[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 1, "creation_date": 1449700608, "post_id": 34189847, "comment_id": 56127044, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/28899620/make-ghci-load-and-interpret-a-module-with-a-foreign-export-declaration-for-f\">Make GHCi load and interpret a module with a &quot;foreign export&quot; declaration (for FFI with C)?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "edited": false, "score": 0, "creation_date": 1449744905, "post_id": 34191281, "comment_id": 56144927, "body": "thanks. but how should i call the function in C? I did: `  double lat, lng;    getGPS(&quot;79.212.82.103&quot;, &amp;lat, &amp;lng);   printf(&quot;GPS: %d %d\\n&quot;, lat, lng);` but this is not printing the double-values, it looks like the adress or something like this?"}, {"owner": {"reputation": 1596, "user_id": 5483583, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/58e00258c68a02aeb27dd3bb73728821?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian Schmitthenner", "link": "https://stackoverflow.com/users/5483583/fabian-schmitthenner"}, "reply_to_user": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "edited": false, "score": 1, "creation_date": 1449747404, "post_id": 34191281, "comment_id": 56146480, "body": "@MartinFischer you have to use e.g. %f to display a double, with %d it is interpreted as an integer (see e. g. <a href=\"http://www.cplusplus.com/reference/cstdio/printf/\" rel=\"nofollow noreferrer\">cplusplus.com/reference/cstdio/printf</a> for an overview of flags)"}], "tags": [], "owner": {"reputation": 1596, "user_id": 5483583, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/58e00258c68a02aeb27dd3bb73728821?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian Schmitthenner", "link": "https://stackoverflow.com/users/5483583/fabian-schmitthenner"}, "is_accepted": true, "score": 7, "last_activity_date": 1449705554, "last_edit_date": 1449705554, "creation_date": 1449705161, "answer_id": 34191281, "question_id": 34189847, "link": "https://stackoverflow.com/questions/34189847/haskell-export-function-for-c/34191281#34191281", "title": "Haskell export function for C", "body": "<p>there are actually two errors:</p>\n\n<ul>\n<li>the type of the <code>foreign export</code> and the <code>getGPS</code> function have to match, so you need a GPS wrapper from CString to CDouble (use <code>peekCString</code> and <code>CDouble</code> to convert them)</li>\n<li>you can't use a tuple as return argument. There are multiple solutions like using 2 <code>Ptr CDouble</code> arguments or defining a struct.</li>\n</ul>\n\n<p>So a possible solution would be</p>\n\n<pre><code>foreign export ccall \"getGPS\" getGPS' :: CString -&gt; Ptr CDouble -&gt; Ptr CDouble -&gt; IO ()\n\ngetGPS' :: CString -&gt; Ptr CDouble -&gt; Ptr CDouble -&gt; IO ()\ngetGPS' str d1 d2 = do\n  (r1, r2) &lt;- getGPS =&lt;&lt; peekCString str\n  poke d1 (CDouble r1)\n  poke d2 (CDouble r2)\n</code></pre>\n\n<p>Remember to call <code>hs_init</code> and <code>hs_exit</code> when using from C Code.</p>\n"}], "owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "accepted_answer_id": 34191281, "answer_count": 1, "score": 3, "last_activity_date": 1449705554, "creation_date": 1449698628, "question_id": 34189847, "link": "https://stackoverflow.com/questions/34189847/haskell-export-function-for-c", "title": "Haskell export function for C", "body": "<p>My Code:</p>\n\n<pre><code>getGPS :: String -&gt; IO (Double, Double)\ngetGPS ip = do\n  html &lt;- getHTML ip\n  let ztags =Prelude.zip [0..] . filterStr . getTagText . getTags $ html\n  let nlat = Prelude.head $ Prelude.map fst . Prelude.filter (\\(_, str) -&gt; strEq str (\"Latitude:\" :: String)) $ ztags\n  let nlng = Prelude.head $ Prelude.map fst . Prelude.filter (\\(_, str) -&gt; strEq str (\"Longitude:\" :: String)) $ ztags\n  let lat = read (Prelude.head $ Prelude.map snd . Prelude.filter (\\(n, _) -&gt; n == nlat + 1) $ ztags) :: Double\n  let lng = read (Prelude.head $ Prelude.map snd . Prelude.filter (\\(n, _) -&gt; n == nlng + 1) $ ztags) :: Double\n  return (lat, lng)\n</code></pre>\n\n<p>is working fine. Now i wanna export this function via <code>FFI</code> to access it from an C application. I did <code>foreign export ccall getGPS :: CString -&gt; IO (CDouble, CDouble)</code> but this is not working:</p>\n\n<pre><code>GPS.hs:45:1:\n    Illegal foreign declaration: requires unregisterised, llvm (-fllvm) or native code generation (-fasm)\n    When checking declaration:\n      foreign export ccall \"getGPS\" getGPS\n        :: CString -&gt; IO (CDouble, CDouble)\n\nGPS.hs:45:1:\n    Unacceptable result type in foreign declaration:\n      \u2018(CDouble, CDouble)\u2019 cannot be marshalled in a foreign call\n    When checking declaration:\n      foreign export ccall \"getGPS\" getGPS\n        :: CString -&gt; IO (CDouble, CDouble)\n\nGPS.hs:45:1:\n    Couldn't match type \u2018Double\u2019 with \u2018CDouble\u2019\n    Expected type: CString -&gt; IO (CDouble, CDouble)\n      Actual type: String -&gt; IO (Double, Double)\n    In the expression: getGPS\n    When checking declaration:\n      foreign export ccall \"getGPS\" getGPS\n        :: CString -&gt; IO (CDouble, CDouble)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>How to export this function correctly?</p>\n"}, {"tags": ["haskell", "conduit", "attoparsec"], "answers": [{"tags": [], "owner": {"reputation": 1596, "user_id": 5483583, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/58e00258c68a02aeb27dd3bb73728821?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian Schmitthenner", "link": "https://stackoverflow.com/users/5483583/fabian-schmitthenner"}, "is_accepted": true, "score": 0, "last_activity_date": 1449688169, "creation_date": 1449688169, "answer_id": 34187033, "question_id": 34186546, "link": "https://stackoverflow.com/questions/34186546/conduit-and-attoparsec-unexpected-termination-on-parse-error/34187033#34187033", "title": "Conduit and Attoparsec: unexpected termination on parse error", "body": "<p>The <code>conduitParser</code> (or <code>conduitParserEither</code>) can also consume multiple tokens on one line: for example the following input produces the same result:</p>\n\n<pre><code>200 GET404 POST\n500 GET\nFOO\n301 PUT\n302 GET\n201 POST\n</code></pre>\n\n<p>So it makes sense that the parser doesn't continue because it doesn't know where the next token would begin.</p>\n"}], "owner": {"reputation": 1989, "user_id": 150770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e62fcde351346d700b2b69447e2adcb?s=128&d=identicon&r=PG&f=1", "display_name": "mazelife", "link": "https://stackoverflow.com/users/150770/mazelife"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 34187033, "answer_count": 1, "score": 1, "last_activity_date": 1449695453, "creation_date": 1449686435, "last_edit_date": 1449695453, "question_id": 34186546, "link": "https://stackoverflow.com/questions/34186546/conduit-and-attoparsec-unexpected-termination-on-parse-error", "title": "Conduit and Attoparsec: unexpected termination on parse error", "body": "<p>I'm trying to convert a log file parser that I wrote a while back over to conduit, and I'm running into an issue. I'll simplify the details of the parser itself since that's not relevant to the question. I have a log file that looks like this:</p>\n\n<pre><code>200 GET\n404 POST\n500 GET\nFOO\n301 PUT\n302 GET\n201 POST\n</code></pre>\n\n<p>So the parsing code is pretty straightforward:</p>\n\n<pre><code>data SimpleLogEntry = SimpleLogEntry {\n      status :: Int\n    , method :: String\n} deriving (Show, Eq)\n\n\nparseHTTPStatus :: Parser Int\nparseHTTPStatus = validate &lt;$&gt; decimal\n    where validate d = if (d &gt;= 200 &amp;&amp; d &lt; 999) then d else 100\n\n\nparseHTTPMethod :: Parser String\nparseHTTPMethod =\n        (stringCI \"GET\" *&gt; return \"Get\")\n    &lt;|&gt; (stringCI \"POST\" *&gt; return \"Post\")\n    &lt;|&gt; (stringCI \"PUT\" *&gt; return \"Put\")\n    &lt;|&gt; return \"Unknown\"\n\n\nparseLogLine :: Parser SimpleLogEntry\nparseLogLine = fmap SimpleLogEntry\n        parseHTTPStatus\n    &lt;*&gt; (space *&gt; parseHTTPMethod)\n</code></pre>\n\n<p>So far so good. Here's how I implemented this in conduit:</p>\n\n<pre><code>import Prelude hiding (lines)\n\nimport Control.Applicative\nimport Control.Monad.IO.Class (liftIO)\nimport Control.Monad.Trans.Resource (runResourceT, ResourceT)\nimport Data.Attoparsec.ByteString.Char8\nimport qualified Data.ByteString as B\nimport qualified Data.ByteString.Char8 as B8\nimport Data.Conduit\nimport qualified Data.Conduit.Attoparsec as CA\nimport qualified Data.Conduit.Binary as CB\nimport qualified Data.Conduit.List as CL\n\n\nlogLines:: Source (ResourceT IO) B.ByteString\nlogLines = CB.sourceFile \"~/test.log\" $= CB.lines\n\n\nparseEntry :: ConduitM B8.ByteString SimpleLogEntry (ResourceT IO) ()\nparseEntry = CA.conduitParserEither parseLogLine =$= awaitForever go\n    where\n        go (Left err) = liftIO $ putStrLn (\"Got an error: \" ++ CA.errorMessage err)\n        go (Right (_, logEntry)) = yield logEntry\n\n\nsink :: Sink SimpleLogEntry (ResourceT IO) ()\nsink = CL.mapM_ (\\t -&gt; liftIO $ putStrLn $ \"Got a status: \" ++ (show . status) t)\n\n\nmain :: IO ()\nmain = runResourceT $ logLines $= parseEntry $$ sink\n</code></pre>\n\n<p>When running <code>main</code> I get this output:</p>\n\n<pre><code>Got a status: 200\nGot a status: 404\nGot a status: 500\nGot an error: Failed reading: takeWhile1\n</code></pre>\n\n<p>I'm having trouble understanding why the pipeline terminates at this point, rather that continuing to parse the next line of the file, as I'd like to do. Reading the docs for <code>Data.Conduit.Attoparsec</code>, this seems like exactly the use case <code>conduitParserEither</code> was designed for.  </p>\n\n<h2>UPDATE</h2>\n\n<p>Per @Fabian, it turns out that <code>conduitParserEither</code> wasn't really what I wanted here. Here's a definition of <code>parseEntry</code> that does what I wanted to do:</p>\n\n<pre><code>parseEntry' :: ConduitM B8.ByteString SimpleLogEntry (ResourceT IO) ()\nparseEntry' = (CL.map (parseOnly parseLogLine)) =$= awaitForever go\n    where\n        go (Left err) = liftIO $ putStrLn (\"Got an error: \" ++ err)\n        go (Right logEntry) = yield logEntry\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449686703, "post_id": 34186531, "comment_id": 56119498, "body": "Have you experimented with these in <code>ghci</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 2, "creation_date": 1449686716, "post_id": 34186531, "comment_id": 56119502, "body": "These are two different implementations of addition, hence the two different names (<code>add</code>, <code>add&#39;</code>). The meaning of <code>add a (S b) = add (S a) b</code> is sort of &quot;if the second argument is nonzero, increment the first argument and decrement the second argument.&quot;"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1449687258, "post_id": 34186531, "comment_id": 56119856, "body": "Perhaps it will help if you read <code>S</code> as <code>1+</code>, so that <code>S b</code> is <code>1+b</code>. Then <code>add a (1+b) = add (1+a) b</code> looks quite readable to me, as well as <code>add&#39; a (1+b) = 1+(add&#39; a b)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 3, "last_activity_date": 1449694084, "creation_date": 1449694084, "answer_id": 34188659, "question_id": 34186531, "link": "https://stackoverflow.com/questions/34186531/algebraic-data-type-data-nat-zero-s-nat/34188659#34188659", "title": "algebraic data type data Nat = Zero | S Nat", "body": "<p>Assume you are teaching a child how to add numbers who only knows counting.</p>\n\n<p>First:\nAdding 3 and 2 equals adding 4 and 1, equals adding 5 and 0, where we know the answer is 5.</p>\n\n<p>Second:\nAdding 3 and 2 is finding the next number after adding 3 and 1, which is the next next number after adding 3 and 0.  So, the answer is counting up twice on 3.</p>\n"}], "owner": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 1, "closed_date": 1450066934, "accepted_answer_id": 34188659, "answer_count": 1, "score": -4, "last_activity_date": 1449694084, "creation_date": 1449686371, "question_id": 34186531, "link": "https://stackoverflow.com/questions/34186531/algebraic-data-type-data-nat-zero-s-nat", "closed_reason": "Needs details or clarity", "title": "algebraic data type data Nat = Zero | S Nat", "body": "<p>we started know with  algebraic data types. As an example we have :</p>\n\n<pre><code>add ::  Nat -&gt; Nat -&gt; Nat\nadd a Zero = a\nadd a (S b) = add (S a) b\n\nadd' ::  Nat -&gt; Nat -&gt; Nat\nadd' a Zero  = a\nadd' a (S b) = S (add' a b)\n</code></pre>\n\n<p>WHat is that suppose to mean? okay, add a Zero = a I guess it's clear.\nBut add a (S b) = add (S a) b ? and add' ?</p>\n\n<p>thank you very much ;)</p>\n"}, {"tags": ["haskell", "time"], "comments": [{"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1449682313, "post_id": 34185112, "comment_id": 56116762, "body": "So you would want to pass the desired time zone and a UTC datetime value, and receive a value with the time zone set <i>and</i> hours adjusted for daylight savings time, based on the zone you passed?"}, {"owner": {"reputation": 38848, "user_id": 232417, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/004e78a7e0aaf9f1eb0009668cd84b1a?s=128&d=identicon&r=PG", "display_name": "dan", "link": "https://stackoverflow.com/users/232417/dan"}, "reply_to_user": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1449682399, "post_id": 34185112, "comment_id": 56116828, "body": "@9000 I&#39;d be happy with just being able to get the daylight-savings-adjusted TimeZone value for any UTCTime in the U.S. Eastern Time Zone."}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 1, "creation_date": 1449683779, "post_id": 34185112, "comment_id": 56117688, "body": "A cursory look through sources made me think that the library supposes <code>EDT</code> and <code>EST</code> two separate and unrelated timezones, and does not appear to have the DST start / end info which <a href=\"https://en.wikipedia.org/wiki/Tz_database\" rel=\"nofollow noreferrer\">tzdata</a> has. Raw tzdata are <a href=\"https://hackage.haskell.org/package/tzdata\" rel=\"nofollow noreferrer\">available</a> but still raw,"}, {"owner": {"reputation": 38848, "user_id": 232417, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/004e78a7e0aaf9f1eb0009668cd84b1a?s=128&d=identicon&r=PG", "display_name": "dan", "link": "https://stackoverflow.com/users/232417/dan"}, "reply_to_user": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1449684144, "post_id": 34185112, "comment_id": 56117903, "body": "Yes, it seems like I&#39;m looking for tzdata/tzinfo support in Haskell."}, {"owner": {"reputation": 38848, "user_id": 232417, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/004e78a7e0aaf9f1eb0009668cd84b1a?s=128&d=identicon&r=PG", "display_name": "dan", "link": "https://stackoverflow.com/users/232417/dan"}, "reply_to_user": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1449684790, "post_id": 34185112, "comment_id": 56118306, "body": "I&#39;m looking at this right now: <a href=\"http://hackage.haskell.org/package/tz\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/tz</a>"}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1449685125, "post_id": 34185112, "comment_id": 56118533, "body": "There is also <a href=\"http://hackage.haskell.org/package/timezone-olson\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/timezone-olson</a> which seemingly contains the UTC offset rules in some form, but I failed to find an easily consumable form yet."}], "answers": [{"tags": [], "owner": {"reputation": 38848, "user_id": 232417, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/004e78a7e0aaf9f1eb0009668cd84b1a?s=128&d=identicon&r=PG", "display_name": "dan", "link": "https://stackoverflow.com/users/232417/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1449685415, "last_edit_date": 1449685415, "creation_date": 1449684924, "answer_id": 34186083, "question_id": 34185112, "link": "https://stackoverflow.com/questions/34185112/how-to-convert-posix-epoch-seconds-to-est-edt-time-reliably-with-pure-functions/34186083#34186083", "title": "How to convert POSIX epoch seconds to EST/EDT time reliably, with pure functions", "body": "<p>The <a href=\"http://hackage.haskell.org/package/tz\" rel=\"nofollow\">tz</a> package looks like it might fit the bill, but unfortunately, it has <a href=\"https://github.com/fpco/stackage/issues/907\" rel=\"nofollow\">dependency build problems</a>. </p>\n"}, {"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1457239253, "creation_date": 1457239253, "answer_id": 35823193, "question_id": 34185112, "link": "https://stackoverflow.com/questions/34185112/how-to-convert-posix-epoch-seconds-to-est-edt-time-reliably-with-pure-functions/35823193#35823193", "title": "How to convert POSIX epoch seconds to EST/EDT time reliably, with pure functions", "body": "<p><code>utcToLocalTime'</code> and <code>timeZoneFromSeries</code> from the <a href=\"http://hackage.haskell.org/package/timezone-series-0.1.5.1/docs/Data-Time-LocalTime-TimeZone-Series.html#v:utcToLocalTime-39-\" rel=\"nofollow\">timezone-series</a> package look to have been developed to cover exactly this scenario.</p>\n"}], "owner": {"reputation": 38848, "user_id": 232417, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/004e78a7e0aaf9f1eb0009668cd84b1a?s=128&d=identicon&r=PG", "display_name": "dan", "link": "https://stackoverflow.com/users/232417/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 2, "answer_count": 2, "score": 6, "last_activity_date": 1457248804, "creation_date": 1449681876, "last_edit_date": 1457248804, "question_id": 34185112, "link": "https://stackoverflow.com/questions/34185112/how-to-convert-posix-epoch-seconds-to-est-edt-time-reliably-with-pure-functions", "title": "How to convert POSIX epoch seconds to EST/EDT time reliably, with pure functions", "body": "<p>I'm using the <code>time-1.5.0.1</code> library. </p>\n\n<p>I'm given a value representing epoch seconds, e.g. <code>1449590820</code> which equals <code>2015-12-08 11:07:00 -0500</code>.</p>\n\n<p>Using <a href=\"http://hackage.haskell.org/package/time-1.5.0.1/docs/Data-Time.html\" rel=\"nofollow\">Data.Time</a> modules, I want to be able to convert <code>1449590820</code> to a <code>ZonedTime</code>. </p>\n\n<p>The function I want to use is this:</p>\n\n<pre><code>utcToZonedTime :: TimeZone -&gt; UTCTime -&gt; ZonedTime\n</code></pre>\n\n<p>The problem is getting the <code>TimeZone</code> value I need. The available functions in <code>Data.Time</code> either depend on getting the <code>TimeZone</code> from the environment or require you to explicitly construct a <code>TimeZone</code> for <code>EDT</code> or <code>EST</code>.</p>\n\n<p>I want to avoid depending on the environment to give me a <code>ZonedTime</code>, because there is no guarantee that the code will run on a server set to the US Eastern Time. So using this function is out of the question:</p>\n\n<pre><code>utcToLocalZonedTime :: UTCTime -&gt; IO ZonedTime\n</code></pre>\n\n<p>So that leaves me with the option of constructing the necessary <code>TimeZone</code> input myself. </p>\n\n<p>But the <code>TimeZone</code> for <code>EDT</code> is not the same as the <code>TimeZone</code> for <code>EST</code>, so I need a different <code>TimeZone</code> depending on whether daylight savings is in effect. Is there is an easy way to generate a <code>TimeZone</code> of <code>EDT</code> or <code>EST</code> depending on the value of a <code>UTCTime</code> (i.e. whether it falls within the Daylight Savings Time period)? </p>\n\n<p>I want to stress that I want to do this exclusively using pure functions. </p>\n\n<p>Maybe I'm looking for a Haskell analog to the <a href=\"https://github.com/glortho/tzinfo\" rel=\"nofollow\">tzinfo library in Ruby</a>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1449680030, "post_id": 34184413, "comment_id": 56115199, "body": "<code>html &lt;- getHTML &quot;79.212.82.103&quot; ; let tags = parseTags html</code>. You need to bind it somehow, either by <code>&lt;-</code>, <code>&gt;&gt;=</code> or other way."}], "answers": [{"comments": [{"owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "edited": false, "score": 0, "creation_date": 1449686667, "post_id": 34184478, "comment_id": 56119472, "body": "Thanks a lot. this was very helpful and great explained/designed. thanks"}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 4, "last_activity_date": 1449704723, "last_edit_date": 1449704723, "creation_date": 1449680002, "answer_id": 34184478, "question_id": 34184413, "link": "https://stackoverflow.com/questions/34184413/haskell-make-functions-out-of-a-do-block/34184478#34184478", "title": "Haskell make functions out of a do-Block", "body": "<p>It's a monadic action now, so use the monadic syntax:</p>\n\n<pre><code>tags &lt;- parseTags &lt;$&gt; getHTML \"79.212.82.103\"\n--   \u2a53             \u2a53\n--   \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 bind instead of 'let'\n--                 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 functor application\n</code></pre>\n\n<p><code>&lt;$&gt;</code> is just infix <code>fmap</code>. You could use it in your implementation of <code>getHTML</code> as well.</p>\n"}], "owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "accepted_answer_id": 34184478, "answer_count": 1, "score": 3, "last_activity_date": 1449704723, "creation_date": 1449679846, "question_id": 34184413, "link": "https://stackoverflow.com/questions/34184413/haskell-make-functions-out-of-a-do-block", "title": "Haskell make functions out of a do-Block", "body": "<p>I have following program which works fine:</p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE NoMonomorphismRestriction #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n\nmodule GPS where\n\nimport Network.Wreq\nimport Control.Lens\nimport Text.HTML.TagSoup\nimport Data.ByteString.Lazy\nimport Data.ByteString.Lazy.Char8\nimport Data.Strings\n\ngetStr :: Tag ByteString -&gt; String\ngetStr tag@(TagText str) = Data.ByteString.Lazy.Char8.unpack str\ngetStr _ = \"\"\n\nfilterStr :: [Tag ByteString] -&gt; [String]\nfilterStr [] = []\nfilterStr (t:r) = [getStr t] ++ filterStr r\n\nmain :: IO ()\nmain = do\n  r &lt;- post \"http://www.geocodeip.com\" [\"IP\" := Data.ByteString.Lazy.Char8.pack \"79.212.82.103\"]\n  html &lt;- r ^. responseBody\n  let tags = parseTags html\n  let tr = Prelude.head $ sections (~== (\"&lt;tr&gt;\" :: String)) tags\n  let tag = Prelude.filter isTagText tr\n  let text = filterStr tag\n  let ztext =Prelude.zip [0..] text\n  let nlat = Prelude.head $ Prelude.map fst . Prelude.filter (\\(_, str) -&gt; strEq str (\"Latitude:\" :: String)) $ ztext\n  let nlng = Prelude.head $ Prelude.map fst . Prelude.filter (\\(_, str) -&gt; strEq str (\"Longitude:\" :: String)) $ ztext\n  let lat = read (Prelude.head $ Prelude.map snd . Prelude.filter (\\(n, _) -&gt; n == nlat + 1) $ ztext) :: Double\n  let lng = read (Prelude.head $ Prelude.map snd . Prelude.filter (\\(n, _) -&gt; n == nlng + 1) $ ztext) :: Double\n  print lat\n  print lng\n</code></pre>\n\n<p>And now the interesting part - I want to make sub-functions out of this \"do-Block\", e.g. getHTML, getTags, makeText etc....</p>\n\n<p>So I started to make following:</p>\n\n<pre><code>getHTML :: String -&gt; IO ByteString\ngetHTML ip = fmap (view responseBody) (post \"http://www.geocodeip.com\" [\"IP\" := Data.ByteString.Lazy.Char8.pack ip])\n</code></pre>\n\n<p>This should replace the first and second line of my do-Block, it should get the HTML. This works fine, only problem is that it retuns a type with <code>IO</code>, so <code>let tags = parseTags $ getHTML \"79.212.82.103\"</code> is not working:</p>\n\n<pre><code>[1 of 1] Compiling GPS              ( GPS.hs, interpreted )\n\nGPS.hs:38:14:\n    No instance for (Text.StringLike.StringLike (IO ByteString))\n      arising from a use of \u2018parseTags\u2019\n    In the expression: parseTags\n    In the expression: parseTags $ getHTML \"79.212.82.103\"\n    In an equation for \u2018tags\u2019:\n        tags = parseTags $ getHTML \"79.212.82.103\"\n\nGPS.hs:39:37:\n    No instance for (Text.StringLike.StringLike (IO ByteString))\n      arising from a use of \u2018~==\u2019\n    In the first argument of \u2018sections\u2019, namely\n      \u2018(~== (\"&lt;tr&gt;\" :: String))\u2019\n    In the second argument of \u2018($)\u2019, namely\n      \u2018sections (~== (\"&lt;tr&gt;\" :: String)) tags\u2019\n    In the expression:\n      Prelude.head $ sections (~== (\"&lt;tr&gt;\" :: String)) tags\n\nGPS.hs:41:24:\n    Couldn't match type \u2018IO ByteString\u2019 with \u2018ByteString\u2019\n    Expected type: [Tag ByteString]\n      Actual type: [Tag (IO ByteString)]\n    In the first argument of \u2018filterStr\u2019, namely \u2018tag\u2019\n    In the expression: filterStr tag\nFailed, modules loaded: none.\n</code></pre>\n\n<p>How to fix my issue?</p>\n"}, {"tags": ["haskell", "types", "functional-programming", "type-systems"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1449682775, "post_id": 34184201, "comment_id": 56117039, "body": "Why would you expect there to be one?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1449683289, "post_id": 34184201, "comment_id": 56117352, "body": "I don&#39;t expect, but I think that, using Occam&#39;s Razor, when you have two very similar concepts in a system, it often means there is some non-obvious, more primitive concept that generalizes both. I just find this particular feature of CoC too oddly specific to be, among the space of possible systems, the simplest one that can be used for total functional programming and writing specifications as types. But I could be wrong."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449685632, "post_id": 34184201, "comment_id": 56118844, "body": "Ah, I see what you mean."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 2, "creation_date": 1449688296, "post_id": 34184201, "comment_id": 56120429, "body": "It&#39;s not CoC in the paper \u2014 it&#39;s the original version of MLTT with the impredicative universe. CoC only has impredicative <code>Prop</code>, which doesn&#39;t admit <code>Prop \u2208 Prop</code>, but admits <code>(A : Prop) -&gt; ... \u2208 Prop</code>. Occam&#39;s Razor can produce only conjectures \u2014 it&#39;s not a proper argument."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1449689975, "post_id": 34184201, "comment_id": 56121359, "body": "@user3237465 woops okay, sorry."}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 1, "closed_date": 1458363978, "answer_count": 0, "score": 7, "last_activity_date": 1449689966, "creation_date": 1449679318, "last_edit_date": 1449689966, "question_id": 34184201, "link": "https://stackoverflow.com/questions/34184201/is-there-a-simpler-type-system-with-the-practical-utilities-of-coc", "closed_reason": "Duplicate", "title": "Is there a simpler type system with the practical utilities of CoC?", "body": "<p>The Calculus of Constructions, as presented on the <a href=\"http://augustss.blogspot.com.br/2007/10/simpler-easier-in-recent-paper-simply.html\" rel=\"nofollow\">Simpler, Easier</a> post, is a very simple type system which can be used as a programming language with all good properties you'd expect - type checking, correctness proofs, totality. Yet, given the similarity between Pi and Lam, and using Occam's Razor, I wonder: is there a system even simpler than CoC, with all those practical utilities?</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1449673938, "post_id": 34182174, "comment_id": 56110669, "body": "Not that it really matters, no? :P"}, {"owner": {"reputation": 24126, "user_id": 368864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/76e6f95b06ade13607a4dd999f7f72e5?s=128&d=identicon&r=PG", "display_name": "cambraca", "link": "https://stackoverflow.com/users/368864/cambraca"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1449673982, "post_id": 34182174, "comment_id": 56110705, "body": "@BartekBanachewicz No, or at least I don&#39;t think so, but it bugs me!!!"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 2, "creation_date": 1449674548, "post_id": 34182174, "comment_id": 56111140, "body": "Some function in <code>cleanUp</code> (maybe <code>filter</code>) has a type signature written using the variable <code>a</code> while some function in <code>joinByPairs</code> (maybe <code>(++)</code>) has a type signature written using the variable <code>t</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1449674571, "post_id": 34182174, "comment_id": 56111159, "body": "I don&#39;t have an exact answer, but I think it pretty much boils down to this: the GHC developers don&#39;t care very much about the names of the type variables GHC shows you. Sometimes type variables will come from what you&#39;ve written, sometimes they&#39;ll come from the function(s) you&#39;re using, and sometimes the compiler will make them up from whole cloth. Sometimes this is really annoying (particularly when using <code>ScopedTypeVariables</code>)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1449711186, "post_id": 34182174, "comment_id": 56130802, "body": "@dfeuer Actually, the GHC devs care more than you may think. There&#39;s an awful lot of extra machinery in GHC to keep around type information provided by the user -- type synonyms and families are kept folded as long as possible, type variable names are preserved if they came from the user, and probably other subtle places you wouldn&#39;t think about off the top of your head have special cases as well."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1449674763, "post_id": 34182533, "comment_id": 56111291, "body": "Type variables that are named in a type signature don&#39;t always keep those names in typed hole messages, even when they are in scope with <code>ScopedTypeVariables</code>. This is obnoxious, IMO."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449674937, "post_id": 34182533, "comment_id": 56111414, "body": "Ah.  I rarely used typed holes, so I haven&#39;t run into that."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1449675377, "post_id": 34182533, "comment_id": 56111749, "body": "Typed holes are awesome, although <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9091\" rel=\"nofollow noreferrer\">not quite as awesome</a> yet as they <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9479\" rel=\"nofollow noreferrer\">should be</a>."}], "tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 8, "last_activity_date": 1449674681, "creation_date": 1449674681, "answer_id": 34182533, "question_id": 34182174, "link": "https://stackoverflow.com/questions/34182174/why-does-type-sometimes-show-a-and-other-times-t/34182533#34182533", "title": "Why does `:type` sometimes show `a` and other times `t`?", "body": "<p>It's because of the way type variable names are chosen.  Brand-new variables get <code>t</code>.  Type variables that are named in a type signature keep the name from the type signature.  When unifying type variables, GHC prefers to keep a name that came from an explicit type signature.  If no subexpression had an explicit type signature, there's no names other than <code>t</code> to unify with.</p>\n"}], "owner": {"reputation": 24126, "user_id": 368864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/76e6f95b06ade13607a4dd999f7f72e5?s=128&d=identicon&r=PG", "display_name": "cambraca", "link": "https://stackoverflow.com/users/368864/cambraca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "accepted_answer_id": 34182533, "answer_count": 1, "score": 6, "last_activity_date": 1449674681, "creation_date": 1449673703, "question_id": 34182174, "link": "https://stackoverflow.com/questions/34182174/why-does-type-sometimes-show-a-and-other-times-t", "title": "Why does `:type` sometimes show `a` and other times `t`?", "body": "<p>I have these two functions:</p>\n\n<pre><code>cleanUp a = Data.List.filter (/=[]) a\n\njoinByPairs [] = []\njoinByPairs (x:[]) = (x:[])\njoinByPairs (x:y:xs) = (x ++ y) : joinByPairs xs\n</code></pre>\n\n<p>When I load them in <code>ghci</code>, and call <code>:type</code> on them, I get these results:</p>\n\n<pre><code>*Main&gt; :type joinByPairs\njoinByPairs :: [[a]] -&gt; [[a]]\n*Main&gt; :type cleanUp\ncleanUp :: Eq t =&gt; [[t]] -&gt; [[t]]\n</code></pre>\n\n<p>What is the logic of it showing <code>a</code> vs. <code>t</code>? I don't think it's because of the <code>Eq t</code> part, since I have other functions that show something like <code>otherFunction :: Eq a =&gt; [[a]] -&gt; [[a]]</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449672474, "post_id": 34180683, "comment_id": 56109585, "body": "It looks fine to me."}, {"owner": {"reputation": 534, "user_id": 3741667, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/21cb614bca606c41959304bf9463f8d0?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/3741667/jonas"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449672576, "post_id": 34180683, "comment_id": 56109687, "body": "But is this the most convenient way to evaluate it? It took me so long to write that down..."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 1, "creation_date": 1449672862, "post_id": 34180683, "comment_id": 56109905, "body": "You are calculating the cartesian product of two lists, to which <code>liftM2 (,) [1,2] [&#39;a&#39;, &#39;b&#39;]</code> or even <code>(,) &lt;$&gt; [1, 2] &lt;*&gt; &quot;ab&quot;</code> are shorter. In terms of computation, it may seem to you that if you can term rewrite your expression this much, it would cause a corresponding excess of computations, but I would not worry about that."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449672892, "post_id": 34180683, "comment_id": 56109927, "body": "Define &quot;convenient&quot; and &quot;evaluate&quot;. I mean -- a trained Haskeller can mentally skip most of these intermediate steps, but would you call that an &quot;evaluation&quot;? One can even mentally jump from the first step to the last... Your steps are nice to me since they expose how <code>&gt;&gt;=</code> is implemented in terms of <code>map</code> and <code>concat</code>."}, {"owner": {"reputation": 534, "user_id": 3741667, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/21cb614bca606c41959304bf9463f8d0?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/3741667/jonas"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449673009, "post_id": 34180683, "comment_id": 56110026, "body": "@chi I was just wondering if I took a longer path by bracketing things the wrong way and evaluating them in the wrong order. It is confusing to see so many <code>&gt;&gt;=</code> and <code>-&gt;</code> at the same time. And I have no problem with <code>[1..2] &gt;&gt;= \\n -&gt; [&#39;a&#39;, &#39;b&#39;]</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1449673302, "post_id": 34180683, "comment_id": 56110238, "body": "You can possibly simplify things a bit if you start computing from the inner subexpression. I.e., first you can reduce <code>[&#39;a&#39;,&#39;b&#39;] &gt;&gt;= \\ch -&gt; return (n, ch)</code> to <code>[(n, &#39;a&#39;), (n, &#39;b&#39;)]</code> leaving <code>n</code> as a free variable. This could slightly reduce the visual noise in the next lines."}], "owner": {"reputation": 534, "user_id": 3741667, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/21cb614bca606c41959304bf9463f8d0?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/3741667/jonas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449669645, "creation_date": 1449669645, "question_id": 34180683, "link": "https://stackoverflow.com/questions/34180683/simple-haskell-bind-expression-evaluation", "title": "Simple Haskell bind expression evaluation", "body": "<p>Can anyone help me check if this is the right way to evaluate the expression:</p>\n\n<pre><code>  [1..2] &gt;&gt;= \\n -&gt; ['a', 'b'] &gt;&gt;= \\ch -&gt; return (n, ch)\n= concat (map (\\n -&gt; ['a', 'b'] &gt;&gt;= \\ch -&gt; return (n, ch)) [1..2])\n= concat [ ['a', 'b'] &gt;&gt;= \\ch -&gt; return (1, ch),\n           ['a', 'b'] &gt;&gt;= \\ch -&gt; return (2, ch) ]\n= concat [ concat (map (\\ch -&gt; return (1, ch)) ['a', 'b']),\n           concat (map (\\ch -&gt; return (2, ch)) ['a', 'b']) ]\n= concat [ concat [return (1, 'a'), return (1, 'b')],\n           concat [return (2, 'a'), return (2, 'b')] ]\n= concat [ concat [ [(1, 'a')], [(1, 'b')] ],\n           concat [ [(2, 'a')], [(2, 'b')] ] ]\n= concat [ [ (1, 'a'), (1, 'b') ],\n           [ (2, 'a'), (2, 'b') ] ]\n= [ (1, 'a'), (1, 'b'), (2, 'a'), (2, 'b') ]\n</code></pre>\n\n<p>Considering this is what lies behind the list comprehension <code>[(n, ch) | n &lt;- [1..2], ch &lt;- ['a', 'b']]</code>, am I doing something stupid here?</p>\n"}, {"tags": ["haskell", "exception"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1449668000, "post_id": 34179759, "comment_id": 56106326, "body": "Your approach is completely sound (in my opinion) but you have made one tiny mistake. The <code>fail</code> function comes from the <code>Monad</code> class and generally just calls <code>error</code>. <code>fail &quot;&quot; :: Either () ()</code> is an error, not <code>Left ()</code>. So you are not actually using the <code>MonadThrow</code> interface. You should be called <code>throwE</code> with your own exception type <code>throwE $ MyException &quot;...&quot;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13337, "user_id": 441899, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/368fb99f86e2264ceec0539a3746b9d3?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/441899/jules"}, "edited": false, "score": 0, "creation_date": 1461997799, "post_id": 34201708, "comment_id": 61461360, "body": "Just a short comment: you are aware that your <code>first</code> function is already defined in the <code>Bifunctor</code> instance of <code>Either</code>, right?  Just import <code>Data.Bifunctor</code> to get it."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 0, "last_activity_date": 1449749858, "creation_date": 1449749858, "answer_id": 34201708, "question_id": 34179759, "link": "https://stackoverflow.com/questions/34179759/hunit-testing-with-exceptions/34201708#34201708", "title": "Hunit testing with exceptions", "body": "<p>Thanks to @user2407038 I've been able to solve this:</p>\n\n<p>defining a new datatype for the exception</p>\n\n<pre><code>data ParseException = TagMismatch String deriving (Typeable, Eq, Show)\n</code></pre>\n\n<p>then adjusting the imports and the following functions</p>\n\n<pre><code>parseTxt :: Exception e =&gt; (Element -&gt; Either e a) -&gt; Text -&gt; Either SomeException a\nparseTxt parser inText = documentRoot &lt;$&gt; (parseText def $ fromStrict inText) &gt;&gt;=\n                         (first toException . parser)\n\nfirst :: (a -&gt; c) -&gt; Either a b -&gt; Either c b\nfirst f (Left l) = Left (f l)\nfirst _ (Right r) = Right r\n\nparser :: MonadThrow m =&gt; Element -&gt; m TestElement\nparser elmt =\n    do unless (elementName elmt == \"TestElement\")\n         $ throwM $ TagMismatch \"TestElement\"\n       return TestElement\n\nunitTests :: TestTree\nunitTests = testGroup \"Unit tests\"\n    [ {-...-}\n      testCase \"parseTxt parser failTxt == fail\" $\n        (first aux $ parseTxt parser failTxt) @?= Left $ TagMismatch \"TestElement\"\n    ]\n    where aux = fromMaybe (error \"converting from SomeException failed\")\n              . fromException\n</code></pre>\n\n<p><em>Note1:</em> the <code>deriving Eq</code> is only necessary for the <code>@?=</code> operation in the unit tests and could be omitted for the productive version of the code.</p>\n\n<p><em>Note2:</em> Also the direct dependency on <code>resourcet</code> can be replaced by <code>exceptions</code>, which the former just reexports.</p>\n"}], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 0, "accepted_answer_id": 34201708, "answer_count": 1, "score": 2, "last_activity_date": 1449749858, "creation_date": 1449666853, "question_id": 34179759, "link": "https://stackoverflow.com/questions/34179759/hunit-testing-with-exceptions", "title": "Hunit testing with exceptions", "body": "<p>I am writing a program to parse some xml.</p>\n\n<p>I took the approach of using <code>MonadThrow</code> to take care of errors in parsing, but now when testing the fails - can't figure out how to test them. Which makes me unsure if this approach is the right one.</p>\n\n<p>First of all here is a complete (non-working) example</p>\n\n<p><code>exception.hs</code></p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Test.Tasty\nimport Test.Tasty.HUnit\n\nimport Control.Exception (SomeException, displayException)\nimport Control.Monad (unless)\nimport Control.Monad.Trans.Resource (MonadThrow)\nimport Data.Function (on)\nimport Text.XML (Element, parseText, def, documentRoot, elementName)\nimport Data.Text (Text)\nimport Data.Text.Lazy (fromStrict)\n\ndata TestElement = TestElement deriving (Show, Eq)\n\nmain :: IO ()\nmain = defaultMain unitTests\n\nunitTests :: TestTree\nunitTests = testGroup \"Unit tests\"\n    [ testCase \"parseTxt parser goodTxt1 == Right TestElement \" $\n        parseTxt parser goodTxt1 @?= Right TestElement\n    , testCase \"parseTxt parser goodTxt2 == Right TestElement \" $\n        parseTxt parser goodTxt2 @?= Right TestElement\n    , testCase \"parseTxt parser failTxt == Left \\\"ElementName does not match TestElement\\\"\" $\n        parseTxt parser failTxt @?= undefined\n    --hunit\n    ]\n\n\nparseTxt :: (Element -&gt; Either SomeException a) -&gt; Text -&gt; Either SomeException a\nparseTxt parser inText = documentRoot &lt;$&gt; (parseText def $ fromStrict inText) &gt;&gt;=\n                         parser\n\nparser :: MonadThrow m =&gt; Element -&gt; m TestElement\nparser elmt =\n    do unless (elementName elmt == \"TestElement\")\n         $ fail \"ElementName does not match TestElement\"\n       {-here usually some more complicated attribute/subnode parsing happens-}\n       return TestElement\n\nfailTxt :: Text\nfailTxt = \"&lt;ToastElement&gt;&lt;/ToastElement&gt;\"\n\ngoodTxt1 :: Text\ngoodTxt1 = \"&lt;TestElement /&gt;\"\n\ngoodTxt2 :: Text\ngoodTxt2 = \"&lt;TestElement&gt;&lt;/TestElement&gt;\"\n\ninstance Eq SomeException where\n    (==) = (==) `on` displayException\n</code></pre>\n\n<p>which needs <code>exception.cabal</code></p>\n\n<pre><code>[...]\nexecutable exception\n  hs-source-dirs:      src\n  main-is:             Main.hs\n  default-language:    Haskell2010\n  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5\n               ,       xml-conduit\n               ,       exceptions\n               ,       resourcet\n               ,       tasty\n               ,       tasty-hunit\n               ,       text\n</code></pre>\n\n<h1>TL;DR</h1>\n\n<p>I am not sure what to put instead of the <code>undefined</code> in the last unit test and if the approach of using exceptions is right in this case.</p>\n\n<hr>\n\n<p>There are several options I thought of:</p>\n\n<ul>\n<li>using <code>(either displayException show $ parseTxt parser failTxt) @?= undefined</code>\nstill fails and does not yield a <code>Left</code> value</li>\n<li>using <code>assertFail</code> defies the purpose of having a <code>Either SomeException TestElement</code> in my opinion</li>\n<li>I could use a self-defined exception-type in order to match against it, but can I use fail to throw an error of my own type</li>\n</ul>\n\n<p>I think one of the sources of my confusion is that I don't know when the error is thrown (I thought lazy evaluation would throw the error when I matched against it - which is apparently wrong).</p>\n"}, {"tags": ["haskell", "io-monad"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1449666155, "post_id": 34179321, "comment_id": 56105177, "body": "The definition of <code>&gt;&gt;=</code> for <code>[]</code> is just <code>concatMap</code> - this function is precisely what does the mapping."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1449691443, "post_id": 34179321, "comment_id": 56122182, "body": "You have used the monad laws to define <code>fmap</code>."}, {"owner": {"reputation": 34030, "user_id": 1993366, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dGJXl.png?s=128&g=1", "display_name": "vikingsteve", "link": "https://stackoverflow.com/users/1993366/vikingsteve"}, "edited": false, "score": 0, "creation_date": 1449744869, "post_id": 34179321, "comment_id": 56144902, "body": "Wasn&#39;t the first time I found <code>&gt;&gt;=</code> confusing in this context. Has nothing to do with Monads here."}, {"owner": {"reputation": 30876, "user_id": 2079831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/707e9914d5a39558c376e8db47c60151?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2079831/andrew"}, "edited": false, "score": 0, "creation_date": 1449777603, "post_id": 34179321, "comment_id": 56165382, "body": "@ vikingsteve I guess list [] is a monad. That&#39;s why &gt;&gt;= defined for the list."}], "answers": [{"tags": [], "owner": {"reputation": 5013, "user_id": 969617, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/2412de50d273085f5dcf3f2101c3996e?s=128&d=identicon&r=PG", "display_name": "beoliver", "link": "https://stackoverflow.com/users/969617/beoliver"}, "is_accepted": false, "score": 0, "last_activity_date": 1449665744, "creation_date": 1449665744, "answer_id": 34179378, "question_id": 34179321, "link": "https://stackoverflow.com/questions/34179321/haskell-why-it-is-working-iteration-over-monad/34179378#34179378", "title": "Haskell. Why it is working? (Iteration over Monad)", "body": "<p>A list is a <code>monad</code>, so given the signature for map:</p>\n\n<p><code>map :: (a-&gt;b) -&gt; [a] -&gt; [b]</code></p>\n\n<p>and the signature for liftMM</p>\n\n<p><code>liftMM :: Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b</code></p>\n\n<p>the <code>[]</code> is the <code>m</code></p>\n\n<p>This means that <strong>for lists</strong> <code>liftMM</code> and <code>map</code> do the same thing. </p>\n"}, {"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 2, "last_activity_date": 1449703992, "last_edit_date": 1449703992, "creation_date": 1449666435, "answer_id": 34179618, "question_id": 34179321, "link": "https://stackoverflow.com/questions/34179321/haskell-why-it-is-working-iteration-over-monad/34179618#34179618", "title": "Haskell. Why it is working? (Iteration over Monad)", "body": "<p><code>m</code> here is <code>[]</code> and <code>liftMM</code> works by delegating to the implementation of <code>(&gt;&gt;=)</code> and <code>return</code> for <code>m</code>. Therefore you need to understand <code>(&gt;&gt;=)</code> and <code>return</code> for lists, and if you look at the <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/src/GHC.Base.html#line-726\" rel=\"nofollow\">definition</a> they are:</p>\n\n<pre><code>instance Monad []  where\n    xs &gt;&gt;= f            = [y | x &lt;- xs, y &lt;- f x]\n    return x            = [x]\n</code></pre>\n\n<p>so for each element in the source list <code>&gt;&gt;=</code> applies <code>f</code> and then inserts each element of the returned list into the result list.</p>\n\n<p><code>return x</code> simply returns a singleton list containing <code>x</code> so <code>return (f a)</code> returns a list <code>[f a]</code>. Each of these single element lists are then combined by <code>(&gt;&gt;=)</code> to create the output list.</p>\n"}], "owner": {"reputation": 30876, "user_id": 2079831, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/707e9914d5a39558c376e8db47c60151?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/2079831/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 2, "accepted_answer_id": 34179618, "answer_count": 2, "score": 1, "last_activity_date": 1449703992, "creation_date": 1449665536, "question_id": 34179321, "link": "https://stackoverflow.com/questions/34179321/haskell-why-it-is-working-iteration-over-monad", "title": "Haskell. Why it is working? (Iteration over Monad)", "body": "<pre><code>liftMM :: Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b\nliftMM f m = m &gt;&gt;= \\a -&gt; return (f a)\n</code></pre>\n\n<p>I run:</p>\n\n<pre><code>&gt; liftMM (*2) [1..10]\n</code></pre>\n\n<p>I got output:</p>\n\n<pre><code>&gt; [2,4,6,8,10,12,14,16,18,20]\n</code></pre>\n\n<p>I can not see how this function is mapping over all list's values? There is no any recursion or iteration, just one pass monad internal m value to the function f. What I am missing here?</p>\n"}, {"tags": ["list", "haskell", "filter"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1449661251, "post_id": 34177871, "comment_id": 56102232, "body": "i think you already used the name of that function in the tags - <code>filter</code> it keeps all elements that satisfy a given condition"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1449661454, "post_id": 34177871, "comment_id": 56102358, "body": "i think your difficulty is rather to formalize the datamodel - you have a list of tupels of two list of Strings, and the condition on top of that data model - try to come up with a good datatype and then think about the condition/filter again. I&#39;ll bet it will be easier then."}, {"owner": {"reputation": 157, "user_id": 4817532, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-J9x2IROrVFs/AAAAAAAAAAI/AAAAAAAAABA/Lct15HbADb0/photo.jpg?sz=128", "display_name": "Negar Alinaghi", "link": "https://stackoverflow.com/users/4817532/negar-alinaghi"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1449664756, "post_id": 34177871, "comment_id": 56104291, "body": "Thanks, I know that this data structure is not the best, but the problem is that now I am in the middle of a project done partially by someone else and any change in this level will change many other things! That&#39;s why I was wondering if there is a way for filtering the list with the same structure as it already has..."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1449665386, "post_id": 34177871, "comment_id": 56104688, "body": "You can of course work directly with the strings: <code>filter (\\([x,y],[a,b]) -&gt; (y==&quot;number&quot; &amp;&amp; b==&quot;alley&quot;) || y &#47;= &quot;number&quot;)</code>. Note this makes a lot of implicit assumptions that will give nasty errors if violated. If the function is any bigger than this, then defining your own datatype will make your life much easier."}], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 1, "last_activity_date": 1449665618, "creation_date": 1449665618, "answer_id": 34179343, "question_id": 34177871, "link": "https://stackoverflow.com/questions/34177871/how-to-drop-elements-of-a-list-which-are-not-satisfying-a-certain-condition/34179343#34179343", "title": "How to drop elements of a list which are not satisfying a certain condition?", "body": "<p>the only answer I can get from your description is </p>\n\n<pre><code>condition (x,y) = let xy = if any (== \"number\") x\n                             then any (`elem` [\"number\",\"alley\"]) y\n                             else True\n                      yx = if any (== \"number\") y\n                             then any (`elem` [\"number\",\"alley\"]) x\n                             else True\n                   in xy &amp;&amp; yx\n</code></pre>\n\n<p>it is dirty and could be refactored easily but i don't have time right now for prettyfying</p>\n"}], "owner": {"reputation": 157, "user_id": 4817532, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-J9x2IROrVFs/AAAAAAAAAAI/AAAAAAAAABA/Lct15HbADb0/photo.jpg?sz=128", "display_name": "Negar Alinaghi", "link": "https://stackoverflow.com/users/4817532/negar-alinaghi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1449665618, "creation_date": 1449661026, "last_edit_date": 1449661781, "question_id": 34177871, "link": "https://stackoverflow.com/questions/34177871/how-to-drop-elements-of-a-list-which-are-not-satisfying-a-certain-condition", "title": "How to drop elements of a list which are not satisfying a certain condition?", "body": "<p>I am trying to formalize route descriptions in haskell for a spatial reasoning simulation. In the process I need a function to drop some elements in a list like this which does not satisfy a condition: </p>\n\n<pre><code> [([\"Keyhan\",\"ave.\"],[\"Keyhan4\",\"alley\"]),([\"13\",\"number\"],[\"Keyhan\",\"ave.\"]),([\"13\",\"number\"],[\"Keyhan4\",\"alley\"])]\n</code></pre>\n\n<p>I want all the pairs in this list which contain <code>\"number\"</code> and anything, except for <code>\"number\"</code> and <code>\"alley\"</code> to be removed from the list. Here for example the desired answer is:</p>\n\n<pre><code>[([\"Keyhan\",\"ave.\"],[\"Keyhan4\",\"alley\"]),([\"13\",\"number\"],[\"Keyhan4\",\"alley\"])]\n</code></pre>\n\n<p>which means the pair containing <code>\"ave.\"</code> and <code>\"number\"</code> <code>([\"13\",\"number\"],[\"Keyhan\",\"ave.\"])</code> is removed.</p>\n\n<p>I am confused and I really don't know how to write this function. Precisely I don't know how to formalize the condition. I would truly appreciate your help!</p>\n"}, {"tags": ["string", "haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449672636, "post_id": 34176904, "comment_id": 56109734, "body": "Style comment: there&#39;s no need to write <code>something == True</code>, since that is equivalent to simply <code>something</code>. It&#39;s also equivalent to <code>(something == True) == True</code>, but you wouldn&#39;t write that, would you? ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1449659533, "post_id": 34177155, "comment_id": 56101203, "body": "I think your <code>identifier</code> function only checks the first letter of a <code>String</code> and no other - so it would not yield a correct result for &quot;d&#39;Artagnan&quot;. I think you should call <code>isIdentifier</code> recursively or use a <code>fold</code>"}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 3, "last_activity_date": 1449752046, "last_edit_date": 1449752046, "creation_date": 1449658959, "answer_id": 34177155, "question_id": 34176904, "link": "https://stackoverflow.com/questions/34176904/checking-if-a-string-contains-uppercase/34177155#34177155", "title": "Checking if a string contains uppercase", "body": "<blockquote>\n  <p>It should return the exception message when the input contains a uppercase letter. And return the input when it is lowercase or any other character. Can someone maybe suggest a better way of writing this?</p>\n</blockquote>\n\n<ul>\n<li>Avoid functions that throw exceptions and produce side-effects when they can be written <a href=\"https://en.wikipedia.org/wiki/Pure_function\" rel=\"nofollow\">purely</a>.</li>\n<li><code>putStrLn (\"*** Exception: ...\")</code> will not produce an exception. <code>error \"Uppercase\"</code> will.</li>\n</ul>\n\n<p>If your function has the signature <code>String -&gt; String</code>, it cannot</p>\n\n<ul>\n<li>use <code>isUpper</code> on the input, since <code>Data.Char.isUpper :: Char -&gt; Bool</code>, or</li>\n<li>use <code>putStrLn</code> as the output, since <code>System.IO.putStrLn :: String -&gt; IO ()</code>.</li>\n</ul>\n\n<p>If the only criterion for a valid identifier is that it doesn't contain uppercase latters, you could write:</p>\n\n<pre><code>isIdentifier :: String -&gt; Bool\nisIdentifier = not . any isUpper\n</code></pre>\n\n<p>although you probably want to formulate all criteria for valid identifiers as one predicate. That could for example be matching something like <em>[_a-z][_a-zA-Z0-9]+</em>:</p>\n\n<pre><code>isIdentifier :: String -&gt; Bool\nisIdentifier (c:cs) = (c == '_' || isLower c) &amp;&amp; all (\\c -&gt; c == '_' || isAlphaNum c) cs\nisIdentifier \"\" = False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 3, "last_activity_date": 1449659203, "creation_date": 1449659203, "answer_id": 34177249, "question_id": 34176904, "link": "https://stackoverflow.com/questions/34176904/checking-if-a-string-contains-uppercase/34177249#34177249", "title": "Checking if a string contains uppercase", "body": "<p>if you want to include \"normal\" input/output you have to make your function</p>\n\n<pre><code>identifier :: String -&gt; IO String\n</code></pre>\n\n<p>otherwise (even if it is not a good habit to write unsafe functions) I recommend to use <code>error \"*** Exception \u2026\"</code> (if you want to use real exceptions take a look at <code>Control.Except</code> and <code>MonadThrow/MonadCatch</code>.</p>\n\n<p>next - I assume <code>isUpper</code> is imported from <code>Data.Char</code> and only works on characters. I would combine <code>isUpper</code> with the function <code>all</code> that checks if a property (here <code>isUpper</code>) is true for all elements of a list - which can be applied to a <code>String</code> as it is just a synonym for <code>[Char]</code>. I also recommend not checking for upper but lowercase as this is your goal.</p>\n\n<p>so you can have something like</p>\n\n<pre><code>if (all isLower input)\n  then input\n  else error \"i will promise to look at Data.Maybe and Data.Either in the near future\"\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 5585914, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e100737f8425e4b368e321930fc42c7?s=128&d=identicon&r=PG&f=1", "display_name": "bob", "link": "https://stackoverflow.com/users/5585914/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4666, "favorite_count": 1, "accepted_answer_id": 34177249, "answer_count": 2, "score": 0, "last_activity_date": 1450447796, "creation_date": 1449658256, "last_edit_date": 1450447796, "question_id": 34176904, "link": "https://stackoverflow.com/questions/34176904/checking-if-a-string-contains-uppercase", "title": "Checking if a string contains uppercase", "body": "<p>I am new to Haskell and I can't seem to get my code written correctly.</p>\n\n<p>I have tried :</p>\n\n<pre><code>identifier :: String -&gt; String\nidentifier input\n    | isUpper input == True = putStrLn(\"*** Exception: Uppercase\" ++ input)\n    | return input\n</code></pre>\n\n<p>And my latest try was:</p>\n\n<pre><code>identifier :: String -&gt; String\nidentifier input = do\n    if isUpper input == True\n        then putStrLn(\"*** Exception : Uppercase\" ++ input)\n        else return input\n</code></pre>\n\n<p>It should return the exception message when the input contains a uppercase letter.\nAnd return the input when it is lowercase or any other character.\nCan someone maybe suggest a better way of writing this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1449654302, "post_id": 34175173, "comment_id": 56097703, "body": "What do you want to split the list on? Is it, by any chance, a <code>String</code> you want to split on <code>&#39;\\n&#39;</code> or <code>\\s+</code>?"}, {"owner": {"reputation": 3111, "user_id": 2846781, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/66799fb2211ee2618b679c10e96629f6?s=128&d=identicon&r=PG&f=1", "display_name": "TheLeonKing", "link": "https://stackoverflow.com/users/2846781/theleonking"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1449655883, "post_id": 34175173, "comment_id": 56098748, "body": "I&#39;m sorry, I should have been clearer. I would like to split a <code>String</code> on whitespaces."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1449658377, "post_id": 34175173, "comment_id": 56100416, "body": "You do know about cabal or stack, right? \u2014 BTW, it&#39;s also quite easy to split lists with tools from <code>base</code> only..."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1449662933, "post_id": 34175173, "comment_id": 56103220, "body": "@Algorithm_NL: Then this is a <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>. You were actually trying to split a string, but asked about your (non-working) solution."}, {"owner": {"reputation": 3111, "user_id": 2846781, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/66799fb2211ee2618b679c10e96629f6?s=128&d=identicon&r=PG&f=1", "display_name": "TheLeonKing", "link": "https://stackoverflow.com/users/2846781/theleonking"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1449667386, "post_id": 34175173, "comment_id": 56105960, "body": "@Zeta Wow, I didn&#39;t realize that. Thanks for the clarification!"}], "answers": [{"comments": [{"owner": {"reputation": 3111, "user_id": 2846781, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/66799fb2211ee2618b679c10e96629f6?s=128&d=identicon&r=PG&f=1", "display_name": "TheLeonKing", "link": "https://stackoverflow.com/users/2846781/theleonking"}, "edited": false, "score": 0, "creation_date": 1449653796, "post_id": 34175246, "comment_id": 56097344, "body": "Good to know, thanks. Would there be any way to do this without installing packages?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 3111, "user_id": 2846781, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/66799fb2211ee2618b679c10e96629f6?s=128&d=identicon&r=PG&f=1", "display_name": "TheLeonKing", "link": "https://stackoverflow.com/users/2846781/theleonking"}, "edited": false, "score": 0, "creation_date": 1449653844, "post_id": 34175246, "comment_id": 56097377, "body": "but I think it is in the haskell plattform - since ghc-7.8, and even though it is not &quot;safe&quot; for small projects using ghc-7.6 I just copy paste the code in some module to not depend on the whole <code>split</code> package"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 3111, "user_id": 2846781, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/66799fb2211ee2618b679c10e96629f6?s=128&d=identicon&r=PG&f=1", "display_name": "TheLeonKing", "link": "https://stackoverflow.com/users/2846781/theleonking"}, "edited": false, "score": 0, "creation_date": 1449654072, "post_id": 34175246, "comment_id": 56097538, "body": "if you add a <code>split == 0.2.2</code> to your <code>build-depends:</code>-statements it is quite simple to install the package - why would you like to avoid it?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1449654224, "post_id": 34175246, "comment_id": 56097643, "body": "@epsilonhalbe: Maybe he doesn&#39;t even use a <code>.cabal</code> or <code>.yaml</code> file and only wants to write a stand-alone Haskell script for <code>runhaskell</code>."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1449654923, "post_id": 34175246, "comment_id": 56098097, "body": "sometimes I don&#39;t think about the obvious use-cases"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449666800, "post_id": 34175246, "comment_id": 56105576, "body": "@AlgorithmNL, you can generally copy the source code of the bits you need. Different packages on Hackage have different licenses, but they&#39;re all open source."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 10, "last_activity_date": 1449667067, "last_edit_date": 1449667067, "creation_date": 1449653653, "answer_id": 34175246, "question_id": 34175173, "link": "https://stackoverflow.com/questions/34175173/haskell-could-not-find-module-data-list-split/34175246#34175246", "title": "Haskell: Could not find module `Data.List.Split&#39;", "body": "<p><code>Data.List.Split</code> is not in the <a href=\"https://hackage.haskell.org/package/base\" rel=\"noreferrer\">base</a> I think you'll have to install <a href=\"https://hackage.haskell.org/package/split\" rel=\"noreferrer\"><code>split</code></a></p>\n\n<h2>Update</h2>\n\n<p>after the clarification in the comments that only splitting on whitespace is required - use <code>words</code>/<code>lines</code> to your need - see also @Zeta's answer.</p>\n"}, {"comments": [{"owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "edited": false, "score": 0, "creation_date": 1481530992, "post_id": 34178453, "comment_id": 69397720, "body": "How do you split on a given string that is not necessarily whitespace? For example when reading a csv file."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "edited": false, "score": 0, "creation_date": 1481540244, "post_id": 34178453, "comment_id": 69402672, "body": "@user3224967 CSV is a lot more complicate than that, since <code>&quot;</code> breaks delimiter, e.g. <code>Mayer;John;&quot;Department of StackOverflow; Washington&quot;</code> is a record with three, not four fields."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 7, "last_activity_date": 1449662811, "creation_date": 1449662811, "answer_id": 34178453, "question_id": 34175173, "link": "https://stackoverflow.com/questions/34175173/haskell-could-not-find-module-data-list-split/34178453#34178453", "title": "Haskell: Could not find module `Data.List.Split&#39;", "body": "<p>To split a <code>String</code> on arbitrary white space (e.g. any Char <code>c</code> where <code>Data.Char.isSpace c</code> is <code>True</code>), use <code>words</code>:</p>\n\n<pre><code>-- words :: String -&gt; [String]\nghci&gt; words \"Hello World, I'm a string \\n example   \\r\\t with white space\"\n[\"Hello\",\"World,\",\"I'm\",\"a\",\"string\",\"example\",\"with\",\"white\",\"space\"]\n</code></pre>\n\n<p>No need for additional imports, since <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:words\" rel=\"noreferrer\"><code>words</code></a> is part of the <code>Prelude</code>.</p>\n"}], "owner": {"reputation": 3111, "user_id": 2846781, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/66799fb2211ee2618b679c10e96629f6?s=128&d=identicon&r=PG&f=1", "display_name": "TheLeonKing", "link": "https://stackoverflow.com/users/2846781/theleonking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13306, "favorite_count": 0, "accepted_answer_id": 34178453, "answer_count": 2, "score": 10, "last_activity_date": 1479053946, "creation_date": 1449653480, "last_edit_date": 1449653916, "question_id": 34175173, "link": "https://stackoverflow.com/questions/34175173/haskell-could-not-find-module-data-list-split", "title": "Haskell: Could not find module `Data.List.Split&#39;", "body": "<p>I'm trying to split a list in Haskell. As to my knowledge, the easiest way to do this is with <code>splitOn</code>, but this function requires <code>Data.List.Split</code>, so I tried to run <code>import Data.List.Split</code> in Prelude. However, I got the following error:</p>\n\n<p><code>Could not find module Data.List.Split</code></p>\n\n<p>Simply importing <code>Data.List</code> does work, however.</p>\n\n<p>What could I do to solve this? Or, even better: is there an easy, built-in alternative to split lists?</p>\n"}, {"tags": ["haskell", "bits"], "comments": [{"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1449650990, "post_id": 34170620, "comment_id": 56095503, "body": "Why are you in the IO monad in the decoder function? You aren&#39;t even using it. You could just write <code>decoder = go . BS.unpack where go = [...]</code>"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1449665801, "post_id": 34170620, "comment_id": 56104936, "body": "You have given your <code>intsToBits</code> function the type <code>Int -&gt; [Bit]</code>. But this is not the most general type of this function! The most general type is <code>Integral a =&gt; a -&gt; [Bit]</code>. In other words, you&#39;ve already got the function you need, just change the type. With this type,<code>intsToBits</code> will happily accept a <code>Word8</code>. Then you simply have <code>decoder = concatMap intsToBits . unpack</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1916, "user_id": 3457762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0429df5bced7c2317a880821a7cc480e?s=128&d=identicon&r=PG&f=1", "display_name": "astiefel", "link": "https://stackoverflow.com/users/3457762/astiefel"}, "edited": false, "score": 0, "creation_date": 1449635491, "post_id": 34170700, "comment_id": 56088864, "body": "I need to apply this to my own datatype called <code>Bit</code> where each is represented by either <code>One</code> or <code>Zero</code> so how can I do that here?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1916, "user_id": 3457762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0429df5bced7c2317a880821a7cc480e?s=128&d=identicon&r=PG&f=1", "display_name": "astiefel", "link": "https://stackoverflow.com/users/3457762/astiefel"}, "edited": false, "score": 0, "creation_date": 1449635669, "post_id": 34170700, "comment_id": 56088910, "body": "@asyiefel, you&#39;re going to have to show your efforts before I can go further."}, {"owner": {"reputation": 1916, "user_id": 3457762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0429df5bced7c2317a880821a7cc480e?s=128&d=identicon&r=PG&f=1", "display_name": "astiefel", "link": "https://stackoverflow.com/users/3457762/astiefel"}, "edited": false, "score": 0, "creation_date": 1449635785, "post_id": 34170700, "comment_id": 56088948, "body": "I&#39;ve updated the above with a snippet of the code. I can provide all if necessary"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1449637936, "last_edit_date": 1449637936, "creation_date": 1449635149, "answer_id": 34170700, "question_id": 34170620, "link": "https://stackoverflow.com/questions/34170620/haskell-convert-word8-to-int-to-bits/34170700#34170700", "title": "Haskell convert Word8 to Int to Bits", "body": "<p><code>Word8</code> is an instance of the <code>FiniteBits</code> class, so you can use something like</p>\n\n<pre><code>toBitList x = map (testBit x) [0..(finiteBitSize x-1)]\n</code></pre>\n\n<p>Or if you want it the other way around, <code>[(finiteBitSize x-1), (finiteBitSize x-2)..0]</code>.</p>\n\n<hr>\n\n<p>I see from your edit that you (apparently) want your bits in order from most significant to least significant, and you don't want any leading zeros. There are various ways to do this, but the easiest is probably to modify the above approach using <code>countLeadingZeros</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1916, "user_id": 3457762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0429df5bced7c2317a880821a7cc480e?s=128&d=identicon&r=PG&f=1", "display_name": "astiefel", "link": "https://stackoverflow.com/users/3457762/astiefel"}, "edited": false, "score": 0, "creation_date": 1449636466, "post_id": 34170909, "comment_id": 56089152, "body": "It is <code>data Bit = Zero | One</code>. It&#39;s not HW, it&#39;s a project"}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 3, "last_activity_date": 1449636304, "creation_date": 1449636304, "answer_id": 34170909, "question_id": 34170620, "link": "https://stackoverflow.com/questions/34170620/haskell-convert-word8-to-int-to-bits/34170909#34170909", "title": "Haskell convert Word8 to Int to Bits", "body": "<p>Meta on asking questions: You really should give some examples of how you tried to solve the problem.  Shy of that, at least an example of the result you want such as what \"bits\" means to you.   I tend to think of a collection of <code>Word8</code> values as bits and so there is operation to be performed.</p>\n\n<p>That said, lets pose and answer a series of related questions.</p>\n\n<p><strong>What are the bit operators in Haskell?</strong></p>\n\n<p>If you want bit level operations, instead of doing arithmetic tricks like <code>x || 2^i</code> you can use the functions from the Bits class:</p>\n\n<pre><code>Prelude&gt; import Data.Bits\nPrelude Data.Bits&gt; :i Bits\nclass Eq a =&gt; Bits a where\n  (.&amp;.) :: a -&gt; a -&gt; a\n  (.|.) :: a -&gt; a -&gt; a\n  xor :: a -&gt; a -&gt; a\n  complement :: a -&gt; a\n  shift :: a -&gt; Int -&gt; a\n  rotate :: a -&gt; Int -&gt; a\n  zeroBits :: a\n  bit :: Int -&gt; a\n  setBit :: a -&gt; Int -&gt; a\n  clearBit :: a -&gt; Int -&gt; a\n  complementBit :: a -&gt; Int -&gt; a\n  testBit :: a -&gt; Int -&gt; Bool\n  bitSizeMaybe :: a -&gt; Maybe Int\n  bitSize :: a -&gt; Int\n  isSigned :: a -&gt; Bool\n  shiftL :: a -&gt; Int -&gt; a\n  unsafeShiftL :: a -&gt; Int -&gt; a\n  shiftR :: a -&gt; Int -&gt; a\n  unsafeShiftR :: a -&gt; Int -&gt; a\n  rotateL :: a -&gt; Int -&gt; a\n  rotateR :: a -&gt; Int -&gt; a\n  popCount :: a -&gt; Int\n</code></pre>\n\n<p>And also the <code>FiniteBits</code> class:</p>\n\n<pre><code>class Bits b =&gt; FiniteBits b where\n  finiteBitSize      :: b -&gt; Int\n  countLeadingZeros  :: b -&gt; Int\n  countTrailingZeros :: b -&gt; Int\n</code></pre>\n\n<p><strong>How can I convert <code>Word8</code> to <code>[Bool]</code>?</strong></p>\n\n<p>This is simply testing each bit in the word, and b</p>\n\n<pre><code>toBits x = [testBit x i | i &lt;- [0.. finiteBitSize x - 1]\n</code></pre>\n\n<p><strong>How can I convert <code>Word8</code> to some datatype I called <code>Bit</code> that I won't show you?</strong></p>\n\n<p>After your first edit I now think you have <code>data Bit = Zero | One</code> but am unclear if that's correct.  It seems like homework and the advice given here should suffice to get the rest of the way either way.</p>\n"}], "owner": {"reputation": 1916, "user_id": 3457762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0429df5bced7c2317a880821a7cc480e?s=128&d=identicon&r=PG&f=1", "display_name": "astiefel", "link": "https://stackoverflow.com/users/3457762/astiefel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1903, "favorite_count": 3, "accepted_answer_id": 34170909, "answer_count": 2, "score": -3, "last_activity_date": 1449650805, "creation_date": 1449634620, "last_edit_date": 1449650805, "question_id": 34170620, "link": "https://stackoverflow.com/questions/34170620/haskell-convert-word8-to-int-to-bits", "title": "Haskell convert Word8 to Int to Bits", "body": "<p>I want to convert a Word8 to an Int so I can convert it to a list of Bits is there anyway to convert it to either an int or straight to bits?</p>\n\n<p>This is my current snippet of a code</p>\n\n<pre><code>intsToBits :: Int -&gt; [Bit]\nintsToBits x  =\n  reverse (go x) where\n  go 0 = [Zero]\n  go n | n `mod` 2 == 1 = One : go (n `div` 2)\n       | n `mod` 2 == 0 = Zero : go (n `div` 2)\n  go _ = []\n\nword8ToInt :: Word8 -&gt; Int\nword8ToInt = fromIntegral\n\ndecoder :: BS.ByteString -&gt; IO [Bit]\ndecoder raw =\n  do\n     let raw' = BS.unpack raw\n     let ls = go raw'\n     return ls\n       where\n         go []     = []\n         go [x]    = intsToBits $  x\n         go (x:xs) = intsToBits (word8ToInt x) ++ go xs\n</code></pre>\n"}, {"tags": ["haskell", "google-spreadsheet-api", "google-oauth", "http-conduit", "oauth2-playground"], "comments": [{"owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "edited": false, "score": 0, "creation_date": 1449674984, "post_id": 34168668, "comment_id": 56111447, "body": "where did you obtain the auth info you are using from? The error suggests there is a mismatch between authenticating service, authentication type and authentication authority."}, {"owner": {"reputation": 64, "user_id": 795533, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d866546b2ffd5294644288e170c87e48?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya Kumar", "link": "https://stackoverflow.com/users/795533/aditya-kumar"}, "reply_to_user": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "edited": false, "score": 0, "creation_date": 1449688465, "post_id": 34168668, "comment_id": 56120504, "body": "I am able to do http delete and http get operations using the same oauth clientid and clientsecret. The auth info was obtained in a regular way by creating an application in google developer&#39;s console. What do you mean by auth info is it about clientid and client secret?"}, {"owner": {"reputation": 3502, "user_id": 1378888, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/ECGgg.jpg?s=128&g=1", "display_name": "eddyparkinson", "link": "https://stackoverflow.com/users/1378888/eddyparkinson"}, "edited": false, "score": 0, "creation_date": 1449714812, "post_id": 34168668, "comment_id": 56131752, "body": "Curl .. try looking at posts by people using curl <a href=\"http://stackoverflow.com/search?q=%5Bgoogle-spreadsheet-api%5D+curl\">stackoverflow.com/search?q=%5Bgoogle-spreadsheet-api%5D+curl</a> But I have been able to add rows without a problem, so sounds like the url or a parameter is wrong. .. Could you print them and post them here?"}, {"owner": {"reputation": 64, "user_id": 795533, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d866546b2ffd5294644288e170c87e48?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya Kumar", "link": "https://stackoverflow.com/users/795533/aditya-kumar"}, "edited": false, "score": 0, "creation_date": 1449896807, "post_id": 34168668, "comment_id": 56216058, "body": "I have been able to do post using the Google OAuth playground using the url <a href=\"https://spreadsheets.google.com/feeds/list/1hIEq4AAauzI8INelQRIvgxBhmzX44qAB_1QQpFJQ2Xo/od6/private/full\" rel=\"nofollow noreferrer\">spreadsheets.google.com/feeds/list/&hellip;</a> and this is the exact same url I am using in my code. Then I am using an xml library to construct the xml required for adding the row and when I print the string I get the same as I posted above in the main section."}, {"owner": {"reputation": 64, "user_id": 795533, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d866546b2ffd5294644288e170c87e48?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya Kumar", "link": "https://stackoverflow.com/users/795533/aditya-kumar"}, "edited": false, "score": 0, "creation_date": 1455908635, "post_id": 34168668, "comment_id": 58716678, "body": "If authorization information is not passed correctly, google sends back 200. After I identified my mistake and passed authorization token correctly it worked for me."}], "answers": [{"tags": [], "owner": {"reputation": 64, "user_id": 795533, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d866546b2ffd5294644288e170c87e48?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya Kumar", "link": "https://stackoverflow.com/users/795533/aditya-kumar"}, "is_accepted": false, "score": 1, "last_activity_date": 1455908775, "creation_date": 1455908775, "answer_id": 35513032, "question_id": 34168668, "link": "https://stackoverflow.com/questions/34168668/post-request-to-google-sheets-api-using-http-conduit-in-haskell/35513032#35513032", "title": "Post request to Google sheets API using http-conduit in Haskell", "body": "<p>If authorization information is not passed correctly, google sheets API server sends back 200. After I identified my mistake and passed authorization token correctly it worked for me.\nIt is weird why google sends back 200 OK though.</p>\n"}], "owner": {"reputation": 64, "user_id": 795533, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d866546b2ffd5294644288e170c87e48?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya Kumar", "link": "https://stackoverflow.com/users/795533/aditya-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1455908775, "creation_date": 1449620638, "question_id": 34168668, "link": "https://stackoverflow.com/questions/34168668/post-request-to-google-sheets-api-using-http-conduit-in-haskell", "title": "Post request to Google sheets API using http-conduit in Haskell", "body": "<p>I am trying to create a post request to spreadsheets API using http-conduit.\nUnfortunately the post request does not work and the google sheets server does not provide any feedback as to what I am doing wrong in my request.</p>\n\n<p>I am using <a href=\"https://developers.google.com/google-apps/spreadsheets/\" rel=\"nofollow\">https://developers.google.com/google-apps/spreadsheets/</a> to create a POST request to add a new row to my spreadsheet.</p>\n\n<p>The code I wrote is:</p>\n\n<pre><code>import Network.HTTP.Conduit\nimport Network.HTTP.Types (hAuthorization)\nimport Network.Google.OAuth2\nimport qualified Data.ByteString.Char8 as B8\nimport qualified Data.ByteString.Builder as B\nimport qualified Data.ByteString.Lazy as L\n\nscopes = [\"https://spreadsheets.google.com/feeds\"]\n\ncreateToken client = getAccessToken client scopes (Just \"./key.txt\")\n\nauthorize token request = request\n  { requestHeaders = [(hAuthorization, B8.pack $ \"Bearer \" ++ token)] }\n\n-- post::String -&gt; OAuth2Client -&gt;String -&gt; IO Status\npost url client postData = do\n  print \"inside post request\"\n  token &lt;- createToken client\n  request &lt;- parseUrl url\n  -- $ \"&lt;?xml version='1.0' encoding='utf-8'?&gt;\" ++\n  let pd = B.toLazyByteString $ B.string7  postData\n  let req = request{\n                method = \"POST\"\n              , requestHeaders = [(\"Content-Type\", \"application/atom+xml\"),\n                                  (\"Content-Length\",B8.pack $ show $ length postData)]\n              , requestBody = RequestBodyLBS pd\n              }\n  let postReq = authorize token postReq\n  res &lt;- withManager $ httpLbs req\n  print  res\n  return $ responseStatus  res\n</code></pre>\n\n<p>now when I am calling post with correct url and string data </p>\n\n<pre><code>   &lt;entry xmlns=\"http://www.w3.org/2005/Atom\"\n       xmlns:gsx=\"http://schemas.google.com/spreadsheets/2006/extended\"&gt;\n      &lt;gsx:name&gt;Pork&lt;/gsx:name&gt;\n      &lt;gsx:category&gt;meat&lt;/gsx:category&gt;\n      &lt;gsx:healthiness&gt;questionable&lt;/gsx:healthiness&gt;\n      &lt;gsx:type&gt;2&lt;/gsx:type&gt;\n   &lt;/entry&gt;\n</code></pre>\n\n<p>I get a response of :</p>\n\n<pre><code>  Response {responseStatus = Status {statusCode = 200, statusMessage = \"OK\"},    responseVersion = HTTP/1.1, responseHeaders = [(\"Content-      Type\",\"application/binary\"),(\"X-Robots-Tag\",\"noindex, nofollow, nosnippet\"),(\"P3P\",\"CP=\\\"This is not a P3P policy! See https://support.google.com/accounts/answer/151657?hl=en for more info.\\\"\"),(\"P3P\",\"CP=\\\"This is not a P3P policy! See https://support.google.com/accounts/answer/151657?hl=en for more info.\\\"\"),(\"Date\",\"Tue, 08 Dec 2015 23:52:23 GMT\"),(\"Expires\",\"Tue, 08 Dec 2015 23:52:23 GMT\"),(\"Cache-Control\",\"private, max-age=0\"),(\"X-Content-Type-Options\",\"nosniff\"),(\"X-Frame-Options\",\"SAMEORIGIN\"),(\"X-XSS-Protection\",\"1; mode=block\"),(\"Content-Length\",\"0\"),(\"Server\",\"GSE\"),(\"Set-Cookie\",\"NID=74=CW9_VUnww09KLa-geN3Oxz2Zdh17ognD-Lw3rsXDRUkdOeaiOOKGM4ZBqPXPlp6yxvApu5yqttLjgpqesV1SP4qsza1ZW6ompUGznQqNmVcU2dmyzWebeY8D-NZUijLI;Domain=.google.com;Path=/;Expires=Wed, 08-Jun-2016 23:52:23 GMT;HttpOnly\"),(\"Set-Cookie\",\"NID=74=o-ILV0SQxX_i8EZDtP1jfCU5McNvdDc9FSuZ6FO8ZwQBrFuLg9oxiNtNAnxBKVubB0C4vL2n8LW5NBQMcmpXMvmaYcO0wZbRs4AxpQ96GFPfz5-y9KRZwJ86m8XIjK46;Domain=.google.com;Path=/;Expires=Wed, 08-Jun-2016 23:52:23 GMT;HttpOnly\"),(\"Alternate-Protocol\",\"443:quic,p=0\"),(\"Alt-Svc\",\"clear\")], responseBody = \"\", responseCookieJar = CJ {expose = [Cookie {cookie_name = \"NID\", cookie_value = \"74=o-ILV0SQxX_i8EZDtP1jfCU5McNvdDc9FSuZ6FO8ZwQBrFuLg9oxiNtNAnxBKVubB0C4vL2n8LW5NBQMcmpXMvmaYcO0wZbRs4AxpQ96GFPfz5-y9KRZwJ86m8XIjK46\", cookie_expiry_time = 2016-06-08 23:52:23 UTC, cookie_domain = \"google.com\", cookie_path = \"/\", cookie_creation_time = 2015-12-08 23:52:25.6609874 UTC, cookie_last_access_time = 2015-12-08 23:52:25.6609874 UTC, cookie_persistent = True, cookie_host_only = False, cookie_secure_only = False, cookie_http_only = True}]}, responseClose' = ResponseClose}\n</code></pre>\n\n<p>But the OAuth-Playground gives me:</p>\n\n<pre><code>   HTTP/1.1 201 Created\n   Alternate-protocol: 443:quic,p=0\n   Content-length: 1048\n   X-xss-protection: 1; mode=block\n   X-robots-tag: noindex, nofollow, nosnippet\n   X-content-type-options: nosniff\n   Gdata-version: 1.0\n   Transfer-encoding: chunked\n   Set-cookie: NID=74=fuRYIEz3fRhSSdeqgNf9nCOi3IDTxo5I2FBkhv94fb5RqTRs-B5CXExV7ot9_vsDYryi8AvWJWoF1MXj-7syryXXzzfERwAskFQ5T1WA0Rzvi6xjIvsoLWRbvqbI08AF;Domain=.google.com;Path=/;Expires   =Wed, 08-Jun-2016 23:25:55 GMT;HttpOnly,    NID=74=nm8Q6cWmCmjvaoJgzXBMrg5w9QJzelMfloleHmIkjNw06jI-kMG8U2NyHdb0O3McHFHtCz4IbIAvfJtCD-EWxw25vmyGyGnBCgnsQqUw8GBc09oe7lyoSeXE7LjQQOKv;Domain=.google.com;Path=/;Expires=Wed, 08-Jun-2016 23:25:55 GMT;HttpOnly\n   Expires: Tue, 08 Dec 2015 23:25:55 GMT\n   Vary: Accept, X-GData-Authorization, GData-Version\n   Server: GSE\n   -content-encoding: gzip\n   Location: https://spreadsheets.google.com/feeds/list/1hIEq4AAauzI8INelQRIvgxBhmzX44qAB_1QQpFJQ2Xo/od6/private/full/cyevm/246h23pn1mc9h0\n   Cache-control: private, max-age=0, must-revalidate, no-transform\n   Date: Tue, 08 Dec 2015 23:25:55 GMT\n   P3p: CP=\"This is not a P3P policy! See https://support.google.com/accounts/answer/151657?hl=en for more info.\",    CP=\"This is not a P3P policy! See https://support.google.com/accounts/answer/151657?hl=en for more info.\"\n   Alt-svc: clear\n   Content-type: application/atom+xml; charset=UTF-8\n   X-frame-options: SAMEORIGIN\n   Content-location: https://spreadsheets.google.com/feeds/list/1hIEq4AAauzI8INelQRIvgxBhmzX44qAB_1QQpFJQ2Xo/od6/private/full/cyevm/246h23pn1mc9h0\n   &lt;?xml version='1.0' encoding='UTF-8'?&gt;\n   &lt;entry xmlns='http://www.w3.org/2005/Atom' xmlns:gsx='http://schemas.google.com/spreadsheets/2006/extended'&gt;\n   &lt;id&gt;https://spreadsheets.google.com/feeds/list/1hIEq4AAauzI8INelQRIvgxBhmzX44qAB_1QQpFJQ2Xo/od6/private/full/cyevm&lt;/id&gt;\n   &lt;updated&gt;2015-12-06T01:22:19.799Z&lt;/updated&gt;\n   &lt;category scheme='http://schemas.google.com/spreadsheets/2006' term='http://schemas.google.com/spreadsheets/2006#list'/&gt;\n   &lt;title type='text'&gt;Pork&lt;/title&gt;\n   &lt;content type='text'&gt;category: meat, healthiness: questionable, type: 2&lt;/content&gt;\n   &lt;link rel='self' type='application/atom+xml' href='https://spreadsheets.google.com/feeds/list/1hIEq4AAauzI8INelQRIvgxBhmzX44qAB_1QQpFJQ2Xo/od6/private/full/cyevm'/&gt;\n   &lt;link rel='edit' type='application/atom+xml' href='https://spreadsheets.google.com/feeds/list/1hIEq4AAauzI8INelQRIvgxBhmzX44qAB_1QQpFJQ2Xo/od6/private/full/cyevm/246h23pn1mc9h0'/&gt;\n   &lt;gsx:name&gt;Pork&lt;/gsx:name&gt;\n   &lt;gsx:category&gt;meat&lt;/gsx:category&gt;\n   &lt;gsx:healthiness&gt;questionable&lt;/gsx:healthiness&gt;\n   &lt;gsx:type&gt;2&lt;/gsx:type&gt;\n   &lt;/entry&gt;\n</code></pre>\n\n<p>Can someone please let me know what is wrong?\nThanks in advance.</p>\n"}, {"tags": ["haskell", "io", "monads", "ghci", "hunit"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1449620254, "post_id": 34168538, "comment_id": 56084557, "body": "Well, types are good unit tests to start with!  Try <code>return (z == a &amp;&amp; b == y)</code>."}, {"owner": {"reputation": 1916, "user_id": 3457762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0429df5bced7c2317a880821a7cc480e?s=128&d=identicon&r=PG&f=1", "display_name": "astiefel", "link": "https://stackoverflow.com/users/3457762/astiefel"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1449621492, "post_id": 34168538, "comment_id": 56084952, "body": "Is there a way to wrap that in an hunit test?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1449623548, "post_id": 34168538, "comment_id": 56085562, "body": "@astiefel An HUnit <code>Assertion</code> is just an <code>IO ()</code> so yes you can. The correct thing would probably be to do <code>assertEqual &quot;...&quot; z a; assertEqual &quot;...&quot; b y</code> - this way you can give reasons for why these must be equal and when your test fails you will have an easier time figuring out why."}], "answers": [{"tags": [], "owner": {"reputation": 2719, "user_id": 241294, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n6ka1.png?s=128&g=1", "display_name": "poida", "link": "https://stackoverflow.com/users/241294/poida"}, "is_accepted": true, "score": 1, "last_activity_date": 1449656269, "last_edit_date": 1449656269, "creation_date": 1449655704, "answer_id": 34176020, "question_id": 34168538, "link": "https://stackoverflow.com/questions/34168538/haskell-unit-tests-using-io-monad/34176020#34176020", "title": "Haskell Unit tests using IO monad", "body": "<p>Like what @user2407038 said in the comments and as mentioned in the <a href=\"https://wiki.haskell.org/HUnit_1.0_User&#39;s_Guide#Assertions\" rel=\"nofollow\">HUnit user manual</a> HUnit tests run in the <a href=\"https://hackage.haskell.org/package/HUnit-1.3.0.0/docs/Test-HUnit-Base.html#t:Assertion\" rel=\"nofollow\">IO monad</a>.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>testFilesEqual = TestCase (do x &lt;- readFile \"a.txt\"\n                              y &lt;- readFile \"b.txt\"\n                              assertEqual \"files not equal\" x y)\n# a.txt == b.txt\n\u03bb&gt; runTestTT testFilesEqual\nCases: 1  Tried: 0  Errors: 0  Failures: 0\nCounts {cases = 1, tried = 1, errors = 0, failures = 0}\n\n# a.txt != b.txt\n\u03bb&gt; runTestTT testFilesEqual\n### Failure:\nfiles not equal\nexpected: \"hello\\n\"\nbut got: \"world\\n\"\nCases: 1  Tried: 1  Errors: 0  Failures: 1\nCounts {cases = 1, tried = 1, errors = 0, failures = 1}\n</code></pre>\n"}], "owner": {"reputation": 1916, "user_id": 3457762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0429df5bced7c2317a880821a7cc480e?s=128&d=identicon&r=PG&f=1", "display_name": "astiefel", "link": "https://stackoverflow.com/users/3457762/astiefel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 2, "accepted_answer_id": 34176020, "answer_count": 1, "score": 4, "last_activity_date": 1449656269, "creation_date": 1449619900, "question_id": 34168538, "link": "https://stackoverflow.com/questions/34168538/haskell-unit-tests-using-io-monad", "title": "Haskell Unit tests using IO monad", "body": "<p>I am trying to write HUnit tests for haskell functions that return IO monads because they perform file I/O. Is there any way to do this? Right now I am trying to write a method that just returns a Bool and that can be my test</p>\n\n<pre><code>combine :: FilePath -&gt; FilePath -&gt; Bool\ncombine fp1 fp2 = do\n  cs &lt;- readFile fp1\n  let (_,y,z) = strToHuff cs\n  let _ = writeToFile fp2 z y\n  (a, b) &lt;- readFromFile fp2\n  z == a &amp;&amp; b == y\n</code></pre>\n\n<p>but that gives me the following error:</p>\n\n<pre><code>FileWriter.hs:153:3: Couldn't match type \u2018IO b0\u2019 with \u2018Bool\u2019 \u2026\n    Expected type: IO String -&gt; (String -&gt; IO b0) -&gt; Bool\n      Actual type: IO String -&gt; (String -&gt; IO b0) -&gt; IO b0\n    In a stmt of a 'do' block: cs &lt;- readFile fp1\n    In the expression:\n      do { cs &lt;- readFile fp1;\n           let (_, y, z) = strToHuff cs;\n           let _ = writeToFile \"try1.txt\" z y;\n           (a, b) &lt;- readFromFile fp2;\n           .... }\n    In an equation for \u2018combine\u2019:\n        combine fp1 fp2\n          = do { cs &lt;- readFile fp1;\n                 let (_, y, z) = ...;\n                 let _ = ...;\n                 .... }\nFileWriter.hs:157:3: Couldn't match expected type \u2018IO b0\u2019 with actual type \u2018Bool\u2019 \u2026\n    In a stmt of a 'do' block: z == a &amp;&amp; b == y\n    In the expression:\n      do { cs &lt;- readFile fp1;\n           let (_, y, z) = strToHuff cs;\n           let _ = writeToFile \"try1.txt\" z y;\n           (a, b) &lt;- readFromFile fp2;\n           .... }\n    In an equation for \u2018combine\u2019:\n        combine fp1 fp2\n          = do { cs &lt;- readFile fp1;\n                 let (_, y, z) = ...;\n                 let _ = ...;\n                 .... }\nCompilation failed.\n</code></pre>\n"}, {"tags": ["list", "function", "haskell", "input", "winghci"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 4, "creation_date": 1449619612, "post_id": 34168477, "comment_id": 56084348, "body": "Check out <code>zipWith</code> and <code>cycle</code>."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1449619814, "post_id": 34168477, "comment_id": 56084417, "body": "See <a href=\"http://stackoverflow.com/questions/17383169/haskell-double-every-2nd-element-in-list/17383354#17383354\" title=\"haskell double every 2nd element in list\">stackoverflow.com/questions/17383169/&hellip;</a>"}, {"owner": {"reputation": 187, "user_id": 3273373, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/WNvGu.jpg?s=128&g=1", "display_name": "T-Bird", "link": "https://stackoverflow.com/users/3273373/t-bird"}, "edited": false, "score": 1, "creation_date": 1449619831, "post_id": 34168477, "comment_id": 56084424, "body": "I&#39;m trying not to use library functions, and I don&#39;t see how zipWith would help..."}, {"owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "edited": false, "score": 0, "creation_date": 1449620692, "post_id": 34168477, "comment_id": 56084705, "body": "Why not use library functions?"}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1449624289, "post_id": 34168477, "comment_id": 56085777, "body": "@T-Bird: Avoiding library functions is not a good idea. Good functional programming style involves splitting problems into smaller pieces and solving these with generic, reusable functions as the ones found in the standard libraries. So the best strategy is to (a) use standard library functions to solve your problem, and then (b) write your own versions of the functions as an additional exercise. And this is a recursive solution, since you may use other library functions in step (b)..."}], "answers": [{"comments": [{"owner": {"reputation": 336, "user_id": 5657031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQu61dwt0vc/AAAAAAAAAAI/AAAAAAAAAY0/ki0tUEoS0pU/photo.jpg?sz=128", "display_name": "Michael Szvetits", "link": "https://stackoverflow.com/users/5657031/michael-szvetits"}, "edited": false, "score": 1, "creation_date": 1455900100, "post_id": 34168701, "comment_id": 58711628, "body": "The goal was to avoid library functions, for unknown reasons."}], "tags": [], "owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "is_accepted": false, "score": -2, "last_activity_date": 1455542730, "last_edit_date": 1455542730, "creation_date": 1449620829, "answer_id": 34168701, "question_id": 34168477, "link": "https://stackoverflow.com/questions/34168477/haskell-function-that-alternatively-applies-input-unary-functions/34168701#34168701", "title": "Haskell function that alternatively applies input unary functions", "body": "<p>Just a simple solution...</p>\n\n<pre><code>fun :: (a -&gt; b) -&gt; (a -&gt; b) -&gt; [a] -&gt; [b]\nfun f g = reverse . snd . foldl step (0,[])\n          where\n             step (c,ac) x = (c + 1, (if even c then f x else g x) : ac)\n</code></pre>\n\n<p>Since you do not want to use library functions, you can reproduce the same result without using <code>foldl</code>. The idea is simple to use a counter to know which position is even or not.</p>\n\n<p><strong>Edit:</strong> I've made a little confusion on my accumulator. Now, it is correct.</p>\n"}, {"comments": [{"owner": {"reputation": 926, "user_id": 6174476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rnHQ.jpg?s=128&g=1", "display_name": "Alberto Schiabel", "link": "https://stackoverflow.com/users/6174476/alberto-schiabel"}, "edited": false, "score": 0, "creation_date": 1581242826, "post_id": 34168873, "comment_id": 106359006, "body": "Notice that in this case you can also use <code>id</code> in place of <code>($)</code>, which probably makes it easier to read."}, {"owner": {"reputation": 926, "user_id": 6174476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rnHQ.jpg?s=128&g=1", "display_name": "Alberto Schiabel", "link": "https://stackoverflow.com/users/6174476/alberto-schiabel"}, "edited": false, "score": 0, "creation_date": 1581242888, "post_id": 34168873, "comment_id": 106359026, "body": "Moreover, you can drop <code>l</code> altogether (making it an implicit parameter) to obtain a terser expression."}], "tags": [], "owner": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "is_accepted": false, "score": 2, "last_activity_date": 1449622050, "creation_date": 1449622050, "answer_id": 34168873, "question_id": 34168477, "link": "https://stackoverflow.com/questions/34168477/haskell-function-that-alternatively-applies-input-unary-functions/34168873#34168873", "title": "Haskell function that alternatively applies input unary functions", "body": "<p>Expanding on @luqui's comment:</p>\n\n<pre><code>func f1 f2 l = zipWith ($) (cycle [f1, f2]) l\n</code></pre>\n\n<p>If you don't want to use library functions, just look up their implementations, they're quite simple.</p>\n"}, {"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1449667293, "post_id": 34169215, "comment_id": 56105904, "body": "As a one-liner: <code>interMap f g xs = foldr (\\x r f g -&gt; f x : r g f) (\\_ _ -&gt; []) xs f g</code>."}], "tags": [], "owner": {"reputation": 336, "user_id": 5657031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQu61dwt0vc/AAAAAAAAAAI/AAAAAAAAAY0/ki0tUEoS0pU/photo.jpg?sz=128", "display_name": "Michael Szvetits", "link": "https://stackoverflow.com/users/5657031/michael-szvetits"}, "is_accepted": true, "score": 6, "last_activity_date": 1449624546, "creation_date": 1449624546, "answer_id": 34169215, "question_id": 34168477, "link": "https://stackoverflow.com/questions/34168477/haskell-function-that-alternatively-applies-input-unary-functions/34169215#34169215", "title": "Haskell function that alternatively applies input unary functions", "body": "<p>If you don't want to use any library functions, you can do this by using recursion:</p>\n\n<pre><code>func _ _ []     = []\nfunc f g (x:xs) = f x : func g f xs\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 3273373, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/WNvGu.jpg?s=128&g=1", "display_name": "T-Bird", "link": "https://stackoverflow.com/users/3273373/t-bird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 1, "accepted_answer_id": 34169215, "answer_count": 3, "score": 2, "last_activity_date": 1455542730, "creation_date": 1449619570, "question_id": 34168477, "link": "https://stackoverflow.com/questions/34168477/haskell-function-that-alternatively-applies-input-unary-functions", "title": "Haskell function that alternatively applies input unary functions", "body": "<p>I am trying to write a Haskell function that takes two unary functions (f and g) and a list of numbers (ns) and alternatively applies those input functions f and g to the elements of the inputted list.</p>\n\n<p>For example:</p>\n\n<pre><code>func double square [2, 3, 4, 5, 6]\n</code></pre>\n\n<p>would return</p>\n\n<pre><code>[4, 9, 8, 25, 12]\n</code></pre>\n\n<p>I am using WinGHCi for my compiler. Any help on writing this function would be appreciated, thanks.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1449609796, "post_id": 34165978, "comment_id": 56079814, "body": "It looks like your teacher is trying to get you used to the way <code>do</code> notation translates into applications of <code>&gt;&gt;=</code>. Try running a simple function like <code>\\x -&gt; Just (x + 1)</code> and a test list like <code>[1,2,3]</code> through your various <code>mapM</code> functions and look at the outputs. (Hint: one of the implementations is incorrect!)"}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1449617206, "creation_date": 1449617206, "answer_id": 34168055, "question_id": 34165978, "link": "https://stackoverflow.com/questions/34165978/haskell-test-different-implementations-of-mapm/34168055#34168055", "title": "Haskell test different implementations of mapM", "body": "<p>One class of monads you may find useful in your testing are the <a href=\"https://hackage.haskell.org/package/free/docs/Control-Monad-Free.html\" rel=\"nofollow\"><em>free monads</em></a> over various functors. Free monads tend to be particularly sensitive to any mistakes you may make in your implementation. You can use any reasonably flexible base functor, such as <code>[]</code>, for your tests.</p>\n\n<pre><code>data Free f a = Pure a\n              | Free (f (Free f a))\n\ninstance Functor f =&gt; Functor (Free f) where\n  fmap f (Pure a) = Pure (f a)\n  fmap f (Free xs) = Free (fmap (fmap f) xs)\n\ninstance Functor f =&gt; Applicative (Free f) where\n  pure = Pure\n  (&lt;*&gt;) = ap\n\ninstance Functor f =&gt; Monad (Free f) where\n  Pure x &gt;&gt;= f = f x\n  Free xs &gt;&gt;= f = Free (fmap (&gt;&gt;= f) xs)\n\ninstance (Eq (f (Free f a)), Eq a) =&gt; Eq (Free f a) where\n  Pure a == Pure b = a == b\n  Free fa == Free fb = fa == fb\n  _ == _ = False\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5647834, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c8f1682c67b6bb6f529ae2a9a2579157?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/5647834/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1449617206, "creation_date": 1449608671, "question_id": 34165978, "link": "https://stackoverflow.com/questions/34165978/haskell-test-different-implementations-of-mapm", "title": "Haskell test different implementations of mapM", "body": "<p>I have implemented sequence' :: Monad m => [m a] -> m [a] below</p>\n\n<pre><code>sequence' [] = return []\nsequence' (m : ms)\n  = m &gt;&gt;=\n      \\ a -&gt;\n        do as &lt;- sequence' ms\n           return (a : as)\n</code></pre>\n\n<p>I need to test following implementations of \nmapM' :: Monad m => (a -> m b) -> [a] -> m [b] </p>\n\n<pre><code>mapM'a f as = sequence' (map f as)\n\nmapM'b f [] = return []\nmapM'b f (a : as)\n  = f a &gt;&gt;= \\b -&gt; mapM'b f as &gt;&gt;= \\ bs -&gt; return (b : bs)\n\nmapM'f f [] = return []\nmapM'f f (a : as) =\n    do b &lt;- f a\n       bs &lt;- mapM'f f as\n       return (b : bs)\n\nmapM'g f [] = return []\nmapM'g f (a : as)\n  = f a &gt;&gt;=\n      \\ b -&gt;\n        do bs &lt;- mapM'g f as\n           return (b : bs)\n\nmapM'h f [] = return []\nmapM'h f (a : as)\n  = f a &gt;&gt;=\n      \\ b -&gt;\n      do bs &lt;- mapM'h f as\n         return (bs ++ [b])\n</code></pre>\n\n<p>Please let me know how do I test and verify above implementations of mapM - which functions I should call.\nSome examples will be very useful.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "types", "parsec", "hindley-milner"], "answers": [{"comments": [{"owner": {"reputation": 1596, "user_id": 5483583, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/58e00258c68a02aeb27dd3bb73728821?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian Schmitthenner", "link": "https://stackoverflow.com/users/5483583/fabian-schmitthenner"}, "edited": false, "score": 0, "creation_date": 1449608980, "post_id": 34165974, "comment_id": 56079360, "body": "you have to replace <code>a</code> with the appropriate type of cause (or use _ when using PartialTypeSigs)"}], "tags": [], "owner": {"reputation": 1596, "user_id": 5483583, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/58e00258c68a02aeb27dd3bb73728821?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian Schmitthenner", "link": "https://stackoverflow.com/users/5483583/fabian-schmitthenner"}, "is_accepted": false, "score": 1, "last_activity_date": 1449608664, "creation_date": 1449608664, "answer_id": 34165974, "question_id": 34165691, "link": "https://stackoverflow.com/questions/34165691/haskell-parsec-commenting-out-parsefromfile-call-leads-to-ambiguous-types/34165974#34165974", "title": "Haskell / Parsec - commenting out parseFromFile call leads to ambiguous types", "body": "<p><code>parseFromFile</code> has type</p>\n\n<pre><code>parseFromFile :: Text.Parsec.String.Parser a -&gt; String -&gt; IO (Either Text.Parsec.Error.ParseError a)\n</code></pre>\n\n<p>So adding a type annotation to <code>parserCode</code> should solve the issue:</p>\n\n<pre><code>parserCode :: Text.Parsec.String.Parser a\n</code></pre>\n\n<p>This is not as general as it could be now (we might want to use <code>Text.Parsec.ByteString.parseFromFile</code> as well for example).\nFor that case, we can probably use something like</p>\n\n<pre><code>parserCode :: Stream s Identity Char =&gt; Parsec s () a\n</code></pre>\n"}], "owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449970269, "creation_date": 1449607513, "last_edit_date": 1449970269, "question_id": 34165691, "link": "https://stackoverflow.com/questions/34165691/haskell-parsec-commenting-out-parsefromfile-call-leads-to-ambiguous-types", "title": "Haskell / Parsec - commenting out parseFromFile call leads to ambiguous types", "body": "<p>I'm working on some parsec code. At the bottom of the script, there's a parseFromFile call, where ParseFromFile comes from Text.Parsec.String</p>\n\n<pre><code>parseFromFile parserCode inFile\n</code></pre>\n\n<p>If I comment this out, my code no longer compiles and I get a host of ambiguous type errors:</p>\n\n<pre><code>DeleteMe.hs:47:18-23: No instance for (Stream s0 Data.Functor.Identity.Identity Char) \u2026\n      arising from a use of \u2018noneOf\u2019\n    The type variable \u2018s0\u2019 is ambiguous\n    Relevant bindings include\n      parseSeq :: ParsecT s0 u Data.Functor.Identity.Identity [Char]...\n</code></pre>\n\n<p>with ambiguities like between the strict and lazy forms of streams:</p>\n\n<pre><code>Note: there are several potential instances:\n  instance Monad m =&gt;\n           Stream Data.ByteString.Internal.ByteString m Char\n    -- Defined in \u2018Text.Parsec.Prim\u2019\n  instance Monad m =&gt;\n           Stream Data.ByteString.Lazy.Internal.ByteString m Char\n    -- Defined in \u2018Text.Parsec.Prim\u2019\n  instance Monad m =&gt; Stream Text m Char\n    -- Defined in \u2018Text.Parsec.Prim\u2019\n</code></pre>\n\n<p>parseFromFile must be disambiguating the type inference. What's the right way to resolve this ambiguity? Including the parseFromFile call will get it to compile, but I don't want to have to have to call it for that purpose. I could type annotate all combinator code, but that's messy.</p>\n"}, {"tags": ["haskell", "optimization"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449606493, "post_id": 34164793, "comment_id": 56077857, "body": "The poor performance is likely due to the fact that the implementation of <code>replicateM</code> is slow (O(n^2)) so your code is actually running slower than O(t*m). See <a href=\"http://www.haskellforall.com/2013/03/pipes-32-listt-codensity-arrowchoice.html\" rel=\"nofollow noreferrer\">here</a> and <a href=\"http://blog.ezyang.com/2012/01/problem-set-the-codensity-transformation/\" rel=\"nofollow noreferrer\">here</a> for improving the asymptotic performance of certain computations. You do the majority of your work in IO, not with conduit - you should run the conduit at the very last moment. Also some things are suspicious.. like <code>seq () x</code> - what is that supposed to do?"}, {"owner": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449606842, "post_id": 34164793, "comment_id": 56078063, "body": "@user2407038 seq is not strictly necessary (haha pun), I just wanted to avoid building up a thunk since I only increment the counter, and never do anything else with it. But I&#39;ll definitely read the links you sent me!"}, {"owner": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449608277, "post_id": 34164793, "comment_id": 56078937, "body": "@user2407038 and how would I conduit at the last moment? Since IO has to be on the bottom of the monad transformer stack, it seems like I have to run conduit first ..."}], "owner": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1449604950, "creation_date": 1449604326, "last_edit_date": 1449604950, "question_id": 34164793, "link": "https://stackoverflow.com/questions/34164793/optimize-this-bit-of-conduit-code-for-speed", "title": "Optimize this bit of conduit code for speed", "body": "<p>I am implementing an approximate counting algorithm where we:</p>\n\n<p>Maintain t counters {X<sub><em>1</em></sub>,..., X<sub><em>t</em></sub>} using log (log <em>n</em>) bits for each</p>\n\n<ul>\n<li><p>Initialize all counters to 0</p></li>\n<li><p>When an item arrives, increase each X<sub><em>i</em></sub> by 1 independently with probability (&frac12;)<sup>X<sub><em>i</em></sub></sup></p></li>\n<li><p>When the stream is over, output Z =  1/t (2<sup>X<sub><em>1</em></sub></sup> &minus; 1 + ... + 2<sup>X<sub><em>t</em></sub></sup> &minus; 1) </p></li>\n<li><p>repeat the above steps m times independently and in parallel and output the median.</p></li>\n</ul>\n\n<p>Here it is in haskell, using the conduit library. </p>\n\n<pre><code>import Data.Random\nimport Data.Conduit\nimport Data.List\nimport Data.Ord (comparing)\nimport qualified Data.Conduit.List as Cl\n\nimport Control.Monad.Identity\n\n\ntype Prob    = Double\ntype Counter = Float\ntype Delta   = Double\ntype Eps     = Double\n\n\n-- * Run Morris alpha on stream inputs `xs`\nmorrisA :: [a] -&gt; IO Counter\nmorrisA xs = flip runRVar StdRandom $ Cl.sourceList xs $$ alpha\n\n-- * Run Morris beta on stream inputs `xs` for `t` independent trials and average\nmorrisB :: Int -&gt; [a] -&gt; IO Counter\nmorrisB t =  fmap rmean . replicateM t . morrisA\n\n-- * final morris algorithm\n-- * Run on stream inputs `xs` for t independent trials for `t = 1/eps`, \n-- * and `m` times in parralell, for `m = 1/(e^2 * d)`\n-- * and take the median\n\nmorris :: Eps -&gt; Delta -&gt; [a] -&gt; IO Counter\nmorris e d = fmap rmedian . replicateM m . morrisB t \n  where (t,m) = (round $ 1/(e^2*d), round $ 1/d)\n\n-- * Utils * -- \n\n-- * A step in morris Algorithm alpha\nalpha :: Sink a RVar Counter\nalpha = (\\x -&gt; 2^(round x) - 1) &lt;$&gt; Cl.foldM (\\x _ -&gt; incr x) 0\n\n-- * Increment a counter `x` with probability 1/2^x\nincr :: Counter -&gt; RVar Counter\nincr x = do\n  h &lt;- (\\q -&gt; q &lt;= (0.5^(round x) :: Prob)) &lt;$&gt; uniform 0 1\n  return $ if h then (seq () succ x) else seq () x\n\nrmean, rmedian :: (Floating a, Ord a, RealFrac a) =&gt; [a] -&gt; Float\nrmean   = fromIntegral . round . mean\nrmedian = fromIntegral . round . median\n\n-- |Numerically stable mean\nmean :: Floating a =&gt; [a] -&gt; a\nmean x = fst $ foldl' (\\(!m, !n) x -&gt; (m+(x-m)/(n+1),n+1)) (0,0) x\n\n-- |Median\nmedian :: (Floating a, Ord a) =&gt; [a] -&gt; a\nmedian x | odd n  = head  $ drop (n `div` 2) x'\n         | even n = mean $ take 2 $ drop i x'\n                  where i = (length x' `div` 2) - 1\n                        x' = sort x\n                        n  = length x\n</code></pre>\n\n<p>The problem is that runtime of <code>morris</code> is linear in both length of stream and number of iterations <code>t*m</code>. So eg <code>morrisA</code> takes about 100\u03bcs for 100 items. Now if we want to be 95% confident of 5% error, we have to run <code>morris</code> for <code>n=160000</code> times. </p>\n\n<p>Could someone suggest how to optimize this code? maybe:</p>\n\n<ol>\n<li><p>implement morris in something other than conduit</p></li>\n<li><p>some faster way to repeat <code>morrisA</code> other than <code>replicateM</code>.</p></li>\n</ol>\n"}, {"tags": ["haskell", "getopt"], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 4, "last_activity_date": 1449604097, "creation_date": 1449604097, "answer_id": 34164725, "question_id": 34164599, "link": "https://stackoverflow.com/questions/34164599/how-haskells-system-console-getopt-reqarg-takes-a-2-arity-function-as-its-const/34164725#34164725", "title": "How Haskell&#39;s System.Console.GetOpt ReqArg Takes a 2 arity function as its constructors first argument?", "body": "<p>The <code>-&gt;</code> you see in type signatures is, actually, a type too. And because of this, type variable <code>a</code> can be a function <code>b -&gt; c</code>. In your example it is <code>Options -&gt; IO Options</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1449620446, "last_edit_date": 1449620446, "creation_date": 1449604168, "answer_id": 34164749, "question_id": 34164599, "link": "https://stackoverflow.com/questions/34164599/how-haskells-system-console-getopt-reqarg-takes-a-2-arity-function-as-its-const/34164749#34164749", "title": "How Haskell&#39;s System.Console.GetOpt ReqArg Takes a 2 arity function as its constructors first argument?", "body": "<p><code>ReqArg</code> is not a function: it is a constructor. Now constructors are evidently functions as well. The signature of <code>ReqArg</code> is:</p>\n\n<pre><code>ReqArg :: (String -&gt; a) -&gt; String -&gt; ArgDescr a\n</code></pre>\n\n<p>So you constructor returns an <code>ArgDescr a</code>.</p>\n\n<p>Now a second aspect you have to notice is that <code>a</code> is in this case equivalent to <code>a = Options -&gt; IO Options</code>, so that means the signature of your <code>ReqArg</code> constructor collapses to:</p>\n\n<pre><code>ReqArg :: (String -&gt; (Options -&gt; IO Options)) -&gt; String -&gt; ArgDescr (Options -&gt; IO Options)\n</code></pre>\n\n<p>or less noisy:</p>\n\n<pre><code>ReqArg :: (String -&gt; Options -&gt; IO Options) -&gt; String -&gt; ArgDescr (Options -&gt; IO Options)\n</code></pre>\n\n<p>(brackets removed)</p>\n\n<p>So it is a function with \"<em>arity</em>\" 2 (note that strictly speaking in functional programming every function has (at least conceptually) arity 1). The point is that you generate out of the first argument a new function. But Haskells syntactical sugar allows to \"define two arguments\" at once.</p>\n\n<h1>Explaining the documentation</h1>\n\n<p>That's the reason why in the documentation example, you need to use <code>foldr</code>:</p>\n\n<pre><code>return (foldl (flip id) defaultOptions o, n)\n</code></pre>\n\n<p>Note this does not map on your (<code>Options -&gt; IO Options</code>), in the example one uses <code>Options -&gt; Options</code>.</p>\n\n<p>The point is, in the documentation Haskell processes each command option individually. Initially you start with <code>defaultOptions</code>, and processing an option with <code>o</code> out of <code>n</code> results in a new <code>Option</code>, that you use as input for processing the next. After you completed the chain of elements, you return the final <code>Options</code> data.</p>\n\n<h1>For your program</h1>\n\n<p>You make things a bit harder using an <code>IO</code> Monad: it was perhaps better to store a boolean whether you had to print the version, and if that was the case, do this in the <code>main</code>, or somewhere else. Nevertheless, you can achieve the same using <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Foldable.html#v:foldlM\" rel=\"nofollow\"><code>foldlM</code></a> instead of <code>foldl</code>.</p>\n"}], "owner": {"reputation": 235, "user_id": 1380952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f87171d5254bb42711ee34dc4f04a626?s=128&d=identicon&r=PG", "display_name": "blischalk", "link": "https://stackoverflow.com/users/1380952/blischalk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1449620446, "creation_date": 1449603689, "last_edit_date": 1449617644, "question_id": 34164599, "link": "https://stackoverflow.com/questions/34164599/how-haskells-system-console-getopt-reqarg-takes-a-2-arity-function-as-its-const", "title": "How Haskell&#39;s System.Console.GetOpt ReqArg Takes a 2 arity function as its constructors first argument?", "body": "<p>I am still quite new to Haskell so forgive me if this is completely obvious and I am just not understanding correctly.</p>\n\n<p>On Hackage <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/System-Console-GetOpt.html#t:ArgDescr\" rel=\"nofollow\">the documentation</a> says that <code>System.Console.GetOpt ReqArg</code> takes a function of arity 1 e.g <code>(String -&gt; a)</code> as the first argument to its constructor.</p>\n\n<pre><code>ReqArg (String -&gt; a) String\n</code></pre>\n\n<p>In many of the examples that I have seen a 2 arity function is passed to this constructor.</p>\n\n<p>Example from (<a href=\"https://wiki.haskell.org/High-level_option_handling_with_GetOpt\" rel=\"nofollow\">https://wiki.haskell.org/High-level_option_handling_with_GetOpt</a>):</p>\n\n<pre><code>data Options = Options  { optVerbose    :: Bool\n                        , optInput      :: IO String\n                        , optOutput     :: String -&gt; IO ()\n                        }\n\nstartOptions :: Options\nstartOptions = Options  { optVerbose    = False\n                        , optInput      = getContents\n                        , optOutput     = putStr\n                        }\n\noptions :: [ OptDescr (Options -&gt; IO Options) ]\noptions =\n    [ Option \"i\" [\"input\"]\n        (ReqArg\n            (\\arg opt -&gt; return opt { optInput = readFile arg })\n            \"FILE\")\n        \"Input file\"\n\n    , Option \"o\" [\"output\"]\n        (ReqArg\n            (\\arg opt -&gt; return opt { optOutput = writeFile arg })\n            \"FILE\")\n        \"Output file\"\n\n    , Option \"s\" [\"string\"]\n        (ReqArg\n            (\\arg opt -&gt; return opt { optInput = return arg })\n            \"FILE\")\n        \"Input string\"\n\n    , Option \"v\" [\"verbose\"]\n        (NoArg\n            (\\opt -&gt; return opt { optVerbose = True }))\n        \"Enable verbose messages\"\n\n    , Option \"V\" [\"version\"]\n        (NoArg\n            (\\_ -&gt; do\n                hPutStrLn stderr \"Version 0.01\"\n                exitWith ExitSuccess))\n        \"Print version\"\n\n    , Option \"h\" [\"help\"]\n        (NoArg\n            (\\_ -&gt; do\n                prg &lt;- getProgName\n                hPutStrLn stderr (usageInfo prg options)\n                exitWith ExitSuccess))\n        \"Show help\"\n    ]\n</code></pre>\n\n<p>So my question is do value constructors not really enforce the type when a function is used in its arguments or is there something else I am missing?</p>\n\n<p><strong>Update:</strong></p>\n\n<p>This is making more sense to me know. I believe there were a couple of factors that I was overlooking. First, as @CommuSoft mentioned, all functions really are a single arity in Haskell due to currying. Second, I didn't look closely enough at options which is not a function but a variable which is of type:</p>\n\n<pre><code>[ OptDescr (Options -&gt; IO Options) ]\n</code></pre>\n\n<p>This type signature of options declares what the type of the type variable of ReqArg is as well as the other type constructors NoArg and OptArg (the latter not utilized in the example).</p>\n\n<p>The single arity anonymous function passed to the NoArg ArgDescr constructor will essentially just be:</p>\n\n<pre><code>(Options -&gt; IO Options)\n</code></pre>\n\n<p>E.g it will receive the Options instance record</p>\n\n<p>Where as the 2 arity anonymous function passed to the ReqArg constructor will be:</p>\n\n<pre><code>(String -&gt; Options -&gt; IO Options)\n</code></pre>\n\n<p>And it will receive a string (the value someone entered at the command line) and the Options instance record.</p>\n\n<p>Thanks to all for helping me think this through!</p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 1, "last_activity_date": 1449601853, "creation_date": 1449601853, "answer_id": 34164055, "question_id": 34163756, "link": "https://stackoverflow.com/questions/34163756/how-can-i-modify-a-cabal-package-installed-onto-my-computer/34164055#34164055", "title": "How can I modify a cabal package installed onto my computer", "body": "<pre><code>tar xzf wxAstroids*\n</code></pre>\n\n<p>This will get your the package in a <code>wxAstroids-&lt;version&gt;</code> directory.  Change to that directory and...</p>\n\n<pre><code>vi xAstroids.cabal\n-- Edit the file, add Paths_wxAstroids to the other-modules: list.\n</code></pre>\n\n<p>Now the package should be fixed, so reinstall this fixed version</p>\n\n<pre><code>cabal install\n</code></pre>\n\n<p>Yay!</p>\n"}], "owner": {"reputation": 1, "user_id": 5655911, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208529456420287/picture?type=large", "display_name": "David Adams", "link": "https://stackoverflow.com/users/5655911/david-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1449601853, "creation_date": 1449600848, "question_id": 34163756, "link": "https://stackoverflow.com/questions/34163756/how-can-i-modify-a-cabal-package-installed-onto-my-computer", "title": "How can I modify a cabal package installed onto my computer", "body": "<p>I'm trying to use wxHaskell to modify wxAsteroids. Every time I try to change something within the wxAsteroids1.1.0.1.tar.gz folder it does not affect the program. Is there a way to update the wxAsteroids.exe in order to use the code? Unzipping the .tar.gz gives me this error when trying to run Asteroids.lhs:</p>\n\n<p><code>could not find module 'Paths_wxAsteroids'\n Use -v to see a list of the files searched for.</code></p>\n"}, {"tags": ["haskell", "symbolic-math", "proof", "sbv"], "comments": [{"owner": {"reputation": 1147, "user_id": 1498618, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iOfuB.png?s=128&g=1", "display_name": "Reed Oei", "link": "https://stackoverflow.com/users/1498618/reed-oei"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1449607403, "post_id": 34162834, "comment_id": 56078427, "body": "@ThomasM.DuBuisson Also if I change the limit to 4097, I get the solutions with m being 225 and 576, but if it&#39;s 4096 it doesn&#39;t show."}], "answers": [{"tags": [], "owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "is_accepted": true, "score": 5, "last_activity_date": 1449616494, "last_edit_date": 1449616494, "creation_date": 1449611681, "answer_id": 34166760, "question_id": 34162834, "link": "https://stackoverflow.com/questions/34162834/why-does-this-sbv-code-stop-before-hitting-the-limit-i-set/34166760#34166760", "title": "Why does this SBV code stop before hitting the limit I set?", "body": "<p>It's always good to give a full program:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nimport Data.SBV\n\npairCube :: SInteger -&gt; Symbolic SBool\npairCube limit = do\n        (m :: SInteger) &lt;- exists \"m\"\n        (n :: SInteger) &lt;- exists \"n\"\n        (a :: SInteger) &lt;- exists \"a\"\n        constrain $ m^(3::Integer) .== n^(2::Integer)\n        constrain $ m .&lt; limit\n        return $ m + n .== a^(2::Integer)\n\nmain :: IO ()\nmain = print =&lt;&lt; allSat (pairCube 1000)\n</code></pre>\n\n<p>When I run it, I get:</p>\n\n<pre><code>Main&gt; main\nSolution #1:\n  m = 0 :: Integer\n  n = 0 :: Integer\n  a = 0 :: Integer\nSolution #2:\n  m =  9 :: Integer\n  n = 27 :: Integer\n  a = -6 :: Integer\nSolution #3:\n  m =  1 :: Integer\n  n = -1 :: Integer\n  a =  0 :: Integer\nSolution #4:\n  m =  9 :: Integer\n  n = 27 :: Integer\n  a =  6 :: Integer\nSolution #5:\n  m =  64 :: Integer\n  n = 512 :: Integer\n  a = -24 :: Integer\nSolution #6:\n  m =  64 :: Integer\n  n = 512 :: Integer\n  a =  24 :: Integer\nUnknown\n</code></pre>\n\n<p>Note the final <code>Unknown.</code></p>\n\n<p>Essentially, SBV queried Z3, and got 6 solutions; when SBV asked for the 7th, Z3 said \"I don't know if there's any other solution.\" With non-linear arithmetic, this behavior is expected.</p>\n\n<p>To answer the original question (i.e., find the max <code>m</code>), I changed the constraint to read:</p>\n\n<pre><code>constrain $ m .== limit\n</code></pre>\n\n<p>and coupled it with the following \"driver:\"</p>\n\n<pre><code>main :: IO ()\nmain = loop 1000\n  where loop (-1) = putStrLn \"Can't find the largest m!\"\n        loop m    = do putStrLn $ \"Trying: \" ++ show m\n                       mbModel &lt;- extractModel `fmap` sat (pairCube m)\n                       case mbModel of\n                         Nothing -&gt; loop (m-1)\n                         Just r  -&gt; print (r :: (Integer, Integer, Integer))\n</code></pre>\n\n<p>After running about 50 minutes on my machine, Z3 produced:</p>\n\n<pre><code>(576,13824,-120)\n</code></pre>\n\n<p>So, clearly the <code>allSat</code> based approach is causing Z3 to give-up way earlier than what it can actually achieve if we fix <code>m</code> and iterate ourself. With a non-linear problem, expecting anything faster/better would be too much to ask of a general purpose SMT solver..</p>\n"}], "owner": {"reputation": 1147, "user_id": 1498618, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iOfuB.png?s=128&g=1", "display_name": "Reed Oei", "link": "https://stackoverflow.com/users/1498618/reed-oei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 34166760, "answer_count": 1, "score": 4, "last_activity_date": 1449616494, "creation_date": 1449597675, "question_id": 34162834, "link": "https://stackoverflow.com/questions/34162834/why-does-this-sbv-code-stop-before-hitting-the-limit-i-set", "title": "Why does this SBV code stop before hitting the limit I set?", "body": "<p>I have this theorem (not sure if that's the right word), and I want to get all the solutions.</p>\n\n<pre><code>pairCube limit = do\n    m &lt;- natural exists \"m\"\n    n &lt;- natural exists \"n\"\n    a &lt;- natural exists \"a\"\n    constrain $ m^3 .== n^2\n    constrain $ m .&lt; limit\n    return $ m + n .== a^2\n\nres &lt;- allSat (pairCube 1000)\n\n-- Run from ghci\nextractModels res :: [[Integer]]\n</code></pre>\n\n<p>This is trying to solve the problem:</p>\n\n<p>There are infinite pairs of integers (m, n) such that m^3 = n^2 and m + n is a perfect square. What is the pair with the greatest m less than 1000?</p>\n\n<p>I know the actual answer, just through brute forcing, but I want to do with SBV.</p>\n\n<p>However, when I run the code it gives only the following values (in the form [m, n, a]):\n[[9,27,6],[64,512,24],[]]</p>\n\n<p>However, there are several other solutions with an m value less than 1000 that aren't included. </p>\n"}, {"tags": ["haskell", "symbolic-math", "proof", "sbv"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1449598799, "post_id": 34162708, "comment_id": 56072977, "body": "Floating point square root or exact real square root or integer square root or what? Also, for square root can&#39;t you just add a variable <code>y</code> with <code>y .&gt;= 0</code> and <code>y * y .== x</code>?"}, {"owner": {"reputation": 1147, "user_id": 1498618, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iOfuB.png?s=128&g=1", "display_name": "Reed Oei", "link": "https://stackoverflow.com/users/1498618/reed-oei"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1449598928, "post_id": 34162708, "comment_id": 56073050, "body": "@ReidBarton Ideally it would act like Sage&#39;s sqrt function, so that if I do sqrt   50, it gives me something like 5 * sqrt 2."}], "answers": [{"tags": [], "owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "is_accepted": true, "score": 3, "last_activity_date": 1449638949, "creation_date": 1449638949, "answer_id": 34171373, "question_id": 34162708, "link": "https://stackoverflow.com/questions/34162708/how-do-i-get-symbolic-square-root-and-logarithm-functions-in-sbv/34171373#34171373", "title": "How do I get symbolic square root and logarithm functions in SBV?", "body": "<p>SBV already supports square-root for the floating-point types:</p>\n\n<p>Single precision:</p>\n\n<pre><code>Prelude Data.SBV&gt; sat $ \\x -&gt; x .== fpSqrt sRNE (4.2::SFloat)\nSatisfiable. Model:\n  s0 = 2.04939 :: Float\n</code></pre>\n\n<p>Double precision:</p>\n\n<pre><code>Prelude Data.SBV&gt; sat $ \\x -&gt; x .== fpSqrt sRNE (4.2::SDouble)\nSatisfiable. Model:\n  s0 = 2.04939015319192 :: Double\n</code></pre>\n\n<p>Note that you need to provide a rounding-mode, in the above I used <code>sRNE</code> which stands for <code>round-nearest-towards-even</code> which is the default rounding-mode used in Haskell. SBV supports all 5 IEEE rounding modes, if needed.</p>\n\n<p>You can also use reals (arbitrary-precision algebraic real numbers):</p>\n\n<pre><code>Prelude Data.SBV&gt; sat $ \\x -&gt; x * x .==  (4.2::SReal)\nSatisfiable. Model:\n  s0 = root(1, 5x^2 = 21) = -2.0493901531919196... :: Real\n</code></pre>\n\n<p>In this case, you get an algebraic equation, and an approximation of the real-result. (Note in the above that <code>x*x == 4.2</code> is the same as <code>5*x^2 = 21</code>). Both forms are available from the programmatic API.</p>\n\n<p>There's no single function for integer-square-roots; nor for logarithms. These latter ones can be expressed using quantifiers, but SMT solvers are unlikely to produce good results for them since they will involve both non-linear arithmetic and quantification.</p>\n\n<p>Note in general that neither SBV nor SMT solvers are good for \"simplifying\" symbolic expressions. You will always get a concrete answer for your query: If you ask for <code>sqrt 50</code>, you will get <code>7.07106</code> (in the correct type/precision), instead of things like <code>5 * sqrt 2</code>, for instance.</p>\n"}], "owner": {"reputation": 1147, "user_id": 1498618, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iOfuB.png?s=128&g=1", "display_name": "Reed Oei", "link": "https://stackoverflow.com/users/1498618/reed-oei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 34171373, "answer_count": 1, "score": 0, "last_activity_date": 1449638949, "creation_date": 1449597264, "question_id": 34162708, "link": "https://stackoverflow.com/questions/34162708/how-do-i-get-symbolic-square-root-and-logarithm-functions-in-sbv", "title": "How do I get symbolic square root and logarithm functions in SBV?", "body": "<p>The only solution I can find is to do a square root approximation, but this doesn't work symbolically so I can't use it for proving.</p>\n"}, {"tags": ["haskell", "refactoring", "pointfree", "do-notation"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1449595790, "post_id": 34162101, "comment_id": 56071207, "body": "So you want <code>getLine &gt;&gt;= \\x -&gt; putStrLn x &gt;&gt; return x</code> in point free style.  Have you asked lambdabot? It says <code>liftM2 (&gt;&gt;) putStrLn return =&lt;&lt; getLine</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1449597904, "post_id": 34162101, "comment_id": 56072452, "body": "@ThomasM.DuBuisson It seems like Lambdabot found almost the exact function that OP wanted! <code>flip (liftM2 (&gt;&gt;)) :: Monad m =&gt; (a -&gt; m b) -&gt; (a -&gt; m c) -&gt; (a -&gt; m b)</code> - the actual type is slightly more generalized so it is somewhat hard to see."}, {"owner": {"reputation": 4179, "user_id": 935676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITQRV.jpg?s=128&g=1", "display_name": "amoebe", "link": "https://stackoverflow.com/users/935676/amoebe"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1449603872, "post_id": 34162101, "comment_id": 56076254, "body": "@ThomasM.DuBuisson Thank you, I asked the <code>pointfree</code> command line tool, and it could not handle <code>do</code>, so I gave up. I ended up using <code>ask = getLine &gt;&gt;= liftM2 (&gt;&gt;) putStrLn return</code>, which looks okay, thanks again! You can put this into an answer if you want, then I can mark it as solved."}], "answers": [{"comments": [{"owner": {"reputation": 4179, "user_id": 935676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITQRV.jpg?s=128&g=1", "display_name": "amoebe", "link": "https://stackoverflow.com/users/935676/amoebe"}, "edited": false, "score": 0, "creation_date": 1449604369, "post_id": 34162798, "comment_id": 56076601, "body": "You&#39;re right, it is probably not a very good idea. The arrows look really complicated. I&#39;m not sure if the solution with <code>liftM2</code> in clear enough or confusing?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 4179, "user_id": 935676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITQRV.jpg?s=128&g=1", "display_name": "amoebe", "link": "https://stackoverflow.com/users/935676/amoebe"}, "edited": false, "score": 0, "creation_date": 1449613945, "post_id": 34162798, "comment_id": 56082036, "body": "The problem with <code>liftM2(&gt;&gt;)</code> is that it mixes two different monads (<code>(a-&gt;)</code> and <code>IO</code>) in a really quite convoluted way. If you do something like that, better do it properly with <code>ReaderT</code>, but that&#39;s only worth it if you&#39;re reading the same value from a whole bunch of places."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 8, "last_activity_date": 1449597560, "creation_date": 1449597560, "answer_id": 34162798, "question_id": 34162101, "link": "https://stackoverflow.com/questions/34162101/add-action-without-changing-result-to-refactor-do-notation/34162798#34162798", "title": "Add action without changing result to refactor do-notation", "body": "<p>As a tendency, if you use one value in two different places it probably <em>is</em> a good idea to give it a name in a clear <code>do</code> block, rather than pressing on pointless style.</p>\n\n<p>The abstract concept of splitting up information flow to different actions is captured by <a href=\"https://en.wikipedia.org/wiki/Cartesian_monoidal_category\">cartesian monoidal categories</a>, known to Haskellers as <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Arrow.html\">arrows</a>. In your case, you're basically working in the <code>IO</code> Kleisli category:</p>\n\n<pre><code>import Prelude hiding (id)\nimport Control.Arrow\n\nask' :: Kleisli IO () String\nask' = Kleisli (\\()-&gt;getLine) &gt;&gt;&gt; (putStrLn &amp;&amp;&amp; id) &gt;&gt;&gt; arr snd\n</code></pre>\n\n<p>I don't think it's a good idea to write such code.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 2, "last_activity_date": 1449626543, "last_edit_date": 1449626543, "creation_date": 1449625589, "answer_id": 34169382, "question_id": 34162101, "link": "https://stackoverflow.com/questions/34162101/add-action-without-changing-result-to-refactor-do-notation/34169382#34169382", "title": "Add action without changing result to refactor do-notation", "body": "<blockquote>\n  <p>I want to sequentially compose two monad actions in Haskell, discarding any value produced by the second, and passing the argument to both actions.</p>\n</blockquote>\n\n<p>This sounds to me like a <code>Reader</code>\u2014the function type <code>r -&gt; m a</code> is isomorphic to <code>ReaderT r m a</code>, and the monad works by implicitly plugging in the same <code>r</code> value into all the \"holes.\"  So for example:</p>\n\n<pre><code>import Control.Applicative\nimport Control.Monad.Reader\n\nexample :: IO String\nexample = getLine &gt;&gt;= discarding putStrLn\n\ndiscarding :: Monad m =&gt; (a -&gt; m b) -&gt; a -&gt; m a\ndiscarding action = runReaderT (ReaderT action *&gt; ask)\n</code></pre>\n\n<p>The operator you want is then something like:</p>\n\n<pre><code>action `thingy` extra = action &gt;&gt;= discarding extra\n</code></pre>\n\n<p>But of course <code>discarding</code> has a simpler implementation:</p>\n\n<pre><code>discarding :: Applicative f =&gt; (a -&gt; f b) -&gt; a -&gt; f a\ndiscarding action a = action a *&gt; return a\n</code></pre>\n\n<p>...so in the end I think this is really code golf.  But in a more complex program where this is a common pattern at a larger scale it might be worth a shot.  Basically, if you have:</p>\n\n<pre><code>a0 :: r -&gt; m a0\na1 :: r -&gt; m a1\n   .\n   .\n   .\nan :: r -&gt; m an\n</code></pre>\n\n<p>Then it follows that:</p>\n\n<pre><code>ReaderT a0 :: ReaderT r m a0\nReaderT a1 :: ReaderT r m a1\n   .\n   .\n   .\nReaderT an :: ReaderT r m an\n</code></pre>\n\n<p>And then:</p>\n\n<pre><code>runReaderT (ReaderT a0 &lt;* ReaderT a1 &lt;* ... &lt;* ReaderT an) :: r -&gt; m a0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 2, "last_activity_date": 1449683922, "last_edit_date": 1495541043, "creation_date": 1449683922, "answer_id": 34185783, "question_id": 34162101, "link": "https://stackoverflow.com/questions/34162101/add-action-without-changing-result-to-refactor-do-notation/34185783#34185783", "title": "Add action without changing result to refactor do-notation", "body": "<p>For completeness, in this particular case (the <code>IO</code>) monad, you could also abuse <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Exception-Base.html#v:bracket\" rel=\"nofollow noreferrer\"><code>bracket</code></a> for this purpose:</p>\n\n<pre><code>bracket getLine putStrLn return\n</code></pre>\n\n<p>But I strongly discourage it, as this will be much less readable than the original <code>do</code>-notation block, it's just ugly.</p>\n\n<p>As already mentioned, in this particular case naming the result seems the best way.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/q/16726659/1333025\">Should do-notation be avoided in Haskell?</a></p>\n"}], "owner": {"reputation": 4179, "user_id": 935676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITQRV.jpg?s=128&g=1", "display_name": "amoebe", "link": "https://stackoverflow.com/users/935676/amoebe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 34162798, "answer_count": 3, "score": 7, "last_activity_date": 1449683922, "creation_date": 1449595222, "question_id": 34162101, "link": "https://stackoverflow.com/questions/34162101/add-action-without-changing-result-to-refactor-do-notation", "title": "Add action without changing result to refactor do-notation", "body": "<p>I want to sequentially compose two monad actions in Haskell, discarding any value produced by the second, and passing the argument to both actions. Currently I'm using a do-block like this:</p>\n\n<pre><code>ask = do\n  result &lt;- getLine\n  putStrLn result\n  return result\n</code></pre>\n\n<p>I was hoping to write this a little more point free and neat, so I tried this:</p>\n\n<pre><code>ask' = getLine &lt;* putStrLn\n</code></pre>\n\n<p>However, this doesn't even type check and the problem is that <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Applicative.html#v:-60--42-\" rel=\"noreferrer\"><code>&lt;*</code></a> does not transfer the result of the first action to the second. I want to chain the actions like <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:-62--62--61-\" rel=\"noreferrer\"><code>&gt;&gt;=</code></a> does, but not change the result. The type should be <code>(a -&gt; m b) -&gt; (a -&gt; m c) -&gt; (a -&gt; m b)</code>, but <a href=\"https://www.haskell.org/hoogle/?hoogle=%28a+-%3E+m+b%29+-%3E+%28a+-%3E+m+c%29+-%3E+%28a+-%3E+m+b%29\" rel=\"noreferrer\">Hoogle</a> yields no suitable results. What would be an operator to achieve this function composition?</p>\n"}, {"tags": ["python", "haskell", "reduce"], "comments": [{"owner": {"reputation": 36413, "user_id": 2301450, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/4xgoZ.png?s=128&g=1", "display_name": "vaultah", "link": "https://stackoverflow.com/users/2301450/vaultah"}, "edited": false, "score": 1, "creation_date": 1449592922, "post_id": 34161269, "comment_id": 56069347, "body": "<i>reduce(function, sequence[, initial])</i> &quot;If initial is present, it is placed before the items of the sequence in the calculation, and serves as a default when the sequence is empty.&quot; Is this what you want?"}], "answers": [{"tags": [], "owner": {"reputation": 18703, "user_id": 2912340, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/ddQ02.jpg?s=128&g=1", "display_name": "\u0141ukasz Rogalski", "link": "https://stackoverflow.com/users/2912340/%c5%81ukasz-rogalski"}, "is_accepted": false, "score": 10, "last_activity_date": 1449593050, "creation_date": 1449593050, "answer_id": 34161365, "question_id": 34161269, "link": "https://stackoverflow.com/questions/34161269/is-there-a-way-to-specify-the-reduce-accumulator-in-python/34161365#34161365", "title": "Is there a way to specify the reduce() accumulator in Python?", "body": "<p>Quoting <a href=\"https://docs.python.org/2/library/functions.html#reduce\" rel=\"noreferrer\">reduce docs</a>, an interface is:</p>\n\n<pre><code>reduce(function, iterable[, initializer])\n</code></pre>\n\n<blockquote>\n  <p>If the optional <em>initializer</em> is present, it is placed before the items\n  of the iterable in the calculation, and serves as a default when the\n  iterable is empty. If initializer is not given and iterable contains\n  only one item, the first item is returned.</p>\n</blockquote>\n\n<p>So, an (academic) example for using initializer may be:</p>\n\n<pre><code>seq = ['s1', 's22', 's333']\nlen_sum_count = reduce(lambda accumulator, s: accumulator + len(s), seq, 0)\nassert len_sum_count == 9\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 5486662, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/isNIe.jpg?s=128&g=1", "display_name": "GuitarGuy365", "link": "https://stackoverflow.com/users/5486662/guitarguy365"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2895, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1449593050, "creation_date": 1449592790, "question_id": 34161269, "link": "https://stackoverflow.com/questions/34161269/is-there-a-way-to-specify-the-reduce-accumulator-in-python", "title": "Is there a way to specify the reduce() accumulator in Python?", "body": "<p>I've been learning a lot of Haskell lately, and wanted to try out some of the neat tricks it has in Python. From what I can understand, Python's reduce automatically sets the iterative variable and the accumulator in the function passed to the first two values of the list given in reduce. In Haskell, when I use its equivalent, fold, I can specify what I want the accumulator to be. Is there a way I can do this with Python's reduce?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5046043"}, "edited": false, "score": 0, "creation_date": 1449591191, "post_id": 34160603, "comment_id": 56068094, "body": "and by integer division do you mean the <code>div</code> acts as the floor function aswell"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1449591222, "post_id": 34160603, "comment_id": 56068114, "body": "Yes. This is the reason I removed <code>floor</code> as well."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": true, "score": 2, "last_activity_date": 1449590963, "creation_date": 1449590963, "answer_id": 34160603, "question_id": 34160402, "link": "https://stackoverflow.com/questions/34160402/haskell-realfrac-error/34160603#34160603", "title": "Haskell RealFrac error", "body": "<p>The <code>/</code> function if for fractional numbers and returning <code>Fractional</code>:</p>\n\n<pre><code>&gt; :t (/)\n(/) :: Fractional a =&gt; a -&gt; a -&gt; a \n</code></pre>\n\n<p>If you want to use integer division, use the <code>div</code> function instead:</p>\n\n<pre><code>dayshoursmins :: Int -&gt; (Int, Int, Int)\ndayshoursmins x = (days, hours, minutes)\n    where\n        days = x `div` (24 * 60)\n        a = x - (days * (24 * 60))\n        hours =  a `div` 60\n        b = a - (hours * 60)\n        minutes = b\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5046043"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 1, "accepted_answer_id": 34160603, "answer_count": 1, "score": 1, "last_activity_date": 1449590963, "creation_date": 1449590418, "question_id": 34160402, "link": "https://stackoverflow.com/questions/34160402/haskell-realfrac-error", "title": "Haskell RealFrac error", "body": "<p>The error : Instance of RealFrac Int required for definition of dayshoursmins</p>\n\n<p>I understand that this error is because I'm changing the type - or something along those lines - and that it doesnt match (RealFrac a, Integral b) => a -> b. I'm just not sure how to fix it. The error occurs on line 2. I have tried using fromIntegral however I may be using it incorrectly.</p>\n\n<pre><code>dayshoursmins :: Int -&gt; (Int, Int, Int)\ndayshoursmins x = (days, hours, minutes)\nwhere\n    days = floor (x / (24 * 60))\n    a = x - (days * (24 * 60))\n    hours = floor (a / 60)\n    b = a - (hours * 60)\n    minutes = b\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 2, "creation_date": 1449590429, "post_id": 34160196, "comment_id": 56067568, "body": "I think any solution using <code>words</code> will suffer from this: <code>unwords</code> and <code>words</code> aren&#39;t perfect inverses of each other and will always drop leading/trailing whitespace in addition to double/triple/etc. spaces. Try writing a solution without <code>words</code> or <code>unwords</code>. Alternatively, see <a href=\"https://hackage.haskell.org/package/split-0.2.2/docs/Data-List-Split.html\" rel=\"nofollow noreferrer\"><code>splitOn</code></a>, which is more careful about this."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1449590604, "post_id": 34160196, "comment_id": 56067678, "body": "Try writing a recursive solution which is like the <code>map</code> function, but also passes along a piece of state <code>shouldNextNonWhitespaceCharBeCapitalized :: Bool</code>, then see if you can find a higher order function in Data.List that captures this type of recursion."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449678200, "post_id": 34160720, "comment_id": 56113813, "body": "Another way to wrap is <code>drop 1 . upperFirst&#39; . (&#39; &#39; :)</code>."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 4, "last_activity_date": 1449591291, "creation_date": 1449591291, "answer_id": 34160720, "question_id": 34160196, "link": "https://stackoverflow.com/questions/34160196/haskell-capitalize-the-first-letter-of-each-word-in-a-string-without-losing-wh/34160720#34160720", "title": "Haskell - Capitalize the first letter of each word in a string without losing white spaces", "body": "<p>Pattern matching is your friend here</p>\n\n<pre><code>import Data.Char\n\nupperFirst :: String -&gt; String\nupperFirst (c1:c2:rest) =\n    if isSpace c1 &amp;&amp; isLower c2\n        then c1 : toUpper c2 : upperFirst rest\n        else c1 : upperFirst (c2:rest)\nupperFirst s = s\n</code></pre>\n\n<p>The only problem with this function is that the first character won't get capitalized (also affects single-character strings), but if you really need that functionality then just wrap the call to this function up in another that handles those special cases:</p>\n\n<pre><code>upperFirst' = &lt;the implementation above&gt;\n\nupperFirst [] = []\nupperFirst [c] = [toUpper c]  -- No-op on non-letters\nupperFirst (s:str) = upperFirst' (toUpper s:str)\n</code></pre>\n\n<p>To test:</p>\n\n<pre><code>&gt; upperFirst \"this is a   test  of \\t this\\n function\"\n\"This Is A   Test  Of \\t This\\n Function\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449677996, "post_id": 34161542, "comment_id": 56113673, "body": "This will replace tabs and newlines with spaces."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449681219, "post_id": 34161542, "comment_id": 56115999, "body": "Oops! Sorry! I got confused."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 3, "last_activity_date": 1449593547, "creation_date": 1449593547, "answer_id": 34161542, "question_id": 34160196, "link": "https://stackoverflow.com/questions/34160196/haskell-capitalize-the-first-letter-of-each-word-in-a-string-without-losing-wh/34161542#34161542", "title": "Haskell - Capitalize the first letter of each word in a string without losing white spaces", "body": "<pre><code>import Data.Char\n\nupperFirst :: String -&gt; String\nupperFirst s = zipWith upper (' ':s) s where\n    upper c1 c2 | isSpace c1 &amp;&amp; isLower c2 = toUpper c2\n    upper c1 c2 = c2\n</code></pre>\n\n<p>E.g.</p>\n\n<pre><code>upperFirst \"a   test for    upperFirst\"\n</code></pre>\n\n<p>reduces to</p>\n\n<pre><code>zipWith upper\n    \" a test for    upperFirst  \"\n    \"a test for    upperFirst  \"\n</code></pre>\n\n<p>If a symbol in the first string is a space and a symbol at the same position in the second string is a lowercase letter, then make it uppercase, otherwise return the same. So</p>\n\n<ul>\n<li><code>upper ' ' 'a' = 'A'</code></li>\n<li><code>upper 'a' ' ' = ' '</code></li>\n<li><code>upper ' ' 't' = 'T'</code></li>\n<li><code>upper 't' 'e' = 'e'</code></li>\n</ul>\n\n<p>and so on. Hence the result is <code>\"A Test For    UpperFirst  \"</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1449593778, "post_id": 34161578, "comment_id": 56069890, "body": "Nice one. Why not <code>concatMap</code>?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1449594337, "post_id": 34161578, "comment_id": 56070241, "body": "@user3237465: I doubt that it adds clarity, but I like it."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 8, "last_activity_date": 1449595289, "last_edit_date": 1495535342, "creation_date": 1449593659, "answer_id": 34161578, "question_id": 34160196, "link": "https://stackoverflow.com/questions/34160196/haskell-capitalize-the-first-letter-of-each-word-in-a-string-without-losing-wh/34161578#34161578", "title": "Haskell - Capitalize the first letter of each word in a string without losing white spaces", "body": "<p>Instead of extracting words, as <code>words</code> does, you want to just <em>split</em> the string so each word beginning is also at the start of a list. As Hao Lian commented, this can be done with <code>splitOn</code>, but the standard <a href=\"http://hackage.haskell.org/package/base/docs/Data-List.html#v:groupBy\" rel=\"nofollow noreferrer\"><code>groupBy</code></a> will also do the trick:</p>\n\n<pre><code>import Data.List\nimport Data.Char\n\nupperFirst = concat\n           . map (\\(c:cs) -&gt; toUpper c : cs)\n           . groupBy (\\a b -&gt; isSpace a == isSpace b)\n</code></pre>\n\n<p>How this works: it groups together chars which are either all spaces, or all non-spaces. It then uppercases the start of each substring (bit inefficient to also do that for the whitespace, but harmless) and then just concatenates all the strings back together.</p>\n\n<p>As user3237465 remarks, the combination of <code>map</code> and <code>concat</code> is very common, and a special case of something <a href=\"https://en.wikipedia.org/wiki/Monad_%28functional_programming%29\" rel=\"nofollow noreferrer\">even more common</a>. Furthermore, there's <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Function.html#v:on\" rel=\"nofollow noreferrer\">a nice little combinator</a> that comes in handy when grouping or sorting by some predicate. Hence you can also write this as</p>\n\n<pre><code>import Control.Monad\nimport Data.Function\n\nupperFirst = groupBy ((==)`on`isSpace) &gt;=&gt; \\(c:cs) -&gt; toUpper c : cs\n</code></pre>\n\n<p>To top it up, you can use <a href=\"https://stackoverflow.com/questions/17006679/how-can-i-use-control-lens-to-update-the-ith-element-of-a-list\">the hip modern way</a> of modifying things, for the uppercasing part:</p>\n\n<pre><code>import Control.Lens\n\nupperFirst = groupBy ((==)`on`isSpace) &gt;=&gt; ix 0 %~ toUpper\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "is_accepted": false, "score": 1, "last_activity_date": 1449720303, "last_edit_date": 1449720303, "creation_date": 1449669163, "answer_id": 34180514, "question_id": 34160196, "link": "https://stackoverflow.com/questions/34160196/haskell-capitalize-the-first-letter-of-each-word-in-a-string-without-losing-wh/34180514#34180514", "title": "Haskell - Capitalize the first letter of each word in a string without losing white spaces", "body": "<p>This problem is a prototypical scan:</p>\n\n<pre><code>&gt;&gt;&gt; scanl (\\old new -&gt; if isSpace old then toUpper new else new) ' ' \" hello  world  \"\n\"  Hello  World  \" \n</code></pre>\n\n<p>The initial state of the 'seed' -- here a space -- is added at the beginning, but tail is legitimate here. See the implementation of <code>scanl</code> <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/src/GHC.List.html#scanl\" rel=\"nofollow\">here</a>, and compare it with the other scan functions, which have different advantages. Here's a simple version:</p>\n\n<pre><code>scan op state []     = state : []\nscan op state (x:xs) = state : scan op (op state x) xs\n</code></pre>\n\n<p>You can write your function by inlining </p>\n\n<pre><code>op old new = if isSpace old then toUpper new else new\n</code></pre>\n\n<p>into the definition</p>\n\n<pre><code>myscan state []     = state : []\nmyscan state (x:xs) = state : myscan (if isSpace state then toUpper x else x) xs\n</code></pre>\n\n<p>starting it with whitespace and then taking the tail:</p>\n\n<pre><code>titlecase = tail . myscan ' '\n</code></pre>\n\n<p>Then in ghci I see</p>\n\n<pre><code>&gt;&gt;&gt; titlecase \"  hello    world  \"\n\"  Hello    World  \"\n</code></pre>\n\n<p>Or you can just directly use the general <code>scan</code> we defined</p>\n\n<pre><code>&gt;&gt;&gt; let op old new = if isSpace old then toUpper new else new\n\n&gt;&gt;&gt; scan op ' ' \" hello   world  \"\n\"  Hello   World  \"\n\n&gt;&gt;&gt; tail $ scan op ' ' \" hello   world  \"\n\" Hello   World  \"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1449679994, "last_edit_date": 1495541913, "creation_date": 1449679045, "answer_id": 34184118, "question_id": 34160196, "link": "https://stackoverflow.com/questions/34160196/haskell-capitalize-the-first-letter-of-each-word-in-a-string-without-losing-wh/34184118#34184118", "title": "Haskell - Capitalize the first letter of each word in a string without losing white spaces", "body": "<p>This is very similar to <a href=\"https://stackoverflow.com/a/34180514/1477667\">Michael's solution</a>, but I think <code>mapAccumL</code> is a better fit than <code>scanl</code>:</p>\n\n<pre><code>upperFirst :: Traversable t =&gt; t Char -&gt; t Char\nupperFirst = snd . mapAccumL go True where\n  go lastSpace x\n     | isSpace x = (True, x)\n     | lastSpace = (,) False $! toUpper x\n     | otherwise = (False, x)\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 5498865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iCmWc.png?s=128&g=1", "display_name": "Fossa", "link": "https://stackoverflow.com/users/5498865/fossa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3567, "favorite_count": 1, "answer_count": 5, "score": 6, "last_activity_date": 1449720303, "creation_date": 1449589847, "question_id": 34160196, "link": "https://stackoverflow.com/questions/34160196/haskell-capitalize-the-first-letter-of-each-word-in-a-string-without-losing-wh", "title": "Haskell - Capitalize the first letter of each word in a string without losing white spaces", "body": "<p>I'm doing an exercise that requires me to write a function that capitalize all the first letters of the words of a string. </p>\n\n<p>Here is what I did so far:</p>\n\n<pre><code>upperFirst:: String -&gt; String\nupperFirst str =  let \n                      upperFirstForEachWord (firstLetter:others) = toUpper firstLetter : map toLower others\n                  in unwords  (map upperFirstForEachWord (words str))\n</code></pre>\n\n<p>And this is how it works:</p>\n\n<pre><code>upperFirst \"\" =   \"\"\nupperFirst \"hello friends!\" = \"Hello Friends!\"\n</code></pre>\n\n<p>But also:</p>\n\n<pre><code>upperFirst \" \" =  \"\"\nupperFirst \" a a a \" = \"A A A\"\n</code></pre>\n\n<p>I'm losing the white spaces at the beginning, at the end and the double ones because of the function <code>words</code>.</p>\n\n<p>How can I keep them recursively (without working on all the possible cases)? </p>\n\n<p>Thank you for any help!</p>\n"}, {"tags": ["haskell", "lambda", "functional-programming"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1449588347, "post_id": 34159512, "comment_id": 56066031, "body": "&quot;Can i sort/change the postion of agruments &quot;id xs []&quot; ?&quot; Can you clarify your question? It&#39;s hard to understand what you are asking."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1449588566, "creation_date": 1449588566, "answer_id": 34159736, "question_id": 34159512, "link": "https://stackoverflow.com/questions/34159512/lambdas-and-folds-left-and-right/34159736#34159736", "title": "Lambdas and Folds (Left and Right)", "body": "<p>The crucial thing is how this work with <em>difference lists</em>. Let's write out some explicit conversions:</p>\n\n<pre><code>type DList a = [a]-&gt;[a]\n\nemptyDList :: Dlist a\nemptyDList = id\n\nfromDList :: DList a -&gt; [a]\nfromDList f = f []\n\nmyReverse'' :: \u2200 a . [a] -&gt; [a]\nmyReverse'' xs = fromDList $ foldr revCons emptyDList xs \n where revCons :: a -&gt; DList a -&gt; DList a\n       revCons x fId empty = fId $ x : empty\n</code></pre>\n\n<p>Note that <code>revCons</code> has three arguments, though its signature actually suggests only two: difference lists are really a function type, but you can think of these functions as an abstract optimised representation for concrete lists.</p>\n"}, {"comments": [{"owner": {"reputation": 543, "user_id": 3123541, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9c7e4f692392a0b98401c9f3dfb469e2?s=128&d=identicon&r=PG&f=1", "display_name": "FuzzY", "link": "https://stackoverflow.com/users/3123541/fuzzy"}, "edited": false, "score": 0, "creation_date": 1453505738, "post_id": 34169957, "comment_id": 57647127, "body": "I think <code>my_reverse xs = foldl (flip (:)) [] xs</code>, with <code>[] xs</code> at the end, not <code>... xs []</code>"}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": true, "score": 2, "last_activity_date": 1449629539, "creation_date": 1449629539, "answer_id": 34169957, "question_id": 34159512, "link": "https://stackoverflow.com/questions/34159512/lambdas-and-folds-left-and-right/34169957#34169957", "title": "Lambdas and Folds (Left and Right)", "body": "<p>The way I like to understand these \"reverse list with <code>foldr</code>\" problems is to split it into pieces, and apply the lesson of <a href=\"https://byorgey.wordpress.com/2012/11/05/foldr-is-made-of-monoids/\" rel=\"nofollow\">\"Foldr is made of monoids\"</a>.  Don't worry, this isn't as scary as it sounds.</p>\n\n<p>First, let's note that <code>reverse</code> can be implemented this way:</p>\n\n<pre><code>my_reverse xs = foldl (flip (:)) xs []\n</code></pre>\n\n<p>This is the first simplification to our problem: if we can figure out how to write <code>foldl</code> in terms of <code>foldr</code>, then we can plug that solution into <code>my_reverse</code> to and be done with it. </p>\n\n<p>Now, the standard type signature for <code>foldr</code> is this:</p>\n\n<pre><code>foldr :: (a -&gt; r -&gt; r) -&gt; r -&gt; [a] -&gt; r\n</code></pre>\n\n<p>But the order of the arguments doesn't really matter, so let's rearrange things this way (throwing in a few implicit parentheses as well), and we'll compare it with <code>map</code>:</p>\n\n<pre><code>my_foldr :: (a -&gt; (r -&gt; r)) -&gt; [a] -&gt; (r -&gt; r)\nmap      :: (a -&gt; b       ) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>Once you see this correspondence, it's not hard to see that we can write <code>my_foldr</code> this way:</p>\n\n<pre><code>my_foldr :: (a -&gt; (r -&gt; r)) -&gt; [a] -&gt; (r -&gt; r)\nmy_foldr f as = compose (map f as)\n  where compose :: [r -&gt; r] -&gt; (r -&gt; r)\n        compose = foldr (.) id\n</code></pre>\n\n<p>Think of this in the following way:</p>\n\n<ol>\n<li>The <code>map</code> operation is converting each element of the list into a \"step\" of the transformation that we apply to the <code>r</code> values.</li>\n<li>The <code>compose</code> function takes the resulting list of \"steps\" and wires them all together, using the <code>.</code> operator.</li>\n</ol>\n\n<p>And now the trick is that we can write a <code>foldl</code> counterpart with a small change:</p>\n\n<pre><code>my_foldl :: (a -&gt; (r -&gt; r)) -&gt; [a] -&gt; (r -&gt; r)\nmy_foldl f as = compose (map f as)\n    where compose :: [r -&gt; r] -&gt; (r -&gt; r)\n          compose = foldr (flip (.)) id\n\n{- Example:\n&gt;&gt;&gt;  my_foldl (:) [1..3] []\n[3,2,1]\n-}\n</code></pre>\n\n<p>All I did was change <code>(.)</code> to <code>flip (.)</code>!  And note that <code>my_foldl</code> is written in terms of <code>map</code> and <code>foldr</code>... but <code>map</code> can be rewritten in terms of <code>foldr</code> as well:</p>\n\n<pre><code>my_map :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmy_map f = foldr (\\a bs -&gt; f a : bs) []\n</code></pre>\n\n<p>So we've ended up with a solution that's different and longer than the one you're trying to understand, but hopefully it's illuminating.  </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 1676504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e9e15c982d8ac6c469d97497bd98af?s=128&d=identicon&r=PG", "display_name": "Robi", "link": "https://stackoverflow.com/users/1676504/robi"}, "is_accepted": false, "score": 0, "last_activity_date": 1454591295, "creation_date": 1454591295, "answer_id": 35201851, "question_id": 34159512, "link": "https://stackoverflow.com/questions/34159512/lambdas-and-folds-left-and-right/35201851#35201851", "title": "Lambdas and Folds (Left and Right)", "body": "<p>If you do: </p>\n\n<pre><code>Prelude :t \\x fId empty -&gt; fId (x : empty)\n</code></pre>\n\n<p>You will get:</p>\n\n<pre><code>\\x fId empty -&gt; fId (x : empty) :: a -&gt; ([a] -&gt; t) -&gt; [a] -&gt; t\n</code></pre>\n\n<p>This function type here is equivalent to:</p>\n\n<pre><code>a -&gt; ([a] -&gt; t) -&gt; ([a] -&gt; t) \n</code></pre>\n\n<p>which means a function (binary function) that takes two arguments (the second argument is a function i.e. <code>[a] -&gt; t</code>) and returns a function (i.e. <code>[a] -&gt; t</code>).</p>\n\n<p>This binary function matches the first argument that <code>foldr</code> takes (i.e. <code>a -&gt; b -&gt; b</code>).</p>\n\n<p>In other words, <code>foldr (\\x fId empty -&gt; fId (x : empty))</code> takes two arguments: a function and a list and returns a function.</p>\n\n<pre><code>Prelude&gt; :t foldr (\\x fId empty -&gt; fId (x : empty))\nfoldr (\\x fId empty -&gt; fId (x : empty))\n  :: ([a] -&gt; t) -&gt; [a] -&gt; [a] -&gt; t\n</code></pre>\n\n<p>Take this example: <code>foldr (\\x fId empty -&gt; fId (x : empty)) id [1, 2, 3]</code>.</p>\n\n<p>Step 1: <code>3</code> and <code>id</code> are passed to the anonymous binary function as arguments. A function like <code>\\empty -&gt; id (3 : empty)</code> is returned as the new accumulator value.</p>\n\n<p>Step 2: <code>2</code> and <code>\\empty -&gt; id (3 : empty)</code> are passed to the anonymous binary function. And <code>\\empty -&gt; id (3 : (2 : empty))</code> is returned.  </p>\n\n<p>Step 3: <code>1</code> and <code>\\empty -&gt; id (3 : (2 : empty))</code> are passed to the anonymous binary function. And <code>\\empty -&gt; id (3 : (2 : (1 : empty)))</code> is returned. </p>\n\n<p>So <code>foldr (\\x fId empty -&gt; fId (x : empty)) id [1, 2, 3]</code> produces a function like <code>\\empty -&gt; id (3 : (2 : (1 : empty)))</code>.</p>\n\n<p>If you apply <code>\\empty -&gt; id (3 : (2 : (1 : empty)))</code> to <code>[]</code>, then it will give you <code>[3, 2, 1]</code>.</p>\n\n<p>This means <code>foldr (\\x fId empty -&gt; fId (x : empty)) id [1, 2, 3] []</code> produces <code>[3, 2, 1]</code>.</p>\n"}], "owner": {"reputation": 57, "user_id": 3553559, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/255985d98f3840fd3f15d3117f8a62c1?s=128&d=identicon&r=PG&f=1", "display_name": "duyCuong", "link": "https://stackoverflow.com/users/3553559/duycuong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 3, "accepted_answer_id": 34169957, "answer_count": 3, "score": -1, "last_activity_date": 1454591295, "creation_date": 1449587956, "last_edit_date": 1449588737, "question_id": 34159512, "link": "https://stackoverflow.com/questions/34159512/lambdas-and-folds-left-and-right", "title": "Lambdas and Folds (Left and Right)", "body": "<p>I really don't understand code </p>\n\n<pre><code>myReverse'' :: [a] -&gt; [a]\nmyReverse'' xs = foldr (\\x fId empty -&gt; fId (x : empty)) id xs []\n</code></pre>\n\n<p>In case: </p>\n\n<ul>\n<li>empty mapping to [] &lt;---- accumulator </li>\n<li>id mapping to fID (func id) </li>\n<li>x is first element of xs (list) <br></li>\n</ul>\n\n<p>Can i sort/change the postion of agruments \"id xs []\" ? </p>\n\n<pre><code>myReverse'' xs = foldr (\\x fId empty -&gt; fId (x : empty)) xs id []\n</code></pre>\n\n<p>I have read a book yesterday <a href=\"http://learnyouahaskell.com/higher-order-functions#lambdas\" rel=\"nofollow\">http://learnyouahaskell.com/higher-order-functions#lambdas</a></p>\n\n<pre><code>elem' :: (Eq a) =&gt; a -&gt; [a] -&gt; Bool  \nelem' y ys = foldl (\\acc x -&gt; if x == y then True else acc) False ys  \n</code></pre>\n\n<p>The explanation is understandable to me. </p>\n\n<blockquote>\n  <p>the left fold's binary function has the accumulator as the first parameter and the current value as the second one (so \\acc x -> ...)</p>\n</blockquote>\n\n<p>or I can write as</p>\n\n<pre><code>elem' :: (Eq a) =&gt; a -&gt; [a] -&gt; Bool\nelem' y ys = foldr (\\x acc -&gt; if x == y then True else acc) False ys\n</code></pre>\n\n<p>Anyone, can help/guide/explain me ? <br> \nMany thanks!</p>\n"}, {"tags": ["haskell", "applicative", "scotty"], "answers": [{"comments": [{"owner": {"reputation": 424, "user_id": 3889860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TfGyC.jpg?s=128&g=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/3889860/nobody"}, "edited": false, "score": 0, "creation_date": 1449582010, "post_id": 34157255, "comment_id": 56061345, "body": "Thanks for your reply, can we construct a new record by FullName &lt;$&gt; &quot;John&quot; &lt;*&gt; &quot;Hanks&quot; ? Why?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 424, "user_id": 3889860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TfGyC.jpg?s=128&g=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/3889860/nobody"}, "edited": false, "score": 0, "creation_date": 1449582562, "post_id": 34157255, "comment_id": 56061751, "body": "@nobody No, just use <code>FullName &quot;John&quot; &quot;Hanks&quot;</code> since those are strings, not actions. Use <code>&lt;$&gt;&#47;&lt;*&gt;</code> only when you have actions around, and you need to execute them to get their result."}, {"owner": {"reputation": 424, "user_id": 3889860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TfGyC.jpg?s=128&g=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/3889860/nobody"}, "edited": false, "score": 0, "creation_date": 1449585207, "post_id": 34157255, "comment_id": 56063653, "body": "Thank you very much for your explanation!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1449581635, "creation_date": 1449581635, "answer_id": 34157255, "question_id": 34157080, "link": "https://stackoverflow.com/questions/34157080/how-scotty-make-an-applicative-constructor/34157255#34157255", "title": "How Scotty make an Applicative constructor", "body": "<p>This is because <code>param \"fn\"</code> is <em>not</em> a <code>String</code>, but an <code>ActionM</code> which produces a <code>String</code>. We don't want to store the action inside <code>FullName</code>, we want to run the action, take its result, and store that.</p>\n\n<p>We could run the actions as follows</p>\n\n<pre><code>get \"/lastfirst/:fn/:ln\" $ do\n    fn &lt;- param \"fn\"\n    ln &lt;- param \"ln\"\n    let fullName = FullName fn ln\n    html $ fromString (lastFirst fullName)\n</code></pre>\n\n<p>but the applicative syntax is easier to read.</p>\n"}], "owner": {"reputation": 424, "user_id": 3889860, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/TfGyC.jpg?s=128&g=1", "display_name": "nobody", "link": "https://stackoverflow.com/users/3889860/nobody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 1, "accepted_answer_id": 34157255, "answer_count": 1, "score": 0, "last_activity_date": 1449633960, "creation_date": 1449581105, "last_edit_date": 1449633960, "question_id": 34157080, "link": "https://stackoverflow.com/questions/34157080/how-scotty-make-an-applicative-constructor", "title": "How Scotty make an Applicative constructor", "body": "<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Control.Applicative\n\nimport Data.Monoid\nimport Data.String\n\nimport Network.Wai.Middleware.RequestLogger\n\nimport Web.Scotty\n\ndata FullName = FullName { firstName :: String, lastName :: String }\n\nlastFirst :: FullName -&gt; String\nlastFirst fn = lastName fn ++ \", \" ++ firstName fn\n\nmain = scotty 3000 $ do\n    middleware logStdoutDev\n\n    get \"/lastfirst/:fn/:ln\" $ do\n        fullName &lt;- FullName &lt;$&gt; param \"fn\" &lt;*&gt; param \"ln\"\n        html $ fromString (lastFirst fullName)\n</code></pre>\n\n<p>You may notice that the last part of the code use applicative function to construct a record, can someone explain why it shouldn't be created as usual?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1449581147, "post_id": 34156788, "comment_id": 56060725, "body": "Try <code>f xs = iterate genLists (map (\\x -&gt; [x]) xs) where genLists xss = (:) &lt;$&gt; xs &lt;*&gt; xss</code>."}, {"owner": {"reputation": 33, "user_id": 5654573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0223a74ed3fc4eb747e774c07a6250f5?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil K", "link": "https://stackoverflow.com/users/5654573/kamil-k"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1449581390, "post_id": 34156788, "comment_id": 56060881, "body": "Undefined variable &quot;&lt;*&gt;&quot;"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1449581434, "post_id": 34156788, "comment_id": 56060909, "body": "Depending on the version of the Haskell platform that you&#39;re using, you may need to <code>import Control.Applicative</code>."}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1449581714, "post_id": 34157250, "comment_id": 56061141, "body": "OP is probably new to Haskell and doesn&#39;t know <code>Applicative</code> yet."}, {"owner": {"reputation": 33, "user_id": 5654573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0223a74ed3fc4eb747e774c07a6250f5?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil K", "link": "https://stackoverflow.com/users/5654573/kamil-k"}, "edited": false, "score": 0, "creation_date": 1449581873, "post_id": 34157250, "comment_id": 56061244, "body": "Hi thanks for sollution it works well. But the thing is that i cant import anything. So there have to be a sollution witout using Applicative type"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1449582363, "post_id": 34157250, "comment_id": 56061608, "body": "@Jubobs: Sure, but since this is a Hugs error message, I guess OP takes some kind of Haskell class with restricted imports or similar (haven&#39;t seen Hugs being used anywhere lately beside Haskell classes)"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1449582412, "post_id": 34157250, "comment_id": 56061643, "body": "@Zeta Good call. I didn&#39;t know this was a Hugs error message."}], "tags": [], "owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "is_accepted": false, "score": 1, "last_activity_date": 1449993500, "last_edit_date": 1449993500, "creation_date": 1449581610, "answer_id": 34157250, "question_id": 34156788, "link": "https://stackoverflow.com/questions/34156788/how-do-i-generate-all-combinations-of-list-elements-to-a-given-length-with-itera/34157250#34157250", "title": "How do I generate all combinations of list elements to a given length with iterate?", "body": "<p>Here is one possible implementation, using the applicative style (which you can learn more about <a href=\"http://learnyouahaskell.com/functors-applicative-functors-and-monoids#applicative-functors\" rel=\"nofollow\">here</a>).</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Control.Applicative\n\nf :: [a] -&gt; [[[a]]]\nf xs = iterate genLists $ map pure xs\n  where\n    genLists xss = (:) &lt;$&gt; xs &lt;*&gt; xss\n</code></pre>\n\n<p>Then,</p>\n\n<pre><code>\u03bb&gt; take 3 $ f [1,2]\n[[[1],[2]],[[1,1],[1,2],[2,1],[2,2]],[[1,1,1],[1,1,2],[1,2,1],[1,2,2],[2,1,1],[2,1,2],[2,2,1],[2,2,2]]]\n</code></pre>\n\n<p>Here is an alternative, if you don't want to or cannot use applicative stuff:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f :: [a] -&gt; [[[a]]]\nf xs = iterate genLists $ map (\\x -&gt; [x]) xs\n  where\n    genLists xss = [y : ys | y &lt;- xs, ys &lt;- xss]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 5654573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0223a74ed3fc4eb747e774c07a6250f5?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil K", "link": "https://stackoverflow.com/users/5654573/kamil-k"}, "edited": false, "score": 0, "creation_date": 1449582460, "post_id": 34157430, "comment_id": 56061675, "body": "You are rigth about those types. I didn&#39;t realized that.  Can i also ask why u wrote ys&lt;- ys ? What did u meant by that?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 33, "user_id": 5654573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0223a74ed3fc4eb747e774c07a6250f5?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil K", "link": "https://stackoverflow.com/users/5654573/kamil-k"}, "edited": false, "score": 0, "creation_date": 1449582493, "post_id": 34157430, "comment_id": 56061703, "body": "@KamilK: Copy error. Fixed ^^&quot;. Meant <code>ys &lt;- yss</code>, e.g. &quot;take one list of the list of lists&quot;."}, {"owner": {"reputation": 33, "user_id": 5654573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0223a74ed3fc4eb747e774c07a6250f5?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil K", "link": "https://stackoverflow.com/users/5654573/kamil-k"}, "edited": false, "score": 0, "creation_date": 1449582727, "post_id": 34157430, "comment_id": 56061877, "body": "Damn its good.  Thanks a lot. It is really good. I spent 2h on figuring why it didnt worked. Thanks one more time"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 2, "last_activity_date": 1449582397, "last_edit_date": 1449582397, "creation_date": 1449582093, "answer_id": 34157430, "question_id": 34156788, "link": "https://stackoverflow.com/questions/34156788/how-do-i-generate-all-combinations-of-list-elements-to-a-given-length-with-itera/34157430#34157430", "title": "How do I generate all combinations of list elements to a given length with iterate?", "body": "<p>Lets see why you get the error:</p>\n\n<pre><code>iterate  :: (a  -&gt; a    ) -&gt; a -&gt; [a]\ngenLists :: [a] -&gt; [[a]]\n</code></pre>\n\n<p>As you can see, <code>iterate</code> takes a function that takes and returns the same type. However, <code>genLists</code> doesn't do that. It takes a list and returns a list of lists.</p>\n\n<p>Since you actually want <code>f :: [a] -&gt; [[[a]]]</code>, <code>genLists</code> return type is actually fine. However, its argument type is wrong. It has to be of type <code>genLists :: [[a]] -&gt; [[a]]</code>:</p>\n\n<pre><code>f :: [a] -&gt; [[[a]]]\nf xs = iterate genLists [[x] | x &lt;- xs]\n    where\n       genLists yss = [ x : ys | x &lt;- xs , ys &lt;- yss]\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5654573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0223a74ed3fc4eb747e774c07a6250f5?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil K", "link": "https://stackoverflow.com/users/5654573/kamil-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 737, "favorite_count": 1, "accepted_answer_id": 34157430, "answer_count": 2, "score": 3, "last_activity_date": 1449993500, "creation_date": 1449580272, "last_edit_date": 1449582893, "question_id": 34156788, "link": "https://stackoverflow.com/questions/34156788/how-do-i-generate-all-combinations-of-list-elements-to-a-given-length-with-itera", "title": "How do I generate all combinations of list elements to a given length with iterate?", "body": "<p>I'm trying to write a function using <code>iterate</code> which should generate all combinations of the elements:</p>\n\n<pre><code>f :: [a] -&gt; [[[a]]]\nf [1,2] = \n  [ [[1] , [2]]                  -- all combinations of length 1\n  , [[1,1],[1,2],[2,1],[2,2]],   -- all combinations of length 2\n  , [[1,1,1],... ]               -- all combinations of length 3\n  , ...                          -- and so on\n  ]                              -- infinitely\n</code></pre>\n\n<p>I've tried the following approach</p>\n\n<pre><code>f :: [a] -&gt; [[[a]]]\nf list = iterate genLists list\n\ngenLists :: [a] -&gt; [[a]]       \ngenLists list  = [ [k] | k&lt;-list ] \n</code></pre>\n\n<p>However, Hugs gives me the following error:</p>\n\n<pre><code>Type error in application\n*** Expression     : iterate genLists list\n*** Term           : genLists\n*** Type           : [a] -&gt; [[a]]\n*** Does not match : [[a]] -&gt; [[a]]\n*** Because        : unification would give infinite type\n</code></pre>\n\n<p>I don't really know why I get the error. Also, how can I generate those combinations using only <code>iterate</code>? I cannot import any other module since this is an assignment.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1449579043, "post_id": 34156241, "comment_id": 56059407, "body": "What do <code>g</code> and <code>g&#39;</code> do? Depending on what you&#39;re trying to achieve, this may or may not be a sensible idea."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 6, "creation_date": 1449579169, "post_id": 34156241, "comment_id": 56059475, "body": "Yes, this function already exists as <code>either</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1449581131, "post_id": 34156241, "comment_id": 56060715, "body": "You just discovered how to eliminate a value in a sum type (<code>Either</code>). Nice! This is a fundamental operation in functional programming. As you saw, you indeed need two functions for that, one for each possible constructor (<code>Left&#47;Right</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 47690, "user_id": 55925, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4d4fbbf7cbb15f7076a5bc273f7fa039?s=128&d=identicon&r=PG", "display_name": "Johannes Weiss", "link": "https://stackoverflow.com/users/55925/johannes-weiss"}, "is_accepted": true, "score": 8, "last_activity_date": 1449579248, "creation_date": 1449579248, "answer_id": 34156435, "question_id": 34156241, "link": "https://stackoverflow.com/questions/34156241/haskell-accepting-different-types-and-acting-accordingly/34156435#34156435", "title": "Haskell - Accepting different types and acting accordingly", "body": "<p>So that definitely can make sense and one way to implement that is:</p>\n\n<pre><code>f :: Either Int String -&gt; IO ()\nf e =\n    case e of\n        Left l -&gt; g l\n        Right r -&gt; g' r\n</code></pre>\n\n<p>or using <a href=\"https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Either.html#v:either\"><code>either</code></a>:</p>\n\n<pre><code>import Data.Either (either)\nf :: Either Int String -&gt; IO ()\nf = either g g'\n</code></pre>\n\n<p>Note that in the second version I don't assign a variable name to the <code>Either Int String</code> argument. That is called <a href=\"https://wiki.haskell.org/Eta_conversion\">eta conversion / eta reduction</a>. But obviously you could also write <code>f e = either g g' e</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11669, "user_id": 76123, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c933fbb8685a083234fe385df8e9025f?s=128&d=identicon&r=PG", "display_name": "Daniel Pratt", "link": "https://stackoverflow.com/users/76123/daniel-pratt"}, "is_accepted": false, "score": 5, "last_activity_date": 1449579310, "creation_date": 1449579310, "answer_id": 34156459, "question_id": 34156241, "link": "https://stackoverflow.com/questions/34156241/haskell-accepting-different-types-and-acting-accordingly/34156459#34156459", "title": "Haskell - Accepting different types and acting accordingly", "body": "<p>As an armchair Haskell programmer, it seems fine to me.</p>\n\n<pre><code>f :: Either Int String -&gt; IO ()\nf (Left n) = g n\nf (Right s) = g' s\n</code></pre>\n"}], "owner": {"reputation": 757, "user_id": 5083453, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52685bd3fa5ba092cb58f2aa426dcd92?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica Nowak", "link": "https://stackoverflow.com/users/5083453/jessica-nowak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 2, "accepted_answer_id": 34156435, "answer_count": 2, "score": 7, "last_activity_date": 1449579310, "creation_date": 1449578625, "question_id": 34156241, "link": "https://stackoverflow.com/questions/34156241/haskell-accepting-different-types-and-acting-accordingly", "title": "Haskell - Accepting different types and acting accordingly", "body": "<p>Lets say I got the following very basic example:</p>\n\n<pre><code>f :: Either Int String -&gt; IO ()\n</code></pre>\n\n<p>as well as a function <code>g :: Int -&gt; IO ()</code> and a function <code>g' :: String -&gt; IO ()</code> and I basically want to implement <code>f</code> as a \"selector\" which calls <code>g</code> or <code>g'</code> depending on its input, so that in the future I only have to work with <code>f</code> because I know that my program will only encounter either Int or String.</p>\n\n<p>Does this way of using <code>Either</code> make sense? The convention seems to be to use it mainly for Error and Exception handling.</p>\n\n<p>If it does make sense, what would be a good way or best practice to implement such an example? I've heard/read about <code>case</code> as well as bifunctors.</p>\n\n<p>If it does not: what is the haskell way of handling the possibility of different input types? Or is this something which should be avoided from the beginning?</p>\n"}, {"tags": ["haskell", "numeric"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449580665, "post_id": 34155866, "comment_id": 56060403, "body": "I find it hard to tell whether &quot;full precision&quot; of a floating point is intended to include <code>.0</code> or not. I&#39;d think it should omit that, as you assumed."}, {"owner": {"reputation": 7542, "user_id": 1866775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4K99R.jpg?s=128&g=1", "display_name": "Tobias Hermann", "link": "https://stackoverflow.com/users/1866775/tobias-hermann"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449581854, "post_id": 34155866, "comment_id": 56061239, "body": "I&#39;d expect the <code>0.</code> only from <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Numeric.html#v:showFFloatAlt\" rel=\"nofollow noreferrer\">showFFloatAlt</a>. Added this remark to my question."}, {"owner": {"reputation": 34030, "user_id": 1993366, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dGJXl.png?s=128&g=1", "display_name": "vikingsteve", "link": "https://stackoverflow.com/users/1993366/vikingsteve"}, "edited": false, "score": 0, "creation_date": 1449583766, "post_id": 34155866, "comment_id": 56062629, "body": "What does the documentation mean by &quot;full precision&quot; ? It refers to that term several times in the context."}], "answers": [{"comments": [{"owner": {"reputation": 7542, "user_id": 1866775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4K99R.jpg?s=128&g=1", "display_name": "Tobias Hermann", "link": "https://stackoverflow.com/users/1866775/tobias-hermann"}, "edited": false, "score": 0, "creation_date": 1449653036, "post_id": 34174256, "comment_id": 56096838, "body": "Yes, using <code>Just 0</code> results in <code>&quot;42&quot;</code>, but that is not an optimal solution for cases like <code>42.34</code>. Additionally there should be a difference between <code>showFFloat</code> and <code>showFFloatAlt</code>."}, {"owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "reply_to_user": {"reputation": 7542, "user_id": 1866775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4K99R.jpg?s=128&g=1", "display_name": "Tobias Hermann", "link": "https://stackoverflow.com/users/1866775/tobias-hermann"}, "edited": false, "score": 0, "creation_date": 1449653414, "post_id": 34174256, "comment_id": 56097106, "body": "It probably does. The <code>Alt</code> versions only difference is to guarantee the presence of the decimal point, even if not needed. While this might imply that values exists, for which <code>showFFloat</code> ommits the decimal point, it does not imply that it always ommits it when possible. Although I second you on that being a sensible guarantee that should be included. Thus, the function is not broken, rather insensibly defined:)"}, {"owner": {"reputation": 7542, "user_id": 1866775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4K99R.jpg?s=128&g=1", "display_name": "Tobias Hermann", "link": "https://stackoverflow.com/users/1866775/tobias-hermann"}, "edited": false, "score": 0, "creation_date": 1449654997, "post_id": 34174256, "comment_id": 56098149, "body": "OK, thanks. So I will have to use something along these lines: <a href=\"http://ideone.com/7x3clc\" rel=\"nofollow noreferrer\">ideone.com/7x3clc</a>"}], "tags": [], "owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "is_accepted": true, "score": 2, "last_activity_date": 1449650624, "creation_date": 1449650624, "answer_id": 34174256, "question_id": 34155866, "link": "https://stackoverflow.com/questions/34155866/float-to-string-with-optional-decimal-point/34174256#34174256", "title": "Float to String with optional decimal point", "body": "<p>I'd expect that result. 'Full precision' seems to include 'minimum uncertancy'. From <code>123</code>, one cannot know if it has been rounded, from <code>123.0</code> one can. Using <code>Just 0</code> instead of <code>Nothing</code> should conform to your expectations.</p>\n"}], "owner": {"reputation": 7542, "user_id": 1866775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/4K99R.jpg?s=128&g=1", "display_name": "Tobias Hermann", "link": "https://stackoverflow.com/users/1866775/tobias-hermann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 34174256, "answer_count": 1, "score": 2, "last_activity_date": 1449650624, "creation_date": 1449577498, "last_edit_date": 1449581414, "question_id": 34155866, "link": "https://stackoverflow.com/questions/34155866/float-to-string-with-optional-decimal-point", "title": "Float to String with optional decimal point", "body": "<p>I expect the following code to output <code>123</code>, <a href=\"http://ideone.com/cAVqa1\" rel=\"nofollow\">but instead it prints <code>123.0</code></a>.</p>\n\n<pre><code>import Numeric\nmain = putStrLn $ showFFloat Nothing 123 \"\"\n</code></pre>\n\n<p>Is <code>showFFloat</code> broken, or do I misread the <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Numeric.html#v:showFFloat\" rel=\"nofollow\">documentation</a>?</p>\n\n<p>I would expect this behavior only from <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Numeric.html#v:showFFloatAlt\" rel=\"nofollow\">showFFloatAlt</a>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1449574478, "post_id": 34154784, "comment_id": 56056422, "body": "Edit your question and add your best attempt at an implementation so far."}], "answers": [{"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1449578076, "post_id": 34154925, "comment_id": 56058853, "body": "I downvoted, because this answer makes the problem more complicated. A reader is assumed to reverse-engineer the meaning of <code>groupBy</code> and <code>span</code> and then decide how to hack the existing code. This looks like a puzzle, not like a hint."}, {"owner": {"reputation": 2535, "user_id": 634020, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/044be669886e6b2e625776ff8be167b7?s=128&d=identicon&r=PG", "display_name": "Philip Kamenarsky", "link": "https://stackoverflow.com/users/634020/philip-kamenarsky"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1449578984, "post_id": 34154925, "comment_id": 56059371, "body": "@user3237465: Actually, it shows you how to inspect, understand and modify existing code on Hackage, which, in my opinion, is much more valuable than just saying &quot;here is your homework for you&quot;. I&#39;ve done it myself on a number of occasions."}, {"owner": {"reputation": 34030, "user_id": 1993366, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dGJXl.png?s=128&g=1", "display_name": "vikingsteve", "link": "https://stackoverflow.com/users/1993366/vikingsteve"}, "edited": false, "score": 0, "creation_date": 1449581999, "post_id": 34154925, "comment_id": 56061335, "body": "Well, you showed the stuff on hackage but you didn&#39;t provide a real answer."}], "tags": [], "owner": {"reputation": 2535, "user_id": 634020, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/044be669886e6b2e625776ff8be167b7?s=128&d=identicon&r=PG", "display_name": "Philip Kamenarsky", "link": "https://stackoverflow.com/users/634020/philip-kamenarsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1449574701, "creation_date": 1449574701, "answer_id": 34154925, "question_id": 34154784, "link": "https://stackoverflow.com/questions/34154784/haskell-set-a-limit-to-the-group-function/34154925#34154925", "title": "Haskell - Set a limit to the &quot;group&quot; function", "body": "<p>The cool thing about Haskell is that most packages are open source. If you go on Hackage, you can look up the source of every function (click on \"Source\" to the right).</p>\n\n<p>So let's see how <code>group</code> is <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html#v:group\" rel=\"nofollow\">defined</a>:</p>\n\n<pre><code>group                   :: Eq a =&gt; [a] -&gt; [[a]]\ngroup                   =  groupBy (==)\n</code></pre>\n\n<p>All, right, so we need <code>groupBy</code>:</p>\n\n<pre><code>groupBy                 :: (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]\ngroupBy _  []           =  []\ngroupBy eq (x:xs)       =  (x:ys) : groupBy eq zs\n                           where (ys,zs) = span (eq x) xs\n</code></pre>\n\n<p>Next, <code>span</code>:</p>\n\n<pre><code>span _ xs@[]            =  (xs, xs)\nspan p xs@(x:xs')\n         | p x          =  let (ys,zs) = span p xs' in (x:ys,zs)\n         | otherwise    =  ([],xs)\n</code></pre>\n\n<p>Now it shouldn't be too hard to add a limit to <code>span</code> and use this new version in a modified <code>groupBy</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 34030, "user_id": 1993366, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dGJXl.png?s=128&g=1", "display_name": "vikingsteve", "link": "https://stackoverflow.com/users/1993366/vikingsteve"}, "edited": false, "score": 0, "creation_date": 1449581795, "post_id": 34155830, "comment_id": 56061205, "body": "Thanks for the <code>chunksOf</code> tip. I think however he will need to &quot;flatten&quot; the end result via <code>concat</code>."}, {"owner": {"reputation": 34030, "user_id": 1993366, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dGJXl.png?s=128&g=1", "display_name": "vikingsteve", "link": "https://stackoverflow.com/users/1993366/vikingsteve"}, "edited": false, "score": 0, "creation_date": 1449582124, "post_id": 34155830, "comment_id": 56061424, "body": "Right, ok. But for me as a beginner I recognize <code>&gt;&gt;=</code> as a monad operator. Why did you use it here rather than concat - is this some sort of quick hack?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 34030, "user_id": 1993366, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dGJXl.png?s=128&g=1", "display_name": "vikingsteve", "link": "https://stackoverflow.com/users/1993366/vikingsteve"}, "edited": false, "score": 0, "creation_date": 1449582324, "post_id": 34155830, "comment_id": 56061579, "body": "@vikingsteve, that just looks nicer to me. I changed the code to make it more explicit."}, {"owner": {"reputation": 34030, "user_id": 1993366, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dGJXl.png?s=128&g=1", "display_name": "vikingsteve", "link": "https://stackoverflow.com/users/1993366/vikingsteve"}, "edited": false, "score": 0, "creation_date": 1449582535, "post_id": 34155830, "comment_id": 56061733, "body": "Wow, and you tought me about <code>concatMap</code> at the same time. Awesome - thank you!"}, {"owner": {"reputation": 149, "user_id": 5498865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iCmWc.png?s=128&g=1", "display_name": "Fossa", "link": "https://stackoverflow.com/users/5498865/fossa"}, "edited": false, "score": 0, "creation_date": 1449583123, "post_id": 34155830, "comment_id": 56062171, "body": "Your answer is very clear and proposes a simple solution, awesome!  But how can I implement <code>chunksOf</code> on my own?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 149, "user_id": 5498865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iCmWc.png?s=128&g=1", "display_name": "Fossa", "link": "https://stackoverflow.com/users/5498865/fossa"}, "edited": false, "score": 0, "creation_date": 1449583360, "post_id": 34155830, "comment_id": 56062333, "body": "@Fossa, see <a href=\"http://stackoverflow.com/questions/8680888/subdividing-a-list-in-haskell\">this</a> question."}, {"owner": {"reputation": 149, "user_id": 5498865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iCmWc.png?s=128&g=1", "display_name": "Fossa", "link": "https://stackoverflow.com/users/5498865/fossa"}, "edited": false, "score": 0, "creation_date": 1449585300, "post_id": 34155830, "comment_id": 56063726, "body": "Perfect, I solved my problem in the most clear way possible. Thank you!"}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 4, "last_activity_date": 1449582262, "last_edit_date": 1449582262, "creation_date": 1449577425, "answer_id": 34155830, "question_id": 34154784, "link": "https://stackoverflow.com/questions/34154784/haskell-set-a-limit-to-the-group-function/34155830#34155830", "title": "Haskell - Set a limit to the &quot;group&quot; function", "body": "<p>You can first group the elements of a list, then split all sublists and concat the results:</p>\n\n<pre><code>groupWithLimit :: Eq a =&gt; Int -&gt; [a] -&gt; [[a]]\ngroupWithLimit n xs = concatMap (chunksOf n) (group xs)\n</code></pre>\n\n<p>E.g. <code>chunksOf 2 \"aaaaa\"</code> is <code>[\"aa\",\"aa\",\"a\"]</code>. You can find <code>chunksOf</code> <a href=\"https://hackage.haskell.org/package/split-0.2.2/docs/Data-List-Split.html#v:chunksOf\" rel=\"nofollow\">here</a> or implement it yourself.</p>\n"}], "owner": {"reputation": 149, "user_id": 5498865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iCmWc.png?s=128&g=1", "display_name": "Fossa", "link": "https://stackoverflow.com/users/5498865/fossa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 1, "accepted_answer_id": 34155830, "answer_count": 2, "score": 1, "last_activity_date": 1449582262, "creation_date": 1449574286, "question_id": 34154784, "link": "https://stackoverflow.com/questions/34154784/haskell-set-a-limit-to-the-group-function", "title": "Haskell - Set a limit to the &quot;group&quot; function", "body": "<p>I need to use the <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html#v:group\" rel=\"nofollow\">group</a> function but I want to set a maximum limit to the number of elements in a single group and, if the limit is reached, the function should add another list with the remains elements right next to the first one.\nIn other words, I want to implement another version of <em>group</em> that does something like that:</p>\n\n<pre><code>groupWithLimit \"abbcccddeeee\" 2 \n=\n[\"a\",\"bb\",\"cc\",\"c\",\"dd\",\"ee\",\"ee\"]\n</code></pre>\n\n<p>These should be the types and the definition</p>\n\n<pre><code>groupWithLimit :: [a]-&gt; Int -&gt; [[a]]\ngroupWithLimit (x:xs) limit = ...\n</code></pre>\n\n<p>I tried with map and the lambda expressions but I didn't manage to do it...</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["haskell", "haskell-lens", "isomorphism", "bifunctor"], "answers": [{"comments": [{"owner": {"reputation": 4773, "user_id": 4148211, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/DiKJf.jpg?s=128&g=1", "display_name": "frasertweedale", "link": "https://stackoverflow.com/users/4148211/frasertweedale"}, "edited": false, "score": 1, "creation_date": 1449621358, "post_id": 34161995, "comment_id": 56084909, "body": "Thanks for the breakdown; <code>bimapping p id</code> is nice.  Sometimes with all the fancy type synonyms I overlook that optics are just functions :)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 4773, "user_id": 4148211, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/DiKJf.jpg?s=128&g=1", "display_name": "frasertweedale", "link": "https://stackoverflow.com/users/4148211/frasertweedale"}, "edited": false, "score": 0, "creation_date": 1449625211, "post_id": 34161995, "comment_id": 56086024, "body": "@frasertweedale, you&#39;re welcome. I&#39;ve written <code>seconding</code>,  generalized the types of that and <code>firsting</code> to allow two different bifunctors (as in <code>bimapping</code>), and suggested my preferred implementations <a href=\"https://github.com/ekmett/lens/pull/619\" rel=\"nofollow noreferrer\">on GitHib</a>."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 3, "last_activity_date": 1449681307, "last_edit_date": 1449681307, "creation_date": 1449594903, "answer_id": 34161995, "question_id": 34154211, "link": "https://stackoverflow.com/questions/34154211/lifting-an-iso-into-the-first-argument-of-a-bifunctor/34161995#34161995", "title": "Lifting an Iso into the first argument of a Bifunctor", "body": "<h3>Update</h3>\n\n<p>Thanks to your question, the next version of <code>Control.Lens.Iso</code> <a href=\"https://github.com/ekmett/lens/commit/0da78a979f4da1a969b319eda995003ac4b322ef\" rel=\"nofollow\">will include</a> <code>firsting</code> and <code>seconding</code>.</p>\n\n<hr>\n\n<p><code>iso id id</code> looks a bit ugly. Let's try to take that apart.</p>\n\n<pre><code>type Iso s t a b =\n  forall f p . (Functor f, Profunctor p) =&gt;\n                               p a (f b) -&gt; p s (f t)\n\n--plain :: Iso s t s t\n--plain = iso id id\n\nplain :: (Functor f, Profunctor p) =&gt; p s (f t) -&gt; p s (f t)\nplain = id\n</code></pre>\n\n<p>So you can cut your implementation down to</p>\n\n<pre><code>firsting p = bimapping p id\n</code></pre>\n\n<p>This is probably the most concise form. If you want to really get to the bare bones, of it, read on.</p>\n\n<p>Inlining the definition of <code>bimapping</code></p>\n\n<pre><code>bimapping :: (Bifunctor f, Bifunctor g) =&gt; AnIso s t a b -&gt; AnIso s' t' a' b' -&gt; Iso (f s s') (g t t') (f a a') (g b b')\nbimapping f g = withIso f $ \\ sa bt -&gt; withIso g $ \\s'a' b't' -&gt;\n  iso (bimap sa s'a') (bimap bt b't')\n</code></pre>\n\n<p>and simplifying using <code>first</code>, you get</p>\n\n<pre><code>firsting p = withIso p $ \\ sa bt -&gt;\n             iso (first sa) (first bt)\n</code></pre>\n\n<p>This is a particularly clear expression, I think. It uses <code>withIso</code> to break <code>p</code> into the two functions that make up the isomorphism, uses <code>first</code> to lift each of them to apply to the first argument of the bifunctor, and then packages them back up with <code>iso</code>. If the relevant bifunctor has an optimized <code>first</code> that does something better than can be done with <code>bimap</code>, then this will also be faster than the implementation using <code>bimapping</code>.</p>\n\n<p>Inlining <code>iso</code> gives</p>\n\n<pre><code>firsting p = withIso p $ \\ sa bt -&gt;\n             dimap (first sa) (fmap (first bt))\n</code></pre>\n\n<p>Finally, inlining <code>withIso</code> (digging into <code>Control.Lens.Internal.Iso</code>, which we probably shouldn't do),</p>\n\n<pre><code>firsting p =\n  case p (Exchange id Identity) of\n    Exchange sa bt -&gt;\n      dimap (first sa) (fmap (first (runIdentity #. bt)))\n</code></pre>\n\n<hr>\n\n<p>By the way, the type signature for <code>plain</code>, without the redundant context, is</p>\n\n<pre><code>plain :: p s (f t) -&gt; p s (f t)\n</code></pre>\n\n<p>This is exactly the same as</p>\n\n<pre><code>plain :: Equality s t s t\n</code></pre>\n"}], "owner": {"reputation": 4773, "user_id": 4148211, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/DiKJf.jpg?s=128&g=1", "display_name": "frasertweedale", "link": "https://stackoverflow.com/users/4148211/frasertweedale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "accepted_answer_id": 34161995, "answer_count": 1, "score": 3, "last_activity_date": 1449681307, "creation_date": 1449572615, "question_id": 34154211, "link": "https://stackoverflow.com/questions/34154211/lifting-an-iso-into-the-first-argument-of-a-bifunctor", "title": "Lifting an Iso into the first argument of a Bifunctor", "body": "<p><code>Control.Lens.Iso</code> contains many wonderful functions for lifting <code>Iso</code>s into various type arguments of useful abstractions.  For example:</p>\n\n<ul>\n<li><code>mapping</code> for arbitrary <code>Functor</code>s</li>\n<li><code>contramapping</code> for <code>Contravariant</code> functors</li>\n<li><code>dimapping</code>, <code>lmapping</code> and <code>rmapping</code> for <code>Profunctor</code>s</li>\n<li><code>bimapping</code> for <code>Bifunctor</code>s</li>\n</ul>\n\n<p>I am looking for the function to lift an <code>Iso</code> into the <code>first</code> argument of a <code>Bifunctor</code>, but it doesn't seem to be there.  I am currently defining it thusly:</p>\n\n<pre><code>firsting\n  :: Bifunctor f\n  =&gt; AnIso s t a b\n  -&gt; Iso (f s x) (f t y) (f a x) (f b y)\nfirsting p = bimapping p (iso id id)\n</code></pre>\n\n<p>Does this function already exist somewhere, or is <code>bimapping p (iso id id)</code> as good as it gets?</p>\n"}, {"tags": ["haskell", "monads", "lenses"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5653698, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M2N1hCNegFY/AAAAAAAAAAI/AAAAAAAAAOM/8SvRnaNx-og/photo.jpg?sz=128", "display_name": "S i", "link": "https://stackoverflow.com/users/5653698/s-i"}, "edited": false, "score": 0, "creation_date": 1451576135, "post_id": 34407461, "comment_id": 56838870, "body": "That&#39;s great, thanks. I had been looking for an overly generic (read impossible) way to do this."}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 0, "last_activity_date": 1450750388, "creation_date": 1450750388, "answer_id": 34407461, "question_id": 34152747, "link": "https://stackoverflow.com/questions/34152747/how-can-i-lift-an-fclabels-lens-to-a-monad/34407461#34407461", "title": "How can I lift an fclabels Lens to a Monad?", "body": "<p>Instead of trying to write it all in one go in point-free style, why not just write it in long-hand?</p>\n\n<pre><code>liftMLens :: (Monad m) =&gt; a :-&gt; b -&gt; m a :-&gt; m b\nliftMLens l = lens (liftM $ get l) $ \\f mx -&gt; do\n    x &lt;- mx\n    let v = get l x\n    v' &lt;- f $ return v\n    return $ set l v' x\n</code></pre>\n\n<p>Of course you can then code-golf it if you really want to...</p>\n"}], "owner": {"reputation": 3, "user_id": 5653698, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M2N1hCNegFY/AAAAAAAAAAI/AAAAAAAAAOM/8SvRnaNx-og/photo.jpg?sz=128", "display_name": "S i", "link": "https://stackoverflow.com/users/5653698/s-i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 1, "accepted_answer_id": 34407461, "answer_count": 1, "score": 0, "last_activity_date": 1450750545, "creation_date": 1449568269, "last_edit_date": 1450750545, "question_id": 34152747, "link": "https://stackoverflow.com/questions/34152747/how-can-i-lift-an-fclabels-lens-to-a-monad", "title": "How can I lift an fclabels Lens to a Monad?", "body": "<p>I'm trying to update some old code using <a href=\"https://hackage.haskell.org/package/fclabels\" rel=\"nofollow\">fclabels</a>, from <a href=\"https://hackage.haskell.org/package/fclabels-0.4.0\" rel=\"nofollow\">v0.4</a> to <a href=\"https://hackage.haskell.org/package/fclabels-2.0\" rel=\"nofollow\">v2.0</a> (lts-3.17), that lifts a <code>label</code>/<code>lens</code> to a monad. The old code is:</p>\n\n<pre><code>{-# LANGUAGE TypeOperators #-}\nimport Data.Record.Label\nimport Control.Monad (liftM, liftM2)\n\nliftMLabel :: Monad m =&gt; a :-&gt; b -&gt; m a :-&gt; m b\nliftMLabel l = label (liftM $ get l) (liftM2 $ set l)\n</code></pre>\n\n<p>So the first thing I did was change <code>label</code> to <code>lens</code>, and <code>set</code> to <code>modify</code>:</p>\n\n<pre><code>{-# LANGUAGE TypeOperators #-}\nimport Data.Label\nimport Control.Monad (liftM, liftM2)\n\nliftMLabel :: Monad m =&gt; a :-&gt; b -&gt; m a :-&gt; m b\nliftMLens l = lens (liftM $ get l) (liftM2 $ modify l)\n</code></pre>\n\n<p>This gave the following compiler error:</p>\n\n<pre><code>Expected type: (m b -&gt; m b) -&gt; m a -&gt; m a\n  Actual type: m (b -&gt; b) -&gt; m a -&gt; m a\n</code></pre>\n\n<p>Which makes sense, giving how <code>liftM2</code> would treat each arg of the <code>lens</code> <code>modify</code> function.</p>\n\n<p>The old fclabels used a setter function for creating a label, which accepts a simple value argument. The <code>modify</code> function, used for creating newer fclabels lenses, takes a function for modifying using the existing value, and I see why it too will operate on monadic arguments.</p>\n\n<p>I'll need to perform some extra plumbing for the modify function, and I see that <code>ap</code> does something similar to what I want, but it's not clear to me what the best approach is in totality.</p>\n\n<p>So what is a good way to deal with the <code>modify</code> function, so I can match the expected type?</p>\n"}, {"tags": ["haskell", "typeerror"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449551828, "post_id": 34148419, "comment_id": 56044473, "body": "The type of <code>fromMaybe</code> is <code>forall . a -&gt; Maybe a -&gt; a</code>. Therefore, the type of <code>fromMaybe $ x</code> is <code>Maybe a -&gt; a</code> for some <code>x :: a</code>. Regardless of what type <code>a</code> is, you can see this already must be a type error - the body of the function <code>findPrime</code> must have type <code>Int</code>, which it evidently doesn&#39;t. You probably want <code>fromJust</code> (which handles the Nothing case with an error) because <code>find isPrime [here..]</code> is never <code>Nothing</code> - the compiler doesn&#39;t know this, but of course we do. Or <code>head $ filter isPrime [here..]</code>."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449552380, "post_id": 34148419, "comment_id": 56044664, "body": "@user2407038: That would have been a nice answer (although some aren&#39;t familiar with the explicit <code>forall a. a -&gt; \u2026</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 4, "last_activity_date": 1449552058, "last_edit_date": 1449552058, "creation_date": 1449551733, "answer_id": 34148507, "question_id": 34148419, "link": "https://stackoverflow.com/questions/34148419/cant-figure-out-this-type-error/34148507#34148507", "title": "Can&#39;t figure out this type error", "body": "<p><code>fromMaybe</code> expects a fall-back value if the provided <code>Maybe a</code> is <code>Nothing</code>:</p>\n\n<pre><code>fromMaybe :: a -&gt; Maybe a -&gt; a\nfromMaybe _ (Just x) = x\nfromMaybe a Nothing  = a\n</code></pre>\n\n<p>In <code>findPrime</code> you're missing that first argument, thus ending up with the wrong type:</p>\n\n<pre><code>findPrime here = (fromMaybe $ find (\\x -&gt; isPrime x) [here..])\n              -- ^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>We can have a look at the types to verify that this is actually the error:</p>\n\n<pre><code>           find (\\x -&gt; isPrime x) [here..]  :: Maybe Int\nfromMaybe                                   :: a         -&gt; Maybe a           -&gt; a\nfromMaybe (find (\\x -&gt; isPrime x) [here..]) ::           -&gt; Maybe (Maybe Int) -&gt; Maybe Int\n</code></pre>\n\n<p>Which is exactly the erroneous type you see.</p>\n\n<h3>Quick solution</h3>\n\n<p>If you're certain that <code>find</code> will <strong>always</strong> return <code>Just x</code>, you can use <code>fromJust</code>. Note that <code>fromJust</code> is partial, it will throw an exception if you use it on <code>Nothing</code>.</p>\n\n<p>Note that <code>fromJust $ find p xs</code> is the same as <code>head $ filter p xs</code>, which doesn't need additional imports.</p>\n"}], "owner": {"reputation": 137, "user_id": 5486662, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/isNIe.jpg?s=128&g=1", "display_name": "GuitarGuy365", "link": "https://stackoverflow.com/users/5486662/guitarguy365"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 34148507, "answer_count": 1, "score": 0, "last_activity_date": 1449552058, "creation_date": 1449551227, "question_id": 34148419, "link": "https://stackoverflow.com/questions/34148419/cant-figure-out-this-type-error", "title": "Can&#39;t figure out this type error", "body": "<p>I am still pretty inexperienced at Haskell. That being said, I am having a very hard time finding out where this type the compiler is finding in my code <code>Maybe (Maybe Int) -&gt; Maybe Int</code> From what I can tell the only thing that should be returned are Int values.  </p>\n\n<pre><code>findThisPrime :: Int -&gt; Int\nfindThisPrime num = calcPrime 1 num\n    where calcPrime :: Int -&gt; Int -&gt; Int\n          calcPrime curr 0 = curr\n          calcPrime curr num = calcPrime (findPrime curr) (num - 1)\n          findPrime :: Int -&gt; Int\n          findPrime here = (fromMaybe $ find (\\x -&gt; isPrime x) [here..])\n</code></pre>\n\n<p>Error: </p>\n\n<pre><code>hs&gt; :l projectEuler\n[1 of 1] Compiling Main             ( projectEuler.hs, interpreted )\n\nprojectEuler.hs:48:33:\n    Couldn't match expected type `Int'\n            with actual type `Maybe (Maybe Int) -&gt; Maybe Int'\n    In the expression: (fromMaybe $ find (\\ x -&gt; isPrime x) [here .. ])\n    In an equation for `findPrime':\n        findPrime here = (fromMaybe $ find (\\ x -&gt; isPrime x) [here .. ])\n    In an equation for `findThisPrime':\n        findThisPrime num\n          = calcPrime 1 num\n          where\n              calcPrime :: Int -&gt; Int -&gt; Int\n              calcPrime curr 0 = curr\n              calcPrime curr num = calcPrime (findPrime curr) (num - 1)\n              findPrime :: Int -&gt; Int\n              findPrime here = (fromMaybe $ find (\\ x -&gt; isPrime x) [here .. ])\nFailed, modules loaded: none.\n</code></pre>\n\n<p>isPrime is a function that takes an Int, checks if it is prime, and returns a Bool.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 0, "creation_date": 1449544804, "post_id": 34147296, "comment_id": 56042527, "body": "What is the type of the values under <code>Maybe</code>? <code>Number</code>, <code>String</code>, etc.?"}, {"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 1, "creation_date": 1449544884, "post_id": 34147296, "comment_id": 56042549, "body": "It looks like you have a list of strings, not of <code>Maybe</code>. Perhaps the function you have called mapped <code>show</code> over your data?"}, {"owner": {"reputation": 597, "user_id": 2157021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5f361d3bd72832787dc2b79ce78de71?s=128&d=identicon&r=PG", "display_name": "amar47shah", "link": "https://stackoverflow.com/users/2157021/amar47shah"}, "edited": false, "score": 1, "creation_date": 1449544950, "post_id": 34147296, "comment_id": 56042561, "body": "Could you post the code for the function that produces the output at the top of your question?"}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1449545505, "post_id": 34147296, "comment_id": 56042715, "body": "@Koterpiller Aeson returns the data type when I use <code>prism</code> to obtain a particular value. so Number is an Int and String is a String"}, {"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 0, "creation_date": 1449545552, "post_id": 34147296, "comment_id": 56042730, "body": "@matthias remove all the <code>show</code> calls and apply <code>catMaybe</code> to the result of <code>f</code>."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "reply_to_user": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 0, "creation_date": 1449546852, "post_id": 34147296, "comment_id": 56043051, "body": "@Koterpillar the values returned from the JSON are not homogeneous. I have the shows in there to get a list of strings."}, {"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 0, "creation_date": 1449546910, "post_id": 34147296, "comment_id": 56043067, "body": "You can apply <code>show</code> later, after you extract values from <code>Maybe</code>s."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1449547394, "post_id": 34147296, "comment_id": 56043203, "body": "I get  <code>[ Number 8000.0,  Number 93.0, String &quot;test&quot;]</code>. So the &quot;Just&quot; has been removed but I still have the data type names in there. Also, won&#39;t  using <code>catMaybes</code> remove instances of <code>nothing</code> ???? I still would like to keep  them in there."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1449551356, "post_id": 34147296, "comment_id": 56044328, "body": "It seems like you somehow want to keep the Nothing values... Replace <code>show $ ...</code> with <code>maybe &quot;Nothing&quot; show $ ...</code> ? This still prints the string <code>&quot;Nothing&quot;</code> for any such values in the list, but prints the <code>Just</code> values without the <code>&quot;Just&quot;</code>."}, {"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 0, "creation_date": 1449606941, "post_id": 34147296, "comment_id": 56078142, "body": "@matthias updated my answer to convert everything to strings."}], "answers": [{"comments": [{"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1449545073, "post_id": 34147382, "comment_id": 56042596, "body": "I am not trying to discard the <code>Nothings</code>, I am trying to remove the string &quot;Just&quot; and &quot;Number&quot; or &quot;String&quot; from the output when printed."}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 3, "creation_date": 1449545480, "post_id": 34147382, "comment_id": 56042707, "body": "Your probably ought to expand your example to demonstrate the behavior you want when the list contains a <code>Nothing</code>, then."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1449545659, "post_id": 34147382, "comment_id": 56042751, "body": "@ChrisMartin. Having &quot;Nothing&quot; in the list is fine for my purposes."}, {"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "reply_to_user": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1449563810, "post_id": 34147382, "comment_id": 56049515, "body": "@matthias You just have to remove <code>show</code> and you won&#39;t have any <code>&quot;Just&quot;</code> and such. Just do <code>map show . catMaybes $ f x</code>."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1449616935, "post_id": 34147382, "comment_id": 56083282, "body": "@koterpiller thank you for this. I have learned a lot from your posts."}], "tags": [], "owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "is_accepted": true, "score": 8, "last_activity_date": 1449606909, "last_edit_date": 1449606909, "creation_date": 1449544694, "answer_id": 34147382, "question_id": 34147296, "link": "https://stackoverflow.com/questions/34147296/obtaining-only-value-component-of-a-maybe-in-haskell/34147382#34147382", "title": "Obtaining only Value component of a Maybe in Haskell", "body": "<p><a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Maybe.html#v:catMaybes\" rel=\"nofollow noreferrer\">catMaybes</a> from <code>Data.Maybe</code> will only leave <code>Just</code> values in the list, discarding any <code>Nothing</code>s.</p>\n\n<p>(Hint: you can use Hoogle search for <a href=\"https://www.haskell.org/hoogle/?hoogle=%5BMaybe%20a%5D%20-%3E%20%5Ba%5D\" rel=\"nofollow noreferrer\">[Maybe a] -> [a]</a>).</p>\n\n<p>Updated: if you want to replace <code>Nothing</code> with something else, use <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Maybe.html#v:fromMaybe\" rel=\"nofollow noreferrer\">fromMaybe</a> with your default value, i.e.</p>\n\n<p><code>map (fromMaybe \"Nothing\") (f x)</code></p>\n\n<p>It also looks like you have strings instead of <code>Maybe</code> inside the list; you'll have to remove <code>show</code> call from each element.</p>\n\n<p>Updated again: let's convert everything to strings!</p>\n\n<pre><code>map (fromMaybe \"nothing\" . fmap show)\n</code></pre>\n\n<p>The outer <code>map</code> applies the transformation to each element. <code>fmap show</code> converts the values inside <code>Just</code> to strings and leaves <code>Nothing</code> alone (note the number <code>1</code> converted to a string <code>\"1\"</code>:</p>\n\n<pre><code>&gt; map (fmap show) [Just 1, Nothing]\n[Just \"1\",Nothing]\n</code></pre>\n\n<p>Then <code>fromMaybe \"nothing\"</code> unpacks <code>Just</code> values and replaces <code>Nothing</code> with a string of your choice.</p>\n\n<pre><code>&gt; map (fromMaybe \"nothing\" . fmap show) [Just 1, Nothing]\n[\"1\",\"nothing\"]\n</code></pre>\n\n<p>I suggest you pay closer attention to types while using Haskell, converting everything to strings removes the benefits of using a well-typed language.</p>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 34147382, "answer_count": 1, "score": 1, "last_activity_date": 1449606909, "creation_date": 1449544090, "last_edit_date": 1449545738, "question_id": 34147296, "link": "https://stackoverflow.com/questions/34147296/obtaining-only-value-component-of-a-maybe-in-haskell", "title": "Obtaining only Value component of a Maybe in Haskell", "body": "<p>have a function that is returning:</p>\n\n<p><code>&gt;&gt;&gt; [\"Just (Number 8000.0)\",\"Just (Number 93.0)\",\"Just (String \\\"test\\\")\"]</code></p>\n\n<p>What is the best way to get just the values?</p>\n\n<p><code>&gt;&gt;&gt; [\"8000.0\", \"93.0\", \"test\"]</code></p>\n\n<p>The code is trying to parse JSON, using <code>prism</code>s from Aeson.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>jsonFile :: FilePath\njsonFile = \"test.json\"\n\ngetJSON :: IO BS.ByteString\ngetJSON = BS.readFile jsonFile\n\nmain :: IO ()\nmain = do\n     input &lt;- getJSON\n     print $ f input\n\nf :: BS.ByteString -&gt; [String]\nf x = [ show $ (x ^? key \"a\" . nth 0 . key \"b\")\n        , show $ x ^? key \"a\" . nth 0 . key \"c\"\n        , show $ x ^? key \"a\" . nth 0 . key \"d\" \n        ]\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "edited": false, "score": 0, "creation_date": 1449539522, "post_id": 34146390, "comment_id": 56041080, "body": "<code>nubBy</code> isn&#39;t terribly efficient, though, is it?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "edited": false, "score": 2, "creation_date": 1449540920, "post_id": 34146390, "comment_id": 56041429, "body": "@user3217013, without a known <code>Ord</code>, <code>Hashable</code>, or similar constraint, it&#39;s the best you can do."}, {"owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449599169, "post_id": 34146390, "comment_id": 56073213, "body": "@dfeuer Right. I was assuming that we were dealing with <code>Integer</code>s."}], "tags": [], "owner": {"reputation": 9215, "user_id": 298282, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/afb3a36064179f0226a1691c9433be13?s=128&d=identicon&r=PG", "display_name": "Yasir Arsanukaev", "link": "https://stackoverflow.com/users/298282/yasir-arsanukaev"}, "is_accepted": true, "score": 4, "last_activity_date": 1449538723, "last_edit_date": 1449538723, "creation_date": 1449537661, "answer_id": 34146390, "question_id": 34146292, "link": "https://stackoverflow.com/questions/34146292/erase-duplicate-pairs-from-list/34146390#34146390", "title": "Erase duplicate pairs from list", "body": "<p>The <a href=\"https://www.haskell.org/hoogle/?hoogle=nubBy\" rel=\"nofollow\"><code>nubBy</code></a> function eliminates duplicate elements from a list using the function you provide for elements comparison.</p>\n\n<pre><code>nubBy (\\x y -&gt; (fst x == snd y &amp;&amp; snd x == fst y) || (x == y)) [(1,7),(7,1),(2,3),(3,4),(4,3)]\n[(1,7),(2,3),(3,4)]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "is_accepted": false, "score": 2, "last_activity_date": 1449599109, "last_edit_date": 1449599109, "creation_date": 1449539827, "answer_id": 34146688, "question_id": 34146292, "link": "https://stackoverflow.com/questions/34146292/erase-duplicate-pairs-from-list/34146688#34146688", "title": "Erase duplicate pairs from list", "body": "<p>You could reorder each tuple so that you always have the smaller element on the left and the larger on the right. Then you can sort your list and take one element from each run of equal elements. This is how I would do it</p>\n\n<pre><code>import Control.Arrow ((&amp;&amp;&amp;))\nimport Data.List (sort, group)\n\ndedup = map head . group . sort . map (uncurry min &amp;&amp;&amp; uncurry max)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 5652254, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3tkqlU3_oBU/AAAAAAAAAAI/AAAAAAAAAis/-a06_HR1PE0/photo.jpg?sz=128", "display_name": "James Constable", "link": "https://stackoverflow.com/users/5652254/james-constable"}, "is_accepted": false, "score": 2, "last_activity_date": 1449541063, "creation_date": 1449541063, "answer_id": 34146855, "question_id": 34146292, "link": "https://stackoverflow.com/questions/34146292/erase-duplicate-pairs-from-list/34146855#34146855", "title": "Erase duplicate pairs from list", "body": "<p>If order is unimportant, you could just choose the version of the tuple with the smaller element followed by the larger element as the 'canonical' representation of each element, and then either sort the list and remove adjacent duplicates, or run them through a set (both take O(nlogn) time).</p>\n\n<p>Here is the latter solution:</p>\n\n<pre><code>import Data.Set\nremoveDuplicates xs = toList (fromList (canonical xs))\n    where canonical [] = []\n          canonical ((a,b):t) = (if a &lt; b then (a, b) else (b, a)) : (canonical t)\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 5523735, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0cd51b33a60dbf810b491c9bf0cb064?s=128&d=identicon&r=PG&f=1", "display_name": "craaaft", "link": "https://stackoverflow.com/users/5523735/craaaft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 34146390, "answer_count": 3, "score": 0, "last_activity_date": 1449599109, "creation_date": 1449537029, "question_id": 34146292, "link": "https://stackoverflow.com/questions/34146292/erase-duplicate-pairs-from-list", "title": "Erase duplicate pairs from list", "body": "<p>I have a list of pairs and I want to erase all the duplicates in the list. So for example I have [(1,7),(7,1),(2,3),(3,4),(4,3)] and after using the function I would get [(1,7),(2,3),(3,4)].</p>\n\n<p>Is there already a function that does something like this or an easy way to implement this?</p>\n"}, {"tags": ["haskell", "template-haskell"], "answers": [{"tags": [], "owner": {"reputation": 4614, "user_id": 1378868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a42920594ee2a0cc33012c407fd9d5?s=128&d=identicon&r=PG", "display_name": "snak", "link": "https://stackoverflow.com/users/1378868/snak"}, "is_accepted": true, "score": 4, "last_activity_date": 1449545478, "creation_date": 1449545478, "answer_id": 34147486, "question_id": 34146190, "link": "https://stackoverflow.com/questions/34146190/is-it-possible-to-use-template-haskell-to-get-the-name-of-the-current-file/34147486#34147486", "title": "Is it possible to use template haskell to get the name of the current file?", "body": "<p>You can get it using <a href=\"http://hackage.haskell.org/package/template-haskell-2.10.0.0/docs/Language-Haskell-TH-Syntax.html#v:location%60\" rel=\"nofollow\"><code>location</code></a>.</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nimport Language.Haskell.TH\nimport Language.Haskell.TH.Syntax\n\nmain = putStrLn $(LitE . StringL . loc_filename &lt;$&gt; location)\n</code></pre>\n"}], "owner": {"reputation": 2183, "user_id": 52310, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8729b9952488497d0343e8bd86afe8cb?s=128&d=identicon&r=PG", "display_name": "Alex R", "link": "https://stackoverflow.com/users/52310/alex-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 34147486, "answer_count": 1, "score": 3, "last_activity_date": 1449545478, "creation_date": 1449536247, "question_id": 34146190, "link": "https://stackoverflow.com/questions/34146190/is-it-possible-to-use-template-haskell-to-get-the-name-of-the-current-file", "title": "Is it possible to use template haskell to get the name of the current file?", "body": "<p>The closest I can see is using <a href=\"https://hackage.haskell.org/package/template-haskell-2.10.0.0/docs/Language-Haskell-TH.html#v:reifyModule\" rel=\"nofollow\"><code>reifyModule</code></a> and <a href=\"https://hackage.haskell.org/package/template-haskell-2.10.0.0/docs/Language-Haskell-TH.html#v:thisModule\" rel=\"nofollow\"><code>thisModule</code></a>, but that doesn't work.</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nimport Language.Haskell.TH\nimport Language.Haskell.TH.Syntax\n\nmain = putStrLn $(LitE . StringL . show &lt;$&gt; thisModule)\n</code></pre>\n\n<p>(unsurprisingly) gives back <code>Module (PkgName \"main\") (ModName \"Main\")</code> regardless of the file name.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 8, "creation_date": 1449536816, "post_id": 34146131, "comment_id": 56040363, "body": "Your <code>seqA</code> only works with lists, while <code>sequenceA</code> can deal with any <code>Traversable</code>, including lists (note the constraints in the signature are on different type variables, <code>f</code> and <code>t</code>)."}, {"owner": {"reputation": 6783, "user_id": 1727828, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/iZ4RR.png?s=128&g=1", "display_name": "mxxk", "link": "https://stackoverflow.com/users/1727828/mxxk"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1449540614, "post_id": 34146131, "comment_id": 56041346, "body": "[facepalm] Right, of course! Totally missed the <code>t (f a)</code> versus <code>[f a]</code> distinction..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1449541121, "post_id": 34146131, "comment_id": 56041475, "body": "@duplode Put that in an answer!"}], "answers": [{"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": true, "score": 7, "last_activity_date": 1449549107, "last_edit_date": 1449549107, "creation_date": 1449541376, "answer_id": 34146902, "question_id": 34146131, "link": "https://stackoverflow.com/questions/34146131/why-does-sequencea-need-traversable/34146902#34146902", "title": "Why does sequenceA need Traversable?", "body": "<p>This is a subject that can be initially confusing because there is a lot of history and change around it, and older explanations are out of date.  The history is roughly this:</p>\n\n<ol>\n<li>The idea of the <code>sequence</code> operation dates back to the 1990s, when the <code>Monad</code> class was incorporated into Haskell and people first formulated generic operations for it.  The signature that you quote from the Typeclassopedia reflects this: <code>sequence :: Monad m =&gt; [m a] -&gt; m [a]</code>.  It can work with any monad, but it is hardcoded to work on lists.  </li>\n<li>The <code>Applicative</code> class was developed during the mid-to-late 2000s; the seminal paper that everybody cites is McBride and Patterson (2008), <a href=\"http://www.staff.city.ac.uk/~ross/papers/Applicative.html\">\"Applicative Programming with Effects\"</a>.  McBride and Patterson also note that:\n\n<ul>\n<li>The old monadic <code>sequence</code> operation can in fact be generalized to <code>dist :: Applicative f =&gt; [f a] -&gt; f [a]</code>.  The <code>Monad</code> constraint is too narrow!</li>\n<li>Likewise, the old <code>mapM</code> function (close relative to <code>sequence</code>) generalizes to <code>traverse :: Applicative f =&gt; (a -&gt; f b) -&gt; [a] -&gt; f [b]</code>.</li>\n<li>This can be generalized to non-list data structures by putting these operations into a <code>Traversable</code> class that they propose in the paper.</li>\n</ul></li>\n<li>The <code>Applicative</code> and <code>Traversable</code> classes were added into the GHC <code>base</code> libraries, with some small changes.  The <code>dist</code> function was named <code>sequenceA</code> instead, and the <code>Foldable</code> class joined <code>Traversable</code> for types that support only a subset of <code>Traversable</code>'s requirements.</li>\n<li>These classes proved extremely popular.  But that shows that the original  <code>sequence :: Monad m =&gt; [m a] -&gt; m [a]</code> signature was <strong>wrong in hindsight</strong>. </li>\n<li>So finally, fast-forward to 2015, when GHC implemented the <a href=\"https://wiki.haskell.org/Functor-Applicative-Monad_Proposal\">Applicative/Monad Proposal</a> (make <code>Applicative</code> a superclass of <code>Monad</code>) and the <a href=\"https://wiki.haskell.org/Foldable_Traversable_In_Prelude\">Foldable/Traversable Proposal</a>, where the base libraries were revised in order to get them close to the ideal, hindsight-informed design.  </li>\n</ol>\n\n<p>The Foldable/Traversable Proposal, however, did not change the signature of <code>sequence</code>.  I can't tell you precisely why, but the answer is going to be some obtuse detail that boils down to historical reasons, backward compatibility or something like that.  But I can tell you that if we could start all over again:</p>\n\n<ol>\n<li><code>sequence</code> would have <code>sequenceA</code>'s signature;</li>\n<li><code>sequenceA</code> would not exist independently of <code>sequence</code>;</li>\n<li><code>mapM</code> is just <code>traverse</code> with the wrong signature, and thus would not exist independently either.</li>\n</ol>\n"}], "owner": {"reputation": 6783, "user_id": 1727828, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/iZ4RR.png?s=128&g=1", "display_name": "mxxk", "link": "https://stackoverflow.com/users/1727828/mxxk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 2, "accepted_answer_id": 34146902, "answer_count": 1, "score": 3, "last_activity_date": 1449549107, "creation_date": 1449535816, "question_id": 34146131, "link": "https://stackoverflow.com/questions/34146131/why-does-sequencea-need-traversable", "title": "Why does sequenceA need Traversable?", "body": "<p>From the <a href=\"https://wiki.haskell.org/Typeclassopedia\" rel=\"nofollow\">Typeclassopedia</a>:</p>\n\n<blockquote>\n<pre><code>sequence :: Monad m =&gt; [m a] -&gt; m [a]\n</code></pre>\n  \n  <p>Takes a list of computations and combines them into one computation which collects a list of their results. It is again something of a historical accident that sequence has a <code>Monad</code> constraint, since it can actually be implemented only in terms of <code>Applicative</code>.</p>\n</blockquote>\n\n<p>And indeed, there is <code>sequenceA</code> which operates on <code>Applicative</code> types.</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>sequenceA :: (Applicative f, Traversable t) =&gt; t (f a) -&gt; f (t a)\n</code></pre>\n\n<p>But wait, why does <code>sequenceA</code> need the <code>Traversable</code> constraint when it can be implemented without it?</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>seqA :: Applicative f =&gt; [f a] -&gt; f [a]\nseqA = foldr fx (pure [])\n         where\n           fx f fs = pure (:) &lt;*&gt; f &lt;*&gt; fs)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449594053, "post_id": 34145920, "comment_id": 56070069, "body": "Each <code>Stat</code> must have a <code>Stat</code> constructor in front of it: <code>[Stat (&quot;Strength&quot;, 5), Stat (&quot;Toughness&quot;, 1), Stat (&quot;Fisticuffs&quot;, 1)]</code> or <code>map Stat [(&quot;Strength&quot;, 5), (&quot;Toughness&quot;, 1),(&quot;Fisticuffs&quot;, 1)]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5652223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35f30624873ce45fd36440c742ac0b74?s=128&d=identicon&r=PG&f=1", "display_name": "user5652223", "link": "https://stackoverflow.com/users/5652223/user5652223"}, "edited": false, "score": 0, "creation_date": 1449542349, "post_id": 34146894, "comment_id": 56041855, "body": "I need to make an instance of the Show typeclass for the Stat datatype so that individual stats can be printed. I want to know how to get each item in the list of stats and show them as :<code>&quot;Name of Stat&quot; ++ (show(stat_string)) ++ &quot;: &quot; ++ (show(stat_val))</code>"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 11, "user_id": 5652223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35f30624873ce45fd36440c742ac0b74?s=128&d=identicon&r=PG&f=1", "display_name": "user5652223", "link": "https://stackoverflow.com/users/5652223/user5652223"}, "edited": false, "score": 2, "creation_date": 1449551638, "post_id": 34146894, "comment_id": 56044429, "body": "@user5652223 You cannot define a show instance for a type synonym. Either change it to <code>data Stat = ...</code> or live with the existing show instances. You can, of course, display the <code>Stat</code>s however you like within the show instance for <code>Monster</code>: <code>instance Show Monster where show (Monster n ss) = &quot;Monster &quot; ++ n ++ concat [ &quot;\\n&quot; ++ sn ++ &quot;:&quot; ++ show sv | (sn,sv) &lt;- ss ]</code>"}, {"owner": {"reputation": 11, "user_id": 5652223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35f30624873ce45fd36440c742ac0b74?s=128&d=identicon&r=PG&f=1", "display_name": "user5652223", "link": "https://stackoverflow.com/users/5652223/user5652223"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449576969, "post_id": 34146894, "comment_id": 56058077, "body": "@user2407038 So I changed <code>type Stat </code> to ` data Stat` , but I get the error :                                                                                                                     <code>Couldn&#39;t match expected type Stat  with actual type ([Char], Integer)     In the expression: (&quot;Toughness&quot;, 1)     In the second argument of Monster, namely      [(&quot;Strength&quot;, 5), (&quot;Toughness&quot;, 1)]     In the expression:       Monster         &quot;Dragon&quot; [(&quot;Strength&quot;, 5), (&quot;Toughness&quot;, 1)] [(&quot;Fisticuffs&quot;, 1)] </code>"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1449541341, "creation_date": 1449541341, "answer_id": 34146894, "question_id": 34145920, "link": "https://stackoverflow.com/questions/34145920/using-the-show-typeclass-in-an-instance/34146894#34146894", "title": "Using the show typeclass in an instance", "body": "<p>Presumably instead of <code>instance Show Stat</code> you meant <code>instance Show Monster</code> (since <code>Stat</code> already has a suitable <code>Show</code> instance).</p>\n"}], "owner": {"reputation": 11, "user_id": 5652223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35f30624873ce45fd36440c742ac0b74?s=128&d=identicon&r=PG&f=1", "display_name": "user5652223", "link": "https://stackoverflow.com/users/5652223/user5652223"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449577375, "creation_date": 1449534394, "last_edit_date": 1449577375, "question_id": 34145920, "link": "https://stackoverflow.com/questions/34145920/using-the-show-typeclass-in-an-instance", "title": "Using the show typeclass in an instance", "body": "<p>So I'm very new to Haskell and I've been trying to figure how to use the show typeclass in an instance to print out <code>[Stat]</code> in this:</p>\n\n<pre><code>module HaskellGame.Datatypes where ....\n\n\n   data Stat = Stat {\n                     name ::String, \n                     value::Int\n                    }\n\n    data Monster = Monster {\n                           name :: String,\n                           stats :: [Stat]\n                         }\n</code></pre>\n\n<p>So far the code I've written is this:</p>\n\n<pre><code>   module HaskellGame.Graphics where ...\n\n   {-This displays the Monster on the Map-}\n    instance Show Monster where\n     show (Monster _ _ ) = \"M\"\n   {-This displays the stats of the monster-}\n    instance Show Stat where\n     show (Stat name value) = (show(name)) ++ \": \" ++ (show(value))\n</code></pre>\n\n<p>and I get this error:</p>\n\n<pre><code> Couldn't match expected type `Stat'\n            with actual type `([Char], Integer)'\nIn the expression: (\"Toughness\", 1)\nIn the second argument of `Monster', namely\n  `[(\"Strength\", 5), (\"Toughness\", 1)]'\nIn the expression:\n  Monster\n    \"Dragon\" [(\"Strength\", 5), (\"Toughness\", 1)] [(\"Fisticuffs\", 1)]\n</code></pre>\n\n<p>I want to know what I'm doing wrong. </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 4, "last_activity_date": 1449529330, "creation_date": 1449529330, "answer_id": 34144984, "question_id": 34144569, "link": "https://stackoverflow.com/questions/34144569/why-does-lazy-evaluation-seem-to-work-differently-for-a-num-than-an-int-in-haske/34144984#34144984", "title": "Why does lazy evaluation seem to work differently for a Num than an Int in Haskell?", "body": "<p>Look at the type of <code>1 + 2</code>: it's <code>Num a =&gt; a</code>. That means it can be any numeric type, specified by whoever uses <code>x</code>. So if you evaluate it once, GHCI's defaulting rules mean it defaults to <code>Int</code>, and then you evaluate <code>x :: Int</code>, which is indeed <code>3 :: Int</code>. However, that can't be saved as the value for <code>x</code>, because someone might later try to use it as <code>x :: Double</code>, for example, and the answer would be different.</p>\n"}], "owner": {"reputation": 669, "user_id": 971747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/300d4218090b02563aa3befda5f7e2b4?s=128&d=identicon&r=PG", "display_name": "Giles Bradshaw", "link": "https://stackoverflow.com/users/971747/giles-bradshaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 2, "closed_date": 1449532264, "answer_count": 1, "score": 3, "last_activity_date": 1449529330, "creation_date": 1449527551, "question_id": 34144569, "link": "https://stackoverflow.com/questions/34144569/why-does-lazy-evaluation-seem-to-work-differently-for-a-num-than-an-int-in-haske", "closed_reason": "Duplicate", "title": "Why does lazy evaluation seem to work differently for a Num than an Int in Haskell?", "body": "<p>In GHCI if I do..</p>\n\n<pre><code>let x = 1 + 2\n</code></pre>\n\n<p>then </p>\n\n<pre><code>:sprint x\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>x = _\n</code></pre>\n\n<p>then if I do </p>\n\n<pre><code>x\n\n3\n</code></pre>\n\n<p>then..</p>\n\n<pre><code>:sprint x\n</code></pre>\n\n<p>I still get </p>\n\n<pre><code>x = _\n</code></pre>\n\n<p>However if I do</p>\n\n<pre><code>let x = 1 + 2 :: Int\n</code></pre>\n\n<p>Then the second :sprint x gives me</p>\n\n<pre><code>3\n</code></pre>\n\n<p>Just wondering why that is?</p>\n"}, {"tags": ["haskell", "parsec"], "comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 1, "creation_date": 1449530020, "post_id": 34144527, "comment_id": 56038200, "body": "Could you provide more information? For example, what happens right now when you run your parser on the given input?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1449532937, "post_id": 34144527, "comment_id": 56039215, "body": "The line <code>tbool =  Ttype &lt;$&gt; (show tbool)</code> is very suspicious... firstly <code>show _</code> has type <code>[Char]</code>, so the <code>Ttype</code> is expected to have type <code>Char -&gt; x</code> for some <code>x</code>, which it clearly does not. Secondly, even if this was a type correct expression, it is self-referential in a way that probably will not terminate. You probably want <code>data Type = Var String | ...</code>"}, {"owner": {"reputation": 11, "user_id": 5644172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/911d5a67396f4a1585f906745d553e28?s=128&d=identicon&r=PG&f=1", "display_name": "BSZ", "link": "https://stackoverflow.com/users/5644172/bsz"}, "edited": false, "score": 0, "creation_date": 1449567979, "post_id": 34144527, "comment_id": 56051983, "body": "ERROR:     Couldn&#39;t match expected type \u2018ParsecT [Char] () Identity Type\u2019                 with actual type \u2018[b2]\u2019     In the first argument of \u2018(&lt;|&gt;)\u2019, namely \u2018tbool\u2019     In the second argument of \u2018(&lt;|&gt;)\u2019, namely \u2018tbool &lt;|&gt; tbool\u2019  test.hs:41:32:     Couldn&#39;t match expected type \u2018ParsecT [Char] () Identity Type\u2019                 with actual type \u2018[b3]\u2019     In the second argument of \u2018(&lt;|&gt;)\u2019, namely \u2018tbool\u2019     In the second argument of \u2018(&lt;|&gt;)\u2019, namely \u2018tbool &lt;|&gt; tbool\u2019  `"}], "owner": {"reputation": 11, "user_id": 5644172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/911d5a67396f4a1585f906745d553e28?s=128&d=identicon&r=PG&f=1", "display_name": "BSZ", "link": "https://stackoverflow.com/users/5644172/bsz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1449527409, "creation_date": 1449527409, "question_id": 34144527, "link": "https://stackoverflow.com/questions/34144527/how-to-parse-with-parsec-expression-in-haskell", "title": "How to parse with parsec expression in haskell", "body": "<p>Type:</p>\n\n<pre><code>data Type\n  = Ttype \n  | Arr Type Type\n  deriving (Eq, Show)\n\ndata Ttype = String  \n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>lchar = lexeme . char\n\nparens :: ParserT a b -&gt; ParserT a b\nparens = between (lchar '(') (lchar ')')\n\nsymbol :: String -&gt; ParserT a String\nsymbol p = string p &lt;* spaces\n\ntypeParser :: CharParser () Type\ntypeParser = arr &lt;|&gt; tbool &lt;|&gt;  tbool\n  where tbool =  Ttype &lt;$&gt; (show tbool)\n        subtyp = parens arr &lt;|&gt; tbool &lt;|&gt; tbool\n        arr = chainr1 subtyp $ try (symbol \"-&gt;\" *&gt; pure Arr)\nparseIt :: String -&gt; Either ParseError Type\nparseIt  = P.parse typeParser \"\"\n</code></pre>\n\n<p><strong>How to parse this type:</strong> (A->(B->C))->(A->B)\nSorry. I am new to the Haskell language.</p>\n"}, {"tags": ["haskell", "byte", "bit", "bit-shift", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "reply_to_user": {"reputation": 1916, "user_id": 3457762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0429df5bced7c2317a880821a7cc480e?s=128&d=identicon&r=PG&f=1", "display_name": "astiefel", "link": "https://stackoverflow.com/users/3457762/astiefel"}, "edited": false, "score": 1, "creation_date": 1449528851, "post_id": 34144500, "comment_id": 56037743, "body": "@astiefel you can convert across numeric types; see <a href=\"https://wiki.haskell.org/Converting_numbers\" rel=\"nofollow noreferrer\">wiki.haskell.org/Converting_numbers</a>"}, {"owner": {"reputation": 1916, "user_id": 3457762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0429df5bced7c2317a880821a7cc480e?s=128&d=identicon&r=PG&f=1", "display_name": "astiefel", "link": "https://stackoverflow.com/users/3457762/astiefel"}, "edited": false, "score": 0, "creation_date": 1449696926, "post_id": 34144500, "comment_id": 56125182, "body": "is there a way to reverse it? Because I have the following unpack method: <code>unpack :: Word8 -&gt; [Word8] unpack 0 = [0] unpack x = reverse (go x) where   go 0 = []   go n | n </code>mod` 2 == 1 = 1 : go (n <code>div</code> 2)        | n <code>mod</code> 2 == 0 = 0 : go (n <code>div</code> 2)        | otherwise      = []` but I cannot pack and then unpack"}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 5, "last_activity_date": 1449527264, "creation_date": 1449527264, "answer_id": 34144500, "question_id": 34144091, "link": "https://stackoverflow.com/questions/34144091/convert-bits-to-int8-haskell/34144500#34144500", "title": "Convert Bits to Int8 Haskell", "body": "<p>One solution would be to just fold over the list:</p>\n\n<pre><code>import Data.Bits (Bits, shiftL, (.|.))\n\npack :: (Num b, Foldable t, Bits b) =&gt; t b -&gt; b\npack a = foldl go 0 a\n    where go acc i = (acc `shiftL` 1) .|. i\n</code></pre>\n\n<p>and you get:</p>\n\n<pre><code>\\&gt; pack [0,1,0,0,0,1,1,1,1,0]\n286\n</code></pre>\n"}], "owner": {"reputation": 1916, "user_id": 3457762, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0429df5bced7c2317a880821a7cc480e?s=128&d=identicon&r=PG&f=1", "display_name": "astiefel", "link": "https://stackoverflow.com/users/3457762/astiefel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 2, "accepted_answer_id": 34144500, "answer_count": 1, "score": 3, "last_activity_date": 1449527264, "creation_date": 1449525572, "question_id": 34144091, "link": "https://stackoverflow.com/questions/34144091/convert-bits-to-int8-haskell", "title": "Convert Bits to Int8 Haskell", "body": "<p>Trying to convert a list of Bits (0,1) into an Int8 or something similar so that I am not wasting a byte from ByteString on only 1 bit</p>\n\n<p>For example, I may have a list like [0,1,0,0,0,1,1,1,1,0], which as a ByteString represents each of those as a Byte instead of a Bit.</p>\n"}, {"tags": ["haskell", "maybe", "attoparsec"], "comments": [{"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 1, "creation_date": 1449521769, "post_id": 34142495, "comment_id": 56034145, "body": "It seems to me that you keep asking questions and accepting your own answers, which by the way are posted at the exact same time of the question."}, {"owner": {"reputation": 11743, "user_id": 2597135, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/9b8c6248f917c92724a033de96708542?s=128&d=identicon&r=PG", "display_name": "Uli K&#246;hler", "link": "https://stackoverflow.com/users/2597135/uli-k%c3%b6hler"}, "reply_to_user": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 1, "creation_date": 1449522908, "post_id": 34142495, "comment_id": 56034826, "body": "@rubik Yes, this is a built-in feature of StackOverflow and it is actively encouraged to use it! Please read <a href=\"https://stackoverflow.com/help/self-answer\">stackoverflow.com/help/self-answer</a>"}, {"owner": {"reputation": 11743, "user_id": 2597135, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/9b8c6248f917c92724a033de96708542?s=128&d=identicon&r=PG", "display_name": "Uli K&#246;hler", "link": "https://stackoverflow.com/users/2597135/uli-k%c3%b6hler"}, "reply_to_user": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1449522960, "post_id": 34142495, "comment_id": 56034851, "body": "@rubik Please note that I will happily accept other answers. I had several self-answered questions where someone came up with a better answer and I happily accepted it."}], "answers": [{"comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 3, "creation_date": 1449523927, "post_id": 34142496, "comment_id": 56035428, "body": "Iirc, there&#39;s also an Alternative instance, in which case you can use the optional function."}], "tags": [], "owner": {"reputation": 11743, "user_id": 2597135, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/9b8c6248f917c92724a033de96708542?s=128&d=identicon&r=PG", "display_name": "Uli K&#246;hler", "link": "https://stackoverflow.com/users/2597135/uli-k%c3%b6hler"}, "is_accepted": true, "score": 1, "last_activity_date": 1449523164, "last_edit_date": 1449523164, "creation_date": 1449519842, "answer_id": 34142496, "question_id": 34142495, "link": "https://stackoverflow.com/questions/34142495/attoparsec-optional-parser-with-maybe-result/34142496#34142496", "title": "Attoparsec optional parser with Maybe result", "body": "<p>You can use <a href=\"https://hackage.haskell.org/package/attoparsec-0.13.0.1/docs/Data-Attoparsec-ByteString-Char8.html#v:option\" rel=\"nofollow\"><code>option</code></a> and the Applicative instance of <code>Parser</code> for this:</p>\n\n<pre><code>-- Make a parser optional, return Nothing if there is no match\nmaybeOption :: Parser a -&gt; Parser (Maybe a)\nmaybeOption p = option Nothing (Just &lt;$&gt; p)\n</code></pre>\n\n<p>You can then use it like this:</p>\n\n<pre><code>myMaybeParser = maybeOption myParser\n</code></pre>\n"}], "owner": {"reputation": 11743, "user_id": 2597135, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/9b8c6248f917c92724a033de96708542?s=128&d=identicon&r=PG", "display_name": "Uli K&#246;hler", "link": "https://stackoverflow.com/users/2597135/uli-k%c3%b6hler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "accepted_answer_id": 34142496, "answer_count": 1, "score": 0, "last_activity_date": 1449523164, "creation_date": 1449519842, "question_id": 34142495, "link": "https://stackoverflow.com/questions/34142495/attoparsec-optional-parser-with-maybe-result", "title": "Attoparsec optional parser with Maybe result", "body": "<p>I have an <a href=\"https://hackage.haskell.org/package/attoparsec\" rel=\"nofollow\">Attoparsec</a> parser like this:</p>\n\n<pre><code>myParser :: Parser Text\nmyParser = char '\"' *&gt; takeWhile (not . isspace) &lt;* char '\"'\n</code></pre>\n\n<p>I want to make this parser optional so I get a function that returns <code>Just txt</code> if the parser matches and <code>Nothing</code> else, i.e. a function of the signature:</p>\n\n<pre><code>myMaybeParser :: Parser (Maybe Text)\n</code></pre>\n\n<p>How can I do this?</p>\n"}, {"tags": ["haskell", "po", "attoparsec"], "answers": [{"tags": [], "owner": {"reputation": 11743, "user_id": 2597135, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/9b8c6248f917c92724a033de96708542?s=128&d=identicon&r=PG", "display_name": "Uli K&#246;hler", "link": "https://stackoverflow.com/users/2597135/uli-k%c3%b6hler"}, "is_accepted": true, "score": 3, "last_activity_date": 1449514970, "creation_date": 1449514970, "answer_id": 34141176, "question_id": 34141175, "link": "https://stackoverflow.com/questions/34141175/reading-pot-files-in-haskell-using-attoparsec/34141176#34141176", "title": "Reading POT files in Haskell using Attoparsec", "body": "<p>Assuming the POT file to read is stored in <code>mypot.pot</code>, you can use this code which you can directly run in <code>runghc</code>. I have tested this successfully using some Khan Academy PO files, but it currently only works with simple files (no plural etc), but it is easy to extend:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Prelude hiding (takeWhile)\nimport Data.Attoparsec.ByteString\nimport Data.Attoparsec.ByteString.Char8 hiding (takeWhile, skipWhile)\nimport qualified Data.Text.Encoding as TE\nimport Data.Text(Text)\nimport Data.Word\nimport Data.ByteString (unsnoc, ByteString)\nimport qualified Data.ByteString.Char8 as B\nimport Control.Applicative\nimport Control.Monad\nimport Data.Maybe\nimport Data.Either\nimport qualified Data.Text as T\n\ndata PORecord = PORecord {\n        poComment :: Text,\n        poMsgid :: Text,\n        poMsgstr :: Text\n    } deriving (Show, Eq)\n\ntakeTillEOL :: Parser ByteString\ntakeTillEOL = takeWhile (not . isEndOfLine)\n\nparseMsgidMsgstrLine :: ByteString -&gt; Parser Text\nparseMsgidMsgstrLine key = do\n  void (string key) &lt;?&gt; \"Line key\"\n  skipSpace\n  char '\"' &lt;?&gt; \"Opening Qutotation mark\"\n  val &lt;- takeTillEOL\n  endOfLine &lt;?&gt; \"EOL\"\n  return $ TE.decodeUtf8 $ fromMaybe \"\" $ (fst &lt;$&gt; unsnoc val)\n\nmsgidLine = parseMsgidMsgstrLine \"msgid\"\nmsgstrLine = parseMsgidMsgstrLine \"msgstr\"\n\nescapedTextLine :: Parser Text\nescapedTextLine = char '\"' *&gt; (TE.decodeUtf8 &lt;$&gt; takeTillEOL) &lt;* endOfLine\n--escapedTextLine = do\n--    char '\"'\n--    val &lt;- takeTillEOL\n--    return $ (traceShow val ())\n\nnameP :: String -&gt; Parser a -&gt; Parser a\nnameP str p = p &lt;?&gt; str\n\ncommentLine :: Parser Text\ncommentLine = nameP \"comment line\" $ do\n    char '#' &lt;?&gt; \"Line start hash\"\n    -- Skip space but not newline\n    void $ many (char ' ')\n    txt &lt;- TE.decodeUtf8 &lt;$&gt; takeTillEOL\n    endOfLine &lt;?&gt; \"EOF\"\n    return txt\n\nemptyLine :: Parser ()\nemptyLine = skipSpace &lt;* endOfLine\n\npoRecord :: Parser PORecord\npoRecord = do\n    comments &lt;- many1 commentLine &lt;?&gt; \"Comments\"\n    msgidPrimary &lt;- msgidLine &lt;?&gt; \"msgid\"\n    extraMsgid &lt;- many escapedTextLine &lt;?&gt; \"Extra msgid\"\n    msgstrPrimary &lt;- msgstrLine &lt;?&gt; \"msgstr\"\n    extraMsgstr &lt;- many escapedTextLine &lt;?&gt; \"Extra msgstr\"\n    endOfLine\n    let comment = T.intercalate \"\\n\" comments\n    let msgid = T.intercalate \"\\n\" $ msgidPrimary : extraMsgid\n    let msgstr = T.intercalate \"\\n\" $ msgstrPrimary : extraMsgstr\n    return $ PORecord comment msgid msgstr\n\npoFile :: Parser [PORecord]\npoFile =\n    --let options = choice [emptyLine *&gt; pure Nothing, ]\n    many1 poRecord &lt;?&gt; \"PO results\"\n\nmain :: IO ()\nmain = do\n    f &lt;- B.readFile \"mypot.pot\"\n    print $ parseOnly poFile f\n</code></pre>\n"}], "owner": {"reputation": 11743, "user_id": 2597135, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/9b8c6248f917c92724a033de96708542?s=128&d=identicon&r=PG", "display_name": "Uli K&#246;hler", "link": "https://stackoverflow.com/users/2597135/uli-k%c3%b6hler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 34141176, "answer_count": 1, "score": 1, "last_activity_date": 1449514970, "creation_date": 1449514970, "question_id": 34141175, "link": "https://stackoverflow.com/questions/34141175/reading-pot-files-in-haskell-using-attoparsec", "title": "Reading POT files in Haskell using Attoparsec", "body": "<p>I have a set of POT files that I want to read in order to postprocess translations in Haskell. Due to the POT files being very large, I want to use <a href=\"https://hackage.haskell.org/package/attoparsec\" rel=\"nofollow\">attoparsec</a> to get a good performance.</p>\n\n<p>I tried using <a href=\"https://hackage.haskell.org/package/hgettext\" rel=\"nofollow\">hgettext</a>, but my task is not to read translations for translating my program but merely to parse the POT files. Basically, I want to get a list of <code>(comment, msgid, msgstr)</code> tuples</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 7, "creation_date": 1449515087, "post_id": 34141165, "comment_id": 56030422, "body": "Look at the type signatures for <code>foldl</code> and <code>foldr</code>. Hint: they&#39;re different."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1449515123, "post_id": 34141165, "comment_id": 56030444, "body": "Also, if you are new to types, you can enter into ghci <code>:t allComp</code> to see its type signature."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1449517072, "creation_date": 1449517072, "answer_id": 34141744, "question_id": 34141165, "link": "https://stackoverflow.com/questions/34141165/foldl-compiles-but-not-foldr/34141744#34141744", "title": "foldl compiles but not foldr", "body": "<p>If you do a search on <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow\"><em>Hoogle</em></a> you will see that the signature of <code>foldl</code> and <code>foldr</code> differ:</p>\n\n<pre><code>foldl :: (a -&gt; b -&gt; a) -&gt; a -&gt; [b] -&gt; a\nfoldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\n</code></pre>\n\n<p>Now let's make the signature more <em>semantically sound</em>:</p>\n\n<pre><code>foldl :: (a -&gt; b -&gt; a) -&gt; a -&gt; [b] -&gt; a\nfoldr :: (b -&gt; a -&gt; a) -&gt; a -&gt; [b] -&gt; a\n</code></pre>\n\n<p>You see that the order of the types in the first argument (the function) differ. This is because <code>foldl</code> looks like:</p>\n\n<pre><code>foldl f z [x1,x2,...,xn] = f (f (f (... (f z x1) x2) x3)...) xn\n</code></pre>\n\n<p>whereas <code>foldr</code> looks like:</p>\n\n<pre><code>foldr f z [x1,x2,...,xn] = f z (f x1 (f x2 (... (f xn-1 xn) ...)))\n</code></pre>\n\n<p>Since the <code>(&amp;&amp;)</code> is associative, that does not matter much. You can simply change it with a <code>flip :: (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c</code>:</p>\n\n<pre><code>all f xs = foldr (flip (allComp f)) True xs\n</code></pre>\n"}], "owner": {"reputation": 1002, "user_id": 1620367, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wbTpy.jpg?s=128&g=1", "display_name": "vkubicki", "link": "https://stackoverflow.com/users/1620367/vkubicki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 34141744, "answer_count": 1, "score": 1, "last_activity_date": 1449517110, "creation_date": 1449514936, "last_edit_date": 1449517110, "question_id": 34141165, "link": "https://stackoverflow.com/questions/34141165/foldl-compiles-but-not-foldr", "title": "foldl compiles but not foldr", "body": "<p>As a small exercise, I am trying to recode all. This code seems to work (except for infinite list):</p>\n\n<pre><code>allComp f acc x = acc &amp;&amp; f x\n\nall :: (a -&gt; Bool) -&gt; [a] -&gt; Bool\nall f xs = foldl (allComp f) True xs\n</code></pre>\n\n<p>But this one does not compile if I keep the same signature:</p>\n\n<pre><code>allComp f acc x = acc &amp;&amp; f x\n\nall :: (a -&gt; Bool) -&gt; [a] -&gt; Bool\nall f xs = foldr (allComp f) True xs\n</code></pre>\n\n<p>And the compilation error is:</p>\n\n<pre><code>Couldn't match type `a' with `Bool'\n  `a' is a rigid type variable bound by\n      the type signature for all :: (a -&gt; Bool) -&gt; [a] -&gt; Bool\n      at Main.hs:8:8\nExpected type: Bool -&gt; Bool\n  Actual type: a -&gt; Bool\nIn the first argument of `allComp', namely `f'\nIn the first argument of `foldr', namely `(allComp f)'\nIn the expression: foldr (allComp f) True xs\n</code></pre>\n\n<p>Can anyone explain more clearly why the first version compiles but not the second?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1449511281, "post_id": 34140074, "comment_id": 56028225, "body": "What are the <code>0</code> arguments to <code>findEl</code> in <code>lElems</code> supposed to mean? They can&#39;t be of a general type <code>a</code> that is an instance of <code>Ord</code>."}, {"owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "edited": false, "score": 0, "creation_date": 1449511285, "post_id": 34140074, "comment_id": 56028229, "body": "<code>0</code> gets into argument of <code>findEl</code> of type <code>a</code>, so <code>a</code> is inferred as <code>Integer</code>"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1449512520, "post_id": 34140074, "comment_id": 56028985, "body": "As given here, <code>lElems</code> doesn&#39;t compile (with GHC): <i>Could not deduce (GHC.Num.Num a) arising from the literal `0&#39;</i>"}], "answers": [{"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": true, "score": 1, "last_activity_date": 1449513822, "last_edit_date": 1449513822, "creation_date": 1449512903, "answer_id": 34140601, "question_id": 34140074, "link": "https://stackoverflow.com/questions/34140074/haskell-bst-inferred-type-is-not-general-enough/34140601#34140601", "title": "haskell, bst - Inferred type is not general enough", "body": "<p>If you augment each subtree with the number of elements it contains,</p>\n\n<pre><code>data BinaryTree a = Empty | Node a Integer (BinaryTree a) (BinaryTree a)\n\ninsert :: Ord a =&gt; a -&gt; BinaryTree a -&gt; BinaryTree a\ninsert x Empty = Node x 1 Empty Empty\ninsert x (Node y n left right) =\n  case x `compare` y of\n    LT -&gt; Node y (n+1) (insert x left) right\n    GT -&gt; Node y (n+1) left (insert x right)\n    EQ -&gt; Node y n left right\n\nnumElems :: BinaryTree a -&gt; Integer\nnumElems Empty = 0\nnumElems (Node _ n _ _) = n\n</code></pre>\n\n<p>Then the number of elements less than an element (disregarding duplicates) is found more easily:</p>\n\n<pre><code>countLT :: Ord a =&gt; a -&gt; BinaryTree a -&gt; Integer\ncountLT x Empty = 0\ncountLT x (Node y n left right) =\n  case x `compare` y of\n    LT -&gt; countLT x left\n    GT -&gt; 1 + numElems left + countLT x right\n    EQ -&gt; numElems left\n</code></pre>\n\n<p>E.g.</p>\n\n<pre><code>ghci&gt; let t = insert 43 (insert 41 (insert 42 Empty))\nghci&gt; map (\\i -&gt; countLT i t) [41,42,43,44]\n[0,1,2,3]\n</code></pre>\n"}], "owner": {"reputation": 2337, "user_id": 4278243, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IUMpR.jpg?s=128&g=1", "display_name": "Aleksander Monk", "link": "https://stackoverflow.com/users/4278243/aleksander-monk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 34140601, "answer_count": 1, "score": 0, "last_activity_date": 1449513822, "creation_date": 1449510982, "last_edit_date": 1449511724, "question_id": 34140074, "link": "https://stackoverflow.com/questions/34140074/haskell-bst-inferred-type-is-not-general-enough", "title": "haskell, bst - Inferred type is not general enough", "body": "<p>I'm trying to write a program that will find element in a tree and return how many elements in the tree is &lt; my element. </p>\n\n<pre><code>data Bst a = Empty | Node (Bst a) a (Bst a)\n\nlElems :: Ord a =&gt; a -&gt; Bst a -&gt; Int\nlElems n t = (counto (findEl n 0 0 t) t)\n\ncounto :: Ord a =&gt; a -&gt; Bst a -&gt; Int\ncounto n Empty = 0\ncounto n (Node l m r)\n        | m == n = counto n l\n        | n &gt; m =  1 + (counto n l) + (counto n r)\n        | n &lt; m = counto n l\n\nfindEl:: Ord a =&gt; a -&gt; a -&gt; a -&gt; Bst a -&gt; a\nfindEl n anc sta Empty = anc\nfindEl n anc sta (Node l m r) \n            | m == n = anc\n            | n &gt; m = if anc == sta || anc &gt; m  then findEl n m sta r else findEl n anc sta r\n            | n &lt; m = if anc &gt; m || anc == sta  then findEl n m sta l else findEl n anc sta r\n</code></pre>\n\n<p><code>counto</code> and <code>findEl</code> are working good, but when I try to use them together I have this error\n<a href=\"https://i.stack.imgur.com/w8epd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w8epd.png\" alt=\"Error\"></a></p>\n\n<p>Here's my test tree</p>\n\n<pre><code>lElems 2 (Node (Node (Node Empty 1 (Node Empty 2 Empty)) 3 (Node Empty 5 (Node Empty 4 Empty))) 6 (Node (Node Empty 7 Empty) 8 (Node Empty 9 Empty)))\n</code></pre>\n\n<p>And I'd like to not change anything in <code>data Bst</code> definition</p>\n\n<p>So, why <code>a</code> cant be Integer? And what's wrong in <code>lElems</code>?</p>\n\n<p>|||EDIT|||</p>\n\n<p>First 0 it's 0 which will be returned if there is no such element in the tree.\nSecond 0 it's 0 to compare with first 0 and it's only one way how findEl work on my computer</p>\n\n<p>However, if I change zeros to variables <code>p</code> and <code>m</code> ,and call <code>lElems</code> with zeros <code>lElems 2 0 0 tree</code> it works </p>\n"}, {"tags": ["haskell", "monads"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5647834, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c8f1682c67b6bb6f529ae2a9a2579157?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/5647834/john-smith"}, "edited": false, "score": 0, "creation_date": 1449596082, "post_id": 34143088, "comment_id": 56071366, "body": "I am using HUGS. I think this is Haskell 98."}, {"owner": {"reputation": 51, "user_id": 5647834, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c8f1682c67b6bb6f529ae2a9a2579157?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/5647834/john-smith"}, "edited": false, "score": 0, "creation_date": 1449596138, "post_id": 34143088, "comment_id": 56071400, "body": "I got following error when I tried import Control.Monad.Writer thru a script.  ERROR file:{Hugs}\\packages\\mtl\\Control\\Monad\\Reader.hs:47 - Haskell 98 does not support dependent parameters"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 51, "user_id": 5647834, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c8f1682c67b6bb6f529ae2a9a2579157?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/5647834/john-smith"}, "edited": false, "score": 0, "creation_date": 1449596826, "post_id": 34143088, "comment_id": 56071819, "body": "Oh, try Control.Monad.Trans.Writer then I think. Trans is from transformers package, which doesn&#39;t use as many spooky features"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 2, "last_activity_date": 1449525431, "last_edit_date": 1449525431, "creation_date": 1449521879, "answer_id": 34143088, "question_id": 34139489, "link": "https://stackoverflow.com/questions/34139489/haskell-different-implementations-of-sequence/34143088#34143088", "title": "Haskell different implementations of sequence_", "body": "<p>It's usually good to check what happens with infinite lists in Haskell</p>\n\n<pre><code>sequence_ (repeat (putChar 'a'))\n</code></pre>\n\n<p>and with lazy monads like <code>Writer</code></p>\n\n<pre><code>import Control.Monad.Writer\nexecWriter (sequence_ (repeat (tell \"a\")))\n</code></pre>\n\n<p>If my intuition is correct, you should see at least one difference between your implementations with these cases.</p>\n\n<p>Oh, and just to correct your vocabulary. <code>sequence</code> is just a function (some would call it a \"monadic function\"). Here are some diagrams about where the actual monad is:</p>\n\n<pre><code>putChar :: Char -&gt; IO   ()\n                   ^^\n                  monad\n\ntell :: w -&gt; Writer w   ()\n             ^^^^^^^^\n              monad\n\nsequence_ :: (Monad m) =&gt; [m a] -&gt; m ()\n                    ^      ^       ^\n                    +------+-------+\n                          monad\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5647834, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c8f1682c67b6bb6f529ae2a9a2579157?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/5647834/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1449525431, "creation_date": 1449508965, "question_id": 34139489, "link": "https://stackoverflow.com/questions/34139489/haskell-different-implementations-of-sequence", "title": "Haskell different implementations of sequence_", "body": "<p>I tested following implementations of </p>\n\n<pre><code>sequence_' :: Monad m =&gt; [m a] -&gt; m () \n\nsequence_'b [] = return ()\nsequence_'b (m : ms) = (foldl (&gt;&gt;) m ms) &gt;&gt; return ()\n\nsequence_'d [] = return ()\nsequence_'d (m : ms) = m &gt;&gt; sequence_'d ms\n\nsequence_'e [] = return ()\nsequence_'e (m : ms) = m &gt;&gt;= \\ _ -&gt; sequence_'e ms\n\nsequence_'g ms = foldr (&gt;&gt;) (return ()) ms\n</code></pre>\n\n<p>To test these I used following:</p>\n\n<pre><code>sequence_'e [putChar 'a', putChar 'b', putChar 'c']\n</code></pre>\n\n<p>and</p>\n\n<pre><code>sequence_'e [getChar, getChar, getChar]\n</code></pre>\n\n<p>The above tests worked. The first one put the value abc on the HUGS screen and the cursor returned to the next line.</p>\n\n<p>The second one accepted three characters typed on the HUGS screen and the cursor returned to the next line.</p>\n\n<p>Please suggest more tests which I could do to test these implementations of sequence_ (I guess this is a sequence Monad).</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "theorem-proving", "induction", "implication"], "comments": [{"owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "edited": false, "score": 0, "creation_date": 1449507782, "post_id": 34138857, "comment_id": 56026067, "body": "What you&#39;ve done on the base case is correct, since your &quot;implication&quot; is also a Haskell function. So, when you use the empty list for xs in the base case, that&#39;s ok."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1449507790, "post_id": 34138857, "comment_id": 56026072, "body": "It&#39;s unnecessary to even examine <code>no f []</code>. We know, just by expanding the definitions, that <code>null (filter f []) = null [] = True</code> is True. You can proceed immediately to proving your inductive case!"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1449508391, "post_id": 34138857, "comment_id": 56026456, "body": "&quot;If the second part is False&quot;. You&#39;ve just proved that the second part is in fact True. Therefore if the second part is False, then anything at all is True."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449508442, "post_id": 34138857, "comment_id": 56026503, "body": "Arriving at <code>True ==&gt; True</code> is a correct proof of <code>no f [] ==&gt; null (filter f [])</code> because some statement is said to be proved if it is equivalent to <code>True</code> and <code>True ==&gt; True</code> is trivially <code>True</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "is_accepted": true, "score": 1, "last_activity_date": 1449508199, "creation_date": 1449508199, "answer_id": 34139243, "question_id": 34138857, "link": "https://stackoverflow.com/questions/34138857/haskell-use-induction-to-prove-an-implication/34139243#34139243", "title": "Haskell - Use induction to prove an implication", "body": "<p>Here's the complete proof. Later, when I have a bit more of time, I'll prove this on Agda or Idris and post the code here. </p>\n\n<p>Proof by induction over <code>xs</code>.</p>\n\n<p>Case <code>xs = []</code>:</p>\n\n<pre><code>no f [] ==&gt; null (filter f [])\n== {- Filter.1, filter p [] = [] -}\nno f [] ==&gt; null ([])\n== {- No.1,  no p [] = True-}\nTrue ==&gt; null ([])\n== {- Null.1, null [] = True -}\nTrue ==&gt; True \n</code></pre>\n\n<p>Case <code>xs = y : ys</code>. Suppose that <code>no f ys == null (filter f ys)</code>. Consider the following cases:</p>\n\n<p>Case <code>f y == True</code>:</p>\n\n<pre><code>no f (y : ys) ==&gt; null (filter f (y : ys))\n== {- no - f y == True -}\nFalse ==&gt; null (filter f (y : ys))\n== \nTrue\n</code></pre>\n\n<p>Case <code>f y == False</code>:</p>\n\n<pre><code>no f (y : ys) ==&gt; null (filter f (y : ys))\n=={- By definition of filter and no -}\nno f ys ==&gt; null (filter f ys)\n== {By I.H.}\nTrue\n</code></pre>\n\n<p>Which finishes the proof.</p>\n"}], "owner": {"reputation": 149, "user_id": 5498865, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iCmWc.png?s=128&g=1", "display_name": "Fossa", "link": "https://stackoverflow.com/users/5498865/fossa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 34139243, "answer_count": 1, "score": 2, "last_activity_date": 1449508199, "creation_date": 1449507007, "question_id": 34138857, "link": "https://stackoverflow.com/questions/34138857/haskell-use-induction-to-prove-an-implication", "title": "Haskell - Use induction to prove an implication", "body": "<p>I've to prove by induction that </p>\n\n<pre><code>no f xs ==&gt; null (filter f xs)\n</code></pre>\n\n<p>Where :</p>\n\n<pre><code>filter p []    = []\nfilter p (x:xs) \n  | p x        = x : filter p xs\n  | otherwise  = filter p xs\n\nnull [] = True; null _ = False \n\nno p [] = True\nno p (x:xs)\n  | p x = False\n  | otherwise = no p xs\n\nLogic implication:\nTrue ==&gt; False = False\n_    ==&gt; _     = True\n</code></pre>\n\n<p>So, I've supposed that the followings are my assumption and my claim:</p>\n\n<pre><code>Assumption: no f xs ==&gt; null (filter f xs)\nClaim: no f (x:xs) ==&gt; null (filter f (x:xs))\n</code></pre>\n\n<p>And I started to try to prove the base case (the empty list):</p>\n\n<pre><code>no f [] ==&gt; null (filter f [])\n== {- Filter.1, filter p [] = [] -}\nno f [] ==&gt; null ([])\n== {- No.1,  no p [] = True-}\nTrue ==&gt; null ([])\n== {- Null.1, null [] = True -}\nTrue ==&gt; True \n</code></pre>\n\n<p>But I'm not sure it is correct, because I've proved that they are both True and not that if the left part is True and the second part is False, then the implication is False (that is the definition of ==>).\nIs this correct?\nHow can I go on with the proof?\nI don't clearly get how can I use induction to prove an implication...</p>\n\n<p>Thank you in advance! </p>\n"}, {"tags": ["c", "haskell", "functional-programming", "clang"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1449507120, "post_id": 34138730, "comment_id": 56025602, "body": "Is <code>f</code> fixed or variable?"}, {"owner": {"reputation": 486, "user_id": 3807103, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-YNIokoSHQ8U/AAAAAAAAAAI/AAAAAAAAAFs/hUUwaGWJ4IQ/photo.jpg?sz=128", "display_name": "qleguennec", "link": "https://stackoverflow.com/users/3807103/qleguennec"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1449507251, "post_id": 34138730, "comment_id": 56025691, "body": "One way of answering that question would be to somehow find a way to allow f to be visible to arg, to be able to call f in its function body."}, {"owner": {"reputation": 486, "user_id": 3807103, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-YNIokoSHQ8U/AAAAAAAAAAI/AAAAAAAAAFs/hUUwaGWJ4IQ/photo.jpg?sz=128", "display_name": "qleguennec", "link": "https://stackoverflow.com/users/3807103/qleguennec"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1449507368, "post_id": 34138730, "comment_id": 56025772, "body": "f is a variable relative to g"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1449507719, "post_id": 34138730, "comment_id": 56026020, "body": "@qleguennec, no, <a href=\"http://ideone.com/NWmtB4\" rel=\"nofollow noreferrer\">I&#39;m wrong</a>."}, {"owner": {"reputation": 486, "user_id": 3807103, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-YNIokoSHQ8U/AAAAAAAAAAI/AAAAAAAAAFs/hUUwaGWJ4IQ/photo.jpg?sz=128", "display_name": "qleguennec", "link": "https://stackoverflow.com/users/3807103/qleguennec"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1449507956, "post_id": 34138730, "comment_id": 56026181, "body": "@user3237465 I&#39;ll re-edit, but whatever, haskell is not really a thing there"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1449508142, "post_id": 34138730, "comment_id": 56026305, "body": "With the restrictions you impose, you can&#39;t, but in practice it&#39;s not a problem because the restrictions you impose do not exist. I cannot provide a proof for this, though, so just a comment instead of an answer."}, {"owner": {"reputation": 486, "user_id": 3807103, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-YNIokoSHQ8U/AAAAAAAAAAI/AAAAAAAAAFs/hUUwaGWJ4IQ/photo.jpg?sz=128", "display_name": "qleguennec", "link": "https://stackoverflow.com/users/3807103/qleguennec"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1449508346, "post_id": 34138730, "comment_id": 56026423, "body": "@FUZxxl They do exist if you say they do, or, in my case, someone else say they do. I should have been downvoted for that question."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 2, "creation_date": 1449508481, "post_id": 34138730, "comment_id": 56026527, "body": "@qleguennec Then you made probably a mistake when you designed your callback.  If you could post your actual code, we can try to find a solution for that instead of solving a meta-problem that cannot be solved in general in C."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1449509356, "post_id": 34138730, "comment_id": 56027111, "body": "@qleguennec, you seem to have created an unnecessary problem for yourself.  Especially with such a simple function <code>ft_striteri_helper()</code>, the easiest solution would probably be to write a separate version of that function for the case of one-arg <code>f()</code>.  A C++ solution would undoubtedly boil down to that once you pierced the layers of polymorphism and encapsulation that surely would be applied.  You could write C code that emulated the C++ way, but that seems like rather a lot of mess and fuss for something that can be simple."}, {"owner": {"reputation": 486, "user_id": 3807103, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-YNIokoSHQ8U/AAAAAAAAAAI/AAAAAAAAAFs/hUUwaGWJ4IQ/photo.jpg?sz=128", "display_name": "qleguennec", "link": "https://stackoverflow.com/users/3807103/qleguennec"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1449511739, "post_id": 34138730, "comment_id": 56028519, "body": "@John Bollinger I do not chose the types of the functions I need to write, nor the language I use to write them."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1449516104, "post_id": 34138730, "comment_id": 56030990, "body": "@qleguennec, to a large extent, you <i>do</i> choose the types of functions you write.  In this case, the alternative I suggested seems entirely viable, as it would not need to involve any differences at all in the names or arguments of the external functions you provide."}], "answers": [{"comments": [{"owner": {"reputation": 486, "user_id": 3807103, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-YNIokoSHQ8U/AAAAAAAAAAI/AAAAAAAAAFs/hUUwaGWJ4IQ/photo.jpg?sz=128", "display_name": "qleguennec", "link": "https://stackoverflow.com/users/3807103/qleguennec"}, "edited": false, "score": 0, "creation_date": 1449507894, "post_id": 34139098, "comment_id": 56026143, "body": "f is not visible to that function you wrote"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 486, "user_id": 3807103, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-YNIokoSHQ8U/AAAAAAAAAAI/AAAAAAAAAFs/hUUwaGWJ4IQ/photo.jpg?sz=128", "display_name": "qleguennec", "link": "https://stackoverflow.com/users/3807103/qleguennec"}, "edited": false, "score": 0, "creation_date": 1449508006, "post_id": 34139098, "comment_id": 56026214, "body": "@qleguennec, whyever not?  Surely whether <code>f()</code> is visible to <code>f2()</code> is not directly dependent on <code>f2()</code> itself."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 486, "user_id": 3807103, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-YNIokoSHQ8U/AAAAAAAAAAI/AAAAAAAAAFs/hUUwaGWJ4IQ/photo.jpg?sz=128", "display_name": "qleguennec", "link": "https://stackoverflow.com/users/3807103/qleguennec"}, "edited": false, "score": 0, "creation_date": 1449508043, "post_id": 34139098, "comment_id": 56026233, "body": "@qleguennec That makes no sense. Maybe you should edit your question and provide skeleton C program to demonstrate the problem."}, {"owner": {"reputation": 486, "user_id": 3807103, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-YNIokoSHQ8U/AAAAAAAAAAI/AAAAAAAAAFs/hUUwaGWJ4IQ/photo.jpg?sz=128", "display_name": "qleguennec", "link": "https://stackoverflow.com/users/3807103/qleguennec"}, "edited": false, "score": 0, "creation_date": 1449508230, "post_id": 34139098, "comment_id": 56026360, "body": "Because f is relative to g, even if it is defined somewhere else, at any point, I&#39;ll use it like this: g(that_function). However, I&#39;ll refer it as &#39;f&#39; in the body of g. If you think it will make more sense, I can edit my question with the real code I&#39;m trying to write."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1449508049, "last_edit_date": 1449508049, "creation_date": 1449507761, "answer_id": 34139098, "question_id": 34138730, "link": "https://stackoverflow.com/questions/34138730/how-to-lift-a-function-to-take-an-extra-parameter-in-c/34139098#34139098", "title": "How to lift a function to take an extra parameter in C?", "body": "<p>Since you want only to accept and ignore the extra parameter, you can accomplish this by creating a wrapper function with the required signature, that simply delegates to the original function:</p>\n\n<pre><code>void f2(unsigned int i, char *s) {\n    f(s);\n}\n</code></pre>\n\n<p>With a proper declaration of that function in scope, you can then simply call</p>\n\n<pre><code>g(f2);\n</code></pre>\n\n<p>Function <code>f2()</code> can be declared static if you wish, so that it is not visible to code outside the file in which it is defined.  It does not need to be nested.</p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1449509776, "post_id": 34139634, "comment_id": 56027368, "body": "Varargs functions are irrelevant to the problem as stated because the functions involved <i>are not</i> varargs functions.  No amount of wrapping, via varargs or otherwise, allows a function pointer of type <code>void(*)(unsigned int, char *)</code> to carry information about what <i>other</i> function the pointed to function should call.  That has to be determined somehow by the function implementation."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1449509846, "post_id": 34139634, "comment_id": 56027406, "body": "Macros are not useful for the OP&#39;s case, because he wants a <i>dynamic</i> solution, not a static one."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1449510030, "post_id": 34139634, "comment_id": 56027491, "body": "Possibly C++ and lambdas would be an alternative, but the OP has asserted that it is not.  Unless you have some reason to contradict him on that point, it is useless to suggest lambdas (or C++)."}], "tags": [], "owner": {"reputation": 881, "user_id": 5635258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b69b37f21456c0333195948af74563b9?s=128&d=identicon&r=PG&f=1", "display_name": "StephenG", "link": "https://stackoverflow.com/users/5635258/stepheng"}, "is_accepted": false, "score": -1, "last_activity_date": 1449512548, "last_edit_date": 1592644375, "creation_date": 1449509466, "answer_id": 34139634, "question_id": 34138730, "link": "https://stackoverflow.com/questions/34138730/how-to-lift-a-function-to-take-an-extra-parameter-in-c/34139634#34139634", "title": "How to lift a function to take an extra parameter in C?", "body": "<p>Well let's consider a few options.</p>\n<p>Firstly C has no lambda expressions, although the latest C++ standard does.  It might be worth your while consider C++ instead of C if this is a major issue for you.</p>\n<p>C can define and pass <a href=\"https://stackoverflow.com/questions/840501/how-do-function-pointers-in-c-work\">function pointers</a>.  So it <em>is</em> perfectly legal to pass a function as a parameter to another function.</p>\n<p>You can also define <a href=\"http://www.cse.unt.edu/%7Edonr/courses/4410/NOTES/stdarg/index.html\" rel=\"nofollow noreferrer\">functions to take a variable number of arguments</a>, which may also be useful to you.</p>\n<p>Also C macros can be useful.  You can, for example do this :</p>\n<pre><code>#define f1( x )   g( (x), 1 )\n#define f2( x )   g( (x), 2 )\n\nint g( int x, int y )\n{\n    return ( x + y ) ;\n}\n</code></pre>\n<p>You can even do clever things with macros to allow <a href=\"https://stackoverflow.com/questions/11761703/overloading-macro-on-number-of-arguments/11763277#11763277\">macro overloading</a>.  That's not exactly ideal in terms of coding style, but it's possible.</p>\n<p>So there may be some tools in there to get you what you want.</p>\n<h1>Update</h1>\n<p>The OP added an update to his post while I was making up mine, so if I understand his goal here is a rough suggestion.</p>\n<p>As it appears the OP wants the chosen function to have access to an index variable which can be set elsewhere he could try using a struct for parameters.  Perhaps something like :</p>\n<pre><code>typedef struct mystring_s {\n    char *s ;\n    int i ;\n    } mystring_t ;\n\nvoid f1( mystring_t *strp )\n{\n    /* can access strp-&gt;s and strp-&gt;i */\n}\n\n/* and similar for other functions f2, f2, etc. */\n\n/* And to use this you can call any function using\n */\n\nvoid g( void (*fn)( mystring_t * ), mystring_t *strp )\n{\n    (*fn)( strp ) ;\n}\n\nvoid set_i( mystring_t *strp, int v )\n{\n    strp-&gt;i = v ;\n}\n\n/* for example */\n\nmystring_t s ;\n\n/* set up s */\n\nset_i( &amp;s, 11 ) ;\ng( &amp;f1, &amp;s ) ;\nset_i( &amp;s, 31 ) ;\ng( &amp;f2, &amp;s ) ;\n</code></pre>\n<p>Of course he could also try using a global value ( which he apparently does not want to or thinks is not possible ), and he could even store a function pointer with the data.</p>\n<p>Hard to know for sure if this is a workable idea for the OP, as he's really trying to do something that C is not designed for.  I think the problem is that he has a design idea in his head and it is a bad choice for C.  It might be better to look at how this requirements arose, and modify that overall design to something more C-friendly, than to try and make C do something to replace Haskell's capabilities.</p>\n"}, {"comments": [{"owner": {"reputation": 486, "user_id": 3807103, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-YNIokoSHQ8U/AAAAAAAAAAI/AAAAAAAAAFs/hUUwaGWJ4IQ/photo.jpg?sz=128", "display_name": "qleguennec", "link": "https://stackoverflow.com/users/3807103/qleguennec"}, "edited": false, "score": 0, "creation_date": 1449511564, "post_id": 34139761, "comment_id": 56028408, "body": "This might be the closest answer, but unfortunatly, this can&#39;t work because the prototypes are immuable, it has to be exactly as stated. I will however validate that answer."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 486, "user_id": 3807103, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-YNIokoSHQ8U/AAAAAAAAAAI/AAAAAAAAAFs/hUUwaGWJ4IQ/photo.jpg?sz=128", "display_name": "qleguennec", "link": "https://stackoverflow.com/users/3807103/qleguennec"}, "edited": false, "score": 0, "creation_date": 1449518165, "post_id": 34139761, "comment_id": 56032143, "body": "@qleguennec In C, well-designed libraries involving callbacks often use this kind of idiom to get something similar to functional closures. A closure can be implemented as a fully-abstracted lambda term (with no free variables) paired with an environment (providing the values for the first <code>k</code> arguments). In C, this is rendered as a function pointer, plus a <code>void *</code> pointer to the environment/context. If a library fails to provide this feature, there&#39;s no portable workaround. Even the standard library fails at this (<code>qsort</code>), though :-/"}, {"owner": {"reputation": 486, "user_id": 3807103, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-YNIokoSHQ8U/AAAAAAAAAAI/AAAAAAAAAFs/hUUwaGWJ4IQ/photo.jpg?sz=128", "display_name": "qleguennec", "link": "https://stackoverflow.com/users/3807103/qleguennec"}, "edited": false, "score": 0, "creation_date": 1449523233, "post_id": 34139761, "comment_id": 56034997, "body": "This will probably upset you and I am sorry about it. After reading documentation I understood that solution and this is the right answer to my problem. However, and I recognize I didn&#39;t state it in my post, I am not allowed to declare a structure nor a typedef in a c file. I could declare the structures I need in my header, but then I&#39;d need to find a name to all of them. I guess I can&#39;t use this solution, but thanks anyway, I learned something!"}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 4, "last_activity_date": 1449509894, "creation_date": 1449509894, "answer_id": 34139761, "question_id": 34138730, "link": "https://stackoverflow.com/questions/34138730/how-to-lift-a-function-to-take-an-extra-parameter-in-c/34139761#34139761", "title": "How to lift a function to take an extra parameter in C?", "body": "<p>You cannot implement this in standard portable C. The problem is that the function <code>g</code>. is designed wrong. It should have type</p>\n\n<pre><code>void g(void (*f) (void *, unsigned int, char), void *ctxt)\n</code></pre>\n\n<p>and it should pass its <code>ctxt</code> argument as the first argument to any <code>f</code> calls it makes.</p>\n\n<p>Now you can implement what you want with code like</p>\n\n<pre><code>struct const_ctxt {\n    void (*fun)(char *);\n}\n\nvoid const(void *ctxt, unsigned int i, char *s)\n{\n    ((struct const_ctxt *)ctxt)-&gt;fun(s);\n}\n\nvoid call_g_using_const_f(void (*f)(char *))\n{\n    struct const_ctxt *ctxt = malloc(sizeof (struct const_ctxt));\n    ctxt-&gt;fun = f;\n    g(const, (void *)ctxt);\n    free(ctxt);\n}\n</code></pre>\n\n<p>Warning: If the arguments to <code>g</code> might escape the dynamic scope of <code>g</code> then you will need to find another strategy for managing the allocation of the <code>ctxt</code>s.</p>\n\n<p>The pattern of <code>g</code> taking a pair of a code pointer and a data \"context\"/\"environment\" pointer is how higher-level languages typically implement closures.</p>\n"}], "owner": {"reputation": 486, "user_id": 3807103, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh3.googleusercontent.com/-YNIokoSHQ8U/AAAAAAAAAAI/AAAAAAAAAFs/hUUwaGWJ4IQ/photo.jpg?sz=128", "display_name": "qleguennec", "link": "https://stackoverflow.com/users/3807103/qleguennec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "accepted_answer_id": 34139761, "answer_count": 3, "score": 6, "last_activity_date": 1449512548, "creation_date": 1449506640, "last_edit_date": 1449508824, "question_id": 34138730, "link": "https://stackoverflow.com/questions/34138730/how-to-lift-a-function-to-take-an-extra-parameter-in-c", "title": "How to lift a function to take an extra parameter in C?", "body": "<p>(I understand that C is not intended to be used in a functional way. However, having learned functional programming, I have trouble thinking differently.)</p>\n\n<p>Given those restrictions:</p>\n\n<ul>\n<li>No nested functions because clang forbids it (so no lamda expressions)</li>\n<li>no global variables</li>\n</ul>\n\n<p>Can we think of a way of lifting a function f to take an extra parameter to fit a prototype, such as this new parameter will be ignored when f is executed?</p>\n\n<p>Here is in detail what I want to do:</p>\n\n<p>I want to fit a function f whose type is:</p>\n\n<pre><code>f :: void f(char *s)\n</code></pre>\n\n<p>in a function g that takes an function as an argument (call it arg), whose type is:</p>\n\n<pre><code>arg :: void f(unsigned int i, char *s)\n</code></pre>\n\n<p>Thus, the type of g is:</p>\n\n<pre><code>g :: void g(void (*f) (unsigned int, char))\n</code></pre>\n\n<p>The solution in haskell would be the following:</p>\n\n<pre><code>g (const f)\n</code></pre>\n\n<p>Is that even possible, maybe with some kind of macro wizardry?</p>\n\n<p>EDIT: To provide a better understanding, here is the actual code. The body of ft_striter needs to be completed. The purpose is: apply the function f to every character of a string, using or not using its index i.</p>\n\n<pre><code>void        ft_striter(char *s, void (*f) (char *s))\n{\n    ft_striteri(?);\n}\n\nstatic void ft_striteri_helper(char *s, unsigned int i, void (*f)(unsigned int, char*))\n{\n    if (*s) \n    {\n        f(i, s);\n        ft_striteri_helper(s + 1, i + 1, f);\n    }\n}\n\nvoid        ft_striteri(char *s, void (*f)(unsigned int, char*))\n{\n    ft_striteri_helper(s, 0, f);\n}\n</code></pre>\n"}, {"tags": ["list", "haskell", "filter"], "comments": [{"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 2, "creation_date": 1449506618, "post_id": 34138605, "comment_id": 56025251, "body": "Consider passing a set of already-seen numbers between invocations of the function that scans your list of lists. (Remember how a partial result is passed around during invocation of <code>fold</code>)."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1449506714, "post_id": 34138605, "comment_id": 56025329, "body": "I have no mood to make a proper answer of this (and it&#39;s not really efficient), but a possible solution is <code>nubBy (\\l m -&gt; not . null $ intersect l m)</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1449506861, "post_id": 34138605, "comment_id": 56025429, "body": "Say you have a list <code>[[1,3,2],[5,6],[3,8],[10,11],[8],[13,6]]</code>, should <code>[8]</code> be part of the output too? You did not &quot;emit&quot; <code>[3,8]</code>, but still have observed it so to speak."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449506932, "post_id": 34138605, "comment_id": 56025480, "body": "While the desired semantics of this function are somewhat ambiguous, this should be a good starting point: <code>($[]) . fst . foldl (\\(r,seen) l -&gt; (if any (`elem` seen) l then r else r . (l:) , l++seen)) (id,[])</code>"}, {"owner": {"reputation": 24126, "user_id": 368864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/76e6f95b06ade13607a4dd999f7f72e5?s=128&d=identicon&r=PG", "display_name": "cambraca", "link": "https://stackoverflow.com/users/368864/cambraca"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1449506987, "post_id": 34138605, "comment_id": 56025518, "body": "@CommuSoft the entire <code>[3,8]</code> item should go away. I&#39;m trying to do something like @9000 suggested, building a new <code>[Int]</code> list of &quot;previously seen numbers&quot; and passing it around, still unsuccessful.."}, {"owner": {"reputation": 24126, "user_id": 368864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/76e6f95b06ade13607a4dd999f7f72e5?s=128&d=identicon&r=PG", "display_name": "cambraca", "link": "https://stackoverflow.com/users/368864/cambraca"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1449507085, "post_id": 34138605, "comment_id": 56025581, "body": "@leftaroundabout wow that totally seems to work. I have no idea how/why though. Care to put it in an answer and explain it a bit? What does <code>nubBy</code> do?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1449507434, "post_id": 34138605, "comment_id": 56025824, "body": "@cambraca: <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html#v:nubBy\" rel=\"nofollow noreferrer\">read the documentation</a>. When you don&#39;t know where the documentation is, <a href=\"http://hayoo.fh-wedel.de/?query=nubBy\" rel=\"nofollow noreferrer\">ask Hayoo</a>. When you don&#39;t even know the name of a function you need, <a href=\"https://www.haskell.org/hoogle/?hoogle=Eq+a+%3D%3E+%5Ba%5D+-%3E+%5Ba%5D+-%3E+%5Ba%5D\" rel=\"nofollow noreferrer\">ask Hoogle</a>."}, {"owner": {"reputation": 24126, "user_id": 368864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/76e6f95b06ade13607a4dd999f7f72e5?s=128&d=identicon&r=PG", "display_name": "cambraca", "link": "https://stackoverflow.com/users/368864/cambraca"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1449516377, "post_id": 34138605, "comment_id": 56031138, "body": "@leftaroundabout that&#39;s useful, I wasn&#39;t aware of all of those resources. Thanks!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1449543052, "post_id": 34138605, "comment_id": 56042085, "body": "@cambraca CommuSoft&#39;s question was not about the <code>[3,8]</code> item -- which we all agree should not be emitted -- but about the <code>[8]</code> item that appears later in their sample input list. A shorter example is: what should the behavior on <code>[[0], [0,1], [1]]</code> be, <code>[[0]]</code> or <code>[[0], [1]]</code>?"}, {"owner": {"reputation": 24126, "user_id": 368864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/76e6f95b06ade13607a4dd999f7f72e5?s=128&d=identicon&r=PG", "display_name": "cambraca", "link": "https://stackoverflow.com/users/368864/cambraca"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1449543760, "post_id": 34138605, "comment_id": 56042273, "body": "@DanielWagner @CommuSoft sorry, I missed that! That&#39;s a good question. The <code>[8]</code> item should be kept, since <code>8</code> is not in the previous lists."}], "answers": [{"comments": [{"owner": {"reputation": 24126, "user_id": 368864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/76e6f95b06ade13607a4dd999f7f72e5?s=128&d=identicon&r=PG", "display_name": "cambraca", "link": "https://stackoverflow.com/users/368864/cambraca"}, "edited": false, "score": 0, "creation_date": 1449529329, "post_id": 34138902, "comment_id": 56037939, "body": "Any idea how this compares to @leftroundabout&#39;s solution in terms of performance? (<code>nubBy (\\l m -&gt; not . null $ intersect l m)</code>)"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 24126, "user_id": 368864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/76e6f95b06ade13607a4dd999f7f72e5?s=128&d=identicon&r=PG", "display_name": "cambraca", "link": "https://stackoverflow.com/users/368864/cambraca"}, "edited": false, "score": 0, "creation_date": 1449534669, "post_id": 34138902, "comment_id": 56039777, "body": "@cambraca: the <code>intersect</code> and <code>numBy</code> are not fully specified, but based on what I&#39;ve seen before, I expect quadratic time complexity whereas using a <code>HashSet</code> results in linear time complexity (see edit)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1449543162, "post_id": 34138902, "comment_id": 56042106, "body": "@CommuSoft The standard library includes <code>Data.List</code>, which contains both <code>intersect</code> and <code>nubBy</code>."}, {"owner": {"reputation": 24126, "user_id": 368864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/76e6f95b06ade13607a4dd999f7f72e5?s=128&d=identicon&r=PG", "display_name": "cambraca", "link": "https://stackoverflow.com/users/368864/cambraca"}, "edited": false, "score": 0, "creation_date": 1449543620, "post_id": 34138902, "comment_id": 56042242, "body": "@CommuSoft sorry if this is a dumb question, I&#39;m getting an error on <code>... =&gt; Set a ...</code>: &quot;Not in scope: type constructor or class &#39;Set&#39;&quot;. Do I need to import something else? Also, I was using Data.List, which apparently has a lot of similar functions to Data.HashSet. Why is this? What&#39;s the difference between <code>filter</code> or <code>union</code> between the two? I assume I can&#39;t use them interchangeably."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1449549027, "post_id": 34138902, "comment_id": 56043617, "body": "@DanielWagner: yes I know. I mean the documentation seems to lack the time complexity."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 24126, "user_id": 368864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/76e6f95b06ade13607a4dd999f7f72e5?s=128&d=identicon&r=PG", "display_name": "cambraca", "link": "https://stackoverflow.com/users/368864/cambraca"}, "edited": false, "score": 1, "creation_date": 1449549038, "post_id": 34138902, "comment_id": 56043622, "body": "@cambraca: did you install the <code>hashmap</code> package? There is another package (<code>unordered-containers</code>) that uses the same module name..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1449555437, "post_id": 34138902, "comment_id": 56045733, "body": "@CommuSoft Ah, sorry for the noise, then."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1449549298, "last_edit_date": 1495541712, "creation_date": 1449507123, "answer_id": 34138902, "question_id": 34138605, "link": "https://stackoverflow.com/questions/34138605/removing-elements-from-int-list-if-the-numbers-appeared-before-in-the-same-l/34138902#34138902", "title": "Removing elements from [[Int]] list if the numbers appeared before in the same list in Haskell", "body": "<p>What about this: you use an accumulator like a <a href=\"https://hackage.haskell.org/package/hashmap-1.3.0.1/docs/Data-HashSet.html\" rel=\"nofollow noreferrer\">Data.HashSet</a> and then use some kind of filter approach like:</p>\n\n<pre><code>import Data.HashSet\nimport Data.Hashable\n\nsomefilter :: (Hashable a, Ord a) =&gt; [[a]] -&gt; [[a]]\nsomefilter = sf empty\n\nsf :: (Hashable a, Ord a) =&gt; Set a -&gt; [[a]] -&gt; [[a]]\nsf hs (x:xs) | any (flip member hs) x = tl\n             | otherwise = x : tl\n             where tl = sf (foldr insert hs x) xs\nsf _ [] = []\n</code></pre>\n\n<p>Then the demo:</p>\n\n<pre><code>*Main&gt; somefilter [[1,3,2],[5,6],[3,8],[10,11],[13,6]]\n[[1,3,2],[5,6],[10,11]]\n</code></pre>\n\n<p>You can of course use another datastructure (list, treeset, whatever) to store the values you've encountered thus far. A <code>HashSet</code> is simply a reasonable choice because of the low lookup and insertion time complexity.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>Evidently time complexity is not easy to measure for lazy programming. If you intend to generate the entire list, the time complexities can be derived from the <a href=\"https://hackage.haskell.org/package/containers-0.4.2.1/docs/Data-IntMap.html#t:IntMap\" rel=\"nofollow noreferrer\">documentation of <code>Data.IntMap</code></a>.</p>\n\n<p>Given that the total number of elements is <em>N</em> (not to be confused with the number of <em>lists</em>), and we consider the number of bits of the <code>Int</code> <em>W</em> fixed (32 or 64), both <code>insert</code> and <code>lookup</code> are done in constant time. This means that the total time complexity is <em>O(N)</em>.</p>\n\n<p>For the <code>nubBy</code> solution, although the time complexity for <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html#v:intersect\" rel=\"nofollow noreferrer\"><code>intersect</code></a> this probably runs in <em>O(m n)</em> with <em>m</em> the number of items in one list, and <em>n</em> the number of elements in another list. This is done for each list against all previous. So in case there are <em>O(k)</em> lists, the time complexity is <em>O(k<sup>2</sup> a<sup>2</sup>)</em> with <em>a</em> the average number of items in a list. Since <em>a k=N</em>, the time complexity is thus approximately <em>O(N<sup>2</sup>)</em>.</p>\n\n<p><strong>Edit 2</strong></p>\n\n<p>Based on <a href=\"https://stackoverflow.com/questions/34138605/removing-elements-from-int-list-if-the-numbers-appeared-before-in-the-same-l/34138902?noredirect=1#comment56042273_34138605\">your comment</a>, you can rewrite the function in order to meet the new specifications:</p>\n\n<pre><code>import Data.HashSet\nimport Data.Hashable\n\nsomefilter2 :: (Hashable a, Ord a) =&gt; [[a]] -&gt; [[a]]\nsomefilter2 = sf2 empty\n\nsf2 :: (Hashable a, Ord a) =&gt; Set a -&gt; [[a]] -&gt; [[a]]\nsf2 hs (x:xs) | any (flip member hs) x = sf2 hs xs\n              | otherwise = x : sf2 (foldr insert hs x) xs\nsf2 _ [] = []\n</code></pre>\n\n<p>With the difference between <code>somefilter</code> and <code>somefilter2</code>:</p>\n\n<pre><code>*Main&gt; somefilter [[1,3,2],[5,6],[3,8],[10,11],[8],[13,6]]\n[[1,3,2],[5,6],[10,11]]\n*Main&gt; somefilter2 [[1,3,2],[5,6],[3,8],[10,11],[8],[13,6]]\n[[1,3,2],[5,6],[10,11],[8]]\n</code></pre>\n\n<p>there is only a difference in the recursive part of <code>sf</code>: now you only add elements to the <code>Set</code> in case you \"<em>emit</em>\" an element.</p>\n"}], "owner": {"reputation": 24126, "user_id": 368864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/76e6f95b06ade13607a4dd999f7f72e5?s=128&d=identicon&r=PG", "display_name": "cambraca", "link": "https://stackoverflow.com/users/368864/cambraca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449549298, "creation_date": 1449506254, "last_edit_date": 1449512219, "question_id": 34138605, "link": "https://stackoverflow.com/questions/34138605/removing-elements-from-int-list-if-the-numbers-appeared-before-in-the-same-l", "title": "Removing elements from [[Int]] list if the numbers appeared before in the same list in Haskell", "body": "<p>I have something like this:</p>\n\n<pre><code>[[1,3,2],[5,6],[3,8],[10,11],[13,6]]\n</code></pre>\n\n<p>And I want to filter out the third and last list, so that it becomes:</p>\n\n<pre><code>[[1,3,2],[5,6],[10,11]]\n</code></pre>\n\n<p>The logic is to remove the lists if any of the numbers \"appeared before\" (in the case of <code>[3,8]</code>, the number <code>3</code> appears in the first list).</p>\n\n<p>I can only think of non-FP methods to do this. My goal is to learn Haskell in a \"good way\". How can this be done?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 7, "creation_date": 1449502129, "post_id": 34137057, "comment_id": 56022018, "body": "&quot;I want to return element if it&#39;s in the tree and -1 if not&quot; -- if the elements are not numbers, there&#39;s no type that includes both -1 and the element values. Consider using Haskell-style <code>Maybe</code> instead of broken C-style error reporting."}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 6, "last_activity_date": 1449502499, "last_edit_date": 1449502499, "creation_date": 1449502111, "answer_id": 34137222, "question_id": 34137057, "link": "https://stackoverflow.com/questions/34137057/haskell-finding-element-in-bst/34137222#34137222", "title": "Haskell, finding element in bst", "body": "<p>In the <code>n == m</code> case, <code>lElems</code> returns <code>n</code>. From the type signature, the function is declared as always returning <code>Int</code>. This means that <code>n</code> <em>must</em> be an <code>Int</code>, and thus, can't be <em>any</em> <code>Ord a</code>.</p>\n\n<p><s>Try converting <code>n</code> into <code>Int</code> before returning it;</s> that will probably require you to further constrain <code>a</code>, though.</p>\n\n<p>Instead of returning <code>-1</code> in the case where you don't find what you're looking for, consider changing the return type to <code>Maybe a</code>, or perhaps an <code>Either</code> value.</p>\n"}], "owner": {"reputation": 2337, "user_id": 4278243, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IUMpR.jpg?s=128&g=1", "display_name": "Aleksander Monk", "link": "https://stackoverflow.com/users/4278243/aleksander-monk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 34137222, "answer_count": 1, "score": 3, "last_activity_date": 1449502499, "creation_date": 1449501697, "question_id": 34137057, "link": "https://stackoverflow.com/questions/34137057/haskell-finding-element-in-bst", "title": "Haskell, finding element in bst", "body": "<pre><code>data Bst a = Empty | Node (Bst a) a (Bst a)\n\nlElems :: Ord a =&gt; a -&gt; Bst a -&gt; Int\nlElems _ Empty = -1\nlElems n (Node l m r)\n                | n == m = n\n                | n &gt; m = lElems n r\n                | n &lt; m = lElems n l\n</code></pre>\n\n<p>Here you see definition of type and program. I want to return element if it's in the tree and -1 if not. </p>\n\n<pre><code>However, I had this problem \n Couldn't match expected type `Int' with actual type `a'\n      `a' is a rigid type variable bound by\n          the type signature for lElems :: Ord a =&gt; a -&gt; Bst a -&gt; Int\n          at C:\\Users\\User\\workspace\\s\\src\\Main.hs:3:11\n</code></pre>\n\n<p>Can someone explain me what is wrong here?</p>\n"}, {"tags": ["haskell", "types", "parentheses"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1449536299, "post_id": 34136852, "comment_id": 56040228, "body": "How are the question in the text and the question in the title related? Parentheses in type signatures do <i>not</i> denote special semantics, they are for precedence, just like everywhere else in Haskell, which is why the two snippets are <i>not</i> equivalent."}, {"owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1449565440, "post_id": 34136852, "comment_id": 56050315, "body": "@J&#246;rgWMittag: I agree that the two questions are not <i>equivalent</i> -- and in fact have different answers -- but I&#39;m surprised that you find them <i>unrelated</i>. They&#39;re both about the meaning of parentheses in type signatures; a &quot;yes&quot; answer to the question in the title would probably entail a &quot;yes&quot; answer to the question in the text; and a good answer to either question would probably implicitly (or even explicitly) answer the other."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 2, "creation_date": 1449565679, "post_id": 34136852, "comment_id": 56050449, "body": "Parentheses in type signatures denote precedence, just like in terms. Precedence is purely a <i>syntactic</i> property, it has no semantic significance. So, parentheses in type signatures are neither special nor semantics, and <i>that</i> is why the two snippets are not equivalent, just like <code>a + b * c</code> and <code>(a + b) * c</code> are not equivalent, also because of syntactic precedence and not because of semantics."}], "answers": [{"tags": [], "owner": {"reputation": 1025, "user_id": 1439629, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4cfce72158cd5741f0a48e67483b85e8?s=128&d=identicon&r=PG", "display_name": "Hamish", "link": "https://stackoverflow.com/users/1439629/hamish"}, "is_accepted": false, "score": 13, "last_activity_date": 1449501329, "creation_date": 1449501329, "answer_id": 34136925, "question_id": 34136852, "link": "https://stackoverflow.com/questions/34136852/what-is-the-meaning-of-parentheses-in-haskell-type-signatures/34136925#34136925", "title": "What is the meaning of parentheses in Haskell type signatures?", "body": "<p>Yes,</p>\n\n<pre><code>(a -&gt; b) -&gt; ...\n</code></pre>\n\n<p>means \"given a function which takes a to b ...\". While, this</p>\n\n<pre><code>a -&gt; b -&gt; ...\n</code></pre>\n\n<p>means \"given some a and some b...\"</p>\n"}, {"tags": [], "owner": {"reputation": 32271, "user_id": 75652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/303ee8d24a8776dcf67b30c1d4e8b064?s=128&d=identicon&r=PG", "display_name": "janneb", "link": "https://stackoverflow.com/users/75652/janneb"}, "is_accepted": false, "score": 6, "last_activity_date": 1488465264, "last_edit_date": 1488465264, "creation_date": 1449501424, "answer_id": 34136956, "question_id": 34136852, "link": "https://stackoverflow.com/questions/34136852/what-is-the-meaning-of-parentheses-in-haskell-type-signatures/34136956#34136956", "title": "What is the meaning of parentheses in Haskell type signatures?", "body": "<p>Yes, the <code>(a -&gt; b)</code> means one argument which is a function with signature <code>a -&gt; b</code>, whereas <code>a -&gt; b -&gt; ...</code> means two arguments.</p>\n"}, {"tags": [], "owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "is_accepted": true, "score": 32, "last_activity_date": 1449994581, "last_edit_date": 1449994581, "creation_date": 1449501434, "answer_id": 34136961, "question_id": 34136852, "link": "https://stackoverflow.com/questions/34136852/what-is-the-meaning-of-parentheses-in-haskell-type-signatures/34136961#34136961", "title": "What is the meaning of parentheses in Haskell type signatures?", "body": "<p>Yes, there is a difference, because <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-630004.1\" rel=\"nofollow\">the <code>-&gt;</code> type constructor is <em>right-associative</em></a>. In other words,</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>a -&gt; b -&gt; f a -&gt; f b\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>a -&gt; (b -&gt; (f a -&gt; f b))\n</code></pre>\n\n<p>This type signature denotes a function that takes a parameter of type <code>a</code> and returns a function, which itself takes a parameter of type <code>b</code> and returns a function, which itself takes a parameter of type <code>f a</code> and returns a value of type <code>f b</code>.</p>\n\n<p>On the other hand,</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>denotes a function that takes a parameter of type <code>a -&gt; b</code> (i.e. a function that takes a parameter of type <code>a</code> and returns a value of type <code>b</code>) and returns a function, which itself takes a parameter of type <code>f a</code> and returns a value of type <code>f b</code>.</p>\n\n<p>Here is a contrived example that illustrates the difference between the two type signatures:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f :: (Int -&gt; Bool) -&gt; [Int] -&gt; [Bool]\nf = map\n\ng :: Int -&gt; Bool -&gt; [Int] -&gt; [Bool]\ng n b = map (\\n' -&gt; (n' == n) == b)\n\n\u03bb&gt; let ns = [42, 13, 42, 17]\n\n\u03bb&gt; f (== 42) ns\n[True,False,True,False]\n\n\u03bb&gt; g 42 True ns\n[True,False,True,False]\n\n\u03bb&gt; g 42 False ns\n[False,True,False,True]\n</code></pre>\n"}], "owner": {"reputation": 15873, "user_id": 139667, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/e083e1865879535bb75306472b4ba5d0?s=128&d=identicon&r=PG&f=1", "display_name": "Trident D&#39;Gao", "link": "https://stackoverflow.com/users/139667/trident-dgao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2897, "favorite_count": 1, "accepted_answer_id": 34136961, "answer_count": 3, "score": 23, "last_activity_date": 1488465264, "creation_date": 1449501132, "last_edit_date": 1449570724, "question_id": 34136852, "link": "https://stackoverflow.com/questions/34136852/what-is-the-meaning-of-parentheses-in-haskell-type-signatures", "title": "What is the meaning of parentheses in Haskell type signatures?", "body": "<p>Take the type signature of <code>fmap</code> (the <code>Functor</code> method) as an example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>How is that different from the following type signature?</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>a -&gt; b -&gt; f a -&gt; f b\n</code></pre>\n\n<p>Is there even a difference between those two type signatures?</p>\n"}, {"tags": ["haskell", "elm"], "comments": [{"owner": {"reputation": 5862, "user_id": 859279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6543ec0f2465bba1c6899f580bd1e20b?s=128&d=identicon&r=PG", "display_name": "Apanatshka", "link": "https://stackoverflow.com/users/859279/apanatshka"}, "reply_to_user": {"reputation": 2627, "user_id": 215924, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/db83b716acfe0f3a1de6faa176d63fca?s=128&d=identicon&r=PG&f=1", "display_name": "Squidly", "link": "https://stackoverflow.com/users/215924/squidly"}, "edited": false, "score": 1, "creation_date": 1449495371, "post_id": 34134058, "comment_id": 56017445, "body": "@Squidly you confused the order of the operands or the operator..."}, {"owner": {"reputation": 13576, "user_id": 83658, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/f2b8ccc227f3ae306206b1882458c8c1?s=128&d=identicon&r=PG", "display_name": "jpierson", "link": "https://stackoverflow.com/users/83658/jpierson"}, "edited": false, "score": 0, "creation_date": 1519884669, "post_id": 34134058, "comment_id": 85092107, "body": "I&#39;ve heard these infix operators lovingly referred to as left pizza and right pizza operators. Prior to that in F# the typical phrasing I see is pipe forward and pipe backward operators."}], "answers": [{"tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 8, "last_activity_date": 1449492995, "last_edit_date": 1592644375, "creation_date": 1449492995, "answer_id": 34134111, "question_id": 34134058, "link": "https://stackoverflow.com/questions/34134058/syntax-in-haskell-elm/34134111#34134111", "title": "Syntax in Haskell/Elm", "body": "<p>It isn't syntax, it's just a normal Elm function. From <a href=\"http://package.elm-lang.org/packages/elm-lang/core/3.0.0/Basics#%3C%7C\" rel=\"noreferrer\">http://package.elm-lang.org/packages/elm-lang/core/3.0.0/Basics#%3C|</a>:</p>\n<blockquote>\n<p><code>(&lt;|) : (a -&gt; b) -&gt; a -&gt; b</code></p>\n<p>Backward function application <code>f &lt;| x == f x</code>. This function is useful for avoiding parenthesis</p>\n</blockquote>\n<p>and similarly <code>x |&gt; f == f x</code>. The Haskell equivalent of <code>&lt;|</code> is called <code>$</code>, and <code>|&gt;</code> is <code>Data.Function.&amp;</code> (added in Base 4.8.0.0).</p>\n"}], "owner": {"reputation": 1024, "user_id": 2158624, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/0d42d0dacec3f9427ab583a42f6e3651?s=128&d=identicon&r=PG", "display_name": "Bogdan Nechyporenko", "link": "https://stackoverflow.com/users/2158624/bogdan-nechyporenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1449492995, "creation_date": 1449492834, "question_id": 34134058, "link": "https://stackoverflow.com/questions/34134058/syntax-in-haskell-elm", "title": "Syntax in Haskell/Elm", "body": "<p>Can't find anything about this syntax in Haskel/Elm:</p>\n\n<pre><code>bar day yOffset =\n    rect\n        [\n            x &lt;| toString &lt;| (day.xOffset * (barWidth + barMargin)),\n            y &lt;| toString &lt;| if day.amount &lt;= 0 then yOffset\n                else yOffset - day.amount,\n            height &lt;| toString &lt;| abs day.amount,\n            width &lt;| toString barWidth\n        ]\n        [ Svg.title [] [ text day.day ] ]\n\nmin = List.map (\\x -&gt; x.words) lastTwoWeeks\n            |&gt; List.minimum\n            |&gt; Maybe.withDefault 0\n            |&gt; (\\x -&gt; if x &gt; 0 then 0 else x)\n</code></pre>\n\n<p>What does mean &lt;| and |> ?</p>\n"}, {"tags": ["haskell", "stm", "unsafe-perform-io"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1449486895, "post_id": 34130843, "comment_id": 56012143, "body": "The second item is very scary indeed."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1449496053, "post_id": 34130843, "comment_id": 56017898, "body": "Can I ask, why do you want to do this within STM?"}, {"owner": {"reputation": 2535, "user_id": 634020, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/044be669886e6b2e625776ff8be167b7?s=128&d=identicon&r=PG", "display_name": "Philip Kamenarsky", "link": "https://stackoverflow.com/users/634020/philip-kamenarsky"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1449496333, "post_id": 34130843, "comment_id": 56018080, "body": "@MathematicalOrchid: I have a local store/cache in a <code>TVar</code>. Whenever something is not in the store it should be fetched from the database and saved in the store. I could of course (and currently am) split this in 2 steps: STM (check for value in store) -&gt; IO (fetch from db) -&gt; STM (save in store), but this would mean that another thread would be able to change the store in the window between the two STM transactions."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1449496438, "post_id": 34130843, "comment_id": 56018142, "body": "@PhilipKamenarsky So change it so that the first transaction is &quot;look in the cache, if it&#39;s not there, put an [I&#39;m fetching it] marker there&quot;. Any other transactions trying to fetch the same value retry when they see the marker. Problem solved."}, {"owner": {"reputation": 2535, "user_id": 634020, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/044be669886e6b2e625776ff8be167b7?s=128&d=identicon&r=PG", "display_name": "Philip Kamenarsky", "link": "https://stackoverflow.com/users/634020/philip-kamenarsky"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1449496652, "post_id": 34130843, "comment_id": 56018277, "body": "@MathematicalOrchid Just as you wrote this it occurred to me. Put it in an answer so I can accept it :)"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1449500575, "post_id": 34130843, "comment_id": 56020893, "body": "@MathematicalOrchid that&#39;s a more complicated and also fragile solution. For instance what if the original thread never returns to replace the marker?"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1449500891, "post_id": 34130843, "comment_id": 56021118, "body": "@PhilipKamenarsky I think you might have a deeper issue with your proposed solution: if thread B alters the store in your <code>TVar</code> (even a different key/val) while thread A is doing its DB read, thread A&#39;s transaction will be restarted. There&#39;s a real danger of livelock, since your database reads live on a much slower timescale than local concurrency stuff."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1449501572, "post_id": 34130843, "comment_id": 56021615, "body": "@jberryman You make some valid points. I would expect the flag / unflag stuff with exception-handling bracketing for this reason. If you do two STM transactions, a momentary write conflict shouldn&#39;t matter; the transaction to commit the write will just immediately retry."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449507376, "post_id": 34130843, "comment_id": 56025779, "body": "Presumably <code>fetchValueFromDatabase</code> will retry in the middle of the operation at least sometimes, meaning any temporary buffers or memory that has been allocated (which is almost a certainty for network IO) will not be cleaned up - at best, you will leak memory everywhere, at worst, these resources not being cleaned up will be observable elsewhere (like reading constantly changing, garbage data from some handle)."}, {"owner": {"reputation": 2535, "user_id": 634020, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/044be669886e6b2e625776ff8be167b7?s=128&d=identicon&r=PG", "display_name": "Philip Kamenarsky", "link": "https://stackoverflow.com/users/634020/philip-kamenarsky"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1449510852, "post_id": 34130843, "comment_id": 56027964, "body": "@jberryman I&#39;m using a fetch flag, putting a timeout on the database read and clearing the flag when an exception occurs. That should cover it, do you see anything else that might go wrong?"}], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 3, "last_activity_date": 1449497406, "creation_date": 1449497406, "answer_id": 34135580, "question_id": 34130843, "link": "https://stackoverflow.com/questions/34130843/safe-to-use-unsafeiotostm-to-read-from-database/34135580#34135580", "title": "Safe to use unsafeIOToSTM to read from database?", "body": "<p>I would suggest that doing I/O from an STM transaction is just a bad idea.</p>\n\n<p>Presumably what you want is to avoid two threads doing the DB lookup at the same time. What I would do is this:</p>\n\n<ul>\n<li><p>See if the item is already in the cache. If it is, we're done.</p></li>\n<li><p>If it isn't, mark it with an \"I'm fetching this\" flag, commit the STM transaction, go get it from the DB, and do a second STM transaction to insert it into the cache (and remove the flag).</p></li>\n<li><p>If the item is already flagged, <code>retry</code> the transaction. This blocks the calling thread until the first thread inserts the value from the DB.</p></li>\n</ul>\n"}], "owner": {"reputation": 2535, "user_id": 634020, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/044be669886e6b2e625776ff8be167b7?s=128&d=identicon&r=PG", "display_name": "Philip Kamenarsky", "link": "https://stackoverflow.com/users/634020/philip-kamenarsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 1, "accepted_answer_id": 34135580, "answer_count": 1, "score": 6, "last_activity_date": 1449497406, "creation_date": 1449482493, "last_edit_date": 1592644375, "question_id": 34130843, "link": "https://stackoverflow.com/questions/34130843/safe-to-use-unsafeiotostm-to-read-from-database", "title": "Safe to use unsafeIOToSTM to read from database?", "body": "<p>In this pseudocode block:</p>\n<pre><code>atomically $ do\n  if valueInLocalStorage key\n      then readValueFromLocalStorage key\n      else do\n        value &lt;- unsafeIOToSTM $ fetchValueFromDatabase key\n        writeValueToLocalStorage key value\n</code></pre>\n<p>Is it safe to use <code>unsafeIOToSTM</code>? The docs say:</p>\n<ul>\n<li><p><strong>The STM implementation will often run transactions multiple times, so you need to be prepared for this if your IO has any side effects.</strong></p>\n<p>Basically, if a transaction fails it is because some other thread <code>wroteValueToLocalStorage</code> and when the transaction is retried it will return the stored value instead of fetching from the database again.</p>\n</li>\n<li><p><strong>The STM implementation will abort transactions that are known to be invalid and need to be restarted. This may happen in the middle of unsafeIOToSTM, so make sure you don't acquire any resources that need releasing (exception handlers are ignored when aborting the transaction). That includes doing any IO using Handles, for example. Getting this wrong will probably lead to random deadlocks.</strong></p>\n<p>This worries me the most. Logically, if <code>fetchValueFromDatabase</code> doesn't open a new connection (i.e. an existing connection is used) everything should be fine. Are there other pitfalls I am missing?</p>\n</li>\n<li><p><strong>The transaction may have seen an inconsistent view of memory when the IO runs. Invariants that you expect to be true throughout your program may not be true inside a transaction, due to the way transactions are implemented. Normally this wouldn't be visible to the programmer, but using unsafeIOToSTM can expose it.</strong></p>\n<p><code>key</code> is a single value, no invariants to break.</p>\n</li>\n</ul>\n"}, {"tags": ["haskell", "scheme"], "comments": [{"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1449487030, "post_id": 34130789, "comment_id": 56012205, "body": "What does your code do?"}, {"owner": {"reputation": 31, "user_id": 5649400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6cc878b719cec80f0f569c5577024a?s=128&d=identicon&r=PG&f=1", "display_name": "x3kt0", "link": "https://stackoverflow.com/users/5649400/x3kt0"}, "reply_to_user": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1449487367, "post_id": 34130789, "comment_id": 56012389, "body": "@SimonShine \tNeed to do without the use of standard functions: &quot;For a given list to determine the maximum number of consecutive lists.&quot;"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449487472, "post_id": 34130789, "comment_id": 56012446, "body": "IIUC, the <code>list?</code> check dynamically tests whether something is a list. This has no clear counterpart in a statically typed language, unless there&#39;s a giant sum type around like <code>data Value = VCons ... | VNil | VInt ... | ....</code>. Anyway, this looks too broad for SO."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1449501723, "post_id": 34130789, "comment_id": 56021742, "body": "I would first rewrite that in Scheme (or Lisp), as it looks like it&#39;s already been converted from an assignment-based, non-list-processing language. (If you have list of lists - <code>[[a]]</code> - in Haskell, the number you&#39;re looking for is the length of the list. If you don&#39;t have a list of lists, the number is zero.)"}, {"owner": {"reputation": 1412, "user_id": 2337890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d77cef83b5a1cf1de40f5babc58cf63f?s=128&d=identicon&r=PG&f=1", "display_name": "WorBlux", "link": "https://stackoverflow.com/users/2337890/worblux"}, "edited": false, "score": 0, "creation_date": 1449521442, "post_id": 34130789, "comment_id": 56033954, "body": "Yes, this looks like a way to count elements in a a list where some but not all elements are themselves lists. Haskell doesn&#39;t allow for lists of heterogeneous types."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1449542981, "post_id": 34130789, "comment_id": 56042069, "body": "<code>lab1 ... = ... $ foldr (\\x (counter,result)-&gt; if (listP x) then (if counter &gt;= result then (counter+1,result+1) else (counter+1,result)) else (0,result)) (....,....)  currentlist</code>. assuming a datatype to which there exists a <code>listP</code> predicate returning a Boolean result. Like e.g. <code>NestedList a = Atom a | Nested [NestedList a]</code> with <code>listP (Atom _) = ... ; listP (...) = ...</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1449543473, "post_id": 34130789, "comment_id": 56042198, "body": "@x3kt0 &quot;Need to do without the use of standard functions&quot; see the above comment; then implement your own <code>foldr</code> and fuse the above into one explicitly recursive definition. --- maybe define <code>data NestedList a = Atom a | List [NestedList a]</code> , using a clearer name (<code>List</code>)."}, {"owner": {"reputation": 31, "user_id": 5649400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6cc878b719cec80f0f569c5577024a?s=128&d=identicon&r=PG&f=1", "display_name": "x3kt0", "link": "https://stackoverflow.com/users/5649400/x3kt0"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1449553299, "post_id": 34130789, "comment_id": 56044964, "body": "@WillNess Hmm. I need to use something like:  <code>data PolarBear a = P a | B [PolarBear a]   task :: [PolarBear a] -&gt; Int task []           = 0 task ((P _):ps)   = task ps  task ((B p):ps) | null p = 1 + task ps                  | otherwise = task ps  +  (task p)     main = task $ [B [ P 1, B [], B [ P 2, B [ P 3, B [], B []]]]]</code> ??"}, {"owner": {"reputation": 31, "user_id": 5649400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6cc878b719cec80f0f569c5577024a?s=128&d=identicon&r=PG&f=1", "display_name": "x3kt0", "link": "https://stackoverflow.com/users/5649400/x3kt0"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1449553631, "post_id": 34130789, "comment_id": 56045059, "body": "@WillNess In Haskell there are local variables?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1449568421, "post_id": 34130789, "comment_id": 56052270, "body": "@x3kt0 yes, you introduce them with <code>let</code>. as for your new code, the original Scheme code processes the  input list <i>from the back</i>."}, {"owner": {"reputation": 6798, "user_id": 4174897, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/gS0gI.jpg?s=128&g=1", "display_name": "Kyll", "link": "https://stackoverflow.com/users/4174897/kyll"}, "edited": false, "score": 0, "creation_date": 1449845842, "post_id": 34130789, "comment_id": 56196635, "body": "Can you elaborate on how your code doesn&#39;t work? What were you expecting, and what actually happened? If you got an exception, post the line it occurred on and the exception details."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1449849345, "last_edit_date": 1449849345, "creation_date": 1449845942, "answer_id": 34226391, "question_id": 34130789, "link": "https://stackoverflow.com/questions/34130789/scheme-code-to-haskell/34226391#34226391", "title": "Scheme code to Haskell", "body": "<p>The thing to notice in your code is that it processes the input list from back to front, passing the info along in the same direction (in two variables). This is the same as what <code>foldr</code> does, when the combining function is strict in its second argument.</p>\n\n<p>The pair which is the second argument to the combining function emulates the updatable \"environment\" for the two vars in Scheme.</p>\n\n<p>I'm leaving spaces to be filled, since it's a homework.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>lab1 ... = ... $ \n    foldr (\\x (counter,result)-&gt; \n       if (listP x) \n       then (if counter &gt;= result \n             then (counter+1,result+1) \n             else (counter+1,result)) \n       else (0,result)) (....,....) currentlist\n</code></pre>\n\n<p>assuming a datatype to which there exists a <code>listP</code> predicate returning a Boolean result. Like e.g. </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data NestedList a = Atom a | List [NestedList a] \n</code></pre>\n\n<p>with </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>listP (Atom _) = ... \nlistP (...) = ...\n</code></pre>\n\n<p>If you need to present an explicitly recursive code, you need to write down the definition for <code>foldr</code>, and fuse it with the definition for the combining function above (let's call it <code>g</code>), turning</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>foldr g ... = ...\n</code></pre>\n\n<p>into</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>foldr_g ... = ...\n</code></pre>\n\n<p>then just renaming the <code>foldr_g</code> to your liking. The postprocessing step can go into a separate, \"interface\" function. Like so,</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>foldr_g z [] = z\nfoldr_g z (x:xs) = -- g x (foldr_g z xs)\n                      g x r\n                        where\n                        r = foldr_g z xs\n\ng x (counter, result) \n  | listP x = if counter &gt;= result then ... else ...\n  | otherwise = ....\n</code></pre>\n\n<p>Actually inline the definition of <code>g</code> into the <code>foldr_g</code> by interchanging the code lines and smashing the two definitions together, as</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>foldr_g z [] = z\nfoldr_g z (x:xs)   -- g x (foldr_g z xs)\n                   -- g x r\n  | listP x = if counter &gt;= result then ... else ...\n  | otherwise = ....\n                   --   where\n                   --   r = foldr_g z xs\n where\n    (counter, result) = foldr_g z xs\n</code></pre>\n\n<p>and we call it as\n</p>\n\n<pre><code>lab1 currentList counter result =\n  ... (foldr_g (...,...) currentlist)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1449849395, "post_id": 34227320, "comment_id": 56198888, "body": "that&#39;s not me, that&#39;s <code>foldr</code>! :)"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1449849216, "last_edit_date": 1495541267, "creation_date": 1449848616, "answer_id": 34227320, "question_id": 34130789, "link": "https://stackoverflow.com/questions/34130789/scheme-code-to-haskell/34227320#34227320", "title": "Scheme code to Haskell", "body": "<p>As <a href=\"https://stackoverflow.com/questions/34130789/scheme-code-to-haskell#comment56021742_34130789\">molbdnilo indicated</a>, that's a really wretched excuse for Scheme code. To really get a feel for translating Scheme to Haskell, you should first make versions of <code>counter</code> and <code>result</code> that are bound in the <code>countdown</code> named <code>let</code> and updated on each pass <em>without</em> using <code>set!</code>.</p>\n\n<pre><code>(define (lab1 currentList counter0 result0) \n    (let countdown\n         ((i (- (length currentList) 1))\n         (counter counter0)\n         (result result0)) \n      (if (= i 0) \n          (display result) \n          (if (list? (list-ref currentList i))  \n              (if (&gt; (+ 1 counter) result) \n                 (countdown (- i 1) (+ 1 counter) (+ 1 result))\n                 (countdown (- i 1) (+ 1 counter) result))\n              (countdown (- i 1) 0 result))))) \n</code></pre>\n\n<p>Once you've done that, you can expand the named let out into a local recursive function. Remember that</p>\n\n<pre><code>(let loop ((x x0)) body)\n</code></pre>\n\n<p>is basically the same as</p>\n\n<pre><code>(letrec ((loop (lambda (x) body)))\n        (loop x0))\n</code></pre>\n\n<p>Once you've done that, the translation to Haskell should be pretty much immediate. It will be really <em>bad</em> Haskell code, because Haskell's <code>!!</code> is every bit as horribly inefficient as Scheme's <code>list-ref</code> (Will Ness shows how to do it much better), but it will faithfully reproduce the original code's behavior and (terrible) performance.</p>\n"}], "owner": {"reputation": 31, "user_id": 5649400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6cc878b719cec80f0f569c5577024a?s=128&d=identicon&r=PG&f=1", "display_name": "x3kt0", "link": "https://stackoverflow.com/users/5649400/x3kt0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1449849345, "creation_date": 1449482365, "last_edit_date": 1449568683, "question_id": 34130789, "link": "https://stackoverflow.com/questions/34130789/scheme-code-to-haskell", "title": "Scheme code to Haskell", "body": "<p>I need convert this code to Haskell. Please help me. \nI would be very grateful for your help.</p>\n\n<pre><code>#lang scheme\n\n(define (lab1 currentList counter result) \n    (let countdown ((i (- (length currentList) 1))) \n      (if (= i 0) \n          (display result) \n          (begin \n            (if (list? (list-ref currentList i))  \n                (if (&gt; (+ 1 counter) result) \n                    (begin\n                      (set! counter (+ 1 counter))\n                      (set! result (+ 1 result))\n                      (countdown(- i 1))) \n                    (begin\n                      (set! counter (+ 1 counter))\n                      (countdown(- i 1)))) \n                (begin\n                  (set! counter 0)\n                  (countdown(- i 1)))))))) \n</code></pre>\n\n<p>I think I need to use something like: </p>\n\n<pre><code>data PolarBear a = P a | B [PolarBear a] \n\ntask :: [PolarBear a] -&gt; Int \ntask [] = 0 \ntask ((P _):ps) = task ps \ntask ((B p):ps) | null p = 1 + task ps \n                | otherwise = task ps + (task p) \n\nmain = task $ [B [ P 1, B [], B [ P 2, B [ P 3, B [], B []]]]]\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["haskell", "ghc", "cabal", "cabal-install"], "comments": [{"owner": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "edited": false, "score": 0, "creation_date": 1449474780, "post_id": 34128474, "comment_id": 56005452, "body": "did you update your .cabal file?"}, {"owner": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "reply_to_user": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "edited": false, "score": 0, "creation_date": 1449476391, "post_id": 34128474, "comment_id": 56006157, "body": "@Sigrlami I&#39;m afraid I don&#39;t understand. I have a directory called <code>$HOME&#47;.cabal</code> and <code>&#47;tmp&#47;haskell-example&#47;.cabal-sandbox</code>, but no <code>.cabal</code> file. What would I need to do to update it?"}, {"owner": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "edited": false, "score": 0, "creation_date": 1449478150, "post_id": 34128474, "comment_id": 56007023, "body": "When you&#39;re using command <code>cabal init</code> inside your project is creating <code>foo.cabal</code> file which describes all needed dependencies, and you need to add them manually. Assuming your project name <code>foo</code>.For example, <a href=\"https://github.com/sigrlami/pollock/blob/master/pollock.cabal\" rel=\"nofollow noreferrer\">github.com/sigrlami/pollock/blob/master/pollock.cabal</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "edited": false, "score": 2, "creation_date": 1449480187, "post_id": 34129712, "comment_id": 56008114, "body": "Wait a second. I think I was thinking about <code>cabal</code> completely the wrong way. I was expecting a cabal sandbox to behave like a virtualenv or npm environment and alter behavior of ghc, but it seems like the only similarity is that it redirects where <code>cabal install</code> installs things. This makes so much sense now."}], "tags": [], "owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "is_accepted": true, "score": 7, "last_activity_date": 1449478657, "creation_date": 1449478657, "answer_id": 34129712, "question_id": 34128474, "link": "https://stackoverflow.com/questions/34128474/ghc-cannot-find-module-in-cabal-sandbox/34129712#34129712", "title": "GHC cannot find module in cabal sandbox", "body": "<p>If you're into manual hacking, you can pass to ghc the sandbox's pkg db location, such as:</p>\n\n<pre><code>ghc Main.hs -package-db .cabal-sandbox/x86_64-linux-ghc-7.10.2-packages.conf.d/\n</code></pre>\n\n<p>However the \"normal\" way to use sandboxes is to always compile using <code>cabal build</code> (or <code>cabal install</code> with no parameters) rather than running ghc directly.</p>\n\n<ol>\n<li>Run <code>cabal init</code>, answer questions as you please</li>\n<li>Edit the resulting <code>foo.cabal</code> file (<code>foo</code> is the name of your package).</li>\n<li>Run <code>cabal build</code> or <code>cabal install</code> - this will run ghc for you.</li>\n</ol>\n\n<p>When editing the cabal file, check that your exported modules (if it's a lib) are listed and that your main src is correct. Also make sure dependencies such as <code>natural-numbers</code> are listed in the <code>build-depends:</code> clause.</p>\n"}], "owner": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1661, "favorite_count": 2, "accepted_answer_id": 34129712, "answer_count": 1, "score": 5, "last_activity_date": 1449478657, "creation_date": 1449473540, "question_id": 34128474, "link": "https://stackoverflow.com/questions/34128474/ghc-cannot-find-module-in-cabal-sandbox", "title": "GHC cannot find module in cabal sandbox", "body": "<p>I am using Haskell version 7.8.4 on (X)Ubuntu 15.10, with Cabal-Install 1.18 both installed through <code>apt</code>. I have not attempted to install anything Haskell-related by hand on this machine. I set up a cabal sandbox, fetched and installed a module only to discover that <code>ghc</code> doesn't seem to be picking it up. <code>ghc -v</code> seems to suggest that I have two versions of the cabal library that are mutually shadowing each other. How does this work?</p>\n\n<p>I am starting out with an empty directory <code>/tmp/haskell-example</code></p>\n\n<p>then I do a <code>cabal sandbox init</code>.</p>\n\n<pre><code>$ cabal sandbox init\nWriting a default package environment file to\n/tmp/haskell-example/cabal.sandbox.config\nCreating a new sandbox at /tmp/haskell-example/.cabal-sandbox\n</code></pre>\n\n<p>then I install <code>natural-numbers</code> because I want to use the <code>Data.Natural</code> module in a program. This operation succeeds.</p>\n\n<pre><code>$ cabal install natural-numbers\nResolving dependencies...\nNotice: installing into a sandbox located at\n/tmp/haskell-example/.cabal-sandbox\nConfiguring natural-numbers-0.1.2.0...\nBuilding natural-numbers-0.1.2.0...\nInstalled natural-numbers-0.1.2.0\n</code></pre>\n\n<p>I can verify that the <code>Data.Natural</code> module has indeed been installed to the cabal sandbox.</p>\n\n<pre><code>$ ls /tmp/haskell-example/.cabal-sandbox/lib/x86_64-linux-ghc-7.8.4/natural-numbers-0.1.2.0\n Data\nlibHSnatural-numbers-0.1.2.0.a\nlibHSnatural-numbers-0.1.2.0-ghc7.8.4.so\n$ ls /tmp/haskell-example/.cabal-sandbox/lib/x86_64-linux-ghc-7.8.4/natural-numbers-0.1.2.0/Data\nNatural.dyn_hi\nNatural.hi\n</code></pre>\n\n<p>then I create a simple <code>Main.hs</code> file that imports <code>Data.Natural</code> but does not use it.</p>\n\n<pre><code>module Main where\n\nimport Data.Natural\n\nmain = putStrLn \"Hello World\"\n</code></pre>\n\n<p>When I try to <code>ghc Main.hs</code> I see the following :</p>\n\n<pre><code>$ ghc Main.hs \nMain.hs:3:8:\n    Could not find module \u2018Data.Natural\u2019\n    Use -v to see a list of the files searched for.\n</code></pre>\n\n<p>With the verbose flag enabled, it seems as if my cabal is getting shadowed by a later cabal, which is in turn shadowing the earlier cabal. Why is this happening?</p>\n\n<pre><code>$ ghc -v Main.hs \nGlasgow Haskell Compiler, Version 7.8.4, stage 2 booted by GHC version 7.8.4\nUsing binary package database: /usr/lib/ghc/package.conf.d/package.cache\nhiding package Cabal-1.18.1.5 to avoid conflict with later version Cabal-1.22.1.1\nwired-in package ghc-prim mapped to ghc-prim-0.3.1.0-ec14d2f6075975a2ce9112eae431c8e1\nwired-in package integer-gmp mapped to integer-gmp-0.5.1.0-de4898ebdc5ab81cedce89121ae9ac84\nwired-in package base mapped to base-4.7.0.2-5ef1e7e809bc3b18d74efc783356e209\nwired-in package rts mapped to builtin_rts\nwired-in package template-haskell mapped to template-haskell-2.9.0.0-c1976a420ad8b9b589eee08844c59ba2\nwired-in package dph-seq not found.\nwired-in package dph-par not found.\nHsc static flags: \nhiding package Cabal-1.18.1.5 to avoid conflict with later version Cabal-1.22.1.1\nwired-in package ghc-prim mapped to ghc-prim-0.3.1.0-ec14d2f6075975a2ce9112eae431c8e1\nwired-in package integer-gmp mapped to integer-gmp-0.5.1.0-de4898ebdc5ab81cedce89121ae9ac84\nwired-in package base mapped to base-4.7.0.2-5ef1e7e809bc3b18d74efc783356e209\nwired-in package rts mapped to builtin_rts\nwired-in package template-haskell mapped to template-haskell-2.9.0.0-c1976a420ad8b9b589eee08844c59ba2\nwired-in package dph-seq not found.\nwired-in package dph-par not found.\n*** Chasing dependencies:\nChasing modules from: *Main.hs\n\nMain.hs:3:8:\n    Could not find module \u2018Data.Natural\u2019\n    Locations searched:\n    Data/Natural.hs\n    Data/Natural.lhs\n*** Deleting temp files:\nDeleting: \n*** Deleting temp dirs:\nDeleting: \n</code></pre>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449471274, "post_id": 34126505, "comment_id": 56004095, "body": "The type of <code>runRVar</code> is very general - in this case, the first <code>runRVar</code> is being instantiated at the type <code>RVar Bool -&gt; StdRandom -&gt; RVar Bool</code> when you use <code>toss&#39;</code> inside of <code>foo</code> and <code>bar</code>. And this function is just the identity (or should be). In any case, StdRandom does not &quot;do&quot; anything - when you write <code>runRVar ... StdRandom</code> it simply means to use the <code>MonadRandom</code> interface as the source of randomness."}], "answers": [{"comments": [{"owner": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "edited": false, "score": 0, "creation_date": 1449502059, "post_id": 34126708, "comment_id": 56021969, "body": "I&#39;m sorry just to clarify, you&#39;re saying by setting <code>NoMonomorphismRestriction</code>, I see now that I can write <code>bar :: MonadRandom m =&gt; StateT Int m ()</code>. <i>However</i> I should still write <code>StateT Int RVar ()</code> because <code>MonadRandom m</code> is too general? And you&#39;re saying <code>StdRandom</code> is just something to satisfy the typechecker, and does not actually initialize a random seed correct?"}, {"owner": {"reputation": 128, "user_id": 947407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f20474e5c7fc041f3e79565316a53d6c?s=128&d=identicon&r=PG", "display_name": "David Kraeutmann", "link": "https://stackoverflow.com/users/947407/david-kraeutmann"}, "reply_to_user": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "edited": false, "score": 1, "creation_date": 1449609186, "post_id": 34126708, "comment_id": 56079474, "body": "Yes, pretty much. By writing RVar you don&#39;t need to do runRVar <i>inside</i> StateT and can just provide a random generator from outside once. This also has the effect of making it easier to change the random number generator used (you just need to pass/edit it once instead of replacing all occurrences of StdRandom)."}], "tags": [], "owner": {"reputation": 128, "user_id": 947407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f20474e5c7fc041f3e79565316a53d6c?s=128&d=identicon&r=PG", "display_name": "David Kraeutmann", "link": "https://stackoverflow.com/users/947407/david-kraeutmann"}, "is_accepted": true, "score": 4, "last_activity_date": 1449464147, "creation_date": 1449464147, "answer_id": 34126708, "question_id": 34126505, "link": "https://stackoverflow.com/questions/34126505/usage-of-runrvar-over-some-monad-transformer-stack/34126708#34126708", "title": "Usage of runRVar over some monad transformer stack", "body": "<ol>\n<li>When monomorphism restriction is on (it's on by default), all types of top-level binders will be inferred monomorphic.</li>\n<li>You should add <code>RVar</code> to the monad stack like you did in <code>bar</code>. <code>MonadRandom</code> is too general.\n<code>StdRandom</code> is just a data constructor, so it has no specific state. <code>random-fu</code> should handle updating state automatically.</li>\n<li>Just add the signature. See 1.</li>\n</ol>\n"}], "owner": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 1, "accepted_answer_id": 34126708, "answer_count": 1, "score": 0, "last_activity_date": 1449464147, "creation_date": 1449462870, "question_id": 34126505, "link": "https://stackoverflow.com/questions/34126505/usage-of-runrvar-over-some-monad-transformer-stack", "title": "Usage of runRVar over some monad transformer stack", "body": "<p>In the following example:</p>\n\n<pre><code>toss :: Double -&gt; RVar Bool\ntoss p = do\n  q &lt;- uniform 0 1\n  return $ q &lt;= p\n\ntoss' :: MonadRandom m =&gt; Double -&gt; m Bool\ntoss' p = runRVar (toss p) StdRandom\n\n\nfoo :: StateT Int RVar ()\nfoo = do\n    h &lt;- lift $ toss' 0.5\n    if h then put 100 else put 0\n\nbar :: StateT Int RVar ()\nbar = do\n    h &lt;- lift $ toss 0.5\n    if h then put 404 else put 200\n\n\ntestFoo :: MonadRandom m =&gt; m ((), Int)\ntestFoo = runRVar (runStateT foo 0) StdRandom\n\ntestBar :: MonadRandom m =&gt; m ((), Int)\ntestBar = runRVar (runStateT bar 0) StdRandom\n</code></pre>\n\n<p>I am confused about:</p>\n\n<ol>\n<li><p>why the signature of foo is forced to be <code>StateT Int RVar ()</code> even though <code>toss'</code> has signature <code>m Bool</code> for some <code>MonadRandom m</code></p></li>\n<li><p>Why <code>testFoo</code> has to be run with some <code>StdRandom</code> even though <code>toss'</code> already <code>runRVar</code> with <code>StdRandom</code>. It makes sense from a type perspective, but which <code>StdRandom</code> end up being used? If this question makes any sense at all.</p></li>\n<li><p>Would it be possible to rewrite <code>foo</code>'s signature as <code>MonadRandom m =&gt; StateT Int m ()</code></p></li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 2, "creation_date": 1449449955, "post_id": 34124822, "comment_id": 55998369, "body": "Can you format your question so that the code is displayed with its original whitespace? One way is to indent each line with exactly four spaces."}], "answers": [{"tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": false, "score": 3, "last_activity_date": 1449450423, "creation_date": 1449450423, "answer_id": 34124919, "question_id": 34124822, "link": "https://stackoverflow.com/questions/34124822/please-tell-me-the-mistake-in-this-haskell-coe-syntactically/34124919#34124919", "title": "Please tell me the mistake in this haskell coe syntactically", "body": "<p>Your question gives very little information about what is going on more broadly, so I'm not sure how to fix the problem. I can, however, see the syntax error.</p>\n\n<pre><code>where ((Abs x tau t),t2(TypeArrow tau1 tau2)) = typingConstraint capGamma i x\n</code></pre>\n\n<p>has a pattern to the left of <code>=</code> which uses a pattern variable <code>t2</code> as a function, applied to <code>(TypeArrow tau1 tau2)</code>, but such patterns are not permitted: matching such a pattern would mean figuring out what function <code>t2</code> is from one example of its use.</p>\n\n<p>My guess is that you're missing a comma. It's hard to give better advice without more information. It would really help me (and probably you, too) if you could say what the type of <code>typingConstraint</code> is. That type will tell you which patterns are valid for matching its output.</p>\n"}], "owner": {"reputation": 639, "user_id": 5648009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eae95b58b7dddbb2d5a86d0d6f880448?s=128&d=identicon&r=PG&f=1", "display_name": "Ani", "link": "https://stackoverflow.com/users/5648009/ani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1449519763, "answer_count": 1, "score": -5, "last_activity_date": 1449480265, "creation_date": 1449449543, "last_edit_date": 1449480265, "question_id": 34124822, "link": "https://stackoverflow.com/questions/34124822/please-tell-me-the-mistake-in-this-haskell-coe-syntactically", "closed_reason": "Needs details or clarity", "title": "Please tell me the mistake in this haskell coe syntactically", "body": "<pre><code>typingConstraint capGamma i (App (Abs x tau t)t2) =\n  ((Abs x tau t)\n  ,t2(TypeVar (\"T\"++show (i+1)))\n  ,(TypeArrow(TypeVar(\"T\"++show i)),(TypeVar(\"T\"++ show (i+1)))))\n   where ((Abs x tau t),t2(TypeArrow tau1 tau2)) = typingConstraint capGamma i x\n</code></pre>\n\n<p>error message </p>\n\n<blockquote>\n  <p>\"parse error in pattern t2\"</p>\n</blockquote>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1463, "user_id": 3703503, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1ca51bdb8bc5906975c4133f0bf4873c?s=128&d=identicon&r=PG&f=1", "display_name": "SlySherZ", "link": "https://stackoverflow.com/users/3703503/slysherz"}, "edited": false, "score": 0, "creation_date": 1449448269, "post_id": 34124613, "comment_id": 55997908, "body": "Thanks, it works perfectly. I just find it slightly harder to read."}], "tags": [], "owner": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "is_accepted": false, "score": 3, "last_activity_date": 1449447905, "creation_date": 1449447905, "answer_id": 34124613, "question_id": 34124558, "link": "https://stackoverflow.com/questions/34124558/is-it-possible-to-nest-guards-in-haskell/34124613#34124613", "title": "Is it possible to nest guards in Haskell?", "body": "<p>No, it's not possible. Why not just write it linearly as</p>\n\n<pre><code>isDigit :: Char -&gt; Bool\nisDigit c = c &gt;= '0' &amp;&amp; c &lt;= '9'\n\nparseNumber :: String -&gt; Maybe (String, String)\nparseNumber [] = Just (\"\", \"\")\nparseNumber (h:ls)\n    -- Digit found\n    | isDigit h &amp;&amp; p == Nothing = Just([h], ls)\n    -- Ends in a digit\n    | isDigit h = Just (h:fst d, snd d)\n    -- Ends in a point\n    | h == '.' &amp;&amp; p == Nothing = Nothing\n    -- We don't want multiple dots\n    | h == '.' &amp;&amp; not ('.' `elem` (snd d)) = Just (h:(fst d), snd d)\n    -- Not a number, stop looking!\n    | otherwise = Nothing\n    where\n        p = parseNumber ls\n        Just d = parseNumber ls -- Float version of p. Not used if p is Nothing\n\nmain = print $ parseNumber \"123.0 + 2\"\n</code></pre>\n\n<p>If your guards become too involved it's probably a sign that you need to extract a function.</p>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 16, "last_activity_date": 1586619844, "last_edit_date": 1586619844, "creation_date": 1449450345, "answer_id": 34124909, "question_id": 34124558, "link": "https://stackoverflow.com/questions/34124558/is-it-possible-to-nest-guards-in-haskell/34124909#34124909", "title": "Is it possible to nest guards in Haskell?", "body": "<p>No, but you can use cases if you'd like:</p>\n\n<pre><code>parseNumber :: String -&gt; Maybe (String, String)\nparseNumber [] = Just (\"\", \"\")\nparseNumber (h:ls)\n    | isDigit h =\n         case () of\n           () | p == Nothing -&gt; Just([h], ls)\n              | otherwise -&gt; Just (h:fst d, snd d) -- Ends in a digit\n    | h == '.' =\n         case () of\n           () | p == Nothing -&gt; Nothing\n              | not ('.' `elem` (snd d)) -&gt; Just (h:(fst d), snd d)\n    | otherwise = Nothing\n    where \n        p      = parseNumber ls\n        Just d = parseNumber ls\n</code></pre>\n\n<p>Alternatively, multiway if works in a similar manner (<code>if True | p1 -&gt; b ; | p2 -&gt; c</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1449453873, "post_id": 34125006, "comment_id": 55999249, "body": "This is the approach I wanted to suggest. There&#39;s one observation I think is worth making in the answer body, though: in this case, the transformation to <code>dig &lt;|&gt; dot</code> is okay because <code>dig</code> and <code>dot</code> start with mutually exclusive guards, but in general they may not and then falling through from <code>dig</code> to <code>dot</code> may be undesirable. This can be handled with a multiline if or <code>case () of _</code> construct, though the syntax is a bit clumsy when it&#39;s not needed (like here)."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1449505248, "post_id": 34125006, "comment_id": 56024294, "body": "@DanielWagner Even if the guards where not mutually exclusive, one of them would come first, so transforming it to <code>guard1 &lt;|&gt; guard2</code> still seems valid to me."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1449513091, "post_id": 34125006, "comment_id": 56029324, "body": "If the guards are <i>not</i> mutually exclusive, and <code>p</code> fails but <code>dot</code> succeeds, <code>dig &lt;|&gt; dot</code> will succeed where the original would have failed without trying <code>dot</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1449529773, "post_id": 34125006, "comment_id": 56038101, "body": "I don&#39;t believe I understand - if <code>p</code> fails there is no way for <code>dot</code> to succeed. This would still be the case if the guards where not mutually exclusive."}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 5, "last_activity_date": 1449451113, "creation_date": 1449451113, "answer_id": 34125006, "question_id": 34124558, "link": "https://stackoverflow.com/questions/34124558/is-it-possible-to-nest-guards-in-haskell/34125006#34125006", "title": "Is it possible to nest guards in Haskell?", "body": "<p>When your function becomes exceedingly complicated and you cannot support the logic which is implemented with just guards alone, consider writing the function with abstract control functions instead:</p>\n\n<pre><code>import Control.Applicative \nimport Control.Monad \n\nisDigit :: Char -&gt; Bool\nisDigit c = c &gt;= '0' &amp;&amp; c &lt;= '9'\n\nparseNumber :: String -&gt; Maybe (String, String)\nparseNumber [] = return (\"\", \"\")\nparseNumber (h:ls) = dig &lt;|&gt; dot where -- h is either a digit or a dot\n  p = parseNumber ls \n  dig = do \n    guard (isDigit h)                                 -- ensure h is a digit\n    fmap (\\(ds,r) -&gt; (h:ds,r)) p \n      &lt;|&gt; return ([h],ls)  -- the alternative between two computations\n                           -- either the tail is parsed and h prepended to the result\n                           -- or the digit is returned by itself                         \n  dot = do \n    guard (h == '.')             -- ensure h is a dot\n    (ds,r) &lt;- p                  -- parse the tail\n    guard $ not $ '.' `elem` ds  -- ensure there is no dot in the tail\n    return (h:ds,r)              -- result\n</code></pre>\n\n<p>This uses the <code>Monad</code>, <code>Functor</code>, and <code>MonadPlus</code> instances of <code>Maybe</code> to implement the parsing logic. In fact, this function generalizes to the type <code>MonadPlus m =&gt; String -&gt; m (String, String)</code> - there is no actual use of <code>Maybe</code> constructors here. </p>\n\n<p>The function is also easy to read. It is much more evident what is happening that in the version with guards. </p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1449451988, "creation_date": 1449451988, "answer_id": 34125119, "question_id": 34124558, "link": "https://stackoverflow.com/questions/34124558/is-it-possible-to-nest-guards-in-haskell/34125119#34125119", "title": "Is it possible to nest guards in Haskell?", "body": "<p>It <em>is</em> possible to chain guards, with <code>,</code>. This does basically the same as <code>&amp;&amp;</code> in fjarri's answer, but is more versatile when it comes to pattern guards.</p>\n\n<p>What's not possible is <em>nesting</em> guards. Well, in your example that's only actually needed in the first clause. You could write</p>\n\n<pre><code>parseNumber (h:ls)\n    | isDigit h\n       = if isNothing p\n           then Just ([h], ls)        -- Digit found    &lt;&lt;&lt; ERROR!!\n           else Just (h:fst d, snd d) -- Ends in a digit\n    | h == '.'\n    , not ('.' `elem` snd d)\n       = Just (h:fst d, snd d)    -- We don't want multiple dots\n    | otherwise = Nothing       -- Not a number, stop looking!\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1449480163, "creation_date": 1449480163, "answer_id": 34130157, "question_id": 34124558, "link": "https://stackoverflow.com/questions/34124558/is-it-possible-to-nest-guards-in-haskell/34130157#34130157", "title": "Is it possible to nest guards in Haskell?", "body": "<p>Using <code>where Just d = ...</code> is dangerous: if you ever access it when <code>p</code> is <code>Nothing</code> your whole program will crash. By doing that, you have to add such checks in your code (as you correctly already did), and be careful not to forget any one of these. </p>\n\n<p>There are safer ways, such as using <code>case p of Nothing -&gt; ... ; Just d -&gt; ...</code>, using the <code>maybe</code> eliminator, or using functor/applicative/monad tools. Let's use <code>case</code> to keep it simple:</p>\n\n<pre><code>parseNumber :: String -&gt; Maybe (String, String)\nparseNumber [] = Just (\"\", \"\")\nparseNumber (h:ls)\n    | isDigit h = case p of\n        Nothing -&gt; Just([h], ls)         -- Digit found    &lt;&lt;&lt; ERROR!!\n        Just d  -&gt; Just (h:fst d, snd d) -- Ends in a digit\n    | h == '.' = case p of\n        Nothing -&gt; Nothing                 -- Ends in a point\n        Just d | not ('.' `elem` (snd d))\n                -&gt; Just (h:(fst d), snd d) -- We don't want multiple dots\n        _       -&gt; Nothing                 -- Not a number, stop looking!\n    where \n        p = parseNumber ls\n</code></pre>\n\n<p>We can also directly pattern match on the subcomponents of <code>d</code>:</p>\n\n<pre><code>parseNumber :: String -&gt; Maybe (String, String)\nparseNumber [] = Just (\"\", \"\")\nparseNumber (h:ls)\n    | isDigit h = case p of\n        Nothing        -&gt; Just([h], ls)     -- Digit found    &lt;&lt;&lt; ERROR!!\n        Just (hs,rest) -&gt; Just (h:hs, rest) -- Ends in a digit\n    | h == '.' = case p of\n        Nothing -&gt; Nothing           -- Ends in a point\n        Just (hs, rest) | not ('.' `elem` rest) \n                -&gt; Just (h:hs, rest) -- We don't want multiple dots\n        _       -&gt; Nothing           -- Not a number, stop looking!\n    where \n        p = parseNumber ls\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "is_accepted": false, "score": 13, "last_activity_date": 1449620611, "creation_date": 1449620611, "answer_id": 34168666, "question_id": 34124558, "link": "https://stackoverflow.com/questions/34124558/is-it-possible-to-nest-guards-in-haskell/34168666#34168666", "title": "Is it possible to nest guards in Haskell?", "body": "<p>No, you can't.  We all want it, but nobody can come up with a sensible syntax. </p>\n"}, {"tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": false, "score": 0, "last_activity_date": 1509295476, "creation_date": 1509295476, "answer_id": 47002707, "question_id": 34124558, "link": "https://stackoverflow.com/questions/34124558/is-it-possible-to-nest-guards-in-haskell/47002707#47002707", "title": "Is it possible to nest guards in Haskell?", "body": "<p>Put them in separated functions. </p>\n\n<pre><code>isDigit :: Char -&gt; Bool\nisDigit c = c &gt;= '0' &amp;&amp; c &lt;= '9'\n\n\nparseNumber :: String -&gt; Maybe (String, String)\nparseNumber [] = Just (\"\", \"\")\nparseNumber (h:ls)\n    | isDigit h  = f_p (h:ls)            \n    | h == '.'   = temp (h: ls)         \n    | otherwise  = Nothing       -- Not a number, stop looking!\n\n\nf_p :: String -&gt; Maybe (String, String)\nf_p (h:ls)\n    | parseNumber ls == Nothing  = Just([h], ls)         -- Digit found &lt;&lt;&lt; ERROR!!\n    | otherwise                  = Just (h:fst d, snd d) -- Ends in a digit\n    where \n        Just d = parseNumber ls -- Float version of p. Not used if p is Nothing\n\n\ntemp :: String -&gt; Maybe (String, String)\ntemp (h:ls)\n    | parseNumber ls == Nothing  = Nothing                 -- Ends in a point\n    | not ('.' `elem` (snd d))   = Just (h:(fst d), snd d) -- We don't want multiple dots\n    where \n        Just d = parseNumber ls -- Float version of p. Not used if p is Nothing\n</code></pre>\n\n<p>Have to admit I did not tested this code. </p>\n"}, {"tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 6, "last_activity_date": 1510536594, "creation_date": 1510536594, "answer_id": 47255913, "question_id": 34124558, "link": "https://stackoverflow.com/questions/34124558/is-it-possible-to-nest-guards-in-haskell/47255913#47255913", "title": "Is it possible to nest guards in Haskell?", "body": "<p>Recent GHC now has <code>MultiWayIf</code>:</p>\n\n<pre><code>{-# LANGUAGE MultiWayIf #-}\n\nparseNumber :: String -&gt; Maybe (String, String)\nparseNumber [] = Just (\"\", \"\")\nparseNumber (h:ls)\n  | isDigit h = if\n    | p == Nothing -&gt; Just ([h], ls)\n    | otherwise    -&gt; Just (h:fst d, snd d)\n  | h == '.'  = if\n    | p == Nothing             -&gt; Nothing\n    | not ('.' `elem` (snd d)) -&gt; Just (h:(fst d), snd d)\n  | otherwise = Nothing\n  where p@(~(Just d)) = parseNumber ls\n</code></pre>\n\n<p>But this is better written slightly differently anyhow, without the partiality.</p>\n\n<pre><code>{-# LANGUAGE MultiWayIf #-}\n\nparseNumber :: String -&gt; Maybe (String, String)\nparseNumber [] = Just (\"\", \"\")\nparseNumber (h:ls)\n  | isDigit h = if\n    | Nothing &lt;- p -&gt; Just ([h], ls) -- PatternGuards, on by default\n    | Just d  &lt;- p -&gt; Just (h:fst d, snd d)\n  | h == '.'  = if\n    | Nothing &lt;- p                         -&gt; Nothing\n    | Just d  &lt;- p, not ('.' `elem` snd d) -&gt; Just (h:(fst d), snd d)\n  | otherwise = Nothing\n  where p = parseNumber ls\n</code></pre>\n\n<p>and you may as well use <code>maybe</code>.</p>\n\n<pre><code>parseNumber :: String -&gt; Maybe (String, String)\nparseNumber \"\" = Just (\"\", \"\")\nparseNumber (h:hs)\n  | isDigit h = maybe (Just ([h], hs)) (\\(num, rest') -&gt; Just (h:num, rest')) rest\n  | h == '.'  = maybe Nothing (\\(num, rest') -&gt; if '.' `elem` num then Nothing\n                                                else Just (h:num, rest')\n                              ) rest -- This logic is a bit wonky; it doesn't really work\n  | otherwise = Nothing\n  where rest = parseNumber hs\n</code></pre>\n"}], "owner": {"reputation": 1463, "user_id": 3703503, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1ca51bdb8bc5906975c4133f0bf4873c?s=128&d=identicon&r=PG&f=1", "display_name": "SlySherZ", "link": "https://stackoverflow.com/users/3703503/slysherz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11634, "favorite_count": 2, "accepted_answer_id": 34124909, "answer_count": 8, "score": 8, "last_activity_date": 1586619844, "creation_date": 1449447424, "last_edit_date": 1592644375, "question_id": 34124558, "link": "https://stackoverflow.com/questions/34124558/is-it-possible-to-nest-guards-in-haskell", "title": "Is it possible to nest guards in Haskell?", "body": "<p>Haskell newbie here, trying to write code to parse math expressions.\nCode:</p>\n<pre><code>isDigit :: Char -&gt; Bool\nisDigit c = c &gt;= '0' &amp;&amp; c &lt;= '9'\n\nparseNumber :: String -&gt; Maybe (String, String)\nparseNumber [] = Just (&quot;&quot;, &quot;&quot;)\nparseNumber (h:ls)\n    | isDigit h\n        | p == Nothing = Just([h], ls)      -- Digit found    &lt;&lt;&lt; ERROR!!\n        | otherwise = Just (h:fst d, snd d) -- Ends in a digit\n    | h == '.'\n        | p == Nothing = Nothing                                -- Ends in a point\n        | not ('.' `elem` (snd d)) = Just (h:(fst d), snd d)    -- We don't want multiple dots\n    | otherwise = Nothing       -- Not a number, stop looking!\n    where \n        p = parseNumber ls\n        Just d = parseNumber ls -- Float version of p. Not used if p is Nothing  \n</code></pre>\n<p>This function is supposed to take a string that starts with a number, and returns the number separated from the rest of the expression. Example:</p>\n<blockquote>\n<p>parseNumber &quot;123.0 + 2&quot;</p>\n<p>(&quot;123.0&quot;, &quot; + 2&quot;)</p>\n</blockquote>\n<p>I think this nested guards' syntax reads really nicely, but it doesn't work.\nThe error reads, for the marked line:</p>\n<blockquote>\n<p>parse error on input `|'</p>\n</blockquote>\n<p>Are chained guards not allowed in Haskell? Or am I writting this wrongly somehow? Also, what alternatives do I have to chain logic in a simple way?</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "edited": false, "score": 0, "creation_date": 1449444921, "post_id": 34124184, "comment_id": 55997067, "body": "haskell is purely recursive"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449446517, "post_id": 34124184, "comment_id": 55997438, "body": "Just a hint: you could pass both functions to <code>mapEven, mapOdd</code> -- this is because you don&#39;t want to generate a plain <code>x</code> as you are doing in <code>mapOdd ... = x : ...</code>. Each <code>x</code> you generate should be applied to either <code>f</code> or <code>g</code>, according to whether it is found in an even or odd position. Once you have done that, you will not need <code>++</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449451719, "post_id": 34124184, "comment_id": 55998788, "body": "<code>funkyMap f0 g0 = snd . foldr (\\a ((f,g),xs) -&gt; ((g,f),f a:xs)) ((f0,g0),[])</code>"}, {"owner": {"reputation": 51, "user_id": 5647834, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c8f1682c67b6bb6f529ae2a9a2579157?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/5647834/john-smith"}, "edited": false, "score": 0, "creation_date": 1449453368, "post_id": 34124184, "comment_id": 55999136, "body": "One requirement for the solution to pass is that it should use recursion."}, {"owner": {"reputation": 51, "user_id": 5647834, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c8f1682c67b6bb6f529ae2a9a2579157?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/5647834/john-smith"}, "edited": false, "score": 0, "creation_date": 1449453425, "post_id": 34124184, "comment_id": 55999146, "body": "Is the solution provided by user2407038 using recursion. Please pardon my ignorance, I am a newbie to Haskell."}, {"owner": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 0, "creation_date": 1449478905, "post_id": 34124184, "comment_id": 56007428, "body": "This sounds like a homework problem. Any kind of looping in Haskell uses recursion under the hood. Probably your instructor wants you to use explicit recursion, which the solution offered above does not use, the recursion is hidden inside standard higher level functions (<code>foldr</code>). BTW an even more compact solution (without explicit recursion) is: <code>funkyMap f g = zipWith ($) (cycle [f,g])</code>"}], "answers": [{"tags": [], "owner": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "is_accepted": false, "score": 2, "last_activity_date": 1502622879, "last_edit_date": 1502622879, "creation_date": 1449445654, "answer_id": 34124298, "question_id": 34124184, "link": "https://stackoverflow.com/questions/34124184/haskell-recursive-function-to-apply-different-functions-to-even-and-odd-numbered/34124298#34124298", "title": "Haskell recursive function to apply different functions to even and odd numbered index", "body": "<p>This line has a problem:</p>\n\n<pre><code>funkyMap f g (x:xs) = (mapEven f x) ++ (mapOdd g xs)\n</code></pre>\n\n<p><code>x</code> is an element of the list (ie type <code>a</code>), while <code>xs</code> is another list (type <code>[a]</code>). But you are treating them the same. The error you are getting is because the only way to make sense of a list and an element being the same type is if it's a list of lists of lists of lists of lists...</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449479191, "post_id": 34124539, "comment_id": 56007591, "body": "While there are more elegant solutions, the above looks correct."}], "tags": [], "owner": {"reputation": 51, "user_id": 5647834, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c8f1682c67b6bb6f529ae2a9a2579157?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/5647834/john-smith"}, "is_accepted": false, "score": 1, "last_activity_date": 1449447326, "creation_date": 1449447326, "answer_id": 34124539, "question_id": 34124184, "link": "https://stackoverflow.com/questions/34124184/haskell-recursive-function-to-apply-different-functions-to-even-and-odd-numbered/34124539#34124539", "title": "Haskell recursive function to apply different functions to even and odd numbered index", "body": "<p>By God's mercy, I got some inspiration and I seemed to have cracked this problem.\nPlease review the following solution:</p>\n\n<pre><code>h1 p q [] = []\nh1 p q ((cnt, val) : xs) = (if odd cnt then (q val) else (p val) ) : h1 p q xs\n\nfunkyMap f g xs = h1 f g ( zip [0..] xs)\n</code></pre>\n\n<p>If I try funkyMap (+10) (+100) [1, 2, 3, 4, 5] I get [11,102,13,104,15] which is expected.</p>\n\n<p>Also funkyMap (+100) (+2) [1] gives\n[101]</p>\n\n<p>and funkyMap (+100) (+2) [] gives\n[]</p>\n\n<p>Please review this solution and let me know your feedback.</p>\n\n<p>Thanks</p>\n"}], "owner": {"reputation": 51, "user_id": 5647834, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c8f1682c67b6bb6f529ae2a9a2579157?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/5647834/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 1, "answer_count": 2, "score": -2, "last_activity_date": 1502622895, "creation_date": 1449444711, "last_edit_date": 1502622895, "question_id": 34124184, "link": "https://stackoverflow.com/questions/34124184/haskell-recursive-function-to-apply-different-functions-to-even-and-odd-numbered", "title": "Haskell recursive function to apply different functions to even and odd numbered index", "body": "<p>I have been struggling with following problem for sometime. I spent many hours on the internet to find a viable algorithm in Haskell using recursive functions only but no success.</p>\n\n<p>Define a recursive function funkyMap :: (a -> b) -> (a -> b) -> [a] -> [b] that takes as arguments two functions f and g and a list xs, and applies f to all elements at even positions ([0, 2..]) in xs and g to all elements at odd positions ([1, 3..]) in xs.</p>\n\n<p>Example: funkyMap (+10) (+100) [1, 2, 3, 4, 5] = [(+10) 1, (+100) 2, (+10) 3, (+100) 4, (+10) 5].</p>\n\n<p>To above problem, I attempted following solution, but HUGS give me compilation error \"unification would give infinite type\".</p>\n\n<pre><code>mapEven :: (a-&gt;a) -&gt; [a] -&gt; [a]\nmapEven f [] = []\nmapEven f (x:xs) = f x : mapOdd f xs\n\nmapOdd :: (a-&gt;a) -&gt; [a] -&gt; [a]\nmapOdd g [] = []\nmapOdd g (x:xs) = x : mapEven g xs\n\nfunkyMap :: (a -&gt; b) -&gt; (a -&gt; b) -&gt; [a] -&gt; [b]\nfunkyMap f g [] = []\nfunkyMap f g (x:xs) = (mapEven f x) ++ (mapOdd g xs)\n</code></pre>\n\n<p>Please suggest an alternate working solution.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "induction", "coinduction"], "comments": [{"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1449490069, "post_id": 34123543, "comment_id": 56014027, "body": "typo: &quot;induction has type <code>(f a -&gt; a) -&gt; Ind a -&gt; a</code>.&quot; Should be <code>Ind f</code>."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1449490560, "post_id": 34123543, "comment_id": 56014331, "body": "duals and curry confuse me, but isn&#39;t <code>induction :: (f a -&gt; a) -&gt; (Ind a -&gt; a) \u2248 (f a -&gt; a, Ind a) -&gt; a</code>, so shouldn&#39;t it&#39;s dual be either <code>(Ind a -&gt; a) -&gt; (f a -&gt; a)</code> or <code>a -&gt; (f a -&gt; a, Ind a)</code>?"}, {"owner": {"reputation": 28832, "user_id": 34707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c51a8b8afa2366a2ef4650c411f187a?s=128&d=identicon&r=PG", "display_name": "Edward KMETT", "link": "https://stackoverflow.com/users/34707/edward-kmett"}, "reply_to_user": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 3, "creation_date": 1449590639, "post_id": 34123543, "comment_id": 56067697, "body": "@rampion the outer -&gt; is in the meta theory. Given any f-algebra <code>f :: f a -&gt; a</code>, <code>cata f</code> :: Mu f -&gt; a is the unique f-algebra homomorphism from the initial f-algebra (Mu f) to a. This is how you get <code>(f a -&gt; a) -&gt; Mu f -&gt; a</code>. <code>flip</code> that and you can literally take that as the definition of Mu f! As for ana/coinduction, Given an f-coalgebra (f :: a -&gt; f a), we have <code>ana f :: a -&gt; Nu f</code>. So <code>(a -&gt; f a) -&gt; a -&gt; Nu f</code>. The arrows that get turned around were &#39;f&#39; and the <code>cata f</code>/<code>ana f</code> arrows, not the meta-theoretic ones. When you dualize the def. of monad to make comonad, same thing happens."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1449595855, "post_id": 34123543, "comment_id": 56071240, "body": "Edward KMETT: Thanks!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449687787, "post_id": 34123543, "comment_id": 56120153, "body": "I have the funny feeling that <i>if</i> it&#39;s possible, it will use something relating to the &quot;double reverse&quot; technique, hiding some sort of seed in a functor. And it may only be possible for some functors, if at all."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449695751, "post_id": 34123543, "comment_id": 56124516, "body": "@dfeuer Do you have a link to the &quot;double reverse&quot; technique?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449696326, "post_id": 34123543, "comment_id": 56124848, "body": "@PyRulez, I&#39;m being extremely vague. Please don&#39;t take it literally. I&#39;m talking about a tail-recursive implementation  of <code>map</code> as <code>map = reverse . map&#39; [] where {map&#39; seed [] = seed; map&#39; seed (x : xs) = map&#39; (x : seed) xs}</code>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1449794062, "post_id": 34211942, "comment_id": 56173143, "body": "Can you explain why general recursion (in the form of <code>Fix</code> here) is required to construct and deconstruct that buffer?"}, {"owner": {"reputation": 33, "user_id": 393229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea9200654ead96f5f95b38e4e60aebc?s=128&d=identicon&r=PG", "display_name": "jyp", "link": "https://stackoverflow.com/users/393229/jyp"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449853177, "post_id": 34211942, "comment_id": 56201273, "body": "@dfeuer: this is simply because haskell <i>concrete</i> recursive structures can only be declared using general recursion."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1449954457, "post_id": 34211942, "comment_id": 56231764, "body": "Is there a dual form of <a href=\"https://github.com/jyp/ControlledFusion/blob/master/Control/FixPoints.hs#L54-L56\" rel=\"nofollow noreferrer\">loop</a>? (I like it because even though it uses general recursion, it does not use recursive types (ironically, this function could not be defined at all in a non-recursive environment, because I know a way to use it to produce <code>Void</code>.))"}, {"owner": {"reputation": 33, "user_id": 393229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea9200654ead96f5f95b38e4e60aebc?s=128&d=identicon&r=PG", "display_name": "jyp", "link": "https://stackoverflow.com/users/393229/jyp"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1450009532, "post_id": 34211942, "comment_id": 56243642, "body": "@PyRulez: as far as I can tell the dual of loop is &#39;alloc&#39;."}], "tags": [], "owner": {"reputation": 33, "user_id": 393229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea9200654ead96f5f95b38e4e60aebc?s=128&d=identicon&r=PG", "display_name": "jyp", "link": "https://stackoverflow.com/users/393229/jyp"}, "is_accepted": false, "score": 1, "last_activity_date": 1449782907, "last_edit_date": 1449782907, "creation_date": 1449782394, "answer_id": 34211942, "question_id": 34123543, "link": "https://stackoverflow.com/questions/34123543/how-do-i-convert-an-inductive-type-into-a-coinductive-type-efficiently-without/34211942#34211942", "title": "How do I convert an inductive type into a coinductive type efficiently (without recursion)?", "body": "<p>Yes, this is formally possible:</p>\n\n<p><a href=\"https://github.com/jyp/ControlledFusion/blob/master/Control/FixPoints.hs\" rel=\"nofollow\">https://github.com/jyp/ControlledFusion/blob/master/Control/FixPoints.hs</a></p>\n\n<p>However, the conversion still requires the construction of an intermediate buffer, which can only be done using a loop, at runtime.</p>\n\n<p>The reason underlying this limitation is that a value of the 'inductive' type <em>responds</em> to a given order of evaluation (*),  while the a value of the 'co-inductive' type <em>fixes</em> an order of evaluation. The only way to make the transition possible without forcing many re-computations is to allocate some kind of intermediate buffer, to memoize intermediate results.</p>\n\n<p>By the way, the conversion from 'co-inductive' to 'inductive' requires no buffer, but requires reifing the evaluation order by using an explicit loop. </p>\n\n<p>BTW, I have studied the underlying concepts in two papers:\n1. In Haskell, for effectful streams: <a href=\"https://gist.github.com/jyp/fadd6e8a2a0aa98ae94d\" rel=\"nofollow\">https://gist.github.com/jyp/fadd6e8a2a0aa98ae94d</a>\n2. In classical linear logic, for arrays and streams. <a href=\"http://lopezjuan.com/limestone/vectorcomp.pdf\" rel=\"nofollow\">http://lopezjuan.com/limestone/vectorcomp.pdf</a></p>\n\n<p>(*) That's assuming a strict language. Things change a bit in presence of lazy evaluation, but the concepts and the final answer are the same. There are some comments about lazy evaluation in the source code.</p>\n"}], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 823, "favorite_count": 4, "answer_count": 1, "score": 15, "last_activity_date": 1449782907, "creation_date": 1449440451, "last_edit_date": 1449604035, "question_id": 34123543, "link": "https://stackoverflow.com/questions/34123543/how-do-i-convert-an-inductive-type-into-a-coinductive-type-efficiently-without", "title": "How do I convert an inductive type into a coinductive type efficiently (without recursion)?", "body": "<pre><code>&gt; {-# LANGUAGE DeriveFunctor, Rank2Types, ExistentialQuantification #-}\n</code></pre>\n\n<p>Any inductive type is defined like so</p>\n\n<pre><code>&gt; newtype Ind f = Ind {flipinduct :: forall r. (f r -&gt; r) -&gt; r}\n&gt; induction = flip flipinduct\n</code></pre>\n\n<p><code>induction</code> has type <code>(f a -&gt; a) -&gt; Ind f -&gt; a</code>. There is a dual concept to this called coinduction.</p>\n\n<pre><code>&gt; data CoInd f = forall r. Coinduction (r -&gt; f r) r\n&gt; coinduction = Coinduction\n</code></pre>\n\n<p><code>coinduction</code> has type <code>(a -&gt; f a) -&gt; a -&gt; CoInd f</code>. Notice how <code>induction</code> and <code>coinduction</code> are dual. As an example of inductive and coinductive datatypes, look at this functor.</p>\n\n<pre><code>&gt; data StringF rec = Nil | Cons Char rec deriving Functor\n</code></pre>\n\n<p>Without recursion, <code>Ind StringF</code> is a finite string and <code>CoInd StringF</code> is a finite or infinite string (if we use recursion, they are both finite or infinite or undefined strings). In general, it is possible to convert <code>Ind f -&gt; CoInd f</code> for any Functor <code>f</code>. For example, we can wrap a functor value around a coinductive type</p>\n\n<pre><code>&gt; wrap :: (Functor f) =&gt; f (CoInd f) -&gt; CoInd f\n&gt; wrap fc = coinduction igo Nothing where\n&gt;   --igo :: Maybe (CoInd f) -&gt; f (Maybe (CoInd f))\n&gt;   igo Nothing  = fmap Just fc\n&gt;   igo (Just (Coinduction step seed)) = fmap (Just . Coinduction step) $ step seed\n</code></pre>\n\n<p>This operation adds an extra operation (pattern matching <code>Maybe</code>) for each step. This means it gives <code>O(n)</code> overhead.</p>\n\n<p>We can use induction on <code>Ind f</code> and <code>wrap</code> to get <code>CoInd f</code>.</p>\n\n<pre><code>&gt; convert :: (Functor f) =&gt; Ind f -&gt; CoInd f\n&gt; convert = induction wrap\n</code></pre>\n\n<p>This is <code>O(n^2)</code>. (Getting the first layer is <code>O(1)</code>, but the nth element is <code>O(n)</code> due to the nested <code>Maybe</code>s, making this <code>O(n^2)</code> total.)\nDually, we can define <code>cowrap</code>, which takes an inductive type, and reveals its top Functor layer.</p>\n\n<pre><code>&gt; cowrap :: (Functor f) =&gt; Ind f -&gt; f (Ind f)\n&gt; cowrap = induction igo where\n&gt;    --igo :: f (f (Ind f)) -&gt; f (Ind f)\n&gt;    igo = fmap (\\fInd -&gt; Ind $ \\fold -&gt; fold $ fmap (`flipinduct` fold) fInd)\n</code></pre>\n\n<p><code>induction</code> is always <code>O(n)</code>, so so is <code>cowrap</code>.</p>\n\n<p>We can use <code>coinduction</code> to produce <code>CoInd f</code> from <code>cowrap</code> and <code>Ind f</code>.</p>\n\n<pre><code>&gt; convert' :: (Functor f) =&gt; Ind f -&gt; CoInd f\n&gt; convert' = coinduction cowrap\n</code></pre>\n\n<p>This is again <code>O(n)</code> everytime we get an element, for a total of <code>O(n^2)</code>.</p>\n\n<hr>\n\n<p>My question is, without using recursion (directly or indirectly), can we convert <code>Ind f</code> to <code>CoInd f</code> in <code>O(n)</code> time?</p>\n\n<p>I know how to do it with recursion (convert <code>Ind f</code> to <a href=\"https://hackage.haskell.org/package/unification-fd/docs/Data-Functor-Fixedpoint.html#t:Fix\"><code>Fix f</code></a> and then <code>Fix f</code> to <code>CoInd f</code> (the initial conversion is <code>O(n)</code>, but then each element from <code>CoInd f</code> is <code>O(1)</code>, making the second conversion <code>O(n)</code> total, and <code>O(n) + O(n) = O(n)</code>)), but I would like to see if its possible without.</p>\n\n<p>Observe that <code>convert</code> and <code>convert'</code> never used recursion, directly or indirectly. Nifty, ain't it!</p>\n"}, {"tags": ["http", "haskell", "post", "web-crawler", "http-conduit"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1449438774, "post_id": 34123084, "comment_id": 55995093, "body": "try <code>let res = withManager $ httpLbs req</code> instead of <code>res &lt;- withManager $ httpLbs req</code>."}, {"owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1449439738, "post_id": 34123084, "comment_id": 55995486, "body": "I have edited my post. still an error"}], "answers": [{"comments": [{"owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "edited": false, "score": 0, "creation_date": 1449471671, "post_id": 34123810, "comment_id": 56004256, "body": "thanks! but can you tell me please where the difference between <code>let .. = ..</code> and <code>.. &lt;- ..</code> is?"}, {"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "reply_to_user": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "edited": false, "score": 0, "creation_date": 1449493142, "post_id": 34123810, "comment_id": 56015975, "body": "<code>let</code> is just name binding whereas <code>&lt;-</code> is part of the do notation. You can read more here : <a href=\"https://en.wikibooks.org/wiki/Haskell/do_notation\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Haskell/do_notation</a>"}], "tags": [], "owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "is_accepted": true, "score": 1, "last_activity_date": 1449442065, "creation_date": 1449442065, "answer_id": 34123810, "question_id": 34123084, "link": "https://stackoverflow.com/questions/34123084/haskell-use-data-from-post-request/34123810#34123810", "title": "Haskell use Data from POST REQUEST", "body": "<p>It looks like you are confused by do-notation and monadic/non-monadic code.\nHere is how I would write it.</p>\n\n<pre><code>getGPS :: String -&gt; IO ()\ngetGPS ip = do\n  initReq &lt;- parseUrl \"http://www.geocodeip.com/\"\n  let req = urlEncodedBody [(\"IP\", C8.pack ip)] initReq\n  res &lt;- withManager $ httpLbs req\n  let tags = parseTags (responseBody res)\n  print tags\n</code></pre>\n"}], "owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 1, "accepted_answer_id": 34123810, "answer_count": 1, "score": 0, "last_activity_date": 1449442236, "creation_date": 1449437763, "last_edit_date": 1449442236, "question_id": 34123084, "link": "https://stackoverflow.com/questions/34123084/haskell-use-data-from-post-request", "title": "Haskell use Data from POST REQUEST", "body": "<p>I want to get the body of <a href=\"http://geocodeip.com/\" rel=\"nofollow\">geocodeip.com</a> with a POST request (the ip in the textbox).</p>\n\n<p>Here my code:</p>\n\n<pre><code>{-# OPTIONS_GHC -Wall #-}\n{-# LANGUAGE ForeignFunctionInterface #-}\n{-# LANGUAGE OverloadedStrings #-}\n\nmodule Main where\n\nimport Foreign.C.Types\nimport Foreign.C.String\n\nimport Network.HTTP.Conduit\nimport qualified Data.ByteString.Lazy as L\nimport qualified Data.ByteString.Char8 as C8\nimport Text.HTML.TagSoup\ngetGPS :: String -&gt; IO ()\ngetGPS ip = do\n  initReq &lt;- parseUrl \"http://www.geocodeip.com/\"\n  let req = (flip urlEncodedBody) initReq $ [(\"IP\", C8.pack ip)]\n  let res = withManager $ httpLbs req\n  tags &lt;- fmap parseTags ( (responseBody res))\n  print tags\n\n--foreign export ccall getGPS :: CString -&gt; IO ()\n</code></pre>\n\n<p>So far it is working if i \"finish\" he function with <code>L.putStr $ responseBody res</code> ... but how can I get the <code>tags</code> out of this?</p>\n\n<p>Compile-Error:</p>\n\n<pre><code>    Couldn't match type \u2018Response L.ByteString\u2019 with \u2018L.ByteString\u2019\n    Expected type: Response L.ByteString\n      Actual type: Response (Response L.ByteString)\n    In the first argument of \u2018responseBody\u2019, namely \u2018res\u2019\n    In the second argument of \u2018($)\u2019, namely \u2018responseBody res\u2019\nFailed, modules loaded: none.\n</code></pre>\n\n<p>How to solve this type-error?</p>\n"}, {"tags": ["sql", "haskell", "yesod", "esqueleto"], "answers": [{"comments": [{"owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "edited": false, "score": 0, "creation_date": 1449589321, "post_id": 34142578, "comment_id": 56066731, "body": "Works beautifully. Thanks so much!"}], "tags": [], "owner": {"reputation": 3116, "user_id": 353187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfdc97f71e1b8c257ae1bbd52989785d?s=128&d=identicon&r=PG", "display_name": "xnyhps", "link": "https://stackoverflow.com/users/353187/xnyhps"}, "is_accepted": true, "score": 3, "last_activity_date": 1449555265, "last_edit_date": 1449555265, "creation_date": 1449520061, "answer_id": 34142578, "question_id": 34121399, "link": "https://stackoverflow.com/questions/34121399/unique-post-author-from-esqueleto/34142578#34142578", "title": "Unique post author from Esqueleto", "body": "<p>Instead of using <code>subList_select</code> and trying to call <code>max_</code>, you could just use <code>sub_select</code> and have the subquery sort by date and limit 1.</p>\n\n<p>This is the solution that I found, which seems to do the trick:</p>\n\n<pre><code>    result &lt;- select $ from $ \\(user, status_update) -&gt; do\n        let subquery = from $ \\status_update2 -&gt; do\n            where_ (status_update2 ^. StatusUpdateUser ==. user ^. UserId)\n            where_ (date (status_update2 ^. StatusUpdatePosted) ==. date now)\n            orderBy [desc (status_update2 ^. StatusUpdatePosted)]\n            limit 1\n            return (status_update2 ^. StatusUpdateId)\n\n        where_ (status_update ^. StatusUpdateId ==. sub_select subquery)\n        where_ (user ^. UserId ==. status_update ^. StatusUpdateUser)\n        return\n            ( status_update ^. StatusUpdateId\n            , status_update ^. StatusUpdateSubject\n            , status_update ^. StatusUpdateMessage\n            , user ^. UserEmail\n            )\n</code></pre>\n\n<p>The resulting SQL is:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT \"status_update\".\"id\", \"status_update\".\"subject\", \"status_update\".\"message\", \"user\".\"email\"\nFROM \"user\", \"status_update\"\nWHERE (\"status_update\".\"id\" = (SELECT \"status_update2\".\"id\"\n    FROM \"status_update\" AS \"status_update2\"\n    WHERE (\"status_update2\".\"user\" = \"user\".\"id\")\n    AND (date(\"status_update2\".\"posted\") = date(date(?)))\n    ORDER BY \"status_update2\".\"posted\" DESC\n    LIMIT 1))\nAND (\"user\".\"id\" = \"status_update\".\"user\")\n</code></pre>\n\n<p>To satisfy the \"only <code>StatusUpdates</code> from the current day\" condition I have defined <code>date</code> and <code>now</code> by importing <code>Database.Esqueleto.Internal.Sql</code> and:</p>\n\n<pre><code>date :: SqlExpr (Value UTCTime) -&gt; SqlExpr (Value Int)\ndate d = unsafeSqlFunction \"date\" d\n\nnow :: SqlExpr (Value UTCTime)\nnow = unsafeSqlFunction \"date\" (val \"now\" :: SqlExpr (Value String))\n</code></pre>\n\n<p>However, what exactly \"from the current day\" means to you could be something different (past 24 hours, in a certain timezone, etc.).</p>\n"}], "owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 34142578, "answer_count": 1, "score": 2, "last_activity_date": 1449555265, "creation_date": 1449428500, "last_edit_date": 1449453126, "question_id": 34121399, "link": "https://stackoverflow.com/questions/34121399/unique-post-author-from-esqueleto", "title": "Unique post author from Esqueleto", "body": "<p>I have an Esqueleto query that selects all of the <code>StatusUpdate</code>s and their respective <code>User</code>s. I'd like to limit it to only one <code>StatusUpdate</code> per <code>User</code>, and only <code>StatusUpdate</code>s from the current day.</p>\n\n<p>I have a working SQL query, I'm just struggling with turning it into valid Esqueleto.</p>\n\n<pre><code>SELECT \"email\", \"subject\"\nFROM \"status_update\"\nLEFT JOIN \"user\"\nON (\"status_update\".\"user\" = \"user\".\"id\")\nWHERE \"status_update\".\"id\"\nIN (SELECT MAX(\"status_update\".\"id\") FROM \"status_update\" GROUP BY \"status_update\".\"user\")\n</code></pre>\n\n<p>What I have so far:</p>\n\n<pre><code>  statusUpdates &lt;- runDB\n    $ E.select\n    $ E.from $ \\(status_update `E.LeftOuterJoin` user) -&gt; do\n\n      E.on (status_update ^. StatusUpdateUser E.==. user ^. UserId)\n\n      E.where_ ((status_update ^. StatusUpdateId) `E.in_`\n        (E.subList_select $ E.from $ \\(status_update) -&gt; do\n          E.groupBy (status_update ^. StatusUpdateUser)\n          return (status_update ^. StatusUpdateId)))\n\n      return\n        ( status_update ^. StatusUpdateId\n        , status_update ^. StatusUpdateSubject\n        , status_update ^. StatusUpdateMessage\n        , user ^. UserEmail\n        )\n</code></pre>\n\n<p>\u2026Which produces the following output:</p>\n\n<pre><code>SELECT \"status_update\".\"id\", \"status_update\".\"subject\", \"status_update\".\"message\", \"user\".\"email\"\nFROM \"status_update\"\nLEFT OUTER JOIN \"user\"\nON \"status_update\".\"user\" = \"user\".\"id\"\nWHERE \"status_update\".\"id\"\nIN (SELECT \"status_update2\".\"id\" FROM \"status_update\" AS \"status_update2\" GROUP BY \"status_update2\".\"user\"); []\n</code></pre>\n\n<p>It seems the only thing that's missing is the <code>MAX</code> function in my second select. I've been trying to squeeze <code>E.max_</code> into different parts of the query but I can't seem to make anything work.</p>\n\n<p>Help?</p>\n"}, {"tags": ["haskell", "types", "type-systems", "lambda-calculus"], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1449656981, "post_id": 34120885, "comment_id": 56099473, "body": "Sorry I do not understand how you&#39;re able to know when it should be a Pi and when it should be a \u03bb by context. Could you elaborate a little bit on the distinction?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1449657577, "post_id": 34120885, "comment_id": 56099864, "body": "As a simple example, <code>\u03bb (a : *) -&gt; \u03bb (x : a) -&gt; a</code> applied to itself. What would happen? Since <code>a : *</code> and everything is a type, wouldn&#39;t this term accept everything?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1449658386, "post_id": 34120885, "comment_id": 56100428, "body": "@Viclib, I have a little typechecker for a basic dependent type theory, I&#39;ll try to merge <code>\u03a0</code> and <code>\u03bb</code>. If you have <code>[a : *] -&gt; [x : a] -&gt; a</code> and you apply it to itself, then the first binder acts like a lambda and the result is <code>[x : [a : *] -&gt; [x : a] -&gt; a] -&gt; a</code>."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1449659331, "post_id": 34120885, "comment_id": 56101063, "body": "But that&#39;s my issue. How do you know the first binder should act like a lambda? To me it seems that doing that will allow you to express anything, for example, <code>(\u03bb (x : *) -&gt; (x x)) (\u03bb (x : *) -&gt; (x x))</code> reduces to itself because the first binder is treated as a \u03bb, and that goes on forever. How are you able to say it is OK to apply <code>(\u03bb (a : *) -&gt; \u03bb (x : a) -&gt; a)</code> to itself, but not <code>(\u03bb (x : *) -&gt; (x x))</code>?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1449660900, "post_id": 34120885, "comment_id": 56102018, "body": "@Viclib, <code>\u03bb (x : *) -&gt; (x x)</code> is not typeable and we don&#39;t reduce untyped expressions. One problem is that in the same <code>t = [ x : * ] -&gt; ...</code> a binder can be treated in one place as a lambda and in another as a pi and all in the same expression. I&#39;m not sure how bad it is, but it can be prevented by remembering which binder what denote."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1449663278, "post_id": 34120885, "comment_id": 56103436, "body": "@Viclib, I wrote a bit of code and here are some problems I encountered: in <code>([ x : _ ] [ y : _ ] -&gt; x) x y</code> both binders are lambdas, but to show this we must either reduce terms as soon as possible (not sure whether it is safe, but probably yes) or keep track of to how many arguments a function is applied. When we infer the type of <code>f x</code> (since we have explicit types everywhere, all terms are inferrable), we know that <code>f</code> is a function, but don&#39;t know what <code>x</code> is. If <code>f</code> is a lambda and <code>x</code> contains binders, then we must reduce the expression."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1449663474, "post_id": 34120885, "comment_id": 56103556, "body": "We can&#39;t leave uninstantiated binders in a fully typed term. What&#39;s the type of <code>[x : _] -&gt; ...</code>? It can be both <code>\u03a0 _ _</code> and <code>*</code>. Dealing with all these details looks too tedious. In any case it&#39;s better to use <code>\u03a0</code> and <code>\u03bb</code> explicitly."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1449678790, "post_id": 34120885, "comment_id": 56114304, "body": "I still don&#39;t understand the origin of the asymmetry between Pi and Lam. Would it be possible to have a simpler, more symmetrical  system, with the practical utilities (type checking, proving correctness, totality, etc) of CoC? I&#39;ll make a new question for that one."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1449680859, "post_id": 34120885, "comment_id": 56115741, "body": "@Viclib, &quot;Would it be possible to have a simpler, more symmetrical system&quot; \u2014 I&#39;m sure it&#39;s not. It&#39;s like asking &quot;would it be possible to have a simpler, more symmetrical system, if we replace every &#39;d&#39; and &#39;b&#39; with &#39;o|o&#39; and decide from a context whether &#39;o|o&#39; is &#39;b&#39; or &#39;d&#39;?&quot; It obscures your code, it complicates your typechecker. I can&#39;t say better than Thorsten Altenkirch (a quote is in my answer)."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1449682308, "post_id": 34120885, "comment_id": 56116758, "body": "Hmm I see. So, what I might need is understanding how this remarkably specific system, with 2 very similar yet different constructs, is so interesting and powerful. Maybe time experience will tell me so. Thanks for all your answers (:"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1449682543, "post_id": 34120885, "comment_id": 56116902, "body": "Btw do you have a link to the archive of that thread? How did you get those quotes?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1449682931, "post_id": 34120885, "comment_id": 56117118, "body": "@Viclib, what one might do is to express both <code>\u03a0</code> and <code>\u03bb</code> in terms of the same <code>bind</code> like this: <code>\u03a0 = bind pi</code>, <code>\u03bb = bind lam</code>. That&#39;s how it is in the <a href=\"https://lirias.kuleuven.be/bitstream/123456789/404549/1/icfp002-devriese-authorversion.pdf\" rel=\"nofollow noreferrer\">Typed Syntactic Meta-programming</a> paper. Thanks for all your questions, I learned a lot while studying answers to them or writing my own."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1449683164, "post_id": 34120885, "comment_id": 56117265, "body": "I don&#39;t have a link (thy <a href=\"http://comments.gmane.org/gmane.science.mathematics.logic.coq.club/16292\" rel=\"nofollow noreferrer\">this</a>, but it doesn&#39;t work for me; if it doesn&#39;t work for you too, try to google &quot;Similarities between forall and fun&quot; and read cached messages), I get the quotes from incoming messages in my gmail."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 6, "last_activity_date": 1449437056, "last_edit_date": 1449437056, "creation_date": 1449425696, "answer_id": 34120885, "question_id": 34120462, "link": "https://stackoverflow.com/questions/34120462/is-it-actually-possible-to-remove-pi-from-calculus-of-constructions/34120885#34120885", "title": "Is it actually possible to remove &quot;Pi&quot; from Calculus of Constructions?", "body": "<p>That's just overloading like <code>(a, b)</code> in Haskell: it can be both a type and a value. You can use the same binder for <code>\u03a0</code> and <code>\u03bb</code> and typechecker will decide from the context which one you mean. If you typecheck one binder against another, then the former is <code>\u03bb</code> and the latter is <code>\u03a0</code> \u2014 and that's why you can't unambiguously replace <code>*</code> with <code>\u03bb x . x</code> \u2014 because then the former binder could be <code>\u03a0</code> and the latter is <code>*</code> (<code>*</code> as a binder doesn't make any sense to me). There is a bigger problem with <code>\u2200 = \u03bb</code> and <code>* = \u03bb x . x</code>: by transitivity <code>* = \u2200 x . x</code>, which is a common way to postulate <code>False</code> \u2014 this type must be uninhabited in a sound system, so you won't have any types at all.</p>\n\n<p>There was a recent thread on Coq-club \"Similarities between forall and fun\" (gmane.org gives me \"No such message\", is it just me?), here are some excerpts:</p>\n\n<p><strong>Dominic Mulligan</strong>:</p>\n\n<blockquote>\n  <p>And here is another with a small bibliography pointing to similar work:</p>\n  \n  <p><a href=\"http://www.macs.hw.ac.uk/~fairouz/forest/papers/journals-publications/jfp05.pdf\" rel=\"nofollow\">http://www.macs.hw.ac.uk/~fairouz/forest/papers/journals-publications/jfp05.pdf</a></p>\n  \n  <p>Ironically, according to that paper Coquand first presented the Calculus of\n  Constructions with a single, unified binder, following a convention\n  established by De Bruijn in AutoMath.</p>\n</blockquote>\n\n<p><strong>Thorsten Altenkirch:</strong></p>\n\n<blockquote>\n  <p>A function and its type are very different concepts even if they have\n  some superficial syntactic similarity.</p>\n  \n  <p>Especially for the newcomer this identification is very confusing and\n  completely misleading. I do think that one should understand type\n  theoretical concepts from what they mean and not how they look like.</p>\n</blockquote>\n\n<p><strong>Andreas Abel</strong>:</p>\n\n<blockquote>\n  <p>My student Matthias Benkard also worked on such a system, see \"Type\n  Checking without Types\"</p>\n  \n  <p><a href=\"http://www.cse.chalmers.se/~abela/benkardThesis.pdf\" rel=\"nofollow\">http://www.cse.chalmers.se/~abela/benkardThesis.pdf</a></p>\n</blockquote>\n\n<p>Note that the system described at the first link has \u03a0-reduction (i.e. you can apply pi-types just like lambdas) \u2014 your system will have it too, if you unify <code>\u03a0</code> and <code>\u03bb</code> internally (as opposed to syntactically). And the system described at the second link unifies types and values</p>\n\n<blockquote>\n  <p>One immediate consequence is the absence of any distinction between\n  types and their inhabitants: Every value is a type containing itself\n  and all of its parts; and conversely, every type is a composite value\n  consisting of its inhabitants.</p>\n</blockquote>\n\n<p>so there is really just one binder (except for <code>let</code> and maybe <code>fix</code>).</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 2, "accepted_answer_id": 34120885, "answer_count": 1, "score": 6, "last_activity_date": 1449437056, "creation_date": 1449423239, "question_id": 34120462, "link": "https://stackoverflow.com/questions/34120462/is-it-actually-possible-to-remove-pi-from-calculus-of-constructions", "title": "Is it actually possible to remove &quot;Pi&quot; from Calculus of Constructions?", "body": "<p>The article <a href=\"http://augustss.blogspot.com.br/2007/10/simpler-easier-in-recent-paper-simply.html\">Simpler, Easier!</a> claims it could be possible to encode dependent type systems even without the presence of \"Pi\" - that is, you could reuse the \"Lam\" constructor for it. But how can that be true, if \"Pi\" and \"Lam\" are treated differently in some cases?</p>\n\n<p>Moreover, could \"Star\" be removed? I think you could replace all occurrences of it by \"\u03bb x . x\" (id).</p>\n"}, {"tags": ["parsing", "haskell"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1449429430, "post_id": 34120460, "comment_id": 55991920, "body": "Related: <a href=\"http://stackoverflow.com/questions/28200987/why-am-i-getting-a-type-error-in-this-sequence-of-parsers-lecture-8-by-erik-mei\" title=\"why am i getting a type error in this sequence of parsers lecture 8 by erik mei\">stackoverflow.com/questions/28200987/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": false, "score": 1, "last_activity_date": 1449426687, "last_edit_date": 1449426687, "creation_date": 1449424241, "answer_id": 34120632, "question_id": 34120460, "link": "https://stackoverflow.com/questions/34120460/unable-to-get-the-return-type-in-a-parser-match-the-signature-in-haskell-using-t/34120632#34120632", "title": "Unable to get the return type in a Parser match the signature in Haskell using the do syntax", "body": "<p>Remember that you can't quite use <code>do</code>-notation yet as proper usage of the <code>do</code> notation requires you to have a <code>Monad</code> instance for <code>newtype Parser</code>. Since you are using a type synonym, the compiler is happily using the <code>Monad</code> instance for the <code>(-&gt;) r</code> type \u2013 which is not what you want! In an ideal world the compiler would have been able to read your intent and complained, but sadly it could not.</p>\n\n<p>Sequencing your parser type is more complicated than sequencing the arrow type. The arrow type doesn't know that we mean <code>[]</code> to be failure or that we want each parser to gobble up a little and then spit out what's left. So let's define a sequencing operator like <code>&gt;&gt;&gt;=</code> that encodes our ideas:</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>(&gt;&gt;&gt;=) :: Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b\np &gt;&gt;&gt;= f = \\input -&gt; case parse p input of\n                     []         -&gt; []\n                     [(v, out)] -&gt; parse (f v) out\n</code></pre>\n\n<p>Then let's desugar your <code>do</code> block using this operator:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>p :: Parser (Char, Char)\np = item &gt;&gt;&gt;= \\x -&gt;\n    item &gt;&gt;&gt;= \\_ -&gt;\n    item &gt;&gt;&gt;= \\y -&gt;\n    ret (x, y)\n</code></pre>\n\n<p>And that should make it typecheck. <code>parse p \"abcdef\" =&gt; [(('a','c'),\"def\")]</code>.</p>\n\n<p>Credit for this code goes to <a href=\"https://github.com/igstan/programming-in-haskell/blob/master/functional-parsers.hs\" rel=\"nofollow\">Ionu\u021b G. Stan</a>.</p>\n\n<h2>Alternatively</h2>\n\n<p>Alternatively we can skip ahead a little and implement the <code>Monad</code> instance. We insist on doing it so that we can keep our nice <code>do</code>-block. The first order of business is to use <code>newtype</code> so we can attach typeclass instances to our type.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>newtype Parser a =\n  Parser { parse :: String -&gt; [(a, String)] }\n</code></pre>\n\n<p>For a type to have <code>Monad</code>, it must first have <code>Functor</code> and <code>Applicative</code>. Functor is easy enough to discharge with <code>deriving (Functor)</code>.  Applicative is a little trickier, but very similar to the <code>&gt;&gt;&gt;=</code> we wrote above.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>newtype Parser a =\n  Parser { parse :: String -&gt; [(a, String)] }\n  deriving (Functor)\n\ninstance Applicative Parser where\n  pure x =\n    Parser (\\inp -&gt; [(x, inp)])\n  left &lt;*&gt; right =\n    Parser (\\inp -&gt; case parse left inp of\n              [] -&gt; []\n              [(a2b, s)] -&gt; case parse right s of\n                [] -&gt; []\n                [(a, out)] -&gt; [(a2b a, out)])\n</code></pre>\n\n<p>Implementing <code>Monad</code> is a breeze as it mostly involves copying and pasting our <code>&gt;&gt;&gt;=</code> definition into the definition for the actual name of the operator, <code>&gt;&gt;=</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance Monad Parser where\n  return =\n    pure\n  p &gt;&gt;= a2q =\n    Parser (\\inp -&gt; case parse p inp of\n              [] -&gt; []\n              [(a, out)] -&gt; parse (a2q a) out)\n</code></pre>\n\n<p>Restoring your code back to full:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>p :: Parser (Char, Char)\np = do\n  x &lt;- item\n  item\n  y &lt;- item\n  return (x, y)\n</code></pre>\n\n<p><code>parse p \"abcdef\" =&gt; [(('a','c'),\"def\")]</code>, as desired.</p>\n\n<h2>Alternatively alternatively</h2>\n\n<p>We could actually elide the <code>Monad</code> instance entirely. Note that the parser can be written with just the applicative methods:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>q :: Parser (Char, Char)\nq = (,) &lt;$&gt; (item &lt;* item &lt;*&gt; item)\n</code></pre>\n\n<p>You can read this (very abstruse) code as \"using the <code>(,)</code> function to collect all the items we are about to take, take one item and keep it, take one more item and throw it away, and then take one more item.\"</p>\n\n<p>This is likely more information than required, but I'm a big fan of applicative. It deserves more spotlight! Popular parsing packages like <code>parsec</code> or <code>attoparsec</code> encourage the use of applicative parsers for reasons of performance.</p>\n\n<p>One wonders if our <code>do</code>-block would continue to work once we delete our lovely <code>Monad</code> instance. Not as of yet! But a <a href=\"https://ghc.haskell.org/trac/ghc/wiki/ApplicativeDo\" rel=\"nofollow\">future GHC will have ApplicativeDo</a>.</p>\n\n<h2>Full code</h2>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE DeriveFunctor #-}\n\nmodule Main where\n\nnewtype Parser a =\n  Parser { parse :: String -&gt; [(a, String)] }\n  deriving (Functor)\n\ninstance Applicative Parser where\n  pure x =\n    Parser (\\inp -&gt; [(x, inp)])\n  left &lt;*&gt; right =\n    Parser (\\inp -&gt; case parse left inp of\n              [] -&gt; []\n              [(a2b, s)] -&gt; case parse right s of\n                [] -&gt; []\n                [(a, out)] -&gt; [(a2b a, out)])\n\ninstance Monad Parser where\n  return =\n    pure\n  p &gt;&gt;= a2q =\n    Parser (\\inp -&gt; case parse p inp of\n              [] -&gt; []\n              [(a, out)] -&gt; parse (a2q a) out)\n\nfailure :: Parser a\nfailure = Parser (\\inp -&gt; [])\n\nitem :: Parser Char\nitem = Parser (\\inp -&gt; case inp of\n                 [] -&gt; []\n                 (x:xs) -&gt; [(x, xs)])\n\np :: Parser (Char, Char)\np = do\n  x &lt;- item\n  item\n  y &lt;- item\n  return (x, y)\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4150768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/31BEY.jpg?s=128&g=1", "display_name": "skoppisetti", "link": "https://stackoverflow.com/users/4150768/skoppisetti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449426687, "creation_date": 1449423235, "question_id": 34120460, "link": "https://stackoverflow.com/questions/34120460/unable-to-get-the-return-type-in-a-parser-match-the-signature-in-haskell-using-t", "title": "Unable to get the return type in a Parser match the signature in Haskell using the do syntax", "body": "<p>I am learning Haskell and working through <strong>Graham Hutton's - Programming in Haskell</strong>. For a week I am now stuck in the chapter on <strong>Functional Parsers</strong>. I am following the examples as they are and can't get the types match for this one parser using the do syntax. Following is the code:</p>\n\n<pre><code>type Parser a = String -&gt; [(a,String)]\n\nret :: a -&gt; Parser a\nret v = \\inp -&gt; [(v , inp)]\n\nfailure :: Parser a\nfailure = \\inp -&gt; []\n\nitem :: Parser Char\nitem = \\inp -&gt; case inp of\n                 [] -&gt; []\n                 (x:xs) -&gt; [(x,xs)]\n\nparse :: Parser a -&gt; String -&gt; [(a, String)]\nparse p inp = p inp\n\np :: Parser (Char, Char)\np = do \n    x &lt;- item\n    item\n    y &lt;- item\n    ret (x, y)\n</code></pre>\n\n<p>Loading this script into GHCi throws an error complaining about the types not matching for the last parser <strong>\"p\"</strong>. I actually agree with the error because <strong>\"item\"</strong> parser has a return type of <code>[(Char, String)]</code>. Therefore the return type for parser <strong>p</strong> is <code>[(([(Char, String)], [(Char, String)]), String)]</code> but parser p is declared to be of type <code>Parser (Char , Char)</code> which translates to <code>[((Char, Char), String)]</code>. This is the problem I am facing.</p>\n\n<p>To get around it I worte myself a new function as follows:</p>\n\n<pre><code>getIt :: [(a,b)] -&gt; a\ngetIt = \\(x:xs) -&gt; fst x\n</code></pre>\n\n<p>and modified the Parser p as follows:</p>\n\n<pre><code>p :: Parser (Char, Char)\np = do \n    x &lt;- item\n    item\n    y &lt;- item\n    ret (getIt x, getIt y)\n</code></pre>\n\n<p>This change lines up my return types but the output is still not right:</p>\n\n<pre><code>Prelude&gt; parse p \"abcdef\"\n[(('a','c'), \"def\")] --Expected output according to the book\n[(('a','a'), \"abcdef\")] --Output I get after my changes\n</code></pre>\n\n<p>Any help is really appreciated. I will update the post if I find something myself.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "types", "functional-programming", "type-systems"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1449430697, "post_id": 34120348, "comment_id": 55992352, "body": "I&#39;m not sure about this. Some random thoughts -- Won&#39;t any actual use of such untyped term produce <code>?</code> as a type? Subject reduction can no longer preserve types, it has to account for types possibly becoming <code>?</code> at each beta reduction. Also, adding types later on is not just a matter of adding annotations, but inserting lambdas and applications for types (e.g. identity is a binary function in CoC). In Coq/Agda you may add an (inconsistent) axiom <code>coerce : forall a: Type, ? -&gt; a</code> to force type checking, but reduction will no longer be possible."}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1449422607, "creation_date": 1449422607, "question_id": 34120348, "link": "https://stackoverflow.com/questions/34120348/is-it-possible-to-mix-dynamic-and-static-types-in-a-setting-such-as-system-f-or", "title": "Is it possible to mix dynamic and static types in a setting such as System F or CoC?", "body": "<p>I have a quite big codebase of untyped \u03bb-terms. I think it could be fun trying to this codebase to the Calculus of Constructions, but I'd not like to implement everything from scratch. Instead, I'd like the type system to accept my untyped terms. I'd slowly add type annotations in a progressive manner. </p>\n\n<p>My idea is to extend CoC with a \"unknown\" type annotation, <code>?</code>, that would always typecheck, but I'm not sure that would work. Is there any known, principled way to do this?</p>\n"}, {"tags": ["scala", "haskell", "macros", "dsl"], "answers": [{"tags": [], "owner": {"reputation": 609, "user_id": 1655785, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/j6P2g.jpg?s=128&g=1", "display_name": "ppopoff", "link": "https://stackoverflow.com/users/1655785/ppopoff"}, "is_accepted": true, "score": 1, "last_activity_date": 1479902970, "creation_date": 1479902970, "answer_id": 40764193, "question_id": 34118916, "link": "https://stackoverflow.com/questions/34118916/create-haskell-like-where-construct-with-scala-macroexpressions/40764193#40764193", "title": "Create Haskell-like where construct with scala macroexpressions", "body": "<p>Well, it looks like that Macro or Scala-meta will not help. The only option is to create a compiler plugin for that.</p>\n"}], "owner": {"reputation": 609, "user_id": 1655785, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/j6P2g.jpg?s=128&g=1", "display_name": "ppopoff", "link": "https://stackoverflow.com/users/1655785/ppopoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 1, "accepted_answer_id": 40764193, "answer_count": 1, "score": 3, "last_activity_date": 1479902970, "creation_date": 1449414624, "question_id": 34118916, "link": "https://stackoverflow.com/questions/34118916/create-haskell-like-where-construct-with-scala-macroexpressions", "title": "Create Haskell-like where construct with scala macroexpressions", "body": "<p>Is it possible to create something looking like haskell <code>where-clause</code> in scala with help of scala-macro expressions?</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 590, "user_id": 3029543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100004855955180/picture?type=large", "display_name": "ptkato", "link": "https://stackoverflow.com/users/3029543/ptkato"}, "edited": false, "score": 0, "creation_date": 1541978254, "post_id": 34813485, "comment_id": 93392937, "body": "Wouldn&#39;t something like <a href=\"https://pastebin.com/DFyutFW6\" rel=\"nofollow noreferrer\">this</a> work as well?"}], "tags": [], "owner": {"reputation": 464, "user_id": 3825556, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7ajzp.png?s=128&g=1", "display_name": "Cirquit", "link": "https://stackoverflow.com/users/3825556/cirquit"}, "is_accepted": false, "score": 2, "last_activity_date": 1452868784, "creation_date": 1452868784, "answer_id": 34813485, "question_id": 34118626, "link": "https://stackoverflow.com/questions/34118626/how-to-write-yesod-form-that-checks-if-two-fileds-are-the-same/34813485#34813485", "title": "How to write Yesod form that checks if two fileds are the same?", "body": "<p>This is a working example of a custom password field that checks if the input from both boxes were the same. This comparison is created in the record <code>fieldParse</code>.</p>\n\n<p>To run this example from cmd: <code>stack runghc &lt;filename.hs&gt;</code></p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE OverloadedStrings     #-}\n{-# LANGUAGE QuasiQuotes           #-}\n{-# LANGUAGE TemplateHaskell       #-}\n{-# LANGUAGE TypeFamilies          #-}\nimport           Control.Applicative\nimport           Data.Text           (Text)\nimport           Yesod\n\ndata App = App\n\nmkYesod \"App\" [parseRoutes|\n/ HomeR GET\n|]\n\ninstance Yesod App\n\ninstance RenderMessage App FormMessage where\n    renderMessage _ _ = defaultFormMessage\n\n\npasswordConfirmField :: Field Handler Text\npasswordConfirmField = Field\n    { fieldParse = \\rawVals _fileVals -&gt;\n        case rawVals of\n            [a, b]\n                | a == b -&gt; return $ Right $ Just a\n                | otherwise -&gt; return $ Left \"Passwords don't match\"\n            [] -&gt; return $ Right Nothing\n            _ -&gt; return $ Left \"You must enter two values\"\n    , fieldView = \\idAttr nameAttr otherAttrs eResult isReq -&gt;\n        [whamlet|\n            &lt;input id=#{idAttr} name=#{nameAttr} *{otherAttrs} type=password&gt;\n            &lt;div&gt;Confirm:\n            &lt;input id=#{idAttr}-confirm name=#{nameAttr} *{otherAttrs} type=password&gt;\n        |]\n    , fieldEnctype = UrlEncoded\n    }\n\ngetHomeR :: Handler Html\ngetHomeR = do\n    ((res, widget), enctype) &lt;- runFormGet $ renderDivs $\n        areq passwordConfirmField \"Password\" Nothing\n    defaultLayout\n        [whamlet|\n            &lt;p&gt;Result: #{show res}\n            &lt;form enctype=#{enctype}&gt;\n                ^{widget}\n                &lt;input type=submit value=\"Change password\"&gt;\n        |]\n\nmain :: IO ()\nmain = warp 3000 App\n</code></pre>\n"}], "owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1452868784, "creation_date": 1449412954, "question_id": 34118626, "link": "https://stackoverflow.com/questions/34118626/how-to-write-yesod-form-that-checks-if-two-fileds-are-the-same", "title": "How to write Yesod form that checks if two fileds are the same?", "body": "<p>Let's say we have something like this:</p>\n\n<pre><code>myForm :: Form (Text, Text)\nmyForm = renderBootstrap3 BootstrapBasicForm $ (,)\n  &lt;$&gt; areq passwordField (bfs (\"Password\" :: Text)) Nothing\n  &lt;*&gt; areq passwordField (bfs (\"Repeat password\" :: Text)) Nothing\n</code></pre>\n\n<p>Is it possible to check whether the both field are the same? Validation is\ndescribed <a href=\"http://www.yesodweb.com/book/forms#forms_validation\" rel=\"nofollow\">here</a>,\n<a href=\"http://haddock.stackage.org/lts-3.16/yesod-form-1.4.5/Yesod-Form-Functions.html#v:check\" rel=\"nofollow\"><code>check</code></a>\nseems to be not powerful enough to perform this sort of check. Maybe\n<a href=\"http://haddock.stackage.org/lts-3.16/yesod-form-1.4.5/Yesod-Form-Functions.html#v:checkM\" rel=\"nofollow\"><code>checkM</code></a>\nmay be of some use?</p>\n\n<p>If it's not possible to do with built-in Yesod facilities, what would be the\nbest work-around? I can think of:</p>\n\n<pre><code>postSomethingR :: Handler Html\npostSomethingR = do\n  ((result, form), enctype) &lt;- runFormPost myForm\n  case result of\n    FormSuccess (password0, password1) -&gt; do\n      if password0 == password1\n      then\n      -- do your thing\n      else\n      -- serve the form again and perhaps set message telling that\n      -- passwords don't match?\n</code></pre>\n"}, {"tags": ["haskell", "types"], "answers": [{"comments": [{"owner": {"reputation": 2442, "user_id": 3666302, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e9aed854fcd666aba1316ef908ad5913?s=128&d=identicon&r=PG&f=1", "display_name": "TomTom", "link": "https://stackoverflow.com/users/3666302/tomtom"}, "edited": false, "score": 0, "creation_date": 1449410648, "post_id": 34118196, "comment_id": 55985412, "body": "I see... but how would the definition of <code>throwParty</code> look like if I don&#39;t change the type synonym? I have trouble understanding how to represent the Acquaintances function. Something like: <code>throwParty host (host&#39; friend [people]) = &quot;broken door&quot;</code> doesn&#39;t work."}, {"owner": {"reputation": 2442, "user_id": 3666302, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e9aed854fcd666aba1316ef908ad5913?s=128&d=identicon&r=PG&f=1", "display_name": "TomTom", "link": "https://stackoverflow.com/users/3666302/tomtom"}, "edited": false, "score": 1, "creation_date": 1449414476, "post_id": 34118196, "comment_id": 55986609, "body": "I don&#39;t know what I thought, but now it is clear. You just pass the function which you can use inside...  <code>throwParty host calcPartyGuests = .... calcPartyGuests host someFriend ...</code>"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 2442, "user_id": 3666302, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e9aed854fcd666aba1316ef908ad5913?s=128&d=identicon&r=PG&f=1", "display_name": "TomTom", "link": "https://stackoverflow.com/users/3666302/tomtom"}, "edited": false, "score": 0, "creation_date": 1449452154, "post_id": 34118196, "comment_id": 55998891, "body": "@TomTom: It could look as if you hadn\u2019t changed the definition at all, too: <code>throwParty host host&#39; friend people = \u2026</code>. If you want to represent <code>Acquaintances</code> as one entity, you should probably make it a data type: <code>data Acquaintances = Acquaintances Person Friend [Person]</code> Then <code>throwParty host (Acquaintances host&#39; friend people) = \u2026</code>"}], "tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 3, "last_activity_date": 1449410234, "creation_date": 1449410234, "answer_id": 34118196, "question_id": 34118153, "link": "https://stackoverflow.com/questions/34118153/how-do-type-synonyms-work-with-multi-functions/34118196#34118196", "title": "How do type synonyms work with multi functions?", "body": "<p>That\u2019s equivalent to</p>\n\n<pre><code>throwParty :: Person -&gt; (Person -&gt; Friend -&gt; [Person]) -&gt; DamagedFurniture\n</code></pre>\n\n<p>and not</p>\n\n<pre><code>throwParty :: Person -&gt; Person -&gt; Friend -&gt; [Person] -&gt; DamagedFurniture\n</code></pre>\n\n<p>Something you can do instead is:</p>\n\n<pre><code>type AcquaintancesTo a = Person -&gt; Friend -&gt; [Person] -&gt; a\n\nthrowParty :: Person -&gt; AcquaintancesTo DamagedFurniture\n</code></pre>\n"}], "owner": {"reputation": 2442, "user_id": 3666302, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e9aed854fcd666aba1316ef908ad5913?s=128&d=identicon&r=PG&f=1", "display_name": "TomTom", "link": "https://stackoverflow.com/users/3666302/tomtom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 34118196, "answer_count": 1, "score": 0, "last_activity_date": 1449410234, "creation_date": 1449409994, "question_id": 34118153, "link": "https://stackoverflow.com/questions/34118153/how-do-type-synonyms-work-with-multi-functions", "title": "How do type synonyms work with multi functions?", "body": "<p>I saw that you can create type synonyms with functions that project multiple times, but I don't quite understand how this is supposed to be used.</p>\n\n<p>Here is an example I just made up, which I guess would show such an usecase, but I am not able to define the function <code>throwParty</code>. How would I go about using such a type synonym?</p>\n\n<p><strong>My example</strong></p>\n\n<pre><code>type DamagedFurniture = String\ntype Person           = String\ntype Friend           = Person\ntype Acquaintances    = Person -&gt; Friend -&gt; [Person]\n\nthrowParty :: Person -&gt; Acquaintances -&gt; DamagedFurniture\n</code></pre>\n"}, {"tags": ["haskell", "ghci", "ghc-mod"], "owner": {"reputation": 491, "user_id": 208545, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c949177224405cb00f6b2a956ebf7288?s=128&d=identicon&r=PG", "display_name": "wiz", "link": "https://stackoverflow.com/users/208545/wiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1449407463, "creation_date": 1449407463, "question_id": 34117775, "link": "https://stackoverflow.com/questions/34117775/view-core-for-a-snippet-of-code", "title": "View core for a snippet of code", "body": "<p>Is there a way to get <code>-ddump-simpl</code>-like dump in repl/editor for a code snippet (or at least for a top-level function)? Assuming everything is accesible for ghci/ghc-mod to load an run.</p>\n"}, {"tags": ["haskell", "type-inference", "hugs"], "answers": [{"comments": [{"owner": {"reputation": 602, "user_id": 2695711, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/338ff7a9bfed60daa1a76f6de97bebd9?s=128&d=identicon&r=PG&f=1", "display_name": "Apeiron", "link": "https://stackoverflow.com/users/2695711/apeiron"}, "edited": false, "score": 0, "creation_date": 1449403713, "post_id": 34117118, "comment_id": 55983398, "body": "Yeah, I get that much,  but then why doesn&#39;t  eval (Div (Val 4) (Val 2)) work or eval (Div (eval Val 4) (eval Val 2)) ?"}, {"owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "reply_to_user": {"reputation": 602, "user_id": 2695711, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/338ff7a9bfed60daa1a76f6de97bebd9?s=128&d=identicon&r=PG&f=1", "display_name": "Apeiron", "link": "https://stackoverflow.com/users/2695711/apeiron"}, "edited": false, "score": 0, "creation_date": 1449404001, "post_id": 34117118, "comment_id": 55983485, "body": "@Apeiron I tried <code>eval (Div (Val 4) (Val 2))</code> and it works. The result is <code>2</code>. <code>eval (Div (eval Val 4) (eval Val 2))</code> doesn&#39;t work, because <code>eval Val 4</code> will result in an <code>Int</code> and you cannot use an <code>Int</code> in <code>Div</code> constructor - you need an <code>Expr</code>."}], "tags": [], "owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "is_accepted": true, "score": 3, "last_activity_date": 1449402846, "creation_date": 1449402846, "answer_id": 34117118, "question_id": 34116989, "link": "https://stackoverflow.com/questions/34116989/cannot-infer-instance-using-evaluator/34117118#34117118", "title": "Cannot infer instance using evaluator", "body": "<p>What <code>eval</code> expects is an argument of a type that <code>eval</code> is defined for. Looking at the signature, it requires an argument of type <code>Expr</code>, either a <code>Val</code> or a <code>Div</code>. <code>eval 4</code> means that you're passing an <code>Int</code> to the function. For that to work, <code>eval</code> would have to be defined as:</p>\n\n<pre><code>eval :: Int -&gt; Int\n</code></pre>\n\n<p>By writing <code>(Val 4)</code>, you are invoking one of the data constructors of <code>Expr</code> type, creating a new value of type <code>Expr</code>, which you can pass to <code>eval</code> and make the compiler happy. </p>\n"}], "owner": {"reputation": 602, "user_id": 2695711, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/338ff7a9bfed60daa1a76f6de97bebd9?s=128&d=identicon&r=PG&f=1", "display_name": "Apeiron", "link": "https://stackoverflow.com/users/2695711/apeiron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 34117118, "answer_count": 1, "score": 0, "last_activity_date": 1449402846, "creation_date": 1449401875, "question_id": 34116989, "link": "https://stackoverflow.com/questions/34116989/cannot-infer-instance-using-evaluator", "title": "Cannot infer instance using evaluator", "body": "<p>I've started to work through <a href=\"http://www.cs.nott.ac.uk/~pszgmh/monads\" rel=\"nofollow\">http://www.cs.nott.ac.uk/~pszgmh/monads</a> for a intro on functional programming course. What better way to try and understand stuff than to actually try and test the code.</p>\n\n<p>Alas, on the second page I encounter the following:</p>\n\n<pre><code>data Expr = Val Int | Div Expr Expr\n\neval            :: Expr -&gt; Int \neval (Val n)    = n \neval (Div x y)  = eval x `div` eval y\n</code></pre>\n\n<p>Which produces an error when I try to run it. I'm not quite sure why this happens.\nWhen I try</p>\n\n<pre><code>eval (Val 4) `div` eval (Val 2) \n</code></pre>\n\n<p>in the repl-loop, it works just fine, but </p>\n\n<pre><code>eval 4 `div` eval 2 \n</code></pre>\n\n<p>Ends in a type inference error.</p>\n\n<p>When I update my definition to the following:</p>\n\n<pre><code>data Expr = Val Int | Div Expr Expr\n\neval            :: Expr -&gt; Int \neval (Val n)    = n \neval (Div x y)  = eval (Val x) `div` eval (Val y)\n</code></pre>\n\n<p>I get a type error in definition. What is wrong with the first definition?\nThe course uses Hugs by the way.</p>\n"}, {"tags": ["algorithm", "haskell", "random"], "comments": [{"owner": {"reputation": 7539, "user_id": 786351, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/232239227b4b1c6c9c145d9ab6e6651f?s=128&d=identicon&r=PG", "display_name": "ElKamina", "link": "https://stackoverflow.com/users/786351/elkamina"}, "edited": false, "score": 0, "creation_date": 1449382198, "post_id": 34114181, "comment_id": 55978781, "body": "If it works in Matlab, it couldn&#39;t be a algorithms issue. I don&#39;t know what language this is, but you should post in that stackoverflow"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449384614, "post_id": 34114181, "comment_id": 55979235, "body": "Your mathy symbols do not show up well on my phone. Could you use ASCII, or at least more commonly available symbols?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449405105, "post_id": 34114181, "comment_id": 55983800, "body": "Indeed <code>0.5^2000 :: Double</code> is zero, but I can&#39;t see if this can cause trouble here."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1449405490, "post_id": 34114181, "comment_id": 55983913, "body": "This is <i>not</i> your problem, but note that passing <code>StdGen</code> around like this is error-prone, since it&#39;s easy to use an old one, or use a new one twice. That being said, your code seems to be correctly passing them around, as far as I can see. To prevent these kinds of traps, in the future, consider using a monad like <code>Rand</code> from <code>Control.Monad.Random</code>."}, {"owner": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1449408940, "post_id": 34114181, "comment_id": 55984860, "body": "dfeuer I just did. and @chi if I was passing stdGen around would using Rand make a difference?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449409420, "post_id": 34114181, "comment_id": 55985011, "body": "@chibro2 No difference, AFAICT. It&#39;s just a different style, but the semantics would be the same."}, {"owner": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449410397, "post_id": 34114181, "comment_id": 55985329, "body": "@chi ok I&#39;ll do that. But unfortunately this subtle bug is still eluding me"}], "answers": [{"comments": [{"owner": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "edited": false, "score": 0, "creation_date": 1449455858, "post_id": 34118519, "comment_id": 55999730, "body": "now is there a way to generalize the signature of <code>tos</code>, ie <code>MonadState Int m =&gt; m Int</code> vs <code>State Int Int</code> ? I can&#39;t seem to find some <code>MonadRVar</code>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "edited": false, "score": 0, "creation_date": 1449492760, "post_id": 34118519, "comment_id": 56015711, "body": "@chibro2: you can always use <a href=\"http://hackage.haskell.org/package/transformers/docs/Control-Monad-Trans-Class.html#v:lift\" rel=\"nofollow noreferrer\"><code>lift</code></a> to reach into a transformer stack on top of <code>RVal</code>, or you can use <code>RValT</code> itself on top of the stack."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1449413730, "last_edit_date": 1449413730, "creation_date": 1449412287, "answer_id": 34118519, "question_id": 34114181, "link": "https://stackoverflow.com/questions/34114181/randomized-algorithm-not-behaving-as-expected/34118519#34118519", "title": "Randomized algorithm not behaving as expected", "body": "<p>The problem is actually very simple: with <code>randomR (1,100)</code> you preclude values within the first percent, so you have a complete cutoff at high powers of 1/2 (which all lie in that small interval). Actually a general thing: <a href=\"https://www.cs.utexas.edu/users/EWD/transcriptions/EWD08xx/EWD831.html\" rel=\"nofollow\"><em>ranges should start at zero</em></a>, not at one<sup>&dagger;</sup>, unless there's a specific reason.</p>\n\n<p>But why even use a range of 100 in the first place? I'd just make it</p>\n\n<pre><code>tos :: Prob -&gt; StdGen -&gt; (Bool,StdGen)\ntos p s = (q &lt;= p, s')\n  where (q,s') = randomR (0,1) s\n</code></pre>\n\n<hr>\n\n<p><sup>&dagger;</sup><sub>I know, Matlab gets this wrong all over the place. Just one of the <a href=\"http://www.parallelnetz.de/ScriptingHater.html\" rel=\"nofollow\">many</a> horrible things about that language.</sub></p>\n\n<hr>\n\n<p>Unrelated to your problem: as chi remarked this kind of code looks a lot nicer if you use a suitable random monad, instead of manually passing around <code>StdGen</code>s.</p>\n\n<pre><code>import Data.Random\nimport Data.Random.Source.Std\n\ntype Prob   = Double\n\ntos :: Prob -&gt; RVar Bool\ntos p = do\n  q &lt;- uniform 0 1\n  return $ q &lt;= p\n\nmorris :: [a] -&gt; RVar Int\nmorris xs = go xs 0 where\n  go []     n = return n\n  go (_:xs) n = do\n    h &lt;- tos (0.5^n)\n    go xs $ if h then succ n else n\n\nmorrisTest :: Int -&gt; IO Int\nmorrisTest n = do\n  runRVar (morris [1..n]) StdRandom\n</code></pre>\n"}], "owner": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 34118519, "answer_count": 1, "score": 5, "last_activity_date": 1449413730, "creation_date": 1449377384, "last_edit_date": 1449409715, "question_id": 34114181, "link": "https://stackoverflow.com/questions/34114181/randomized-algorithm-not-behaving-as-expected", "title": "Randomized algorithm not behaving as expected", "body": "<p>I am implementing an approximate counting algorithm where we:</p>\n\n<p>Maintain a counter <em>X</em> using log (log <em>n</em>) bits</p>\n\n<ul>\n<li><p>Initialize <em>X</em> to 0</p></li>\n<li><p>When an item arrives, increase <em>X</em> by 1 with probability (&frac12;)<sup><em>X</em></sup></p></li>\n<li><p>When the stream is over, output 2<sup><em>X</em></sup> &minus; 1 so that E[2<sup><em>X</em></sup>]= <em>n</em> + 1</p></li>\n</ul>\n\n<p>My implementation is as follows:</p>\n\n<pre><code>import System.Random\n\ntype Prob   = Double\ntype Tosses = Int\n\n-- * for sake of simplicity we assume 0 &lt;= p &lt;= 1\ntos :: Prob -&gt; StdGen -&gt; (Bool,StdGen)\ntos p s = (q &lt;= 100*p, s')\n  where (q,s') = randomR (1,100) s\n\ntoses :: Prob -&gt; Tosses -&gt; StdGen -&gt; [(Bool,StdGen)]\ntoses _ 0 _ = []\ntoses p n s = let t@(b,s') = tos p s in t : toses p (pred n) s'\n\ntoses' :: Prob -&gt; Tosses -&gt; StdGen -&gt; [Bool]\ntoses' p n = fmap fst . toses p n\n\nmorris :: StdGen -&gt; [a] -&gt; Int\nmorris s xs = go s xs 0 where\n  go _ []     n = n\n  go s (_:xs) n = go s' xs n' where\n    (h,s') = tos (0.5^n) s \n    n'     = if h then succ n else n\n\nmain :: IO Int\nmain = do\n  s &lt;- newStdGen\n  return $ morris s [1..10000]\n</code></pre>\n\n<p>The problem is that my X is always incorrect for any <code>|stream| &gt; 2</code>, and it seems like for all <code>StdGen</code> and <code>|stream| &gt; 1000</code>, <code>X = 7</code> </p>\n\n<p>I tested the same algorithm in Matlab and it works there, so I assume it's either </p>\n\n<ol>\n<li><p>an issue with my random number generator, or</p></li>\n<li><p>raising 1/2 to a large n in <code>Double</code></p></li>\n</ol>\n\n<p>Please suggest a path forward?</p>\n"}, {"tags": ["string", "haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449374250, "post_id": 34113824, "comment_id": 55977399, "body": "You can write this particular function yourself rather easily. But you will find things start to get trickier if you want to support other <code>printf</code>-style format specifiers. There actually is a Haskell version of <code>printf</code>, but it&#39;s a bit ... weird."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449375017, "post_id": 34113824, "comment_id": 55977547, "body": "@dfeuer any help with how to write the function? I am new to Haskell... thanks. I only need this specific functionality with strings. Maybe something like <code>splitOn &quot;%s&quot;</code>   then <code>zip</code>  and <code>concat</code> the two lists??? Would that be an efficient way to do it? (assuming that I can even do that)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1449375158, "post_id": 34113824, "comment_id": 55977580, "body": "I think it&#39;s definitely a good idea to think about the utilities in <code>Data.List.Split</code>! You&#39;re probably getting close. Why don&#39;t you try out your idea and see where it leads? If you get properly stuck, we&#39;ll be happy to help."}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1449377423, "post_id": 34113824, "comment_id": 55977996, "body": "The term to google is &quot;string interpolation&quot;."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449377791, "post_id": 34113824, "comment_id": 55978069, "body": "@dfeuer would please critique my attempt and perhaps show me how I can improve it. Thanks!"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449430596, "post_id": 34113824, "comment_id": 55992310, "body": "Your attempt seems to be a perfectly acceptable implementation... but there is already a <code>concat</code> function."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1449434359, "post_id": 34113824, "comment_id": 55993574, "body": "See <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Text-Printf.html\" rel=\"nofollow noreferrer\">Text.Printf</a> for a reference"}], "answers": [{"comments": [{"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 1, "creation_date": 1449386568, "post_id": 34114733, "comment_id": 55979586, "body": "I have amended by listConcat above. Then I realised I could have done <code>listConcat&#39; s = foldr (++) &quot;&quot; s</code> ?? and then after your post I found the actual <code>Prelude.concat</code>, which oddly enough was the first thing I thought of but for some reason it didn&#39;t work when I first tried it (hence be stumbling through trying to make my own). So I guess <code>concat $ mergeList (splitOn &quot;%s&quot; s) v</code>. Is that a solid solution? I like your Socratic method btw!!!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1449419677, "post_id": 34114733, "comment_id": 55988400, "body": "@matthias, your revised function won&#39;t work on empty lists. The <code>foldr</code> one is fine, but you can generalize it to arbitrary lists."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1449422473, "post_id": 34114733, "comment_id": 55989406, "body": "@dfeur I have changed my base case to <code>listConcat [] = []</code>. I am not sure what you mean regarding the <code>foldr</code>"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1449383209, "creation_date": 1449383209, "answer_id": 34114733, "question_id": 34113824, "link": "https://stackoverflow.com/questions/34113824/string-substitution-operators-with-lists-in-haskell/34114733#34114733", "title": "String substitution operators with lists in Haskell", "body": "<p>Great start! <code>mergeList</code> is very clean.</p>\n\n<pre><code>mergeList :: [a] -&gt; [a] -&gt; [a]\nmergeList [] ys = ys\nmergeList (x:xs) ys = x:mergeList ys xs\n\n\n\nlistConcat :: [String] -&gt; String\nlistConcat [] = []\nlistConcat (x:xs)\n  | null xs   = x\n  | otherwise = x ++ listConcat xs\n</code></pre>\n\n<p>You can do better than this for <code>listConcat</code>. In particular, you currently use two base cases for the recursion, but you only need one. Furthermore, you can change the type signature to <code>listConcat :: [[a]] -&gt; [a]</code> to make it more general. Once you've cleaned up your version: There's a function like that in the standard library. Can you find it?</p>\n"}, {"comments": [{"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1449430712, "post_id": 34119596, "comment_id": 55992355, "body": "would you please look at my attempt at your approach, and perhaps complete your outline so that I can tick it as the solution. Thanks"}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 3, "last_activity_date": 1449418323, "creation_date": 1449418323, "answer_id": 34119596, "question_id": 34113824, "link": "https://stackoverflow.com/questions/34113824/string-substitution-operators-with-lists-in-haskell/34119596#34119596", "title": "String substitution operators with lists in Haskell", "body": "<p>The outline of another, more direct approach:</p>\n\n<pre><code>printf' ('%':'s':rest) (v:vs) = ...\nprintf' (c:rest)       vs     = ...\n... -- handle the remaining cases too\n</code></pre>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1449431771, "creation_date": 1449373908, "last_edit_date": 1449431771, "question_id": 34113824, "link": "https://stackoverflow.com/questions/34113824/string-substitution-operators-with-lists-in-haskell", "title": "String substitution operators with lists in Haskell", "body": "<p>I would like to be able to create a string using printf like functionality, with the variables drawn from a list and inserted into a template string.</p>\n\n<p>i.e.</p>\n\n<pre><code>let templateStr = \"First comes %s, then comes %s, after which comes %s\"\nlet vars = [\"one\",\"two\", \"three\"]\n</code></pre>\n\n<p>and some function returns:</p>\n\n<pre><code>function returns &gt;&gt;&gt; First comes one, then comes two, after which comes three\n</code></pre>\n\n<p>i.e. in Python I could do something like: </p>\n\n<pre><code>&gt;&gt;&gt; templateStr = \"First comes %s, then comes %s, after which comes %s\"\n&gt;&gt;&gt; vars = [\"one\",\"two\", \"three\"]\n&gt;&gt;&gt; outputStr = tempStr % tuple(vars)\n&gt;&gt;&gt; print outputStr\nFirst comes one, then comes two, after which comes three\n</code></pre>\n\n<p><strong>My Attempt</strong></p>\n\n<pre><code>mergeList :: [a] -&gt; [a] -&gt; [a]\nmergeList [] ys = ys\nmergeList (x:xs) ys = x:mergeList ys xs\n\n-- not actually needed * use: Prelude.concat\nlistConcat :: [[a]] -&gt; [a]\nlistConcat [] = []\nlistConcat (x:xs) = x ++ listConcat xs\n\n-- via @dfeuer list concat is not need because of Prelude.concat\nprintf' :: String -&gt; [String] -&gt; String\nprintf' s v = concat $ mergeList (splitOn \"%s\" s) v\n</code></pre>\n\n<p><strong>Attempt via @Reid Barton</strong></p>\n\n<pre><code>printf' :: String -&gt; [String] -&gt; String\nprintf' ('%':'s':rest) (v:vs) = v ++ printf' rest vs\nprintf' (c:rest)        vs    = c :  printf' rest vs\nprintf' []              _     = []\n</code></pre>\n\n<p>both attempts give</p>\n\n<pre><code>&gt;&gt;&gt; let templateStr = \"First comes %s, then comes %s, after which comes %s\"\n&gt;&gt;&gt; let vars = [\"one\",\"two\", \"three\"]\n&gt;&gt;&gt; printf' templateStr vars\n\"First comes one, then comes two, after which comes three\"\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "choice", "agda", "curry-howard"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1449370467, "post_id": 34113331, "comment_id": 55976726, "body": "Downvoted on the grounds that this question does not show any research effort: Googling for &quot;axiom of choice agda&quot; gives quite a lot of discussion of how to do this."}, {"owner": {"reputation": 784, "user_id": 484944, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/209cb96d5d69aed0b63e6a653de79d83?s=128&d=identicon&r=PG", "display_name": "Nick Alger", "link": "https://stackoverflow.com/users/484944/nick-alger"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1449371329, "post_id": 34113331, "comment_id": 55976883, "body": "@DanielWagner If there is no previous discussion on stackexchange about this topic, then it is on-topic regardless of what else you can find on google. The founders of stackexchange have written about this many times. The whole philosophy is to be that resource that future people find while searching google."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 784, "user_id": 484944, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/209cb96d5d69aed0b63e6a653de79d83?s=128&d=identicon&r=PG", "display_name": "Nick Alger", "link": "https://stackoverflow.com/users/484944/nick-alger"}, "edited": false, "score": 2, "creation_date": 1449371384, "post_id": 34113331, "comment_id": 55976897, "body": "@NickAlger Yes; for that reason, I did not (and will not) vote to close the question, which is the action to take for off-topic things. (I think it&#39;s perfectly reasonable for the question-goodness-vote count and the close-vote count to mean different things.)"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1449372891, "post_id": 34113331, "comment_id": 55977161, "body": "The version of the axiom that applies to indexed sets, or are we trying to reason about even uncountable sets?"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1449394263, "creation_date": 1449394263, "answer_id": 34115918, "question_id": 34113331, "link": "https://stackoverflow.com/questions/34113331/how-to-encode-the-axiom-of-choice-in-haskell-functional-programming/34115918#34115918", "title": "How to encode the axiom of choice in Haskell/Functional programming?", "body": "<p>This is just a hint.</p>\n\n<p>The axiom of choice can be expressed as:</p>\n\n<blockquote>\n  <p>If for every <code>x : A</code> there's a <code>y : B</code> such that the property <code>P x y</code> holds, then there's a choice function <code>f : A -&gt; B</code> such that, for all <code>x : A</code> we have <code>P x (f x)</code>.</p>\n</blockquote>\n\n<p>More precisely</p>\n\n<pre><code>choice : {A B : Set} (P : A -&gt; B -&gt; Set) -&gt;\n   ((x : A) -&gt; \u03a3 B (\u03bb y -&gt; P x y)) -&gt;\n   \u03a3 (A -&gt; B) (\u03bb f -&gt; (x : A) -&gt; P x (f x))\nchoice P h = ?\n</code></pre>\n\n<p>given</p>\n\n<pre><code>data \u03a3 (A : Set) (P : A -&gt; Set) : Set where\n  _,_ : (x : A) -&gt; P x -&gt; \u03a3 A P\n</code></pre>\n\n<p>Above, <code>choice</code> is indeed provable. Indeed, <code>h</code> assigns to each <code>x</code> a (dependent) pair whose first component <code>y</code> is an element of <code>A</code> and the second component is a proof that the first indeed satisfies <code>P x y</code>. Instead, the <code>f</code> in the thesis must assign to <code>x</code> only <code>y</code>, without any proof.</p>\n\n<p>As you see, obtaining the choice function <code>f</code> from <code>h</code> is just a matter of discarding the proof component in the pair.</p>\n\n<p>There's no need to extend Agda with LEM or any other axiom to prove this. The above proof is entirely constructive.</p>\n\n<p>If we were using Coq, note that Coq forbids to eliminate a proof (such as <code>h : ... -&gt; Prop</code>) to construct a non-proof (<code>f</code>), so translating this into Coq directly fails. (This is to allow program extraction.) However, if we avoid the <code>Prop</code> sort of Coq and use <code>Type</code> directly, then the above can be translated.</p>\n\n<hr>\n\n<p>You may want to use the following projections for this exercise:</p>\n\n<pre><code>pr1 : \u2200 {A : Set} {P} -&gt; \u03a3 A P -&gt; A\npr1 (x , _) = x\n\npr2 : \u2200 {A : Set} {P} -&gt; (p : \u03a3 A P) -&gt; P (pr1 p)\npr2 (_ , y) = y\n</code></pre>\n"}], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 3, "answer_count": 1, "score": 1, "last_activity_date": 1449434262, "creation_date": 1449369189, "last_edit_date": 1449434262, "question_id": 34113331, "link": "https://stackoverflow.com/questions/34113331/how-to-encode-the-axiom-of-choice-in-haskell-functional-programming", "title": "How to encode the axiom of choice in Haskell/Functional programming?", "body": "<pre><code>&gt; {-# LANGUAGE RankNTypes #-}\n</code></pre>\n\n<p>I was wondering if there was a way to represent the axiom of choice in haskell and/or some other functional programming language.</p>\n\n<p>As we know, false is represented by the type with no values (<code>Void</code> in haskell).</p>\n\n<pre><code>&gt; import Data.Void\n</code></pre>\n\n<p>We can represent negation like so</p>\n\n<pre><code>&gt; type Not a = a -&gt; Void\n</code></pre>\n\n<p>We can express the law of excluded middle for a type <code>a</code> like so</p>\n\n<pre><code>&gt; type LEM a = Either a (a -&gt; Void)\n</code></pre>\n\n<p>This means we can make constructive logic into a <code>Reader</code> monad</p>\n\n<pre><code>&gt; type Constructive a = (forall r. LEM r) -&gt; a\n</code></pre>\n\n<p>We can, for example, do double negation elimination in it</p>\n\n<pre><code>&gt; doubleneg :: Constructive (((a -&gt; Void) -&gt; Void) -&gt; a)\n&gt; doubleneg = \\lem nna -&gt; either id (absurd . nna) lem\n</code></pre>\n\n<p>We can also have a monad where the law of excluded middle fails</p>\n\n<pre><code>&gt; type AntiConstructive a = ((forall r. LEM r) -&gt; Void) -&gt; a\n</code></pre>\n\n<hr>\n\n<p>Now the question is, how can we make a type that represents the axiom of choice? The axiom of choice talks about sets of sets. This implies we would need types of types or something. Is there something <em>equivalent</em> to  the axiom of choice that could be encoded? (If you can encode the negation, just combine it with the law of excluded middle). Maybe trickery would allow us to have types of types.</p>\n\n<p>Note: Ideally, it should be a version of the axiom of choice that works with <a href=\"https://en.wikipedia.org/wiki/Diaconescu%27s_theorem\" rel=\"nofollow\">Diaconescu's theorem</a>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449366441, "post_id": 34112891, "comment_id": 55975943, "body": "Debug.trace uses <code>unsafePerformIO</code>, so the answer to the question &quot;why do the semantics of Debug.trace appear to be so inconsistent&quot; is &quot;because it uses unsafePerformIO&quot;. I&#39;m not that there is any deeper meaning to this."}, {"owner": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449395364, "post_id": 34112891, "comment_id": 55981334, "body": "@user2407038 Is there any other way to do what I want with the &quot;trace&quot; that does not have these kind of problems? Also, what is the way to have trace-like code turned off/on without having to change the source code?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449429950, "post_id": 34112891, "comment_id": 55992092, "body": "Trace is intended only for debugging, it is perfectly acceptable to use trace as you are doing so and then remove it in final code. You can use CPP or cabal conditionals or the like to have trace &quot;enabled&quot; conditionally on different compiles, but it probably isn&#39;t worth it.. simpler to define <code>trace _ x = x</code> in your file and comment out <code>import Debug.Trace</code> when you are ready to get rid of it."}], "owner": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449364570, "creation_date": 1449364570, "question_id": 34112891, "link": "https://stackoverflow.com/questions/34112891/strange-behavior-when-using-quickcheck-and-debug-trace-in-haskell", "title": "Strange behavior when using QuickCheck and Debug.Trace in Haskell", "body": "<p>I am getting a strange behavior when using QuickCheck and Debug.Trace in Haskell. I have the code below, which defines a type <code>S</code> and makes it an instance of the Arbitrary typeclass. In the middle of the implementation of <code>arbitrary</code> I use <code>Debug.Trace.trace</code> to track what is going on. </p>\n\n<pre><code>data S = C Float | R Float Float | T Float Float Float deriving Show\ninstance Arbitrary S where\n  arbitrary = do\n    x &lt;- return () -- STRANGE: Without this line, the string \"aaa\" is only\n                   --          shown for the first occurrence of a C value.\n                   --          But with it, the string \"aaa\" is show for \n                   --          every arbitrary value of a C value.\n    aaa &lt;- Debug.Trace.trace \"aaa\" $ choose (0.0, 10.0)\n    bbb &lt;- Debug.Trace.trace \"bbb\" $ choose (0.0, 10.0)\n    ccc &lt;- choose (0.0, 10.0)\n    ddd &lt;- choose (0.0, 10.0)\n    eee &lt;- choose (0.0, 10.0)\n    fff &lt;- Debug.Trace.trace \"fff\" $ choose (0.0, 10.0)\n    elements [C aaa,\n              R bbb ccc,\n              T ddd eee fff]\nprop_s (C x) = True\nprop_s (R x y) = True\nprop_s (T x y z) = True\np = verboseCheckWith stdArgs {maxSuccess = 10 } prop_s\n</code></pre>\n\n<p>The strange thing is that the previous code behaves differently with and without the line <code>x &lt;- return ()</code>, which at first seems irrelevant, when evaluating <code>p</code> in GHCi.</p>\n\n<p>What is the sense of this behavior?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "pipe"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1449367057, "post_id": 34112862, "comment_id": 55976061, "body": "Expand the expression <code>(f ~&gt; g) ~&gt; h = f ~&gt; (g ~&gt; h)</code> using the definition of <code>~&gt;</code>. The result is exactly the first theorem, but slightly more specific: <code>all y . for (for (f y) g) h = for (f y) (\\x -&gt; for (g x) h)</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449394799, "post_id": 34112862, "comment_id": 55981186, "body": "Perhaps it&#39;s easier to read if the definition of <code>~&gt;</code> is rewritten as <code>(~&gt;) = \\f g x -&gt; for (f x) g</code> ? I can see how using infix and postfix notation together can cause confusion."}, {"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449414789, "post_id": 34112862, "comment_id": 55986724, "body": "@chi I&#39;m confused because the <code>x</code> has disappeared. Not experienced in these derivations."}], "answers": [{"tags": [], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "is_accepted": true, "score": 2, "last_activity_date": 1449428883, "creation_date": 1449428883, "answer_id": 34121480, "question_id": 34112862, "link": "https://stackoverflow.com/questions/34112862/haskell-pipes-understanding-the-logic-of-the-for-equality/34121480#34121480", "title": "Haskell Pipes: Understanding the logic of the &quot;for equality&quot;", "body": "<p>Taking hints from the comments, I've figured it out. Thanks everyone.</p>\n\n<p>First:</p>\n\n<pre><code>  (f ~&gt; g) x =       for (f x) g\n  (f ~&gt; g)   = \\x -&gt; for (f x) g\n  (~&gt;) f g   = \\x -&gt; for (f x) g\n</code></pre>\n\n<p>Hence:</p>\n\n<pre><code>        for (for s f) g, s = e x\n= \\x -&gt; for (for (e x) f) g\n= \\x -&gt; for ((e ~&gt; f) x) g\n= (e ~&gt; f) ~&gt; g\n</code></pre>\n\n<p>and</p>\n\n<pre><code>        for s     (\\x -&gt; for (f x) g), s = e x\n= \\x -&gt; for (e x) (\\x -&gt; for (f x) g)\n= \\x -&gt; for (e x) (f ~&gt; g)\n= e ~&gt; (f ~&gt; g)\n</code></pre>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 34121480, "answer_count": 1, "score": 3, "last_activity_date": 1449428883, "creation_date": 1449364305, "last_edit_date": 1449428342, "question_id": 34112862, "link": "https://stackoverflow.com/questions/34112862/haskell-pipes-understanding-the-logic-of-the-for-equality", "title": "Haskell Pipes: Understanding the logic of the &quot;for equality&quot;", "body": "<p>At the <a href=\"https://hackage.haskell.org/package/pipes-4.1.7/docs/Pipes-Tutorial.html\" rel=\"nofollow\">Pipes tutorial</a>, it says that this:</p>\n\n<pre><code> -- s :: Monad m =&gt;      Producer a m ()  -- i.e. 'P.stdinLn'\n -- f :: Monad m =&gt; a -&gt; Producer b m ()  -- i.e. 'duplicate'\n -- g :: Monad m =&gt; b -&gt; Producer c m ()  -- i.e. '(lift . putStrLn)'    \n for (for s f) g = for s (\\x -&gt; for (f x) g)\n</code></pre>\n\n<p>plus this:</p>\n\n<pre><code> (~&gt;) :: Monad m\n      =&gt; (a -&gt; Producer b m ())\n      -&gt; (b -&gt; Producer c m ())\n      -&gt; (a -&gt; Producer c m ())\n (f ~&gt; g) x = for (f x) g\n</code></pre>\n\n<p>equals this:</p>\n\n<pre><code> f :: Monad m =&gt; a -&gt; Producer b m ()\n g :: Monad m =&gt; b -&gt; Producer c m ()\n h :: Monad m =&gt; c -&gt; Producer d m ()\n (f ~&gt; g) ~&gt; h = f ~&gt; (g ~&gt; h)\n</code></pre>\n\n<p>which makes no sense to me. Could someone please clarify?</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1449354394, "post_id": 34110960, "comment_id": 55973001, "body": "You may also like the <a href=\"http://hackage.haskell.org/package/universe\" rel=\"nofollow noreferrer\">universe</a> family of packages, which offers <code>universe :: Universe a =&gt; [a]</code> as a canonical way to enumerate a given type. It has many instances that are not covered by the <code>(Enum a, Bounded a)</code> constraint -- and skips a few instances that would be covered by that, but in the wrong way, like <code>Double</code>."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1449354538, "post_id": 34111401, "comment_id": 55973053, "body": "I would propose a third idiomatic solution, which is to move the constraint from the class instance to the type signature of <code>enumMyClassId</code>, e.g. <code>enumMyClassId :: (Bounded (MyClassId a), Enum (MyClassId a)) =&gt; [a]</code> and skip that constraint in the <code>MyClass</code> declaration."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1449354677, "post_id": 34111401, "comment_id": 55973109, "body": "@DanielWagner, sure, if you don&#39;t need/want that constraint for some other reason."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 3, "last_activity_date": 1449411281, "last_edit_date": 1449411281, "creation_date": 1449352755, "answer_id": 34111401, "question_id": 34110960, "link": "https://stackoverflow.com/questions/34110960/enumerating-an-associated-type-in-a-typeclass/34111401#34111401", "title": "Enumerating an associated type in a typeclass", "body": "<p>The reason your function is rejected is that any attempt to <em>use</em> it will result in ambiguity. At the use site, you can give a signature that constrains <code>MyClassId a</code>, but you can't specify <code>a</code>. You should be able to defer the error message to the use site (where it will be easier to understand) by temporarily enabling <code>AllowAmbiguousTypes</code>.</p>\n\n<p>There are two idiomatic fixes:</p>\n\n<h3>Use a proxy</h3>\n\n<pre><code>enumMyClassId :: MyClass a =&gt; proxy a -&gt; [MyClassId a]\n</code></pre>\n\n<p>You'd typically pass this a <code>Proxy</code> from <code>Data.Proxy</code>, but you can also use an arbitrary value whose type's last argument is <code>a</code>.</p>\n\n<h3>Use a tagged type</h3>\n\n<p>This approach is typically less convenient, but sometimes is important for getting things to be memoized.</p>\n\n<p>Edward Kmett's <code>tagged</code> package gives you</p>\n\n<pre><code>newtype Tagged s b = Tagged {unTagged :: b}\n</code></pre>\n\n<p>Then you'd write</p>\n\n<pre><code>enumMyClassId :: MyClass a =&gt; Tagged a [MyClassId a]\n</code></pre>\n\n<p>And call it</p>\n\n<pre><code>enumMyClassId :: Tagged a [MyClassId a]\n</code></pre>\n\n<hr>\n\n<p>There's also a GHC-special approach that's not even intended ever to be portable, but that gives performance like tagged types with proxy convenience.</p>\n\n<h3>Magic proxy</h3>\n\n<p>You can use the magical <a href=\"https://hackage.haskell.org/package/ghc-prim-0.4.0.0/docs/GHC-Prim.html#t:Proxy-35-\" rel=\"nofollow\"><code>Proxy#</code> type</a> that GHC completely erases in compilation. This works just like the first solution, but uses a <code>Proxy# a</code> type instead of a <code>proxy a</code> one. When calling such a function, you pass <code>proxy#</code>, which is a totally fake value.</p>\n"}], "owner": {"reputation": 929, "user_id": 1750683, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/918873ca1e4732f952c0baa31cfd3ba0?s=128&d=identicon&r=PG", "display_name": "Enzo", "link": "https://stackoverflow.com/users/1750683/enzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 34111401, "answer_count": 1, "score": 1, "last_activity_date": 1449411281, "creation_date": 1449349936, "last_edit_date": 1449354254, "question_id": 34110960, "link": "https://stackoverflow.com/questions/34110960/enumerating-an-associated-type-in-a-typeclass", "title": "Enumerating an associated type in a typeclass", "body": "<p>Given a typeclass definition like the following, I'd like to enumerate the <code>MyClassId a</code> type for any type that is an instance of <code>MyClass</code>.</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies     #-}\n{-# LANGUAGE FlexibleContexts #-}\n\nclass\n  ( Enum (MyClassId e)\n  , Bounded (MyClassId e))\n  =&gt; MyClass e where\n    type MyClassId e :: *\n\nenumMyClassId :: MyClass a =&gt; [MyClassId a]\nenumMyClassId = enumFrom minBound\n</code></pre>\n\n<p>However, when I try to compile this snippet of code, GHC 7.10.2 complains with the following message:</p>\n\n<pre>\nenumTypeClass.hs:12:18:\n    Couldn't match type \u2018MyClassId a0\u2019 with \u2018MyClassId a\u2019\n    NB: \u2018MyClassId\u2019 is a type function, and may not be injective\n    The type variable \u2018a0\u2019 is ambiguous\n    Expected type: [MyClassId a]\n      Actual type: [MyClassId a0]\n    In the ambiguity check for the type signature for \u2018enumMyClassId\u2019:\n      enumMyClassId :: forall a. MyClass a => [MyClassId a]\n    To defer the ambiguity check to use sites, enable AllowAmbiguousTypes\n    In the type signature for \u2018enumMyClassId\u2019:\n      enumMyClassId :: MyClass a => [MyClassId a]\n</pre>\n\n<p>I am not exactly sure why it can't infer that the <code>a</code> type variable is the same as the <code>a</code> in the constraint for the function <code>enumMyClassId</code>. One possible fix is to change the function <code>enumMyClassId</code> to the following:</p>\n\n<pre><code>enumMyClassId :: MyClass a =&gt; a -&gt; [MyClassId a]\nenumMyClassId _ = enumFrom minBound\n</code></pre>\n\n<p>But this is not very elegant as it introduces an unused variable just to make the program typecheck. Is there some solution that doesn't involve the trick above?</p>\n"}, {"tags": ["haskell", "ghc", "coercion"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 4, "creation_date": 1449346797, "post_id": 34110289, "comment_id": 55970552, "body": "&quot;Haskell types can only be trusted if they don&#39;t have arrows in them, because Haskell allows runtime errors and non-termination&quot; &lt;- what do you mean by this? <i>Every</i> type is inhabited by <code>\u22a5</code>, not just function types, so none of them can be trusted."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1449347130, "post_id": 34110289, "comment_id": 55970661, "body": "@BenjaminHodgson, if you fully force something without functions, then you have a proper witness. For instance, once you force something of type <code>x :~: y</code>, you know that <code>x ~ y</code> (although &quot;internally&quot;, that evidence is only available under a pattern match). If you force a function, that does <i>not</i> generally give you a witness in Haskell."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1449347354, "post_id": 34110289, "comment_id": 55970734, "body": "I&#39;ve edited the question to clarify."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449347719, "post_id": 34110289, "comment_id": 55970864, "body": "IIUC, the last part tests &quot;representational-ness&quot; using two skolem constants <code>A,B</code> in order to guarantee it on all types. I wonder if this might suffer from the same problem as an early version of <code>Data.Constraint.Forall</code>, where using two skolem constants was not enough &quot;thanks&quot; to closed type families being able to count how many arguments are distinct."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449348429, "post_id": 34110289, "comment_id": 55971127, "body": "@chi, I thought about that, but in this case the user doesn&#39;t get so much access, since <code>rep</code> gets only <code>Representational t</code> and the coercions I don&#39;t see anywhere to <i>put</i> leaked information. I could be missing something, of course."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1449348766, "post_id": 34110289, "comment_id": 55971247, "body": "In fact, I think I can probably get away with just using one &quot;skolem&quot;, and its (exportable!) reflexive coercion. The only weird bit about it is that I want it to be polykinded."}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1449347338, "creation_date": 1449346138, "last_edit_date": 1449347338, "question_id": 34110289, "link": "https://stackoverflow.com/questions/34110289/trusting-types-of-functions-with-boring-arguments", "title": "Trusting types of functions with boring arguments", "body": "<p>As a general rule, Haskell types can only be trusted if they don't contain any functions, because Haskell allows runtime errors and non-termination, and even then only when they are fully forced. So in general, if I have a function <code>f :: X -&gt; Y</code>, and I have <code>x :: X</code>, I can only be confident of <code>Y</code> if I force <code>f x</code>. In a recent question/answer, I explored a situation where the <code>X</code> type is \"boring\": specifically, I was working with <code>Data.Type.Coercion.Coercion</code>:</p>\n\n<pre><code>data Coercion a b where\n  Coercion :: Coercible a b =&gt; Coercion a b\n</code></pre>\n\n<p>While the <code>Coercible a b</code> constraint means that <code>Coercion</code> is not quite a nullary data constructor, the coercion system ensures that a <code>Coercible a b</code> dictionary is always represented by <code>\\x -&gt; x</code>, so it almost might as well be nullary.</p>\n\n<p>My impression, which I'd love someone to verify or refute, is that when a function's arguments are <em>all</em> boring in this sort of sense, then applying the function just once, with a single set of type arguments, and forcing the result, allows its type to be trusted for all type arguments. For instance, given Edward Kmett's</p>\n\n<pre><code>class Representational t where\n  rep :: Coercion a b -&gt; Coercion (t a) (t b)\n</code></pre>\n\n<p>I am hoping this works:</p>\n\n<pre><code>type family A :: k\ntype family B :: k\ncoerceAB :: Coercion A B\ncoerceAB = unsafeCoerce (Coercion :: Coercion () ())\n\nreallyRepresentational :: forall t . Representational t =&gt; Proxy t\nreallyRepresentational = (rep coerceAB :: Coercion (t A) (t B)) `seq` Proxy\n</code></pre>\n\n<p>I imagine that there's no way for an implementation of <code>rep</code> to fail on any non-bottom input if it manages to pass <code>reallyRepresentational</code>. Is this correct?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": false, "score": 1, "last_activity_date": 1458268082, "creation_date": 1458268082, "answer_id": 36075086, "question_id": 34109477, "link": "https://stackoverflow.com/questions/34109477/haskell-stack-build-error-no-local-directories-found-as-children/36075086#36075086", "title": "Haskell stack build error &quot;No local directories found as children&quot;", "body": "<p>What's your stack version?  Can you still reproduce this with the latest?</p>\n\n<p>This means that it is parsing an argument as if it is a TARGET, but isn't finding the dir.  I think in old versions of stack, unrecognized flags would get parsed this way.  So, if you're using a command intended for newer stack, this error can happen.</p>\n"}], "owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1458268082, "creation_date": 1449341337, "question_id": 34109477, "link": "https://stackoverflow.com/questions/34109477/haskell-stack-build-error-no-local-directories-found-as-children", "title": "Haskell stack build error &quot;No local directories found as children&quot;", "body": "<p>When running <code>stack build --no-terminal --install-ghc</code>, I run into <code>Error parsing targets: No local directories found as children</code>. \nI can understand what it means, but why does it happen? I haven't read anywhere in the Stack manual about having to create extra directories ..</p>\n\n<p>Thanks in advance </p>\n"}, {"tags": ["haskell", "filter", "lambda"], "comments": [{"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1449347156, "post_id": 34109435, "comment_id": 55970669, "body": "using <code>elemIndex</code> to determine the current element&#39;s index is not robust since it will return <code>Just</code> the index of the <i>first</i> element that is equal to the one you are looking for (or <code>Nothing</code> if no such element exists), which is not necessarily the index of the element you are currently considering.  Imagine what will happen if you try to run your algorithm on a list of identical values."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1449350400, "post_id": 34109435, "comment_id": 55971843, "body": "Did you try to understand the error message (it can be a little intimidating)? It can help to break your function out into smaller functions, giving each a type signature, and working within ghci and using <code>:t</code> to get the types of different expressions as you go"}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 5486662, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/isNIe.jpg?s=128&g=1", "display_name": "GuitarGuy365", "link": "https://stackoverflow.com/users/5486662/guitarguy365"}, "edited": false, "score": 0, "creation_date": 1449343073, "post_id": 34109479, "comment_id": 55969232, "body": "Oh right duh. I am still getting the last error though."}, {"owner": {"reputation": 559, "user_id": 3389669, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6a013398fd6031b9d738643f8c75b7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user3389669", "link": "https://stackoverflow.com/users/3389669/user3389669"}, "reply_to_user": {"reputation": 137, "user_id": 5486662, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/isNIe.jpg?s=128&g=1", "display_name": "GuitarGuy365", "link": "https://stackoverflow.com/users/5486662/guitarguy365"}, "edited": false, "score": 0, "creation_date": 1449344962, "post_id": 34109479, "comment_id": 55969866, "body": "@GuitarGuy365: The last error comes from the use of <code>elemIndex</code>. It returns a <code>Maybe Int</code> and not an <code>Int</code>, because there is the possibility that the given argument is not within the given list. If that is the case, <code>Nothing</code> will be returned, instead of <code>Just n</code>, with an integer <code>n</code>."}], "tags": [], "owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "is_accepted": false, "score": 2, "last_activity_date": 1449348809, "last_edit_date": 1449348809, "creation_date": 1449341346, "answer_id": 34109479, "question_id": 34109435, "link": "https://stackoverflow.com/questions/34109435/type-errors-using-filter-and-lambda/34109479#34109479", "title": "Type errors using filter and lambda?", "body": "<p>What you are passing to <code>filter</code> is a tuple (pair) consisting of the filtering function and the list. The type of <code>filter</code> is</p>\n\n<pre><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>Therefore you should pass two arguments to <code>filter</code>:</p>\n\n<pre><code>dropN lst n = filter (\\x -&gt; ((elemIndex x lst) + 1) `mod` n /= 0) lst\n</code></pre>\n\n<p>In Haskell, you pass arguments to a function by <em>seperating them with spaces</em>. For example,</p>\n\n<pre><code>f a b\n</code></pre>\n\n<p>means \"Invoke <code>f</code> with the first argument equal to <code>a</code> and the second argument equal to <code>b</code>\".</p>\n"}], "owner": {"reputation": 137, "user_id": 5486662, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/isNIe.jpg?s=128&g=1", "display_name": "GuitarGuy365", "link": "https://stackoverflow.com/users/5486662/guitarguy365"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449348809, "creation_date": 1449341133, "question_id": 34109435, "link": "https://stackoverflow.com/questions/34109435/type-errors-using-filter-and-lambda", "title": "Type errors using filter and lambda?", "body": "<p>I've just started learning Haskell about a week ago, and am still struggling a lot with type matching with my functions. I am trying to write a function that takes a list and integer n, and removes every nth index from that list. It's problem 16 in <a href=\"https://wiki.haskell.org/99_questions/11_to_20\" rel=\"nofollow\">H99: 99 Haskell Problems</a>. Anyways here is the code:</p>\n\n<pre><code>dropN :: (Ord a) =&gt; [a] -&gt; Int -&gt; [a]\ndropN lst n = filter (\\x -&gt; ((elemIndex x lst) + 1) `mod` n /= 0, lst)\n</code></pre>\n\n<p>And here are the errors I am receiving: </p>\n\n<pre><code>Prelude&gt; :l P10                                                                \n[1 of 1] Compiling Main             ( P10.hs, interpreted )                                                                                                   \nP10.hs:34:15:                                                                      \n    Couldn't match expected type `[a]' with actual type `[a0] -&gt; [a0]'             \n    Relevant bindings include                                                        \n       lst :: [a] (bound at P10.hs:34:7)                                              \n       dropN :: [a] -&gt; Int -&gt; [a] (bound at P10.hs:34:1)                            \n    Probable cause: `filter' is applied to too few arguments                       \n    In the expression:                                                               \n        filter (\\ x -&gt; (elemIndex x lst) `mod` n /= 0, lst)                          \n    In an equation for `dropN':                                                        \n        dropN lst n = filter (\\ x -&gt; (elemIndex x lst) `mod` n /= 0, lst)                                                                                     \nP10.hs:34:22:                                                                      \n    Couldn't match expected type `a0 -&gt; Bool'                                                  \n    with actual type `(a -&gt; Bool, [a])'                                \n    Relevant bindings include                                                        \n        lst :: [a] (bound at P10.hs:34:7)                                              \n        dropN :: [a] -&gt; Int -&gt; [a] (bound at P10.hs:34:1)                            \n    In the first argument of `filter', namely                                    \n        `(\\ x -&gt; (elemIndex x lst) `mod` n /= 0, lst)'                               \n    In the expression:                                                               \n        filter (\\ x -&gt; (elemIndex x lst) `mod` n /= 0, lst)                          \n    In an equation for `dropN':                                                        \n        dropN lst n = filter (\\ x -&gt; (elemIndex x lst) `mod` n /= 0, lst)                                                                                     \nP10.hs:34:53:                                                                      \n    Couldn't match expected type `Maybe Int' with actual type `Int'                \n    In the second argument of `mod', namely `n'                                    \n    In the first argument of `(/=)', namely `(elemIndex x lst) `mod` n'        \nFailed, modules loaded: none.                                                  \n</code></pre>\n"}, {"tags": ["haskell", "syntax", "lambda", "infix-notation", "infix-operator"], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1449347606, "post_id": 34109441, "comment_id": 55970822, "body": "Nice indeed! Is this part of Haskell98, Haskell2010, or just GHC?"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1449357377, "post_id": 34109441, "comment_id": 55973888, "body": "I especially like the let version."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1449371879, "post_id": 34109441, "comment_id": 55976982, "body": "It is Haskell 98. The syntax of let and where involves &quot;decls&quot;, which includes type signatures, fixity declarations and function and pattern bindings."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1449374178, "post_id": 34109441, "comment_id": 55977383, "body": "please don&#39;t write the <code>let</code> version"}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 16, "last_activity_date": 1449341153, "creation_date": 1449341153, "answer_id": 34109441, "question_id": 34109113, "link": "https://stackoverflow.com/questions/34109113/how-to-give-infixities-to-operators-in-lambda/34109441#34109441", "title": "How to give infixities to operators in lambda?", "body": "<p>Fixity declarations can be local but must accompany definitions, so you'd have to write something like</p>\n\n<pre><code>foo cons nil = 'a' # 'b' # nil\n  where (#) = cons\n        infixr 5 #\n</code></pre>\n\n<p>or</p>\n\n<pre><code>foo = \\cons nil -&gt; let (#) = cons; infixr 5 # in 'a' # 'b' # nil\n</code></pre>\n\n<p>etc.</p>\n"}], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 1, "answer_count": 1, "score": 11, "last_activity_date": 1449341153, "creation_date": 1449339297, "question_id": 34109113, "link": "https://stackoverflow.com/questions/34109113/how-to-give-infixities-to-operators-in-lambda", "title": "How to give infixities to operators in lambda?", "body": "<p>For example, this does not type check</p>\n\n<pre><code>\\cons nil -&gt; 5 `cons` 3 `cons` nil\n</code></pre>\n\n<p>nor does this</p>\n\n<pre><code>\\(#) -&gt; 5 # 3 # nil\n</code></pre>\n\n<p>Although both of these do</p>\n\n<pre><code>\\cons nil -&gt; 5 `cons` nil\n\\(#) nil -&gt; 5 # nil\n</code></pre>\n\n<p>Is there a way to assign infixites to operators in lambdas. I tried</p>\n\n<pre><code>infixr 5 #\nfoo = \\(#) nil -&gt; 5 # 3 # nil\n</code></pre>\n\n<p>which gives an error for no definition of <code>#</code> and</p>\n\n<pre><code>foo = \\(infixr 5 #) nil -&gt; 5 # 3 # nil\n</code></pre>\n\n<p>which is just a syntax error.</p>\n\n<p>What can I do?</p>\n"}, {"tags": ["list", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1449341984, "creation_date": 1449341984, "answer_id": 34109587, "question_id": 34108629, "link": "https://stackoverflow.com/questions/34108629/return-a-sequence-of-elements-in-haskell/34109587#34109587", "title": "Return a sequence of elements in Haskell", "body": "<p>Well, mathematically it actually makes perfect sense to consider a single card a sequence of one card. So it's a good idea to not change that behaviour as such... just extend the definition so you can obtain the real desired result from that.</p>\n\n<p>The real problem is not that you get single cards as single-element sequences, but <em>that you don't get anything behind them</em>. To fix that, you need to first obtain not merely the first, but <em>all</em> sequences in the list:</p>\n\n<pre><code>findSeqs :: [Card] -&gt; [[Card]]\nfindSeqs [] = []\nfindSeqs [h] = [[h]]\nfindSeqs (h:t@(h':_))  -- avoid `head` and `null`... pattern matching FTW!\n  | Just h == (pCard h' pack)  = h ^: findSeqs t\n  | otherwise                  = [h] : findSeqs t\n</code></pre>\n\n<p>I've used the helper</p>\n\n<pre><code>(^:) :: a -&gt; [[a]] -&gt; [[a]]\nh ^: (hl:ls) = (h:hl) : ls\n_ ^: [] = []\n</code></pre>\n\n<p>Once you have <code>findSeqs</code>, you merely need to skim the result for the first non-degenerate sequence.</p>\n"}, {"tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": true, "score": 1, "last_activity_date": 1449342913, "last_edit_date": 1449342913, "creation_date": 1449342390, "answer_id": 34109656, "question_id": 34108629, "link": "https://stackoverflow.com/questions/34108629/return-a-sequence-of-elements-in-haskell/34109656#34109656", "title": "Return a sequence of elements in Haskell", "body": "<p>This is how I would do it:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.List (groupBy)\nimport Data.Function (on)\n\ndata Suit = Clubs | Diamonds | Hearts | Spades deriving Eq\ndata Face = Ace | Two | Three | Four | Five | Six | Seven | Eight | Nine | Ten\n          | Jack | Queen | King deriving Enum\n\ntype Card = (Face, Suit)\n\nfindSequences :: [Card] -&gt; [[Card]]\nfindSequences = [sequence | sequence &lt;- groupBy ((==) `on` snd),\n                            contiguous (map fst sequence),\n                            length sequence &gt; 1]\n\ncontiguous :: Enum a =&gt; [a] -&gt; Bool\ncontiguous (x:xs) = map fromEnum xs == take (length xs) [fromEnum x + 1 ..]\n</code></pre>\n\n<p>The <code>findSequences</code> function finds all the sequences in the deck (except single card sequences).</p>\n"}], "owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 34109656, "answer_count": 2, "score": 0, "last_activity_date": 1449342913, "creation_date": 1449336990, "last_edit_date": 1449339481, "question_id": 34108629, "link": "https://stackoverflow.com/questions/34108629/return-a-sequence-of-elements-in-haskell", "title": "Return a sequence of elements in Haskell", "body": "<p>I want to return a sequence of Cards in a game in Haskell. For example:</p>\n\n<pre><code>[(SIX,D),(SEVEN,D),(EIGHT,S)] ~&gt; [(SIX,D),(SEVEN,D)] \n[(SIX,D),(SEVEN,S)] ~&gt; []\n[(SIX,D),(SEVEN,D)] ~&gt; [(SIX,D),(SEVEN,D)]\n</code></pre>\n\n<p>Until now, I have this function:</p>\n\n<pre><code>findSeq :: [Card] -&gt; [Card]\nfindSeq [] = []\nfindSeq (h:t)\n    | null t = [h]\n    | Just h == (pCard (head t) pack) = h:findSeq t\n    | otherwise = [h]\n</code></pre>\n\n<p>Which returns even the first card: i.e, unsuitable for example 2 above. How can I return a sequence, or nothing else if there is no sequence of consecutive elements in there?</p>\n\n<p>I also tried filtering them, but I received 'too many arguments exception'. Any help?</p>\n"}, {"tags": ["haskell", "typing"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1449316459, "post_id": 34103962, "comment_id": 55960393, "body": "Since when has <code>[a]</code> been equal to <code>[Int] -&gt; Int</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1449313265, "creation_date": 1449313265, "answer_id": 34104045, "question_id": 34103962, "link": "https://stackoverflow.com/questions/34103962/why-would-head-sum-leads-a-type-error-haskell/34104045#34104045", "title": "Why would (head sum) leads a type error? (Haskell)", "body": "<p>For the first one: <code>head</code> expects a list, <code>sum</code> is a function. Hence, they can not be applied.</p>\n\n<p>About the second one: with the new GHC 7.10 class redesign, <code>sum head</code> type checks, but has a useless type:</p>\n\n<pre><code>&gt; :t sum head\nsum head :: (Num a, Foldable ((-&gt;) [a])) =&gt; a\n</code></pre>\n\n<p>Note the constraint <code>Foldable ((-&gt;) [a])</code>. To fulfill such constraint we would need to define, roughly, a conversion function from</p>\n\n<pre><code>[a] -&gt; b\n</code></pre>\n\n<p>and</p>\n\n<pre><code>[b]\n</code></pre>\n\n<p>for any choice of <code>b</code>. This can not really be done, so <code>sum head</code> is not practically usable.</p>\n"}, {"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1449344499, "post_id": 34104080, "comment_id": 55969698, "body": "You are confusing <code>head sum</code> with <code>head . sum</code>."}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1449344625, "post_id": 34104080, "comment_id": 55969741, "body": "@ReinHenrichs, just notice it, you are right, sorry"}], "tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 0, "last_activity_date": 1449313451, "creation_date": 1449313451, "answer_id": 34104080, "question_id": 34103962, "link": "https://stackoverflow.com/questions/34103962/why-would-head-sum-leads-a-type-error-haskell/34104080#34104080", "title": "Why would (head sum) leads a type error? (Haskell)", "body": "<blockquote>\n  <p>I have tried :t head sum in the Ghci and get a type error result.</p>\n</blockquote>\n\n<p><code>head</code> returns the first element of a list, sum reduces a list of num into a single num. Since head take a list it cant take a single int as parameter, thats why <code>head sum</code> throws a type error.\nNotice that you have not check it properly in ghci, the type of sum is:</p>\n\n<pre><code>Prelude&gt; :t sum\nsum :: Num a =&gt; [a] -&gt; a\n</code></pre>\n\n<blockquote>\n  <p>Also, I have tried :t sum head in the Ghci and get a result.</p>\n</blockquote>\n\n<p>As you just saw, <code>head</code> is of type <code>[a] -&gt; a</code> and sum is of type <code>Num a =&gt; [a] -&gt; a</code>, so If <code>head</code> returns an <code>a</code> and asuming that <code>a</code> can be of any type, including a <code>Num a =&gt; [a]</code> or in plain english, a list of numerals wich can be taken by <code>sum</code> and where <code>sum</code> will reduce it and return an <code>a</code> (wich is a Num).\nSo, the type for <code>sum . head</code> is:</p>\n\n<pre><code>Prelude&gt; :t sum . head\nsum . head :: Num c =&gt; [[c]] -&gt; c\n</code></pre>\n\n<p>Mapping to the previous explanation, the <code>[a]</code> from the <code>head</code> is now <code>[c]</code>, the <code>[a]</code> from <code>sum</code> is <code>[[c]]</code> and the final returned result from our previous <code>a</code> is <code>c</code> wich is also a Num (numeral).</p>\n"}], "owner": {"reputation": 43, "user_id": 5504456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5355bf3cf4680d91482b590ac3765acd?s=128&d=identicon&r=PG&f=1", "display_name": "Nostaglia", "link": "https://stackoverflow.com/users/5504456/nostaglia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1449313451, "creation_date": 1449312585, "question_id": 34103962, "link": "https://stackoverflow.com/questions/34103962/why-would-head-sum-leads-a-type-error-haskell", "title": "Why would (head sum) leads a type error? (Haskell)", "body": "<p>I have tried <code>:t head sum</code> in the Ghci and get a type error result.</p>\n\n<p>For my own thinking, it should be <code>[int] -&gt; int</code>.</p>\n\n<p>Also, I have tried <code>:t sum head</code> in the Ghci and get <code>a</code> result.</p>\n\n<p>I get confused for these answers.\nCould someone help me figure out that?</p>\n\n<p><code>head</code> and <code>sum</code> functions shows below:</p>\n\n<p><code>head :: [a] -&gt; a</code></p>\n\n<p><code>sum :: [Int] -&gt; Int</code></p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1449311588, "post_id": 34103595, "comment_id": 55958924, "body": "Unfortunatley, monads don&#39;t compose. You&#39;ve discovered a <a href=\"https://hackage.haskell.org/package/transformers-0.4.3.0/docs/Control-Monad-Trans-Error.html\" rel=\"nofollow noreferrer\">Monad Transformer</a>"}, {"owner": {"reputation": 1056, "user_id": 1268085, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ff2b99da4e49f13c53b2f718649fc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Yogesh Sajanikar", "link": "https://stackoverflow.com/users/1268085/yogesh-sajanikar"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1449339461, "post_id": 34103595, "comment_id": 55968069, "body": "It seems hedis-simple defines RedisTx in such a way that it is not possible to write monad instance for it. I wonder if simpler design decisions were possible to make."}], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 3, "last_activity_date": 1449311545, "last_edit_date": 1495535233, "creation_date": 1449311545, "answer_id": 34103808, "question_id": 34103595, "link": "https://stackoverflow.com/questions/34103595/defining-monad-of-nested-monads/34103808#34103808", "title": "Defining Monad of nested monads", "body": "<p>The type of your <code>&gt;&gt;=</code> function should be</p>\n\n<pre><code>Outer a -&gt; (a -&gt; Outer b) -&gt; Outer b\n</code></pre>\n\n<p>Since you only have an <code>a</code> in the case where the <code>Outer</code> value is <code>(Right (Just x))</code> for some <code>x</code> you can do:</p>\n\n<pre><code>instance Monad Outer where\n  return = pure\n  (Outer l) &gt;&gt;= f = case l of\n    Left e -&gt; Outer (Left e)\n    Right Nothing -&gt; Outer (Right Nothing)\n    Right (Just x) -&gt; f x\n</code></pre>\n\n<p>As for your second question, you can't. Given two monads <code>M</code> and <code>N</code> their composition <code>M N</code> cannot be automatically be made into a monad. See <a href=\"https://stackoverflow.com/questions/7040844/applicatives-compose-monads-dont\">this question</a> for more details.</p>\n"}], "owner": {"reputation": 1056, "user_id": 1268085, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ff2b99da4e49f13c53b2f718649fc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Yogesh Sajanikar", "link": "https://stackoverflow.com/users/1268085/yogesh-sajanikar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 34103808, "answer_count": 1, "score": 1, "last_activity_date": 1449311545, "creation_date": 1449310029, "question_id": 34103595, "link": "https://stackoverflow.com/questions/34103595/defining-monad-of-nested-monads", "title": "Defining Monad of nested monads", "body": "<p>I am trying to define an instance of a monad for a type, which is defined as follows:</p>\n\n<pre><code>type Error a = Either String a\ndata Outer a = Outer { fromOuter :: Error (Maybe a) } \n</code></pre>\n\n<p><em>Functors</em> and <em>Applicative</em> instances for the <strong>Outer</strong> type can be defined as:</p>\n\n<pre><code>instance Functor Outer where\n    f `fmap` (Outer fa) = Outer $ fmap (fmap f) $ fa \n\n\ninstance Applicative Outer where\n     pure = Outer . pure . pure\n     (Outer l) &lt;*&gt; (Outer r) = Outer $ do\n                             el &lt;- l\n                             er &lt;- r\n                             return $ el &lt;*&gt; er\n</code></pre>\n\n<p>However, I am struggling to define <strong>bind</strong> for defining <em>Monad</em> instance for this type:</p>\n\n<pre><code>instance Monad Outer where\n    return = pure\n    (Outer l) &gt;&gt;= f = ??????\n</code></pre>\n\n<p>Further question is:</p>\n\n<p>How the above can be generalised to, say,</p>\n\n<pre><code>data Outer m n a = Outer { fromOuter :: m (n a) }\n</code></pre>\n\n<p><em>This problem is an abstraction of a issue in <a href=\"https://hackage.haskell.org/package/hedis-simple-0.1.0.0\" rel=\"nofollow\">hedis-simple</a> where I am trying to define Monad instance for <a href=\"https://hackage.haskell.org/package/hedis-simple-0.1.0.0/docs/Database-Redis-Simple.html#t:RedisTx\" rel=\"nofollow\">RedisTx</a></em></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449304218, "post_id": 34102677, "comment_id": 55957184, "body": "This code is very old so it probably won&#39;t compile anyways. If you really want to try to run it, you&#39;ll have to expose the package: <code>ghc-pkg expose haskell98</code> ."}, {"owner": {"reputation": 87, "user_id": 3181073, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/100002558462642/picture?type=large", "display_name": "Fantoma Din Umbra", "link": "https://stackoverflow.com/users/3181073/fantoma-din-umbra"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449304488, "post_id": 34102677, "comment_id": 55957247, "body": "Now I get another error ghci Dice.hs GHCi, version 7.6.3: <a href=\"http://www.haskell.org/ghc/\" rel=\"nofollow noreferrer\">haskell.org/ghc</a>  :? for help Loading package ghc-prim ... linking ... done. Loading package integer-gmp ... linking ... done. Loading package base ... linking ... done.  Top level:     Ambiguous interface for `Prelude&#39;:       it was found in multiple packages: base haskell98-2.0.0.2"}], "owner": {"reputation": 87, "user_id": 3181073, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/100002558462642/picture?type=large", "display_name": "Fantoma Din Umbra", "link": "https://stackoverflow.com/users/3181073/fantoma-din-umbra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449302491, "creation_date": 1449302491, "question_id": 34102677, "link": "https://stackoverflow.com/questions/34102677/haskell-pfp-library-problems", "title": "Haskell PFP library problems", "body": "<p>I am trying to run these <a href=\"http://web.engr.oregonstate.edu/~erwig/pfp/\" rel=\"nofollow\">examples</a> using their <a href=\"http://web.engr.oregonstate.edu/~erwig/pfp/pfp-jun06.tar.gz\" rel=\"nofollow\">library</a>. When I run the command ghci Dice.hs, even if I am in the same folder with Dice.hs it tells </p>\n\n<pre><code>$ ghci Dice.hs\nGHCi, version 7.6.3: http://www.haskell.org/ghc/  :? for help\nLoading package ghc-prim ... linking ... done.\nLoading package integer-gmp ... linking ... done.\nLoading package base ... linking ... done.\n\nProbability.hs:5:8:\n    Could not find module `Monad'\n    It is a member of the hidden package `haskell98-2.0.0.2'.\n    Use -v to see a list of the files searched for.\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I also installed <code>mtl</code> package with Cabal. Other ideas?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1449304395, "post_id": 34102268, "comment_id": 55957222, "body": "You cannot write a <code>Monad</code> instance and have a class constraint which would allow you to get value-level information about a type in the bind function - you <i>can</i> but you must change the specification of <code>Monad</code>, obviously. If you just need do notation, maybe you should look into <code>RebindableSyntax</code>."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 2, "creation_date": 1449326507, "post_id": 34102268, "comment_id": 55963480, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/11599685/whats-the-current-status-of-restricted-monads\">What&#39;s the current status of restricted monads?</a>."}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449299013, "creation_date": 1449299013, "question_id": 34102268, "link": "https://stackoverflow.com/questions/34102268/defining-a-monad-with-function-depending-on-type-of-second-argument-of-bind", "title": "Defining a Monad with function depending on type of second argument of bind", "body": "<p>There's a Monad I'm trying to define, lets call it <code>MyData</code>.</p>\n\n<p>Inside <code>MyData</code> there's some IO actions going on, there's a function <code>runMyMonad</code> that executes them.</p>\n\n<p>Naturally I have to define <code>&gt;&gt;=</code>, with the following type signature:</p>\n\n<pre><code>instance Monad MyData ...\n(&gt;&gt;=) :: MyData a -&gt; (a -&gt; MyData b) -&gt; MyData b\n</code></pre>\n\n<p>I'd particularly like to define a Monad because I'd like users to be able to use \"do\" notation.</p>\n\n<p>The thing is, to actually do what I want to do, I need to know some information that entirely depends on the type of <code>b</code>. Like the following:</p>\n\n<pre><code>myfunc (undefined :: b)\n</code></pre>\n\n<p>I could create a type class like so, but then there's a problem, my Monad no longer works because Monad requires <code>a</code> and <code>b</code> to be unrestricted.</p>\n\n<p>I could create <code>MyData</code> like the following:</p>\n\n<pre><code>data MyData a where\n  MyData :: (MyTypeClass a) =&gt; a -&gt; a -&gt; MyData a\n</code></pre>\n\n<p>Or something similar. That way when I pattern match on it, I get the typeclass for free. But I can only see this working on the first argument of <code>&gt;&gt;=</code>, as the second is wrapped up in a function. </p>\n\n<p>So this is what I want to do:</p>\n\n<p>a) Be able to apply a function that depends only on the type <code>b</code> in <code>&gt;&gt;=</code>.<br>\nb) Be able to use <code>do</code> notation.<br>\nc) Not affect other uses of <code>Monad</code>.</p>\n\n<p>Any ideas will be appreciated.</p>\n"}, {"tags": ["multithreading", "haskell", "parallel-processing"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449314899, "post_id": 34101203, "comment_id": 55959878, "body": "Not sure if relevant: the <code>solve = ...</code> global non-function binding is possibly keeping a large result list from being garbage collected."}, {"owner": {"reputation": 199, "user_id": 4661077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dcbd3ec5da8eba82a74ca4d28f9a5622?s=128&d=identicon&r=PG&f=1", "display_name": "jimpudar", "link": "https://stackoverflow.com/users/4661077/jimpudar"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449329237, "post_id": 34101203, "comment_id": 55964309, "body": "Thanks for the suggestion chi, I deleted the <code>solve</code> non-function and ran it again on 1,2, and 4 processors but didn&#39;t see any change in runtime or threadscope images. For reference, my new <code>main</code> function reads <code>main = do   print $ fromJust $ find isJust $ parMap rpar (subsetSum numbers) [n,n-1 .. 1]     where n = (length numbers)</code>"}], "owner": {"reputation": 199, "user_id": 4661077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dcbd3ec5da8eba82a74ca4d28f9a5622?s=128&d=identicon&r=PG&f=1", "display_name": "jimpudar", "link": "https://stackoverflow.com/users/4661077/jimpudar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1449289013, "creation_date": 1449289013, "question_id": 34101203, "link": "https://stackoverflow.com/questions/34101203/multithreaded-subset-sum-with-haskell-parallel-strategies", "title": "Multithreaded Subset Sum with Haskell Parallel Strategies", "body": "<p>I am attempting to use <code>Parallel.Strategies</code> to parallelize my subset sum solver, and need a little help understanding what is happening.</p>\n\n<h2>The Problem</h2>\n\n<p>Find the subset of numbers in <code>numbers :: [Int]</code> which sum to <code>100000000</code>.</p>\n\n<p>Single-threaded solution:</p>\n\n<pre><code>import Data.List (find)\nimport Data.Maybe (fromJust, isJust)\n\nnumbers = [14920416,14602041,14088921,13371291,13216099,12153625,10896437\n          ,10884343,10228468,10177453,9998564,9920883,9511265,8924305\n          ,8452302,8103727,7519471,7043381,7028847,6418450,6222190,6215767\n          ,6190960,5514135,4798322,3823984,3247980,837289] :: [Int]\n\nsubsequencesOfSize :: Int -&gt; [Int] -&gt; [[Int]]\nsubsequencesOfSize n xs = let l = length xs\n                          in if n&gt;l then [] else subsequencesBySize xs !! (l-n)\n  where\n    subsequencesBySize [] = [[[]]]\n    subsequencesBySize (x:xs) = let next = subsequencesBySize xs\n                                in zipWith (++) ([]:next) (map (map (x:)) next ++ [[]])\n\nsubsetSum :: [Int] -&gt; Int -&gt; Maybe [Int] \nsubsetSum seq n = find ((==target) . sum) (subsequencesOfSize n seq)\n  where target = 100000000\n\nsolve = map (subsetSum numbers) [n,n-1 .. 1]\n  where n = (length numbers)\n\nmain = do\n  print $ fromJust $ find isJust solve\n</code></pre>\n\n<h2>Parallel Strategy</h2>\n\n<p>Since I am calculating the subsets of size n separately already, I figured I could just use <code>parMap</code> to spawn calculation of each list of subsets of size n simultaneously. I replaced the <code>map</code> in the <code>solve</code> function like this:</p>\n\n<pre><code>import Control.Parallel.Strategies\n\nsolve = parMap rpar (subsetSum numbers) [n,n-1 .. 1]\n  where n = (length numbers)\n</code></pre>\n\n<h3>Single Core</h3>\n\n<pre><code>newproblem +RTS -p -N1 -RTS\n\n    total time  =       35.05 secs   (35047 ticks @ 1000 us, 1 processor)\n    total alloc = 22,628,052,232 bytes  (excludes profiling overheads)\n\nCOST CENTRE                           MODULE  %time %alloc\n\nsubsetSum                             Main     86.6   24.5\nsubsequencesOfSize.subsequencesBySize Main     11.0   75.5\nsolve                                 Main      2.4    0.0\n</code></pre>\n\n<h3>Two Cores</h3>\n\n<pre><code>        newproblem +RTS -p -N2 -RTS\n\n    total time  =       28.80 secs   (57590 ticks @ 1000 us, 2 processors)\n    total alloc = 26,537,237,440 bytes  (excludes profiling overheads)\n\nCOST CENTRE                           MODULE  %time %alloc\n\nsubsetSum                             Main     70.2   21.4\nsubsequencesOfSize.subsequencesBySize Main     28.8   78.6\n</code></pre>\n\n<h3>Four Cores</h3>\n\n<pre><code>       newproblem +RTS -p -N4 -RTS\n\n    total time  =       26.68 secs   (106727 ticks @ 1000 us, 4 processors)\n    total alloc = 35,925,142,744 bytes  (excludes profiling overheads)\n\nCOST CENTRE                           MODULE  %time %alloc\n\nsubsetSum                             Main     68.2   22.4\nsubsequencesOfSize.subsequencesBySize Main     30.8   77.6\n</code></pre>\n\n<h3><a href=\"http://i.imgur.com/DJbZfEI.png\" rel=\"nofollow\">threadscope comparisons</a></h3>\n\n<p>As you can see, the program does run quite a bit faster with 2 or 4 cores than on a single core. However, I do not believe the lists of subsets of size n are being handled by separate processors as I intended.</p>\n\n<p>Looking at the threadscopes, it seems to me as if each \"bump\" in processor activity is the calculation on each subset of size n. I expected not a reduction in the runtime of each \"bump\", but \"bumps\" spawned in parallel across each processor. However, the former description is more accurate than the latter.</p>\n\n<p>What is happening here? Where are the speedups coming from? Why is there so much garbage collection happening in between subset calculations?</p>\n\n<p>Thanks in advance for any enlightenment whatsoever :D </p>\n"}, {"tags": ["perl", "haskell", "io"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449288781, "post_id": 34101020, "comment_id": 55954252, "body": "I cannot reproduce this, the code executes as expected on my machine. How exactly are you compiling and running it? Also, make your program print out each process ID and wait on each process.. Does it work if you hard code 2 processes? <code>forkIO (sleep 1) &gt;&gt; forkIO (sleep 2)</code>"}, {"owner": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1449289008, "post_id": 34101020, "comment_id": 55954296, "body": "@user2407038 I am running GHC version 7.8.4 on (X)Ubuntu 15.04. What are you using?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1449314598, "post_id": 34101020, "comment_id": 55959781, "body": "Unrelated to the actual issue: in Haskell you can also use one of <code>sequence</code>, <code>mapM</code>, <code>forM</code> or their <code>..._</code> variants instead of <code>foldr1 (&gt;&gt;) [...]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "edited": false, "score": 0, "creation_date": 1449295977, "post_id": 34101772, "comment_id": 55955525, "body": "So if the presence of active threads isn&#39;t sufficient to prevent the program from exiting, what is the condition?  I take it if I wanted to use threads, I would have to keep track of their <code>id</code>s and add an explicit wait."}, {"owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "reply_to_user": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "edited": false, "score": 0, "creation_date": 1449297177, "post_id": 34101772, "comment_id": 55955757, "body": "Depending on what you\u2019re doing, you can use <code>threadDelay</code> to wait 0.5 seconds at the end of your program (dirty) assuming the threads creation is very fast. Or you can follow the Terminating The Program section on <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Concurrent.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.8.1.0/docs/&hellip;</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "edited": false, "score": 0, "creation_date": 1449314441, "post_id": 34101772, "comment_id": 55959722, "body": "@GregoryNisbet IIRC, as soon as the main thread exits, the other ones are terminated. Adding explicit waits would prevent that."}], "tags": [], "owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "is_accepted": true, "score": 3, "last_activity_date": 1449294659, "creation_date": 1449294659, "answer_id": 34101772, "question_id": 34101020, "link": "https://stackoverflow.com/questions/34101020/second-of-several-forked-processes-does-not-run-in-haskell-ghc-7-8-4/34101772#34101772", "title": "Second of several forked processes does not run in Haskell (GHC 7.8.4)", "body": "<p>I have been able to reproduce this with GHC 7.10.2.</p>\n\n<p>The Haskell and Perl versions are not strictly equivalent. The Perl version will create process after process, waiting the previous one to be launched (not finished).</p>\n\n<p>The Haskell version will create several threads, each one launching one process.</p>\n\n<p>Since you do not wait for your threads to finish launching their process, some threads will fail because your program ends too quickly. Thread execution in the Haskell runtime is not random, therefore your program will (generally) exhibit the same behavior again and again on your machine.</p>\n\n<p>You can also try to increase the number of processes to see what happens. With 14 processes, the 13th process is not launched (on my configuration).</p>\n\n<p>If you remove the <code>forkIO</code> call, your program will work just fine:</p>\n\n<pre><code>import System.Process (createProcess, proc, shell, CreateProcess)\nimport Text.Printf (printf, PrintfArg)\nimport Control.Monad (void)\n\nsleep :: Integer -&gt; CreateProcess\nsleep x = shell (printf \"sleep %d; echo %d\" x x)\n\nmain = foldr1 (&gt;&gt;)\n              [ void $ createProcess task\n              | task &lt;- fmap sleep [1..5]\n              ]\n</code></pre>\n"}], "owner": {"reputation": 5900, "user_id": 931154, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/bTrZd.jpg?s=128&g=1", "display_name": "Gregory Nisbet", "link": "https://stackoverflow.com/users/931154/gregory-nisbet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 34101772, "answer_count": 1, "score": 2, "last_activity_date": 1449294659, "creation_date": 1449287173, "last_edit_date": 1449290024, "question_id": 34101020, "link": "https://stackoverflow.com/questions/34101020/second-of-several-forked-processes-does-not-run-in-haskell-ghc-7-8-4", "title": "Second of several forked processes does not run in Haskell (GHC 7.8.4)", "body": "<p>I have a simple Haskell program that forks off several processes, each of which sleeps for a certain number of seconds and then echos. Regardless of how many processes I fork, the second one does not seem to output any visible content to the terminal.</p>\n\n<pre><code>import System.Process (createProcess, proc, shell, CreateProcess)\nimport Text.Printf (printf, PrintfArg)\nimport Control.Concurrent (forkIO)\nimport Control.Monad (void)\n\nsleep :: Integer -&gt; CreateProcess\nsleep x = shell (printf \"sleep %d; echo %d\" x x)\n-- sleep x = shell (printf \"sleep %d, echo %d, touch %d.haskell\" x x x)\n\nmain = foldr1 (&gt;&gt;) $ [\n  forkIO $ void $ createProcess task |\n  task &lt;- [ sleep 1, sleep 2, sleep 3, sleep 4, sleep 5] ]\n</code></pre>\n\n<p>produces</p>\n\n<pre><code>./scheduler \nuser@name-of-computer $ 1\n3\n4\n5\n</code></pre>\n\n<p>And if you run it with the commented line instead of just printing, you can see</p>\n\n<pre><code>$ 1.haskell  4.haskell\n3.haskell  5.haskell\n</code></pre>\n\n<p>This behavior also seems to be specific to Haskell. Perl does not exhibit it.</p>\n\n<pre><code>use strict;\nuse warnings FATAL =&gt; 'all';\n\nsub sleep_echo {\n  my ($second_count) = @_;\n  my $cpid = fork;\n  if ($cpid == 0) {\n    exec \"sleep $second_count; echo $second_count\";\n  }\n}\n\nfor (my $i = 1; $i &lt;= 5; $i++) {\n  sleep_echo($i);\n}\n</code></pre>\n\n<p>prints </p>\n\n<pre><code>user@name-of-computer $ 1\n2\n3\n4\n5\n</code></pre>\n\n<p>Any ideas as to what's going on?</p>\n"}, {"tags": ["haskell", "currying", "wxhaskell"], "answers": [{"comments": [{"owner": {"reputation": 2108, "user_id": 2200817, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4c13d246cf5226bf581cbfd451d9a50d?s=128&d=identicon&r=PG", "display_name": "allidoiswin", "link": "https://stackoverflow.com/users/2200817/allidoiswin"}, "edited": false, "score": 0, "creation_date": 1449376049, "post_id": 34101066, "comment_id": 55977744, "body": "This still requires me to define my parameters in main. I would like to define my parameters once, forever, outside of main, so I can call foo with those parameters anywhere, perhaps with something like <code>bar foo myOpts</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 2108, "user_id": 2200817, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4c13d246cf5226bf581cbfd451d9a50d?s=128&d=identicon&r=PG", "display_name": "allidoiswin", "link": "https://stackoverflow.com/users/2200817/allidoiswin"}, "edited": false, "score": 1, "creation_date": 1449422352, "post_id": 34101066, "comment_id": 55989369, "body": "You can absolutely define your parameters as a top level value which you may use from anywhere. I see absolutely no reason that <code>myParams</code> must be a local definition inside of main - I just happened to give 4 examples where it was the case. You then call your function with <code>bar myParams</code>, just the same as above."}, {"owner": {"reputation": 2108, "user_id": 2200817, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4c13d246cf5226bf581cbfd451d9a50d?s=128&d=identicon&r=PG", "display_name": "allidoiswin", "link": "https://stackoverflow.com/users/2200817/allidoiswin"}, "edited": false, "score": 0, "creation_date": 1449455884, "post_id": 34101066, "comment_id": 55999734, "body": "Oops. Brainfart. Apparently we can use NamedFieldPuns to pattern-match record fields easier: <a href=\"https://twitter.com/haskelltips/status/432255638849064960\" rel=\"nofollow noreferrer\">twitter.com/haskelltips/status/432255638849064960</a>"}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 2, "last_activity_date": 1449287548, "creation_date": 1449287548, "answer_id": 34101066, "question_id": 34100871, "link": "https://stackoverflow.com/questions/34100871/given-a-function-g-a-b-z-how-can-i-use-it-like-h-a-b/34101066#34101066", "title": "Given a function g :: a -&gt; b -&gt; .... -&gt; z, how can I use it like h :: (a, b, ...) -&gt; z?", "body": "<p>It seems like you would naturally like the input to this function to be a record of parameters:</p>\n\n<pre><code>{-# LANGUAGE RecordWildCards #-} \n\n-- Defined by your library \nfoo :: String -&gt; Int -&gt; IO () \nfoo = ... \n\ndata Opts = Opts { optString :: String, optInt :: Int } \nbar :: Opts -&gt; IO () \nbar Opts{..} = foo optString optInt \n</code></pre>\n\n<p>Now, you can use any of the following equivalent syntaxes (some use RecordWildCards):</p>\n\n<pre><code>main = do \n  let optString = &lt;...&gt;\n      optInt    = &lt;...&gt;\n  bar Opts{..} \n\nmain = do \n  let x = &lt;...&gt;\n      y = &lt;...&gt;\n      myParams = Opts x y \n  bar myParams \n\nmain = do \n  bar $ Opts \n    { optString = &lt;...&gt; \n    , optInt    = &lt;...&gt; \n    } \n\nmain = do \n  let optString = &lt;...&gt;\n      optInt    = &lt;...&gt;\n      myParams  = Opts{..} \n  bar myParams \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 559, "user_id": 3389669, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6a013398fd6031b9d738643f8c75b7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user3389669", "link": "https://stackoverflow.com/users/3389669/user3389669"}, "is_accepted": false, "score": 1, "last_activity_date": 1449345709, "creation_date": 1449345709, "answer_id": 34110214, "question_id": 34100871, "link": "https://stackoverflow.com/questions/34100871/given-a-function-g-a-b-z-how-can-i-use-it-like-h-a-b/34110214#34110214", "title": "Given a function g :: a -&gt; b -&gt; .... -&gt; z, how can I use it like h :: (a, b, ...) -&gt; z?", "body": "<p>There is also the (less clean) possibility of writing an <code>uncurry</code> variant (see <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:uncurry\" rel=\"nofollow\">here</a>) having more arguments:</p>\n\n<pre><code>uncurry6 :: (a -&gt; b -&gt; c -&gt; d -&gt; e -&gt; f -&gt; g) -&gt; ((a,b,c,d,e,f) -&gt; g)\nuncurry6 fun (a,b,c,d,e,f) = fun a b c d e f \n</code></pre>\n\n<p>Having that, <code>uncurry6 fileOpenDialog</code> will make <code>fileOpenDialog</code> accept a 6-tuple.</p>\n"}], "owner": {"reputation": 2108, "user_id": 2200817, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4c13d246cf5226bf581cbfd451d9a50d?s=128&d=identicon&r=PG", "display_name": "allidoiswin", "link": "https://stackoverflow.com/users/2200817/allidoiswin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1449345709, "creation_date": 1449285565, "last_edit_date": 1449297979, "question_id": 34100871, "link": "https://stackoverflow.com/questions/34100871/given-a-function-g-a-b-z-how-can-i-use-it-like-h-a-b", "title": "Given a function g :: a -&gt; b -&gt; .... -&gt; z, how can I use it like h :: (a, b, ...) -&gt; z?", "body": "<p>Background: I'm working with wxHaskell's fileOpenDialog, which takes 6 non-obvious parameters (curried). My code is currently:</p>\n\n<pre><code>maybePath &lt;- fileOpenDialog w useLastSelectedDir canSelectReadOnly\n                frameName possibleFiles initialDir defaultFilename\n</code></pre>\n\n<p>with a <code>let</code> statement above that to define all my parameters. What I would love to do though, is save my parameters somewhere. I somewhat understand why Haskell would't support something like say:</p>\n\n<pre><code>myParams = ( ... ) -- tuple of params\nmaybePath &lt;- fileOpenDialog myParams\n</code></pre>\n\n<p>However, is there something close to this in the spirit of not repeating myself?</p>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1449265247, "post_id": 34097869, "comment_id": 55947904, "body": "What would you want your arbitrary random generator to be? Would <code>mkStdGen 0</code> or something like that, with a known seed, work for you?"}, {"owner": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "reply_to_user": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1449265320, "post_id": 34097869, "comment_id": 55947939, "body": "I don&#39;t think mkStdGen 0 would be sufficiently random ..."}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 2, "creation_date": 1449266979, "post_id": 34097869, "comment_id": 55948695, "body": "Then how about <code>instance Arbitrary StdGen where   arbitrary = do seed &lt;- arbitrary; return $ mkStdGen seed</code>?"}, {"owner": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "reply_to_user": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1449267621, "post_id": 34097869, "comment_id": 55948984, "body": "That works, what about shrink? stdGen not exactly a num ..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1449268672, "post_id": 34097869, "comment_id": 55949404, "body": "The default <code>shrink</code>, i.e. <code>const []</code>, should be OK, I guess. So it&#39;s just <code>arbitrary = mkStdGen &lt;$&gt; arbitrary</code>."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1449271733, "post_id": 34097869, "comment_id": 55950479, "body": "What would be the purpose of having an arbitrary <code>StdGen</code>?"}, {"owner": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1449282289, "post_id": 34097869, "comment_id": 55953022, "body": "@ReinHenrichs good question, I&#39;m sure if I&#39;m using it the right way. But I like to quickCheck a function that takes in a StdGen as a parameter, I could just explicitly pass in some seed :: StdGen. Does that make more sense than generating an arbitrary instance of it?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1449337388, "post_id": 34097869, "comment_id": 55967248, "body": "The issue with having an instance n the &quot;standard library&quot; is that there is no such library.  If the instance goes in the random package then that package now must depend on quick check.  If the instances went in quick check the dep goes the other way.  Or you can make an orpaned instance in another library, but those are frowned upon."}], "owner": {"reputation": 4310, "user_id": 1128571, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e743815e7a4a5f8c1d66277d6397624f?s=128&d=identicon&r=PG", "display_name": "xiaolingxiao", "link": "https://stackoverflow.com/users/1128571/xiaolingxiao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1449265005, "creation_date": 1449265005, "question_id": 34097869, "link": "https://stackoverflow.com/questions/34097869/arbitrary-instance-for-stdgen", "title": "Arbitrary instance for StdGen", "body": "<p>Please define:</p>\n\n<pre><code>instance Arbitrary StdGen where\n  arbitrary = undefined\n  shrink    = undefined\n</code></pre>\n\n<p>Why is this not defined in the standard library? Are there some pitfalls I should avoid, is it even possible?</p>\n"}, {"tags": ["haskell", "template-haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1449269328, "post_id": 34097332, "comment_id": 55949673, "body": "Since <code>c</code> is only ever applied to <code>a</code>, it would probably be better to write <code>class (Eq c, Monoid c) =&gt; Collection c a | c -&gt; a where emptyColl :: c -&gt; Bool</code> and so forth for the other methods. This way <code>a</code> need not be the last argument (or an argument at all) of the collection type."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1449269564, "post_id": 34097332, "comment_id": 55949780, "body": "Also, syntactic issues aside, I suspect you will have trouble implementing an <code>fmap</code>-alike, since <code>fmap</code> changes the contained type (without constraint on what the new contained type is) and none of your methods can do that in a uniform way. e.g. it seems reasonable to expect that <code>Data.Set.Set</code> could implement <code>Collection</code>, and it is a perfectly reasonable functor, but it cannot be made an instance of <code>Functor</code>."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1449270004, "creation_date": 1449270004, "answer_id": 34098924, "question_id": 34097332, "link": "https://stackoverflow.com/questions/34097332/haskell-gen-instance-of-b-when-class-a-provides-enough-info-for-class-b/34098924#34098924", "title": "Haskell, Gen instance of B when class A provides enough info for class B", "body": "<p>The standard trick for this is to give implementations of the appropriate functions and let users write their own instances. For example, you might write</p>\n\n<pre><code>fmapColl :: (Collection c a, Collection c b) =&gt; (a -&gt; b) -&gt; c a -&gt; c b\nfmapColl f ca\n    | emptyColl ca = mkEmptyColl -- you don't have this in your class, but probably should\n    | otherwise = case splitColl ca of\n        (a, ca') -&gt; f a &gt;|&lt; fmapColl f ca'\n</code></pre>\n\n<p>Assuming we had a suitable type class, say, <code>CFunctor</code>:</p>\n\n<pre><code>class CFunctor f where\n    type ConstraintI f\n    type ConstraintO f\n    cfmap :: (ConstraintI i, ConstraintO o) =&gt; (i -&gt; o) -&gt; f i -&gt; f o\n</code></pre>\n\n<p>Then for a given <code>Collection</code> instance like <code>Set</code> we could instantiate <code>CFunctor</code> with minimal actual code like this:</p>\n\n<pre><code>instance CFunctor Set where\n    type ConstraintI Set = Ord\n    type ConstraintO Set = Ord\n    cfmap = fmapColl\n</code></pre>\n\n<p>You can see this pattern -- defining a \"default\" implementation for users to put in their instances -- in the <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Traversable.html#v:fmapDefault\" rel=\"nofollow\">base library's <code>fmapDefault</code></a>, for example.</p>\n"}], "owner": {"reputation": 33, "user_id": 5334338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec69090a30d721f883096767ba5101b?s=128&d=identicon&r=PG&f=1", "display_name": "jpostma1", "link": "https://stackoverflow.com/users/5334338/jpostma1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1449270004, "creation_date": 1449262741, "last_edit_date": 1449264176, "question_id": 34097332, "link": "https://stackoverflow.com/questions/34097332/haskell-gen-instance-of-b-when-class-a-provides-enough-info-for-class-b", "title": "Haskell, Gen instance of B when class A provides enough info for class B", "body": "<p>While writing a class for a Collection/Container type (btw point me towards existing types if i'm reinventing the wheel) to provide a general interface for adding and removing elements from any 'Collection' type. </p>\n\n<pre><code>class (Eq (c a), Monoid (c a)) =&gt; Collection c a where\n  emptyColl   :: c a -&gt; Bool\n  splitColl   :: c a -&gt; (a, c a)\n  toColl      :: a -&gt; c a\n  size        :: c a -&gt; Int\n  combineColl :: a -&gt; c a -&gt; c a\n  (&gt;|&lt;)       :: a -&gt; c a -&gt; c a\n  a &gt;|&lt; c     =  combineColl a c\n</code></pre>\n\n<p>I noticed instances of Collection could also be instances of Foldable. Using splitColl and emptyColl. So you don't need to write a Foldable as well, if you make constructs like this over several classes a significant amount of time, writing trivial instances, can be saved.</p>\n\n<p>I tried to make Collection an instance of Foldable. However classes can't seem to be instantiated from other classes do they? \nI received the following error messages:</p>\n\n<pre><code>instance Functor (Collection c) where\n\nThe first argument of \u2018Functor\u2019 should have kind \u2018* -&gt; *\u2019,\n  but \u2018Collection c\u2019 has kind \u2018* -&gt; GHC.Prim.Constraint\u2019\nIn the instance declaration for \u2018Functor (Collection c)\u2019 \n\ninstance Functor (Collection c a) where\n\n The first argument of \u2018Functor\u2019 should have kind \u2018* -&gt; *\u2019,\n  but \u2018Collection c a\u2019 has kind \u2018GHC.Prim.Constraint\u2019\nIn the instance declaration for \u2018Functor (Collection c a)\u2019\n</code></pre>\n\n<p>How could I get the desired functionality? I think template Haskell might be the way to go here, I never used it tho, an example would be great :)</p>\n\n<p>Thanks in advance! </p>\n\n<p>PS: I've been writing haskell for about a year, minor tips that come to mind are much appreciated</p>\n"}, {"tags": ["haskell", "frp", "reactive-banana"], "comments": [{"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "edited": false, "score": 0, "creation_date": 1449350226, "post_id": 34096402, "comment_id": 55971780, "body": "If there were a special version of <code>accumB</code>, then it would no longer be possible to freely use Behavior and Event in mutual recursion. Could you elaborate on the particular programming problem that you have in mind? Chances are that <code>accumE</code> may help."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "reply_to_user": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "edited": false, "score": 0, "creation_date": 1449390353, "post_id": 34096402, "comment_id": 55980247, "body": "@HeinrichApfelmus I&#39;ve updated my question."}], "answers": [{"tags": [], "owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "is_accepted": true, "score": 1, "last_activity_date": 1449413337, "creation_date": 1449413337, "answer_id": 34118685, "question_id": 34096402, "link": "https://stackoverflow.com/questions/34096402/getting-updates-from-accumb-without-delay/34118685#34118685", "title": "Getting updates from accumB without delay", "body": "<p>If you have a <code>Behavior Conf</code>, then you can make other Behaviors from it via the <code>Applicative</code> class combinators. For instance, it may be that you turn it into a <code>Behavior String</code> which is then displayed in a text field. Once you feed a Behavior to such an UI widget, the widget code makes sure that the <em>new</em> value of the Behavior is displayed.</p>\n\n<p>If you need an explicit indication of when the configuration has changed, then an <code>Event Conf</code> may be more appropriate. You can use the <code>accumE</code> function for that, it will contain the <em>new</em> value.</p>\n"}], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 2, "accepted_answer_id": 34118685, "answer_count": 1, "score": 2, "last_activity_date": 1449413337, "creation_date": 1449258916, "last_edit_date": 1449390346, "question_id": 34096402, "link": "https://stackoverflow.com/questions/34096402/getting-updates-from-accumb-without-delay", "title": "Getting updates from accumB without delay", "body": "<p>THe documentation for <code>accumB</code> says:</p>\n\n<blockquote>\n  <p>Note: As with stepper, the value of the behavior changes \"slightly\n  after\" the events occur. This allows for recursive definitions.</p>\n</blockquote>\n\n<p>In my case there is no recursion, but i want to get updates \"right now\", not \"slightly after\". Why there is no special version of <code>accumB</code>? I guess, i'm missing something obvious?</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> In my application I have <code>data Config</code>, which holds various configuration values and a bunch of <code>Event (Config -&gt; Config)</code>, which are fired when user changes some value in GUI. Now, i want other parts of my program to access <code>Config</code> whenever they want, that's why i used <code>Behavior Config</code> there. The problem is that when changing event is fired, the behavior still has old value of <code>Config</code>, so i can't observe this change immediately.</p>\n"}, {"tags": ["json", "haskell", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1449261731, "post_id": 34096735, "comment_id": 55946252, "body": "this is brilliant and your explanations are very clear. Thanks again."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 2, "last_activity_date": 1449260233, "creation_date": 1449260233, "answer_id": 34096735, "question_id": 34096394, "link": "https://stackoverflow.com/questions/34096394/parsing-decoded-json-in-haskell/34096735#34096735", "title": "Parsing decoded JSON in Haskell", "body": "<p>For this problem I would turn to the <code>lens</code> library.  While this is a rather large dependency, it can be very useful for drilling down into your data.  Be warned, <code>lens</code> is a beast powered by a lot of mathematics that is usually beyond the layperson, but in a lot of cases it's one of those libraries that \"just works\".  In order to make it work easily (i.e. without having to write all the lenses yourself) you need the <code>TemplateHaskell</code> extension and you'll need to change all of your types so that their fields start with an underscore, so</p>\n\n<pre><code>data Response = Response\n    { _response :: [Body]\n    } deriving (Show)\n</code></pre>\n\n<p>and so on for your other types.  Your JSON parsing will be fine, though.</p>\n\n<p>Then you need to just import <code>Control.Lens</code>.  One caveat is that it exports a type called <code>Identity</code> that will clash with yours so</p>\n\n<pre><code>import Control.Lens hiding (Identity)\n</code></pre>\n\n<p>Then at the bottom of the file just place the following lines</p>\n\n<pre><code>makeLenses ''Response\nmakeLenses ''Body\nmakeLenses ''Identity\nmakeLenses ''Stock\nmakeLenses ''Weight\nmakeLenses ''Dimensions\nmakeLenses ''FinancialDetails\nmakeLenses ''TaxCode\nmakeLenses ''Variation\n</code></pre>\n\n<p>This uses template haskell to generate a bunch of functions for you called lenses.  These have a weird type that I won't go into now (there's <a href=\"https://wiki.haskell.org/Lens\" rel=\"nofollow\">plenty of tutorials</a> out there), but all of them will be the same as your field names minus the underscore.</p>\n\n<p>These new functions let you do some pretty crazy things.  For example, if you wanted all of the <code>sku</code>s inside a response you can just do</p>\n\n<pre><code>&gt; -- Unwrap the Maybe here\n&gt; Just json &lt;- decode &lt;$&gt; getJSON\n&gt; toListOf (response.traversed.identity.sku) json\n[\"ABCDEF\", \"CDEFG\"]\n&gt; -- Or as an alternative to toListOf you can use the operator ^..\n&gt; json^..response.traversed.identity.sku\n[\"ABCDEF\", \"CDEFG\"]\n</code></pre>\n\n<p>If you just want to access a field you can use the <code>^.</code> operator, or if you want to index into a list you'll probably also want the <code>^?</code> operator which allows for safe indexing (returns <code>Nothing</code> if you go out of bounds)</p>\n\n<pre><code>&gt; json^?response.ix 0.identity\nJust (Identity {_sku=\"ABCDEF\", _ean=\"111\", _barcode=\"222\"})\n&gt; let Just ident = json^?response.ix 0.identity\n&gt; ident^.sku\n\"ABCDEF\"\n</code></pre>\n\n<p>Of course, you can do all this without resorting to <code>lens</code>.  It could look something like</p>\n\n<pre><code>allSkus :: Response -&gt; [String]\nallSkus r = map (_sku . _identity) $ _response r\n</code></pre>\n\n<p>Which isn't too bad, but what if you wanted to change the value in the first identity?  With <code>lens</code> you can perform sets as well (obviously still working with immutable values):</p>\n\n<pre><code>&gt; let newjson = (response.ix 0.identity.sku .~ \"FOOBAR\") json\n&gt; newjson^..response.traversed.identity.sku\n[\"FOOBAR\", \"CDEFG\"]\n</code></pre>\n\n<p>This is to illustrate how powerful <code>lens</code> can be.  It's a complicated framework, more of its own language inside Haskell and it takes a while to learn, but it can be very good at expressing what you want to do rather than how to do it.</p>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 34096735, "answer_count": 1, "score": 2, "last_activity_date": 1449260233, "creation_date": 1449258892, "question_id": 34096394, "link": "https://stackoverflow.com/questions/34096394/parsing-decoded-json-in-haskell", "title": "Parsing decoded JSON in Haskell", "body": "<p>I would like some help on how to access specific fields once I decode JSON with Aeson. </p>\n\n<p>I would like some tips on the best way to to access a field or list of fields once I am at this point.</p>\n\n<p>For example from below. The data contains descriptions of 2 products. How would I return the 2 <code>sku</code> fields ie <code>[\"ABCDEF\",\"CDEFG\"]</code> or even how to access the entire <code>Identity</code> data type for both products.</p>\n\n<p>My output is:</p>\n\n<p><strong>DECODED JSON</strong></p>\n\n<pre><code>Just (Response {response = [Body {productId = 5555, brandId = 10, productTypeId = 1, identity = Identity {sku = \"ABCDEF\", ean = \"1111\", barcodls {taxable = False, taxCode = TaxCode {taxCodeId = 7, code = \"T1\"}}, variations = [Variation {optionId = 1, optionName = \"option1\", optionVal111221\", barcode = \"2443222\"}, productGroupId = 17, stock = Stock {stockTracked = True, weight = Weight {magnitude = 0.0}, dimensions = Dimensption1\", optionValueId = 5, optionValue = \"5\"},Variation {optionId = 2, optionName = \"option2\", optionValueId = 14, optionValue = \"14\"}]}]})\n</code></pre>\n\n<p>Here is the original JSON</p>\n\n<p><strong>JSON</strong></p>\n\n<pre><code>{\n  \"response\": [\n    {\n      \"id\": 5555,\n      \"brandId\": 10,\n      \"productTypeId\": 1,\n      \"identity\": {\n        \"sku\": \"ABCDEF\",\n        \"ean\": \"1111\",\n        \"barcode\": \"2222\"\n      },\n      \"productGroupId\": 17,\n      \"stock\": {\n        \"stockTracked\": true,\n        \"weight\": {\n          \"magnitude\": 0\n        },\n        \"dimensions\": {\n          \"length\": 0,\n          \"height\": 0,\n          \"width\": 0,\n          \"volume\": 0\n        }\n      },\n      \"financialDetails\": {\n        \"taxable\": false,\n        \"taxCode\": {\n          \"id\": 7,\n          \"code\": \"T1\"\n        }\n      },\n      \"variations\": [\n        {\n          \"optionId\": 1,\n          \"optionName\": \"option1\",\n          \"optionValueId\": 5,\n          \"optionValue\": \"5\"\n        },\n        {\n          \"optionId\": 2,\n          \"optionName\": \"option2\",\n          \"optionValueId\": 14,\n          \"optionValue\": \"OS\"\n        }\n      ]\n    },\n    {\n      \"id\": 9999,\n      \"brandId\": 10,\n      \"productTypeId\": 1,\n      \"identity\": {\n        \"sku\": \"CDEFG\",\n        \"ean\": \"111221\",\n        \"barcode\": \"2443222\"\n      },\n      \"productGroupId\": 17,\n      \"stock\": {\n        \"stockTracked\": true,\n        \"weight\": {\n          \"magnitude\": 0\n        },\n        \"dimensions\": {\n          \"length\": 0,\n          \"height\": 0,\n          \"width\": 0,\n          \"volume\": 0\n        }\n      },\n      \"financialDetails\": {\n        \"taxable\": false,\n        \"taxCode\": {\n          \"id\": 7,\n          \"code\": \"T1\"\n        }\n      },\n      \"variations\": [\n        {\n          \"optionId\": 1,\n          \"optionName\": \"option1\",\n          \"optionValueId\": 5,\n          \"optionValue\": \"5\"\n        },\n        {\n          \"optionId\": 2,\n          \"optionName\": \"option2\",\n          \"optionValueId\": 14,\n          \"optionValue\": \"14\"\n        }\n      ]\n    } \n  ]\n}\n</code></pre>\n\n<p>and here is my code so far:</p>\n\n<p><strong>CODE</strong></p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Data.Aeson \nimport Control.Applicative \nimport qualified Data.ByteString.Lazy.Char8 as BS\n\n\njsonFile :: FilePath\njsonFile = \"test.json\"\n\ngetJSON :: IO BS.ByteString\ngetJSON = BS.readFile jsonFile\n\nmain :: IO ()\nmain = do\n     input &lt;- getJSON\n     let json = decode input :: Maybe Response\n     case json of\n        Nothing -&gt; print \"error parsing JSON\"\n        Just m  -&gt; print json\n\n\ndata Response = Response\n    { response :: [Body]\n    } deriving (Show)\n\ninstance FromJSON Response where\n    parseJSON (Object v) = Response &lt;$&gt; v .: \"response\"\n    parseJSON _ = mempty\n\ndata Body = Body\n    { productId         :: Int\n    , brandId           :: Int\n    , productTypeId     :: Int\n    , identity          :: Identity\n    , productGroupId    :: Int\n    , stock             :: Stock\n    , financialDetails  :: FinancialDetails\n    , variations        :: [Variation]\n    } deriving (Show)\n\ninstance FromJSON Body where\n    parseJSON (Object v) = Body\n        &lt;$&gt; v .: \"id\"\n        &lt;*&gt; v .: \"brandId\"\n        &lt;*&gt; v .: \"productTypeId\"\n        &lt;*&gt; v .: \"identity\"\n        &lt;*&gt; v .: \"productGroupId\"\n        &lt;*&gt; v .: \"stock\"\n        &lt;*&gt; v .: \"financialDetails\"\n        &lt;*&gt; v .: \"variations\"\n    parseJSON _ = mempty\n\ndata Identity = Identity\n    { sku       :: String\n    , ean       :: String\n    , barcode   :: String\n    } deriving (Show)\n\ninstance FromJSON Identity where\n    parseJSON (Object v) = Identity\n        &lt;$&gt; v .: \"sku\"\n        &lt;*&gt; v .: \"ean\"\n        &lt;*&gt; v .: \"barcode\"\n    parseJSON _ = mempty\n\ndata Stock = Stock\n    { stockTracked  :: Bool\n    , weight        :: Weight\n    , dimensions    :: Dimensions\n    } deriving (Show)\n\ninstance FromJSON Stock where\n    parseJSON (Object v) = Stock\n        &lt;$&gt; v .: \"stockTracked\"\n        &lt;*&gt; v .: \"weight\"\n        &lt;*&gt; v .: \"dimensions\"\n    parseJSON _ = mempty\n\ndata Weight = Weight \n    { magnitude             :: Double\n    } deriving (Show)\n\ninstance FromJSON Weight where\n    parseJSON (Object v) = Weight\n        &lt;$&gt; v .: \"magnitude\"\n    parseJSON _ = mempty\n\ndata Dimensions = Dimensions                \n    { length                :: Double\n    , height                :: Double\n    , width                 :: Double\n    , volume                :: Double  \n    } deriving (Show) \n\ninstance FromJSON Dimensions where\n    parseJSON (Object v) = Dimensions\n        &lt;$&gt; v .: \"length\"\n        &lt;*&gt; v .: \"height\"\n        &lt;*&gt; v .: \"width\"\n        &lt;*&gt; v .: \"volume\"\n    parseJSON _ = mempty\n\ndata FinancialDetails = FinancialDetails    \n    { taxable               :: Bool\n    , taxCode               :: TaxCode\n    } deriving (Show)\n\ninstance FromJSON FinancialDetails where\n    parseJSON (Object v) = FinancialDetails\n        &lt;$&gt; v .: \"taxable\"\n        &lt;*&gt; v .: \"taxCode\"\n    parseJSON _ = mempty\n\ndata TaxCode = TaxCode                     \n    { taxCodeId                   :: Int\n    , code                  :: String\n    } deriving (Show)  \n\ninstance FromJSON TaxCode where\n    parseJSON (Object v) = TaxCode\n        &lt;$&gt; v .: \"id\"\n        &lt;*&gt; v .: \"code\"\n    parseJSON _ = mempty     \n\ndata Variation = Variation         \n    { optionId              :: Int\n    , optionName            :: String\n    , optionValueId         :: Int\n    , optionValue           :: String\n    }  deriving (Show) \n\ninstance FromJSON Variation where\n    parseJSON (Object v) = Variation\n        &lt;$&gt; v .: \"optionId\"\n        &lt;*&gt; v .: \"optionName\"\n        &lt;*&gt; v .: \"optionValueId\"\n        &lt;*&gt; v .: \"optionValue\"\n    parseJSON _ = mempty  \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1449249408, "post_id": 34093795, "comment_id": 55939979, "body": "It looks like you&#39;re wanting a dependently typed function since the return type is dependent on the value of its argument.  What is it you&#39;re actually trying to do, since this usually means you&#39;re going about something the wrong way?"}, {"owner": {"reputation": 5122, "user_id": 109011, "user_type": "registered", "profile_image": "https://graph.facebook.com/552148900/picture?type=large", "display_name": "Marnen Laibow-Koser", "link": "https://stackoverflow.com/users/109011/marnen-laibow-koser"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1449249474, "post_id": 34093795, "comment_id": 55940019, "body": "@bheklilr: I&#39;m trying to do exactly what I said I was trying to do: parse a string into a value of unknown type, pretty much the way the <code>read</code> function does. Why do you think this is the wrong way? And if it is the wrong way, what would be the right way?"}, {"owner": {"reputation": 2666, "user_id": 382780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e2b7c885cfa6c044bd14500052d2060?s=128&d=identicon&r=PG", "display_name": "31eee384", "link": "https://stackoverflow.com/users/382780/31eee384"}, "edited": false, "score": 0, "creation_date": 1449249736, "post_id": 34093795, "comment_id": 55940173, "body": "What do you expect the code that uses this function to look like? Is it useful to not know which thing happened after calling this function? How about using <code>Either</code>?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 5, "creation_date": 1449249739, "post_id": 34093795, "comment_id": 55940175, "body": "<code>read</code> doesn&#39;t parse a value into an unknown type.  Try typing <code>read &quot;1234&quot;</code> into GHCi.  It doesn&#39;t work, does it?  Now enter <code>read &quot;1234&quot; :: Int</code>, this works because you&#39;ve told <code>read</code> what type to return.  It&#39;s not that <code>read</code> is determining the return type, <i>you</i> have to determine what return type you want from <code>read</code> before calling it.  If you don&#39;t specify an explicit signature and it still compiles this is because GHC uses type inference to figure out what type should go there, but at the end of the day <code>read</code> is not determining its return type."}, {"owner": {"reputation": 5122, "user_id": 109011, "user_type": "registered", "profile_image": "https://graph.facebook.com/552148900/picture?type=large", "display_name": "Marnen Laibow-Koser", "link": "https://stackoverflow.com/users/109011/marnen-laibow-koser"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1449256406, "post_id": 34093795, "comment_id": 55943741, "body": "@bheklilr: &quot;<code>read</code> doesn&#39;t parse a value into an unknown type.&quot;\u2014Yes, sorry about the inexact phrasing. By &quot;unknown type&quot;, I meant &quot;type that&#39;s not fully known at compile time&quot;. Of course the runtime context determines the type, and I&#39;m well aware of that."}, {"owner": {"reputation": 5122, "user_id": 109011, "user_type": "registered", "profile_image": "https://graph.facebook.com/552148900/picture?type=large", "display_name": "Marnen Laibow-Koser", "link": "https://stackoverflow.com/users/109011/marnen-laibow-koser"}, "reply_to_user": {"reputation": 2666, "user_id": 382780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e2b7c885cfa6c044bd14500052d2060?s=128&d=identicon&r=PG", "display_name": "31eee384", "link": "https://stackoverflow.com/users/382780/31eee384"}, "edited": false, "score": 0, "creation_date": 1449256509, "post_id": 34093795, "comment_id": 55943801, "body": "@31eee384: I simply don&#39;t care whether <code>read</code> was invoked or not. I&#39;m parsing string representations of things that will go in a collection. I can already deal with the case of parsing <code>1 2 3</code> and getting a collection of <code>Integral</code>s, but I should also be able to deal with <code>&quot;one&quot; &quot;two&quot; &quot;three&quot;</code> and yield a collection of strings. (This is an exercise rather than a real-world project, so there&#39;s limited context.)"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1449257199, "post_id": 34093795, "comment_id": 55944221, "body": "@MarnenLaibow-Koser <code>read</code> still determines its type at compile time.  That&#39;s why I said that in order for it to compile GHC will determine the type needed there, but it&#39;s always caller determined polymorphism, not callee."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1449257642, "post_id": 34093795, "comment_id": 55944444, "body": "@MarnenLaibow-Koser Haskell doesn&#39;t really do run-time types.  What you&#39;re asking to do doesn&#39;t make much sense in Haskell anyway.  To illustrate, how would you act on any values you might parse?  If you parsed a list of strings, how would you tell it&#39;s a list of strings and not a list of ints?  You can&#39;t make a case statement that switches on the type of a value, that&#39;s not allowed.  How would you apply functions to it?"}, {"owner": {"reputation": 5122, "user_id": 109011, "user_type": "registered", "profile_image": "https://graph.facebook.com/552148900/picture?type=large", "display_name": "Marnen Laibow-Koser", "link": "https://stackoverflow.com/users/109011/marnen-laibow-koser"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1449259447, "post_id": 34093795, "comment_id": 55945280, "body": "@bheklilr: None of the operations on the collection care in any way about its members&#39; types; they&#39;re simply manipulating the elements as opaque unmodifiable things, much like list operations do, or working with common typeclasses like <code>Show</code>. In other words, the collection sort of acts like <code>[a]</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1449264123, "post_id": 34093795, "comment_id": 55947361, "body": "@bheklilr <a href=\"http://stackoverflow.com/a/11422333/791604\">I take issue with your claim that <code>read</code> determines its (return) type at compile time.</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5122, "user_id": 109011, "user_type": "registered", "profile_image": "https://graph.facebook.com/552148900/picture?type=large", "display_name": "Marnen Laibow-Koser", "link": "https://stackoverflow.com/users/109011/marnen-laibow-koser"}, "edited": false, "score": 0, "creation_date": 1449256578, "post_id": 34094300, "comment_id": 55943839, "body": "Srsly? I missed <code>String</code> being an instance of <code>Read</code>? I looked in the docs for that and didn&#39;t find it! That would explain the &quot;overlapping types&quot; error. Checking docs again now..."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1449256700, "post_id": 34094300, "comment_id": 55943909, "body": "Minor point of order: <code>read</code> for <code>String</code> also modifies the <code>readListPrec</code> behavior for <code>[Char]</code> to allow reading both strings (&quot;foo&quot;) and lists of chars ([&#39;f&#39;,&#39;o&#39;,&#39;o&#39;]). Both <code>Read</code> and <code>Show</code> allow overloading for lists to allow for things like String. The <code>Read</code> instance for strings is defined <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/src/GHC.Read.html#line-315\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 5122, "user_id": 109011, "user_type": "registered", "profile_image": "https://graph.facebook.com/552148900/picture?type=large", "display_name": "Marnen Laibow-Koser", "link": "https://stackoverflow.com/users/109011/marnen-laibow-koser"}, "edited": false, "score": 0, "creation_date": 1449256716, "post_id": 34094300, "comment_id": 55943927, "body": "Yes, that was my problem: I didn&#39;t know that <code>String</code> was an instance of <code>Read</code>, and so I was both reimplementing <code>read</code> and creating type issues. Thanks. But...how would I know that <code>String</code> was an instance of <code>Read</code>? It doesn&#39;t seem to be in the docs."}, {"owner": {"reputation": 5122, "user_id": 109011, "user_type": "registered", "profile_image": "https://graph.facebook.com/552148900/picture?type=large", "display_name": "Marnen Laibow-Koser", "link": "https://stackoverflow.com/users/109011/marnen-laibow-koser"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1449256745, "post_id": 34094300, "comment_id": 55943947, "body": "@ReinHenrichs: That may be the answer to why I couldn&#39;t find anything about <code>Read String</code> in the docs, then."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 5122, "user_id": 109011, "user_type": "registered", "profile_image": "https://graph.facebook.com/552148900/picture?type=large", "display_name": "Marnen Laibow-Koser", "link": "https://stackoverflow.com/users/109011/marnen-laibow-koser"}, "edited": false, "score": 1, "creation_date": 1449256774, "post_id": 34094300, "comment_id": 55943973, "body": "@MarnenLaibow-Koser You would have to deduce it from the facts that <code>Char</code> is an instance of <code>Read</code>, <code>type String = [Char]</code>, and <code>instance Read a =&gt; Read [a]</code>."}, {"owner": {"reputation": 5122, "user_id": 109011, "user_type": "registered", "profile_image": "https://graph.facebook.com/552148900/picture?type=large", "display_name": "Marnen Laibow-Koser", "link": "https://stackoverflow.com/users/109011/marnen-laibow-koser"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1449259354, "post_id": 34094300, "comment_id": 55945243, "body": "@ReinHenrichs: The last is the one I was unaware of."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 7, "last_activity_date": 1449250996, "creation_date": 1449250996, "answer_id": 34094300, "question_id": 34093795, "link": "https://stackoverflow.com/questions/34093795/extending-read-like-behavior/34094300#34094300", "title": "Extending `read`-like behavior", "body": "<blockquote>\n  <p>Shouldn't <code>a</code> match any type, including complex types like <code>[Char]</code>?</p>\n</blockquote>\n\n<p>It can and does. The question here is about who gets to choose what <code>a</code> is. The type you wrote is <code>parse :: String -&gt; a</code> which is short for</p>\n\n<pre><code>parse :: forall a. String -&gt; a\n</code></pre>\n\n<p>which you should read as: \"the caller chooses a type <code>a</code> and a <code>String</code> <code>s</code>, and <code>parse s</code> produces a value of type <code>a</code>\". The important part here is that it is the caller, and not <code>parse</code>, that chooses the type to substitute for <code>a</code>. So if you write</p>\n\n<pre><code>parse s = \"\"\n</code></pre>\n\n<p>this is an error, because the caller may choose a type other than <code>String</code>! You could also imagine a type where <code>parse</code> gets to choose; this is called an existential type, and it has some strong restrictions on how the caller can use the produced value.</p>\n\n<blockquote>\n  <p><code>String</code> isn't an instance of <code>Read</code>, so I'm not quite sure where it's seeing the overlap.</p>\n</blockquote>\n\n<p>You're wrong: <code>String</code> <em>is</em> an instance of <code>Read</code>. It uses these two instances:</p>\n\n<pre><code>instance Read Char -- Defined in \u2018GHC.Read\u2019\ninstance Read a =&gt; Read [a] -- Defined in \u2018GHC.Read\u2019\n</code></pre>\n\n<p>(Recall that <code>type String = [Char]</code>.) For example, in ghci:</p>\n\n<pre><code>&gt; read \"\\\"foo\\\"\" :: String\n\"foo\"\n</code></pre>\n\n<p>Perhaps this instance is enough for your purposes!</p>\n"}], "owner": {"reputation": 5122, "user_id": 109011, "user_type": "registered", "profile_image": "https://graph.facebook.com/552148900/picture?type=large", "display_name": "Marnen Laibow-Koser", "link": "https://stackoverflow.com/users/109011/marnen-laibow-koser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 34094300, "answer_count": 1, "score": 1, "last_activity_date": 1449250996, "creation_date": 1449249104, "question_id": 34093795, "link": "https://stackoverflow.com/questions/34093795/extending-read-like-behavior", "title": "Extending `read`-like behavior", "body": "<p>I am in the process of learning Haskell, and I've come across a problem I can't seem to solve. Basically, my use case is as follows. I'm processing a string; if it begins with a <code>\"</code> character, then I want to return it as a string (with <code>\"</code> stripped); otherwise, I want to return the result of <code>read</code> on it. In other words:</p>\n\n<p><code>parse \"\\\"foo\\\"\" -&gt; \"foo\"</code></p>\n\n<p><code>parse \"3\" -&gt; 3</code></p>\n\n<p><code>parse \"1.5\" -&gt; 1.5</code></p>\n\n<p>So far I've tried the following approaches.</p>\n\n<ol>\n<li>Polymorphic return types</li>\n</ol>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>parse :: String -&gt; a\nparse ('\"':xs) = init xs -- strip closing '\"'\nparse string = read string\n</code></pre>\n\n<p>This gives a compile-time error <code>Couldn't match expected type `a' with actual type `[Char]'</code>. Shouldn't <code>a</code> match any type, including complex types like <code>[Char]</code>? </p>\n\n<ol start=\"2\">\n<li>Typeclass</li>\n</ol>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>{-# LANGUAGE FlexibleInstances, UndecidableInstances #-}\nclass Parse where parse :: String -&gt; a\ninstance Read a =&gt; Parse a where parse = read\ninstance Parse String where parse = init . tail\n</code></pre>\n\n<p>This compiles, but gives the following runtime error:</p>\n\n<pre><code>Overlapping instances for Parse a0 arising from a use of `parse'\nMatching instances:\n  instance Read a =&gt; Parse a -- Defined at parse.hs:5:14\n  instance Parse [Char] -- Defined at parse.hs:7:14\n(The choice depends on the instantiation of `a0'\n To pick the first instance above, use -XIncoherentInstances\n when compiling the other instance declarations)\n</code></pre>\n\n<p><code>String</code> isn't an instance of <code>Read</code>, so I'm not quite sure where it's seeing the overlap.</p>\n\n<p>BTW, the pragmas are there because otherwise I get compile-time errors:</p>\n\n<pre><code>Illegal instance declaration for `Parse [Char]'\n  (All instance types must be of the form (T a1 ... an)\n   where a1 ... an are *distinct type variables*,\n   and each type variable appears at most once in the instance head.\n   Use -XFlexibleInstances if you want to disable this.)\nIn the instance declaration for `Parse [Char]'\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Constraint is no smaller than the instance head\n  in the constraint: Read a\n(Use -XUndecidableInstances to permit this)\nIn the instance declaration for `Parse a'\n</code></pre>\n\n<ol start=\"3\">\n<li>Making <code>String</code> an instance of <code>Read</code></li>\n</ol>\n\n<p>I'm not sure how to do this, and the documentation isn't all that clear to me. If I can figure it out, though, it sounds like it might be the right thing to do. But one question sticks in my head: if in one module I make <code>String</code> an instance of <code>Read</code>, would that change the class for the entire application even if I don't export the relevant bits? If it would, then I'm not sure I like the implications of that.</p>\n\n<hr>\n\n<p>So that's what I've tried so far. Is my approach wrong? Is it basically right and I just need to fix a couple of details? Please let me know.</p>\n"}, {"tags": ["haskell", "types"], "answers": [{"comments": [{"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1449255570, "post_id": 34092683, "comment_id": 55943282, "body": "typo: it should say &quot;we need a function Graph -&gt; [(Start, [End])]&quot;"}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 3, "last_activity_date": 1449255902, "last_edit_date": 1449255902, "creation_date": 1449245726, "answer_id": 34092683, "question_id": 34092322, "link": "https://stackoverflow.com/questions/34092322/function-expects-structure-of-newtype-but-not-newtype-itself/34092683#34092683", "title": "Function expects structure of newtype but not newtype itself", "body": "\n\n<p>The type of map is</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>In this case, join has type</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>join :: (Start, [End]) -&gt; [Edge]\n</code></pre>\n\n<p>So <code>map join</code> has type</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>map join :: [(Start, [End])] -&gt; [[Edge]]\n</code></pre>\n\n<p>And what we want is <code>Graph -&gt; [[Edge]]</code>. So we need a function <code>Graph -&gt; [(Start, [End])]</code> and we'll be all set. Fortunately, this is really simple with record accessors!</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type Node = Integer\ntype Edge = (Node, Node)\ntype Start = Node\ntype End = Node\n\nnewtype Graph = Graph {\n  edges :: [(Start, [End])]\n} deriving (Eq, Show)\n\njoin :: (Start, [End]) -&gt; [Edge]\njoin (start, ends) = map (\\e -&gt; if start &lt; e then (start, e) else (e, start)) ends\n\nsampleGraph =\n  Graph [(5, [1, 2, 3]),\n         (7, [1, 2]),\n         (1, [1, 2]),\n         (2, [1, 2])\n        ]\n\nfoo = map join . edges\n</code></pre>\n\n<p>We declare an accessor <code>edges</code> for the edges field, and it's automatically given the type <code>Graph -&gt; (Start, [End])</code>. Composing <code>map join . edges</code> yields the final desired type.</p>\n\n<p>An alternate way of doing this would be to use a case-expression to destruct <code>Graph</code> into its constituent parts:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>case sampleGraph of\n   Graph edges -&gt; map join edges\n</code></pre>\n\n<p>Life is a buffet of options.</p>\n"}], "owner": {"reputation": 2442, "user_id": 3666302, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e9aed854fcd666aba1316ef908ad5913?s=128&d=identicon&r=PG&f=1", "display_name": "TomTom", "link": "https://stackoverflow.com/users/3666302/tomtom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 34092683, "answer_count": 1, "score": 1, "last_activity_date": 1449255902, "creation_date": 1449244718, "question_id": 34092322, "link": "https://stackoverflow.com/questions/34092322/function-expects-structure-of-newtype-but-not-newtype-itself", "title": "Function expects structure of newtype but not newtype itself", "body": "<p>I seem to miss something fundamental.</p>\n\n<p>When I try to map join with the <code>sampleGraph</code> I get this error:</p>\n\n<pre><code>Main&gt; map join sampleGraph \n\n&lt;interactive&gt;:3:10:\n    Couldn't match expected type \u2018[(Start, [End])]\u2019\n            with actual type \u2018Graph\u2019\n    In the second argument of \u2018map\u2019, namely \u2018sampleGraph\u2019\n    In the expression: map join sampleGraph\n</code></pre>\n\n<p><strong>This is the code</strong></p>\n\n<pre><code>type Node = Integer\ntype Edge = (Node,Node)\ntype Start = Node\ntype End = Node\nnewtype Graph = Graph [(Start,[End])] deriving (Eq,Show)\n\njoin :: (Start, [End]) -&gt; [Edge]\njoin (start, ends) = map (\\ e -&gt; if start &lt; e then (start, e) else (e, start)) ends\n\nsampleGraph = (Graph\n    [(5,[1,2,3]),\n     (7,[1,2]),\n     (1,[1,2]),\n     (2,[1,2])\n    ])\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "alternative-functor"], "comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 4, "creation_date": 1449237492, "post_id": 34089511, "comment_id": 55931956, "body": "I would define <code>ensure</code> as <code>ensure :: MonadPlus m =&gt; (a -&gt; Bool) -&gt; a -&gt; m a; ensure p = mfilter p . return</code>."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 6, "creation_date": 1449238746, "post_id": 34089511, "comment_id": 55932826, "body": "<code>ensure</code> reminds me of <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#v:guard\" rel=\"nofollow noreferrer\"><code>guard</code></a> but looks much more useful"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1449239172, "post_id": 34089511, "comment_id": 55933126, "body": "Your second form looks like <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#v:mfilter\" rel=\"nofollow noreferrer\"><code>mfilter</code></a>. Passing an unwrapped value to the predicate seems to be better."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 3, "creation_date": 1449239503, "post_id": 34089511, "comment_id": 55933365, "body": "@user3237465 I have an almost identical definition in <code>Dmwit.Prelude</code>, namely, <code>ensure p x = x &lt;$ guard (p x)</code>."}, {"owner": {"reputation": 13597, "user_id": 1463507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9d940a7d55911df9afca8e2dd525f3ee?s=128&d=identicon&r=PG", "display_name": "kqr", "link": "https://stackoverflow.com/users/1463507/kqr"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1449241917, "post_id": 34089511, "comment_id": 55934981, "body": "@user3237465 ...and then chain it with fromMaybe to get an empty string when run as <code>ensure (&#47;= &quot;kim&quot;) &quot;kim&quot;</code>? Or am I missing something?"}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 4, "creation_date": 1449243932, "post_id": 34089511, "comment_id": 55936428, "body": "The smallest requirement set I can think of: <code>ensure (Eq a, Monoid a) =&gt; (a -&gt; Bool) -&gt; a -&gt; a; ensure p = if p a then a else mempty</code>. This could even work work for numbers if we decided under which operation we are using the monoid."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 3, "creation_date": 1449244006, "post_id": 34089511, "comment_id": 55936488, "body": "9000: I think your <code>Eq</code> requirement is superfluous"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1449268296, "post_id": 34089511, "comment_id": 55949265, "body": "@kqr, you can, but I would define two versions of <code>ensure</code>: one for <code>Monoid</code> and one for <code>MonadPlus</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2728, "user_id": 453273, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d1a9ce578cf1f56e53ae38d1b0476d7e?s=128&d=identicon&r=PG", "display_name": "Rose Kunkel", "link": "https://stackoverflow.com/users/453273/rose-kunkel"}, "is_accepted": true, "score": 2, "last_activity_date": 1614317458, "last_edit_date": 1614317458, "creation_date": 1467077474, "answer_id": 38065703, "question_id": 34089511, "link": "https://stackoverflow.com/questions/34089511/looking-for-generalisation-of-the-if-p-x-then-x-else-empty-construct/38065703#38065703", "title": "Looking for generalisation of the `if p x then x else empty` construct", "body": "<p>Below are suggestions from the comments. One using <code>Monoid</code>, by <a href=\"https://stackoverflow.com/users/223424/9000\">9000</a>:</p>\n<pre><code>ensure :: Monoid a =&gt; (a -&gt; Bool) -&gt; a -&gt; a\nensure p a = if p a then a else mempty\n</code></pre>\n<p>Another using <code>MonadPlus</code>, by <a href=\"https://stackoverflow.com/users/3237465/user3237465\">user3237465</a>:</p>\n<pre><code>ensure :: MonadPlus m =&gt; (a -&gt; Bool) -&gt; a -&gt; m a\nensure p = mfilter p . return\n</code></pre>\n<p>And a variant of the second one that only requires <code>Alternative</code>, by <a href=\"https://stackoverflow.com/users/791604/daniel-wagner\">Daniel Wagner</a>:</p>\n<pre><code>ensure :: Alternative f =&gt; (a -&gt; Bool) -&gt; a -&gt; f a\nensure p x = x &lt;$ guard (p x)\n</code></pre>\n"}], "owner": {"reputation": 13597, "user_id": 1463507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9d940a7d55911df9afca8e2dd525f3ee?s=128&d=identicon&r=PG", "display_name": "kqr", "link": "https://stackoverflow.com/users/1463507/kqr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 1, "accepted_answer_id": 38065703, "answer_count": 1, "score": 8, "last_activity_date": 1614317473, "creation_date": 1449235827, "last_edit_date": 1614317473, "question_id": 34089511, "link": "https://stackoverflow.com/questions/34089511/looking-for-generalisation-of-the-if-p-x-then-x-else-empty-construct", "title": "Looking for generalisation of the `if p x then x else empty` construct", "body": "<p>I have a couple of snippets which feel like they're doing the same thing, but I'm not entirely convinced there is a generalised construct to handle them both. In one place, I have</p>\n\n<pre><code>ensure :: (String -&gt; Bool) -&gt; String -&gt; String\nensure p x =\n    if p x then\n        x\n    else\n        \"\"\n</code></pre>\n\n<p>This might in use look something like</p>\n\n<pre><code>ensure (/= \"kim\") \"alex\"    -- returns \"alex\"\nensure (/= \"kim\") \"kim\"     -- returns \"\"\n</code></pre>\n\n<p>in another, I have the very similar</p>\n\n<pre><code>ensure :: (a -&gt; Bool) -&gt; Maybe a -&gt; Maybe a\nensure p maybeX = do\n    x &lt;- maybeX\n    if p x then\n        Just x\n    else\n        Nothing\n</code></pre>\n\n<p>This would instead look something like</p>\n\n<pre><code>ensure even 6     -- returns Just 6\nensure even 11    -- returns Nothing\n</code></pre>\n\n<p>Both are checking whether a value is correct according to some predicate, and if it's not they're returning a default \"empty\"-looking value. There is a slight difference though \u2013 which means the second function could be rewritten as</p>\n\n<pre><code>ensure :: (Maybe a -&gt; Bool) -&gt; Maybe a -&gt; Maybe a\nensure p maybeX =\n    if p x then\n        x\n    else\n        Nothing\n</code></pre>\n\n<p>to make them more similar, putting the responsibility of \"unwrapping\" the <code>Maybe</code> on the predicate. With this new definition, both functions would fall under</p>\n\n<pre><code>ensure :: Alternative f =&gt; (f a -&gt; Bool) -&gt; f a -&gt; f a\nensure p x =\n    bool x empty (p x)\n</code></pre>\n\n<p>So, my question is,</p>\n\n<p><strong>Does this <code>bool x empty (p x)</code> exist in some form so I don't have to implement this function myself?</strong> The problem with inlining <code>bool x empty (p x)</code> is that in my case, both <code>p</code> and <code>x</code> are quite long.</p>\n"}, {"tags": ["haskell", "typeclass", "dependent-type", "gadt"], "answers": [{"comments": [{"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1449219625, "post_id": 34084291, "comment_id": 55921247, "body": "Ah.  Unfortunately, avoiding such a constraint is the reason I am going through this in the first place.  But!  My problem was initially that I needed to specify <code>(Applicative (Foo ns), Foldable (Foo ns))</code>, etc., for all my existentials, and I thought just having this would be able to get rid of it all.  But I see now that I can just replace all of those various constraints with a <code>Known</code> constraint.  No avoiding the constraint, but now just having one catch-all is much cleaner, thanks!"}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1449258147, "post_id": 34084291, "comment_id": 55944714, "body": "@JustinL. You can also use <a href=\"https://downloads.haskell.org/~ghc/7.8.4/docs/html/users_guide/constraint-kind.html\" rel=\"nofollow noreferrer\">constraint synonyms</a>: <code>type Known ns = (Applicative (Foo ns), Foldable (Foo ns), ...)</code>."}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "reply_to_user": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1449300551, "post_id": 34084291, "comment_id": 55956443, "body": "@AlexeyRomanov it still feels very ad-hoc and un-haskell to me.  I might throw in a bunch of instances that only have very rare/uncommon and obscure usages that don&#39;t have any business belonging in the actual data constructor for the type...it doesn&#39;t have anything to do with the obscure classes at all.  And I&#39;d have to add the class and duplicate work every time I write a new instance."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 5, "last_activity_date": 1449221669, "last_edit_date": 1449221669, "creation_date": 1449219311, "answer_id": 34084291, "question_id": 34083781, "link": "https://stackoverflow.com/questions/34083781/inferring-general-typeclass-instance-from-a-series-of-smaller-ones/34084291#34084291", "title": "Inferring general typeclass instance from a series of smaller ones?", "body": "<p>If there's no constraint for a class, you can't use its methods. Just add the constraint:</p>\n\n<pre><code>asProds :: forall as. Known (Prod Proxy) as =&gt; Proxy as -&gt; Prod Proxy as\nasProds _ = known :: Prod Proxy as  \n</code></pre>\n\n<p>Note that GHC can infer this type:</p>\n\n<pre><code>asProds (_ :: Proxy as) = known :: Prod Proxy as\n-- inferred constraint\n</code></pre>\n\n<p>Since types are erased, there's nothing from which instances could be built runtime in the absence of a dictionary to begin with. It might well be logically true that there exists instances for all inhabitants of a kind, but for programs we need dictionaries - constructive proofs - to run.</p>\n\n<p>Writing out the constraints shouldn't bother us much, since if we have instances for all cases, then when we need an instance, we can usually get one, with not-too-frequent exceptions. The exception is when we want instances for an open type with type family applications. In that case we have to write functions that explicitly build instances at the desired type from other known instances. </p>\n"}], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "accepted_answer_id": 34084291, "answer_count": 1, "score": 6, "last_activity_date": 1449221669, "creation_date": 1449217279, "last_edit_date": 1449218217, "question_id": 34083781, "link": "https://stackoverflow.com/questions/34083781/inferring-general-typeclass-instance-from-a-series-of-smaller-ones", "title": "Inferring general typeclass instance from a series of smaller ones?", "body": "<p>the title of this is admittedly not very descriptive, but I don't know how else to describe this in a short title.  I'd appreciate any recommendations!</p>\n\n<p>I'm going to be presenting a very simplified version of my issue :)</p>\n\n<p>So I have a typeclass</p>\n\n<pre><code>class Known f a where\n    known :: f a\n</code></pre>\n\n<p>That is supposed to be able to generate the canonical construction of a given type at a certain index, useful for working with GADT's and stuff.  I'm giving a simplified version of <a href=\"http://hackage.haskell.org/package/type-combinators-0.1.2.1/docs/Type-Class-Known.html\">this</a>, with the relavant parts.</p>\n\n<p>So there's obviously an instance for <code>Proxy</code>:</p>\n\n<pre><code>instance Known Proxy a where\n    known = Proxy\n</code></pre>\n\n<p>Which we can use:</p>\n\n<pre><code>&gt; known :: Proxy Monad\nProxy\n</code></pre>\n\n<p>But there's also an instance for <a href=\"http://hackage.haskell.org/package/type-combinators-0.1.2.1/docs/Data-Type-Product.html\">this HList-like type</a>:</p>\n\n<pre><code>data Prod f :: [k] -&gt; * where\n    PNil :: Prod f '[]\n    (:&lt;) :: f a -&gt; Prod f as -&gt; Prod f (a ': as)\n\ninfixr 5 (:&lt;)\n</code></pre>\n\n<p>Where a <code>Prod f '[a,b,c]</code> would be roughly equivalent to a <code>(f a, f b, f c)</code> tuple.  Same Functor, different types.</p>\n\n<p>Writing the instance is decently straightforward:</p>\n\n<pre><code>instance Known (Prod f) '[] where\n    known = PNil\ninstance (Known f a, Known (Prod f) as) =&gt; Known (Prod f) (a ': as) where\n    known = known :&lt; known\n</code></pre>\n\n<p>Which works out pretty well: (assuming a Show instance)</p>\n\n<pre><code>&gt; known :: Prod Proxy '[1,2,3]\nProxy :&lt; Proxy :&lt; Proxy :&lt; PNil\n</code></pre>\n\n<p>But, I'm in the case where I need to make a \"polymorphic\" function on all <code>as</code>...but GHC is not liking it.</p>\n\n<pre><code>asProds :: forall as. Proxy as -&gt; Prod Proxy as\nasProds _ = known :: Prod Proxy as\n</code></pre>\n\n<p>It comes up with this error:</p>\n\n<pre><code>No instance for (Known (Prod f) as)\n  arising from a use of 'known'\n</code></pre>\n\n<p>Which I guess is saying that GHC can't show that there will be an instance it will pick that will work for <em>any</em> <code>as</code>, or, it doesn't have a strategy to construct <code>known</code> for that instance.</p>\n\n<p>I as a human know that this is the case, but is there any way I can get this to work?  The instances are all \"in scope\" and available...but how can I tell GHC how to construct it in a way that it is satisfied?</p>\n"}]