[{"tags": ["haskell", "quickcheck", "hspec"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 1, "creation_date": 1481155682, "post_id": 41029511, "comment_id": 69266777, "body": "Yes, it is possible. You can do this using <code>ScopedTypeVariables</code>, and it can be made even nicer by using GHC 8\u2019s <code>TypeApplications</code> along with <code>AllowAmbiguousTypes</code>."}, {"owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "edited": false, "score": 0, "creation_date": 1481222662, "post_id": 41029511, "comment_id": 69300850, "body": "<code>forall</code> is used to introduce a new type <i>variable</i>. <i>Concrete</i> types such as <code>Int</code> need not be introduced, just insert them instead of a <i>type variable</i>. Your example then becomes: <code>checkFunctor :: forall f. (Functor f) =&gt; String -&gt; f Int -&gt; IO ()</code>. In the body of <code>checkFunctor</code> you need accordingly: <code>functorIdentity :: f Int -&gt; TypeIdentity</code>."}], "answers": [{"comments": [{"owner": {"reputation": 160, "user_id": 4177612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-BHXwXZ27Vh4/AAAAAAAAAAI/AAAAAAAAAHU/ND3J8zu54_w/photo.jpg?sz=128", "display_name": "D. Amoroso", "link": "https://stackoverflow.com/users/4177612/d-amoroso"}, "edited": false, "score": 0, "creation_date": 1481157789, "post_id": 41029593, "comment_id": 69267423, "body": "Thank you for your answer! I edited the question after I tried this, although without success"}], "tags": [], "owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "is_accepted": true, "score": 1, "last_activity_date": 1481223039, "last_edit_date": 1481223039, "creation_date": 1481155693, "answer_id": 41029593, "question_id": 41029511, "link": "https://stackoverflow.com/questions/41029511/abstracting-hspec-tests/41029593#41029593", "title": "Abstracting Hspec tests", "body": "<p>Since you did not add an error message, I assume the problem is a type error where <code>(functorIdentity :: f a -&gt; TypeIdentity)</code> is defined. The problem is that the <code>f</code> introduced here is new and different from the <code>f</code> in the top-level signature. To remedy this, enable the following extension:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n</code></pre>\n\n<p>And change the signature of <code>checkFunctor</code> to:</p>\n\n<pre><code>checkFunctor :: forall f a. (Functor f) =&gt; String -&gt; f a -&gt; IO ()\n</code></pre>\n\n<p><code>forall</code> introduces new <em>type variables</em>. Without <em>ScopedTypeVariables</em> and an explicit <code>forall</code> it is always present implicitly, and <code>(functorIdentity :: f a -&gt; TypeIdentity)</code> becomes <code>(functorIdentity :: forall f a. f a -&gt; TypeIdentity)</code>. However, you do <em>not</em> want a forall here, because you want the type variables <code>f</code> and <code>a</code> to be the same as the top-level ones.</p>\n"}], "owner": {"reputation": 160, "user_id": 4177612, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-BHXwXZ27Vh4/AAAAAAAAAAI/AAAAAAAAAHU/ND3J8zu54_w/photo.jpg?sz=128", "display_name": "D. Amoroso", "link": "https://stackoverflow.com/users/4177612/d-amoroso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 41029593, "answer_count": 1, "score": 1, "last_activity_date": 1481223039, "creation_date": 1481155051, "last_edit_date": 1481157690, "question_id": 41029511, "link": "https://stackoverflow.com/questions/41029511/abstracting-hspec-tests", "title": "Abstracting Hspec tests", "body": "<p>I am going through \"Haskell programming from first principles\" and I found myself writing code in the following fashion over and over:</p>\n\n<pre><code>type IntToInt = Fun Int Int\ntype TypeIdentity = ConcreteFunctorType Int -&gt; Bool\ntype TypeComposition = ConcreteFunctorType Int -&gt; IntToInt -&gt; IntToInt -&gt; Bool\n\ncheckSomething :: IO ()\ncheckSomething = hspec $ do\n        describe \"Some functor\" $ do\n            it \"identity property\" $ do\n                property $ (functorIdentity :: TypeIdentity)\n            it \"composition property\" $ do\n                property $ (functorComposition :: TypeComposition)\n</code></pre>\n\n<p>I tried abstracting this but at my level I am not able to figure out a way to make it work</p>\n\n<p>what I would have liked to accomplish was something like this</p>\n\n<pre><code>checkFunctor :: (Functor f) =&gt; String -&gt; f a -&gt; IO ()\ncheckFunctor description f = hspec $ do\n        describe description $ do\n            it \"identity property\" $ do\n                property $ (functorIdentity :: f a -&gt; TypeIdentity)\n            it \"composition property\" $ do\n                property $ ( functorComposition :: f a -&gt; TypeComposition)\n</code></pre>\n\n<p>EDIT:\nAfter Sapanoia's answer I tried as follows </p>\n\n<pre><code>type TypeIdentity = Bool\ntype TypeComposition = Fun Int Int -&gt; Fun Int Int -&gt; Bool\n\n\ncheckFunctor :: forall f a. (Functor f) =&gt; String -&gt; f a -&gt; IO ()\ncheckFunctor description f = hspec $ do\n    describe description $ do\n        it \"identity property\" $ do\n            property $ (functorIdentity :: f a -&gt; TypeIdentity)\n        it \"composition property\" $ do\n            property $ (functorCompose' :: f a -&gt; TypeComposition)\n</code></pre>\n\n<p>but I get the following error </p>\n\n<pre><code>FunctorCheck.hs:22:25: error:\n\u2022 Couldn't match type \u2018a\u2019 with \u2018Int\u2019\n  \u2018a\u2019 is a rigid type variable bound by\n    the type signature for:\n      checkFunctor :: forall (f :: * -&gt; *) a.\n                      Functor f =&gt;\n                      String -&gt; f a -&gt; IO ()\n    at FunctorCheck.hs:16:26\n  Expected type: f a -&gt; TypeComposition\n    Actual type: f Int -&gt; Fun Int Int -&gt; Fun Int Int -&gt; Bool\n</code></pre>\n\n<p>It then becomes quite complicated for me to define the types to generate the arbitrary values and functions. </p>\n\n<p>Is there a way I can bind the type of checkFunctor to a specific type like  the following? </p>\n\n<pre><code>checkFuntor :: checkFunctor :: forall f Int. (Functor f) =&gt; String -&gt; f a -&gt; IO ()\n</code></pre>\n\n<p>of course I tried this and it gives me a parse error, I assume it's just me not using 'forall' correctly.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1481152732, "post_id": 41029046, "comment_id": 69265748, "body": "Do you know how to write <code>map</code> and <code>filter</code> yourself?"}], "answers": [{"comments": [{"owner": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "edited": false, "score": 0, "creation_date": 1481153062, "post_id": 41029137, "comment_id": 69265876, "body": "I&#39;ve got the following error :  ERROR &quot;save.hs&quot;:5 - Type error in application *** Expression     : (x == Operator) and (y == Number) *** Term           : (==) *** Type           : a -&gt; a -&gt; Bool *** Does not match : b -&gt; c -&gt; d -&gt; e -&gt; f"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 1, "creation_date": 1481153221, "post_id": 41029137, "comment_id": 69265937, "body": "I think your code isn&#39;t correct, it isn&#39;t defined on singleton."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "edited": false, "score": 0, "creation_date": 1481154699, "post_id": 41029137, "comment_id": 69266468, "body": "@PierreP. the infix and operator is spelled <code>&amp;&amp;</code>, not <code>and</code> (that&#39;s something different)"}, {"owner": {"reputation": 3946, "user_id": 6231376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cea33b55396be93411ade85021f41b01?s=128&d=identicon&r=PG&f=1", "display_name": "TeWu", "link": "https://stackoverflow.com/users/6231376/tewu"}, "reply_to_user": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "edited": false, "score": 0, "creation_date": 1481154785, "post_id": 41029137, "comment_id": 69266506, "body": "@PierreP  I edited the answer - this time I&#39;ve actually checked if the code compiles ;)"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1481155017, "post_id": 41029137, "comment_id": 69266568, "body": "Now, you can remove equation <code>swap [] = []</code>  and I believe that with pattern matching you can simplify your code :)"}, {"owner": {"reputation": 3946, "user_id": 6231376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cea33b55396be93411ade85021f41b01?s=128&d=identicon&r=PG&f=1", "display_name": "TeWu", "link": "https://stackoverflow.com/users/6231376/tewu"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1481155306, "post_id": 41029137, "comment_id": 69266659, "body": "@freestyle right - because <code>swap xs = xs</code> case handles empty list - good catch! :)"}], "tags": [], "owner": {"reputation": 3946, "user_id": 6231376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cea33b55396be93411ade85021f41b01?s=128&d=identicon&r=PG&f=1", "display_name": "TeWu", "link": "https://stackoverflow.com/users/6231376/tewu"}, "is_accepted": false, "score": 2, "last_activity_date": 1481157312, "last_edit_date": 1481157312, "creation_date": 1481152800, "answer_id": 41029137, "question_id": 41029046, "link": "https://stackoverflow.com/questions/41029046/swapping-two-successive-elements-in-a-list/41029137#41029137", "title": "Swapping two successive elements in a list", "body": "<p>You just need to construct a list with elements swapped and return it:</p>\n\n<pre><code>data Token = Number | Operator deriving (Eq, Show)\n\nswap :: [Token] -&gt; [Token]\nswap (x:y:xs) = if x == Number &amp;&amp; y == Operator then\n                  y : x : swap xs\n                else \n                  x : swap (y : xs)\nswap xs = xs\n\n\nmain = putStrLn $ show $ swap [Number, Number, Number, Operator, Operator, Number, Operator, Number]\n-- Output: [Number,Number,Operator,Number,Operator,Operator,Number,Number]\n</code></pre>\n\n<p><a href=\"http://ideone.com/m8z8sR\" rel=\"nofollow noreferrer\">Run it</a></p>\n\n<p>Alternatively, you can use pattern matching instead of <code>if/else</code>:</p>\n\n<pre><code>swap :: [Token] -&gt; [Token]\nswap (x@Number:y@Operator:xs) = y : x : swap xs\nswap (x:xs) = x : swap xs\nswap [] = []\n</code></pre>\n\n<p><a href=\"http://ideone.com/HXa353\" rel=\"nofollow noreferrer\">Run it</a></p>\n"}], "owner": {"reputation": 1015, "user_id": 6391764, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ae6eb3e43b8792b2ce6fa3743e01a750?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre P.", "link": "https://stackoverflow.com/users/6391764/pierre-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481157312, "creation_date": 1481152296, "question_id": 41029046, "link": "https://stackoverflow.com/questions/41029046/swapping-two-successive-elements-in-a-list", "title": "Swapping two successive elements in a list", "body": "<p>I have a list of elements and I would like to create a Haskell function of this type : </p>\n\n<p><code>swap :: [Token] -&gt; [Token]</code></p>\n\n<p>Given this data : <code>data Token = Number | Operator</code></p>\n\n<p>In the function I would like to check if two successive elements (starting from the beggining) are \"swappable\". Two elements are swappable if the first one is <code>Number</code> and the following one is <code>Operator</code>. </p>\n\n<p>I have started to design a function like this but not sure how to complete it : </p>\n\n<pre><code>swap :: [Token] -&gt; [Token]\nswap [] = []\nswap (x:xs) = if ( x == Number ) and ( xs!!0 == Operator ) then\n                -- swap here\n              else \n                swap (xs)\n</code></pre>\n\n<p>I don't know how to do the swap though.</p>\n\n<p>Thanks for your help</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2638, "user_id": 7208029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QxbAJ.png?s=128&g=1", "display_name": "Chai T. Rex", "link": "https://stackoverflow.com/users/7208029/chai-t-rex"}, "edited": false, "score": 0, "creation_date": 1481148821, "post_id": 41028215, "comment_id": 69264112, "body": "You can use a list of acceptable characters like <code>[&#39;a&#39;..&#39;z&#39;]</code> or whatever, <code>filter</code>, and <code>notElem</code> to get a list of acceptable characters that aren&#39;t used yet in the <code>String</code>."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1481148980, "post_id": 41028215, "comment_id": 69264198, "body": "You could do <code>import Data.Unique; uniqueName = (&quot;var&quot; ++) &lt;$&gt; hashUnique &lt;$&gt; newUnique</code>.  This function lives in <code>IO</code>, but you&#39;re guaranteed to always get a unique string of the form <code>varN</code> where <code>N</code> is a sequence of digits.  Considering there&#39;s only so many characters to choose from and <code>Data.Unique</code> can provide as many unique names as you have RAM for, this solution scales more."}, {"owner": {"reputation": 73, "user_id": 7243489, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1290615340959601/picture?type=large", "display_name": "Bruno Nascimento", "link": "https://stackoverflow.com/users/7243489/bruno-nascimento"}, "reply_to_user": {"reputation": 2638, "user_id": 7208029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QxbAJ.png?s=128&g=1", "display_name": "Chai T. Rex", "link": "https://stackoverflow.com/users/7208029/chai-t-rex"}, "edited": false, "score": 0, "creation_date": 1481164511, "post_id": 41028215, "comment_id": 69269182, "body": "@ChaiT.Rex comment actually gave me an idea to try something. I&#39;ll edit the question to add my try. Also, I&#39;m not sure if I uderstood bheklilr&#39;s idea, but it seems it wouldn&#39;t work in my case, since the variables are named using a single Char."}], "answers": [{"comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1481152806, "post_id": 41028342, "comment_id": 69265781, "body": "You don&#39;t <i>need</i> to."}], "tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": false, "score": 1, "last_activity_date": 1481153374, "last_edit_date": 1495540906, "creation_date": 1481148865, "answer_id": 41028342, "question_id": 41028215, "link": "https://stackoverflow.com/questions/41028215/haskell-how-to-get-a-different-char-from-a-list/41028342#41028342", "title": "Haskell: How to get a different char from a list?", "body": "<p>You can save state of free characters when you've just got one.</p>\n\n<p>So, you need the function like this:</p>\n\n<pre><code>getNewVarName :: [Char] -&gt; (Char, [Char])\ngetNewVarName (x:xs) = (x, xs)\ngetNewVarName _      = error \"Ups, here are not free characters.\"\n\nlet\n    (name1, xs') = getNewVarName xs\n    (name2, xs'') = getNewVarName xs'\nin ...\n</code></pre>\n\n<p>And you can see <a href=\"https://stackoverflow.com/questions/40876135/haskell-labelling-items-in-recursive-function/40876681#40876681\">this question</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 2, "last_activity_date": 1481154350, "creation_date": 1481154350, "answer_id": 41029399, "question_id": 41028215, "link": "https://stackoverflow.com/questions/41028215/haskell-how-to-get-a-different-char-from-a-list/41029399#41029399", "title": "Haskell: How to get a different char from a list?", "body": "<p>For a quadratic time algorithm (made generic, in Haskell style):</p>\n\n<pre><code>import Data.List ((\\\\))\n\ngetNewVarName :: (Eq a) =&gt; [a] -&gt; [a] -&gt; a\ngetNewVarName possibleVars varsInUse = head (possibleVars \\\\ varsInUse)\n</code></pre>\n\n<p>Where <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:-92--92-\" rel=\"nofollow noreferrer\"><code>(\\\\)</code></a> is the list difference operator.</p>\n\n<p>If you use <a href=\"https://hackage.haskell.org/package/containers-0.5.8.1/docs/Data-Set.html\" rel=\"nofollow noreferrer\"><code>Data.Set</code></a> to store the possible variables and the variables in use instead of a list, then this same algorithm only costs O(n log n).   You can use a trie to get linear time, but this is just getting silly.  If you actually care about speed you should use a <a href=\"https://hackage.haskell.org/package/monad-supply-0.6/docs/Control-Monad-Supply.html\" rel=\"nofollow noreferrer\">supply</a> of fresh variables.</p>\n"}], "owner": {"reputation": 73, "user_id": 7243489, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1290615340959601/picture?type=large", "display_name": "Bruno Nascimento", "link": "https://stackoverflow.com/users/7243489/bruno-nascimento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 41029399, "answer_count": 2, "score": 1, "last_activity_date": 1481165877, "creation_date": 1481148258, "last_edit_date": 1481165877, "question_id": 41028215, "link": "https://stackoverflow.com/questions/41028215/haskell-how-to-get-a-different-char-from-a-list", "title": "Haskell: How to get a different char from a list?", "body": "<p>So, I'm trying to make a function to rename variables in a Lambda Calculus expression, but I can't seem to figure out how to get a Char that's not already in use so I can set it as the new name to a variable.</p>\n\n<p>I've already got a list with all the Chars that are being used as names to variables, so what I need is just a function that receives this list e returns a differnt Char, i.e. one that's not in use.</p>\n\n<p>A function like that:</p>\n\n<pre><code>getNewVarName :: [Char] -&gt; Char\n</code></pre>\n\n<p>I don't really use lists, or Haskell, for that matter, so I hope you can excuse my silly question.</p>\n\n<p>// Edit 1</p>\n\n<pre><code>-- acceptableNames is passed as the second argument to getNewVarName\nacceptableNames = ['a'..'z'] ++ ['A'..'Z']\n\ngetNewVarName :: [Char] -&gt; [Char] -&gt; Char\n-- vars is the list with all the names actually being used\n-- acceptable == acceptableNames\ngetNewVarName vars acceptable\n    | (not(null acceptable)) = let e = head acceptable\n                               in  if(elem e vars)\n                                   then getNewVarName vars (tail acceptable)\n                                   else e\n    | otherwise = '$' -- returns '$' just if all acceptableNames are used up\n</code></pre>\n\n<p>Basically, what it does is return the first Char in <code>acceptableNames</code> that is not contained in <code>vars</code>. Apparently, it works.</p>\n\n<p>I realize there must be lots of better ways to do it, but, considering my knowledge on Haskell, that was the way that made sense to me.</p>\n\n<p>Please, let me know of any ways I can improve this code.</p>\n\n<p>// Edit 2</p>\n\n<p>@luqui answer worked perfectly in this case. Way simpler than my solution.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1481148256, "post_id": 41028167, "comment_id": 69263850, "body": "Weird... but does it matter? <code>sized-vector</code> is deprecated in favour of <a href=\"https://hackage.haskell.org/package/sized-0.2.0.0/docs/Data-Sized.html\" rel=\"nofollow noreferrer\"><code>sized</code>, which <i>has</i> a functor instance</a>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1481150871, "post_id": 41028167, "comment_id": 69264989, "body": "It&#39;s inconvenient but not insoluble. You can define <code>newtype FlippedVec n a = FlippedVec { unFlipVec :: Vector a n }</code> and work with <code>FlippedVec</code>s"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1481154570, "post_id": 41028167, "comment_id": 69266421, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/39758994/order-of-type-arguments-in-indexed-vectors\">Order of type arguments in indexed vectors</a>"}], "owner": {"reputation": 555, "user_id": 1505475, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bc72887d0b9f71cdbc2eeb5f9899d8f?s=128&d=identicon&r=PG", "display_name": "simon1505475", "link": "https://stackoverflow.com/users/1505475/simon1505475"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1481148051, "creation_date": 1481148051, "question_id": 41028167, "link": "https://stackoverflow.com/questions/41028167/why-isnt-vector-from-sized-vector-not-a-functor-etc", "title": "Why isn&#39;t Vector from sized-vector not a Functor, etc?", "body": "<p>Why is the <code>a</code> parameter of <code>Vector</code> from <a href=\"https://hackage.haskell.org/package/sized-vector-1.4.3.1\" rel=\"nofollow noreferrer\">sized-vector</a> \nhave type Vector a n (with n the length) not the last type parameter? It prevents the creation of instances of Functor, Foldable, Traversable and Applicative and forces the duplication of some of their interfaces.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": true, "score": 2, "last_activity_date": 1481143257, "creation_date": 1481143257, "answer_id": 41026976, "question_id": 41026605, "link": "https://stackoverflow.com/questions/41026605/haskell-put-function-on-pair/41026976#41026976", "title": "Haskell - put function on pair", "body": "<p>The general case:</p>\n\n<pre><code>rTD xs = do\n    (m, ys) &lt;- get\n    let m' = ...\n    let ys' = ...\n    put (m', ys')\n</code></pre>\n\n<p>The gets/modify case:</p>\n\n<pre><code>rTD xs = do\n    m &lt;- gets fst\n    let m' = ...\n    modify (\\s -&gt; (m', snd s))\n</code></pre>\n\n<p>With lens:</p>\n\n<pre><code>rTD xs = do\n    _1 %= Map.insert \"key\" 777\n    _2 %= (\"foo\":)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 41026976, "answer_count": 1, "score": 0, "last_activity_date": 1481143257, "creation_date": 1481141904, "question_id": 41026605, "link": "https://stackoverflow.com/questions/41026605/haskell-put-function-on-pair", "title": "Haskell - put function on pair", "body": "<p>I have a following <code>State</code> monad:   </p>\n\n<pre><code>type S = (M.Map String Integer, [String])\n</code></pre>\n\n<p>Now, I have a function:   </p>\n\n<pre><code>rTD :: [String] -&gt; ReaderT Env (StateT S (ErrorT String IO)) \nrTD (s, _) &lt;- get\n-- (1) how to here use put function to modify one element of pair my Store ?\n</code></pre>\n\n<p>(1) how to here use put function to modify one element of pair my Store ?<br>\nThanks in advance.</p>\n"}, {"tags": ["list", "haskell", "tuples"], "comments": [{"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1481141808, "post_id": 41026518, "comment_id": 69260411, "body": "&quot;Each tuple is a tuple as well.&quot; You mean each tuple consists of tuples as well."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1481142196, "post_id": 41026518, "comment_id": 69260633, "body": "Is this a homework exercise? That is do you want a hint or do you want a solution?"}, {"owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "reply_to_user": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1481142253, "post_id": 41026518, "comment_id": 69260676, "body": "Yes. May be the example I posted is better than my wording :)"}, {"owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "reply_to_user": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 2, "creation_date": 1481142384, "post_id": 41026518, "comment_id": 69260749, "body": "@jpath : No it is not a home work :) I am nearly 60 years old. I m trying to solve jigsaw sudoko, and I needed to remove duplicates."}, {"owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "reply_to_user": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1481142880, "post_id": 41026518, "comment_id": 69261017, "body": "@jpath: if my list seems cryptic, then these represent cells in a jigsaw sudoko. Each cell is of type (Int,Int,Int,Int) repressing the row, column, region and value of the cell. I have written a function that given a grid, I obtained the cells which have same potential values. The example is such a list of such cells."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "edited": false, "score": 0, "creation_date": 1481143197, "post_id": 41026839, "comment_id": 69261181, "body": "Well, thanks. but I tried it, and it gave me the same list, i.e, it didn&#39;t remove conjugates."}, {"owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "edited": false, "score": 0, "creation_date": 1481152947, "post_id": 41026839, "comment_id": 69265832, "body": "Yes, it worked. Thanks. Interesting, though is that the order of the resulting list is the reverse of the list that jpath solution produces. I think I can retain the order by applying the reverse function."}, {"owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "edited": false, "score": 0, "creation_date": 1481153087, "post_id": 41026839, "comment_id": 69265890, "body": "As a side note, is there anyway in Haskell to measure the time that two function take to perform a task. For example how can I compare if ja solution is faster or slower than jpath solution?"}, {"owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "edited": false, "score": 0, "creation_date": 1481154372, "post_id": 41026839, "comment_id": 69266345, "body": "I know that using ghci to benchmark functions is not accurate. However, I used :set +s to compare the solutions I got. The results are:  (0.06 secs, 272,840 bytes) -- for removeConj (0.07 secs, 277,416 bytes) -- for nubTuples  p.s: I used this on my sample which doesn&#39;t provide real indicators."}], "tags": [], "owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "is_accepted": true, "score": 2, "last_activity_date": 1481151511, "last_edit_date": 1481151511, "creation_date": 1481142694, "answer_id": 41026839, "question_id": 41026518, "link": "https://stackoverflow.com/questions/41026518/removing-conjugate-tuples-from-a-list-in-haskell/41026839#41026839", "title": "Removing conjugate tuples from a list in Haskell", "body": "<p>\"Each element of the tuple is a tuple as well\"</p>\n\n<pre><code>removeConj xs = foldl f [] xs\n  where f b a = if (elem (snd a, fst a) b) then b else (a:b) \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "edited": false, "score": 0, "creation_date": 1481143517, "post_id": 41026902, "comment_id": 69261345, "body": "many thanks @jpath. it worked. The order of the resulting list is not important to me."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "reply_to_user": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "edited": false, "score": 0, "creation_date": 1481144083, "post_id": 41026902, "comment_id": 69261693, "body": "@HassanShahin You are welcome. I&#39;ve still added another version that keeps the order and has the added benefit of being lazy."}, {"owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "edited": false, "score": 0, "creation_date": 1481144338, "post_id": 41026902, "comment_id": 69261860, "body": "Yeah. I noticed. Thanks again @jpath"}, {"owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "edited": false, "score": 0, "creation_date": 1481145295, "post_id": 41026902, "comment_id": 69262388, "body": "This is great. But you are moving to the more advanced stuff. I am only a old beginner :). Many thanks."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "reply_to_user": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "edited": false, "score": 0, "creation_date": 1481145476, "post_id": 41026902, "comment_id": 69262490, "body": "Yeah, I already felt a bit guilty when writing <code>join bimap</code> and the really long type of <code>nubFourTuples</code>. And the whole <code>discrimination</code> is probably already too much as well for a beginner."}], "tags": [], "owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "is_accepted": false, "score": 5, "last_activity_date": 1481145489, "last_edit_date": 1481145489, "creation_date": 1481142978, "answer_id": 41026902, "question_id": 41026518, "link": "https://stackoverflow.com/questions/41026518/removing-conjugate-tuples-from-a-list-in-haskell/41026902#41026902", "title": "Removing conjugate tuples from a list in Haskell", "body": "<p>First we can generalise the type to the following:</p>\n\n<pre><code>nubTuples :: Eq a =&gt; [(a,a)] -&gt; [(a,a)]\n</code></pre>\n\n<p>However, to make things efficient and easier let's also ask for an <code>Ord</code> instance for <code>a</code>. Why does this make things easier? Because now we can transform our tuples into an ordered normal form. Then we can simply <code>nub . sort</code>. The below implemenation actually just sorts and nubs based on that representation, so that <code>nubTuples [(2,1)] = [(2,1)]</code> and not <code>[(1,2)]</code>.</p>\n\n<pre><code>import Data.List (sortOn, nubBy)\nimport Data.Tuple (swap)\n\nnubTuples :: Ord a =&gt; [(a,a)] -&gt; [(a,a)]\nnubTuples = nubBy unorderedCompare . sortOn orderTuple\n  where orderTuple (x,y)\n          | x &lt; y = (x,y)\n          | otherwise = (y,x)\n        unorderedCompare x y = x == y || swap x == y\n</code></pre>\n\n<p>Note that this changes the order and removes duplicates:</p>\n\n<pre><code>nubTuples [(3,4),(1,2),(1,2)] = [(1,2),(3,4)]\n</code></pre>\n\n<p>As for changing the order we can fix this by using the <code>nubWith</code> function from <code>Data.Discrimination</code> in the <a href=\"https://hackage.haskell.org/package/discrimination-0.2.1/docs/Data-Discrimination-Grouping.html\" rel=\"nofollow noreferrer\"><code>discrimination</code></a> package. Then our code would become the following:</p>\n\n<pre><code> import Data.Discrimination (nubWith, Grouping)\n\n nubTuples :: (Ord a, Grouping a) =&gt; [(a,a)] -&gt; [(a,a)]\n nubTuples = nubWith orderTuple\n   where orderTuple (x,y)\n           | x &lt; y = (x,y)\n           | otherwise = (y,x)\n</code></pre>\n\n<p>This doesn't require sorting, keeps the order intact and is maximally lazy (which is often very important for performance). It still removes duplicates though.</p>\n\n<p>You can simply derive a <code>Grouping</code> instance for any of your types likes this:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\nimport Data.Discrimination\nimport GHC.Generics\n\ndata A = A deriving Generic\ninstance Grouping A\n</code></pre>\n\n<p>Note that there is no instance of <code>Grouping</code> for 4-tuples. This would be a way to work around it:</p>\n\n<pre><code>nubFourTuples :: (Grouping a, Ord a, Grouping b, Ord b,\n                  Grouping c, Ord c, Grouping d, Ord d)\n              =&gt; [((a,b,c,d),(a,b,c,d))] -&gt; [((a,b,c,d),(a,b,c,d))]\nnubFourTuples = (fmap . both) reassociate . nubTuples . (fmap . both) associate\n   where associate (w,x,y,z) = ((w,x),(y,z))\n         reassociate ((w,x),(y,z)) = (w,x,y,z)\n         both f (x,y) = (f x, f y)\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 1, "accepted_answer_id": 41026839, "answer_count": 2, "score": 3, "last_activity_date": 1481151511, "creation_date": 1481141586, "last_edit_date": 1481141913, "question_id": 41026518, "link": "https://stackoverflow.com/questions/41026518/removing-conjugate-tuples-from-a-list-in-haskell", "title": "Removing conjugate tuples from a list in Haskell", "body": "<p>I have a list of tuples. Each tuple is a tuple as well. For each outer tuple, I have a conjugate tuple. By this I mean that if I have (a,b) in the list then I also have (b,a) as well. What I want is to remove the conjugate tuples from the list.</p>\n\n<p>To give you a concrete example of my list here it is:</p>\n\n<p><code>[((1,2,1,0),(5,2,1,0)),((2,4,4,0),(2,5,4,0)),((2,5,4,0),(2,4,4,0)),((3,1,1,0),(3,3,2,0)),((3,3,2,0),(3,1,1,0)),((5,1,7,0),(8,1,7,0)),((5,2,1,0),(1,2,1,0)),((5,5,8,0),(8,5,8,0)),((5,6,6,0),(8,6,8,0)),((5,9,9,0),(8,9,9,0)),((6,3,5,0),(6,8,9,0)),((6,8,9,0),(6,3,5,0)),((7,7,6,0),(9,7,6,0)),((8,1,7,0),(5,1,7,0)),((8,5,8,0),(5,5,8,0)),((8,6,8,0),(5,6,6,0)),((8,9,9,0),(5,9,9,0)),((9,7,6,0),(7,7,6,0))]</code></p>\n\n<p>The result after removing the conjugate tuples should be:</p>\n\n<p><code>[((1,2,1,0),(5,2,1,0)),((2,4,4,0),(2,5,4,0)),((3,1,1,0),(3,3,2,0)),((5,1,7,0),(8,1,7,0)),((5,5,8,0),(8,5,8,0)),((5,6,6,0),(8,6,8,0)),((5,9,9,0),(8,9,9,0)),((6,3,5,0),(6,8,9,0)),((7,7,6,0),(9,7,6,0)),]</code></p>\n\n<p>I have tried for hours with no success. Any help will be appreciated.</p>\n"}, {"tags": ["haskell", "monads", "typeclass", "do-notation"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1481130669, "post_id": 41022833, "comment_id": 69253847, "body": "Surely you would want something more like <code>(&gt;&gt;=) :: MonadDict m -&gt; m a -&gt; (a -&gt; m b) -&gt; m b</code>, or what do you plan to do if you get three different dictionaries?"}, {"owner": {"reputation": 5892, "user_id": 293205, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/49d9dd9a9dc4f639823256df0ae14535?s=128&d=identicon&r=PG", "display_name": "coubeatczech", "link": "https://stackoverflow.com/users/293205/coubeatczech"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1481131072, "post_id": 41022833, "comment_id": 69254107, "body": "@DanielWagner I use it only once see the <code>usage</code> part where I pass the dictionary at the very end"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1481135279, "post_id": 41022833, "comment_id": 69256570, "body": "Usually simple invariants like &quot;I only pass one&quot; are good things to ask the type-checker to check for you. The type I proposed is one way to ask it to do so."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1481135565, "post_id": 41022833, "comment_id": 69256743, "body": "@DanielWagner How would you pass multiple <code>MonadDict m</code>s to <code>&gt;&gt;=</code>; only one is exposed, the final <code>MonadDict m</code> argument; as long as <code>&gt;&gt;=</code> passes the argument to that reader to the other two readers the same dictionary will be used for all 3. <code>(&gt;&gt;=)</code>&#39;s type is the same as preludes <code>(&gt;&gt;=)</code> for <code>ReaderT (MonadDict m) m</code>, but has a different implementation."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1481138441, "post_id": 41022833, "comment_id": 69258427, "body": "@Cirdec Ah, you&#39;re right: I had completely misread the type signature!"}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1481140524, "post_id": 41024480, "comment_id": 69259568, "body": "Interesting. Turns out this even works with <code>-XRecordWildCards</code>: if you call the <code>bind</code> fields <code>&gt;&gt;=</code> and <code>&gt;&gt;</code> respectively, you can just use <code>monadicCode MonadDict{..} = do ...</code>. Whether any of this is a good idea I&#39;m less than certain, but all this is definitely intriguing."}], "tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": true, "score": 6, "last_activity_date": 1481142194, "last_edit_date": 1481142194, "creation_date": 1481134458, "answer_id": 41024480, "question_id": 41022833, "link": "https://stackoverflow.com/questions/41022833/rebind-do-notation-with-typeclass-free-monad/41024480#41024480", "title": "Rebind do notation with typeclass-free monad", "body": "<p>You can do like this:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE RebindableSyntax #-}\n{-# LANGUAGE RecordWildCards #-}\n\nmodule Lib where\nimport Prelude hiding(return, fail, (&gt;&gt;=), (&gt;&gt;))\n\ndata MonadDict m = MonadDict\n    { (&gt;&gt;=)  :: forall a b. m a -&gt; (a -&gt; m b) -&gt; m b\n    , (&gt;&gt;)   :: forall a b. m a -&gt; m b -&gt; m b\n    , return :: forall a. a -&gt; m a\n    , fail   :: forall a. String -&gt; m a\n    }\n\nmonadDictIO :: MonadDict IO\nmonadDictIO = ...\n\nfoo :: MonadDict m -&gt; String -&gt; m ()\nfoo = ...\n\nusage = let\n    monadicCode m@MonadDict{..} = do\n        ln &lt;- getLine\n        putStrLn ln\n        foo m ln\n    in monadicCode monadDictIO\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 1, "last_activity_date": 1481140949, "last_edit_date": 1481140949, "creation_date": 1481139084, "answer_id": 41025805, "question_id": 41022833, "link": "https://stackoverflow.com/questions/41022833/rebind-do-notation-with-typeclass-free-monad/41025805#41025805", "title": "Rebind do notation with typeclass-free monad", "body": "<p>The short and incorrect answer is drop the <code>MonadDict m</code> argument from the return type of the second argument to <code>(&gt;&gt;=)</code>:</p>\n\n<pre><code>(&gt;&gt;=) :: (MonadDict m -&gt; m a) -&gt; (a -&gt; m b) -&gt; (MonadDict m -&gt; m b)\n</code></pre>\n\n<p>But that doesn't really solve all of your syntax problems. If someone has an existing arrow with the type <code>Monad m =&gt; a -&gt; m b</code>, with explicit dictionary passing it'll have the type <code>a -&gt; (MonadDict m -&gt; m b)</code>, and won't be usable as the second argument to <code>(&gt;&gt;=)</code>. If there were a function <code>drop :: (MonadDict m -&gt; m b) -&gt; m b</code> to make it compatible with the second argument then there'd be no reason to pass <code>MonadDict</code>s around.</p>\n\n<hr>\n\n<p>You're reinventing the <a href=\"http://hackage.haskell.org/package/transformers-0.5.2.0/docs/Control-Monad-Trans-Reader.html#v:ReaderT\" rel=\"nofollow noreferrer\"><code>ReaderT</code></a> transformer to read a <code>MonadDict m</code>.</p>\n\n<pre><code>newtype ReaderT r m a = ReaderT { runReaderT :: r -&gt; m a }\n</code></pre>\n\n<p>Every time you're using <code>const</code> it's the equivalent of <code>lift</code> ing an <code>m a</code> into <code>ReaderT (MonadDict m) m a</code>. Your example wouldn't look so unfamiliar if you wrote it with <code>lift</code> instead of <code>const</code>.</p>\n\n<pre><code>usage = let\n  monadicCode = do\n    ln &lt;- lift getLine \n    lift . putStrLn $ ln\n  in monadicCode monadDictIO\n</code></pre>\n\n<p>Here's a complete example using <code>ReaderT</code>; it'd probably be better to make a new type for <code>ReaderT (MonadDict m) m</code> and a different name for <code>lift</code>. The implementation of <code>(&gt;&gt;=)</code> and <code>return</code> is identical to <code>ReaderT</code>s, except it uses the <code>bind</code> or <code>ret</code> from the <code>MonadDict</code>.</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE RebindableSyntax #-}\n\nmodule Lib\n    ( usage\n    ) where\n\nimport Prelude hiding ((&gt;&gt;=), return)\nimport qualified Prelude as P ((&gt;&gt;=), return)\nimport Control.Monad.Trans.Reader\n\ndata MonadDict m = MonadDict {\n  bind :: forall a b. m a -&gt; (a -&gt; m b) -&gt; m b ,\n  ret :: forall a. a -&gt; m a }\n\ntype ReadM m a = ReaderT (MonadDict m) m a\n\n(&gt;&gt;=) :: ReadM m a -&gt; (a -&gt; ReadM m b) -&gt; ReadM m b\nm &gt;&gt;= k = ReaderT $ \\d@MonadDict { bind = bind } -&gt; bind (runReaderT m d) (\\a -&gt; runReaderT (k a) d)\n\nreturn :: a -&gt; ReadM m a\nreturn a = ReaderT $ \\d@MonadDict { ret = ret } -&gt; ret a\n\nlift :: m a -&gt; ReadM m a\nlift m = ReaderT $ \\_ -&gt; m\n\nmonadDict :: Monad m =&gt; MonadDict m\nmonadDict = MonadDict {\n  bind = (P.&gt;&gt;=),\n  ret  = P.return\n}\n\nexample1 :: String -&gt; ReadM IO ()\nexample1 a = do\n    lift . putStrLn $ a\n    lift . putStrLn $ a\n\nexample2 :: ReadM IO ()\nexample2 = do\n    example1 \"Hello\"\n    ln &lt;- lift getLine \n    lift . putStrLn $ ln\n\nusage :: IO ()\nusage = runReaderT example2 monadDict\n</code></pre>\n\n<p>If you give it its own type you can equip it with a <code>Monad</code> instance independently of the underlying <code>m</code>, and dispense with <code>RebindableSyntax</code>.</p>\n\n<pre><code>newtype ReadMD m a = ReadMD {runReadMD :: MonadDict m -&gt; m a}\n\ninstance Functor (ReadMD f) where\n    fmap = liftM\n\ninstance Applicative (ReadMD f) where\n    pure = return\n    (&lt;*&gt;) = ap\n\ninstance Monad (ReadMD m) where\n    m &gt;&gt;= k = ReadMD $ \\d@MonadDict { bind = bind } -&gt; bind (runReadMD m d) (\\a -&gt; runReadMD (k a) d)\n    return a = ReadMD $ \\d@MonadDict { ret = ret } -&gt; ret a\n</code></pre>\n"}], "owner": {"reputation": 5892, "user_id": 293205, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/49d9dd9a9dc4f639823256df0ae14535?s=128&d=identicon&r=PG", "display_name": "coubeatczech", "link": "https://stackoverflow.com/users/293205/coubeatczech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 41024480, "answer_count": 2, "score": 2, "last_activity_date": 1481142194, "creation_date": 1481128869, "question_id": 41022833, "link": "https://stackoverflow.com/questions/41022833/rebind-do-notation-with-typeclass-free-monad", "title": "Rebind do notation with typeclass-free monad", "body": "<p>It is possible to rebind the (>>=) and return for a monad using explicit dictionary passing like this:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE RebindableSyntax #-}\n\nmodule Lib where\n\nimport Prelude hiding ((&gt;&gt;=), return)\n\ndata MonadDict m = MonadDict {\n  bind :: forall a b. m a -&gt; (a -&gt; m b) -&gt; m b ,\n  ret :: forall a. a -&gt; m a }\n\n(&gt;&gt;=) :: (MonadDict m -&gt; m a) -&gt; (a -&gt; (MonadDict m -&gt; m b)) -&gt; (MonadDict m -&gt; m b)\nreturn :: a -&gt; (MonadDict m -&gt; m a)\n\nmonadDictIO :: MonadDict IO\n\nusage = let\n  monadicCode = do\n    ln &lt;- const getLine \n    const . putStrLn $ ln\n  in monadicCode monadDictIO\n</code></pre>\n\n<p>Is there a better way, how to represent the monad so one can avoid ignoring the <code>MonadDict</code> monad instance argument (using <code>const</code>) in every usage of the monadic action?</p>\n"}, {"tags": ["vb.net", "haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1481128675, "post_id": 41022254, "comment_id": 69252571, "body": "Closely related: <a href=\"http://stackoverflow.com/q/9975836/2751851\"><i>How can I simulate Haskell&#39;s \u201cEither a b\u201d in Java</i></a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1481130577, "post_id": 41022254, "comment_id": 69253794, "body": "Why can&#39;t you define recursive structures? From a few seconds Googling that looks <a href=\"https://www.codeproject.com/articles/4647/a-simple-binary-tree-implementation-with-vb-net\" rel=\"nofollow noreferrer\">pretty trivial</a> to me."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1481131813, "post_id": 41022254, "comment_id": 69254562, "body": "Your <code>Tag</code> type isn&#39;t actually used in your example."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1481132249, "post_id": 41022254, "comment_id": 69254838, "body": "<code>HTML</code> doesn&#39;t have a valid definition; you reuse the <code>Tag</code> data constructor. It&#39;s also not very interesting; it doesn&#39;t define a tree of <code>Content</code>, it just allows you to wrap a <code>Content</code> value in an arbitrary number of wrappers. As such, it&#39;s isomorphic to <code>type HTML&#39; = (Int, Content)</code>."}, {"owner": {"reputation": 81, "user_id": 5423571, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/vuFkZ.jpg?s=128&g=1", "display_name": "lsalvatore", "link": "https://stackoverflow.com/users/5423571/lsalvatore"}, "edited": false, "score": 0, "creation_date": 1481134264, "post_id": 41022254, "comment_id": 69256024, "body": "Sorry, true. I have added B and R data constructor."}, {"owner": {"reputation": 81, "user_id": 5423571, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/vuFkZ.jpg?s=128&g=1", "display_name": "lsalvatore", "link": "https://stackoverflow.com/users/5423571/lsalvatore"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1481135647, "post_id": 41022254, "comment_id": 69256816, "body": "@DanielWagner Thanks! I haven&#39;t tried with class yet. The problem is when i define a structure. It can&#39;t be recursive"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1481143598, "post_id": 41022254, "comment_id": 69261389, "body": "@Isalvatore .Net structures can&#39;t be recursive, classes can. <a href=\"https://msdn.microsoft.com/en-us/library/ms229017(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Always use classes instead of structures</a> unless you <i>really</i> know what you&#39;re doing. Structures are passed as value types, and flattened wherever they are used; a recursive structure would be flattened into itself and either be empty or have infinite size. <a href=\"http://stackoverflow.com/questions/12454794/why-covariance-and-contravariance-do-not-support-value-type\">Variance on structures doesn&#39;t work correctly</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 0, "creation_date": 1481180868, "post_id": 41027361, "comment_id": 69274657, "body": "To actually use this you need to do a typecase/downcast with is ugly af.  If you add a method corresponding to the appropriate fold operation or to a single layer of pattern matching to the base class, then this problem and the first one you mention are both solved.  While new subclasses like <code>TrickedYou</code> can be added, they will be forced to observationally behave (modulo side-effects and downcasting) like the modeled algebraic data type."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 0, "creation_date": 1481181928, "post_id": 41027361, "comment_id": 69275188, "body": "@DerekElkins That&#39;s what the last linked answer is. I have no desire to ever write generic code with variance markings in VB.Net."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 1, "last_activity_date": 1481144751, "last_edit_date": 1495540906, "creation_date": 1481144751, "answer_id": 41027361, "question_id": 41022254, "link": "https://stackoverflow.com/questions/41022254/how-i-can-translate-the-following-datatype-defined-in-haskell-to-vb-net/41027361#41027361", "title": "How i can translate the following datatype defined in Haskell to VB .net?", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/ms973803.aspx\" rel=\"nofollow noreferrer\">standard OO way of doing this</a> would be</p>\n\n<pre><code>Public MustInherit Class HTML\n    Public Tag as String\nEnd Class\n\nPublic Class B\n    Inherits HTML\n\n    Public Content as String\nEnd Class\n\nPublic Class R\n    Inherits HTML\n\n    Public HTML as HTML\nEnd Class\n</code></pre>\n\n<p>This isn't the same as the Haskell datatype. Besides possibly being <code>null</code>, someone could define another class that's neither <code>B</code> nor <code>R</code></p>\n\n<pre><code>Public Class TrickedYou\n    Inherits HTML\nEnd Class\n</code></pre>\n\n<p>There's <a href=\"https://stackoverflow.com/a/18426577/414413\">another way to express sum types in .Net</a> that matches Haskell's sum types up to <code>null</code>s. It uses generics and is fairly alien to OO programming; the closest OO design pattern is a visitor, which almost gets a sum type right. The visitor OO pattern doesn't get the generic return type right.</p>\n"}], "owner": {"reputation": 81, "user_id": 5423571, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/vuFkZ.jpg?s=128&g=1", "display_name": "lsalvatore", "link": "https://stackoverflow.com/users/5423571/lsalvatore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481144751, "creation_date": 1481127269, "last_edit_date": 1481134848, "question_id": 41022254, "link": "https://stackoverflow.com/questions/41022254/how-i-can-translate-the-following-datatype-defined-in-haskell-to-vb-net", "title": "How i can translate the following datatype defined in Haskell to VB .net?", "body": "<p>The following datatype defined in Haskell is:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type Tag = String\ntype Content = String\ndata HTML = B Tag Content | R Tag HTML\n</code></pre>\n\n<p>But in VB.Net i can't define recursive structures. And i don't know how to define the \"|\" that is a some kind of \"or\"/\"union\" in Haskell.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 5466, "user_id": 1803692, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/umD6Q.jpg?s=128&g=1", "display_name": "Vogel612", "link": "https://stackoverflow.com/users/1803692/vogel612"}, "reply_to_user": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "edited": false, "score": 2, "creation_date": 1481125226, "post_id": 41021145, "comment_id": 69250164, "body": "@mnoronha nope. This is pretty much pseudocode. Accordingly its not on-topic for Code Review. They require the full code (under review) to be present in the question. So this might become a good Code Review question,but only with significant edits."}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "reply_to_user": {"reputation": 5466, "user_id": 1803692, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/umD6Q.jpg?s=128&g=1", "display_name": "Vogel612", "link": "https://stackoverflow.com/users/1803692/vogel612"}, "edited": false, "score": 0, "creation_date": 1481125770, "post_id": 41021145, "comment_id": 69250539, "body": "@Vogel612 Pseudocode as in an incomplete code sample?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1481128458, "post_id": 41021145, "comment_id": 69252394, "body": "What is <code>MyObjectData</code>? In particular, what are the types of its fields?"}, {"owner": {"reputation": 7, "user_id": 7257630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dfebb58190e1d18b812a3c0b3f697a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jojika", "link": "https://stackoverflow.com/users/7257630/jojika"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1481129780, "post_id": 41021145, "comment_id": 69253314, "body": "@duplode, different ones."}], "answers": [{"tags": [], "owner": {"reputation": 336, "user_id": 7236501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f52887fba37383964c102def911c9bc?s=128&d=identicon&r=PG&f=1", "display_name": "shinobi", "link": "https://stackoverflow.com/users/7236501/shinobi"}, "is_accepted": false, "score": 0, "last_activity_date": 1481128510, "creation_date": 1481128510, "answer_id": 41022694, "question_id": 41021145, "link": "https://stackoverflow.com/questions/41021145/how-can-i-simplify-this-in-haskell/41022694#41022694", "title": "How can I simplify this in Haskell?", "body": "<p>By all likelihood, you can use neither <code>map</code> nor <code>mapM</code>, because, for all you've given us to look at, there isn't necessarily any single type to which each of <code>a</code>, <code>b</code>, <code>c</code>, etc. would be mapped.  For that matter, I doubt there's any sensible way to simplify this in the general case.</p>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 1, "last_activity_date": 1481155728, "creation_date": 1481155728, "answer_id": 41029599, "question_id": 41021145, "link": "https://stackoverflow.com/questions/41021145/how-can-i-simplify-this-in-haskell/41029599#41029599", "title": "How can I simplify this in Haskell?", "body": "<p>Not really.  You could mess with <a href=\"https://hackage.haskell.org/package/base-4.7.0.1/docs/Data-Data.html\" rel=\"nofollow noreferrer\">data generics</a>, which is a bit of a sledgehammer unless you are doing this for a number of data types.  If it's just one or two instances, I'd just bite the bullet and write out the boilerplate.  If you have a big schema like this, it's worth reading the <a href=\"http://research.microsoft.com/en-us/um/people/simonpj/papers/hmap/\" rel=\"nofollow noreferrer\">Scrap Your Boilerplate</a> paper and using generics.  (N.B. there may be more modern approaches to generics, I'm not sure, this is the only one I've ever used)</p>\n\n<p>There are \"cleaner\" ways, depending on how you decide your database abstraction works.  If your columns are to be treated as a \"serial stream\", you could make a class for deserializable objects:</p>\n\n<pre><code>import Control.Monad.Supply\n\nclass FromSQLStream a where\n    fromSQLStream :: Supply SqlData a\n\n-- All FromSQLs are FromSQLStreams, but a superclass isn't a good idea\n-- for some reasons here...\nfromSqlS :: (FromSQL a) =&gt; Supply SqlData a\nfromSqlS = fromSql &lt;$&gt; supply\n</code></pre>\n\n<p>(I'm guessing about the names <code>FromSQL</code> and <code>SqlData</code>, but this is probably roughly how your SQL library works)</p>\n\n<p>Then at least it composes a bit:</p>\n\n<pre><code>instance FromSQLStream MyObjectDataNested where\n    fromSQLStream = MyObjectDataNested &lt;$&gt; fromSqlS &lt;*&gt; fromSqlS &lt;*&gt; fromSqlS\n\ninstance FromSQLStream MyObjectData where\n    fromSqlStream = \n      MyObjectData &lt;$&gt; fromSqlS &lt;*&gt; fromSqlS &lt;*&gt; fromSqlS &lt;*&gt; fromSqlS\n                   &lt;*&gt; fromSqlS &lt;*&gt; fromSqlS &lt;*&gt; fromSqlS &lt;*&gt; fromSqlS\n                   &lt;*&gt; fromSqlS &lt;*&gt; fromSQLStream\n</code></pre>\n\n<p>Which is awful repetitive, but under the hood it's less repetitive than it looks because of the type information floating around directing things.  But I don't think you can do better than that without generics.</p>\n"}], "owner": {"reputation": 7, "user_id": 7257630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dfebb58190e1d18b812a3c0b3f697a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jojika", "link": "https://stackoverflow.com/users/7257630/jojika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 41029599, "answer_count": 2, "score": 0, "last_activity_date": 1481166407, "creation_date": 1481123962, "last_edit_date": 1481129812, "question_id": 41021145, "link": "https://stackoverflow.com/questions/41021145/how-can-i-simplify-this-in-haskell", "title": "How can I simplify this in Haskell?", "body": "<p>I have something this:</p>\n\n<pre><code>func1 :: IO [MyObjectData]\nfunc1 = do\n  res1 &lt;- quickQuery conn123 \"select * from table1\" []\n  return $ map parseMyObjectData res1\n\n  where\n    parseMyObjectData [a, b, c, d, e, f, g, h, i, j, k, l] =\n\n    MyObjectData (fromSql a) (fromSql b) (fromSql c) (fromSql d) (fromSql e) \n      (fromSql f) (fromSql g) (fromSql h) (fromSql i)\n        (MyObjectDataNested \n          (fromSql j) (fromSql k) (fromSql l))\n</code></pre>\n\n<p>It's a simplified version. Is there any way to simplify it? I'm thinking that I should somehow use \"fromSql\" in map or mapM, but how exactly? Or....</p>\n"}, {"tags": ["haskell", "atom-editor"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1481128142, "post_id": 41021118, "comment_id": 69252185, "body": "By which means did you install the <a href=\"http://hackage.haskell.org/package/MonadRandom\" rel=\"nofollow noreferrer\">MonadRandom package</a>? Cabal, stack...?"}, {"owner": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1481193790, "post_id": 41021118, "comment_id": 69282216, "body": "I installed a full haskell package. I didn&#39;t install MoandRandom alone. when I load the script to ghci it works just fine."}, {"owner": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1481194957, "post_id": 41021118, "comment_id": 69282927, "body": "I found out that the problem is with ide-haskell. I will submit an issue in their github."}], "owner": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481160178, "creation_date": 1481123856, "last_edit_date": 1481160178, "question_id": 41021118, "link": "https://stackoverflow.com/questions/41021118/language-haskell-in-atom-only-recognizes-packages-in-prelude", "title": "language-haskell in atom only recognizes packages in Prelude", "body": "<p>I use <a href=\"https://atom.io/packages/language-haskell\" rel=\"nofollow noreferrer\"><code>language-haskell</code></a> package to turn my atom into a haskell aware text editor. In a <code>.hs</code> file when I try to import a package which is not in prelude e.g.:</p>\n\n<pre><code>import Control.Monad.Random\n</code></pre>\n\n<p>I get the following error:</p>\n\n<blockquote>\n  <p>Could not find module \u2018Control.Monad.Random\u2019 Use -v to see a list of\n  the files searched for.</p>\n</blockquote>\n\n<p>There seems to be a problem with <code>language-haskell</code> package.\ninfo: I am running a Mac OS X El Captain </p>\n"}, {"tags": ["haskell", "unicode"], "answers": [{"comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1481135569, "post_id": 41019129, "comment_id": 69256747, "body": "This is not fully correct. There are unicode characters that are represented in  2 Java chars. See my answer."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 1, "last_activity_date": 1481118390, "creation_date": 1481118390, "answer_id": 41019129, "question_id": 41018372, "link": "https://stackoverflow.com/questions/41018372/how-to-convert-string-like-u-to-text/41019129#41019129", "title": "How to convert string like &quot;//u****&quot; to text?", "body": "<p>If you replace <code>\\u</code> with <code>\\x</code> then this is a valid Haskell string literal.</p>\n\n<pre><code>my_string = \"\\x0050\\x0069\\x006e...\"\n</code></pre>\n\n<p>You can then convert to <code>Text</code> if you want, or leave it as <code>String</code>, or whatever.</p>\n"}, {"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 0, "last_activity_date": 1481136287, "last_edit_date": 1592644375, "creation_date": 1481135493, "answer_id": 41024783, "question_id": 41018372, "link": "https://stackoverflow.com/questions/41018372/how-to-convert-string-like-u-to-text/41024783#41024783", "title": "How to convert string like &quot;//u****&quot; to text?", "body": "<p>Watch out, Java normally uses UTF-16 to encode its strings, so interpreting the bytes as UTF-8 will probably not work.</p>\n<p>If the codes in your file are UTF-16, you need to do the following:</p>\n<ol>\n<li>find the numeric value (Unicode code point) for each quadrupel</li>\n<li>check if this is a high surrogate character. If this is so, the following character will be a low surrogate character. The pair of surrogate characters can be mapped to a Unicode point.</li>\n<li>make a String from your list of unicode numbers with <code>map fromEnum</code></li>\n</ol>\n<p>The following is a quote from the Java doc <a href=\"http://docs.oracle.com/javase/7/docs/api/\" rel=\"nofollow noreferrer\">http://docs.oracle.com/javase/7/docs/api/</a> :</p>\n<blockquote>\n<p>The char data type (and therefore the value that a Character object encapsulates) are based on the original Unicode specification, which defined characters as fixed-width 16-bit entities. The Unicode Standard has since been changed to allow for characters whose representation requires more than 16 bits. The range of legal code points is now U+0000 to U+10FFFF, known as Unicode scalar value. (Refer to the definition of the U+n notation in the Unicode Standard.)</p>\n<p>The set of characters from U+0000 to U+FFFF is sometimes referred to as the Basic Multilingual Plane (BMP). Characters whose code points are greater than U+FFFF are called supplementary characters. The Java platform uses the UTF-16 representation in char arrays and in the String and StringBuffer classes. In this representation, supplementary characters are represented as a pair of char values, the first from the high-surrogates range, (\\uD800-\\uDBFF), the second from the low-surrogates range (\\uDC00-\\uDFFF).</p>\n</blockquote>\n<p>Java has methods to combine a high surrogate character and a low surrogate character to get the Unicode point. You may want to check the source of the <code>java.lang.Character</code> class to find out how exactly they do this, but I guess it is some simple bit-operation.</p>\n<p>Another possibility would be to check for a Haskell library that does UTF-16 decoding.</p>\n"}, {"tags": [], "owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "is_accepted": true, "score": 1, "last_activity_date": 1481154167, "last_edit_date": 1481154167, "creation_date": 1481152929, "answer_id": 41029154, "question_id": 41018372, "link": "https://stackoverflow.com/questions/41018372/how-to-convert-string-like-u-to-text/41029154#41029154", "title": "How to convert string like &quot;//u****&quot; to text?", "body": "<p>A simple solution may look like this:</p>\n\n<pre><code>decodeJava = T.decodeUtf16BE . BS.concat . gobble\n\ngobble []                      = []\ngobble ('\\\\':'u':a:b:c:d:rest) = let sym = convert16 [a,b] [c,d]\n                                 in  sym : gobble rest\ngobble _                       = error \"decoding error\"\n\nconvert16 hi lo = BS.pack [read $ \"0x\"++hi, read $ \"0x\"++lo]\n</code></pre>\n\n<p><strong>Notes:</strong></p>\n\n<ul>\n<li>Your string is UTF16-encoded, therefore you need <code>decodeUtf16BE</code>.</li>\n<li>Decoding will fail if there are other characters in the string. This code will work with your example only if you remove the trailing <code>i</code>.</li>\n<li>Constructing the words by appending <code>0x</code> and, in particular, using <code>read</code> is very slow, but will do the trick for small data.</li>\n</ul>\n"}], "owner": {"reputation": 811, "user_id": 4997183, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-MCQgzoKAdi4/AAAAAAAAAAI/AAAAAAAAAAA/7oB88u1vGmY/photo.jpg?sz=128", "display_name": "Hailong Li", "link": "https://stackoverflow.com/users/4997183/hailong-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 41029154, "answer_count": 3, "score": 1, "last_activity_date": 1481240778, "creation_date": 1481116127, "last_edit_date": 1481240778, "question_id": 41018372, "link": "https://stackoverflow.com/questions/41018372/how-to-convert-string-like-u-to-text", "title": "How to convert string like &quot;//u****&quot; to text?", "body": "<p>I want to convert a string like \"//u****\" to text (unicode) in Haskell.</p>\n\n<p>I have a Java propertyes file, and it has the following content:</p>\n\n<pre><code>i18n.test.key=\\u0050\\u0069\\u006e\\u0067\\u0020\\uc190\\uc2e4\\ub960\\u0020\\ud50c\\ub7ec\\uadf8\\uc778\n</code></pre>\n\n<p>I wanna convert it to text (Unicode) in Haskell.</p>\n\n<p>I think I can do it like this:</p>\n\n<ol>\n<li>Convert \"\\u****\" to word8 array  </li>\n<li>Convert word8 array to ByteString  </li>\n<li>Use <code>Text.Encoding.decodeUtf8</code> convert ByteString to text</li>\n</ol>\n\n<p>But step 1 is little complicated for me.</p>\n\n<p>How to do it in Haskell?</p>\n"}, {"tags": ["haskell", "emacs", "intero"], "owner": {"reputation": 31, "user_id": 5315922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29597e8e5b5ccdcf21e0850b354e68?s=128&d=identicon&r=PG&f=1", "display_name": "Pieter Laeremans", "link": "https://stackoverflow.com/users/5315922/pieter-laeremans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1481113775, "creation_date": 1481113775, "question_id": 41017533, "link": "https://stackoverflow.com/questions/41017533/is-it-possible-in-emacs-intero-mode-to-start-a-session-on-a-remote-host", "title": "Is it possible in emacs intero-mode to start a session on a remote host", "body": "<p>I have:</p>\n\n<ul>\n<li>mac laptop (running emacs, haskell-mode intero installed)</li>\n<li>linux cluster (don't have root access)\n\n<ul>\n<li>can mount home partition using sshfs</li>\n<li>stack installed and running in user mode</li>\n</ul></li>\n</ul>\n\n<p>Would it be possible to let the stack and ghci and other backend processes execute on the cluster from my mac ? </p>\n\n<p>Thanks in advance,</p>\n"}, {"tags": ["haskell", "monads", "haskeline"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1481106965, "post_id": 41015045, "comment_id": 69237573, "body": "Try <code>liftIO (process $ words input)</code>."}, {"owner": {"reputation": 97, "user_id": 4119576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HYnsk.png?s=128&g=1", "display_name": "Wolfe", "link": "https://stackoverflow.com/users/4119576/wolfe"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1481107027, "post_id": 41015045, "comment_id": 69237623, "body": "That seems to do the trick.  Thanks!  Would you mind explaining exactly what this is doing?"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 4119576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HYnsk.png?s=128&g=1", "display_name": "Wolfe", "link": "https://stackoverflow.com/users/4119576/wolfe"}, "edited": false, "score": 0, "creation_date": 1481108160, "post_id": 41015328, "comment_id": 69238443, "body": "Great. Thanks a bunch!"}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 6, "last_activity_date": 1481107398, "creation_date": 1481107398, "answer_id": 41015328, "question_id": 41015045, "link": "https://stackoverflow.com/questions/41015045/use-the-input-from-haskelines-getinputline/41015328#41015328", "title": "Use the input from Haskeline&#39;s getInputLine", "body": "<p>All statements in a <code>do</code> block must have the same type (well, must have the same monad in their type). In your case, this is <code>InputT IO something</code> (with the monad being <code>InputT IO</code>).</p>\n\n<p><code>getInputLine \"$ \"</code> has type <code>InputT IO (Maybe String)</code>, so that part is OK.</p>\n\n<p>Then you have a <code>case</code> expression, which means all branches need to have the same type. The first branch is just <code>return ()</code>, which gets the type <code>InputT IO ()</code>. All good so far.</p>\n\n<p>The second branch is <code>process $ words input</code>. But this has type <code>IO ()</code>, not <code>InputT IO ()</code>, which is what the compiler expects at this point.</p>\n\n<p>To fix this: Fortunately there's an easy way to convert (\"lift\") a value of type <code>IO x</code> to <code>InputT IO x</code>, which is the <code>liftIO</code> function:</p>\n\n<pre><code>Just input -&gt; liftIO (process $ words input)\n</code></pre>\n\n<p>That is, <code>liftIO :: IO a -&gt; InputT IO a</code> (actually it's more general than that: <code>liftIO :: (MonadIO m) =&gt; IO a -&gt; m a</code> but that doesn't matter here).</p>\n"}], "owner": {"reputation": 97, "user_id": 4119576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HYnsk.png?s=128&g=1", "display_name": "Wolfe", "link": "https://stackoverflow.com/users/4119576/wolfe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 41015328, "answer_count": 1, "score": 4, "last_activity_date": 1481107398, "creation_date": 1481106585, "question_id": 41015045, "link": "https://stackoverflow.com/questions/41015045/use-the-input-from-haskelines-getinputline", "title": "Use the input from Haskeline&#39;s getInputLine", "body": "<p>I have the code</p>\n\n<pre><code> main :: IO()\n main = runInputT defaultSettings loop          \n where                                        \n   --loop :: InputT IO ()                     \n   loop = do                                  \n     minput &lt;- getInputLine \"$ \"              \n     case minput of                           \n       Nothing -&gt; return ()                   \n       Just input -&gt; process $ words input          \n     loop                                     \n</code></pre>\n\n<p>Where process has the type definition</p>\n\n<pre><code>process :: [String] -&gt; IO ()\n</code></pre>\n\n<p>However I get the error:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018IO\u2019 with \u2018InputT m\u2019                                                       \nExpected type: InputT m ()                                                                     \n  Actual type: IO ()                                                                           \n\u2022 In the expression: process $ words input                                                       \nIn a case alternative: Just input -&gt; process $ words input                                     \nIn a stmt of a 'do' block:                                                                     \n  case minput of {                                                                             \n    Nothing -&gt; return ()                                                                       \n    Just input -&gt; process $ words input }\n</code></pre>\n\n<p>I was wondering if anybody could explain what I'm doing wrong.\nI just want to raw input from getInputLine to do other things with.</p>\n\n<p>Thanks                                                                </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1481104790, "post_id": 41014371, "comment_id": 69236105, "body": "What is <code>s1</code> and <code>s2</code> ?"}, {"owner": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 1, "creation_date": 1481104834, "post_id": 41014371, "comment_id": 69236139, "body": "Please provide a <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>"}, {"owner": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "edited": false, "score": 0, "creation_date": 1481105340, "post_id": 41014371, "comment_id": 69236447, "body": "Oh I&#39;m sorry. s1 and s2 are two sonnets of the type list. I converted a string of the text with SplitOn to lists."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 1, "creation_date": 1481105390, "post_id": 41014371, "comment_id": 69236479, "body": "Also please provide the full error message. This way we can not see where the error occurs."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1481105534, "post_id": 41014371, "comment_id": 69236589, "body": "You just removed the actual code of your problem."}, {"owner": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "edited": false, "score": 0, "creation_date": 1481105604, "post_id": 41014371, "comment_id": 69236634, "body": "Sorry, I wasn&#39;t done yet."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 1, "creation_date": 1481105926, "post_id": 41014371, "comment_id": 69236849, "body": "The problem is, that <code>wordLengths</code> returns a list of the word lengths instead of one number. Furthermore you should also provide the definitions of <code>sonnet1&#47;2</code> and remove the import of <code>FPH</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1481115628, "post_id": 41014371, "comment_id": 69243273, "body": "Beware that <code>let ln [] = ... ; let ln (x:xs) = ...</code> defines <code>ln</code> only according to the second equation! The first one is shadowed (<code>-Wall</code> should warn you about that, turn it on!). You should use both equations inside the same let (remove the second <code>let</code> and indent the second <code>ln</code> under the first one)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1481120726, "post_id": 41014371, "comment_id": 69246965, "body": "<code>ln</code> is both unused and (more or less) the same as <code>sum</code>; why are you defining it in the first place?"}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": false, "score": 1, "last_activity_date": 1481106643, "last_edit_date": 1481106643, "creation_date": 1481106339, "answer_id": 41014942, "question_id": 41014371, "link": "https://stackoverflow.com/questions/41014371/division-in-haskell-doesnt-work-due-to-wrong-type/41014942#41014942", "title": "Division in Haskell doesn&#39;t work due to wrong type", "body": "<p>Let's start by walking through some types:</p>\n\n<pre><code>task :: IO ()\ntask = do\n    let wordLengths = map length -- (:: [[Char]] -&gt; [Int]) \n    let wl1 = wordLengths s1     -- (:: [Int])\n    let wl2 = wordLengths s2     -- (:: [Int])\n    let getsum1 = sum wl1        -- (:: Int)\n    let ln [] = 0\n    let ln (x:xs) =1 + ln xs\n    let average = wl1 `quot` getsum1\n    print average\n</code></pre>\n\n<p>The terms we should be looking at here are <code>wl1</code> and <code>getsum1</code>, since our error is occurring on the operation involving them. First, the function <code>quot</code>:</p>\n\n<pre><code>ghci&gt;&gt; :t quot\nIntegral a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>So we can apply it to two arguments that are members of the typeclass <code>Integral</code>. Do both are arguments satisfy that constraint? We said <code>getsum1</code> had type <code>Int</code> above, so we're good there. <code>wl1</code>, on the other hand, has type <code>[Int]</code>. There's our problem. </p>\n\n<p>How should we go about fixing this, based on what you've outlined? We want to divide the sum of lengths by the number of items in the list (presumably to get the average length of words from our original <code>[[Char]]</code>). So we'll want do divide <code>getsum1</code> by <code>length wl1</code> (depending on what sort of format you expect for the result, there are several ways you could do this).</p>\n"}], "owner": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1481106643, "creation_date": 1481104647, "last_edit_date": 1481105543, "question_id": 41014371, "link": "https://stackoverflow.com/questions/41014371/division-in-haskell-doesnt-work-due-to-wrong-type", "title": "Division in Haskell doesn&#39;t work due to wrong type", "body": "<p>I'm trying to get the sum of all elements in a list, what works so far. And I have the amount of elements. I want to divide the sum by the amount to get the average of all elements in this list. And the division gives me an error back I can't fix.\nMy code:</p>\n\n<pre><code>module HA\n\nwhere\n\nimport FPH\nimport Data.List.Split\nimport Data.Char\nimport qualified Data.Text hiding (length)\n\ns1 = splitOn \" \" sonnet18\ns2 = splitOn \" \" sonnet73\n\ncountSubStrs str sub = length $ Data.Text.breakOnAll (Data.Text.pack sub) (Data.Text.pack str)\n\ntask :: IO ()\ntask = do\n    let wordLengths = map length\n    let wl1 = wordLengths s1\n    let wl2 = wordLengths s2\n    let getsum1 = sum wl1\n    let ln [] = 0\n    let ln (x:xs) =1 + ln xs\n    let average = wl1 `quot` getsum1\n    print average\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>Couldn't match expected type '[Int]' with actual type 'Int'\nIn the second argument of `quot\u00b4, namely `getsum1\u00b4\nIn the expression: wl1 `quot\u00b4 getsum1\nIn an equation for `average\u00b4: average = wl1 `quot\u00b4 getsum1\n</code></pre>\n"}, {"tags": ["haskell", "term"], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1481090523, "post_id": 41010361, "comment_id": 69228588, "body": "Huh, I never new about that &#39;\\^L&#39; syntax. The <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch2.html#x7-200002.6\" rel=\"nofollow noreferrer\">Report</a> is surprisingly quiet about what it means!"}], "tags": [], "owner": {"reputation": 1020, "user_id": 500060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c122862374667042520953c02df7d7ed?s=128&d=identicon&r=PG", "display_name": "glguy", "link": "https://stackoverflow.com/users/500060/glguy"}, "is_accepted": true, "score": 6, "last_activity_date": 1481090291, "last_edit_date": 1481090291, "creation_date": 1481090079, "answer_id": 41010361, "question_id": 41010153, "link": "https://stackoverflow.com/questions/41010153/how-to-compare-a-char-and-escape-terminal-escape-sequence/41010361#41010361", "title": "How to compare a char and escape terminal escape sequence", "body": "<p>You can look up the expected sequences using the <em>terminfo</em> database.</p>\n\n<p>See the module <a href=\"http://hackage.haskell.org/package/terminfo-0.4.0.2/docs/System-Console-Terminfo-Keys.html\" rel=\"noreferrer\">System.Terminfo.Keys</a>.</p>\n\n<p>For example:</p>\n\n<pre><code>Prelude System.Console.Terminfo&gt; t &lt;- setupTermFromEnv \nPrelude System.Console.Terminfo&gt; getCapability t keyLeft\nJust \"\\ESCOD\"\n</code></pre>\n\n<p>As far as the control characters, those will just appear as ASCII controls:</p>\n\n<pre><code>Prelude&gt; getChar -- pressing control L\n'\\f'\nPrelude&gt; '\\f' == '\\^L'\nTrue\n</code></pre>\n\n<p>You might like better to use a more complete library for interacting with the terminal like <a href=\"http://hackage.haskell.org/package/vty\" rel=\"noreferrer\">vty</a>.</p>\n"}], "owner": {"reputation": 97, "user_id": 4119576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HYnsk.png?s=128&g=1", "display_name": "Wolfe", "link": "https://stackoverflow.com/users/4119576/wolfe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 41010361, "answer_count": 1, "score": 2, "last_activity_date": 1481090291, "creation_date": 1481089005, "question_id": 41010153, "link": "https://stackoverflow.com/questions/41010153/how-to-compare-a-char-and-escape-terminal-escape-sequence", "title": "How to compare a char and escape terminal escape sequence", "body": "<p>If I have something like this:</p>\n\n<pre><code>main :: IO ()                    \nmain = do                        \n    hSetBuffering stdin NoBuffering\n    c &lt;- getChar                   \n</code></pre>\n\n<p>How would I go about comparing c to see if I got an escape sequence like the arrow keys or ctrl plus a key.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 7, "creation_date": 1481084509, "post_id": 41009213, "comment_id": 69226653, "body": "Welcome to Stack Overflow! I may be mistaken, but this just looks like a problem statement - not even a test case, let alone an attempt. Why don&#39;t you try solving this on your own and see where you get stuck, then asking about <i>that</i>? :)"}], "answers": [{"tags": [], "owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "is_accepted": false, "score": 1, "last_activity_date": 1481089864, "creation_date": 1481089864, "answer_id": 41010308, "question_id": 41009213, "link": "https://stackoverflow.com/questions/41009213/how-do-i-write-a-haskell-function-which-duplicates-every-occurrence-of-a-given-c/41010308#41010308", "title": "How do I write a haskell function which duplicates every occurrence of a given character in a string", "body": "<p>You can use <code>:</code> when writing function to work with list</p>\n\n<ul>\n<li><code>x:xs</code> to pattern match a list to head <code>x</code> and tail <code>xs</code> </li>\n<li><code>x:xs</code> to build a list from <code>x</code> and <code>xs</code></li>\n</ul>\n\n<p>There are many way to write <code>dup</code> function , this is my quick solution using guard <code>|</code></p>\n\n<pre><code>dup :: Char -&gt; String -&gt; String\ndup c [] = []\ndup c (x:xs)\n  | c == x    =  x:x:dup c xs\n  | otherwise =  x:dup c xs\n\nmain = do \n  let x = dup 'a' \"the cat in the hat has a fat head\"\n  putStrLn x\n</code></pre>\n\n<p>give</p>\n\n<pre><code>the caat in the haat haas aa faat heaad\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1513, "user_id": 6624417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a73a12db09cb90a99be14fa2bb7b6096?s=128&d=identicon&r=PG&f=1", "display_name": "E4z9", "link": "https://stackoverflow.com/users/6624417/e4z9"}, "is_accepted": false, "score": 0, "last_activity_date": 1481111201, "creation_date": 1481111201, "answer_id": 41016648, "question_id": 41009213, "link": "https://stackoverflow.com/questions/41009213/how-do-i-write-a-haskell-function-which-duplicates-every-occurrence-of-a-given-c/41016648#41016648", "title": "How do I write a haskell function which duplicates every occurrence of a given character in a string", "body": "<p>So many ways to do this ;), e.g.</p>\n\n<pre><code>dup :: Char -&gt; String -&gt; String\ndup charToDup s = concatMap dupC s\n  where dupC c = if c == charToDup then replicate 2 c\n                 else [c]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 893, "user_id": 6248287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tPegr.jpg?s=128&g=1", "display_name": "\u019b\u019b\u019b", "link": "https://stackoverflow.com/users/6248287/%c6%9b%c6%9b%c6%9b"}, "is_accepted": false, "score": 1, "last_activity_date": 1481128774, "creation_date": 1481128774, "answer_id": 41022792, "question_id": 41009213, "link": "https://stackoverflow.com/questions/41009213/how-do-i-write-a-haskell-function-which-duplicates-every-occurrence-of-a-given-c/41022792#41022792", "title": "How do I write a haskell function which duplicates every occurrence of a given character in a string", "body": "<p>You can solve it using list comprehension. </p>\n\n<pre><code>dup :: Char -&gt; [Char] -&gt; [Char]\ndup c string = [ ss | s &lt;- string, ss &lt;- if c == s then [c] ++ [s] else [s]]\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7255353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3081adbd000d5cf67a71cd41ce52f5e?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Higgs", "link": "https://stackoverflow.com/users/7255353/ryan-higgs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1481128774, "creation_date": 1481083466, "last_edit_date": 1481084341, "question_id": 41009213, "link": "https://stackoverflow.com/questions/41009213/how-do-i-write-a-haskell-function-which-duplicates-every-occurrence-of-a-given-c", "title": "How do I write a haskell function which duplicates every occurrence of a given character in a string", "body": "<pre><code>import Data.List\nimport System.IO\n\nimport Data.STRef\nimport Data.Char\n\nmain = do\n         let x = dup 'a' \"the cat in the hat has a fat head\"\n         putStrLn $ show $ x\n</code></pre>\n\n<p>This is what I have so far, I don't know where to go form here</p>\n"}, {"tags": ["haskell", "types", "ghc", "records"], "comments": [{"owner": {"reputation": 787, "user_id": 3307736, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/e9015090707d0e02ee256b8c4687951f?s=128&d=identicon&r=PG&f=1", "display_name": "Larry", "link": "https://stackoverflow.com/users/3307736/larry"}, "edited": false, "score": 0, "creation_date": 1481076771, "post_id": 41008295, "comment_id": 69224796, "body": "Can this be done in future release of ghc at all?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1481079957, "post_id": 41008295, "comment_id": 69225472, "body": "Presumably that they couldn&#39;t find a way to make it work."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 10, "last_activity_date": 1481083183, "last_edit_date": 1495535446, "creation_date": 1481083183, "answer_id": 41009175, "question_id": 41008295, "link": "https://stackoverflow.com/questions/41008295/why-duplicaterecordfields-cannot-have-type-inference/41009175#41009175", "title": "Why DuplicateRecordFields cannot have type inference?", "body": "<p>You will be interested in <a href=\"https://github.com/adamgundry/ghc-proposals/blob/overloaded-record-fields/proposals/0000-overloaded-record-fields.rst\" rel=\"nofollow noreferrer\"><code>OverloadedRecordFields</code></a> which is still being implemented.</p>\n\n<hr>\n\n<p>The current implementation is intentionally crippled, so as to not introduce too much new stuff all at once. Inferring the record projection types turns out to open a nasty can of worms (which the aforementioned extension addresses).</p>\n\n<p>Consider the following GHCi interaction</p>\n\n<pre><code>ghci&gt; data Record1 = Record1 { field :: Int }\nghci&gt; data Record2 = Record2 { field :: Bool }\nghci&gt; :t field\n</code></pre>\n\n<p>What should the type of <code>field</code> be now? Somehow,  we need a way to capture the notion of \"any record with a field called <code>field</code>\". To this end, <code>OverloadedRecordFields</code> introduces a new built-in type class </p>\n\n<blockquote>\n  <p>The new module <code>GHC.Records</code> defines the following:</p>\n\n<pre><code>class HasField (x :: k) r a | x r -&gt; a where\n  getField :: r -&gt; a\n</code></pre>\n  \n  <p>A <code>HasField x r a</code> constraint represents the fact that <code>x</code> is a field of\n  type <code>a</code> belonging to a record type <code>r</code>. The <code>getField</code> method gives the\n  record selector function.</p>\n</blockquote>\n\n<p>Then, from our example above, it is as if the following instances were magically generated by GHC (in fact that is not actually what will happen, but it is a good first approximation).</p>\n\n<pre><code>instance HasField \"field\" Record1 Int where\n  getField (Record1 f) = f\n\ninstance HasField \"field\" Record2 Bool where\n  getField (Record2 f) = f\n</code></pre>\n\n<p>If you are interested, I recommend reading the proposal. The other feature I haven't mentioned is the <code>IsLabel</code> class. Once all of this is implemented (and some more for updating records) I look forward to being able to <a href=\"https://stackoverflow.com/questions/38136144/replace-record-projection-function-with-lenses\">get my lenses for free</a> (so I can stop declaring field names starting with an underscore and enabling <code>TemplateHaskell</code> for <code>makeLenses</code>).</p>\n"}], "owner": {"reputation": 787, "user_id": 3307736, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/e9015090707d0e02ee256b8c4687951f?s=128&d=identicon&r=PG&f=1", "display_name": "Larry", "link": "https://stackoverflow.com/users/3307736/larry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 917, "favorite_count": 0, "accepted_answer_id": 41009175, "answer_count": 1, "score": 8, "last_activity_date": 1490054624, "creation_date": 1481076719, "last_edit_date": 1495542400, "question_id": 41008295, "link": "https://stackoverflow.com/questions/41008295/why-duplicaterecordfields-cannot-have-type-inference", "title": "Why DuplicateRecordFields cannot have type inference?", "body": "<p>Related post: <a href=\"https://stackoverflow.com/questions/37395098/how-to-disambiguate-selector-function\">How to disambiguate selector function?</a></p>\n\n<p><a href=\"https://ghc.haskell.org/trac/ghc/wiki/Records/OverloadedRecordFields/DuplicateRecordFields\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/wiki/Records/OverloadedRecordFields/DuplicateRecordFields</a></p>\n\n<blockquote>\n  <p>However, we do not infer the type of the argument to determine the datatype, or have any way of deferring the choice to the constraint solver.</p>\n</blockquote>\n\n<p>It's actually annoying that this feature is not implemented. I tried to look up multiple sources but I could not find a reason why they decide not to infer types.</p>\n\n<p>Does anyone know a good reason for this? Is it because of a limitation of the current type system? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "edited": false, "score": 0, "creation_date": 1481088642, "post_id": 41007577, "comment_id": 69227896, "body": "You can made this question better by show code you have already done. Also in haskell question it help to include type signature of your desire output."}], "answers": [{"comments": [{"owner": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "edited": false, "score": 0, "creation_date": 1481075364, "post_id": 41007663, "comment_id": 69224448, "body": "At first, thank you for the very good explanation! But while trying to use it, I get only the error <code>variable not in scope: wordLengths :: [String] -&gt; [Int]</code>"}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "reply_to_user": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "edited": false, "score": 0, "creation_date": 1481075789, "post_id": 41007663, "comment_id": 69224573, "body": "I assume you&#39;re trying to enter this directly into <code>ghci</code>? The function definition I&#39;ve included was intended to go in a Haskell source file. You can paste it into some file with the extension <code>.hs</code> and then load it via <code>ghci fileName.hs</code> in terminal."}, {"owner": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "edited": false, "score": 0, "creation_date": 1481075923, "post_id": 41007663, "comment_id": 69224604, "body": "I think that&#39;s what I did. I wrote a *.hs-file and added it into this. So I have to &quot;modify&quot; some source file of Haskell itself? I added my entire HA.hs file."}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "reply_to_user": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "edited": false, "score": 0, "creation_date": 1481076224, "post_id": 41007663, "comment_id": 69224671, "body": "Ah, guessed wrong. What you did should be right; it&#39;s hard to tell exactly what could be causing the problem. You&#39;ve taken the second definition (with <code>map</code>, right?). If you can paste what you&#39;ve included verbatim I can be more helpful :)"}, {"owner": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "edited": false, "score": 0, "creation_date": 1481076343, "post_id": 41007663, "comment_id": 69224698, "body": "Yes I did. I pasted my entire script in the question. You can see it up there."}, {"owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "reply_to_user": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "edited": false, "score": 0, "creation_date": 1481076355, "post_id": 41007663, "comment_id": 69224703, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/129953/discussion-between-mnoronha-and-kendel-ventonda\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": true, "score": 2, "last_activity_date": 1481074635, "last_edit_date": 1481074635, "creation_date": 1481072308, "answer_id": 41007663, "question_id": 41007577, "link": "https://stackoverflow.com/questions/41007577/getting-length-of-words-in-list-in-haskell/41007663#41007663", "title": "Getting length of words in list in Haskell", "body": "<p>If you think you need a loop when working in Haskell, you're probably looking for recursion. We'll want to recurse through the list of strings, applying the <code>length</code> function to each one. The general pattern of recursion through a list where a function is applied to each value (which you'll become very familiar with as you work through Haskell) looks roughly like this:</p>\n\n<pre><code>func f []     = []\nfunc f (x:xs) = f x : func f xs\n</code></pre>\n\n<p>So we could solve the problem that way (specializing the function, rather than accepting it as an argument):</p>\n\n<pre><code>wordLengths :: [String] -&gt; [Int]\nwordLengths []     = []\nwordLengths (x:xs) = length x : wordLengths xs\n</code></pre>\n\n<p>However, since this behavior is so common, there exists a function <code>map</code> that takes care of all of this for us. Its type signature is <code>(a -&gt; b) -&gt; [a] -&gt; [b]</code>, so we know to pass it a function (<code>length</code>) and a list of things (our <code>String</code>s). If we <code>map</code> the <code>length</code> function to each value in your list of strings, we'll get your desired result:</p>\n\n<pre><code>wordLengths :: [String] -&gt; [Int]\nwordLengths = map length\n</code></pre>\n\n<p>Example usage:</p>\n\n<pre><code>ghci&gt;&gt; wordLengths [\"abc\",\"defg\"]\n[3,4]\n</code></pre>\n"}], "owner": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4254, "favorite_count": 0, "accepted_answer_id": 41007663, "answer_count": 1, "score": 1, "last_activity_date": 1481076901, "creation_date": 1481071691, "last_edit_date": 1481076901, "question_id": 41007577, "link": "https://stackoverflow.com/questions/41007577/getting-length-of-words-in-list-in-haskell", "title": "Getting length of words in list in Haskell", "body": "<p>I started to write a couple functions where I could count specific words in a sentence and so on, but now I need to count the lengths of the words in a list. So I have a list where each element is a word and want to count the characters of this word.\nI couldn't find any solution to do that, since Haskell doesn't use loops. Is there anyway to do this?</p>\n"}, {"tags": ["haskell", "serialization", "websocket", "ghcjs"], "comments": [{"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1481076418, "post_id": 41007007, "comment_id": 69224717, "body": "I just used cereal. I was using reflex-frp on the client, which provided a way of basically viewing a websocket as an input Event of ByteString and an output Event of ByteString. I didn&#39;t really have any particular performance needs though, and I didn&#39;t benchmark; I had the pieces lying around already (was using cereal anyway), and it just worked, so that was all I needed."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1481149068, "post_id": 41007007, "comment_id": 69264237, "body": "Guess I should look at <code>reflex-frp</code> for their websockets bindings."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1481151706, "post_id": 41007007, "comment_id": 69265341, "body": "I do recall now though that I was using <code>https:&#47;&#47;github.com&#47;reflex-frp&#47;reflex-platform</code> rather than hackage, and that I had some frustrations till I figured out that the websocket stuff included in that was significantly different from what was released on hackage at the time (a couple of months ago)."}, {"owner": {"reputation": 24270, "user_id": 578832, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/A3R4H.png?s=128&g=1", "display_name": "Johannes Gerer", "link": "https://stackoverflow.com/users/578832/johannes-gerer"}, "edited": false, "score": 0, "creation_date": 1571484867, "post_id": 41007007, "comment_id": 103262004, "body": "What did you end up using?"}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1571485869, "post_id": 41007007, "comment_id": 103262257, "body": "I don\u2019t recall. I think the project did not go beyond hte <code>Read</code>/<code>Show</code> stage."}], "answers": [{"comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1481149179, "post_id": 41007866, "comment_id": 69264282, "body": "Will the automatically derived <code>Generic</code> instances of the <code>store</code> library be Endian-safe?"}, {"owner": {"reputation": 145, "user_id": 6840642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e5097e226bafec8ac922e683f1ad195?s=128&d=identicon&r=PG&f=1", "display_name": "Hapal", "link": "https://stackoverflow.com/users/6840642/hapal"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1481149720, "post_id": 41007866, "comment_id": 69264491, "body": "As far as I remember, <code>store</code> supposes that both encoder and decoder have the same endian (for the sake of performance). Most other encoding libraries do not make that assumption. It does not matter whether or not you use the generic implementation since the instances for basic types are typically implemented manually anyways."}, {"owner": {"reputation": 145, "user_id": 6840642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e5097e226bafec8ac922e683f1ad195?s=128&d=identicon&r=PG&f=1", "display_name": "Hapal", "link": "https://stackoverflow.com/users/6840642/hapal"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1481149977, "post_id": 41007866, "comment_id": 69264615, "body": "By the way, if you are looking for performance on the JS side, you may benefit from native JSON implementation as well. I am not sure how you can use a native JSON decoder rather than something like Aeson in GHCJS, but it must be doable."}], "tags": [], "owner": {"reputation": 145, "user_id": 6840642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e5097e226bafec8ac922e683f1ad195?s=128&d=identicon&r=PG&f=1", "display_name": "Hapal", "link": "https://stackoverflow.com/users/6840642/hapal"}, "is_accepted": false, "score": 1, "last_activity_date": 1481073765, "creation_date": 1481073765, "answer_id": 41007866, "question_id": 41007007, "link": "https://stackoverflow.com/questions/41007007/most-efficient-wire-format-for-ghcjs-code-over-websockets/41007866#41007866", "title": "Most efficient wire format for GHCJS code over websockets", "body": "<p>We were looking for a fast serializer/deserializer library in Haskell to store data in a reddis cache last year and eventually we ended up using ProtoBuf! That was partially because we already had ProtoBuf implementation of all of the objects that we wanted to serialize, but the performance was also much better compared to cereal/binary. By the time, <a href=\"https://hackage.haskell.org/package/store\" rel=\"nofollow noreferrer\">store</a> was non-existent.</p>\n\n<p>The size and the speed of serialization/deserialization very much depends on your data as well. For instance, if you have lots of smallish (say in the range 1 to 100) 64 bit numbers, protobuf (because of its <a href=\"https://developers.google.com/protocol-buffers/docs/encoding\" rel=\"nofollow noreferrer\">base 128 variant</a> encoding) or even JSON could be more efficient than cereal or binary (that I guess use a fixed size for numbers regardless of their values).</p>\n\n<p>There is also <a href=\"https://hackage.haskell.org/package/typed-wire\" rel=\"nofollow noreferrer\">Typed-Wire</a> that allows you to do serialization across a few languages, but I think it uses JSON as the underlying implementation.</p>\n\n<p>i have no experience with GHCJS, but I'd recommend trying <code>store</code> first. Just make sure client and server have no little/big endianness incompatibility.</p>\n"}], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "answer_count": 1, "score": 8, "last_activity_date": 1481073765, "creation_date": 1481067991, "question_id": 41007007, "link": "https://stackoverflow.com/questions/41007007/most-efficient-wire-format-for-ghcjs-code-over-websockets", "title": "Most efficient wire format for GHCJS code over websockets", "body": "<p>I am working on a Haskell application, running in the browser compiled with GHCJS, which communicates with a server, also written in Haskell, over websockets. Both programs share the same Haskell data type definition, and I \u201cjust\u201d have to pick serialization format.</p>\n\n<p>At the moment, for simplicity, the program runs on <code>Read</code> and <code>Show</code>, which works, but is obviously not ideal.</p>\n\n<p>On the other hand, it is unclear if the usual contenders for fast serialization, such as the <code>cereal</code> library, which work on <code>ByteStrings</code> are actually going to be efficient in GHCJS. Furthermore, GHCJS\u2019s API seems to make it hard to let <code>ByteStrings</code> interact with the binary <code>Blob</code> type that the JavaScript bindings to Websockets provide.</p>\n\n<p>Generic code generation (using <code>GHC.Generics</code>) would be nice.</p>\n\n<p>Has anyone solved this problem before?  Possibly even benchmarked various serialization variants on GHCJS?</p>\n"}, {"tags": ["haskell", "infix-notation"], "answers": [{"comments": [{"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 5, "creation_date": 1481062091, "post_id": 41005827, "comment_id": 69220254, "body": "You can use this site to find such definitions: <a href=\"https://www.haskell.org/hoogle/?hoogle=\" rel=\"nofollow noreferrer\">haskell.org/hoogle/?hoogle=</a>!!"}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 4, "last_activity_date": 1481062023, "creation_date": 1481062023, "answer_id": 41005827, "question_id": 41005786, "link": "https://stackoverflow.com/questions/41005786/meaning-of-in-haskell/41005827#41005827", "title": "Meaning of &quot;!!&quot; in Haskell", "body": "<p><code>!!</code> is a function that returns the <code>i</code>th elements of a list (0-indexed).</p>\n\n<p>Its documentation can be found <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#v:-33--33-\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<blockquote>\n  <p>List index (subscript) operator, starting from 0. It is an instance of the more general <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:genericIndex\" rel=\"nofollow noreferrer\"><code>genericIndex</code></a>, which takes an index of any integral type.</p>\n</blockquote>\n"}], "owner": {"reputation": 448, "user_id": 4339476, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7af53c0293141e765d27609212eb131f?s=128&d=identicon&r=PG&f=1", "display_name": "Gallaoui", "link": "https://stackoverflow.com/users/4339476/gallaoui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 41005827, "answer_count": 1, "score": 1, "last_activity_date": 1481067230, "creation_date": 1481061870, "last_edit_date": 1481067230, "question_id": 41005786, "link": "https://stackoverflow.com/questions/41005786/meaning-of-in-haskell", "title": "Meaning of &quot;!!&quot; in Haskell", "body": "<pre><code>elementAt :: [a] -&gt; Int -&gt; a\nelementAt list i    = list !! (i-1)\n</code></pre>\n\n<p>This  Function return the i'th element of a list. For Example elementAt \"haskell\" 5 return 'e'\ncan anyone explain me whats the meaning of \"!!\" , i cant find it anywhere .  </p>\n"}, {"tags": ["haskell", "hspec"], "comments": [{"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1481062678, "post_id": 41005587, "comment_id": 69220508, "body": "What is the connection between the programming language and testing system? :)"}, {"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1481101612, "post_id": 41005587, "comment_id": 69234014, "body": "I meant implementation of test cases, which usually imply applying of a testing framework."}], "answers": [{"comments": [{"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "edited": false, "score": 0, "creation_date": 1481107304, "post_id": 41014640, "comment_id": 69237794, "body": "&gt; If I understand correctly, Core of HSpec doesn&#39;t have a special solution for this case.    Thank you @freestyle, that confirms my assumption"}, {"owner": {"reputation": 598, "user_id": 3129333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f259569666286400dced4cde9c05195?s=128&d=identicon&r=PG&f=1", "display_name": "RonyHe", "link": "https://stackoverflow.com/users/3129333/ronyhe"}, "edited": false, "score": 2, "creation_date": 1553073221, "post_id": 41014640, "comment_id": 97245737, "body": "Isn&#39;t the <code>xit</code> function relevant here? <a href=\"http://hackage.haskell.org/package/hspec-2.7.0/docs/Test-Hspec.html#v:xit\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/hspec-2.7.0/docs/&hellip;</a>"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 598, "user_id": 3129333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f259569666286400dced4cde9c05195?s=128&d=identicon&r=PG&f=1", "display_name": "RonyHe", "link": "https://stackoverflow.com/users/3129333/ronyhe"}, "edited": false, "score": 2, "creation_date": 1553074853, "post_id": 41014640, "comment_id": 97246691, "body": "@RonyHe Yes, but <code>xit</code> was added after I wrote the answer :-)"}], "tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": true, "score": 2, "last_activity_date": 1481105475, "creation_date": 1481105475, "answer_id": 41014640, "question_id": 41005587, "link": "https://stackoverflow.com/questions/41005587/is-it-possible-to-skip-tests-in-hspec-test-suite/41014640#41014640", "title": "Is it possible to skip tests in HSpec test suite?", "body": "<p>If I understand correctly, <em>Core</em> of <em>HSpec</em> doesn't have a special solution for this case. But you can skip tests without verbosity about it. For example:</p>\n\n<pre><code>main = hspec $ do\n    ...\n    when isDatabaseServerRunning $ do\n        describe \"database\" $ do\n            it \"test some one\" $ do\n                ...\n</code></pre>\n\n<p>Another solution maybe to use the function like <code>mapSpecItem_</code> for changing result of test to <code>Pending</code> with a message about why was skipped. For example:</p>\n\n<pre><code>skip :: String -&gt; Bool -&gt; SpecWith a -&gt; SpecWith a\nskip   _ False = id\nskip why True  = mapSpecItem_ updateItem\n  where\n    updateItem x = x{itemExample = \\_ _ _ -&gt; return . Pending . Just $ why}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 9359631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979446bf8241aa5cb433b4929953393a?s=128&d=identicon&r=PG&f=1", "display_name": "O_Prime", "link": "https://stackoverflow.com/users/9359631/o-prime"}, "is_accepted": false, "score": 2, "last_activity_date": 1616133146, "creation_date": 1616133146, "answer_id": 66703142, "question_id": 41005587, "link": "https://stackoverflow.com/questions/41005587/is-it-possible-to-skip-tests-in-hspec-test-suite/66703142#66703142", "title": "Is it possible to skip tests in HSpec test suite?", "body": "<p>&quot;Changing it to xit marks the corresponding spec item as pending.&quot;</p>\n<p>source:\n<a href=\"http://hackage.haskell.org/package/hspec-2.7.8/docs/Test-Hspec.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/hspec-2.7.8/docs/Test-Hspec.html</a></p>\n"}], "owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 41014640, "answer_count": 2, "score": 1, "last_activity_date": 1616133146, "creation_date": 1481061092, "question_id": 41005587, "link": "https://stackoverflow.com/questions/41005587/is-it-possible-to-skip-tests-in-hspec-test-suite", "title": "Is it possible to skip tests in HSpec test suite?", "body": "<p>In most programming languages it is easy to skip a test in some circumstances. Is there a proper way to do that in haskell HSpec based test suite?</p>\n"}, {"tags": ["haskell", "yesod", "shakespeare-text"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 3693200, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/68f7c9831a8a110a9412fd57d9790017?s=128&d=identicon&r=PG&f=1", "display_name": "terickson001", "link": "https://stackoverflow.com/users/3693200/terickson001"}, "edited": false, "score": 0, "creation_date": 1481086256, "post_id": 41009469, "comment_id": 69227094, "body": "While I did miss that, it isn&#39;t the source of this error, as I have now discovered there are some circumstances where a &#39;font_size&#39; mixin can be included without error, but are not compiled correctly. Also, the error persists without any &#39;font_size&#39; mixins.  All the same, thank you for spotting this stupid mistake, It seems my current font (Terminus I believe) has <code>{}</code> that look very similar to <code>()</code>."}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 0, "last_activity_date": 1481085188, "creation_date": 1481085188, "answer_id": 41009469, "question_id": 41005447, "link": "https://stackoverflow.com/questions/41005447/lucius-mixins-cause-unexpected-end-of-input-cant-find-end-of-block/41009469#41009469", "title": "Lucius mixins cause &quot;unexpected end of input&quot;, Can&#39;t find end of block", "body": "<p>I suspect, there it is</p>\n\n<pre><code>font_size :: Double -&gt; Mixin\nfont_size size =\n  [luciusMixin|\n        font-size: #(pxsize}px;\n        font-size: #(remsize)rem;\n  |]\n</code></pre>\n\n<p>Note <code>#(pxsize}px</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 3693200, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/68f7c9831a8a110a9412fd57d9790017?s=128&d=identicon&r=PG&f=1", "display_name": "terickson001", "link": "https://stackoverflow.com/users/3693200/terickson001"}, "is_accepted": true, "score": 0, "last_activity_date": 1481318921, "creation_date": 1481318921, "answer_id": 41069192, "question_id": 41005447, "link": "https://stackoverflow.com/questions/41005447/lucius-mixins-cause-unexpected-end-of-input-cant-find-end-of-block/41069192#41069192", "title": "Lucius mixins cause &quot;unexpected end of input&quot;, Can&#39;t find end of block", "body": "<p>Well, the error was caused by a few typos (<code>font-size -&gt; font_size; box-sizing -&gt; box_sizing</code>), sadly I had glazed over the idea of a naming error due to the fact that I was not getting a <code>'font-size' is not in scope</code> error. The parser was seeing the <code>-</code> as subtraction due to the fact that they are not allowed in haskell function names. On the plus side, I now know the insides of Yesod  and shakespeare <em>very</em> well, and can hopefully help people with <em>actual</em> problems.</p>\n"}], "owner": {"reputation": 11, "user_id": 3693200, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/68f7c9831a8a110a9412fd57d9790017?s=128&d=identicon&r=PG&f=1", "display_name": "terickson001", "link": "https://stackoverflow.com/users/3693200/terickson001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 41069192, "answer_count": 2, "score": 1, "last_activity_date": 1481318921, "creation_date": 1481060507, "last_edit_date": 1481150184, "question_id": 41005447, "link": "https://stackoverflow.com/questions/41005447/lucius-mixins-cause-unexpected-end-of-input-cant-find-end-of-block", "title": "Lucius mixins cause &quot;unexpected end of input&quot;, Can&#39;t find end of block", "body": "<p>I'm trying to use mixins in Yesod's Lucius, but have run into a problem. Currently my 'center' mixin is the only one that seems to work, which also happens to be the only mixin without variable interpolation, although I'm not sure that is related to the problem the problem.</p>\n\n<p>Lucius:</p>\n\n<pre><code>@keyframes blink {\n    0%   {opacity: 0}\n    40%  {opacity: 0.8}\n    80%  {opacity: 0}\n    100% {opacity: 0}\n}\n\n@-webkit-keyframes blink {\n    0%   {opacity: 0}\n    40%  {opacity: 0.8}\n    80%  {opacity: 0}\n    100% {opacity: 0}\n}\n\n\nhtml, body {\n    height: 100%;\n    margin: 0;\n}\n\n*, *:after, *:before {\n    text-rendering: optimizeLegibility;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    ^{box-sizing \"inherit\"}\n}\n\nheader {\n    min-height: 100%;\n    z-index: 0;\n    background-image: url(@{StaticR images_landing__jpg});\n    background-position: center center;\n    background-size: cover;\n\n    .greeting {\n        min-width: 30%;\n        padding: 3%;\n        background-image: url(@{StaticR images_neg_lines_png});\n        background-repeat: repeat;\n        text-align: center;\n        ^{center \"both\"}\n        color: whitesmoke;\n\n        h2, h4 {\n            font-family: \"Lato\";\n            font-weight: 300;\n        }\n        h4 {\n            font-family: \"Lato\";\n            ^{font-size 20}\n        }\n        h1 {\n            font-family: \"Tangerine\";\n            font-weight: bold;\n            color: #ffffff;\n            ^{font-size 96}\n        }\n    }\n\n    .scroll-link {\n        ^{center \"x\"}\n        bottom: 5%;\n        .scroll-arrow {\n            display: inline;\n            path {\n                stroke: white;\n                fill: transparent;\n                stroke-width: 1px;\n                animation: blink 2s infinite;\n                -webkit-animation: blink 2s infinite;\n            }\n            path.a1 {\n                animation-delay: -1s;\n                -webkit-animation-delay: -1s;\n            }\n            path.a2 {\n                animation-delay: -0.5s;\n                -webkit-animation-delay: -0.5s;\n            }\n            path.a3 {\n                animation-delay: 0s;\n                -webkit-animation-delay: 0s;\n            }\n        }\n    }\n}\n\n.main-container {\n    background: whitesmoke;\n}\n</code></pre>\n\n<p>Mixins:</p>\n\n<pre><code>{-# LANGUAGE QuasiQuotes #-}\nmodule Mixins\n    ( center\n    , box_sizing\n    , font_size\n    , unlink\n    ) where\n\nimport Text.Lucius\nimport ClassyPrelude.Yesod\n\ncenter :: String -&gt; Mixin\ncenter axis\n  | axis == \"x\" =\n    [luciusMixin|\n        left: 50%;\n        -webkit-transform: translate(-50%, 0);\n        -ms-transform: translate(-50%, 0);\n        transform: translate(-50%, 0);\n    |]\n  | axis == \"y\" =\n    [luciusMixin|\n        top: 50%;\n        -webkit-transform: translate(0, -50%);\n        -ms-transform: translate(0, -50%);\n        transform: translate(0, -50%);\n    |]\n  | otherwise =\n    [luciusMixin|\n        top: 50%;\n        left: 50%;\n        -webkit-transform: translate(-50%, -50%);\n        -ms-transform: translate(-50%, -50%);\n        transform: translate(-50%, -50%);\n    |]\n\nbox_sizing :: String -&gt; Mixin\nbox_sizing box_model =\n  [luciusMixin|\n        -webkit-box-sizing: #{box_model};\n        -moz-box-sizing: #{box_model};\n        box-sizing: #{box_model};\n  |]\n\nfont_size :: Double -&gt; Mixin\nfont_size size =\n  [luciusMixin|\n        font-size: #(pxsize}px;\n        font-size: #(remsize)rem;\n  |]\n  where\n    pxsize = show size\n    remsize = show $ size * 0.125\n\nunlink :: String -&gt; Mixin\nunlink color =\n  [luciusMixin|\n        color: #{color};\n        text-decoration: none;\n  |]\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>[...]/Foundation.hs:132:15:\n    Exception when trying to run compile-time code:\n      \"\n[...]\n\" (line 94, column 1)\nunexpected end of input\nexpecting \"/*\", \"}\", \"#\", \"@\" or \"{\"\ncheckIfBlock\n    Code: widgetFile \"default-layout\"\n    In the splice: $(widgetFile \"default-layout\")\n</code></pre>\n\n<p>Things I've troubleshot:</p>\n\n<ul>\n<li>Add trailing semicolons -> No effect</li>\n<li>Remove all mixins but 'center' -> Compiles</li>\n<li>Remove all mixins but 'box_sizing' and make static (no interpolation) -> No effect</li>\n</ul>\n\n<p>It's quite possible I'm missing something obvious, and I'd hate to be <em>that</em> guy, however there's not much in the way of documentation for these types of things. Perhaps this can help someone else in a similar position.</p>\n\n<p>Anyways, any and all help is appreciated.</p>\n\n<p><strong>EDIT</strong>: </p>\n\n<p>As it turns out, after merging some separate lucius files, the 'unlink' mixin also compiles without error. Due to the fact that it is, structurally speaking, essentially identical to other mixins such as 'box_sizing' I now know that interpolation is not the culprit, nor the formatting of the function (Guards vs. Equation).</p>\n\n<p>I'm becoming more and more suspicious of the formatting in the Lucius file as it seems the Haskell code is insignificant. I'm starting to feel the problem might just be basic css syntax error that i'm blind to for whatever reason.</p>\n\n<p><strong>EDIT 2</strong>:</p>\n\n<p>I have merged the Lucius code for my navbar, which revealed that a mixin that could not previously compile, under certain (albeit unknown) circumstances, can succeed.</p>\n\n<p>The relevant code: \n<br/>(note the 'font_size' mixin succesfully compiles in this code)</p>\n\n<pre><code>/* Navbar */\n@navheight: 6rem;\n\nnav {\n    z-index: 10000;\n    position: absolute;\n    background-color: transparent;\n    color: rgba(255, 255, 255, 1);\n    height: #{navheight};\n    line-height: #{navheight};\n    ^{font-size 16};\n    .left {\n        padding-left: 2rem;\n        padding-right: 2rem;\n        height: #{navheight};\n\n        .brand {\n            display: inline;\n            font-family: \"Lato\";\n            font-weight: bold;\n            ^{unlink \"inherit\"};\n        }\n        .more {\n            display: inline;\n            font-family: \"Lato\";\n        }\n    }\n\n    .right {\n        height: #{navheight};\n        ul li {\n            display: inline-block;\n            padding-left: 2rem;\n            padding-right: 2rem;\n            a {\n                font-family: \"RaleWay\";\n                display: block;\n                text-align: center;\n                ^{unlink \"inherit\"};\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["haskell", "haskell-lens"], "answers": [{"comments": [{"owner": {"reputation": 5502, "user_id": 350127, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c46a4215e49e00007cd622b75df75f91?s=128&d=identicon&r=PG", "display_name": "yilmazhuseyin", "link": "https://stackoverflow.com/users/350127/yilmazhuseyin"}, "edited": false, "score": 0, "creation_date": 1481062418, "post_id": 41005756, "comment_id": 69220401, "body": "Worked like a charm. Thank you."}], "tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": true, "score": 2, "last_activity_date": 1481062434, "last_edit_date": 1481062434, "creation_date": 1481061745, "answer_id": 41005756, "question_id": 41005322, "link": "https://stackoverflow.com/questions/41005322/get-list-of-values-from-sublist-with-control-lens/41005756#41005756", "title": "Get list of values from sublist with Control.Lens", "body": "<p>The documentation says:</p>\n\n<blockquote>\n  <p>View the value pointed to by a Getter, Iso or Lens or the result of folding over all the results of a Fold or Traversal that points at a monoidal value.</p>\n</blockquote>\n\n<p>You need to use <code>toListOf</code> instead <code>view</code>. For example:</p>\n\n<pre><code>toListOf (_2.traverse._2) a\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>a ^.. _2 . traverse . _2\n</code></pre>\n\n<p>So, <code>toListOf</code> isn't lens, it's just another operator like <code>view</code>, but it extracts a list of the targets of a <strong>Fold</strong>.</p>\n"}], "owner": {"reputation": 5502, "user_id": 350127, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c46a4215e49e00007cd622b75df75f91?s=128&d=identicon&r=PG", "display_name": "yilmazhuseyin", "link": "https://stackoverflow.com/users/350127/yilmazhuseyin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 1, "accepted_answer_id": 41005756, "answer_count": 1, "score": 0, "last_activity_date": 1522015218, "creation_date": 1481060033, "last_edit_date": 1522015218, "question_id": 41005322, "link": "https://stackoverflow.com/questions/41005322/get-list-of-values-from-sublist-with-control-lens", "title": "Get list of values from sublist with Control.Lens", "body": "<p>I am trying to get list of values from a substructure.\nI have the following structure</p>\n\n<pre><code>(\"Value\",[(1,\"1\"),(2,\"2\"),(3,\"3\"),(4,\"4\"),(5,\"5\")])\n</code></pre>\n\n<p>And I am trying to get the second element of the tuples in the list.</p>\n\n<pre><code>[\"1\", \"2\" , \"3\" , \"4\" , \"5\"]\n</code></pre>\n\n<p>The expression I am tying is:</p>\n\n<pre><code>view (_2 . toListOf . _2) a\n</code></pre>\n\n<p>I have also tried <code>traverse</code>. But It seems like <code>traverse</code> has a folding effect on the list. I need the result as a list.</p>\n\n<pre><code>Prelude Control.Lens&gt; let a = (\"Value\", [(i, show i)|i&lt;-[1..5]]) :: (String, [(Int, String)])\nPrelude Control.Lens&gt; a\n(\"Value\",[(1,\"1\"),(2,\"2\"),(3,\"3\"),(4,\"4\"),(5,\"5\")])\nPrelude Control.Lens&gt; view (_2 . toListOf . _2) a\n\n&lt;interactive&gt;:36:7: error:\n    \u2022 Couldn't match type \u2018[]\u2019 with \u2018Const t\u2019\n      Expected type: Getting t (String, [(Int, String)]) t\n        Actual type: (t -&gt; Const t t)\n                     -&gt; (String, [(Int, String)]) -&gt; [(String, [(Int, String)])]\n    \u2022 In the first argument of \u2018view\u2019, namely \u2018(_2 . toListOf . _2)\u2019\n      In the expression: view (_2 . toListOf . _2) a\n      In an equation for \u2018it\u2019: it = view (_2 . toListOf . _2) a\n    \u2022 Relevant bindings include it :: t (bound at &lt;interactive&gt;:36:1)\n\n&lt;interactive&gt;:36:23: error:\n    \u2022 Couldn't match type \u2018Const t t0\u2019\n                     with \u2018[(Int, String)]\n                           -&gt; Const (Data.Monoid.Endo [[(Int, String)]]) [(Int, String)]\u2019\n      Expected type: (t -&gt; Const t t)\n                     -&gt; Getting\n                          (Data.Monoid.Endo [[(Int, String)]])\n                          [(Int, String)]\n                          [(Int, String)]\n        Actual type: (t -&gt; Const t t)\n                     -&gt; ([(Int, String)]\n                         -&gt; Const (Data.Monoid.Endo [[(Int, String)]]) [(Int, String)])\n                     -&gt; Const t t0\n    \u2022 In the second argument of \u2018(.)\u2019, namely \u2018_2\u2019\n      In the second argument of \u2018(.)\u2019, namely \u2018toListOf . _2\u2019\n      In the first argument of \u2018view\u2019, namely \u2018(_2 . toListOf . _2)\u2019\n    \u2022 Relevant bindings include it :: t (bound at &lt;interactive&gt;:36:1)\nPrelude Control.Lens&gt;\n</code></pre>\n"}, {"tags": ["haskell", "replace"], "comments": [{"owner": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "edited": false, "score": 0, "creation_date": 1481058973, "post_id": 41004612, "comment_id": 69218746, "body": "After adding the do-block it just gives me another error message: &quot;Variable not in scope: replace :: [Char] -&gt; [Char] -&gt; [Char] -&gt; t&quot;"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1481059481, "post_id": 41004612, "comment_id": 69219002, "body": "What makes you expect <code>replace</code> to exist?"}, {"owner": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1481059593, "post_id": 41004612, "comment_id": 69219060, "body": "Since I&#39;m doing it like it&#39;s done in a tutorial and they use it that way, I considered it to be part of the library I&#39;m importing."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1481059619, "post_id": 41004612, "comment_id": 69219074, "body": "What tutorial? Show us."}, {"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1481059696, "post_id": 41004612, "comment_id": 69219104, "body": "Using qualified import can help to find where the things are from."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1481059848, "post_id": 41004612, "comment_id": 69219171, "body": "Please don&#39;t edit your code to fix the problem described in your post and leave all the original text describing the the problem that is now gone! Generally Stack Overflow would prefer you asked a separate question for each issue, but if you do decide to edit your question anyway then at least make sure the result of your edit is a complete question asking for help with the problem you actually have!"}, {"owner": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1481059901, "post_id": 41004612, "comment_id": 69219194, "body": "@DanielWagner I&#39;m using this one: <a href=\"http://www.makechronicles.com/2012/11/11/first-steps-with-haskell-the-word-counter/\" rel=\"nofollow noreferrer\">makechronicles.com/2012/11/11/&hellip;</a>"}, {"owner": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1481059960, "post_id": 41004612, "comment_id": 69219223, "body": "@Ben I exactly did this last time and everyone went crazy why I&#39;d open another question for the same script and why I wouldn&#39;t have just edited my code. So that&#39;s the reason."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1481060452, "post_id": 41004612, "comment_id": 69219455, "body": "My main point your post now contains a substantially different program, and claims that your problem is a parse error. That&#39;s going to make it harder for people to help with your <i>actual</i> problem with <i>this</i> code, which has nothing to do with the parse error in your earlier code."}, {"owner": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1481060612, "post_id": 41004612, "comment_id": 69219528, "body": "@Ben I thought that&#39;s what the versioning is there for but I changed it back and open up a new one."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1481060695, "post_id": 41004612, "comment_id": 69219566, "body": "I had a look at that tutorial, and it tells you to prepare by getting a library from here: <a href=\"https://github.com/jgoerzen/missingh\" rel=\"nofollow noreferrer\">github.com/jgoerzen/missingh</a>. That&#39;s the library that contains <code>replace</code> (in <code>Data.List.Utils</code>), not <code>Data.List.Split</code>."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1481060832, "post_id": 41004612, "comment_id": 69219638, "body": "I&#39;m still not being clear. I don&#39;t really mind if whether you edit the code in this post. I&#39;m saying you should <b>also</b> edit the text of the post to describe your new problem!"}, {"owner": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "edited": false, "score": 0, "creation_date": 1481061022, "post_id": 41004612, "comment_id": 69219740, "body": "I&#39;m sorry if I misunderstood you. My English is, obviously not well enough. But since I have to install a library, I can&#39;t use this solution anyway. But thank you for helping me."}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1481057768, "post_id": 41004696, "comment_id": 69218109, "body": "&quot;[Top-level <code>let</code>] is only needed while using the interpreter.&quot; -- And not even in that case if you are using GHC 8."}, {"owner": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "edited": false, "score": 0, "creation_date": 1481057938, "post_id": 41004696, "comment_id": 69218196, "body": "Yes of course. I somehow thought I already tried to do it in a do block but obviously I didn&#39;t try... because it works. But now I get an issure with the missing expression."}, {"owner": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "edited": false, "score": 0, "creation_date": 1481058994, "post_id": 41004696, "comment_id": 69218753, "body": "Looks like it&#39;s not the only issue I have here."}], "tags": [], "owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "is_accepted": false, "score": 4, "last_activity_date": 1481057622, "creation_date": 1481057622, "answer_id": 41004696, "question_id": 41004612, "link": "https://stackoverflow.com/questions/41004612/cant-replace-in-haskell/41004696#41004696", "title": "Can&#39;t replace in Haskell", "body": "<p>You cannot use <code>let</code> at the toplevel like you do.\nIt is only needed while using the interpreter.</p>\n"}], "owner": {"reputation": 371, "user_id": 5108315, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh4.googleusercontent.com/-QZ6igTDAGv0/AAAAAAAAAAI/AAAAAAAABXQ/HM4X_Zw-4xg/photo.jpg?sz=128", "display_name": "Kendel Ventonda", "link": "https://stackoverflow.com/users/5108315/kendel-ventonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481060576, "creation_date": 1481057365, "last_edit_date": 1481060576, "question_id": 41004612, "link": "https://stackoverflow.com/questions/41004612/cant-replace-in-haskell", "title": "Can&#39;t replace in Haskell", "body": "<p>I'm trying to read in a string from a file, which works fine. But trying to replace punctuation marks with nothing to delete them, it gives me always the same message.\nMy program part so far looks like this:</p>\n\n<pre><code>module HA\n\nwhere\n\nimport FPH\nimport Data.List\n\nlet contents2 = replace \".\" \"\" sonnet18\nlet contents3 = replace \"!\" \"\" contents2\n</code></pre>\n\n<p>sonnet18 is a string in the file FPH.hs.\nI tried a couple ways to replace it, but get always the exception \"parse error (possibly incorrect indentation or mismatched brackets)\nIt doesn't say much and looking it up, didn't help yet. All indentations are four whitespaces and so on. I can't find the mistake. I'm grateful for any help.</p>\n"}, {"tags": ["haskell", "operators"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1481052059, "post_id": 41003160, "comment_id": 69215104, "body": "You should look them up on Hoogle or Hayoo."}, {"owner": {"reputation": 548, "user_id": 4547068, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/651f7915c52ada9f3b616430481ec37f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roca Lopez", "link": "https://stackoverflow.com/users/4547068/daniel-roca-lopez"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1481052074, "post_id": 41003160, "comment_id": 69215112, "body": "I don&#39;t know how to search them"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1481052121, "post_id": 41003160, "comment_id": 69215139, "body": "Well, start by finding them with Google. Once you&#39;ve done so, type the operator you want into the search field."}, {"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1481052164, "post_id": 41003160, "comment_id": 69215157, "body": "@dfeuer you mean Hoogle?"}, {"owner": {"reputation": 548, "user_id": 4547068, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/651f7915c52ada9f3b616430481ec37f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roca Lopez", "link": "https://stackoverflow.com/users/4547068/daniel-roca-lopez"}, "edited": false, "score": 1, "creation_date": 1481052167, "post_id": 41003160, "comment_id": 69215159, "body": "it would be maybe easier if you answered the question instead?"}, {"owner": {"reputation": 548, "user_id": 4547068, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/651f7915c52ada9f3b616430481ec37f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roca Lopez", "link": "https://stackoverflow.com/users/4547068/daniel-roca-lopez"}, "edited": false, "score": 0, "creation_date": 1481052252, "post_id": 41003160, "comment_id": 69215206, "body": "I looked them in hoogle but still don&#39;t understand what are they doing on my code"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 2, "creation_date": 1481052509, "post_id": 41003160, "comment_id": 69215343, "body": "@Jean-BaptistePotonnier, no, I meant Google to find Hoogle and Hayoo. Daniel, you need to read about applicative functors. Learn You a Haskell has a good explanation."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1481065431, "post_id": 41003160, "comment_id": 69221527, "body": "Also typeclassopedia is a good reference"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1506712714, "post_id": 41003160, "comment_id": 79945689, "body": "possible duplicate of <a href=\"https://stackoverflow.com/questions/6280585/need-to-know-what-and-do-in-haskell\" title=\"need to know what and do in haskell\">stackoverflow.com/questions/6280585/&hellip;</a> (I&#39;ve found this link with <a href=\"http://symbolhound.com/\" rel=\"nofollow noreferrer\">symbolhound</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 3, "last_activity_date": 1506553110, "last_edit_date": 1506553110, "creation_date": 1481052394, "answer_id": 41003266, "question_id": 41003160, "link": "https://stackoverflow.com/questions/41003160/what-are-and-operands-in-haskell/41003266#41003266", "title": "what are &lt;$&gt; and &lt;*&gt; operands in haskell", "body": "<p>The <code>&lt;$&gt;</code> operator is an infix form of <code>fmap</code>. It allows you to apply a pure function to the value wrapped into some parametric type that belongs to a <code>Functor</code> class. The type of <code>&lt;$&gt;</code> is <code>(a -&gt; b) -&gt; f a -&gt; f b</code>.</p>\n\n<p>The <code>&lt;*&gt;</code> operator is quite similar to <code>&lt;$&gt;</code>. It allows you to apply a function wrapped into a parametric type to a value wrapped into the same parametric type. The type of <code>&lt;*&gt;</code> is <code>f (a -&gt; b) -&gt; f a -&gt; f b</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "is_accepted": false, "score": 1, "last_activity_date": 1481053355, "creation_date": 1481053355, "answer_id": 41003521, "question_id": 41003160, "link": "https://stackoverflow.com/questions/41003160/what-are-and-operands-in-haskell/41003521#41003521", "title": "what are &lt;$&gt; and &lt;*&gt; operands in haskell", "body": "<p>In this particular case, it's a way to combine the results of <code>eval</code>. \nIf one part of the the expression is failing, then the whole expression is failing.</p>\n\n<p>This way, its possible to separate error handling of your application logic and to avoid complex nested <code>case ... of</code>.</p>\n\n<p>To fully understand this, I'll advise do read on functors first, then applicative functors.</p>\n\n<p>In parallel you can play with Maybe and Either, and write the equivalent code using <code>case</code> expressions. </p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 4, "last_activity_date": 1481056211, "last_edit_date": 1495540904, "creation_date": 1481053923, "answer_id": 41003682, "question_id": 41003160, "link": "https://stackoverflow.com/questions/41003160/what-are-and-operands-in-haskell/41003682#41003682", "title": "what are &lt;$&gt; and &lt;*&gt; operands in haskell", "body": "<p>As I am the one who <a href=\"https://stackoverflow.com/a/40979668/1126841\">showed you these operators</a>, I'll give a brief explanation as to why I used them.</p>\n\n<hr>\n\n<p>To review, a functor is a type constructor that lets you use the <code>fmap</code> function to apply a function to a \"wrapped\" value. In the specific case of the <code>Either</code> type constructor (partially applied, in this case, to <code>String</code>), you can apply a function to a <code>Right</code> value, but ignore the function if applied to a <code>Left</code> value (your error). It provides a way of error propagation without having to check for the error.</p>\n\n<pre><code>fmap f (Right x) = Right (f x)\nfmap f (Left y) = Left y\n</code></pre>\n\n<hr>\n\n<p>An applicative functor is similar, except the function itself can be wrapped just like the argument it is applied to. The <code>&lt;*&gt;</code> operator unwraps both its operands, unlike <code>fmap</code> which only unwraps its right operand.</p>\n\n<pre><code>Right f &lt;*&gt; Right x = Right (f x)\nLeft f &lt;*&gt; _ = Left f\n_ &lt;*&gt; Left y = Left y\n</code></pre>\n\n<p>Typically, you don't wrap functions yourself: they result from using <code>fmap</code> to partially apply a function to a wrapped value:</p>\n\n<pre><code>fmap (+) (Right 3) == Right (+ 3)\nfmap (+) (Left \"error\") == Left \"error\"\n</code></pre>\n\n<p>So, when we are working with <code>Either</code> values, the use of <code>&lt;$&gt;</code> (infix <code>fmap</code>) and <code>&lt;*&gt;</code> let us pretend we are working with regular values, without worrying about whether they are wrapped with <code>Left</code> or <code>Right</code>. <code>Right</code> values provide the expected <code>Right</code>-wrapped answer, and <code>Left</code> values are preserved. In the case of a binary operator, only the first <code>Left</code> value is returned, but that is often sufficient.</p>\n\n<pre><code>(+) &lt;$&gt; Left \"x undefined\" &lt;*&gt; Left \"y undefined\" == Left \"x undefined\" &lt;*&gt; Left \"y undefined\"\n                                                  == Left \"x undefined\"\n\n(+) &lt;$&gt; Left \"x undefined\" &lt;*&gt; Right 9 == Left \"x undefined\" &lt;*&gt; Right 9\n                                       == Left \"x undefined\"\n\n(+) &lt;$&gt; Right 3 &lt;*&gt; Left \"y undefined\" == Right (+ 3) &lt;*&gt; Left \"y undefined\"\n                                       == Left \"y undefined\"\n\n(+) &lt;$&gt; Right 3 &lt;*&gt; Right 9 == Right (+3) &lt;*&gt; Right 9\n                            == Right 12\n</code></pre>\n\n<hr>\n\n<p>In the end, using the <code>Applicative</code> instance of <code>Either String</code> lets us combine the results of evaluating two subexpressions without having to explicitly check if either recursive call of <code>eval</code> actually succeeded. Successful recursive calls result in success; an error in either call is used as the same error for the top-level call.</p>\n"}], "owner": {"reputation": 548, "user_id": 4547068, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/651f7915c52ada9f3b616430481ec37f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roca Lopez", "link": "https://stackoverflow.com/users/4547068/daniel-roca-lopez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 41003682, "answer_count": 3, "score": -3, "last_activity_date": 1506553110, "creation_date": 1481052006, "question_id": 41003160, "link": "https://stackoverflow.com/questions/41003160/what-are-and-operands-in-haskell", "title": "what are &lt;$&gt; and &lt;*&gt; operands in haskell", "body": "<p>what are those operators in haskell?  and &lt;*>\nI have them in a line like this:</p>\n\n<pre><code>class Evaluable e where\n    eval :: (Num a, Ord a) =&gt; (Ident -&gt; Maybe a) -&gt; (e a) -&gt; (Either String a)\n    typeCheck :: (Ident -&gt; String) -&gt; (e a) -&gt; Bool\n\ninstance Evaluable NExpr where\n    eval lookup (Plus left right) = (+) &lt;$&gt; eval lookup left &lt;*&gt; eval lookup right\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "higher-order-functions", "recursion-schemes"], "comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1481046425, "post_id": 41001405, "comment_id": 69212199, "body": "I&#39;d say you should start with <code>f1 g n = g n</code> and then write f2 such that <code>f2 (+) [1..4] 5 == [5,10,15,20]</code>"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1481048377, "post_id": 41001405, "comment_id": 69213212, "body": "Yes, <code>f2 = map</code> sounds like a good idea."}], "answers": [{"comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1481048562, "post_id": 41001889, "comment_id": 69213296, "body": "Of if you want to get fancy, <code>f1 = flip (map . flip ($))</code> :-D"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1481065628, "post_id": 41001889, "comment_id": 69221598, "body": "Your answer explains nothing"}], "tags": [], "owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "is_accepted": false, "score": 2, "last_activity_date": 1481048433, "last_edit_date": 1481048433, "creation_date": 1481047249, "answer_id": 41001889, "question_id": 41001405, "link": "https://stackoverflow.com/questions/41001405/haskell-higher-order-functions/41001889#41001889", "title": "Haskell Higher Order Functions", "body": "<blockquote>\n  <p>I'm thinking I have to use a partially evaluated map so that [1,2,3,4] becomes [*1,*2,*3,*4] ??</p>\n</blockquote>\n\n<p>Your intuition brings you closer to the answer, so that's a good sign</p>\n\n<p>That said, the expression you're given to work with is really weird</p>\n\n<pre><code>f1 (f2 (*) [1,2,3,4]) 5\n</code></pre>\n\n<p>I would write <code>f1</code> and <code>f2</code> as follows</p>\n\n<pre><code>let f1 = \\xs n -&gt; map (\\f -&gt; f n) xs\n    f2 = map\nin f1 (f2 (*) [1,2,3,4]) 5\n-- [5,10,15,20]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 0, "last_activity_date": 1482285582, "creation_date": 1482285582, "answer_id": 41253984, "question_id": 41001405, "link": "https://stackoverflow.com/questions/41001405/haskell-higher-order-functions/41253984#41253984", "title": "Haskell Higher Order Functions", "body": "<p>If you take <code>f2 = map</code>, you immediately get to the first step that you've come up with:</p>\n\n<pre><code>f2 (*) [1, 2, 3, 4] =\nmap (*) [1, 2, 3, 4] =\n[(1 *), (2 *), (3 *), (4 *)]\n</code></pre>\n\n<p>Now given this list of multiplier functions, we need</p>\n\n<pre><code>f1 [g1, g2, ..., gn] x =\n[g1 x, g2 x, ..., gn x]\n</code></pre>\n\n<p>since then we can apply it on <code>f2 (*) [1..4]</code> to get</p>\n\n<pre><code>f1 [(1 *), (2 *), (3 *), (4 *)] 5 =\n[1 * 5, 2 * 5, 3 * 5, 4 * 5] =\n[5, 10, 15, 20]\n</code></pre>\n\n<p>which is what you're after.</p>\n\n<p>If you look at <code>f1</code>, it looks almost like a <code>map</code>, except the arguments are <code>flip</code>ped:</p>\n\n<pre><code>f1 = \\gs x -&gt; map h gs\n</code></pre>\n\n<p>Now we just need to figure out what <code>h</code> is. <code>h</code> needs to be something that takes a function like <code>(2 *)</code> and gives you the result of applying that function to <code>5</code>; i.e. <code>h = \\g -&gt; g 5</code>. </p>\n\n<p>Putting it all together, we get</p>\n\n<pre><code>let f2 = map\n    f1 = \\gs x -&gt; map (\\g -&gt; g x) gs\nin f1 (f2 (*) [1, 2, 3, 4]) 5\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7258402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6e4e0c9185d461a03420908e6e3c0d5?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Leggio", "link": "https://stackoverflow.com/users/7258402/dylan-leggio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1482285582, "creation_date": 1481045526, "last_edit_date": 1482285168, "question_id": 41001405, "link": "https://stackoverflow.com/questions/41001405/haskell-higher-order-functions", "title": "Haskell Higher Order Functions", "body": "<p>I have a homework on higher order functions in Haskell and I'm having a little trouble getting started.</p>\n\n<p>If I could get some help and explanation on the first question, I'm confident I can finish the rest.</p>\n\n<blockquote>\n  <p>Using higher order functions (<code>map</code>, <code>fold</code>, or <code>filter</code>), and if necessary\n  lambda expressions, write functions <code>f1</code> and <code>f2</code> such that <code>f1 (f2 (*) [1,2,3,4]) 5 ~&gt; [5,10,15,20]</code></p>\n</blockquote>\n\n<pre><code>f1 = \nf2 = \n</code></pre>\n\n<p>I'm thinking I have to use a partially applied <code>map</code> so that <code>[1,2,3,4]</code> becomes <code>[(*1),(*2),(*3),(*4)]</code> ?</p>\n"}, {"tags": ["string", "haskell", "char"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1481059816, "post_id": 41000948, "comment_id": 69219155, "body": "This is a great programming exercise. But <a href=\"https://www.kalzumeus.com/2010/06/17/falsehoods-programmers-believe-about-names/\" rel=\"nofollow noreferrer\">you might enjoy this cautionary tale about names</a>."}, {"owner": {"reputation": 574, "user_id": 6262818, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0qG2x.png?s=128&g=1", "display_name": "Jack Parkinson", "link": "https://stackoverflow.com/users/6262818/jack-parkinson"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1481068463, "post_id": 41000948, "comment_id": 69222604, "body": "@DanielWagner I have seen something like that before, and in fact I did consider how cautious I needed to be about the names I was dealing with so as not to get erroneous results. However, for the purposes of this exercise, it was acceptable for me to be a little heavy handed and go with a lot of those assumptions."}], "answers": [{"comments": [{"owner": {"reputation": 574, "user_id": 6262818, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0qG2x.png?s=128&g=1", "display_name": "Jack Parkinson", "link": "https://stackoverflow.com/users/6262818/jack-parkinson"}, "edited": false, "score": 0, "creation_date": 1481045069, "post_id": 41001204, "comment_id": 69211405, "body": "I&#39;m not sure I fully understand why return behaves like this, but I think it&#39;s because I&#39;m not thinking about it in a functional context based on my coding background. I didn&#39;t realise that using <code>do ... return ...</code> would yield any different result from using a regular function call but I will look into the documentation more. Thanks for your response!"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 574, "user_id": 6262818, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0qG2x.png?s=128&g=1", "display_name": "Jack Parkinson", "link": "https://stackoverflow.com/users/6262818/jack-parkinson"}, "edited": false, "score": 2, "creation_date": 1481047956, "post_id": 41001204, "comment_id": 69213008, "body": "That is the purpose of <code>return</code>; its general type is <code>return :: Monad m =&gt; a -&gt; m a</code>, but <code>m</code> here is fixed to be <code>[]</code> because of the declared return value of <code>getname</code>. The <code>return</code> function is nothing like the statement of the same name in most programming languages"}, {"owner": {"reputation": 574, "user_id": 6262818, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0qG2x.png?s=128&g=1", "display_name": "Jack Parkinson", "link": "https://stackoverflow.com/users/6262818/jack-parkinson"}, "edited": false, "score": 0, "creation_date": 1481063596, "post_id": 41001204, "comment_id": 69220877, "body": "Yes, so it would seem, I think that&#39;s what threw me off. I expected it to behave the way I&#39;ve always found it to behave."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 5, "last_activity_date": 1481044742, "creation_date": 1481044742, "answer_id": 41001204, "question_id": 41000948, "link": "https://stackoverflow.com/questions/41000948/haskell-error-couldnt-match-expected-type-char-with-actual-type-char/41001204#41001204", "title": "Haskell error - Couldn&#39;t match expected type \u2018Char\u2019 with actual type \u2018[Char]\u2019", "body": "<p>Don't use <code>do</code> notation here. Because the return value of your function is <code>[Char</code>], the argument to <code>return</code> is expected to be a <code>Char</code> value (because <code>return :: a -&gt; [a]</code>).</p>\n\n<p>You aren't doing anything here that requires <code>do</code> notation; just use regular function calls.</p>\n\n<pre><code>getname fullName = (reverse (splitOn \" \" fullName)) !! 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 574, "user_id": 6262818, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0qG2x.png?s=128&g=1", "display_name": "Jack Parkinson", "link": "https://stackoverflow.com/users/6262818/jack-parkinson"}, "edited": false, "score": 0, "creation_date": 1481069162, "post_id": 41002025, "comment_id": 69222820, "body": "Thanks for your response - in regard to safeLast, maybe you should actually suggest it to the Haskell community. Or failing that, I think they let just about everything on hackage!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1481048034, "last_edit_date": 1481048034, "creation_date": 1481047706, "answer_id": 41002025, "question_id": 41000948, "link": "https://stackoverflow.com/questions/41000948/haskell-error-couldnt-match-expected-type-char-with-actual-type-char/41002025#41002025", "title": "Haskell error - Couldn&#39;t match expected type \u2018Char\u2019 with actual type \u2018[Char]\u2019", "body": "<p>Your code is accidentally working inside the list monad, as if it was meant to describe a nondeterministic computation. You do not need that monad, nor any other monad. So, avoid using <code>do</code> for this. You can still use <code>let .. in ..</code> if you want: </p>\n\n<pre><code>getname :: String -&gt; String\ngetname fullName =\n  let nameList = splitOn \" \" fullName    -- split the full name into individual names\n      reversedName = reverse nameList    -- reverse the full name\n      lastName = reversedName !! 0       -- get the first name from the reversed list\n  in lastName\n</code></pre>\n\n<p>Alternatively, use <code>last</code>:</p>\n\n<pre><code>getname :: String -&gt; String\ngetname fullName = last (splitOn \" \" fullName)\n</code></pre>\n\n<p>Beware that <code>last</code> is partial: it will crash your program as soon as there is not name in the input string. A safer approach could be:</p>\n\n<pre><code>getname :: String -&gt; Maybe String\ngetname fullName = case splitOn \" \" fullName of\n   [] -&gt; Nothing\n   xs -&gt; Just (last xs)\n</code></pre>\n\n<p>Or even:</p>\n\n<pre><code>getname :: String -&gt; Maybe String\ngetname fullName = safeLast (splitOn \" \" fullName)\n\n-- This should be already there in the library, IMO\nsafeLast :: [a] -&gt; Maybe a\nsafeLast []     = Nothing\nsafeLast [x]    = Just x\nsafeLast (_:xs) = safeLast xs\n</code></pre>\n"}], "owner": {"reputation": 574, "user_id": 6262818, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0qG2x.png?s=128&g=1", "display_name": "Jack Parkinson", "link": "https://stackoverflow.com/users/6262818/jack-parkinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 829, "favorite_count": 0, "accepted_answer_id": 41001204, "answer_count": 2, "score": 0, "last_activity_date": 1481048034, "creation_date": 1481043908, "question_id": 41000948, "link": "https://stackoverflow.com/questions/41000948/haskell-error-couldnt-match-expected-type-char-with-actual-type-char", "title": "Haskell error - Couldn&#39;t match expected type \u2018Char\u2019 with actual type \u2018[Char]\u2019", "body": "<p>I am trying to write a Haskell function which would take a person's full name and return only the last name; for example, <code>getName \"Hans Christian Anderson\"</code> should return <code>\"Anderson\"</code>. The function is below:</p>\n\n<pre><code>getname :: String -&gt; String\ngetname fullName = do\n  let nameList = splitOn \" \" fullName    -- split the full name into individual names\n  let reversedName = reverse nameList    -- reverse the full name\n  let lastName = reversedName !! 0       -- get the first name from the reversed list\n  return lastName\n</code></pre>\n\n<p>But whenever I try to compile this, I get the following error:</p>\n\n<pre><code>Couldn't match expected type \u2018Char\u2019 with actual type \u2018[Char]\u2019\nIn the first argument of \u2018return\u2019, namely \u2018lastName\u2019\nIn a stmt of a 'do' block: return lastName\n</code></pre>\n\n<p>I'm not sure I fully understand this error. As I understand Haskell (I am quite new to it) the structure <code>[Char]</code> would be the same as <code>String</code>, which is what I'm looking for. I just don't understand why it's expecting this <code>Char</code> type that it seems is appearing in the return statement as a String. I have gone over each line and they seem to be correct to me.</p>\n\n<p>Any advice on why this behavior is occurring and how to fix it is much appreciated.</p>\n"}, {"tags": ["haskell", "anonymous-function"], "answers": [{"comments": [{"owner": {"reputation": 2610, "user_id": 1883304, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xYoZ7.png?s=128&g=1", "display_name": "Micrified", "link": "https://stackoverflow.com/users/1883304/micrified"}, "edited": false, "score": 0, "creation_date": 1481046029, "post_id": 41000138, "comment_id": 69211967, "body": "Thank you! The <code>\\f g x -&gt; f (g x)</code> really &quot;fixed&quot; my perspective. I understand it now."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 4, "last_activity_date": 1481042116, "last_edit_date": 1481042116, "creation_date": 1481041447, "answer_id": 41000138, "question_id": 41000009, "link": "https://stackoverflow.com/questions/41000009/understanding-embedded-anonymous-functions-in-haskell/41000138#41000138", "title": "Understanding embedded anonymous functions in Haskell?", "body": "<p>This is just an example of currying. Haskell provides syntactic sugar for this:</p>\n\n<pre><code>\\f g x -&gt; f (g x)\n</code></pre>\n\n<p>In either case, applying the function to an argument <code>foo1</code> returns the function</p>\n\n<pre><code>\\g x -&gt; foo1 (g x)\n</code></pre>\n\n<p>Applying this to a function <code>foo2</code> returns <em>another</em> function</p>\n\n<pre><code>\\x -&gt; foo1 (foo2 x)\n</code></pre>\n\n<p>which, if applied to yet <em>another</em> argument <code>bar</code> would return the value computed by <code>foo1 (foo2 bar)</code>.</p>\n\n<hr>\n\n<p>In a language like Python, it would look like</p>\n\n<pre><code>compose1 = lambda f: lambda g: lambda x: f(g(x))\n</code></pre>\n\n<p>Since Python functions are not curried by default, this is a distinct\nfunction from <code>compose2 = lambda f,g,h: f(g(x))</code>. The difference between the two\nwould be how you use them.</p>\n\n<pre><code>compose1(foo1)(foo2)(bar)\ncompose2(foo1, foo2, bar)\n</code></pre>\n\n<p>Written out using <code>def</code> statements, <code>compose1</code> would look something like</p>\n\n<pre><code>def compose1(f):\n    def _1(g):\n        def _2(x):\n            return f(g(x))\n        return _2\n    return _1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2610, "user_id": 1883304, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xYoZ7.png?s=128&g=1", "display_name": "Micrified", "link": "https://stackoverflow.com/users/1883304/micrified"}, "edited": false, "score": 0, "creation_date": 1481046294, "post_id": 41001508, "comment_id": 69212130, "body": "Thank you. I was not reading it quite as a function composition with two function arguments. It makes sense once I do that!"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1481045913, "creation_date": 1481045913, "answer_id": 41001508, "question_id": 41000009, "link": "https://stackoverflow.com/questions/41000009/understanding-embedded-anonymous-functions-in-haskell/41001508#41001508", "title": "Understanding embedded anonymous functions in Haskell?", "body": "<p>You don't need to overthink this. <code>(\\f -&gt; (\\g -&gt; (\\x -&gt; f (g x) ) ) )</code> is just a function of an argument <code>f</code> with <em>some result</em>... which happens to be again a function, but it's in principle no different from a function whose result is a number. It's just some blackbox...</p>\n\n<pre><code>\\f -&gt; \u2588\u2588\n</code></pre>\n\n<p>Now, when you actually apply this lambda to some <code>f</code>, you get access to the blackbox. For example, I can apply it to the <a href=\"http://hackage.haskell.org/package/haskell98-2.0.0.3/docs/Prelude.html#v:sqrt\" rel=\"nofollow noreferrer\"><code>sqrt</code></a> function:</p>\n\n<pre><code>(\\f -&gt; \u2588\u2588) sqrt\n  \u2261 \u2588\u2588\n  = \\g -&gt; \u2588\u2588\u2082\n</code></pre>\n\n<p>Ok, another lambda which yields some blackbox. Let's apply that one to <code>(^2)</code></p>\n\n<pre><code>(\\g -&gt; \u2588\u2588\u2082) (^2)\n  \u2261 \u2588\u2588\u2082\n  = \\x -&gt; \u2588\u2588\u2083\n</code></pre>\n\n<p>Now that blackbox isn't so dark: it's just <code>f (g x)</code>, where <code>f</code>, <code>g</code> and <code>x</code> are arguments we've already applied:</p>\n\n<pre><code>(\\f -&gt; (\\g -&gt; (\\x -&gt; f (g x) ) ) ) sqrt (^2)\n  \u2261 \\x -&gt; sqrt (x^2)\n</code></pre>\n\n<p>Of course that's just one example. Generally, that big lambda of yours takes two functions and gives you the composition of both functions. Of course this is better written as</p>\n\n<pre><code>\\f g x -&gt; f $ g x\n</code></pre>\n\n<p>or in fact simply <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Function.html#v:.\" rel=\"nofollow noreferrer\"><code>.</code></a></p>\n"}, {"tags": [], "owner": {"reputation": 893, "user_id": 6248287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tPegr.jpg?s=128&g=1", "display_name": "\u019b\u019b\u019b", "link": "https://stackoverflow.com/users/6248287/%c6%9b%c6%9b%c6%9b"}, "is_accepted": false, "score": 1, "last_activity_date": 1481133400, "creation_date": 1481133400, "answer_id": 41024185, "question_id": 41000009, "link": "https://stackoverflow.com/questions/41000009/understanding-embedded-anonymous-functions-in-haskell/41024185#41024185", "title": "Understanding embedded anonymous functions in Haskell?", "body": "<p>Think of the entire lambda function as a black box. From the signature we know there are three arrows \"->\" separating each argument. This tells you that this black box receives 3 actual arguments: f g x. It applies f to the result of applying g to x. It's easier to understand by looking at its named function equivalences. </p>\n\n<pre><code>compose f g x = f (g x)\ncompose' f g = \\x -&gt; f (g x)\n</code></pre>\n"}], "owner": {"reputation": 2610, "user_id": 1883304, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xYoZ7.png?s=128&g=1", "display_name": "Micrified", "link": "https://stackoverflow.com/users/1883304/micrified"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 41000138, "answer_count": 3, "score": 1, "last_activity_date": 1481133400, "creation_date": 1481041079, "question_id": 41000009, "link": "https://stackoverflow.com/questions/41000009/understanding-embedded-anonymous-functions-in-haskell", "title": "Understanding embedded anonymous functions in Haskell?", "body": "<p>I'm trying to establish the best way to understand a series of embedded anonymous expressions such as: </p>\n\n<pre><code>(\\f -&gt; (\\g -&gt; (\\x -&gt; f (g x) ) ) )\n</code></pre>\n\n<p>In Haskell. I don't have too much trouble with simpler expressions such as: </p>\n\n<pre><code>(\\x -&gt; x + 1) \n</code></pre>\n\n<p>Which states that the function takes a Number and returns a number: \n    <code>Num a =&gt; a -&gt; a</code></p>\n\n<p>But when things are embedded like this I get quite lost. My attempt to understand it is that the anonymous function pipes the argument from <code>f</code> to <code>g</code> to <code>x</code> right away, where I should then begin writing the typing as it is where the variable is used. But I've tried rationalizing maybe four or five different explanations and I keep getting caught up on what looks like a recursive function call in the innermost function. </p>\n\n<p>Can the typing of this problem be figured out in an easier manner? </p>\n"}, {"tags": ["haskell", "import", "cabal"], "comments": [{"owner": {"reputation": 79, "user_id": 4193058, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/797c59e674fc7e6f6ceaa61b07d069b7?s=128&d=identicon&r=PG&f=1", "display_name": "slothish1", "link": "https://stackoverflow.com/users/4193058/slothish1"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1481071122, "post_id": 40998196, "comment_id": 69223305, "body": "I&#39;ve edited the post. Please let me know if you think I can improve more."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1481077039, "post_id": 40998196, "comment_id": 69224855, "body": "Thanks for making edits, I hope you&#39;re enjoying coding."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 2, "last_activity_date": 1481073579, "creation_date": 1481073579, "answer_id": 41007836, "question_id": 40998196, "link": "https://stackoverflow.com/questions/40998196/error-failed-to-load-interface-for-data-either-utils/41007836#41007836", "title": "Error: &quot;Failed to load interface for &#39;Data.Either.Utils&#39;&quot;", "body": "<p>The <code>Data.Either.Utils</code> module is not part of \"base\" Haskell; it's part of the MissingH package, and that package seems to be .. ha ha .. missing!</p>\n\n<p>I'm not too familiar with Cabal sandboxes (I use Stack), but presumably you can run:</p>\n\n<pre><code>cabal install MissingH\n</code></pre>\n\n<p>in your sandbox, and you should be good to go.</p>\n\n<p>If that doesn't work, just copy the code for <code>forceEither</code> from MissingH:</p>\n\n<pre><code>forceEither :: Show e =&gt; Either e a -&gt; a\nforceEither (Left x) = error (show x)\nforceEither (Right x) = x\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 4193058, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/797c59e674fc7e6f6ceaa61b07d069b7?s=128&d=identicon&r=PG&f=1", "display_name": "slothish1", "link": "https://stackoverflow.com/users/4193058/slothish1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2503, "favorite_count": 0, "accepted_answer_id": 41007836, "answer_count": 1, "score": 2, "last_activity_date": 1481073579, "creation_date": 1481035927, "last_edit_date": 1481071291, "question_id": 40998196, "link": "https://stackoverflow.com/questions/40998196/error-failed-to-load-interface-for-data-either-utils", "title": "Error: &quot;Failed to load interface for &#39;Data.Either.Utils&#39;&quot;", "body": "<p>Does anyone know why this single, specific import statement is causing a problem? I'm using sandbox and cabal. My other imports work fine (Web.Scotty, Data.Text.Lazy, etc.). I'm running with \"cabal exec runghc filename.hs\". I don't have a cabal.config file, but I do have a cabal.sandbox.config file.</p>\n\n<p>I'm attempting to use the forceEither function, which is in <code>Data.Either.Utils</code>. My import statements are normal as far as I can tell:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Web.Scotty\nimport Control.Monad.Trans (liftIO)\nimport Data.Aeson (object, (.=))\nimport Network.HTTP.Types.Status\nimport Data.Text.Lazy\nimport Data.Text.Lazy.IO\nimport Data.Either.Utils\n\nimport Data.Monoid (mconcat)\n</code></pre>\n\n<p>Message:</p>\n\n<pre><code>filename.hs:8:1: error:\n    Failed to load interface for \u2018Data.Either.Utils\u2019\n    Use -v to see a list of the files searched for.\n</code></pre>\n\n<p>Running with -v shows:</p>\n\n<pre><code>Using a sandbox located at\n/Users/myuser/Desktop/mydirectory/myotherdirectory/.cabal-sandbox\n/usr/local/bin/ghc --print-global-package-db\n/usr/local/bin/runghc filename.hs\n</code></pre>\n"}, {"tags": ["haskell", "data-analysis"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1481035160, "post_id": 40997717, "comment_id": 69204294, "body": "Would your goal be having a lightweight data schema -- essentially a representation for a tuple type like <code>(Int, String, ...)</code> except that it would have many fields? Do you think you can access said schema somewhere? E.g., written in the csv file? Otherwise, one could guess it from the first row with some heuristics(?) This might turn out to be a nice project."}, {"owner": {"reputation": 15633, "user_id": 2091169, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MT8tZ.jpg?s=128&g=1", "display_name": "Jivan", "link": "https://stackoverflow.com/users/2091169/jivan"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1481035569, "post_id": 40997717, "comment_id": 69204582, "body": "@chi kind of. However the problem with tuples is that they can contain at most 65 (or 62, don&#39;t remember exactly) elements, which makes them unpractical for this purpose."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 4, "creation_date": 1481035769, "post_id": 40997717, "comment_id": 69204736, "body": "My experience doing similar things is tuples are (almost) never the best solution. Data types in haskell are cheap, so just create a record, it will make your life much easier. Also there is the <a href=\"https://hackage.haskell.org/package/cassava\" rel=\"nofollow noreferrer\">cassava</a> package to parse it. It even have a generic instance so you don&#39;t really need to do anything to get your csv parsed properly with the correct type."}, {"owner": {"reputation": 15633, "user_id": 2091169, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MT8tZ.jpg?s=128&g=1", "display_name": "Jivan", "link": "https://stackoverflow.com/users/2091169/jivan"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1481036348, "post_id": 40997717, "comment_id": 69205187, "body": "@mb14 thanks - the data types declaration (as shown in <a href=\"https://github.com/hvr/cassava\" rel=\"nofollow noreferrer\">github.com/hvr/cassava</a>) are precisely one of the things I&#39;d like to avoid - I would prefer not having to type 350 type declarations in the beginning of the file if I have 350 features - do you know if there is a way for those types to be inferred?"}, {"owner": {"reputation": 977, "user_id": 56647, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/e1oXP.png?s=128&g=1", "display_name": "Ulrik Rasmussen", "link": "https://stackoverflow.com/users/56647/ulrik-rasmussen"}, "edited": false, "score": 1, "creation_date": 1481036663, "post_id": 40997717, "comment_id": 69205422, "body": "@Jivan that would have to occur at compile time. The only way I can think of is to use Template Haskell to generate the declaration from the CSV file header, but it seems a bit heavy."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1481044439, "post_id": 40997717, "comment_id": 69210962, "body": "Perhaps, if you want a more loosely typed approach, you define a <code>data Value = I Int | S String | ...</code> i.e. a &quot;sum type&quot; and use that for every field. There will be no static guarantees that all the CSV rows will have the same runtime &quot;shape&quot;, but it might be better than nothing."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1481044530, "post_id": 40997717, "comment_id": 69211031, "body": "@Jivan I&#39;m not sure I understand your 350 &quot;features&quot;. You only have to do 1 type declaration per file as far as I know. Now, if you are planning to process 350 different files, with 350 different functions, the overhead of creating 1 data types per files is null."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1481044622, "post_id": 40997717, "comment_id": 69211096, "body": "There is also a <a href=\"https://hackage.haskell.org/package/Frames\" rel=\"nofollow noreferrer\">frame</a> package which might be what you want. I&#39;ve never used it."}, {"owner": {"reputation": 15633, "user_id": 2091169, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MT8tZ.jpg?s=128&g=1", "display_name": "Jivan", "link": "https://stackoverflow.com/users/2091169/jivan"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1481047022, "post_id": 40997717, "comment_id": 69212524, "body": "@mb14 suppose you have three columns: <code>name, age, height</code> - with respective types <code>string, int, float</code> - that&#39;s 3 type declarations. Now imagine that you have 350 columns ( = &quot;features&quot; in machine learning vocabulary) like that. In the example provided by cassava, one would have to specify <code>data Person = Person { name :: !String, age :: !Int, height :: !Float, Feature4 :: !Int, Feature5 :: !Int, ..., Feature350 :: !Int }</code> etc up to 350 columns, or am I missing something?"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1481048808, "post_id": 40997717, "comment_id": 69213417, "body": "@Jivan Ok I didn&#39;t realize you add actually 350 columns in your csv. A tuple won&#39;t work indeed. There is possibly a limit in GHC but even without that, most interesting type classes have only instances for tuple up to 10 or 15 (sometime even only 5). A Map might be indeed the solution. However, why not having a record with a <code>feature :: [Int]</code> (or equivalent, Seq, Map) and write your cassava instance to fill this <code>feature</code> attributes from your 350 columns."}, {"owner": {"reputation": 15633, "user_id": 2091169, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MT8tZ.jpg?s=128&g=1", "display_name": "Jivan", "link": "https://stackoverflow.com/users/2091169/jivan"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1481050293, "post_id": 40997717, "comment_id": 69214166, "body": "@mb14 thanks, I&#39;ll dig into that."}, {"owner": {"reputation": 25370, "user_id": 107158, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/05243b2e0495d108111d1bb6711b1377?s=128&d=identicon&r=PG", "display_name": "Derek Mahar", "link": "https://stackoverflow.com/users/107158/derek-mahar"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1563286582, "post_id": 40997717, "comment_id": 100644275, "body": "@mb14 Does Haskell impose any limits on the number of fields in a record?"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 25370, "user_id": 107158, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/05243b2e0495d108111d1bb6711b1377?s=128&d=identicon&r=PG", "display_name": "Derek Mahar", "link": "https://stackoverflow.com/users/107158/derek-mahar"}, "edited": false, "score": 0, "creation_date": 1563286818, "post_id": 40997717, "comment_id": 100644404, "body": "@DerekMahar I wouldn&#39;t think so, but I&#39;m not sure. It might that there is no theoritical limit but practical one (maybe the compiler can choke on BIG record). Anyway, were it to happend, you can easily solve the proble by nested records."}, {"owner": {"reputation": 25370, "user_id": 107158, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/05243b2e0495d108111d1bb6711b1377?s=128&d=identicon&r=PG", "display_name": "Derek Mahar", "link": "https://stackoverflow.com/users/107158/derek-mahar"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1563286914, "post_id": 40997717, "comment_id": 100644468, "body": "@mb14 Couldn&#39;t you also use nested tuples to represent the columns in each row?"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 25370, "user_id": 107158, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/05243b2e0495d108111d1bb6711b1377?s=128&d=identicon&r=PG", "display_name": "Derek Mahar", "link": "https://stackoverflow.com/users/107158/derek-mahar"}, "edited": false, "score": 0, "creation_date": 1563289076, "post_id": 40997717, "comment_id": 100645873, "body": "@DerekMahar Yes, you could use nested tuple as well."}], "owner": {"reputation": 15633, "user_id": 2091169, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/MT8tZ.jpg?s=128&g=1", "display_name": "Jivan", "link": "https://stackoverflow.com/users/2091169/jivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1481034532, "creation_date": 1481034532, "question_id": 40997717, "link": "https://stackoverflow.com/questions/40997717/dealing-with-tabular-data-in-haskell", "title": "Dealing with tabular data in Haskell", "body": "<p>This is an excerpt of a <code>file.csv</code> file with some tabular data</p>\n\n<pre><code>John,23,Paris\nAlban,28,London\nKlaus,27,Berlin\nHans,29,Stockholm\nJulian,25,Paris\nJonathan,26,Lyon\nAlbert,27,London\n</code></pre>\n\n<p>The column headers for this file would be</p>\n\n<pre><code>firstName, age, city\n</code></pre>\n\n<p>This file is loaded in <code>ghci</code> like this</p>\n\n<pre><code>\ud835\udecc&gt; :m + Data.List Data.Function Data.List.Split\n\ud835\udecc&gt; contents &lt;- readFile \"file.csv\"\n\ud835\udecc&gt; let t = map (splitOn \",\") $ lines contents\n\ud835\udecc&gt; mapM print $ take 3 t\n[\"John\",\"23\",\"Paris\"]\n[\"Alban\",\"28\",\"London\"]\n[\"Klaus\",\"27\",\"Berlin\"]\n[(),(),()]\n</code></pre>\n\n<p>Now, if I want to add a <code>birthYear</code> column to those 3 columns, I can do</p>\n\n<pre><code>\ud835\udecc&gt; let getYear str = show $ 2016 - read str\n\ud835\udecc&gt; let withYear = map (\\(x:xs) -&gt; x : xs ++ [getYear (head xs)]) t\n\ud835\udecc&gt; mapM print $ take 3 withYear\n[\"John\",\"23\",\"Paris\",\"France\",\"1993\"]\n[\"Alban\",\"28\",\"London\",\"UK\",\"1988\"]\n[\"Klaus\",\"27\",\"Berlin\",\"Germany\",\"1989\"]\n[(),(),()]\n</code></pre>\n\n<p>This works well but what bothers me is that the <code>getYear</code> function has type <code>String -&gt; String</code> and as such, type checking is pretty much useless here.</p>\n\n<p>I could easily convert <code>t</code> into a list of tuples like <code>(\"John\", 23, \"Paris\")</code> but what about if I have not 3, but 300 features (which is not that uncommon in machine learning problems)?</p>\n\n<ul>\n<li>What would be the best way to deal with different column types? Using tuples? Using maps?</li>\n<li>In case of a big number of columns, is there a way to make Haskell infer the column's types? For instance, it would detect that column 2 in the above example is <code>Int</code>, and the others are strings?</li>\n<li>Concerning column headers, would there be a way that one could simply access the columns by label instead of by index, so that <code>getYear</code> could be something like <code>2016 - column['age']</code> (Python example)?</li>\n<li>I'm used to Python's Pandas DataFrames which perform all this stuff automagically, but Haskell looks like it could perform a ton of it natively. Not sure how to do this however as of now.</li>\n</ul>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1481032915, "post_id": 40997117, "comment_id": 69202881, "body": "<code>Control.Monad.Writer</code> already defines a type named <code>Writer</code>; why are you defining another one?"}, {"owner": {"reputation": 1342, "user_id": 1574374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6f66f66b0b5781a51040183831d6403?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Harris", "link": "https://stackoverflow.com/users/1574374/mike-harris"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1481033215, "post_id": 40997117, "comment_id": 69203061, "body": "That line (the definition of <code>Writer</code>) is just in the tutorial to explain how it&#39;s defined. You don&#39;t need to put it in your program, it&#39;s already in <code>Control.Monad.Writer</code>, as @chepner mentioned in the comment above."}, {"owner": {"reputation": 48, "user_id": 3780668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d825a8680c1c57986332041670e293?s=128&d=identicon&r=PG&f=1", "display_name": "andreas.thoelke", "link": "https://stackoverflow.com/users/3780668/andreas-thoelke"}, "edited": false, "score": 0, "creation_date": 1481033746, "post_id": 40997117, "comment_id": 69203399, "body": "Hmm, if I delete <code>newtype Writer w a = Writer { runWriter :: (a, w) }</code> I get another error: <code>writer1.hs:6:15: error:     * Data constructor not in scope:         Writer :: (Int, [[Char]]) -&gt; Writer [String] Int     * Perhaps you meant one of these:         </code>WriterT&#39; (imported from Control.Monad.Writer),         variable <code>writer&#39; (imported from Control.Monad.Writer)</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1481034224, "post_id": 40997117, "comment_id": 69203722, "body": "The library is a bit more general than your code. Instead of the constructor <code>Writer</code> you should use the plain function <code>writer</code>."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 1, "creation_date": 1481035629, "post_id": 40997117, "comment_id": 69204626, "body": "<code>Writer</code> is an alias for <code>WriterT Identity</code> but GCHi expands the names."}, {"owner": {"reputation": 48, "user_id": 3780668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d825a8680c1c57986332041670e293?s=128&d=identicon&r=PG&f=1", "display_name": "andreas.thoelke", "link": "https://stackoverflow.com/users/3780668/andreas-thoelke"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1481036051, "post_id": 40997117, "comment_id": 69204954, "body": "Thanks @chi and @Lee! The example is working when using <code>writer</code>. I&#39;m still slightly confused about why I now have to use <code>WriterT</code> which was not introduced in the book."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 2, "creation_date": 1481037333, "post_id": 40997117, "comment_id": 69205988, "body": "Imagine you wanted to print to the console within <code>logNumber</code>. <code>putStrLn &quot;message&quot;</code> has type <code>IO ()</code> which is not compatible with <code>Writer [String] Int</code>. This is a general problem with monads where different monad type constructors (e.g. <code>IO</code>, <code>Maybe</code>, <code>Writer [String]</code>) cannot be automatically composed. One solution is to use <i>monad transformers</i> which allow you to parameterise a monad by some inner monad. That is what <code>WriterT m w a</code> is, where <code>m</code> is the inner monad you can &#39;lift&#39; values of <code>m a</code> from. <code>Identity</code> is a trivial base monad you can use if you don&#39;t need any other effects."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 1, "creation_date": 1481037506, "post_id": 40997117, "comment_id": 69206107, "body": "You will find monad libraries define all monads using the transformer versions (e.g. <code>ReaderT</code>, <code>WriterT</code>, <code>MaybeT</code>) and provide aliases where the inner monad is <code>Identity</code> when you don&#39;t need to combine effects. As you&#39;ve found it does make things more complicated when learning about the base monad in question."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1481040104, "post_id": 40997117, "comment_id": 69207996, "body": "@andreas.thoelke LYaH was written before some changes were made to the base monad libraries. It is a little out of date in some details (although it remains an excellent introduction to the language as a whole)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1481044682, "post_id": 40997117, "comment_id": 69211143, "body": "I was confused as well when <code>WriterT</code> was introduced. Some years ago we used to have a simper <code>Writer</code> and then a generalization <code>WriterT</code> was added. After some time it felt silly to have the libraries carry two copies of the same thing, so the specific one (<code>Writer</code>) was redefined in terms of the more general one. The main downside is that with such approach one could not keep 100% compatibility, so that change did break some old code (as the one in your book)."}, {"owner": {"reputation": 48, "user_id": 3780668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d825a8680c1c57986332041670e293?s=128&d=identicon&r=PG&f=1", "display_name": "andreas.thoelke", "link": "https://stackoverflow.com/users/3780668/andreas-thoelke"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1481049271, "post_id": 40997117, "comment_id": 69213640, "body": "Thanks @chi that commend helped putting WriterT into perspective"}], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 3780668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d825a8680c1c57986332041670e293?s=128&d=identicon&r=PG&f=1", "display_name": "andreas.thoelke", "link": "https://stackoverflow.com/users/3780668/andreas-thoelke"}, "edited": false, "score": 0, "creation_date": 1481044817, "post_id": 41000435, "comment_id": 69211228, "body": "Thanks! I tried <code>import qualified Control.Monad.Writer as MW</code> and then use <code>MW.Writer</code>, but I&#39;m still getting an error: <code>writer1.hs:8:15: error:     Not in scope: data constructor MW.Writer     Perhaps you meant one of these:       MW.WriterT (imported from Control.Monad.Writer),       variable MW.writer (imported from Control.Monad.Writer)     Module Control.Monad.Writer does not export Writer.</code>"}, {"owner": {"reputation": 1513, "user_id": 6624417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a73a12db09cb90a99be14fa2bb7b6096?s=128&d=identicon&r=PG&f=1", "display_name": "E4z9", "link": "https://stackoverflow.com/users/6624417/e4z9"}, "reply_to_user": {"reputation": 48, "user_id": 3780668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d825a8680c1c57986332041670e293?s=128&d=identicon&r=PG&f=1", "display_name": "andreas.thoelke", "link": "https://stackoverflow.com/users/3780668/andreas-thoelke"}, "edited": false, "score": 1, "creation_date": 1481057685, "post_id": 41000435, "comment_id": 69218063, "body": "True, in Control.MonadWriter, <code>Writer w a</code> is just a type alias for <code>WriterT w Identity a</code>. It is not its own type with its own data constructor, so you cannot create one with <code>Writer (x, [&quot;Got number: &quot; ++ show x])</code>. As Lee wrote you can use <code>writer</code> from <code>MonadWriter</code>: Since you have already heard of <code>Applicative</code>, I&#39;d say it is similar to <code>pure</code>. Since <code>Writer w</code> (well, actually <code>WriterT w Identity</code>, but that is more an implementation detail for you right now), is an instance of <code>MonadWriter</code>, you can use <code>writer</code> to create one."}, {"owner": {"reputation": 48, "user_id": 3780668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d825a8680c1c57986332041670e293?s=128&d=identicon&r=PG&f=1", "display_name": "andreas.thoelke", "link": "https://stackoverflow.com/users/3780668/andreas-thoelke"}, "edited": false, "score": 0, "creation_date": 1481058413, "post_id": 41000435, "comment_id": 69218442, "body": "Thanks @E4z9, I think this explains it well."}, {"owner": {"reputation": 1513, "user_id": 6624417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a73a12db09cb90a99be14fa2bb7b6096?s=128&d=identicon&r=PG&f=1", "display_name": "E4z9", "link": "https://stackoverflow.com/users/6624417/e4z9"}, "reply_to_user": {"reputation": 48, "user_id": 3780668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d825a8680c1c57986332041670e293?s=128&d=identicon&r=PG&f=1", "display_name": "andreas.thoelke", "link": "https://stackoverflow.com/users/3780668/andreas-thoelke"}, "edited": false, "score": 0, "creation_date": 1481058585, "post_id": 41000435, "comment_id": 69218545, "body": "In principle it also is possible to take the direct way and create a <code>Writer [String] Int</code> by creating the actual <code>WriterT [String] Identity Int</code> with <code>WriterT $ Identity (x, [&quot;Got number: &quot; ++ show x])</code> (you need to import <code>Data.Functor.Identity</code> too, then)."}], "tags": [], "owner": {"reputation": 1513, "user_id": 6624417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a73a12db09cb90a99be14fa2bb7b6096?s=128&d=identicon&r=PG&f=1", "display_name": "E4z9", "link": "https://stackoverflow.com/users/6624417/e4z9"}, "is_accepted": true, "score": 1, "last_activity_date": 1481042376, "creation_date": 1481042376, "answer_id": 41000435, "question_id": 40997117, "link": "https://stackoverflow.com/questions/40997117/difficulties-understanding-ambiguous-occurrence-writer-error/41000435#41000435", "title": "Difficulties understanding Ambiguous occurrence `Writer&#39; error", "body": "<p>If you want to follow the exercise in the book, and implement Writer yourself, then just remove the <code>import Control.Monad.Writer</code> from your code.</p>\n\n<p>It looks though like the book switches to use <code>Control.Monad.Writer</code> in \n\"Using do notation with Writer\", so there you would just remove your own definition of <code>Writer</code> and use the <code>import Control.Monad.Writer</code>.</p>\n\n<p><code>Control.Monad.Writer</code> exports a type <code>Writer</code>, so that clashes with your own type.</p>\n\n<p>If you would want to use method or types from <code>Control.Monad.Writer</code> anyhow, you could import it under a different name. E.g. <code>import qualified Control.Monad.Writer as MW</code>, then you could access the <code>Writer</code> defined there as <code>MW.Writer</code>, and your own as just <code>Writer</code>.</p>\n\n<p>The <a href=\"https://wiki.haskell.org/Import\" rel=\"nofollow noreferrer\">Haskell wiki</a> has pretty extensive documentation on how you can import modules in different ways (import just specific symbols, import a module without importing specific symbols, etc).</p>\n"}], "owner": {"reputation": 48, "user_id": 3780668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d825a8680c1c57986332041670e293?s=128&d=identicon&r=PG&f=1", "display_name": "andreas.thoelke", "link": "https://stackoverflow.com/users/3780668/andreas-thoelke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 41000435, "answer_count": 1, "score": 0, "last_activity_date": 1481042376, "creation_date": 1481032745, "last_edit_date": 1495540907, "question_id": 40997117, "link": "https://stackoverflow.com/questions/40997117/difficulties-understanding-ambiguous-occurrence-writer-error", "title": "Difficulties understanding Ambiguous occurrence `Writer&#39; error", "body": "<p>When trying to load the following code into ghci:</p>\n\n<pre><code>import Control.Monad.Writer\n\nnewtype Writer w a = Writer { runWriter :: (a, w) } \n\nlogNumber :: Int -&gt; Writer [String] Int  \nlogNumber x = Writer (x, [\"Got number: \" ++ show x])  \n\nmultWithLog :: Writer [String] Int  \nmultWithLog = do  \n    a &lt;- logNumber 3  \n    b &lt;- logNumber 5  \n    return (a*b)  \n</code></pre>\n\n<p>(it's from <a href=\"http://learnyouahaskell.com/for-a-few-monads-more\" rel=\"nofollow noreferrer\">http://learnyouahaskell.com/for-a-few-monads-more</a>)</p>\n\n<p>I'm receiving this error:</p>\n\n<pre><code>writer1.hs:8:16: error:\n    Ambiguous occurrence `Writer'\n    It could refer to either `Control.Monad.Writer.Writer',\n                             imported from `Control.Monad.Writer' at writer1.hs:1:1-27\n                             (and originally defined in `Control.Monad.Trans.Writer.Lazy')\n                          or `Main.Writer', defined at writer1.hs:3:1\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I have read through related questions on SO e.g. <a href=\"https://stackoverflow.com/questions/11589207/ambiguous-occurrence-just\"> Ambiguous occurrence `Just&#39;  </a> but I'm still struggling to see how to best apply this in my case.\nBeyond this specific problem it would be great if you could point to any conventions of how to avoid similar naming ambiguities.</p>\n\n<p>Edit:\nAs @chi pointed out in the comments I can skip <code>newtype Writer w a = Writer { runWriter :: (a, w) }</code> and then use a provided function <code>writer</code> instead of the <code>Writer</code> constructor. However this differs from the code in the book (which uses <code>Writer</code>) and when I call this in the REPL it shows me a different type <code>WriterT</code>:</p>\n\n<pre><code>*Main&gt; logNumber 3\nWriterT (Identity (3,[\"Got number: 3\"]))\n</code></pre>\n\n<p>So I'm still not sure if using the <code>writer</code> function is how that code example is supposed to work.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 10, "last_activity_date": 1481018245, "creation_date": 1481018245, "answer_id": 40992467, "question_id": 40992091, "link": "https://stackoverflow.com/questions/40992091/implement-takewhile-with-fold/40992467#40992467", "title": "Implement takeWhile with fold", "body": "<p>Just change <code>acc</code> to <code>[]</code> in the <code>else</code> branch:</p>\n\n<pre><code>takeWhile f = foldr (\\x acc -&gt; if f x then x : acc else []) []\n</code></pre>\n\n<p>The idea is that you\u2019re lazily building the result list as you consume elements from the input list, so you return <code>[]</code> when you want to terminate the result list.</p>\n\n<pre><code>takeWhile (&lt; 3) [0..]\n=\n0 : takeWhile (&lt; 3) [1..]\n=\n0 : 1 : takeWhile (&lt; 3) [2..]\n=\n0 : 1 : 2 : takeWhile (&lt; 3) [3..]\n=\n0 : 1 : 2 : []\n=\n[0, 1, 2]\n</code></pre>\n\n<p>This also illustrates how Haskell lists are really <em>streams</em> of values. Right folds are little state machines that move step-by-step through an input stream to generate an output stream.</p>\n"}], "owner": {"reputation": 271, "user_id": 3727064, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/685893932/picture?type=large", "display_name": "Amoz", "link": "https://stackoverflow.com/users/3727064/amoz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2356, "favorite_count": 1, "accepted_answer_id": 40992467, "answer_count": 1, "score": 3, "last_activity_date": 1481018245, "creation_date": 1481017074, "question_id": 40992091, "link": "https://stackoverflow.com/questions/40992091/implement-takewhile-with-fold", "title": "Implement takeWhile with fold", "body": "<p>How can I implement the takeWhile function in Haskell using fold?</p>\n\n<pre><code>takeWhile :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>I tried a strategy similiar to implementing filter like this</p>\n\n<pre><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter f = foldr (\\x acc -&gt; if f x then x : acc else acc) []\n</code></pre>\n\n<p>But how can I stop when f x is false?</p>\n"}, {"tags": ["haskell", "functional-programming", "double"], "comments": [{"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "edited": false, "score": 5, "creation_date": 1480979133, "post_id": 40984926, "comment_id": 69179557, "body": "I think there&#39;s a misunderstanding here: <code>280.87936</code> and <code>280.88</code> could both be <code>Float</code> <i>or</i> <code>Doubles</code>. Do you actually need a <code>Double</code>, or do you want to round your answer to two decimal points?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1480980778, "post_id": 40984926, "comment_id": 69180141, "body": "<code>orbitalPeriodInSeconds</code> doesn&#39;t need to return a <code>Float</code>; it can return a polymorphic value whose type is an instance of the <code>Fractional</code> type class. (<code>orbitalPeriodInSeconds :: Fractional a =&gt; Planet -&gt; a</code>). The same goes for <code>ageOn :: Fractional a =&gt; Planet -&gt; a -&gt; a</code>."}, {"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1480981300, "post_id": 40984926, "comment_id": 69180285, "body": "might be a duplicate of <a href=\"http://stackoverflow.com/questions/1559590/haskell-force-floats-to-have-two-decimals\" title=\"haskell force floats to have two decimals\">stackoverflow.com/questions/1559590/&hellip;</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1480982841, "post_id": 40984926, "comment_id": 69180708, "body": "You say &quot;of course the compiler will raise errors if I change Float to Double&quot;; I challenge you to test this hypothesis. When <i>I</i> change all the instances of <code>Float</code> to <code>Double</code>, the compiler doesn&#39;t complain at all. &quot;I get <code>280.87936</code> but I need <code>280.88</code>&quot; is a mostly unrelated issue."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1480993129, "post_id": 40984926, "comment_id": 69183364, "body": "A good rule of thumb is &quot;Never use <code>Float</code>.&quot; There are some special exceptions when dealing with certain protocols, special hardware, numerical recipes, or when really trying to pack things up tightly, but when you think of <code>Float</code> you should almost always use <code>Double</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "is_accepted": false, "score": 3, "last_activity_date": 1480980388, "creation_date": 1480980388, "answer_id": 40985242, "question_id": 40984926, "link": "https://stackoverflow.com/questions/40984926/haskell-from-float-to-double/40985242#40985242", "title": "Haskell from float to Double", "body": "<p>If the need is to display the result you can use <code>showFFloat</code> from <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Numeric.html#v:showFFloat%20Numeric\" rel=\"nofollow noreferrer\">Numeric</a></p>\n\n<pre><code>showFFloat (Just 2) 280.87936 \"\"\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 2804809, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/41830f7758621f29c2a35629943a0ebe?s=128&d=identicon&r=PG&f=1", "display_name": "Romano", "link": "https://stackoverflow.com/users/2804809/romano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480980388, "creation_date": 1480978921, "question_id": 40984926, "link": "https://stackoverflow.com/questions/40984926/haskell-from-float-to-double", "title": "Haskell from float to Double", "body": "<p>I've been trying to learn haskell for a couple days but I can't see to figure out how to create an answer/output that is a float, to a double</p>\n\n<pre><code>module SpaceAge ( Planet(..), ageOn) where\n-- calculate seconds to an age on different planets\ndata Planet = Earth\n            | Jupiter\n            | Mars\n            | Mercury\n            | Neptune\n            | Saturn\n            | Uranus\n            | Venus\n\n-- one year has 31557600 seconds\norbitalPeriodInSeconds :: Planet -&gt; Float\norbitalPeriodInSeconds planet = 31557600 * multiplier where\n    multiplier = case planet of\n        Earth   -&gt; 1.0\n        Jupiter -&gt; 11.862615\n        Mars    -&gt; 1.8808158\n        Mercury -&gt; 0.2408467\n        Neptune -&gt; 164.79132\n        Saturn  -&gt; 29.447498\n        Uranus  -&gt; 84.016846\n        Venus   -&gt; 0.61519726\n\n-- user input example: ageOn Venus 9303000\nageOn :: Planet -&gt; Float -&gt; Float\nageOn planet seconds = seconds / orbitalPeriodInSeconds planet\n</code></pre>\n\n<p>The answer/output will be a float but I need to get a double.\nExample</p>\n\n<p>*SpaceAge> ageOn Mercury 2134835688<br>\n280.87936</p>\n\n<p>But I need 280.88\n<br>\nOffcourse the compiler will raise errors if I change Float to Double because it expect a Float.</p>\n"}, {"tags": ["haskell", "template-haskell"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 3, "creation_date": 1480978553, "post_id": 40984818, "comment_id": 69179319, "body": "Could you solve this with something as simple as <code>data Foo f { bar :: f Int, baz :: f Bool }</code>, then <code>type FooOpt = Foo Maybe</code>? Or do you need the type safety of separate types?"}, {"owner": {"reputation": 93, "user_id": 3284560, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9b8bd7d436e5a63188f54920ef13f9ba?s=128&d=identicon&r=PG&f=1", "display_name": "bartfrenk", "link": "https://stackoverflow.com/users/3284560/bartfrenk"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1480978649, "post_id": 40984818, "comment_id": 69179362, "body": "No, I cannot touch the original type."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1480982645, "post_id": 40984818, "comment_id": 69180660, "body": "Are you sure you can&#39;t generalize the original type, so to use a nearly isomorphic one instead as Alexis suggests? Otherwise, I guess Template Haskell is your only option, but I wonder why you really need this."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1480982711, "post_id": 40984818, "comment_id": 69180677, "body": "Is <a href=\"http://stackoverflow.com/questions/38229211/how-can-i-represent-data-with-optional-fields-at-the-type-level\">this question</a> close enough to your goal?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1480983937, "post_id": 40984818, "comment_id": 69180969, "body": "Do you actually need a proper <code>data</code> declaration (in that case there&#39;s no way around TH), or do you only need <i>some type that&#39;s isomorphic</i> to the modified <code>R</code>? In that case a solution with generics alone might be possible (which of course requires a <code>Generic</code> instance for <code>R</code>, but that shouldn&#39;t be a hurdle)."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1481033964, "post_id": 40984818, "comment_id": 69203541, "body": "generics-sop can do something like that <a href=\"http://stackoverflow.com/questions/39020787/is-there-a-way-to-apply-maybe-constructor-to-each-field-of-record-with-generics\" title=\"is there a way to apply maybe constructor to each field of record with generics\">stackoverflow.com/questions/39020787/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 3284560, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9b8bd7d436e5a63188f54920ef13f9ba?s=128&d=identicon&r=PG&f=1", "display_name": "bartfrenk", "link": "https://stackoverflow.com/users/3284560/bartfrenk"}, "edited": false, "score": 0, "creation_date": 1481040682, "post_id": 40997196, "comment_id": 69208362, "body": "Nice. I didn&#39;t know about EraseIdentity"}], "tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 2, "last_activity_date": 1481033002, "creation_date": 1481033002, "answer_id": 40997196, "question_id": 40984818, "link": "https://stackoverflow.com/questions/40984818/apply-type-constructor-to-components-of-a-record-type/40997196#40997196", "title": "Apply type constructor to components of a record type", "body": "<p>You can parametrize your type with another type (usually a functor) and do</p>\n\n<pre><code>data Foo f {\n   bar :: f Int\n   baz :: f Bool\n}\n</code></pre>\n\n<p>And they use <code>Foo Identity</code> and <code>Foo Maybe</code>. The problem with this is <code>Foo Identity</code> doesn't give you <code>{bar :: Int, baz :: Bool}</code> but <code>{bar :: Identity Int, baz :: Identity Bool}</code>. It's semantically equivalent but a pain in practice because you have to unwrap all field from Identity.</p>\n\n<p>The advantages however, is you can write method which are generic on <code>f</code> and work for both <code>Foo Identity</code> and <code>Foo Maybe</code>. You can get rid of the <code>Identity</code> by using type families. </p>\n\n<pre><code>type family EraseIdentity f a where\n     EraseIdentity Identity a = a\n     EraseIdentity f a = f a\n\n data Foo f = Foo {\n      bar :: EraseIdentity f Int\n      baz :: EraseIdentity f Bool\n }\n</code></pre>\n\n<p>Type families are function on types, and what you are saying here is , transforms <code>Identity a</code> to <code>a</code>. Now <code>Foo Identity</code> is a <code>{ bar :: Int, baz :: Bool}</code>.</p>\n"}], "owner": {"reputation": 93, "user_id": 3284560, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9b8bd7d436e5a63188f54920ef13f9ba?s=128&d=identicon&r=PG&f=1", "display_name": "bartfrenk", "link": "https://stackoverflow.com/users/3284560/bartfrenk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1481033002, "creation_date": 1480978348, "question_id": 40984818, "link": "https://stackoverflow.com/questions/40984818/apply-type-constructor-to-components-of-a-record-type", "title": "Apply type constructor to components of a record type", "body": "<p>Given a fixed type constructor T, and a record type R, is there a mechanism to create a declaration for the record type whose components are those of R, but with T applied to the type.</p>\n\n<p>For example, with T being <code>Maybe</code>, and R,</p>\n\n<pre><code>data Foo {\n  bar :: Int,\n  baz :: Bool\n}\n</code></pre>\n\n<p>the mechanism should give,</p>\n\n<pre><code>data Foo {\n  bar :: Maybe Int,\n  baz :: Maybe Bool\n}\n</code></pre>\n\n<p>Or possibly,</p>\n\n<pre><code>data FooOpt {\n  barOpt :: Maybe Int,\n  bazOpt :: Maybe Bool\n}\n</code></pre>\n\n<p>where the <code>Opt</code> suffix is specified as a parameter.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 42290, "user_id": 3757, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/886cefc5134a9df362fe871b0ab71d38?s=128&d=identicon&r=PG", "display_name": "Christian Oudard", "link": "https://stackoverflow.com/users/3757/christian-oudard"}, "edited": false, "score": 0, "creation_date": 1480979844, "post_id": 40983442, "comment_id": 69179841, "body": "Thank you for the simple improvement to my construction."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 4, "last_activity_date": 1480972890, "last_edit_date": 1480972890, "creation_date": 1480972416, "answer_id": 40983442, "question_id": 40983249, "link": "https://stackoverflow.com/questions/40983249/shouldnt-this-be-in-a-library-somewhere/40983442#40983442", "title": "Shouldn&#39;t this be in a library somewhere?", "body": "<p>I don't know if it exists somewhere, but it can be neatly defined as:</p>\n\n<pre><code>chain :: Monad m =&gt; Int -&gt; (c -&gt; m c) -&gt; c -&gt; m c\nchain n = foldr (&gt;=&gt;) return . replicate n\n</code></pre>\n\n<p><a href=\"https://hackage.haskell.org/package/monad-loops-0.4.3/docs/Control-Monad-Loops.html\" rel=\"nofollow noreferrer\"><em>monad-loops</em></a> has a few potentially useful functions in that vein (<code>foldr (&gt;=&gt;) return</code>, for instance, is <code>concatM</code>), though not exactly your <code>chain</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "is_accepted": false, "score": 3, "last_activity_date": 1480973344, "creation_date": 1480973344, "answer_id": 40983678, "question_id": 40983249, "link": "https://stackoverflow.com/questions/40983249/shouldnt-this-be-in-a-library-somewhere/40983678#40983678", "title": "Shouldn&#39;t this be in a library somewhere?", "body": "<p>For such cases it is always a good idea to search for your desired type on Stackage, Hoogle <strong>and</strong> Hayoo. In this case you can find <a href=\"http://hayoo.fh-wedel.de/?query=Int+-%3E+%28a+-%3E+m+a%29+-%3E+a+-%3E+m+a\" rel=\"nofollow noreferrer\">two results</a> on Hayoo and <a href=\"https://www.stackage.org/lts-7.12/hoogle?q=Monad+m+%3D%3E+Int+-%3E+%28a+-%3E+m+a%29+-%3E+a+-%3E+m+a\" rel=\"nofollow noreferrer\">some more</a> on Stackage. However in this case I think I would just use @duplode's solution instead of depending on another package for that (unless you like a lot of the functions in one of the packages).</p>\n\n<p>Another tip if you do search on those sites is to think of possible generalisations of your function. For example in this case if one was willing to conjugate with a <code>Kleisli</code> newtype wrapper a function like this would also work:</p>\n\n<pre><code> composeN :: Category cat =&gt; Int -&gt; cat a a -&gt; cat a a\n</code></pre>\n\n<p>Sadly I couldn't find such a function.</p>\n\n<p>(<code>Categorie</code>s are things that can be composed and have an identity.)</p>\n"}, {"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1480979093, "post_id": 40983817, "comment_id": 69179538, "body": "just a note - <code>TypeApplication</code> is a very recent addition to GHC (8.0) see <a href=\"https://ghc.haskell.org/trac/ghc/wiki/TypeApplication\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/wiki/TypeApplication</a> for more details"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1480974320, "last_edit_date": 1480974320, "creation_date": 1480973830, "answer_id": 40983817, "question_id": 40983249, "link": "https://stackoverflow.com/questions/40983249/shouldnt-this-be-in-a-library-somewhere/40983817#40983817", "title": "Shouldn&#39;t this be in a library somewhere?", "body": "<p>If I were to propose a library to put it in, I'd propose adding <code>Semigroup</code> and <code>Monoid</code> instances for the following newtype:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE TypeApplications #-}\nimport Control.Monad\nimport GHC.Prim (coerce)\n\nnewtype KleisliEndo m a = KE { runKE :: a -&gt; m a }\ninstance Monad m =&gt; Monoid (KleisliEndo m a) where\n    mempty = coerce (return @m @a)\n    mappend = coerce ((&gt;=&gt;) @m @a @a @a)\n</code></pre>\n\n<p>Then <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Semigroup.html#v:stimesMonoid\" rel=\"nofollow noreferrer\"><code>stimesMonoid</code></a> is your operation.</p>\n\n<p>I wouldn't be surprised to learn that this newtype is indeed in a library somewhere, too.</p>\n"}, {"comments": [{"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1480974390, "post_id": 40983855, "comment_id": 69177428, "body": "May I propose using <code>foldMap</code> instead of <code>fold . map</code>."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1480974451, "post_id": 40983855, "comment_id": 69177460, "body": "In your edit you forgot to conjugate with the kleisli newtype."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1480974709, "post_id": 40983855, "comment_id": 69177608, "body": "@jpath Thanks! I completely missed that. I was already making a <code>composeN</code> when you answered but I hadn&#39;t generalized the signature. Nice idea!"}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1480974949, "post_id": 40983855, "comment_id": 69177739, "body": "Also I think you still have to import <code>Kleisli(..)</code> and <code>runKleisli</code> from <code>Control.Arrow</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1480974977, "post_id": 40983855, "comment_id": 69177752, "body": "@Alec Nice, I didn&#39;t know about <code>Endomorphism</code>! Some (like me) might also like the spelling that turns on <code>ScopedTypeVariables</code> and then has <code>chain = coerce (stimesMonoid @Int @(Endomorphism (Kleisli m) c))</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1480975049, "post_id": 40983855, "comment_id": 69177785, "body": "@DanielWagner Oh I see the trick you are playing! I like it very much indeed!!! I will add it on to my answer."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1480976768, "post_id": 40983855, "comment_id": 69178522, "body": "Also maybe you should point out that <code>Data.Monoid.Endomorphism</code> is from the <code>monoid-extras</code> package."}, {"owner": {"reputation": 42290, "user_id": 3757, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/886cefc5134a9df362fe871b0ab71d38?s=128&d=identicon&r=PG", "display_name": "Christian Oudard", "link": "https://stackoverflow.com/users/3757/christian-oudard"}, "edited": false, "score": 0, "creation_date": 1480979825, "post_id": 40983855, "comment_id": 69179835, "body": "This is all completely out of my depth. I can&#39;t see myself importing endomorphism and semigroup for a function this simple."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 42290, "user_id": 3757, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/886cefc5134a9df362fe871b0ab71d38?s=128&d=identicon&r=PG", "display_name": "Christian Oudard", "link": "https://stackoverflow.com/users/3757/christian-oudard"}, "edited": false, "score": 0, "creation_date": 1480986485, "post_id": 40983855, "comment_id": 69181617, "body": "@ChristianOudard I probably wouldn&#39;t either, although mostly because I would have to bring in an external dependency. However, should <code>Endomorphism</code> be moved into <code>Data.Monoid</code>, I would reconsider - the abstractions make the intent clearer, there is no extra cost (definitely not for the <code>coerce</code> version), and <code>stimesMonoid</code> may actually be a bit more efficient (it uses a halving technique) than the solution with <code>replicate</code>."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 6, "last_activity_date": 1480977076, "last_edit_date": 1480977076, "creation_date": 1480973985, "answer_id": 40983855, "question_id": 40983249, "link": "https://stackoverflow.com/questions/40983249/shouldnt-this-be-in-a-library-somewhere/40983855#40983855", "title": "Shouldn&#39;t this be in a library somewhere?", "body": "<p>The answer proposed by @duplode (involving <code>foldr</code>) is of course correct. However, it is slightly annoying that one must choose between <code>foldl</code> and <code>foldr</code> here, since really <code>(&gt;=&gt;)</code> is really associative. In fact, this is just <em>begging</em> to be solved using <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Foldable.html#v:fold\" rel=\"nofollow noreferrer\"><code>fold :: Monoid m =&gt; t m -&gt; m</code></a>.</p>\n\n<p>Unfortunately, there is no <code>newtype</code> wrapper for this monoid in <code>Data.Monoid</code>. The closest one gets is <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Monoid.html#t:Endo\" rel=\"nofollow noreferrer\"><code>Endo</code></a> which falls a bit short. However with <a href=\"http://hackage.haskell.org/package/monoid-extras-0.4.2/docs/Data-Monoid-Endomorphism.html#\" rel=\"nofollow noreferrer\"><code>Endomorphism</code></a> from the <a href=\"http://hackage.haskell.org/package/monoid-extras\" rel=\"nofollow noreferrer\"><code>monoid-extras</code></a> package we can generate the useful <code>composeN</code> function @jpath suggests for your function generalized to <code>Category</code>:</p>\n\n<pre><code>composeN :: Category cat =&gt; Int -&gt; cat a a -&gt; cat a a\ncomposeN n = getEndomorphism . foldMap Endomorphism . replicate n\n</code></pre>\n\n<p>Then what we really want is to use <code>composeN</code> for the <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Arrow.html#t:Kleisli\" rel=\"nofollow noreferrer\"><code>Kleisli</code></a> category</p>\n\n<pre><code>chain :: Monad m =&gt; Int -&gt; (c -&gt; m c) -&gt; c -&gt; m c\nchain n = runKleisli . composeN n . Kleisli\n</code></pre>\n\n<h3>EDIT</h3>\n\n<p>Following @Daniel Wagners answer - <code>Endomorphism</code> is the monoid you need. I think this is as nice as it can get:</p>\n\n<pre><code>import Data.Monoid.Endomorphism (Endomorphism(..))\nimport Data.Semigroup (stimesMonoid)\nimport Control.Arrow (Kleisli(..))\n\nchain :: Monad m =&gt; Int -&gt; (c -&gt; m c) -&gt; c -&gt; m c\nchain n = (runKleisli . getEndomorphism) . stimesMonoid n . (Endomorphism . Kleisli)\n</code></pre>\n\n<p>If you are not averse to enabling language extensions, you can use actually get rid of the <code>runKleisli . getEndomorphism</code> and <code>Endomorphism . Kleisli</code> with coercions.</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables, TypeApplications #-}\n\nimport Data.Monoid.Endomorphism (Endomorphism(..))\nimport Data.Semigroup (stimesMonoid)\nimport Control.Arrow (Kleisli(..))\nimport Data.Coerce (coerce)\n\nchain :: forall m c. Monad m =&gt; Int -&gt; (c -&gt; m c) -&gt; c -&gt; m c\nchain = coerce (stimesMonoid @Int @(Endomorphism (Kleisli m) c))\n</code></pre>\n"}], "owner": {"reputation": 42290, "user_id": 3757, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/886cefc5134a9df362fe871b0ab71d38?s=128&d=identicon&r=PG", "display_name": "Christian Oudard", "link": "https://stackoverflow.com/users/3757/christian-oudard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 1, "accepted_answer_id": 40983442, "answer_count": 4, "score": 2, "last_activity_date": 1480977076, "creation_date": 1480971631, "question_id": 40983249, "link": "https://stackoverflow.com/questions/40983249/shouldnt-this-be-in-a-library-somewhere", "title": "Shouldn&#39;t this be in a library somewhere?", "body": "<p>I was writing some code to generate a lot of random values and add them to a structure, and I needed a mechanism to chain up identical IO actions. So, I wrote this:</p>\n\n<pre><code>chain :: Monad m =&gt; Int -&gt; (a -&gt; m a) -&gt; a -&gt; m a\nchain 0 _ a = return a\nchain n f a = f =&lt;&lt; chain (n-1) f a\n</code></pre>\n\n<p>I get a suspicion that this should be in some library somewhere, but I couldn't find it in Control.Monad. Is this function already written? Is there an easier way to do this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 1, "creation_date": 1480977760, "post_id": 40982746, "comment_id": 69178953, "body": "Could you please provide smallest complete code example? From what you wrote I don&#39;t see any reasons why it shouldn&#39;t work."}, {"owner": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1481021557, "post_id": 40982746, "comment_id": 69195682, "body": "Yep. Updated with a complete example."}], "answers": [{"comments": [{"owner": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "edited": false, "score": 0, "creation_date": 1481027341, "post_id": 40995265, "comment_id": 69199216, "body": "Hmmm, but the reason I&#39;m using <code>&quot;Linker&quot;</code> in the logger name is because I am logging to that specific logger each time. What&#39;s the point of logger names if root is always the one used? I thought I had to configure them by-name?"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "edited": false, "score": 1, "creation_date": 1481028013, "post_id": 40995265, "comment_id": 69199662, "body": "@atc Point of logger names is that <code>hslogger</code> uses hierarchy of loggers. All loggers should be children of <code>rootLoggerName</code>. For example <code>&quot;Linker.Child&quot;</code> is a child of logger with name <code>&quot;Linker&quot;</code> and <code>&quot;Linker&quot;</code> is a child of <code>&quot;&quot;</code> which is <code>rootLoggerName</code>. By default all children inherits <code>Priority</code> from their parent. Consider next code: <a href=\"http://lpaste.net/6216398766442807296\" rel=\"nofollow noreferrer\">lpaste.net/6216398766442807296</a> . You won&#39;t see <code>&quot;Hallo 2&quot;</code> message. So you should initialize <i>root</i> and only then initialize all your subloggers."}, {"owner": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "edited": false, "score": 0, "creation_date": 1481028145, "post_id": 40995265, "comment_id": 69199748, "body": "Makes sense! I understood the hierarchy element just hadn&#39;t expected that setting a child would end up with duplicates, but of course the <code>setHandlers</code> is applied to the child and <i>not</i> the root logger, hence the duplication. Thanks!"}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 3, "last_activity_date": 1481028261, "last_edit_date": 1481028261, "creation_date": 1481026736, "answer_id": 40995265, "question_id": 40982746, "link": "https://stackoverflow.com/questions/40982746/hslogger-duplicate-log-lines/40995265#40995265", "title": "hslogger &amp; Duplicate Log Lines", "body": "<p>I found error in your program. Actually, it was in your first code, I just didn't pay enough attention to it :(</p>\n\n<p>All you need is to replace logger name with <a href=\"http://hackage.haskell.org/package/hslogger-1.2.10/docs/System-Log-Logger.html#v:rootLoggerName\" rel=\"nofollow noreferrer\">rootLoggerName</a> in</p>\n\n<pre><code>updateGlobalLogger \"Linker\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code>updateGlobalLogger rootLoggerName\n</code></pre>\n\n<p>This did the trick for me. I don't know what happens when you're not initializing with root logger but now it will at least work.</p>\n\n<p>Also, if you're using <code>stack</code> and don't mind using <code>github</code> projects then you may wish to consider using our logging library (it is not currently on hackage) which is a wrapper around <code>hslogger</code> which adds some juice to it (like coloured logger names and more): </p>\n\n<p><a href=\"https://github.com/serokell/log-warper\" rel=\"nofollow noreferrer\">https://github.com/serokell/log-warper</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/dcR7r.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dcR7r.png\" alt=\"Colored logging\"></a></p>\n"}], "owner": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 40995265, "answer_count": 1, "score": 2, "last_activity_date": 1481028261, "creation_date": 1480969720, "last_edit_date": 1481021547, "question_id": 40982746, "link": "https://stackoverflow.com/questions/40982746/hslogger-duplicate-log-lines", "title": "hslogger &amp; Duplicate Log Lines", "body": "<p>I've configured logging like so:</p>\n\n<pre><code>import System.Environment\nimport System.Log.Logger\nimport System.Log.Handler (setFormatter)\nimport System.Log.Handler.Simple (streamHandler)\nimport System.Log.Formatter\nimport System.IO (getLine, stdout)\nmain = do\nstdOutHandler &lt;- streamHandler stdout DEBUG &gt;&gt;= \\lh -&gt; return $\n            setFormatter lh (simpleLogFormatter \"[$time : $loggername : $prio] $msg\")\n  updateGlobalLogger \"Linker\" (setLevel DEBUG . setHandlers [stdOutHandler])\n  infoM \"Linker\" \"Hello world!\"\n</code></pre>\n\n<p>Unfortunately, every time I use <code>infoM</code> (or any logging function), I get duplicate lines, e.g.</p>\n\n<pre><code>infoM \"Linker\" \"hi there\"\n</code></pre>\n\n<p>produces:</p>\n\n<pre><code>hi there\n[2016-12-05 20:23:10 GMT : Linker : INFO] hi there\n</code></pre>\n\n<p>I thought <code>setHandlers</code> removed other handlers first. </p>\n\n<p>I want just the lines that are formatted, not the \"normal\" format ala <code>putStrLn</code> etc.</p>\n"}, {"tags": ["haskell", "pattern-matching", "monads"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1480964647, "post_id": 40981424, "comment_id": 69172315, "body": "Change the instance to <code>instance (Num a, Ord a) =&gt; Evaluable NExpr  where ...</code>"}, {"owner": {"reputation": 548, "user_id": 4547068, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/651f7915c52ada9f3b616430481ec37f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roca Lopez", "link": "https://stackoverflow.com/users/4547068/daniel-roca-lopez"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480964747, "post_id": 40981424, "comment_id": 69172354, "body": "then it says: Expecting one more argument to Nexpr the first argument of Evaluable should have kind * but has kind * -&gt; * @Alec"}], "answers": [{"comments": [{"owner": {"reputation": 548, "user_id": 4547068, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/651f7915c52ada9f3b616430481ec37f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roca Lopez", "link": "https://stackoverflow.com/users/4547068/daniel-roca-lopez"}, "edited": false, "score": 0, "creation_date": 1480968720, "post_id": 40981956, "comment_id": 69174558, "body": "it was a problem with indentation"}], "tags": [], "owner": {"reputation": 1513, "user_id": 6624417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a73a12db09cb90a99be14fa2bb7b6096?s=128&d=identicon&r=PG&f=1", "display_name": "E4z9", "link": "https://stackoverflow.com/users/6624417/e4z9"}, "is_accepted": true, "score": 4, "last_activity_date": 1480967075, "last_edit_date": 1480967075, "creation_date": 1480966541, "answer_id": 40981956, "question_id": 40981424, "link": "https://stackoverflow.com/questions/40981424/haskell-rigid-type-variable-error/40981956#40981956", "title": "Haskell: Rigid type variable error", "body": "<p>If the code block that you gave is really exactly what you've got in your file, then you got your indentation wrong. After fixing the indentation, and following the hint of Alec regarding the instance definition, this type-checks:</p>\n\n<pre><code>type Ident = String\n\ndata NExpr n = Const n |\n            Var Ident |\n            Plus (NExpr n) (NExpr n) |\n            Minus (NExpr n) (NExpr n) |\n            Times (NExpr n) (NExpr n)\n\ndata Symtable a = General a | Stack a\n\nclass Evaluable e where\n  eval :: (Num a, Ord a) =&gt; (Ident -&gt; Maybe a) -&gt; e a -&gt; Either String a\n  typeCheck :: (Ident -&gt; String) -&gt; e a -&gt; Bool\n\ninstance Evaluable NExpr where\n  eval _ (Const n) = Right n\n  typeCheck f f2 = True --to make the code compilable\n</code></pre>\n\n<p>Note that the definitions after <code>where</code> need to be indented.</p>\n\n<p>The way you wrote it, you are defining a method outside of any class or instance:</p>\n\n<pre><code>eval :: (Num a, Ord a) =&gt; (Ident -&gt; Maybe a) -&gt; e a -&gt; Either String a\neval _ (Const n) = Right n\n</code></pre>\n\n<p>But in this case <code>eval</code>'s type specifies that it must be defined for <em>all</em> <code>e a</code>, not just for <code>NExpr a</code>.</p>\n"}], "owner": {"reputation": 548, "user_id": 4547068, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/651f7915c52ada9f3b616430481ec37f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roca Lopez", "link": "https://stackoverflow.com/users/4547068/daniel-roca-lopez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "accepted_answer_id": 40981956, "answer_count": 1, "score": -2, "last_activity_date": 1480967075, "creation_date": 1480964486, "question_id": 40981424, "link": "https://stackoverflow.com/questions/40981424/haskell-rigid-type-variable-error", "title": "Haskell: Rigid type variable error", "body": "<p>I have those info on my haskell code:</p>\n\n<pre><code>data Symtable a = General a | Stack a\n\nclass Evaluable e where\neval :: (Num a, Ord a) =&gt; (Ident -&gt; Maybe a) -&gt; (e a) -&gt; (Either String a)\ntypeCheck :: (Ident -&gt; String) -&gt; (e a) -&gt; Bool\n\ninstance (Num a, Ord a) =&gt; Evaluable (NExpr a) where\neval _ (Const n) = Right n\ntypeCheck f f2 = True --to make the code compilable\n</code></pre>\n\n<p>it gives me an error on the definition of eval because it says: couldn't match type 'e' with NExpr' 'e' is a rigid type variable bound by ... eval::... expected e a actual Nexpr a</p>\n\n<p>ident = string and Nexpr:</p>\n\n<pre><code>data NExpr n = Const n |\n            Var Ident |\n            Plus (NExpr n) (NExpr n) |\n            Minus (NExpr n) (NExpr n) |\n            Times (NExpr n) (NExpr n)\n</code></pre>\n\n<p>how to solve it?</p>\n"}, {"tags": ["haskell", "template-haskell"], "answers": [{"comments": [{"owner": {"reputation": 555, "user_id": 1505475, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bc72887d0b9f71cdbc2eeb5f9899d8f?s=128&d=identicon&r=PG", "display_name": "simon1505475", "link": "https://stackoverflow.com/users/1505475/simon1505475"}, "edited": false, "score": 0, "creation_date": 1480974697, "post_id": 40981745, "comment_id": 69177601, "body": "That&#39;s cool, thank you! It seems to work remarkably well. I assumed because parseExp is not in the Q monad that it might not handle scopes well but it does. The package information is not specific about what is lacking. Do you know more about that?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 555, "user_id": 1505475, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bc72887d0b9f71cdbc2eeb5f9899d8f?s=128&d=identicon&r=PG", "display_name": "simon1505475", "link": "https://stackoverflow.com/users/1505475/simon1505475"}, "edited": false, "score": 1, "creation_date": 1481008962, "post_id": 40981745, "comment_id": 69188433, "body": "@simon1505475 Yeah, that package is in need of some love. Under the hood it relies on <code>haskell-src-exts</code>, which gives you the ability to specify a <code>ParseMode</code>. <code>haskell-src-meta</code> probably uses <a href=\"https://hackage.haskell.org/package/haskell-src-exts-1.19.0/docs/Language-Haskell-Exts-Parser.html#v:defaultParseMode\" rel=\"nofollow noreferrer\"><code>defaultParseMode</code></a> in which case &quot;The default is an unknown filename, no extensions (i.e. Haskell 98), don&#39;t ignore LANGUAGE pragmas, do ignore LINE pragmas, and be aware of fixities from the Prelude.&quot;"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 555, "user_id": 1505475, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bc72887d0b9f71cdbc2eeb5f9899d8f?s=128&d=identicon&r=PG", "display_name": "simon1505475", "link": "https://stackoverflow.com/users/1505475/simon1505475"}, "edited": false, "score": 1, "creation_date": 1481009351, "post_id": 40981745, "comment_id": 69188617, "body": "@simon1505475 I take back my previous comment. <a href=\"https://github.com/bmillwood/haskell-src-meta/blob/master/src/Language/Haskell/Meta/Parse.hs#L70-L79\" rel=\"nofollow noreferrer\">This is the parse mode used</a>"}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 5, "last_activity_date": 1481008848, "last_edit_date": 1495540905, "creation_date": 1480965669, "answer_id": 40981745, "question_id": 40980744, "link": "https://stackoverflow.com/questions/40980744/how-to-call-the-quasiquoter-for-haskell-syntax-explicitly/40981745#40981745", "title": "How to call the quasiquoter for haskell syntax explicitly?", "body": "<p>Short answer: there is no easy way. <a href=\"https://stackoverflow.com/q/31412444/3072788\">This question</a> <s>is still</s> <em>was</em> unanswered for a reason. <code>String -&gt; Q Exp</code> for Haskell is tough. The best way is probably through <a href=\"https://hackage.haskell.org/package/haskell-src-meta-0.7.0\" rel=\"nofollow noreferrer\"><code>haskell-src-meta</code></a> which provides parsers which return Template Haskell AST. In particular the <a href=\"http://support.hfm.io/1.2/api/haskell-src-meta-0.6.0.13/Language-Haskell-Meta-Parse.html\" rel=\"nofollow noreferrer\"><code>Language.Haskell.Meta.Parse</code></a> module gives us <code>parseExp :: String -&gt; Either String Exp</code>.</p>\n\n<pre><code>import Language.Haskell.Meta.Parse (parseExp)\n\nquoted :: QuasiQuoter\nquoted = QuasiQuoter\n     { quoteExp = \\str -&gt;\n         case parseExp str of\n           Left msg -&gt; fail \"Could not parse expression.\"\n           Right exp -&gt; [e| $(pure exp) &gt;&gt; listing Haskell $(liftString str) |] }\n</code></pre>\n"}], "owner": {"reputation": 555, "user_id": 1505475, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bc72887d0b9f71cdbc2eeb5f9899d8f?s=128&d=identicon&r=PG", "display_name": "simon1505475", "link": "https://stackoverflow.com/users/1505475/simon1505475"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 40981745, "answer_count": 1, "score": 4, "last_activity_date": 1481008848, "creation_date": 1480961810, "question_id": 40980744, "link": "https://stackoverflow.com/questions/40980744/how-to-call-the-quasiquoter-for-haskell-syntax-explicitly", "title": "How to call the quasiquoter for haskell syntax explicitly?", "body": "<p>I'm building an eDSL on top of HaTeX. The problem I'm facing is that I want to display Haskell expressions in my LaTeX document and I want to use the same Haskell expression to help generate the document.</p>\n\n<p>The obvious answer is to copy and paste the expression so that it appears both quoted and live. I want to avoid that because the expression is subject to change.</p>\n\n<p>What I'm imagining is a quasi quoter that both splices its content as it stands and output a string that represents it.</p>\n\n<p>For example, here is what I would like to type in:</p>\n\n<pre><code>document = do\n    title \"this is an example document\"\n    paragraph \"This is normal text. We will now show the Haskell code that generates a table\"\n    [quoted| makeTable [\"heading1\",\"heading2\"] [\"cell1\",\"cell2\"] |]\n</code></pre>\n\n<p>and I would like the quasi quote to expand to:</p>\n\n<pre><code>document = do\n    title \"this is an example document\"\n    paragraph \"This is normal text. We will now show the Haskell code that generates a table\"\n    makeTable [\"heading1\",\"heading2\"] [\"cell1\",\"cell2\"]\n    listing Haskell \"makeTable [\\\"heading1\\\",\\\"heading2\\\"] [\\\"cell1\\\",\\\"cell2\\\"]\"\n</code></pre>\n\n<p>For this, I need to write a QuasiQuoter:</p>\n\n<pre><code>quoted :: QuasiQuoter\nquoted = QuasiQuoter\n     { quoteExp = \\str -&gt; [e| $(_ str) &gt;&gt; listing Haskell $(lift str) |] }\n</code></pre>\n\n<p>I am unsure what to replace the hole with in <code>$(_ str)</code>. I need to replace it with the Haskell expression quasi quoter but I am unsure how to call it. If <code>e</code> was <code>e :: QuasiQuoter</code> I could fill the hole with <code>$(quoteExp e str)</code> but\u00a0it unfortunately doesn't work. What should I fill it with?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 3, "last_activity_date": 1480957049, "creation_date": 1480957049, "answer_id": 40979398, "question_id": 40979171, "link": "https://stackoverflow.com/questions/40979171/encountering-error-while-adding-maybet-dependency-in-stack-project/40979398#40979398", "title": "Encountering error while adding MaybeT dependency in stack project", "body": "<p>The solution for your concrete problem is switching from the <a href=\"https://hackage.haskell.org/package/MaybeT-0.1.2\" rel=\"nofollow noreferrer\">outdated <em>MaybeT</em> package</a> to the <code>MaybeT</code> transformer offered by the transformers package in <a href=\"https://hackage.haskell.org/package/transformers-0.5.2.0/docs/Control-Monad-Trans-Maybe.html\" rel=\"nofollow noreferrer\"><code>Control.Monad.Trans.Maybe</code></a>.</p>\n\n<hr>\n\n<p>That said, note that the version mismatch involves <em>base</em>. If you actually needed to use the <em>MaybeT</em> package, you would have to switch the Stack resolver to a snapshot such as <a href=\"https://www.stackage.org/lts-6.26\" rel=\"nofollow noreferrer\"><code>lts-6.26</code></a>, which uses <em>base-4.8</em> or below (i.e. GHC 7.10.3 or below). <em>base</em> versions are coupled to GHC versions, and everything else depends on <em>base</em>, so there is no easy way of switching just <em>base</em> to an older version, as it might be possible, given some luck, with other packages. </p>\n"}], "owner": {"reputation": 835, "user_id": 6301341, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/bb987d3e8cfa45185a84db4232af8312?s=128&d=identicon&r=PG&f=1", "display_name": "jyet", "link": "https://stackoverflow.com/users/6301341/jyet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 40979398, "answer_count": 1, "score": 2, "last_activity_date": 1612607759, "creation_date": 1480956379, "last_edit_date": 1612607759, "question_id": 40979171, "link": "https://stackoverflow.com/questions/40979171/encountering-error-while-adding-maybet-dependency-in-stack-project", "title": "Encountering error while adding MaybeT dependency in stack project", "body": "<p>I am following this tutorial <a href=\"http://adit.io/posts/2012-03-10-building_a_concurrent_web_scraper_with_haskell.html#full-code-listing\" rel=\"nofollow noreferrer\">webScraper</a> using HXT.\nI am using Stack here.</p>\n<p>While adding dependency for MaybeT, it asked to:</p>\n<blockquote>\n<p>Recommended action: try adding the following to your extra-deps in /Users/***/Haskell Development/Scrapper/stack.yaml:</p>\n</blockquote>\n<ul>\n<li>MaybeT-0.1.2</li>\n</ul>\n<p>Now doing so to ended up with this message on running stack build:</p>\n<blockquote>\n<p>In the dependencies for MaybeT-0.1.2:\nbase-4.9.0.0 must match &lt;4.8 (latest applicable is 4.7.0.2)\nneeded due to Scrapper-0.1.0.0 -&gt; MaybeT-0.1.2</p>\n</blockquote>\n<p>Being new to Stack, I am unable to solve the problem, in my cabal file the\nthe dependency:</p>\n<pre><code>  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5\n                    ,  hxt\n                    ,  url\n                    ,  HTTP\n                    ,  MaybeT\n</code></pre>\n<p>In stack.yaml</p>\n<pre><code>resolver: lts-7.12\nextra-deps: [MaybeT-0.1.2]\n</code></pre>\n<p>What is it that I have missed. How can I solve this?</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1480956461, "post_id": 40979033, "comment_id": 69167651, "body": "Presumably, the first argument to <code>eval</code> is the function that does name lookups for any names found in the second argument?"}, {"owner": {"reputation": 548, "user_id": 4547068, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/651f7915c52ada9f3b616430481ec37f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roca Lopez", "link": "https://stackoverflow.com/users/4547068/daniel-roca-lopez"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1480956616, "post_id": 40979033, "comment_id": 69167734, "body": "probably but I&#39;m a bit lost with haskell, I don&#39;t know what to do with it or how to pass it or how to evaluate it with those maybe&#39;s"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1480957182, "post_id": 40979033, "comment_id": 69168125, "body": "That depends on what <code>Ident</code> is and what <code>NExpr</code> looks like."}, {"owner": {"reputation": 548, "user_id": 4547068, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/651f7915c52ada9f3b616430481ec37f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roca Lopez", "link": "https://stackoverflow.com/users/4547068/daniel-roca-lopez"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1480957262, "post_id": 40979033, "comment_id": 69168178, "body": "ident = string, NExpr (updating)"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1480957511, "post_id": 40979033, "comment_id": 69168332, "body": "What do <code>General a</code> and <code>Stack a</code> constructors mean?"}, {"owner": {"reputation": 548, "user_id": 4547068, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/651f7915c52ada9f3b616430481ec37f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roca Lopez", "link": "https://stackoverflow.com/users/4547068/daniel-roca-lopez"}, "edited": false, "score": 0, "creation_date": 1480957542, "post_id": 40979033, "comment_id": 69168350, "body": "I don&#39;t know, I just made it up, it is supposed to store variables + stack values"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1480961104, "post_id": 40979668, "comment_id": 69170379, "body": "This also requires some changes to the <code>class Evaluable</code>, otherwise it involves <code>NExpr a b</code> which is a kind error."}, {"owner": {"reputation": 548, "user_id": 4547068, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/651f7915c52ada9f3b616430481ec37f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roca Lopez", "link": "https://stackoverflow.com/users/4547068/daniel-roca-lopez"}, "edited": false, "score": 0, "creation_date": 1480962293, "post_id": 40979668, "comment_id": 69171063, "body": "it says: couldn&#39;t match type &#39;e&#39; with NExpr&#39; &#39;e&#39; is a rigid type variable bound by ... eval::... expected e a actual Nexpr a"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 2, "last_activity_date": 1480963101, "last_edit_date": 1480963101, "creation_date": 1480957959, "answer_id": 40979668, "question_id": 40979033, "link": "https://stackoverflow.com/questions/40979033/reference-data-from-function/40979668#40979668", "title": "Reference data from function", "body": "<p>The first arugment to <code>eval</code> is a function that will look up the value of a name found in an expression. You ignore it when evaluating a <code>Const</code> value, use it when evaluating a <code>Var</code> value, and just pass it along to the recursive calls for the other cases.</p>\n\n<pre><code>instance (Num a, Ord a) =&gt; Evaluable (NExpr a) where\n  eval _ (Const n) = Right n\n  eval lookup (Var x) = case lookup x of\n                          Nothing -&gt; Left (\"Undefined variable: \" ++ x)\n                          Just y -&gt; Right y\n\n  eval lookup (Plus left right) = (+) &lt;$&gt; eval lookup left &lt;*&gt; eval lookup right\n  -- etc\n</code></pre>\n"}], "owner": {"reputation": 548, "user_id": 4547068, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/651f7915c52ada9f3b616430481ec37f?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Roca Lopez", "link": "https://stackoverflow.com/users/4547068/daniel-roca-lopez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 40979668, "answer_count": 1, "score": -1, "last_activity_date": 1480963101, "creation_date": 1480955925, "last_edit_date": 1480959752, "question_id": 40979033, "link": "https://stackoverflow.com/questions/40979033/reference-data-from-function", "title": "Reference data from function", "body": "<p>I have those info on my haskell code:</p>\n\n<pre><code>data Symtable a = General a | Stack a\n\nclass Evaluable e where\neval :: (Num a, Ord a) =&gt; (Ident -&gt; Maybe a) -&gt; (e a) -&gt; (Either String a)\ntypeCheck :: (Ident -&gt; String) -&gt; (e a) -&gt; Bool\n\ninstance (Num a, Ord a) =&gt; Evaluable (NExpr a) where\neval f f2 = Left (\"Undefined variable: \") --to make the code compilable\ntypeCheck f f2 = True --to make the code compilable\n</code></pre>\n\n<p>The thing is, eval function returns the evaluation of a numeric expression (for example 3 + 5, or x + 3), therefore I have to check the value of X on the symtable data but I haven't got it referenced on this function (I cannot edit the function header). How can I do it?</p>\n\n<p>ident = string and Nexpr:</p>\n\n<pre><code>data NExpr n = Const n |\n            Var Ident |\n            Plus (NExpr n) (NExpr n) |\n            Minus (NExpr n) (NExpr n) |\n            Times (NExpr n) (NExpr n)\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 122984, "user_id": 500104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ff1143d80ee378720a879e79fe6da68f?s=128&d=identicon&r=PG", "display_name": "Xeo", "link": "https://stackoverflow.com/users/500104/xeo"}, "edited": false, "score": 2, "creation_date": 1480956627, "post_id": 40979087, "comment_id": 69167742, "body": "Any reason for <code>(_:_)</code> instead of just <code>_</code>? To force an error on <code>undefined</code> or something?"}, {"owner": {"reputation": 2044, "user_id": 1258491, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/yyvEu.png?s=128&g=1", "display_name": "metaleap", "link": "https://stackoverflow.com/users/1258491/metaleap"}, "edited": false, "score": 0, "creation_date": 1480957285, "post_id": 40979087, "comment_id": 69168194, "body": "@duplode marvellous, thanks, that&#39;s what I get for routinely skipping over class declarations and type signatures =)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 122984, "user_id": 500104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ff1143d80ee378720a879e79fe6da68f?s=128&d=identicon&r=PG", "display_name": "Xeo", "link": "https://stackoverflow.com/users/500104/xeo"}, "edited": false, "score": 1, "creation_date": 1480957790, "post_id": 40979087, "comment_id": 69168487, "body": "@Xeo Good question. I don&#39;t know if there is a deeper reason beyond style consistency in that module. Forcing an error on <code>undefined</code> isn&#39;t necessary -- given that <code>[]</code> is matched first, <code>null undefined</code> will blow up anyway."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 122984, "user_id": 500104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ff1143d80ee378720a879e79fe6da68f?s=128&d=identicon&r=PG", "display_name": "Xeo", "link": "https://stackoverflow.com/users/500104/xeo"}, "edited": false, "score": 6, "creation_date": 1480960748, "post_id": 40979087, "comment_id": 69170183, "body": "@Xeo, it doesn&#39;t matter for lists, but in other contexts it can be worth the trouble to write out all the constructors. A catch-all case may catch too much by mistake; this is especially likely if someone adds a new constructor to an existing type. A function written <code>go Red = don&#39;tgo; go _ = gogogo</code> will do entirely the wrong thing if someone edits the missing <code>Yellow</code> constructor into the <code>TrafficLightColor</code> type. If instead it matches on both <code>Red</code> and <code>Green</code>, then <code>-Wall</code> or <code>-fwarn-incomplete-patterns</code> will alert you to the need to add a case."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1480963476, "post_id": 40979087, "comment_id": 69171654, "body": "Wouldn&#39;t a better implementation use &quot;&amp;&amp;&quot; so that the rest of the expression after the first element gets short-circuited?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 2, "creation_date": 1480964071, "post_id": 40979087, "comment_id": 69171968, "body": "@PaulJohnson Do you mean using <code>(&amp;&amp;)</code> in the binary operation of that <code>foldr</code>? If so, I believe the actual implementation doesn&#39;t short-circuit any less than one with <code>(&amp;&amp;)</code>. For instance, if the list <code>foldr</code> were to be used, we would have <code>null (x : []) = foldr (\\_ _ -&gt; False) True (x : []) = (\\_ _ -&gt; False) x (foldr (\\_ _ -&gt; False) True [])</code>, which immediately reduces to <code>False</code>."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 15, "last_activity_date": 1480956061, "creation_date": 1480956061, "answer_id": 40979087, "question_id": 40978930, "link": "https://stackoverflow.com/questions/40978930/why-does-data-list-null-use-a-foldr/40979087#40979087", "title": "Why does &#39;Data.List.null&#39; use a &#39;foldr&#39;?", "body": "<p><code>null</code> is a method of the <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Foldable.html\" rel=\"noreferrer\"><code>Foldable</code></a> class:</p>\n\n<pre><code>GHCi&gt; :t null\nnull :: Foldable t =&gt; t a -&gt; Bool\n</code></pre>\n\n<p>The implementation you quote is <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/src/Data.Foldable.html#Foldable\" rel=\"noreferrer\">the default one</a>, meant to work for all instances of <code>Foldable</code> even if they do not define a specific implementation:</p>\n\n<pre><code>class Foldable t where\n    -- etc.\n    null :: t a -&gt; Bool\n    null = foldr (\\_ _ -&gt; False) True\n    -- etc.\n</code></pre>\n\n<p>The <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/src/Data.Foldable.html#line-278\" rel=\"noreferrer\">list instance</a>, though, overrides the default implementation:</p>\n\n<pre><code>instance Foldable [] where\n    -- etc.\n    null    = List.null\n    -- etc.\n</code></pre>\n\n<p><code>List.null</code>, in turn, <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/src/GHC.List.html#null\" rel=\"noreferrer\">is defined in <code>GHC.List</code></a> in the simpler way that you expected:</p>\n\n<pre><code>null                    :: [a] -&gt; Bool\nnull []                 =  True\nnull (_:_)              =  False\n</code></pre>\n"}], "owner": {"reputation": 2044, "user_id": 1258491, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/yyvEu.png?s=128&g=1", "display_name": "metaleap", "link": "https://stackoverflow.com/users/1258491/metaleap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 40979087, "answer_count": 1, "score": 8, "last_activity_date": 1518978947, "creation_date": 1480955632, "last_edit_date": 1518978947, "question_id": 40978930, "link": "https://stackoverflow.com/questions/40978930/why-does-data-list-null-use-a-foldr", "title": "Why does &#39;Data.List.null&#39; use a &#39;foldr&#39;?", "body": "<p>In my beginner perception, one could implement <code>Data.List.null</code> as:</p>\n\n<pre><code>null [] = True\nnull _ = False\n</code></pre>\n\n<p>Looking up the actual source in Hackage, I see:</p>\n\n<pre><code>null = foldr (\\_ _ -&gt; False) True\n</code></pre>\n\n<p>I find this curious, surely I'm missing something I should learn about, but what?</p>\n"}, {"tags": ["haskell", "httpresponse"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7252197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db6ff1db9264e2d32ed97b00f50b790b?s=128&d=identicon&r=PG&f=1", "display_name": "terratinkah", "link": "https://stackoverflow.com/users/7252197/terratinkah"}, "edited": false, "score": 0, "creation_date": 1480950044, "post_id": 40976658, "comment_id": 69163552, "body": "Well that function creates a response by making a request to the server so it doesn&#39;t really help. After digging in the <i>http-client</i> sources though I&#39;ve found that <code>Response</code> is exported by <code>Network.HTTP.Client.Types</code>, which should be a part of the <i>http-client</i> package but doesn&#39;t appear to be so. Trying to import it makes stack complain about being unable to find the interface and searching for it on stackage gives no results."}, {"owner": {"reputation": 33, "user_id": 7252197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db6ff1db9264e2d32ed97b00f50b790b?s=128&d=identicon&r=PG&f=1", "display_name": "terratinkah", "link": "https://stackoverflow.com/users/7252197/terratinkah"}, "edited": false, "score": 0, "creation_date": 1480950739, "post_id": 40976658, "comment_id": 69164030, "body": "I&#39;m already doing that. <code>Network.HTTP.Client</code> does not reexport the <code>Response</code> constructor, only the type and the record getters. This prevents me from actually creating a value of the type and is at the crux of my problems."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 33, "user_id": 7252197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db6ff1db9264e2d32ed97b00f50b790b?s=128&d=identicon&r=PG&f=1", "display_name": "terratinkah", "link": "https://stackoverflow.com/users/7252197/terratinkah"}, "edited": false, "score": 0, "creation_date": 1480951271, "post_id": 40976658, "comment_id": 69164407, "body": "@terratinkah My previous comment was indeed rather off the mark (I hadn&#39;t noticed a few things in the blog post), but the constructor is exported by <code>Network.HTTP.Client.Internal</code>. I will update the answer accordingly."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1480951352, "last_edit_date": 1480951352, "creation_date": 1480948374, "answer_id": 40976658, "question_id": 40975421, "link": "https://stackoverflow.com/questions/40975421/mock-a-wreq-response/40976658#40976658", "title": "Mock a Wreq Response", "body": "<p>Looking at <a href=\"https://hackage.haskell.org/package/wreq-0.4.1.0/docs/src/Network-Wreq.html\" rel=\"nofollow noreferrer\">the sources</a> of <em>wreq</em> reveals that the <code>Response</code> type comes from the <em>http-client</em> library. That is the same library used by the blog post you link to, and so the solution is the same that, presumably, was used in the post: import <code>Network.HTTP.Client.Internal</code>, which <a href=\"https://hackage.haskell.org/package/http-client-0.5.4/docs/Network-HTTP-Client-Internal.html#t:Response\" rel=\"nofollow noreferrer\">exports the constructor</a>.</p>\n"}], "owner": {"reputation": 33, "user_id": 7252197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db6ff1db9264e2d32ed97b00f50b790b?s=128&d=identicon&r=PG&f=1", "display_name": "terratinkah", "link": "https://stackoverflow.com/users/7252197/terratinkah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 40976658, "answer_count": 1, "score": 3, "last_activity_date": 1480951352, "creation_date": 1480944624, "last_edit_date": 1480949072, "question_id": 40975421, "link": "https://stackoverflow.com/questions/40975421/mock-a-wreq-response", "title": "Mock a Wreq Response", "body": "<p>I want to manually create a <code>Response</code> in order to mock a web server, similar to <a href=\"https://blog.pusher.com/unit-testing-io-in-haskell/\" rel=\"nofollow noreferrer\">this</a> blog post. However, the <code>Network.Wreq</code> library that I'm using doesn't reveal the constructor for <code>Response</code>. How do I create a <code>Response</code> manually? </p>\n"}, {"tags": ["haskell", "monads", "monad-transformers", "state-monad", "maybe"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1480938140, "post_id": 40973351, "comment_id": 69155947, "body": "What&#39;s the error you get? <code>guard</code> returns <code>MaybeT (State Stack) ()</code> while you require <code>MaybeT (State Stack) Int</code>."}, {"owner": {"reputation": 19024, "user_id": 286335, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6882f075e155c96b4ff0fe3bcab951f3?s=128&d=identicon&r=PG&f=1", "display_name": "cibercitizen1", "link": "https://stackoverflow.com/users/286335/cibercitizen1"}, "edited": false, "score": 0, "creation_date": 1538661455, "post_id": 40973351, "comment_id": 92229013, "body": "MaybeThis could help you <a href=\"https://stackoverflow.com/questions/27096836/constructing-minimal-haskell-example-on-error-handling-in-the-state-monad/52640044#52640044\" title=\"constructing minimal haskell example on error handling in the state monad\">stackoverflow.com/questions/27096836/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1480939575, "post_id": 40973653, "comment_id": 69156800, "body": "This works if one uses the <i>transformers</i> <code>MaybeT</code> and the <i>mtl</i> <code>State</code>. For this exercise, the OP is using their own transformers, and so to use this they will need to <code>lift</code> both <code>get</code> and <code>put</code> (or implement <code>MonadState</code>) and implement <code>fail</code> for their <code>MaybeT</code>."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1480940514, "post_id": 40973653, "comment_id": 69157343, "body": "I did not pay attention to it, but it is pertinent remark."}], "tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": false, "score": 2, "last_activity_date": 1480940211, "last_edit_date": 1480940211, "creation_date": 1480938710, "answer_id": 40973653, "question_id": 40973351, "link": "https://stackoverflow.com/questions/40973351/monad-transformers-implementation-of-a-stack-machine-with-maybet-state-stack/40973653#40973653", "title": "Monad transformers: Implementation of a stack machine with MaybeT (State Stack)", "body": "<p>First of all, you should understand if your stack is empty, your pattern <code>r:rs &lt;- get</code> fails. But you write it in do-block, so the <code>fail</code> function will be called. It is implemented for <code>Monad m =&gt; MaybeT m</code> like this: <code>fail _ = MaybeT (return Nothing)</code>. This means that if the pattern fails it returns <code>Nothing</code>. That what you want.</p>\n\n<p>So, you can do like this:</p>\n\n<pre><code>pop :: MaybeT (State Stack) Int\npop = do r:rs &lt;- get\n         put rs\n         return r\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1513, "user_id": 6624417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a73a12db09cb90a99be14fa2bb7b6096?s=128&d=identicon&r=PG&f=1", "display_name": "E4z9", "link": "https://stackoverflow.com/users/6624417/e4z9"}, "is_accepted": false, "score": 2, "last_activity_date": 1480940187, "last_edit_date": 1480940187, "creation_date": 1480939392, "answer_id": 40973867, "question_id": 40973351, "link": "https://stackoverflow.com/questions/40973351/monad-transformers-implementation-of-a-stack-machine-with-maybet-state-stack/40973867#40973867", "title": "Monad transformers: Implementation of a stack machine with MaybeT (State Stack)", "body": "<p><code>guard</code> doesn't take two arguments, it only takes a <code>Bool</code> argument.</p>\n\n<p>You also need to lift your state manipulations into <code>MaybeT</code>:</p>\n\n<pre><code>pop :: MaybeT (State Stack) Int\npop = do\n  guard True\n  (r:rs) &lt;- lift get\n  lift $ put rs\n  return r\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 1, "last_activity_date": 1480942751, "creation_date": 1480942751, "answer_id": 40974839, "question_id": 40973351, "link": "https://stackoverflow.com/questions/40973351/monad-transformers-implementation-of-a-stack-machine-with-maybet-state-stack/40974839#40974839", "title": "Monad transformers: Implementation of a stack machine with MaybeT (State Stack)", "body": "<p>For the sake of comparison, here is a cruder implementation which doesn't rely neither on <code>guard</code> nor on <code>fail</code>:</p>\n\n<pre><code>pop :: MaybeT (State Stack) Int\npop = do\n  stk &lt;- lift get\n  case stk of\n    [] -&gt; empty\n    (r:rs) -&gt; do\n      lift (put rs)\n      return r\n</code></pre>\n\n<p>Producing <code>empty</code> when the stack is <code>[]</code> amounts to the same thing that  using <code>guard</code> in the way you intend, or using <code>fail</code> to exploit a failed pattern match (as in freestyle's answer).</p>\n"}], "owner": {"reputation": 581, "user_id": 3840551, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e6fa341691a6456b96f4200b4ab3b085?s=128&d=identicon&r=PG&f=1", "display_name": "Gloomy", "link": "https://stackoverflow.com/users/3840551/gloomy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1614385876, "creation_date": 1480937687, "last_edit_date": 1614385876, "question_id": 40973351, "link": "https://stackoverflow.com/questions/40973351/monad-transformers-implementation-of-a-stack-machine-with-maybet-state-stack", "title": "Monad transformers: Implementation of a stack machine with MaybeT (State Stack)", "body": "<p>I'm trying to implement a Maybe-State monad transformer and use it to implement a simple stack machine. \nThe definitions of state monad and maybe should be correct. Now  I'm trying to implement pop: </p>\n\n<pre><code>pop :: MaybeT (State Stack) Int\n</code></pre>\n\n<p>So that if the stack is empty it returns nothing, otherwise it returns <code>Just &lt;popped stack&gt;</code>.\nThis is what I have so far:</p>\n\n<pre><code>pop :: MaybeT (State Stack) Int\npop = guard True (do (r:rs) &lt;- get\n                     put rs\n                     return r)\n</code></pre>\n\n<p>(Obviously <code>True</code> is just a dummy placeholder - I'll implement the condition later, for now I want to get the other part right).</p>\n\n<p>What is wrong with my code? From my understanding <code>guard</code> takes a conditional (<code>True</code>) and a function f. If the conditional is true it then gives <code>pure f</code>.</p>\n\n<p>In my case,</p>\n\n<pre><code>pure = MaybeT . return . Just\n</code></pre>\n\n<p>So shouldn't my function f just return a <code>State Stack Int</code>? </p>\n\n<hr>\n\n<p>Here is the full code, with my implementations of <code>MaybeT</code> and <code>State</code>: </p>\n\n<pre><code>import Control.Applicative (Alternative(..))\nimport Control.Monad (liftM, ap, guard)\nimport Control.Monad.Trans.Class (MonadTrans(lift))\n\nmain :: IO()\nmain = return ()\n\n\n-- State Monad\n--------------\n\nnewtype State s a = MakeState { runState :: s -&gt; (a, s) }\n\ninstance Functor (State s) where\n    fmap  = liftM\n\n\ninstance Applicative (State s) where\n    pure a = MakeState $ \\s -&gt; (a, s)\n    (&lt;*&gt;)  = ap\n\ninstance Monad (State s) where\n    return a = MakeState $ \\s -&gt; (a, s)\n    m &gt;&gt;= k  = MakeState $ \\s -&gt; let (x, s') = runState m s\n                              in runState (k x) s'\n\nget :: State s s\nget = MakeState $ \\s -&gt; (s, s)\n\nput :: s -&gt; State s ()\nput s = MakeState $ \\_ -&gt; ((), s)\n\nmodify :: (s -&gt; s) -&gt; State s ()\nmodify f = MakeState $ \\s -&gt; ((), f s)\n\n-- MaybeT MonadTransformer\n---------------------------\n\nnewtype MaybeT m a = MaybeT { runMaybeT :: m (Maybe a) }\n\ninstance Monad m =&gt; Functor (MaybeT m) where\n    fmap a x = MaybeT $ do e &lt;- runMaybeT x\n                           return $ fmap a e\n\n\n\ninstance Monad m =&gt; Applicative (MaybeT m) where\n    pure      = MaybeT . return . Just\n    (&lt;*&gt;) a b = MaybeT $ do e &lt;- runMaybeT a\n                            f &lt;- runMaybeT b\n                            return $ e &lt;*&gt; f\n\ninstance Monad m =&gt; Monad (MaybeT m) where\n    return  = pure\n    a &gt;&gt;= b = MaybeT $ do aa &lt;- runMaybeT a\n                          maybe (return Nothing) (runMaybeT . b) aa\n\n\ninstance Monad m =&gt; Alternative (MaybeT m) where\n  empty   = MaybeT $ return Nothing\n  a &lt;|&gt; b = MaybeT $ do aa &lt;- runMaybeT a\n                        bb &lt;- runMaybeT b\n                        return $ aa &lt;|&gt; bb\n\n\ninstance MonadTrans MaybeT where\n    -- \"herwrappen\" van het argument\n    lift x = MaybeT $ do r &lt;- x\n                         return $ Just r\n\n\n-- Stack Manipulation\n---------------------\n\ntype Stack = [Int]\n\n-- plaats het argument bovenop de stack\npush :: Int -&gt; State Stack ()\npush x = do r &lt;- get\n            put (x:r)\n-- geef de grootte van de stack terug\nsize :: State Stack Int\nsize = do r &lt;- get\n          return $ length r\n\n-- neem het eerste element van de stack, als het aanwezig is\n-- (hint: hoogle naar `guard`)\npop :: MaybeT (State Stack) Int\npop = guard (True) (do (r:rs) &lt;- get\n                       put rs\n                       return r)\n</code></pre>\n"}, {"tags": ["list", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1480931093, "post_id": 40971262, "comment_id": 69151503, "body": "you beat me to it"}, {"owner": {"reputation": 700, "user_id": 4701158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c86114b72616eeda2b6fd61a65834293?s=128&d=identicon&r=PG&f=1", "display_name": "John Kim", "link": "https://stackoverflow.com/users/4701158/john-kim"}, "edited": false, "score": 0, "creation_date": 1480931392, "post_id": 40971262, "comment_id": 69151689, "body": "Thanks a lot, didn&#39;t think of simply changing x into (x,y). I&#39;ll accept your answer when the timer lets me."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 4, "last_activity_date": 1480931185, "last_edit_date": 1480931185, "creation_date": 1480931025, "answer_id": 40971262, "question_id": 40971157, "link": "https://stackoverflow.com/questions/40971157/haskell-remove-parenthesis-for-a-tuple/40971262#40971262", "title": "Haskell remove parenthesis for a tuple", "body": "<p>There are no standard functions that work on triples, you have to write them yourself.</p>\n\n<pre><code>munge :: (a,(b,c)) -&gt; (a,b,c)\nmunge (x,(y,z)) = (x,y,z)\n\nmunge (get_balance_partition 2 (two_partitions [7, 4, 3, 6, 10]))\n</code></pre>\n\n<p>Or anonymously as a lambda</p>\n\n<pre><code>(\\(x,(y,z)) -&gt; (x,y,z)) (get_balance_partition 2 (two_partitions [7, 4, 3, 6, 10]))\n</code></pre>\n\n<p>Another way is to modify your definition to match on the tuple in the list directly:</p>\n\n<pre><code>get_balance_partition :: Int -&gt; [([Int], [Int])] -&gt; (Int, ([Int], [Int]))\nget_balance_partition min ((x,y):xs)\n   ...\n</code></pre>\n\n<p>And use <code>(x,y)</code> instead of <code>x</code> everywhere, then you can return e.g. <code>(min, x, y)</code> in the first case, and similarly in other cases.</p>\n"}], "owner": {"reputation": 700, "user_id": 4701158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c86114b72616eeda2b6fd61a65834293?s=128&d=identicon&r=PG&f=1", "display_name": "John Kim", "link": "https://stackoverflow.com/users/4701158/john-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 40971262, "answer_count": 1, "score": 1, "last_activity_date": 1487595281, "creation_date": 1480930689, "last_edit_date": 1487595281, "question_id": 40971157, "link": "https://stackoverflow.com/questions/40971157/haskell-remove-parenthesis-for-a-tuple", "title": "Haskell remove parenthesis for a tuple", "body": "<p>I'm a beginner in Haskell, and this is a question for an assignment. \nI'm pretty much done the problem, but I can't figure out how to remove the parenthesis that is surrounding a tuple that I calculated.</p>\n\n<pre><code>get_balance_partition :: Int -&gt; [([Int], [Int])] -&gt; (Int, ([Int], [Int]))\nget_balance_partition min (x:xs)\n    | null xs &amp;&amp; difference_partitions x == min = (min, x)\n    | null xs = (min, ([], []))\n    | difference_partitions x == min = (min, x)\n    | otherwise = get_balance_partition min xs\n</code></pre>\n\n<p>This is a helper function for working code, and I use it like this : </p>\n\n<pre><code>get_balance_partition 2 (two_partitions [7, 4, 3, 6, 10])\n\noutput : (2,([7,4,3],[6,10]))\n</code></pre>\n\n<p>I want to get rid of the parenthesis surrounding the pair of partitions so that the result,</p>\n\n<pre><code> (2,([7,4,3],[6,10]))\n</code></pre>\n\n<p>looks like </p>\n\n<pre><code> (2,[7,4,3],[6,10])\n</code></pre>\n\n<p>How can I get rid of the parenthesis when the pair of partitions is stored in x?</p>\n"}, {"tags": ["haskell", "types", "coercion"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1480929894, "post_id": 40970726, "comment_id": 69150749, "body": "Interesting. Maybe <code>UArray</code> moved from a representational to a nominal role for the element? I wonder why."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1480933929, "post_id": 40970726, "comment_id": 69153220, "body": "Yes, looks like you will (another argument for <code>vector</code> - getting <code>UnBox</code> instances is much easier). Even if you wanted to <code>unsafeCoerce</code> your way through an <code>IArray UArray Elt</code> instance, you can&#39;t since the methods you need to implement aren&#39;t exported. While I understand why we shouldn&#39;t GND here, the fact we can&#39;t handwrite our instance of <code>IArray</code> makes me a bit unhappy..."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1480962269, "post_id": 40970726, "comment_id": 69171050, "body": "You can import the methods from <code>Data.Array.Base</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1481002696, "post_id": 40970726, "comment_id": 69185961, "body": "@ReidBarton Oh. For some reason I thought that wasn&#39;t exposed. Thank you!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1481004407, "post_id": 40970726, "comment_id": 69186520, "body": "@ReidBarton, I think the necessary <code>Coercion</code>s should be exported from <code>GHC.Arr</code> and <code>Data.Array.Unsafe</code> or some such. That won&#39;t give us GND, but will let us <code>coerce</code> the methods."}, {"owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "edited": false, "score": 0, "creation_date": 1481010535, "post_id": 40970726, "comment_id": 69189188, "body": "The reason I chose Array over Vector was being able to use a newtype Int as the index (having int-int-mappings going in both &quot;directions&quot;, it&#39;s very easy to mix up index vs value without newtypes)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1481012086, "post_id": 40970726, "comment_id": 69189872, "body": "You can easily write your own set of operations to use arbitrary indices. <code>index :: Index -&gt; Vector a -&gt; Maybe a; index (Index i) v = v !? i</code>"}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 2, "last_activity_date": 1481014889, "last_edit_date": 1481014889, "creation_date": 1481003501, "answer_id": 40988667, "question_id": 40970726, "link": "https://stackoverflow.com/questions/40970726/using-newtype-in-data-array-unboxed-with-ghc-7-10/40988667#40988667", "title": "Using newtype in Data.Array.Unboxed with ghc 7.10", "body": "<p>You don't have to create a wrapper for <code>MyArr</code>, but you will have to write out by hand the instance you would previously have derived. A bit of a brute force solution is to <code>unsafeCoerce</code> your way through the <code>IArray</code> instance manually (the reason you can't <code>coerce</code> is the same you can't derive).</p>\n\n<pre><code>{-# LANGUAGE InstanceSigs, ScopedTypeVariables, MultiParamTypeClasses #-}\n\nimport Data.Array.Base\nimport Data.Array.IArray\nimport Data.Array.Unboxed\nimport Unsafe.Coerce\n\ninstance IArray UArray Elt where\n  bounds :: forall i. Ix i =&gt; UArray i Elt -&gt; (i, i)\n  bounds arr = bounds (unsafeCoerce arr :: UArray i Int)                                                                                                                                                                        \n\n  numElements :: forall i. Ix i =&gt; UArray i Elt -&gt; Int\n  numElements arr = numElements (unsafeCoerce arr :: UArray i Int)\n\n  unsafeArray :: forall i. Ix i =&gt; (i,i) -&gt; [(Int, Elt)] -&gt; UArray i Elt\n  unsafeArray lu ies = unsafeCoerce (unsafeArray lu [ (i,e) | (i,Elt e) &lt;- ies ] :: UArray i Int) :: UArray i Elt\n\n  unsafeAt :: forall i. Ix i =&gt; UArray i Elt -&gt; Int -&gt; Elt\n  unsafeAt arr ix = Elt (unsafeAt (unsafeCoerce arr :: UArray i Int) ix) \n</code></pre>\n"}], "owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 40988667, "answer_count": 1, "score": 3, "last_activity_date": 1481014889, "creation_date": 1480929311, "question_id": 40970726, "link": "https://stackoverflow.com/questions/40970726/using-newtype-in-data-array-unboxed-with-ghc-7-10", "title": "Using newtype in Data.Array.Unboxed with ghc 7.10", "body": "<p>This worked fine in ghc 7.8.4, but fails in 7.10.3:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric              #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n\nmodule Foo where\n\nimport qualified Data.Array.Unboxed       as A\nimport           GHC.Generics             (Generic)\n\nnewtype Elt = Elt Int deriving (Eq, Ord, Show, Num, Integral, Real, Enum, A.IArray A.UArray, Generic)\ntype MyArr = A.UArray Int Elt\n</code></pre>\n\n<p>with lots of messages like</p>\n\n<pre><code>/tmp/my.hs:9:75:\n    Couldn't match type \u2018Int\u2019 with \u2018Elt\u2019\n    arising from the coercion of the method \u2018Data.Array.Base.numElements\u2019\n      from type \u2018forall i. A.Ix i =&gt; A.UArray i Int -&gt; Int\u2019\n        to type \u2018forall i. A.Ix i =&gt; A.UArray i Elt -&gt; Int\u2019\n    Relevant role signatures:\n      type role A.Ix nominal\n      type role A.UArray nominal nominal\n    When deriving the instance for (A.IArray A.UArray Elt)\n</code></pre>\n\n<p>Although the release notes for 7.10 fail to mention it, I see \n<a href=\"https://ghc.haskell.org/trac/ghc/ticket/9220#comment:11\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/ticket/9220#comment:11</a> admits its a breaking change. But what's the solution \u2013 do I really have to create a newtype wrapper for MyArr with helper functions for every usage?</p>\n"}, {"tags": ["haskell", "functor"], "answers": [{"tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": true, "score": 6, "last_activity_date": 1480929104, "creation_date": 1480929104, "answer_id": 40970667, "question_id": 40970512, "link": "https://stackoverflow.com/questions/40970512/mapping-a-functor-to-another-in-haskell/40970667#40970667", "title": "Mapping a functor to another in Haskell", "body": "<p>You're looking for the <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#v:maybe\" rel=\"nofollow noreferrer\"><code>maybe</code></a> function:</p>\n\n<pre><code>cvX ... =\n  ...\n  maybe (Left NoSpace) (\\p -&gt; Right (x2:x1:(fromJust (rmX (-1) p)))) $\n    rmX 1 xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 4, "last_activity_date": 1480933174, "last_edit_date": 1480933174, "creation_date": 1480932412, "answer_id": 40971694, "question_id": 40970512, "link": "https://stackoverflow.com/questions/40970512/mapping-a-functor-to-another-in-haskell/40971694#40971694", "title": "Mapping a functor to another in Haskell", "body": "<p>In this context, it is worth mentioning the <a href=\"https://hackage.haskell.org/package/errors-2.1.3\" rel=\"nofollow noreferrer\"><em>errors</em></a> package. It offers a number of functions for juggling <code>Maybe</code>, <code>Either</code> and related types, including <a href=\"https://hackage.haskell.org/package/errors-2.1.3/docs/Control-Error-Util.html#v:note\" rel=\"nofollow noreferrer\"><code>note</code></a>, which \"[tags] the <code>Nothing</code> value of a <code>Maybe</code>\":</p>\n\n<pre><code>note :: a -&gt; Maybe b -&gt; Either a b\n</code></pre>\n\n\n\n<pre><code>cvX ... =\n  ...\n  note NoSpace $ fmap (\\p -&gt; x2:x1:(fromJust (rmX (-1) p))) (rmX 1 xs)\n</code></pre>\n\n<p>Unsurprisingly, the implementation of <code>note</code> uses <code>maybe</code> exactly like Sebastian Redl's answer does.</p>\n\n<p>P.S.: It is always a little unpleasant to use <code>fromJust</code>, given how it fails when given <code>Nothing</code>. If <code>rmX (-1)</code> cannot produce a <code>Nothing</code>, you might want to consider factoring out a separate function that doesn't return <code>Maybe a</code> to be used instead of <code>fromJust (rmX (-1) p)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1480953411, "last_edit_date": 1480953411, "creation_date": 1480950454, "answer_id": 40977300, "question_id": 40970512, "link": "https://stackoverflow.com/questions/40970512/mapping-a-functor-to-another-in-haskell/40977300#40977300", "title": "Mapping a functor to another in Haskell", "body": "<p>One similar option is to use the <code>Maybe</code> monad until the very end, then apply <code>Left</code> or <code>Right</code> as necessary with <code>maybe</code>.</p>\n\n<pre><code>maybe (Left NoSpace) Right $ do\n     p1 &lt;- rmX 1 xs\n     p2 &lt;- rmX (-1) p1\n     return (x2:x1:p2)\n</code></pre>\n\n<p>There's lots of room for tweaking this, depending on your preference for <code>do</code> notation vs <code>&gt;&gt;=</code>:</p>\n\n<pre><code>-- untested; take these with a grain of salt...\n\nmaybe (Left NoSpace) Right $ do\n    p &lt;- rmX 1 xs &gt;&gt;= rmX (-1) \n    return (x2:x1:p)\n\nmaybe (Left NoSpace) Right (rmX 1 xs &gt;&gt;= rmX (-1) &gt;&gt;= (return . (x1:)) &gt;&gt;= (return . (x2:)))\n\n-- etc\n</code></pre>\n"}], "owner": {"reputation": 401, "user_id": 1985931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cda15456fc1622e0855b351c6f2854de?s=128&d=identicon&r=PG", "display_name": "iluvAS", "link": "https://stackoverflow.com/users/1985931/iluvas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 1, "accepted_answer_id": 40970667, "answer_count": 3, "score": 2, "last_activity_date": 1480953411, "creation_date": 1480928544, "question_id": 40970512, "link": "https://stackoverflow.com/questions/40970512/mapping-a-functor-to-another-in-haskell", "title": "Mapping a functor to another in Haskell", "body": "<p>I have a function that produces a <code>Maybe a</code> type and I'm using it in a function to produce an <code>Either b a</code>. Is there a way I can map <code>Nothing</code> to <code>Left x</code> to simplify my code? The following code gives some context:</p>\n\n<pre><code>rmX :: ... -&gt; Maybe a\ncvX :: ... -&gt; Either CVXError a\ndata CVXError = BadIndex | NoCover | NoSpace\ncvX ... =\n  ...\n  case rmx 1 xs of\n    Nothing -&gt; Left NoSpace\n    Just p  -&gt; Right (x2:x1:(fromJust (rmX (-1) p)))\n-- given that rmX always passes on negative value arg\n</code></pre>\n\n<p>The case statement is just begging to be replaced with <code>fmap</code> but the problem is that I'm not sure how to 'map' <code>Nothing</code> to <code>Left NoSpace</code> in an <code>fmap</code> call or to even extract this pattern to make my own util function.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1480940692, "post_id": 40967470, "comment_id": 69157460, "body": "Comments are not for extended discussion; this conversation has been <a href=\"http://chat.stackoverflow.com/rooms/129802/discussion-on-question-by-matthew-carland-print-foo-when-i-hit-the-enter-key-h\">moved to chat</a>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 3, "creation_date": 1480941122, "post_id": 40967470, "comment_id": 69157733, "body": "@BhargavRao The moved comments include the ones which explain why this question falls under &quot;cannot be reproduced&quot;. To avoid confusion for future readers, <a href=\"http://chat.stackoverflow.com/transcript/message/34418593#34418593\">here is a link to them</a>."}], "owner": {"reputation": 31, "user_id": 7239302, "user_type": "registered", "profile_image": "https://graph.facebook.com/1134572789925209/picture?type=large", "display_name": "Matthew Carland", "link": "https://stackoverflow.com/users/7239302/matthew-carland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 1, "closed_date": 1480942083, "answer_count": 0, "score": 3, "last_activity_date": 1480925098, "creation_date": 1480914675, "last_edit_date": 1480925098, "question_id": 40967470, "link": "https://stackoverflow.com/questions/40967470/print-foo-when-i-hit-the-enter-key-haskell", "closed_reason": "Not suitable for this site", "title": "Print &quot;foo&quot; when I hit the enter key Haskell", "body": "<p>First,  I wanted to write a program in Haskell that would start printing my girlfriend's name when I hit the 's' key and then stop when I hit the 's' key again.  But I could not understand how to write such a program. </p>\n\n<p>Instead I tried to write a program(had help from fellow redditers) that would print 'foo' when I hit the enter key but it seems 'foo' does not want to print.  Why is that?  </p>\n\n<pre><code>{-# language NumDecimals #-}\nmodule Main where\n\nimport Control.Monad\nimport Control.Concurrent (threadDelay)\nimport Control.Concurrent.MVar\nimport Control.Concurrent.Async (concurrently_)\n\nkeyWatcher :: MVar () -&gt; IO ()\nkeyWatcher latch = forever (do _ &lt;- getLine\n                               _ &lt;- takeMVar latch\n                               _ &lt;- getLine\n                               putMVar latch())\n\nloop :: MVar () -&gt; IO ()\nloop latch = forever (do swapMVar latch ()\n                         threadDelay 1e6\n                         putStrLn \"Marika Boo!!!\")\n\nmain :: IO ()\nmain = do latch &lt;- newMVar ()\n          concurrently_ (loop latch) (keyWatcher latch)\n</code></pre>\n"}, {"tags": ["haskell", "maybe"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 1, "creation_date": 1480914912, "post_id": 40967434, "comment_id": 69144449, "body": "Err, <code>Just</code> does not \u201cde-maybe\u201d, it is one of the two constructor for the <code>Maybe</code> type. In fact, you <i>cannot</i> de-maybe in general, because what if the value is <code>Nothing</code>? There would be no <code>URL</code> \u201cinside\u201d the value to get out. If you\u2019re sure the value will really be a <code>Just</code>, though, you can use <code>fromJust</code>, but use that with extreme caution! It will just crash your program at runtime if the value is not a <code>Just</code> throwing away the whole type safety point of using <code>Maybe</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1480917738, "post_id": 40967434, "comment_id": 69145213, "body": "On the &quot;de-maybe&quot; issue, you might be mixing up the use of <code>Just</code> as a function to build a <code>Maybe</code>-value (e.g. in the type mismatch that surprised you) with its use for pattern matching (e.g. on the left side of an equals sign). For suggestions on how to handle the <code>Maybe</code>-value, <a href=\"http://stackoverflow.com/q/3375483/2751851\"><i>Operating on a return from a Maybe that contains \u201cJust\u201d</i></a> is a good start."}, {"owner": {"reputation": 9119, "user_id": 180258, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8b3779ca7c73166d7016272086c6282f?s=128&d=identicon&r=PG", "display_name": "ron", "link": "https://stackoverflow.com/users/180258/ron"}, "edited": false, "score": 0, "creation_date": 1568373653, "post_id": 40967434, "comment_id": 102262991, "body": "Note: nowadays using network-uri&#39;s Network.URI module seems a better choice."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 3, "last_activity_date": 1480919567, "creation_date": 1480919567, "answer_id": 40968378, "question_id": 40967434, "link": "https://stackoverflow.com/questions/40967434/using-network-url-library-in-haskell/40968378#40968378", "title": "Using Network.URL library in Haskell", "body": "<p>There are a couple of things worth discussing here:</p>\n\n<blockquote>\n  <p>OK, what? That didn't remove my Just, it just added another Just. How can I retrieve the String that parseRequest will take as an argument?</p>\n</blockquote>\n\n<p>Remember something that has type <code>Maybe URL</code> is either a <code>Nothing</code> or a <code>Just url</code> where <code>url :: URL</code>. You can't just \"extract\" the some part of the <code>URL</code> because the whole point of <code>Maybe</code> is that <em>you might not have a <code>URL</code> at all</em>!</p>\n\n<blockquote>\n  <p>How can I retrieve the String that parseRequest will take as an argument?</p>\n</blockquote>\n\n<p>This is unnecessary - <code>parseRequest</code> is doing the same thing as <code>importURL</code> - it is just checking that the URL is properly formed. The only difference is that it signals an error by throwing an error using <code>throwM</code> from <code>MonadThrow</code>. Furthermore, if you want to use <code>http-conduit</code>, you will need to use <code>parseRequest</code> anyways to get a <code>Request</code>, so there really is no point to having <code>importURL</code> there at all.</p>\n\n<p>If you are worried about a badly formed <code>URL</code>, you can make sure to wrap the code in a <a href=\"https://hackage.haskell.org/package/exceptions-0.8.3/docs/Control-Monad-Catch.html#v:catch\" rel=\"nofollow noreferrer\"><code>catch</code></a>.</p>\n\n<pre><code>import Network.Connection (TLSSettings (..))\nimport Network.HTTP.Conduit\n\nmain :: IO ()\nmain = catch (do\n                request &lt;- parseRequest \"https://github.com/\"\n                let settings = mkManagerSettings (TLSSettingsSimple True False False) Nothing\n                manager &lt;- newManager settings\n                res &lt;- httpLbs request manager\n                print res)\n             (\\e -&gt; case e of\n                      HttpExceptionRequest{} -&gt; putStrLn \"Http request failed\"\n                      InvalidUrlException{} -&gt; putStrLn \"Bad URL\")\n</code></pre>\n"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 40968378, "answer_count": 1, "score": 2, "last_activity_date": 1480919567, "creation_date": 1480914408, "question_id": 40967434, "link": "https://stackoverflow.com/questions/40967434/using-network-url-library-in-haskell", "title": "Using Network.URL library in Haskell", "body": "<p>After reading the Yesod book, I'm sold on the idea of using typesafe URLs rather than raw string-likes.  I'm just trying some simple get requests, rather than using the full yesod library, but seemed like it would be easy enough to either define a custom URL data type deriving show, or to use some other existing minimal URL library.</p>\n\n<p>I found this on Hoogle:\n<a href=\"https://hackage.haskell.org/package/url-2.1.3/docs/Network-URL.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/url-2.1.3/docs/Network-URL.html</a></p>\n\n<p>Seems like it will do the kind of validation I want, so that a mistake like:</p>\n\n<pre><code>myothervar = \"kittens\"   -- oh no, I defined this for something else\nparseRequest myothervar  -- and called it from parseRequest!\n</code></pre>\n\n<p>will be caught by the compiler, while </p>\n\n<pre><code>myurl = \"http://example.com\"\nparseRequest myurl\n</code></pre>\n\n<p>...will succeed, great.</p>\n\n<pre><code>ghci    \u03bb&gt; import Network.URL\nghci    \u03bb&gt; myurl = importURL \"http://example.com\"\n</code></pre>\n\n<p>Documentation suggests to me I need to use importURL </p>\n\n<pre><code>ghci    \u03bb&gt; :t myurl\nmyurl :: Maybe URL\n</code></pre>\n\n<p>Great, I know how to de-<code>Maybe</code>, I use <code>Just</code>.</p>\n\n<pre><code>ghci    \u03bb&gt; exportURL $ Just myurl\n\n&lt;interactive&gt;:47:13: error:\n    \u2022 Couldn't match expected type \u2018URL\u2019\n                  with actual type \u2018Maybe (Maybe URL)\u2019\n    \u2022 In the second argument of \u2018($)\u2019, namely \u2018Just myurl\u2019\n      In the expression: exportURL $ Just myurl\n      In an equation for \u2018it\u2019: it = exportURL $ Just myurl\n\nghci    \u03bb&gt; Just (Just (URL {url_type = Absolute (Host {protocol = HTTP False, host = \"example.com\", port = Nothing}), url_path = \"\", url_params = []}))\n</code></pre>\n\n<p>OK, what?  That didn't remove my Just, it just added another Just.  How can I retrieve the String that <code>parseRequest</code> will take as an argument?</p>\n\n<p>And it looks like I definitely need to de-Maybe it by exporting back to String somehow:</p>\n\n<pre><code>ghci    \u03bb&gt; import Network.HTTP.Conduit\nghci    \u03bb&gt; parseRequest $ myurl\n\n&lt;interactive&gt;:84:16: error:\n    \u2022 Couldn't match type \u2018Maybe URL\u2019 with \u2018[Char]\u2019\n      Expected type: String\n        Actual type: Maybe URL\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7250185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d729c1a8b88fe9f01a8ea95ef8cb903?s=128&d=identicon&r=PG&f=1", "display_name": "mattm177", "link": "https://stackoverflow.com/users/7250185/mattm177"}, "edited": false, "score": 0, "creation_date": 1480914250, "post_id": 40966961, "comment_id": 69144244, "body": "Thanks for the help! That makes perfect sense in retrospect. As for the player data representation, I was intending on changing it but just haven&#39;t done that yet."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 5, "last_activity_date": 1480911044, "creation_date": 1480911044, "answer_id": 40966961, "question_id": 40966916, "link": "https://stackoverflow.com/questions/40966916/how-to-exit-out-of-io-in-haskell-by-checking-if-a-win-condition-is-met/40966961#40966961", "title": "How to exit out of IO in Haskell by checking if a win condition is met?", "body": "<p>You just need to add a case for <code>EndOfGame</code> in <code>gameLoop</code>:</p>\n\n<pre><code>gameLoop :: Result -&gt; Int -&gt; IO ()\ngameLoop (EndOfGame move) _ = putStrLn (\"Game over! Player \" ++ show move ++ \" won\")\ngameLoop (ContinueGame state) player = do\n  {- omitted -}\n  gameLoop (connectfour (Move turn state (read input :: Int))) turn\n</code></pre>\n\n<p>The \"non exhaustive pattern in function <code>gameloop</code>\" warning is telling you that <code>gameLoop</code> is missing a case - the <code>EndOfGame</code> one.</p>\n\n<hr>\n\n<p>On another note, you might want to consider making a player ADT:</p>\n\n<pre><code>data Player = One | Two deriving (Show)\n\notherPlayer :: Player -&gt; Player\notherPlayer One = Two\notherPlayer Two = One\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7250185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d729c1a8b88fe9f01a8ea95ef8cb903?s=128&d=identicon&r=PG&f=1", "display_name": "mattm177", "link": "https://stackoverflow.com/users/7250185/mattm177"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 0, "accepted_answer_id": 40966961, "answer_count": 1, "score": 2, "last_activity_date": 1480911636, "creation_date": 1480910649, "last_edit_date": 1480911636, "question_id": 40966916, "link": "https://stackoverflow.com/questions/40966916/how-to-exit-out-of-io-in-haskell-by-checking-if-a-win-condition-is-met", "title": "How to exit out of IO in Haskell by checking if a win condition is met?", "body": "<p>I'm trying to implement the game connect four in Haskell. It's mostly functional at this point, but I'm having trouble passing the fact that the game has ended to the IO recursive function. Currently, the code will state that I have a \"non exhaustive pattern in function gameloop\" and I don't know how to exit out properly when a winstate is achieved.</p>\n\n<p>Here's some code snippets:</p>\n\n<pre><code>data Action = Move Piece State Col   -- do Piece in State\n            | Start              -- returns starting state\ndata Result = EndOfGame Int         -- end of game\n            | ContinueGame State\n         deriving (Eq, Show)\n\ntype Game = Action -&gt; Result\n\n\nconnectfour :: Game\nconnectfour Start = ContinueGame ([],[],[],[],[],[],[])\nconnectfour (Move move state col)\n    | win move (addPiece move state col) col = EndOfGame move -- player of Piece value move wins\n    | isTie (addPiece move state col) = EndOfGame 0 -- no moves, tie\n    | otherwise = ContinueGame (addPiece move state col)\n\n\ngameLoop (ContinueGame state) player = do\n  let turn = if player == 1 then 2 else 1\n  -- Removed code for forum, just prepping values to feed into printboard and printing dialog\n  putStrLn \"Please select a column to enter your piece\"\n  input &lt;- getLine\n  gameLoop (connectfour (Move turn state (read input :: Int))) turn\n</code></pre>\n\n<p>TDLR;\n I'm trying to return a string saying which player has won on exit, but I don't know how to write a condition that checks for this in gameloop.</p>\n"}, {"tags": ["list", "sorting", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 4501633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/62a9f530c8d8dc1ec09f6c442d0d74f9?s=128&d=identicon&r=PG&f=1", "display_name": "USERSFU", "link": "https://stackoverflow.com/users/4501633/usersfu"}, "edited": false, "score": 0, "creation_date": 1480917547, "post_id": 40964937, "comment_id": 69145162, "body": "Thanks. but what if i want to use the built-in sort function as well in the same file while having my own type signature &#39;sort&#39; function?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 59, "user_id": 4501633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/62a9f530c8d8dc1ec09f6c442d0d74f9?s=128&d=identicon&r=PG&f=1", "display_name": "USERSFU", "link": "https://stackoverflow.com/users/4501633/usersfu"}, "edited": false, "score": 0, "creation_date": 1480961818, "post_id": 40964937, "comment_id": 69170790, "body": "@USERSFU Updated my answer."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 6, "last_activity_date": 1480961794, "last_edit_date": 1480961794, "creation_date": 1480893813, "answer_id": 40964937, "question_id": 40964909, "link": "https://stackoverflow.com/questions/40964909/how-to-fix-ambiguous-occurrence-error-in-haskell/40964937#40964937", "title": "how to fix Ambiguous occurrence error in Haskell", "body": "<p>You can try</p>\n\n<pre><code>import Data.List hiding (sort)\n</code></pre>\n\n<p>This will prevent <code>Data.List.sort</code> from being imported, leaving you free to define your own function called <code>sort</code>.</p>\n\n<p>If you want to be able to use <code>Data.List.sort</code> in addition to your own, also add the line</p>\n\n<pre><code>import qualified Data.List\n</code></pre>\n\n<p>or</p>\n\n<pre><code>import qualified Data.List as L\n</code></pre>\n\n<p>This allows you to to access the library function as <code>Data.List.sort</code> or <code>L.sort</code>, respectively.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1480930061, "creation_date": 1480930061, "answer_id": 40970958, "question_id": 40964909, "link": "https://stackoverflow.com/questions/40964909/how-to-fix-ambiguous-occurrence-error-in-haskell/40970958#40970958", "title": "how to fix Ambiguous occurrence error in Haskell", "body": "<p>Try qualifying the name:</p>\n\n<pre><code>module Foo where\n\nimport Data.List as L\n</code></pre>\n\n<p>Then, to refer to the library <code>sort</code>, use <code>L.sort</code>. For the user-defined sort, use <code>Foo.sort</code> instead.</p>\n"}], "owner": {"reputation": 59, "user_id": 4501633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/62a9f530c8d8dc1ec09f6c442d0d74f9?s=128&d=identicon&r=PG&f=1", "display_name": "USERSFU", "link": "https://stackoverflow.com/users/4501633/usersfu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1186, "favorite_count": 1, "accepted_answer_id": 40964937, "answer_count": 2, "score": 4, "last_activity_date": 1480961794, "creation_date": 1480893636, "last_edit_date": 1480894416, "question_id": 40964909, "link": "https://stackoverflow.com/questions/40964909/how-to-fix-ambiguous-occurrence-error-in-haskell", "title": "how to fix Ambiguous occurrence error in Haskell", "body": "<p>I have wrote one function which has a signature of </p>\n\n<pre><code>sort :: [Int] -&gt; [Int]\n</code></pre>\n\n<p>which gives me an error of </p>\n\n<blockquote>\n  <p>Ambiguous occurrence \u2018sort\u2019</p>\n</blockquote>\n\n<p>I know there is already a built-in function called sort in </p>\n\n<blockquote>\n  <p>import Data.List</p>\n</blockquote>\n\n<p>How can i fix this issue while keeping the same type signature? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 4, "creation_date": 1480891733, "post_id": 40964583, "comment_id": 69138755, "body": "Why would you expect <code>.</code> to have a higher precedence than <code>!!</code> and not the other way around?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1480893032, "post_id": 40964583, "comment_id": 69139141, "body": "I&#39;m not sure if there is a rationale to be found behind this specific clash. With &quot;only&quot; ten levels of precedence, some clashes are bound to happen."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1480898423, "post_id": 40964583, "comment_id": 69140525, "body": "@duplode, the choice of ten precedence levels is frankly bizarre. I&#39;d have expected something more like a partial order under an equivalence relation, allowing operators to be declared as having higher, lower, or equal precedence to arbitrary other operators. But I guess the designers didn&#39;t want to wade into the design of a really complex system for that."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 5, "creation_date": 1480898702, "post_id": 40965139, "comment_id": 69140593, "body": "There&#39;s no precedent for either to have higher precedence, but it certainly makes much more sense for <code>!!</code> to have higher precedence. Neither <code>(a . b) !! c</code> nor <code>a !! (b . c)</code> has any hope of passing the type checker, but <code>a . (b !! c)</code> and <code>(a !! b) . c</code> are both potentially valid."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1480903564, "post_id": 40965139, "comment_id": 69141782, "body": "It&#39;s interesting to note, though, that <code>&gt;&gt;=</code> would have been a later addition to the hierarchy, and without it there would be room for <code>.</code> to have a lower precedence than <code>!!</code>. I can&#39;t think of much reason why <code>++</code> should be higher or lower than <code>+</code>, though (assuming the fixity 6 entry should mention <code>++</code> instead of <code>++</code>)."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480925625, "post_id": 40965139, "comment_id": 69148503, "body": "@dfeuer, oh, this is interesting.  There might be some principle here.  Operators with specific return types should be lower precedence than those with more general return types, or something like that."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1480925884, "post_id": 40965139, "comment_id": 69148637, "body": "Yes, @duplode, that&#39;s exactly what I was thinking of. I erased my previous confusing comment. I do mean that <code>a + b : c</code> can make sense but <code>a : b + c</code> cannot, and the former only does when the precedence is right."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 8, "last_activity_date": 1480923594, "last_edit_date": 1480923594, "creation_date": 1480895320, "answer_id": 40965139, "question_id": 40964583, "link": "https://stackoverflow.com/questions/40964583/why-do-and-share-precedence-9/40965139#40965139", "title": "Why do (!!) and (.) share precedence 9?", "body": "<p>Haskell has a lot of operators. Running</p>\n\n<pre><code>grep -hor '^infix[lr]\\{0,1\\} .*$' ghc/libraries/ | sort -u\n</code></pre>\n\n<p>inside my GHC head I get back 137 operators. Not quite all of these are exposed, but still: since precedence has to be between <code>0</code> and <code>9</code> inclusive, clashes are inevitable.</p>\n\n<ul>\n<li><code>$</code> should be lower than pretty much everything (fixity 0)</li>\n<li><code>&gt;&gt;=</code> should be higher than <code>$</code> (fixity 1)</li>\n<li><code>||</code> should be higher than <code>&gt;&gt;=</code> (fixity 2)</li>\n<li><code>&amp;&amp;</code> should be higher than <code>||</code> (fixity 3)</li>\n<li><code>==</code> should be higher than <code>&amp;&amp;</code> (fixity 4)</li>\n<li><code>++</code> should be higher than <code>==</code> (fixity 5)</li>\n<li><code>+</code> should be higher than <code>++</code> (fixity 6)</li>\n<li><code>*</code> should be higher than <code>+</code> (fixity 7)</li>\n<li><code>^</code> should be higher than <code>*</code> (fixity 8)</li>\n<li><code>!!</code> should be higher than <code>^</code> (fixity 9)</li>\n<li><code>.</code> should be higher than pretty much everything (fixity 9)</li>\n</ul>\n\n<p>So there isn't really space to differentiate the precedence of <code>!!</code> and <code>.</code>. Also, I don't think there is much precedent for either <code>.</code> or <code>!!</code> to be expected to have higher precedence.</p>\n"}, {"comments": [{"owner": {"reputation": 1604, "user_id": 2877471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/caa140aba97cc5f1cf9d6688e1292d91?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/2877471/matt"}, "edited": false, "score": 0, "creation_date": 1480952992, "post_id": 40965144, "comment_id": 69165508, "body": "This provided the catharsis I was looking for, thank you for digging!"}], "tags": [], "owner": {"reputation": 14766, "user_id": 483486, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/fcf225aa724d9bb05f6693dc8cf8c459?s=128&d=identicon&r=PG", "display_name": "OmnipotentEntity", "link": "https://stackoverflow.com/users/483486/omnipotententity"}, "is_accepted": true, "score": 11, "last_activity_date": 1480895342, "creation_date": 1480895342, "answer_id": 40965144, "question_id": 40964583, "link": "https://stackoverflow.com/questions/40964583/why-do-and-share-precedence-9/40965144#40965144", "title": "Why do (!!) and (.) share precedence 9?", "body": "<p>I went digging.  There likely is no rhyme or reason for the two infix operators having the same precedence.  In the Haskell 1.0 report, released in 1990, the <code>(!!)</code> operator was found in the PreludeList.hs file and the <code>(.)</code> operator was in the Prelude.hs file.  Because they deal with completely different things (function composition vs list indexing), and they were in completely different files, it's highly likely that they were not cross coordinated.</p>\n\n<p>Moreover, within the report, these functions in the Prelude were barely mentioned.  <code>(.)</code> was just mentioned in a one liner as the composition function and <code>(!!)</code> was not mentioned at all outside of the actual source file.</p>\n\n<p>The reason for that ought to be more or less obvious.  The Prelude is useful, but it's not the reason Haskell was developed, and it's not the hard, interesting part of language design.  Haskell was more about lambda calculus and category theory than list indexing.  So it's not surprising that not a lot of thought (or at least not a lot of documentation!) went into exactly what precedence various operators were.</p>\n"}], "owner": {"reputation": 1604, "user_id": 2877471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/caa140aba97cc5f1cf9d6688e1292d91?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/2877471/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "closed_date": 1480942558, "accepted_answer_id": 40965144, "answer_count": 2, "score": 4, "last_activity_date": 1480923594, "creation_date": 1480891279, "question_id": 40964583, "link": "https://stackoverflow.com/questions/40964583/why-do-and-share-precedence-9", "closed_reason": "Opinion-based", "title": "Why do (!!) and (.) share precedence 9?", "body": "<p>New to Haskell, and I hit a simple error on this piece of an expression</p>\n\n<pre><code>matches !! length . count\n</code></pre>\n\n<blockquote>\n  <p>cannot mix '!!' [infixl 9] and '.' [infixr 9] in the same infix expression</p>\n</blockquote>\n\n<p>This surprised me - why do these operators share a precendence? What prevented Haskell's designers from establishing <code>(.)</code> at a higher precendence than <code>(!!)</code>? </p>\n\n<p>I can't imagine this was simply overlooked, so I assume there is a rationale here that I am missing.</p>\n\n<p><strong>Note</strong> I realize that applying <code>(!!)</code> to the function that is composed by <code>(.)</code> would still result in an error at compile time. I'm curious about why Haskell was designed in a way that allowed for this unexpected error message.</p>\n"}, {"tags": ["haskell", "dictionary", "hashmap"], "comments": [{"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 4, "creation_date": 1480881120, "post_id": 40962891, "comment_id": 69135131, "body": "How is efficiency measured here? Which operations and what expected/required bounds?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1480881920, "post_id": 40962891, "comment_id": 69135423, "body": "Check out <a href=\"https://hackage.haskell.org/package/containers\" rel=\"nofollow noreferrer\"><code>containers</code></a> (not hashed based) and <a href=\"https://hackage.haskell.org/package/unordered-containers\" rel=\"nofollow noreferrer\"><code>unordered-containers</code></a> (hash based)."}, {"owner": {"reputation": 405, "user_id": 5116025, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/YUFkR.jpg?s=128&g=1", "display_name": "Orest Xherija", "link": "https://stackoverflow.com/users/5116025/orest-xherija"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1480883496, "post_id": 40962891, "comment_id": 69135987, "body": "@duplode, I think it is, thanks for pointing that out!"}], "owner": {"reputation": 405, "user_id": 5116025, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/YUFkR.jpg?s=128&g=1", "display_name": "Orest Xherija", "link": "https://stackoverflow.com/users/5116025/orest-xherija"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "closed_date": 1480883513, "answer_count": 0, "score": 0, "last_activity_date": 1480881085, "creation_date": 1480880932, "last_edit_date": 1480881085, "question_id": 40962891, "link": "https://stackoverflow.com/questions/40962891/haskell-efficient-equivalent-for-hash-based-dictionary", "closed_reason": "Duplicate", "title": "Haskell - efficient equivalent for hash-based dictionary", "body": "<p>I would like to construct a couple of \"dictionaries\" in Haskell as part of a project I am working on. I was wondering what would be some efficient data structures for doing so. A very naive approach would be to use a list of tuples, but I suspect that this would be quite inefficient. </p>\n\n<p>Any suggestions would be most welcome!</p>\n\n<p>P.S. I am creating this dictionaries by reading a corpus of raw text as the keys and some scores about the words as values.</p>\n"}, {"tags": ["haskell", "compiler-errors", "cabal", "ghc-mod"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480879060, "post_id": 40961963, "comment_id": 69134320, "body": "What does the <code>config.log</code> say?"}, {"owner": {"reputation": 87, "user_id": 5304008, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/161b26cefcabbf272ba2f9eb67b9230b?s=128&d=identicon&r=PG&f=1", "display_name": "Cooki3Tube", "link": "https://stackoverflow.com/users/5304008/cooki3tube"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480879462, "post_id": 40961963, "comment_id": 69134488, "body": "Unfortunatly I don&#39;t know where it is located, could you please give me a hint ?"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1480881130, "post_id": 40961963, "comment_id": 69135136, "body": "On Windows, I&#39;d use stack: <a href=\"http://haskellstack.org/\" rel=\"nofollow noreferrer\">haskellstack.org</a>"}, {"owner": {"reputation": 87, "user_id": 5304008, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/161b26cefcabbf272ba2f9eb67b9230b?s=128&d=identicon&r=PG&f=1", "display_name": "Cooki3Tube", "link": "https://stackoverflow.com/users/5304008/cooki3tube"}, "edited": false, "score": 0, "creation_date": 1480884247, "post_id": 40961963, "comment_id": 69136233, "body": "Sure, I tried this too, but since stack is built on top of <code>cabal</code> I get the same error when running <code>stack installghc-mod</code>"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1480890136, "post_id": 40961963, "comment_id": 69138223, "body": "Try using the --no-system-ghc argument to Stack, which will force it to install its own toolchain instead of using the Haskell Platform toolchain. The next version of Stack will be making that setting the default."}, {"owner": {"reputation": 87, "user_id": 5304008, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/161b26cefcabbf272ba2f9eb67b9230b?s=128&d=identicon&r=PG&f=1", "display_name": "Cooki3Tube", "link": "https://stackoverflow.com/users/5304008/cooki3tube"}, "edited": false, "score": 0, "creation_date": 1480966247, "post_id": 40961963, "comment_id": 69173153, "body": "Thanks for the advice this helped :)"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1480973179, "post_id": 40961963, "comment_id": 69176834, "body": "<code>C:\\PROGRA~1\\Haskell Platform\\8.0.1\\mingw\\bin\\gcc.exe</code> -- this isn&#39;t a corrupted path. its using the short path facility in windows to be more compatible (<a href=\"https://en.wikipedia.org/wiki/8.3_filename\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/8.3_filename</a>).  if by 3 lines you mean step 3 here (<a href=\"https://www.haskell.org/platform/windows.html\" rel=\"nofollow noreferrer\">haskell.org/platform/windows.html</a>), pasting how you edited your cabal config file might help since it sure <i>looks</i> like an error from those lines not being in place properly..."}], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 2, "last_activity_date": 1480968309, "creation_date": 1480968309, "answer_id": 40982402, "question_id": 40961963, "link": "https://stackoverflow.com/questions/40961963/haskell-cabal-c-compiler-cannot-create-executables/40982402#40982402", "title": "Haskell cabal: C compiler cannot create executables", "body": "<p>I can't know for certain, but thought I'd write an answer with what I <em>think</em> is going on.</p>\n\n<p>The <code>old-time</code> package contains a <code>configure</code> script, which is a Unix shell script used to (surprise!) configure the package. The Cabal build system allows packages to automatically integrate <code>configure</code>, and will run the script for them. On POSIX systems, there's always a shell easily available. However, on Windows, that's not the case. I believe that's the problem you're running into.</p>\n\n<p>Now the tricky part: why <em>don't</em> you have a shell? In theory, the Haskell Platform ships a shell. Well, here are my guesses:</p>\n\n<ul>\n<li>For Stack usage, there's <a href=\"https://github.com/haskell/haskell-platform/issues/251\" rel=\"nofollow noreferrer\">a Haskell Platform bug</a> where Stack cannot find the MSYS tools, which include the shell script. Newer versions of Stack work around this bug, but passing in <code>--no-system-ghc</code> tells Stack to ignore any installed toolchain and manage the installation itself, which is more reliable than using HP's copy.</li>\n<li>For Cabal usage, I'm less certain. I <em>think</em> the HP team decided to require you to use a special batch program to set environment variables correctly, so if you just run <code>cabal install foo</code> from a normal command window, Cabal won't find MSYS and it will fail. However, without more information, I can't be certain this is the case.</li>\n</ul>\n\n<p>My personal recommendation: uninstall Haskell Platform, and use <a href=\"https://haskell-lang.org/get-started/windows\" rel=\"nofollow noreferrer\">the recommended Stack installation instructions</a>. In your case, that's just <a href=\"https://www.stackage.org/stack/windows-x86_64-installer\" rel=\"nofollow noreferrer\">downloading and running the 64-bit Windows installer</a>.</p>\n\n<p>Finally: your suspected problem is not actually a problem; on Windows, pathnames longer than 8 characters can be compressed in the way you see (with <code>~1</code> at the end). There's nothing buggy in that path display.</p>\n"}], "owner": {"reputation": 87, "user_id": 5304008, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/161b26cefcabbf272ba2f9eb67b9230b?s=128&d=identicon&r=PG&f=1", "display_name": "Cooki3Tube", "link": "https://stackoverflow.com/users/5304008/cooki3tube"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1339, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1485693610, "creation_date": 1480875502, "last_edit_date": 1485693610, "question_id": 40961963, "link": "https://stackoverflow.com/questions/40961963/haskell-cabal-c-compiler-cannot-create-executables", "title": "Haskell cabal: C compiler cannot create executables", "body": "<p>I'm trying to install <code>ghc-mod</code> for GHC 8.0.1 on windows/x64. When I try to install <code>ghc-mod</code> via <code>cabal install ghc-mod</code> I get an error saying my C compiler isn't working (it is using the c-compiler bundled with <code>ghc</code>).</p>\n\n<p>Here is the output (of the second time I ran the command. Its basically what the first one says but reduced to the error message):</p>\n\n<pre><code>C:\\Users\\******&gt;cabal install ghc-mod\nResolving dependencies...\nConfiguring old-time-1.1.0.3...\nFailed to install old-time-1.1.0.3\nBuild log ( C:\\Users\\******\\AppData\\Roaming\\cabal\\logs\\old-time-1.1.0.3.log ):\nConfiguring old-time-1.1.0.3...\nbash.exe: warning: could not find /tmp, please create!\nconfigure: WARNING: unrecognized options: --with-compiler\nchecking for gcc... C:\\PROGRA~1\\Haskell Platform\\8.0.1\\mingw\\bin\\gcc.exe \n                    ^ I think the error lies here, as you can see the file path is corrupted but I wasn't able to locate the cause for this\nchecking whether the C compiler works... no\nconfigure: error: in `/cygdrive/c/Users/******/AppData/Local/Temp/cabal-tmp-6084/old-time-1.1.0.3':\nconfigure: error: C compiler cannot create executables\nSee `config.log' for more details\ncabal: Leaving directory 'C:\\Users\\******\\AppData\\Local\\Temp\\cabal-tmp-6084\\old-time-1.1.0.3'\ncabal: Error: some packages failed to install:\ncpphs-1.20.2 depends on old-time-1.1.0.3 which failed to install.\nghc-mod-5.6.0.0 depends on old-time-1.1.0.3 which failed to install.\nhaskell-src-exts-1.17.1 depends on old-time-1.1.0.3 which failed to install.\nhlint-1.9.35 depends on old-time-1.1.0.3 which failed to install.\nold-time-1.1.0.3 failed during the configure step. The exception was:\nExitFailure 77\n</code></pre>\n\n<p>Could you please help me to install <code>ghc-mod</code> or provide any other way of installing it.</p>\n\n<p>I already trieded reinstalling Haskell since I'm just starting off but this didn't make any difference.\nAnd YES I added the 3 lines provided on the haskell homepage. </p>\n"}, {"tags": ["regex", "haskell", "posix"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1480874994, "post_id": 40961756, "comment_id": 69132927, "body": "<code>\\d</code> doesn&#39;t mean anything special in POSIX regexes. It just matches <code>d</code>. Try <code>[[:digit:]]</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 2131, "user_id": 3475678, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/230e565cac4491b28134bb92bfc28a70?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksey", "link": "https://stackoverflow.com/users/3475678/aleksey"}, "edited": false, "score": 1, "creation_date": 1483002812, "post_id": 40963257, "comment_id": 69954654, "body": "Oh these brackets! Thank you."}], "tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 8, "last_activity_date": 1480883163, "creation_date": 1480883163, "answer_id": 40963257, "question_id": 40961756, "link": "https://stackoverflow.com/questions/40961756/why-text-regex-posix-matches-characters-with-d/40963257#40963257", "title": "Why Text.Regex.Posix =~ matches characters with \\d?", "body": "<p>The <a href=\"https://hackage.haskell.org/package/regex-posix-0.95.2/docs/Text-Regex-Posix.html\"><code>Text.Regex.Posix</code> module</a> only supports <em>c posix regex api</em>. POSIX regex syntax does not define <code>\\d</code> as a shorthand character class for digits, instead, it has <code>[:digit:]</code> POSIX character class that must be used inside <em>bracket expressions</em>, e.g. <code>[[:digit:]]</code>. However, it is as easier and shorter to use <code>[0-9]</code> to match regular ASCII digits.</p>\n\n<p>To use <code>\\d</code> in your patterns, you may want to use <a href=\"https://hackage.haskell.org/package/regex-pcre-0.94.4/docs/Text-Regex-PCRE-Wrap.html\"><em>Text.Regex.PCRE</em></a>.</p>\n"}], "owner": {"reputation": 45, "user_id": 4624223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03977d247fadcbe1edf25945a20219a8?s=128&d=identicon&r=PG&f=1", "display_name": "Jo&#227;o Rodrigues", "link": "https://stackoverflow.com/users/4624223/jo%c3%a3o-rodrigues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "accepted_answer_id": 40963257, "answer_count": 1, "score": 4, "last_activity_date": 1480883163, "creation_date": 1480874269, "question_id": 40961756, "link": "https://stackoverflow.com/questions/40961756/why-text-regex-posix-matches-characters-with-d", "title": "Why Text.Regex.Posix =~ matches characters with \\d?", "body": "<p>Can someone explain how this interaction in ghci is possible?</p>\n\n<pre><code>*Main Text.Regex.Posix&gt; \"d1\" =~ \"\\\\d\" :: String\n\"d\"\n*Main Text.Regex.Posix&gt; \"d1\" =~ \"\\\\d\" :: Int\n1\n</code></pre>\n\n<p>I thought that <code>\\d</code> standed for digit, so I don't understand how it can match the character <code>d</code> and not the character <code>1</code> present on the string.</p>\n\n<p>Note: Using ghci 7.10.3</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 5, "creation_date": 1480871379, "post_id": 40961198, "comment_id": 69131635, "body": "Would <code>shout = map toUpper</code> work?"}, {"owner": {"reputation": 1604, "user_id": 2877471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/caa140aba97cc5f1cf9d6688e1292d91?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/2877471/matt"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1480871630, "post_id": 40961198, "comment_id": 69131730, "body": "oh, there are definitely ways to tweak it entirely, but I was wondering if i could make the recursive version point free (as I type this, I&#39;m thinking &quot;maybe recursion is why I can&#39;t point-free&quot;). Shoulda made that more explicit in my question"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1480871918, "post_id": 40961198, "comment_id": 69131829, "body": "Assume you have managed to fix <code>(toUpper . head) : (shout . tail)</code> (it is possible). How does the recursion end? You need to evaluate some condition. How do you write a condition in a point-free manner?"}], "answers": [{"comments": [{"owner": {"reputation": 1604, "user_id": 2877471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/caa140aba97cc5f1cf9d6688e1292d91?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/2877471/matt"}, "edited": false, "score": 0, "creation_date": 1480873680, "post_id": 40961445, "comment_id": 69132462, "body": "Yup, I&#39;m seeing Applicative a few chapters out in my book yet. Thanks for the very thorough reply!"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1480874349, "post_id": 40961445, "comment_id": 69132702, "body": "Does the <code>Applicative</code> case work? I was working on an answer along those lines, but I can&#39;t seem to get something that type-checks. <code>shout = (:) &lt;$&gt; (toUpper.head) &lt;*&gt; (shout . tail)</code> &quot;works&quot; (at least, for infinite lists), but trying to combine this with <code>bool</code> results in a type error. <code>shout = bool ((:) &lt;$&gt; (toUpper . head) &lt;*&gt; (shout . tail)) id . null</code>."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1480874500, "post_id": 40961445, "comment_id": 69132756, "body": "@chepner You are just missing the <code>join</code>. The <code>bool</code> consumes the argument for the predicate and then there is nothing to apply the functions of the two cases to."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1480878030, "post_id": 40961445, "comment_id": 69133908, "body": "Ah, OK, right. <code>null</code> is using the input without passing it through to the correct function. I never gave much thought to what <code>join</code> does in the function monad."}], "tags": [], "owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "is_accepted": true, "score": 8, "last_activity_date": 1480874017, "last_edit_date": 1480874017, "creation_date": 1480872614, "answer_id": 40961445, "question_id": 40961198, "link": "https://stackoverflow.com/questions/40961198/is-it-possible-to-make-this-recursive-function-point-free/40961445#40961445", "title": "Is it possible to make this recursive function point-free?", "body": "<p>As @n.m noted you can use <code>shout = map toUpper</code>. However it is possible to do this without <code>map</code> or any other fancy functions like <code>foldr</code>, but we need more combinators. We need something that takes our input argument and passes it to two functions <code>toUpper . head</code> and <code>shout . tail</code> and then combines them with <code>:</code>. You propably don't know this function yet,  but the <code>&lt;*&gt;</code> operator from applicative has what we need:</p>\n\n<pre><code>(f &lt;*&gt; g) x = f x (g x)\n</code></pre>\n\n<p>Now we can do something like this:</p>\n\n<pre><code>combine . f &lt;*&gt; g = \\x -&gt; combine (f x) (g x) -- [1]\n</code></pre>\n\n<p>I will let you figure out how exactly to apply this to your problem. ;)</p>\n\n<p>But we still need to express the empty list case somehow. There are multiple ways to do this but the easiest would be the <code>bool</code> from <code>Data.Bool</code> function which is like an <code>if</code> function, together with <code>join</code> from <code>Control.Monad</code>.</p>\n\n<pre><code>-- [2]\nbool x _ False = x\nbool _ x True  = x\n\njoin f x = f x x\n</code></pre>\n\n<p>Now we can do the following:</p>\n\n<pre><code>shout = join $ bool (not null case) (null case) . null\n-- Which translates to\nshout xs = bool ((not null case) xs) ((null case) xs) (null xs)\n</code></pre>\n\n<p>Again implementing the two cases is left as an excercise to the reader.</p>\n\n<p>[1]: Instead of <code>(.)</code> you could also use <code>(&lt;$&gt;)</code> which for functions is the same as <code>(.)</code> but <code>(&lt;$&gt;)</code> and <code>(&lt;*&gt;)</code> kind of belong together. You will understand why once you learn about applicatives.</p>\n\n<p>[2]: If you wonder what the reasoning behind the order of the arguments of <code>bool</code> is, the first argument is the <code>False</code> case because <code>Bool</code> is defined like this:</p>\n\n<pre><code>data Bool = False | True\n</code></pre>\n\n<p>And this order is motivated by the convention that <code>False &lt; True</code>. <code>maybe</code> and <code>either</code> are two other functions that share this exact pattern with <code>bool</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1480874956, "last_edit_date": 1480874956, "creation_date": 1480873468, "answer_id": 40961617, "question_id": 40961198, "link": "https://stackoverflow.com/questions/40961198/is-it-possible-to-make-this-recursive-function-point-free/40961617#40961617", "title": "Is it possible to make this recursive function point-free?", "body": "<p>To rewrite anything in a pointfree style,  install <a href=\"http://hackage.haskell.org/package/pointfree\" rel=\"nofollow noreferrer\">pointfree</a>  or use any one of the online versions (<a href=\"http://pointfree.io\" rel=\"nofollow noreferrer\">http://pointfree.io</a> or <a href=\"https://blunt.herokuapp.com\" rel=\"nofollow noreferrer\">https://blunt.herokuapp.com</a>).  </p>\n\n<p>Your expression</p>\n\n<pre><code>\\input -&gt; (toUpper . head $ input) : (shout . tail $ input)\n</code></pre>\n\n<p>translates to</p>\n\n<pre><code>ap ((:) . toUpper . head) (shout . tail)\n</code></pre>\n\n<p>(You can substitute <code>&lt;*&gt;</code> for <code>ap</code>, they are interchangeable in this case).</p>\n\n<p>But this is not enough. You also need to somehow end the recursion. To do that in the pointfree style you need a pointfree <code>if</code> or a pointfree pattern match which do not seem to exist in Haskell. In theory <code>if</code> could be defined as a built-in function, which would make a pointfree definition possible, but in Haskell it isn't. (One can define such a function, but its implementation would not be pointfree. So you can trade <code>map</code> for <code>Data.Bool.bool</code>, but is there a point?</p>\n\n<p>Combinators like <code>.</code> and <code>$</code> and even <code>ap</code> are probably not internally pointfree either, but using them doesn't <em>feel</em> like cheating. They only deal with functions, and thus feel somehow more fundamental than <code>bool</code> or <code>map</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1155, "user_id": 962394, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/97268298c366b07e5556567639105ee1?s=128&d=identicon&r=PG", "display_name": "codeshot", "link": "https://stackoverflow.com/users/962394/codeshot"}, "edited": false, "score": 1, "creation_date": 1542359096, "post_id": 40965810, "comment_id": 93548205, "body": "This is the most practical way to make recursion pointfree. Just gets straight to the nub of the problem"}], "tags": [], "owner": {"reputation": 841, "user_id": 2272506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d910c6f729897b6af6fa867a794001?s=128&d=identicon&r=PG", "display_name": "Jesin", "link": "https://stackoverflow.com/users/2272506/jesin"}, "is_accepted": false, "score": 1, "last_activity_date": 1480901187, "creation_date": 1480901187, "answer_id": 40965810, "question_id": 40961198, "link": "https://stackoverflow.com/questions/40961198/is-it-possible-to-make-this-recursive-function-point-free/40965810#40965810", "title": "Is it possible to make this recursive function point-free?", "body": "<p>The point-free way to do recursion is to use <code>Data.Function.fix</code>, which is explained here: <a href=\"https://en.wikibooks.org/wiki/Haskell/Fix_and_recursion\" rel=\"nofollow noreferrer\">https://en.wikibooks.org/wiki/Haskell/Fix_and_recursion</a></p>\n"}], "owner": {"reputation": 1604, "user_id": 2877471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/caa140aba97cc5f1cf9d6688e1292d91?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/2877471/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 40961445, "answer_count": 3, "score": 1, "last_activity_date": 1480901187, "creation_date": 1480871138, "last_edit_date": 1480871771, "question_id": 40961198, "link": "https://stackoverflow.com/questions/40961198/is-it-possible-to-make-this-recursive-function-point-free", "title": "Is it possible to make this recursive function point-free?", "body": "<p>I have a simple function, and the desire to make sense of point-free style.</p>\n\n<pre><code>shout :: String -&gt; String\nshout input\n  | null input = []\n  | otherwise = (toUpper . head $ input) : (shout . tail $ input)\n</code></pre>\n\n<p>My intuition led me to this</p>\n\n<pre><code>pfShout :: String -&gt; String\npfShout = (toUpper . head) : (shout . tail)\n</code></pre>\n\n<p>which is complaining about the following for the first argument of the cons cell</p>\n\n<blockquote>\n  <p>Couldn't match expected type 'String -> String'\n                with actual type '[[Char] -> Char]'</p>\n  \n  <ul>\n  <li><p>Possible cause: '(:)' is applied to too many arguments</p>\n  \n  <p>In the expression: (toUpper . head) : (pfShout . tail)</p>\n  \n  <p>In an equation for 'pfShout':\n    pfShout = (toUpper . head) : (pfShout . tail)</p></li>\n  </ul>\n</blockquote>\n\n<p>and complaining about this for the second argument of the cons cell</p>\n\n<blockquote>\n  <p>Couldn't match expected type '[[Char] -> Char]'\n                with actual type '[Char] -> String'</p>\n  \n  <ul>\n  <li><p>Probable cause: '(.)' is applied to too few arguments</p>\n  \n  <p>In the second argument of '(:)', namely '(pfShout . tail)'</p>\n  \n  <p>In the expression: (toUpper . head) : (pfShout . tail)</p>\n  \n  <p>In an equation for 'pfShout':\n    pfShout = (toUpper . head) : (pfShout . tail)</p></li>\n  </ul>\n</blockquote>\n\n<p>It's clear to me that I can't make a list out of 'String -> String' functions <em>and</em> '[[Char]->Char]', and I'm starting to get a to a place where I'm thinking this just isn't gonna work point-free.</p>\n\n<p>I understand there are other considerations here (like now I'm missing a base-case), but . I also understand I could completely re-write the function to achieve the same effect (like <code>map toUpper</code>). I'm primarily interested in point-free <em>using recursion</em> with the function as it is written.</p>\n\n<p>If it is (or isn't) possible to write this function point-free, what am I missing?</p>\n"}, {"tags": ["json", "haskell", "aeson"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1480870310, "post_id": 40961032, "comment_id": 69131250, "body": "Relevant: <a href=\"http://stackoverflow.com/questions/18410686/parse-json-with-fieldnames-that-contain-reserved-keywords\">Parse JSON with fieldnames that contain reserved keywords</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7248679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8a4f377512a3b60b865b3dcb8f87e05?s=128&d=identicon&r=PG&f=1", "display_name": "Orado", "link": "https://stackoverflow.com/users/7248679/orado"}, "edited": false, "score": 0, "creation_date": 1480878598, "post_id": 40962407, "comment_id": 69134148, "body": "by the way, is there a way to generate a list of &quot;imports&quot; or &quot;imports qualified&quot; with template haskell  so it compiles as if I were to add them manually?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 13, "user_id": 7248679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8a4f377512a3b60b865b3dcb8f87e05?s=128&d=identicon&r=PG&f=1", "display_name": "Orado", "link": "https://stackoverflow.com/users/7248679/orado"}, "edited": false, "score": 0, "creation_date": 1480879018, "post_id": 40962407, "comment_id": 69134295, "body": "@Orado Not that I know of. Maybe someone else will have an idea for that."}, {"owner": {"reputation": 13, "user_id": 7248679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8a4f377512a3b60b865b3dcb8f87e05?s=128&d=identicon&r=PG&f=1", "display_name": "Orado", "link": "https://stackoverflow.com/users/7248679/orado"}, "edited": false, "score": 1, "creation_date": 1480911773, "post_id": 40962407, "comment_id": 69143606, "body": "alright. is it possible not to parse all the fields in <code>FromJSON</code> implementation, but only ones I want, because others are irrelevant for me?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 13, "user_id": 7248679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8a4f377512a3b60b865b3dcb8f87e05?s=128&d=identicon&r=PG&f=1", "display_name": "Orado", "link": "https://stackoverflow.com/users/7248679/orado"}, "edited": false, "score": 0, "creation_date": 1480912272, "post_id": 40962407, "comment_id": 69143742, "body": "@Orado That happens automatically. If your JSON object has more fields than you need, the extra fields are just ignored."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480915526, "post_id": 40962407, "comment_id": 69144599, "body": "You should probably derive <code>Generic</code> anyway; all sorts of other classes will want it for defaults."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 2, "last_activity_date": 1480878039, "creation_date": 1480878039, "answer_id": 40962407, "question_id": 40961032, "link": "https://stackoverflow.com/questions/40961032/fromjson-tojson-when-some-of-the-fields-should-be-parsed-manually/40962407#40962407", "title": "FromJSON / ToJSON when some of the fields should be parsed manually", "body": "<p>You'll want to take a look at the template Haskell <a href=\"https://hackage.haskell.org/package/aeson-1.0.2.1/docs/Data-Aeson-TH.html\" rel=\"nofollow noreferrer\">deriving abilities of <code>aeson</code></a>. There is an option there which helps you rename fields. For example, say I want to rename the <code>color</code> field to <code>colour</code> in the declaration below:</p>\n\n<pre><code>data MyData = MyData { address :: String\n                     , streetNumber :: Integer\n                     , isApartment :: Bool\n                     , color :: String\n                     }\n</code></pre>\n\n<p>Then, instead of deriving <code>Generic</code>, I add the following</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nimport Data.Aeson.TH\n\ndata MyData = MyData { address :: String\n                     , streetNumber :: Integer\n                     , isApartment :: Bool\n                     , color :: String\n                     }\n\n$(deriveJSON defaultOptions{\n    constructorTagModifier = \\f -&gt; if f == \"color\" then \"colour\" else f \n  } ''MyData)\n</code></pre>\n\n<p>Then my <code>ToJSON</code> and <code>FromJSON</code> instances have appropriately named fields.</p>\n"}], "owner": {"reputation": 13, "user_id": 7248679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8a4f377512a3b60b865b3dcb8f87e05?s=128&d=identicon&r=PG&f=1", "display_name": "Orado", "link": "https://stackoverflow.com/users/7248679/orado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 40962407, "answer_count": 1, "score": 1, "last_activity_date": 1480897025, "creation_date": 1480870088, "last_edit_date": 1480897025, "question_id": 40961032, "link": "https://stackoverflow.com/questions/40961032/fromjson-tojson-when-some-of-the-fields-should-be-parsed-manually", "title": "FromJSON / ToJSON when some of the fields should be parsed manually", "body": "<p>I have a data:</p>\n\n<pre><code>data MyData = MyData { a :: String, b :: Integer, c :: Bool } \n                      deriving (Generic)\n\ninstance FromJSON MyData\ninstance ToJSON MyData\n</code></pre>\n\n<p>In fact, I have many more fields in <code>MyData</code>. </p>\n\n<p>I want to parse 1 or 2 fields manually because in <code>MyData</code> they're called slightly different than in the real JSON object, while still being able to have <code>FromJSON</code> and <code>ToJSON</code> or something like that. Is it possible? Or should I in this case parse all the fields manually and not use <code>FromJSON</code> / <code>ToJSON</code>?</p>\n"}, {"tags": ["c++", "haskell", "dynamic-linking", "haskell-stack", "shake-build-system"], "comments": [{"owner": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1480909053, "post_id": 40960168, "comment_id": 69143022, "body": "Should you be running <code>stack install</code>, or rather <code>stack build</code>? You can also pass the <code>--copy-bins</code> flag to <code>stack</code>, so that it can copy the files by itself without invoking a shake <code>cp</code>."}, {"owner": {"reputation": 247, "user_id": 407472, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e9ee0858c59dfae36ab259481e7cbdd?s=128&d=identicon&r=PG", "display_name": "PsyFish", "link": "https://stackoverflow.com/users/407472/psyfish"}, "reply_to_user": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1480929092, "post_id": 40960168, "comment_id": 69150294, "body": "<code>stack build --copy-bins</code> is identical to <code>stack install</code>. If I use only that instead of <code>cp</code> the .so is not renamed, and the shake script fails, as mentioned above. But Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "is_accepted": false, "score": 0, "last_activity_date": 1528385701, "creation_date": 1528385701, "answer_id": 50745175, "question_id": 40960168, "link": "https://stackoverflow.com/questions/40960168/building-a-c-project-that-links-to-a-haskell-library-using-shake-and-stack/50745175#50745175", "title": "Building a C++ project that links to a Haskell library, using Shake and Stack", "body": "<p>The original identifier is embedded in the <code>.so</code>. I don't remember all the details, but I do know that I've solved such problems using <a href=\"https://en.wikipedia.org/wiki/Rpath\" rel=\"nofollow noreferrer\"><code>rpath</code></a> twiddling in the past.</p>\n"}], "owner": {"reputation": 247, "user_id": 407472, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e9ee0858c59dfae36ab259481e7cbdd?s=128&d=identicon&r=PG", "display_name": "PsyFish", "link": "https://stackoverflow.com/users/407472/psyfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1528385701, "creation_date": 1480864995, "last_edit_date": 1480931275, "question_id": 40960168, "link": "https://stackoverflow.com/questions/40960168/building-a-c-project-that-links-to-a-haskell-library-using-shake-and-stack", "title": "Building a C++ project that links to a Haskell library, using Shake and Stack", "body": "<p>I'm trying to build a simple C++ project (an executable) that calls a Haskell function,\nusing Shake for the build script and calling Stack from within the script to build the Haskell library.</p>\n\n<p>Let's say the Haskell library is called <code>haskell-simple-lib</code>.</p>\n\n<p>The shake script calls <code>stack install haskell-simple-lib</code> which outputs an <code>.so</code> file: <code>libHShaskell-simple-lib-*version*-*unique identifier*.so</code></p>\n\n<p>My Shake rules depends on filenames, and so I can't use the aforementioned name as I don't know in advance what the unique identifier will be. And so, the Shake script runs a <code>cp</code> on the file to <code>_build/libHShaskell-simple-lib.so</code></p>\n\n<p>The link options for the C++ executable has <code>-L_build</code> and <code>-lhaskell-simple-lib</code>.</p>\n\n<p>When I try to run the executable I get an error saying: </p>\n\n<pre><code>error while loading shared libraries: libHShaskell-simple-lib-0.1.0.0-8DkaSm3F3d44RUd03fOuDx-ghc7.10.2.so: cannot open shared object file: No such file or directory\n</code></pre>\n\n<p>But, if I rename the file I copied to <code>_build</code>, to the original name that <code>stack install</code> outputted (the one with the unique identifier), the executable runs correctly.</p>\n\n<p>One would think that all I need to do is to simply <code>cp</code> the file to <code>_build</code> without erasing the unique identifier from the name, however I need to know the name of the <code>.so</code> file in advance for the shake script.</p>\n\n<p>I don't understand why when the executable is run the original .so filename is searched for. The link flag doesn't mention the fullname of the <code>.so</code> that <code>stack install</code> outputted, only <code>libHShaskell-simple-lib</code>.\nCould it be that the original name is embedded in the .so file? If so, how does one go about solving this issue?</p>\n\n<p>EDIT:\nI'm aware this could be solved using a dummy file, but I'd like to know if there's a better way to do this.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 1, "creation_date": 1480861099, "post_id": 40959497, "comment_id": 69128359, "body": "Show/Tell us more about your code. Are the lists constant?"}, {"owner": {"reputation": 2044, "user_id": 1258491, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/yyvEu.png?s=128&g=1", "display_name": "metaleap", "link": "https://stackoverflow.com/users/1258491/metaleap"}, "reply_to_user": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 1, "creation_date": 1480861430, "post_id": 40959497, "comment_id": 69128466, "body": "Just realizing mine was such a stupid question (break time I guess), of course so many of my lists are strings loaded from IO and entirely dynamic-length. I have to assume a ~25 year-old compiler project will inline known lengths of constant lists.."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 2, "creation_date": 1480861732, "post_id": 40959497, "comment_id": 69128539, "body": "That has nothing to do with a 25 year old compiler - it depends on the implementation of the data structure you&#39;re using. Lists do not save length information and therefore you don&#39;t have constant time length with lists."}], "answers": [{"comments": [{"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1480866462, "post_id": 40959679, "comment_id": 69129927, "body": "I think the question wasn&#39;t whats the data structure of List and how to implement length for it, but whether there are any compiler optimisations in cases where the length can be known at compile time."}], "tags": [], "owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "is_accepted": false, "score": 2, "last_activity_date": 1480862475, "last_edit_date": 1480862475, "creation_date": 1480861955, "answer_id": 40959679, "question_id": 40959497, "link": "https://stackoverflow.com/questions/40959497/are-length-calls-rewritten-as-constant-ints-by-ghc/40959679#40959679", "title": "Are &#39;length&#39; calls rewritten as constant ints by GHC?", "body": "<p>It all depends on the data structure used. Regular lists are simple singly linked lists:</p>\n\n<pre><code>data List a = Nil | Cons a (List a)\n</code></pre>\n\n<p>You can imagine <code>length</code> being defined like this:</p>\n\n<pre><code>length []     = 0\nlength (x:xs) = 1 + length xs\n</code></pre>\n\n<p>This requires O(n) time to run, as there is no faster way to determine the length of this structure.</p>\n\n<p>As the strings reside in a text file, they are not constant at compile time and <code>length</code> calls have to be evaluated normally.</p>\n\n<hr>\n\n<p>Using the package <a href=\"https://hackage.haskell.org/package/vector-0.11.0.0/docs/Data-Vector.html\" rel=\"nofollow noreferrer\"><code>Data.Vector</code></a> you get O(1) length calls but lose some list properties.</p>\n"}, {"comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 1, "creation_date": 1480863107, "post_id": 40959805, "comment_id": 69128957, "body": "WIll it also do this for strings / lists read from files, which aren&#39;t known at compile time?"}, {"owner": {"reputation": 2044, "user_id": 1258491, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/yyvEu.png?s=128&g=1", "display_name": "metaleap", "link": "https://stackoverflow.com/users/1258491/metaleap"}, "edited": false, "score": 0, "creation_date": 1480863220, "post_id": 40959805, "comment_id": 69128982, "body": "@Reid Barton well good timing for me then with 8.0.1! The case here with &quot;lists&quot; was really about lots of string processing with many string constants scattered about (predefined formats to generate etc) --- not high-level enough to use advanced text processing packages, but convoluted enough that I noticed I&#39;m doing so many <code>lengths</code> on either constants or <code>concat</code>s-of-constants, and in deep recursions, and for unknown numbers of in/out files etc that it made me ponder &quot;how constant are my constants at this stage&quot;.."}, {"owner": {"reputation": 2044, "user_id": 1258491, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/yyvEu.png?s=128&g=1", "display_name": "metaleap", "link": "https://stackoverflow.com/users/1258491/metaleap"}, "reply_to_user": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1480863324, "post_id": 40959805, "comment_id": 69129002, "body": "@ThreeFx unlikely now isn&#39;t it? Such predictive powers should be the stuff of the next thing after quantum computing.."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 2044, "user_id": 1258491, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/yyvEu.png?s=128&g=1", "display_name": "metaleap", "link": "https://stackoverflow.com/users/1258491/metaleap"}, "edited": false, "score": 1, "creation_date": 1480863380, "post_id": 40959805, "comment_id": 69129021, "body": "@metaleap, then the bad news for you is it doesn&#39;t work for string literals, which have a special desugaring to save space."}, {"owner": {"reputation": 2044, "user_id": 1258491, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/yyvEu.png?s=128&g=1", "display_name": "metaleap", "link": "https://stackoverflow.com/users/1258491/metaleap"}, "edited": false, "score": 0, "creation_date": 1480864014, "post_id": 40959805, "comment_id": 69129186, "body": "Crikey.. well good to know. Can&#39;t believe GHC-output code recurses through a constant &quot;string&quot; (aka sugar-literal) (that&#39;s hopefully being put in the DATA section of the assembled binary code) to hit the processor with +1 whenever I pass a constant-desugared-from-a-literal to length directly or indirectly..  Now don&#39;t tell me constant strings generate runtime code akin to &#39;h&#39;:[&#39;e&#39;:[&#39;l&#39;:[&#39;l&#39;:[&#39;o&#39;]]]]  Wonder why the new 8.0.1 optimization isn&#39;t timed to occur <i>after</i> desugaring of &quot;hello&quot; into [&#39;h&#39;,&#39;e&#39;,&#39;l&#39;,&#39;l&#39;,&#39;o&#39;] (or whatever is done there)"}, {"owner": {"reputation": 2044, "user_id": 1258491, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/yyvEu.png?s=128&g=1", "display_name": "metaleap", "link": "https://stackoverflow.com/users/1258491/metaleap"}, "edited": false, "score": 0, "creation_date": 1480864476, "post_id": 40959805, "comment_id": 69129330, "body": "So that means internally there&#39;s a whole different implementation (in final binary) of length just for constants-desugared-specially-from-string-literals?"}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 8, "last_activity_date": 1480864389, "last_edit_date": 1480864389, "creation_date": 1480862775, "answer_id": 40959805, "question_id": 40959497, "link": "https://stackoverflow.com/questions/40959497/are-length-calls-rewritten-as-constant-ints-by-ghc/40959805#40959805", "title": "Are &#39;length&#39; calls rewritten as constant ints by GHC?", "body": "<p>I believe the question is asking whether GHC turns, for example, <code>length [1,2,3]</code> into <code>3</code> at compile time. GHC 8.0.1 is the first version of GHC to do this optimization (at least among the versions I have installed).</p>\n\n<p>Now, let's turn to the second part of your question. Let's take the date of the first beta release of GHC from Wikipedia as the beginning date of GHC: April 1, 1991. GHC 8.0.1 was released in May of 2016. So, it appears that your theory that this is an optimization that characterizes 25+ year-old compiler projects is validated in this case.</p>\n"}], "owner": {"reputation": 2044, "user_id": 1258491, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/yyvEu.png?s=128&g=1", "display_name": "metaleap", "link": "https://stackoverflow.com/users/1258491/metaleap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 40959805, "answer_count": 2, "score": 1, "last_activity_date": 1480864389, "creation_date": 1480860843, "question_id": 40959497, "link": "https://stackoverflow.com/questions/40959497/are-length-calls-rewritten-as-constant-ints-by-ghc", "title": "Are &#39;length&#39; calls rewritten as constant ints by GHC?", "body": "<p>Just a random pondering looking at my numerous <code>length</code> calls, it occurs to me that surely the compiler can tell the length of <em>any</em> list thanks to immutability and referential transparency (even when new lists are <code>concat</code>-ed from existing known lists / code paths). Then it will likely replace all <code>length l</code> \"calls\" with the <em>actual</em> int constant at some stage during low-level code generation, right?</p>\n\n<p>Wondering if it indeed does, or whether I'm missing something in my beginner intuition about pure functional languages/compiler.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1480850571, "post_id": 40957926, "comment_id": 69125353, "body": "You probably need to enable some kind of extension like <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Records/OverloadedRecordFields/DuplicateRecordFields\" rel=\"nofollow noreferrer\">DuplicateRecordFields</a>"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480850591, "post_id": 40957926, "comment_id": 69125360, "body": "Add <code>{-# LANGUAGE DuplicateRecordFields #-}</code> to the top of your file."}, {"owner": {"reputation": 363, "user_id": 7215196, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/059a3d6c709a96418c8517fb23fcd668?s=128&d=identicon&r=PG&f=1", "display_name": "Kooooro", "link": "https://stackoverflow.com/users/7215196/kooooro"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1480850618, "post_id": 40957926, "comment_id": 69125368, "body": "@n.m., but hasn&#39;t that been embedded into the language or compiler  since ghc 8.0 with no extensions needed?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1480850719, "post_id": 40957926, "comment_id": 69125394, "body": "No, I don&#39;t think it was ever in the plans."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1480851165, "post_id": 40957926, "comment_id": 69125512, "body": "Furtunately not! I consider <code>DuplicateRecordFields</code> a step in the wrong direction, clobbering the language&#39;s simplicity to solve a problem that <a href=\"https://nikita-volkov.github.io/record/\" rel=\"nofollow noreferrer\">can better be adressed on the library level</a>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1480851989, "post_id": 40957926, "comment_id": 69125766, "body": "@leftaroundabout I agree, but I can&#39;t help wishing GHC would generate Van Laarhoven lenses from records instead of projection functions."}], "owner": {"reputation": 363, "user_id": 7215196, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/059a3d6c709a96418c8517fb23fcd668?s=128&d=identicon&r=PG&f=1", "display_name": "Kooooro", "link": "https://stackoverflow.com/users/7215196/kooooro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480849855, "creation_date": 1480849508, "last_edit_date": 1480849855, "question_id": 40957926, "link": "https://stackoverflow.com/questions/40957926/ghc-8-and-still-the-error-multiple-declarations-of-mydatafield123", "title": "GHC 8 and still the error &quot;Multiple declarations of myDataField123&quot;", "body": "<p>I have 2 data's with the fields named the same:</p>\n\n<pre><code>data Data1 = Data1 { var1 :: String }\ndata Data2 = Data2 { var1 :: String }\n</code></pre>\n\n<p>Also in my 'stack.yaml' I have this:</p>\n\n<pre><code>resolver: lts-7.11\n</code></pre>\n\n<p>which makes it to use GHC 8.01 which must  deal with this issue. However, it still doesn't and the error is:</p>\n\n<pre><code> Multiple declarations of \u2018var1'\u2019\n</code></pre>\n"}, {"tags": ["haskell", "primes"], "comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1480853750, "post_id": 40957681, "comment_id": 69126232, "body": "Your description must be wrong, for, the only qualifying intervals are [] and <code>[4..4]</code> since in all the others there is at least one odd number. Hence, a short version of what you describe would be <code>g = (&lt;=4)</code>"}, {"owner": {"reputation": 279, "user_id": 4132944, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a7cf551c6c4126e231165cfbd254534?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Karmanovas", "link": "https://stackoverflow.com/users/4132944/lukas-karmanovas"}, "reply_to_user": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1480854475, "post_id": 40957681, "comment_id": 69126434, "body": "I don&#39;t get it how can that be. If I would enter <code>n=8</code> I should have a list <code>[4,6,8]</code> and it should return True."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 1, "creation_date": 1480856138, "post_id": 40957681, "comment_id": 69126900, "body": "Yes, you actually don&#39;t construct the interval <code>[4..n]</code> in your code. In the description, what you really mean is <code>[4,6 .. n]</code>"}, {"owner": {"reputation": 279, "user_id": 4132944, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a7cf551c6c4126e231165cfbd254534?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Karmanovas", "link": "https://stackoverflow.com/users/4132944/lukas-karmanovas"}, "reply_to_user": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1480861311, "post_id": 40957681, "comment_id": 69128438, "body": "So how should i change it so that it would be correct?"}], "answers": [{"comments": [{"owner": {"reputation": 279, "user_id": 4132944, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a7cf551c6c4126e231165cfbd254534?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Karmanovas", "link": "https://stackoverflow.com/users/4132944/lukas-karmanovas"}, "edited": false, "score": 0, "creation_date": 1480853232, "post_id": 40958313, "comment_id": 69126109, "body": "Yes I think that is something that I would need, but could you tell me how should I use it, I can&#39;t just simply replace my third line with yours or can I?"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 279, "user_id": 4132944, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a7cf551c6c4126e231165cfbd254534?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Karmanovas", "link": "https://stackoverflow.com/users/4132944/lukas-karmanovas"}, "edited": false, "score": 0, "creation_date": 1480861764, "post_id": 40958313, "comment_id": 69128550, "body": "I think you can, although I haven&#39;t tested it. The let ... in clause is the condition, and the single &quot;=&quot; is the value for that condition. Oh, and I forgot the leading &quot;|&quot;. I&#39;ll edit that in."}, {"owner": {"reputation": 279, "user_id": 4132944, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a7cf551c6c4126e231165cfbd254534?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Karmanovas", "link": "https://stackoverflow.com/users/4132944/lukas-karmanovas"}, "edited": false, "score": 0, "creation_date": 1480862112, "post_id": 40958313, "comment_id": 69128659, "body": "Yeah but the problem is I am getting an error, that goldbatch is getting to few arguments"}, {"owner": {"reputation": 279, "user_id": 4132944, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a7cf551c6c4126e231165cfbd254534?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Karmanovas", "link": "https://stackoverflow.com/users/4132944/lukas-karmanovas"}, "edited": false, "score": 0, "creation_date": 1480862337, "post_id": 40958313, "comment_id": 69128726, "body": "Yeah never mind it just needed <code>n</code> after <code>goldbatch2</code>"}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": true, "score": 1, "last_activity_date": 1480862404, "last_edit_date": 1480862404, "creation_date": 1480852254, "answer_id": 40958313, "question_id": 40957681, "link": "https://stackoverflow.com/questions/40957681/goldbach-function-for-list-of-even-numbers-4-n/40958313#40958313", "title": "Goldbach function for list of even numbers [4..n]", "body": "<p>If I understand it correctly, you want something like:</p>\n\n<pre><code> | let (n1, n2) = goldbach2 n in n == n1 + n2   =  goldbach (n-2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 0, "last_activity_date": 1480856219, "last_edit_date": 1480856219, "creation_date": 1480854134, "answer_id": 40958566, "question_id": 40957681, "link": "https://stackoverflow.com/questions/40957681/goldbach-function-for-list-of-even-numbers-4-n/40958566#40958566", "title": "Goldbach function for list of even numbers [4..n]", "body": "<p>I would write this like</p>\n\n<pre><code>goldbachInterval n = all goldbach [4,6 .. n]\n   where\n       goldbach k = .... -- property of being a golbach number\n</code></pre>\n"}], "owner": {"reputation": 279, "user_id": 4132944, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a7cf551c6c4126e231165cfbd254534?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Karmanovas", "link": "https://stackoverflow.com/users/4132944/lukas-karmanovas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 40958313, "answer_count": 2, "score": 1, "last_activity_date": 1513261428, "creation_date": 1480847561, "question_id": 40957681, "link": "https://stackoverflow.com/questions/40957681/goldbach-function-for-list-of-even-numbers-4-n", "title": "Goldbach function for list of even numbers [4..n]", "body": "<p>Hello I am trying to make a function <code>goldbach :: Integer -&gt; Bool</code> for interval <code>[4..n]</code> that should return <code>True</code> only if all elements in that interval is even and can be summed from two prim numbers. So far I have done this.</p>\n\n<pre><code>goldbach::Integer-&gt;Bool\ngoldbach n \n    |goldbach2 n == ??? = goldbach (n-2)\n    |n==4 = True\n    |otherwise = False\n\ngoldbach2 :: Integer -&gt; (Integer, Integer)\ngoldbach2 a = head $\n                 filter (\\(x,y) -&gt; isPrime x &amp;&amp; isPrime y) $\n                 map (\\e -&gt; (e, a - e)) [3,5..a `div` 2]\nwhere\nfactors a = filter (isFactor a) [2..a-1]\nisFactor a b = a `mod` b == 0\nisPrime a = null $ factors a\n</code></pre>\n\n<p>Function <code>golbach2</code> result looks like this <code>goldbac2 28 = (5, 23)</code>. How should I chek in my 3rd line <code>goldbach2 n == ??? = goldbach (n-2)</code> if result of <code>goldbach2 n</code> is correct and gives me two prim numbers?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 4, "last_activity_date": 1480850631, "last_edit_date": 1480850631, "creation_date": 1480847283, "answer_id": 40957649, "question_id": 40957563, "link": "https://stackoverflow.com/questions/40957563/haskell-map-a-given-function-over-the-elements-at-the-leaves-of-a-gtree/40957649#40957649", "title": "Haskell map a given function over the elements at the leaves of a GTree", "body": "<p>You're almost there! You've forgotten to handle the case where there's more than one element in the list of subtrees. The pattern <code>[x]</code> stands for a <em>single-element</em> list.</p>\n\n<p>I'm going to match an arbitrarily long (or short) list of subtrees <code>ts</code> and then use <code>map</code> to apply a recursive call to each of them.</p>\n\n<pre><code>mapTree :: (a -&gt; b) -&gt; GTree a -&gt; GTree b\nmapTree f (Gnode ts) = Gnode (map (mapTree f) ts)\nmapTree f (Leaf x) = Leaf (f x)\n</code></pre>\n\n<p>NB. I know this is an exercise, but in production code I'd ask GHC to write this function for me using the <code>DeriveFunctor</code> language extension.</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n\ndata GTree a = Leaf a | Gnode [GTree a] deriving Functor\n\nmapTree :: (a -&gt; b) -&gt; GTree a -&gt; GTree b\nmapTree = fmap\n</code></pre>\n"}], "owner": {"reputation": 1436, "user_id": 3633116, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/776562355754015/picture?type=large", "display_name": "Nikas \u017dalias", "link": "https://stackoverflow.com/users/3633116/nikas-%c5%bdalias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 40957649, "answer_count": 1, "score": 0, "last_activity_date": 1480850631, "creation_date": 1480846741, "question_id": 40957563, "link": "https://stackoverflow.com/questions/40957563/haskell-map-a-given-function-over-the-elements-at-the-leaves-of-a-gtree", "title": "Haskell map a given function over the elements at the leaves of a GTree", "body": "<p>I got a data structure: </p>\n\n<pre><code>data GTree a = Leaf a | Gnode [GTree a]\n</code></pre>\n\n<p>and an example of this map function for different data structure:</p>\n\n<pre><code>data Tree a = Nil | Node a (Tree a) (Tree a) deriving (Eq,Ord,Show,Read)\n\nmapTree :: (a-&gt; b) -&gt; Tree a -&gt; Tree b\nmapTree Nil = Nil\nmapTree f (Node x t1 t2) = Node (f x) (mapTree f t1) (mapTree f t2)\n</code></pre>\n\n<p>I need to write this function for my GTree data structure, but I can't make it.. For now I have this kind of function:</p>\n\n<pre><code>mapTree :: (a -&gt; b) -&gt; GTree a -&gt; GTree b\nmapTree f (Gnode [a]) = Gnode [mapTree f a]\nmapTree f (Leaf a) = Leaf f\n</code></pre>\n\n<p>Can someone please help me finish it? Or at least explain me how to implement..</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1480813303, "post_id": 40954143, "comment_id": 69118214, "body": "It is not all that satisfactory, but you can temporarily change the script so that it uses <code>exec -- ghc</code> on its own. Within the magic comment, replace <code>runghc</code> with <code>exec</code> and add <code>-- ghc</code> plus whatever options you want to pass to GHC at the end (I&#39;m mentioning these obvious-sounding details because Stack is rather picky about the order of the options)."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1480900746, "post_id": 40954143, "comment_id": 69141121, "body": "Thanks, that gave me an idea to use the cpp preprocessor, something like #ifdef GHCI     exec #else     runghc #endif But this naturally failed because it needs to finish reading this section to run this..."}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1480812709, "creation_date": 1480811839, "last_edit_date": 1480812709, "question_id": 40954143, "link": "https://stackoverflow.com/questions/40954143/force-haskell-stack-build-to-use-the-resolver-specified-after-shebang", "title": "Force Haskell Stack build to use the Resolver Specified after Shebang", "body": "<p>I'm trying to use haskell for scripting in the pattern specified here on the \"Script interpreter\" section:</p>\n\n<blockquote>\n  <p><a href=\"https://haskell-lang.org/tutorial/stack-script\" rel=\"nofollow noreferrer\">https://haskell-lang.org/tutorial/stack-script</a></p>\n</blockquote>\n\n<p>When I have comments like this in my script after the shebang:</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack\n    --resolver nightly-2016-11-26\n    --install-ghc\n    runghc\n    --package http-conduit\n-}\n{-# LANGUAGE OverloadedStrings #-}\n</code></pre>\n\n<p>I know I can safely say run:</p>\n\n<pre><code>$ stack myfile.hs\n</code></pre>\n\n<p>And it correctly picks up the resolver version I specified I need.</p>\n\n<p>However, if I also try to build my script, to have the best of both worlds in scripting for development while I figure things out, and compilation once I'm more sure...</p>\n\n<pre><code>username@myhost:~/$ stack exec -- ghc myfile.hs &amp;&amp; ./myfile\nRun from outside a project, using implicit global project config\nUsing resolver: lts-7.10 from implicit global project's config file: /home/username/.stack/global-project/stack.yaml\n</code></pre>\n\n<p>That will error out because it's using resolver 'lts-7.10' from my global config instead of 'nightly-2016-11-26' even though my comments after the shebang specify a specific, non-global resolver to use.</p>\n\n<p>While I know I could run ghc above and explicitly call --resolver on the command line, I would prefer if this were picked up from what's within the file itself.  Is this possible?</p>\n"}, {"tags": ["haskell", "conduit", "http-conduit"], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1480807730, "post_id": 40953620, "comment_id": 69117070, "body": "<a href=\"https://www.stackage.org/lts-7.11/hoogle?q=.%7C\" rel=\"nofollow noreferrer\">Stackage Hoogle</a> is also a nice option -- it defaults to a broader range of packages than the haskell.org one."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 1, "creation_date": 1480809014, "post_id": 40953620, "comment_id": 69117357, "body": "Thanks, @Alec.  If you&#39;ll continue to indulge me, I propose we continue these until our stackoverflow Q&amp;A sessions overcome all of the obsoleted and deprecated syntaxes and strategies in older versions and implementations available elsewhere on the internet, and these become top hits to direct people canonically to the correct documentation.  :)"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1480809266, "post_id": 40953620, "comment_id": 69117404, "body": "seems like they&#39;d be better calling the operator &quot;pipe&quot; :/"}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 2, "creation_date": 1480812039, "post_id": 40953620, "comment_id": 69118007, "body": "Hmm, off to a good start: after one hour, this is now already the top google result for &quot;dot pipe haskell&quot; a phrase I&#39;ve now written an additional time so folks will be properly redirected to Michael Snoyman&#39;s announcement of this syntax linked to in this answer."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 9, "last_activity_date": 1480810596, "last_edit_date": 1480810596, "creation_date": 1480807285, "answer_id": 40953620, "question_id": 40953587, "link": "https://stackoverflow.com/questions/40953587/what-is-the-dot-pipe-operator-in-haskell/40953620#40953620", "title": "What is the dot pipe &quot;.|&quot; operator in Haskell?", "body": "<p>This is just the (recent) new syntax that <code>conduit</code> uses for fusion. The author wrote a <a href=\"http://www.snoyman.com/blog/2016/09/proposed-conduit-reskin\" rel=\"nofollow noreferrer\">blog-post</a> about this not long ago. To quote from the post, he proposed (and eventually did this) to</p>\n\n<blockquote>\n  <p>Replace the <code>$=</code>, <code>=$</code>, and <code>=$=</code> operators - which are all synonyms of each\n  other - with the <code>.|</code> operator. This borrows intuition from the Unix\n  shell, where the pipe operator denotes piping data from one process to\n  another. The analogy holds really well for conduit, so why not borrow\n  it? (We call all of these operators \"fusion.\")</p>\n</blockquote>\n\n<p>As an aside, if you ever need to look up operators, <a href=\"http://hayoo.fh-wedel.de/?query=.%7C\" rel=\"nofollow noreferrer\">Hayoo</a> and <a href=\"https://www.haskell.org/hoogle/?hoogle=.%7C\" rel=\"nofollow noreferrer\">Hoogle</a>  are the places to go. There is also <a href=\"https://www.stackage.org/lts-7.11/hoogle?q=.%7C\" rel=\"nofollow noreferrer\">Stackage Hoogle</a> (thanks @duplode) which lets you look up operators for particular resolvers (which is especially useful here since this is a recent change).</p>\n"}, {"tags": [], "owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1480810080, "last_edit_date": 1480810080, "creation_date": 1480809731, "answer_id": 40953926, "question_id": 40953587, "link": "https://stackoverflow.com/questions/40953587/what-is-the-dot-pipe-operator-in-haskell/40953926#40953926", "title": "What is the dot pipe &quot;.|&quot; operator in Haskell?", "body": "<p><code>.|</code> is introduced by the <a href=\"https://github.com/snoyberg/conduit\" rel=\"nofollow noreferrer\">Conduit</a> library and is a synonym to <code>fuse</code>.</p>\n\n<pre><code>fuse\n  :: Monad m =&gt; Conduit a m b -&gt; ConduitM b c m r -&gt; ConduitM a c m r\n</code></pre>\n\n<p><code>fuse</code> is used for composition of <code>conduit</code>s the same way as <code>.</code> operator is used for composition of functions. \nFinally, <code>.|</code> is a new syntax to replace <code>$=</code>, <code>=$</code>, and <code>=$=</code>, which were synonyms anyway.</p>\n"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1303, "favorite_count": 0, "accepted_answer_id": 40953620, "answer_count": 2, "score": 6, "last_activity_date": 1480810596, "creation_date": 1480807038, "last_edit_date": 1495542354, "question_id": 40953587, "link": "https://stackoverflow.com/questions/40953587/what-is-the-dot-pipe-operator-in-haskell", "title": "What is the dot pipe &quot;.|&quot; operator in Haskell?", "body": "<p>I understand \".\" (dot) as function composition.  I understand \"|\" (pipe) as \"or,\" guard introduction syntax (from <a href=\"https://wiki.haskell.org/Keywords#.7C\" rel=\"nofollow noreferrer\">here</a>  ), but I <a href=\"https://stackoverflow.com/questions/40836795/haskell-streaming-download\">saw an answer on http-conduits using \".|\"</a> that makes use of this operator in a way I do not understand.</p>\n\n<p>The other references for conduits I have found, such as:</p>\n\n<ul>\n<li><a href=\"https://docs.google.com/presentation/d/1RBefOCZ7AKOo4f1yiF4mtKPAT3l5vY9ky2SR02O4Vvg/edit#slide=id.g3c22e35a9_0205\" rel=\"nofollow noreferrer\">https://docs.google.com/presentation/d/1RBefOCZ7AKOo4f1yiF4mtKPAT3l5vY9ky2SR02O4Vvg/edit#slide=id.g3c22e35a9_0205</a></li>\n<li><a href=\"http://www.yesodweb.com/blog/2014/03/network-conduit-async\" rel=\"nofollow noreferrer\">http://www.yesodweb.com/blog/2014/03/network-conduit-async</a></li>\n</ul>\n\n<p>...suggest syntax like \"$$\", \"$=\", \"=$=\", \"=$\" for combining conduits in data flows.</p>\n\n<p>What should I call this \".|\" this operator and how does it work?</p>\n\n<p>Predictably, googling for \".| haskell\" or \"'dot pipe' haskell\" or \"'dot pipe' haskell operator conduits\" were not very successful.</p>\n"}, {"tags": ["haskell", "generics"], "comments": [{"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1480799457, "post_id": 40952481, "comment_id": 69114822, "body": "What do you think about lens (<a href=\"http://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\">for example</a>)?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1480800571, "post_id": 40952481, "comment_id": 69115152, "body": "Tangential note: Why do you need address fields with <code>String</code> and <code>Maybe String</code> types? You would probably do better by settling on a single <code>Address</code> type with the appropriate fields and then parsing strings into addresses as necessary. Also, it feels strange to have an address type like <code>PersonSteetAddress2</code> in which all fields can be <code>Nothing</code> (except, perhaps, if you are using it to make sense of data extracted from some cranky database with ill-specified fields)."}], "answers": [{"comments": [{"owner": {"reputation": 815, "user_id": 245743, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/11a87619d08da72466e99e16453ea318?s=128&d=identicon&r=PG", "display_name": "ppb", "link": "https://stackoverflow.com/users/245743/ppb"}, "edited": false, "score": 0, "creation_date": 1480861184, "post_id": 40953790, "comment_id": 69128394, "body": "Oh, wow, this is amazing :D I&#39;m still digesting all the details but it&#39;s exactly what I wanted. Thank you!"}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 5, "last_activity_date": 1480818566, "last_edit_date": 1480818566, "creation_date": 1480808621, "answer_id": 40953790, "question_id": 40952481, "link": "https://stackoverflow.com/questions/40952481/how-to-generically-traverse-nested-records-looking-for-specific-values-in-haskel/40953790#40953790", "title": "How to generically traverse nested records looking for specific values in Haskell?", "body": "<p><code>Generic</code> is the way to go for this. However, there are a couple ambiguities in your question still. I'll list these off, along with how I am assuming you want them addressed</p>\n\n<ul>\n<li>What is the type of a path in this case? I'm going to go with just <code>[String]</code> for now. Each <code>String</code> denotes either a constructor name or a field name. </li>\n<li>What happens if there is no field name? I'm going to record that as the field name <code>\"no-field-name\"</code> </li>\n<li>How deep should we go? For example, if you have a data constructor from another external module, should we search for <code>Nothing</code> fields there too? I'm going to make a type family which maps types to whether or not we should descend into the type.</li>\n</ul>\n\n<hr>\n\n<p>As this solution is a bit long, I've separated bits of it with paragraphs. \nWe'll start with a bunch of imports and pragmas and a class that contains our function <code>nothingFields</code>.</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric, TypeFamilies, FlexibleContexts, \n             MultiParamTypeClasses, TypeInType, FlexibleInstances,          \n             TypeOperators, ScopedTypeVariables, UndecidableInstances \n  #-}\nimport GHC.Generics\nimport GHC.TypeLits\nimport Data.Proxy\n\n-- List of constructor or field names to descend to the right field\ntype Field = [String]\n\nclass NothingFields a where\n  nothingFields :: a -&gt; [Field]\n</code></pre>\n\n<p>Next, we will make a type family that maps types to a boolean saying whether or not we want to dig deeper into the type to look for <code>Nothing</code> fields. The catch all default case (the last one) is to stop digging.</p>\n\n<pre><code> type family StopDigging a :: Bool where\n   StopDigging Person = False\n   StopDigging PersonAddress = False\n   StopDigging PersonAddressStreet2 = False\n   StopDigging [a] = StopDigging a\n   StopDigging (Maybe a) = StopDigging a\n   StopDigging a = True\n</code></pre>\n\n<p>Now, we want an instance of <code>NothingFields</code> and a helper class <code>NothingFields'</code> to branch on whether or not we have a type whose fields we should try to explore. Note this is a <a href=\"https://wiki.haskell.org/GHC/AdvancedOverlap#Solution_1_.28using_safer_overlapping_instances.29\" rel=\"nofollow noreferrer\">well-documented problem and there are tricks to solve it</a>.</p>\n\n<pre><code>-- This instance always matches because of its general instance head.\n-- It dispatches to the right version of `nothingFields'` based on\n-- whether  the `StopDigging` type family returns true or false.\ninstance (flag ~ StopDigging a, NothingFields' a flag) =&gt; NothingFields a where\n  nothingFields = nothingFields' (Proxy :: Proxy flag)\n\n-- Helper class whose instances' heads have different flags.\nclass NothingFields' a (flag :: Bool) where\n  nothingFields' :: proxy flag -&gt; a -&gt; [Field]\n\n-- Stop digging into fields\ninstance NothingFields' a True where\n  nothingFields' _ _ = []\n\n-- Continue digging into fields\ninstance (Generic a, GNothingFields' (Rep a)) =&gt; NothingFields' a False where\n   nothingFields' _ = gNothingFields . from\n</code></pre>\n\n<p>The last instance is where the generic programming begins. As is habitual, we'll make a <code>GNothingFields'</code> class for this. Filling in the instances for this is pretty simple in most cases.</p>\n\n<pre><code>-- Generic helper class corresponding to `NothingFields'`\nclass GNothingFields' f where\n  gNothingFields :: f a -&gt; [Field]\n\n-- constructors without arguments\ninstance GNothingFields' U1 where\n  gNothingFields U1 = []\n\n-- sum of constructors\ninstance (GNothingFields' f, GNothingFields' g) =&gt; GNothingFields' (f :+: g) where\n  gNothingFields (L1 x) = gNothingFields x\n  gNothingFields (R1 x) = gNothingFields x\n\n-- product; multiple fields\ninstance (GNothingFields' f, GNothingFields' g) =&gt; GNothingFields' (f :*: g) where\n  gNothingFields (x :*: y) = gNothingFields x ++ gNothingFields y\n</code></pre>\n\n<p>The remaining cases are: <code>M1</code> for metadata and <code>K1</code> for actual data in fields. Here is where the real tricks are going to happen. <code>M1</code> metadata is place around datatypes, constructors, and records. We want to keep track of only the last two:</p>\n\n<pre><code>-- The `D` tells us this is datatype metadata.\ninstance GNothingFields' f =&gt; GNothingFields' (M1 D t f) where\n  gNothingFields (M1 x) = gNothingFields x\n\n-- The `C` tells us this is constructor metadata, so we extract\n-- the constructor name using `symbolVal`.\ninstance (KnownSymbol constructor, GNothingFields' f) =&gt; GNothingFields' (M1 C ('MetaCons constructor a b) f) where\n  gNothingFields (M1 x) = (symbolVal (Proxy :: Proxy constructor) :) &lt;$&gt; gNothingFields x\n\n-- The `S` tells us this is record field metadata, but the `Nothing`\n-- tells us the field has no name.\ninstance (GNothingFields' f) =&gt; GNothingFields' (M1 S ('MetaSel ('Nothing) a b c) f) where\n  gNothingFields (M1 x) = (\"no field name\" :) &lt;$&gt; gNothingFields x\n\n-- The `S` tells us this is record field metadata, and the `Just`\n-- tells us the field has a name, so we extract that using `symbolVal`.\ninstance (KnownSymbol selector, GNothingFields' f) =&gt; GNothingFields' (M1 S ('MetaSel ('Just selector) a b c) f) where\n  gNothingFields (M1 x) = (symbolVal (Proxy :: Proxy selector) :) &lt;$&gt; gNothingFields x\n\n-- This represents an actual data field of type `Maybe`. Note we\n-- recurse using our initial `nothingFields` and not `gNothingFields`.\ninstance {-# OVERLAPPING  #-} (NothingFields a) =&gt; GNothingFields' (K1 i (Maybe a)) where\n  gNothingFields (K1 Nothing) = [[]]\n  gNothingFields (K1 (Just x)) = nothingFields x\n\n-- This represents an actual data field of type _not_ `Maybe`. Note we\n-- recurse using our initial `nothingFields` and not `gNothingFields`.\ninstance (NothingFields a) =&gt; GNothingFields' (K1 i a) where\n  gNothingFields (K1 x) = nothingFields x\n</code></pre>\n\n<hr>\n\n<p>Now, to try this out:</p>\n\n<pre><code>ghci&gt; nothingFields (Person \"name\" Nothing)\n[[\"Person\",\"personAddress\"]] \nghci&gt; nothingFields (Person \"name\" (Just (PersonAddress \"addr\" Nothing Nothing)))\n[[\"Person\",\"personAddress\",\"PersonAddress\",\"personAddressStreet1\"],\n [\"Person\",\"personAddress\",\"PersonAddress\",\"personAddressStreet2\"]]\nghci&gt; nothingFields (Person \"name\" (Just (PersonAddress \"addr\" (Just \"street1\") Nothing)))\n[[\"Person\",\"personAddress\",\"PersonAddress\",\"personAddressStreet2\"]]\nghci&gt; nothingFields (Person \"name\" (Just (PersonAddress \"addr\" Nothing (Just (PersonAddressStreet2 Nothing Nothing)))))\n[[\"Person\",\"personAddress\",\"PersonAddress\",\"personAddressStreet1\"],\n [\"Person\",\"personAddress\",\"PersonAddress\",\"personAddressStreet2\",\"PersonAddressStreet2\",\"personAddress2StreetStreet\"],     \n [\"Person\",\"personAddress\",\"PersonAddress\",\"personAddressStreet2\",\"PersonAddressStreet2\",\"personAddress2StreetNumber\"]]\n</code></pre>\n\n<h2>Disclaimer</h2>\n\n<p>This was fun to implement but are you sure this is <em>really</em> what you want? Past being a debugging tool, I'm not sure this really has much utility... Anyways - enjoy!</p>\n"}], "owner": {"reputation": 815, "user_id": 245743, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/11a87619d08da72466e99e16453ea318?s=128&d=identicon&r=PG", "display_name": "ppb", "link": "https://stackoverflow.com/users/245743/ppb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "accepted_answer_id": 40953790, "answer_count": 1, "score": 3, "last_activity_date": 1480818566, "creation_date": 1480799080, "question_id": 40952481, "link": "https://stackoverflow.com/questions/40952481/how-to-generically-traverse-nested-records-looking-for-specific-values-in-haskel", "title": "How to generically traverse nested records looking for specific values in Haskell?", "body": "<p>Assuming I have the following data types:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>data Person = Person\n  { personName :: String\n  , personAddress :: Maybe PersonAddress\n  }\n\ndata PersonAddress = PersonAddress\n  { personAddressStreet :: String\n  , personAddressStreet1 :: Maybe String\n  , personAddressStreet2 :: Maybe PersonAddressStreet2\n  }\n\ndata PersonAddressStreet2 = PersonAddressStreet2\n  { personAddress2StreetStreet :: Maybe String\n  , personAddress2StreetNumber :: Maybe Int\n  }\n</code></pre>\n\n<p>is there a way to walk a value of <code>Person</code> type in a generic way and report which specific fields have a value of <code>Nothing</code>?</p>\n\n<p>Ideally I would like to see a full path of where in the nested structure that value was found (for example <code>(Person) personAddress -&gt; (PersonAddress) personAddressStreet1</code>)</p>\n\n<p>I looked at Typeable / Generic machinery and while it seems to be related to what I'm trying to do it isn't quite clear how I could utilise those here.</p>\n\n<p>Any suggestions or pointers would be gladly received.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1480792613, "post_id": 40951494, "comment_id": 69112656, "body": "What error do you get?"}, {"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 1, "creation_date": 1480793115, "post_id": 40951494, "comment_id": 69112829, "body": "I think the article is not showing all imports. Conduit imports, at least, are missing."}, {"owner": {"reputation": 15, "user_id": 7246051, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SuOtza1jOms/AAAAAAAAAAI/AAAAAAAAAFA/ueHkgW9-ZHM/photo.jpg?sz=128", "display_name": "Shreya Chakrabarti", "link": "https://stackoverflow.com/users/7246051/shreya-chakrabarti"}, "edited": false, "score": 0, "creation_date": 1480793989, "post_id": 40951494, "comment_id": 69113116, "body": "Posted the error now.....I don&#39;t know how to use &quot;-v&quot; indicated too....yes the tutorial is kind of incomplete........"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1480794097, "post_id": 40951494, "comment_id": 69113152, "body": "It seems you are supposed to use this program with the <a href=\"https://github.com/chrisdone/labels/blob/master/labels-explore/src/Labels/Explore.hs\" rel=\"nofollow noreferrer\"><code>Labels.Explore</code></a> module in the GitHub repository mentioned in the tutorial (@Jean-BaptistePotonnier : that module reexports the relevant <i>conduit</i> stuff). I have no idea why the snippet in the tutorial uses <code>import Labels.RunResourceT</code> rather than <code>import Labels.Explore</code>."}, {"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1480794641, "post_id": 40951494, "comment_id": 69113319, "body": "yeah @dulpode, I&#39;ve just noticed it. Maybe the best way is to check out <a href=\"https://github.com/chrisdone/labels/tree/master/labels-explore\" rel=\"nofollow noreferrer\">github.com/chrisdone/labels/tree/master/labels-explore</a> and compile with cabal. I think tutorials should be more beginner friendly, and explain how to run the example. I suffered from this before, and particularly from people using only unqualified imports !"}, {"owner": {"reputation": 15, "user_id": 7246051, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SuOtza1jOms/AAAAAAAAAAI/AAAAAAAAAFA/ueHkgW9-ZHM/photo.jpg?sz=128", "display_name": "Shreya Chakrabarti", "link": "https://stackoverflow.com/users/7246051/shreya-chakrabarti"}, "edited": false, "score": 0, "creation_date": 1480794665, "post_id": 40951494, "comment_id": 69113325, "body": "Done......does not work tried copy pasting the entire github code too....does not work......pasted everything ...."}, {"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1480795944, "post_id": 40951494, "comment_id": 69113728, "body": "Maybe you can try to check out <a href=\"https://github.com/chrisdone/labels\" rel=\"nofollow noreferrer\">github.com/chrisdone/labels</a> and compile with stack."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1480797114, "post_id": 40951494, "comment_id": 69114083, "body": "Note that this is actually a really quite advanced application, involving cutting-edge compiler extensions and rather heavyweight libraries. Not necessarily a good place for starting with a programming language like Haskell..."}, {"owner": {"reputation": 5668, "user_id": 89574, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fed2705cf484a7ffbc3d44a742b686e5?s=128&d=identicon&r=PG", "display_name": "Christopher Done", "link": "https://stackoverflow.com/users/89574/christopher-done"}, "edited": false, "score": 0, "creation_date": 1480887707, "post_id": 40951494, "comment_id": 69137351, "body": "I fixed the tutorial content, thanks! @ShreyaChakrabarti Try cloning git@github.com:chrisdone/labels.git and run <code>stack build</code>. This file <a href=\"https://github.com/chrisdone/labels/blob/master/labels-explore/app/Main.hs\" rel=\"nofollow noreferrer\">github.com/chrisdone/labels/blob/master/labels-explore/app/&hellip;</a> you can edit to play around."}], "owner": {"reputation": 15, "user_id": 7246051, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SuOtza1jOms/AAAAAAAAAAI/AAAAAAAAAFA/ueHkgW9-ZHM/photo.jpg?sz=128", "display_name": "Shreya Chakrabarti", "link": "https://stackoverflow.com/users/7246051/shreya-chakrabarti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1480795345, "creation_date": 1480792383, "last_edit_date": 1480795345, "question_id": 40951494, "link": "https://stackoverflow.com/questions/40951494/trying-to-run-a-code-in-haskell-errors", "title": "Trying to run a code in Haskell ..errors", "body": "<p>I am a newb at haskell and I am trying to run the code for data mining in haskell from <a href=\"https://www.fpcomplete.com/blog/2016/09/data-haskell\" rel=\"nofollow noreferrer\">https://www.fpcomplete.com/blog/2016/09/data-haskell</a> \nBut it does not work at all.... I even tried the below code with these imports\n<code>import Control.Monad.Except</code>\n<code>import Control.Monad.State</code>,\nstill does not work.</p>\n\n<pre><code>{-# LANGUAGE TypeApplications, OverloadedStrings, OverloadedLabels,\n  TypeOperators, DataKinds, FlexibleContexts #-}\nimport Labels.RunResourceT\n\nmain =\n runResourceT $\n httpSource \"http://chrisdone.com/ontime.csv.zip\" responseBody .|\n zipEntryConduit \"ontime.csv\" .|\n fromCsvConduit\n   @(\"fl_date\" := Day, \"tail_num\" := String)\n   (set #downcase True csv) .|\n dropConduit 10 .|\n takeConduit 5 .&gt;\n tableSink\n</code></pre>\n\n<p>This is the error</p>\n\n<pre><code>Prelude&gt; :l haskell-tut\n[1 of 1] Compiling Main             ( haskell-tut.hs, interpreted )\n\nhaskell-tut.hs:3:1: error:\n    Failed to load interface for `Labels.RunResourceT'\n    Use -v to see a list of the files searched for.\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I would appreciate if any of you can provide the imports or modules to be used and even how to use it too!\nI even tried:</p>\n\n<pre><code>import Control.Monad.Except \nimport Control.Monad.State\n</code></pre>\n\n<p>still errors\ntried this:</p>\n\n<pre><code>{-# LANGUAGE TypeApplications, OverloadedStrings, OverloadedLabels, TypeOperators, DataKinds, FlexibleContexts #-}\n\nimport Labels.Explore\n\nmain =\n runResourceT $\n httpSource \"http://chrisdone.com/ontime.csv.zip\" responseBody .|\n zipEntryConduit \"ontime.csv\" .|\n fromCsvConduit\n   @(\"fl_date\" := Day, \"tail_num\" := String)\n   (set #downcase True csv) .|\n dropConduit 10 .|\n takeConduit 5 .&gt;\n tableSink\n</code></pre>\n\n<p>as suggested in the Github Repository does not work!\nError is :</p>\n\n<pre><code>Prelude&gt; :load haskell-tut\n[1 of 1] Compiling Main             ( haskell-tut.hs, interpreted )\n\nhaskell-tut.hs:3:1: error:\n    Failed to load interface for `Labels.Explore'\n    Use -v to see a list of the files searched for.\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Tried the entire Github Code:</p>\n\n<pre><code>{-# LANGUAGE TypeApplications, OverloadedStrings, OverloadedLabels,\n  TypeOperators, DataKinds, FlexibleContexts #-}\n\nimport Labels.Explore\n\nmoo1 :: IO ()\nmoo1 =\n  runResourceT $\n  httpSource \"http://chrisdone.com/ontime.csv.zip\" responseBody .|\n  zipEntryConduit \"ontime.csv\" .|\n  fromCsvConduit\n    @(\"fl_date\" := Day, \"tail_num\" := String)\n    (set #downcase True csv) .|\n  dropConduit 10 .|\n  takeConduit 5 .&gt;\n  tableSink\n\nmoo_write :: IO ()\nmoo_write =\n  runResourceT\n    (httpSource \"http://chrisdone.com/ontime.csv.zip\" responseBody .|\n     zipEntryConduit \"ontime.csv\" .&gt;\n     fileSink \"ontime.csv\")\n\nmoo1_1 :: IO ()\nmoo1_1 =\n  runResourceT $\n  fileSource \"ontime.csv\" .|\n  fromCsvConduit\n    @(\"distance\" := Double)\n    (set #downcase True csv) .|\n  sinkConduit\n    (foldSink\n       (\\table row -&gt;\n          modify #flights (+ 1) (modify #distance (+ get #distance row) table))\n       (#flights := (0 :: Int), #distance := 0)) .&gt;\n  tableSink\n\nmoo2 :: IO ()\nmoo2 =\n  runResourceT $\n  fileSource \"ontime.csv\" .|\n  fromCsvConduit\n    @(\"fl_date\" := Day, \"tail_num\" := String, \"airline_id\" := Int, \"unique_carrier\" := String)\n    (set #downcase True csv) .|\n  groupConduit #airline_id .|\n  explodeConduit .|\n  projectConduit @(\"fl_date\" := _, \"unique_carrier\" := _) .|\n  takeConduit 5 .&gt;\n  tableSink\n\nmoo3 :: IO ()\nmoo3 =\n  runResourceT $\n  fileSource \"ontime.csv\" .|\n  fromCsvConduit\n    @(\"fl_date\" := Day, \"tail_num\" := String, \"airline_id\" := Int, \"unique_carrier\" := String)\n    (set #downcase True csv) .|\n  groupConduit #airline_id .|\n  explodeConduit .|\n  dropConduit 10 .|\n  projectConduit @(\"fl_date\" := _, \"tail_num\" := _) .|\n  takeConduit 5 .&gt;\n  tableSink\n\nmain = moo1_1\n</code></pre>\n\n<p>Still getting the below error!</p>\n\n<pre><code>Prelude&gt; :load haskell-tut\n[1 of 1] Compiling Main             ( haskell-tut.hs, interpreted )\n\nhaskell-tut.hs:4:1: error:\n    Failed to load interface for `Labels.Explore'\n    Use -v to see a list of the files searched for.\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Please help!</p>\n"}, {"tags": ["haskell", "modular-arithmetic"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1480790618, "post_id": 40950853, "comment_id": 69112061, "body": "Suggestions unrelated to your question: (1) You should use <code>foldl&#39;</code> (from <code>Data.List</code>) rather than <code>foldl</code>  in <code>toInt</code> -- cf. <a href=\"http://stackoverflow.com/q/384797/2751851\"><i>Implications of foldr vs. foldl (or foldl&#39;)</i></a>. (2) You might want to consider having <code>toInt :: String -&gt; Maybe Int</code>, so that you aren&#39;t forced to return nonsense if given an invalid string (e.g. <code>&quot;@#!&quot;</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1480791937, "post_id": 40951367, "comment_id": 69112455, "body": "my bikeshedding style preference would be to favor pattern matching over <code>==</code>, so a <code>case mod n 26 of ... r -&gt; ...</code>."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 2, "last_activity_date": 1480794309, "last_edit_date": 1480794309, "creation_date": 1480791465, "answer_id": 40951367, "question_id": 40950853, "link": "https://stackoverflow.com/questions/40950853/excel-column-to-int-and-vice-versa-improvements-sought/40951367#40951367", "title": "Excel column to Int and vice-versa - improvements sought", "body": "<p>Whenever you are building up a finite list recursively, think about <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:unfoldr\" rel=\"nofollow noreferrer\"><code>unfoldr :: (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]</code></a> from <code>Data.List</code> (although because it unfolds from the wrong direction, we end up needing to reverse the list too). The syntax extension <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#multi-way-if-expressions\" rel=\"nofollow noreferrer\"><code>MultiWayIf</code></a> also helps make things nicer.</p>\n\n<pre><code>{-# LANGUAGE MultiWayIf #-}\n\ntoCol :: Int -&gt; [Char]\ntoCol = reverse . unfoldr (\\n -&gt; let r = n `mod` 26 in\n          if | n == 0    -&gt; Nothing\n             | r == 0    -&gt; Just ('Z'         , n-1 `div` 26)\n             | otherwise -&gt; Just (chr (r + 64), n   `div` 26))\n</code></pre>\n\n<p>Note that this also makes <code>toCol</code> point-free. If you would prefer to not have an extension enabled and prefer to pattern match, you can also do that:</p>\n\n<pre><code>toCol :: Int -&gt; [Char]\ntoCol = reverse . unfoldr (\\n -&gt; case (n, n `mod` 26) of \n                                   (0, _) -&gt; Nothing\n                                   (n, 0) -&gt; Just ('Z'         , n-1 `div` 26)\n                                   (n, r) -&gt; Just (chr (r + 64), n   `div` 26))\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7245837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3465da16938bc01a6bcfa93e655643ea?s=128&d=identicon&r=PG&f=1", "display_name": "Foo", "link": "https://stackoverflow.com/users/7245837/foo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 40951367, "answer_count": 1, "score": 1, "last_activity_date": 1480794309, "creation_date": 1480788251, "last_edit_date": 1480790656, "question_id": 40950853, "link": "https://stackoverflow.com/questions/40950853/excel-column-to-int-and-vice-versa-improvements-sought", "title": "Excel column to Int and vice-versa - improvements sought", "body": "<p>In the code below, I am happy with the functionality i.e. the code produces the output that I expect. However, comparing the length of <strong>toCol</strong> to <strong>toInt</strong> - I am interested in knowing if you could offer something to trim it (i.e. <strong>toCol</strong> ) down. Many thanks!</p>\n\n<pre><code>-- given a spreadsheet column as a string\n-- returns integer giving the position of the column\n-- ex:\n-- toInt \"A\" = 1\n-- toInt \"XFD\" = 16384\ntoInt :: String -&gt; Int\ntoInt = foldl fn 0\n  where\n    fn = \\a c -&gt; 26*a + ((ord c)-64)\n\n-- given a integer returns\n-- the column to be found at that position as a [Char]\n-- ex:\n-- toCol 1 = \"A\"\n-- toCol 16384 = \"XFD\"\ntoCol :: Int -&gt; [Char]\ntoCol n = toCol' n []\n  where\n    toCol' 0 a = a\n    toCol' n a =\n      let r = mod n 26 in\n        case (r == 0) of\n          True -&gt; toCol' (div (n-1) 26) ('Z':a)\n          False -&gt; toCol' (div n 26) (chr(r + 64) : a)\n</code></pre>\n"}, {"tags": ["haskell", "latex"], "answers": [{"comments": [{"owner": {"reputation": 574, "user_id": 6262818, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0qG2x.png?s=128&g=1", "display_name": "Jack Parkinson", "link": "https://stackoverflow.com/users/6262818/jack-parkinson"}, "edited": false, "score": 0, "creation_date": 1480908611, "post_id": 40951132, "comment_id": 69142928, "body": "Thanks very much for such a clear and concise explanation - it makes perfect sense now. And thanks for going above and beyond by giving me extra advice about the <code>fromJust</code>"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1480789804, "creation_date": 1480789804, "answer_id": 40951132, "question_id": 40950840, "link": "https://stackoverflow.com/questions/40950840/map-function-doesnt-work-as-intended/40951132#40951132", "title": "Map Function Doesn&#39;t Work as Intended", "body": "<p><code>tableEntry (removedJusts !! 0)</code> works because it matches the return type of your <code>theBody</code> function (<code>LaTeXT_ m</code> or, expanding the type synonym, <code>LaTeXT m ()</code>). <code>map tableEntry removedJusts</code>, on the other hand, gives a <em>list</em> of <code>LaTeXT_ m</code>, leading to the type error you have seen. What you actually need here is <code>mapM_</code>, which, in addition to mapping, combines all resulting <code>LaTeXT m ()</code> computations in a single <code>LaTeXT m ()</code>:</p>\n\n<pre><code>GHCi&gt; :t mapM_\nmapM_ :: (Foldable t, Monad m) =&gt; (a -&gt; m b) -&gt; t a -&gt; m ()\n</code></pre>\n\n\n\n<pre><code>theBody :: Monad m =&gt; [ Maybe (String, String)] -&gt; LaTeXT_ m\ntheBody listOfEntries = do\n  maketitle\n  center $ tabular Nothing [RightColumn, VerticalLine, LeftColumn] $ do\n    textbf \"Name\" &amp; textbf \"Tel\"\n    let removedJusts = map fromJust listOfEntries\n    mapM_ tableEntry removedJusts\n</code></pre>\n\n<p>P.S.: A closely related function that you will eventually find useful is <code>traverse</code>. Unlike <code>mapM_</code>, <code>traverse</code> collects, rather than discards, the results of each computation. (Here I used <code>mapM_</code> becuase you do want to discard said results, as they are merely <code>()</code>.)</p>\n\n<p>P.P.S.: Using <code>fromJust</code> is generally not a good idea. It will make your <code>theBody</code> crash with a generic error message if there is a <code>Nothing</code> in the input list. Better options include <code>catMaybes</code> (from <code>Data.Maybe</code>), which will silently filter out the <code>Nothing</code> values (e.g. <code>let removedJusts = catMaybes listOfEntries</code>), and <code>maybe</code> and <code>fromMaybe</code> (the latter also from <code>Data.Maybe</code>), which allow you to choose how to handle <code>Nothing</code> values.</p>\n"}], "owner": {"reputation": 574, "user_id": 6262818, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/0qG2x.png?s=128&g=1", "display_name": "Jack Parkinson", "link": "https://stackoverflow.com/users/6262818/jack-parkinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 40951132, "answer_count": 1, "score": 0, "last_activity_date": 1480790086, "creation_date": 1480788150, "last_edit_date": 1480790086, "question_id": 40950840, "link": "https://stackoverflow.com/questions/40950840/map-function-doesnt-work-as-intended", "title": "Map Function Doesn&#39;t Work as Intended", "body": "<p>I have a couple of Haskell functions for writing to a .tex file (using the <a href=\"https://hackage.haskell.org/package/HaTeX-3.17.0.2\" rel=\"nofollow noreferrer\"><em>HaTeX</em></a> package) which look like this:</p>\n\n<pre><code>theBody :: Monad m =&gt; [ Maybe (String, String)] -&gt; LaTeXT_ m\ntheBody listOfEntries = do\n  maketitle\n  center $ tabular Nothing [RightColumn, VerticalLine, LeftColumn] $ do\n    textbf \"Name\" &amp; textbf \"Tel\"\n    let removedJusts = map fromJust listOfEntries\n    map tableEntry removedJusts\n\ntableEntry :: Monad m =&gt; (String, String) -&gt; LaTeXT_ m\ntableEntry (name, number) = do\n  lnbk\n  hline\n  do\n    textit (fromString name)\n    &amp;\n    textit (fromString number)\n</code></pre>\n\n<p>When I run this code, I get the following error:</p>\n\n<pre><code>Couldn't match expected type \u2018LaTeXT m ()\u2019 with actual type \u2018[LaTeXT_ m0]\u2019\n</code></pre>\n\n<p>Arising from the line where I map the <code>tableEntry</code> function to my list of tuples. The list of tuples would look something like this:</p>\n\n<pre><code>[(\"A Name\", \"12345\"), (\"Another Name\", \"54321\"), (\"Yet Another Name\", \"98765\")]\n</code></pre>\n\n<p>If I replace <code>map tableEntry removedJusts</code> with:</p>\n\n<pre><code>tableEntry (removedJusts !! 0)\ntableEntry (removedJusts !! 1)\ntableEntry (removedJusts !! 2)\n</code></pre>\n\n<p>It does indeed add these entries to my tex file, so I can't understand why the map function wouldn't work for the list.</p>\n\n<p>Any help appreciated.</p>\n"}, {"tags": ["haskell", "lazy-io"], "answers": [{"comments": [{"owner": {"reputation": 2688, "user_id": 32352, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/25c1ae809b29bdbe028ff0d3ef8b6efe?s=128&d=identicon&r=PG", "display_name": "johanneslink", "link": "https://stackoverflow.com/users/32352/johanneslink"}, "edited": false, "score": 3, "creation_date": 1480791330, "post_id": 40950991, "comment_id": 69112285, "body": "Works like a charm :) Remains to add that <code>unsafeInterleaveIO</code> must be imported form <code>System.IO.Unsafe</code>."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 6, "last_activity_date": 1480788988, "creation_date": 1480788988, "answer_id": 40950991, "question_id": 40950764, "link": "https://stackoverflow.com/questions/40950764/reimplementing-getcontents-using-getchar/40950991#40950991", "title": "Reimplementing getContents using getChar", "body": "<p>You need a new primitive <code>unsafeInterleaveIO :: IO a -&gt; IO a</code> that delays the execution of its argument action until the result of that action would be evaluated. Then</p>\n\n<pre><code>myGetContents :: IO [Char]\nmyGetContents = do\n  c &lt;- getChar\n  rest &lt;- unsafeInterleaveIO myGetContents\n  return (c : rest)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1480813886, "post_id": 40954032, "comment_id": 69118305, "body": "The advice in the first paragraph makes sense in most occasions, but in this case it doesn&#39;t apply because the OP is explicitly and intentionally trying to re-implement lazy I/O."}, {"owner": {"reputation": 1387, "user_id": 70852, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a458c4d941f0a6f5b01d924c1c3fc004?s=128&d=identicon&r=PG", "display_name": "bojo", "link": "https://stackoverflow.com/users/70852/bojo"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1480900073, "post_id": 40954032, "comment_id": 69140924, "body": "For the record my answer was based on a twitter exchange with the OP which is not reflected in the original question. I got the impression they may not have explicitly been after &quot;lazy IO&quot; and just wanted to get their code to run. Given the spirit of the actual question though, this is indeed a wrong answer."}], "tags": [], "owner": {"reputation": 1387, "user_id": 70852, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a458c4d941f0a6f5b01d924c1c3fc004?s=128&d=identicon&r=PG", "display_name": "bojo", "link": "https://stackoverflow.com/users/70852/bojo"}, "is_accepted": false, "score": 1, "last_activity_date": 1480810830, "creation_date": 1480810830, "answer_id": 40954032, "question_id": 40950764, "link": "https://stackoverflow.com/questions/40950764/reimplementing-getcontents-using-getchar/40954032#40954032", "title": "Reimplementing getContents using getChar", "body": "<p>You should really avoid using anything in <code>System.IO.Unsafe</code> if at all possible. They tend to kill referential transparency and are not common functions used in Haskell unless absolutely necessary.</p>\n\n<p>If you change your type signature a little I suspect you can get a more idiomatic approach to your problem.</p>\n\n<pre><code>consume :: Char -&gt; Bool\nconsume 'x' = False\nconsume _   = True\n\nmain :: IO ()\nmain = loop\n  where\n    loop = do\n      c &lt;- getChar\n      if consume c\n      then do\n        putChar c\n        loop\n      else return ()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 7451909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nOpNK.gif?s=128&g=1", "display_name": "Fox", "link": "https://stackoverflow.com/users/7451909/fox"}, "is_accepted": false, "score": 0, "last_activity_date": 1518905980, "creation_date": 1518905980, "answer_id": 48846499, "question_id": 40950764, "link": "https://stackoverflow.com/questions/40950764/reimplementing-getcontents-using-getchar/48846499#48846499", "title": "Reimplementing getContents using getChar", "body": "<h1>You can do this without any hacks.</h1>\n\n<p>If your goal is simply to read all of <code>stdin</code> into a <code>String</code>, you don't need any of the <code>unsafe*</code> functions.</p>\n\n<p><code>IO</code> is a Monad, and a Monad is an Applicative Functor.  A Functor is defined by the function <code>fmap</code>, whose signature is:</p>\n\n<pre><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>that satisfies these two laws:</p>\n\n<pre><code>fmap id = id\nfmap (f . g) = fmap f . fmap g\n</code></pre>\n\n<p>Effectively, <code>fmap</code> applies a function to wrapped values.</p>\n\n<p>Given a specific character <code>'c'</code>, what is the type of <code>fmap ('c':)</code>?  We can write the two types down, then unify them:</p>\n\n<pre><code>fmap        :: Functor f =&gt; (a      -&gt; b     ) -&gt; f a      -&gt; f b\n     ('c':) ::               [Char] -&gt; [Char]\nfmap ('c':) :: Functor f =&gt; ([Char] -&gt; [Char]) -&gt; f [Char] -&gt; f [Char]\n</code></pre>\n\n<p>Recalling that <code>IO</code> is a functor, if we want to define <code>myGetContents :: IO [Char]</code>, it seems reasonable to use this:</p>\n\n<pre><code>myGetContents :: IO [Char]\nmyGetContents = do\n  x &lt;- getChar\n  fmap (x:) myGetContents\n</code></pre>\n\n<p>This is close, but not quite equivalent to <code>getContents</code>, as this version will attempt to read past the end of the file and throw an error instead of returning a string.  Just looking at it should make that clear: there is no way to return a concrete list, only an infinite cons chain.  Knowing that the concrete case is <code>\"\"</code> at EOF (and using the infix syntax <code>&lt;$&gt;</code> for <code>fmap</code>) brings us to:</p>\n\n<pre><code>import System.IO\nmyGetContents :: IO [Char]\nmyGetContents = do\n  reachedEOF &lt;- isEOF\n  if reachedEOF\n  then return []\n  else do\n    x &lt;- getChar\n    (x:) &lt;$&gt; myGetContents\n</code></pre>\n\n<h1>The Applicative class affords a (slight) simplification.</h1>\n\n<p>Recall that <code>IO</code> is an Applicative Functor, not just any old Functor.  There are \"Applicative Laws\" associated with this typeclass much like the \"Functor Laws\", but we'll look specifically at <code>&lt;*&gt;</code>:</p>\n\n<pre><code>&lt;*&gt; :: Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>This is almost identical to <code>fmap</code> (a.k.a. <code>&lt;$&gt;</code>), except that the function to apply is also wrapped.  We can then avoid the bind in our <code>else</code> clause by using the Applicative style:</p>\n\n<pre><code>import System.IO\nmyGetContents :: IO String\nmyGetContents = do\n  reachedEOF &lt;- isEOF\n  if reachedEOF\n  then return []\n  else (:) &lt;$&gt; getChar &lt;*&gt; myGetContents\n</code></pre>\n\n<h1>One modification is necessary if the input may be infinite.</h1>\n\n<p>Remember when I said that you don't need the <code>unsafe*</code> functions if you just want to read <em>all</em> of <code>stdin</code> into a <code>String</code>?  Well, if you just want <em>some</em> of the input, you do.  If your input might be infinitely long, you definitely do.  The final program differs in one import and a single word:</p>\n\n<pre><code>import System.IO\nimport System.IO.Unsafe\nmyGetContents :: IO [Char]\nmyGetContents = do\n  reachedEOF &lt;- isEOF\n  if reachedEOF\n  then return []\n  else (:) &lt;$&gt; getChar &lt;*&gt; unsafeInterleaveIO myGetContents\n</code></pre>\n\n<p>The defining function of lazy IO is <code>unsafeInterleaveIO</code> (from <code>System.IO.Unsafe</code>).  This delays the computation of the <code>IO</code> action until it is demanded.</p>\n"}], "owner": {"reputation": 2688, "user_id": 32352, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/25c1ae809b29bdbe028ff0d3ef8b6efe?s=128&d=identicon&r=PG", "display_name": "johanneslink", "link": "https://stackoverflow.com/users/32352/johanneslink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 40950991, "answer_count": 3, "score": 6, "last_activity_date": 1518905980, "creation_date": 1480787604, "last_edit_date": 1480791480, "question_id": 40950764, "link": "https://stackoverflow.com/questions/40950764/reimplementing-getcontents-using-getchar", "title": "Reimplementing getContents using getChar", "body": "<p>On my journing towards grasping lazy IO in Haskell I tried the following:</p>\n\n<pre><code>main = do\n  chars &lt;- getContents\n  consume chars\n\nconsume :: [Char] -&gt; IO ()\nconsume [] = return ()\nconsume ('x':_) = consume []\nconsume (c : rest) = do\n  putChar c\n  consume rest\n</code></pre>\n\n<p>which just echos all characters typed in stdin until I hit 'x'.</p>\n\n<p>So, I naively thought it should be possible to reimplement <code>getContents</code> using <code>getChar</code> doing something along the following lines:</p>\n\n<pre><code>myGetContents :: IO [Char]\nmyGetContents = do\n  c &lt;- getChar\n  -- And now?\n  return (c: ???) \n</code></pre>\n\n<p>Turns out it's not so simple since the <code>???</code> would require a function of type <code>IO [Char] -&gt; [Char]</code> which would - I think - break the whole idea of the IO monad. </p>\n\n<p>Checking the implementation of <code>getContents</code> (or rather <code>hGetContents</code>) reveals a whole sausage factory of dirty IO stuff. Is my assumption correct that  <code>myGetContents</code> cannot be implemented without using dirty, ie monad-breaking, code?</p>\n"}, {"tags": ["string", "sorting", "haskell"], "comments": [{"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 2, "creation_date": 1480788231, "post_id": 40950488, "comment_id": 69111281, "body": "<code>sortBy (compare `on` ((!!2) . splitOn &quot; &quot; . fst))</code> will compare by the third word of the first element of the tuple. If you want the last word, use <code>last</code> instead of <code>(!!2)</code>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 1, "creation_date": 1480789069, "post_id": 40950919, "comment_id": 69111566, "body": "I&#39;d still write it in terms of <code>on</code>."}], "tags": [], "owner": {"reputation": 2538, "user_id": 2608433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae39f954ac48900859dea3fb1a061d71?s=128&d=identicon&r=PG", "display_name": "mnoronha", "link": "https://stackoverflow.com/users/2608433/mnoronha"}, "is_accepted": false, "score": 1, "last_activity_date": 1480789593, "last_edit_date": 1480789593, "creation_date": 1480788572, "answer_id": 40950919, "question_id": 40950488, "link": "https://stackoverflow.com/questions/40950488/haskell-sort-of-string-string-with-respect-to-substring-of-the-first-element/40950919#40950919", "title": "haskell sort of [(String,String)] with respect to substring of the first element of tuple", "body": "<p>Because you have to query the last value in each list for each combination, this solution isn't very efficient at all. But here's at least one way of doing it (feel free to suggest better options, readers!)</p>\n\n<pre><code>import Data.List.Split\nimport Data.List\n\nsortStrTuples :: [(String,String)] -&gt; [(String,String)]\nsortStrTuples = sortBy (compare `on` f)\n                    where f (x,_) = last $ (splitOn \" \") x\n</code></pre>\n\n<p>Basically, we sort the provided list in terms of a processed version of that list. For each pair, we split the string contained in the first value of the tuple on its spaces and select the last element. So given a tuple <code>(\"blah1 blah2\",\"blah blah\")</code>, our local function <code>f</code> returns \"blah2\". We then rely on built-in string comparison behavior (which matches what we want).</p>\n\n<p>Testing this, we can see it behaves as expected:</p>\n\n<pre><code>ghci&gt;&gt; sortStrTuples [(\"aa bb cc\",\"blah\"),(\"aa bbb\",\"blah\")]\n[(\"aa bbb\",\"blah\"),(\"aa bb cc\",\"blah\")]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7245702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a3d63133d3e1d3cb5bf641f7f4469eb?s=128&d=identicon&r=PG&f=1", "display_name": "Hyfo", "link": "https://stackoverflow.com/users/7245702/hyfo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480789593, "creation_date": 1480785938, "last_edit_date": 1495540904, "question_id": 40950488, "link": "https://stackoverflow.com/questions/40950488/haskell-sort-of-string-string-with-respect-to-substring-of-the-first-element", "title": "haskell sort of [(String,String)] with respect to substring of the first element of tuple", "body": "<p>I am looking for the way to sort <code>[(String,String)]</code> with regard to the small part of first element of tuple</p>\n\n<p>This problem is similar to <em><a href=\"https://stackoverflow.com/questions/21431052/sort-list-of-strings-by-a-part-of-the-string\">Sort list of strings by a part of the string</a></em>, but in Haskell.</p>\n\n<pre><code>sortBy (compare `on` fst) list\n</code></pre>\n\n<p>works fine but I need to refine search so the string of format \"aa bb cc\" would be sorted only with respect to cc part </p>\n\n<p>I tried to do this:</p>\n\n<pre><code>sortBy (compare `on` ((!!2)(splitOn \" \" (fst)))\n</code></pre>\n\n<p>Unfortunately it does not work, probably due to my lack of understanding how to nest functions.</p>\n"}, {"tags": ["haskell", "machine-learning", "linear-algebra", "hmatrix"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1480779366, "post_id": 40949300, "comment_id": 69108582, "body": "Am I reading this right, <code>a</code> is a 1500 x 120000 matrix?"}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1480779440, "post_id": 40949300, "comment_id": 69108602, "body": "Completely correct. And it might be even bigger."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1480781654, "post_id": 40949300, "comment_id": 69109290, "body": "Are the matrices <a href=\"https://en.wikipedia.org/wiki/Sparse_matrix\" rel=\"nofollow noreferrer\">sparse</a>? That could save you a heck lot of space and time (but you&#39;d probably need a dedicated algorithm like <a href=\"https://en.wikipedia.org/wiki/Conjugate_gradient_method\" rel=\"nofollow noreferrer\">conjugate gradient</a>)."}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "edited": false, "score": 0, "creation_date": 1480784616, "post_id": 40949300, "comment_id": 69110168, "body": "Unfortunately, they are not sparse."}], "answers": [{"comments": [{"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "edited": false, "score": 0, "creation_date": 1480780664, "post_id": 40949596, "comment_id": 69108994, "body": "Reid, thank you for your answer. Indeed, I have to mention that I am using hmatrix library that is interfacing with C routines (BLAS and LAPACK). Matrices are then stored as Data.Vector.Storable arrays."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 1, "last_activity_date": 1480780284, "creation_date": 1480780284, "answer_id": 40949596, "question_id": 40949300, "link": "https://stackoverflow.com/questions/40949300/how-much-space-does-ridge-regression-require/40949596#40949596", "title": "How much space does ridge regression require?", "body": "<p>Simple Gauss-Jordan elimination only takes space to store the input and output matrices plus constant auxiliary space. If I'm reading correctly, the matrix <code>oA</code> you need to invert is <code>n</code> x <code>n</code> so that's not a problem.</p>\n\n<p>Your memory usage is completely dominated by storing the input matrix <code>a</code>, which uses at least 1500 * 120000 * 8 = 1.34 GB. <code>n = 4000</code> would be 4000 * 120000 * 8 = 3.58 GB which is over half of your space budget. I don't know what matrix library you are using or how it stores its matrices, but if they are on the Haskell heap then GC effects could easily account for another factor of 2 in space usage.</p>\n"}, {"tags": [], "owner": {"reputation": 3365, "user_id": 2564696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bfecfacff3f61943083d01444ade243?s=128&d=identicon&r=PG", "display_name": "dmuir", "link": "https://stackoverflow.com/users/2564696/dmuir"}, "is_accepted": false, "score": 1, "last_activity_date": 1481047483, "creation_date": 1481047483, "answer_id": 41001970, "question_id": 40949300, "link": "https://stackoverflow.com/questions/40949300/how-much-space-does-ridge-regression-require/41001970#41001970", "title": "How much space does ridge regression require?", "body": "<p>Well you can get away with 3*m + nxn space, but how numerically stable this will be I'm not sure.</p>\n\n<p>The basis is the identity</p>\n\n<pre><code>inv( inv(Q) + A'*A)) = Q - Q*A'*R*A*Q\nwhere R = inv( I + A*Q*A')\n</code></pre>\n\n<p>If A is your A matrix and </p>\n\n<pre><code>Q = inv( mu*I*mu*I) = I/(mu*mu)\n</code></pre>\n\n<p>then the solution to your ridge regression is </p>\n\n<pre><code>inv( inv(Q) + A'*A)) * A'*b\n</code></pre>\n\n<p>A little more algebra shows </p>\n\n<pre><code>inv( inv(Q) + A'*A)) = (I - A'*inv( (mu2 + A*A'))*A)/mu2\nwhere mu2 = mu*m\n</code></pre>\n\n<p>Note that since A is n x m, A*A' is n x n.</p>\n\n<p>So one algorithm would be</p>\n\n<p>Compute C = A*A' + mu2</p>\n\n<p>Do a cholesky decompostion of C, ie find upper triangular U so that U'*U = C</p>\n\n<p>Compute the vector y = A'*b</p>\n\n<p>Compute the vector z = A*y</p>\n\n<p>Solve U'*u = z for u in z</p>\n\n<p>Solve U*v = z for v in z</p>\n\n<p>compute w = A'*z</p>\n\n<p>Compute x = (y - w)/mu2.</p>\n"}], "owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 40949596, "answer_count": 2, "score": 0, "last_activity_date": 1481047483, "creation_date": 1480778448, "last_edit_date": 1480781315, "question_id": 40949300, "link": "https://stackoverflow.com/questions/40949300/how-much-space-does-ridge-regression-require", "title": "How much space does ridge regression require?", "body": "<p>In Haskell, <a href=\"https://en.wikipedia.org/wiki/Tikhonov_regularization\" rel=\"nofollow noreferrer\">ridge regression</a> can be expressed as:</p>\n\n<pre><code>import Numeric.LinearAlgebra \n\ncreateReadout :: Matrix Double \u2192 Matrix Double \u2192 Matrix Double\ncreateReadout a b = oA &lt;\\&gt; oB\n  where\n   \u03bc = 1e-4\n\n   oA = (a &lt;&gt; (tr a)) + (\u03bc * (ident $ rows a))\n   oB = a &lt;&gt; (tr b)\n</code></pre>\n\n<p>However, this operation is very memory expensive. Here is a minimalistic example that requires more than 2GB on my machine and takes 3 minutes to execute.</p>\n\n<pre><code>import Numeric.LinearAlgebra\nimport System.Random\n\ncreateReadout :: Matrix Double -&gt; Matrix Double -&gt; Matrix Double\ncreateReadout a b = oA &lt;\\&gt; oB\n  where\n    mu = 1e-4\n    oA = (a &lt;&gt; (tr a)) + (mu * (ident $ rows a))\n    oB = a &lt;&gt; (tr b)\n\nteacher :: [Int] -&gt; Int -&gt; Int -&gt; Matrix Double\nteacher labelsList cols' correctRow = fromBlocks $ f &lt;$&gt; labelsList\n  where ones = konst 1.0 (1, cols')\n        zeros = konst 0.0 (1, cols')\n        rows' = length labelsList\n        f i | i == correctRow = [ones]\n            | otherwise = [zeros]\n\nglue :: Element t =&gt; [Matrix t] -&gt; Matrix t\nglue xs = fromBlocks [xs]\n\nmain :: IO ()\nmain = do\n\n  let n = 1500  -- &lt;- The constant to be increased\n      m = 10000\n      cols' = 12\n\n  g &lt;- newStdGen\n\n  -- Stub data\n  let labels = take m . map (`mod` 10) . randoms $ g :: [Int]\n      a = (n &gt;&lt; (cols' * m)) $ take (cols' * m * n) $ randoms g :: Matrix Double\n      teachers = zipWith (teacher [0..9]) (repeat cols') labels\n      b = glue teachers\n\n  print $ maxElement $ createReadout a b\n  return ()\n</code></pre>\n\n<blockquote>\n  <p>$ cabal exec ghc -- -O2 Test.hs</p>\n  \n  <p>$ time ./Test<br>\n  ./Test  190.16s user 5.22s system 106% cpu 3:03.93 total</p>\n</blockquote>\n\n<p>The problem is to increase the constant <strong>n</strong>, at least to n = 4000, while RAM is limited by 5GB. What is minimal space that matrix inversion operation requires in theory? How can this operation be optimized in terms of space? Can ridge regression be efficiently replaced with a cheaper method?</p>\n"}, {"tags": ["arrays", "haskell", "data-structures", "lazy-evaluation", "repa"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1480773561, "post_id": 40948482, "comment_id": 69106953, "body": "This kind of question is off topic (though it&#39;s a good question, I have often wondered about this too). <a href=\"http://hackage.haskell.org/package/containers-0.5.8.1/docs/Data-Sequence.html\" rel=\"nofollow noreferrer\"><code>Seq</code></a> certainly aims in the right direction, perhaps you could change your question to ask whether that specific type fulfills your requirements."}, {"owner": {"reputation": 555, "user_id": 4637817, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/849a2d4951995c9fcb2b9aec36faaf2c?s=128&d=identicon&r=PG&f=1", "display_name": "Remagpie", "link": "https://stackoverflow.com/users/4637817/remagpie"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1480773808, "post_id": 40948482, "comment_id": 69107023, "body": "@leftaroundabout sorry about that, but could you tell me why this is off topic?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1480774121, "post_id": 40948482, "comment_id": 69107140, "body": "@leftaroundabout I have edited the question in an attempt to tone down the recommendation aspect. (@Yang: Quoting the relevant question closure reason: &quot;Questions asking us to recommend or find a book, tool, software library, tutorial or other off-site resource are off-topic for Stack Overflow as they tend to attract opinionated answers and spam. Instead, describe the problem and what has been done so far to solve it.&quot;)"}, {"owner": {"reputation": 555, "user_id": 4637817, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/849a2d4951995c9fcb2b9aec36faaf2c?s=128&d=identicon&r=PG&f=1", "display_name": "Remagpie", "link": "https://stackoverflow.com/users/4637817/remagpie"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1480774313, "post_id": 40948482, "comment_id": 69107197, "body": "@duplode Thank you for your edit, and I&#39;m terribly sorry that I didn&#39;t notice that. I&#39;ll double-check the rules next time."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1480784965, "post_id": 40948482, "comment_id": 69110261, "body": "&quot;but evaluates only few times&quot;/&quot;lazy evaluated&quot; - I don&#39;t understand your requirements here."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1480805050, "post_id": 40948482, "comment_id": 69116373, "body": "Yes, there are a number of possibilities depending on what operations you need, whether you are using it persistently (using old versions after you have updated), if you are doing pointwise modifications only or whether your are concatenating and resizing, etc.  It&#39;s hard to make a recommendation without more of these requirements specified."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1480805296, "post_id": 40948482, "comment_id": 69116438, "body": "Data.Seq, Data.Vector, Data.DList, Data.IntTrie, Data.Array.ST.Lazy all come to mind to look into.  Maybe more ideas once I hear more about the use case"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480821453, "post_id": 40948482, "comment_id": 69119552, "body": "Given your updated use case, take a look at <code>UArray</code>, <code>STUArray</code>, and <code>IOUArray</code> from <a href=\"https://hackage.haskell.org/package/array-0.5.1.1\" rel=\"nofollow noreferrer\"><code>array</code></a> and maybe even <code>Array</code> from <a href=\"https://hackage.haskell.org/package/repa-3.4.1.2\" rel=\"nofollow noreferrer\"><code>repa</code></a>. The first three are all unboxed and pretty bare metal (you can choose mutable or not). The last is good for choosing exactly when to allocate memory (as opposed to being lazy) and for parallelizing operations."}, {"owner": {"reputation": 555, "user_id": 4637817, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/849a2d4951995c9fcb2b9aec36faaf2c?s=128&d=identicon&r=PG&f=1", "display_name": "Remagpie", "link": "https://stackoverflow.com/users/4637817/remagpie"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480829448, "post_id": 40948482, "comment_id": 69121039, "body": "@Alec According to the documentation, repa and unboxed arrays are strict on their elements, so I think they don&#39;t fit in my case."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1480830567, "post_id": 40948482, "comment_id": 69121239, "body": "@Yang Repa has a <a href=\"https://hackage.haskell.org/package/repa-3.4.1.2/docs/Data-Array-Repa.html#t:D\" rel=\"nofollow noreferrer\">delayed</a> representation which allows you to manipulate &quot;delayed&quot; arrays where actual allocation happens only when you try to materialize the array in an unboxed (and necessarily strict) form using something like <a href=\"https://hackage.haskell.org/package/repa-3.4.1.2/docs/Data-Array-Repa.html#v:computeUnboxedP\" rel=\"nofollow noreferrer\"><code>computeUnboxedP</code></a>. IIRC delayed arrays aren&#39;t strict."}, {"owner": {"reputation": 555, "user_id": 4637817, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/849a2d4951995c9fcb2b9aec36faaf2c?s=128&d=identicon&r=PG&f=1", "display_name": "Remagpie", "link": "https://stackoverflow.com/users/4637817/remagpie"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480834026, "post_id": 40948482, "comment_id": 69121898, "body": "@Alec Wow, I didn&#39;t notic that there is delayed representation! I think it fits in my case, but it seems there are not enough documentation about that. Could you explain a bit more about it?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480834720, "post_id": 40948482, "comment_id": 69122014, "body": "@Yang Sure - I&#39;ll add an answer."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 4, "last_activity_date": 1480843444, "creation_date": 1480843444, "answer_id": 40957165, "question_id": 40948482, "link": "https://stackoverflow.com/questions/40948482/appropriate-representation-for-lazy-array-in-haskell/40957165#40957165", "title": "Appropriate representation for lazy array in Haskell", "body": "<p>One library to consider is <a href=\"https://hackage.haskell.org/package/repa-3.4.1.2\" rel=\"nofollow noreferrer\"><code>repa</code></a>. One of the key ideas in <code>repa</code> is that the <a href=\"https://hackage.haskell.org/package/repa-3.4.1.2/docs/Data-Array-Repa.html#t:Array\" rel=\"nofollow noreferrer\"><code>Array</code></a> type is parametrized over its underlying representation. A sample of these is</p>\n\n<ul>\n<li>the delayed representation <a href=\"https://hackage.haskell.org/package/repa-3.4.1.2/docs/Data-Array-Repa.html#t:D\" rel=\"nofollow noreferrer\"><code>D</code></a> for arrays that \"aren't real\" - they just compute elements on demand;</li>\n<li>the unboxed vector representations <a href=\"https://hackage.haskell.org/package/repa-3.4.1.2/docs/Data-Array-Repa.html#t:U\" rel=\"nofollow noreferrer\"><code>U</code></a> for unboxed data</li>\n<li>the boxed vector representation <a href=\"https://hackage.haskell.org/package/repa-3.4.1.2/docs/Data-Array-Repa.html#t:V\" rel=\"nofollow noreferrer\"><code>V</code></a> for boxed data (use only if you can't make an <code>Unbox</code> instance of your data)</li>\n<li>a reference to a foreign buffer <a href=\"https://hackage.haskell.org/package/repa-3.4.1.2/docs/Data-Array-Repa-Repr-ForeignPtr.html#t:F\" rel=\"nofollow noreferrer\"><code>F</code></a>, especially useful if you want to be writing into some foreign bitmap graphics buffer</li>\n</ul>\n\n<p>When you compile  your code, delayed arrays will get optimized away. It goes without saying that the unboxed arrays have <code>O(1)</code> access. For your case, you will probably just be using arrays of shape <a href=\"https://hackage.haskell.org/package/repa-3.4.1.2/docs/Data-Array-Repa-Index.html#t:DIM2\" rel=\"nofollow noreferrer\"><code>DIM2</code></a> (2D arrays).</p>\n\n<p>For demonstration purposes, here is a program that does something similar to what you want: It takes in a list of bitmap layers and their offsets, as well as background bitmap. Then, it draws these layers on top of the bitmap background. It depends on <a href=\"https://hackage.haskell.org/package/repa-3.4.1.1\" rel=\"nofollow noreferrer\"><code>repa-io</code></a> for loading the images into <code>repa</code> arrays.</p>\n\n<pre><code>import Data.Array.Repa.IO.BMP\nimport Data.Array.Repa.Shape\nimport Data.Array.Repa\nimport Data.Word\n\n-- This is our internal representation of a bitmap\ntype Image s = Array s DIM2 (Word8, Word8, Word8)\ndata Layer s = Layer { image :: Image s, offset :: (Int, Int) }\n\ndrawLayersOnBg :: Image U -&gt; [Layer U] -&gt; Image D\ndrawLayersOnBg background layers = foldl (\\bg (Layer im (x,y)) -&gt; overlay bg (ix2 y x) im) (delay background) layers\n  where\n    overlay :: Image D -&gt; DIM2 -&gt; Image U -&gt; Image D\n    overlay bg off ov = backpermuteDft bg\n                                       (\\i -&gt; let i' = i `subDim` off\n                                                 in if extent ov `inShape` I'\n                                                      then Just i'\n                                                      else Nothing)\n                                       ov\n\n    subDim :: DIM2 -&gt; DIM2 -&gt; DIM2\n    subDim (Z :. y :. x) (Z :. dy :. dx) = ix2 (y - dy) (x - dx)\n\nmain = do\n  Right bg &lt;- readImageFromBMP \"background.bmp\"\n  Right l1 &lt;- readImageFromBMP \"layer1.bmp\"\n  Right l2 &lt;- readImageFromBMP \"layer2.bmp\"\n  Right l3 &lt;- readImageFromBMP \"layer3.bmp\"\n\n  out &lt;- computeP $ drawLayersOnBg bg [ Layer l1 (200,100) , Layer l2 (100, 200), Layer l3 (-300,400) ]\n  writeImageToBMP \"out.bmp\" out\n</code></pre>\n\n<p>With some random bitmaps from the internet I got this as an output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1ApGC.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1ApGC.jpg\" alt=\"output\"></a></p>\n\n<p>If I wanted to, I could even have used <code>fromForeignPtr</code> to read bitmaps straight from some foreign memory buffer and <code>computeIntoP</code> instead of <code>computeP</code> to write the bitmap output straight into some foreign memory buffer (no intermediate allocations). If you need high-performance, those are especially interesting.</p>\n"}], "owner": {"reputation": 555, "user_id": 4637817, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/849a2d4951995c9fcb2b9aec36faaf2c?s=128&d=identicon&r=PG&f=1", "display_name": "Remagpie", "link": "https://stackoverflow.com/users/4637817/remagpie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 40957165, "answer_count": 1, "score": 3, "last_activity_date": 1481581439, "creation_date": 1480772924, "last_edit_date": 1481581439, "question_id": 40948482, "link": "https://stackoverflow.com/questions/40948482/appropriate-representation-for-lazy-array-in-haskell", "title": "Appropriate representation for lazy array in Haskell", "body": "<p>I'm trying to make a program that has massive updates on one large array, but evaluates only few times. I want computations to be lazy as possible, but I can't find out which Array representation is good for my case.\nTo be specific, I want my array to:</p>\n\n<ul>\n<li>have fixed size</li>\n<li>access in constant time</li>\n<li>update n elements in O(n)</li>\n<li><strong>lazy evaluated</strong></li>\n</ul>\n\n<p>How to approach these requirements? As a sub-question: are there libraries specifically geared for this use case?</p>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>Maybe my question wasn't specific enough, so I'll try to explain about my case more.</p>\n\n<p>I'm trying to represent various size of image which can be either relatively small(about 1200x800), or much larger than that(at least 8000x8000). Also, there will be lots of layers for one image, which means that if I want to draw image on screen, there will be lots of updates on frame buffer image. I thought if I can exploit lazy-evaluated nature of haskell, I would be able to write on frame buffer only once, rather than overwriting same pixel at each updates.</p>\n\n<p>I'm aware of several options for representing array in haskell, but all of those doesn't seem to fit in my case. For example:</p>\n\n<ul>\n<li>Data.Seq, Data.IntTrie : can't be accessed in constant time</li>\n<li>Data.Vector, Data.Array : update n elements takes more than O(n)</li>\n<li>Unboxed variants : not lazy-evaluated(I guess?)</li>\n</ul>\n\n<p>What approach should I take in this situation?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1480771247, "post_id": 40948153, "comment_id": 69106291, "body": "The problem is not with <code>elemIndex</code>, but with <code>minimum</code>, or rather, <code>minimum . reverse</code>."}, {"owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "edited": false, "score": 0, "creation_date": 1480772251, "post_id": 40948153, "comment_id": 69106580, "body": "You can write <code>[10000000,9999999..1]</code>. <code>reverse</code> is the problem here, because it keeps the whole list in memory. Is there a reason why you want to use <code>reverse</code>?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "edited": false, "score": 0, "creation_date": 1480773162, "post_id": 40948153, "comment_id": 69106831, "body": "@sapanoia granted, though principle it shouldn&#39;t be a problem to keep a list with 100 M entries in memory. Indeed this only causes a stack overflow in GHCi; in a compiled program (even without optimisations) it \u201cmerely\u201d bogs down the system with 19 GB of memory consumption..."}, {"owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1480773700, "post_id": 40948153, "comment_id": 69106999, "body": "@leftaroundabout May I borrow some RAM from your machine? On a more serious note: I interpreted &quot;10000000&quot; as &quot;<i>some arbitrarily large number, could be bigger</i>&quot;. And even if your machine has 10GB of free RAM to spare, you may still take a performance hit, for example by clobbering the memory bus."}], "answers": [{"tags": [], "owner": {"reputation": 336, "user_id": 7236501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f52887fba37383964c102def911c9bc?s=128&d=identicon&r=PG&f=1", "display_name": "shinobi", "link": "https://stackoverflow.com/users/7236501/shinobi"}, "is_accepted": false, "score": 1, "last_activity_date": 1480774425, "creation_date": 1480774425, "answer_id": 40948680, "question_id": 40948153, "link": "https://stackoverflow.com/questions/40948153/find-min-elements-index-of-a-large-list-in-haskell/40948680#40948680", "title": "Find min element&#39;s index of a large list in Haskell", "body": "<pre><code>elemIndex (foldl1' min a) a\n</code></pre>\n\n<p>The essential part is using <code>foldl1' min</code> instead of <code>minimum</code>.  The evaluation of <code>minimum</code> builds and returns a huge redex, whose evaluation causes stack overflow.</p>\n\n<p>All the gory details: <a href=\"https://wiki.haskell.org/Foldr_Foldl_Foldl%27\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Foldr_Foldl_Foldl%27</a></p>\n\n<p>A general discussion of strictness in relation to performance in Haskell: <a href=\"https://wiki.haskell.org/Performance/Strictness\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Performance/Strictness</a></p>\n"}], "owner": {"reputation": 986, "user_id": 6819040, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/IJDZr.jpg?s=128&g=1", "display_name": "AurevoirXavier", "link": "https://stackoverflow.com/users/6819040/aurevoirxavier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1203, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480774425, "creation_date": 1480770934, "question_id": 40948153, "link": "https://stackoverflow.com/questions/40948153/find-min-elements-index-of-a-large-list-in-haskell", "title": "Find min element&#39;s index of a large list in Haskell", "body": "<p>i know some way to find the min or max element's index, but when i deal with a large list. ghc said:\"stack overflow\"</p>\n\n<p>So i go to stack overflow.</p>\n\n<pre><code>Prelude&gt; :m Data.List\nPrelude Data.List&gt; let a = reverse [1..10000000]\nPrelude Data.List&gt; elemIndex  (minimum a) a\n*** Exception: stack overflow\n</code></pre>\n\n<p>This way is better than using elemIndex but it can't solve 'reverse [1..100000000]'.</p>\n\n<pre><code>subset [] = [[]]\nsubset (x:xs) = s ++ map ( x : ) s\nwhere s = subset xs\n\nminIndex xs = snd . minimum $ zip xs [0..]\n</code></pre>\n\n<p>How can i find min element's index of a large list?</p>\n\n<p>You'd better not use other module, just using prelude.</p>\n"}, {"tags": ["haskell", "functor"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1480768565, "post_id": 40947741, "comment_id": 69105632, "body": "Wouldn&#39;t it make more sense to take <code>x :: a</code> as the last argument?"}, {"owner": {"reputation": 401, "user_id": 1985931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cda15456fc1622e0855b351c6f2854de?s=128&d=identicon&r=PG", "display_name": "iluvAS", "link": "https://stackoverflow.com/users/1985931/iluvas"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1480768838, "post_id": 40947741, "comment_id": 69105710, "body": "@leftaroundabout oh yeah, it does. Thanks for pointing that out. But this is just pseudocode to explain my issue. Its just that I have a lot of functions and types that use a pattern similar to this and I&#39;m wondering if theres a better way to go about doing this."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1480770436, "post_id": 40947741, "comment_id": 69106069, "body": "Your <code>wfmap</code> declares 5 arguments in the type, but only 4 in the definition. I think you just have an extra argument of type <code>a</code> in the type."}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 1, "creation_date": 1480780226, "post_id": 40947741, "comment_id": 69108858, "body": "<code>Functor f =&gt; (b -&gt; f b) -&gt; a -&gt; f a</code> is also called <code>Lens&#39; a b</code> and is the centerpiece of the <a href=\"https://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\"><code>lens</code></a> library. Your example could end up looking like <code>wfmap x u w g = (iso u w %%~ g) x</code>, though of course you wouldn&#39;t give wfmap its own name."}], "answers": [{"comments": [{"owner": {"reputation": 401, "user_id": 1985931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cda15456fc1622e0855b351c6f2854de?s=128&d=identicon&r=PG", "display_name": "iluvAS", "link": "https://stackoverflow.com/users/1985931/iluvas"}, "edited": false, "score": 0, "creation_date": 1480781232, "post_id": 40949381, "comment_id": 69109156, "body": "Thanks for this! :)"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 7, "last_activity_date": 1480805095, "last_edit_date": 1480805095, "creation_date": 1480778860, "answer_id": 40949381, "question_id": 40947741, "link": "https://stackoverflow.com/questions/40947741/isomorphic-fmap-in-haskell/40949381#40949381", "title": "Isomorphic `fmap` in Haskell", "body": "<p>Reordering the arguments, as leftaroundabout suggests, allows for a tidier definition:</p>\n\n<pre><code>wfmap :: Functor f =&gt; (a -&gt; b) -&gt; (b -&gt; a) -&gt; (b -&gt; f b) -&gt; a -&gt; f a\nwfmap u w g = fmap w . g . u\n</code></pre>\n\n<p>As for library support, <em>lens</em> provides <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Iso.html\" rel=\"nofollow noreferrer\">nifty support for isomorphisms</a>. A bit more broadly, as Gurkenglas notes...</p>\n\n<blockquote>\n  <p><code>Functor f =&gt; (b -&gt; f b) -&gt; a -&gt; f a</code> is also called <code>Lens' a b</code> and is the centerpiece of the lens library. </p>\n</blockquote>\n\n<p>Without diving into the details of how and why that works, one consequence is that your function might be defined as:</p>\n\n<pre><code>wfmap :: Functor f =&gt; (a -&gt; b) -&gt; (b -&gt; a) -&gt; (b -&gt; f b) -&gt; a -&gt; f a\nwfmap u w g = (iso u w) g\n</code></pre>\n\n<p>Or even:</p>\n\n<pre><code>wfmap :: Functor f =&gt; (a -&gt; b) -&gt; (b -&gt; a) -&gt; (b -&gt; f b) -&gt; a -&gt; f a\nwfmap = iso\n</code></pre>\n\n<p><code>wfmap</code> is just (a specialised version of) <code>iso</code>, which gives out a function which can be used to convert an <code>b -&gt; f b</code> function on the isomorphism \"destination\" to an <code>a -&gt; f a</code> one on the isomorphism \"source\".</p>\n\n<p>It is also worth mentioning <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Iso.html#v:mapping\" rel=\"nofollow noreferrer\"><code>mapping</code></a>, which can be used for the somewhat different purpose of applying <code>fmap</code> on the other side of an isomorphism:</p>\n\n<pre><code>GHCi&gt; :t \\u w g -&gt; over (mapping (iso u w)) (fmap g)\n\\u w g -&gt; over (mapping (iso u w)) (fmap g)\n  :: Functor f =&gt; (s -&gt; a) -&gt; (b -&gt; t) -&gt; (a -&gt; b) -&gt; f s -&gt; f t\nGHCi&gt; :t \\u w g -&gt; under (mapping (iso u w)) (fmap g)\n\\u w g -&gt; under (mapping (iso u w)) (fmap g)\n  :: Functor f =&gt; (s -&gt; a) -&gt; (b -&gt; a1) -&gt; (a1 -&gt; s) -&gt; f b -&gt; f a\n</code></pre>\n\n<p>Finally, note that <code>iso u w</code> can be replaced by any <code>Iso</code> you might find in the libraries or have predefined elsewhere.</p>\n"}], "owner": {"reputation": 401, "user_id": 1985931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cda15456fc1622e0855b351c6f2854de?s=128&d=identicon&r=PG", "display_name": "iluvAS", "link": "https://stackoverflow.com/users/1985931/iluvas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 2, "accepted_answer_id": 40949381, "answer_count": 1, "score": 6, "last_activity_date": 1480805095, "creation_date": 1480768059, "last_edit_date": 1480776114, "question_id": 40947741, "link": "https://stackoverflow.com/questions/40947741/isomorphic-fmap-in-haskell", "title": "Isomorphic `fmap` in Haskell", "body": "<p>Does such a thing exist in Haskell's Prelude?</p>\n\n<pre><code>wfmap :: Functor f\n      =&gt; a\n      -&gt; (a -&gt; b)\n      -&gt; (b -&gt; a)\n      -&gt; (b -&gt; f b)\n      -&gt; f a\nwfmap x u w g = fmap (w) (g (u x))\n</code></pre>\n\n<p>In a project I'm working on, I often found myself 'converting' a type to another, process it and 'converting' it back.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 3758, "user_id": 826938, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1f5fa15f4142e9ec9ade8ea8142a030a?s=128&d=identicon&r=PG", "display_name": "BigONotation", "link": "https://stackoverflow.com/users/826938/bigonotation"}, "is_accepted": true, "score": 1, "last_activity_date": 1480772274, "creation_date": 1480772274, "answer_id": 40948377, "question_id": 40947612, "link": "https://stackoverflow.com/questions/40947612/haskell-how-to-call-ffi-on-windows/40948377#40948377", "title": "Haskell how to call ffi on Windows", "body": "<p>Ok finally figured it out and here is the updated code:</p>\n\n<pre><code>{-# INCLUDE \"myfunction.h\" #-}\n\n{-# LANGUAGE ForeignFunctionInterface #-}\n\n\nimport Prelude hiding (sin)\n\u00a0\nimport Foreign.C -- get the C types\n\u00a0\n-- pure function\nforeign import ccall \"sin\" c_sin :: CDouble -&gt; CDouble\nforeign import ccall \"myfunction\" c_myfunction :: Double -&gt; Double\n\nsin :: Double -&gt; Double\nsin d = realToFrac (c_sin (realToFrac d))\n\nmyfunction :: Double -&gt; Double\nmyfunction d = realToFrac(c_myfunction d)\n\nmain = do\n  print . sin =&lt;&lt; readLn\n  print . myfunction =&lt;&lt; readLn\n</code></pre>\n\n<p>Also you need to make sure to reference your c functions with <code>c_</code> in the foreign import directive. So for a c function <code>foo</code> it should be referenced as <code>c_myfoo</code>. Finally compile using <code>stack ghc Main.hs myfunction.c</code></p>\n"}], "owner": {"reputation": 3758, "user_id": 826938, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/1f5fa15f4142e9ec9ade8ea8142a030a?s=128&d=identicon&r=PG", "display_name": "BigONotation", "link": "https://stackoverflow.com/users/826938/bigonotation"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 40948377, "answer_count": 1, "score": 1, "last_activity_date": 1480772274, "creation_date": 1480767126, "last_edit_date": 1480768085, "question_id": 40947612, "link": "https://stackoverflow.com/questions/40947612/haskell-how-to-call-ffi-on-windows", "title": "Haskell how to call ffi on Windows", "body": "<p>Sorry if this is a bit of newbie question. I am trying to call a C function from Haskell. I am currently using stack on Windows. I started with the following simple example which works well:</p>\n\n<pre><code>import Prelude hiding (sin)\n\u00a0\nimport Foreign.C -- get the C types\n\u00a0\n-- pure function\nforeign import ccall \"sin\" c_sin :: CDouble -&gt; CDouble\n\nsin :: Double -&gt; Double\nsin d = realToFrac (c_sin (realToFrac d))\n\nmain = do\n    print . sin =&lt;&lt; readLn\n</code></pre>\n\n<p>Then I tried to add another custom <code>myfunc</code> function:</p>\n\n<pre><code>{-# INCLUDE \"myfunction.h\" #-}\n{-# LANGUAGE ForeignFunctionInterface #-}\n\nimport Prelude hiding (sin)\n\u00a0\nimport Foreign.C -- get the C types\n\u00a0\n-- pure function\nforeign import ccall \"sin\" c_sin :: CDouble -&gt; CDouble\nforeign import ccall \"myfunc\" c_myfunction :: Double -&gt; Double\n\nsin :: Double -&gt; Double\nsin d = realToFrac (c_sin (realToFrac d))\n\nmyfunc :: Double -&gt; Double\nmyfunc d = realToFrac(c_myfunction d)\n\nmain = do\n   print . sin =&lt;&lt; readLn\n   print . myfunc =&lt;&lt; readLn\n</code></pre>\n\n<p>I am getting the following error:</p>\n\n<pre><code>src\\Main.hs:1:12: warning:\n    -#include and INCLUDE pragmas are deprecated: They no longer have any effect\nLinking src\\Main.exe ...\nsrc\\Main.o:fake:(.text+0x56): undefined reference to `myfunc'\ncollect2.exe: error: ld returned 1 exit status\n`gcc.exe' failed in phase `Linker'. (Exit code: 1)\n</code></pre>\n\n<p>I have defined <code>myfunc</code> as a regular c function in <code>myfunction.c</code> with the correspondinc header <code>myfunction.h</code>.</p>\n\n<p>For compiling the app I am using <code>stack ghc src/Main.hs src/myfunction.c</code></p>\n\n<p>All of my sources are located under the <code>src</code> directory of my project.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 2051, "user_id": 4887726, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/381a9c57be405fa215c388f62ed7ddf7?s=128&d=identicon&r=PG&f=1", "display_name": "LoranceChen", "link": "https://stackoverflow.com/users/4887726/lorancechen"}, "edited": false, "score": 0, "creation_date": 1480757966, "post_id": 40946190, "comment_id": 69103025, "body": "@Alec, thx,it works.But the name ways is misleading."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 1, "last_activity_date": 1480757981, "creation_date": 1480757981, "answer_id": 40946345, "question_id": 40946190, "link": "https://stackoverflow.com/questions/40946190/haskell-stack-global-ghc-version-not-match-when-use-stack-install-happy/40946345#40946345", "title": "haskell stack global ghc version not match when use stack install happy", "body": "<p>The error message is telling you that you are using GHC 7.10.3 but <code>lts-7.10</code> is meant for GHC 8.0.1. You can do one of two things:</p>\n\n<ul>\n<li>Keep GHC 7.10.3 and change your revolver to <a href=\"https://www.stackage.org/lts-6.26\" rel=\"nofollow noreferrer\"><code>lts-6.26</code></a> (the newest resolver for 7.10.3 as of December 2, 2016)</li>\n<li>Do what it suggests and run <code>stack setup</code>. That will automatically install GHC 8.0.1 since that is what your resolver is expecting.</li>\n</ul>\n"}], "owner": {"reputation": 2051, "user_id": 4887726, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/381a9c57be405fa215c388f62ed7ddf7?s=128&d=identicon&r=PG&f=1", "display_name": "LoranceChen", "link": "https://stackoverflow.com/users/4887726/lorancechen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 40946345, "answer_count": 1, "score": 1, "last_activity_date": 1480757981, "creation_date": 1480756862, "question_id": 40946190, "link": "https://stackoverflow.com/questions/40946190/haskell-stack-global-ghc-version-not-match-when-use-stack-install-happy", "title": "haskell stack global ghc version not match when use stack install happy", "body": "<p>I have follow this cmd:</p>\n\n<p>check ghc on PATH</p>\n\n<pre><code>root@9a79ab5e17cb:~# ghc --version\nThe Glorious Glasgow Haskell Compilation System, version 7.10.3\n</code></pre>\n\n<p>setup stack global ghc version</p>\n\n<pre><code>root@9a79ab5e17cb:~# stack setup 7.10.3\nstack will use the GHC on your PATH\nFor more information on paths, see 'stack path' and 'stack exec env'\nTo use this GHC and packages outside of a project, consider using:\nstack ghc, stack ghci, stack runghc, or stack exec\n</code></pre>\n\n<p>after set stack global resolver:</p>\n\n<pre><code>cat /root/.stack/global-project/stack.yaml  \nflags: {}\nextra-package-dbs: []\npackages: []\nextra-deps: []\nresolver: lts-7.10\n</code></pre>\n\n<p>install happy fail >.&lt;</p>\n\n<pre><code>root@9a79ab5e17cb:~# stack install happy\nRun from outside a project, using implicit global project config\nUsing resolver: lts-7.10 from implicit global project's config file: /root/.stack/global-project/stack.yaml\nCompiler version mismatched, found ghc-7.10.3 (x86_64), but expected minor version match with ghc-8.0.1 (x86_64) (based on resolver setting in /root/.stack/global-project/stack.yaml).\nTry running \"stack setup\" to install the correct GHC into /root/.stack/programs/x86_64-linux/\n</code></pre>\n\n<p>How can I change stack ghc global version?</p>\n"}, {"tags": ["function", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 535, "user_id": 5899439, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-TRcyChltFH8/AAAAAAAAAAI/AAAAAAAAADI/BM0RqbMXv0I/photo.jpg?sz=128", "display_name": "James Yeoman", "link": "https://stackoverflow.com/users/5899439/james-yeoman"}, "edited": false, "score": 0, "creation_date": 1480755464, "post_id": 40945985, "comment_id": 69102425, "body": "That worked. Thanks. By the way, why do I need to use backticks when defining it. If I don&#39;t use them when defining, I get a compile error saying that the function lacks an accompanying binding"}, {"owner": {"reputation": 535, "user_id": 5899439, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-TRcyChltFH8/AAAAAAAAAAI/AAAAAAAAADI/BM0RqbMXv0I/photo.jpg?sz=128", "display_name": "James Yeoman", "link": "https://stackoverflow.com/users/5899439/james-yeoman"}, "edited": false, "score": 0, "creation_date": 1480755642, "post_id": 40945985, "comment_id": 69102482, "body": "I found out that backticks are the way to do it by looking at the definition of xor in the Data.Boolean package but I don&#39;t know WHY they are needed."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 535, "user_id": 5899439, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-TRcyChltFH8/AAAAAAAAAAI/AAAAAAAAADI/BM0RqbMXv0I/photo.jpg?sz=128", "display_name": "James Yeoman", "link": "https://stackoverflow.com/users/5899439/james-yeoman"}, "edited": false, "score": 2, "creation_date": 1480755788, "post_id": 40945985, "comment_id": 69102512, "body": "@JamesYeoman All Haskell functions with non-symbolic names are ordinary prefix functions, not infix operators. You can turn an infix operator into a prefix function by surrounding it with parentheses (like <code>(+)</code>), and likewise, you can turn a prefix function into an infix operator by surrounding it with backticks (like <code>`elem`</code>)."}, {"owner": {"reputation": 535, "user_id": 5899439, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-TRcyChltFH8/AAAAAAAAAAI/AAAAAAAAADI/BM0RqbMXv0I/photo.jpg?sz=128", "display_name": "James Yeoman", "link": "https://stackoverflow.com/users/5899439/james-yeoman"}, "edited": false, "score": 0, "creation_date": 1480756100, "post_id": 40945985, "comment_id": 69102574, "body": "Thanks. I am teaching myself Haskell before we actually start learning it in Computer Science. It is my first Functional Programming language. Brain.exe is not responding..."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 535, "user_id": 5899439, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-TRcyChltFH8/AAAAAAAAAAI/AAAAAAAAADI/BM0RqbMXv0I/photo.jpg?sz=128", "display_name": "James Yeoman", "link": "https://stackoverflow.com/users/5899439/james-yeoman"}, "edited": false, "score": 1, "creation_date": 1480763573, "post_id": 40945985, "comment_id": 69104412, "body": "@JamesYeoman If you wrote <code>x equals y = ...</code> that looks exactly the same to the compiler as <code>func a b = ...</code>. There&#39;s no possible way for it to know that in the first case  the <b>second</b> name is the function you&#39;re defining (and the other two are local names for its arguments), while in the other the first name is the function. So Haskell adopts a very simple syntactic rule: alphanumeric names are always prefix functions and symbolic names are always infix operators. That means <code>x equals y = ...</code> is defining a function <code>x</code>; <code>equals</code> is just a local name for one of its arguments."}, {"owner": {"reputation": 535, "user_id": 5899439, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-TRcyChltFH8/AAAAAAAAAAI/AAAAAAAAADI/BM0RqbMXv0I/photo.jpg?sz=128", "display_name": "James Yeoman", "link": "https://stackoverflow.com/users/5899439/james-yeoman"}, "edited": false, "score": 0, "creation_date": 1480835300, "post_id": 40945985, "comment_id": 69122121, "body": "Thanks for the help. All of this is going to help out a lot with the understanding when we come to actually start to be taught Haskell after Christmas. Every time I learn a new language, I always have a go teaching myself the language first before getting taught. It helps so much having the lessons when I have already got a basic understanding because I can then focus on the intricacies. Best of luck to you all with your goals"}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 7, "last_activity_date": 1480755296, "creation_date": 1480755296, "answer_id": 40945985, "question_id": 40945962, "link": "https://stackoverflow.com/questions/40945962/how-do-i-declare-an-operator-that-takes-2-arguments-and-uses-letters-rather-th/40945985#40945985", "title": "How do I declare an &#39;operator&#39; that takes 2 arguments and uses letters rather than symbols?", "body": "<p>You need to use backticks around <code>equal</code> when you call it, exactly as you did to define it.</p>\n\n<pre><code>5 `equal` 5\n</code></pre>\n\n<p>The way you wrote it, Haskell thinks you're trying to pass <code>equal</code> as an argument to <code>5</code>, rather than the other way around.</p>\n"}], "owner": {"reputation": 535, "user_id": 5899439, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-TRcyChltFH8/AAAAAAAAAAI/AAAAAAAAADI/BM0RqbMXv0I/photo.jpg?sz=128", "display_name": "James Yeoman", "link": "https://stackoverflow.com/users/5899439/james-yeoman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 40945985, "answer_count": 1, "score": 1, "last_activity_date": 1480767874, "creation_date": 1480755126, "last_edit_date": 1480767874, "question_id": 40945962, "link": "https://stackoverflow.com/questions/40945962/how-do-i-declare-an-operator-that-takes-2-arguments-and-uses-letters-rather-th", "title": "How do I declare an &#39;operator&#39; that takes 2 arguments and uses letters rather than symbols?", "body": "<p>I want to be able to make operators such as found in VB(.net) like shown below</p>\n\n<pre><code>Console.WriteLine ( 16 Mod 2 )\n</code></pre>\n\n<p>produces an output shown below</p>\n\n<pre><code>0\n</code></pre>\n\n<p><br/>\nAs you can see, this makes code slightly easier to read. How would I go about making functions that do this?</p>\n\n<p>I have tried the following format</p>\n\n<pre><code>equal :: Integer -&gt; Integer -&gt; bool\nx `equal` y = x == y\n</code></pre>\n\n<p>and I get the following error</p>\n\n<pre><code>*Main&gt; 5 equal 5\n\n&lt;interactive&gt;:1:1: error:\n    * Non type-variable argument\n        in the constraint: Num ((Integer -&gt; Integer -&gt; Bool) -&gt; t -&gt; t1)\n      (Use FlexibleContexts to permit this)\n    * When checking the inferred type\n        it :: forall t t1.\n              (Num ((Integer -&gt; Integer -&gt; Bool) -&gt; t -&gt; t1), Num t) =&gt;\n              t1\n*Main&gt;\n</code></pre>\n\n<p>What is going wrong and how do I do it correctly?</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1480744123, "post_id": 40944165, "comment_id": 69100375, "body": "This will save me so much time! Thank you!"}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1480804227, "post_id": 40944165, "comment_id": 69116134, "body": "Does it work as intended? I did not actually test it"}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1480816411, "post_id": 40944165, "comment_id": 69118746, "body": "It does indeed. Caveats: your file name must match the module name, and you must export <code>main</code>"}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1480866024, "post_id": 40944165, "comment_id": 69129785, "body": "Right, but that is generally the case with modules, nothing special about these. I\u2019ll expand the answer."}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": true, "score": 7, "last_activity_date": 1480866138, "last_edit_date": 1480866138, "creation_date": 1480738604, "answer_id": 40944165, "question_id": 40944108, "link": "https://stackoverflow.com/questions/40944108/typechecking-multiple-mains/40944165#40944165", "title": "Typechecking multiple &#39;Main&#39;s", "body": "<p>Cabal\u2019s <code>main-is</code> option only tells Cabal what filename it should pass to GHC. Cabal does not care about it\u2019s module name.</p>\n\n<p>GHC itself has a flag, also called <code>-main-is</code>, <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/phases.html#ghc-flag--main-is\" rel=\"nofollow noreferrer\">documented here</a> which tells the compiler what module conains the <code>main</code> function.</p>\n\n<p>So this works:</p>\n\n<pre><code>executable foo\n  main-is: Foo.hs\n  ghc-options: -main-is Foo\n</code></pre>\n\n<p>Of course <code>Foo.hs</code> should start with <code>module Foo where\u2026</code> and export <code>main</code>. As usual, the module name and file name needs to match.</p>\n\n<p>This way, all executable can have different module names and you can load them all in GHCi.</p>\n\n<p>If you also want to change the name of the main function, write <code>ghc-options: -main-is Foo.fooMain</code>. I would guess you could even have all executables have the same <em>module</em> but different <em><code>main</code>-functions</em> this way.</p>\n"}], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 726, "favorite_count": 0, "accepted_answer_id": 40944165, "answer_count": 1, "score": 4, "last_activity_date": 1480866138, "creation_date": 1480737821, "question_id": 40944108, "link": "https://stackoverflow.com/questions/40944108/typechecking-multiple-mains", "title": "Typechecking multiple &#39;Main&#39;s", "body": "<p>I have a Haskell library with several executables (tests, benchmarks, etc), in total about six. When I do some refactoring in the library, I usually need to make some small change to each of the executables.</p>\n\n<p>In my current workflow, I separately compile each executable (say, with GHCi) and fix each one up. This is tedious because I have to type out the path to each executable, and moreover have to reload all of the (very large) library, which even with GHCi takes some time.  </p>\n\n<p>My first thought to solve this issue was to create a single dummy module that imports the executable \"Main\" modules. However, this (of course) requires that the \"Main\" modules have a module name like <code>module Executable1 where ...</code>. But now cabal complains when compiling the executable that it can't find a module called \"Main\" (despite explicitly listing \"main-is\" in the cabal file for each executable.)</p>\n\n<p>I also tried <code>ghci Exec1.hs Exec2.hs ...</code>, but it complains <code>module \u2018main@main:Main\u2019 is defined in multiple files</code>.</p>\n\n<p>Is there an easy way to load multiple \"Main\" modules at once with GHCi so I can typecheck them simultaneously?</p>\n"}, {"tags": ["scala", "haskell", "types", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 10, "last_activity_date": 1480706728, "creation_date": 1480706728, "answer_id": 40939571, "question_id": 40939508, "link": "https://stackoverflow.com/questions/40939508/translate-a-scala-type-example-to-haskell/40939571#40939571", "title": "Translate a Scala Type example to Haskell", "body": "<p>I would do something like</p>\n\n<pre><code>data Open = Open deriving (Show)\ndata Closed = Closed deriving (Show)\ndata Door door_state = Door deriving (Show)\n\nopen :: Door Closed -&gt; Door Open\nopen _ = Door\n\nclose :: Door Open -&gt; Door Closed\nclose _ = Door\n</code></pre>\n\n<p>Now there aren't any cases to consider, the state itself is encoded in the type, as with the Scala example.</p>\n"}, {"comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1480707552, "post_id": 40939719, "comment_id": 69090933, "body": "You beat me to the <code>DataKinds</code> answer.  I didn&#39;t want to post it without first checking it compiled, but I had to run <code>stack setup</code> first, and that takes a while on a slow network, lol. I like the <code>toggle</code> idea with <code>TypeFamilies</code> though, hadn&#39;t thought of that one."}, {"owner": {"reputation": 1061, "user_id": 2946529, "user_type": "registered", "profile_image": "https://graph.facebook.com/890945556/picture?type=large", "display_name": "Nigel Benns", "link": "https://stackoverflow.com/users/2946529/nigel-benns"}, "edited": false, "score": 0, "creation_date": 1480709048, "post_id": 40939719, "comment_id": 69091562, "body": "Nice, I don&#39;t think I would have come to this myself, still learning the advanced features of the language."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480715613, "post_id": 40939719, "comment_id": 69094349, "body": "For better inference, <code>toggle :: (s ~ Toggle t, t ~ Toggle s) =&gt; Door s -&gt; Door t</code>. Or <code>class Toggled s t | s -&gt; t, t -&gt; s where toggle :: Door s -&gt; Door t</code>. You could probably use an injective type family for GHC 8, but I don&#39;t buy those yet."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1480716522, "post_id": 40939719, "comment_id": 69094717, "body": "@dfeuer Clever trick for inference! What made you think of it (ie. is this a particular case for a more general pattern)?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1480717637, "post_id": 40939719, "comment_id": 69095105, "body": "@Alec, it certainly is a special case of a more general pattern! You should always think about it when your type family is injective. But even if it&#39;s not, look for opportunities to constrain each type variable in terms of one or more of the others."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480798975, "post_id": 40939719, "comment_id": 69114675, "body": "The <code>lens</code> package is full of such inference aids if you want to see more examples. Many/most of them are expressed as MPTCs with fundeps, but it&#39;s easy to translate to type family language. A good example is <code>class Tuple1 s t a b | s -&gt; a, t -&gt; b, s b -&gt; t, t a -&gt; s where _1 :: Lens s t a b</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480800090, "post_id": 40939719, "comment_id": 69115003, "body": "The <code>Tuple1</code> fundeps record certain facts about how tuple-like types are structured and how type-changing lenses for them can behave. A far less useful constructor class, <code>class Tuple1P p where _1&#39; :: Lens (p a) (p b) a b</code>, would effectively have these dependencies automatically."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 18, "last_activity_date": 1480709422, "last_edit_date": 1480709422, "creation_date": 1480707457, "answer_id": 40939719, "question_id": 40939508, "link": "https://stackoverflow.com/questions/40939508/translate-a-scala-type-example-to-haskell/40939719#40939719", "title": "Translate a Scala Type example to Haskell", "body": "<p>In addition to bheklilr's answer, you could use some type extensions to get even closer to the Scala example and rule out non-sensical types like</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Door String\n</code></pre>\n\n<p>Using <code>DataKinds</code>, you could effectively disallow the phantom type from being anything but a <code>Status</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE DataKinds #-}\n\ndata Door (status :: Status) = Door\ndata Status = Open | Closed\n\nopen :: Door Closed -&gt; Door Open\nopen _ = Door\n\nclose :: Door Open -&gt; Door Closed\nclose _ = Door\n</code></pre>\n\n<p>Then, with type families, we could even define what it means to \"toggle\" a door</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE TypeFamilies #-}\n\ntype family Toggle (s :: Status) where\n  Toggle Open = Closed\n  Toggle Closed = Open\n\ntoggle :: Door s -&gt; Door (Toggle s)\ntoggle Door = Door\n</code></pre>\n\n<hr>\n\n<p>As a closing thought, it may be nicer to use a GADT for <code>Door</code> - just so you have two different constructor names. I personally think this reads better</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE GADTs, DataKinds, TypeFamilies #-}\n\ndata Door (status :: Status) where\n  OpenDoor :: Door Open\n  ClosedDoor :: Door Closed\n\nopen :: Door Closed -&gt; Door Open\nopen _ = OpenDoor\n\nclose :: Door Open -&gt; Door Closed\nclose _ = ClosedDoor\n\ntoggle :: Door s -&gt; Door (Toggle s)\ntoggle OpenDoor = ClosedDoor\ntoggle ClosedDoor = OpenDoor\n</code></pre>\n"}], "owner": {"reputation": 1061, "user_id": 2946529, "user_type": "registered", "profile_image": "https://graph.facebook.com/890945556/picture?type=large", "display_name": "Nigel Benns", "link": "https://stackoverflow.com/users/2946529/nigel-benns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "accepted_answer_id": 40939719, "answer_count": 2, "score": 10, "last_activity_date": 1480896732, "creation_date": 1480706464, "last_edit_date": 1480896732, "question_id": 40939508, "link": "https://stackoverflow.com/questions/40939508/translate-a-scala-type-example-to-haskell", "title": "Translate a Scala Type example to Haskell", "body": "<p>I found a really interesting example in a Scala article and I am wondering how it might be encoded in Haskell.</p>\n\n<pre><code>trait Status\ntrait Open extends Status\ntrait Closed extends Status\n\ntrait Door[S &lt;: Status]\nobject Door {\n  def apply[S &lt;: Status] = new Door[S] {}\n\n  def open[S &lt;: Closed](d: Door[S]) = Door[Open]\n  def close[S &lt;: Open](d: Door[S]) = Door[Closed]\n}\n\nval closedDoor = Door[Closed]\nval openDoor = Door.open(closedDoor)\nval closedAgainDoor = Door.close(openDoor)\n\n//val closedClosedDoor = Door.close(closedDoor) // fails to compile\n//val openOpenDoor = Door.open(openDoor) // fails to compile\n</code></pre>\n\n<p>This sample encodes at the type level that you can only open a closed <code>Door</code>, and only close an open <code>Door</code>. My first attempt was just using simple data types but doesn't work as intended:</p>\n\n<pre><code>data Status = Open | Closed deriving (Show)\ndata Door = Door Status deriving (Show)\n\nopen :: Door -&gt; Door\nopen (Door Closed) = Door Open\n\nclose :: Door -&gt; Door\nclose (Door Open) = Door Closed\n\nmain = do\n  let closedDoor = (Door Closed)\n  let openDoor = open closedDoor\n  let closedAgainDoor = close openDoor\n  let closeClosedDoor = close closedDoor\n  let openOpenedDoor = open openDoor\n  print closedAgainDoor\n</code></pre>\n\n<p>This actually compiles (unless I try to print <code>closeClosedDoor</code> or <code>openOpenedDoor</code> which then complains about non-exhaustive patterns in function open, which is obvious)</p>\n\n<p>So I'm trying to figure out if GADTs our Type Families can accomplish this task, but I'm not able to grasp how yet.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 2, "creation_date": 1480693448, "post_id": 40935878, "comment_id": 69083127, "body": "Is that the entire type? Or is there a context like <code>(Foldable b) =&gt; a -&gt; b Bool</code>?"}, {"owner": {"reputation": 617, "user_id": 1437859, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c802c9064bfc167b3853d3d627f50f3c?s=128&d=identicon&r=PG", "display_name": "Catherine Holloway", "link": "https://stackoverflow.com/users/1437859/catherine-holloway"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1480693758, "post_id": 40935878, "comment_id": 69083333, "body": "I didn&#39;t get any more context about the type, I&#39;m seeing a -&gt; b Bool for the first time through a hugs Type error:  *** Does not match : a -&gt; b Bool"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 3, "creation_date": 1480694186, "post_id": 40935878, "comment_id": 69083643, "body": "Could you add the code that results in that error?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 2, "creation_date": 1480695010, "post_id": 40935878, "comment_id": 69084207, "body": "Since you indicate that you&#39;re an absolute beginner: you&#39;re either just seeing a syntax error, or you&#39;re waaay out of your depth. The first step towards understanding this would be to learn about <code>Maybe</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1480704618, "post_id": 40935878, "comment_id": 69089591, "body": "e.g. <code>g x = pure True</code> has a type <code>Applicative f =&gt; t -&gt; f Bool</code>."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1480706311, "post_id": 40935878, "comment_id": 69090407, "body": "Is there a particular bit of code that this is from? If so, it would help us to answer if you provide that part as well."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1480710090, "post_id": 40935878, "comment_id": 69092026, "body": "Asking what a fragment of an error message means is not a good way to get help, here or anywhere else. You must post the code to avoid having the question closed as off-topic. You should also post the full text of the error message if it&#39;s less than 20 lines or so."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1480711337, "post_id": 40935878, "comment_id": 69092513, "body": "Also, Hugs is obsolete. I know there&#39;s still a teacher using it for his classes, but everyone else has been using GHCi for the last ten-plus years. You probably should do the same."}], "answers": [{"comments": [{"owner": {"reputation": 617, "user_id": 1437859, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c802c9064bfc167b3853d3d627f50f3c?s=128&d=identicon&r=PG", "display_name": "Catherine Holloway", "link": "https://stackoverflow.com/users/1437859/catherine-holloway"}, "edited": false, "score": 1, "creation_date": 1480693693, "post_id": 40935977, "comment_id": 69083278, "body": "I&#39;m an absolute beginner, this answer has a lot of things I don&#39;t understand. I don&#39;t completely understand what Maybe means, and I also don&#39;t understand what the symbol \u22a5 here indicates."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 617, "user_id": 1437859, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c802c9064bfc167b3853d3d627f50f3c?s=128&d=identicon&r=PG", "display_name": "Catherine Holloway", "link": "https://stackoverflow.com/users/1437859/catherine-holloway"}, "edited": false, "score": 1, "creation_date": 1480693835, "post_id": 40935977, "comment_id": 69083390, "body": "The symbol \u22a5 is called &quot;bottom&quot;, and it basically means &quot;pathological terms&quot; such as those which throw errors or loop for ever. My favourite Haskell beginners&#39; book is <i>Learn You A Haskell For Great Good</i>, which you can <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">read online for free</a>. Good luck learning this beautiful language!"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 3, "last_activity_date": 1480694185, "last_edit_date": 1480694185, "creation_date": 1480693466, "answer_id": 40935977, "question_id": 40935878, "link": "https://stackoverflow.com/questions/40935878/what-does-the-type-a-b-bool-mean-in-haskell/40935977#40935977", "title": "What does the type a -&gt; b Bool mean in Haskell?", "body": "<p>It might be clearer if you write it out with explicit quantification and kind annotations. <code>a -&gt; b Bool</code> means...</p>\n\n<pre><code>forall (a :: *) (b :: * -&gt; *). a -&gt; b Bool\n</code></pre>\n\n<p><code>b</code> is therefore a <em>type constructor</em> taking a single type argument. Examples of single-argument type constructors abound: <code>Maybe</code>, <code>[]</code>, <code>IO</code> are all examples of things which you could use to instantiate <code>b</code>.</p>\n\n<p>A function <code>f :: a -&gt; b Bool</code> takes an argument of any type <code>a</code>; its return value is the type constructor of your choice with its parameter filled in as <code>Bool</code>.</p>\n\n<p>Parametricity tells us that there aren't any (non-\u22a5) terms with such a type.</p>\n"}, {"comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1480698175, "post_id": 40936020, "comment_id": 69086270, "body": "@ThomasM.DuBuisson In the context of a type error messages, that does not apply though. When the compiler says that it expects the type <code>a -&gt; b Bool</code> that does not mean that the function really needs to have that exact type - you can give it a function <code>Int -&gt; Maybe Bool</code> and it will be satisfied."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1480702104, "post_id": 40936020, "comment_id": 69088293, "body": "Quite true, how sloppy of me."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1480721081, "post_id": 40936020, "comment_id": 69096172, "body": "@sepp2k ... unless <code>b</code> is rigid"}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 7, "last_activity_date": 1480704112, "last_edit_date": 1480704112, "creation_date": 1480693592, "answer_id": 40936020, "question_id": 40935878, "link": "https://stackoverflow.com/questions/40935878/what-does-the-type-a-b-bool-mean-in-haskell/40936020#40936020", "title": "What does the type a -&gt; b Bool mean in Haskell?", "body": "<p>In <code>b Bool</code>, <code>b</code> stands for a parametrized type that takes one type parameter (in Haskell parlance, <code>b</code> is a type constructor of kind <code>* -&gt; *</code>), such as <code>Maybe</code>, <code>IO</code> or <code>[]</code>.</p>\n\n<p>So a function of type <code>a -&gt; b Bool</code> could for example take an <code>Int</code> and produce a <code>Maybe Bool</code>, <code>IO Bool</code>, <code>[Bool]</code> etc.</p>\n"}, {"tags": [], "owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "is_accepted": false, "score": 4, "last_activity_date": 1480693801, "creation_date": 1480693801, "answer_id": 40936087, "question_id": 40935878, "link": "https://stackoverflow.com/questions/40935878/what-does-the-type-a-b-bool-mean-in-haskell/40936087#40936087", "title": "What does the type a -&gt; b Bool mean in Haskell?", "body": "<p>In this case <code>b</code> is a higher kinded type, i.e. a function from types to types. Sounds scary? Fear not! A higher kinded type is something like the list type. <code>([])</code> on it's own is not a type, but it still takes an argument to become one, so <code>([]) Int = [Int]</code> is a type.</p>\n\n<p>Kinds are like the types of types and the kind of a fully applied type is <code>*</code>. The kind of list on the other hand is <code>* -&gt; *</code>. So it takes a type <code>*</code> (e.g. <code>Int</code>) and returns a type (e.g. <code>[Int]</code>). Other examples would be <code>Maybe</code>, <code>IO</code> or the function type <code>(-&gt;)</code> which has kind <code>* -&gt; * -&gt; *</code> because it still takes to types, an argument type and a result type (e.g. <code>(-&gt;) Int Bool = Int -&gt; Bool</code>).</p>\n\n<p>The function that you have given is actually impossible to implement, just like a function of type <code>a -&gt; b</code>. However a function we could implement is the following:</p>\n\n<pre><code>pureEq :: (Eq a, Applicative b) =&gt; a -&gt; a -&gt; b Bool\npureEq x y = pure (x == y)\n</code></pre>\n"}], "owner": {"reputation": 617, "user_id": 1437859, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c802c9064bfc167b3853d3d627f50f3c?s=128&d=identicon&r=PG", "display_name": "Catherine Holloway", "link": "https://stackoverflow.com/users/1437859/catherine-holloway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1480704112, "creation_date": 1480693120, "question_id": 40935878, "link": "https://stackoverflow.com/questions/40935878/what-does-the-type-a-b-bool-mean-in-haskell", "title": "What does the type a -&gt; b Bool mean in Haskell?", "body": "<p>I know that type:</p>\n\n<pre><code>a -&gt; Bool\n</code></pre>\n\n<p>is a function that takes as input something of type a and outputs a boolean.</p>\n\n<p>What does type:</p>\n\n<pre><code>a -&gt; b Bool\n</code></pre>\n\n<p>mean?</p>\n"}, {"tags": ["haskell", "syntax", "switch-statement", "indentation"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1480689061, "post_id": 40934464, "comment_id": 69080157, "body": "If you just wanna minimise the line noise from a complex pattern you could wrap it up in a pattern synonym, or put the <code>case</code> expression in a higher-order function a la <code>maybe</code>/<code>either</code>/<code>foldr</code>"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 7, "last_activity_date": 1480691456, "last_edit_date": 1495540382, "creation_date": 1480691456, "answer_id": 40935332, "question_id": 40934464, "link": "https://stackoverflow.com/questions/40934464/why-is-it-a-syntax-error-to-linebreak-case-matches-without-extra-indentation-an/40935332#40935332", "title": "Why is it a syntax error to linebreak case matches without extra indentation, and what&#39;s the recommended style to get around it?", "body": "<p>By the <a href=\"https://stackoverflow.com/a/33010779/3234959\">indentation rules</a>, the code</p>\n\n<pre><code>foo = case ((), ()) of\n       ( ()\n       , () ) -&gt; ()\n</code></pre>\n\n<p>is desugared to</p>\n\n<pre><code>foo = case ((), ()) of\n       { ( ()\n       ; , () ) -&gt; ()\n       }\n</code></pre>\n\n<p>which is a <code>case</code> with two branches, the first one being a syntax error.</p>\n\n<p>I would recommend the following style instead:</p>\n\n<pre><code>foo = case ((), ()) of\n       (( ()\n        , () )) -&gt; ()\n</code></pre>\n\n<p>or even (not extremely elegant, though)</p>\n\n<pre><code>foo = case ((), ()) of\n       _@( ()\n         , () ) -&gt; ()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 1, "last_activity_date": 1480701829, "creation_date": 1480701829, "answer_id": 40938380, "question_id": 40934464, "link": "https://stackoverflow.com/questions/40934464/why-is-it-a-syntax-error-to-linebreak-case-matches-without-extra-indentation-an/40938380#40938380", "title": "Why is it a syntax error to linebreak case matches without extra indentation, and what&#39;s the recommended style to get around it?", "body": "<p>You could also just rewrite the pattern match as</p>\n\n<pre><code>   (Complicated (Pattern match) to (unwrap),\n    Expression that's (Again not so short)) -&gt; the Rest of my Code\n</code></pre>\n\n<p>I know it's incompatible with your style, but I think there is no real reason to use that style for tuples (aside from consistency).</p>\n"}], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1480701829, "creation_date": 1480688823, "last_edit_date": 1480689206, "question_id": 40934464, "link": "https://stackoverflow.com/questions/40934464/why-is-it-a-syntax-error-to-linebreak-case-matches-without-extra-indentation-an", "title": "Why is it a syntax error to linebreak case matches without extra indentation, and what&#39;s the recommended style to get around it?", "body": "<p>I just discovered that this</p>\n\n<pre><code>foo = case ((), ()) of\n       ( ()\n       , () ) -&gt; ()\n</code></pre>\n\n<p>fails with</p>\n\n<pre><code>/tmp/wtmpf-file11080.hs:3:8:\n    parse error (possibly incorrect indentation or mismatched brackets)\n</code></pre>\n\n<p>This can be made to work by indenting the second line of the pattern</p>\n\n<pre><code>foo = case ((), ()) of\n       ( ()\n        , () ) -&gt; ()\n</code></pre>\n\n<p>but this feels inconsistent with my usual style, especially in</p>\n\n<pre><code>bar = case ( some lengthy :: Complicated typed expression\n           , another also lengthy :: Expression with (Other types) ) of\n       ( Complicated (Pattern match) to (unwrap)\n       , Expression that's (Again not so short) ) -&gt; the Rest of my Code\n</code></pre>\n\n<p>How should the above be rewritten / formatted to look most consistent?</p>\n"}, {"tags": ["haskell", "generics", "types", "module"], "answers": [{"tags": [], "owner": {"reputation": 336, "user_id": 7236501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f52887fba37383964c102def911c9bc?s=128&d=identicon&r=PG&f=1", "display_name": "shinobi", "link": "https://stackoverflow.com/users/7236501/shinobi"}, "is_accepted": false, "score": 3, "last_activity_date": 1480690427, "creation_date": 1480690427, "answer_id": 40935008, "question_id": 40934263, "link": "https://stackoverflow.com/questions/40934263/haskell-generic-type-to-generic-and-int/40935008#40935008", "title": "Haskell : Generic type to generic and INT", "body": "<p>If you're trying to build a stack machine in the manner of FORTH, for example (as your specification of <code>size</code> suggests,) using <code>[a]</code> for the stack isn't likely to do the trick.</p>\n\n<p>A simple and straightforward way to do it would be first to decide on what primitive data types your machine is going to work on, then create a data type with a constructor for each separate type, e.g.:</p>\n\n<pre><code>data Data = I Int | S String | Error String\n    deriving Show -- for convenience only\n</code></pre>\n\n<p>Then, the state of your stack machine would be of type <code>[Data]</code> -- in this case, it would let you do computations on ints and strings, as well as handle errors \"out-of-band\".</p>\n\n<p>Then your <code>size</code> operator would look like this:</p>\n\n<pre><code>size :: [Data] -&gt; [Data]\nsize xs = I (length xs) : xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": false, "score": 1, "last_activity_date": 1480714349, "creation_date": 1480714349, "answer_id": 40941142, "question_id": 40934263, "link": "https://stackoverflow.com/questions/40934263/haskell-generic-type-to-generic-and-int/40941142#40941142", "title": "Haskell : Generic type to generic and INT", "body": "<p>If you really want this, you can do like this:</p>\n\n<pre><code>import Data.List\n\nsize :: Num a =&gt; Stack a -&gt; Stack a\nsize (S xs) = S (sizeAux xs)\n\nsizeAux :: Num a =&gt; [a] -&gt; [a]\nsizeAux xs = genericLength xs : xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 2, "last_activity_date": 1480734720, "creation_date": 1480734720, "answer_id": 40943872, "question_id": 40934263, "link": "https://stackoverflow.com/questions/40934263/haskell-generic-type-to-generic-and-int/40943872#40943872", "title": "Haskell : Generic type to generic and INT", "body": "<p>I agree with @shinobi, that using an ADT is probably the best way to go.  But I just want to bring your awareness to a sexy approach, which is to use a typed stack:</p>\n\n<pre><code>{-# LANGUAGE TypeOperators #-}\n\ndata Empty = Empty\ndata x :&gt; xs = x :&gt; xs\ninfixr 5 :&gt;\n\nclass Stack a where sizeAux :: a -&gt; Int\ninstance Stack Empty where sizeAux _ = 0\ninstance (Stack xs) =&gt; Stack (x :&gt; xs) where \n    sizeAux (_ :&gt; xs) = 1 + size xs\n\n-- Here the head can be a different type from the rest of the stack,\n-- and that is known statically.\nsize :: (Stack xs) =&gt; xs -&gt; Int :&gt; xs\nsize xs = sizeAux xs :&gt; xs\n\ndup :: x :&gt; xs -&gt; x :&gt; x :&gt; xs\ndup (x :&gt; xs) = x :&gt; x :&gt; xs\n\nadd :: Int :&gt; Int :&gt; xs -&gt; Int :&gt; xs\nadd (x :&gt; y :&gt; xs) = (x + y) :&gt; xs\n\n-- etc.\n</code></pre>\n"}], "owner": {"reputation": 606, "user_id": 3497258, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/35f880339f03352b8e66231498e25779?s=128&d=identicon&r=PG&f=1", "display_name": "eXistanCe", "link": "https://stackoverflow.com/users/3497258/existance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1480734720, "creation_date": 1480688177, "question_id": 40934263, "link": "https://stackoverflow.com/questions/40934263/haskell-generic-type-to-generic-and-int", "title": "Haskell : Generic type to generic and INT", "body": "<p>I am developing a Stack module for a college project.\nIts suposed to be a list of generic \"tokens\" thus i used this constructor:</p>\n\n<pre><code>module Stack (Stack(S), dup, swap, pop, size) where\n\nimport Prelude\n\ndata Stack a = S [a]\n</code></pre>\n\n<p>But on the size operation, im suposed to add the size of the list to its head, like this:</p>\n\n<pre><code>size[1,2,3,4] = [4,1,2,3,4]\n</code></pre>\n\n<p>But i cant seem to define this function, since in the signature its receives a generic list and returns a generic list, but in reality its returning a generic list with an INT</p>\n\n<pre><code>size :: Stack a -&gt; Stack a\nsize (S xs) = S(sizeAux xs)\n\nsizeAux :: [a] -&gt; [a]\nsizeAux [] = [0]\nsizeAux xs = length xs:xs\n</code></pre>\n\n<p>I have tried using Show like </p>\n\n<pre><code>sizeAux :: [a] -&gt; [a]\nsizeAux [] = [\"0\"]\nsizeAux xs = show((length xs)):xs\n</code></pre>\n\n<p>but i get the same error, only this time with [Char]</p>\n\n<p>Is there any way to bypass this without changing the Stack constructor to something like [String]? Any help will be apreciated thanks.</p>\n"}, {"tags": ["list", "haskell", "ghc", "multiline", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 1027, "user_id": 230814, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/66d28058eef8a3171e5b85dd8f9bf08c?s=128&d=identicon&r=PG", "display_name": "Scoobie", "link": "https://stackoverflow.com/users/230814/scoobie"}, "edited": false, "score": 0, "creation_date": 1480685254, "post_id": 40933310, "comment_id": 69077567, "body": "What about if I were to compile the code with <code>ghc</code> (not <code>ghci</code>)"}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "reply_to_user": {"reputation": 1027, "user_id": 230814, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/66d28058eef8a3171e5b85dd8f9bf08c?s=128&d=identicon&r=PG", "display_name": "Scoobie", "link": "https://stackoverflow.com/users/230814/scoobie"}, "edited": false, "score": 0, "creation_date": 1480685576, "post_id": 40933310, "comment_id": 69077764, "body": "In a source file you don&#39;t need <code>:{ :}</code>. You just write normal Haskell. <code>:{ :}</code> are just there to keep GHCi from evaluating your code and throwing errors at you after the first newline."}, {"owner": {"reputation": 1027, "user_id": 230814, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/66d28058eef8a3171e5b85dd8f9bf08c?s=128&d=identicon&r=PG", "display_name": "Scoobie", "link": "https://stackoverflow.com/users/230814/scoobie"}, "edited": false, "score": 0, "creation_date": 1480685896, "post_id": 40933310, "comment_id": 69077980, "body": "That multi-line code doesn&#39;t compile in <code>ghc</code> either.      let foo = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]      let bar = [&quot;a&quot;,                &quot;b&quot;,                &quot;c&quot;]      let baz = [&quot;a&quot;] ++               [&quot;b&quot;] ++               [&quot;c&quot;]      main = print foo  (for example)"}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "reply_to_user": {"reputation": 1027, "user_id": 230814, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/66d28058eef8a3171e5b85dd8f9bf08c?s=128&d=identicon&r=PG", "display_name": "Scoobie", "link": "https://stackoverflow.com/users/230814/scoobie"}, "edited": false, "score": 0, "creation_date": 1480685969, "post_id": 40933310, "comment_id": 69078046, "body": "For a top-level definition in a source file you wouldn&#39;t write the <code>let</code>. Just <code>bar = ...</code>"}, {"owner": {"reputation": 1027, "user_id": 230814, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/66d28058eef8a3171e5b85dd8f9bf08c?s=128&d=identicon&r=PG", "display_name": "Scoobie", "link": "https://stackoverflow.com/users/230814/scoobie"}, "edited": false, "score": 0, "creation_date": 1480686103, "post_id": 40933310, "comment_id": 69078125, "body": "Could you please edit your answer to include the details in your comment? Thanks for the answer!"}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "reply_to_user": {"reputation": 1027, "user_id": 230814, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/66d28058eef8a3171e5b85dd8f9bf08c?s=128&d=identicon&r=PG", "display_name": "Scoobie", "link": "https://stackoverflow.com/users/230814/scoobie"}, "edited": false, "score": 0, "creation_date": 1480686519, "post_id": 40933310, "comment_id": 69078409, "body": "@Scoobie I did."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1480686692, "post_id": 40933310, "comment_id": 69078527, "body": "It is also worth mentioning that if you are using the latest GHC (version 8.0 and above) you don&#39;t need the <code>let</code> for top level definitions in GHCi anymore, which makes <code>:{ :}</code> even more convenient."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1480687160, "post_id": 40933310, "comment_id": 69078827, "body": "@jpath Indeed. I wrote the comment (in my head) before your edit :-)"}], "tags": [], "owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "is_accepted": true, "score": 5, "last_activity_date": 1480686793, "last_edit_date": 1480686793, "creation_date": 1480685215, "answer_id": 40933310, "question_id": 40933256, "link": "https://stackoverflow.com/questions/40933256/haskell-multi-line-let-in-ghci/40933310#40933310", "title": "Haskell multi-line `let` in `ghci`", "body": "<p>In GHCi you can use <code>:{ :}</code> for multiline expressions. For example:</p>\n\n<pre><code>Prelude&gt; :{\nPrelude| let bar = [\"a\",\nPrelude|            \"b\",\nPrelude|            \"c\"]\nPrelude| :}\n</code></pre>\n\n<p>The <code>:{ :}</code> keeps GHCi from evaluating your code after the next newline and throwing errors at you because it is not a complete expression.</p>\n\n<p>Note also that the <code>let</code> is not needed for top-level definitions. In a normal Haskell source file you would just write:</p>\n\n<pre><code>bar = [\"a\",\n       \"b\",\n       \"c\"]\n</code></pre>\n\n<p>Furthermore in newer GHCi versions (8.0+) you don't need the <code>let</code> either.</p>\n"}], "owner": {"reputation": 1027, "user_id": 230814, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/66d28058eef8a3171e5b85dd8f9bf08c?s=128&d=identicon&r=PG", "display_name": "Scoobie", "link": "https://stackoverflow.com/users/230814/scoobie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "accepted_answer_id": 40933310, "answer_count": 1, "score": 2, "last_activity_date": 1480686793, "creation_date": 1480685035, "last_edit_date": 1480685217, "question_id": 40933256, "link": "https://stackoverflow.com/questions/40933256/haskell-multi-line-let-in-ghci", "title": "Haskell multi-line `let` in `ghci`", "body": "<p>I'm in <code>ghci</code> and find that the following works:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>let foo = [\"a\", \"b\", \"c\"]\n</code></pre>\n\n<p>... but this doesn't work:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>let bar = [\"a\",\n           \"b\",\n           \"c\"]\n</code></pre>\n\n<p>... nor does this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>let baz = [\"a\"] ++\n          [\"b\"] ++\n          [\"c\"]\n</code></pre>\n\n<p>The same error is provided when I try to compile it as a file, so it's not something that comes from being in <code>ghci</code> vs using <code>ghc</code>.</p>\n\n<p>The error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>[1 of 1] Compiling Main             ( test.hs, test.o )\n\ntest.hs:3:1: error:\n    parse error (possibly incorrect indentation or mismatched brackets)\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 693, "user_id": 243779, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c232452237112c7bd82b0afea0acd3db?s=128&d=identicon&r=PG", "display_name": "KarlsFriend", "link": "https://stackoverflow.com/users/243779/karlsfriend"}, "edited": false, "score": 0, "creation_date": 1480683009, "post_id": 40928649, "comment_id": 69076157, "body": "Argh. Yes of course. Looks like a fault in my own wetware."}], "tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": true, "score": 10, "last_activity_date": 1480681069, "last_edit_date": 1495542629, "creation_date": 1480670526, "answer_id": 40928649, "question_id": 40928558, "link": "https://stackoverflow.com/questions/40928558/filter-hangs-on-infinite-list/40928649#40928649", "title": "filter hangs on infinite List", "body": "<p>Only 2 is prime and even. Other prime numbers aren't even. <code>filter</code> isn't smart. It tries to find the next even prime number, although it doesn't exist. That's why you have hangs.</p>\n\n<p>If you want to have termination anyway, you have to understand what in general case it problem can't be solved (<a href=\"https://stackoverflow.com/questions/1111155/what-exactly-is-the-halting-problem\">halting problem</a>). But anyway you can write approximation.</p>\n\n<p>For example, it's very simple approximation:</p>\n\n<pre><code>funnyFilter p = go ntriesMax\n  where\n    go _ (x:xs) | p x = x : go ntriesMax xs\n    go _     []       = []\n    go 0      _       = []\n    go n (_:xs)       = go (n - 1) xs\n    ntriesMax = 10000\n</code></pre>\n"}], "owner": {"reputation": 693, "user_id": 243779, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c232452237112c7bd82b0afea0acd3db?s=128&d=identicon&r=PG", "display_name": "KarlsFriend", "link": "https://stackoverflow.com/users/243779/karlsfriend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 1, "accepted_answer_id": 40928649, "answer_count": 1, "score": 2, "last_activity_date": 1480681069, "creation_date": 1480670233, "question_id": 40928558, "link": "https://stackoverflow.com/questions/40928558/filter-hangs-on-infinite-list", "title": "filter hangs on infinite List", "body": "<p>I have this code</p>\n\n<pre><code>isPrime x = x &gt; 0 &amp;&amp; filter divisible [1..x] == [1,x]\nwhere divisible y = x `mod` y == 0\n\nprimes = filter isPrime [1..]\n</code></pre>\n\n<p>that defines an infinite List of primes. </p>\n\n<p>All these cases work as Expected:</p>\n\n<pre><code>*Main&gt; take 10 primes\n[2,3,5,7,11,13,17,19,23,29]\n\n*Main&gt; take 10 $ filter odd primes\n[3,5,7,11,13,17,19,23,29,31]\n</code></pre>\n\n<p>However</p>\n\n<pre><code>*Main&gt; take 10 $ filter even primes\n[2\n</code></pre>\n\n<p>hangs and does not continue. I have no clue as to why... \nI restarted ghci and the problem persists. \nI'm using ghc 8.0.1.</p>\n\n<p>My packages:</p>\n\n<pre><code>C:\\projects\\littlethings\\prime&gt;ghc-pkg list\nC:/Program Files/Haskell Platform/8.0.1\\lib\\package.conf.d\n    Cabal-1.24.0.0\n    GLURaw-2.0.0.1\n    GLUT-2.7.0.7\n    HTTP-4000.3.3\n    HUnit-1.3.1.1\n    ObjectName-1.1.0.1\n    OpenGL-3.0.0.2\n    OpenGLRaw-3.1.0.0\n    QuickCheck-2.8.2\n    StateVar-1.1.0.4\n    Win32-2.3.1.1\n    array-0.5.1.1\n    async-2.1.0\n    attoparsec-0.13.0.2\n    base-4.9.0.0\n    binary-0.8.3.0\n    bytestring-0.10.8.1\n    case-insensitive-1.2.0.6\n    containers-0.5.7.1\n    deepseq-1.4.2.0\n    directory-1.2.6.2\n    fgl-5.5.2.3\n    filepath-1.4.1.0\n    fixed-0.2.1.1\n    (ghc-8.0.1)\n    ghc-boot-8.0.1\n    ghc-boot-th-8.0.1\n    ghc-prim-0.5.0.0\n    ghci-8.0.1\n    half-0.2.2.3\n    hashable-1.2.4.0\n    haskeline-0.7.2.3\n    haskell-src-1.0.2.0\n    hoopl-3.10.2.1\n    hpc-0.6.0.3\n    hscolour-1.24\n    html-1.0.1.2\n    integer-gmp-1.0.0.1\n    mtl-2.2.1\n    network-2.6.2.1\n    network-uri-2.6.1.0\n    parallel-3.2.1.0\n    parsec-3.1.9\n    pretty-1.1.3.3\n    primitive-0.6.1.0\n    process-1.4.2.0\n    random-1.1\n    regex-base-0.93.2\n    regex-compat-0.95.1\n    regex-posix-0.95.2\n    rts-1.0\n    scientific-0.3.4.6\n    split-0.2.3\n    stm-2.4.4.1\n    syb-0.6\n    template-haskell-2.11.0.0\n    text-1.2.2.1\n    tf-random-0.5\n    time-1.6.0.1\n    transformers-0.5.2.0\n    unordered-containers-0.2.7.0\n    vector-0.11.0.0\n    xhtml-3000.2.1\n    zlib-0.6.1.1\n\nC:\\Users\\Hamburger\\AppData\\Roaming\\ghc\\x86_64-mingw32-8.0.1\\package.conf.d\n    (containers-0.5.8.1)\n    data-ordlist-0.4.7.0\n    lazyset-0.1.0.0\n    memoize-0.8.1\n</code></pre>\n"}, {"tags": ["haskell", "filter", "distinct-values", "conduit"], "comments": [{"owner": {"reputation": 137, "user_id": 5771177, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f66c6628f434a7998195c89f2af5427b?s=128&d=identicon&r=PG&f=1", "display_name": "suffi", "link": "https://stackoverflow.com/users/5771177/suffi"}, "edited": false, "score": 0, "creation_date": 1480677210, "post_id": 40927857, "comment_id": 69072613, "body": "Is there nothing more you know about these values? It would be a lot easier to filter that list with some sort of metadata."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 2, "creation_date": 1480718993, "post_id": 40927857, "comment_id": 69095552, "body": "Note that a &#39;nub&#39; conduit like this would not stream. It will use indefinite memory since one way or another the conduit will have to record what it has seen e.g. in a Data.Set.Set"}, {"owner": {"reputation": 365, "user_id": 1560138, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/370b89d2b931def9f3df67326283b295?s=128&d=identicon&r=PG", "display_name": "tmortiboy", "link": "https://stackoverflow.com/users/1560138/tmortiboy"}, "reply_to_user": {"reputation": 137, "user_id": 5771177, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f66c6628f434a7998195c89f2af5427b?s=128&d=identicon&r=PG&f=1", "display_name": "suffi", "link": "https://stackoverflow.com/users/5771177/suffi"}, "edited": false, "score": 0, "creation_date": 1480901637, "post_id": 40927857, "comment_id": 69141327, "body": "@suffi in my case, the type is just a list of Ids"}], "answers": [{"comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 3, "creation_date": 1480674629, "post_id": 40929733, "comment_id": 69070906, "body": "For better algorithmic complexity, you could use a <code>Set</code> or <code>HashSet</code> instead, though that incurs an <code>Ord</code> or <code>Hashable</code> constraint, respectively."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 5, "last_activity_date": 1480673736, "creation_date": 1480673736, "answer_id": 40929733, "question_id": 40927857, "link": "https://stackoverflow.com/questions/40927857/haskell-conduit-filter-distinct-values/40929733#40929733", "title": "Haskell conduit filter distinct values", "body": "<p>Something like this should do:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-6.19 runghc --package conduit-combinators\nimport Conduit\nimport Data.Conduit.List (sourceList)\n\nmain = do\n    print $ runConduitPure $ sourceList [1,3,3,1,2,3] .| myConduit [] .| sinkList\n\nmyConduit dup = do\n  num &lt;- await\n  case num of\n    Just x -&gt; if x `elem` dup\n              then myConduit dup\n              else do\n                yield x\n                myConduit (x:dup)\n    Nothing -&gt; return ()\n</code></pre>\n\n<p>On execution:</p>\n\n<pre><code>sibi::casey { ~/scripts }-&gt; ./cond.hs\n[1,3,2]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 0, "last_activity_date": 1480685105, "last_edit_date": 1480685105, "creation_date": 1480682644, "answer_id": 40932536, "question_id": 40927857, "link": "https://stackoverflow.com/questions/40927857/haskell-conduit-filter-distinct-values/40932536#40932536", "title": "Haskell conduit filter distinct values", "body": "<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-6.19 runghc --package conduit-combinators\nimport Conduit\nimport Data.Conduit.List (sourceList, mapAccum, catMaybes)\nimport Control.Monad (void)\n\nmain = do\n    print $ runConduitPure $ sourceList [1,3,3,1,2,3] .| void (mapAccum foo []) .| catMaybes .| sinkList\n\nfoo :: Int -&gt; [Int] -&gt; ([Int], Maybe Int)\nfoo x dup | x `elem` dup = (dup, Nothing)\nfoo x dup = (x:dup, Just x)\n</code></pre>\n\n<p>On execution:</p>\n\n<pre><code>C:\\Users\\Gurkenglas\\scripts&gt;stack conduitnub.hs\n[1,3,2]\n</code></pre>\n"}], "owner": {"reputation": 365, "user_id": 1560138, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/370b89d2b931def9f3df67326283b295?s=128&d=identicon&r=PG", "display_name": "tmortiboy", "link": "https://stackoverflow.com/users/1560138/tmortiboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 40929733, "answer_count": 2, "score": 2, "last_activity_date": 1480685105, "creation_date": 1480667787, "question_id": 40927857, "link": "https://stackoverflow.com/questions/40927857/haskell-conduit-filter-distinct-values", "title": "Haskell conduit filter distinct values", "body": "<p>If I use the following <code>Source</code>:</p>\n\n<pre><code> sourceList [1,3,3,1,2,3]\n</code></pre>\n\n<p>Is it possible to apply some filter or combinator to only allow distinct values to be passed downstream?</p>\n\n<p>So in my example, only <code>[1,3,2]</code> would be passed downstream?</p>\n"}, {"tags": ["javascript", "haskell", "interpreter", "language-design"], "comments": [{"owner": {"reputation": 871364, "user_id": 157247, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/4HovX.jpg?s=128&g=1", "display_name": "T.J. Crowder", "link": "https://stackoverflow.com/users/157247/t-j-crowder"}, "edited": false, "score": 4, "creation_date": 1480663814, "post_id": 40926818, "comment_id": 69065168, "body": "FWIW, <a href=\"http://www.ecma-international.org/ecma-262/7.0/index.html#sec-let-and-const-declarations-runtime-semantics-evaluation\" rel=\"nofollow noreferrer\">in JavaScript</a> it creates an uninitialized binding for <code>factorial</code>, then evaluates the right-hand side (which doesn&#39;t actually <i>use</i> the binding because the function is just being defined, not run), and then initializes the binding with the resulting value. So the binding exists (uninitialized) when the initializer is evaluated (so early reference errors could be handled, although JavaScript doesn&#39;t do that), and has a value as of when the function is run. FWIW."}, {"owner": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "edited": false, "score": 2, "creation_date": 1480664799, "post_id": 40926818, "comment_id": 69065566, "body": "In order to evaluate recursive anonymous functions (lambdas) you need something called Y-Combinator. You might find this links helpful, <a href=\"http://kestas.kuliukas.com/YCombinatorExplained/\" rel=\"nofollow noreferrer\">kestas.kuliukas.com/YCombinatorExplained</a> and <a href=\"http://stackoverflow.com/questions/93526/what-is-a-y-combinator\">stackoverflow.com/questions/93526/what-is-a-y-combinator</a>"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "edited": false, "score": 1, "creation_date": 1480675659, "post_id": 40926818, "comment_id": 69071518, "body": "@zeronone To use Y you already need an interpreter. Also, once we do have an interpreter, Y is horribly inefficient compared to just using recursive bindings."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1480681166, "post_id": 40926818, "comment_id": 69074960, "body": "@Andr&#225;sKov&#225;cs I think zeronone was suggesting to add Y as a predefined operator in the predefined environment <code>const std = { ... , &#39;Y&#39; : Yimpl }</code> where <code>Yimpl</code> can be defined recursively in JavaScript, and shouldn&#39;t be too inefficient, I guess."}, {"owner": {"reputation": 834, "user_id": 1923879, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Bhz6h.jpg?s=128&g=1", "display_name": "charlag", "link": "https://stackoverflow.com/users/1923879/charlag"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1480682006, "post_id": 40926818, "comment_id": 69075525, "body": "@chi I am not sure I can implement in host language because host language is unaware of my language environment."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1480682423, "post_id": 40926818, "comment_id": 69075803, "body": "@charlag_khan But <code>Yimpl</code> needs nothing from the environment. Its implementation should be something like <code>var Yimpl = (f) =&gt; f(() =&gt; Yimpl(f))</code>."}, {"owner": {"reputation": 834, "user_id": 1923879, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Bhz6h.jpg?s=128&g=1", "display_name": "charlag", "link": "https://stackoverflow.com/users/1923879/charlag"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1480683191, "post_id": 40926818, "comment_id": 69076278, "body": "@chi this could work, thanks. I also found this:  &quot;We use a reference to the environment for two reasons: First, by storing a reference instead of the actual environment, we save space. Second - and more importantly - the use of references allows for the creation of environments containing closures whose embedded references point to the environment itself. This is important when defining recursive, or mutually recursive functions. &quot; <a href=\"http://www.cs.cornell.edu/courses/cs312/2004fa/lectures/lecture24.htm\" rel=\"nofollow noreferrer\">cs.cornell.edu/courses/cs312/2004fa/lectures/lecture24.htm</a>"}], "answers": [{"tags": [], "owner": {"reputation": 834, "user_id": 1923879, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Bhz6h.jpg?s=128&g=1", "display_name": "charlag", "link": "https://stackoverflow.com/users/1923879/charlag"}, "is_accepted": false, "score": 0, "last_activity_date": 1480788098, "last_edit_date": 1480788098, "creation_date": 1480701982, "answer_id": 40938431, "question_id": 40926818, "link": "https://stackoverflow.com/questions/40926818/interpreter-how-closure-captures-its-name/40938431#40938431", "title": "Interpreter - How closure captures its name?", "body": "<p><strong>UPDATE</strong></p>\n\n<p>I found one more solution here: <a href=\"http://lisperator.net/pltut/eval1/new-constructs\" rel=\"nofollow noreferrer\">http://lisperator.net/pltut/eval1/new-constructs</a></p>\n\n<p>Evaluator is somewhat different for this language, though. \nBasically, it boils down to this:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>function make_lambda(env, exp) {\n    if (exp.name) {                    // these\n        env = env.extend();            // lines\n        env.def(exp.name, lambda);     // are\n    }                                  // new\n    function lambda() {\n        var names = exp.vars;\n        var scope = env.extend();\n        for (var i = 0; i &lt; names.length; ++i)\n            scope.def(names[i], i &lt; arguments.length ? arguments[i] : false);\n        return evaluate(exp.body, scope);\n    }\n    return lambda;\n}\n</code></pre>\n\n<hr>\n\n<p>I found the solution in the lecture on implementing ML compiler:\n<a href=\"http://www.cs.cornell.edu/courses/cs312/2004fa/lectures/lecture24.htm\" rel=\"nofollow noreferrer\">http://www.cs.cornell.edu/courses/cs312/2004fa/lectures/lecture24.htm</a></p>\n\n<p>\"A closure consists of the name of the unique argument (see below), the expression (i.e. abstract syntax tree) defining the function body, and a reference to the environment in which the closure was created. We use a reference to the environment for two reasons:</p>\n\n<ul>\n<li><p>First, by storing a reference instead of the actual environment, we save space.</p></li>\n<li><p>Second - and more importantly - the use of references allows for the creation of environments containing closures whose embedded references point to the environment itself. This is important when defining recursive, or mutually recursive functions.\"</p></li>\n</ul>\n\n<p>So, what I did is passing a reference of the environment to the <code>makeLamba()</code> instead of a copy. Thus, lambda shares the environment at the moment of creation but for the evaluation of its body the copy of the environment is made (so anything inside the lambda won't mutate parent environment).</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>  // ...\n  case 'lambda':\n    return makeLambda(expr, parentEnv); // not a copy but a reference\n  // ...\n\n  const makeLambda = (fun, parentEnv) =&gt; {\n    return (...args) =&gt; {\n        const env = Object.assign({}, parentEnv);\n        fun.args.forEach((el, i) =&gt; {\n          env[el.value] = args[i];\n        });\n        return _eval(fun.body, env);\n    }\n  }\n</code></pre>\n"}], "owner": {"reputation": 834, "user_id": 1923879, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/Bhz6h.jpg?s=128&g=1", "display_name": "charlag", "link": "https://stackoverflow.com/users/1923879/charlag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1480788098, "creation_date": 1480663219, "last_edit_date": 1480702180, "question_id": 40926818, "link": "https://stackoverflow.com/questions/40926818/interpreter-how-closure-captures-its-name", "title": "Interpreter - How closure captures its name?", "body": "<p>Consider this code in Haskell:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>let factorial n = if n &lt; 2 then 1 else n * factorial (n-1) in factorial 3\n</code></pre>\n\n<p>I see that interpreter evaluating the program in such order:</p>\n\n<ol>\n<li>It's a binding. Evaluate definitions first and evaluate the part after \"in\".</li>\n<li>It's a definition. Evaluate the body and then associate body with the name.</li>\n<li>It's a lambda. Capture the environment, make a closure and return.</li>\n<li>Body of the definition is evaluated, write it to the name now.</li>\n<li>Definitions are evaluated, evaluate the right part of the expression.</li>\n<li>The expression is evaluated, return the result.</li>\n</ol>\n\n<p>I see the following problem with this model: At step 3, when the closure captures environment it doesn't know anything about \"factorial\" binding.</p>\n\n<p>I am writing an interpreter for ML-like language in JavaScript and I stumbled this problem. For example, the following code in my language:</p>\n\n<pre><code>fac = \\x -&gt; if (== x, 0) { 1 } else { fac (- x, 1) } in fac 3\n</code></pre>\n\n<p>won't work because of the described problem.</p>\n\n<p>How interpreters for other languages solve this problem?</p>\n\n<p>Here's the code of the interpreter for the reference.</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>\"use strict\";\n\nconst grammar =\n`\nExpression \"expression\"\n  = Condition\n  / Application\n  / Lambda\n  / Binding\n  / Integer\n  / String\n  / Identifier\n  / '(' expr: Expression ')' { return expr; }\n\n_ \"whitespace\"\n  = [ \\\\t\\\\n\\\\r\\\\n]*\n\nInteger \"integer\"\n  = [0-9]+ {\n    return { type: 'literal',\n             literalType: 'Integer',\n             value: parseInt(text(), 10)\n          };\n  }\n\nString \"string\"\n = '\\\"' value: ([^\\\"]* { return text(); } ) '\\\"' {\n   return { type: 'literal',\n            literalType: 'String',\n            value: value\n          };\n    }\n\nLetter\n  = [a-zA-Z]\n\nIdentifier\n  = (Letter / '+' / '-' / '*' / '/' / '_' / '==' / '&gt;' / '&lt;')+ {\n    return {\n        type: 'identifier',\n        value: text()\n    }\n  }\n\nApplication\n  = id: Identifier _ args: ActualArguments {\n     return { type: 'application',\n            fun: id,\n            args: args\n          }\n  }\n  / lambda: ('(' l: Lambda ')' { return l; }) _ args: ActualArguments  {\n     return { type: 'application',\n            fun: lambda,\n            args: args\n          }\n    }\n\nActualArguments\n = expr: Expression rest: (',' _ e: Expression { return e })* { return [expr].concat(rest); }\n\nLambda\n  = '\\\\\\\\' args: Arguments _ '-&gt;' _ body: Expression {\n   return { type: 'lambda',\n            args: args,\n            body: body\n          }\n    }\n\nArguments\n  = head: Identifier rest: (',' _ i: Identifier { return i; })* { return [head].concat(rest); }\n\nBinding\n = name: Identifier _ '=' _ def: Expression _ 'in' _ expr: Expression {\n   return {\n     type: 'binding',\n     name: name,\n     def: def,\n     expr: expr\n   }\n }\n\nCondition\n = 'if' _ '(' _ cond: Expression _ ')' _ '{' _ expr1: Expression _ '}' expr2: ( _ 'else' _ '{' _ e: Expression _ '}' { return e; })? {\n   return {\n     type: 'condition',\n     condition: cond,\n     expr1,\n     expr2\n   }\n }\n`\n\nconst parser = peg.generate(grammar);\n\nconst std = {\n  '+': (arg1, arg2) =&gt; arg1 + arg2,\n  '-': (arg1, arg2) =&gt; arg1 - arg2,\n  '*': (arg1, arg2) =&gt; arg1 * arg2,\n  '/': (arg1, arg2) =&gt; arg1 / arg2,\n  'str': (arg1, arg2) =&gt; [arg1, arg2].join(\"\"),\n  '&gt;': (arg1, arg2) =&gt; arg1 &gt; arg2,\n  '&lt;': (arg1, arg2) =&gt; arg1 &lt; arg2,\n  '==': (arg1, arg2) =&gt; arg1 === arg2,\n  'false': false,\n  'true': true,\n  'and': (arg1, arg2) =&gt; arg1 &amp;&amp; arg2,\n  'or': (arg1, arg2) =&gt; arg1 || arg2\n}\n\nconst makeLambda = (fun, parentEnv) =&gt; {\n  return (...args) =&gt; {\n      const env = Object.assign({}, parentEnv);\n      fun.args.forEach((el, i) =&gt; {\n        env[el.value] = args[i];\n      });\n      return _eval(fun.body, env);\n  }\n}\n\nconst evalLiteral = (literal) =&gt; {\n  switch (literal.literalType) {\n    case 'Integer':\n      return parseInt(literal.value);\n    case 'String':\n      return String(literal.value);\n    default:\n      console.log('Literal type undefined');\n      return literal.value;\n  }\n}\n\nconst _eval = (expr, parentEnv = std) =&gt; {\n  const env = Object.assign({}, parentEnv);\n  switch (expr.type) {\n    case 'application':\n      const fun = _eval(expr.fun, env);\n      const args = expr.args.map(arg =&gt; _eval(arg, env));\n      return fun.apply(null, args);\n      break;\n    case 'literal':\n      return evalLiteral(expr);\n    case 'identifier':\n      return env[expr.value];\n    case 'lambda':\n      return makeLambda(expr, env);\n    case 'binding':\n      env[expr.name.value] = _eval(expr.def, env);\n      return _eval(expr.expr, env);\n    case 'condition':\n      if (_eval(expr.condition, env)) {\n        return _eval(expr.expr1, env);\n      } else {\n        return _eval(expr.expr2, env);\n      }\n  }\n}\n\nconst parseAndEval = (str) =&gt; {\n  try {\n    const parsed = parser.parse(str);\n    console.log(parsed);\n    return _eval(parsed);\n  } catch (e) {\n    if (e.name == \"SyntaxError\" ) {\n    return e.toString() +\n      \" start: \" + JSON.stringify(e.location.start) +\n      \" end: \" + JSON.stringify(e.location.end);\n    } else {\n      return e.toString();\n    }\n  }\n}\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1480684964, "post_id": 40924235, "comment_id": 69077396, "body": "what have you tried - where are you stuck, can you create the square, do you know how to handle lists and lists of lists? how familiar are you with haskell?"}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1480724538, "post_id": 40924235, "comment_id": 69097099, "body": "Yes i have the square, and all functions to handle in the program. I only miss a function that returns a tuple of type (Int,Int) = (column,line), that tells me the posiction i will be editting in that moment (time)"}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1480724772, "post_id": 40924235, "comment_id": 69097159, "body": "I have the done a program of a game, and that game, at the time d^2 starts closing the map, ending at the time 1(editing the center square of the map) at time d^2 i want to edit the square (0,0). Do you understand what i&#39;m trying to do?"}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1480724879, "post_id": 40924235, "comment_id": 69097181, "body": "In relation to how familiar I am with haskell, i started a few weaks ago, this is the first &#39;big&#39; project I do, and I only miss this function(I even have how to access the map and what to do after i find the tuple (colum,line). So i only miss this function that finds the tuple. So I&#39;m not an expert or anything close to that. Thank you"}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1480733230, "post_id": 40924235, "comment_id": 69098598, "body": "I already solved it, I &#39;inverted&#39; the time making it (t-(d^2)+1) and it became much easier. Thanks anyway"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1480741736, "post_id": 40924235, "comment_id": 69099990, "body": "if you have solved it - don&#39;t hesitate to add your solution"}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1480943973, "post_id": 40924235, "comment_id": 69159419, "body": "I didn&#39;t added but i should, now epsilonhalbe added a diferrent soluction then mine, more advanged actually than what i had, with same result. Thank"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "edited": false, "score": 0, "creation_date": 1480944322, "post_id": 40944642, "comment_id": 69159641, "body": "Thank you, that&#39;s exactly what I needed, I had this done but in a different way, this soluction has more advanced functions than mine."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "edited": false, "score": 0, "creation_date": 1480966645, "post_id": 40944642, "comment_id": 69173387, "body": "please show your solution as well! It is always interesting to compare!"}, {"owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "edited": false, "score": 0, "creation_date": 1481065494, "post_id": 40944642, "comment_id": 69221550, "body": "Done, I think your soluction is more advanced then mine. Thank you, but anyway can you reply what you think of mine?"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 0, "last_activity_date": 1480743514, "creation_date": 1480743514, "answer_id": 40944642, "question_id": 40924235, "link": "https://stackoverflow.com/questions/40924235/spiral-running-by-time/40944642#40944642", "title": "Spiral running by time", "body": "<pre><code>module Spiral where\n\nimport Data.List (transpose)\n\ntype Time = Int\ntype Dimension = Int\ntype Coordinate = (Int,Int)\n\nspiral :: Dimension -&gt; [Coordinate]\nspiral d | d &lt;= 0    = error \"Dimension must be a positive number.\"\n         | otherwise = let square = [[(x,y)|x &lt;- [0..(d-1)]]|y &lt;- [0..(d-1)]]\n                           rotate = reverse . transpose\n                           spiral' :: [[a]] -&gt; [a]\n                           spiral' []     = []\n                           spiral' (x:xs) = spiral' (rotate xs) ++ reverse x\n                        in spiral' square\n\nspiralTime :: Dimension -&gt; Time -&gt; Coordinate\nspiralTime d t | 0 &lt;= t &amp;&amp; t &lt; d*d = spiral d !! t\n               | otherwise         = error $ \"Time must be in [0,\"++show (d*d)++\")\"\n</code></pre>\n\n<p>Note that this function then can be used as <code>getCoordinateAtTime</code> to get a function as you described.</p>\n\n<pre><code>$&gt; ghci stover.hs\nGHCi, version 8.0.1: http://www.haskell.org/ghc/  :? for help\nLoaded GHCi configuration from /home/epsilonhalbe/.ghc/ghci.conf\n[1 of 1] Compiling Spiral           ( stover.hs, interpreted )\nOk, modules loaded: Spiral.\n*Spiral&gt; spiral (-1)\n*** Exception: Dimension must be a positive number.\nCallStack (from HasCallStack):\n  error, called at stover.hs:10:24 in main:Spiral\n*Spiral&gt; spiralTime 5 25\n*** Exception: Time must be in [0,25)\nCallStack (from HasCallStack):\n  error, called at stover.hs:20:38 in main:Spiral\n*Spiral&gt; let getCoordinateAtTime = spiralTime 5\n*Spiral&gt; getCoordinateAtTime 0\n(2,2)\n*Spiral&gt; getCoordinateAtTime 24\n(0,0)\n*Spiral&gt; getCoordinateAtTime 11\n(0,3)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7049147, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d1b2c8bc723cd06e915c0cd670f8bf69?s=128&d=identicon&r=PG&f=1", "display_name": "Dost", "link": "https://stackoverflow.com/users/7049147/dost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 40944642, "answer_count": 1, "score": 0, "last_activity_date": 1481065441, "creation_date": 1480648805, "last_edit_date": 1480674217, "question_id": 40924235, "link": "https://stackoverflow.com/questions/40924235/spiral-running-by-time", "title": "Spiral running by time", "body": "<p>This is a question I have some difficulty making, but I will try to explain the best i can.</p>\n\n<p>Imagine this is the coordenates of a square table</p>\n\n<blockquote>\n<pre><code>(0,0) (1,0) (2,0) (3,0) (4,0)\n\n(0,1) (1,1) (2,1) (3,1) (4,1)\n\n(0,2) (1,2) (2,2) (3,2) (4,2)\n\n(0,3) (1,3) (2,3) (3,3) (4,3)\n\n(0,4) (1,4) (2,4) (3,4) (4,4)\n</code></pre>\n</blockquote>\n\n<p>Now I have 2 Ints</p>\n\n<blockquote>\n  <p>d = dimension of the square table</p>\n  \n  <p>t=>0 and t&lt;= d^2</p>\n</blockquote>\n\n<p>and i need to find a way to calculate the coordenates i will fill in moment t, and i need to fill it in a spiral, like this examples:</p>\n\n<blockquote>\n<pre><code>t=(n^2) -&gt; (0,0)\n\nt=(n^2)-1 -&gt; (1,0)\n\n...\n\nt=((n^2)-n)+1 -&gt; (4,0)\n\nt=((n^2)-n) -&gt; (4,1)\n\nt=((n^2)-n)-1 -&gt; (4,2)\n\n...\n\n\nt=0 -&gt; (2,2)\n</code></pre>\n</blockquote>\n\n<p>So What I'm trying to explain is i need to acces the table in the order:</p>\n\n<pre><code>(0,0) &gt; (1,0) &gt; (2,0) &gt; (3,0) &gt; (4,0) &gt; (4,1) &gt; ... &gt; (4,4) &gt; (3,4) &gt; ... &gt; (0,4) &gt; (0,3) &gt; (0,2) &gt; (0,1) &gt; (1,1) &gt; (2,1) &gt; (3,1) &gt; (3,2) &gt; (3,3) &gt; (2,3) &gt; (1,3) &gt; (1,2) &gt; (2,2)\n</code></pre>\n\n<p>Can someone give some advice on how to build a function, using only the <code>t=moment</code> and <code>d=dimension</code>, that calculate the <code>coordenate(column,line)</code> I need to edit?</p>\n\n<p>Sorry for English errors and confusing question.</p>\n\n<p>Thanks for all help</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1480655206, "post_id": 40923995, "comment_id": 69061715, "body": "I&#39;m not sure I understand... Can you clarify a bit more what you&#39;re doing? What is <code>xs</code>? In <code>checkConsec</code>, you&#39;re trying to pass 6 arguments to <code>helper</code>, which is a function that only takes in 4 arguments."}], "answers": [{"tags": [], "owner": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "is_accepted": false, "score": 2, "last_activity_date": 1480657759, "creation_date": 1480657759, "answer_id": 40925623, "question_id": 40923995, "link": "https://stackoverflow.com/questions/40923995/how-to-pass-a-function-through-map-in-haskell/40925623#40925623", "title": "How to pass a function through map in Haskell", "body": "<p>Arguments to a function is separated by spaces. <code>foo a b c</code> applies three arguments to <code>foo</code> and <code>foo (a b) c</code> applies two arguments to foo. The function application has the highest precedence. I don't have the remaining of your code, but I guess you meant the following.</p>\n\n<pre><code>checkWin :: BoardState -&gt; [[Maybe Piece]]\ncheckWin bs = map (checkConsec bs) (rows bs)\n\ncheckConsec :: BoardState -&gt; [Maybe Piece] -&gt; [Maybe Piece]\ncheckConsec bs = helper (numToConnect bs) 1 (lastMove bs) xs \n\nhelper :: Int -&gt; Int -&gt; Maybe Piece -&gt; [Maybe Piece] -&gt; [Maybe Piece]\nhelper = undefined\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 4518168, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/0e8a44ce2dbb47a003534a1f0af604aa?s=128&d=identicon&r=PG&f=1", "display_name": "AndieM", "link": "https://stackoverflow.com/users/4518168/andiem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1480701186, "creation_date": 1480647392, "last_edit_date": 1480701186, "question_id": 40923995, "link": "https://stackoverflow.com/questions/40923995/how-to-pass-a-function-through-map-in-haskell", "title": "How to pass a function through map in Haskell", "body": "<p>I have been searching for an answer to this problem but to no avail.  I am trying to figure out how i can pass the first array from rows in checkconsec, after it is mapped to bs.  I am trying to use xs but it doesn't work.  Can anyone see what I'm doing wrong?</p>\n\n<pre><code>import Data.Maybe\nimport Data.List\n\ndata Piece = Yellow | Red deriving Eq\ntype Column = [Piece]\ntype Board = [Column]\n\ndata BoardState = BS {\ntheBoard :: Board,\nlastMove :: Piece,\nnumColumns :: Int,\nnumRows :: Int, \nnumToConnect :: Int}\n\n---------- Make Move -----------\n-- This function makes a move on a Boardstate, first checks if the column is full or if the column exists or not.\n-- If true returns just a boardstate, if false returns nothing\nmakeMove :: BoardState -&gt; Int -&gt; Maybe BoardState   \nmakeMove bs n = case ((checkLegal bs n) &amp;&amp; (checkNotFull bs (columns bs !! (n-1)))) of\n         True -&gt; Just (updateBoard bs n)                                \n         False -&gt; Nothing\n\n-- Checks if the move is legal, i.e. if the column to be moved into exists\ncheckLegal :: BoardState -&gt; Int -&gt; Bool\ncheckLegal bs i = case (i &lt;= (numColumns bs) &amp;&amp; (i /= 0)) of\n           True -&gt; True\n           False -&gt; False\n\n-- Checks if the desired column is not full.\ncheckNotFull :: BoardState -&gt; [Maybe Piece] -&gt;Bool\ncheckNotFull bs a  = case (length (catMaybes a)&lt; (numRows bs)) of\n         True -&gt;True\n         False -&gt; False\n\n\n-----------Parts of Board-----------\n-- This function repeats nothing over and over.\nrepeatNothing :: Int -&gt; [Maybe a]\nrepeatNothing m = replicate m Nothing\n\n-- This function pads a list so that the resulting list is of the appropriate length\npadN :: [a] -&gt; Int -&gt; [Maybe a]\npadN xs n = (map Just xs) ++ repeatNothing (n - (length xs))\n\n-- This function finds all of the columns of the board\ncolumns :: BoardState -&gt; [[Maybe Piece]]\ncolumns bs = map (\\col -&gt; padN col (numRows bs)) (theBoard bs) \n\n-- This function finds all the rows of the board\nrows :: BoardState -&gt; [[Maybe Piece]]\nrows bs = map (\\col -&gt; padN col (numRows bs)) (transpose(theBoard bs))\n\n-- This function will find the forward diagonals, but first gets the rows and the calls diagonals on the already padded\n-- rows\ndiagonalsForward :: BoardState -&gt; [[Maybe Piece]]\ndiagonalsForward bs = (diagonals (rows(bs)))\n\n-- This function will find the backward diagonals, but first the rows are found, then the resulting grid is rotated\n-- 90 degrees, followed by calling diagonals, which will then return the backwards diagonals, however in the wrong order\n-- so then reverse is called on each list in order to get the correct order of the diagonals\ndiagonalsBackward :: BoardState -&gt; [[Maybe Piece]]\ndiagonalsBackward bs = map reverse (diagonals((map reverse.transpose)(rows(bs))))\n\n-- Because this section of code is cited above, the detailed axplanation of how it works is attached in another document\ndiagonals :: [[t]] -&gt; [[t]]\ndiagonals [] = []\ndiagonals ([]:xss) = xss\ndiagonals xss = zipWith (++) (map ((:[]).head) xss ++ repeat[])\n        ([] : (diagonals (map tail xss)))\n\n-----------Check Win ---------------\n\ncheckWin :: BoardState -&gt; [[Maybe Piece]]\ncheckWin bs = map (checkConsec bs) (rows bs)\n\ncheckConsec :: BoardState -&gt; [[Maybe Piece]] -&gt; [Maybe Piece]\ncheckConsec bs (x:xs) = helper (numToConnect bs) 1 (lastMove bs) x\n\nhelper :: Int -&gt; Int -&gt; Piece  -&gt; [Maybe Piece] -&gt; [Maybe Piece]\nhelper = undefined\n\n{-\nhelper numToCon cntr color (x:xs) = [];\nhelper numToCon cntr color (x:xs) = if cntr 0 then Nothing -- cntr initialized to 1\nelse case (color, x) of\n(Just Yellow, Just Yellow) -&gt; helper numToCon (cntr+1) color\n(Just Yellow, Nothing) -&gt; helper numToCon(cntr=1) color\n(Just Yellow, Just Red) -&gt; helper numToCon(cntr=1) color\n(Just Red, Just Red) -&gt; helper numToCon(cntr+1) color\n(Just Red, Nothing) -&gt; helper numToCon(cntr=1) color\n(Just Red, Just Yellow) -&gt; helper numToCon(cntr=1) color\n-}\n\n---------Update Board------------\n-- This function splits a list into three separate pieces, the position of the split is determined by the parameter n \nsplit3:: Int -&gt; [Column] -&gt; ([Column], Column, [Column])\nsplit3 n xs = let (ys,(z:zs)) = (take (n-1) xs, drop (n-1) xs) in (ys, z, zs)\n\n-- Calls split3 on the board \nsplitBoard :: BoardState -&gt; Int -&gt; [Column]\nsplitBoard bs n = addPiece bs (split3 n (theBoard bs))\n\n-- Adds a piece to the desired column of the board\naddPiece :: BoardState -&gt; ([Column], Column, [Column]) -&gt; [Column]\naddPiece bs (x,y,z) = x ++ (y ++ [lastMove bs]):z \n\n-- Updates the board to the new state, after adding a piece (or not) and updating the lastMove \nupdateBoard :: BoardState -&gt; Int -&gt; BoardState\nupdateBoard bs n = case (lastMove bs) of\n           Yellow -&gt; BS {theBoard = splitBoard bs n,\n       lastMove = Red,  \n       numColumns = numColumns bs,\n       numRows = numRows bs,    \n       numToConnect = numToConnect bs}\n           Red -&gt; BS {theBoard = splitBoard  bs n,\n       lastMove = Yellow,\n       numColumns = numColumns bs,\n       numRows = numRows bs,\n       numToConnect = numToConnect bs}\n</code></pre>\n\n<p>** Edit: I have edited this to include all of my code, hopefully this will make it easier to understand my problem.  I also fixed (to the best of my knowledge) the types of checkconsec and helper.  The only error I am getting now is:</p>\n\n<pre><code>Couldn't match type \u2018Maybe Piece\u2019 with \u2018[Maybe Piece]\u2019\n    Expected type: [[[Maybe Piece]]]\n      Actual type: [[Maybe Piece]]\n    In the second argument of \u2018map\u2019, namely \u2018(rows bs)\u2019\n    In the expression: map (checkConsec bs) (rows bs)\nFailed, modules loaded: none.\n</code></pre>\n"}, {"tags": ["haskell", "ghcjs"], "comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 2, "creation_date": 1480662746, "post_id": 40923946, "comment_id": 69064713, "body": "Can you go into details on why you need access to the internals of the <code>Text</code> representation?"}, {"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1480684377, "post_id": 40923946, "comment_id": 69077011, "body": "@Cactus I have added details about why I need to access the internals of <code>Text</code>."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 1, "creation_date": 1480684685, "post_id": 40923946, "comment_id": 69077211, "body": "The reason I&#39;m asking, is because <code>Data.Text.Internal</code> should expose enough functionality to do what you want without looking at the representation itself. Your linked previous question doesn&#39;t seem to contain the <code>Text</code>-internals-using version so I can&#39;t tell for sure yet."}, {"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1480685616, "post_id": 40923946, "comment_id": 69077790, "body": "I&#39;ve looked through the other functions in <code>Data.Text.Internal</code>, and it looks like the <code>text</code> function does what I need in most situations. However, there are some other text builder abstractions I&#39;ve been working on where I need something like this: <code>textToMArray :: Text -&gt; ST s (TA.MArray s)</code>. This copies a piece of text into a new buffer. I can write this when I have access to the data constructor, but I don&#39;t think that anything else in <code>Data.Text.Internal</code> lets me do this. I may be able to work around this though. Also, I&#39;d still like to know where the data constructor switcharoo happens."}, {"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1480685928, "post_id": 40923946, "comment_id": 69078006, "body": "It would also be nice to see where the existing discussions of this are. I&#39;m guessing that a longer-term goal would be to push the ghcjs-specific stuff into <code>text</code> itself (behind <code>ifdef</code>s). My cursory perusal of the github issue tracker turns up no talk of this, but I suspect that I just looking for information in the wrong place."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1480686193, "post_id": 40923946, "comment_id": 69078186, "body": "<code>Data.Text.Array</code>?"}, {"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1480690271, "post_id": 40923946, "comment_id": 69081002, "body": "I&#39;m assuming that&#39;s in reponse to my comment about textToMArray. Clearly, copyI is half of the solution, but to call this, I have to first get the Array out of the Text. I don&#39;t see anything other than the data constructor that lets me do this."}, {"owner": {"reputation": 66, "user_id": 1598672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3233f8573d90dfacedcb06a1b74978e0?s=128&d=identicon&r=PG", "display_name": "luite", "link": "https://stackoverflow.com/users/1598672/luite"}, "edited": false, "score": 0, "creation_date": 1480967046, "post_id": 40923946, "comment_id": 69173635, "body": "The <code>JSString</code> based <code>text</code> implementation is available in <code>Data.JSString</code> of the <code>ghcjs-base</code> package. If it&#39;s not available there, that&#39;s probably the first place where it should be added.  I think it&#39;ll take another step to actually get it into the unofficial <code>text</code> package replacement offered by reflex-platform after that."}, {"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "reply_to_user": {"reputation": 66, "user_id": 1598672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3233f8573d90dfacedcb06a1b74978e0?s=128&d=identicon&r=PG", "display_name": "luite", "link": "https://stackoverflow.com/users/1598672/luite"}, "edited": false, "score": 0, "creation_date": 1480969139, "post_id": 40923946, "comment_id": 69174791, "body": "@luite Thanks. That gives me a better idea of the process for contributing in this area."}], "answers": [{"comments": [{"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "edited": false, "score": 0, "creation_date": 1480966349, "post_id": 40981664, "comment_id": 69173207, "body": "Thanks! I&#39;m definitely interesting in leaving this optimization turned on, and since the <code>text</code> smart constructor is still available, I can still work on mutable arrays and freeze them when needed. If I have other general feedback about this feature, where is the most appropriate place to leave it? On the github issue page for reflex-platform or somewhere else?"}, {"owner": {"reputation": 111, "user_id": 4472631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0294919d7fce64ebd1d27def6d7f1d5?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Trinkle", "link": "https://stackoverflow.com/users/4472631/ryan-trinkle"}, "reply_to_user": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "edited": false, "score": 0, "creation_date": 1481403136, "post_id": 40981664, "comment_id": 69366485, "body": "A github issue on reflex-platform works well, or for live discussion you can join us in #reflex-frp on freenode.irc.net."}], "tags": [], "owner": {"reputation": 111, "user_id": 4472631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0294919d7fce64ebd1d27def6d7f1d5?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Trinkle", "link": "https://stackoverflow.com/users/4472631/ryan-trinkle"}, "is_accepted": true, "score": 6, "last_activity_date": 1480965365, "creation_date": 1480965365, "answer_id": 40981664, "question_id": 40923946, "link": "https://stackoverflow.com/questions/40923946/ghcjs-text-data-constructor/40981664#40981664", "title": "GHCJS Text Data Constructor", "body": "<p>It looks like you might be using <a href=\"https://github.com/reflex-frp/reflex-platform\" rel=\"noreferrer\">reflex-platform</a>.  We recently integrated a change that uses JSString for Text rather than the usual implementation; that's because JSString is dramatically faster and uses a lot less memory than the pure-Haskell Text implementation.</p>\n\n<p>If this is what you're running into, I'd encourage you to stick with JSString unless you're quite unconcerned about performance.  However, if you'd like to disable this optimization, I think it should work to just comment out <a href=\"https://github.com/reflex-frp/reflex-platform/blob/develop/default.nix#L245-L298\" rel=\"noreferrer\">this block</a> and then re-enter your try-reflex/work-on/nix-shell.</p>\n"}], "owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 40981664, "answer_count": 1, "score": 3, "last_activity_date": 1480965365, "creation_date": 1480647097, "last_edit_date": 1495540473, "question_id": 40923946, "link": "https://stackoverflow.com/questions/40923946/ghcjs-text-data-constructor", "title": "GHCJS Text Data Constructor", "body": "<p>I am using nix with reflex platform to compile haskell to javascript with GHCJS 8.0.1. I have written some functions that rely on an internal module in the <code>text</code> library: <code>Data.Text.Internal</code>. The only thing I need from this is the data constructor for <code>Text</code>:</p>\n\n<pre><code>data Text = Text\n  {-# UNPACK #-} !A.Array -- payload (Word16 elements)\n  {-# UNPACK #-} !Int     -- offset (units of Word16, not Char)\n  {-# UNPACK #-} !Int     -- length (units of Word16, not Char)\n</code></pre>\n\n<p>However, when I try to compile code that uses this data constructor with GHCJS, it fails. The error message makes it clear that somehow, somewhere, the data constructor for <code>Text</code> has been replaced by:</p>\n\n<pre><code>newtype Text = Text JSString\n</code></pre>\n\n<p>I understand that I can put <code>#ifdef</code>s around blocks of code to work around this. However, I cannot figure out how this data constructor replacement has been accomplished. This is not mentioned anywhere in <code>ghcjs-shims</code>. It isn't mentioned is <code>ghcjs</code> either. Even weirder is that <code>ghcjs-base</code> has functions that use the normal data constructor for <code>Text</code>. I would appreciate if anyone could point me to the source of this replacement.</p>\n\n<p>EDIT: This is not relevant to the question, but the reason I need to use the internals of <code>Text</code> is to efficiently encode things like IPv4 addresses and MAC addresses. In my the <a href=\"https://stackoverflow.com/questions/37364882/ghc-haskell-performance-of-ipv4-address-rendering\">benchmarks I included with a previous question</a>, I found that the fastest IPv4 encoding using the public API of <code>text</code> took around 450ns. Using the internals (and writing to a mutable array directly), I can do this in around 35ns, which is at least at 10x improvement in performance.</p>\n\n<p>EDIT 2: Something else I just remembered (which is possibly relevant to the question) is that in another place in my code, I had used <code>hexadecimal</code> from <a href=\"http://hackage.haskell.org/package/text-1.2.2.1/docs/Data-Text-Lazy-Builder-Int.html\" rel=\"nofollow noreferrer\">Data.Text.Lazy.Builder.Int</a>. However, with ghcjs, this function isn't exported by this module. I would be glad to contribute it upstream somewhere, but since I don't understand how all of the modules in <code>text</code> are getting shimmed out, I don't know where the appropriate upstream for this is. I would appreciate if someone could point me to the specific file where this is accomplished.</p>\n"}, {"tags": ["haskell", "mapreduce", "theory"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 6, "creation_date": 1480636176, "post_id": 40922402, "comment_id": 69057023, "body": "That would be a bit of a simplifying statement - but sort of yes. The main difference you are probably interested in is that <code>foldr</code> folds starting at one end, while MapReduce generally reduces in any order. A better comparison would be with <code>foldMap</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1480637466, "post_id": 40922402, "comment_id": 69057361, "body": "As a side note, unless you have a more specific actual question about this, I&#39;m think this question should be closed as too broad."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 8, "last_activity_date": 1480640918, "last_edit_date": 1480640918, "creation_date": 1480638289, "answer_id": 40922790, "question_id": 40922402, "link": "https://stackoverflow.com/questions/40922402/can-foldr-be-used-as-mapreduce/40922790#40922790", "title": "Can foldr be used as MapReduce?", "body": "<p>Not quite. As Alec's comment indicates, <code>foldr</code> doesn't allow reduction to be reordered or parallelized. For example, if you have</p>\n\n<pre><code>foldr (+) 0 [1,2,3,4]\n</code></pre>\n\n<p>then that's</p>\n\n<pre><code>1 + (2 + (3 + 4))\n</code></pre>\n\n<p>The implementation of <code>foldr</code> can't split the container and sum each half separately, because you're just giving it a function <code>a -&gt; b -&gt; b</code> and a value <code>b</code>. It can't do anything with the function except apply it to both an element and an accumulator.</p>\n\n<pre><code>foldMap :: (Foldable f, Monoid m)\n        =&gt; (a -&gt; m) -&gt; f a -&gt; m\n</code></pre>\n\n<p>on the other hand, is very much a <code>mapReduce</code>. Since the <code>Monoid</code> constraint carries with it a claim of associativity, you can write a <code>foldMap</code> that reduces the first half of the container and the second half in parallel, and then mashes them together with <code>&lt;&gt;</code>.</p>\n\n<hr>\n\n<p>The default implementation of <code>foldr</code> (in <code>Data.Foldable</code>) actually uses <code>foldMap</code>:</p>\n\n<pre><code>foldr c n xs = appEndo (foldMap (Endo . c) xs) n\n</code></pre>\n\n<p>That is, it turns each element into a <em>function</em>; those functions are all composed (composition forms a monoid with <code>id</code> as its identity) and the result applied to the seed. You can't, however, do anything useful with the intermediate functions!</p>\n"}], "owner": {"reputation": 1661, "user_id": 2092686, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/106a013afd3c8f6a2bcde0c1adc5b715?s=128&d=identicon&r=PG&f=1", "display_name": "godzsa", "link": "https://stackoverflow.com/users/2092686/godzsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 40922790, "answer_count": 1, "score": 0, "last_activity_date": 1480640918, "creation_date": 1480635786, "question_id": 40922402, "link": "https://stackoverflow.com/questions/40922402/can-foldr-be-used-as-mapreduce", "title": "Can foldr be used as MapReduce?", "body": "<p>I was thinking that when you do a MapReduce you are transforming your datalist and then using a reduce function to do whatever you want with the transformed data. I guess I can do the same with <code>foldr</code>. When doing something like <code>foldr (filterfun . mapfun) []</code>. Can I say that Haskell's foldr is identical to a mapreduce? Or am I missing something?</p>\n"}, {"tags": ["list", "haskell", "group-by", "tuples"], "comments": [{"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 2, "creation_date": 1480633082, "post_id": 40921619, "comment_id": 69056050, "body": "What did you try?"}, {"owner": {"reputation": 388, "user_id": 7141304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9beafa514fc22789f1f2b972857a2d?s=128&d=identicon&r=PG&f=1", "display_name": "Bernhard", "link": "https://stackoverflow.com/users/7141304/bernhard"}, "reply_to_user": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1480633777, "post_id": 40921619, "comment_id": 69056307, "body": "I think that I could use the <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:groupBy\" rel=\"nofollow noreferrer\">groupBy function</a>. But I don&#39;t know how."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1480633920, "post_id": 40921619, "comment_id": 69056356, "body": "Exactly. Now you just need a function that takes two tuples and returns True if their first elements are equal. Note through that <code>group</code> only groups consecutive elements."}], "answers": [{"comments": [{"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 2, "creation_date": 1480634267, "post_id": 40922107, "comment_id": 69056452, "body": "Note, that normally you would want to use <code>foldr</code> instead of <code>foldr1</code>, because <code>foldr1</code> fails for <code>[]</code>. However, since <code>group</code> never creates empty group-lists (by which I mean something like <code>[[]]</code>, <code>[]</code>), here <code>foldr1</code> is fine."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 0, "last_activity_date": 1480633908, "creation_date": 1480633908, "answer_id": 40922107, "question_id": 40921619, "link": "https://stackoverflow.com/questions/40921619/group-by-first-element-of-a-list-of-tuple-and-apply-function-to-all-grouped-seco/40922107#40922107", "title": "Group by first element of a list of tuple and apply function to all grouped second elements", "body": "<p>This seems to be a homework/study assignment so I will only give a few hints:</p>\n\n<ul>\n<li>you already named the most important function you need <code>groupBy</code> (from <code>Data.List</code>)</li>\n<li>moreover you need something to group with - you can either use a lambda expression, or the little function <code>on</code> provided by the <code>Data.Function</code> module - <code>(==) `on` fst</code> would be an idiomatic way to write this in haskell, but for the exercise write up a lambda function - that does the \"comparison\"</li>\n<li>after the grouping you have something of type <code>[[(Int,Int)]]</code> and with the handy functions <code>map</code> and <code>foldr1</code> you can then add those pairs - provided you have a function <code>add2 :: (Int,Int) -&gt; (Int,Int) -&gt; (Int,Int)</code> that adds the 2nd components</li>\n</ul>\n"}], "owner": {"reputation": 388, "user_id": 7141304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a9beafa514fc22789f1f2b972857a2d?s=128&d=identicon&r=PG&f=1", "display_name": "Bernhard", "link": "https://stackoverflow.com/users/7141304/bernhard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1135, "favorite_count": 0, "closed_date": 1480634078, "accepted_answer_id": 40922107, "answer_count": 1, "score": 0, "last_activity_date": 1480703278, "creation_date": 1480631572, "last_edit_date": 1495541634, "question_id": 40921619, "link": "https://stackoverflow.com/questions/40921619/group-by-first-element-of-a-list-of-tuple-and-apply-function-to-all-grouped-seco", "closed_reason": "Duplicate", "title": "Group by first element of a list of tuple and apply function to all grouped second elements", "body": "<p>I have a list</p>\n\n<p><code>[(8,2),(3,2),(3,1),(10,2),(10,6)] :: [(Int,Int)]</code></p>\n\n<p>and I want to get a list of tuples which is grouped by the first element of the tuple list. Also I would like to have a function applied for all grouped tuples, e.g. the sum.</p>\n\n<p>After applying the group by and the function <code>(+)</code> I expect the result:</p>\n\n<p><code>[(8,2),(3,3),(10,8)] :: [(Int,Int)]</code></p>\n\n<p>How can I do this with Haskell?</p>\n\n<hr>\n\n<p>EDIT</p>\n\n<p>This is not an exact duplicate to \n<a href=\"https://stackoverflow.com/questions/12398458/how-to-group-similar-items-in-a-list-using-haskell\">How to group similar items in a list using Haskell?</a> because I also want to know how to apply a function to every second element in a grouped tuple list.</p>\n\n<hr>\n\n<p>I tried the following and I think it works now.</p>\n\n<pre><code>test :: Eq a =&gt; Tree a -&gt; [(a,Int)]\ntest t = map (foldl1 sumZahlwerte) grouped\n  where grouped = groupBy (\\c d -&gt; fst c == fst d) (getTuple t)\n\nsumZahlwerte :: Eq a =&gt; (a,Int) -&gt; (a,Int) -&gt;  (a,Int)\nsumZahlwerte (b,c) (_,e) = (b,c+e)\n</code></pre>\n\n<p>where <code>getTuple t</code> returns a <code>[(a,Int)]</code> list.</p>\n\n<p>Feedback is appreciated. Thank you for your help!</p>\n"}, {"tags": ["haskell", "stack-overflow"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480629931, "post_id": 40920788, "comment_id": 69054621, "body": "It hardly matters. Your program will blow the stack no matter how you run it. It&#39;s basically the same as <code>main = main</code>, but the later will produce a <code>&lt;&lt;loop&gt;&gt;</code> exception instead of a stack overflow. 33K is a pretty large stack for the way GHC uses it."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1480630191, "post_id": 40920788, "comment_id": 69054765, "body": "The reported stack size in the message is wrong. I thought this got fixed though."}, {"owner": {"reputation": 208, "user_id": 955040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d484d22158ca140c94ce5bfd2a44e8?s=128&d=identicon&r=PG", "display_name": "nimi", "link": "https://stackoverflow.com/users/955040/nimi"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1480631779, "post_id": 40920788, "comment_id": 69055519, "body": "@ReidBarton: a bug in ghc, maybe <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10445\" rel=\"nofollow noreferrer\">this one</a>, although it is marked as &quot;fixed&quot;? Anyone familiar with the ghc bug tracking system? Is there a way to re-open a ticket?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1480632446, "post_id": 40920788, "comment_id": 69055797, "body": "Yes that&#39;s the one I was thinking of. I reopened the ticket."}], "answers": [{"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 3, "last_activity_date": 1480632955, "creation_date": 1480632955, "answer_id": 40921911, "question_id": 40920788, "link": "https://stackoverflow.com/questions/40920788/stack-space-overflow-error-in-haskell-with-a-very-small-stack-size/40921911#40921911", "title": "Stack space overflow error in Haskell with a very small stack size", "body": "<p>It's a bug in GHC; the reported stack size in the message is wrong. See <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10445\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/ticket/10445</a> and thanks for noticing that it's not actually fixed.</p>\n"}], "owner": {"reputation": 208, "user_id": 955040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36d484d22158ca140c94ce5bfd2a44e8?s=128&d=identicon&r=PG", "display_name": "nimi", "link": "https://stackoverflow.com/users/955040/nimi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 40921911, "answer_count": 1, "score": 4, "last_activity_date": 1480632955, "creation_date": 1480627957, "question_id": 40920788, "link": "https://stackoverflow.com/questions/40920788/stack-space-overflow-error-in-haskell-with-a-very-small-stack-size", "title": "Stack space overflow error in Haskell with a very small stack size", "body": "<p>The Haskell program </p>\n\n<pre><code>main=main&gt;&gt;main\n</code></pre>\n\n<p>fails with </p>\n\n<pre><code>2mem: Stack space overflow: current size 33624 bytes.\n2mem: Use `+RTS -Ksize -RTS' to increase it.\n</code></pre>\n\n<p>33k seems quite small. The OS (via top) is reporting a total memory usage of 6G before failing. When I compile the program with <code>ghc -rtsopts 2mem.hs</code> and run it with <code>./2mem +RTS -K32M</code> I sill get the same error.</p>\n\n<p>I'm using ghc, version 8.0.1 on MacOS 10.11.6.</p>\n\n<p>Why is the stack space so small and why doesn't <code>-K32M</code> increase it?</p>\n"}, {"tags": ["haskell", "haskell-pipes"], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1480882273, "last_edit_date": 1495535441, "creation_date": 1480742758, "answer_id": 40944563, "question_id": 40920498, "link": "https://stackoverflow.com/questions/40920498/how-to-turn-a-pull-based-pipe-into-a-push-based-one/40944563#40944563", "title": "How to turn a pull based pipe into a push based one?", "body": "<blockquote>\n<pre><code>-- push based operator, doesn't do what I hoped\nrunEffect (stdin &gt;&gt;~ (\\_ -&gt; countLetters))\n</code></pre>\n</blockquote>\n\n<p>I gather the problem here is that, while the producer is ran first as expected, the first produced value is dropped. Compare...</p>\n\n<pre><code>GHCi&gt; runEffect (stdin &gt;-&gt; countLetters)\ncountLetters\nstdin\nfoo\n3\ncountLetters\nstdin\nglub\n4\ncountLetters\nstdin\n</code></pre>\n\n<p>... with:</p>\n\n<pre><code>GHCi&gt; runEffect (stdin &gt;&gt;~ (\\_ -&gt; countLetters))\nstdin\nfoo\ncountLetters\nstdin\nglub\n4\ncountLetters\nstdin\n</code></pre>\n\n<p>This issue is discussed in detail by Gabriel Gonzalez' answer to <a href=\"https://stackoverflow.com/q/18471706/2751851\">this question</a>. It boils down to how the argument to the function you give to <code>(&gt;&gt;~)</code> is the \"driving\" input in the push-based flow, and so if you <code>const</code> it away you end up dropping the first input. The solution is to reshape <code>countLetters</code> accordingly:</p>\n\n<pre><code>countLettersPush :: String -&gt; Consumer String IO r\ncountLettersPush str = do\n  lift $ putStrLn \"countLetters\"\n  lift . putStrLn . show . length $ str\n  str' &lt;- await\n  countLettersPush str'\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; runEffect (stdin &gt;&gt;~ countLettersPush)\nstdin\nfoo\ncountLetters\n3\nstdin\nglub\ncountLetters\n4\nstdin\n</code></pre>\n\n<blockquote>\n  <p>I've also seen in discussions <a href=\"https://www.reddit.com/r/haskell/comments/14yttw/24_days_of_hackage_pipes/c7hylyc/\" rel=\"nofollow noreferrer\">here</a> that there is no push based counterpart to <code>&gt;-&gt;</code> because it is easy to turn any pipe around (I assume with reflect?)</p>\n</blockquote>\n\n<p>I'm not fully sure of my ground, but it seems that doesn't quite apply to the solution above. What we <em>can</em> do, now that we have the push-based flow working correctly, is using <a href=\"https://hackage.haskell.org/package/pipes-4.2.0/docs/Pipes-Core.html#g:7\" rel=\"nofollow noreferrer\"><code>reflect</code></a> to turn it around back to a pull-based flow:</p>\n\n<pre><code>-- Preliminary step: switching to '(&gt;~&gt;)'.\nstdin &gt;&gt;~ countLettersPush\n(const stdin &gt;~&gt; countLettersPush) ()\n\n-- Applying 'reflect', as the documentation suggests.\nreflect . (const stdin &gt;~&gt; countLettersPush)\nreflect . const stdin &lt;+&lt; reflect . countLettersPush\nconst (reflect stdin) &lt;+&lt; reflect . countLettersPush\n\n-- Rewriting in terms of '(+&gt;&gt;)'.\n(reflect . countLettersPush &gt;+&gt; const (reflect stdin)) ()\nreflect . countLettersPush +&gt;&gt; reflect stdin\n</code></pre>\n\n<p>This is indeed pull-based, as the flow is driven by <code>reflect stdin</code>, the downstream <a href=\"https://hackage.haskell.org/package/pipes-4.2.0/docs/src/Pipes-Core.html#Client\" rel=\"nofollow noreferrer\"><code>Client</code></a>:</p>\n\n<pre><code>GHCi&gt; :t reflect stdin\nreflect stdin :: Proxy String () () X IO r\nGHCi&gt; :t reflect stdin :: Client String () IO r\nreflect stdin :: Client String () IO r :: Client String () IO r\n</code></pre>\n\n<p>The flow, however, involves sending <code>String</code>s upstream, and so it cannot be expressed in terms of <code>(&gt;-&gt;)</code>, which is, so to say, downstream-only:</p>\n\n<pre><code>GHCi&gt; -- Compare the type of the second argument with that of 'reflect stdin'\nGHCi&gt; :t (&gt;-&gt;)\n(&gt;-&gt;)\n  :: Monad m =&gt;\n     Proxy a' a () b m r -&gt; Proxy () b c' c m r -&gt; Proxy a' a c' c m \n</code></pre>\n"}], "owner": {"reputation": 2369, "user_id": 1500583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71020354a2fefbdadf424bd48c912515?s=128&d=identicon&r=PG", "display_name": "David McHealy", "link": "https://stackoverflow.com/users/1500583/david-mchealy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 463, "favorite_count": 1, "accepted_answer_id": 40944563, "answer_count": 1, "score": 6, "last_activity_date": 1480882273, "creation_date": 1480626902, "last_edit_date": 1480794623, "question_id": 40920498, "link": "https://stackoverflow.com/questions/40920498/how-to-turn-a-pull-based-pipe-into-a-push-based-one", "title": "How to turn a pull based pipe into a push based one?", "body": "<p>By default pipes are pull based.  This is due to the operator <code>&gt;-&gt;</code> which is implemented via <code>+&gt;&gt;</code> which is the pointful <code>bind</code> operator for his pull category.  My understanding is that this means that if you have code like <code>producer &gt;-&gt; consumer</code>, the consumer's body will be called first, then once it awaits data, the producer will be called.</p>\n\n<p>I've seen in the <code>pipes</code> documentation <a href=\"https://hackage.haskell.org/package/pipes-4.2.0/docs/Pipes-Core.html#v:-43--62--62-\" rel=\"nofollow noreferrer\">here</a> that you can use the code <code>(reflect .)</code> from <code>Pipes.Core</code> to turn a pull based pipe into a push based pipe.  That means instead (correct me if I'm wrong) that in the code above <code>producer &gt;-&gt; consumer</code>, the producer is run first, produces a value, then the consumer tries to consume.  That seems really useful and I'd like to know how to do it.</p>\n\n<p>I've also seen in discussions <a href=\"https://www.reddit.com/r/haskell/comments/14yttw/24_days_of_hackage_pipes/c7hylyc/\" rel=\"nofollow noreferrer\">here</a> that there is no push based counterpart to <code>&gt;-&gt;</code> because it is easy to turn any pipe around (I assume with reflect?), but I can't really figure how to do it or find any examples.</p>\n\n<p>Here's some code I've attempted:</p>\n\n<pre><code>stdin :: Producer String IO r\nstdin = forever $ do\n  lift $ putStrLn \"stdin\"\n  str &lt;- lift getLine\n  yield str\n\ncountLetters :: Consumer String IO r\ncountLetters = forever $ do\n  lift $ putStrLn \"countLetters\"\n  str &lt;- await\n  lift . putStrLn . show . length $ str\n\n-- this works in pull mode\nrunEffect (stdin &gt;-&gt; countLetters)\n\n-- equivalent to above, works\nrunEffect ((\\() -&gt; stdin) +&gt;&gt; countLetters)\n\n-- push based operator, doesn't do what I hoped\nrunEffect (stdin &gt;&gt;~ (\\_ -&gt; countLetters))\n\n-- does not compile\nrunEffect (countLetters &gt;&gt;~ (\\() -&gt; stdin))\n</code></pre>\n"}, {"tags": ["haskell", "types"], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 4, "last_activity_date": 1480626441, "last_edit_date": 1480626441, "creation_date": 1480625691, "answer_id": 40920199, "question_id": 40919938, "link": "https://stackoverflow.com/questions/40919938/couldnt-match-expected-type-custom-type/40920199#40920199", "title": "couldn&#39;t match expected type (custom type)", "body": "<p>It's difficult to write an anonymous function that maps arbitrary inputs to outputs if there is no general formula. To start, you can use an association list instead; the standard function <code>lookup</code> allows you to get the value for a given variable. (This isn't the best performing method, but it allows you to avoid any additional imports to start.)</p>\n\n<pre><code>-- I lied; one import from the base library\n-- We're going to assume the lookup succeeds;\nimport Data.Maybe\n\n-- A better function would use Maybe Int as the return type,\n-- returning Nothing when the expression contains an undefined variable\nexp2store :: Eq x =&gt; Exp x -&gt; [(x,Int)] -&gt; Int\nexp2store (Con i) _     = i\nexp2store (Var x) st    = fromJust $ lookup x st\nexp2store (Sum es) st   = sum $ map (flip exp2store st) es\nexp2store (Prod es) st  = product $ map (flip exp2store st) es\nexp2store (e :- e') st  = exp2store e st - exp2store e' st\nexp2store (i :* e) st   = i * exp2store e st\nexp2store (e :^ i) st   = exp2store e st ^ i\n</code></pre>\n\n<p>Call the function as</p>\n\n<pre><code>exp2store (Sum[Var\"x\",Var\"y\"]) $ [(\"x\",5), (\"y\",10)]\n</code></pre>\n\n<p>If you must keep <code>Store</code> as defined, you can write your call like this</p>\n\n<pre><code>exp2store (Sum[Var\"x\",Var\"y\"]) $ \\x -&gt; case x of \"x\" -&gt; 5; \"y\" -&gt; 10\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7238179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af0da3b389f267a72ac4cf53fadca1e?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/7238179/joshua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 40920199, "answer_count": 1, "score": 0, "last_activity_date": 1480626441, "creation_date": 1480624709, "last_edit_date": 1480625535, "question_id": 40919938, "link": "https://stackoverflow.com/questions/40919938/couldnt-match-expected-type-custom-type", "title": "couldn&#39;t match expected type (custom type)", "body": "<p>this is my current code:</p>\n\n<pre><code>data Exp x = Con Int | Var x | Sum [Exp x] | Prod [Exp x] \n    | Exp x :- Exp x | Int :* Exp x | Exp x :^ Int\n\nexpression :: Exp String\nexpression = Sum [3:*(Var\"x\":^2), 2:*Var\"y\", Con 1]\n\ntype Store x = x -&gt; Int\n\nexp2store :: Exp x -&gt; Store x -&gt; Int\nexp2store (Con i) _     = i\nexp2store (Var x) st    = st x\nexp2store (Sum es) st   = sum $ map (flip exp2store st) es\nexp2store (Prod es) st  = product $ map (flip exp2store st) es\nexp2store (e :- e') st  = exp2store e st - exp2store e' st\nexp2store (i :* e) st   = i * exp2store e st\nexp2store (e :^ i) st   = exp2store e st ^ i\n</code></pre>\n\n<p>Exp should represent a polynomial expression and exp2store takes an expression and a function which supplies the variables in the expression with a value.</p>\n\n<p>Example:</p>\n\n<pre><code>*Main&gt; exp2store (Var\"x\") $ \\\"x\" -&gt; 5\n5\n</code></pre>\n\n<p>that works. I don't know how I could supply multiple variables with different values, i.e.</p>\n\n<pre><code>*Main&gt; exp2store (Sum[Var\"x\",Var\"y\"]) $ \\\"x\" \"y\" -&gt; 5 10\n</code></pre>\n\n<p>Obviously, this throws an exception. Can somebody help me with this?</p>\n"}, {"tags": ["haskell", "lazy-evaluation"], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1480627291, "post_id": 40920093, "comment_id": 69053416, "body": "You don&#39;t even need to enable the monomorphism restriction to demonstrate the difference, you can simply give ghci an explicit type instead of letting it infer a polymorphic type: <code>let x = trace &quot;1&quot; 1 :: Int in x + x</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1480628203, "post_id": 40920093, "comment_id": 69053841, "body": "This isn&#39;t the monomorphism restriction being off. It&#39;s <code>let</code> generalization being on. GHC must be using the fact that <code>x</code> is used twice at the same type, I guess, while GHCi uses the most general type. Or something. This all seems a bit weird."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1480634898, "post_id": 40920093, "comment_id": 69056646, "body": "@dfeuer, GHC doesn&#39;t use the most general type because it would violate the monomorphism restriction. And the last paragraph of the answer is not really right, in a compiled program (without optimizations) you will see the same results as in ghci if you use <code>{-# LANGUAGE NoMonomorphismRestriction #-}</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1480636886, "post_id": 40920093, "comment_id": 69057225, "body": "@ReidBarton, well, I guess it&#39;s a sort of combination effect. Consider <code>let x :: a; x = trace &quot;1&quot; 1 in x+x :: forall a . Num a =&gt; a</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1480671761, "post_id": 40920093, "comment_id": 69069072, "body": "@ReidBarton: sure? Even with <code>ghc -O0 -XNoMonomorphismRestriction</code> I don&#39;t get a duplicate trace."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1480686424, "post_id": 40920093, "comment_id": 69078348, "body": "My guess would be that it&#39;s because in ghci the result is bound to the implicit <code>it</code> variable. With no monomorphism restriction that stays polymorphic, so <code>x</code> has to be polymorphic. The <b>use</b> of that during printing gets defaulted, but the binding is polymorphic so the think isn&#39;t overwritten. But in the full program compiled with ghc, the result of <code>x + x</code> never goes anywhere polymorphic so the original binding of <code>x</code> gets defaulted, and is monomorphic."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 7, "last_activity_date": 1480625830, "last_edit_date": 1480625830, "creation_date": 1480625346, "answer_id": 40920093, "question_id": 40919795, "link": "https://stackoverflow.com/questions/40919795/is-it-possible-to-switch-off-the-strictness-analyzer-on-ghc/40920093#40920093", "title": "Is it possible to switch off the strictness analyzer on GHC?", "body": "<p>This has nothing to do with strictness. The behaviour of GHCi is actually just silly if you think about it: it \u201ccomputes\u201d <code>x</code> twice. Lazy or not, a constant shouldn't need to be calculated twice!</p>\n\n<p>What's going on: <code>x</code> has a generic number type <code>Num a =&gt; a</code>. That means, its implementation is not really just a constant, but a function with a \u201ctype\u201d- (actually, a <em>dictionary</em>-)argument. Functions are generally not feasible to memoise, so such a polymorphic value <em>is</em> recomputed whenever you need its value. That's annoying, hence standard Haskell avoids this by a somewhat controversial measure, the <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow noreferrer\">monomorphism restriction</a>. It basically eliminates polymorphism if it can thereby turn values into <a href=\"https://wiki.haskell.org/Constant_applicative_form\" rel=\"nofollow noreferrer\">constant applicative forms</a>. So <code>x</code> is inferred with the simpler type <code>Integer</code>, which <em>is</em> then a constant which only triggers <code>trace</code> the one time it's computed whereas the second evaluation just re-uses the already known value. (Which is the \u201cproper lazy\u201d behaviour!)</p>\n\n<p>The reason you don't see this in GHCi is that since version 7.8, it has the monomorphism restriction turned off by default! You can turn it on to see what this does:</p>\n\n<pre><code>GHCi, version 7.10.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :m +Debug.Trace\nPrelude Debug.Trace&gt; let x = trace \"1\" 1 in x + x\n1\n1\n2\nPrelude Debug.Trace&gt; :set -XMonomorphismRestriction \nPrelude Debug.Trace&gt; let x = trace \"1\" 1 in x + x\n1\n2\n</code></pre>\n\n<p>Fortunately, in an actual program the double evaluation will not happen even with the monomorphism restriction turned <em>off</em>, because when <code>x</code> is defined in a function body the compiler can see that <em>within the scope of the function</em>, it is not polymorphic. Hence your second code should never trace <code>1</code> twice. (Though always keep in mind, <code>trace</code> is just a crude debugging tool that really works against the language's grain \u2013 generally don't expect any reproducible behaviour from it.)</p>\n"}], "owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 40920093, "answer_count": 1, "score": 0, "last_activity_date": 1480625830, "creation_date": 1480624172, "question_id": 40919795, "link": "https://stackoverflow.com/questions/40919795/is-it-possible-to-switch-off-the-strictness-analyzer-on-ghc", "title": "Is it possible to switch off the strictness analyzer on GHC?", "body": "<p>It shows <code>ghci</code> is lazy all round below,</p>\n\n<pre><code>ghci &gt; let x = trace \"1\" 1 in x + x\n\n1\n1\n2\n</code></pre>\n\n<p>Running the code below after compilation shows default <code>ghc</code> is enhanced by <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/using-optimisation.html#ghc-flag--fstrictness\" rel=\"nofollow noreferrer\">strictness analyzer</a>.</p>\n\n<pre><code>main = do print $ let x = trace \"1\" 1 in x + x\n\n1\n2\n</code></pre>\n\n<p>But why does the result remain same even if the options <code>-O0 -fno-strictness</code> are passed to <code>ghc</code>?</p>\n"}, {"tags": ["function", "haskell", "pointfree"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1480617192, "post_id": 40917772, "comment_id": 69048002, "body": "You can make it point free - it just isn&#39;t nice <code>agreeLen = ((length . takeWhile id) .) . zipWith (==)</code>. <a href=\"http://pointfree.io\" rel=\"nofollow noreferrer\">pointfree.io</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1480617329, "post_id": 40917772, "comment_id": 69048091, "body": "There&#39;s no completely precise definition of &quot;pointfree&quot; in Haskell. Usually, using library combinators like <code>flip, const, id, &lt;*&gt;</code> and many others is allowed. But that might be considered cheating by some, depending on what you use. I guess <code>const, &lt;*&gt;</code> should suffice for everything, as they do allow to define anything in the untyped lambda calculus."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1480618315, "post_id": 40917772, "comment_id": 69048633, "body": "@chi, eliminators like <code>bool</code>, <code>maybe</code>, and <code>foldr</code> are also generally allowed, as point-free leaves no room for pattern matching."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 6, "last_activity_date": 1480624309, "last_edit_date": 1495541811, "creation_date": 1480617449, "answer_id": 40918028, "question_id": 40917772, "link": "https://stackoverflow.com/questions/40917772/what-are-the-prerequisites-for-a-point-free-function-in-haskell/40918028#40918028", "title": "What are the prerequisites for a point-free function in Haskell", "body": "<p>Your first one <em>can</em> be written in point-free style, but you have to adapt it to your use of <code>map</code> as an infix function.</p>\n\n<pre><code>let lengthz = (length `map`) -- write the partial application as a section\n</code></pre>\n\n<p>The problem with <code>agreeLen</code> is that <code>zipWith</code> is not a function of one argument, but of two. <code>zipWith</code> needs to be applied to both arguments before its result can be passed to <code>takeWhile id</code>. The not-easy way to write it in point-free style is</p>\n\n<pre><code>-- via http://pointfree.io\nagreeLen = ((length . takeWhile id) .) . zipWith (==)\n</code></pre>\n\n<p>Put briefly, <code>zipWith (==)</code> is applied to the first argument <code>x</code> to <code>agreeLen</code> to produce a new function (one that takes a list and returns a zipped list). This new function is given as an argument to <code>(length . takeWhile id) .</code>, which produces a new composed function that takes the second argument to <code>agreeLen</code> and produce the desired <code>Int</code> value.</p>\n\n<p>(@duplode probably <a href=\"https://stackoverflow.com/a/40918034/1126841\">derives this</a> more cleanly than what I was about to attempt.)</p>\n\n<p>A trick that quickly gets out of hand when the initial function takes more than 2 arguments is to explicitly uncurry it, do the composition, then re-curry the result.</p>\n\n<pre><code>agreeLen = curry $ length . takeWhile id . (uncurry $ zipWith (==))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1480618030, "post_id": 40918034, "comment_id": 69048501, "body": "I think not quite anything. You can run into impredicativity with <code>RankNTypes</code>."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 7, "last_activity_date": 1480646170, "last_edit_date": 1480646170, "creation_date": 1480617459, "answer_id": 40918034, "question_id": 40917772, "link": "https://stackoverflow.com/questions/40917772/what-are-the-prerequisites-for-a-point-free-function-in-haskell/40918034#40918034", "title": "What are the prerequisites for a point-free function in Haskell", "body": "<blockquote>\n<pre><code>-- However this cannot:\nlet lengthz x = length `map` x\n-- let lengthz' = length `map` (parse error)\n</code></pre>\n</blockquote>\n\n<p><code>\\x -&gt; length `map` x</code> written point free is simply <code>map length</code>. The infix backticks are just syntactical sugar. (As chepner points out, if you really want it you can use a section, i.e. <code>(length `map`)</code>.) </p>\n\n<blockquote>\n<pre><code>agreeLen :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Int\nagreeLen x y = length $ takeWhile id $ zipWith (==) x y\n-- This may look like it can easily be made pointfree, however it cannot\n</code></pre>\n</blockquote>\n\n<p>The key word here is \"easily\". Pretty much anything can be made point-free if you try hard enough. In this case, omitting the <code>y</code> parameter is easy if we write <code>agreeLen</code> in terms of <code>(.)</code> rather than <code>($)</code>: </p>\n\n<pre><code>agreeLen x y = (length . takeWhile id . zipWith (==) x) y\nagreeLen x = length . takeWhile id . zipWith (==) x\n</code></pre>\n\n<p>As for <code>x</code>, we can handle it by treating the use of <code>(.)</code> to compose <code>zipWith (==) x</code> with the other functions as just another case of a value being modified with a function:</p>\n\n<pre><code>agreeLen x = (.) (length . takeWhile id) (zipWith (==) x)\nagreeLen x = ((length . takeWhile id) .) (zipWith (==) x) -- cosmetical change\nagreeLen x = (((length . takeWhile id) .) . zipWith (==)) x\nagreeLen = ((length . takeWhile id) .) . zipWith (==)\n</code></pre>\n\n<p>It is not something you'd actually want to do in practice, but it is certainly possible.</p>\n"}, {"comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1480624100, "post_id": 40919137, "comment_id": 69051831, "body": "Damn, you were faster than me :)"}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 3, "last_activity_date": 1480621486, "creation_date": 1480621486, "answer_id": 40919137, "question_id": 40917772, "link": "https://stackoverflow.com/questions/40917772/what-are-the-prerequisites-for-a-point-free-function-in-haskell/40919137#40919137", "title": "What are the prerequisites for a point-free function in Haskell", "body": "<p>You can always convert a typed lambda expression into a typed combinator expression, using only the polymorphic S (<code>&lt;*&gt;</code>) and K (<code>const</code>) combinators. <a href=\"http://www.emis.de/journals/NSJOM/Papers/23_1/NSJOM_23_1_319_329.pdf\" rel=\"nofollow noreferrer\">A Note on Typed Combinators and Typed Lambda Terms</a> shows a proof, which is also an <em>abstraction algorithm</em> to convert lambda terms into (point-free) combinator terms:</p>\n\n<blockquote>\n  <ol>\n  <li>|x<sub>&alpha;</sub>| x<sub>&alpha;</sub> = I<sub>&alpha; &rarr; &alpha;</sub></li>\n  <li>|x<sub>&alpha;</sub>| X<sub>&alpha;</sub> = K<sub>&beta; &rarr; (&alpha; &rarr; &beta;)</sub>X<sub>&beta;</sub> if x<sub>&alpha;</sub> &notin; X<sub>&beta;</sub></li>\n  <li>|x<sub>&alpha;</sub>| X<sub>&alpha; &rarr; &beta;</sub> = X<sub>&alpha; &rarr; &beta;</sub> if x<sub>&alpha;</sub> &notin; X<sub>&alpha; &rarr; &beta;</sub></li>\n  <li>|x<sub>&alpha;</sub>| X<sub>&beta; &rarr; &gamma;</sub>Y<sub>&beta;</sub> = S<sub>&alpha; &rarr; (&beta; &rarr; &gamma;) &rarr; &alpha; &rarr; &beta; &rarr; (&alpha; &rarr; &gamma;)</sub>(|x<sub>&alpha;</sub>| X<sub>&beta; &rarr; &gamma;</sub>)(|x<sub>&alpha;</sub>| Y<sub>&beta;</sub>) otherwise</li>\n  </ol>\n</blockquote>\n\n<p>This can be converted into Haskell notation easily:</p>\n\n<pre><code>(\\(x :: a) -&gt; (x :: a)) = id\n\n-- If X does not mention x\n(\\(x :: a) -&gt; (X :: a)) = const X\n\n-- If X does not mention x\n(\\(x :: a) -&gt; (X :: a -&gt; b)) = X\n\n(\\(x :: a) -&gt; (X :: b -&gt; c) (Y :: b))\n  = (\\(x :: a) -&gt; X) &lt;*&gt; (\\(x :: a) -&gt; Y)\n</code></pre>\n\n<p>Therefore you can always write a point-free definition, but it might be much larger and uglier without higher-level combinators, and you may need to introduce newtype wrapping &amp; unwrapping or <code>RankNTypes</code> to deal with impredicative polymorphism arising from passing polymorphic functions around.</p>\n\n<p>However, in real Haskell code you mainly want to use point-free style when you can \u201cget the arguments to the end of the definition\u201d, that is, when you can eta-reduce <code>f x = g x</code> into <code>f = g</code>. This works best if you have a simple \u201cpipeline\u201d of functions where you pass one intermediate value along without duplicating or dropping it. For example, here\u2019s a histogram function:</p>\n\n<pre><code>-- import Control.Arrow ((&amp;&amp;&amp;))\n(f &amp;&amp;&amp; g) x = (f x, g x)\n\n-- import Control.Category ((&gt;&gt;&gt;))\n(f &gt;&gt;&gt; g) = g . f\n\nhistogram :: String -&gt; [(Char, Int)]\nhistogram\n  = sort                             -- [Char]\n  &gt;&gt;&gt; group                          -- [[Char]]\n  &gt;&gt;&gt; map (head &amp;&amp;&amp; length)          -- [(Char, Int)]\n  &gt;&gt;&gt; sortBy (flip (comparing snd))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 3, "last_activity_date": 1480638907, "last_edit_date": 1480638907, "creation_date": 1480624015, "answer_id": 40919760, "question_id": 40917772, "link": "https://stackoverflow.com/questions/40917772/what-are-the-prerequisites-for-a-point-free-function-in-haskell/40919760#40919760", "title": "What are the prerequisites for a point-free function in Haskell", "body": "<p>If we call this form of a function definition <em>point-free</em></p>\n\n<pre><code>f = e\n</code></pre>\n\n<p>where <code>f</code> is just a function name and <em>e</em> is an expression,\nwe can make at least those functions point-free that </p>\n\n<ol>\n<li>have a right hand side that is just a function application.</li>\n<li>don't require pattern matching on their arguments and </li>\n<li>the arguments are not mentioned in \"complex\" subexpressions, such as list comprehensions, case, let or lambda abstractions.</li>\n</ol>\n\n<p>That is, if the arguments are just simple names, we can make it point-free if the other two conditions are also met.</p>\n\n<p>For arguments that need some pattern matching, if we can eliminate the constructor with some function (like <code>maybe</code>, <code>either</code>, <code>fst</code>, <code>snd</code>) we can often rewrite the function so that we get one that can be written point-free:</p>\n\n<pre><code> f (a,b) = (b,a)\n f' ab   = (snd ab, fst ab)\n f'' = (pure (,) &lt;*&gt; snd) &lt;*&gt; fst\n</code></pre>\n\n<p>Also, an <code>if</code> expressions on the right hand side can be rewritten as application of <code>bool</code></p>\n\n<p>Here is an algorithm that eliminates some variable <em>v</em> from an expression <em>e</em> such that the resulting expression <em>x</em> doesn't contain <em>v</em> and, when applied to <em>v</em> is equivalent to <em>e</em></p>\n\n<ul>\n<li>If <em>e</em> doesn't contain <em>v</em>, the result is <code>pure e</code></li>\n<li>If <em>e</em> is <em>v</em>, the result is <code>id</code></li>\n<li>If <em>e</em> is some expression <em>f</em> applied to <em>v</em> and <em>f</em> does not mention <em>v</em> the result is <em>f</em></li>\n<li>Otherwise, <em>e</em> must be an application <em>g h</em> where at least one of <em>g</em> and <em>h</em> mentions <em>v</em>. The result would be <em>g' &lt;*> h'</em> where <em>g'</em> is the expression that results when eliminating <em>v</em> from <em>g</em> and <em>h'</em> is the expression that results when eliminating <em>v</em> from <em>h</em></li>\n</ul>\n\n<p>And here is how to make a function definition point-free that fulfills the requirements outlined above</p>\n\n<pre><code> f v1 v2 v3 ... vn = e\n</code></pre>\n\n<ul>\n<li>let <em>e'</em> be the elimination of <em>vn</em> from <em>e</em></li>\n<li><p>Write down the new function</p>\n\n<p>f' v1 v2 v3 ... v(n-1) = e'</p></li>\n<li><p>If no arguments are left, you're done</p></li>\n<li>Otherwise, make <em>f'</em> point-free</li>\n</ul>\n\n<p>Note, there are different ways to eliminate a variable form an expression using functions like <code>(.)</code> <code>flip</code> etc. that often leads to shorter code, however, the above is the most basic method since it only needs the S, K and I combinators (which are written <code>&lt;*&gt;</code> <code>pure</code> and <code>id</code> in Haskell).</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1480644240, "post_id": 40921583, "comment_id": 69059041, "body": "Well, the next step is <code>agreeLen x = (.) (length . takeWhile id) (zipWith (==) x)</code>. Now you can write that as <code>agreeLen = (.) (length . takeWhile id) . zipWith (==)</code>. Finally, you can bring back the operator section to achieve the desired form."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 4, "last_activity_date": 1480644864, "last_edit_date": 1480644864, "creation_date": 1480631406, "answer_id": 40921583, "question_id": 40917772, "link": "https://stackoverflow.com/questions/40917772/what-are-the-prerequisites-for-a-point-free-function-in-haskell/40921583#40921583", "title": "What are the prerequisites for a point-free function in Haskell", "body": "<blockquote>\n  <p>I always thought that the prerequisites for a pointfree function were to get the function arguments to the end of the definition</p>\n</blockquote>\n\n<p>Well, as other answers have shown, this isn't a necessary condition; almost anything can be made point free. So it's not a prerequisite as such, rather just <em>one</em> simple rule for rewriting a function definition. This particular rule even has a name: <strong>eta reduction</strong> (as in the Greek letter \u03b7, spelled out in English as \"eta\"). But it's not the only such rule.</p>\n\n<p>The conditions for applying eta reduction are also not quite just \"get the arguments to the end\". That's a loose description of what it \"looks like\" when you can apply eta reduction, but the actual condition isn't one you can just apply blindly to the source code text without considering the structure of the expression.<sup>1</sup></p>\n\n<p>The <em>real</em> rule is to look for something like:</p>\n\n<p>func x = expr x</p>\n\n<p>By that I do <em>not</em> mean \"some text (that I'm calling <code>expr</code>) followed by <code>x</code>\", but rather \"some well-formed expression (that I'm calling <code>expr</code>) <strong>applied to</strong> <code>x</code>\". The distinction is that I'm talking about the structure of the expression, not the order of characters on the source code representation of that expression. This is crucial to understanding the differences between the examples that are confusing you.</p>\n\n<p>You always need the \"top level expression\" of the function body to be <strong>exactly</strong> something directly applied to the last argument of the function. You also need for that argument not to be referenced anywhere else, but it otherwise doesn't matter what the \"something\" is; it could be a complicated expression with many sub parts.</p>\n\n<p>Now let's consider your examples in that light. </p>\n\n<pre><code>-- This can be made pointfree quite easily:\nlet lengths x = map length x\n</code></pre>\n\n<p>Okay, <code>x</code> is textually at the end. But is it the argument of a top level application? We've got three parts to this expression, not just two, so our rule doesn't necessarily apply immediately. But remembering that function application is left associative (<code>f x y</code> means <code>f</code> is applied to x, and the result of that <code>f x</code> is applied to <code>y</code>), this is <code>map length</code> applied to <code>x</code>. So we can apply eta reduction to eliminate <code>x</code>, leaving just the expression that was applied to it: <code>map length</code>.</p>\n\n<pre><code>-- However this cannot:\nlet lengthz x = length `map` x\n</code></pre>\n\n<p>Again <code>x</code> is textually last, but we clearly can't just cut it out textually, since that doesn't even result in well-formed code. An infix operator needs a left and a right argument (a name written in backticks like <code>`map`</code> turns it into an infix operator).</p>\n\n<p>But remember what infix operator syntax <em>means</em>. <code>length `map` x</code> is <code>map</code> applied to <code>length</code>, and the result of that <code>map length</code> applied to <code>x</code>. So eta reduction <em>does</em> apply, and we can eliminate <code>x</code>. But not just by blinding deleting the source code text \"x\". What is left should be the expression that was applied to <code>x</code>, which is <code>map length</code> again, not the meaningless source code text <code>length `map`</code>.</p>\n\n<p>We do have another option with infix operators though. You <em>can</em> \"leave out\" an argument from an infix operator if you convert it to a <em>section</em> by wrapping the thing in parentheses. So we could write <code>map</code> applied to <code>length</code> and not apply the result to a second argument by writing <code>(length `map`)</code>, if you want to keep the result <em>looking</em> similar to what you started with. This also gives another way of eliminating arguments to get to point free code: we can leave out the <em>first</em> argument of an infix operator just as easily as the second. For example if we had:</p>\n\n<pre><code>f x = x / 3\n</code></pre>\n\n<p>This is <code>(/)</code> applied to <code>x</code>, and then the result of that applied to <code>3</code>. So the argument of the outermost application is <code>3</code>, not <code>x</code>, and we can't apply eta reduction. But we <em>can</em> apply a very similar process because of Haskell's operator section syntax<sup>2</sup>, and eliminate <code>x</code> to leave <code>(/ 3)</code>. Again, note that the important thing to consider is the <em>structure</em> of the expression <code>x / 3</code>, not the order of the bits of source code text we use to write it down.</p>\n\n<p>Enough of that digression. Your last example is a little more complicated:</p>\n\n<pre><code>agreeLen :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Int\nagreeLen x y = length $ takeWhile id $ zipWith (==) x y\n</code></pre>\n\n<p><code>y</code> (and then <code>x</code> if we could do this twice) is at the end of the source code text. But it is <strong>not</strong> the argument of the top-level function application in this expression.</p>\n\n<p>One quirk of Haskell's syntax is that if there are operators involved in an expression (unless they're inside a parenthesised sub-expression), one of them is <em>always</em> the top-level application. This is because normal function application is higher-precedence than any possible operator, and it's the <strong>lowest</strong> precedence thing that ends up being the top-level expression. So just from the presence of the <code>$</code> operators it's immediately obvious that one of them has to be the \"top\" function, and there's no way either of them could be applied to just <code>y</code> on its own. So eta reduction isn't going to apply immediately.</p>\n\n<p>In more detail, this is <code>$</code> applied to <code>length</code>, and then to everything on the right. The top-level application is therefore <code>($) length</code> being applied to <code>takeWhile id $ zipWith (==) x y</code>; <code>y</code> is deep inside the argument expression, we need the argument of the top-level application to just be simply <code>y</code>.</p>\n\n<p>But remember that <code>f $ x</code> is just another way of writing <code>f x</code>, usually used only so we don't have to put parentheses around <code>f</code> or <code>x</code> if those are complex expressions. If we put the parentheses back we get closer to having <code>y</code> at the top level.</p>\n\n<pre><code>agreeLen x y = length (takeWhile id (zipWith (==) x y))\n</code></pre>\n\n<p>We're still not there. But this is \"<code>length</code> applied to (<code>takeWhile id</code> applied to (<code>zipWith (==) x</code> applied to <code>y</code>)). This pattern of \"chaining\" things applied to the result of other applications is exactly what function <em>composition</em> with the <code>.</code> operator is for. We can mentally reframe this as \"<code>length</code> applied after <code>takeWhile id</code> applied after <code>zipWith (==) x</code>, and the whole of that chain applied to <code>y</code>\". Written in code as:</p>\n\n<pre><code>agreeLen x y = (length . takeWhile id . zipWith (==) x) y\n</code></pre>\n\n<p><strong>Now</strong> we've got <code>&lt;something&gt;</code> applied to <code>y</code>! So we can eta-reduce:</p>\n\n<pre><code>agreeLen x = length . takeWhile id . zipWith (==) x\n</code></pre>\n\n<p>Note that <code>x</code>, although now textually last, does <em>not</em> fit the same pattern as <code>y</code> did above. We don't have parentheses around the whole \"function-pipeline\" before it's applied to <code>x</code>, rather <code>x</code> is <strong>part of</strong> the last stage in the pipeline. We <em>can</em> shuffle things around to eventually get:</p>\n\n<pre><code>agreeLen x = (((length . takeWhile id) .) . zipWith (==)) x\n</code></pre>\n\n<p>and then eta reduce to eliminate <code>x</code>, as shown in other answers. But the steps are more complicated; I don't even know what they are, I just copied that expression from @chepner's answer (who copied it from <a href=\"http://pointfree.io\" rel=\"nofollow noreferrer\">http://pointfree.io</a>). This shows a key difference between the role of <code>x</code> and <code>y</code> in the original <code>agreeLen</code>, even though they both appeared at the end of source code in the right order.</p>\n\n<p>Which just re-emphasises my point: to understand why you can sometimes eta reduce and sometimes not you need to not think of eta reduction as a simple textual rule; you <em>do</em> actually have to read and understand the structure of the expressions you're trying to rewrite.</p>\n\n<hr>\n\n<p><sup>1</sup> Actually in pure lambda calculus you can apply this almost as a blind textual rule; Haskell adds more complicated syntax like infix operators with implicit parentheses via precedence/associative, constructs like case, if/then/else, etc.</p>\n\n<p><sup>2</sup> Infix operator syntax doesn't exist in pure lambda calculus, let alone operator sections. So there's no fancy Greek-letter name for this one, but that's only because the theoreticians who named these rules originally weren't studying Haskell.</p>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 884, "favorite_count": 1, "accepted_answer_id": 40918034, "answer_count": 5, "score": 4, "last_activity_date": 1480646170, "creation_date": 1480616589, "last_edit_date": 1495540400, "question_id": 40917772, "link": "https://stackoverflow.com/questions/40917772/what-are-the-prerequisites-for-a-point-free-function-in-haskell", "title": "What are the prerequisites for a point-free function in Haskell", "body": "<p>I always thought that the prerequisites for a pointfree function were to get the function arguments to the end of the definition. E.g.</p>\n\n<pre><code>-- This can be made pointfree quite easily:    \nlet lengths x = map length x    \nlet lengths' = map length\n\n-- However this cannot:\nlet lengthz x = length `map` x\n-- let lengthz' = length `map` (parse error)\n</code></pre>\n\n<p>I originally came across this reading <a href=\"https://stackoverflow.com/questions/13426417/how-do-i-re-write-a-haskell-function-of-two-argument-to-point-free-style\">this question</a>. There we have this example:</p>\n\n<pre><code>agreeLen :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Int\nagreeLen x y = length $ takeWhile id $ zipWith (==) x y\n-- This may look like it can easily be made pointfree, however it cannot\n-- agreeLen' :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Int\n-- agreeLen' = length $ takeWhile id $ zipWith (==) (zipWith is applied to too few arguments)\n</code></pre>\n\n<p>So why can my first example be made pointfree, but the other two cannot?</p>\n"}, {"tags": ["list", "haskell", "fibonacci"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1480610318, "post_id": 40915355, "comment_id": 69043881, "body": "Note that your function is quite inefficient, and building a list of functions out of it will produce a list of inefficient functions. (I do wonder why you want such a list... I fear this might be an XY problem...)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7237149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3b4989dda982bf81666037d7edac87?s=128&d=identicon&r=PG&f=1", "display_name": "bobjohnson", "link": "https://stackoverflow.com/users/7237149/bobjohnson"}, "edited": false, "score": 0, "creation_date": 1480608970, "post_id": 40915419, "comment_id": 69043031, "body": "thanks very much. Is there any way of doing this without the use of list comprehensions and map? and filter for the matter"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 11, "user_id": 7237149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3b4989dda982bf81666037d7edac87?s=128&d=identicon&r=PG&f=1", "display_name": "bobjohnson", "link": "https://stackoverflow.com/users/7237149/bobjohnson"}, "edited": false, "score": 0, "creation_date": 1480609224, "post_id": 40915419, "comment_id": 69043204, "body": "@bobjohnson Sure, many ways. For example you could just define your own <code>map</code> function and use that. You could even remove the function parameter and use <code>g</code> directly. And you could also get rid of <code>[0 ..]</code> by replacing the list argument with a counter that you increase instead of taking the tail of the list. It&#39;s really up to you, though the two versions I gave are definitely the simplest."}, {"owner": {"reputation": 11, "user_id": 7237149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3b4989dda982bf81666037d7edac87?s=128&d=identicon&r=PG&f=1", "display_name": "bobjohnson", "link": "https://stackoverflow.com/users/7237149/bobjohnson"}, "edited": false, "score": 0, "creation_date": 1480609668, "post_id": 40915419, "comment_id": 69043484, "body": "thats great thanks. how do I apply only one argument to my function g though?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 11, "user_id": 7237149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3b4989dda982bf81666037d7edac87?s=128&d=identicon&r=PG&f=1", "display_name": "bobjohnson", "link": "https://stackoverflow.com/users/7237149/bobjohnson"}, "edited": false, "score": 3, "creation_date": 1480610033, "post_id": 40915419, "comment_id": 69043716, "body": "@bobjohnson By not applying a second one. Like in the example with the list comprehension I apply one argument to <code>g</code> by writing <code>g i</code>. Had I written <code>g i 0</code>, that would have applied two arguments, but since I didn&#39;t add a second argument, there was only one."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 4, "last_activity_date": 1480608901, "creation_date": 1480608901, "answer_id": 40915419, "question_id": 40915355, "link": "https://stackoverflow.com/questions/40915355/how-to-implement-an-infinite-list-of-functions-in-haskell/40915419#40915419", "title": "How to implement an infinite list of functions in Haskell", "body": "<p>You can get a list of all numbers starting at 0 using <code>[0 ..]</code>. Once you have that, it's just a matter of applying <code>g</code> to each of them.</p>\n\n<p>You can do this using a list comprehension like you did in your example usage:</p>\n\n<pre><code>gs = [g i | i &lt;- [0 ..]]\n</code></pre>\n\n<p>Or using map:</p>\n\n<pre><code>gs = map g [0 ..]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7237149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3b4989dda982bf81666037d7edac87?s=128&d=identicon&r=PG&f=1", "display_name": "bobjohnson", "link": "https://stackoverflow.com/users/7237149/bobjohnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 958, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1480613284, "creation_date": 1480608673, "last_edit_date": 1480613284, "question_id": 40915355, "link": "https://stackoverflow.com/questions/40915355/how-to-implement-an-infinite-list-of-functions-in-haskell", "title": "How to implement an infinite list of functions in Haskell", "body": "<p>I am using a version of the Fibonacci function g where:</p>\n\n<pre><code>g :: Integer -&gt; Integer -&gt; Integer\ng i n  |  i==0   = 0\n       |  i==1   = n\n       |  i&gt;1    = (n*( (g (i-1) n) + (g (i-2) n) ))\n</code></pre>\n\n<p>...such that g i n is the value of gi(n) and the partial definition g i is gi</p>\n\n<p>I now want to define an infinite list of functions: <code>gs :: [ Integer -&gt; Integer ]</code>, such that <code>(gs !! i) is gi</code>.</p>\n\n<p>I want take 5 $ <code>[ g 3 | g &lt;- gs]</code> to give me <code>[0,3,9,36,135]</code>.</p>\n\n<p>Can anyone help me define this infinite list?</p>\n"}, {"tags": ["haskell", "windows-installer", "installation"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1480607524, "post_id": 40914950, "comment_id": 69042120, "body": "I don&#39;t know what an MSI is (like many Haskellers, I&#39;m all on Linux), but apparently the <a href=\"https://www.stackage.org/stack/windows-x86_64-installer\" rel=\"nofollow noreferrer\">Stack installer for Windows</a> works easy enough."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1480609816, "post_id": 40914950, "comment_id": 69043575, "body": "I took the liberty of editing your question rather radically so that its closure becomes less likely. (Questions whose main purpose is asking outright for recommendations of libraries, installers and other tools are off-topic in Stack Overflow.)"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1480633676, "post_id": 40914950, "comment_id": 69056269, "body": "I&#39;m voting to close this as off-topic because it is a question about system administration."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1480710810, "post_id": 40914950, "comment_id": 69092306, "body": "@immibis While the task described is one of system administration, its goal is <a href=\"http://meta.stackoverflow.com/q/269596/2751851\">installing a programming environment</a>. That the question is primarily about such an environment is, I believe, enough to tilt the balance towards on-topic, at least from this perspective."}, {"owner": {"reputation": 961, "user_id": 4151129, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/t4snY.png?s=128&g=1", "display_name": "Ben I.", "link": "https://stackoverflow.com/users/4151129/ben-i"}, "edited": false, "score": 0, "creation_date": 1496431246, "post_id": 40914950, "comment_id": 75675945, "body": "If you teach CS, you may be interested in the new <a href=\"http://cseducators.stackexchange.com\">CS Educator&#39;s Stack Exchange</a> (though since it&#39;s still in private beta, it&#39;s easiest to enter <a href=\"https://area51.stackexchange.com/proposals/92460/computer-science-educators\">through here</a>)"}], "owner": {"reputation": 786, "user_id": 2315723, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/MC3f4.jpg?s=128&g=1", "display_name": "branty1970", "link": "https://stackoverflow.com/users/2315723/branty1970"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1480609694, "creation_date": 1480607325, "last_edit_date": 1480609694, "question_id": 40914950, "link": "https://stackoverflow.com/questions/40914950/installing-haskell-on-a-windows-network", "title": "Installing Haskell on a Windows network", "body": "<p>I'm a teacher of Computing and we need to install Haskell on lots of Windows machines on our network. What would be a reasonable way of doing that? In particular, an MSI would be a satisfactory method, and so it would be useful to know whether anything of the sort already exists before we go through the process of making an MSI ourselves.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "error-handling", "monads"], "answers": [{"comments": [{"owner": {"reputation": 401, "user_id": 1985931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cda15456fc1622e0855b351c6f2854de?s=128&d=identicon&r=PG", "display_name": "iluvAS", "link": "https://stackoverflow.com/users/1985931/iluvas"}, "edited": false, "score": 0, "creation_date": 1480598530, "post_id": 40911380, "comment_id": 69035617, "body": "Thanks this works great! Is there also something similar to <code>fmap</code> that I can use for either?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 401, "user_id": 1985931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cda15456fc1622e0855b351c6f2854de?s=128&d=identicon&r=PG", "display_name": "iluvAS", "link": "https://stackoverflow.com/users/1985931/iluvas"}, "edited": false, "score": 2, "creation_date": 1480600642, "post_id": 40911380, "comment_id": 69037080, "body": "@iluvAS <code>fmap</code> works on <code>Either a b</code>, affecting only the right <code>b</code> values. (There should be a more general <code>dimap</code> somewhere in the libraries but it&#39;s not widely used)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1480603150, "post_id": 40911380, "comment_id": 69038910, "body": "The <code>Either</code> instance for <code>Data.Bifunctor</code> provides <code>bimap f g (Left x) = Left (f x)</code> and <code>bimap f g (Right y) = Right (g y)</code>. <code>dimap</code> is from <code>Data.Profunctor</code> (which I do not understand well enough to comment on further)."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1480604227, "post_id": 40911380, "comment_id": 69039724, "body": "@chepner there&#39;s nothing too scary about the <code>Profunctor</code> class itself \u2013 it&#39;s just like a bifunctor but <i>contravariant</i> in the first argument, i.e. <code>a -&gt; b</code> maps <code>p b c</code> to <code>p a b</code> instead of the other way around as you&#39;d have with <code>(,)</code> or <code>Either</code> (these are covariant in both arguments, which is expressed by <code>Bifunctor</code>). The simplest profunctor is <code>-&gt;</code>, with <code>dimap h g f = g . f . h</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1480604533, "post_id": 40911380, "comment_id": 69039960, "body": "Yeah, I just haven&#39;t internalized contravariant functors to the point where I can look at a problem and say &quot;Aha!  A contravariant functor would be useful here!&quot;, which means I have even <i>less</i> intuition for when a profunctor would be useful. (I gather they are used under the hood for lenses, though?)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1480604601, "post_id": 40911380, "comment_id": 69040026, "body": "Yes, but I don&#39;t quite understand how they are needed for lenses (specifically, <code>Iso</code>s) either."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1480606580, "post_id": 40911380, "comment_id": 69041416, "body": "@chepner, whenever you have <code>F a b</code> such that <code>a</code> appears only in contravariant positions and <code>b</code> appears only in covariant positions, you have a profunctor. <code>Fold</code> from <a href=\"https://hackage.haskell.org/package/foldl-1.2.1/docs/Control-Foldl.html\" rel=\"nofollow noreferrer\">Control.Foldl</a> is one such example."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1480597388, "creation_date": 1480597388, "answer_id": 40911380, "question_id": 40911014, "link": "https://stackoverflow.com/questions/40911014/distinguishing-errors-in-haskell/40911380#40911380", "title": "Distinguishing errors in haskell", "body": "<p>Use <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Either.html#t:Either\" rel=\"nofollow noreferrer\"><code>Either</code></a>. It is basically the same as <code>Maybe</code> with a parameterised <code>Nothing</code> constructor, or in other words, <code>Maybe a</code> is isomorphic to <code>Either () a</code>. By replacing the <code>()</code> \u201cunit error\u201d with a custom error-tag type, you can make different failure cases different.</p>\n\n<pre><code>pulOh :: Seq -&gt; Int -&gt; Either String Seq\npulOh xs n = case tlTrn *** hdTrn $ splSq xs n of\n    (Nothing, _)    -&gt; Left \"first failed\"\n    (_, Nothing)    -&gt; Left \"last failed\"\n    (Just f,Just l) -&gt; Right $ f ++ l\n</code></pre>\n\n<p>(I took the liberty of replacing that lambda with a <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Arrow.html#v:-42--42--42-\" rel=\"nofollow noreferrer\"><code>***</code></a> \u201cparallel pipeline\u201d)</p>\n"}], "owner": {"reputation": 401, "user_id": 1985931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cda15456fc1622e0855b351c6f2854de?s=128&d=identicon&r=PG", "display_name": "iluvAS", "link": "https://stackoverflow.com/users/1985931/iluvas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 40911380, "answer_count": 1, "score": 1, "last_activity_date": 1480597388, "creation_date": 1480596220, "question_id": 40911014, "link": "https://stackoverflow.com/questions/40911014/distinguishing-errors-in-haskell", "title": "Distinguishing errors in haskell", "body": "<p>I'm still new to Haskell. Whats the best way to distinguish between errors?\nCurrently I'm using the <code>maybe</code> monad but it can only 'represent one state of error'.</p>\n\n<p>The following code snippet will put my question into context.</p>\n\n<pre><code>pulOh :: Seq          -- input X O sequence\n      -&gt; Int          -- split point real index\n      -&gt; Maybe Seq\npulOh xs n          =\n  case (\\(f,l)-&gt;(tlTrn f, hdTrn l)) (splSq xs n) of         -- split and process at index\n    (Nothing, _)    -&gt; Nothing                              -- first failed\n    (_, Nothing)    -&gt; Nothing                              -- last failed\n    (Just f,Just l) -&gt; Just (f ++ l)                        -- both parts passed\n</code></pre>\n\n<p>I would like the result to be able to distinguish if the call fails for <code>fst</code> or <code>snd</code>. Short-circuiting the case of both failing to <code>fst</code> fail.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1480589102, "post_id": 40908292, "comment_id": 69029501, "body": "<code>(op x) =&gt; \\a -&gt; a op x</code>; <code>(x op) =&gt; \\a -&gt; x op a</code>; <code>(op) x y =&gt; \\x y -&gt; x op y</code>"}, {"owner": {"reputation": 111, "user_id": 1179472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yig8Y.jpg?s=128&g=1", "display_name": "Le Dong Thuc", "link": "https://stackoverflow.com/users/1179472/le-dong-thuc"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1480589216, "post_id": 40908292, "comment_id": 69029573, "body": "@freestyle maybe, I think so, but you have any document talk about function (++) implement like that?"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 1, "creation_date": 1480589318, "post_id": 40908292, "comment_id": 69029644, "body": "<a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-280003.4\" rel=\"nofollow noreferrer\">haskell.org/onlinereport/haskell2010/&hellip;</a>"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1480635632, "post_id": 40908292, "comment_id": 69056866, "body": "The function is called <code>(++)</code>. <code>(++ &quot;abc&quot;)</code> is <i>not</i> a normal function call - see how it doesn&#39;t even contain the name of the function! <code>((++) &quot;abc&quot;)</code> would do what you expect."}], "answers": [{"comments": [{"owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "edited": false, "score": 1, "creation_date": 1480589271, "post_id": 40908552, "comment_id": 69029612, "body": "+1, beat me to finding the &quot;section&quot; concept. I think it would be nice to add a little about the <code>subtract</code> function that the OP mentions; how the same logic doesn&#39;t apply because <code>subtract</code> is a function and not an operator. (Showing the difference between <code>(-) 10 5</code> and <code>(subtract) 10 5</code>)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1480592735, "post_id": 40908552, "comment_id": 69031865, "body": "The last one looks wrong <code>(- 2) 1</code> is a type error, since that&#39;s unary minus. Also, <code>subtract 2 1</code> yields -1. Indeed, <code>(-e)</code> is a special-case since it is not a section, precisely because unary minus exists which conflicts :-( <code>subtract</code> exists to be able to express these missing sections."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1480592927, "post_id": 40908552, "comment_id": 69031992, "body": "@chi Ack. I keep getting bitten by this. I don&#39;t even use unary minus in my code, I&#39;m perfectly happy with <code>negate</code>."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 9, "last_activity_date": 1480592979, "last_edit_date": 1480592979, "creation_date": 1480589108, "answer_id": 40908552, "question_id": 40908292, "link": "https://stackoverflow.com/questions/40908292/dont-understand-concatenation-operator/40908552#40908552", "title": "Don&#39;t understand concatenation operator (++)", "body": "<p>Since <code>++</code> is an operator, Haskell expects it to be in an infix position. Adding parens on either side will tell Haskell to treat it as a prefix function. That's why</p>\n\n<pre><code>(++) \"abc\" \"xyz\"      -- \"abc\" ++ \"xyz\"\n</code></pre>\n\n<p>works the way it does. However, having a paren on just one side of an operator, like <code>(++ \"abc\")</code> or <code>(\"abc\" ++)</code> is something special called a <a href=\"https://wiki.haskell.org/Section_of_an_infix_operator\" rel=\"nofollow noreferrer\">section</a> - it essentially produces a function that would \"fill in\" the missing argument</p>\n\n<pre><code>(++ \"abc\")        -- equivalent to `\\x -&gt; x ++ \"abc\"`\n(\"abc\" ++)        -- equivalent to `\\x -&gt; \"abc\" ++ x`\n</code></pre>\n\n<p>Then, <code>(++ \"abc\") (\"xyz\")</code> is equivalent to <code>(\\x -&gt; x ++ \"abc\") (\"xyz\")</code> is equivalent to <code>\"xyz\" ++ \"abc\"</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1480598634, "post_id": 40908857, "comment_id": 69035683, "body": "It&#39;s important to note that operator sections are one step beyond currying. <code>(++ &quot;abc&quot;)</code> and <code>(&quot;abc&quot; ++)</code> are both legal, as is <code>((++) &quot;abc&quot;)</code>, but <code>(&quot;abc&quot; (++))</code> is not. Since binary operators are, well, binary, you can specify the single argument in either position, not just the first one as with ordinary multi-argument functions."}], "tags": [], "owner": {"reputation": 889, "user_id": 2452617, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/6AAFY.jpg?s=128&g=1", "display_name": "dyno8426", "link": "https://stackoverflow.com/users/2452617/dyno8426"}, "is_accepted": false, "score": 0, "last_activity_date": 1480589908, "creation_date": 1480589908, "answer_id": 40908857, "question_id": 40908292, "link": "https://stackoverflow.com/questions/40908292/dont-understand-concatenation-operator/40908857#40908857", "title": "Don&#39;t understand concatenation operator (++)", "body": "<p>Let's start with the second one. This is a case of <strong>prefix notation</strong>. Here, and if you are aware of the <a href=\"https://en.wikipedia.org/wiki/Polish_notation\" rel=\"nofollow noreferrer\">prefix notation</a> of using operators, you would see the result \"abcxyz\" to be more intuitive. Basically, in this representation of operational expressions, the operator comes first, followed by the sequence of operands, which in this case is two. So, it treats \"abc\" as the first operand and \"xyz\" as the second operand and does the concatenation in the standard expected manner, i.e. the second/right operand is added to the right of the first/left operand.</p>\n\n<p>Whereas, the first one is a case of <strong>currying</strong>. Basically, concatenation (++), being a multi-argument function can be equally expressed as a series of one argument functions, where by supplying one argument at a time, we are transforming our original function requiring <code>n</code> arguments (better read \"expression\" as denoted in Haskell) into another function which takes <code>n-1</code> arguments. So, here the original 2-argument function (++) gets converted to a 1-argument function (++ \"abc\"). Now, it can be read as a function which appends \"abc\" to any string provided as an input, which is confirmed by our output as well.</p>\n"}], "owner": {"reputation": 111, "user_id": 1179472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yig8Y.jpg?s=128&g=1", "display_name": "Le Dong Thuc", "link": "https://stackoverflow.com/users/1179472/le-dong-thuc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 40908552, "answer_count": 2, "score": 3, "last_activity_date": 1480592979, "creation_date": 1480588333, "last_edit_date": 1480589054, "question_id": 40908292, "link": "https://stackoverflow.com/questions/40908292/dont-understand-concatenation-operator", "title": "Don&#39;t understand concatenation operator (++)", "body": "<p>I have a question about list concatenation. The function plus plus (++) work is different with parentheses</p>\n\n<pre><code>(++ \"abc\") (\"xyz\") &gt;&gt;&gt; it's xyzabc\n(++) \"abc\" \"xyz\"   &gt;&gt;&gt; it's abcxyz\n</code></pre>\n\n<hr>\n\n<p>I think it's because:</p>\n\n<pre><code>(++ \"abc\") (\"xyz\") &gt;&gt;&gt; \"xyz\" ++ \"abc\"\n(++) \"abc\" \"xyz\"   &gt;&gt;&gt; \"abc\" ++ \"xyz\"\n</code></pre>\n\n<p>But why, and have any document talk about that?</p>\n\n<p>I continue to test with \"subtract\" function. The result as my expect:</p>\n\n<pre><code>(subtract 10) (5) &gt;&gt;&gt; -5\n(subtract) 10 5   &gt;&gt;&gt; -5\n</code></pre>\n"}, {"tags": ["haskell", "arrows"], "answers": [{"comments": [{"owner": {"reputation": 4091, "user_id": 9191, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a06d0fc5d5b9a1d254e566c1d0e449a8?s=128&d=identicon&r=PG", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9191/fredrik"}, "edited": false, "score": 0, "creation_date": 1480585175, "post_id": 40906900, "comment_id": 69026620, "body": "Deceptively simple! ^^ This works great, i was thinking too much in old tracks to really take a step back and try to do a normal case matching recursion. Thanks."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 5, "last_activity_date": 1480587147, "last_edit_date": 1480587147, "creation_date": 1480584672, "answer_id": 40906900, "question_id": 40906464, "link": "https://stackoverflow.com/questions/40906464/equivalent-of-a-traverse-in-arrow-notation/40906900#40906900", "title": "Equivalent of a traverse in arrow notation", "body": "<p>You need something stronger than just <code>Arrow</code> - you'll need <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Arrow.html#t:ArrowChoice\" rel=\"nofollow noreferrer\"><code>ArrowChoice</code></a>. Thankfully, <code>Query</code> is an instance of that too. You can make something work with </p>\n\n<pre><code>setManyCustomerAttributes :: Query ([TagData], UserDetails) ()\nsetManyCustomerAttributes = proc (pairs,customer) -&gt;\n        case pairs of\n          [] -&gt; returnA -&lt; ()\n          (p:ps) -&gt; do\n             setCustomerAttributes -&lt; (p,customer)\n             setManyCustomerAttributes -&lt; (ps,customer)\n</code></pre>\n\n<p>I'm still thinking about if there is some interesting abstraction analogous to <code>traverse</code> worth generalizing here.</p>\n\n<h3>EDIT</h3>\n\n<p>If there is an <code>Arrow</code> equivalent, <a href=\"http://hackage.haskell.org/package/profunctors-5.2/docs/Data-Profunctor-Traversing.html#t:Traversing\" rel=\"nofollow noreferrer\"><code>Traversing</code></a> may be a generalizing abstraction.</p>\n"}], "owner": {"reputation": 4091, "user_id": 9191, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a06d0fc5d5b9a1d254e566c1d0e449a8?s=128&d=identicon&r=PG", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/9191/fredrik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "accepted_answer_id": 40906900, "answer_count": 1, "score": 3, "last_activity_date": 1480587147, "creation_date": 1480583240, "question_id": 40906464, "link": "https://stackoverflow.com/questions/40906464/equivalent-of-a-traverse-in-arrow-notation", "title": "Equivalent of a traverse in arrow notation", "body": "<p>I'm using the <a href=\"http://hackage.haskell.org/package/hasql\" rel=\"nofollow noreferrer\">hasql</a> library to interact with a PostgreSQL database and it uses Arrows for queries and query composition.</p>\n\n<p>I have a simple query with this type:</p>\n\n<pre><code>setCustomerAttributes :: Query (TagData, UserDetails) ()\n</code></pre>\n\n<p>where <code>Query</code> is the arrow <code>(TagData, UserDetails)</code> is the input and it returns <code>()</code>.</p>\n\n<p>Now I want to write a query that takes several <code>TagData</code> as input and just runs this query for all of them.\nEssentially I'd want to do something like this</p>\n\n<pre><code>setManyCustomerAttributes :: Query ([TagPair], Customer) ()\nsetManyCustomerAttributes = proc (pairs, customer) -&gt; do\n  returnA -&lt; traverse_ (\\pair -&gt; setCustomerAttribute -&lt; (pair, customer)) pairs\n</code></pre>\n\n<p>However this of course produces the error <code>Arrow command found where expression was expected</code>, as you can't just mix and match arrow notation and regular expressions like that.</p>\n\n<p>What is the arrow equivalent of doing a traverse like that?</p>\n"}]