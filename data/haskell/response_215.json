[{"tags": ["haskell", "syntax-error", "io-monad", "do-notation"], "answers": [{"comments": [{"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1550699019, "post_id": 54795646, "comment_id": 96369446, "body": "It occurred to me that indentation might be the issue, and then I saw your answer. Unfortunately in the book I am using to learn Haskell, the necessity of this particular type of indentation is not mentioned, so it&#39;s good to know. :)"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 13, "last_activity_date": 1550698798, "creation_date": 1550698798, "answer_id": 54795646, "question_id": 54795600, "link": "https://stackoverflow.com/questions/54795600/a-mystery-involving-putstrln/54795646#54795646", "title": "A mystery involving putStrLn", "body": "<p>Both snippets have the same problem. If you put the first action of a <code>do</code> block on the same line as the <code>do</code> itself, you still have to indent the rest of the actions in the <code>do</code> block as far as the first one. Two choices to fix it:</p>\n\n<pre><code>main = do line &lt;- fmap reverse getLine\n          putStrLn $ \"You said \" ++ line ++ \" backwards!\"\n          putStrLn $ \"Yes, you said \" ++ line ++ \" backwards!\"\n</code></pre>\n\n<p>or</p>\n\n<pre><code>main = do\n   line &lt;- fmap reverse getLine\n   putStrLn $ \"You said \" ++ line ++ \" backwards!\"\n   putStrLn $ \"Yes, you said \" ++ line ++ \" backwards!\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 3, "last_activity_date": 1550706913, "creation_date": 1550706913, "answer_id": 54797104, "question_id": 54795600, "link": "https://stackoverflow.com/questions/54795600/a-mystery-involving-putstrln/54797104#54797104", "title": "A mystery involving putStrLn", "body": "<p>It also works when explicit separators are used throughout:</p>\n\n<pre><code>main = do { line &lt;- fmap reverse getLine ;\n   putStrLn $ \"You said \" ++ line ++ \" backwards!\" ;\n   putStrLn $ \"Yes, you said \" ++ line ++ \" backwards!\" }\n\nmain = do { line &lt;- getLine ;\n   let { line' = reverse line } ;                     -- NB let's { }s\n   putStrLn $ \"You said \" ++ line' ++ \" backwards!\" ;\n   putStrLn $ \"Yes, you said \" ++ line' ++ \" backwards!\" }\n</code></pre>\n\n<p>This is not a substitute for the good indentation style, but an addition to it.</p>\n"}], "owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "accepted_answer_id": 54795646, "answer_count": 2, "score": 1, "last_activity_date": 1550706913, "creation_date": 1550698579, "last_edit_date": 1550706508, "question_id": 54795600, "link": "https://stackoverflow.com/questions/54795600/a-mystery-involving-putstrln", "title": "A mystery involving putStrLn", "body": "<p>Why does the piece of code below produce the error <code>parse error on input \u2018putStrLn\u2019</code>?</p>\n\n<pre><code>main = do line &lt;- fmap reverse getLine\n   putStrLn $ \"You said \" ++ line ++ \" backwards!\"\n   putStrLn $ \"Yes, you said \" ++ line ++ \" backwards!\"\n\n&lt;interactive&gt;:11:4: error: parse error on input \u2018putStrLn\u2019\n</code></pre>\n\n<p>Also, why does the following piece of code produce the error <code>parse error on input \u2018let\u2019</code>?</p>\n\n<pre><code>main = do line &lt;- getLine\n  let line' = reverse line\n  putStrLn $ \"You said \" ++ line' ++ \" backwards!\"\n  putStrLn $ \"Yes, you said \" ++ line' ++ \" backwards!\"\n\n\n &lt;interactive&gt;:31:4: error: parse error on input \u2018let\u2019\n</code></pre>\n"}, {"tags": ["list", "haskell", "int"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 4, "creation_date": 1550684200, "post_id": 54792131, "comment_id": 96362561, "body": "Start as you always do in Haskell: with a type signature. After that, try writing the dumbest possible function with that type signature, leaving blanks for yourself in places where you don&#39;t know what to do."}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1550735262, "post_id": 54792454, "comment_id": 96380210, "body": "@MichaelLitchard I think it&#39;s a bad question, but you can&#39;t really guess whether someone is a &quot;help vampire&quot; after a single question. This is why I chose to write my own answer in a way that is correct, and hopefully interesting to other spectators who might see the question, but obviously useless as a copy/paste homework solution."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1550769306, "post_id": 54792454, "comment_id": 96402133, "body": "@amalloy I think I didn&#39;t word my comment very well. I&#39;m more concerned with, and was referring to, the site as a whole. Imagine what we would become if we indulged every lazy question that clearly is looking for someone else to do the work?"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 1, "last_activity_date": 1550684986, "creation_date": 1550684986, "answer_id": 54792454, "question_id": 54792131, "link": "https://stackoverflow.com/questions/54792131/create-list-of-lists-from-a-list-while-changing-one-and-always-different-value-h/54792454#54792454", "title": "Create list of lists from a list while changing one and always different value Haskell", "body": "<p>First thing you always need is to figure out the type signature of your function. In your case you want</p>\n\n<pre><code>lister :: [Int] -&gt; [[Int]]\n</code></pre>\n\n<p>Then, as you want to loop through the list but keeping track of the indexes you have changed, an easy way would be to list a list of your list (hard to follow, just look at the code) and then zip it with its index. Then for each list you switch the element in that position. This is you code</p>\n\n<pre><code>lister :: [Int] -&gt; [[Int]]\nlister ls = [switch i l | (i,l) &lt;- zip [0..9] (repeat ls)]\n</code></pre>\n\n<p>You then need a switch function, to switch the element in the ith position accordingly to your rule:</p>\n\n<pre><code>switch :: Int -&gt; [Int] -&gt; [Int]\nswitch 0 ls = ls\nswitch n ls = [if i == n &amp;&amp; x == -1 then 0 else x | (i,x) &lt;- zip [1..] ls]\n</code></pre>\n\n<p>Note that this returns 9 lists, one for each element in your original list. Therefore it contains some duplicates. You can eliminate them using <code>nub</code> from <code>Data.List</code>, watch out because it is <code>O(n^2)</code></p>\n\n<p>This is your complete code:</p>\n\n<pre><code>import Data.List\n\nlister :: [Int] -&gt; [[Int]]\nlister ls = nub [switch i l | (i,l) &lt;- zip [0..9] (repeat ls)]\n\nswitch :: Int -&gt; [Int] -&gt; [Int]\nswitch 0 ls = ls\nswitch n ls = [if i == n &amp;&amp; x == -1 then 0 else x | (i,x) &lt;- zip [1..] ls]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1550706469, "post_id": 54796106, "comment_id": 96371898, "body": "I believe you do not need the <code>nub</code> if you already checked they&#39;re different from the original one"}, {"owner": {"reputation": 774, "user_id": 6034245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3qwA.jpg?s=128&g=1", "display_name": "chrisheyn", "link": "https://stackoverflow.com/users/6034245/chrisheyn"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1550730718, "post_id": 54796106, "comment_id": 96378154, "body": "@Lorenzo. Thank you. You are right! I will change that"}], "tags": [], "owner": {"reputation": 774, "user_id": 6034245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3qwA.jpg?s=128&g=1", "display_name": "chrisheyn", "link": "https://stackoverflow.com/users/6034245/chrisheyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1550730761, "last_edit_date": 1550730761, "creation_date": 1550701107, "answer_id": 54796106, "question_id": 54792131, "link": "https://stackoverflow.com/questions/54792131/create-list-of-lists-from-a-list-while-changing-one-and-always-different-value-h/54796106#54796106", "title": "Create list of lists from a list while changing one and always different value Haskell", "body": "<p>Another try:</p>\n\n<pre><code>zeros :: [Int] -&gt; [Int] -&gt; [[Int]]\nzeros _ []     = []\nzeros h (x:xs) = [h ++ newX:xs] ++ zeros nextH xs\n    where newX = if x == (-1) then 0 else x\n        nextH = h ++ [x]\n\nswitch xs = ((filter (/= xs)) . (zeros [])) xs\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>main = print $ switch [-1, 0, 0, 1, -1, -1, 1, 1, 0]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 1, "last_activity_date": 1550782012, "last_edit_date": 1550782012, "creation_date": 1550707237, "answer_id": 54797154, "question_id": 54792131, "link": "https://stackoverflow.com/questions/54792131/create-list-of-lists-from-a-list-while-changing-one-and-always-different-value-h/54797154#54797154", "title": "Create list of lists from a list while changing one and always different value Haskell", "body": "<p>Clearly this is a very specific problem. It is often useful to look at the bigger picture: what more general problem is this a special case of? Clearly, here, we are looking through a list, and may see an element that we wish to replace, in zero or more ways. Further, we wish to see how many ways it is possible to make a limited number of such replacements. So, let us implement the general case before thinking about how to specialize to our original problem:</p>\n\n<pre><code>import Control.Applicative (Alternative, empty, (&lt;|&gt;))\n\nreplaceNTimes :: Alternative f =&gt; (a -&gt; f a) -&gt; Int -&gt; [a] -&gt; f [a]\nreplaceNTimes _ 0 xs = pure xs\nreplaceNTimes _ _ [] = empty\nreplaceNTimes f n (x:xs) = replaceHere &lt;|&gt; keepLooking\n  where replaceHere = (:) &lt;$&gt; f x &lt;*&gt; replaceNTimes f (n - 1) xs\n        keepLooking = (x:) &lt;$&gt; replaceNTimes f n xs\n</code></pre>\n\n<p>If we have a \"budget\" of zero replacements remaining, we simply return the remainder of the list. If we have budget remaining but the list is empty, we abort, because we failed to make the expected number of replacements. Otherwise, we consult our replacement-suggester function to see which replacements are legal at the current position, and choose to either make one of them and recurse with a smaller N, or to make none and recurse with the same N.</p>\n\n<p>With this tool at our disposal, the original problem is easy: we just specialize N to 1 (make exactly one replacement), and supply a replacing function that only suggests replacing -1 with 0:</p>\n\n<pre><code>replaceSingleNegativeOneWithZero :: [Int] -&gt; [[Int]]\nreplaceSingleNegativeOneWithZero = replaceNTimes go 1\n  where go (-1) = [0]\n        go _ = []\n</code></pre>\n\n<p>And test to ensure that we get the expected output:</p>\n\n<pre><code>*Main&gt; replaceSingleNegativeOneWithZero [-1,0,0,1,-1,-1,1,1,0]\n[ [0,0,0,1,-1,-1,1,1,0]\n, [-1,0,0,1,0,-1,1,1,0]\n, [-1,0,0,1,-1,0,1,1,0]]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11091485, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YdB7krwEFWQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQN1belW9CQYlO-Ga9SelwW1Bo6ibA/mo/photo.jpg?sz=128", "display_name": "PFNK", "link": "https://stackoverflow.com/users/11091485/pfnk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 54792454, "answer_count": 3, "score": -3, "last_activity_date": 1550782012, "creation_date": 1550683623, "last_edit_date": 1550685387, "question_id": 54792131, "link": "https://stackoverflow.com/questions/54792131/create-list-of-lists-from-a-list-while-changing-one-and-always-different-value-h", "title": "Create list of lists from a list while changing one and always different value Haskell", "body": "<p>I have a list of 9 integers with values 1, -1, 0 such as:</p>\n\n<pre><code>[-1, 0, 0, 1, -1, -1, 1, 1, 0] \n</code></pre>\n\n<p>What I am trying to do is that from this one list create list of lists where each one of them contain only one change and all the time different. For each -1 I want to change it into 0. </p>\n\n<p><strong>Example:</strong></p>\n\n<p>From the list: </p>\n\n<pre><code>[-1,0,0,1,-1,-1,1,1,0], \n</code></pre>\n\n<p>I want to get the result:</p>\n\n<pre><code>[ [ 0, 0, 0, 1, -1, -1, 1, 1, 0]\n, [-1, 0, 0, 1,  0, -1, 1, 1, 0]\n, [-1, 0, 0, 1, -1,  0, 1, 1, 0]\n]\n</code></pre>\n\n<p>So each list has only one value changed and each has a different one. I have no idea how to even start. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1550675653, "post_id": 54789462, "comment_id": 96357412, "body": "Hint: keep the old <code>doubleEveryOther</code>, and write a new function with a new name that combines <code>reverseList</code> and <code>doubleEveryOther</code>."}], "answers": [{"comments": [{"owner": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 0, "creation_date": 1550676136, "post_id": 54789560, "comment_id": 96357765, "body": "Exactly what I was looking for, thanks very much! I&#39;m sure there are more efficient ways but I just needed to get over that bump."}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": true, "score": 7, "last_activity_date": 1550676507, "last_edit_date": 1550676507, "creation_date": 1550675633, "answer_id": 54789560, "question_id": 54789462, "link": "https://stackoverflow.com/questions/54789462/intermediate-value-in-simple-haskell-function/54789560#54789560", "title": "Intermediate value in simple Haskell function", "body": "<p>This is a very simple combination of the two functions you've already created:</p>\n\n<pre><code>doubleEveryOtherFromRight = reverseList . doubleEveryOther . reverseList\n</code></pre>\n\n<p>Note that your <code>reverseList</code> is actually already defined in the standard Prelude as <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:reverse\" rel=\"nofollow noreferrer\">reverse</a>. so you didn't need to define it yourself.</p>\n\n<p>I'm aware that the above solution isn't very efficient, because both uses of <code>reverse</code> need to pass through the entire list. I'll leave it to others to suggest more efficient versions, but hopefully this illustrates the power of function composition to build more complex computations out of simpler ones.</p>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1550686950, "post_id": 54790857, "comment_id": 96363840, "body": "Better yet, use <code>zipWith ($) listOfFuncs ls</code>, where <code>listOfFuncs</code> is either <code>cycle [id, (*2)]</code> or <code>cycle [(*2), id]</code>, depending on whether the list is odd or not."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1550688995, "post_id": 54790857, "comment_id": 96364878, "body": "@chepner, that&#39;s a very neat, understandable and (as far as I can tell) efficient solution, you should post it as an answer yourself"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": false, "score": 2, "last_activity_date": 1551305382, "last_edit_date": 1551305382, "creation_date": 1550679429, "answer_id": 54790857, "question_id": 54789462, "link": "https://stackoverflow.com/questions/54789462/intermediate-value-in-simple-haskell-function/54790857#54790857", "title": "Intermediate value in simple Haskell function", "body": "<p>Whenever you have to work on consecutive terms in a list, <code>zip</code> with a list comprehension is an easy way to go. It takes two lists and returns a list of tuples, so you can either zip the list with its tail or make it indexed. What i mean is</p>\n\n<pre><code>doubleFromRight :: [Int] -&gt; [Int]\ndoubleFromRight ls = [if (odd i == oddness) then 2*x else x | (i,x) &lt;- zip [1..] ls]\n    where\n      oddness = odd . length $ ls\n</code></pre>\n\n<p>This way you count every element, starting from 1 and if the index has the same parity as the last element in the list (both odd or both even), then you double the element, else you leave it as is.</p>\n\n<p>I am not 100% sure this is more efficient, though, if anyone could point it out in the comments that would be great</p>\n"}, {"comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 1, "creation_date": 1550694506, "post_id": 54794019, "comment_id": 96367475, "body": "Any reason for using an if-then-else instead of guards?"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1550691350, "creation_date": 1550691350, "answer_id": 54794019, "question_id": 54789462, "link": "https://stackoverflow.com/questions/54789462/intermediate-value-in-simple-haskell-function/54794019#54794019", "title": "Intermediate value in simple Haskell function", "body": "<p>As Lorenzo points out, you can make one pass to determine if the list has an odd or even length, then a second pass to actually construct the new list. It might be simpler, though, to separate the two tasks.</p>\n\n<pre><code>doubleFromRight ls = zipWith ($) (cycle fs) ls -- [f0 ls0, f1 ls1, f2 ls2, ...]\n   where fs = if odd (length ls)\n              then [(*2), id]\n              else [id, (*2)]\n</code></pre>\n\n<hr>\n\n<p>So how does this work? First, we observe that to create the final result, we need to apply one of two function (<code>id</code> or <code>(*2)</code>) to each element of <code>ls</code>. <code>zipWith</code> can do that if we have a list of appropriate functions. The interesting part of its definition is basically</p>\n\n<pre><code>zipWith f (x:xs) (y:ys) = f x y : zipWith f xs ys\n</code></pre>\n\n<p>When <code>f</code> is <code>($)</code>, we're just applying a function from one list to the corresponding element in the other list.</p>\n\n<p>We want to zip <code>ls</code> with an infinite alternating list of <code>id</code> and <code>(*2)</code>. The question is, which function should that list start with? It should always <em>end</em> with <code>(*2)</code>, so the starting item is determined by the length of <code>ls</code>. An odd-length requires us to start with <code>(*2)</code>; an even one, <code>id</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 0, "creation_date": 1550739169, "post_id": 54797370, "comment_id": 96382383, "body": "Can you clarify how this algorithm decides which to start with, if it doesn&#39;t calculate the length?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 1, "creation_date": 1550739296, "post_id": 54797370, "comment_id": 96382466, "body": "it pairs up the input list with the cycled <i>infinite</i> list of functions, <code>[(*2), id, (*2), id, .... ]</code>. then it skips along them both. when the first list is finished, the second is in the appropriate state to be - again - applied, pairwise, - on the second!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 0, "creation_date": 1550739412, "post_id": 54797370, "comment_id": 96382526, "body": "thanks for staying engaged. it can be hard to say what is or isn&#39;t immediately clear in my code. :)"}, {"owner": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 0, "creation_date": 1550740490, "post_id": 54797370, "comment_id": 96383168, "body": "Thank you for the help! The Haskell community (here and on IRC) is ridiculously patient and helpful to newbies."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1550739364, "last_edit_date": 1550739364, "creation_date": 1550708927, "answer_id": 54797370, "question_id": 54789462, "link": "https://stackoverflow.com/questions/54789462/intermediate-value-in-simple-haskell-function/54797370#54797370", "title": "Intermediate value in simple Haskell function", "body": "<p>If we really want to avoid calculating the length, we can define</p>\n\n<pre><code>doubleFromRight :: Num a =&gt; [a] -&gt; [a]\ndoubleFromRight xs = zipWith ($)\n                       (foldl' (\\a _ -&gt; drop 1 a) (cycle [(2*), id]) xs)\n                       xs\n</code></pre>\n\n<p>This pairs up the input list with the cycled <em>infinite</em> list of functions, <code>[(*2), id, (*2), id, .... ]</code>. then it skips along them both. when the first list is finished, the second is in the appropriate state to be - again - applied, pairwise, - on the second! This time, for real.</p>\n\n<p>So in effect it does <em>measure</em> the length (of course), it just doesn't count in integers but in the list elements so to speak.</p>\n\n<p>If the length of the list is even, the first element will be doubled, otherwise the second, as you've specified in the question:</p>\n\n<pre><code>&gt; doubleFromRight [1..4]\n[2,2,6,4]\n\n&gt; doubleFromRight [1..5]\n[1,4,3,8,5]\n</code></pre>\n\n<p>The <code>foldl'</code> function processes the list left-to-right. Its type is</p>\n\n<pre><code>foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b\n--        reducer_func    acc   xs    result\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 0, "creation_date": 1551002913, "post_id": 54833217, "comment_id": 96473681, "body": "Thanks for this answer, Daniel . Apologies for the dim question but what exactly does <code>(3-factor, factor*x:xs&#39;)</code> do?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 0, "creation_date": 1551020224, "post_id": 54833217, "comment_id": 96477951, "body": "@JoshFriedlander <code>3-factor</code> and <code>factor*x</code> are just subtraction and multiplication, respectively; <code>:</code> is the function that prepends an element to a list; and <code>(,)</code> is the constructor for pairs (aka tuples if you prefer that name)."}, {"owner": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 0, "creation_date": 1551024424, "post_id": 54833217, "comment_id": 96479107, "body": "So does <code>3 - factor</code> move us back three steps in the list?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 0, "creation_date": 1551024452, "post_id": 54833217, "comment_id": 96479115, "body": "@JoshFriedlander Nope. It&#39;s just a trick to alternate between 1 and 2: <code>3-1 = 2</code> and <code>3-2 = 1</code>. So if the current factor is <code>1</code>, then <code>3-factor</code> is the new factor of <code>2</code>; and if the current factor is <code>2</code>, then <code>3-factor</code> is the new factor of <code>1</code>."}, {"owner": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 0, "creation_date": 1551024816, "post_id": 54833217, "comment_id": 96479214, "body": "Ah, now I see. While @Robin Zigmond&#39;s answer was what I was looking for, reading your answer slowly/asking for clarification taught me a lot of new stuff. Thanks for your time!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1550860657, "creation_date": 1550860657, "answer_id": 54833217, "question_id": 54789462, "link": "https://stackoverflow.com/questions/54789462/intermediate-value-in-simple-haskell-function/54833217#54833217", "title": "Intermediate value in simple Haskell function", "body": "<p>Most of the other solutions show you how to either use the building blocks you already have or building blocks available in the standard library to build your function. I think it's also instructive to see how you might build it from scratch, so in this answer I discuss one idea for that.</p>\n\n<p>Here's the plan: we're going to walk all the way to the end of the list, then walk back to the front. We'll build our new list during our walk back from the end. The way we'll build it as we walk back is by alternating between (multiplicative) factors of 1 and 2, multiplying our current element by our current factor and then swapping factors for the next step. At the end we'll return both the final factor and the new list. So:</p>\n\n<pre><code>doubleFromRight_ :: Num a =&gt; [a] -&gt; (a, [a])\ndoubleFromRight_ [] = (1, [])\ndoubleFromRight_ (x:xs) =\n    -- not at the end yet, keep walking\n    let (factor, xs') = doubleFromRight_ xs\n    -- on our way back to the front now\n    in (3-factor, factor*x:xs')\n</code></pre>\n\n<p>If you like, you can write  a small wrapper that throws away the factor at the end.</p>\n\n<pre><code>doubleFromRight :: Num a =&gt; [a] -&gt; [a]\ndoubleFromRight = snd . doubleFromRight_\n</code></pre>\n\n<p>In ghci:</p>\n\n<pre><code>&gt; doubleFromRight [1..5]\n[1,4,3,8,5]\n&gt; doubleFromRight [1..6]\n[2,2,6,4,10,6]\n</code></pre>\n\n<p>Modern practice would be to hide the helper function <code>doubleFromRight_</code> inside a <code>where</code> block in <code>doubleFromRight</code>; and since the slightly modified name doesn't actually tell you anything new, we'll use the community standard name internally. Those two changes might land you here:</p>\n\n<pre><code>doubleFromRight :: Num a =&gt; [a] -&gt; [a]\ndoubleFromRight = snd . go where\n    go [] = (1, [])\n    go (x:xs) = let (factor, xs') = go xs in (3-factor, factor*x:xs')\n</code></pre>\n\n<p>An advanced Haskeller might then notice that <code>go</code> fits into the shape of a fold and write this:</p>\n\n<pre><code>doubleFromRight :: Num a =&gt; [a] -&gt; [a]\ndoubleFromRight = snd . foldr (\\x (factor, xs) -&gt; (3-factor, factor*x:xs)) (1,[])\n</code></pre>\n\n<p>But I think it's perfectly fine in this case to stop one step earlier with the explicit recursion; it may even be more readable in this case!</p>\n"}], "owner": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 54789560, "answer_count": 5, "score": 1, "last_activity_date": 1551305382, "creation_date": 1550675335, "last_edit_date": 1550679619, "question_id": 54789462, "link": "https://stackoverflow.com/questions/54789462/intermediate-value-in-simple-haskell-function", "title": "Intermediate value in simple Haskell function", "body": "<p>I need a function to double every other number in a list. This does the trick:</p>\n\n<pre><code>doubleEveryOther :: [Integer] -&gt; [Integer]\ndoubleEveryOther []         = []\ndoubleEveryOther (x:[])     = [x]\ndoubleEveryOther (x:(y:zs)) = x : 2 * y : doubleEveryOther zs\n</code></pre>\n\n<p>However, the catch is that I need to double every other number starting <em>from the right</em> - so if the length of the list is even, the first one will be doubled, etc.</p>\n\n<p>I understand that in Haskell it's tricky to operate on lists backwards, so my plan was to reverse the list, apply my function, then output the reverse again. I have a <code>reverseList</code> function:</p>\n\n<pre><code>reverseList :: [Integer] -&gt; [Integer]\nreverseList  [] = []\nreverseList  xs = last xs : reverseList (init xs) \n</code></pre>\n\n<p>But I'm not quite sure how to implant it inside my original function. I got to something like this:</p>\n\n<pre><code>doubleEveryOther :: [Integer] -&gt; [Integer]\ndoubleEveryOther []         = []\ndoubleEveryOther (x:[])     = [x]\ndoubleEveryOther (x:(y:zs)) =\n | rev_list = reverseList (x:(y:zs))\n |  rev_list = [2 * x, y] ++ doubleEveryOther zs\n</code></pre>\n\n<p>I'm not exactly sure of the syntax of a function that includes intermediate values like this. </p>\n\n<p>In case it's relevant, this is for Exercise 2 in <a href=\"http://cis.upenn.edu/~cis194/spring13/hw/01-intro.pdf\" rel=\"nofollow noreferrer\">CIS 194 HW 1</a>.</p>\n"}, {"tags": ["haskell", "functional-programming", "monads", "monad-transformers", "state-monad"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1550674293, "post_id": 54788178, "comment_id": 96356527, "body": "Would <code>m (s, [b])</code> work as the result type instead?  That&#39;s much easier to get."}, {"owner": {"reputation": 15219, "user_id": 91522, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5de8b254c711059975670fba5ec10ab1?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/91522/eric"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1550674412, "post_id": 54788178, "comment_id": 96356613, "body": "I could indeed <code>fst &lt;$&gt;</code> that which I would like to avoid if possible but please share your idea"}], "answers": [{"comments": [{"owner": {"reputation": 15219, "user_id": 91522, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5de8b254c711059975670fba5ec10ab1?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/91522/eric"}, "edited": false, "score": 0, "creation_date": 1550677181, "post_id": 54789210, "comment_id": 96358405, "body": "Thanks Daniel, <code>StateT</code> is indeed enough"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1550674631, "creation_date": 1550674631, "answer_id": 54789210, "question_id": 54788178, "link": "https://stackoverflow.com/questions/54788178/is-there-an-elegant-way-to-implement-this-function-monad-m-s-a-m/54789210#54789210", "title": "Is there an elegant way to implement this function: `(Monad m) =&gt; (s -&gt; a -&gt; m (s, b)) -&gt; s -&gt; [a] -&gt; m [b]`", "body": "<p>Up to newtype nonsense, we have:</p>\n\n<pre><code>traverse @[] @(StateT s m) :: (a -&gt; s -&gt; m (a, s)) -&gt; [a] -&gt; s -&gt; m ([b], s)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1550691931, "post_id": 54789826, "comment_id": 96366272, "body": "<code>\\(a,b) -&gt; (b,a)</code> has a name, <code>Data.Tuple.swap</code>"}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 1, "last_activity_date": 1550734034, "last_edit_date": 1550734034, "creation_date": 1550676492, "answer_id": 54789826, "question_id": 54788178, "link": "https://stackoverflow.com/questions/54788178/is-there-an-elegant-way-to-implement-this-function-monad-m-s-a-m/54789826#54789826", "title": "Is there an elegant way to implement this function: `(Monad m) =&gt; (s -&gt; a -&gt; m (s, b)) -&gt; s -&gt; [a] -&gt; m [b]`", "body": "<p>Plain <code>StateT</code> suffices,</p>\n\n<pre><code>foo :: Monad m =&gt; (s -&gt; a -&gt; m (s, b)) -&gt; s -&gt; [a] -&gt; m [b]\nfoo g = flip (evalStateT . mapM (StateT . f))\n   where\n   f a s = liftM swap $ g s a\n\nswap (a,b) = (b,a)   -- or import Data.Tuple\n</code></pre>\n\n<p><code>flip</code> and <code>f</code> make the pieces fit, if you must use your exact types instead of the more natural type <code>a -&gt; s -&gt; m (b, s)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1550677566, "post_id": 54790032, "comment_id": 96358657, "body": "If you absolutely must avoid using <code>StateT</code> in the wrapper, you might like to turn on <code>ScopedTypeVariables</code> and sundry other extensions, then use <code>foldAccumulate :: forall m s a b. ...; foldAccumulate = coerce (traverse @[] @(StateT s m) @a @b)</code> to replace the (cheap, but not completely free) newtype wrapping and unwrapping with (the completely free) mere coercion. You can also relax your <code>Monad</code> constraint to <code>Applicative</code>."}], "tags": [], "owner": {"reputation": 15219, "user_id": 91522, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5de8b254c711059975670fba5ec10ab1?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/91522/eric"}, "is_accepted": false, "score": 2, "last_activity_date": 1550677140, "creation_date": 1550677140, "answer_id": 54790032, "question_id": 54788178, "link": "https://stackoverflow.com/questions/54788178/is-there-an-elegant-way-to-implement-this-function-monad-m-s-a-m/54790032#54790032", "title": "Is there an elegant way to implement this function: `(Monad m) =&gt; (s -&gt; a -&gt; m (s, b)) -&gt; s -&gt; [a] -&gt; m [b]`", "body": "<p>Based on Will Ness's answer and because I have the opportunity to rearrange arguments in my code I can get the following</p>\n\n<pre><code>foldAccumulate :: (Monad m) =&gt; (a -&gt; s -&gt; m (b, s)) -&gt; [a] -&gt; s -&gt; m [b]\nfoldAccumulate f = evalStateT . traverse (StateT . f)\n</code></pre>\n\n<p>Which is indeed a <code>traverse</code> with the appropriate <code>StateT m</code> monad, and there's no need for writing anything, I don't know why I did not see that :-). Thanks!</p>\n"}], "owner": {"reputation": 15219, "user_id": 91522, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5de8b254c711059975670fba5ec10ab1?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/91522/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 54789826, "answer_count": 3, "score": 1, "last_activity_date": 1550734034, "creation_date": 1550671356, "last_edit_date": 1550678898, "question_id": 54788178, "link": "https://stackoverflow.com/questions/54788178/is-there-an-elegant-way-to-implement-this-function-monad-m-s-a-m", "title": "Is there an elegant way to implement this function: `(Monad m) =&gt; (s -&gt; a -&gt; m (s, b)) -&gt; s -&gt; [a] -&gt; m [b]`", "body": "<p>A function like <code>(Monad m) =&gt; (s -&gt; a -&gt; m (s, b))</code> producing a new state and a new value based on the previous state and the current value is quite frequent. </p>\n\n<p>We can use different approaches for implementing a traversal of a list of <code>a</code> to produce a <code>m [b]</code> given a function <code>f :: s -&gt; a -&gt; m (s, b)</code></p>\n\n<ul>\n<li>using <code>Control.Monad.foldM</code> but the code is not particularly nice</li>\n<li>using <code>traverse</code> and a <code>StateT (WriterT m)</code> monad, which is a bit better</li>\n</ul>\n\n<p>Is there a good use of existing libraries to decompose the \"state-defined behaviour\" with the \"output behaviour\" of <code>f</code> and get the desired traversal in a few combinators?</p>\n"}, {"tags": ["haskell", "yesod", "haskell-persistent"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1550697223, "post_id": 54787344, "comment_id": 96368681, "body": "What database are you using?"}, {"owner": {"reputation": 457, "user_id": 7169108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRp7Z.jpg?s=128&g=1", "display_name": "Sumanth Kumar Mora", "link": "https://stackoverflow.com/users/7169108/sumanth-kumar-mora"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1550698716, "post_id": 54787344, "comment_id": 96369315, "body": "I am using sqlite"}, {"owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "edited": false, "score": 0, "creation_date": 1550745192, "post_id": 54787344, "comment_id": 96386208, "body": "you could try with <a href=\"https://github.com/bitemyapp/esqueleto\" rel=\"nofollow noreferrer\">github.com/bitemyapp/esqueleto</a> to perform joins on your tables"}], "answers": [{"tags": [], "owner": {"reputation": 457, "user_id": 7169108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRp7Z.jpg?s=128&g=1", "display_name": "Sumanth Kumar Mora", "link": "https://stackoverflow.com/users/7169108/sumanth-kumar-mora"}, "is_accepted": true, "score": 0, "last_activity_date": 1550846982, "creation_date": 1550846982, "answer_id": 54829643, "question_id": 54787344, "link": "https://stackoverflow.com/questions/54787344/how-to-get-referenced-model-information-in-yesod/54829643#54829643", "title": "How to get referenced model information in Yesod?", "body": "<p>I couldn't find any direct way (similar to annotations) to fetch referenced model information. But there are 2 ways we can get this done.</p>\n\n<ol>\n<li>Incase, if your database is SQL. You can use esqueleto <a href=\"https://github.com/bitemyapp/esqueleto/blob/master/README.md\" rel=\"nofollow noreferrer\">https://github.com/bitemyapp/esqueleto/blob/master/README.md</a>.</li>\n<li>Write some boilerplate code and get information.</li>\n</ol>\n\n<p>Create the <code>HouseResp</code> type, which will represent your response body including person and address information.</p>\n\n<pre><code>data HouseResp = HouseResp\n  { rent :: Int\n  , owner :: Person\n  , address :: Address\n  }\n</code></pre>\n\n<p>Then, modify <code>getHouseR</code> to fetch complete information for every house by using available reference id.</p>\n\n<pre><code>getHouseR :: Handler Value\ngetHouseR = do\n  housesWithReference &lt;- runDB $ selectList [] [Asc HouseRent]\n  houses &lt;- sequence (Import.map getCompleteHouse housesWithReference)\n  return $ toJSON houses\n\n\ngetCompleteHouse :: Entity House -&gt; Handler HouseResp\ngetCompleteHouse house = runDB $ do\n  let rent' = houseRent (entityVal house)\n  person &lt;- getJust (houseOwnerId (entityVal house))\n  address' &lt;- getJust (houseAddressId (entityVal house))\n  return (HouseResp rent' person address')\n</code></pre>\n"}], "owner": {"reputation": 457, "user_id": 7169108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRp7Z.jpg?s=128&g=1", "display_name": "Sumanth Kumar Mora", "link": "https://stackoverflow.com/users/7169108/sumanth-kumar-mora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 54829643, "answer_count": 1, "score": 1, "last_activity_date": 1550846982, "creation_date": 1550668836, "question_id": 54787344, "link": "https://stackoverflow.com/questions/54787344/how-to-get-referenced-model-information-in-yesod", "title": "How to get referenced model information in Yesod?", "body": "<p>I have 3 Models</p>\n\n<pre><code>Address json\n    number Text\n    street Text\n    pincode Text\n    deriving Show\nPerson json\n    email Text\n    name Text\n    telephone Text\n    deriving Show\nHouse json\n    rent Int\n    ownerId PersonId\n    addressId AddressId\n    deriving Show\n</code></pre>\n\n<p>I want to access all houses. Which I can get by doing </p>\n\n<pre><code>getHouseR :: Handler Value\ngetHouseR = do\n houses &lt;- runDB $ selectList [] [Asc HouseRent]\n return $ toJSON houses\n</code></pre>\n\n<p>But I get only reference to the other entities like <code>person &amp; address</code>.</p>\n\n<pre><code>[{\"rent\":8000,\"addressId\":4,\"ownerId\":1,\"id\":3},{\"rent\":10000,\"addressId\":2,\"ownerId\":1,\"id\":1}]\n</code></pre>\n\n<p>I would like to get complete information of house, That means, resolve that <code>ownerId &amp; addressId</code> and get that data sent which might look like,</p>\n\n<pre><code>[{\"rent\":8000,\"address\":{\"number\": \"23\", \"street\": \"12/B\", \"pincode\": \"111111\"},\"owner\":{\"email\": \"hey@email.com\", \"name\": \"Moto\", \"telephone\": \"xxxxxxxxxx\"},\"id\":3}]\n</code></pre>\n\n<p>Is there any way to add an information like <code>getForiegnData</code> to the query and that would fetch me all this ? Or any other solution ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 8984, "user_id": 2485966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZj6A.jpg?s=128&g=1", "display_name": "Ruud Helderman", "link": "https://stackoverflow.com/users/2485966/ruud-helderman"}, "edited": false, "score": 2, "creation_date": 1550669456, "post_id": 54786844, "comment_id": 96353396, "body": "Explanation and an example of a combinator that is not a supercombinator can be found here: <a href=\"https://wiki.haskell.org/Super_combinator\" rel=\"nofollow noreferrer\">wiki.haskell.org/Super_combinator</a>"}], "answers": [{"comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1550701957, "post_id": 54794868, "comment_id": 96370502, "body": "To be fair, that definition at the top is written in such a way that the only possible super combinator is a constant. For example, <code>\\x -&gt; x</code> cannot be a super combinator, because (1) it is not a constant, and (2) it contains a subexpression <code>x</code>, which is not a super combinator."}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1550705622, "post_id": 54794868, "comment_id": 96371674, "body": "@FyodorSoikin The definition is from the Haskell Wiki and I only took the simple bit because I thought it was obvious what it meant, but I&#39;ll update it now"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 3, "last_activity_date": 1550705747, "last_edit_date": 1550705747, "creation_date": 1550695154, "answer_id": 54794868, "question_id": 54786844, "link": "https://stackoverflow.com/questions/54786844/what-is-the-difference-between-combinator-and-supercombinator/54794868#54794868", "title": "What is the difference between combinator and supercombinator?", "body": "<blockquote>\n  <p>A supercombinator is either a constant, <strong>or a combinator which contains only supercombinators as subexpressions</strong>.</p>\n</blockquote>\n\n<p>Or more completely,</p>\n\n<blockquote>\n  <p>Any lambda expression is of the form \\x1 x2 .. xn -> E, where E is not\n  a lambda abstraction and n\u22650. (Note that if the expression is not a\n  lambda abstraction, n=0.) This is a supercombinator if and only if:</p>\n  \n  <ul>\n  <li>the only free variables in E are x1..xn, and</li>\n  <li><strong>every lambda abstraction in E is a supercombinator</strong>.</li>\n  </ul>\n</blockquote>\n\n<p>A combinator does not contain any free variable, but might have a subexpression that does.\nFor example, from <a href=\"https://wiki.haskell.org/Super_combinator\" rel=\"nofollow noreferrer\">Haskell Wiki: Super combinator</a></p>\n\n<pre><code>\\f g -&gt; f (\\x -&gt; g x 2)\n</code></pre>\n\n<p>the outer lambda function is indeed a combinator because it has no free variables, however its subexpression <code>\\x -&gt; g x 2</code> has a free variable (<code>g</code>), so it is not a combinator. It follows that <code>\\f g -&gt; f (\\x -&gt; g x 2)</code> cannot be a supercombinator</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 1, "accepted_answer_id": 54794868, "answer_count": 1, "score": 0, "last_activity_date": 1550705747, "creation_date": 1550667176, "question_id": 54786844, "link": "https://stackoverflow.com/questions/54786844/what-is-the-difference-between-combinator-and-supercombinator", "title": "What is the difference between combinator and supercombinator?", "body": "<p>What is the difference between combinator and supercombinator? Both of them do not contain any free variables. That is the one thing, that I know.</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers", "state-monad", "type-constraints"], "owner": {"reputation": 639, "user_id": 10654293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N3y4b1ilweA/AAAAAAAAAAI/AAAAAAAAAAQ/nO5VTzQiUu0/photo.jpg?sz=128", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/10654293/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "closed_date": 1550665902, "answer_count": 0, "score": 1, "last_activity_date": 1553713425, "creation_date": 1550665491, "last_edit_date": 1553713425, "question_id": 54786365, "link": "https://stackoverflow.com/questions/54786365/why-no-typelcass-constraint-on-statet-definition", "closed_reason": "Duplicate", "title": "Why no typelcass constraint on StateT definition", "body": "<p>Here is the StateT definition in the transformers lib:</p>\n\n<pre><code>newtype StateT s m a = StateT { runStateT :: s -&gt; m (a,s) }\n</code></pre>\n\n<p>Here <code>m</code> is a <code>Monad</code></p>\n\n<p>Then why in the definition there is no contraint on it? Something like:</p>\n\n<pre><code>newtype (Monad m) =&gt; StateT s m a = StateT { runStateT :: s -&gt; m (a,s) }\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550662890, "post_id": 54785423, "comment_id": 96349376, "body": "@RobinZigmond The first one is a perfectly valid function definition."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 8, "last_activity_date": 1550663208, "creation_date": 1550663208, "answer_id": 54785643, "question_id": 54785423, "link": "https://stackoverflow.com/questions/54785423/what-is-the-difference-between-lambda-abstractions/54785643#54785643", "title": "What is the difference between lambda abstractions?", "body": "<p>The second declaration uses a simple binding <code>z = ...</code>, so it is affected by the monomorphism restriction. The first one uses a function binding <code>z x = ...</code>, so it is not affected. </p>\n\n<p>Apart from that, there is no difference.</p>\n\n<p>Adding an explicit type signature would remove even the difference about the monomorphism restriction, which would not apply to any of the declarations. The same holds if we disable the MR in GHC using a flag or <code>LANGUAGE</code> pragma, of course.</p>\n"}, {"tags": [], "owner": {"reputation": 1298, "user_id": 1102119, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/13045f5496c970abe6b1a6ead4891b0a?s=128&d=identicon&r=PG", "display_name": "kccqzy", "link": "https://stackoverflow.com/users/1102119/kccqzy"}, "is_accepted": false, "score": 0, "last_activity_date": 1550695850, "creation_date": 1550695850, "answer_id": 54795037, "question_id": 54785423, "link": "https://stackoverflow.com/questions/54785423/what-is-the-difference-between-lambda-abstractions/54795037#54795037", "title": "What is the difference between lambda abstractions?", "body": "<p>There are no behavioral differences, but depending on optimization settings, there could be small differences in performance. </p>\n\n<p>As an example, in the <code>base</code> library, in <code>GHC.List</code> we see the following:</p>\n\n<pre><code>-- The lambda form turns out to be necessary to make this inline\n-- when we need it to and give good performance.\n{-# INLINE [0] lengthFB #-}\nlengthFB :: x -&gt; (Int -&gt; Int) -&gt; Int -&gt; Int\nlengthFB _ r = \\ !a -&gt; r (a + 1)\n</code></pre>\n\n<p>(Copied from <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.List.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.List.html</a> but there are plenty of other examples just in <code>base</code> or in <code>containers</code>). Specifically the two different forms may have differences in the arity of the function and affect inlining differences.  </p>\n\n<p>The difference could be more pronounced if there is additionally a <code>where</code> clause in the definition. In the absence of the let-float optimization, the second form means that all invocations of the function share a single instance, but in the first form different invocations may create separate instances. Again, this is depending on optimization settings and usually with <code>-O</code> GHC will produce identical code. </p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 1, "accepted_answer_id": 54785643, "answer_count": 2, "score": 3, "last_activity_date": 1550695850, "creation_date": 1550662589, "question_id": 54785423, "link": "https://stackoverflow.com/questions/54785423/what-is-the-difference-between-lambda-abstractions", "title": "What is the difference between lambda abstractions?", "body": "<p>What is the different between those expression: </p>\n\n<pre><code>z n = n + 1\n</code></pre>\n\n<p>and </p>\n\n<pre><code>z = \\n -&gt; n  + 1 \n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 1, "last_activity_date": 1550693721, "creation_date": 1550693721, "answer_id": 54794556, "question_id": 54785227, "link": "https://stackoverflow.com/questions/54785227/how-to-change-path-to-resulting-binary-with-stack/54794556#54794556", "title": "How to change path to resulting binary with stack?", "body": "<p>You can use the <code>local-bin-path</code> setting in your <code>stack.yaml</code> file.</p>\n"}], "owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 54794556, "answer_count": 1, "score": 0, "last_activity_date": 1550693721, "creation_date": 1550662021, "question_id": 54785227, "link": "https://stackoverflow.com/questions/54785227/how-to-change-path-to-resulting-binary-with-stack", "title": "How to change path to resulting binary with stack?", "body": "<p>As I understand, building with <code>stack build</code> sets resulting binaries to local-install-root directory (<code>stack path</code>). Is any way to change this directory with .cabal/stack.yaml file?</p>\n"}, {"tags": ["haskell", "memory-management", "fold"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 10668536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d520fb99182d11f935e74abd96c2de?s=128&d=identicon&r=PG&f=1", "display_name": "Mayoi", "link": "https://stackoverflow.com/users/10668536/mayoi"}, "edited": false, "score": 0, "creation_date": 1550697207, "post_id": 54785214, "comment_id": 96368674, "body": "Thanks! The first code snippet consumes constant memory while the second does not."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1550661985, "creation_date": 1550661985, "answer_id": 54785214, "question_id": 54784679, "link": "https://stackoverflow.com/questions/54784679/how-to-make-foldl-consume-constant-memory/54785214#54785214", "title": "How to make foldl consume constant memory?", "body": "<p>I would try to force the fields of <code>Stupid</code> and see if that helps.</p>\n\n<pre><code>let f acc x = c `seq` a `seq` Stupid{content=c,ul=a}\n       where\n       c = content acc V.// [(x,x+123)]\n       a = ul acc\nin foldl' f (Stupid {content=V.replicate 10000 10,ul=1}) $\n   take 100000 $\n   cycle [0..9999]\n</code></pre>\n\n<p>This should be nearly equivalent to forcing the parameters of the function:</p>\n\n<pre><code>foldl' (\\acc x -&gt; acc `seq` x `seq` \n        Stupid{content=(content acc) V.// [(x,x+123)],ul=ul acc})\n   (Stupid {content=V.replicate 10000 10,ul=1}) $ take 100000 $ cycle [0..9999]\n</code></pre>\n\n<p>(This can also be written with bang patterns, if one prefers those.)</p>\n\n<p>Another option, more aggressive, would be to use strictness annotations in the definition of the <code>Stupid</code> constructor.</p>\n\n<pre><code>data ... = Stupid { content = ! someType , ul :: ! someOtherType }\n</code></pre>\n\n<p>This will always force those fields in the whole program.</p>\n"}], "owner": {"reputation": 75, "user_id": 10668536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d520fb99182d11f935e74abd96c2de?s=128&d=identicon&r=PG&f=1", "display_name": "Mayoi", "link": "https://stackoverflow.com/users/10668536/mayoi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 54785214, "answer_count": 1, "score": 3, "last_activity_date": 1550661985, "creation_date": 1550660293, "question_id": 54784679, "link": "https://stackoverflow.com/questions/54784679/how-to-make-foldl-consume-constant-memory", "title": "How to make foldl consume constant memory?", "body": "<p>We define the following data type <code>Stupid</code>:</p>\n\n<pre><code>import qualified Data.Vector as V\nimport Data.List (foldl')\ndata Stupid = Stupid {content::V.Vector Int, ul::Int} deriving Show\n</code></pre>\n\n<p>Now I have two slightly different code.</p>\n\n<pre><code>foldl' (\\acc x-&gt;Stupid{content=(content acc) V.// [(x,x+123)],ul=1}) (Stupid {content=V.replicate 10000 10,ul=1}) $ take 100000 $ cycle [0..9999]\n</code></pre>\n\n<p>takes constant memory (~100M), while</p>\n\n<pre><code>foldl' (\\acc x-&gt;Stupid{content=(content acc) V.// [(x,x+123)],ul=ul acc}) (Stupid {content=V.replicate 10000 10,ul=1}) $ take 100000 $ cycle [0..9999]\n</code></pre>\n\n<p>takes a huge amount of memory(~8G).</p>\n\n<p>Theoretically, only one copy of the current <code>Stupid</code> object is needed though out the process for both cases. I don't understand why there is such a difference in memory consumption if I want to access and record the <code>ul acc</code>.</p>\n\n<p>Can someone explain why this happens and give a workaround for constant memory if I need to access <code>ul acc</code>? Thanks.</p>\n\n<p>Note: I know that I can do replacements of a vector in batch, this script is just for demonstration purpose, so please don't modify that part.</p>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550649700, "post_id": 54781286, "comment_id": 96341490, "body": "This isn&#39;t how pattern matching works - you can only do it against constructors, and can&#39;t, as you see here, use a variable to stand for the constructor. Perhaps there&#39;s a language extension which allows this, if there is I&#39;m not aware of it. But I don&#39;t see that you actually write less code doing it the way you want - and I find it less readable compared to the standard way."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1550649708, "creation_date": 1550649708, "answer_id": 54781459, "question_id": 54781286, "link": "https://stackoverflow.com/questions/54781286/pattern-matching-operator-constructor-in-expression/54781459#54781459", "title": "Pattern matching operator/constructor in expression", "body": "<p>Can't do that. Consider this instead:</p>\n\n<pre><code>data Operator = Add | Sub | Mult | Div | Power\ndata Exp = Num Int | Neg Exp | Bin Operator Exp Exp\n</code></pre>\n\n<p>Now you can write something very similar to what you tried:</p>\n\n<pre><code>elimiZeros (Bin a b c) = ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1550658848, "post_id": 54781695, "comment_id": 96346853, "body": "it <i>could</i> be <code>(`Int` or `Bool`)</code>. But then what would that <code>or</code> be?... in what type system?... the first thing that must be told about Haskell&#39;s is that it wants its types known <i>in full</i> upfront. that is quite hard to get to outsiders, esp. coming from dynamic languages, esp. that it is never actually <i>said.</i> (at least I didn&#39;t see it)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1550661441, "post_id": 54781695, "comment_id": 96348553, "body": "@WillNess Indeed. Some type systems allow &quot;union types&quot; like <code>Int or Bool</code>, but they are quite complex to use (in type checking / type inference). In Haskell, there&#39;s no real need to use that. AFAIK, <code>mypy</code> does use union types, with some success, but there type inference is (overall) simpler than in Haskell."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1550650701, "creation_date": 1550650701, "answer_id": 54781695, "question_id": 54781286, "link": "https://stackoverflow.com/questions/54781286/pattern-matching-operator-constructor-in-expression/54781695#54781695", "title": "Pattern matching operator/constructor in expression", "body": "<p>Haskell does not allow patterns like</p>\n\n<pre><code>f (a b c) = ...\n</code></pre>\n\n<p>To see why, consider this type:</p>\n\n<pre><code>data T = A Int Int | B Bool Bool\n\nf :: T -&gt; ...\nf (a b c) = ...\n</code></pre>\n\n<p>If that were allowed, what would be the type of <code>b</code> and <code>c</code>? Well, it could be <code>Int</code> or <code>Bool</code>, we can't know for sure. So, in general, <code>(a b c)</code> patterns are forbidden, requiring that a pattern must start with an explicit constructor (unless the pattern is just a variable, of course).</p>\n\n<p>In your code, you can try using multiple equations</p>\n\n<pre><code>elimiZeros (Add b (Num 0)) = ...\nelimiZeros (Add b c      ) = ...\n...\n</code></pre>\n\n<p>avoiding most of your <code>if</code>s.</p>\n"}], "owner": {"reputation": 13, "user_id": 11088615, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JWhIK7JZLfQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPcJSBMRzbr8DNF0UX-apGYZjCYMg/mo/photo.jpg?sz=128", "display_name": "Bj&#248;rn", "link": "https://stackoverflow.com/users/11088615/bj%c3%b8rn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "accepted_answer_id": 54781695, "answer_count": 2, "score": 1, "last_activity_date": 1550677104, "creation_date": 1550649007, "last_edit_date": 1550677104, "question_id": 54781286, "link": "https://stackoverflow.com/questions/54781286/pattern-matching-operator-constructor-in-expression", "title": "Pattern matching operator/constructor in expression", "body": "<p>I'm trying to write a function that simplifies expressions by identifying parts of it that will evaluate to zero, so that n*0 -> 0 and n+0 -> n etc.</p>\n\n<pre><code>elimiZeros :: Exp -&gt; Exp\n</code></pre>\n\n<p>The data type is:</p>\n\n<pre><code>data Exp = Num Int\n     | Add Exp Exp\n     | Sub Exp Exp\n     | Mult Exp Exp\n     | Div Exp Exp\n     | Power Exp Exp\n     | Neg Exp\n     deriving Show\n</code></pre>\n\n<p>To avoid having to pattern match each operator by themselves, I tried matching several at the same time, however I get a compiler error: \"Parse error in pattern: a\":</p>\n\n<pre><code>elimiZeros :: Exp -&gt; Exp\nelimiZeros (Num n) = (Num n)\nelimiZeros (a b c) = \n  if c == (Num 0)\n    then case a of\n      Add -&gt; elimiZeros b\n      Sub -&gt; elimiZeros b\n      Mult -&gt; (Num 0)\n  else if b == (Num 0)\n    then case a of\n      Add -&gt; elimiZeros c\n      Sub -&gt; elimiZeros c\n      -- etc, not finished\n  else (a b c)\n</code></pre>\n\n<p>Isn't it possible to pattern match with this syntax?</p>\n\n<p>Edit: Thank you for the clarifying responses! </p>\n"}, {"tags": ["haskell", "monad-transformers", "classy-prelude"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1565145095, "post_id": 54779029, "comment_id": 101256012, "body": "The advantages of <code>StateT s IO</code> over <code>IORef</code>s are real, and they have nothing to do with purity. A <code>StateT</code> &quot;variable&quot; can&#39;t escape its enclosing <code>runStateT</code>. That makes it clear to both humans and the compiler just when it exists. It can be allocated on the stack or in a register, and even unboxed automatically. An <code>IORef</code> can be passed to a function, stored in a data structure, etc. It is always allocated on the heap and its contents must be boxed. If you need an accumulator for a tight loop, an <code>IORef</code> is typically a lousy choice. I know that doesn&#39;t answer your question."}, {"owner": {"reputation": 2567, "user_id": 3780203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3f3f9ab585dc56fa27e203ce4eb27fd?s=128&d=identicon&r=PG&f=1", "display_name": "ephrion", "link": "https://stackoverflow.com/users/3780203/ephrion"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1565192190, "post_id": 54779029, "comment_id": 101277446, "body": "@dfeuer does GHC actually use that knowledge to do optimizations like that on the <code>s</code> in a <code>StateT s m a</code>?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2567, "user_id": 3780203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3f3f9ab585dc56fa27e203ce4eb27fd?s=128&d=identicon&r=PG&f=1", "display_name": "ephrion", "link": "https://stackoverflow.com/users/3780203/ephrion"}, "edited": false, "score": 1, "creation_date": 1565197978, "post_id": 54779029, "comment_id": 101280290, "body": "@ephrion Oh yes, most definitely. GHC&#39;s representation of <code>IO</code> is bogus, but it makes it very convenient to apply optimizations designed for pure code to code involving <code>IO</code>. Once the newtypes are unwrapped, <code>StateT s IO a</code> is just <code>s -&gt; State# RealWorld -&gt; (# State# RealWorld, (a, s) #)</code>. Despite the difficulty of nested constructed product result analysis, this tends to unbox pretty well in my experience."}], "answers": [{"tags": [], "owner": {"reputation": 2567, "user_id": 3780203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3f3f9ab585dc56fa27e203ce4eb27fd?s=128&d=identicon&r=PG&f=1", "display_name": "ephrion", "link": "https://stackoverflow.com/users/3780203/ephrion"}, "is_accepted": true, "score": 8, "last_activity_date": 1565195086, "creation_date": 1565195086, "answer_id": 57398704, "question_id": 54779029, "link": "https://stackoverflow.com/questions/54779029/how-to-understand-monadunliftios-requirement-of-no-stateful-monads/57398704#57398704", "title": "How to understand `MonadUnliftIO`&#39;s requirement of &quot;no stateful monads&quot;?", "body": "<blockquote>\n  <p>\"StateT is bad, IO is OK\"</p>\n</blockquote>\n\n<p>That's not really the point of the article. The idea is that <code>MonadBaseControl</code> permits some confusing (and often undesirable) behaviors with stateful monad transformers in the presence of concurrency and exceptions.</p>\n\n<p><code>finally :: StateT s IO a -&gt; StateT s IO a -&gt; StateT s IO a</code> is a great example. If you use the \"<code>StateT</code> is attaching a mutable variable of type <code>s</code> onto a monad <code>m</code>\" metaphor, then you might expect that the finalizer action gets access to the most recent <code>s</code> value when an exception was thrown.</p>\n\n<p><code>forkState :: StateT s IO a -&gt; StateT s IO ThreadId</code> is another one. You might expect that the state modifications from the input would be reflected in the original thread.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>lol :: StateT Int IO [ThreadId]\nlol = do\n  for [1..10] $ \\i -&gt; do\n    forkState $ modify (+i)\n</code></pre>\n\n<p>You might expect that <code>lol</code> could be rewritten (modulo performance) as <code>modify (+ sum [1..10])</code>. But that's not right. The implementation of <code>forkState</code> just passes the initial state to the forked thread, and then <em>can never retrieve any state modifications</em>. The easy/common understanding of <code>StateT</code> fails you here.</p>\n\n<p>Instead, you have to adopt a more nuanced view of <code>StateT s m a</code> as \"a transformer that provides a thread-local immutable variable of type <code>s</code> which is implicitly threaded through a computation, and it is possible to replace that local variable with a new value of the same type for future steps of the computation.\" (more or less a verbose english retelling of the <code>s -&gt; m (a, s)</code>) With this understanding, the behavior of <code>finally</code> becomes a bit more clear: it's a local variable, so it does not survive exceptions. Likewise, <code>forkState</code> becomes more clear: it's a thread-local variable, so obviously a change to a different thread won't affect any others.</p>\n\n<p>This is <em>sometimes</em> what you want. But it's usually not how people write code IRL and it often confuses people.</p>\n\n<p>For a long time, the default choice in the ecosystem to do this \"lowering\" operation was <code>MonadBaseControl</code>, and this had a bunch of downsides: hella confusing types, difficult to implement instances, impossible to derive instances, sometimes confusing behavior. Not a great situation.</p>\n\n<p><code>MonadUnliftIO</code> restricts things to a simpler set of monad transformers, and is able to provide relatively simple types, derivable instances, and always predictable behavior. The cost is that <code>ExceptT</code>, <code>StateT</code>, etc transformers can't use it.</p>\n\n<p>The underlying principle is: by restricting what is possible, we make it easier to understand what might happen. <code>MonadBaseControl</code> is extremely powerful and general, and quite difficult to use and confusing as a result. <code>MonadUnliftIO</code> is less powerful and general, but it's much easier to use.</p>\n\n<blockquote>\n  <p>So this appears to be saying that state is not mutated in the monad m when using askUnliftIO. </p>\n</blockquote>\n\n<p>This isn't true - the law is stating that <code>unliftIO</code> shouldn't do anything with the monad transformer aside from lowering it into <code>IO</code>. Here's something that breaks that law:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>newtype WithInt a = WithInt (ReaderT Int IO a)\n  deriving newtype (Functor, Applicative, Monad, MonadIO, MonadReader Int)\n\ninstance MonadUnliftIO WithInt where\n  askUnliftIO = pure (UnliftIO (\\(WithInt readerAction) -&gt; runReaderT 0 readerAction))\n</code></pre>\n\n<p>Let's verify that this breaks the law given: <code>askUnliftIO &gt;&gt;= (\\u -&gt; liftIO (unliftIO u m)) = m</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>test :: WithInt Int\ntest = do\n  int &lt;- ask\n  print int\n  pure int\n\ncheckLaw :: WithInt ()\ncheckLaw = do\n  first &lt;- test\n  second &lt;- askUnliftIO &gt;&gt;= (\\u -&gt; liftIO (unliftIO u test))\n  when (first /= second) $\n    putStrLn \"Law violation!!!\"\n</code></pre>\n\n<p>The value returned by <code>test</code> and the <code>askUnliftIO ...</code> lowering/lifting are different, so the law is broken. Furthermore, the observed effects are different, which isn't great either.</p>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 2, "accepted_answer_id": 57398704, "answer_count": 1, "score": 14, "last_activity_date": 1566259830, "creation_date": 1550638019, "last_edit_date": 1566259815, "question_id": 54779029, "link": "https://stackoverflow.com/questions/54779029/how-to-understand-monadunliftios-requirement-of-no-stateful-monads", "title": "How to understand `MonadUnliftIO`&#39;s requirement of &quot;no stateful monads&quot;?", "body": "<p>I've looked over <a href=\"https://www.fpcomplete.com/blog/2017/06/tale-of-two-brackets\" rel=\"noreferrer\">https://www.fpcomplete.com/blog/2017/06/tale-of-two-brackets</a>, though skimming some parts, and I still don't quite understand the core issue \"<code>StateT</code> is bad, <code>IO</code> is OK\", other than vaguely getting the sense that Haskell allows one to write bad <code>StateT</code> monads (or in the ultimate example in the article, <code>MonadBaseControl</code> instead of <code>StateT</code>, I think).</p>\n\n<p>In the haddocks, the following law must be satisfied:</p>\n\n<pre><code>askUnliftIO &gt;&gt;= (\\u -&gt; liftIO (unliftIO u m)) = m\n</code></pre>\n\n<p>So this appears to be saying that state is not mutated in the monad <code>m</code> when using <code>askUnliftIO</code>. But to my mind, in <code>IO</code>, the entire world can be the state. I could be reading and writing to a text file on disk, for instance.</p>\n\n<p>To quote <a href=\"https://www.fpcomplete.com/blog/2017/06/readert-design-pattern\" rel=\"noreferrer\">another article by Michael</a>, </p>\n\n<blockquote>\n  <p>False purity We say WriterT and StateT are pure, and technically they\n  are. But let's be honest: if you have an application which is entirely\n  living within a StateT, you're not getting the benefits of restrained\n  mutation that you want from pure code. May as well call a spade a\n  spade, and accept that you have a mutable variable.</p>\n</blockquote>\n\n<p>This makes me think this is indeed the case: with IO we are being honest, with <code>StateT</code>, we are not being honest about mutability ... but that seems another issue than what the law above is trying to show; after all, <code>MonadUnliftIO</code> is assuming <code>IO</code>. I'm having trouble understanding conceptually how <code>IO</code> is more restrictive than something else.</p>\n\n<p><strong>Update 1</strong></p>\n\n<p>After sleeping (some), I am still confused but am gradually getting less so as the day wears on. I worked out the law proof for <code>IO</code>. I realized the presence of <code>id</code> in the README. In particular,</p>\n\n<pre><code>instance MonadUnliftIO IO where\n  askUnliftIO = return (UnliftIO id)\n</code></pre>\n\n<p>So <code>askUnliftIO</code> would appear to return an <code>IO (IO a)</code> on an <code>UnliftIO m</code>.</p>\n\n<pre><code>Prelude&gt; fooIO = print 5\nPrelude&gt; :t fooIO\nfooIO :: IO ()\nPrelude&gt; let barIO :: IO(IO ()); barIO = return fooIO\nPrelude&gt; :t barIO\nbarIO :: IO (IO ())\n</code></pre>\n\n<p>Back to the law, it really appears to be saying that state is not mutated in the monad <code>m</code> when doing a round trip on the transformed monad (<code>askUnliftIO</code>), where the round trip is <code>unLiftIO</code> -> <code>liftIO</code>.</p>\n\n<p>Resuming the example above, <code>barIO :: IO ()</code>, so if we do <code>barIO &gt;&gt;= (u -&gt; liftIO (unliftIO u m))</code>, then <code>u :: IO ()</code> and <code>unliftIO u == IO ()</code>, then <code>liftIO (IO ()) == IO ()</code>. **So since everything has basically been applications of <code>id</code> under the hood, we can see that no state was changed, even though we are using <code>IO</code>. Crucially, I think, what is important is that the value in <code>a</code> is never run, nor is any other state modified, as a result of using <code>askUnliftIO</code>. If it did, then like in the case of <code>randomIO :: IO a</code>, we would not be able to get the same value had we not run <code>askUnliftIO</code> on it. (Verification attempt 1 below)</p>\n\n<p><em>But</em>, it still seems like we <em>could</em> do the same for other Monads, even if they do maintain state. But I also see how, for some monads, we may not be able to do so. Thinking of a contrived example: each time we access the value of type <code>a</code> contained in the stateful  monad, some internal state is changed. </p>\n\n<p><strong>Verification attempt 1</strong></p>\n\n<pre><code>&gt; fooIO &gt;&gt; askUnliftIO\n5\n&gt; fooIOunlift = fooIO &gt;&gt; askUnliftIO\n&gt; :t fooIOunlift\nfooIOunlift :: IO (UnliftIO IO)\n&gt; fooIOunlift\n5\n</code></pre>\n\n<p>Good so far, but confused about why the following occurs:</p>\n\n<pre><code> &gt; fooIOunlift &gt;&gt;= (\\u -&gt; unliftIO u)\n\n&lt;interactive&gt;:50:24: error:\n    * Couldn't match expected type `IO b'\n                  with actual type `IO a0 -&gt; IO a0'\n    * Probable cause: `unliftIO' is applied to too few arguments\n      In the expression: unliftIO u\n      In the second argument of `(&gt;&gt;=)', namely `(\\ u -&gt; unliftIO u)'\n      In the expression: fooIOunlift &gt;&gt;= (\\ u -&gt; unliftIO u)\n    * Relevant bindings include\n        it :: IO b (bound at &lt;interactive&gt;:50:1)\n</code></pre>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 10, "creation_date": 1550614526, "post_id": 54775756, "comment_id": 96331471, "body": "Why ask us when you can just ask GHCi with the <code>:t</code> (or <code>:type</code> ) command?"}, {"owner": {"reputation": 9, "user_id": 8209123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98e066a8e3beef792f49616f9d369df9?s=128&d=identicon&r=PG&f=1", "display_name": "vigilantis", "link": "https://stackoverflow.com/users/8209123/vigilantis"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1550614705, "post_id": 54775756, "comment_id": 96331539, "body": "how would i use that in the terminal?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 4, "creation_date": 1550614997, "post_id": 54775756, "comment_id": 96331618, "body": "sounds like you really haven&#39;t been taught the very basics. Have you read Chapter 1 of Learn You a Haskell? <a href=\"http://learnyouahaskell.com/starting-out\" rel=\"nofollow noreferrer\">learnyouahaskell.com/starting-out</a> [You&#39;ll have to go back a little to the introduction if you haven&#39;t downloaded GHC yet.] Incidentally, the entire book is an excellent introduction to Haskell (it&#39;s what I started with, fwiw)."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1550615578, "post_id": 54775756, "comment_id": 96331807, "body": "as a followup to my last comment, I just realised that types, and the <code>:t</code> command, aren&#39;t covered until the following chapter (&quot;Types and Typeclasses&quot;)"}, {"owner": {"reputation": 9, "user_id": 8209123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98e066a8e3beef792f49616f9d369df9?s=128&d=identicon&r=PG&f=1", "display_name": "vigilantis", "link": "https://stackoverflow.com/users/8209123/vigilantis"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1550615638, "post_id": 54775756, "comment_id": 96331825, "body": "I see, thank you very much, Im just starting to learn so this&#39;ll be very helpful"}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1550626858, "post_id": 54775858, "comment_id": 96334565, "body": "Please read <a href=\"https://stackoverflow.com/help/how-to-answer\">stackoverflow.com/help/how-to-answer</a>, especially the part about answering well-asked questions."}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1550671793, "post_id": 54775858, "comment_id": 96354902, "body": "@chepner are you saying I shouldn&#39;t have answered because it&#39;s asking for multiple questions?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1550672073, "post_id": 54775858, "comment_id": 96355088, "body": "Yes, the linked FAQ is pretty explicit: &quot;Avoid trying to answer questions which ... request answers to multiple questions.&quot;"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1550675364, "post_id": 54775858, "comment_id": 96357209, "body": "@chepner Thanks, I&#39;m new to the site so I thought they counted as one questions as its basically all the same topic"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1550676013, "post_id": 54775858, "comment_id": 96357673, "body": "Such questions are usually homework dumps: why else would they be asking about the types of a list of random expressions with no context?"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 1, "last_activity_date": 1550615350, "last_edit_date": 1550615350, "creation_date": 1550615019, "answer_id": 54775858, "question_id": 54775756, "link": "https://stackoverflow.com/questions/54775756/what-would-the-type-of-the-following-be/54775858#54775858", "title": "What would the type of the following be?", "body": "<ol>\n<li><code>one x = [x]</code> is a that takes an element and returns a list with that element only, so it has type <code>one :: a -&gt; [a]</code></li>\n<li><code>three x = (x,x,x)</code> has trivial type <code>three :: a -&gt; (a,a,a)</code></li>\n<li><code>first x y = x</code> looks like the Prelude function <code>const</code> that has type <code>first :: a -&gt; b -&gt; a</code></li>\n<li><code>mult m n = m*n</code> has the same type as <code>(*)</code>, which is <code>(*) :: Num a =&gt; a -&gt; a -&gt; a</code></li>\n<li><code>[(False,\u20190\u2019),(True,\u20191\u2019)]</code> is not even a function, so has simple type <code>:: [(Bool, Char)]</code></li>\n</ol>\n\n<p>Remember you can always use they GHCi function <code>:t</code> to return the type of an expression</p>\n"}], "owner": {"reputation": 9, "user_id": 8209123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98e066a8e3beef792f49616f9d369df9?s=128&d=identicon&r=PG&f=1", "display_name": "vigilantis", "link": "https://stackoverflow.com/users/8209123/vigilantis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 54775858, "answer_count": 1, "score": -5, "last_activity_date": 1550615350, "creation_date": 1550614486, "question_id": 54775756, "link": "https://stackoverflow.com/questions/54775756/what-would-the-type-of-the-following-be", "title": "What would the type of the following be?", "body": "<p>Im just starting learn Haskell new, I'm struggling with determining the type for the following:</p>\n\n<pre><code>    1) one x = [x]\n    2) three x = (x,x,x)\n    3) first x y = x\n    4) mult m n = m*n\n    5) [(False,\u20190\u2019),(True,\u20191\u2019)]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1550610989, "post_id": 54775016, "comment_id": 96330103, "body": "Is your question the one you asked in the title, or why x and y are considered free variables?"}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1550611042, "post_id": 54775016, "comment_id": 96330122, "body": "As to the purpose, I think it&#39;s already in the page you linked: <i>&quot;Because supercombinators have no free variables, they can always be given their own names and let floated to the top level&quot;</i>"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1550611335, "post_id": 54775016, "comment_id": 96330243, "body": "@RobertHarvey the second question is, why <code>x</code> and <code>y</code> are considered as free variables?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1550611507, "post_id": 54775016, "comment_id": 96330323, "body": "The first point only applies if there <i>are</i> free variables in <code>E</code>. If there aren&#39;t any, then it is vacuously true that all free variables in <code>E</code> are one of the parameters."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 6, "creation_date": 1550611679, "post_id": 54775016, "comment_id": 96330401, "body": "<code>x</code> and <code>y</code> are not free in the expression <code>\\x y -&gt; x + y</code>. But <code>x</code> and <code>y</code> <i>are</i> free in the expression <code>x + y</code>."}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550610884, "creation_date": 1550610884, "question_id": 54775016, "link": "https://stackoverflow.com/questions/54775016/what-can-i-do-with-a-super-combinator-or-combinator", "title": "What can I do with a super combinator or combinator?", "body": "<p>I am reading on the page <a href=\"https://wiki.haskell.org/Super_combinator\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Super_combinator</a> and would like to know, what is the purpose of the super combinator? </p>\n\n<p>And I would like to understand the following context: </p>\n\n<blockquote>\n  <p>Any lambda expression is of the form \\x1 x2 .. xn -> E, where E is not\n  a lambda abstraction and n\u22650. (Note that if the expression is not a\n  lambda abstraction, n=0.) This is a supercombinator if and only if: </p>\n  \n  <ul>\n  <li><p>the only free variables in E are x1..xn, and </p></li>\n  <li><p>every lambda abstraction in E is a supercombinator.  </p></li>\n  </ul>\n</blockquote>\n\n<p>the first point confuses me, because   </p>\n\n<pre><code>\\x y -&gt; x + y \n</code></pre>\n\n<p><code>x</code> and <code>y</code> are bound variables and therefore they are not free.   </p>\n"}, {"tags": ["haskell", "installation", "cabal", "lilypond"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1550658915, "post_id": 54774128, "comment_id": 96346905, "body": "By using <code>stack</code> instead of <code>cabal</code>, for example."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1550666817, "post_id": 54774128, "comment_id": 96351808, "body": "@Bartek Banachewicz: I have edited the question. I tried via stack, but it didn&#39;t work, and I don&#39;t understand what the recommended action is asking me to do."}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1550786281, "post_id": 54774128, "comment_id": 96409965, "body": "it&#39;s just asking to add those dependencies in the stack.yaml"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1550786753, "post_id": 54774128, "comment_id": 96410161, "body": "@Lorenzo: I tried adding those dependencies, and then when I write <code>stack install music-suite</code> I get <code>The same package name is used in multiple local packages  base-orphans used in: - PLIndex &quot;base-orphans-0.8&quot; - PLIndex &quot;base-orphans-0.3.3&quot;</code>.     Which do I get rid of?"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1550786939, "post_id": 54774128, "comment_id": 96410249, "body": "I&#39;d say the oldest one - 0.3.3(?)"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1550787172, "post_id": 54774128, "comment_id": 96410327, "body": "@Lorenzo: Then it tells me to add <code>base-orphans-0.3.3</code> again"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1550787429, "post_id": 54774128, "comment_id": 96410442, "body": "@Lorenzo: I have edited my question with further problems that arise when adding dependencies."}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1550790666, "post_id": 54774128, "comment_id": 96411522, "body": "Try <code>allow-newer: true</code> in your stack.yaml"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1550808498, "post_id": 54774128, "comment_id": 96415029, "body": "@user65526 What do you get from <code>cabal --version</code>?"}, {"owner": {"reputation": 188, "user_id": 5772563, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DVfEl50m8KI/AAAAAAAAAAI/AAAAAAAAADk/gmX7V01d4u8/photo.jpg?sz=128", "display_name": "Adrian Legaspi", "link": "https://stackoverflow.com/users/5772563/adrian-legaspi"}, "edited": false, "score": 0, "creation_date": 1550814234, "post_id": 54774128, "comment_id": 96416577, "body": "Quite frankly, I think this is a problem with the package versioning itself so the best way to proceed with this one is to create a pull request or rather just use stack when building the source by also migrating everything to stack"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1550821652, "post_id": 54774128, "comment_id": 96419472, "body": "@Lorenzo: it still comes up with the same errors."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1550821786, "post_id": 54774128, "comment_id": 96419537, "body": "@Alec: <code>cabal-install version 2.2.0.0 compiled using version 2.2.0.1 of the Cabal library</code>"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 188, "user_id": 5772563, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DVfEl50m8KI/AAAAAAAAAAI/AAAAAAAAADk/gmX7V01d4u8/photo.jpg?sz=128", "display_name": "Adrian Legaspi", "link": "https://stackoverflow.com/users/5772563/adrian-legaspi"}, "edited": false, "score": 0, "creation_date": 1550821987, "post_id": 54774128, "comment_id": 96419633, "body": "@Adrian Legaspi: what kind of pull request, and how do I create one? What does it mean to build the source by migrating everything to stack and using stack in this context?"}], "answers": [{"comments": [{"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1550835446, "post_id": 54825472, "comment_id": 96427212, "body": "Thanks. I tried your steps 1) - 4), but when I tried <code>stack build</code> I got <code>$ stack build Error parsing targets: The specified targets matched no packages. Perhaps you need to run &#39;stack init&#39;? mm$ stack init Looking for .cabal or package.yaml files to use to init the project.</code>"}, {"owner": {"reputation": 94, "user_id": 261965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12533c24ecf85f521466ea6c7bf93174?s=128&d=identicon&r=PG", "display_name": "hsyl20", "link": "https://stackoverflow.com/users/261965/hsyl20"}, "reply_to_user": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1551112956, "post_id": 54825472, "comment_id": 96512118, "body": "Are you sure to execute commands 3 and 4 in a package folder containing a .cabal file?"}], "tags": [], "owner": {"reputation": 94, "user_id": 261965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12533c24ecf85f521466ea6c7bf93174?s=128&d=identicon&r=PG", "display_name": "hsyl20", "link": "https://stackoverflow.com/users/261965/hsyl20"}, "is_accepted": false, "score": 0, "last_activity_date": 1550832662, "creation_date": 1550832662, "answer_id": 54825472, "question_id": 54774128, "link": "https://stackoverflow.com/questions/54774128/cabal-problems-installing-music-suite/54825472#54825472", "title": "Cabal problems installing music-suite", "body": "<p>The problem is that music-suite hasn't been updated for some years and can't be directly built with the latest GHC releases.</p>\n\n<p>Hopefully, we can use \"stack\" which is a tool that allows you to specify which GHC and which packages to use. However I haven't been able to find a build plan working with the music-suite packages on Hackage, so let's build them from sources:</p>\n\n<p>1) Install stack (instructions are on <a href=\"https://haskellstack.org\" rel=\"nofollow noreferrer\">https://haskellstack.org</a>)</p>\n\n<p>2) Optional: create a new package with <code>stack new mypackage</code> (or you can use your own package)</p>\n\n<p>3) In your package folder, create or edit the \"stack.yaml\" file so that it contains:</p>\n\n<pre><code>resolver: lts-13.8\n\npackages:\n- .\n- music-suite\n- music-parts\n- music-score\n- music-articulation\n- music-pitch\n- music-dynamics\n- lilypond\n- musicxml2\n- monadplus\n\nextra-deps:\n- average-0.6.1\n- prettify-1.0\n- data-interval-1.3.0\n- extended-reals-0.2.3.0\n- positive-0.4.1\n- type-unary-0.3.2\n- vector-space-points-0.2.1.2\n- applicative-numbers-0.1.3\n- ty-0.1.7\n- reverse-apply-2.0.1\n- roman-numerals-0.5.1.5\n\nallow-newer: true\n\nghc-options:\n   \"music-score\": -XUndecidableInstances\n</code></pre>\n\n<p>4) In your package folder, fetch and fix music-suite with the following commands:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>git clone https://github.com/music-suite/lilypond\ngit clone https://github.com/music-suite/music-suite\ngit clone https://github.com/music-suite/music-score\ngit clone https://github.com/music-suite/music-dynamics\ngit clone https://github.com/music-suite/music-parts\ngit clone https://github.com/music-suite/music-pitch\ngit clone https://github.com/music-suite/music-articulation\ngit clone https://github.com/music-suite/musicxml2\ngit clone https://github.com/hanshoglund/monadplus\n\necho \"instance Semigroup (Partial a b) where (&lt;&gt;) = mplus\" &gt;&gt; monadplus/src/Control/Monad/Plus.hs\n\necho \"instance Semigroup RhythmContext where (&lt;&gt;) = mappend\" &gt;&gt; music-score/src/Music/Score/Internal/Quantize.hs\necho \"instance Semigroup CrescDim where (&lt;&gt;) = mappend\" &gt;&gt; music-score/src/Music/Score/Export/DynamicNotation.hs\necho \"instance Semigroup DynamicNotation where (&lt;&gt;) = mappend\" &gt;&gt; music-score/src/Music/Score/Export/DynamicNotation.hs\necho \"instance Semigroup Slur where (&lt;&gt;) = mappend\" &gt;&gt; music-score/src/Music/Score/Export/ArticulationNotation.hs\necho \"instance Semigroup Mark where (&lt;&gt;) = mappend\" &gt;&gt; music-score/src/Music/Score/Export/ArticulationNotation.hs\necho \"instance Semigroup ArticulationNotation where (&lt;&gt;) = mappend\" &gt;&gt; music-score/src/Music/Score/Export/ArticulationNotation.hs\necho \"instance Semigroup (ScScore a) where (&lt;&gt;) = mappend\" &gt;&gt; music-score/src/Music/Score/Export/SuperCollider.hs\necho \"instance Semigroup SystemBar where (&lt;&gt;) = mappend\" &gt;&gt; music-score/src/Music/Score/Export2/StandardNotation.hs\necho \"instance Semigroup StaffInfo where (&lt;&gt;) = mappend\" &gt;&gt; music-score/src/Music/Score/Export2/StandardNotation.hs\necho \"instance Semigroup Chord where (&lt;&gt;) = mappend\" &gt;&gt; music-score/src/Music/Score/Export2/StandardNotation.hs\necho \"instance Semigroup MovementInfo where (&lt;&gt;) = mappend\" &gt;&gt; music-score/src/Music/Score/Export2/StandardNotation.hs\necho \"instance Semigroup WorkInfo where (&lt;&gt;) = mappend\" &gt;&gt; music-score/src/Music/Score/Export2/StandardNotation.hs\n</code></pre>\n\n<p>5) Now you can build the whole thing with <code>stack build</code></p>\n\n<hr>\n\n<p>A simpler solution would be to ask for the release of newer music-suite packages on Hackage.</p>\n"}, {"comments": [{"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1551035327, "post_id": 54846131, "comment_id": 96482472, "body": "How can I install an older version of GHC? How do I then open the older version (version 7.10.3), and open the newer version at the terminal? Would there be any conflicts or problems from having two versions?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1551036104, "post_id": 54846131, "comment_id": 96482709, "body": "@user65526 For question one, I trust you can find GHC&#39;s website with Google. For question two, I included instructions in the answer already. For question three, GHC&#39;s installer is generally careful to install versioned names of each executable, though it will reset the non-versioned name to point at the most-recently-installed versioned name; I use <a href=\"https://gist.github.com/dmwit/1d4af1c62fc2ef33cfd7994bc022c2be\" rel=\"nofollow noreferrer\">this script</a> if I want to revert to a different default version after an installation."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 0, "last_activity_date": 1550955351, "creation_date": 1550955351, "answer_id": 54846131, "question_id": 54774128, "link": "https://stackoverflow.com/questions/54774128/cabal-problems-installing-music-suite/54846131#54846131", "title": "Cabal problems installing music-suite", "body": "<p>The payload in your cabal error is here (I have editorialized a bit, replacing some very repetitive stuff with <code>&lt;...&gt;</code>):</p>\n\n<pre><code>[__5] next goal: transformers (dependency of music-score)\n[__5] rejecting: transformers-0.5.5.0, &lt;...&gt; (conflict: music-score =&gt; transformers&gt;=0.4.3.0 &amp;&amp; &lt;0.5)\n[__5] rejecting: transformers-0.4.3.0 (conflict: base==4.11.1.0/installed-4.1..., transformers =&gt; base&gt;=2 &amp;&amp; &lt;4.9)\n[__5] rejecting: transformers-0.4.2.0, &lt;...&gt; (conflict: music-score =&gt; transformers&gt;=0.4.3.0 &amp;&amp; &lt;0.5)\n</code></pre>\n\n<p>Lines 2 and 4 together say that, of all the possible available versions of the <code>transformers</code> package, <em>only</em> version <code>0.4.3.0</code> meets the version bounds in <code>music-core</code>'s constraints. Line 3 says that <code>transformers-0.4.3.0</code> demands <code>base &lt;4.9</code>, and your version of <code>base</code> is too new to meet that constraint.</p>\n\n<p>So far so good, just standard constraint solving, and a summary of what has gone wrong in the constraint set cabal sees. Now for some high-level interpretation that cabal isn't qualified to give you.</p>\n\n<p><code>base</code> is the deepest, most hard-wired library; it comes with GHC and can't be replaced, so your only choice for changing <code>base</code> versions is installing a different version of GHC. There is, unfortunately, no principled connection between <code>base</code> version number and GHC version number, though there is a table <a href=\"https://wiki.haskell.org/Base_package\" rel=\"nofollow noreferrer\">here</a>. Consulting that table, we see that GHC 7.10.3 was the last one to ship a <code>base</code> version under 4.9.</p>\n\n<p>Therefore, to get past this problem and on to the next problem, you should install a version of GHC which is at least as old as 7.10.3, and then tell cabal to use it when performing its constraint solving. This latter you can do either by making the new (old) GHC be the first one on your PATH, or by using cabal's <code>-w</code> flag to specify exactly which compiler to use, as in:</p>\n\n<pre><code>cabal install music-suite -w ghc-7.10.3\n</code></pre>\n"}], "owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1550955351, "creation_date": 1550606742, "last_edit_date": 1550787397, "question_id": 54774128, "link": "https://stackoverflow.com/questions/54774128/cabal-problems-installing-music-suite", "title": "Cabal problems installing music-suite", "body": "<p>I am trying to install music-suite for use with Haskell via cabal. Following the instructions, here <a href=\"http://music-suite.github.io/docs/ref/\" rel=\"nofollow noreferrer\">http://music-suite.github.io/docs/ref/</a> , which suggest downloading Lilypond, I entered <code>cabal install lilypond</code> and downloaded it successfully.</p>\n\n<p>Problems began when I tried to install music-suite via cabal. Here is what happened:</p>\n\n<pre><code>mm$ cabal install music-suite\nclang: warning: argument unused during compilation: '-nopie' [-Wunused-command-line-argument]\nResolving dependencies...\ncabal: Could not resolve dependencies:\n[__0] trying: music-suite-1.9.0 (user goal)\n[__1] trying: musicxml2-1.9.0 (dependency of music-suite)\n[__2] trying: base-4.11.1.0/installed-4.1... (dependency of musicxml2)\n[__3] trying: music-score-1.9.0 (dependency of music-suite)\n[__4] trying: vector-space-points-0.2.1.2 (dependency of music-score)\n[__5] next goal: transformers (dependency of music-score)\n[__5] rejecting: transformers-0.5.5.0/installed-0.5..., transformers-0.5.6.2,\ntransformers-0.5.5.0, transformers-0.5.4.0, transformers-0.5.2.0,\ntransformers-0.5.1.0, transformers-0.5.0.1, transformers-0.5.0.0 (conflict:\nmusic-score =&gt; transformers&gt;=0.4.3.0 &amp;&amp; &lt;0.5)\n[__5] rejecting: transformers-0.4.3.0 (conflict:\nbase==4.11.1.0/installed-4.1..., transformers =&gt; base&gt;=2 &amp;&amp; &lt;4.9)\n[__5] rejecting: transformers-0.4.2.0, transformers-0.4.1.0,\ntransformers-0.3.0.0, transformers-0.2.2.1, transformers-0.2.1.0,\ntransformers-0.2.0.0, transformers-0.1.4.0, transformers-0.1.3.0,\ntransformers-0.1.1.0, transformers-0.1.0.1, transformers-0.0.1.0,\ntransformers-0.0.0.0, transformers-0.5.6.1, transformers-0.5.6.0,\ntransformers-0.5.3.1, transformers-0.5.3.0, transformers-0.5.0.2,\ntransformers-0.4.0.0, transformers-0.2.2.0, transformers-0.1.0.0 (conflict:\nmusic-score =&gt; transformers&gt;=0.4.3.0 &amp;&amp; &lt;0.5)\n[__5] fail (backjumping, conflict set: base, music-score, transformers)\nAfter searching the rest of the dependency tree exhaustively, these were the\ngoals I've had most trouble fulfilling: music-score, base, transformers,\nmusic-suite, musicxml2, vector-space-points\n</code></pre>\n\n<p>What exactly has gone wrong? How can I resolve this problem?</p>\n\n<p>I tried to install it via stack, but this message came up:</p>\n\n<pre><code>Error: While constructing the build plan, the following exceptions were encountered:\n\nIn the dependencies for music-suite-1.9.0:\nabcnotation must match ==1.9.0, but the stack configuration has no specified version  (latest matching version\n            is 1.9.0)\nlilypond must match ==1.9.0, but the stack configuration has no specified version  (latest matching version\n         is 1.9.0)\nmusic-articulation must match ==1.9.0, but the stack configuration has no specified version  (latest matching\n                   version is 1.9.0)\nmusic-dynamics must match ==1.9.0, but the stack configuration has no specified version  (latest matching version\n               is 1.9.0)\nmusic-dynamics-literal must match ==1.9.0, but the stack configuration has no specified version  (latest matching\n                       version is 1.9.0)\nmusic-parts must match ==1.9.0, but the stack configuration has no specified version  (latest matching version\n            is 1.9.0)\nmusic-pitch must match ==1.9.0, but the stack configuration has no specified version  (latest matching version\n            is 1.9.0)\nmusic-pitch-literal must match ==1.9.0, but the stack configuration has no specified version  (latest matching\n                    version is 1.9.0)\nmusic-preludes must match ==1.9.0, but the stack configuration has no specified version  (latest matching version\n               is 1.9.0)\nmusic-score must match ==1.9.0, but the stack configuration has no specified version  (latest matching version\n            is 1.9.0)\nmusicxml2 must match ==1.9.0, but the stack configuration has no specified version  (latest matching version\n          is 1.9.0)\nneeded since music-suite is a build target.\n\nSome different approaches to resolving this:\n\n  * Consider trying 'stack solver', which uses the cabal-install solver to attempt to find some working build\nconfiguration. This can be convenient when dealing with many complicated constraint errors, but results may be\nunpredictable.\n\n  * Recommended action: try adding the following to your extra-deps\nin /Users/mm/.stack/global-project/stack.yaml:\n\n- abcnotation-1.9.0\n- lilypond-1.9.0\n- music-articulation-1.9.0\n- music-dynamics-1.9.0\n- music-dynamics-literal-1.9.0\n- music-parts-1.9.0\n- music-pitch-1.9.0\n- music-pitch-literal-1.9.0\n- music-preludes-1.9.0\n- music-score-1.9.0\n- musicxml2-1.9.0\n</code></pre>\n\n<p>I had added all these dependencies (which are also listed here <a href=\"http://hackage.haskell.org/package/music-suite-1.9.0/dependencies\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/music-suite-1.9.0/dependencies</a>), however\nI receive <code>The same package name is used in multiple local packagesbase-orphans used in:\n- PLIndex \"base-orphans-0.8\"\n- PLIndex \"base-orphans-0.3.3\"</code> when I type <code>stack install music-suite</code> at the terminal.</p>\n\n<p>When I remove one of these dependencies, I get a message asking for them to be restored, and I also get the following errors:</p>\n\n<p>Error: While constructing the build plan, the following exceptions were encountered:</p>\n\n<pre><code> In the dependencies for cassava-0.4.4.0:\nbase-4.12.0.0 from stack configuration does not match &gt;=4.5 &amp;&amp; &lt;4.9  (latest matching version is 4.8.2.0)\n needed due to music-suite-1.9.0 -&gt; cassava-0.4.4.0\n\n  In the dependencies for comonad-4.3:\nbase-4.12.0.0 from stack configuration does not match &gt;=0 &amp;&amp; &lt;0 \n needed due to music-suite-1.9.0 -&gt; comonad-4.3\n\n In the dependencies for directory-1.2.7.1:\nbase-4.12.0.0 from stack configuration does not match &gt;=4.5 &amp;&amp; &lt;4.11  (latest matching version is 4.10.1.0)\n needed due to music-suite-1.9.0 -&gt; directory-1.2.7.1\n\n In the dependencies for monadplus-1.4.2:\nbase-4.12.0.0 from stack configuration does not match &gt;=4 &amp;&amp; &lt;4.11  (latest matching version is 4.10.1.0)\n needed due to music-suite-1.9.0 -&gt; monadplus-1.4.2\n\n In the dependencies for music-score-1.9.0:\nbase-orphans-0.8 from stack configuration does not match &gt;=0.1 &amp;&amp; &lt;0.4  (latest matching version is 0.3.3)\n needed due to music-suite-1.9.0 -&gt; music-score-1.9.0\n\n In the dependencies for process-1.2.3.0:\nbase-4.12.0.0 from stack configuration does not match &gt;=4.4 &amp;&amp; &lt;4.9  (latest matching version is 4.8.2.0)\n needed due to music-suite-1.9.0 -&gt; process-1.2.3.0\n\n In the dependencies for transformers-0.4.3.0:\nbase-4.12.0.0 from stack configuration does not match &gt;=2 &amp;&amp; &lt;4.9  (latest matching version is 4.8.2.0)\n needed due to music-suite-1.9.0 -&gt; transformers-0.4.3.0\n\n In the dependencies for vector-space-points-0.2.1.2:\nbase-4.12.0.0 from stack configuration does not match &gt;=4.0 &amp;&amp; &lt;4.12  (latest matching version is 4.11.1.0)\n needed due to music-suite-1.9.0 -&gt; vector-space-points-0.2.1.2\n\n Some different approaches to resolving this:\n\n   * Set 'allow-newer: true' to ignore all version constraints and build anyway.\n\n   * Consider trying 'stack solver', which uses the cabal-install solver to attempt to find some working build\nconfiguration. This can be convenient when dealing with many complicated constraint errors, but results may be\nunpredictable.\n</code></pre>\n"}, {"tags": ["haskell", "maybe"], "comments": [{"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 6, "creation_date": 1550603869, "post_id": 54773421, "comment_id": 96326881, "body": "add par&#233;ntesis <code>justToIntOnly (Just a)</code>. Also check function <code>maybe</code> from <code>Data.Maybe</code>"}, {"owner": {"reputation": 61, "user_id": 1925052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltq1U.jpg?s=128&g=1", "display_name": "FabolousPotato", "link": "https://stackoverflow.com/users/1925052/fabolouspotato"}, "reply_to_user": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1550603894, "post_id": 54773421, "comment_id": 96326891, "body": "Oh thanks so simple"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1550604640, "post_id": 54773421, "comment_id": 96327239, "body": "<code>justToIntOnly = Data.Maybe.fromMaybe (-1)</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1550605322, "post_id": 54773421, "comment_id": 96327543, "body": "I wonder why do you want to do such a conversion. Note that, in Haskell, representing an &quot;invalid&quot; integer result as <code>-1</code> is not idiomatic, and using <code>Nothing</code> would be the right way. Unless you need to interface with some software / server / library / format / whatever which mandates <code>-1</code>, you should keep your <code>Nothing</code>s as they are."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1550606212, "post_id": 54773421, "comment_id": 96327981, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/23413691/how-to-write-show-typeclass-for-data\">How to write &quot;Show&quot; Typeclass for data</a>"}, {"owner": {"reputation": 61, "user_id": 1925052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltq1U.jpg?s=128&g=1", "display_name": "FabolousPotato", "link": "https://stackoverflow.com/users/1925052/fabolouspotato"}, "edited": false, "score": 1, "creation_date": 1550609218, "post_id": 54773421, "comment_id": 96329376, "body": "I need to do this chi because I want to use elemIndex function&#39;s result Maybe to actually access an index in a list."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1550609935, "post_id": 54773421, "comment_id": 96329698, "body": "That sounds quite weird. <code>elemIndex</code> requires an element <code>x</code> to search, and gives you <code>Just index</code> on success. If you access the list at <code>index</code> you get back the element <code>x</code> you searched for. Isn&#39;t that unnecessary? Further, we have plenty of functions to work with a <code>Maybe Int</code>, including <code>fmap</code> and all the applicative/monadic functions. If we have <code>position :: Maybe Int</code>, we can use <code>(list !!) &lt;$&gt; position</code> and get <code>Just element</code> (if <code>position == Just index</code>) or <code>Nothing</code> (otherwise). The nothing-ness gets propagated nicely, as it should. Using <code>case .. of</code> is also a lower level option."}], "answers": [{"tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": false, "score": 5, "last_activity_date": 1550605861, "last_edit_date": 1550605861, "creation_date": 1550605515, "answer_id": 54773841, "question_id": 54773421, "link": "https://stackoverflow.com/questions/54773421/how-to-convert-maybe-a-to-a-or-1-for-nothing/54773841#54773841", "title": "How to convert Maybe a to a or -1 (for nothing)?", "body": "<p>You just forgot the parenthesis, remember what you're doing is actually a pattern matching:</p>\n\n<pre><code>--Converts Just a to a &amp;&amp; Nothing to -1\njustToIntOnly :: (Integral a) =&gt; Maybe a -&gt; a\njustToIntOnly (Just a) = a\njustToIntOnly Nothing  = -1\n</code></pre>\n\n<p>As someone pointed out in the comments, there are already functions to handle <code>Maybe</code> like you need, you can search Hoogle for <code>Maybe a -&gt; a</code>:</p>\n\n<p>The maybe function takes a default value, a function, and a Maybe value. If the Maybe value is Nothing, the function returns the default value. Otherwise, it applies the function to the value inside the Just and returns the result.</p>\n\n<pre><code>maybe :: b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b\n</code></pre>\n\n<p>You can use it like</p>\n\n<pre><code>justToIntOnly = maybe (-1) id\n</code></pre>\n\n<p>An even better function would be <code>fromMaybe :: a -&gt; Maybe a -&gt; a</code>, which takes a default value and and Maybe value. If the Maybe is Nothing, it returns the default values; otherwise, it returns the value contained in the Maybe.</p>\n\n<pre><code>justToIntOnly = fromMaybe (-1)\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 1925052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltq1U.jpg?s=128&g=1", "display_name": "FabolousPotato", "link": "https://stackoverflow.com/users/1925052/fabolouspotato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "closed_date": 1550612316, "answer_count": 1, "score": 0, "last_activity_date": 1550605861, "creation_date": 1550603686, "last_edit_date": 1550604441, "question_id": 54773421, "link": "https://stackoverflow.com/questions/54773421/how-to-convert-maybe-a-to-a-or-1-for-nothing", "closed_reason": "Not suitable for this site", "title": "How to convert Maybe a to a or -1 (for nothing)?", "body": "<p>I'd line to convert Just a to a and Nothing to -1 where a is an Int.</p>\n\n<p>My function is:</p>\n\n<pre><code>--Converts Just a to a &amp;&amp; Nothing to -1\njustToIntOnly :: (Integral a) =&gt; Maybe a -&gt; a\njustToIntOnly Just a = a\njustToIntOnly Nothing = -1\n</code></pre>\n\n<p>The error i get is:\n\"Equations for `justToIntOnly' have different numbers of arguments\"</p>\n\n<p>I dont really understand whats going on,</p>\n"}, {"tags": ["haskell", "typechecking"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550590239, "post_id": 54768808, "comment_id": 96319530, "body": "What makes you so sure that the GHC documentation is incomplete?"}, {"owner": {"reputation": 479, "user_id": 9903901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jack malkovick", "link": "https://stackoverflow.com/users/9903901/jack-malkovick"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550597768, "post_id": 54768808, "comment_id": 96323952, "body": "@DanielW Sorry. I did not say that. Java lang spec is complete, but it&#39;s not a very good place for e beginner to start. I know, it&#39;s an exaggerated comparison."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1550601100, "post_id": 54768808, "comment_id": 96325676, "body": "Hey, asking for offsite resources is OT on SO (lots of reasons, for example offsite resources tend to become available or get out of date)"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1550606354, "post_id": 54768808, "comment_id": 96328055, "body": "Do you perhaps have a specific question about <code>10.8.3.4. Instance termination rules</code> (scrolling down from your first link)? Those rules look pretty clear to me..."}, {"owner": {"reputation": 479, "user_id": 9903901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jack malkovick", "link": "https://stackoverflow.com/users/9903901/jack-malkovick"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1550647436, "post_id": 54768808, "comment_id": 96340414, "body": "@Cubic It&#39;s just hard to understand from only one information source... even &quot;smaller than&quot; is not exactly clear for me..."}], "owner": {"reputation": 479, "user_id": 9903901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jack malkovick", "link": "https://stackoverflow.com/users/9903901/jack-malkovick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1550600001, "creation_date": 1550587333, "last_edit_date": 1550600001, "question_id": 54768808, "link": "https://stackoverflow.com/questions/54768808/class-instance-type-checking-rules-learning-resources", "title": "Class / Instance type checking rules learning resources", "body": "<p>Currently, I'm trying to understand more about <a href=\"https://downloads.haskell.org/~ghc/master/users-guide/glasgow_exts.html#class-and-instances-declarations\" rel=\"nofollow noreferrer\">Instance termination rules</a>, in order to explain errors like <code>The constraint ... is no smaller than the instance head</code>, and not to use <code>UndecidableInstances</code> without exactly knowing that it does.</p>\n\n<p>I'm sure there are more rules of the type checker regarding instances that I don't know about and that I would be interested to learn.</p>\n\n<p>Where could I find a more detailed description of what Haskell does there?\nUnfortunately, <a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/jfp06.pdf\" rel=\"nofollow noreferrer\">Understanding Functional Dependencies via\nConstraint Handling Rules</a> seems a little too much (complex) for me.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550585214, "post_id": 54766019, "comment_id": 96316346, "body": "But the bold sentence is wrong! After all, <code>fib_mem 30000</code> and <code>fib_mem 30001</code> are applications of functions to arguments, but the latter implicitly has pointers to the former and so whichever one you do first takes <i>significantly</i> longer. They&#39;re pointing their blaming finger at the wrong problem!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1550585949, "post_id": 54766019, "comment_id": 96316802, "body": "See also: <a href=\"https://stackoverflow.com/q/8330756/791604\">What are constant applicative forms?</a>."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550586053, "post_id": 54766019, "comment_id": 96316875, "body": "@DanielWagner Maybe a simple example would be not bad."}], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550588784, "post_id": 54768831, "comment_id": 96318542, "body": "Why this is a CAF <code>z = (+) 4</code> and this not <code>z = \\x -&gt; 4 + x</code>? What is the different?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550588815, "post_id": 54768831, "comment_id": 96318566, "body": "by definition, lambda expression is not a CAF. that&#39;s what the wiki page is saying."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550589889, "post_id": 54768831, "comment_id": 96319273, "body": "Super combinators look like for me functions composition, for instance <code>h(g (f x) )</code>. Is it right?"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550589976, "post_id": 54768831, "comment_id": 96319342, "body": "and why <code>z n = [1..n]</code> is not CAF? <code>n</code> is a bound variable."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550593975, "post_id": 54768831, "comment_id": 96321842, "body": "<code>h(g (f x) )</code> is an expression with  a lot of free variables. You need to show the left hand side of the equation (definition). ---- in <code>z n = [1..n]</code> the <code>n</code> on the RHS depends on <code>n</code> on the LHS, thus <code>z</code> is not CAF. indeed it can be called as <code>z 5</code> first, and then <code>z 3</code>. these will be two different values, not one."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550610027, "post_id": 54768831, "comment_id": 96329739, "body": "<code>z n = [1..n]</code> is a lambda abstration?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550650880, "post_id": 54768831, "comment_id": 96342110, "body": "it is equivalent to <code>z = \\n -&gt; [1..n]</code>, yes. Not <i>eta</i>-equivalent like <code>((+) 4) =~= (\\x -&gt; ((+) 4) x) = (\\x -&gt; 4 + x)</code>, but <i>directly</i> equivalent."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550650928, "post_id": 54768831, "comment_id": 96342140, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/188733/discussion-between-will-ness-and-zero-coding\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 3, "last_activity_date": 1550587379, "creation_date": 1550587379, "answer_id": 54768831, "question_id": 54766019, "link": "https://stackoverflow.com/questions/54766019/create-a-new-expression-without-pointer-from-previous-one/54768831#54768831", "title": "Create a new expression without pointer from previous one", "body": "<blockquote>\n  <p>Why <code>fib_mem</code> is a <em>constant applicative form</em>?</p>\n</blockquote>\n\n<p>Not <code>fib_mem</code>, but <code>(map fib [0..] !!)</code>. It is a <a href=\"https://wiki.haskell.org/Constant_applicative_form\" rel=\"nofollow noreferrer\">CAF</a> because it is a partially applied function <code>(!!)</code>. As such it is subject to memory retention.</p>\n\n<p>(see also: <a href=\"https://stackoverflow.com/q/8330756/791604\">What are super combinators and constant applicative forms?</a>)</p>\n\n<p>Since the type is monomorphic, it is retained in memory even between calls to <code>fib_mem</code>, in effect as if having <code>map fib [0..]</code> \"floated\" to the top level, as if defined as</p>\n\n<pre><code>fib_mem_m :: Int -&gt; Integer\nfib_mem_m = (the_list !!)\n            where fib 0 = 1\n                  fib 1 = 1\n                  fib n = (the_list !! (n-2)) + (the_list !! (n-1))\nthe_list = map fib [0..]\n</code></pre>\n\n<p>If the type were polymorphic, the floating to top level wouldn't be possible, but it would still be retained for the duration of each call to <code>fib_mem</code>, as if defined as</p>\n\n<pre><code>fib_mem_p :: Num a =&gt; Int -&gt; a\nfib_mem_p = (the_list !!)\n            where fib 0 = 1\n                  fib 1 = 1\n                  fib n = (the_list !! (n-2)) + (the_list !! (n-1))\n                  the_list = map fib [0..]\n</code></pre>\n\n<p>To see the difference, evaluate <code>fib_mem_m 10000</code> twice, at the GHCi propt. The second attempt will take 0 seconds. But <code>fib_mem_p 10000</code> will take same amount of time each time it is called. It will still be as fast as the first one, so there is still memoization going on there, it's just not retained between calls. </p>\n\n<p>With this style of definition, the full application as in <code>fib_mem_arg</code> will too be memoized -- and just as the one above, not between the calls to <code>fib_mem_arg</code>, but only during each call.</p>\n\n<pre><code>fib_mem_arg :: Num a =&gt; Int -&gt; Integer  -- or polymorphic, makes no difference\nfib_mem_arg x = the_list !! x\n            where fib 0 = 1\n                  fib 1 = 1\n                  fib n = (the_list !! (n-2)) + (the_list !! (n-1))\n                  the_list = map fib [0..]\n</code></pre>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 54768831, "answer_count": 1, "score": 4, "last_activity_date": 1550587379, "creation_date": 1550578159, "last_edit_date": 1550584420, "question_id": 54766019, "link": "https://stackoverflow.com/questions/54766019/create-a-new-expression-without-pointer-from-previous-one", "title": "Create a new expression without pointer from previous one", "body": "<p>I am reading the book <a href=\"https://www.packtpub.com/application-development/haskell-high-performance-programming\" rel=\"nofollow noreferrer\">https://www.packtpub.com/application-development/haskell-high-performance-programming</a> and trying to figure out, what is the difference between those two functions: </p>\n\n<p>This functions does memoize the intermediate numbers:</p>\n\n<pre><code>fib_mem :: Int -&gt; Integer\nfib_mem = (map fib [0..] !!)\n            where fib 0 = 1\n                  fib 1 = 1\n                  fib n = fib_mem (n-2) + fib_mem (n-1) \n</code></pre>\n\n<p>and this not: </p>\n\n<pre><code>fib_mem_arg :: Int -&gt; Integer\nfib_mem_arg x = map fib [0..] !! x\n                where fib 0 = 1\n                      fib 1 = 1\n                      fib n = fib_mem_arg (n-2) + fib_mem_arg (n-1) \n</code></pre>\n\n<p>The author tries to explain as following: </p>\n\n<blockquote>\n  <p>Running fib_mem_arg with anything but very small arguments, one can\n  confirm it does no memoization. Even though we can see that map fib\n  [0..] does not depend on the argument number and could be memorized,\n  it will not be, <strong>because applying an argument to a function will create\n  a new expression that cannot implicitly have pointers to expressions\n  from previous function applications</strong>. </p>\n</blockquote>\n\n<p>What does he mean with the sentence, that is bold marked? Could someone provide me a simple example? </p>\n\n<p>Why <code>fib_mem</code> is a <code>constant applicative form</code>?</p>\n"}, {"tags": ["haskell", "servant"], "answers": [{"tags": [], "owner": {"reputation": 444, "user_id": 1738581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/febb5b5c9b48bfc151565fb2571fd529?s=128&d=identicon&r=PG", "display_name": "tgrez", "link": "https://stackoverflow.com/users/1738581/tgrez"}, "is_accepted": true, "score": 2, "last_activity_date": 1550576663, "last_edit_date": 1550576663, "creation_date": 1550574761, "answer_id": 54764944, "question_id": 54763143, "link": "https://stackoverflow.com/questions/54763143/catching-io-exceptions-in-servant/54764944#54764944", "title": "catching IO exceptions in servant", "body": "<p>Servant's <code>Handler</code> is a newtype wrapper:</p>\n\n<pre><code>newtype Handler a = Handler { runHandler' :: ExceptT ServantErr IO a }\n</code></pre>\n\n<p>inside, there is a <code>ExceptT ServantErr</code>, where <code>ServantErr</code> is:</p>\n\n<pre><code>data ServantErr = ServantErr { errHTTPCode     :: Int\n                             , errReasonPhrase :: String\n                             , errBody         :: LBS.ByteString\n                             , errHeaders      :: [HTTP.Header]\n                             } deriving (Show, Eq, Read, Typeable)\n</code></pre>\n\n<p>So, you can run your DB operations in eg <code>try</code> or, to handle releasing resources: <code>bracket</code>, and map your DB exceptions to <code>ServantErr</code> to get the HTTP response code that you want.</p>\n\n<p>How to throw <code>ServantErr</code> after you catch DB exception: <a href=\"https://haskell-servant.readthedocs.io/en/stable/tutorial/Server.html#failing-through-servanterr\" rel=\"nofollow noreferrer\">https://haskell-servant.readthedocs.io/en/stable/tutorial/Server.html#failing-through-servanterr</a></p>\n"}], "owner": {"reputation": 823, "user_id": 560478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cede0930b58ad165da51737fff5644?s=128&d=identicon&r=PG", "display_name": "Philipp Siegmantel", "link": "https://stackoverflow.com/users/560478/philipp-siegmantel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 54764944, "answer_count": 1, "score": 0, "last_activity_date": 1550576663, "creation_date": 1550569527, "question_id": 54763143, "link": "https://stackoverflow.com/questions/54763143/catching-io-exceptions-in-servant", "title": "catching IO exceptions in servant", "body": "<p>I use <code>servant</code> for a simple JSON api, that allows you to create users, whose names must be unique. This is enforced by a unique constraint in SQLite. I have a function <code>DB.saveUser :: UserReq -&gt; IO Int</code> that (unsurprisingly) saves users to SQLite and returns the generated id. It will throw a <code>SQLError ErrorConstraint _ _</code> if the name has already been taken. I want to return a HTTP response code 409 if that occurs. So my question would be, is there some way to catch the <code>SQLError</code> in the Handler Monad? If not, what would be the cleanest way to achieve what I'm looking for? I thought about making <code>DB.saveUser</code> return a <code>Maybe Int</code> but somehow I think there must be a better solution.</p>\n\n<pre><code>createUser :: UserReq -&gt; Handler (Headers '[Header \"Location\" Text] NoContent)\ncreateUser ur = do id &lt;- liftIO (DB.saveUser ur)\n                   return . addHeader (T.pack (\"/user/\" ++ show id)) $ NoContent\n\nsaveUser (UR.UserReq name) = withConnection database $ \\conn -&gt;\n  do executeNamed conn \"INSERT INTO users (name) VALUES (:name)\" [\":name\" := name]\n     fromIntegral &lt;$&gt; lastInsertRowId conn\n</code></pre>\n"}, {"tags": ["function", "haskell", "types", "nested", "tuples"], "comments": [{"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 2, "creation_date": 1550572460, "post_id": 54761857, "comment_id": 96308561, "body": "I found question which I think have answer you want, but I didn&#39;t understand it yet. <a href=\"https://stackoverflow.com/questions/31220903/haskell-how-to-create-most-generic-function-possible-that-applies-a-function-to\" title=\"haskell how to create most generic function possible that applies a function to\">stackoverflow.com/questions/31220903/&hellip;</a>"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1550635063, "post_id": 54761857, "comment_id": 96336333, "body": "Yep, that&#39;s what&#39;s needed. Long story short, you can&#39;t do what you want in Haskell today (not counting brittle hacky things), since it doesn&#39;t support intersection types."}], "answers": [{"comments": [{"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 0, "creation_date": 1550567780, "post_id": 54762128, "comment_id": 96305511, "body": "What if we try <code>twice&#39; :: (forall a (b :: * -&gt; *) . b a -&gt; a) -&gt; b (b a) -&gt; a</code>? I&#39;m trying it right now, but not sure it is possible."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 0, "creation_date": 1550570715, "post_id": 54762128, "comment_id": 96307394, "body": "@talex In dependently typed languages, something like that could work. In Haskell, however, <code>b</code> matches only (injective) type constructors, not arbitrary type-level functions. I.e. <code>b a</code> matches with <code>(Int, a)</code> but not with <code>(a, Int)</code>. Further your function would be impossible to call since there is no terminating function of type <code>forall a (b :: * -&gt; *) . b a -&gt; a</code>, since that would be able to map <code>Const () Void</code> to <code>Void</code>, so we would get <code>f (Const ()) :: Void</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1550566243, "creation_date": 1550566243, "answer_id": 54762128, "question_id": 54761857, "link": "https://stackoverflow.com/questions/54761857/is-it-possible-to-use-a-general-function-to-get-the-second-element-of-a-tuple-in/54762128#54762128", "title": "Is it possible to use a general function to get the second element of a tuple inside a tuple?", "body": "<p>With your typing it is not possible because your <code>f = fst</code> is polymorphic and the two calls implicitly involve a different type. If we make the calls explicit, they become:</p>\n\n<pre><code> fst @ (Int,Int) (fst @ ((Int,Int),Int) ((1,2),3))\n</code></pre>\n\n<p>It could be possible to use a different type for <code>twice</code>, requiring that the argument must be a polymorphic function. This requires <code>Rank2Types</code>:</p>\n\n<pre><code>twice' :: (forall a b . (a, b) -&gt; a) -&gt; ((a,b),c) -&gt; a\ntwice' f x = f ( f x )\n</code></pre>\n\n<p>However, the function above is of limited use, since the only meaningful choice for <code>f</code> is <code>fst</code> -- there are no other terminating functions of type <code>(forall a b . (a, b) -&gt; a)</code>.</p>\n\n<p>It should be possible to use type classes as well, turning a few extensions on.</p>\n\n<pre><code>class C a where\n   type Res a\n   theF :: a -&gt; Res a\n\ninstance C (a, b) where\n   type Res (a, b) = a\n   theF = fst\n\ntwiceC :: (C a, C (Res a)) =&gt; a -&gt; Res (Res a)\ntwiceC x = theF (theF x)\n</code></pre>\n\n<p>Here, however, the function must be defined in the <code>instance</code>, instead of being passed as a parameter.</p>\n"}], "owner": {"reputation": 33, "user_id": 8702105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1514bbb11e0da7776a0935d243fe077f?s=128&d=identicon&r=PG&f=1", "display_name": "Minoxsta", "link": "https://stackoverflow.com/users/8702105/minoxsta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 54762128, "answer_count": 1, "score": 3, "last_activity_date": 1550566243, "creation_date": 1550565252, "question_id": 54761857, "link": "https://stackoverflow.com/questions/54761857/is-it-possible-to-use-a-general-function-to-get-the-second-element-of-a-tuple-in", "title": "Is it possible to use a general function to get the second element of a tuple inside a tuple?", "body": "<p>Someone asked me this while working on an exercise about a function applying a function twice to something, and I thought it was interesting. </p>\n\n<p>The idea is we should make the function twice, that takes a function and an input to it, and applies the function twice, e.g.</p>\n\n<pre><code>twice :: (a -&gt; a) -&gt; a -&gt; a\ntwice f x = f ( f x )\n</code></pre>\n\n<p>The typing makes perfect sense in general.\nUnfortunately, for the case of tuples in tuples and the function <code>fst</code> we might think it possible to use it on <code>((1,2),3)</code> but this is not possible because of the type of <code>twice</code>.</p>\n\n<p>Is there a way to make something like this that works?</p>\n"}, {"tags": ["haskell", "data-structures"], "comments": [{"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 1, "creation_date": 1550564880, "post_id": 54761286, "comment_id": 96303953, "body": "You link is not working (probably because of my proxy). Can you describe puzzle here."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550565469, "post_id": 54761286, "comment_id": 96304234, "body": "First impression: use four double-ended queues, one for each segment.  I believe okasaki (&quot;purely functional data structures&quot;) has a good pure deque."}], "answers": [{"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 0, "last_activity_date": 1550572345, "creation_date": 1550572345, "answer_id": 54764104, "question_id": 54761286, "link": "https://stackoverflow.com/questions/54761286/data-structure-for-hungarian-rings-in-haskell/54764104#54764104", "title": "Data structure for Hungarian Rings in Haskell", "body": "<p>Much like <a href=\"https://softwareengineering.stackexchange.com/questions/142760/how-to-represent-a-rubiks-cube-in-a-data-structure\">how to represent a Rubik's cube in a data structure</a>, a naive model contains redundant information, and the most compact model depends on an <a href=\"https://en.wikipedia.org/wiki/Rubik%27s_Cube_group\" rel=\"nofollow noreferrer\">algebraic analysis</a> of the object. So on the one hand, an operation on a model with redundant information may be inefficient, and an operation on a compact model (e.g. a permutation group) may be quite abstract when translating to physical operations.</p>\n\n<p>So you may find that a permutation group of a higher order more easily describes it; here's from the Rubik's Cube Group article on Wikipedia:</p>\n\n<blockquote>\n  <p>The Rubik's Cube group is the subgroup of the symmetric group <em>S\u2084\u2088</em> generated by the six permutations corresponding to the six clockwise cube moves.</p>\n</blockquote>\n\n<p>And that might well correspond to a set of double-ended queues as luqui suggests, as long as you take into account that one rotating operation of one queue affects the other queues.</p>\n"}], "owner": {"reputation": 13, "user_id": 7805666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4873e4c9c92fe8fec4bdadd6c62d615?s=128&d=identicon&r=PG&f=1", "display_name": "Tomogotchi98", "link": "https://stackoverflow.com/users/7805666/tomogotchi98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1550572345, "creation_date": 1550563226, "last_edit_date": 1550564661, "question_id": 54761286, "link": "https://stackoverflow.com/questions/54761286/data-structure-for-hungarian-rings-in-haskell", "title": "Data structure for Hungarian Rings in Haskell", "body": "<p>So I'm working on a solver for the Hungarian Rings puzzle in Haskell (<a href=\"https://www.jaapsch.net/puzzles/rings.htm\" rel=\"nofollow noreferrer\">https://www.jaapsch.net/puzzles/rings.htm</a>)\nI'm not great at the language, still have a lot of blind spots. I'm struggling to figure out what data structure to use to represent the puzzle, and would love any hints, tips or answers for this! (btw how my current idea represents the coloured balls is as a series of numbers that will be in order when the puzzle is solved)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1550567246, "post_id": 54760825, "comment_id": 96305178, "body": "By the way, the last equation does not use pointfree style, that would mean avoiding to mention <code>xs</code>."}], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550567537, "post_id": 54762386, "comment_id": 96305357, "body": "Is <code>sum                     =  foldl (+) 0</code> a pattern binding?"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550567747, "post_id": 54762386, "comment_id": 96305482, "body": "What is DM mean?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1550570392, "post_id": 54762386, "comment_id": 96307178, "body": "@zero_coding Yes, unfortunately <code>sum = ...</code> is a pattern binding, and the MR applies to it, even if it has a function type. (I wish having a function type would be enough, but it is not). We need at least one function argument on the left of <code>=</code>. (DM is a typo for MR -- fixed! Sometimes people jokingly uses DMR for &quot;dreaded monomorphism restriction&quot;, so I got it wrong :) )"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1550570199, "last_edit_date": 1550570199, "creation_date": 1550567166, "answer_id": 54762386, "question_id": 54760825, "link": "https://stackoverflow.com/questions/54760825/why-the-pointfree-style-does-not-cause-a-problem/54762386#54762386", "title": "Why the pointfree style does not cause a problem?", "body": "<blockquote>\n  <p>because the restriction only applies to pattern bindings.</p>\n</blockquote>\n\n<p>Essentially, the MR does not apply when we are defining a function using a function binding of the form</p>\n\n<pre><code>f arg1 ... argN = ...\n</code></pre>\n\n<p>with <code>N &gt; 0</code>.</p>\n\n<p>The intuition is as follows. The purpose of the MR is to avoid turning Haskell non-functions into lower-level functions accidentally. For instance,</p>\n\n<pre><code>x = 3 + 4\n</code></pre>\n\n<p>is not a function. However, its type is <code>Num a =&gt; a</code>, which is usually implemented as a function from a <code>Num</code> dictionary to the result of <code>3+4</code> where <code>+</code> is a function defined by the dictionary. This can lead to a bad performance, since every time we use <code>x</code> the sum will need to be recomputed from scratch. This is unavoidable if we want to compute <code>print (x :: Int) &gt;&gt; print (x :: Double)</code>, for instance. But actually using <code>x</code> at different types is rather uncommon.</p>\n\n<p>So, the MR makes <code>x</code> monomorphic, preventing us to use it at more than a single type. In that way, recomputation can be avoided.</p>\n\n<p>However, if <code>x</code> is <em>already</em> a function there is no harm in keeping that polymorphic, since we are \"recomputing\" function calls anyway. So, the MR does not apply to function bindings.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 54762386, "answer_count": 1, "score": 0, "last_activity_date": 1550570199, "creation_date": 1550561348, "question_id": 54760825, "link": "https://stackoverflow.com/questions/54760825/why-the-pointfree-style-does-not-cause-a-problem", "title": "Why the pointfree style does not cause a problem?", "body": "<p>I read about The Monomorphism Restriction from the page <a href=\"https://www.haskell.org/tutorial/pitfalls.html\" rel=\"nofollow noreferrer\">https://www.haskell.org/tutorial/pitfalls.html</a> and could not understand the last point: </p>\n\n<blockquote>\n  <p>A common violation of the restriction happens with functions defined\n  in a higher-order manner, as in this definition of sum from the\n  Standard Prelude: </p>\n  \n  <p><code>sum                     =  foldl (+) 0</code></p>\n  \n  <p>As is, this would cause a static type error. We can fix the problem by\n  adding the type signature: </p>\n  \n  <p><code>sum                     :: (Num a) =&gt; [a] -&gt; a</code></p>\n  \n  <p>Also note that this problem would not have arisen if we had written: </p>\n  \n  <p><code>sum xs                  =  foldl (+) 0 xs</code></p>\n  \n  <p>because the restriction only applies to pattern bindings.</p>\n</blockquote>\n\n<p>Why the last point does not cause any error?</p>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "edited": false, "score": 0, "creation_date": 1550546716, "post_id": 54758033, "comment_id": 96298093, "body": "Tried to use both modifiers together?"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1550550483, "last_edit_date": 1550550483, "creation_date": 1550550112, "answer_id": 54758818, "question_id": 54758033, "link": "https://stackoverflow.com/questions/54758033/how-to-quickcheck-all-possible-cases-for-a-type-that-is-both-enum-and-bounded/54758818#54758818", "title": "How to quickCheck all possible cases for a type that is both Enum and Bounded?", "body": "<p>How about just not using quickcheck?</p>\n\n<pre><code>&gt; myNeatProperty x = (x == GT) || (x &lt;= EQ)\n&gt; all myNeatProperty [minBound .. maxBound]\nTrue\n&gt; lessNeatProperty x = x &lt;= EQ\n&gt; all lessNeatProperty [minBound .. maxBound]\nFalse\n&gt; -- Oh no! Can we have some counterexamples, please?\n&gt; filter (not . lessNeatProperty) [minBound .. maxBound]\n[GT]\n</code></pre>\n\n<p>For those situations where your space is finite but not <code>Enum</code> and <code>Bounded</code>, consider using <a href=\"https://hackage.haskell.org/package/universe-base-1.0.2.1/docs/Data-Universe-Class.html#v:universeF\" rel=\"noreferrer\"><code>universeF</code></a> in place of <code>[minBound .. maxBound]</code>.</p>\n"}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 54758818, "answer_count": 1, "score": 1, "last_activity_date": 1550550483, "creation_date": 1550543412, "question_id": 54758033, "link": "https://stackoverflow.com/questions/54758033/how-to-quickcheck-all-possible-cases-for-a-type-that-is-both-enum-and-bounded", "title": "How to quickCheck all possible cases for a type that is both Enum and Bounded?", "body": "<p>I have a <a href=\"http://hackage.haskell.org/package/QuickCheck-2.12.6.1/docs/Test-QuickCheck.html\" rel=\"nofollow noreferrer\">quickCheck</a> property which involves generating elements for a sum type which has only two elements.</p>\n\n<p>Clearly the default number of test cases, 100, is too many for this case, and so I've used <code>withMaxSuccess</code> to reduce the number of cases to 3. This runs quickly but is not ideal for two reasons. Firstly, the three test cases run are more than the two required. And secondly, the three cases are not comprehensive due to the 1-in-4 chance that all three involve the same element, to the exclusion of the other one.</p>\n\n<p>I have tried QuickCheck's <code>forAll</code> modifier, which seemed like it might do what I am looking for, but the number of test cases run was still 100.</p>\n\n<p>If I have a type with a finite number of elements to be the generator for a QuickCheck test, is there a way to set QuickCheck to test the property comprehensively over the type by running it with each element once?</p>\n\n<p>To qualify whether the type has a finite number of elements, perhaps it can be qualified by both the <code>Enum</code> and <code>Bounded</code> typeclasses.</p>\n"}, {"tags": ["haskell", "modulo"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1550537980, "post_id": 54757365, "comment_id": 96296325, "body": "Show an example of its use. I don&#39;t remember any uses for it offhand, but it&#39;s very possible to make your own definition of it, so libraries may define it."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1550538204, "post_id": 54757365, "comment_id": 96296375, "body": "it&#39;s in <code>Data.Ratio</code>, see here: <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Ratio.html#v:-37-\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/&hellip;</a> (Unless of course there is another definition of <code>%</code> in another library, as is entirely possible.)"}], "answers": [{"tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": false, "score": 2, "last_activity_date": 1550538250, "creation_date": 1550538250, "answer_id": 54757493, "question_id": 54757365, "link": "https://stackoverflow.com/questions/54757365/what-does-do-in-haskell/54757493#54757493", "title": "What does % do in Haskell?", "body": "<p><a href=\"https://www.stackage.org/lts-13.8/hoogle?q=(%25)\" rel=\"nofollow noreferrer\">Searching for <code>(%)</code> on Stackage Hoogle</a>, it appears that <code>Data.Ratio</code> defines the <code>%</code> operator as constructing a <code>Ratio</code> value from a numerator and denominator. A GHCi example:</p>\n\n<pre><code>Prelude&gt; :m + Data.Ratio\nPrelude Data.Ratio&gt; let x = 1 % 2\nPrelude Data.Ratio&gt; x\n1 % 2\nPrelude Data.Ratio&gt; :t x\nx :: Integral a =&gt; Ratio a\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1102, "user_id": 1710956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba96169513e96916e3ddc6e6fc9919a?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/1710956/ryan"}, "edited": false, "score": 0, "creation_date": 1550787765, "post_id": 54757501, "comment_id": 96410577, "body": "Never heard of Hoogle. I am new to Haskell. I searched via DDGo, and not one article mentioned Data.Ratio. This resource was not included in general search results. See: <a href=\"https://duckduckgo.com/?q=operator+haskell&amp;t=ffab&amp;atb=v155-6&amp;ia=software\" rel=\"nofollow noreferrer\">duckduckgo.com/&hellip;</a>"}, {"owner": {"reputation": 1102, "user_id": 1710956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba96169513e96916e3ddc6e6fc9919a?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/1710956/ryan"}, "edited": false, "score": 0, "creation_date": 1550787842, "post_id": 54757501, "comment_id": 96410607, "body": "Is there a way to look up those type definitions for Data.Ratio in GHCi/Prelude? I already tried <code>:t %</code> to no avail"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 1102, "user_id": 1710956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba96169513e96916e3ddc6e6fc9919a?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/1710956/ryan"}, "edited": false, "score": 1, "creation_date": 1550788767, "post_id": 54757501, "comment_id": 96410928, "body": "@Ryan, Hoogle at <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">haskell.org/hoogle</a> is a search engine for Haskell libraries. you can reach it at that link and you can then search for any function, some function description and -- the most important -- function types. As I said, <code>%</code> is part of the <code>Data.Ratio</code> library, so before you can use it in the GHCi -- including <code>:t</code>, you need to import it by <code>import Data.Ratio</code>. Then you can see the type. Remember also you can use <code>:info</code> that sometimes gives you more info than just <code>:t</code>"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": false, "score": 12, "last_activity_date": 1551304406, "last_edit_date": 1551304406, "creation_date": 1550538337, "answer_id": 54757501, "question_id": 54757365, "link": "https://stackoverflow.com/questions/54757365/what-does-do-in-haskell/54757501#54757501", "title": "What does % do in Haskell?", "body": "<p>With a quick look on <a href=\"https://www.haskell.org/hoogle/?hoogle=%25\" rel=\"nofollow noreferrer\">Hoogle</a>, you can see that <code>%</code> is an infix function defined as</p>\n\n<pre><code>(%) :: Integral a =&gt; a -&gt; a -&gt; Ratio a\n</code></pre>\n\n<p>and as you can guess it is part of the <code>Data.Ratio</code> library, which mostly deals with ratios (i.e.: fractions). It is code is</p>\n\n<pre><code>x % y = reduce (x * signum y) (abs y)\n</code></pre>\n\n<p>thus given two integrals (x,y) , it returns an irreducible fraction x/y</p>\n"}, {"tags": [], "owner": {"reputation": 1069, "user_id": 4299824, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LKWkrlvV9UE/AAAAAAAAAAI/AAAAAAAABYQ/OWKjHFpdGGs/photo.jpg?sz=128", "display_name": "YAMAMOTO Yuji", "link": "https://stackoverflow.com/users/4299824/yamamoto-yuji"}, "is_accepted": true, "score": 6, "last_activity_date": 1550823612, "last_edit_date": 1550823612, "creation_date": 1550538971, "answer_id": 54757566, "question_id": 54757365, "link": "https://stackoverflow.com/questions/54757365/what-does-do-in-haskell/54757566#54757566", "title": "What does % do in Haskell?", "body": "<p>In Haskell, we can define binary operators with various symbols (including <code>%</code>) like ordinary functions, So you can define <code>%</code> as an arbitrary operator you want (in the module which you define it).</p>\n\n<p>As the most typical case, <code>%</code> is provided as the constructor of the <code>Ratio</code> type by <a href=\"https://www.stackage.org/haddock/lts-13.8/base-4.12.0.0/Data-Ratio.html\" rel=\"nofollow noreferrer\">Data.Ratio module</a>.</p>\n\n<p>Try the code below on GHCi to make sure that <code>%</code> is provided by <code>Data.Ratio</code>:</p>\n\n<pre><code>ghci&gt; 3 % 9\n\n&lt;interactive&gt;:1:3: error:\n    Variable not in scope: (%) :: Integer -&gt; Integer -&gt; t\nghci&gt; import Data.Ratio\nghci&gt; 3 % 9\n1 % 3\n</code></pre>\n\n<p>And remember you can search such operators and functions in these search engines:</p>\n\n<ul>\n<li><a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">https://www.haskell.org/hoogle/</a></li>\n<li><a href=\"https://www.stackage.org/\" rel=\"nofollow noreferrer\">https://www.stackage.org/</a></li>\n</ul>\n\n<p>Actually I've looked up how <code>%</code> is defined by <a href=\"https://www.haskell.org/hoogle/?hoogle=%25\" rel=\"nofollow noreferrer\">Hoogle</a>.</p>\n\n<p>% is an infix function defined as</p>\n\n<pre><code>(%) :: Integral a =&gt; a -&gt; a -&gt; Ratio a\n</code></pre>\n\n<p>and from the type definition above, you can see that it is part of the <code>Data.Ratio</code> library, which mostly deals with ratios (i.e.: fractions). Its code is</p>\n\n<pre><code>x % y = reduce (x * signum y) (abs y)\n</code></pre>\n\n<p>thus given two integrals (x,y) , it returns an irreducible fraction x/y</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1550625156, "post_id": 54768325, "comment_id": 96334184, "body": "There&#39;s also a nice version (I think maybe in Python?) that guarantees a positive result regardless of the signs of the operands, as well as guaranteeing <code>q * n + r = m</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1550626630, "post_id": 54768325, "comment_id": 96334518, "body": "Python <code>%</code> is Haskell <code>mod</code>, I believe."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1550627999, "post_id": 54768325, "comment_id": 96334836, "body": "Huh. Got that wrong. R6RS Scheme&#39;s <code>mod</code> does it &quot;Euclidean style&quot;, as does PureScript (which used to do it Knuth style but switched)."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1550602367, "last_edit_date": 1550602367, "creation_date": 1550585736, "answer_id": 54768325, "question_id": 54757365, "link": "https://stackoverflow.com/questions/54757365/what-does-do-in-haskell/54768325#54768325", "title": "What does % do in Haskell?", "body": "<p><code>Data.Ratio</code> uses <code>%</code> as a constructor, but unless that type was defined before the <code>Integral</code> type class, it doesn't explain why <code>%</code> was <em>available</em> for use by <code>Data.Ratio</code>. (Of course, qualified imports allow you to use the same operator name in multiple modules, so either way, <code>%</code> being used by <code>Data.Ratio</code> isn't really a reason.)</p>\n\n<p>Note, however, that <code>Integral</code> defines <a href=\"https://stackoverflow.com/questions/5891140/difference-between-mod-and-rem-in-haskell\">both <code>mod</code> and <code>rem</code> functions</a>. I suspect that <code>%</code> was intentionally left out of <code>Integral</code>, both to avoid 1) making a choice as to whether it should be an alias for <code>mod</code> or <code>rem</code>, as well as 2) making people remember which choice was made.</p>\n\n<p>Also, <a href=\"https://stackoverflow.com/questions/1907565/c-and-python-different-behaviour-of-the-modulo-operation\">languages use different definitions for <code>%</code></a>, so either <code>(%) = mod</code> or <code>(%) = rem</code> had the potential for confusing <em>someone</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 1649, "user_id": 2394634, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/GhVqX.jpg?s=128&g=1", "display_name": "147pm", "link": "https://stackoverflow.com/users/2394634/147pm"}, "is_accepted": false, "score": 0, "last_activity_date": 1614405935, "creation_date": 1614405935, "answer_id": 66396075, "question_id": 54757365, "link": "https://stackoverflow.com/questions/54757365/what-does-do-in-haskell/66396075#66396075", "title": "What does % do in Haskell?", "body": "<p>Found this in &quot;Old School&quot; Davies <em>Introduction to Functional Programming Systems Using Haskell</em>. (He constantly compares Haskell to Pascal.) It's a simulation of stack arithmetic</p>\n<pre><code>type Stack = [Float]\n\npush :: Float -&gt; Stack -&gt; Stack\npush x stack = x : stack\n\naddStack :: Stack -&gt; Stack\naddStack (x:y:stack) = (y + x) : stack\n\nsubtStack :: Stack -&gt; Stack\nsubtStack (x:y:stack) = (y - x) : stack\n\nmultStack :: Stack -&gt; Stack\nmultStack  (x:y:stack) = (y * x) : stack\n\ndivStack :: Stack -&gt; Stack\ndivStack  (x:y:stack) = (y / x) : stack\n\nemptyStack :: Stack\nemptyStack = []\n\npopStack :: Stack -&gt; (Float, Stack)\npopStack (top:rest) = (top,rest)\n</code></pre>\n<p>Then</p>\n<pre><code>let f % g     = g . f\n    actionsOn = push 12.2 %\n                push 7.1 %\n                push 6.7 %\n                divStack %\n                push 4.3 %\n                subtStack %\n                multStack %\n                push 2.2 %\n                addStack\nin popStack (actionsOn emptyStack)\n\n(-37.331642,[])\n</code></pre>\n<p>This is just a neater version of a crazy-looking nested function</p>\n<pre><code>popStack (addStack (push 2.2 (multStack (subtStack (push 4.3 (divStack (push 6.7 (push 7.1 (push 12.2 emptyStack)))))))))\n</code></pre>\n<p>which itself avoids creating and passing a new stack for each stack operation. In summary, what YAMAMOTO Yuji says right at the beginning is applicable here and not really any <code>Ratio</code> stuff AFAIK.</p>\n"}], "owner": {"reputation": 1102, "user_id": 1710956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba96169513e96916e3ddc6e6fc9919a?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/1710956/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2022, "favorite_count": 1, "accepted_answer_id": 54757566, "answer_count": 5, "score": 1, "last_activity_date": 1614405935, "creation_date": 1550537067, "question_id": 54757365, "link": "https://stackoverflow.com/questions/54757365/what-does-do-in-haskell", "title": "What does % do in Haskell?", "body": "<p>I'm used to using % to mean \"modulo\" in other languages. In Haskell, we have to use <code>mod x y</code> or <code>x `mod` y</code>. So, what is this symbol used for in Haskell?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1550528631, "post_id": 54756227, "comment_id": 96293978, "body": "<code>yesno</code> has type <code>(YesNo a) =&gt; a -&gt; Bool</code>. Have you tried to type all this at the prompt? I&#39;d recommend saving it as a file and loading it from the file. (Although the bodies of those <code>class</code> and <code>instance</code> declarations need to be indented.)"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550529157, "post_id": 54756227, "comment_id": 96294152, "body": "@Robin Zigmond: Ah yes, they were indented in the file. Adding the constraint <code>(YesNo a) =&gt;</code> doesn&#39;t seem to work (I still get <code>&lt;interactive&gt;:14:1: error:     Variable not in scope</code> when asking for the type of <code>yesno</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1550529325, "post_id": 54756227, "comment_id": 96294213, "body": "no, you don&#39;t need to put the constraint in your file - I was just saying that&#39;s what the reported type should be. Let me try it now, I think you must be doing something wrong but I can&#39;t say for sure until I&#39;ve tried myself."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 5, "creation_date": 1550529448, "post_id": 54756227, "comment_id": 96294245, "body": "well it works fine for me, I copied your code, loaded it into GHCI, put in <code>:t yesno</code>, and as expected got the output <code>yesno :: YesNo a =&gt; a -&gt; Bool</code>. Can you describe <i>exactly</i> what you&#39;re doing, perhaps with a screenshot?"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550529886, "post_id": 54756227, "comment_id": 96294378, "body": "@Robin Zigmond: I have exactly the code in my question in a file which I have been loading successfully. I load it, and receive the error I mentioned."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 2, "creation_date": 1550530162, "post_id": 54756227, "comment_id": 96294469, "body": "@user65526 After your edit, your code doesn&#39;t compile anymore. So if you were really loading a file with those contents, you&#39;d be getting an error message. If you were loading a file with the code before the edit (i.e. without the <code>(YesNo a) =&gt;</code>), you would be getting no errors, but you wouldn&#39;t be getting any messages about &quot;Compiling Geometry&quot; or &quot;Compiling Shape&quot; as those modules aren&#39;t mentioned anywhere in the code. In other words: you&#39;re not loading the file that contains the code from your question - you&#39;re loading some other file."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1550530597, "post_id": 54756227, "comment_id": 96294625, "body": "@sepp2k, in my file I have <code>import Geometry</code> and <code>import Shapes</code> (corresponding to two separate files I have been using successfully until now) which is why I am getting the messages about &quot;Compiling Geometry&quot;, etc, just as I wish to. If I get rid of the suggested class constraint <code>(YesNot a) =&gt;</code> I still get the error report."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1550530719, "post_id": 54756227, "comment_id": 96294661, "body": "@user65526 - <code>(YesNo a) =&gt;</code> was not a &quot;suggested class constraint&quot;. I was merely trying to point out what the inferred type of the <code>yesno</code> function would be (and indeed is). That should NOT go in your file anywhere, and to avoid all possible doubt, I wasn&#39;t trying to tell you to add it :)"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1550530815, "post_id": 54756227, "comment_id": 96294692, "body": "by the way, now that we know you&#39;re importing other files, I think we need to see more. You&#39;ve clearly got <code>import</code>s in your file, perhaps you have <code>export</code>s too and aren&#39;t exporting <code>yesno</code>?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 5, "creation_date": 1550530815, "post_id": 54756227, "comment_id": 96294693, "body": "Please show us the actual contents of the file you&#39;re loading or, even better, try to load a file that actually contains exactly the code in your question (without the <code>(YesNo a) =&gt;</code>) and nothing else. Then when you realize that it works perfectly fine with that file, try to figure out what&#39;s different about your <code>experiment</code> file."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550531554, "post_id": 54756227, "comment_id": 96294920, "body": "@RobinZigmond Exports don&#39;t matter when loading a file with <code>:l</code>. That is, even if a definition isn&#39;t exported, you can still access in GHCi when loading the file with <code>:l</code>. So the issue must be something else. I&#39;m still not convinced that OP isn&#39;t just loading the wrong file (especially since there apparently was no compilation error when OP tried the version with the added constraint in it)."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1550531583, "post_id": 54756227, "comment_id": 96294929, "body": "@sepp2k: The code works when I load it at the prompt. So I suppose it must be something in the file <code>experiment.hs</code>"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1550531651, "post_id": 54756227, "comment_id": 96294951, "body": "@sepp2k: there was a compilation error when I loaded with the additional constraint. The same error I get when loading without the constraint."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1550532197, "post_id": 54756227, "comment_id": 96295098, "body": "@sepp2k - thanks for the explanation, I wasn&#39;t sure"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1550535639, "post_id": 54756227, "comment_id": 96295881, "body": "If it says &quot;Ok, three modules loaded&quot;, that means there was no compilation error when loading the file. If there was a different message, you need to tell us that. But according to the GHCi output you posted in the question, the file compiled without errors."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1550535913, "post_id": 54756227, "comment_id": 96295942, "body": "@sepp2k: Yes, it loads. But then <code>:t yesno</code> produces <code>&lt;interactive&gt;:1:1: error: Variable not in scope: yesno</code>"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 2, "creation_date": 1550536434, "post_id": 54756227, "comment_id": 96296040, "body": "I know that. I&#39;m saying that it still loaded when you put an actual error in the file. If there&#39;s an error in the file, it shouldn&#39;t load. I therefore concluded that you&#39;re loading a different file than the one you&#39;re editing."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550561390, "post_id": 54756227, "comment_id": 96302394, "body": "@user65526 did you get this sorted? I must admit I&#39;m kind of intrigued as to what you were doing wrong. If you didn&#39;t figure it out yet, edit the question with the complete contents of your <code>experiment.hs</code> so we can see exactly what you&#39;re working with."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550561925, "post_id": 54756227, "comment_id": 96302624, "body": "@Robin Zigmond: It works now. I think I was loading a different file. However, I find it mystifying since the files seem to have the same content."}], "owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1550530496, "creation_date": 1550528450, "last_edit_date": 1550530496, "question_id": 54756227, "link": "https://stackoverflow.com/questions/54756227/defining-a-data-type", "title": "Defining a data type", "body": "<p>What sort of data type do I need in order for these class declarations to work?</p>\n\n<pre><code>class YesNo a where\n   yesno :: a -&gt; Bool\n\ninstance YesNo Int where\n   yesno 0 = False\n   yesno _ = True\n\ninstance YesNo [a] where\n   yesno [] = False\n   yesno _ = True\n\ninstance YesNo Bool where\n   yesno = id\n\ninstance YesNo (Maybe a) where\n   yesno (Just _) = True\n   yesno Nothing = False\n</code></pre>\n\n<p>At the moment <code>*Main&gt; :t yesno</code> produces <code>&lt;interactive&gt;:1:1: error: Variable not in scope: yesno</code>, presumably because I need to define an appropriate data type.</p>\n\n<p>It was suggested I add the constraint <code>(YesNo a) =&gt;</code> to the type of <code>yesno</code> doesn't seem to work (I still get <code>&lt;interactive&gt;:14:1: error: Variable not in scope</code> when asking for the type of <code>yesno</code>:</p>\n\n<pre><code>  *Main&gt; :l experiment\n  [1 of 3] Compiling Geometry         ( Geometry.hs, interpreted )\n  [2 of 3] Compiling Shapes           ( Shapes.hs, interpreted )\n  [3 of 3] Compiling Main             ( experiment.hs, interpreted )\n  Ok, three modules loaded.\n  *Main&gt; :t yesno\n\n&lt;interactive&gt;:1:1: error: Variable not in scope: yesno\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550535182, "post_id": 54755319, "comment_id": 96295790, "body": "Where have you seen these other code examples?"}, {"owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550544732, "post_id": 54755319, "comment_id": 96297682, "body": "I am actually trying to use some code from this library <a href=\"http://hackage.haskell.org/package/cryptonite-0.25/docs/src/Crypto-PubKey-RSA-PKCS15.html#HashAlgorithmASN1\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/cryptonite-0.25/docs/src/&hellip;</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550549907, "post_id": 54755319, "comment_id": 96298711, "body": "Right. So packages are allowed to use their own hidden internal modules, but nobody else is. Sorry. Find another way."}], "answers": [{"comments": [{"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1580826899, "post_id": 54755511, "comment_id": 106220446, "body": "I will say, I sometimes question the principle, or at least what some authors decide to stick in there. More than once I&#39;ve had to copy and paste some internal module code, which is really not ideal due to possible version changes in the dependency not lining up well with the pasted code (though types would catch most issues)."}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": false, "score": 2, "last_activity_date": 1551305048, "last_edit_date": 1551305048, "creation_date": 1550524708, "answer_id": 54755511, "question_id": 54755319, "link": "https://stackoverflow.com/questions/54755319/how-to-use-hidden-modules-in-haskell/54755511#54755511", "title": "How to use hidden modules in haskell", "body": "<p>As per <a href=\"https://ghc.readthedocs.io/en/8.0.2/packages.html\" rel=\"nofollow noreferrer\">GHC Docs</a>, hidden modules </p>\n\n<blockquote>\n  <p>\"cannot be imported, but they are still subject to the overlapping\n  constraint: no other package in the same program may provide a module\n  of the same name.\"</p>\n</blockquote>\n"}], "owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1551305048, "creation_date": 1550523853, "question_id": 54755319, "link": "https://stackoverflow.com/questions/54755319/how-to-use-hidden-modules-in-haskell", "title": "How to use hidden modules in haskell", "body": "<p>I am trying to import ByteArray ,from the Cryptonite library.\nMy cabal file has cryptonite in the Build depends ,and my import statement looks like this</p>\n\n<pre><code>import Crypto.Internal.ByteArray (ByteArray, Bytes)\nimport qualified Crypto.Internal.ByteArray as B\n</code></pre>\n\n<p>The error I get is \nCould not load module \u2018Crypto.Internal.ByteArray\u2019\n    it is a hidden module in the package \u2018cryptonite-0.25\u2019\nI have seen other code examples which use this specific import statement ,what am I missing here?</p>\n"}, {"tags": ["haskell", "classy-prelude"], "answers": [{"tags": [], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "is_accepted": false, "score": 1, "last_activity_date": 1550542234, "creation_date": 1550542234, "answer_id": 54757901, "question_id": 54755020, "link": "https://stackoverflow.com/questions/54755020/how-to-log-all-exceptions-in-haskell/54757901#54757901", "title": "How to log all exceptions in Haskell?", "body": "<p>I now understand my issue was that a concrete type was needed for the <code>Exception</code> argument, since it is a polymorphic function as stated in my question, and there is no call site to narrow this down to a specific type. The right answer is described in <em>Catch 'em all!</em> <a href=\"https://www.fpcomplete.com/blog/2018/04/async-exception-handling-haskell\" rel=\"nofollow noreferrer\">here</a>, and it is to use the concrete <code>SomeException</code> type.  The resulting code is:</p>\n\n<pre><code>logExceptions :: MonadUnliftIO m =&gt; Logger -&gt; m a -&gt; m a\nlogExceptions logger program = withException program logEx\n  where\n    logEx :: MonadUnliftIO m =&gt; SomeException -&gt; m ()\n    logEx ex = do\n      logIt Warn logger [\"Logging exception: \", (show ex)]\n      flush logger\n</code></pre>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1550587728, "creation_date": 1550522339, "last_edit_date": 1550587728, "question_id": 54755020, "link": "https://stackoverflow.com/questions/54755020/how-to-log-all-exceptions-in-haskell", "title": "How to log all exceptions in Haskell?", "body": "<p><strong>Original Title</strong>: <em>How to deal with multiple instances of Exception types when inspecting all Exceptions?</em></p>\n\n<p>I have the following imports (note my prelude is actually ClassyPrelude, which uses <a href=\"https://hackage.haskell.org/package/unliftio-0.2.10/docs/UnliftIO-Exception.html\" rel=\"nofollow noreferrer\">UnliftIO.Exception</a>). Note that System.Logger is from <a href=\"https://hackage.haskell.org/package/tinylog\" rel=\"nofollow noreferrer\">tinylog</a>, a thin library on top of <a href=\"https://hackage.haskell.org/package/fast-logger\" rel=\"nofollow noreferrer\">fast-logger</a>.</p>\n\n<pre><code>import           Prelude                   hiding(log)\nimport           System.Logger             hiding(log)\nimport qualified System.Logger             as TL\n</code></pre>\n\n<p>And the following function:</p>\n\n<pre><code>logExceptions :: MonadUnliftIO m =&gt; Logger -&gt; m a -&gt; m a\nlogExceptions logger program = withException program\n  (\\ex -&gt; do\n    logIt Warn logger [\"Logging exception: \", (show ex)]\n    flush logger\n    )\n</code></pre>\n\n<p>Putting the lambda into a local function with a type may make it slightly more clear:</p>\n\n<pre><code>logExceptions :: MonadUnliftIO m =&gt; Logger -&gt; m a -&gt; m a\nlogExceptions logger program = withException program logEx\n  where\n    logEx :: (MonadUnliftIO m, Exception e) =&gt; e -&gt; m ()\n    logEx ex = do\n      logIt Warn logger [\"Logging exception: \", (show ex)]\n      flush logger\n</code></pre>\n\n<p>This results in the following compile error:</p>\n\n<pre><code>    * Could not deduce (Exception e0)\n        arising from a use of `withException'\n      from the context: MonadUnliftIO m\n        bound by the type signature for:\n                   logExceptions :: forall (m :: * -&gt; *) a.\n                                    MonadUnliftIO m =&gt;\n                                    Logger -&gt; m a -&gt; m a\n        at src/FDS/Logging.hs:19:1-56\n      The type variable `e0' is ambiguous\n      These potential instances exist:\n        instance Exception SomeException -- Defined in `GHC.Exception.Type'\n        instance Exception IOException -- Defined in `GHC.IO.Exception'\n        instance Exception SomeAsyncException\n          -- Defined in `GHC.IO.Exception'\n        ...plus four others         \n        ...plus 30 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    * In the expression: withException program logEx\n      In an equation for `logExceptions':\n          logExceptions logger program\n            = withException program logEx\n            where                   \n                logEx :: (MonadUnliftIO m, Exception e) =&gt; e -&gt; m ()\n                logEx ex            \n                  = do logIt Warn logger ...\n                       ....         \n   |                                \n20 | logExceptions logger program = withException program logEx\n   |         \n</code></pre>\n\n<p>The most worrisome bit is the <code>plus 30 instances involving out-of-scope types</code>. I could hide these imports to slightly improve the situation:</p>\n\n<pre><code>import           GHC.Exception.Type        hiding(SomeException)\nimport           GHC.IO.Exception          hiding(IOException, SomeAsyncException)\n</code></pre>\n\n<p>But it hardly seems reasonable to go through and find all 30+ exception types and mask them all out in this fashion. I assume I'm doing something quite wrong here, or do I really need to go through and mask everything?</p>\n\n<p><strong>Note</strong>:</p>\n\n<ol>\n<li>My <code>logIt</code> function is just a thin wrapper around the <code>log</code> function from tinylog - feel free to substitute with whatever feels ergonomic.</li>\n</ol>\n"}, {"tags": ["haskell", "dfa"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1550521750, "post_id": 54754856, "comment_id": 96291357, "body": "<i>I am just struggling with my code in particular.</i> You need to be more specific about what you&#39;re struggling with."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1550521904, "post_id": 54754856, "comment_id": 96291415, "body": "Exactly what problem are you having with your code? Are you getting an error message, or just wrong results?"}, {"owner": {"reputation": 31, "user_id": 11025683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa2835694712982b8dbc10f2e153137?s=128&d=identicon&r=PG&f=1", "display_name": "LHM", "link": "https://stackoverflow.com/users/11025683/lhm"}, "edited": false, "score": 0, "creation_date": 1550521925, "post_id": 54754856, "comment_id": 96291428, "body": "Thank you, I just edited my post to specify what I am having a hard time with."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1550521930, "post_id": 54754856, "comment_id": 96291432, "body": "That was a quick edit! You answered my question before I asked it!"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1550522059, "post_id": 54754856, "comment_id": 96291494, "body": "Side note: I believe your <code>deltaStar</code> is a re-implementation of <code>foldl</code>."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1550522163, "post_id": 54754856, "comment_id": 96291538, "body": "@LHM Thanks for clarifying. Pro Stack-Overflow tip: you can use backticks to format inline code, as I did in my edit."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1550522172, "post_id": 54754856, "comment_id": 96291542, "body": "I&#39;ve just copied and pasted your code into GHCi and I&#39;m surprised it even compiles - your indentation is all wrong. When you have a set of statement in e.g. a <code>where</code> or <code>let</code> block, they need to be indented to the same level."}, {"owner": {"reputation": 31, "user_id": 11025683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa2835694712982b8dbc10f2e153137?s=128&d=identicon&r=PG&f=1", "display_name": "LHM", "link": "https://stackoverflow.com/users/11025683/lhm"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1550522453, "post_id": 54754856, "comment_id": 96291679, "body": "@bradrn should I chance the deltaStart to foldl then? also I edited the code so that they are inline, is this how it should be formatted?"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1550522502, "post_id": 54754856, "comment_id": 96291702, "body": "@LHM Just remove the definition of <code>deltaStar</code> (in <code>extendDelta</code>) and replace its usage with <code>foldl</code>."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1550522546, "post_id": 54754856, "comment_id": 96291726, "body": "@LHM I&#39;ve been having a look at your code and I believe that <code>dfaAccept dfaFactory &quot;&quot;</code> should be <code>True</code>, not <code>False</code>, since your DFA starts in state <code>1</code>, which is also an accepting state."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1550522744, "post_id": 54754856, "comment_id": 96291800, "body": "You should start learning how to debug your Haskell code. <a href=\"https://downloads.haskell.org/~ghc/7.4.1/docs/html/users_guide/ghci-debugger.html\" rel=\"nofollow noreferrer\">This doc</a> is a good place to start."}, {"owner": {"reputation": 31, "user_id": 11025683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa2835694712982b8dbc10f2e153137?s=128&d=identicon&r=PG&f=1", "display_name": "LHM", "link": "https://stackoverflow.com/users/11025683/lhm"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1550522882, "post_id": 54754856, "comment_id": 96291869, "body": "@bradrn thank you, for changing the deltaStar would this be a good way to write it? ***extendDelta delta = deltaStar     where foldl [] = q           foldl q (a:w) = foldl (delta q a) w   *** and for dfaAccept dfaFactory &quot;&quot; if I changed the code to make it false would that then change the other input/outputs?"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1550522896, "post_id": 54754856, "comment_id": 96291877, "body": "@Code-Apprentice Yes, that&#39;s an excellent document. I use <code>trace</code> and (more rarely) GHCi breakpoints particularly often - the latter seems like it could be particularly useful in this situation"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1550522954, "post_id": 54754856, "comment_id": 96291899, "body": "@LHM Yes, that is correct for <code>extendDelta</code>. (It&#39;s not a change in functionality; it&#39;s just a little more compact to use <code>foldl</code>.) I&#39;m not sure what change you&#39;re describing for <code>dfaAccept</code>."}, {"owner": {"reputation": 31, "user_id": 11025683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa2835694712982b8dbc10f2e153137?s=128&d=identicon&r=PG&f=1", "display_name": "LHM", "link": "https://stackoverflow.com/users/11025683/lhm"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1550522982, "post_id": 54754856, "comment_id": 96291911, "body": "@code-Apprentice Thank you! that looks really helpful I am going to go over that now."}, {"owner": {"reputation": 31, "user_id": 11025683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa2835694712982b8dbc10f2e153137?s=128&d=identicon&r=PG&f=1", "display_name": "LHM", "link": "https://stackoverflow.com/users/11025683/lhm"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1550523155, "post_id": 54754856, "comment_id": 96291980, "body": "@bradrn well I am trying to figure out if I should alter the code so that it recognizes the input &quot;&quot; as false and &quot;10.11&quot; as true. As of right now my code is basically doing the opposite of that."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550523387, "post_id": 54754856, "comment_id": 96292066, "body": "Your definition of <code>dfaFactory</code> doesn&#39;t match with the DFA at the beginning of your question at all (not even the same number of states, let alone the other DFA stats being different). Is that on purpose? If not, perhaps that&#39;s one source of your problems."}, {"owner": {"reputation": 31, "user_id": 11025683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa2835694712982b8dbc10f2e153137?s=128&d=identicon&r=PG&f=1", "display_name": "LHM", "link": "https://stackoverflow.com/users/11025683/lhm"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550523590, "post_id": 54754856, "comment_id": 96292137, "body": "@danielWagner that is not on purpose.. Like I said this is all new to me and I started off with a basic/simple approach to see if I could get the code to run. I have never used/written in haskell before. So from here to make sure the two match, I think I have most but for this \ud835\udeff=\u2329\ud835\udc600,0,\ud835\udc601\u232a,\u2329\ud835\udc600,1,\ud835\udc601\u232a,\u2329\ud835\udc600,.,\ud835\udc602\u232a,\u2329\ud835\udc601,0,\ud835\udc601\u232a,\u2329\ud835\udc601,1,\ud835\udc60&zwnj;&#8203;1\u232a, \u2329\ud835\udc601,.,\ud835\udc603\u232a,\u2329\ud835\udc602,0,\ud835\udc603\u232a,\u2329\ud835\udc602,1,\ud835\udc603\u232a,\u2329\ud835\udc602,.,\ud835\udc604\u232a,\u2329\ud835\udc603,0,\ud835\udc603\u232a,&zwnj;&#8203;\u2329\ud835\udc603,1,\ud835\udc603\u232a, \u2329\ud835\udc603,.,\ud835\udc604\u232a\u2329\ud835\udc604,0,\ud835\udc604\u232a,\u2329\ud835\udc604,1,\ud835\udc604\u232a,\u2329\ud835\udc604,.,\ud835\udc604\u232a} how would I demonstrate that?"}], "answers": [{"comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 2, "creation_date": 1550527889, "post_id": 54755763, "comment_id": 96293738, "body": "+1 for a helpful answer. However, I feel compelled to comment on the indentation style... What&#39;s going to happen if <code>dfaFactory</code> is renamed? Will you not be forced to realign the entire <code>where</code> clause according to the length of the new name? If you&#39;re using version control, the diff is going to look massive for a relatively small change. For this reason, I personally favour <a href=\"https://github.com/tibbe/haskell-style-guide/blob/master/haskell-style.md#indentation\" rel=\"nofollow noreferrer\">the style recommended by Johan Tibell</a>. Something to think about."}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1550528344, "post_id": 54755763, "comment_id": 96293896, "body": "@jubobs interesting perspective I had never thought of, I do use version control but I&#39;m just a undergrad so never needed it properly and never noticed the big diff. I&#39;ll read the guide and give it a go"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1550528731, "post_id": 54755763, "comment_id": 96294022, "body": "True, my suggestion may be more relevant if you have collaborators (as opposed to coding alone). Shameless plug, but I once gave a lightning talk in which I briefly mentioned why I think formatting style is worth considering with respect to Git diffs: <a href=\"https://www.youtube.com/watch?v=1mJQdcDi7z0&amp;t=3m25s\" rel=\"nofollow noreferrer\">youtube.com/watch?v=1mJQdcDi7z0&amp;t=3m25s</a> The language used in my example is Java, but my point applies to Haskell nonetheless."}, {"owner": {"reputation": 31, "user_id": 11025683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa2835694712982b8dbc10f2e153137?s=128&d=identicon&r=PG&f=1", "display_name": "LHM", "link": "https://stackoverflow.com/users/11025683/lhm"}, "edited": false, "score": 1, "creation_date": 1550529119, "post_id": 54755763, "comment_id": 96294140, "body": "Thank you this is really helpful!!"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 31, "user_id": 11025683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa2835694712982b8dbc10f2e153137?s=128&d=identicon&r=PG&f=1", "display_name": "LHM", "link": "https://stackoverflow.com/users/11025683/lhm"}, "edited": false, "score": 0, "creation_date": 1550529457, "post_id": 54755763, "comment_id": 96294249, "body": "@LHM You can simplify the delta even more as most jumps are +2, but thats beyond the scope of the answer, plus this way is easier to change if your specifications change"}, {"owner": {"reputation": 31, "user_id": 11025683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa2835694712982b8dbc10f2e153137?s=128&d=identicon&r=PG&f=1", "display_name": "LHM", "link": "https://stackoverflow.com/users/11025683/lhm"}, "edited": false, "score": 0, "creation_date": 1550529700, "post_id": 54755763, "comment_id": 96294322, "body": "@Lorenzo I am just curious but if I wanted to implement tuples and transitions into this code, would this work and how would I go about starting that? I am currently trying to think of a way to show an example but I am blanking at the moment"}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 31, "user_id": 11025683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa2835694712982b8dbc10f2e153137?s=128&d=identicon&r=PG&f=1", "display_name": "LHM", "link": "https://stackoverflow.com/users/11025683/lhm"}, "edited": false, "score": 0, "creation_date": 1550538033, "post_id": 54755763, "comment_id": 96296335, "body": "@LHM What do you mean by tuples and transitions?"}, {"owner": {"reputation": 31, "user_id": 11025683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa2835694712982b8dbc10f2e153137?s=128&d=identicon&r=PG&f=1", "display_name": "LHM", "link": "https://stackoverflow.com/users/11025683/lhm"}, "edited": false, "score": 0, "creation_date": 1550542046, "post_id": 54755763, "comment_id": 96297150, "body": "@Lorenzo So now that I have gotten to this point and I am starting to understand how Haskell works I have to actually implement certain criteria for it to be considered finished... I added the final requirements that I am working towards to my original post... Hopefully I didn&#39;t start off to far from the actual end goal. haha"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 2, "last_activity_date": 1550526769, "last_edit_date": 1550526769, "creation_date": 1550525945, "answer_id": 54755763, "question_id": 54754856, "link": "https://stackoverflow.com/questions/54754856/haskell-program-that-can-handle-any-arbitrary-deterministic-finite-automaton/54755763#54755763", "title": "Haskell program that can handle any arbitrary deterministic finite automaton", "body": "<p>You kind of are on the right track, as in your structure for the DFA is right, however you didn't implement all the specs you were given:</p>\n\n<p>For starter, your DFA should have 5 <strong>states</strong>: <code>states = [0,1,2,3,4]</code></p>\n\n<p>The <strong>alphabet</strong> is right, and so is the <strong>starting state</strong>. However in your specs you can see that the <strong>accepting state</strong> is 3, so you need to put it in your code: <code>fs = [3]</code></p>\n\n<p>Finally your <strong>delta</strong> functions were wrong. Here's what they should be:</p>\n\n<pre><code>delta 0 '0' = 1\ndelta 0 '1' = 1\ndelta 0 '.' = 2\ndelta 1 '0' = 1\ndelta 1 '1' = 1\ndelta 1 '.' = 3\ndelta 2 '0' = 3\ndelta 2 '1' = 3\ndelta 2 '.' = 4\ndelta 3 '0' = 3\ndelta 3 '1' = 3\ndelta 3 '.' = 4\ndelta 4 '0' = 4\ndelta 4 '1' = 4\ndelta 4 '.' = 4\n</code></pre>\n\n<p>Furthermore, you can see that your delta can be easily simplified:\nAn input of 0 or 1 in any state is the same, so you can have that with a simpler pattern matching. Also, 4 is a black-hole state, that is it always maps to itself. So you can rewrite your delta as:</p>\n\n<pre><code>delta 4  _  = 4\ndelta 0 '.' = 2\ndelta 0  _  = 1\ndelta 1 '.' = 3\ndelta 1  _  = 1\ndelta 2 '.' = 4\ndelta 2  _  = 3\ndelta 3 '.' = 4\ndelta 3  _  = 3\n</code></pre>\n\n<p>Also, as others pointed out in the comments, your extendDelta and deltaStar are just a weird way to apply a left fold. <code>fold'</code> is usually better as it does not build up a stack so I'll use that. You need to import it from <code>Data.List</code></p>\n\n<p>So this is your final DFA:</p>\n\n<pre><code>import import Data.List\ntype State = Int\ntype DFA = ([State], [Char], State-&gt;Char-&gt;State, State, [State])\n\n\ndfaFactory :: DFA\ndfaFactory = (states, alphabet, delta, s, fs)\n              where\n                states = [0,1,2,3,4]\n                alphabet= ['1','0','.']\n                s = 0\n                fs = [3]\n                delta 4  _  = 4\n                delta 0 '.' = 2\n                delta 0  _  = 1\n                delta 1 '.' = 3\n                delta 1  _  = 1\n                delta 2 '.' = 4\n                delta 2  _  = 3\n                delta 3 '.' = 4\n                delta 3  _  = 3\n\ndfaAccept :: DFA -&gt; String -&gt; Bool\ndfaAccept (qs,alpha,delta,s,fs) w = finalState `elem` fs\n                                      where\n                                        finalState = foldl' delta s w\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11025683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa2835694712982b8dbc10f2e153137?s=128&d=identicon&r=PG&f=1", "display_name": "LHM", "link": "https://stackoverflow.com/users/11025683/lhm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 1, "accepted_answer_id": 54755763, "answer_count": 1, "score": 2, "last_activity_date": 1550542144, "creation_date": 1550521544, "last_edit_date": 1550542144, "question_id": 54754856, "link": "https://stackoverflow.com/questions/54754856/haskell-program-that-can-handle-any-arbitrary-deterministic-finite-automaton", "title": "Haskell program that can handle any arbitrary deterministic finite automaton", "body": "<pre><code>\ud835\udc44={\ud835\udc600,\ud835\udc601,\ud835\udc602,\ud835\udc603,\ud835\udc604}\n\ud835\udc5e\ud835\udc60=\ud835\udc600 \n\ud835\udc39={\ud835\udc603} \n\ud835\udeff=\u2329\ud835\udc600,0,\ud835\udc601\u232a,\u2329\ud835\udc600,1,\ud835\udc601\u232a,\u2329\ud835\udc600,.,\ud835\udc602\u232a,\u2329\ud835\udc601,0,\ud835\udc601\u232a,\u2329\ud835\udc601,1,\ud835\udc601\u232a,\n\u2329\ud835\udc601,.,\ud835\udc603\u232a,\u2329\ud835\udc602,0,\ud835\udc603\u232a,\u2329\ud835\udc602,1,\ud835\udc603\u232a,\u2329\ud835\udc602,.,\ud835\udc604\u232a,\u2329\ud835\udc603,0,\ud835\udc603\u232a,\u2329\ud835\udc603,1,\ud835\udc603\u232a,\n\u2329\ud835\udc603,.,\ud835\udc604\u232a\u2329\ud835\udc604,0,\ud835\udc604\u232a,\u2329\ud835\udc604,1,\ud835\udc604\u232a,\u2329\ud835\udc604,.,\ud835\udc604\u232a}\n\nWhere \u03a3={0,1,.}.\n</code></pre>\n\n<p>I am working on a Haskell program that can handle any arbitrary deterministic finite automaton based on the above definition. I am supposed to represent each state with its name as a String, represent all states as a list of states, and represent each transition as three tuple and the list of transitions as a list.</p>\n\n<p>I have modified my code and it runs but I can tell that I am not on the right track as far as the requirements go. \nI am very new to Haskell and would greatly appreciate some guidance on how I can make my code better or if I am completely off course with it. I am really trying to understand how it all works; I have gone through many different examples and tutorials but I am just struggling with my code in particular.</p>\n\n<p><strong>Edit</strong>: To be specific, when I input the examples given below I get the correct output except for <code>dfaAccept dfaFactory \"10.11\"</code>. this comes back as false rather than true and <code>dfaAccept dfaFactory \"\"</code> results in true instead of false. I am not seeing where my error is that causes this. Also I want to be sure that my code makes sense in terms of readability.</p>\n\n<pre><code>type State = Int\ntype DFA = ([State], [Char], State-&gt;Char-&gt;State, State, [State])\n\ndfaFactory :: DFA\ndfaFactory = (states, alphabet, delta, s, fs)\n    where states = [1,2,3]\n    alphabet= ['1','0','.']\n    s = 1\n    fs = [1]\n    delta 1 '1' = 2\n    delta 1 '0' = 2\n    delta 1 '.' = 2                        \n    delta 2 '1' = 3\n    delta 2 '0' = 3\n    delta 2 '.' = 3\n    delta 3 '1' = 1\n    delta 3 '0' = 1\n    delta 3 '.' = 1\n\nextendDelta :: (State -&gt; Char -&gt; State) -&gt; (State -&gt; String -&gt; State)\nextendDelta delta = deltaStar\n  where deltaStar q [] = q\n  deltaStar q (a:w) = deltaStar (delta q a) w                        \n\ndfaAccept :: DFA -&gt; String -&gt; Bool\ndfaAccept (qs,alpha,delta,s,fs) w =\n  let deltaStar = extendDelta delta\n  q = deltaStar s w\n  in elem q fs               \n</code></pre>\n\n<p>Sample output would look like this:</p>\n\n<pre><code>Prelude&gt; dfaAccept dfaFactory \u201c\u201d\nFalse\nPrelude&gt; dfaAccept dfaFactory \u201c1\u201d\nFalse\nPrelude&gt; dfaAccept dfaFactory \u201c1.0\u201d\nTrue\nPrelude&gt; dfaAccept dfaFactory \u201c10.11\u201d\nTrue\nPrelude&gt; dfaAccept dfaFactory \u201c10.10.10\u201d\nFalse\n</code></pre>\n\n<p><strong>Edit</strong> I am working towards implementing these final requirements... just not sure how to get there.\na. represent each state with its name as a String\nb. represents all states as a list of states\nc. represent each transition as three tuple and the list of transitions as a list.\na. dfaFactory \u2013 returns a \u201chardcoded\u201d DFA definition (i.e. a four tuple)        b. getStates, getFirstState, getFinalStates, and getTransitions \u2013 take a single DFA argument and return the corresponding component of the DFA.\nc. getFromState, getLabel, and getToState \u2013 take a single transition argument and return the corresponding component of the transition\nd. matchTransition \u2013 takes a state, a input character, and a transition and returns True, if the given state and input matches the from state and label of the given transition\ne. findNextState \u2013 takes a DFA, an input character, and a current state and returns the state in the DFA based on this input and state.\nf. dfaAccept \u2013 takes a DFA and an input String and returns True if the DFA accepts the input and False otherwise. Use this to call the dfaAccept1 helper function\ng. dfaAccept1 \u2013 takes an input string, a current state, and a DFA. Decompose the input string one character at a time, don\u2019t match the entire string since your solution must work for any DFA). This is a recursive function with a base and recursive case.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1550514091, "post_id": 54753120, "comment_id": 96288324, "body": "I don&#39;t have time now for a detailed answer (being on phone doesn&#39;t help), but most of those things you&#39;ve asked about are simply types which you pass values of to the constructor. For example <code>Universe</code> is a constructor function that takes a list of <code>a</code>s, a single <code>a</code> and another list, and produces a <code>Universe a</code> value. And all <code>Universe a</code> values can be made this way. For definitions with the pipe character, the pipe separates different constructors which can make those values. Haskell keeps track of which constructor was used for each value, and can for example pattern match on it."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1550514415, "post_id": 54753120, "comment_id": 96288468, "body": "There are too many unrelated questions in this post."}, {"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 2, "creation_date": 1550514582, "post_id": 54753120, "comment_id": 96288546, "body": "<a href=\"https://en.wikibooks.org/wiki/Haskell/Type_declarations\" rel=\"nofollow noreferrer\">This</a> and <a href=\"https://en.wikibooks.org/wiki/Haskell/More_on_datatypes\" rel=\"nofollow noreferrer\">this</a> should probably help (or any other Haskell tutorial, really)."}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1550515609, "post_id": 54753491, "comment_id": 96288984, "body": "<code>Universe [a] a [a]</code> sure looks like a list <a href=\"https://wiki.haskell.org/Zipper\" rel=\"nofollow noreferrer\">zipper</a>, that is, a list with a &quot;focused element&quot;.  The name isn&#39;t evocative of it but that pattern is very familiar: elements to the left, focused element, elements to the right."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550532236, "post_id": 54753491, "comment_id": 96295111, "body": "@luqui I&#39;ve used <code>Universe</code> and relatives a lot recently. The idea is that if you have a cellular automaton operating on a 1D universe, you can represent that as a list zipper. This construction is <i>extremely</i> useful with comonads; see e.g. <a href=\"https://kukuruku.co/post/cellular-automata-using-comonads/\" rel=\"nofollow noreferrer\">kukuruku.co/post/cellular-automata-using-comonads</a> for more information."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1550533350, "post_id": 54753491, "comment_id": 96295372, "body": "@bradrn oh yeah, I read dan piponi&#39;s original about that.  It&#39;s really cool."}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 7, "last_activity_date": 1551304557, "last_edit_date": 1551304557, "creation_date": 1550515254, "answer_id": 54753491, "question_id": 54753120, "link": "https://stackoverflow.com/questions/54753120/how-some-of-these-data-definitions-in-haskell-get-evaluated/54753491#54753491", "title": "How some of these `data` definitions in Haskell get evaluated", "body": "<h1>Algebraic Data Types</h1>\n\n<p>Algebraic data types are what you want to look at, and they can be used to define data such as trees, algebraic expressions and parsing instructions.</p>\n\n<ul>\n<li><strong><code>data Universe a = Universe [a] a [a]</code></strong></li>\n</ul>\n\n<p>This defines a new data type Universe that holds data of type <code>a</code> (this can be any type) and you construct with a list, an element, and another list. It does not say much as is, and I can't come up with an example as to when you'd use it, but if you have one I can explain it to you. (EDIT: Look at first comment) It is important to note that you can do pattern matching with it, so you could have a function such as:</p>\n\n<pre><code>    f :: Universe a        -&gt; a\n    f (Universe _ 0 _)      = 0\n    f (Universe (x:xs) z ys = x\n</code></pre>\n\n<ul>\n<li><strong><code>data BExpr = BoolConst Bool\n       | Not BExpr\n       | BBinary BBinOp BExpr BExpr\n       | RBinary RBinOp AExpr AExpr\n</code></strong></li>\n</ul>\n\n<p>This again defines a new data type that is recursive and it's of the most used type. The pipe <code>|</code> constructor means \"or\", in the sense that your type BExpr can either be:</p>\n\n<ul>\n<li><code>BoolConst Bool</code> : a boolean constant (True/False), defined in some other type</li>\n<li><code>Not BExpr</code> : a negation of another expression</li>\n<li>Some other expression containing an operator and two expressions to apply it to</li>\n</ul>\n\n<p>For a simpler example, think of</p>\n\n<pre><code>Data Tree a = Leaf a | Node (Tree a) a (Tree a)\n</code></pre>\n\n<p>This is how most trees are defined: your data can either be a Leaf, or a node containing two trees and some data.</p>\n\n<p>Look at these two links for more info:\n<a href=\"https://wiki.haskell.org/Algebraic_data_type\" rel=\"nofollow noreferrer\">Haskell Wiki: Algebraic data type</a>\n<a href=\"https://www.schoolofhaskell.com/school/starting-with-haskell/introduction-to-haskell/2-algebraic-data-types\" rel=\"nofollow noreferrer\">School of Haskell: Evaluating Data Types</a></p>\n\n<ul>\n<li><code>data Digraph a = DG [a] [(a,a)] deriving (Eq,Ord,Show)</code>\nThis is exactly the same as the <code>Universe a</code>, It holds some data and it is constructed giving it a list of <code>[a]</code> and a list of tuples <code>(a,a)</code>. Again, you can use pattern matching.</li>\n</ul>\n\n<p>For the last one, again they're different ways to call a constructor for that type</p>\n"}], "owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 54753491, "answer_count": 1, "score": 1, "last_activity_date": 1551304557, "creation_date": 1550513573, "question_id": 54753120, "link": "https://stackoverflow.com/questions/54753120/how-some-of-these-data-definitions-in-haskell-get-evaluated", "title": "How some of these `data` definitions in Haskell get evaluated", "body": "<p>I'm looking at some examples to see how more complex <code>data</code> definitions work, such as these....</p>\n\n<pre><code>data DualMap a b = DualMap (Map a b) (Map b a)\ndata Store s a = Store (s -&gt; a) s deriving Functor\ndata Fold a b = forall x . Fold (x -&gt; a -&gt; x) x (x -&gt; b)\ndata Pair a b = Pair !a !b\ntype Rule m a = (m -&gt; a) -&gt; a\ndata RingZipper a = RingZipper {\n    before :: V.Vector a,\n    focus  :: a,\n    after  :: V.Vector a\n} deriving(Eq, Generic, NFData)\n</code></pre>\n\n<p>I have a few quick questions on some of them.</p>\n\n<p>First, the meaning of <code>[a] a [a]</code> here:</p>\n\n<pre><code>data Universe a = Universe [a] a [a]\n</code></pre>\n\n<p>Next, not sure how the following works. It seems to say create a list out of all the same elements in a strange way. By that I mean I don't understand what it means to pass in <code>BExpr</code>.</p>\n\n<pre><code>data BExpr = BoolConst Bool\n           | Not BExpr\n           | BBinary BBinOp BExpr BExpr\n           | RBinary RBinOp AExpr AExpr\n</code></pre>\n\n<p>That was from <a href=\"https://wiki.haskell.org/Parsing_a_simple_imperative_language\" rel=\"nofollow noreferrer\">this</a>.</p>\n\n<p>Next, wondering what <code>[a] [(a,a)]</code> means in <a href=\"http://hackage.haskell.org/package/HaskellForMaths-0.4.9/docs/src/Math.Algebra.Group.CayleyGraph.html#Digraph\" rel=\"nofollow noreferrer\">here</a>, or how it gets resolved.</p>\n\n<pre><code>data Digraph a = DG [a] [(a,a)] deriving (Eq,Ord,Show)\n</code></pre>\n\n<p>Some others I don't have questions on...</p>\n\n<pre><code>type Monomial coefficient exponent  = (coefficient, exponent)\n</code></pre>\n\n<p><a href=\"https://github.com/dmjio/miso/blob/master/src/Miso/Router.hs\" rel=\"nofollow noreferrer\">https://github.com/dmjio/miso/blob/master/src/Miso/Router.hs</a></p>\n\n<pre><code>data Router a where\n  RChoice       :: Router a -&gt; Router a -&gt; Router a\n  RCapture      :: FromHttpApiData x =&gt; (x -&gt; Router a) -&gt; Router a\n  RQueryParam   :: (FromHttpApiData x, KnownSymbol sym)\n                   =&gt; Proxy sym -&gt; (Maybe x -&gt; Router a) -&gt; Router a\n  RQueryParams  :: (FromHttpApiData x, KnownSymbol sym)\n                   =&gt; Proxy sym -&gt; ([x] -&gt; Router a) -&gt; Router a\n  RQueryFlag    :: KnownSymbol sym\n                   =&gt; Proxy sym -&gt; (Bool -&gt; Router a) -&gt; Router a\n  RPath         :: KnownSymbol sym =&gt; Proxy sym -&gt; Router a -&gt; Router a\n  RPage         :: a -&gt; Router a\n</code></pre>\n\n<p>And finally from <a href=\"https://github.com/ekmett/structures/blob/master/src/Data/Vector/Set/Fusion.hs\" rel=\"nofollow noreferrer\">here</a>, how the <code>MergeL sa sb a</code> vs. <code>MergeR sa sb a</code> get selected, I don't see it.</p>\n\n<pre><code>data MergeState sa sb a\n  = MergeL sa sb a\n  | MergeR sa sb a\n  | MergeLeftEnded sb\n  | MergeRightEnded sa\n  | MergeStart sa sb\n</code></pre>\n"}, {"tags": ["haskell", "set"], "answers": [{"comments": [{"owner": {"reputation": 444, "user_id": 1738581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/febb5b5c9b48bfc151565fb2571fd529?s=128&d=identicon&r=PG", "display_name": "tgrez", "link": "https://stackoverflow.com/users/1738581/tgrez"}, "reply_to_user": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "edited": false, "score": 0, "creation_date": 1550509168, "post_id": 54752045, "comment_id": 96286247, "body": "Updated my answer."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "edited": false, "score": 1, "creation_date": 1550509211, "post_id": 54752045, "comment_id": 96286270, "body": "@LancePollard Also see <a href=\"https://stackoverflow.com/questions/993112/what-does-the-exclamation-mark-mean-in-a-haskell-declaration/993122#993122\" title=\"what does the exclamation mark mean in a haskell declaration\">stackoverflow.com/questions/993112/&hellip;</a>"}], "tags": [], "owner": {"reputation": 444, "user_id": 1738581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/febb5b5c9b48bfc151565fb2571fd529?s=128&d=identicon&r=PG", "display_name": "tgrez", "link": "https://stackoverflow.com/users/1738581/tgrez"}, "is_accepted": false, "score": 3, "last_activity_date": 1550509023, "creation_date": 1550509023, "answer_id": 54752045, "question_id": 54751981, "link": "https://stackoverflow.com/questions/54751981/what-data-unpack-size-a-set-a-set-a-means-in-haskell/54752045#54752045", "title": "What data {-# UNPACK #-} !Size !a !(Set a) !(Set a) means in Haskell", "body": "<p>This is a GHC pragma:</p>\n\n<blockquote>\n  <p>The UNPACK indicates to the compiler that it should unpack the contents of a constructor field into the constructor itself, removing a level of indirection.</p>\n</blockquote>\n\n<p>src: <a href=\"https://downloads.haskell.org/~ghc/7.0.3/docs/html/users_guide/pragmas.html\" rel=\"nofollow noreferrer\">https://downloads.haskell.org/~ghc/7.0.3/docs/html/users_guide/pragmas.html</a></p>\n\n<p>The meaning of those exclamations marks is to enforce strictness on those fields.</p>\n"}], "owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550509023, "creation_date": 1550508792, "question_id": 54751981, "link": "https://stackoverflow.com/questions/54751981/what-data-unpack-size-a-set-a-set-a-means-in-haskell", "title": "What data {-# UNPACK #-} !Size !a !(Set a) !(Set a) means in Haskell", "body": "<p>I am not familiar with Haskell but want to check out some of its definitions. I am looking at the <a href=\"http://hackage.haskell.org/package/containers-0.6.0.1/docs/src/Data.Set.Internal.html#Set\" rel=\"nofollow noreferrer\">Set</a> and see this:</p>\n\n<pre><code>data Set a    = Bin {-# UNPACK #-} !Size !a !(Set a) !(Set a)\n              | Tip\n</code></pre>\n\n<p>Wondering what that comment is doing (if it's doing some sort of code injection magic), and what the meaning of the exclamation marks is and the overall statement of <code>!Size !a !(Set a) !(Set a)</code>.</p>\n"}, {"tags": ["haskell", "graph", "typeclass"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550514101, "post_id": 54751905, "comment_id": 96288329, "body": "See also <a href=\"https://stackoverflow.com/q/9732084/791604\">How do you represent a graph in Haskell?</a>."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1550513981, "post_id": 54753069, "comment_id": 96288286, "body": "This is nice for being close to the mathematical definition, but it has pretty unfortunate computational characteristics. For example, getting the edges associated with a given node must traverse all edges. I would consider instead using an adjacency map like <code>Map a (Set a)</code> (keys are nodes, values are the set of nodes on the other side they&#39;re connected to). You can either use one for each part or combine them, depending on your goals. ...OR just directly reuse <code>fgl</code> and maintain the bipartite invariant yourself."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 1, "creation_date": 1550717077, "post_id": 54753069, "comment_id": 96374291, "body": "There are a lot of applications of bipartite graphs where one would want <code>data BiPartiteGraph a b = ...</code> or even <code>data BiPartiteGraph e a b = ...</code>"}], "tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": true, "score": 2, "last_activity_date": 1550513342, "creation_date": 1550513342, "answer_id": 54753069, "question_id": 54751905, "link": "https://stackoverflow.com/questions/54751905/how-to-define-a-bipartite-graph-in-haskell/54753069#54753069", "title": "How to define a bipartite graph in Haskell", "body": "<p>I would use <code>Data.Set</code> for constructing both sets of vertices and another one for the edges. Now wrap them in a module where you hide them.  </p>\n\n<pre><code>module BiPartiteGraph (create) where\n\n\nimport qualified Data.Set as Set \n\n\ndata BiPartiteGraph a = BiPartiteGraph (Set.Set a) (Set.Set a) (Set.Set (a, a)) -- (U, V, E)\n\n\n-- Construct a BiPartiteGraph from a list of edges\ncreate :: Ord a =&gt; [(a, a)] -&gt; BiPartiteGraph a\ncreate _ = undefined\n\n\n-- Implementation of the show function \ninstance (Show a) =&gt; Show (BiPartiteGraph a) where\n    show _ = undefined \n</code></pre>\n"}], "owner": {"reputation": 66677, "user_id": 169992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OeNfG.png?s=128&g=1", "display_name": "Lance Pollard", "link": "https://stackoverflow.com/users/169992/lance-pollard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 54753069, "answer_count": 1, "score": 2, "last_activity_date": 1550513342, "creation_date": 1550508561, "question_id": 54751905, "link": "https://stackoverflow.com/questions/54751905/how-to-define-a-bipartite-graph-in-haskell", "title": "How to define a bipartite graph in Haskell", "body": "<p>Trying to understand how these parameterized types work in Haskell, such as these:</p>\n\n<pre><code>data List a = Nil | Cons a (List a)\ndata Either a b = Left a | Right b\ndata Tree a = Nil | Node a (Tree a) (Tree a)\ndata Tree = Branch [Tree]\ndata Tree a = Node a [Tree a]\n</code></pre>\n\n<p>To make it a little more complicated I wanted to see what the definition looks like for a <a href=\"https://en.wikipedia.org/wiki/Bipartite_graph\" rel=\"nofollow noreferrer\">bipartite graph</a>, basically a graph with two sets of nodes where the nodes only connect to nodes of the other set.</p>\n\n<p>So.. (in JavaScript).... An example of how the data would be connected is like this:</p>\n\n<pre><code>var typeA_node1 = { id: 'a1' }\nvar typeA_node2 = { id: 'a2' }\nvar typeA_node3 = { id: 'a3' }\n\nvar typeB_node1 = { id: 'b1' }\nvar typeB_node2 = { id: 'b2' }\nvar typeB_node3 = { id: 'b3' }\n\ntypeA_node1.right = typeB_node3\ntypeB_node3.right = typeA_node2\n\ntypeA_node2.right = typeB_node2\ntypeB_node2.right = typeA_node3\n\ntypeA_node3.right = typeB_node1\n</code></pre>\n\n<p>Basically, <code>a--b--a--b--a--b--a--b</code>, a is always connected to b only, never to a. An <code>a</code> can be connected to many <code>b</code> nodes, I just didn't show that in the example.</p>\n\n<p>Wondering how to define this properly using <code>data</code> or <code>type</code> in Haskell (or something else).</p>\n"}, {"tags": ["haskell", "monads", "applicative"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 5, "creation_date": 1550504977, "post_id": 54750784, "comment_id": 96283930, "body": "Every type that is an instance of <code>Monad</code> must have its <code>return</code> equal to <code>pure</code>. But there are types which are <code>Applicative</code> but not a <code>Monad</code>, and therefore have a <code>pure</code> but no <code>return</code>. <code>ZipList</code> is the traditional example here."}, {"owner": {"reputation": 774, "user_id": 6034245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3qwA.jpg?s=128&g=1", "display_name": "chrisheyn", "link": "https://stackoverflow.com/users/6034245/chrisheyn"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550505520, "post_id": 54750784, "comment_id": 96284273, "body": "@RobinZigmond Thank you for this fast reply! Is it unconventional to just use pure in larger Haskell projects? So to never define return for Monad instances?  If you would like to add your first comment as an answer, I can mark this question as resolved."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550505830, "post_id": 54750784, "comment_id": 96284457, "body": "unfortunately I&#39;m pretty new to Haskell, so I can&#39;t speak for what people do in &quot;larger Haskell projects&quot;. (Although I&#39;m sure some of the other regular contributors here can help you on this.) Personally I like to use <code>return</code> if I&#39;m working in the context of a <code>Monad</code> (for example, a <code>do</code> block) but just use <code>pure</code> if I happen to need the function &quot;on the fly&quot; (to embed an element in a singleton list, typically). But I don&#39;t really know what the idiomatic way is to use them."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1550508163, "post_id": 54750784, "comment_id": 96285705, "body": "@chrisheyn As far as I can see, using <code>pure</code> everywhere would be fine. Many haskellers still use <code>return</code>, especially in <code>do</code> blocks, both because of habit (<code>pure</code> is more recent) and because they want to remark we are working with a monad. Some instead tend to use <code>pure</code>, even when <code>return</code> would also work. It&#39;s hard to say which one is more idiomatic, but I&#39;d say that using <code>pure</code> everywhere would generally be regarded as a matter of &quot;personal style&quot;."}, {"owner": {"reputation": 774, "user_id": 6034245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3qwA.jpg?s=128&g=1", "display_name": "chrisheyn", "link": "https://stackoverflow.com/users/6034245/chrisheyn"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1550508376, "post_id": 54750784, "comment_id": 96285838, "body": "Thank you @chi. I can imagine that using <code>return</code> adds more information to the code. That&#39;s sounds like a good approach when working with Monads."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1550509083, "post_id": 54750784, "comment_id": 96286203, "body": "My personal opinion (&amp; speculation) is that, in a parallel universe where <code>Applicative</code> was introduced in the base library at the same time as <code>Monad</code>, we would not have <code>return</code> at all, since that would be redundant. That reasoning could justify a position stating &quot;let&#39;s pretend we did the right thing from day one, and consequently behave as if <code>return</code> did not exist&quot;. Feel free to use <code>pure</code> in your code as you wish. As long as you don&#39;t become too dogmatic about it, you&#39;ll be fine :)"}], "answers": [{"tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": true, "score": 8, "last_activity_date": 1550542605, "last_edit_date": 1550542605, "creation_date": 1550506113, "answer_id": 54751241, "question_id": 54750784, "link": "https://stackoverflow.com/questions/54750784/haskell-example-where-pure-and-return-not-interchangeable/54751241#54751241", "title": "Haskell example where pure and return not interchangeable", "body": "<p>Every type that is an instance of Monad must have its <code>return</code> equal to <code>pure</code>.</p>\n\n<p>In particular, since <code>Applicative</code> was made a superclass of <code>Monad</code>, <code>return</code> doesn't need to be defined because by default it is defined to be a synonym of <code>pure</code>: see <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Monad.html#t:Monad\" rel=\"nofollow noreferrer\">the definition</a>:</p>\n\n<blockquote>\n  <p>Furthermore, the Monad and Applicative operations should relate as follows:</p>\n  \n  <ul>\n  <li><code>pure = return</code></li>\n  </ul>\n</blockquote>\n\n\n\n<blockquote>\n  <p>Minimal complete definition</p>\n\n<pre><code>(&gt;&gt;=)\n</code></pre>\n</blockquote>\n\n<p>Notice that the minimal definition only requires <code>&gt;&gt;=</code>, not <code>return</code>, and the requirement that <code>pure = return</code> (which, like all such \"laws\", cannot be enforced by the language but must hold for all \"sane\" implementations, otherwise the semantics will not be correct).</p>\n\n<p>But there are types which are Applicative but not a Monad, and therefore have a <code>pure</code> but no <code>return</code>. <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Applicative.html#t:ZipList\" rel=\"nofollow noreferrer\"><code>ZipList</code></a> is the traditional example.</p>\n"}], "owner": {"reputation": 774, "user_id": 6034245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3qwA.jpg?s=128&g=1", "display_name": "chrisheyn", "link": "https://stackoverflow.com/users/6034245/chrisheyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 54751241, "answer_count": 1, "score": 3, "last_activity_date": 1550542605, "creation_date": 1550504571, "question_id": 54750784, "link": "https://stackoverflow.com/questions/54750784/haskell-example-where-pure-and-return-not-interchangeable", "title": "Haskell example where pure and return not interchangeable", "body": "<p>Is Haskell's <code>pure</code> function the same as <code>return</code>?</p>\n\n<p>I just can make a type an instance of Monad if it is already an instance of Applicative, right? So I wonder that Applicative's  <code>pure</code> is everytime interchangeable with Monad's <code>return</code>?\nIs there an example where they are not the same?</p>\n\n<pre><code>data HelloType a = HelloType { getValue :: a } deriving (Show, Eq)\n\ninstance Functor HelloType where\n    fmap f (HelloType y) = HelloType (f y)\n\ninstance Applicative HelloType where\n    (&lt;*&gt;) (HelloType f) (HelloType x) = HelloType (f x)\n    pure = HelloType\n\ninstance Monad HelloType where\n    (&gt;&gt;=) (HelloType x) f = f x\n    -- return = pure\n    return = HelloType\n\nplus3 :: (Num a) =&gt; Maybe a -&gt; HelloType (Maybe a)\nplus3 (Just x) = HelloType (Just $ x + 3)\nplus3 Nothing = HelloType Nothing\n\nmain= do\n    let withPure = pure (Just 3) &gt;&gt;= plus3 &gt;&gt;= plus3\n        withReturn = return (Just 3) &gt;&gt;= plus3 &gt;&gt;= plus3\n    print $ withPure == withReturn -- TRUE\n</code></pre>\n"}, {"tags": ["haskell", "state", "monads"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1550498731, "post_id": 54748918, "comment_id": 96280112, "body": "Are you sure that&#39;s the right definition of <code>Stack</code>? I feel like it should be <code>type Stack a = Trans [a] a</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550498840, "post_id": 54748918, "comment_id": 96280185, "body": "And I believe the functions you&#39;re being asked to write are simple &quot;pure&quot; functions <code>state -&gt; (a, state)</code>, and that you&#39;ll then learn about the State monad and how it can simplify series of such stack operations. You don&#39;t need to know anything about how the monad &quot;works&quot; in order to write these basic functions."}, {"owner": {"reputation": 13, "user_id": 9054066, "user_type": "registered", "profile_image": "https://graph.facebook.com/1602599133134287/picture?type=large", "display_name": "Jan v", "link": "https://stackoverflow.com/users/9054066/jan-v"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550498894, "post_id": 54748918, "comment_id": 96280223, "body": "@RobinZigmond I don&#39;t know, maybe, but I don&#39;t think it makes a difference because we only have tasks that handle with Integers"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1550499708, "post_id": 54748918, "comment_id": 96280693, "body": "<code>a</code> is the return value of an action on a <code>Stack</code>, so for example <code>push :: Int -&gt; Stack ()</code> and <code>pop :: Stack Int</code>."}, {"owner": {"reputation": 13, "user_id": 9054066, "user_type": "registered", "profile_image": "https://graph.facebook.com/1602599133134287/picture?type=large", "display_name": "Jan v", "link": "https://stackoverflow.com/users/9054066/jan-v"}, "edited": false, "score": 0, "creation_date": 1550499813, "post_id": 54748918, "comment_id": 96280758, "body": "Thank you, this is what I figured out:             push :: Int -&gt; Stack ()             pop :: Stack Int             add :: Stack () (takes two elements from stack, calculates the sum and puts it back on the stack).  i still dont get how to implement it tho. how to write it."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1550500765, "post_id": 54748918, "comment_id": 96281342, "body": "Are you given a <code>Monad</code> instance for <code>Trans state</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1550502721, "post_id": 54749892, "comment_id": 96282504, "body": "To be fair, you can use <code>push</code> and <code>pop</code> without a <code>Monad</code> instance; it&#39;s just a lot more verbose :)"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1550512977, "post_id": 54749892, "comment_id": 96287901, "body": "Is the <code>&lt;*&gt;</code> definition correct? It seems strange to me that <code>st</code> is applied to <code>r</code> and not <code>fr</code>. Usually the state is passed &quot;left-to-right&quot; and <code>fr</code> is the leftmost parameter."}], "tags": [], "owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "is_accepted": true, "score": 5, "last_activity_date": 1550501639, "creation_date": 1550501639, "answer_id": 54749892, "question_id": 54748918, "link": "https://stackoverflow.com/questions/54748918/calling-functions-on-a-state-monad-stack-in-haskell/54749892#54749892", "title": "Calling functions on a state monad &quot;Stack&quot; in Haskell", "body": "<p>Pop and push is rather straightforward:</p>\n\n<pre><code>push :: Int -&gt; Stack ()\npush x = T { run = \\st -&gt; ((), x : st) }\n\npop :: Stack (Maybe Int)\npop = T\n  { run = \\st -&gt; case st of\n      (x : xs) -&gt; (Just x, xs)\n      _ -&gt; (Nothing, st)\n  }\n</code></pre>\n\n<p><code>pop</code> is type of <code>Maybe Int</code> because the stack can be empty. In that case we just return <code>Nothing</code>.\nBut what can we do with it? Well, not much without a <code>Monad</code> instance. Let's do one. We need <code>Functor</code> and <code>Applicative</code> instances first:</p>\n\n<pre><code>instance Functor (Trans st) where\n  fmap f (T r) = T\n    { run = \\st -&gt; \n        let (result, state) = r st\n        in (f result, state)\n    }\n\ninstance Applicative (Trans st) where\n  pure a = T { run = \\st -&gt; (a, st) }\n  (&lt;*&gt;) (T fr) (T r) = T\n    { run = \\st -&gt;\n        let (result, state) = r st\n            (f, nextState) = fr state\n        in (f result, nextState)\n    }\n\ninstance Monad (Trans a) where\n  (&gt;&gt;=) (T r) f = T\n    { run = \\st -&gt;\n        let (result, state) = r st\n        in run (f result) state\n    }\n</code></pre>\n\n<p>What does it give us? We can finally use our <code>pop</code> and <code>push</code> functions:</p>\n\n<pre><code>simpleStack :: Stack Int\nsimpleStack = do\n  push 10\n  push 20\n  push 30\n  Just x &lt;- pop\n  return x\n</code></pre>\n\n<p>And we can test it this way:</p>\n\n<pre><code>main :: IO ()\nmain = putStrLn $ show $ fst $ run simpleStack []\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9054066, "user_type": "registered", "profile_image": "https://graph.facebook.com/1602599133134287/picture?type=large", "display_name": "Jan v", "link": "https://stackoverflow.com/users/9054066/jan-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 54749892, "answer_count": 1, "score": 1, "last_activity_date": 1550530865, "creation_date": 1550498299, "last_edit_date": 1550530865, "question_id": 54748918, "link": "https://stackoverflow.com/questions/54748918/calling-functions-on-a-state-monad-stack-in-haskell", "title": "Calling functions on a state monad &quot;Stack&quot; in Haskell", "body": "<p>We have the following types given by the task</p>\n\n<pre><code>newtype Trans state a = T {run :: state -&gt; (a,state)}\ntype Stack a = Trans [Int] a\n</code></pre>\n\n<p>What I want is to write a function\n1. push to put an Integer on the stack\n2. pop to return and remove the highest object</p>\n\n<p>i tried to google through state monads to understand them and I get the concept, but I cannot implement it with the given type structure.</p>\n"}, {"tags": ["haskell", "arbitrary-precision"], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 2685382, "user_type": "registered", "profile_image": "https://graph.facebook.com/554336693/picture?type=large", "display_name": "Mick Francis", "link": "https://stackoverflow.com/users/2685382/mick-francis"}, "edited": false, "score": 0, "creation_date": 1550505517, "post_id": 54750032, "comment_id": 96284272, "body": "Very helpful answer - thanks. However, this seems to run out of steam after a while: <code>&gt; take 1000 $ bits $ 1&#47;3</code> <code>[0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0&zwnj;&#8203;,1,0,1,0,1,0,1,0,1,0&zwnj;&#8203;,1,0,1,0,1,0,1,0,1,0&zwnj;&#8203;,1,0,1,0,1,0,0,0,0,0&zwnj;&#8203;,0,0...</code>  Presumably something is not precise enough?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 139, "user_id": 2685382, "user_type": "registered", "profile_image": "https://graph.facebook.com/554336693/picture?type=large", "display_name": "Mick Francis", "link": "https://stackoverflow.com/users/2685382/mick-francis"}, "edited": false, "score": 0, "creation_date": 1550505827, "post_id": 54750032, "comment_id": 96284455, "body": "@MickFrancis Try <code>bits (1&#47;3 :: CReal)</code>. Without, <code>1&#47;3</code> is defaulting to <code>Double</code>. In your actual code of course you can put the signature on <code>bits</code> and then callers need not specify it. I&#39;ll update my answer shortly, as I was making the same mistake without noticing."}, {"owner": {"reputation": 139, "user_id": 2685382, "user_type": "registered", "profile_image": "https://graph.facebook.com/554336693/picture?type=large", "display_name": "Mick Francis", "link": "https://stackoverflow.com/users/2685382/mick-francis"}, "edited": false, "score": 0, "creation_date": 1550506086, "post_id": 54750032, "comment_id": 96284583, "body": "Great - that&#39;s sorted it (in fact I used Rational). Thanks again."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1550505873, "last_edit_date": 1550505873, "creation_date": 1550502078, "answer_id": 54750032, "question_id": 54748192, "link": "https://stackoverflow.com/questions/54748192/infinite-precision-reciprocal-in-haskell/54750032#54750032", "title": "&#39;Infinite&#39; precision reciprocal in Haskell", "body": "<p>There are more principled ways, but CReal can certainly do it.</p>\n\n<pre><code>&gt; bit n = (`mod` 2) . floor . (*2**n)\n&gt; [bit i (pi :: CReal) | i &lt;- [-1..10]]\n[1,1,0,0,1,0,0,1,0,0,0,0]\n&gt; [bit i (5/8 :: CReal) | i &lt;- [1..10]]\n[0,1,0,1,0,0,0,0,0,0,0]\n</code></pre>\n\n<p>Swap out <code>2</code> everywhere for whatever base you like. For an infinite list it's probably cheaper to iterate the multiplication, so:</p>\n\n<pre><code>&gt; bits = map ((`mod` 2) . floor) . iterate (2*)\n&gt; take 10 (bits (5/8 :: CReal))\n[0,1,0,1,0,0,0,0,0,0]\n</code></pre>\n\n<p>Again you can swap out <code>2</code> for any base you like.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1550607149, "post_id": 54751665, "comment_id": 96328448, "body": "<code>Set Rational</code> strikes me as a lousy way to represent a set of rational numbers because each comparison requires two arbitrary-precision multiplications. You could try <code>Set (Integer, Integer)</code> or perhaps <code>Map Integer (Set Integer)</code>, handling numerators and denominators separately."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1550608827, "post_id": 54751665, "comment_id": 96329197, "body": "@dfeuer Good point! Perhaps a lighter fix would be switching to <code>HashSet</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1550514554, "last_edit_date": 1550514554, "creation_date": 1550507740, "answer_id": 54751665, "question_id": 54748192, "link": "https://stackoverflow.com/questions/54748192/infinite-precision-reciprocal-in-haskell/54751665#54751665", "title": "&#39;Infinite&#39; precision reciprocal in Haskell", "body": "<p>In my other answer, I show how to do this with CReal to answer your question of whether that can be done. But I don't actually think that's a good idea, because it's invoking more power than is needed. Just to give a flavor of what I have in mind for a \"more principled\" approach, here's what I'm thinking:</p>\n\n<pre><code>bits :: Rational -&gt; [Int]\nbits n = whole : bits (2*frac) where\n    (whole, frac) = properFraction n\n</code></pre>\n\n<p>In action:</p>\n\n<pre><code>&gt; take 65 . bits $ 1/3\n[0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1]\n</code></pre>\n\n<p>You'll notice that this is <em>significantly</em> faster than the CReal approach in the other answer. It should also have better memory performance, even if you switch the other answer from CReal to Rational, because it keeps the fraction upper-bounded by 1 (whereas the other solution adds ~1 bit per iteration). It can be made faster still by noticing when it starts to loop. Here's a function that returns the loop in an easily-observable way:</p>\n\n<pre><code>import Data.Set (Set)\nimport qualified Data.Set as S\n\ndata BitsRep\n    = Loop Rational [Int]\n    | Lollipop [Int] [Int]\n    deriving (Eq, Ord, Read, Show)\n\n-- always returns a Lollipop when given an empty set\nbitsRaw :: Set Rational -&gt; Rational -&gt; BitsRep\nbitsRaw s n = case S.member n s of\n    True -&gt; Loop n []\n    False -&gt; case bitsRaw (S.insert n s) (2*frac) of\n        Lollipop prefix loop -&gt; Lollipop (whole:prefix) loop\n        Loop n' loop -&gt; (if n == n' then Lollipop [] else Loop n') (whole:loop)\n        where\n        (whole, frac) = properFraction n\n</code></pre>\n\n<p>If you really want it as an infinite list, a short wrapper will do, and significantly reduce the computation needed once the loop point is reached:</p>\n\n<pre><code>bits :: Rational -&gt; [Int]\nbits n = prefix ++ cycle loop where\n    Lollipop prefix loop = bitsRaw S.empty n\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1550595983, "post_id": 54767167, "comment_id": 96323002, "body": "Cool, it&#39;s a nice simplification, and avoids reducing the fraction on each multiplication like you would get with Rational. Nice!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1550614650, "post_id": 54767167, "comment_id": 96331516, "body": "You should force <code>bit</code>; otherwise each list element is an unnecessary thunk."}], "tags": [], "owner": {"reputation": 139, "user_id": 2685382, "user_type": "registered", "profile_image": "https://graph.facebook.com/554336693/picture?type=large", "display_name": "Mick Francis", "link": "https://stackoverflow.com/users/2685382/mick-francis"}, "is_accepted": false, "score": 2, "last_activity_date": 1550581919, "creation_date": 1550581919, "answer_id": 54767167, "question_id": 54748192, "link": "https://stackoverflow.com/questions/54748192/infinite-precision-reciprocal-in-haskell/54767167#54767167", "title": "&#39;Infinite&#39; precision reciprocal in Haskell", "body": "<p>After a bit of tinkering, I managed to do this without resorting to Rational / CReal:</p>\n\n<pre><code>recipBits :: Integer -&gt; [Bool]\nrecipBits n = dblAndMod2 2\n    where dblAndMod2 :: Integer -&gt; [Bool]\n          dblAndMod2 !r = let bit = r &gt;= n\n                              r'  = 2 * (if bit then r - n else r)\n                          in  bit : dblAndMod2 r'\n</code></pre>\n\n<p>Using explicit recursion gains a moderate speedup over using iterate. I'm not too worried about where it goes into a loop, as I'm using it with such large numbers that I'll never reach the loop. Thanks again for the help!</p>\n"}], "owner": {"reputation": 139, "user_id": 2685382, "user_type": "registered", "profile_image": "https://graph.facebook.com/554336693/picture?type=large", "display_name": "Mick Francis", "link": "https://stackoverflow.com/users/2685382/mick-francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1550581919, "creation_date": 1550495785, "question_id": 54748192, "link": "https://stackoverflow.com/questions/54748192/infinite-precision-reciprocal-in-haskell", "title": "&#39;Infinite&#39; precision reciprocal in Haskell", "body": "<p>I need to generate an infinite Haskell list containing all bits (or words) from the fractional part of the reciprocal of an Integer, in MSB-first order. Is there a straightforward way to do this from standard libraries, or do I need to implement a Newton iteration function or similar?</p>\n\n<p>I considered using CReal, but can't find a way of extracting bits/words.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1550485713, "post_id": 54745041, "comment_id": 96272321, "body": "<code>type NonEmptyList a = (a, [a])</code> is an ugly but suitable definition."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 7, "creation_date": 1550486163, "post_id": 54745041, "comment_id": 96272559, "body": "There&#39;s an applicative instance so <code>pure 5</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 6, "last_activity_date": 1550496780, "last_edit_date": 1550496780, "creation_date": 1550491929, "answer_id": 54747032, "question_id": 54745041, "link": "https://stackoverflow.com/questions/54745041/how-to-create-a-nonempty-list/54747032#54747032", "title": "How to create a nonEmpty list?", "body": "<p><code>fromList</code> takes any non-empty list value.</p>\n\n<pre><code>&gt; fromList [5]\n5 :| []\n</code></pre>\n\n<p>If you want a function of type <code>a -&gt; NonEmpty a</code>, then</p>\n\n<pre><code>singleton = fromList . (:[])\n</code></pre>\n\n<p>(I'm surprised <code>singleton</code> isn't already in the package.)</p>\n\n<p>(Or as @Lee mentioned in the comments, <code>singleton = pure</code> using\nthe <code>Applicative</code> instance for <code>NonEmpty</code>.)</p>\n\n<p>Your solution of <code>5 :| []</code> is also fine, as <code>:|</code> is <em>the</em> way to create a new <code>NonEmpty</code> value; the functions are just wrappers around its use. (In fact, <code>pure</code> is <em>defined</em> as <code>pure a = a :| []</code>, and <code>fromList (a:as) = a :| as</code>.)</p>\n"}, {"comments": [{"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1589188651, "post_id": 54748897, "comment_id": 109183340, "body": "Maybe I&#39;m missing something, but I think it defeat the purpose of <code>NonEmpty</code>, since <code>[] :: NonEmpty Int</code> would pass compilation but fail at runtime."}], "tags": [], "owner": {"reputation": 5755, "user_id": 394253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985ef765f821b00d3b41ac5ca8aef6a0?s=128&d=identicon&r=PG", "display_name": "Ed&#39;ka", "link": "https://stackoverflow.com/users/394253/edka"}, "is_accepted": true, "score": 4, "last_activity_date": 1550498221, "creation_date": 1550498221, "answer_id": 54748897, "question_id": 54745041, "link": "https://stackoverflow.com/questions/54745041/how-to-create-a-nonempty-list/54748897#54748897", "title": "How to create a nonEmpty list?", "body": "<p>With <a href=\"https://downloads.haskell.org/~ghc/8.6.3/docs/html/users_guide/glasgow_exts.html#overloaded-lists\" rel=\"nofollow noreferrer\">OverloadedLists</a> extension the usual list syntax can be used to define any <a href=\"https://downloads.haskell.org/~ghc/8.6.3/docs/html/users_guide/glasgow_exts.html#the-islist-class\" rel=\"nofollow noreferrer\">IsList</a> entity (such as <a href=\"https://hackage.haskell.org/package/semigroups-0.18/docs/src/Data-List-NonEmpty.html#line-195\" rel=\"nofollow noreferrer\">NonEmpty</a>):</p>\n\n<pre><code>{-# LANGUAGE OverloadedLists #-}\n\nimport Data.List.NonEmpty\n\nl :: NonEmpty Int\nl = [42]\n</code></pre>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 629, "favorite_count": 0, "accepted_answer_id": 54748897, "answer_count": 2, "score": 2, "last_activity_date": 1550498221, "creation_date": 1550485392, "last_edit_date": 1550494652, "question_id": 54745041, "link": "https://stackoverflow.com/questions/54745041/how-to-create-a-nonempty-list", "title": "How to create a nonEmpty list?", "body": "<p>I want to use <a href=\"https://hackage.haskell.org/package/semigroups-0.18/docs/Data-List-NonEmpty.html\" rel=\"nofollow noreferrer\">Data.List.NonEmpty</a>, I'm searching how to define a list with one element ? I can only fine nonEmpty with a list, but obviously it returns a Maybe and I don't want that...</p>\n\n<p>Update : I find this solution </p>\n\n<pre><code>let emptyList = 5 :| []\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "tree", "binary-tree"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1550484519, "post_id": 54744701, "comment_id": 96271638, "body": "first simplify the problem - the real issue is that <code>flatten $ reverseflatten [1..5]</code> is not equal to <code>[1..5]</code>, which you clearly intend it to be. (Since Haskell is referentially transparent, applying <code>reverseflatten</code> to each side would produce the same result if they were equal.) (I don&#39;t know how to solve this, although it&#39;s related to your rather complicated and un-natural recipe for &quot;reverse flattening&quot;, but just saying that it will be simpler to consider the root problem rather than a consequence of it.)"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550484667, "post_id": 54744701, "comment_id": 96271729, "body": "@Robin Zigmond: Can I (politely) beg to differ on it being unnatural? In natural language syntax and semantics (my field) the recipe I devised is actually very natural :) Granted, it may be unnatural from other perspectives, and perhaps to where you are coming from..."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550484792, "post_id": 54744701, "comment_id": 96271793, "body": "Fair enough, it&#39;s a matter of opinion, I&#39;ll clarify my first comment to reflect that. Well apparently I can&#39;t edit the comment any more, but hopefully this will do for clarification. What I really meant, anyway, is that you can&#39;t express it with a simple 2/3 line recursive definition and instead ended up needing an auxiliary function, with both functions having 4 cases."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1550490942, "post_id": 54744701, "comment_id": 96275303, "body": "You took the <code>reverseflatten</code> from the answer to your previous post, which appears to be buggy. Is that answer actually correct, or should we still take your previous description as the reference?  At the moment there is only a very informal description of the structure you want, which as we all know is highly prone to misinterpretation. Some context about where that comes from, what it means in your domain, would help clarify the situation."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1550495177, "post_id": 54744701, "comment_id": 96277882, "body": "If you expect <code>reverseflatten (flatten (reverseflatten xs)))</code> to always be true, presumably your code is based on some data structure description that includes a proof for this property holding. You should check your implementation line by line if it actually does what is required from the definition of your operators."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1550497868, "post_id": 54744701, "comment_id": 96279509, "body": "@Li-yao Xia: Please see the edited question."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1550498098, "post_id": 54744701, "comment_id": 96279658, "body": "Ok sorry I was mistaken about the status of <code>reverseflatten</code>."}], "answers": [{"comments": [{"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1550500851, "post_id": 54749552, "comment_id": 96281399, "body": "That&#39;s it! :) These functions are very natural for my purposes :)"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": true, "score": 3, "last_activity_date": 1550500477, "creation_date": 1550500477, "answer_id": 54749552, "question_id": 54744701, "link": "https://stackoverflow.com/questions/54744701/flattening-a-binary-tree-in-a-specific-manner/54749552#54749552", "title": "Flattening a binary tree in a specific manner", "body": "<p>I think that your problem is that the first node of the tree does not have the same pattern as the others, as in if you look at Tree1 it goes [x,y,z] , whereas Tree4 goes [x,y,[x',z,y']].</p>\n\n<p>You can see that the ordering of the child nodes do not follow that of the first one, which is why some people noted it feels un-natural. To fix it you can either change your definition of reverseFlattening to one that has a constant pattern, which I assume you don't want, or change your flatten to take this weird pattern into account:</p>\n\n<pre><code>data Tree a = Leaf a | Node (Tree a) a (Tree a) | UNode a (Tree a) deriving (Show)\n\nreverseFlatten :: [a] -&gt; Tree a\nreverseFlatten [x] = (Leaf x)\nreverseFlatten [x,y] = UNode y (Leaf x)\nreverseFlatten [x,y,z] = Node (Leaf x) y (Leaf z)\nreverseFlatten (x:y:xs) = Node (Leaf x) y (reverseFlatten ((xs !! 1) : (head xs) : (drop 2 xs)))\n\nflatten :: Tree a -&gt; [a]\nflatten (Leaf x)            = [x]\nflatten (UNode l (Leaf x))  = [l,x]\nflatten (Node (Leaf l) x r) = l : x : flattenRest r\n\nflattenRest :: Tree a -&gt; [a]\nflattenRest (Leaf x)            = [x]\nflattenRest (UNode l (Leaf x))  = [l,x]\nflattenRest (Node (Leaf l) x r) = x : l : flattenRest r\n</code></pre>\n\n<p>Note that I extended the pattern matching for your UNode and the left Node as you know already it will be a left-sided tree so there's no need to call your function if you know already what the result will be.</p>\n"}, {"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 1, "last_activity_date": 1550500800, "creation_date": 1550500800, "answer_id": 54749644, "question_id": 54744701, "link": "https://stackoverflow.com/questions/54744701/flattening-a-binary-tree-in-a-specific-manner/54749644#54749644", "title": "Flattening a binary tree in a specific manner", "body": "<h2>Testable specification</h2>\n\n<p>First we can implement your specification <code>reverseflatten (flatten (reverseflatten (x : xs))) = reverseflatten (x : xs)</code> as a QuickCheck property.</p>\n\n<ul>\n<li><p>We parameterize it by <code>flatten</code> and <code>reverseflatten</code> so it is easy to plug in different implementations.</p></li>\n<li><p>We specialize the element type to <code>Int</code> because we have to tell QuickCheck what to generate at some point.</p></li>\n<li><p>The type variable <code>a</code> really means <code>Tree Int</code>, but the generality will be useful later.</p></li>\n</ul>\n\n\n\n<pre><code>import Test.QuickCheck\n\nprop_flat :: (Eq a, Show a) =&gt;\n             (a -&gt; [Int]) -&gt; ([Int] -&gt; a) -&gt; (Int, [Int]) -&gt; Property\nprop_flat f rf (x0, xs0) =\n    (rf . f . rf) xs === rf xs\n  where\n    xs = x0 : xs0\n\n-- Also remember to derive both Show and Eq on Tree.\n</code></pre>\n\n<p>We can check that it's a nontrivial property by applying it to the incorrect implementation.</p>\n\n<pre><code>ghci&gt; quickCheck $ prop_flat flatten reverseflatten\n*** Failed! Falsifiable (after 5 tests and 8 shrinks):    \n(0,[0,0,1,0])\nNode (Leaf 0) 0 (Node (Leaf 0) 1 (Leaf 0)) /= Node (Leaf 0) 0 (Node (Leaf 1) 0 (Leaf 0))\n</code></pre>\n\n<h2>Flatten, first take</h2>\n\n<p>Now the implementation of <code>flatten</code> needs to be split in two stages, like <code>reverseflatten</code>, because the root behaves differently from the other nodes:</p>\n\n<ul>\n<li><p>at the root, <code>Node (Leaf x) y (Leaf z)</code> \u2192 <code>[x, y, z]</code>,</p></li>\n<li><p>but in the inner nodes, <code>Node (Leaf x) y (Leaf z)</code> \u2192 <code>[y, x, z]</code></p></li>\n</ul>\n\n<p>Also note that all the trees you've shown, and those that can actually be generated by <code>reverseflatten</code> lean to the right, so we really only know what to do on patterns <code>Leaf x</code>, <code>UNode x (Leaf y)</code> and <code>Node (Leaf x) y r</code>, but not other patterns like <code>UNode x (Node ...)</code> or <code>Node (Node ...) y r</code>. Hence, considering the whole domain of <code>Tree</code>s, <code>flatten1</code> is highly partial:</p>\n\n<pre><code>flatten1 :: Tree a -&gt; [a]\nflatten1 (Leaf x) = [x]\nflatten1 (UNode x (Leaf y)) = [x, y]\nflatten1 (Node (Leaf x) y r) = x : y : flatten1' r\n\nflatten1' :: Tree a -&gt; [a]\nflatten1' (Leaf x) = [x]\nflatten1' (UNode x (Leaf y)) = [x, y]\nflatten1' (Node (Leaf y) x r) = x : y : flatten1' r\n</code></pre>\n\n<p>Partiality notwithstanding, QuickCheck agrees:</p>\n\n<pre><code>ghci&gt; quickCheck $ prop_flat flatten1 reverseflatten\n+++ OK, passed 100 tests.\n</code></pre>\n\n<h2>Flatten, total version</h2>\n\n<p>A total function can be obtained by generalizing the patterns a bit, but as the test above shows, the specification does not cover these extra cases. Whenever we pattern match on a nested <code>Leaf y</code>, we instead just get the whole tree <code>ys</code> and flatten it. If it does turn out to be <code>ys = Leaf y</code>, then it will be flattened to a singleton list, so the original semantics are preserved.</p>\n\n<pre><code>flatten2 :: Tree a -&gt; [a]\nflatten2 (Leaf x) = [x]\nflatten2 (UNode x ys) = x : flatten2 ys\nflatten2 (Node xs y r) = flatten2 xs ++ y : flatten2' r\n\nflatten2' :: Tree a -&gt; [a]\nflatten2' (Leaf x) = [x]\nflatten2' (UNode x ys) = x : flatten2' ys\nflatten2' (Node ys x r) = x : flatten2' ys ++ flatten2' r\n</code></pre>\n\n<h2>Flatten, totally specified version</h2>\n\n<p>Rather than arbitrarily generalizing the function on the unspecified part of its domain, we can also restrict its domain to match exactly the specification. This leads to an alternative type definition: in all examples, <code>UNode</code> only has a leaf subtree, and similarly <code>Node</code> has only a leaf as the left subtree, so we unpack those leaves into the constructors.</p>\n\n<pre><code>data Tree' a = Leaf' a | UNode' a a | Node' a a (Tree' a)\n  deriving (Eq, Show)\n</code></pre>\n\n<p>The implementation of <code>flatten'</code> is a straightforward adaptation of <code>flatten1</code>:</p>\n\n<pre><code>flatten' :: Tree' a -&gt; [a]\nflatten' (Leaf' x) = [x]\nflatten' (UNode' x y) = [x, y]\nflatten' (Node' x y r) = x : y : f'' r\n\nf'' :: Tree' a -&gt; [a]\nf'' (Leaf' x) = [x]\nf'' (UNode' x y) = [x, y]\nf'' (Node' x y r) = y : x : f'' r\n</code></pre>\n\n<p><code>reverseflatten'</code> is similarly adapted from a refactored version of <code>reverseflatten</code>.</p>\n\n<pre><code>reverseflatten' :: [a] -&gt; Tree' a\nreverseflatten' (x : []) = Leaf' x\nreverseflatten' (x : y : []) = UNode' x y\nreverseflatten' (x : y : z : r) = Node' x y (rf'' z r)\n\nrf'' :: a -&gt; [a] -&gt; Tree' a\nrf'' x [] = Leaf' x\nrf'' x (y : []) = UNode' x y\nrf'' x (y : z : r) = Node' y x (rf'' z r)\n</code></pre>\n\n<p>QuickCheck validates:</p>\n\n<pre><code>ghci&gt; quickCheck $ prop_flat flatten' reverseflatten'\n+++ OK, passed 100 tests.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1550516919, "last_edit_date": 1550516919, "creation_date": 1550516599, "answer_id": 54753776, "question_id": 54744701, "link": "https://stackoverflow.com/questions/54744701/flattening-a-binary-tree-in-a-specific-manner/54753776#54753776", "title": "Flattening a binary tree in a specific manner", "body": "<p>Let's hypothesize a slightly stronger property and just calculate without thinking, and see where it gets us. Namely, that stronger property will be that whenever <code>xs</code> is not empty, we have:</p>\n\n<pre><code>flatten (reverseflatten xs) = xs\n</code></pre>\n\n<p>From the definition of <code>reverseflatten</code>, there are four cases to consider. The first is this:</p>\n\n<pre><code>flatten (reverseflatten [x]) = [x]\nflatten (Leaf x) = [x]\n</code></pre>\n\n<p>Next:</p>\n\n<pre><code>flatten (reverseflatten [x,y]) = [x,y]\nflatten (UNode x (Leaf y)) = [x,y]\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>flatten (reverseflatten [x,y,z]) = [x,y,z]\nflatten (Node (Leaf x) y (Leaf z)) = [x,y,z]\n</code></pre>\n\n<p>Finally:</p>\n\n<pre><code>flatten (reverseflatten (x:y:xs)) = x:y:xs\nflatten (revflat2 (x:y:xs)) = x:y:xs\n</code></pre>\n\n<p>Because the previous patterns have captured the situations where <code>xs</code> matches <code>[]</code> or <code>[_]</code>, we need only consider one case of <code>revflat2</code>, namely, the one where <code>xs</code> has at least two elements.</p>\n\n<pre><code>flatten (revflat2 (x:y:w:z:xs)) = x:y:w:z:xs\nflatten (Node (Leaf x) y (revflat2 (z:w:xs))) = x:y:w:z:xs\n</code></pre>\n\n<p>Aha! For this to work, it would be nice to have a helper with a new property, namely:</p>\n\n<pre><code>flatten2 (revflat2 (z:w:xs)) = w:z:xs\n</code></pre>\n\n<p>(We'll actually use the names <code>x</code> and <code>y</code> instead of <code>w</code> and <code>z</code>, of course.)\nOnce again let us calculate without thinking. There are three cases for <code>xs</code>, namely <code>[]</code>, <code>[_]</code>, and longer. When <code>xs</code> is <code>[]</code>:</p>\n\n<pre><code>flatten2 (revflat2 [x,y]) = [y,x]\nflatten2 (UNode y (Leaf x)) = [y,x]\n</code></pre>\n\n<p>For <code>[_]</code>:</p>\n\n<pre><code>flatten2 (revflat2 [x,y,z]) = [y,x,z]\nflatten2 (Node (Leaf x) y (Leaf z)) = [y,x,z]\n</code></pre>\n\n<p>And for longer:</p>\n\n<pre><code>flatten2 (revflat2 (x:y:w:z:xs)) = y:x:w:z:xs\nflatten2 (Node (Leaf x) y (revflat2 (z:w:xs))) = y:x:w:z:xs\n</code></pre>\n\n<p>By induction hypothesis, we have <code>flatten2 (revflat2 (z:w:xs)) = w:z:xs</code>, so this last equation can become:</p>\n\n<pre><code>flatten2 (Node (Leaf x) y rest) = y:x:flatten2 rest\n</code></pre>\n\n<p>Now we can just take all the final lines of each of these cases and they make a program:</p>\n\n<pre><code>flatten (Leaf x) = [x]\nflatten (UNode x (Leaf y)) = [x,y]\nflatten (Node (Leaf x) y (Leaf z)) = [x,y,z]\nflatten (Node (Leaf x) y rest) = x:y:flatten2 rest\n\nflatten2 (UNode y (Leaf x)) = [y,x]\nflatten2 (Node (Leaf x) y (Leaf z)) = [y,x,z]\nflatten2 (Node (Leaf x) y rest) = y:x:flatten2 rest\n</code></pre>\n\n<p>Is this the best program? No! In particular, it's partial -- you have some free choices you can make about what <code>flatten</code> and <code>flatten2</code> should do when the first tree argument to a <code>Node</code> or <code>UNode</code> is not a <code>Leaf</code> (but no matter what choice you make it will not affect the property you care about) and about what <code>flatten2</code> should do with leaves. Likely if you make sane choices here, you can coalesce many of the patterns.</p>\n\n<p>But what's nice about this process is that it's <em>completely</em> mechanical: you can take your property of interest, turn a crank, and get out a function with that property (or conflicting equations that tell you it's not possible and why). Only once you have something that works do you need to stare and think about what would make it prettier or better. Yay, equational reasoning!</p>\n"}], "owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 54749552, "answer_count": 3, "score": 0, "last_activity_date": 1550516919, "creation_date": 1550484261, "last_edit_date": 1550498210, "question_id": 54744701, "link": "https://stackoverflow.com/questions/54744701/flattening-a-binary-tree-in-a-specific-manner", "title": "Flattening a binary tree in a specific manner", "body": "<p>Consider the following definitions of binary and unary trees, a function <code>flatten</code>, which converts binary and unary trees to lists (e.g, <code>flatten (Node (Leaf 10) 11 (Leaf 20))</code> is <code>[10,11,20]</code>) and a function, <code>reverseflatten</code>, which converts lists to binary trees (<em>in the specific manner described here (<a href=\"https://stackoverflow.com/questions/54738406/defining-a-function-from-lists-to-binary-and-unary-trees/54738585#54738585\">Defining a function from lists to binary and unary trees</a>) and illustrated in the picture below</em>):</p>\n\n<pre><code>data Tree a = Leaf a | Node (Tree a) a (Tree a) | UNode a (Tree a) deriving (Show)\nflatten :: Tree a -&gt; [a]\nflatten (Leaf x) = [x] \nflatten (Node l x r) = flatten l ++ [x] ++ flatten r\nflatten (UNode l x) = [l] ++ flatten x\n\nreverseflatten :: [a] -&gt; Tree a\nreverseflatten [x] = (Leaf x)\nreverseflatten [x,y] = UNode x (Leaf y)\nreverseflatten [x,y,z] = Node (Leaf x) y (Leaf z)\nreverseflatten (x:y:xs) = revflat2 (x:y:xs)\n\nrevflat2 :: [a] -&gt; Tree a\nrevflat2 [x] = (Leaf x)\nrevflat2 [x,y] = UNode y (Leaf x)\nrevflat2 [x,y,z] = Node (Leaf x) y (Leaf z)\nrevflat2 (x:y:xs) = Node (Leaf x) y (revflat2 ([head $ tail xs] ++ [head xs] ++ tail (tail xs)))\n</code></pre>\n\n<p><code>reverseflatten [1..5]</code> is <code>Node (Leaf 1) 2 (Node (Leaf 4) 3 (Leaf 5)</code>, but <code>(reverseflatten(flatten(reverseflatten [1..5])))</code> does not return the same as <code>reverseflatten [1..5]</code>. How could <code>flatten</code> be modified so that <code>reverseflatten x: xs</code> is the same as <code>(reverseflatten(flatten(reverseflatten x:xs)))</code>?</p>\n\n<p><code>reverseflatten</code> forms the series of trees in the picture below. \nFor example, <code>reverseflatten [x,y,z]</code> forms Tree 2 in the picture, <code>reverseflatten [x,y,z, x']</code> forms Tree 3, <code>reverseflatten [x,y,z, x', y']</code> forms Tree 4, <code>reverseflatten [x,y,z, x', y', z']</code> forms Tree 5, <code>reverseflatten [x,y,z, x', y', z', x'']</code> forms Tree 6, etcetera.\n<img src=\"https://i.stack.imgur.com/wj8FK.jpg\" alt=\"Series of trees generated by &lt;code&gt;reverseflatten&lt;/code&gt;\"></p>\n\n<p>What I want is that <code>reverseflatten x: xs</code> is the same as <code>(reverseflatten(flatten(reverseflatten x:xs)))</code>. So I need to design <code>flatten</code> so it has this effect.</p>\n\n<p>I have made the following attempt (where the case <code>flatten Node l x r</code> is supposed to divide into a case in which <code>r</code> is a leaf, and a case where it is not):</p>\n\n<pre><code>flatten :: Tree a -&gt; [a]\nflatten (Leaf x) = [x] \nflatten (UNode l x) = [l] ++ flatten x \nflatten (Node l x r)\n    | r == Leaf y   = [l, x, r]  \n    | otherwise = flatten (Node l x (revflat2 ([head $ tail r] ++ [head r]     ++ tail (tail r)))\n</code></pre>\n\n<p>but this produces:</p>\n\n<pre><code>experiment.hs:585:1: error:\n    parse error (possibly incorrect indentation or mismatched brackets)\n    |\n585 | flatten (UNode l x) = [l] ++ flatten x \n    | ^\n</code></pre>\n"}, {"tags": ["python", "haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1550462593, "post_id": 54740286, "comment_id": 96262890, "body": "Well if you want an idiomatic solution, just see the page about memoization on the Haskell wiki. Fibonacci is the canonical example for memoization (caching function results) techniques.  And it will be quite a lot less code than this.  Or are you interested in a &quot;transliteration&quot;, that is, more or less a line-by-line translation?"}, {"owner": {"reputation": 41, "user_id": 11076951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cef5f535a6705e78468efa9bb2494119?s=128&d=identicon&r=PG&f=1", "display_name": "teekinator359", "link": "https://stackoverflow.com/users/11076951/teekinator359"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550463018, "post_id": 54740286, "comment_id": 96262972, "body": "Hm, more or less a line-by-line. I just have to be able to implement the essence of the python code, which is the use of cache and a top down iteration approach. I just don&#39;t know how to ask the right questions regarding this problem, as haskell has a REALLY hard syntax..."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1550464436, "post_id": 54740286, "comment_id": 96263311, "body": "There can&#39;t really be a line by line translation when the core concepts differ."}, {"owner": {"reputation": 41, "user_id": 11076951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cef5f535a6705e78468efa9bb2494119?s=128&d=identicon&r=PG&f=1", "display_name": "teekinator359", "link": "https://stackoverflow.com/users/11076951/teekinator359"}, "edited": false, "score": 0, "creation_date": 1550465392, "post_id": 54740286, "comment_id": 96263531, "body": "Maybe not exactly like the python code. I&#39;m thinking of using the while with some lambda expressions. I don&#39;t know how you pass around a parameter."}, {"owner": {"reputation": 41, "user_id": 11076951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cef5f535a6705e78468efa9bb2494119?s=128&d=identicon&r=PG&f=1", "display_name": "teekinator359", "link": "https://stackoverflow.com/users/11076951/teekinator359"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1550465758, "post_id": 54740286, "comment_id": 96263631, "body": "Ohhhh, then that makes it even harder to figure out how to implement it in haskell... @Thomas M. DuBuisson. Are you suggesting I could just remove the custom data type, @luqui?"}, {"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 0, "creation_date": 1550467643, "post_id": 54740286, "comment_id": 96264105, "body": "<a href=\"https://wiki.haskell.org/Memoization\" rel=\"nofollow noreferrer\">wiki.haskell.org/Memoization</a> This also has alot of helpful links/references/blog posts that may help further guide your question."}, {"owner": {"reputation": 41, "user_id": 11076951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cef5f535a6705e78468efa9bb2494119?s=128&d=identicon&r=PG&f=1", "display_name": "teekinator359", "link": "https://stackoverflow.com/users/11076951/teekinator359"}, "reply_to_user": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 0, "creation_date": 1550469273, "post_id": 54740286, "comment_id": 96264552, "body": "Okey, thank you! @dopamane"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 11076951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cef5f535a6705e78468efa9bb2494119?s=128&d=identicon&r=PG&f=1", "display_name": "teekinator359", "link": "https://stackoverflow.com/users/11076951/teekinator359"}, "edited": false, "score": 0, "creation_date": 1550474082, "post_id": 54741406, "comment_id": 96266324, "body": "Wow, don&#39;t be! This is just great. This is more than I asked for. It has given me a better understanding for sure. Thanks for taking your time to help a helpless coder :)"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 7, "last_activity_date": 1550472296, "last_edit_date": 1550472296, "creation_date": 1550470559, "answer_id": 54741406, "question_id": 54740286, "link": "https://stackoverflow.com/questions/54740286/functional-programming-how-to-convert-an-implementation-of-fibonacci-written-in/54741406#54741406", "title": "Functional programming: How to convert an implementation of fibonacci written in python to haskell", "body": "\n\n<p><em>I'm a little embarrassed in retrospect since you are very clearly asking about the \"top-down iteration\" technique which I speak none of.  Oh well, I hope this is still useful on some level.</em></p>\n\n<p>A lot of effort in the python code is going into simulating recursion with an explicit stack and a while loop.  In Haskell we would just use regular recursion; you're not going to get stack overflows or anything like that<sup>1</sup>.  The recursive definition of fibonacci is, of course:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>fib :: Int -&gt; Integer\nfib 0 = 0\nfib 1 = 1\nfib n = fib (n-1) + fib (n-2)\n</code></pre>\n\n<p>Which is quite tiny.  All we have to do is add caching to it. </p>\n\n<h2>Explicit Cache Passing</h2>\n\n<p>If we're trying to stay close to the original code (yet without going all the way to simulating recursion), we should pass our cache around as a parameter.  That is, our function will take a cache, and return an updated cache.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type Cache = Map.Map Int Integer\n\nfib :: Int -&gt; Cache -&gt; (Integer, Cache)\nfib 0 cache = (0, cache)\nfib 1 cache = (1, cache)\nfib n cache = \n    let (a, cache') = fib (n-1) cache in \n     ... -- Left as exercise\n         -- Since we call fib twice, remember to pass the\n         -- *updated* cache, not the original, to the second call\n</code></pre>\n\n<p>I do recommend this exercise, even though in the next section it will become obsolete.</p>\n\n<blockquote>\n  <p><strong>Digression</strong></p>\n  \n  <p>It turns out that the pattern of our <code>Cache</code>-passing fib is exactly the pattern that the <code>State</code> monad captures.  So we could have written <code>fib</code> as</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>fib :: Int -&gt; State Cache Integer\n</code></pre>\n  \n  <p>Indeed, the definition of <code>State</code> is essentially:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>State s a = s -&gt; (a, s)\n</code></pre>\n  \n  <p>modulo some <code>newtype</code> nonsense.  If we substitute in <code>State Cache Integer</code>, we find that</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>fib :: Int -&gt; State Cache Integer\n    :: Int -&gt; Cache -&gt; (Integer, Cache)\n</code></pre>\n  \n  <p>just as our original!  So if you did that exercise, you basically know what the <code>State</code> monad does.</p>\n</blockquote>\n\n<h2>Pure Memoization</h2>\n\n<p>Passing a cache around is all well and good, but we can do better.  Wouldn't it be great to still be able to see the core logic of the original <code>fib</code> definition easily, without worrying about threading a state around?  That's what the examples on the <a href=\"https://wiki.haskell.org/Memoization\" rel=\"noreferrer\">Memoization</a> page are talking about:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>memoized_fib :: Int -&gt; Integer\nmemoized_fib = (map fib [0 ..] !!)\n   where fib 0 = 0\n         fib 1 = 1\n         fib n = memoized_fib (n-2) + memoized_fib (n-1)\n</code></pre>\n\n<p>There is a little slant to this language: we have the \"real\" <code>fib</code> definition hiding inside the <code>where</code> clause of <code>memoized_fib</code>, and the \"real\" definition calls back out to its parent <code>memoized_fib</code>.  But the original function is still pretty clear and not overwhelmed with little details.  </p>\n\n<p>The first line contains an <a href=\"https://wiki.haskell.org/Section_of_an_infix_operator\" rel=\"noreferrer\">operator section</a> in case you haven't seen that before.  It is just syntax sugar and doesn't relate to the memoization technique.</p>\n\n<p>The way this works is the first line creates a (single, program-global<sup>2</sup>) infinite list</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>[ fib 0, fib 1, fib 2, fib 3, fib 4, fib 5, ... ]\n</code></pre>\n\n<p>which, because of laziness, is not evaluated (that would take a long time, wouldn't it?).  Then when we need to know a particular fibonacci number, say <code>4</code>, we index into the list, and thus only evaluate that element.  This updates the corresponding <em>thunk</em> (lazily suspended computation)</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code> [ fib 0, fib 1, fib 2, fib 3, 3, fib 5, ... ]\n</code></pre>\n\n<p>so that if we ever access the 4th element again, it's already been evaluated.  Of course, one of the reasons we ask for fibonacci numbers is to compute other fibonacci numbers (because <code>fib</code> recurses into <code>memoized_fib</code>), so now intermediate results will cached in this list also, and as a result the computation gets an exponential speedup.</p>\n\n<p>Indexing into a list is O(n), because Haskell lists are essentially linked lists.  So the memo table has O(n) lookup; we can do better by using a trie.  That's what my library <a href=\"http://hackage.haskell.org/package/data-memocombinators-0.5.1/docs/Data-MemoCombinators.html\" rel=\"noreferrer\">data-memocombinators</a> provides, as well as a couple other libraries such as <a href=\"http://hackage.haskell.org/package/MemoTrie-0.6.9/docs/Data-MemoTrie.html\" rel=\"noreferrer\">MemoTrie</a> with slightly different perspectives on basically same thing.  Using these libraries you can use this same pure memoization technique with an O(log n) memo table.  <a href=\"https://stackoverflow.com/a/4980838/33796\">More on the details of that</a>.</p>\n\n<p>So, that's how 26 lines of Python becomes 5 lines<sup>3</sup> of Haskell.  Happy Hasking!</p>\n\n<hr>\n\n<p><sup>1</sup> Stack overflows <em>can</em> happen in Haskell, but it's not because your recursion is too deep, it's usually because you were a bit too lazy and need to force something somewhere.`</p>\n\n<p><sup>2</sup> The technical word is <a href=\"https://wiki.haskell.org/Constant_applicative_form\" rel=\"noreferrer\">Constant Applicative Form</a> or CAF, if you want to find out more.</p>\n\n<p><sup>3</sup> And still 4 too many.</p>\n\n<blockquote class=\"spoiler\">\n  <p> <code>fibs = 0 : scanl (+) 1 fibs</code></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550471744, "post_id": 54741622, "comment_id": 96265419, "body": "Thank you for writing this!  I was weighing whether to take this angle in my answer, so I&#39;m glad somebody did!  (And in retrospect I think it&#39;s probably more what OP was looking for)"}, {"owner": {"reputation": 41, "user_id": 11076951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cef5f535a6705e78468efa9bb2494119?s=128&d=identicon&r=PG&f=1", "display_name": "teekinator359", "link": "https://stackoverflow.com/users/11076951/teekinator359"}, "edited": false, "score": 1, "creation_date": 1550476304, "post_id": 54741622, "comment_id": 96267407, "body": "As a first time poster, the stackoverflow community has proven to be really great! I have to look in to the syntax more before I can fully understand this answer. But yes, this is more what I was looking for. Greatly appreciated, and thank you for taking your time!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1550522851, "post_id": 54741622, "comment_id": 96291847, "body": "this is very pretty. ---- perhaps, <code>interpret = until (null . program) step</code>? (I understand your motivations, but still...)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1550596840, "post_id": 54741622, "comment_id": 96323455, "body": "I&#39;d like to ask your opinion on the more visually aligned coding style, as can be seen in <a href=\"https://gist.github.com/WillNess/506fdf0b3588d735af73a087bb5da144\" rel=\"nofollow noreferrer\">an edit of this answer</a> that I was thinking to make (just a few touches here and there). Do you think it&#39;s great / okay / acceptable / inappropriate / inconsequential / don&#39;t like it / else / ... ? For me such code seems clearer somehow... Would you mind if I made that edit? (You&#39;re welcome to do it yourself if you so prefer of course.) (also, <code>do</code> notation is probably easier for the newbies...)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1550600762, "post_id": 54741622, "comment_id": 96325514, "body": "@WillNess Aligning things like that is okay for toys like this. I don&#39;t like it for serious code any more, where mere name changes could then cause large multi-line diffs, so I&#39;m out of the habit, but don&#39;t really object. However I do object to <a href=\"http://dmwit.com/tabs\" rel=\"nofollow noreferrer\">aligning things on lines with different indentation levels</a>, as you appear to be doing with the arrows of <code>case M.lookup n (cache m) of ...</code> (aligning them with the arrows of the enclosing <code>case</code>). <code>do</code> syntax with indentation is fine; single-line <code>do</code>s using braces and semicolons is weird and uncommon."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1550652790, "post_id": 54741622, "comment_id": 96343078, "body": "thanks, :) makes sense, about the diffs. --- I aligned them because they are <i>semantically</i> related, whatever the code path we had to take to get to each one of them. as for <code>do</code>, it&#39;s my personal preference to have most things explicit, and use the explicit separators whether one line of multi line. For me it adds clarity, readability, and removes brittleness for an occasional unintended off-by-one spacing (i.e. makes code clearer <i>and</i> more robust). I&#39;ll also occasionally prefer extraneous parens which could be omitted, just for the sake of clarity."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1550653764, "post_id": 54741622, "comment_id": 96343631, "body": "went ahead with the edit, taking your comments into account. hope it&#39;s okay."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1550653150, "last_edit_date": 1550653150, "creation_date": 1550471660, "answer_id": 54741622, "question_id": 54740286, "link": "https://stackoverflow.com/questions/54740286/functional-programming-how-to-convert-an-implementation-of-fibonacci-written-in/54741622#54741622", "title": "Functional programming: How to convert an implementation of fibonacci written in python to haskell", "body": "<p>I think the answer to this question really shows a place where Haskell shines: in the design and implementation of domain-specific languages. Where the Python uses strings and reflection, we'll use <em>algebraic data types</em> to represent the commands in the language, making the implementation clean and easy to check for completeness (plus the compiler will let you know if you made a typo in one of the commands, unlike the Python version!).</p>\n\n<p>First let's define the language we're interpreting. Since Fibonacci numbers get big fast, we'll just use bignums everywhere to avoid having to think about integer arithmetic overflow.</p>\n\n<pre><code>import Data.Map (Map)\nimport qualified Data.Map as M\n\ndata Command = Push Integer | Plus | Fib | Cache  deriving (Eq, Ord, Read, Show)\n</code></pre>\n\n<p>(I'd be tempted to give <code>Integer</code> arguments to <code>Fib</code> and <code>Cache</code> as well, rather than forcing a <code>Push</code> onto the stack before each of the calls, but we'll keep it this way for consistency with the original Python code.)</p>\n\n<p>Our stack machine will just use a plain list for its stack, and the environment will be a <code>Map</code>. The state of our stack machine will include the commands to run, the stack, and the cache.</p>\n\n<pre><code>data Machine = Machine\n    { program :: [Command]\n    , cache   :: Map Integer Integer\n    , stack   :: [Integer]\n    } \n    deriving (Eq, Ord, Read, Show)\n</code></pre>\n\n<p>With the preliminaries out of the way, we can write the function which takes one machine step.</p>\n\n<pre><code>step :: Machine -&gt; Machine\nstep m = case program m of\n    []   -&gt; m\n    c:cs -&gt; case (c, stack m) of\n        (Push n, ns)   -&gt; m { program = cs, stack = n:ns }\n        (Plus, a:b:ns) -&gt; m { program = cs, stack = a+b:ns }\n        (Fib, n:ns) -&gt; case M.lookup n (cache m) of\n            Just fibn -&gt; m { program = cs, stack = fibn:ns }\n            Nothing   -&gt; m { stack = ns, program\n                = Push (n-2) : Fib\n                : Push (n-1) : Fib\n                : Plus\n                : Push n : Cache\n                : cs\n                }\n        (Cache, n:ns@(fibn:_)) -&gt; m\n            { program = cs\n            , stack = ns\n            , cache = M.insert n fibn (cache m)\n            }\n        _ -&gt; error $ \"stack too short for command \" ++ show c\n</code></pre>\n\n<p>Running a program in full is easy: just keep stepping until the program is <code>[]</code>. So:</p>\n\n<pre><code>interpret :: Machine -&gt; Machine\ninterpret = until (null . program) step\n</code></pre>\n\n<p>Now we can set up a little wrapper that creates a machine with a mostly-empty cache, sets it running, and has a look at the stack when it's done.</p>\n\n<pre><code>fibMachine :: Integer -&gt; Machine\nfibMachine n = Machine\n    { program = [Fib]\n    , cache = M.fromList [(1,1), (2,1)]\n    , stack = [n]\n    }\n\nfib :: Integer -&gt; Integer\nfib = head . stack . interpret . fibMachine\n</code></pre>\n\n<p>Give it a whirl:</p>\n\n<pre><code>&gt; fib 10\n55\n</code></pre>\n\n<p>Note that we didn't incorporate tracing into <code>interpret</code>. But that's okay; we can add tracing completely externally, like this:</p>\n\n<pre><code>tracingInterpret :: Machine -&gt; IO Machine\ntracingInterpret m = mapM_ print unfinished &gt;&gt; return finished \n    where \n    (unfinished, finished:_) = break (null . program) (iterate step m)\n</code></pre>\n\n<p>Try it:</p>\n\n<pre><code>&gt; tracingInterpret (fibMachine 4)\nMachine {program = [Fib], cache = fromList [(1,1),(2,1)], stack = [4]}\nMachine {program = [Push 2,Fib,Push 3,Fib,Plus,Push 4,Cache], cache = fromList [(1,1),(2,1)], stack = []}\nMachine {program = [Fib,Push 3,Fib,Plus,Push 4,Cache], cache = fromList [(1,1),(2,1)], stack = [2]}\nMachine {program = [Push 3,Fib,Plus,Push 4,Cache], cache = fromList [(1,1),(2,1)], stack = [1]}\nMachine {program = [Fib,Plus,Push 4,Cache], cache = fromList [(1,1),(2,1)], stack = [3,1]}\nMachine {program = [Push 1,Fib,Push 2,Fib,Plus,Push 3,Cache,Plus,Push 4,Cache], cache = fromList [(1,1),(2,1)], stack = [1]}\nMachine {program = [Fib,Push 2,Fib,Plus,Push 3,Cache,Plus,Push 4,Cache], cache = fromList [(1,1),(2,1)], stack = [1,1]}\nMachine {program = [Push 2,Fib,Plus,Push 3,Cache,Plus,Push 4,Cache], cache = fromList [(1,1),(2,1)], stack = [1,1]}\nMachine {program = [Fib,Plus,Push 3,Cache,Plus,Push 4,Cache], cache = fromList [(1,1),(2,1)], stack = [2,1,1]}\nMachine {program = [Plus,Push 3,Cache,Plus,Push 4,Cache], cache = fromList [(1,1),(2,1)], stack = [1,1,1]}\nMachine {program = [Push 3,Cache,Plus,Push 4,Cache], cache = fromList [(1,1),(2,1)], stack = [2,1]}\nMachine {program = [Cache,Plus,Push 4,Cache], cache = fromList [(1,1),(2,1)], stack = [3,2,1]}\nMachine {program = [Plus,Push 4,Cache], cache = fromList [(1,1),(2,1),(3,2)], stack = [2,1]}\nMachine {program = [Push 4,Cache], cache = fromList [(1,1),(2,1),(3,2)], stack = [3]}\nMachine {program = [Cache], cache = fromList [(1,1),(2,1),(3,2)], stack = [4,3]}\nMachine {program = [], cache = fromList [(1,1),(2,1),(3,2),(4,3)], stack = [3]}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 11076951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cef5f535a6705e78468efa9bb2494119?s=128&d=identicon&r=PG&f=1", "display_name": "teekinator359", "link": "https://stackoverflow.com/users/11076951/teekinator359"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1550653150, "creation_date": 1550462362, "question_id": 54740286, "link": "https://stackoverflow.com/questions/54740286/functional-programming-how-to-convert-an-implementation-of-fibonacci-written-in", "title": "Functional programming: How to convert an implementation of fibonacci written in python to haskell", "body": "<p>So, for this task I have to convert python to haskell. The code I have to implement in haskell is a code that generates a fibonacci sequence using a top down iteration method. The problem is that i'm fairly new at haskell, and I don't quite know how to execute this problem. </p>\n\n<p>I have created a while-loop in haskell, and a function. </p>\n\n<p>Python code:</p>\n\n<pre><code>def fib_top_down_iter_with_cache(n, trace=False):\n    fibDict = {1:1, 2: 1}\n    (inp, stack) = (['fib', n], [])\n    fib_top_down_iter_with_cache.function_calls = 0\n    while inp:\n        if trace: \n            print(fibDict, inp, stack)\n        (inp, token) = (inp[:-1], inp[-1])\n        if isinstance(token, int):\n            stack = [token] + stack\n        elif token == 'fib':\n            (n, stack) = (stack[0], stack[1:])\n            fib_top_down_iter_with_cache.function_calls += 1\n            if n in fibDict:\n                inp = inp + [fibDict[n]]\n            else:\n                inp = inp + ['cache', n, '+', 'fib', n - 1, 'fib', n - 2]\n        elif token == '+':\n            (n1, n2, stack) = (stack[0], stack[1], stack[2:])\n            inp = inp + [n1 + n2]\n        elif token == 'cache':\n            (n1, n2, stack) = (stack[0], stack[1], stack[1:])\n            fibDict[n1] = n2\n        else:\n            raise Exception()\n    return stack[0]\n</code></pre>\n\n<p>What I have tried in haskell:</p>\n\n<pre><code>while :: state -&gt; (state -&gt; Bool) -&gt; (state -&gt; state) -&gt; (state -&gt; result) -&gt; result\nwhile state eval bodyFn extractRes\n    | eval state = while (bodyFn state) eval bodyFn extractRes\n    | otherwise = extractRes state\n\ndata Input\n    = Word String | Num Integer\n    deriving (Eq, Show)\n\nword :: Input -&gt; String\nword (Word x) = x\n\nvalue :: Input -&gt; Integer\nvalue (Num x) = x\n\nfibTopDownIterWithCache :: Integer -&gt; Integer\nfibTopDownIterWithCache n = fibTopDownIterWithCache []\nfibTopDownIterWithCache n cache = while ([Word \"fib\", Num n], [])\n                                        (-- Just don't know how to implement the rest)\n</code></pre>\n\n<p>So, the cache has to be implemented as a Data.Map data type, and I have to attach the cache as an attribute of the function (which i have done, i think). Then I have to pass the cache around as an additional parameter. </p>\n\n<p>The expected value is just the nth fibonacci value. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 5, "creation_date": 1550458665, "post_id": 54739801, "comment_id": 96262108, "body": "This looks like the reader monad to me, but it wouldn&#39;t be pretty, exactly."}, {"owner": {"reputation": 893, "user_id": 6248287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tPegr.jpg?s=128&g=1", "display_name": "\u019b\u019b\u019b", "link": "https://stackoverflow.com/users/6248287/%c6%9b%c6%9b%c6%9b"}, "edited": false, "score": 0, "creation_date": 1550466039, "post_id": 54739801, "comment_id": 96263699, "body": "<a href=\"https://hackernoon.com/the-reader-monad-part-1-1e4d947983a8\" rel=\"nofollow noreferrer\">hackernoon.com/the-reader-monad-part-1-1e4d947983a8</a>"}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 1, "last_activity_date": 1550472575, "creation_date": 1550472575, "answer_id": 54741818, "question_id": 54739801, "link": "https://stackoverflow.com/questions/54739801/how-to-carry-a-value-across-function-call-chains/54741818#54741818", "title": "How to carry a value across function call chains", "body": "<p>The simplest way to address such concerns is, in my opinion, to use <strong>partial application</strong>, like this:</p>\n\n<pre><code>main = do\n  let settings = Settings { dbName=\"prod\" }\n  let getUserId' = getUserId settings\n  let hasPermission' = hasPermission settings\n  let _permission = hasPermission' $ getUserId' \"bob\"\n  print _permission\n</code></pre>\n\n<p>If you put the 'common' argument last, however, you can also use the built-in <strong>reader monad</strong> instance:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  let getPermission = (flip getUserId) \"bob\" &gt;&gt;= (flip hasPermission)\n  print $ getPermission $ Settings { dbName=\"prod\" }\n</code></pre>\n\n<p>Here <code>getPermission</code> is a local function with the type <code>Settings -&gt; Bool</code>. Typically, I consider the first option (partial application) to be simpler and easier to understand.</p>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 0, "last_activity_date": 1550473728, "last_edit_date": 1550473728, "creation_date": 1550473422, "answer_id": 54741969, "question_id": 54739801, "link": "https://stackoverflow.com/questions/54739801/how-to-carry-a-value-across-function-call-chains/54741969#54741969", "title": "How to carry a value across function call chains", "body": "<p>There is a feature called <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#implicit-parameters\" rel=\"nofollow noreferrer\">implicit parameters</a>, which has somewhat gone out of style lately, but I believe it is still supported, which offers a nice solution for this. </p>\n\n<pre><code>{-# LANGUAGE ImplicitParams #-}\n\ndata Settings = Settings { dbName :: String } deriving Show\n\ngetUserId :: (?settings :: Settings) =&gt; String -&gt; Int\ngetUserId username = 1\n\nhasPermission :: (?settings :: Settings) =&gt; Int -&gt; Bool\nhasPermission userId = True\n\nmain = do\n    let ?settings = Settings { dbName = \"prod\" }\n    print $ hasPermission (getUserId \"bob\")\n</code></pre>\n\n<p>See also the <a href=\"http://okmij.org/ftp/Haskell/tr-15-04.pdf\" rel=\"nofollow noreferrer\">implicit configurations</a> paper, which explores this problem in quite some depth, and its corresponding library, <a href=\"http://hackage.haskell.org/package/reflection\" rel=\"nofollow noreferrer\"><code>reflection</code></a>.</p>\n"}], "owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1550473728, "creation_date": 1550457874, "last_edit_date": 1550473444, "question_id": 54739801, "link": "https://stackoverflow.com/questions/54739801/how-to-carry-a-value-across-function-call-chains", "title": "How to carry a value across function call chains", "body": "<p>Let's say I have the following data structure and functions:</p>\n\n<pre><code>data Settings = Settings { dbName :: String } deriving Show\n\n-- username to user id lookup\ngetUserId :: Settings -&gt; String -&gt; Int\ngetUserId settings username = 1\n\n-- checks permission for a given user id\nhasPermission :: Settings -&gt; Int -&gt; Bool\nhasPermission settings userId = True\n</code></pre>\n\n<p>I'd like to be able to chain <code>getUserId</code> and <code>hasPermission</code> with some syntactic sugar without having to carry instance of <code>Settings</code> as I chain the function calls. Something like this:</p>\n\n<pre><code>main = do\n  let _permission = Settings{dbName=\"prod\"} &gt;&gt;= getUserId \"bob\" &gt;&gt; hasPermission\n  print _permission\n</code></pre>\n\n<p>This (obviously) does not work.</p>\n\n<p>Any go-to patterns for this this?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3629, "user_id": 379639, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4fa63505dd4dd4691b87d30508b1bfd3?s=128&d=identicon&r=PG", "display_name": "Xavier Shay", "link": "https://stackoverflow.com/users/379639/xavier-shay"}, "edited": false, "score": 0, "creation_date": 1550504064, "post_id": 54746507, "comment_id": 96283339, "body": "This is fantastic, thanks. It also means I can use a typeclass (e.g. <code>Show a</code>) rather than a concrete <code>String</code> for the implementation piece - which is a limitation I was running into with the <code>Data</code> approach."}], "tags": [], "owner": {"reputation": 2350, "user_id": 10033674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bbU6P.jpg?s=128&g=1", "display_name": "Karol Samborski", "link": "https://stackoverflow.com/users/10033674/karol-samborski"}, "is_accepted": true, "score": 2, "last_activity_date": 1550490087, "creation_date": 1550490087, "answer_id": 54746507, "question_id": 54738623, "link": "https://stackoverflow.com/questions/54738623/generic-conversion-of-simple-adt-to-array/54746507#54746507", "title": "Generic conversion of simple ADT to array", "body": "<p>When using generics you don't need to merge two types of information. All you need is to handle each possible type via instances.</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE DefaultSignatures #-}\n{-# LANGUAGE TypeOperators #-}\nimport GHC.Generics\n\ntype PlayerId = String\ndata Location = Deck | Hand PlayerId deriving Generic\n\ninstance MyClass Location\n\nclass MyClass a where\n  myF :: a -&gt; [String]\n  default myF :: (Generic a, MyClass1 (Rep a)) =&gt; a -&gt; [String]\n  myF = defaultMyF\n\ndefaultMyF :: (Generic a, MyClass1 (Rep a)) =&gt; a -&gt; [String]\ndefaultMyF a = myF1 $ from a\n</code></pre>\n\n<p><code>Rep a</code> has kind <code>* -&gt; *</code> so we cannot implement <code>MyClass</code> directly for <code>U1</code>, <code>V1</code>, <code>M1</code> etc. Instead we need another class where <code>myF</code> would have type <code>:: a b -&gt; [String]</code>. </p>\n\n<pre><code>class MyClass1 a where\n  myF1 :: a b -&gt; [String]\n\ninstance MyClass1 V1 where\n  myF1 _ = []\n\ninstance MyClass1 U1 where\n  myF1 _ = []\n\ninstance MyClass1 (K1 i String) where\n  myF1 (K1 a) = [a]\n\ninstance (MyClass1 f, Constructor t) =&gt; MyClass1 (C1 t f) where\n  myF1 c@(M1 a) = (conName c) : myF1 a\n\ninstance (MyClass1 f) =&gt; MyClass1 (D1 t f) where\n  myF1 (M1 a) = myF1 a\n\n\ninstance (MyClass1 f) =&gt; MyClass1 (S1 t f) where\n  myF1 (M1 a) = myF1 a\n\ninstance (MyClass1 a, MyClass1 b) =&gt; MyClass1 (a :+: b) where\n  myF1 (L1 x) = myF1 x\n  myF1 (R1 x) = myF1 x\n\ninstance (MyClass1 a, MyClass1 b) =&gt; MyClass1 (a :*: b) where\n  myF1 (a :*: b) = myF1 a ++ myF1 b\n</code></pre>\n\n<p>And now you can test it:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  putStrLn $ show $ myF Deck\n  putStrLn $ show $ myF $ Hand \"1234\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3629, "user_id": 379639, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4fa63505dd4dd4691b87d30508b1bfd3?s=128&d=identicon&r=PG", "display_name": "Xavier Shay", "link": "https://stackoverflow.com/users/379639/xavier-shay"}, "edited": false, "score": 0, "creation_date": 1550618768, "post_id": 54761133, "comment_id": 96332686, "body": "oh nice, I haven&#39;t looked at this library yet. Thanks!"}], "tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": false, "score": 2, "last_activity_date": 1550562619, "creation_date": 1550562619, "answer_id": 54761133, "question_id": 54738623, "link": "https://stackoverflow.com/questions/54738623/generic-conversion-of-simple-adt-to-array/54761133#54761133", "title": "Generic conversion of simple ADT to array", "body": "<p>Here is a solution using <a href=\"http://hackage.haskell.org/package/generics-sop\" rel=\"nofollow noreferrer\">generics-sop</a>.</p>\n\n<pre><code>{-# LANGUAGE DeriveAnyClass, DeriveGeneric, FlexibleContexts, ScopedTypeVariables, TypeApplications #-}\n\nimport Data.Char\nimport Generics.SOP\nimport qualified GHC.Generics as GHC\n\ntype PlayerId = String\ndata Location = Deck | Hand PlayerId\n  deriving (GHC.Generic, Generic, HasDatatypeInfo)\n</code></pre>\n\n<p>The library uses its own generic representation which can either be derived automatically from the GHC <code>Generic</code> class or via Template Haskell. We use the former approach, which means we have to derive <code>GHC.Generic</code> via the <code>DeriveGeneric</code> extension and then SOP's <code>Generic</code> and <code>HasDatatypeInfo</code> classes via the <code>DeriveAnyClass</code> extension.</p>\n\n<p>We now proceed in two steps. The first is just to get the name of the constructor of a value as a lowercase string (because that's what you used in the example). A variant of this function should really be in the library, but unfortunately, it isn't, so we have to define it ourselves:</p>\n\n<pre><code>lcConstructor :: forall a . (Generic a, HasDatatypeInfo a) =&gt; a -&gt; String\nlcConstructor x =\n  hcollapse\n    (hzipWith\n      (\\ c _ -&gt; K (map toLower (constructorName c)))\n      (constructorInfo (datatypeInfo (Proxy @a)))\n      (unSOP (from x))\n    )\n</code></pre>\n\n<p>In essence, <code>constructorInfo (datatypeInfo (Proxy @a))</code> constructs a table of all the constructor information for the type <code>a</code>. The call to <code>hzipWith</code> then selects the right components from the table (the one corresponding to the value <code>x</code> in question). Furthermore, we extract the name from the constructor info and turn it into lowercase characters.</p>\n\n<p>We can test this part:</p>\n\n<pre><code>GHCi&gt; lcConstructor Deck\n\"deck\"\nGHCi&gt; lcConstructor (Hand \"42\")\n\"hand\"\n</code></pre>\n\n<p>The remaining work is to get string representations of all the constructor arguments and append them to the constructor name:</p>\n\n<pre><code>myF :: (Generic a, HasDatatypeInfo a, All2 Show (Code a)) =&gt; a -&gt; [String]\nmyF a =\n  (lcConstructor a :) . hcollapse . hcmap (Proxy @Show) (mapIK show) . from $ a\n</code></pre>\n\n<p>Here, <code>from</code> turns the value into its representation, then <code>hcmap</code> turns all the arguments of the constructor into strings using <code>show</code>, then <code>hcollapse</code> extracts the results as a list of strings, and <code>(lcConstructor :)</code> prepends the name of the constructor.</p>\n\n<pre><code>GHCi&gt; myF Deck\n[\"deck\"]\nGHCi&gt; myF (Hand \"42\")\n[\"hand\", \"\\\"42\\\"\"]\n</code></pre>\n"}], "owner": {"reputation": 3629, "user_id": 379639, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4fa63505dd4dd4691b87d30508b1bfd3?s=128&d=identicon&r=PG", "display_name": "Xavier Shay", "link": "https://stackoverflow.com/users/379639/xavier-shay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 54746507, "answer_count": 2, "score": 3, "last_activity_date": 1550562619, "creation_date": 1550445781, "last_edit_date": 1550448911, "question_id": 54738623, "link": "https://stackoverflow.com/questions/54738623/generic-conversion-of-simple-adt-to-array", "title": "Generic conversion of simple ADT to array", "body": "<p>Given a sum type:</p>\n\n<pre><code>type PlayerId = String\ndata Location = Deck | Hand PlayerId\n</code></pre>\n\n<p>How can I write either of these two functions (I don't care which generic approach to take ... bonus points for helping me figure out which is more appropriate):</p>\n\n<pre><code>myF :: Generic a =&gt; a -&gt; [String]\nmyF :: Data a =&gt; a -&gt; [String]\n\n-- roughly equivalent to\nmyF :: Location -&gt; [String]\nmyF x = case x of\n          Deck     -&gt; [\"deck\"]\n          Hand pid -&gt; [\"hand\", show pid]\n</code></pre>\n\n<p>(For any \"invalid\" type, e.g. the argument is not <code>Show</code>able, either return <code>[]</code> or <code>error</code>.)</p>\n\n<p>Context: I have a number of similar enum-like types that I want to generically define <code>Data.Aeson.ToJSON</code> instances for, though given <code>myF</code> above I know how to do the rest. Though mostly I'm just doing this to learn more about generic programming.</p>\n\n<p><strong>Attempts:</strong></p>\n\n<p><strong>Using <code>Generic</code></strong></p>\n\n<pre><code>\u03bb&gt; unM1 $ from Deck\n(L1 (M1 {unM1 = U1}))\n\n\u03bb&gt; :t (undefined :: Rep Location p)\n(undefined :: Rep Location p)\n  :: D1\n       ('MetaData \"Location\" \"Test\" \"main\" 'False)\n       (\n         C1 ('MetaCons \"Deck\" 'PrefixI 'False) U1\n         :+:\n         C1\n           ('MetaCons \"Hand\" 'PrefixI 'False)\n           (S1\n              ('MetaSel\n                 'Nothing 'NoSourceUnpackedness 'NoSourceStrictness 'DecidedLazy)\n              (Rec0 String)))\n</code></pre>\n\n<p>Since <code>:+:</code> is defined as <code>L1 | R1</code>, I could probably \"merge\" the above two results. I'm not sure of a neat way I'd do this though .. maybe pattern match on the former and use it to \"descend\" in to the latter - but I'm not sure how to cross over between the type definition and real code.</p>\n\n<p><strong>Using <code>Data</code></strong></p>\n\n<p>AFAICT <code>Data</code> is an alternate approach to generics. You would use <em>either</em> <code>Generic</code> <em>or</em> <code>Data</code>, right?</p>\n\n<p>I think I need to use one of the <code>gmap*</code> functions, but I can't figure out how to relate the types to my problem. Have tried some exploratory \"plug random arguments in to various methods\" but didn't get anywhere interesting.</p>\n\n<p><em>UPDATE!</em> I tried to simplify my example, but I may have done so too much. In my actual code, <code>PlayerId</code> is a newtype around string. The following \"works\" in that case (modulo lower casing the constructor name):</p>\n\n<pre><code>mkQ :: (Typeable a, Typeable b) =&gt; r -&gt; (b -&gt; r) -&gt; a -&gt; r\n(r `mkQ` q) a = case cast a of\n                  Just b -&gt; q b\n                  Nothing -&gt; r\n\nmyF :: Data a =&gt; a -&gt; [String]\nmyF input =\n  [showConstr . toConstr $ input]\n  ++ gmapQ (\\x -&gt; (\"\" `mkQ` f) x) input\n\nf :: PlayerId -&gt; String\nf (PlayerId x) = x\n</code></pre>\n\n<p>The insight here was that constructors and arguments need to be treated differently. A remaining problem is that the above code needs to know about <code>PlayerId</code>. The following doesn't work:</p>\n\n<pre><code>f :: Show a =&gt; a -&gt; String\nf = show\n</code></pre>\n\n<p>... since that doesn't match the type signature of <code>gmapQ</code>. I think I understand why this is the case: the way gmapQ works is by using <code>cast</code> and this definition of <code>f</code> isn't concrete enough to give it an actual type to cast to. I'm not sure if there is a way around this, or if it is a limitation of using <code>Data</code>. (This is still probably workable though, if not ideal: I can imagine a case where I have <code>myF</code> parameterized by some <code>fs</code> that are specific to the particular arguments in the type.)</p>\n\n<p>It also doesn't feel right because I copied the <code>mkQ</code> function from the <a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/2003/01/hmap.pdf\" rel=\"nofollow noreferrer\">original SYB paper</a> ... I would have thought I should be able to do this using functions provided by <code>Data.Data</code>.</p>\n"}, {"tags": ["haskell", "recursion", "tree", "binary-tree"], "comments": [{"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1550443901, "post_id": 54738406, "comment_id": 96259324, "body": "@Willem Van Onsem: then it is really a unary tree, consisting of a mother node, and a single daughter node, which is a leaf. I will edit my question."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550445251, "post_id": 54738406, "comment_id": 96259592, "body": "I&#39;ve only had a brief look, but I&#39;m not quite sure of what the recursive pattern is here. It&#39;s the same <i>shape</i> as <code>reverseFlatten (x:y:xs) = Node (Leaf x) y (reverseFlatten xs)</code> I think (with the singleton and 2-element list cases explicitly as you have them above), but the precise way the list elements are assigned to nodes or leaves seems strange. Can you explain the thought process in words? [Doing so will probably take you a long way towards getting the right recursive definition.]"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550447127, "post_id": 54738406, "comment_id": 96259960, "body": "@Robin Zigmond: We form <code>Node (Leaf x) y (Leaf z)</code> from  <code>[x,y,z]</code>, and then  <code>Node (Leaf x) y (UNode z (Leaf x&#39;) )</code> from <code>[x,y,z,x&#39;]</code>. Then for <code>[x, y, z, x&#39;, y&#39;] I wanted to preserve </code>z` in its previous position in the case for <code>reverseflatten [x,y,z]</code>, and so position <code>z</code> as in <code>Node (Leaf x&#39;) z (Leaf y&#39;)</code>, in the second place. I then wanted <code>x&#39;</code> and <code>y&#39;</code> to be the daughters of <code>z</code>, in the order in which they are present in the list, hence <code>Node (Leaf x&#39;) z (Leaf y&#39;)</code>."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550447313, "post_id": 54738406, "comment_id": 96260015, "body": "@Robin Zigmond:  Then for <code>reverseflatten [x,y,z,x&#39;,y&#39;,z&#39;,x&#39;&#39;]</code> I had a similar idea in mind (I wanted <code>y&#39;</code>&#39; to remain a mother node (as it is in the case <code>reverseflatten [x,y,z,x&#39;,y&#39;]</code> and <code>reverseflatten [x,y,z,x&#39;,y&#39;,z&#39;]</code>) , with daughters <code>z&#39;</code> and <code>x&#39;</code>)"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550447523, "post_id": 54738406, "comment_id": 96260059, "body": "@Robin Zigmond: So the general idea is that whenever the list is odd, we preserve the tree as it was for the previous odd numbered list, but add two daughters: one daughter to the bottom left of the final rightmost element of the tree corresponding to the previous odd numbered list, and the other daughter to the bottom right."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550447953, "post_id": 54738406, "comment_id": 96260144, "body": "Thanks, I appreciate the explanation. Unfortunately I&#39;m about to go to bed and don&#39;t want to think too hard about it now - I expect someone else will have posted an answer by the time I wake up, but if not I&#39;ll return to it."}, {"owner": {"reputation": 1104, "user_id": 9769772, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Koralp Catalsakal", "link": "https://stackoverflow.com/users/9769772/koralp-catalsakal"}, "edited": false, "score": 0, "creation_date": 1550451598, "post_id": 54738406, "comment_id": 96260820, "body": "@user65526 can you check my edited code in the answer ?"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 1104, "user_id": 9769772, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Koralp Catalsakal", "link": "https://stackoverflow.com/users/9769772/koralp-catalsakal"}, "edited": false, "score": 0, "creation_date": 1550472170, "post_id": 54738406, "comment_id": 96265568, "body": "@Koralp Catalsakal: That&#39;s it :) ! It works."}], "answers": [{"comments": [{"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1550446688, "post_id": 54738585, "comment_id": 96259855, "body": "@Koralp Catalsakal: This doesn&#39;t quite generate the pattern I wanted (see my comment to Robin Zigmond)"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550446707, "post_id": 54738585, "comment_id": 96259860, "body": "@Robin Zigmond: Yes, I had wanted it to be as in my example. So how do I modify the above to account for that? For example, I want a list <code>[1..5]</code> to go to <code>Node (Leaf 1) 2 (Node (Leaf 4) 3 (Leaf 5))</code> and <code>[1..7]</code> to go to <code>Node (Leaf 1) 2 (Node (Leaf 4) 3 (Node (Leaf 6) 5 (Leaf 7)))</code>."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550447158, "post_id": 54738585, "comment_id": 96259972, "body": "@Robin Zigmond: written a response above :)"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1550472776, "post_id": 54738585, "comment_id": 96265787, "body": "@Koralp Catalsakal: Also, at the moment <code>reverseflatten [1..5]</code> is <code>Node (Leaf 1) 2 (Node (Leaf 4) 3 (Leaf 5)</code>, but <code>(reverseflatten(flatten(reverseflatten [1..5])))</code> does not return <code>reverseflatten [1..5]</code>, which is what would be ideal. How could <code>flatten</code> be modified so that <code>reverseflatten x: xs</code> is <code>(reverseflatten(flatten(reverseflatten x:xs)))</code>?"}, {"owner": {"reputation": 1104, "user_id": 9769772, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Koralp Catalsakal", "link": "https://stackoverflow.com/users/9769772/koralp-catalsakal"}, "reply_to_user": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1550490246, "post_id": 54738585, "comment_id": 96274888, "body": "@user65526 In <code>reverseflatten</code>, we switch the ordering of the array. For example, for the input of [1,2,3,4,5] our <code>reverseflatten</code> gives an output of [1,2,4,3,5]. However, the <code>flatten</code> function does not capture this and assumes the ordering of the array is the order of the tree. Therefore, to be able to use <code>flatten</code> correctly, you will need to reverse the switching operation in <code>reverseflatten</code>. I can&#39;t currently work on it, but will try if I have the time :)"}], "tags": [], "owner": {"reputation": 1104, "user_id": 9769772, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Koralp Catalsakal", "link": "https://stackoverflow.com/users/9769772/koralp-catalsakal"}, "is_accepted": true, "score": 3, "last_activity_date": 1550451577, "last_edit_date": 1550451577, "creation_date": 1550445394, "answer_id": 54738585, "question_id": 54738406, "link": "https://stackoverflow.com/questions/54738406/defining-a-function-from-lists-to-binary-and-unary-trees/54738585#54738585", "title": "Defining a function from lists to binary and unary trees", "body": "<p>I tried to change the code to capture the pattern you were asking for. My implementation is not very efficient, but could not think of any at the moment. \nI hope that I understood the pattern correctly.</p>\n\n<pre><code>reverseflatten :: [a] -&gt; Tree a\nreverseflatten [x] = (Leaf x)\nreverseflatten [x,y] = UNode x (Leaf y)\nreverseflatten [x,y,z] = Node (Leaf x) y (Leaf z)\nreverseflatten (x:y:xs) = revflat2 (x:y:xs)\n\nrevflat2 :: [a] -&gt; Tree a\nrevflat2 [x] = (Leaf x)\nrevflat2 [x,y] = UNode y (Leaf x)\nrevflat2 [x,y,z] = Node (Leaf x) y (Leaf z)\nrevflat2 (x:y:xs) = Node (Leaf x) y (revflat2 ([head $ tail xs] ++ [head xs] ++ tail (tail xs)))\n</code></pre>\n"}], "owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 54738585, "answer_count": 1, "score": 0, "last_activity_date": 1550451577, "creation_date": 1550443764, "last_edit_date": 1550449331, "question_id": 54738406, "link": "https://stackoverflow.com/questions/54738406/defining-a-function-from-lists-to-binary-and-unary-trees", "title": "Defining a function from lists to binary and unary trees", "body": "<p>Consider binary and unary trees, as defined by the following type, and a function <code>flatten</code>, which converts binary and unary trees to lists (e.g, <code>flatten (Node (Leaf 10) 11 (Leaf 20))</code> is <code>[10,11,20]</code>):</p>\n\n<pre><code>data Tree a = Leaf a | Node (Tree a) a (Tree a) | UNode a (Tree a) deriving (Show)\nflatten :: Tree a -&gt; [a]\nflatten (Leaf x) = [x] \nflatten (Node l x r) = flatten l ++ [x] ++ flatten r\nflatten (UNode l x) = [l] ++ flatten x\n</code></pre>\n\n<p>I am trying to define a recursive function, <code>reverseflatten</code>, which converts lists to binary and unary trees, specifically <em>in the manner of the following pattern</em>, which works for lists of length &lt;= 7. I can see how the pattern would go on, but not how to create a recursive function from my example:</p>\n\n<pre><code>reverseflatten :: [a] -&gt; Tree a\nreverseflatten [x] = (Leaf x)\nreverseflatten [x,y] = UNode x (Leaf y)\nreverseflatten [x,y,z] = Node (Leaf x) y (Leaf z)\nreverseflatten [x,y,z,x'] = Node (Leaf x) y (UNode z (Leaf x') )\nreverseflatten [x,y,z,x',y'] = Node (Leaf x) y ( Node (Leaf x') z (Leaf y'))\nreverseflatten [x,y,z,x',y',z'] =  Node (Leaf x) y ( Node (Leaf x') z ( UNode y' (Leaf z')))\nreverseflatten [x,y,z,x',y',z',x''] =  Node (Leaf x) y ( Node (Leaf x') z ( Node (Leaf z') y' (Leaf x'')))\n</code></pre>\n\n<p>How would I create such a recursive function, that for any finite list, forms a binary tree of the kind defined above? The answer below does not do this, since it does not follow the pattern above.</p>\n\n<hr>\n\n<p>Edit: \nThe procedure I followed for even lists > 2, should be fairly transparent (you take the tree corresponding to an odd list and then you add a unary node).\nThe general procedure I followed for constructing a tree from an odd-numbered list was this. <code>reverse flatten[x,y,z]</code> is <code>Node (Leaf x) y (Leaf z)</code>. Then for the next odd-numbered list up, <code>[x, y, z, x', y']</code>, I wanted to preserve <code>z</code> in its previous position in the case for <code>reverseflatten [x,y,z]</code> (in which <code>z</code> was the final bottom right leaf), and so position <code>z</code> as in <code>Node (Leaf x') z (Leaf y')</code>, in the second place, so that the tree for this case is just like the tree for <code>reverseflatten [x,y,z]</code>, except that we add nodes surrounding the bottom right leaf, <code>z</code>. I then wanted x' and y' to surround <code>z</code>, in the order in which they are present in the list, hence Node (Leaf x') z (Leaf y').\n Then for the next odd-numbered list <code>reverseflatten [x,y,z,x',y',z',x'']</code> , I had a similar idea in mind. I wanted <code>y'</code> to remain in its place in <code>reverseflatten [x,y,z,x',y']</code> and <code>reverseflatten [x,y,z,x',y',z', x'']</code>) to be constructed by surrounding <code>y'</code> by z' and x'', in the order in which they are present in the list.</p>\n"}, {"tags": ["haskell", "lambda", "haskell-platform"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1550433927, "post_id": 54737122, "comment_id": 96256821, "body": "Can you be a bit more specific? What do you understand about this, and what part is confusing you?"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 5536152, "user_type": "registered", "profile_image": "https://graph.facebook.com/1048959478461627/picture?type=large", "display_name": "Sven Kuffer", "link": "https://stackoverflow.com/users/5536152/sven-kuffer"}, "edited": false, "score": 0, "creation_date": 1550434634, "post_id": 54737178, "comment_id": 96257038, "body": "thanks for the explicit answer, still one tiny question, if I might ask. why does x+a result in (+a), what&#39;s the x and where did it go?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 61, "user_id": 5536152, "user_type": "registered", "profile_image": "https://graph.facebook.com/1048959478461627/picture?type=large", "display_name": "Sven Kuffer", "link": "https://stackoverflow.com/users/5536152/sven-kuffer"}, "edited": false, "score": 1, "creation_date": 1550434769, "post_id": 54737178, "comment_id": 96257075, "body": "@SvenKuffer: this is more simplified notation. This is called &quot;<i>operator section</i>&quot; iirc: <a href=\"https://wiki.haskell.org/Section_of_an_infix_operator\" rel=\"nofollow noreferrer\">wiki.haskell.org/Section_of_an_infix_operator</a>  so behind the curtains, it is still <code>\\x -&gt; x+a</code>, but this would result in our list in a lot of lambda expressions."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1550434827, "last_edit_date": 1550434827, "creation_date": 1550433957, "answer_id": 54737178, "question_id": 54737122, "link": "https://stackoverflow.com/questions/54737122/haskell-map-functions-and-lambda-expressions/54737178#54737178", "title": "Haskell map functions and lambda expressions", "body": "<p>There are two maps here, let us first analyze the subexpression:</p>\n\n<pre><code>map (\\a x -&gt; x + a) [1,2,3]\n</code></pre>\n\n<p>We can write the lambda expression in a form that is probably better for the above case:</p>\n\n<pre><code>map (\\a -&gt; (\\x -&gt; x + a)) [1,2,3]\n</code></pre>\n\n<p>So this is a function that takes a parameter <code>a</code> and returns a function. So it will return a function that takes a parameter <code>x</code> that maps to <code>x + a</code>. Thus that means that the second <code>map</code> produces a <em>list of functions</em>. Indeed, so the above expression is equivalent to:</p>\n\n<pre><code>[(+1), (+2), (+3)]\n</code></pre>\n\n<p>or more verbose:</p>\n\n<pre><code>[\\x -&gt; x+1, \\x -&gt; x+2, \\x -&gt; x+3]\n</code></pre>\n\n<p>here the <code>x</code>s in the lambda expressions are different variables.</p>\n\n<p>Now the first map takes these functions, and maps these on calling the function with value one, so, this expression:</p>\n\n<pre><code>map (\\a -&gt; a 1) [(+1), (+2), (+3)]\n</code></pre>\n\n<p>is equivalent to:</p>\n\n<pre><code>[(+1) 1, (+2) 1, (+3) 1]\n</code></pre>\n\n<p>and thus equivalent to:</p>\n\n<pre><code>[2,3,4]\n</code></pre>\n\n<p>as you found out.</p>\n\n<p>We can syntactically simplify this function to:</p>\n\n<pre><code>j :: Num a =&gt; [a]\nj = map ($ 1) (map (+) [1,2,3])\n</code></pre>\n\n<p>which is semantically equivalent to:</p>\n\n<pre><code>j :: Num a =&gt; [a]\nj = map (+1) [1,2,3]\n</code></pre>\n\n<p>and hence:</p>\n\n<pre><code>j :: Num a =&gt; [a]\nj = [2,3,4]\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5536152, "user_type": "registered", "profile_image": "https://graph.facebook.com/1048959478461627/picture?type=large", "display_name": "Sven Kuffer", "link": "https://stackoverflow.com/users/5536152/sven-kuffer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2030, "favorite_count": 0, "accepted_answer_id": 54737178, "answer_count": 1, "score": 4, "last_activity_date": 1550434827, "creation_date": 1550433597, "question_id": 54737122, "link": "https://stackoverflow.com/questions/54737122/haskell-map-functions-and-lambda-expressions", "title": "Haskell map functions and lambda expressions", "body": "<p>I've got this expression in Haskell, now I don't understand exactly how this is applied. Typing in j returns [2,3,4]   </p>\n\n<pre><code>j :: [Int]\nj = map (\\a -&gt; a 1) (map (\\a x -&gt; x + a) [1,2,3])\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550434239, "post_id": 54733948, "comment_id": 96256923, "body": "<i>please</i> stop pasting code in ghci as your way of developing! It hurts me to watch! Get a proper editor and load the file with <code>:load</code> or command line argument."}], "answers": [{"comments": [{"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1550413190, "post_id": 54734016, "comment_id": 96250595, "body": "The code in your answer produces <code>&lt;interactive&gt;:478:14: error: parse error on input \u2018brak\u2019</code>. How come?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 1, "creation_date": 1550413328, "post_id": 54734016, "comment_id": 96250622, "body": "@user65526: sorry, there was some problem with the indentation when pasting this."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1550413538, "post_id": 54734016, "comment_id": 96250678, "body": "How do you know when <code>where</code> requires a new line in Haskell (as in the second occurrence of <code>where</code> in your code), and when <code>where</code> can be at the end of a line (as in the first occurrence of <code>where</code> in the code above)? So whenever <code>where</code> starts a new line it must be indented? And then the next line after must be indented further, as with <code>brak e</code>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1550413660, "post_id": 54734016, "comment_id": 96250708, "body": "@user65526: <code>where</code> does not requires a new line. THe idea is that Haskell is a language that uses spacing as a way to define a scope, so since we have two clauses for <code>brak</code>, we need to indent it at the same level."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1550413950, "post_id": 54734016, "comment_id": 96250778, "body": "The code you provided above still produces a few of the error messages I wrote in my question."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1550414053, "post_id": 54734016, "comment_id": 96250797, "body": "@user65526: it looks as if you defined it as <code>data Expr = Val Expr | App Op Expr Expr</code>, not as  <code>data Expr = Val Int | App Op Expr Expr</code>, or as said before, but I can not check, did not create an instance of <code>Show</code> for <code>Op</code>."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1550414295, "post_id": 54734016, "comment_id": 96250864, "body": "I have the following instance for <code>Op</code> (where each occurrence of lower case <code>show</code> is on a separate line, and indented with respect to <code>instance</code>):  <code>instance Show Op where show Add = &quot;+&quot; show Sub = &quot;-&quot; show Mul = &quot;*&quot; show Div = &quot;&#47;&quot;</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1550414510, "post_id": 54734016, "comment_id": 96250906, "body": "@user65526: well I ran this on the shell, see above."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1550414910, "post_id": 54734016, "comment_id": 96251012, "body": "I tried out the code in your answer, and receive the errors which I have just put under &#39;Edit&#39; in my question."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1550415144, "post_id": 54734016, "comment_id": 96251085, "body": "@user65526: it looks like you defined a <code>show</code> <i>not</i> in an <code>instance Show</code> block, and thus have <i>overwritten</i> the <code>show</code> function. Probably you better restart a session"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1550414496, "last_edit_date": 1550414496, "creation_date": 1550412120, "answer_id": 54734016, "question_id": 54733948, "link": "https://stackoverflow.com/questions/54733948/errors-involving-expected-types/54734016#54734016", "title": "Errors involving expected types", "body": "<p>The only error I spot here is that <code>n</code> is an <code>Int</code>, and thus you need to use <code>show</code> to convert that to a <code>String</code>:</p>\n\n<pre><code>instance Show Expr where\n    show (Val n) = <b>show</b> n\n    show (App o l r) = brak l ++ show o ++ brak r \n        where brak (Val n) = show n\n              brak e = &quot;(&quot; ++ show e ++ &quot;)&quot;</code></pre>\n\n<p>Furthermore you do not show the type of <code>Op</code>, but this should be a type that is an instance of <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#t:Show\" rel=\"nofollow noreferrer\"><strong><code>Show</code></strong></a> as well, so you should define a <code>instance Show Op</code>.</p>\n\n<p>For example:</p>\n\n<pre><code>Prelude&gt; data Op = Add | Sub | Mul | Div\nPrelude&gt; :{\nPrelude| instance Show Op where\nPrelude|     show Add = \"+\"\nPrelude|     show Sub = \"-\"\nPrelude|     show Mul = \"*\"\nPrelude|     show Div = \"/\"\nPrelude| :}\nPrelude&gt; data Expr = Val Int | App Op Expr Expr\nPrelude&gt; :{\nPrelude| instance Show Expr where\nPrelude|     show (Val n) = show n\nPrelude|     show (App o l r) = brak l ++ show o ++ brak r \nPrelude|         where brak (Val n) = show n\nPrelude|               brak e = \"(\" ++ show e ++ \")\"\nPrelude| :}\n</code></pre>\n\n<p>and then we can query it like:</p>\n\n<pre><code>Prelude&gt; show (App Mul (Val 3) (App Add (Val 3) (Val 2)))\n\"3*(3+2)\"\n</code></pre>\n"}], "owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 54734016, "answer_count": 1, "score": 2, "last_activity_date": 1550414837, "creation_date": 1550411704, "last_edit_date": 1550414837, "question_id": 54733948, "link": "https://stackoverflow.com/questions/54733948/errors-involving-expected-types", "title": "Errors involving expected types", "body": "<p>The following piece of code (which is taken from Graham Hutton's \"Programming in Haskell\" (Chapter 9))</p>\n\n<pre><code>:{\nPrelude| data Op = Add | Sub | Mul | Div\nPrelude| instance Show Op where\nPrelude|    show Add = \"+\"\nPrelude|    show Sub = \"-\"\nPrelude|    show Mul = \"*\"\nPrelude|    show Div = \"/\"\nPrelude| valid :: Op -&gt; Int -&gt; Int -&gt; Bool\nPrelude| valid Add _ _ = True\nPrelude| valid Sub x y = x &gt; y\nPrelude| valid Mul _ _ = True\nPrelude| valid Div x y = x `mod` y == 0\nPrelude| apply :: Op -&gt; Int -&gt; Int -&gt; Int\nPrelude| apply Add x y = x + y\nPrelude| apply Sub x y = x - y\nPrelude| apply Mul x y = x * y\nPrelude| apply Div x y = x `div` y\nPrelude| data Expr = Val Int | App Op Expr Expr\nPrelude| instance Show Expr where\nPrelude|       show (Val n) = n\nPrelude|       show (App o l r) = brak l ++ show o ++ brak r \nPrelude|                          where\nPrelude|                             brak (Val n ) = show n\nPrelude|                             brak e = \"(\" ++ show e ++ \")\"\nPrelude| :}\n</code></pre>\n\n<p>generates these errors:</p>\n\n<pre><code>&lt;interactive&gt;:455:22: error:\n\u2022 Couldn't match type \u2018Int\u2019 with \u2018[Char]\u2019\n  Expected type: String\n    Actual type: Int\n\u2022 In the expression: n\n  In an equation for \u2018Prelude.show\u2019: Prelude.show (Val n) = n\n  In the instance declaration for \u2018Show Expr\u2019\n\n&lt;interactive&gt;:456:26: error:\n\u2022 Couldn't match expected type \u2018[Char]\u2019 with actual type \u2018Int\u2019\n\u2022 In the first argument of \u2018(++)\u2019, namely \u2018brak l\u2019\n  In the expression: brak l ++ show o ++ brak r\n  In an equation for \u2018Prelude.show\u2019:\n      Prelude.show (App o l r)\n        = brak l ++ show o ++ brak r\n        where\n            brak (Val n) = show n\n            brak e = \"(\" ++ show e ++ \")\"\n\n&lt;interactive&gt;:456:36: error:\n\u2022 Couldn't match expected type \u2018[Char]\u2019 with actual type \u2018Int\u2019\n\u2022 In the first argument of \u2018(++)\u2019, namely \u2018show o\u2019\n  In the second argument of \u2018(++)\u2019, namely \u2018show o ++ brak r\u2019\n  In the expression: brak l ++ show o ++ brak r\n\n&lt;interactive&gt;:456:41: error:\n\u2022 Couldn't match expected type \u2018Ghci41.Expr\u2019 with actual type \u2018Op\u2019\n\u2022 In the first argument of \u2018show\u2019, namely \u2018o\u2019\n  In the first argument of \u2018(++)\u2019, namely \u2018show o\u2019\n  In the second argument of \u2018(++)\u2019, namely \u2018show o ++ brak r\u2019\n\n&lt;interactive&gt;:456:46: error:\n\u2022 Couldn't match expected type \u2018[Char]\u2019 with actual type \u2018Int\u2019\n\u2022 In the second argument of \u2018(++)\u2019, namely \u2018brak r\u2019\n  In the second argument of \u2018(++)\u2019, namely \u2018show o ++ brak r\u2019\n  In the expression: brak l ++ show o ++ brak r\n\n&lt;interactive&gt;:458:50: error:\n\u2022 Couldn't match expected type \u2018Ghci41.Expr\u2019 with actual type \u2018Int\u2019\n\u2022 In the first argument of \u2018show\u2019, namely \u2018n\u2019\n  In the expression: show n\n  In an equation for \u2018brak\u2019: brak (Val n) = show n\n\n&lt;interactive&gt;:459:38: error:\n\u2022 Couldn't match expected type \u2018Int\u2019 with actual type \u2018[Char]\u2019\n\u2022 In the expression: \"(\" ++ show e ++ \")\"\n  In an equation for \u2018brak\u2019: brak e = \"(\" ++ show e ++ \")\"\n  In an equation for \u2018Prelude.show\u2019:\n      Prelude.show (App o l r)\n        = brak l ++ show o ++ brak r\n        where\n            brak (Val n) = show n\n            brak e = \"(\" ++ show e ++ \")\"\n\n&lt;interactive&gt;:459:45: error:\n\u2022 Couldn't match expected type \u2018[Char]\u2019 with actual type \u2018Int\u2019\n\u2022 In the first argument of \u2018(++)\u2019, namely \u2018show e\u2019\n  In the second argument of \u2018(++)\u2019, namely \u2018show e ++ \")\"\u2019\n  In the expression: \"(\" ++ show e ++ \")\"\n\n&lt;interactive&gt;:459:50: error:\n\u2022 Couldn't match expected type \u2018Ghci41.Expr\u2019\n              with actual type \u2018Expr\u2019\n  NB: \u2018Expr\u2019 is defined at &lt;interactive&gt;:453:1-38\n      \u2018Ghci41.Expr\u2019 is defined at &lt;interactive&gt;:246:1-35\n\u2022 In the first argument of \u2018show\u2019, namely \u2018e\u2019\n  In the first argument of \u2018(++)\u2019, namely \u2018show e\u2019\n  In the second argument of \u2018(++)\u2019, namely \u2018show e ++ \")\"\u2019\n</code></pre>\n\n<p>I do not understand what has gone wrong. Can anyone help? Do I need to declare the type of <code>n</code> to be a String, in order to deal with the first error? What are the other error reports pointing out?</p>\n\n<p>If I see error reports like these particular ones, what would be a good strategy for me to employ in order to avoid them?</p>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>I have tried out the code in the answer below, but I receive the following errors:</p>\n\n<pre><code>   &lt;interactive&gt;:520:20: error:\n\u2022 Couldn't match type \u2018Int\u2019 with \u2018[Char]\u2019\n  Expected type: String\n    Actual type: Int\n\u2022 In the expression: show n\n  In an equation for \u2018Prelude.show\u2019: Prelude.show (Val n) = show n\n  In the instance declaration for \u2018Show Expr\u2019\n\n&lt;interactive&gt;:520:25: error:\n\u2022 Couldn't match expected type \u2018Ghci41.Expr\u2019 with actual type \u2018Int\u2019\n\u2022 In the first argument of \u2018show\u2019, namely \u2018n\u2019\n  In the expression: show n\n  In an equation for \u2018Prelude.show\u2019: Prelude.show (Val n) = show n\n\n&lt;interactive&gt;:521:24: error:\n\u2022 Couldn't match expected type \u2018[Char]\u2019 with actual type \u2018Int\u2019\n\u2022 In the first argument of \u2018(++)\u2019, namely \u2018brak l\u2019\n  In the expression: brak l ++ show o ++ brak r\n  In an equation for \u2018Prelude.show\u2019:\n      Prelude.show (App o l r)\n        = brak l ++ show o ++ brak r\n        where\n            brak (Val n) = show n\n            brak e = \"(\" ++ show e ++ \")\"\n\n&lt;interactive&gt;:521:34: error:\n\u2022 Couldn't match expected type \u2018[Char]\u2019 with actual type \u2018Int\u2019\n\u2022 In the first argument of \u2018(++)\u2019, namely \u2018show o\u2019\n  In the second argument of \u2018(++)\u2019, namely \u2018show o ++ brak r\u2019\n  In the expression: brak l ++ show o ++ brak r\n\n&lt;interactive&gt;:521:39: error:\n\u2022 Couldn't match expected type \u2018Ghci41.Expr\u2019 with actual type \u2018Op\u2019\n\u2022 In the first argument of \u2018show\u2019, namely \u2018o\u2019\n  In the first argument of \u2018(++)\u2019, namely \u2018show o\u2019\n  In the second argument of \u2018(++)\u2019, namely \u2018show o ++ brak r\u2019\n\n&lt;interactive&gt;:521:44: error:\n\u2022 Couldn't match expected type \u2018[Char]\u2019 with actual type \u2018Int\u2019\n\u2022 In the second argument of \u2018(++)\u2019, namely \u2018brak r\u2019\n  In the second argument of \u2018(++)\u2019, namely \u2018show o ++ brak r\u2019\n  In the expression: brak l ++ show o ++ brak r\n\n&lt;interactive&gt;:522:34: error:\n\u2022 Couldn't match expected type \u2018Ghci41.Expr\u2019 with actual type \u2018Int\u2019\n\u2022 In the first argument of \u2018show\u2019, namely \u2018n\u2019\n  In the expression: show n\n  In an equation for \u2018brak\u2019: brak (Val n) = show n\n\n&lt;interactive&gt;:523:23: error:\n\u2022 Couldn't match expected type \u2018Int\u2019 with actual type \u2018[Char]\u2019\n\u2022 In the expression: \"(\" ++ show e ++ \")\"\n  In an equation for \u2018brak\u2019: brak e = \"(\" ++ show e ++ \")\"\n  In an equation for \u2018Prelude.show\u2019:\n      Prelude.show (App o l r)\n        = brak l ++ show o ++ brak r\n        where\n            brak (Val n) = show n\n            brak e = \"(\" ++ show e ++ \")\"\n\n&lt;interactive&gt;:523:30: error:\n\u2022 Couldn't match expected type \u2018[Char]\u2019 with actual type \u2018Int\u2019\n\u2022 In the first argument of \u2018(++)\u2019, namely \u2018show e\u2019\n  In the second argument of \u2018(++)\u2019, namely \u2018show e ++ \")\"\u2019\n  In the expression: \"(\" ++ show e ++ \")\"\n\n&lt;interactive&gt;:523:35: error:\n\u2022 Couldn't match expected type \u2018Ghci41.Expr\u2019\n              with actual type \u2018Expr\u2019\n  NB: \u2018Expr\u2019 is defined at &lt;interactive&gt;:518:1-38\n      \u2018Ghci41.Expr\u2019 is defined at &lt;interactive&gt;:246:1-35\n\u2022 In the first argument of \u2018show\u2019, namely \u2018e\u2019\n  In the first argument of \u2018(++)\u2019, namely \u2018show e\u2019\n  In the second argument of \u2018(++)\u2019, namely \u2018show e ++ \")\"\u2019\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1550413016, "post_id": 54733883, "comment_id": 96250554, "body": "Can you please show your full definition for <code>distribute_ones</code>? Your use of <code>!!</code> is unnecessary. Use <code>zipWith</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1550417784, "last_edit_date": 1550417784, "creation_date": 1550417465, "answer_id": 54734744, "question_id": 54733883, "link": "https://stackoverflow.com/questions/54733883/haskell-is-there-a-better-way-of-evenly-distributing-an-element-over-a-list/54734744#54734744", "title": "Haskell - Is there a better way of evenly distributing an element over a list", "body": "<p>For evenly distributing elements, I recommend Bjorklund's algorithm. Bjorklund's algorithm takes two sequences to merge, and repeatedly:</p>\n\n<ol>\n<li>Merges as much of the prefix of the two as it can, taking one from each, then</li>\n<li>recursively calls itself with the merged elements as one sequence and the leftovers from the longer input as the other sequence.</li>\n</ol>\n\n<p>In code:</p>\n\n<pre><code>bjorklund :: [[a]] -&gt; [[a]] -&gt; [a]\nbjorklund xs ys = case zipMerge xs ys of\n    ([], leftovers) -&gt; concat leftovers\n    (merged, leftovers) -&gt; bjorklund merged leftovers\n\nzipMerge :: [[a]] -&gt; [[a]] -&gt; ([[a]], [[a]])\nzipMerge [] ys = ([], ys)\nzipMerge xs [] = ([], xs)\nzipMerge (x:xs) (y:ys) = ((x++y):merged, leftovers) where\n    ~(merged, leftovers) = zipMerge xs ys\n</code></pre>\n\n<p>Here's some examples in ghci:</p>\n\n<pre><code>&gt; bjorklund (replicate 2 [1]) (replicate 2 [0])\n[1,0,1,0]\n&gt; bjorklund (replicate 5 [1]) (replicate 8 [0])\n[1,0,0,1,0,1,0,0,1,0,0,1,0]\n</code></pre>\n\n<p>If you like, you could write a small wrapper that takes just the arguments you care about.</p>\n\n<pre><code>ones len numOnes = bjorklund\n    (replicate ((-) len numOnes) [0])\n    (replicate (min len numOnes) [1])\n</code></pre>\n\n<p>In ghci:</p>\n\n<pre><code>&gt; map (ones 4) [2,3,2,10]\n[[0,1,0,1],[0,1,1,1],[0,1,0,1],[1,1,1,1]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": false, "score": 0, "last_activity_date": 1550499509, "creation_date": 1550499509, "answer_id": 54749254, "question_id": 54733883, "link": "https://stackoverflow.com/questions/54733883/haskell-is-there-a-better-way-of-evenly-distributing-an-element-over-a-list/54749254#54749254", "title": "Haskell - Is there a better way of evenly distributing an element over a list", "body": "<p>Here's an alternate algorithm to distribute <code>itemCount</code> items across <code>rowLength</code> cells within a single row.  Initialize <code>currentCount</code> to 0.  Then for each cell:</p>\n\n<ol>\n<li>Add <code>itemCount</code> to <code>currentCount</code>.</li>\n<li>If the new <code>currentCount</code> is less than <code>rowLength</code>, use the original value of the cell.</li>\n<li>If the new <code>currentCount</code> is at least <code>rowLength</code>, subtract <code>rowLength</code>, and increment the value of the cell by one.</li>\n</ol>\n\n<p>This algorithm produces the output you expect from the input you provide.</p>\n\n<p>We can write the state required for this as a simple data structure:</p>\n\n<pre><code>data Distribution = Distribution { currentCount :: Int\n                                 , itemCount    :: Int\n                                 , rowLength    :: Int\n                                 } deriving (Eq, Show)\n</code></pre>\n\n<p>At each step of the algorithm we need to know whether we're emitting an output (and incrementing the value), and what the next state value will be.</p>\n\n<pre><code>nextCount :: Distribution -&gt; Int\nnextCount d = currentCount d + itemCount d\n\nwillEmit :: Distribution -&gt; Bool\nwillEmit d = (nextCount d) &gt;= (rowLength d)\n\nnextDistribution :: Distribution -&gt; Distribution\nnextDistribution d = d { currentCount = (nextCount d) `mod` (rowLength d) }\n</code></pre>\n\n<p>To keep this as running state, we can package it in <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-State-Lazy.html#t:State\" rel=\"nofollow noreferrer\">the <code>State</code> monad</a>.  Then we can write the \"for each cell\" list above as a single function:</p>\n\n<pre><code>distributeCell :: Int -&gt; State Distribution Int\ndistributeCell x = do\n  emit &lt;- gets willEmit\n  modify nextDistribution\n  return $ if emit then x + 1 else x\n</code></pre>\n\n<p>To run this over a whole row, we can use the <a href=\"https://www.stackage.org/haddock/lts-12.20/base-4.11.1.0/Prelude.html#v:traverse\" rel=\"nofollow noreferrer\"><code>traverse</code></a> function from the standard library.  This takes some sort of \"container\" and a function that maps single values to monadic results, and creates a \"container\" of the results inside the same monad.  Here the \"container\" type is <code>[a]</code> and the \"monad\" type is <code>State Distribution a</code>, so the specialized type signature of <code>traverse</code> is</p>\n\n<pre><code>traverse :: (Int -&gt; State Distribution Int)\n         -&gt; [Int]\n         -&gt; State Distribution [Int]\n</code></pre>\n\n<p>We don't actually care about the final state, we just want the resulting <code>[Int]</code> out, which is what <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-State-Lazy.html#v:evalState\" rel=\"nofollow noreferrer\"><code>evalState</code></a> does.  This would produce:</p>\n\n<pre><code>distributeRow :: [Int] -&gt; Int -&gt; [Int]\ndistributeRow row count =\n  evalState\n  (traverse distributeCell row :: State Distribution [Int])\n  (Distribution 0 count (length row))\n</code></pre>\n\n<p>Applying this to the whole matrix is a simple application of <code>zipWith</code> (given two lists and a function, call the function repeatedly with pairs of items from the two lists, returning the list of results):</p>\n\n<pre><code>distributeOnes :: [[Int]] -&gt; [Int] -&gt; [[Int]]\ndistributeOnes = zipWith distributeRow\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 10895439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/142374a25f49bbe040cdaa2244edb29f?s=128&d=identicon&r=PG&f=1", "display_name": "iovo", "link": "https://stackoverflow.com/users/10895439/iovo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 54734744, "answer_count": 2, "score": 3, "last_activity_date": 1550499509, "creation_date": 1550411146, "question_id": 54733883, "link": "https://stackoverflow.com/questions/54733883/haskell-is-there-a-better-way-of-evenly-distributing-an-element-over-a-list", "title": "Haskell - Is there a better way of evenly distributing an element over a list", "body": "<p>Given a matrix like this</p>\n\n<pre><code>matrix_table =\n\n[[ 0, 0, 0, 0]\n,[ 0, 0, 0, 0]\n,[ 0, 0, 0, 0]\n,[ 0, 0, 0, 0]\n]\n</code></pre>\n\n<p>and a list <code>position_list = [2, 3, 2, 10]</code></p>\n\n<p>output of a function</p>\n\n<pre><code>distribute_ones :: [[Int]] -&gt; [Int] -&gt; [[Int]]\ndistribute_ones matrix_table position_list \n</code></pre>\n\n<p>should look like this</p>\n\n<pre><code>[[ 0, 1, 0, 1] -- 2 '1's in the list\n,[ 0, 1, 1, 1] -- 3 '1's in the list\n,[ 0, 1, 0, 1] -- 2 '1's in the list\n,[ 1, 1, 1, 1] -- Since 10 &gt; 4, all '1's in the list\n]\n</code></pre>\n\n<hr>\n\n<p>What I tried:</p>\n\n<p>I generated list of lists, the base matrix with </p>\n\n<pre><code> replicate 4 (replicate 4 0)\n</code></pre>\n\n<p>then divided inner lists with <code>chunksOf</code> from <code>Data.List.Split</code> library to make cut-outs of <code>4 - (position_list !! nth)</code>.</p>\n\n<p>Finally appending and concatenating with <code>1</code> like this</p>\n\n<pre><code>take 4 . concat . map (1 :)\n</code></pre>\n\n<p>Although I think it's not exactly the best approach.\nIs there a better way of doing that?</p>\n"}, {"tags": ["haskell", "monads"], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 3, "last_activity_date": 1550407440, "creation_date": 1550407440, "answer_id": 54733369, "question_id": 54733069, "link": "https://stackoverflow.com/questions/54733069/how-binding-works-in-function-monads-in-haskell/54733369#54733369", "title": "How binding works in function monads in Haskell?", "body": "<p>Haskell <code>do</code> notation is syntactic sugar for a series of <code>&gt;&gt;=</code> bindings; in this case, for something like this:</p>\n\n<pre><code>addStuff = (*2) &gt;&gt;= (\\a -&gt; (+10) &gt;&gt;= (\\b -&gt; return (a + b)))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 7, "last_activity_date": 1550407732, "creation_date": 1550407732, "answer_id": 54733407, "question_id": 54733069, "link": "https://stackoverflow.com/questions/54733069/how-binding-works-in-function-monads-in-haskell/54733407#54733407", "title": "How binding works in function monads in Haskell?", "body": "<p>Let us first <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-470003.14\" rel=\"noreferrer\"><em>desugar</em> the <code>do</code> block [Haskell'10 report]</a>:</p>\n\n<pre><code>addStuff = do\n    a &lt;- (*2)\n    b &lt;- (+10)\n    return (a+b)</code></pre>\n\n<p>is equivalent to:</p>\n\n<pre><code>addStuff = (*2) &gt;&gt;= \\a -&gt; ((+10) &gt;&gt;= \\b -&gt; return (a + b))\n</code></pre>\n\n<p>The inner bind expression (<code>(+10) &gt;&gt;= \\b -&gt; return (a + b)</code>), can thus be converted, with the bind definition to:</p>\n\n<pre><code>\\w -&gt; (\\b -&gt; return (a + b)) ((+10) w) w\n</code></pre>\n\n<p>and if we substitute <code>return</code> with <code>const</code>, we thus obtain:</p>\n\n<pre><code>\\w -&gt; (const . (a+)) ((+10) w) w\n</code></pre>\n\n<p>We thus have a function that takes as input <code>w</code>, and then calls <code>const . (a+)</code> on <code>(w+10)</code> and <code>w</code>, so it will ignore the last <code>w</code>. Semantically it is equivalent to:</p>\n\n<pre><code>(a+) . (+10)\n</code></pre>\n\n<p>So now our <code>addStuf</code> is equivalent to:</p>\n\n<pre><code>addStuff = (*2) &gt;&gt;= \\a -&gt; ((a+) . (+10))\n</code></pre>\n\n<p>and if we now use the definition for the bind operator again, we see:</p>\n\n<pre><code>\\w -&gt; (\\a -&gt; ((a+) . (+10))) ((*2) w) w\n</code></pre>\n\n<p>or shorter:</p>\n\n<pre><code>\\w -&gt; (\\a -&gt; ((a+) . (+10))) (w*2) w\n</code></pre>\n\n<p>We can now substitue <code>a</code> with <code>(w*2)</code> and obtain:</p>\n\n<pre><code>\\w -&gt; ((w*2)+) . (+10)) w\n</code></pre>\n\n<p>So our <code>addStuf</code> is equivalent to:</p>\n\n<pre><code>addStuff w = (w*2) + (w+10)\n</code></pre>\n\n<p>or more simple:</p>\n\n<pre><code>addStuff w =  3*w + 10\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1550422999, "creation_date": 1550422999, "answer_id": 54735536, "question_id": 54733069, "link": "https://stackoverflow.com/questions/54733069/how-binding-works-in-function-monads-in-haskell/54735536#54735536", "title": "How binding works in function monads in Haskell?", "body": "<p>Passing the updated argument between the computation steps (which would thus be serving a role of a state) is the job of another monad, namely the State monad.</p>\n\n<p>The function aka Reader monad is simpler than that, does less work:</p>\n\n<pre><code>-- (return x) w = x\n-- (h &gt;&gt;= f)  w = f (h w) w \n\n(h &gt;&gt;= (\\a -&gt;   g &gt;&gt;= (\\b -&gt;   return (f a b))))   w                   \n=   \n       (\\a -&gt;   g &gt;&gt;= (\\b -&gt;   return (f a b)))  (h w)   w\n= \n(g &gt;&gt;= (\\b -&gt;   return (f  (h w)  b)))   w\n= \n       (\\b -&gt;   return (f  (h w)  b)))  (g w)   w\n= \n                return (f  (h w)  (g w))        w\n= \n                        f  (h w)  (g w)  \n</code></pre>\n\n<p>Thus the input argument <code>w</code> is passed <em>unchanged</em> into both (by extension, all) the computation steps. Or in the specific case you ask about,</p>\n\n<pre><code>    liftM2 (+) ( *2) ( +10)  w \n = \n           (+) (w*2) (w+10) \n</code></pre>\n\n<p><code>liftM2</code> function is equivalent to the <code>do</code> block that you show,</p>\n\n<pre><code>liftM2 f h g =\n   do {\n     a &lt;- h ;\n     b &lt;- g ;\n     return (f a b) }\n =\n   h &gt;&gt;= (\\ a -&gt;\n    g &gt;&gt;= (\\ b -&gt;  return (f a b) ))\n</code></pre>\n\n<p>in any monad.</p>\n"}], "owner": {"reputation": 139, "user_id": 3857291, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4686c78a9bd7ef6e3cedf8daacda9dee?s=128&d=identicon&r=PG", "display_name": "Pavel", "link": "https://stackoverflow.com/users/3857291/pavel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 54733407, "answer_count": 3, "score": 5, "last_activity_date": 1550422999, "creation_date": 1550405178, "last_edit_date": 1550406702, "question_id": 54733069, "link": "https://stackoverflow.com/questions/54733069/how-binding-works-in-function-monads-in-haskell", "title": "How binding works in function monads in Haskell?", "body": "<p>From learn you a haskell: <a href=\"http://learnyouahaskell.com/for-a-few-monads-more\" rel=\"nofollow noreferrer\">http://learnyouahaskell.com/for-a-few-monads-more</a></p>\n\n<p>Monad instance for function is this:</p>\n\n<pre><code>instance Monad ((-&gt;) r) where  \n    return x = \\_ -&gt; x  \n    h &gt;&gt;= f = \\w -&gt; f (h w) w \n</code></pre>\n\n<p>I am having trouble understanding the output of the following:</p>\n\n<pre><code>import Control.Monad.Instances  \n\naddStuff :: Int -&gt; Int  \naddStuff = do  \n    a &lt;- (*2)  \n    b &lt;- (+10)  \n    return (a+b)\n</code></pre>\n\n<p><code>addStuff 3</code> returns 19. Book says 3 gets passed as parameters to both <code>(*2)</code> <code>and (+10)</code>. How?</p>\n\n<p>From <code>h &gt;&gt;= f = \\w -&gt; f (h w) w</code> , it seems like <code>(h w)</code> is getting bound to a or b.\nSo, why 6 is not being passed in (+10)?</p>\n\n<p>My understanding of <code>f</code> here is that when <code>(*2)</code> is <code>h</code>, <code>f</code> is the last 2 lines of <code>addStuff</code>. When <code>(+10)</code> is <code>h</code>, <code>f</code> is the last line (in this case the return statement) of <code>addStuff</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1550403598, "post_id": 54732806, "comment_id": 96248191, "body": "In fact a <code>State</code> does <i>not</i> contain the state, it basically encapsulates the <i>change</i> of a state. When you create such <code>State</code> objects, you typically &quot;chain&quot; several state changes, and eventually you call <code>runState</code> with the initial state."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1550403803, "post_id": 54732806, "comment_id": 96248249, "body": "That does look wrong to me, for the reason you gave. I just checked the link and don&#39;t see that snippet anywhere though? [Edit: found it. It&#39;s probably a mistake, it is a wiki after all]"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550403898, "post_id": 54732806, "comment_id": 96248273, "body": "@RobinZigmond: it is probably located at Wikipedia: <a href=\"https://en.wikibooks.org/wiki/Haskell/Understanding_monads/State\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Haskell/Understanding_monads/State</a>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1550404274, "post_id": 54732806, "comment_id": 96248364, "body": "It looks indeed something is wrong,  unless <code>State</code> is just a type synonym of an arrow (like <code>type State s a = s -&gt; (a, s)</code>), but if we use a <code>newtype</code>, then indeed it is not completely correc.t"}], "answers": [{"comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1550428502, "post_id": 54732978, "comment_id": 96255084, "body": "The Wiki page seems to be using the simplification <code>type State s a = s -&gt; (a, s)</code>, instead of a <code>newtype</code>. The <code>(&gt;&gt;=)</code> then defined is not actually part of the <code>Monad</code> class, just a free-floating function, which is where the irregularity comes from. I think this answer would be better if, instead of declaring the page wrong (or, &quot;not entirely correct&quot;), it just pointed out this fact, and offered the &quot;correct&quot; version as how it&#39;s actually implemented, with <code>State</code> actually becoming an instance of <code>Monad</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 7, "last_activity_date": 1550431035, "last_edit_date": 1550431035, "creation_date": 1550404429, "answer_id": 54732978, "question_id": 54732806, "link": "https://stackoverflow.com/questions/54732806/is-this-piece-of-haskell-code-correct-if-so-why/54732978#54732978", "title": "is this piece of haskell code correct, if so why?", "body": "<p><strong>In short:</strong> A <code>State</code> object itself does <em>not</em> encapsulate the state, it encapsulates the <em>change</em> of a state.</p>\n\n<p>Indeed, the <code>State</code> type is defined as:</p>\n\n<pre><code>newtype State s a = State { runState :: s -&gt; (a, s) }</code></pre>\n\n<p>where <code>runState</code> is thus a function that takes a state <code>s</code>, and returns a result <code>a</code> and a new state.</p>\n\n<p>The bind operator <code>(&gt;&gt;=) :: State s a -&gt; (a -&gt; State s b) -&gt; State s b</code> basically \"chains\" state changes together. It thus takes one state changing function <code>f1 :: s -&gt; (a, s)</code>, and a function <code>f2 :: a -&gt; State s b</code>, and thus creates a function <code>g :: s -&gt; (b, s)</code> so to speak that is encapsulated in a <code>State</code> constructor. The second function <code>f2</code> thus takes an <code>a</code> and returns such state changing function as well.</p>\n\n<p>So the bind operator can be defined as:</p>\n\n<pre><code>(State f1) &gt;&gt;= f2 = State $ \\i -&gt; let (y, s) = f1 i in runState (f2 y) s</code></pre>\n\n<p>Here we have <code>i</code> as initial state, and we thus will first \"chain\" <code>i</code> through the <code>f1</code> state changer. This returns then a 2-tuple: <code>y</code> is the \"result\" of that call, and <code>s</code> is the new state, we will then pass the result and the new state to <code>f2</code>. Note that here we do <em>not</em> make state changes at all, we only construct a <code>State</code> object that <em>can</em> do that. We thus postpone the real chaining.</p>\n\n<p>If the <code>State</code> is however defined as above, then the piece of code does not match that definition, it defines it, like <a href=\"https://stackoverflow.com/questions/54732806/is-this-piece-of-haskell-code-correct-if-so-why/54732978#comment96255084_54732978\">@HTWN says</a>, as:</p>\n\n<pre><code>type State s a = s -&gt; (a, s)\n</code></pre>\n\n<p>In that case, it is correct, given that <code>runState</code> is then the <code>id</code> function, since then:</p>\n\n<pre><code>(&gt;&gt;=) :: State s a -&gt; (a -&gt; State s b) -&gt; State s b\n(&gt;&gt;=) act1 fact2 = f\n    where f s = act2 is \n              where (iv,is) = act1 s\n                    act2 = fact2 iv\n</code></pre>\n\n<p>In order to make it compatible with our <code>State</code> type, we thus add some logic to unwrap and wrap it in the <code>State</code> data constructor:</p>\n\n<pre><code>(&gt;&gt;=) :: State s a -&gt; (a -&gt; State s b) -&gt; State s b\n(&gt;&gt;=) act1 fact2 = State f\n    where f s = runState act2 is \n              where (iv,is) = runState act1 s\n                    act2 = fact2 iv\n</code></pre>\n\n<p>then it is indeed correct. The main error is not wrapping it in a <code>State</code> data constructor.</p>\n"}], "owner": {"reputation": 39, "user_id": 11074433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa06b370c86f9f30d8a39fe37d1891c9?s=128&d=identicon&r=PG&f=1", "display_name": "Azerty Poit", "link": "https://stackoverflow.com/users/11074433/azerty-poit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1550431035, "creation_date": 1550403175, "last_edit_date": 1550403305, "question_id": 54732806, "link": "https://stackoverflow.com/questions/54732806/is-this-piece-of-haskell-code-correct-if-so-why", "title": "is this piece of haskell code correct, if so why?", "body": "<p>the haskell wiki (here : <a href=\"https://wiki.haskell.org/State_Monad\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/State_Monad</a> ) says the state monad bind operator is defined like this :</p>\n\n<pre><code>(&gt;&gt;=) :: State s a -&gt; (a -&gt; State s b) -&gt; State s b\n(act1 &gt;&gt;= fact2) s = runState act2 is \n    where (iv,is) = runState act1 s\n          act2 = fact2 iv\n</code></pre>\n\n<p>however it seems incorrect to me as the result of the bind operator is a function wrapped in a constructor thus cannot be applied (I'm talking about this pattern : <code>(act1 &gt;&gt;= fact2) s</code>)</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 3985, "user_id": 387527, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2ee4bf552ca59c2f324e666a3de008bd?s=128&d=identicon&r=PG", "display_name": "agam", "link": "https://stackoverflow.com/users/387527/agam"}, "is_accepted": false, "score": 1, "last_activity_date": 1550390855, "creation_date": 1550390855, "answer_id": 54731303, "question_id": 54731249, "link": "https://stackoverflow.com/questions/54731249/stack-yaml-vs-package-yaml-for-adding-dependencies/54731303#54731303", "title": "Stack.yaml vs package.yaml for adding dependencies", "body": "<p>Nevermind, it turns out I had run <code>stack new &lt;project&gt; simple</code>; if I had run <code>stack new &lt;project&gt; new-project</code>, it would have generated the <code>package.yaml</code> file instead of the <code>&lt;project&gt;.cabal</code> file I currently find there.</p>\n"}, {"tags": [], "owner": {"reputation": 80, "user_id": 901918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5e23195ec352b69ba9e9065b83e862?s=128&d=identicon&r=PG", "display_name": "Andrew Cowie", "link": "https://stackoverflow.com/users/901918/andrew-cowie"}, "is_accepted": true, "score": 4, "last_activity_date": 1550394568, "creation_date": 1550394568, "answer_id": 54731680, "question_id": 54731249, "link": "https://stackoverflow.com/questions/54731249/stack-yaml-vs-package-yaml-for-adding-dependencies/54731680#54731680", "title": "Stack.yaml vs package.yaml for adding dependencies", "body": "<p><em>package.yaml</em> is actually processed by <strong>hpack</strong>; it's not a <strong>stack</strong> feature, except in so far as if it sees one there in your project it'll use it and generate a <em>.cabal</em> file.</p>\n\n<p>You can create a <em>package.yaml</em> yourself from scratch. You don't need to do <code>stack new</code> or whatever.</p>\n\n<p>I certainly find it using <em>package.yaml</em> rather than <em>project.cabal</em> convenient. There's no nice user guide, as such (as pointed out in the <strong>hpack</strong> <a href=\"https://github.com/sol/hpack#readme\" rel=\"nofollow noreferrer\">README</a>) but a few examples and you'll realize there's not much to it:</p>\n\n<ul>\n<li><a href=\"https://github.com/oprdyn/publish/blob/master/package.yaml\" rel=\"nofollow noreferrer\">https://github.com/oprdyn/publish/blob/master/package.yaml</a></li>\n<li><a href=\"https://github.com/oprdyn/docker.haskell/blob/master/files/src/baseline/package.yaml\" rel=\"nofollow noreferrer\">https://github.com/oprdyn/docker.haskell/blob/master/files/src/baseline/package.yaml</a></li>\n</ul>\n\n<p>I have seen a few mentions that the <strong>Cabal</strong> library now supports new features to reduce the tedious repetition (perhaps in a <code>&gt;= 2.x</code> format?) which might make the need for <em>package.yaml</em> go away fairly soon, which would be fine.</p>\n"}, {"tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": false, "score": 2, "last_activity_date": 1550437917, "creation_date": 1550437917, "answer_id": 54737722, "question_id": 54731249, "link": "https://stackoverflow.com/questions/54731249/stack-yaml-vs-package-yaml-for-adding-dependencies/54737722#54737722", "title": "Stack.yaml vs package.yaml for adding dependencies", "body": "<p>Usually <code>package.yaml</code> is the correct place to add dependencies, and <code>stack.yaml</code> is the correct place to add additional information about those dependencies.</p>\n\n<p>If you're just using packages from the project's main stack snapshot and using the default build settings for all of them: you generally don't need to edit <code>stack.yaml</code> at all. Dependencies are mentioned in <code>stack.yaml</code> when:</p>\n\n<ul>\n<li>The package isn't in a stack snapshot</li>\n<li>You need a different version of the package from the one your stack snapshot provides</li>\n<li>The package (or the specific version you need) isn't on hackage at all (for example: you need stack to get it from github)</li>\n<li>You need the package to be compiled with non-default flags</li>\n<li>etc</li>\n</ul>\n"}], "owner": {"reputation": 3985, "user_id": 387527, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2ee4bf552ca59c2f324e666a3de008bd?s=128&d=identicon&r=PG", "display_name": "agam", "link": "https://stackoverflow.com/users/387527/agam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 811, "favorite_count": 0, "accepted_answer_id": 54731680, "answer_count": 3, "score": 1, "last_activity_date": 1550437917, "creation_date": 1550390264, "last_edit_date": 1550408592, "question_id": 54731249, "link": "https://stackoverflow.com/questions/54731249/stack-yaml-vs-package-yaml-for-adding-dependencies", "title": "Stack.yaml vs package.yaml for adding dependencies", "body": "<p>Possibly a dumb question:</p>\n\n<p>The <a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#stacks-functions\" rel=\"nofollow noreferrer\">Stack documentation</a> mentions <code>package.yaml</code> as the right place to add dependencies, but all I see in my project directory is a single <code>stack.yaml</code> file; is that the right place, then?</p>\n\n<p>(I see an <a href=\"https://stackoverflow.com/questions/49774055/stacks-package-yaml-vs-stack-yaml\">existing question</a> that asks about redundancy between these two files, but I don't even see the <code>package.yaml</code> file at all !!)</p>\n\n<p>If it helps:</p>\n\n<pre><code>$ stack --version\nVersion 1.9.3, Git revision 40cf7b37526b86d1676da82167ea8758a854953b (6211 commits) x86_64 hpack-0.31.1\n</code></pre>\n"}, {"tags": ["haskell", "aeson"], "answers": [{"tags": [], "owner": {"reputation": 6788, "user_id": 1748754, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jjk7p.jpg?s=128&g=1", "display_name": "erewok", "link": "https://stackoverflow.com/users/1748754/erewok"}, "is_accepted": true, "score": 1, "last_activity_date": 1550380058, "creation_date": 1550380058, "answer_id": 54730278, "question_id": 54730118, "link": "https://stackoverflow.com/questions/54730118/how-to-parse-a-json-string-using-aeson-that-can-be-one-of-two-different-types/54730278#54730278", "title": "How to parse a JSON string using Aeson that can be one of two different types", "body": "<p>One way to solve this problem is to pattern match on the <strong>JSON data constructors</strong> that are valid for your dataset and raise <em>invalid</em> for all others. </p>\n\n<p>For instance, you could write something like this for that particular field, keeping in mind that <code>parseJSON</code> is a function from <code>Value -&gt; Parser a</code>:</p>\n\n<pre><code>instance FromJSON Group where\n    parseJSON (Bool False) = Group &lt;$&gt; pure []\n    parseJSON (Array arr) =  pure (Group $ parseListOfInt arr)\n    parseJSON invalid    = typeMismatch \"Group\" invalid\n\nparseListOfInt :: Vector Value -&gt; [Int]\nparseListOfInt = undefined -- build this function\n</code></pre>\n\n<p>You can see an example of this in the <a href=\"https://hackage.haskell.org/package/aeson-1.4.2.0/docs/Data-Aeson.html#g:11\" rel=\"nofollow noreferrer\">Aeson docs</a>, which are pretty good (but you kind of have to read them closely and a few times through).</p>\n\n<p>I would probably then define a <em>separate</em> record to represent the top-level object that this key comes in and rely on generic deriving, but others may have a better suggestion there:</p>\n\n<pre><code>data GroupObj = GroupObj { group :: Group } deriving (Eq, Show)\ninstance FromJSON GroupObj\n</code></pre>\n\n<p>One thing to always keep in mind when working with Aeson are the <a href=\"https://hackage.haskell.org/package/aeson-1.4.2.0/docs/Data-Aeson.html#g:9\" rel=\"nofollow noreferrer\">core constructors</a> (of which there are only 6) and the underlying data structures (<code>HashMap</code> for <code>Object</code> and <code>Vector</code> for <code>Array</code>, for instance). </p>\n\n<p>For example, in the above, when you pattern match on <code>Array arr</code>, you have to be aware that you're getting a <code>Vector Value</code> there in <code>arr</code> and we still have some work to do to turn this into a list of integers, which is why I left that other function <code>parseListOfInt</code> undefined up above because I think it's probably a good exercise to build it?</p>\n"}], "owner": {"reputation": 23, "user_id": 11073284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/870ddade2db3abd3b184761d3bef53b7?s=128&d=identicon&r=PG&f=1", "display_name": "imanschumpeter", "link": "https://stackoverflow.com/users/11073284/imanschumpeter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 54730278, "answer_count": 1, "score": 2, "last_activity_date": 1595594910, "creation_date": 1550377859, "last_edit_date": 1595594910, "question_id": 54730118, "link": "https://stackoverflow.com/questions/54730118/how-to-parse-a-json-string-using-aeson-that-can-be-one-of-two-different-types", "title": "How to parse a JSON string using Aeson that can be one of two different types", "body": "<p>I'm currently struggling to parse some JSON data using the <code>aeson</code> library. There are a number of properties that have the value <code>false</code> when the data for that property is absent. So if the property's value is typically an array of integers and there happens to be no data for that property, instead of providing an empty array or <code>null</code>, the value is <code>false</code>. (The way that this data is structured isn't my doing so I'll have to work with it somehow.) </p>\n\n<p>Ideally, I would like to end up with an empty list in cases where the value is a boolean. I've created a small test case below for demonstration. Because my <code>Group</code> data constructor expects a list, it fails to parse when it encounters <code>false</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>  data Group = Group [Int] deriving (Eq, Show)\n\n  jsonData1 :: ByteString\n  jsonData1 = [r|\n    {\n      \"group\" : [1, 2, 4]\n    }\n  |]\n\n  jsonData2 :: ByteString\n  jsonData2 = [r|\n    {\n      \"group\" : false\n    }\n  |]\n\n  instance FromJSON Group where\n    parseJSON = withObject \"group\" $ \\g -&gt; do\n      items &lt;- g .:? \"group\" .!= []\n      return $ Group items\n\n  test1 :: Either String Group\n  test1 = eitherDecode jsonData1\n  -- returns \"Right (Group [1,2,4])\"\n\n  test2 :: Either String Group\n  test2 = eitherDecode jsonData2\n  -- returns \"Left \\\"Error in $.group: expected [a], encountered Boolean\\\"\"\n</code></pre>\n\n<p>I was initially hoping that the <code>(.!=)</code> operator would allow it to default to an empty list but that only works if the property is absent altogether or <code>null</code>. If it were <code>\"group\": null</code>, it would parse successfully and I would get <code>Right (Group [])</code>.</p>\n\n<p>Any advice for how to get it to successfully parse and return an empty list in these cases where it's <code>false</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1550360721, "post_id": 54728646, "comment_id": 96241124, "body": "Did you do any research before asking this question? <a href=\"https://www.haskell.org/hoogle/?hoogle=Int+-%3E+Char\" rel=\"nofollow noreferrer\">Hoogle</a> helps in this kind of situation."}, {"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 0, "creation_date": 1550429088, "post_id": 54728646, "comment_id": 96255279, "body": "Welcome to StackOverflow! Be sure to take the <a href=\"https://stackoverflow.com/tour\">tour</a> and visit the <a href=\"https://stackoverflow.com/help\">help center</a>. Could you please elaborate, why did you choose this particular type signature for <code>PatternMatch</code>? What <code>[Char]</code> and <code>Bool</code> arguments are supposed to do? Also, you say that you want to perform an operation on a <i>list</i> of triples, but put a plain triple in the signature. You may want to align the description of what you&#39;re trying to do with what you&#39;ve actually tried, or maybe the other way around."}], "answers": [{"comments": [{"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 0, "creation_date": 1550428769, "post_id": 54728966, "comment_id": 96255172, "body": "The first version is not correct: it should be [(Int, Int, Int)], and you should then map a composition of <code>show</code> and the lambda, right now you&#39;re composing the lambda with <code>map show</code>. But even with this it will not work, since you can&#39;t use <code>&#47;</code> with <code>Int</code>s, you&#39;d need <code>div</code> (or <code>quot</code>), like you did in the comprehension."}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 0, "creation_date": 1550439320, "post_id": 54728966, "comment_id": 96258205, "body": "@Michail you&#39;re absolutely right I forgot the brackets in the type declaration and around the function - EDITED now. However I can still do a floating point division because the compiler will just convert it to a float type and return a float, because it wasn&#39;t clear what the OP wanted and that&#39;s what he used in its version."}, {"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 0, "creation_date": 1550441571, "post_id": 54728966, "comment_id": 96258793, "body": "Haskell doesn&#39;t have implicit type conversions. <code>&#47;</code> requires its arguments to be of the same type and be <code>Fractional</code>, which <code>Int</code> isn&#39;t. The function will typecheck if you omit the signature, because the compiler will infer <code>Fractional a =&gt; [(a, a, a)] -&gt; String</code> for it. It will accept a list with some integer <i>literals</i> inside, but they will not be <code>Int</code>s, they will actually be floats or doubles. If you try to feed explicitly annotated <code>Int</code>s into it, the program will be rejected."}, {"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 0, "creation_date": 1550442712, "post_id": 54728966, "comment_id": 96259057, "body": "oops, my bad, also <code>Show a</code> for the inferred type."}, {"owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "reply_to_user": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 0, "creation_date": 1550455664, "post_id": 54728966, "comment_id": 96261520, "body": "@Michail you&#39;re actually quite right, my apologies. I only checked in the GHCi without giving it the type declaration. Edited my answer again"}], "tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": false, "score": 2, "last_activity_date": 1550455698, "last_edit_date": 1550455698, "creation_date": 1550362724, "answer_id": 54728966, "question_id": 54728646, "link": "https://stackoverflow.com/questions/54728646/summing-elements-in-a-2d-list-and-then-dividing-that-number-and-then-convertin/54728966#54728966", "title": "Summing elements in a 2D list, and then dividing that number, and then converting that number to a character", "body": "<p>Hoogle and google can easily help you with this question. You are just looking for a function of type <code>Int -&gt; String</code> (char would be restricted to only one digit; also watch out for decimal values). You'll find that the well-known function <code>Show</code> does what you need.\nAlso, dividing by 3 and 255 makes your code look weird, just divide by 765 at once.\nFinally, there's no need for pattern matching for a function like this, you can use the higher order function <code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code> and either write your own helper function or use a lambda function:</p>\n\n<pre><code>patternMatch  :: [(Int,Int,Int)] -&gt; String\npatternMatch = concat . map (show . (\\(x,y,z) -&gt; (x+y+z) `div` 765))\n</code></pre>\n\n<p>P.S.: If you are sure you'll only get integers 0..9, then you can use an even simpler list comprehension:</p>\n\n<pre><code>patternMatch tups = [head . show $ (x+y+z) `div` 765 |(x,y,z) &lt;- tups]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10735911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8c050b4349f343dca8edc7e615b950f?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Asif", "link": "https://stackoverflow.com/users/10735911/ahmed-asif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1550455698, "creation_date": 1550359353, "question_id": 54728646, "link": "https://stackoverflow.com/questions/54728646/summing-elements-in-a-2d-list-and-then-dividing-that-number-and-then-convertin", "title": "Summing elements in a 2D list, and then dividing that number, and then converting that number to a character", "body": "<p>I need to sum the elements from a 2D list of three- tuples of Ints\nE.g[(10,50,50),(60,70,90),(100,100,20)],](50,60,100),(60,70,90),(60,40,30)]</p>\n\n<p>and divide it by 3 and then 255. </p>\n\n<p>right now I have this</p>\n\n<pre><code>PatternMatch:: [Char] -&gt; Bool -&gt; (Int, Int, Int)-&gt; Char\nPatternMatch _ _[] = []\nPatternMatch ((a,b,c):xs) = (((a + b + c) / 3) / 255) : (PatternMatch xs)\n</code></pre>\n\n<p>But this returns it as an integer, but I need a char. For that I need a helper function, but idk how to go about this. Please help!</p>\n"}, {"tags": ["haskell", "binary-tree", "fold"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1550349289, "post_id": 54727313, "comment_id": 96238522, "body": "Hint: how would you make a <code>foldBT</code> that leaves the tree intact?"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "edited": false, "score": 0, "creation_date": 1550362137, "post_id": 54727449, "comment_id": 96241438, "body": "I really like your solution. How do you come to the idea of <code>g &#47;= f</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "edited": false, "score": 0, "creation_date": 1550365999, "post_id": 54727449, "comment_id": 96242002, "body": "@Jung Your mind should go the other way: why assume <code>g = f</code> to begin with? Never assume an equality until you&#39;re forced to! A better question would be, &quot;How did I come to the idea that there might be an equality relating <code>mapTree</code> and <code>foldBT</code>?&quot;, and for that, I cheated: you yourself demanded it in the original question text."}, {"owner": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "edited": false, "score": 0, "creation_date": 1550384948, "post_id": 54727449, "comment_id": 96244464, "body": "good tip! I do indeed know they are related through the equation <code>mapTree f = foldBT _ e</code> I struggled because I assume <code>g = f</code> But it makes sense that couldnt happen since that would lead to <code>f a = N (f a)</code> Once again thanks !"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1550349596, "creation_date": 1550349596, "answer_id": 54727449, "question_id": 54727313, "link": "https://stackoverflow.com/questions/54727313/implementation-of-map-on-binary-tree-using-fold/54727449#54727449", "title": "Implementation of map on binary tree using fold", "body": "<p>Let us hypothesize <code>mapTree f = foldBT g e</code>, and solve for <code>g</code> and <code>e</code>. The definition of <code>foldBT</code> says:</p>\n\n<pre><code>foldBT g e Nil = e\n</code></pre>\n\n<p>Meanwhile, from the definition of <code>mapTree</code>, we get:</p>\n\n<pre><code>mapTree f Nil = Nil\n</code></pre>\n\n<p>From our hypothesis that <code>mapTree f = foldBT g e</code>, we can transform the second equation and stick it next to the first equation:</p>\n\n<pre><code>foldBT g e Nil = Nil\nfoldBT g e Nil = e\n</code></pre>\n\n<p>So <code>e = Nil</code>.</p>\n\n<p>Let's do the other clauses now. The definition of <code>foldBT</code> says:</p>\n\n<pre><code>foldBT g e (N a left right) = g a (foldBT g e left) (foldBT g e right)\n</code></pre>\n\n<p>Meanwhile, <code>mapTree</code>'s definition says:</p>\n\n<pre><code>mapTree f (N a left right) = N (f a) (mapTree f left) (mapTree f right)\n</code></pre>\n\n<p>Again, using our hypothesis <code>mapTree f = foldBT g e</code>, we can now rewrite this equation, and stick it next to the first one:</p>\n\n<pre><code>foldBT g e (N a left right) = N (f a) (foldBT g e left) (foldBT g e right)\nfoldBT g e (N a left right) = g a (foldBT g e left) (foldBT g e right)\n</code></pre>\n\n<p>So <code>g a = N (f a)</code> would validate this equation. Writing these all down in one spot, we get:</p>\n\n<pre><code>mapTree f = foldBT g e where\n    e = Nil\n    g a = N (f a)\n</code></pre>\n\n<p>You can inline the definitions of <code>e</code> and <code>g</code> if you like; I would.</p>\n\n<pre><code>mapTree f = foldBT (N . f) Nil\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1550350518, "post_id": 54727464, "comment_id": 96238796, "body": "In a fold function, the <code>l</code> and <code>r</code> are typically &quot;already folded&quot;, so you can simplify the last one to <code>foldFunc a l r = N (f a) l r</code>. You also thus forgo the <code>N</code> constructor :)."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550350585, "post_id": 54727464, "comment_id": 96238817, "body": "Yeah, thanks - I&#39;d just figured both of those out myself. Will edit now :)"}, {"owner": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "edited": false, "score": 0, "creation_date": 1550388998, "post_id": 54727464, "comment_id": 96245151, "body": "thanks for the reference ! One question: What does the last <code>b</code> in the type signature of <code>foldBT</code> represent ? Does it have the type of <code>Nil</code> which is polymorphic?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550397646, "post_id": 54727464, "comment_id": 96246870, "body": "The last <code>b</code> is the type of the return value. It&#39;s arbitrary, but it determines the types of the arguments, in the way I described: you need a <code>b</code> for the <code>Nil</code> tree, and the function which deals with the <code>N</code> constructor must have type <code>a -&gt; b -&gt; b -&gt; b</code> as it takes the leaf value and the results of folding the subtrees and computes the new result. Again, it&#39;s exactly analogous to folding a list, where the type signature is <code>(a -&gt; b -&gt; b) -&gt; b -&gt; [ a] -&gt; b</code>."}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 1, "last_activity_date": 1550350653, "last_edit_date": 1550350653, "creation_date": 1550349715, "answer_id": 54727464, "question_id": 54727313, "link": "https://stackoverflow.com/questions/54727313/implementation-of-map-on-binary-tree-using-fold/54727464#54727464", "title": "Implementation of map on binary tree using fold", "body": "<p>The idea of the <code>foldBT</code> function is that it takes an argument for each constructor of your data type (plus the one holding the whole <code>SimpleBT a</code> itself that you wish to fold over). The first one, of type <code>a -&gt; b -&gt; b -&gt; b</code> corresponds to the recursive <code>N</code> constructor, and shows how to combine the value at the node with the results of the fold of the two subtrees into the result of the entire fold. The second argument corresponds to the <code>Nil</code> constructor, and since this constructor takes no arguments, the corresponding argument to <code>fold</code> is simply a constant.</p>\n\n<p>It's completely analagous to folding over a list. The list type <code>[a]</code> also has 2 constructors. One of them takes an <code>a</code> and a list and adds the element to the front of the list: <code>a -&gt; [a] -&gt; [a]</code>, this gives rise to a \"fold function\" of type <code>a -&gt; b -&gt; b</code>. The other constructor, as in your case, is nullary (the empty list), so again corresponds to an argument whose type is just <code>b</code>. Hence <code>foldr</code> for a list has type <code>(a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b</code>.</p>\n\n<p>There is a great discussion of this, with more examples, in this chapter of the Haskell wikibook: <a href=\"https://en.wikibooks.org/wiki/Haskell/Other_data_structures\" rel=\"nofollow noreferrer\">https://en.wikibooks.org/wiki/Haskell/Other_data_structures</a></p>\n\n<p>As for how to build a map from a fold, for your particular tree type - bearing in mind what I've said above, you need (given a mapping function <code>f :: a -&gt; a0</code>), we need to think about what this does to both the <code>Nil</code> tree, and what it does recursively to trees with a leaf and 2 branches. Also, since our return type will of course be another tree of the same type, <code>b</code> here will be <code>SimpleBT a0</code>.</p>\n\n<p>For <code>Nil</code>, obviously we want <code>map</code> to leave it unchanged, so the second argument to <code>foldBT</code> will be <code>Nil</code>. And for the other constructor, we want the <code>map</code> to apply the base function to the value at the leaf, and then recursively map over the 2 branches. This leads us to the function <code>\\a left right -&gt; N (f a) (mapTree f left) (mapTree f right)</code>.</p>\n\n<p>So we can conclude that the map function can be defined as follows (thanks to @DanielWagner and @WillemVanOnsen for helping me fix my first broken version):</p>\n\n<pre><code>mapTree :: (a -&gt; b) -&gt; SimpleBT a -&gt; SimpleBT b\nmapTree f = foldBT foldFunc Nil\n    where foldFunc a l r = N (f a) l r\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1550350653, "creation_date": 1550348669, "question_id": 54727313, "link": "https://stackoverflow.com/questions/54727313/implementation-of-map-on-binary-tree-using-fold", "title": "Implementation of map on binary tree using fold", "body": "<p>I'm struggling with define map over tree using <code>foldBT</code>. My idea is to convert the tree into list, map the operator over the list, and then convert the list back to tree. But it sounds inefficient and also doesn't make use of <code>foldBT</code>... I tried to run <code>foldBT (*2) Nil (numTree [3,5,7]</code> but ghci reported error. I don't really understand how the function <code>foldBt</code> works. An example would be great. </p>\n\n<pre><code>data SimpleBT a = Nil | N a (SimpleBT a) (SimpleBT a) deriving (Show, Eq)\n\nfoldBT :: (a -&gt; b -&gt; b -&gt; b) -&gt; b -&gt; SimpleBT a -&gt; b\nfoldBT f e Nil = e\nfoldBT f e (N a left right) = f a (foldBT f e left) (foldBT f e right)\n\nmapTree :: (a -&gt; b) -&gt; SimpleBT a -&gt; SimpleBT b\nmapTree f Nil = Nil\nmapTree f (N a left right) = N (f a) (mapTree f left) (mapTree f right)\n\nsize :: SimpleBT a -&gt; Int\nsize Nil = 0\nsize (N _ left right) = 1 + size left + size right\n\ninsert ::  SimpleBT a -&gt; a -&gt; SimpleBT a\ninsert Nil a = N a Nil Nil\ninsert (N x left right) a\n  | size left &lt;= size right = N x (insert left a) right\n  | otherwise = N x left (insert right a)\n\nnumTree :: [a] -&gt; SimpleBT a\nnumTree xs = foldl insert Nil xs\n</code></pre>\n"}, {"tags": ["haskell", "polymorphism", "type-families"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1550348946, "post_id": 54727102, "comment_id": 96238455, "body": "Correct: you must make separate instance declarations for each instance of <code>JointDist</code>. That said there&#39;s several code smells here that make me think a much simpler design is warranted. Perhaps it would be possible to give better advice if you can answer this question: is there an instance of <code>JointDist</code> which is <i>not</i> isomorphic to a <code>TrivialDist</code> (and if so, what does it look like)?"}, {"owner": {"reputation": 156, "user_id": 6227376, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/85099febfaf3add71d997224cc2e29c2?s=128&d=identicon&r=PG&f=1", "display_name": "C. Hammill", "link": "https://stackoverflow.com/users/6227376/c-hammill"}, "edited": false, "score": 0, "creation_date": 1550352558, "post_id": 54727102, "comment_id": 96239275, "body": "Alternatively you might want to check out some of the libraries that provide random variables for you. My preference is MonadBayes which implements a probability monad that allows sampling, conditioning, and inference."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 9983429, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212619753992033/picture?type=large", "display_name": "Jeremy Silver", "link": "https://stackoverflow.com/users/9983429/jeremy-silver"}, "is_accepted": true, "score": 0, "last_activity_date": 1550370516, "creation_date": 1550370516, "answer_id": 54729586, "question_id": 54727102, "link": "https://stackoverflow.com/questions/54727102/polymorphic-type-family-instance-in-haskell/54729586#54729586", "title": "Polymorphic type family instance in Haskell", "body": "<p>After monkeying around a bit, I think I've found a solution that uses equality constraints instead of explicit type families:</p>\n\n<pre><code>class Simulable s a b where\n    -- generates infinite stream of random samples from a distribution\n    samples :: s a -&gt; IO [b]\n    -- generates a single random sample from a distribution\n    sample :: s a -&gt; IO b\n    sample = fmap head . samples\n\ninstance (b ~ a) =&gt; Simulable TrivialDist a b where\n    samples :: TrivialDist a -&gt; IO [a]\n    samples (Trivial x) = return $ repeat x\n\ninstance {-# OVERLAPPABLE #-} (JointDist d a, b ~ [a]) =&gt; Simulable d a b where\n    samples :: d a -&gt; IO [[a]]\n    samples = samples . toTrivialDist\n</code></pre>\n\n<p>The <code>{-# OVERLAPPABLE #-}</code> pragma instructs GHC to allow the <code>TrivialDist a b</code> instance to overlap the <code>d a b</code> instance (otherwise we get an error).</p>\n"}], "owner": {"reputation": 53, "user_id": 9983429, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212619753992033/picture?type=large", "display_name": "Jeremy Silver", "link": "https://stackoverflow.com/users/9983429/jeremy-silver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 54729586, "answer_count": 1, "score": 3, "last_activity_date": 1550370516, "creation_date": 1550347086, "question_id": 54727102, "link": "https://stackoverflow.com/questions/54727102/polymorphic-type-family-instance-in-haskell", "title": "Polymorphic type family instance in Haskell", "body": "<p>I'm trying to write code to simulate random variables, and I want to keep things as polymorphic as possible. This may involve the use of type families, which are completely new to me.</p>\n\n<p>Here is a simplified version of my code:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE InstanceSigs #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE UndecidableInstances #-}\n\n\ndata TrivialDist a = Trivial a\n\ngetVal :: TrivialDist a -&gt; a\ngetVal (Trivial x) = x\n\nclass JointDist d a where\n    toTrivialDist :: d a -&gt; TrivialDist [a]\n\ndata TrivialJointDist a = TrivialJoint [a]\n\ninstance JointDist TrivialJointDist a where\n    toTrivialDist :: TrivialJointDist a -&gt; TrivialDist [a]\n    toTrivialDist (TrivialJoint xs) = Trivial xs\n\nclass Simulable s a where\n    type Samp s a :: *\n    -- generates infinite stream of random samples from a distribution\n    samples :: s a -&gt; IO [Samp s a]\n    -- generates a single random sample from a distribution\n    sample :: s a -&gt; IO (Samp s a)\n    sample = fmap head . samples\n\ninstance Simulable TrivialDist a where\n    type Samp TrivialDist a = a\n    samples :: TrivialDist a -&gt; IO [a]\n    samples (Trivial x) = return $ repeat x\n\ninstance (JointDist d a) =&gt; Simulable d a where\n    type Samp d a = [a]\n    samples :: d a -&gt; IO [[a]]\n    samples = samples . toTrivialDist\n</code></pre>\n\n<p>When I load it into ghci, I get this error:</p>\n\n<pre><code>test.hs:30:10: error:\n    Conflicting family instance declarations:\n      Samp TrivialDist a = a -- Defined at test.hs:30:10\n      Samp d a = [a] -- Defined at test.hs:40:10\n   |\n30 |     type Samp TrivialDist a = a\n   |          ^^^^^^^^^^^^^^^^^^^^^^\nFailed, 0 modules loaded.\n</code></pre>\n\n<p>This issue seems to resemble the one found <a href=\"https://stackoverflow.com/questions/17593730/why-are-these-family-instance-declarations-conflicting\">here</a> (the explanation seems to be that GHC can't distinguish the types based on the constraints), but no solution was proposed.</p>\n\n<p>I can get the code to compile if I change the last instance declaration to:</p>\n\n<pre><code>instance Simulable TrivialJointDist a where\n    type Samp TrivialJointDist a = [a]\n    samples :: TrivialJointDist a -&gt; IO [[a]]\n    samples = samples . toTrivialDist\n</code></pre>\n\n<p>However, I then lose the advantage of polymorphism, as I would need to make separate instance declarations for each subtype of <code>JointDist d a</code>.</p>\n\n<p>Any help is much appreciated!</p>\n"}, {"tags": ["haskell", "pattern-matching", "warnings", "suppress-warnings", "non-exhaustive-patterns"], "comments": [{"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 1, "creation_date": 1550341048, "post_id": 54726077, "comment_id": 96236361, "body": "This sounds like you are asking ghc to solve the halting problem."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1550341781, "post_id": 54726077, "comment_id": 96236550, "body": "Pattern synonyms and the <code>COMPLETE</code> pragma?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1550343991, "post_id": 54726077, "comment_id": 96237191, "body": "This seems a little backwards anyway; define <code>highestPitch</code> first explicitly, then <code>pitched = either False True . highestPitch</code>."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1550426857, "post_id": 54726077, "comment_id": 96254550, "body": "@chepner, <code>either</code> takes two functions, not two constants.  Better to do <code>pitched = isRight . highestPitch</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1550427032, "post_id": 54726077, "comment_id": 96254613, "body": "@pat Yeah, that was a dumb mistake on my part. (I see @chi fixed my answer for me.) I like suggesting <code>either</code> in this case, though, because it doesn&#39;t require importing <code>Data.Either</code> like <code>isRight</code> does."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1550343739, "creation_date": 1550343739, "answer_id": 54726604, "question_id": 54726077, "link": "https://stackoverflow.com/questions/54726077/avoid-inappropriate-non-exhaustive-pattern-match-warning-in-ghci/54726604#54726604", "title": "Avoid inappropriate non-exhaustive pattern match warning in GHCI", "body": "<p>GHC does not check exhaustiveness taking into account the definition of <code>pitched</code>. Consequently, the first equation is essentially ignored by the checker, causing the warning to be raised.</p>\n\n<p>Indeed, from a computing science perspective, GHC can not decide that in the general case, since exhaustiveness in the presence of view patterns is undecidable. At best, GHC might use some sophisticated static analysis, but instead it simply chooses to ignore <code>pitched</code> completely.</p>\n\n<p>To silence the warning, I can see two main options. The first is to add a catch all case at the end.</p>\n\n<pre><code>highestPitch :: Instrument -&gt; Either String Float\nhighestPitch i@(pitched -&gt; False) =\n  Left $ \"Instrument \" ++ show i ++ \" has no pitch.\"\nhighestPitch (Drums (Just Cowbell)) = Right 800\nhighestPitch Violin                 = Right 5000\nhighestPitch Oboe                   = Right 2000\nhighestPitch i                      =\n  Left $ \"Instrument \" ++ show i ++ \" has no pitch.\"\n  -- we could even use \"error\", in certain cases\n</code></pre>\n\n<p>If we follow this route, in this specific case we can remove the first equation.</p>\n\n<pre><code>highestPitch :: Instrument -&gt; Either String Float\nhighestPitch (Drums (Just Cowbell)) = Right 800\nhighestPitch Violin                 = Right 5000\nhighestPitch Oboe                   = Right 2000\nhighestPitch i                      =\n  Left $ \"Instrument \" ++ show i ++ \" has no pitch.\"\n</code></pre>\n\n<p>Alternatively, we could make the last case <code>Oboe</code> a catch-all one:</p>\n\n<pre><code>highestPitch :: Instrument -&gt; Either String Float\nhighestPitch i@(pitched -&gt; False) =\n  Left $ \"Instrument \" ++ show i ++ \" has no pitch.\"\nhighestPitch (Drums (Just Cowbell)) = Right 800\nhighestPitch Violin                 = Right 5000\nhighestPitch _oboe                  = Right 2000   -- must be an Oboe\n</code></pre>\n\n<p>I am not a huge fan of this approach, though, since if <code>pitched</code> contains a bug, this will silently produce pitches which should have been not existent.</p>\n\n<p>Actually, as pointed out above in the comments, there is a third way: using <code>PatternSynonyms</code> and the <code>COMPLETE</code> pragma to convince GHC to silence the warning. This is however more advanced. While it definitely has its uses in designing libraries, for this specific case it is probably a bit overkill.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 4, "last_activity_date": 1550395696, "last_edit_date": 1550395696, "creation_date": 1550344685, "answer_id": 54726757, "question_id": 54726077, "link": "https://stackoverflow.com/questions/54726077/avoid-inappropriate-non-exhaustive-pattern-match-warning-in-ghci/54726757#54726757", "title": "Avoid inappropriate non-exhaustive pattern match warning in GHCI", "body": "<p>I would reverse which function is \"definitive\". Even if an instrument is pitched, you still have to assign some highest pitch, while <code>highestPitch</code> provides everything you need to know if an instrument is pitched or not. Thus</p>\n\n<pre><code>-- An instrument with a highest pitch is pitched; the others aren't.\npitched :: Instrument -&gt; Bool\npitched = either (const False) (const True) . highestPitch\n\n\nhighestPitch :: Instrument -&gt; Either String Float\nhighestPitch (Drums (Just Cowbell)) = Right 800\nhighestPitch Violin                 = Right 5000\nhighestPitch Oboe                   = Right 2000\nhighestPitch Rattle = Left \"Instrument Rattle has no pitch\"\nhighestPitch (Drums Nothing) = Left \"Instrument Drums Nothing has no pitch\"\n</code></pre>\n"}], "owner": {"reputation": 2588, "user_id": 916142, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/cf88a560a7f987712350b7d629ed2bc7?s=128&d=identicon&r=PG", "display_name": "Jeffrey Benjamin Brown", "link": "https://stackoverflow.com/users/916142/jeffrey-benjamin-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1550395696, "creation_date": 1550340091, "last_edit_date": 1550371428, "question_id": 54726077, "link": "https://stackoverflow.com/questions/54726077/avoid-inappropriate-non-exhaustive-pattern-match-warning-in-ghci", "title": "Avoid inappropriate non-exhaustive pattern match warning in GHCI", "body": "<h1>Before you dismiss this as a duplicate</h1>\n\n<p>I see that at least as of September 2018, <a href=\"https://stackoverflow.com/questions/41768887/how-can-i-disable-haskell-warning-in-small-block\">GHCI does not allow you to disable a warning locally</a> (although you can in a whole file). </p>\n\n<p>But maybe there's some other way to let GHCI know that every case is in fact being handled?</p>\n\n<h1>The Question</h1>\n\n<p>An idiom I use sometimes is to write a function where the first definition(s) tests for some predicate(s) and returns Left, and the other definitions consider arguments where the operation actually makes sense. Whenever I do that, I get a \"Pattern match(es) are non-exhaustive\" error, but I really am checking for every condition.</p>\n\n<h1>Example</h1>\n\n<p>(For the real-world code motivating this toy example, see e.g. the definition of <code>pExprToHExpr</code> <a href=\"https://github.com/JeffreyBenjaminBrown/rslt-haskell/blob/d7d3869f2c266888b7fad0c6c9cb5f32dcdd2bed/src/Hash/Convert.hs\" rel=\"nofollow noreferrer\">here</a>.)</p>\n\n<p>This code:</p>\n\n<pre><code>{-# LANGUAGE ViewPatterns #-}\n\ndata Cowbell = Cowbell\n  deriving Show\ndata Instrument = Rattle\n                | Drums (Maybe Cowbell)\n                | Violin\n                | Oboe\n  deriving Show\n\npitched :: Instrument -&gt; Bool\npitched Rattle                 = False\npitched (Drums Nothing)        = False\npitched (Drums (Just Cowbell)) = True\npitched Violin                 = True\npitched Oboe                   = True\n\nhighestPitch :: Instrument -&gt; Either String Float\nhighestPitch i@(pitched -&gt; False) =\n  Left $ \"Instrument \" ++ show i ++ \" has no pitch.\"\nhighestPitch (Drums (Just Cowbell)) = Right 800\nhighestPitch Violin                 = Right 5000\nhighestPitch Oboe                   = Right 2000\n</code></pre>\n\n<p>generates this error:</p>\n\n<pre><code>example.hs:19:1: warning: [-Wincomplete-patterns]\n    Pattern match(es) are non-exhaustive\n    In an equation for \u2018highestPitch\u2019:\n        Patterns not matched:\n            Rattle\n            (Drums Nothing)\n</code></pre>\n\n<p>Under other conditions, I would just subdivide the <code>Instrument</code> type:</p>\n\n<pre><code>data Percussive = Rattle | Drums\ndata Pitched    = Violin | Oboe\ndata Instrument = Percussive Percussive\n                | Pitched Pitched\n</code></pre>\n\n<p>But (in this imaginary physics) a set of <code>Drums</code> might have a highest pitch, if it includes a <code>Cowbell</code>, so it doesn't fit into either the <code>Percussive</code> or the <code>Pitched</code> type.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 3, "creation_date": 1550339844, "post_id": 54726021, "comment_id": 96236013, "body": "It helps if you write your functions with explicit type signatures."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 1, "creation_date": 1550340154, "post_id": 54726021, "comment_id": 96236116, "body": "Hint: Use <code>zip</code>."}], "answers": [{"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1550340645, "post_id": 54726087, "comment_id": 96236258, "body": "The &quot;pointfree&quot; style is not entirely correct, since this can only &quot;chain&quot; one parameter. You can use the <code>(.).(.)</code> operator, but that perhaps makes things a bit &quot;<i>overcomplicated</i>&quot;. +1 nevertheless for the first attempt."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1550340745, "post_id": 54726087, "comment_id": 96236288, "body": "@WillemVanOnsem oops, you&#39;re correct, I should know that by now as I&#39;ve often tried it and had it not work, and eventually realised this. That should teach me for posting an answer without actually testing it! I&#39;ll rewrite as a correct composition by reducing to a function of one parameter rather than zero."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1550342477, "post_id": 54726087, "comment_id": 96236725, "body": "It&#39;s not <i>too</i> bad though: <code>map2 = ((map snd . filter fst) .) . zip</code>."}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 4, "last_activity_date": 1550340771, "last_edit_date": 1550340771, "creation_date": 1550340178, "answer_id": 54726087, "question_id": 54726021, "link": "https://stackoverflow.com/questions/54726021/filter-haskell-list-based-on-another-list/54726087#54726087", "title": "Filter haskell list based on another list", "body": "<p>The easiest way I can think of to implement this would be as follows:</p>\n\n<pre><code>map2 :: [Bool] -&gt; [a] -&gt; [a]\nmap2 bs as = map snd $ filter fst $ zip bs as\n</code></pre>\n\n<p>That is, zip the two lists together to get a list of pairs where the first one is the Boolean indicating whether to keep it or not. Then filter to only the ones with <code>True</code> in the first slot, and extract their original elements with <code>map snd</code>.</p>\n\n<p>Note that the above is an explicit form, in practice I'd probably simplify this to remove the <code>as</code> parameter:</p>\n\n<pre><code>map2 bs = (map snd) . (filter fst) . (zip bs)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1550344938, "post_id": 54726142, "comment_id": 96237468, "body": "... or <code>[ y | (True, y) &lt;- zip l1 l2 ]</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1550345142, "last_edit_date": 1550345142, "creation_date": 1550340544, "answer_id": 54726142, "question_id": 54726021, "link": "https://stackoverflow.com/questions/54726021/filter-haskell-list-based-on-another-list/54726142#54726142", "title": "Filter haskell list based on another list", "body": "<p>The main problem is that you write brackets the wrong way. If you write brackets like <code>f (g x)</code>, then Haskell interprets this, like a language in the C/C++/Java language family would do that like <code>f(g(x))</code>.</p>\n\n<p>Here you write expressions like:</p>\n\n<pre><code>map2 (os xs (res ++ [x]))\n</code></pre>\n\n<p>So according to the syntax, <code>os</code> should be a function, and <code>xs</code> its parameter. But that is not the case.</p>\n\n<p>We can solve the problem like:</p>\n\n<pre><code>map2 :: [Bool] -&gt; [a] -&gt; [a] -&gt; [a]\nmap2 [] [] res = res\nmap2 (o:os) (x:xs) res = if o then map2 os xs (res ++ [x]) else map2 os xs res</code></pre>\n\n<p>but still this is <em>not</em> the best way to handle it, since:</p>\n\n<ol>\n<li>it might happen that the two lists do not have the same length, in that case the function will raise an error; and</li>\n<li><code>(++)</code> runs linear with the length of the first list, making this a quadratic algorithm.</li>\n</ol>\n\n<p>We can solve these problems by writing it like:</p>\n\n<pre><code>map2 :: [Bool] -&gt; [a] -&gt; [a]\nmap2 (o:os) (x:xs) | o = x : map2 os xs\n                   | otherwise = map2 os xs\nmap2 _ _ = []</code></pre>\n\n<p>we thus no longer need an <em>accumulator</em> here.</p>\n\n<h1>Using <code>zip</code></h1>\n\n<p>You can use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:zip\" rel=\"nofollow noreferrer\"><strong><code>zip :: [a] -&gt; [b] -&gt; [(a, b)]</code></strong></a> to iterate over two lists concurrently and produce tuples of those elements, for example:</p>\n\n<pre><code>Prelude&gt; zip [True, False, True] [1,2,3]\n[(True,1),(False,2),(True,3)]\n</code></pre>\n\n<p>We can then use this, for example in list comprehension to filter, and yield the corresponding elements, like:</p>\n\n<pre><code>map2 :: [Bool] -&gt; [a] -&gt; [a]\nmap2 l1 l2 = [ y | (x, y) &lt;- zip l1 l2, x ]\n</code></pre>\n\n<p>or we can, like <a href=\"https://stackoverflow.com/questions/54726021/filter-haskell-list-based-on-another-list/54726142?noredirect=1#comment96237468_54726142\">@WillNess says</a>, put the filter already in the pattern matching, like:</p>\n\n<pre><code>map2 :: [Bool] -&gt; [a] -&gt; [a]\nmap2 l1 l2 = [ y | (<b>True</b>, y) &lt;- zip l1 l2]</code></pre>\n"}], "owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 1, "accepted_answer_id": 54726142, "answer_count": 2, "score": 1, "last_activity_date": 1550345142, "creation_date": 1550339741, "question_id": 54726021, "link": "https://stackoverflow.com/questions/54726021/filter-haskell-list-based-on-another-list", "title": "Filter haskell list based on another list", "body": "<p>Let's say I have two lists:</p>\n\n<pre><code>l1 = [True, False, True]\n\nl2 = [1, 2, 3]\n</code></pre>\n\n<p>I want the result of my function to be <code>[1, 3]</code>, as they map to <code>True</code> in the other list</p>\n\n<p>This is what I have thought of:</p>\n\n<pre><code>map2 [] [] res = res\nmap2 (o:os) (x:xs) res = if o then map2 (os xs (res ++ [x])) else map2 (os xs (res ++ []))\n</code></pre>\n\n<p>We can map 2 lists at the same time. Basically if <code>o</code> is True, then I want to add <code>x</code> to the list, otherwise I don't. I think this should work, but it doesn't.</p>\n\n<p>I get that <strong>Couldn't match expected type `[a0] -> [a0] -> [Bool]'</strong></p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 6008, "user_id": 1983772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f429722c8167802b89cbe4d324aa1e?s=128&d=identicon&r=PG", "display_name": "Norrius", "link": "https://stackoverflow.com/users/1983772/norrius"}, "edited": false, "score": 0, "creation_date": 1550341827, "post_id": 54725856, "comment_id": 96236564, "body": "Yes; I though there was some function to do that, but completely overlooked it while skimming the docs for it."}, {"owner": {"reputation": 6008, "user_id": 1983772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f429722c8167802b89cbe4d324aa1e?s=128&d=identicon&r=PG", "display_name": "Norrius", "link": "https://stackoverflow.com/users/1983772/norrius"}, "edited": false, "score": 0, "creation_date": 1550345930, "post_id": 54725856, "comment_id": 96237752, "body": "One more thing though: <code>fromList</code> takes a <code>[(k, v)]</code>, and <code>f&#39;</code> returns just a <code>v</code>. So <code>zipMap</code> has to either add the key or expect this from the user-supplied <code>f</code>. Can you please fix this (in either direction) in case someone else finds this useful? :)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 6008, "user_id": 1983772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f429722c8167802b89cbe4d324aa1e?s=128&d=identicon&r=PG", "display_name": "Norrius", "link": "https://stackoverflow.com/users/1983772/norrius"}, "edited": false, "score": 0, "creation_date": 1550346461, "post_id": 54725856, "comment_id": 96237909, "body": "Oh, right. I had it wrong in an earlier version, too; I fixed it there, but not here."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 1, "last_activity_date": 1550346478, "last_edit_date": 1550346478, "creation_date": 1550338610, "answer_id": 54725856, "question_id": 54725554, "link": "https://stackoverflow.com/questions/54725554/zipping-two-hashmaps/54725856#54725856", "title": "Zipping two HashMaps", "body": "<p>In general:</p>\n\n<ol>\n<li>Merge the two maps to get a list of all keys</li>\n<li>Define a new function that, given a key, uses <code>lookupDefault</code> to\nget the appropriate value (default or real) from each map in order\nto compute the value for the new map</li>\n<li>Map that function over the keys, and create a new hash map from the result.</li>\n</ol>\n\n<hr>\n\n<pre><code>zipMap :: (v1 -&gt; v2 -&gt; v3) -- Combining function\n       -&gt; v1               -- default value for keys unique to the second map\n       -&gt; v2               -- default value for keys unique to the first map\n       -&gt; HashMap k v1\n       -&gt; HashMap k v2\n       -&gt; HashMap k v3\nzipMap f d1 d2 m1 m2 = let allKeys = keys (union m1 m2)\n                           f' k = (k, f (lookupDefault d1 k m1) (lookupDefault d2 k m2))\n                       in fromList $ map f' allKeys\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6008, "user_id": 1983772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f429722c8167802b89cbe4d324aa1e?s=128&d=identicon&r=PG", "display_name": "Norrius", "link": "https://stackoverflow.com/users/1983772/norrius"}, "edited": false, "score": 0, "creation_date": 1550339818, "post_id": 54725959, "comment_id": 96236002, "body": "Wow, <code>These</code> looks very natural in this scenario. That&#39;s really cool, although obviously installing another package is not always convenient (dependency on aeson? wtf)."}, {"owner": {"reputation": 6008, "user_id": 1983772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f429722c8167802b89cbe4d324aa1e?s=128&d=identicon&r=PG", "display_name": "Norrius", "link": "https://stackoverflow.com/users/1983772/norrius"}, "edited": false, "score": 0, "creation_date": 1550346417, "post_id": 54725959, "comment_id": 96237892, "body": "I can confirm that this works well, but in my case installing an extra library was not an option. Nevertheless, thank you for showing me <code>these</code>"}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1550339312, "creation_date": 1550339312, "answer_id": 54725959, "question_id": 54725554, "link": "https://stackoverflow.com/questions/54725554/zipping-two-hashmaps/54725959#54725959", "title": "Zipping two HashMaps", "body": "<p>The <a href=\"http://hackage.haskell.org/package/these\" rel=\"nofollow noreferrer\">these</a> package provides the <a href=\"http://hackage.haskell.org/package/these-0.7.6/docs/Data-These.html#t:These\" rel=\"nofollow noreferrer\"><code>These</code></a> datatype, which is a bit like <code>Either</code> but has an extra constructor for when <em>both</em> cases are present.</p>\n\n<p>The package also defines typeclasses for \"zipping with padding\" over data structures. In particular the <a href=\"http://hackage.haskell.org/package/these-0.7.6/docs/Data-Align.html#t:Align\" rel=\"nofollow noreferrer\"><code>Align</code></a> typeclass, which has a <code>HashMap</code> instance.</p>\n\n<p>For example, to zip two maps using <code>0</code>s for missing entries:</p>\n\n<pre><code>import Data.These\nimport Data.Align\n\npadWithZeros :: (Align f, Num a, Num b) =&gt; f a -&gt; f b -&gt; f (a, b)\npadWithZeros = alignWith (fromThese 0 0)\n</code></pre>\n\n<p>There are also <a href=\"http://hackage.haskell.org/package/these-0.7.6/docs/Data-Align-Indexed.html\" rel=\"nofollow noreferrer\"><code>Data.Align.Indexed</code></a> and <code>Data.Align.Keyed</code>, which give the zipping function access to the key.</p>\n\n<p>One disadvantage of <a href=\"http://hackage.haskell.org/package/these\" rel=\"nofollow noreferrer\">these</a> is that the dependency foot print is somewhat heavy.</p>\n"}], "owner": {"reputation": 6008, "user_id": 1983772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f429722c8167802b89cbe4d324aa1e?s=128&d=identicon&r=PG", "display_name": "Norrius", "link": "https://stackoverflow.com/users/1983772/norrius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 54725856, "answer_count": 2, "score": 2, "last_activity_date": 1550346478, "creation_date": 1550336759, "question_id": 54725554, "link": "https://stackoverflow.com/questions/54725554/zipping-two-hashmaps", "title": "Zipping two HashMaps", "body": "<p>Let's say I have two HashMaps:</p>\n\n<pre><code>import Data.HashMap.Strict\nm1 :: HashMap Char Int\nm2 :: HashMap Char Int\n??? :: (v1 -&gt; v2 -&gt; v3) -&gt; HashMap k v1 -&gt; HashMap k v2 -&gt; HashMap k v3\n-- or even\n??? :: (k -&gt; v1 -&gt; v2 -&gt; v3) -&gt; HashMap k v1 -&gt; HashMap k v2 -&gt; HashMap k v3\n</code></pre>\n\n<p>I'd like some kind of <code>zip</code> to walk over these maps, where:</p>\n\n<ol>\n<li>if a key exists in one map but not the other, it is substituted with a default (sort of <strong>\"zip longest\"</strong>)</li>\n<li>the <strong>result type can be different</strong> from the original types.</li>\n</ol>\n\n<p>This matches the signature of <a href=\"https://hackage.haskell.org/package/unordered-containers/docs/Data-HashMap-Strict.html#v:intersectionWithKey\" rel=\"nofollow noreferrer\"><code>intersectionWithKey</code></a> with semantics closer to <a href=\"https://hackage.haskell.org/package/unordered-containers/docs/Data-HashMap-Strict.html#v:unionWithKey\" rel=\"nofollow noreferrer\"><code>unionWithKey</code></a>.</p>\n\n<p>A concrete example: for a simple case of applying <code>(,)</code> with a 0 default, I can do</p>\n\n<pre><code>unionWith add (map (,0) m1) (map (0,) m2) :: HashMap Char (Int, Int)\nadd (a, x) (b, y) = (a+b, x+y)\n</code></pre>\n\n<p>This provokes the question: is there a clean way to do this in general?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1550333972, "post_id": 54725099, "comment_id": 96234230, "body": "the <code>where</code> clause needs to be indented. (Haskell treats anything with the same &quot;indentation level&quot; as the previous line as a new statement, this is a part of the previous expression so it needs to be intended to show this.)"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1550334059, "post_id": 54725099, "comment_id": 96234260, "body": "by the way there are a number of other issues and misunderstandings with your implementation"}, {"owner": {"reputation": 27, "user_id": 11071950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c2d14cda72662327a3981d072e761de?s=128&d=identicon&r=PG&f=1", "display_name": "karim doe", "link": "https://stackoverflow.com/users/11071950/karim-doe"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550334136, "post_id": 54725099, "comment_id": 96234284, "body": "what are the other errors can you please help"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1550357011, "post_id": 54725099, "comment_id": 96240368, "body": "Haskell <code>where</code> is not the same as SQL <code>where</code>."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1550334555, "creation_date": 1550334555, "answer_id": 54725190, "question_id": 54725099, "link": "https://stackoverflow.com/questions/54725099/keep-getting-a-parse-indendation-error-in-haskell-what-am-i-doing-wrong/54725190#54725190", "title": "keep getting a parse indendation error in Haskell what am I doing wrong", "body": "<p>The above code fragment contains some errors:</p>\n\n<ol>\n<li>you here use <code>where</code> as a filter, but in Haskell a where clause is used to define locally scoped variables;</li>\n<li>you only define the <code>(x:xs)</code> pattern, so even if this works, it will error on the empty list;</li>\n<li><code>[x | x &lt;- xs]</code> is just the identity function for a list, so we can omit that, furthermore it is advisable <em>not</em> to name variables the same as the \"outer\" variables, since that creates confusion; and</li>\n<li><code>x mod 2 == 1</code> can be replaced by <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:odd\" rel=\"nofollow noreferrer\"><strong><code>odd :: Integral i =&gt; i -&gt; Bool</code></strong></a>.</li>\n</ol>\n\n<p>We can fix this by writing it like:</p>\n\n<pre><code>cubeOdds2 :: Integral i =&gt; [i] -&gt; [i]\ncubeOdds2 = map cube . filter odd\n    where cube x = x * x * x</code></pre>\n\n<p>For example:</p>\n\n<pre><code>Prelude&gt; cubeOdds2 [1,4,2,5]\n[1,125]\n</code></pre>\n\n<p>We here thus use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:filter\" rel=\"nofollow noreferrer\"><strong><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</code></strong></a> to filter the list, such that only odd numbers are retained, and then use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:map\" rel=\"nofollow noreferrer\"><strong><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code></strong></a> to perform a mapping on these elements with <code>cube</code> as the function that takes an element and returns the mapping for that element.</p>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1550335108, "last_edit_date": 1550335108, "creation_date": 1550334745, "answer_id": 54725221, "question_id": 54725099, "link": "https://stackoverflow.com/questions/54725099/keep-getting-a-parse-indendation-error-in-haskell-what-am-i-doing-wrong/54725221#54725221", "title": "keep getting a parse indendation error in Haskell what am I doing wrong", "body": "<p>You have a few problems. One is incorrect syntax the other is misunderstanding what the where clause is for.  Then there's pattern matching unnecessarily.  Finally, and not strictly a problem, is a mix of list notation and higher order functions.</p>\n\n<p><strong>Not a Where Clause</strong></p>\n\n<p>A <code>where</code> clause is for variable bindings, such as:</p>\n\n<pre><code>where functionName param1 param2 = &lt;some expression&gt;\n</code></pre>\n\n<p>The clause is not useful for constraints over the variables.   For a list-notation style constraint just add a comma and the constraint:</p>\n\n<pre><code>[x | x &lt;- list, predicate1 x, predicate2 x]\n</code></pre>\n\n<p><strong>Pattern Matching</strong></p>\n\n<p>The function <code>cubeOdds2 (x:xs)</code> will bind <code>x</code> to the first element in the list then <code>xs</code> to the remaining list.  It will also fail with an exception on empty lists. \n What you seem to want is to just operate on the list , so don't pattern match and just use a variable name such as <code>cubeOdds2 xs</code>.</p>\n\n<p><strong>List Comprehension Notation vs Higher Order Functions</strong></p>\n\n<p>A list comprehension is syntax like <code>[a | val &lt;- list, predicate val, let a = someFunction val]</code>.  Higher order functions can do everything the list comprehension does, such as <code>map</code>ping the someFunction computation and <code>filter</code>ing based on the predicate.</p>\n\n<p><strong>Some Solutions</strong></p>\n\n<p>With these changes we have three final forms for your cubeOdds function.</p>\n\n<p>First, your mix of conventions:</p>\n\n<pre><code>cubeOdds3 xs = map cube [x | x &lt;- xs, x `mod` 2 == 1]\n</code></pre>\n\n<p>Second, just list comprehension:</p>\n\n<pre><code>cubeOdds4 xs = [cube x | x &lt;- xs, x `mod` 2 == 1]\n</code></pre>\n\n<p>Third, just higher order functions:</p>\n\n<pre><code>cubeOdds5 xs = map cube (filter (\\x -&gt; x `mod` 2 == 1) xs)\n</code></pre>\n\n<p><strong>Code Golf</strong></p>\n\n<p>We can even go further and use the built in <code>odd</code> function:</p>\n\n<pre><code>cubeOdds6 xs = [cube x | x &lt;- xs, odd x]\n</code></pre>\n\n<p>And use point free style too:</p>\n\n<pre><code>cubeOdds7 = map cube . filter odd\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11071950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c2d14cda72662327a3981d072e761de?s=128&d=identicon&r=PG&f=1", "display_name": "karim doe", "link": "https://stackoverflow.com/users/11071950/karim-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1550351377, "creation_date": 1550333928, "last_edit_date": 1550351377, "question_id": 54725099, "link": "https://stackoverflow.com/questions/54725099/keep-getting-a-parse-indendation-error-in-haskell-what-am-i-doing-wrong", "title": "keep getting a parse indendation error in Haskell what am I doing wrong", "body": "<pre><code>cube = x*x*x\ncube xs = map cube [x | x &lt;-xs] \n           where x mod 2 == 1\n</code></pre>\n\n<p>so I'm trying to get the odd number of the list</p>\n\n<p>Thank you all for your help!</p>\n"}, {"tags": ["python", "dictionary", "haskell"], "comments": [{"owner": {"reputation": 26111, "user_id": 2750492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fTVM8.jpg?s=128&g=1", "display_name": "AChampion", "link": "https://stackoverflow.com/users/2750492/achampion"}, "edited": false, "score": 1, "creation_date": 1550333301, "post_id": 54724876, "comment_id": 96234044, "body": "What is <code>startingPoint</code>? If this is just a typo of <code>start</code> then your python is overly complicated because you don&#39;t need the <code>if</code> condition because you <code>return True</code> if you drop out of the <code>for</code> loop and an empty adjacency list would immediately drop out."}, {"owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "reply_to_user": {"reputation": 26111, "user_id": 2750492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fTVM8.jpg?s=128&g=1", "display_name": "AChampion", "link": "https://stackoverflow.com/users/2750492/achampion"}, "edited": false, "score": 0, "creation_date": 1550333655, "post_id": 54724876, "comment_id": 96234146, "body": "Sorry it should just be start, okay yes I can do that, but still the recursive case stands"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3956566"}, "edited": false, "score": 1, "creation_date": 1550628359, "post_id": 54724876, "comment_id": 96334921, "body": "Do not delete your question when you get your answer. See <a href=\"https://meta.stackoverflow.com/questions/378440/caveat-emptor-making-students-aware-they-cannot-delete-their-homework-questions\" title=\"caveat emptor making students aware they cannot delete their homework questions\">meta.stackoverflow.com/questions/378440/&hellip;</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "edited": false, "score": 0, "creation_date": 1550337797, "post_id": 54725498, "comment_id": 96235416, "body": "Thanks for this! I like the <code>filter</code> command. I was going to manually delete the item from the list but it seems like filter does the job! Actually a question, you say I only need <code>adjust</code>. But in the python code, the adjust that I make does depend on the key, its <code>adjListCopy[start].remove(vertex)</code>, where <code>start</code> is the key. Is this not dependent?"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "edited": false, "score": 0, "creation_date": 1550337890, "post_id": 54725498, "comment_id": 96235452, "body": "@KSplitX You&#39;re only using the key to choose which value to adjust, and passing <code>start</code> as a parameter to <code>adjust</code> already takes care of that. You only need <code>adjustWithKey</code> if the new value depends on the key, rather than just depending on the old value. <code>filter (vertex &#47;=)</code> does its job with just the old value."}, {"owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "edited": false, "score": 0, "creation_date": 1550350790, "post_id": 54725498, "comment_id": 96238854, "body": "Hmm one more question actually, the <code>any</code> command takes a function and a list, and return True if at least one matches. In our case, we are never returning True or False anywhere, so where does it get its input from? In python it is clear where the True and False comes from, but not in haskell?"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "edited": false, "score": 0, "creation_date": 1550352273, "post_id": 54725498, "comment_id": 96239203, "body": "@KSplitX It comes from <code>any</code>. When you call <code>any</code> on an empty list, it ignores the function you pass it and just returns <code>False</code>. Since each level of recursion applies a <code>not</code>, the final <code>True</code> or <code>False</code> depends on whether there were an odd or even number of levels of recursion down to this base case."}, {"owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "edited": false, "score": 0, "creation_date": 1550352934, "post_id": 54725498, "comment_id": 96239358, "body": "Where would I add a true or false in the haskell code for clarity purposes?"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "edited": false, "score": 0, "creation_date": 1550353395, "post_id": 54725498, "comment_id": 96239481, "body": "@KSplitX If you really want those constants in the code, you could replace <code>not $ any f adjListAtstarting</code> with <code>if any f adjListAtstarting then False else True</code>, but that&#39;s widely considered to make the code <i>less</i> clear."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1550338392, "last_edit_date": 1550338392, "creation_date": 1550336415, "answer_id": 54725498, "question_id": 54724876, "link": "https://stackoverflow.com/questions/54724876/trouble-converting-recursive-case-to-haskell/54725498#54725498", "title": "Trouble converting recursive case to Haskell", "body": "<p>This should work:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import qualified Data.Map as Map\n\nwin adjList start = not $ any f adjListAtstarting\n    where adjListAtstarting = Map.findWithDefault [] start adjList\n          f vertex = win (Map.adjust (filter (vertex /=)) start adjList) vertex\n</code></pre>\n\n<p>Since you want to handle <code>Just []</code> and <code>Nothing</code> the same anyway, I used <code>findWithDefault</code> instead of <code>lookup</code> so you don't have to deal with the <code>Maybe</code> at all. As AChampion pointed out, you don't need the <code>if</code> test, as the right thing automatically happens if the list is empty.</p>\n\n<p><code>not $ any f adjListAtstarting</code> calls function <code>f</code> on each of the elements of <code>adjListAtstarting</code>, and returns <code>True</code> if all of the calls to <code>f</code> returned <code>False</code>, but returns <code>False</code> if any of the calls to <code>f</code> returned <code>True</code>. This matches your Python for loop, which immediately returns <code>False</code> if the inner test is ever <code>True</code>, and returns <code>True</code> if the loop exits because the inner test was always false.</p>\n\n<p><code>filter (vertex /=)</code> takes a list, and returns a list with all of the elements except for <code>vertex</code>. (Note: You used <code>remove</code> in Python, which only removes the first occurrence of the element from the list. This will remove all of the matching elements from the list. If lists will never contain two of the same element, then this is fine. If they do, then you'll need to use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:delete\" rel=\"nofollow noreferrer\">the <code>delete</code> function (imported from <code>Data.List</code>)</a> instead.)</p>\n\n<p><code>Map.adjust (filter (vertex /=)) start adjList</code> calls <code>filter (vertex /=)</code> on the <code>start</code> element of <code>adjList</code>, and returns a map where the result of that call is the replacement for the <code>start</code> element in the input, and all other elements are the same. (You only need <code>adjust</code> and not <code>adjustWithKey</code>, since the change you're making to the value doesn't depend on the key.)</p>\n"}], "owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1550338392, "creation_date": 1550332309, "last_edit_date": 1550337751, "question_id": 54724876, "link": "https://stackoverflow.com/questions/54724876/trouble-converting-recursive-case-to-haskell", "title": "Trouble converting recursive case to Haskell", "body": "<p>I have the following python code:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>def win(start, adjList):\n  if len(adjList[start]) == 0: return True\n\n  else:\n\n    for vertex in adjList[startingPoint]:\n\n      adjListCopy = copy.deepcopy(adjList)\n      adjListCopy[start].remove(vertex)\n\n      if (win(vertex, adjListCopy)): return False\n\n  return True\n</code></pre>\n\n<p>Here <code>adjList</code> is a dictionary, like <code>{0: [1,2], 2: [3], 3: []}</code> and start is a index to look at, in this case assume start is <code>0</code>. Then it will return if we can win if we start at <code>0</code>.</p>\n\n<p>In haskell I will represent the dictionary as a <code>Map</code></p>\n\n<p>Here is my code so far: </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>win adjList start =\n    if (adjListAtstarting) == Just [] || (adjListAtstarting) == Nothing\n        then True\n    else\n        False\n        -- loop through each item in the map, and recurse\n\n    where adjListAtstarting = Map.lookup start adjList\n</code></pre>\n\n<p>I need help with the recursive case in haskell. I know that I can perform the <code>adjListCopy[start].remove(vertex)</code> using the <code>Map.adjustWithKey</code> function. The main reason I have trouble is because of the <code>for</code> loop.</p>\n"}, {"tags": ["sqlite", "haskell", "sql-delete"], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 1, "last_activity_date": 1550335782, "creation_date": 1550335782, "answer_id": 54725392, "question_id": 54724750, "link": "https://stackoverflow.com/questions/54724750/error-while-trying-to-delete-a-sqlite-table-in-haskell/54725392#54725392", "title": "Error while trying to delete a sqlite table in haskell", "body": "<p><code>execute</code> requires a query parameter.  From the haddocks:</p>\n\n<pre><code>execute :: ToRow q =&gt; Connection -&gt; Query -&gt; q -&gt; IO ()\n</code></pre>\n\n<p>Try</p>\n\n<pre><code>execute conn \"DROP TABLE tabela\" ()\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9677022, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-8NLYFUhE8f8/AAAAAAAAAAI/AAAAAAAAAQc/ZvoB05WJaCo/photo.jpg?sz=128", "display_name": "Pedro Augusto Null", "link": "https://stackoverflow.com/users/9677022/pedro-augusto-null"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 54725392, "answer_count": 1, "score": 0, "last_activity_date": 1550335782, "creation_date": 1550331522, "last_edit_date": 1550333411, "question_id": 54724750, "link": "https://stackoverflow.com/questions/54724750/error-while-trying-to-delete-a-sqlite-table-in-haskell", "title": "Error while trying to delete a sqlite table in haskell", "body": "<p>I have a problem when trying to delete a complete table in sqlite, could someone help me?</p>\n\n<p>code:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Control.Applicative\nimport Database.SQLite.Simple\nimport Database.SQLite.Simple.FromRow\n\ndata TestField = TestField Int String deriving (Show)\n\ninstance FromRow TestField where\nfromRow = TestField &lt;$&gt; field &lt;*&gt; field\n\nmain :: IO()\nmain = do\nconn &lt;- open \"db1.sqlite\"\nexecute conn \"DROP TABLE tabela\"\nclose conn\n</code></pre>\n\n<p>Returning the error:</p>\n\n<pre><code>delete.hs:14:3: error:\n\u2022 Couldn't match expected type \u2018IO a0\u2019\n              with actual type \u2018q0 -&gt; IO ()\u2019\n\u2022 Probable cause: \u2018execute\u2019 is applied to too few arguments\n  In a stmt of a 'do' block: execute conn \"DROP TABLE tabela\"\n  In the expression:\n    do { conn &lt;- open \"db1.sqlite\";\n         execute conn \"DROP TABLE tabela\";\n         close conn }\n  In an equation for \u2018main\u2019:\n      main\n        = do { conn &lt;- open \"db1.sqlite\";\n               execute conn \"DROP TABLE tabela\";\n               close conn }\n      Failed, modules loaded: none.\n</code></pre>\n"}, {"tags": ["javascript", "haskell", "functional-programming", "continuations", "delimited-continuations"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10675354"}, "edited": false, "score": 0, "creation_date": 1550326065, "post_id": 54723616, "comment_id": 96231901, "body": "I spent hours looking for this. <code>of</code> is not <code>Cont</code>, now it is that obvious. Thanks!"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1550327514, "post_id": 54723616, "comment_id": 96232305, "body": "Cool, it was just a hunch but I didn&#39;t bother to confirm it by testing\u2026 :-)"}], "tags": [], "owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "is_accepted": true, "score": 2, "last_activity_date": 1550324121, "creation_date": 1550324121, "answer_id": 54723616, "question_id": 54721972, "link": "https://stackoverflow.com/questions/54721972/how-to-discard-a-delimited-continuation-from-within-multiple-nested-functions/54723616#54723616", "title": "How to discard a delimited continuation from within multiple nested functions?", "body": "<p>I think your <code>liftM2</code> is broken, as it is not lazy. Instead of using <code>of</code>, it should construct a new continuation:</p>\n\n<pre><code>const liftM2 = f =&gt; tf =&gt; tg =&gt;\n  Cont(k =&gt; runCont(tf) (x =&gt; runCont(tg) (y =&gt; k(f(x)(y)))));\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10675354"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 54723616, "answer_count": 1, "score": 5, "last_activity_date": 1550324121, "creation_date": 1550311918, "last_edit_date": 1550323625, "question_id": 54721972, "link": "https://stackoverflow.com/questions/54721972/how-to-discard-a-delimited-continuation-from-within-multiple-nested-functions", "title": "How to discard a delimited continuation from within multiple nested functions?", "body": "<p>I study delimited continuations and am currently playing with discarding them to obtain an effect similar to raising exceptions.</p>\n\n<p>Here is what causes me trouble:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>const structure = type =&gt; cons =&gt; {\r\n  const f = (f, args) =&gt;\r\n   ({[\"run\" + type]: f, [Symbol.toStringTag]: type, [Symbol(\"args\")]: args});\r\n\r\n  return cons(f);\r\n};\r\n\r\nconst Cont = structure(\"Cont\")\r\n  (Cont =&gt; f =&gt; Cont(f));\r\n\r\nconst runCont = tf =&gt; k =&gt;\r\n  tf.runCont(k);\r\n\r\nconst reset = tf =&gt;\r\n  of(tf.runCont(id));\r\n  \r\nconst shift = f =&gt;\r\n  Cont(k =&gt; f(k).runCont(id));\r\n\r\nconst of = x =&gt;\r\n  Cont(k =&gt; k(x));\r\n  \r\nconst liftM2 = f =&gt; tf =&gt; tg =&gt;\r\n  of(runCont(tf) (x =&gt; runCont(tg) (y =&gt; f(x) (y))));\r\n\r\nconst id = x =&gt; x;\r\n\r\nconst mulM = liftM2(x =&gt; y =&gt; x * y);\r\nconst addM = liftM2(x =&gt; y =&gt; x + y);\r\nconst subM = liftM2(x =&gt; y =&gt; x - y);\r\n\r\nconst z1 = mulM(of(5))\r\n  (reset\r\n    (addM\r\n      (shift(k =&gt; of(3)))\r\n        (of(3)))\r\n  ).runCont(id); // 5 * 3 = 15 (as expected)\r\n\r\nconst z2 = mulM(of(5))\r\n  (reset // A\r\n    (mulM // B\r\n      (addM\r\n        (shift(k =&gt; of(3))) // C should unwind up to A instead of B\r\n          (of(3)))\r\n            (of(4)))\r\n  ).runCont(id); // 5 * 3 * 4 = 60 (but 15 expected)\r\n\r\nconsole.log(z1);\r\nconsole.log(z2);</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>It seems as if I can unwind the stack only by a single frame. Is this by design of <code>shift</code>/<code>reset</code> or caused by a flaw in my implementation?</p>\n\n<p><strong>[EDIT]</strong></p>\n\n<p>I got it working in <a href=\"https://repl.it/repls/TastyCadetblueProcess\" rel=\"nofollow noreferrer\">Haskell</a>, i.e. it's an implementation issue:</p>\n\n<pre><code>reset :: ((a -&gt; a) -&gt; a) -&gt; (a -&gt; r) -&gt; r\nreset k f = f $ k id\n\nshift :: ((a -&gt; r) -&gt; (r -&gt; r) -&gt; r) -&gt; (a -&gt; r) -&gt; r\nshift f k = f k id\n\nreturn :: a -&gt; (a -&gt; r) -&gt; r\nreturn a k = k a\n\nliftM2 :: (a -&gt; b -&gt; c) -&gt; ((a -&gt; r) -&gt; r) -&gt; ((b -&gt; r) -&gt; r) -&gt; (c -&gt; r) -&gt; r\nliftM2 f ma mb k = ma $ \\a -&gt; mb $ \\b -&gt; k (f a b)\n\nexample :: Num a =&gt; (a -&gt; r) -&gt; r\nexample = liftM2 (*) (return 5) (reset (liftM2 (*) (return 3) (liftM2 (+) (return 2) (shift (\\k -&gt; return 3)))))\n</code></pre>\n"}, {"tags": ["haskell", "data-kinds"], "answers": [{"comments": [{"owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "edited": false, "score": 0, "creation_date": 1550296691, "post_id": 54720121, "comment_id": 96225669, "body": "My problem stems mainly from defining other data types. For instance, say I have a new data class who&#39;s constructor takes in either a circle or a square. How do I specify that using the typeclass?"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "edited": false, "score": 0, "creation_date": 1550300957, "post_id": 54720121, "comment_id": 96226265, "body": "I don&#39;t quite understand what you mean by that. Do you mean you want to define a data type which can have a <code>Shape Circle&#39;</code> or <code>Shape Square&#39;</code> field, but not a <code>Shape Triangle&#39;</code>?"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "edited": false, "score": 0, "creation_date": 1550301015, "post_id": 54720121, "comment_id": 96226272, "body": "Oh, just saw your comment on @luqui&#39;s answer explaining it. Never mind."}], "tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": false, "score": 1, "last_activity_date": 1550294080, "creation_date": 1550294080, "answer_id": 54720121, "question_id": 54720058, "link": "https://stackoverflow.com/questions/54720058/datakind-unions/54720121#54720121", "title": "DataKind Unions", "body": "<p>You could use typeclasses:</p>\n\n<pre><code>class MyOpClass sh where\n    myOp :: Shape sh -&gt; Int\n\ninstance MyOpClass Circle' where\n    myOp (Circle r) = _\n\ninstance MyOpClass Square' where\n    myOP (Square s) = _\n</code></pre>\n\n<p>This doesn't feel like a particularly 'complete' solution to me - anyone could go back and add another <code>instance MyOpClass Triangle'</code> - but I can't think of any other solution. Potentially you could avoid this problem simply by not exporting the typeclass however.</p>\n"}, {"comments": [{"owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "edited": false, "score": 0, "creation_date": 1550297112, "post_id": 54720330, "comment_id": 96225731, "body": "At this point, wouldn&#39;t this be the same as creating another data class whose constructors allow for a subset of shapes? The benefit I guess is that the function type still takes in <code>Shape</code>. To repeat the comment I added in the other post, I&#39;m mainly using this to limit inputs for other data types (eg one type can only take in a circle or a triangle). My haskell experience is limited, but is there a way of specifying that constraint using typeclasses?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "edited": false, "score": 0, "creation_date": 1550300557, "post_id": 54720330, "comment_id": 96226213, "body": "@AllanW Yes you can use a class in a GADT, for example. <code>data Scene where BasicShape :: MyOpClass s =&gt; Shape sh -&gt; Scene</code>."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1550301166, "post_id": 54720330, "comment_id": 96226292, "body": "@luqui Using a typeclass doesn&#39;t seem like the right solution for a GADT. I would prefer &#39;collapsing&#39; the indirection by defining <code>data Scene where BasicShape :: Either (s :~: Circle&#39;) (s :~: Square&#39;) -&gt; Shape sh -&gt; Scene</code>, so providing the witness directly."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550305467, "post_id": 54720330, "comment_id": 96227043, "body": "@bradm, yeah, I probably agree. This whole problem seems like a bunch of hoop-jumping, honestly.  I would be looking for an alternative design..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550331761, "post_id": 54720330, "comment_id": 96233537, "body": "Why not <code>Either (Shape Circle&#39;) (Shape Square&#39;) -&gt; Int</code>?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550337039, "post_id": 54720330, "comment_id": 96235183, "body": "@DanielWagner, derp, yeah.  Hoop jumping indeed."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550381506, "post_id": 54720330, "comment_id": 96243962, "body": "@DanielWagner I can&#39;t believe I didn&#39;t see that. That would be <i>much</i> simpler."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 6, "last_activity_date": 1550296497, "creation_date": 1550296497, "answer_id": 54720330, "question_id": 54720058, "link": "https://stackoverflow.com/questions/54720058/datakind-unions/54720330#54720330", "title": "DataKind Unions", "body": "<p>This is getting kind of awful, but I guess you could require a proof that it's either a circle or a square using <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Type-Equality.html\" rel=\"noreferrer\"><code>Data.Type.Equality</code></a>:</p>\n\n<pre><code>test1 :: Either (s :~: Circle') (s :~: Square') -&gt; Shape s -&gt; Int\n</code></pre>\n\n<p>Now the user has to give an extra argument (a \"proof term\") saying which one it is.</p>\n\n<p>In fact you can use the proof term idea to \"complete\" bradm's solution, with:</p>\n\n<pre><code>class MyOpClass sh where\n    myOp :: Shape sh -&gt; Int\n    shapeConstraint :: Either (sh :~: Circle') (sh :~: Square')\n</code></pre>\n\n<p>Now nobody can go adding any more instances (unless they use <code>undefined</code>, which would be impolite).</p>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550337210, "post_id": 54721408, "comment_id": 96235236, "body": "Cool technique!  I didn&#39;t know you could do nonlinear matching in type families like this."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550337413, "post_id": 54721408, "comment_id": 96235306, "body": "Though, isn&#39;t <code>x ~ x</code> redundant because we&#39;re already in the nonlinear pattern for <code>x</code>?  Seems like <code>()</code> should work just as well."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550340074, "post_id": 54721408, "comment_id": 96236093, "body": "@luqui I would think so too, but if you use <code>()</code> instead of <code>x ~ x</code> for some reason it no longer prevents you from putting unreachable pattern matches in your function. Also, you must have an explicit type annotation inside your pattern match for that \u201cunreachable\u201d check to happen (with <code>x ~ x</code>). I\u2019m also not sure why that\u2019s the case (maybe a GHC bug?)."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550340511, "post_id": 54721408, "comment_id": 96236214, "body": "To clarify a bit: By &quot;explicit type annotation inside your pattern match,&quot; I mean something like: <code>test2 (Square s :: Shape Square&#39;) = ...</code>. And, like I said, I&#39;m not sure why that is needed here (and, to me, it almost seems like it could be the result of some sort of GHC bug)."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550340708, "post_id": 54721408, "comment_id": 96236280, "body": "that does sound like a GHC bug to me, at least on the surface (there might be deep subtlety here).  In the unreachable case, shouldn&#39;t the type family fail to normalize? Worth reporting I think, see what the gurus say."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550341572, "post_id": 54721408, "comment_id": 96236488, "body": "@luqui Based on my previous experience with type families I would think so, yeah. I  would think it would fail to normalize regardless of strange <code>x ~ x</code> things or explicit  type annotations in patterns. Maybe it is worth reporting just in case (and even if it isn&#39;t a bug, I can probably get a good explanation of why it works the way it does!)."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1550342440, "post_id": 54721408, "comment_id": 96236713, "body": "Oh, I just realized I had an older version of GHC (8.4.3). If I upgrade to the latest (8.6.3), then the <code>x ~ x</code> no longer matters (it can be replaced with <code>()</code>), but for some reason the explicit type annotations are still necessary."}, {"owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "edited": false, "score": 0, "creation_date": 1550346247, "post_id": 54721408, "comment_id": 96237846, "body": "Thank you! I will try this later and accept the answer if it works. Do you mind adding back the <code>x ~ x</code> as a note for those who are using older versions?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "edited": false, "score": 0, "creation_date": 1550349537, "post_id": 54721408, "comment_id": 96238581, "body": "@AllanW Looking at this again, it looks like I was mistaken about a couple of things: The explicit type annotation seems to give errors regardless of whether the pattern match is type-correct (not fully sure why, could be a limitation of GADT pattern matching). It looks like I was misinterpreting the type error messages. Also, it looks like there is not in fact a difference between GHC versions. I&#39;m not sure what made me think there was a difference with <code>x ~ x</code> now, because I can&#39;t seem to reproduce it. Sorry for the confusion!"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1550349880, "post_id": 54721408, "comment_id": 96238660, "body": "It will still work for preventing invalid calls, but it won&#39;t seem to prevent unreachable cases in a function definition. That might be possible, but I am not sure how (so far, at least)."}, {"owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "edited": false, "score": 0, "creation_date": 1550432051, "post_id": 54721408, "comment_id": 96256186, "body": "Can you take a look at my edit? Using your example, passing a square still compiles. I&#39;m not sure if this relates to your &#39;explicit type annotation&#39; comment above"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "edited": false, "score": 0, "creation_date": 1550460065, "post_id": 54721408, "comment_id": 96262371, "body": "@AllanW This is what I meant when I was saying it won&#39;t prevent unreachable cases to be defined. If you actually try to call that function with a <code>Shape Square&#39;</code>, it will not type check (but cases that should type check, do type check). For example, the call <code>test1 (Square undefined)</code> gives you a type error while <code>test1 (Circle undefined)</code> does not. There may be a way to also prevent the unreachable code in definitions by extending this technique, but I&#39;m not sure (so far)."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "edited": false, "score": 0, "creation_date": 1550461629, "post_id": 54721408, "comment_id": 96262673, "body": "@AllanW I edited in a partial solution to the unreachable case issue."}, {"owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "edited": false, "score": 0, "creation_date": 1550627100, "post_id": 54721408, "comment_id": 96334619, "body": "@David I&#39;ve accepted your answer, but I&#39;m curious how the first example with Constraint is meant to be used? I&#39;m not very familiar with anything related to DataKinds beyond the basic example."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "edited": false, "score": 0, "creation_date": 1550631728, "post_id": 54721408, "comment_id": 96335625, "body": "@AllanW You would use the first example by putting a constraint of this form in your type: <code>Union [...] t =&gt; {rest of your type goes here}</code> where <code>[...]</code> is a list of the types you want to restrict <code>t</code> to (where <code>t</code> is the name of the type variable you are restricting. Here, this is <code>s</code>). Does that make sense? Let me know if you want more clarification."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1550631804, "post_id": 54721408, "comment_id": 96335639, "body": "Note that this will might not work out too well for the kind <code>*</code> (the kind that consists of the &quot;usual&quot; types). It should really just work for any kind you have defined yourself (or defined by a library), such as your <code>Shape&#39;</code> kind here. I haven&#39;t tested <code>*</code> out though. It may still work if you are dealing with a GADT, but I am not sure. So if you are not using a GADT at all <i>and</i> you are trying to use it with kind <code>*</code>, you may run into issues (although, you probably shouldn&#39;t be doing that anyway, hah)."}, {"owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "edited": false, "score": 0, "creation_date": 1554614461, "post_id": 54721408, "comment_id": 97812685, "body": "@David it&#39;s been a while, but I&#39;m wondering if there is a good way to use <code>Union</code> to restrict against pattern matching. For instance, if I have a data structure where the <code>Shape</code> field must be a square or triangle, the compiler will still complain that matching against those two alone is not exhaustive"}, {"owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "edited": false, "score": 0, "creation_date": 1554616844, "post_id": 54721408, "comment_id": 97813056, "body": "For reference, I ended up making a new question for pattern matching restrictions: <a href=\"https://stackoverflow.com/questions/55556060/restrict-pattern-matching-to-subset-of-constructors\" title=\"restrict pattern matching to subset of constructors\">stackoverflow.com/questions/55556060/&hellip;</a>"}], "tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": true, "score": 6, "last_activity_date": 1550480007, "last_edit_date": 1550480007, "creation_date": 1550307041, "answer_id": 54721408, "question_id": 54720058, "link": "https://stackoverflow.com/questions/54720058/datakind-unions/54721408#54721408", "title": "DataKind Unions", "body": "<p>You can accomplish something like this in (I think) a reasonably clean way using a type family together with <code>ConstraintKinds</code> and <code>PolyKinds</code>:</p>\n\n<pre><code>type family Union (a :: [k]) (r :: k) :: Constraint where\n  Union (x ': xs) x = ()\n  Union (x ': xs) y = Union xs y\n\ntest1 :: Union [Circle', Triangle'] s =&gt; Shape s -&gt; Int\ntest1 = undefined\n</code></pre>\n\n<p>The <code>()</code> above is the empty constraint (it's like an empty \"list\" of type class constraints).</p>\n\n<p>The first \"equation\" of the type family makes use of the nonlinear pattern matching available in type families (it uses <code>x</code> twice on the left hand side). The type family also makes use of the fact that if none of the cases match, it will not give you a valid constraint.</p>\n\n<p>You should also be able to use a type-level Boolean instead of <code>ConstraintKinds</code>. That would be a bit more cumbersome and I think it would be best to avoid using a type-level Boolean here (if you can).</p>\n\n<p>Side-note (I can never remember this and I had to look it up for this answer): You get <code>Constraint</code> in-scope by importing it from <code>GHC.Exts</code>.</p>\n\n<h2>Edit: Partially disallowing unreachable definitions</h2>\n\n<p>Here is a modification to get it to (partially) disallow unreachable definitions as well as invalid calls. It is slightly more roundabout, but it seems to work.</p>\n\n<p>Modify <code>Union</code> to give a <code>*</code> instead of a constraint, like this:</p>\n\n<pre><code>type family Union (a :: [k]) (r :: k) :: * where\n  Union (x ': xs) x = ()\n  Union (x ': xs) y = Union xs y\n</code></pre>\n\n<p>It doesn't matter too much what the type is, as long as it has an inhabitant you can pattern match on, so I give back the <code>()</code> type (the unit type).</p>\n\n<p>This is how you would use it:</p>\n\n<pre><code>test1 :: Shape s -&gt; Union [Circle', Triangle'] s -&gt; Int\ntest1 Circle {}   () = undefined\ntest1 Triangle {} () = undefined\n-- test1 Square {} () = undefined -- This line won't compile\n</code></pre>\n\n<p>If you forget to match on it (like, if you put a variable name like <code>x</code> instead of matching on the <code>()</code> constructor), it is possible that an unreachable case can be defined. It will still give a type error at the call-site when you actually try to reach that case, though (so, even if you don't match on the <code>Union</code> argument, the call <code>test1 (Square undefined) ()</code> will not type check).</p>\n\n<p>Note that it seems the <code>Union</code> argument must come after the <code>Shape</code> argument in order for this to work (fully as described, anyway).</p>\n"}, {"tags": [], "owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1550434064, "creation_date": 1550434064, "answer_id": 54737196, "question_id": 54720058, "link": "https://stackoverflow.com/questions/54720058/datakind-unions/54737196#54737196", "title": "DataKind Unions", "body": "<p>Another solution I've noticed, though pretty verbose, is to create a kind that has a list of feature booleans. You can then pattern match on the features when restricting the type:</p>\n\n<pre><code>-- [circleOrSquare] [triangleOrSquare]\ndata Shape' =\n  Shape'' Bool\n          Bool\n\ndata Shape :: Shape' -&gt; * where\n  Circle :: { radius :: Int} -&gt; Shape (Shape'' True False)\n  Square :: { side :: Int} -&gt; Shape (Shape'' True True)\n  Triangle\n    :: { a :: Int\n       , b :: Int\n       , c :: Int}\n    -&gt; Shape (Shape'' False True)\n\ntest1 :: Shape (Shape'' True x) -&gt; Int\ntest1 Circle {}   = 2\ntest1 Square {}   = 2\ntest1 Triangle {} = 2\n</code></pre>\n\n<p>Here, Triangle will fail to match:</p>\n\n<pre><code>    \u2022 Couldn't match type \u2018'True\u2019 with \u2018'False\u2019\n      Inaccessible code in\n        a pattern with constructor:\n          Triangle :: Int -&gt; Int -&gt; Int -&gt; Shape ('Shape'' 'False 'True),\n        in an equation for \u2018test1\u2019\n    \u2022 In the pattern: Triangle {}\n      In an equation for \u2018test1\u2019: test1 Triangle {} = 2\n   |\n52 | test1 Triangle {} = 2\n   |       ^^^^^^^^^^^\n</code></pre>\n\n<p>Unfortunately, I don't think you can write this as a record, which may be clearer and avoids the ordering of the features.</p>\n\n<p>This might be usable in conjunction with the class examples for readability.</p>\n"}], "owner": {"reputation": 2273, "user_id": 4407321, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KHKUZ.png?s=128&g=1", "display_name": "Allan W", "link": "https://stackoverflow.com/users/4407321/allan-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 2, "accepted_answer_id": 54721408, "answer_count": 4, "score": 8, "last_activity_date": 1550480007, "creation_date": 1550293427, "last_edit_date": 1550431974, "question_id": 54720058, "link": "https://stackoverflow.com/questions/54720058/datakind-unions", "title": "DataKind Unions", "body": "<p>I'm not sure if it is the right terminology, but is it possible to declare function types that take in an 'union' of datakinds?</p>\n\n<p>For example, I know I can do the following:</p>\n\n<pre><code>{-# LANGUAGE DataKinds      #-}\n{-# LANGUAGE GADTs          #-}\n\n...\n\ndata Shape'\n  = Circle'\n  | Square'\n  | Triangle'\n\ndata Shape :: Shape' -&gt; * where\n  Circle :: { radius :: Int} -&gt; Shape Circle'\n  Square :: { side :: Int} -&gt; Shape Square'\n  Triangle\n    :: { a :: Int\n       , b :: Int\n       , c :: Int}\n    -&gt; Shape Triangle'\n\ntest1 :: Shape Circle' -&gt; Int\ntest1 = undefined\n</code></pre>\n\n<p>However, what if I want to take in a shape that is either a circle or a square? What if I also want to take in all shapes for a separate function?</p>\n\n<p>Is there a way for me to either define a set of <code>Shape'</code> kinds to use, or a way for me to allow multiple datakind definitions per data?</p>\n\n<p>Edit:</p>\n\n<p>The usage of unions doesn't seem to work:</p>\n\n<pre><code>{-# LANGUAGE ConstraintKinds #-}\n{-# LANGUAGE DataKinds       #-}\n{-# LANGUAGE GADTs           #-}\n{-# LANGUAGE KindSignatures  #-}\n{-# LANGUAGE PolyKinds       #-}\n{-# LANGUAGE TypeFamilies    #-}\n{-# LANGUAGE TypeOperators   #-}\n\n...\n\ntype family Union (a :: [k]) (r :: k) :: Constraint where\n  Union (x ': xs) x = ()\n  Union (x ': xs) y = Union xs y\n\ndata Shape'\n  = Circle'\n  | Square'\n  | Triangle'\n\ndata Shape :: Shape' -&gt; * where\n  Circle :: { radius :: Int} -&gt; Shape Circle'\n  Square :: { side :: Int} -&gt; Shape Square'\n  Triangle\n    :: { a :: Int\n       , b :: Int\n       , c :: Int}\n    -&gt; Shape Triangle'\n\ntest1 :: Union [Circle', Triangle'] s =&gt; Shape s -&gt; Int\ntest1 Circle {} = undefined\ntest1 Triangle {} = undefined\ntest1 Square {} = undefined\n</code></pre>\n\n<p>The part above compiles</p>\n"}, {"tags": ["dictionary", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1550273222, "post_id": 54718309, "comment_id": 96222353, "body": "Well, the input type wouldn&#39;t change. Would the output type change if it returned your desired output instead?"}, {"owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1550273292, "post_id": 54718309, "comment_id": 96222375, "body": "I dont see a concept of &quot;empty tuple&quot; in haskell"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 1, "creation_date": 1550273362, "post_id": 54718309, "comment_id": 96222387, "body": "You can&#39;t add or remove elements with <code>map</code>, only transform them. Have you tried <code>filter</code>?"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1550273949, "post_id": 54718309, "comment_id": 96222489, "body": "&quot;I dont see a concept of &quot;empty tuple&quot; in haskell&quot; You don&#39;t need an &quot;empty tuple&quot;. You have <code>[(3,4),(4,4),(0,0)]</code> (a list containing three tuples), and you want <code>[(3,4),(4,4)]</code> (a list containing two tuples). Both of these are type <code>[(Int, Int)]</code> (a list of tuples)."}], "answers": [{"tags": [], "owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": true, "score": 8, "last_activity_date": 1550273699, "last_edit_date": 1592644375, "creation_date": 1550273391, "answer_id": 54718358, "question_id": 54718309, "link": "https://stackoverflow.com/questions/54718309/haskell-map-but-remove-items-that-dont-follow-condition/54718358#54718358", "title": "Haskell map but remove items that don&#39;t follow condition", "body": "<p>What you're asking for is <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Maybe.html#v:mapMaybe\" rel=\"noreferrer\">mapMaybe</a>:</p>\n<blockquote>\n<pre><code>mapMaybe :: (a -&gt; Maybe b) -&gt; [a] -&gt; [b]\n</code></pre>\n<p>base Data.Maybe</p>\n<p>The <code>mapMaybe</code> function is a version of <code>map</code> which can throw out elements. In particular, the functional argument returns something of type <code>Maybe b</code>. If this is <code>Nothing</code>, no element is added on to the result list. If it is <code>Just b</code>, then b is included in the result list.</p>\n</blockquote>\n<p>The smallest change to use it in your code would be:</p>\n<pre><code>import Data.Maybe\n\nfn :: [(Int, Int)] -&gt; [(Int, Int)]\nfn tuples = mapMaybe (\\(x,y) -&gt; if (x + y) &gt; 5 then Just (x,y) else Nothing) tuples\n</code></pre>\n<p>However, in this specific case, you don't actually transform, you just remove. If you don't plan on adding transformation later, <code>filter</code> is more suitable:</p>\n<pre><code>fn = filter (\\(x,y) -&gt; x+y &gt; 5)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1550274181, "creation_date": 1550274181, "answer_id": 54718439, "question_id": 54718309, "link": "https://stackoverflow.com/questions/54718309/haskell-map-but-remove-items-that-dont-follow-condition/54718439#54718439", "title": "Haskell map but remove items that don&#39;t follow condition", "body": "<p>Bit of a weird question, but after the comment</p>\n\n<blockquote>\n  <p>I dont see a concept of \u201cempty tuple\u201d in haskell</p>\n</blockquote>\n\n<p>I guess I see where you're coming from. Actually Haskell does have \u201cempty tuples\u201d: the unit type <code>()</code> is the type of \u201ctuples with zero elements\u201d. So what you're thinking of seems to be</p>\n\n<pre><code>fn tuples = map (\\(x,y) -&gt; if x + y &gt; 5 then (x,y) else ()) tuples\n</code></pre>\n\n<p>But that doesn't work because <code>()</code> is <em>a different type</em> from <code>(Int,Int)</code>. The elements of a list must all have the same type. Even if it did work, \u00e0 la dynamic-types, the result of <code>fn [(3,4), (4,4), (0,1)]</code> would then actually be <code>[(3,4), (4,4), ()]</code>. I.e. you'd still get three elements, just one of them would be \u201cboring\u201d.</p>\n\n<p><code>map</code> does in fact by design guarantee to never change the number of elements in the list, only the values of their elements. So if that's what you <em>want</em>, you need to use a different function. The closest to your approach would be <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:concatMap\" rel=\"nofollow noreferrer\"><code>concatMap</code></a>:</p>\n\n<pre><code>fn tuples = concatMap (\\(x,y) -&gt; if x + y &gt; 5 then [(x,y)] else []) tuples\n</code></pre>\n\n<p>What happens here can also be described in two steps:</p>\n\n<ul>\n<li>You map a function that generates a list for each element. The result is thus a list of lists.</li>\n<li>You flatten that list.</li>\n</ul>\n\n<p>So <code>[(3,4), (4,4), (0,1)]</code> -> <code>[[(3,4)], [(4,4)], []]</code> -> <code>[(3,4), (4,4)]</code>.</p>\n\n<p>Really though, there's no need to use a mapping step at all here \u2013 the elements are kept as they are eventually, so <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:filter\" rel=\"nofollow noreferrer\"><code>filter</code></a> is the tool to use.</p>\n"}], "owner": {"reputation": 2181, "user_id": 7058735, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GxhO2.png?s=128&g=1", "display_name": "K Split X", "link": "https://stackoverflow.com/users/7058735/k-split-x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "accepted_answer_id": 54718358, "answer_count": 2, "score": 0, "last_activity_date": 1550274181, "creation_date": 1550273023, "question_id": 54718309, "link": "https://stackoverflow.com/questions/54718309/haskell-map-but-remove-items-that-dont-follow-condition", "title": "Haskell map but remove items that don&#39;t follow condition", "body": "<p>The function should take a list of tuples, and return the ones that have sum > 5</p>\n\n<p>Let's say I have the following code:</p>\n\n<pre><code>fn :: [(Int, Int)] -&gt; [(Int, Int)]\n\nfn tuples = map (\\(x,y) -&gt; if (x + y) &gt; 5 then (x,y) else (0,0)) tuples\n</code></pre>\n\n<p><code>fn [(3,4), (4,4), (0,1)]</code> returns <code>[(3,4),(4,4),(0,0)]</code> but really I just want it to return <code>[(3,4),(4,4)]</code></p>\n\n<p>Is this possible in haskell while still following the type signature?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 5, "creation_date": 1550272656, "post_id": 54718106, "comment_id": 96222251, "body": "Take a look at <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:filter\" rel=\"nofollow noreferrer\"><code>filter</code></a>"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 4, "creation_date": 1550280514, "post_id": 54718106, "comment_id": 96223633, "body": "What is the error message? Did you read and try to understand it? What specifically is confusing you about it? Something that will be useful to you is to open ghcid and learn to load a file and ask the types of things with <code>:t</code>, e.g. what is the type of <code>drop</code>? What are the types of the arguments you&#39;re trying to pass it above? Also please be careful how you enter code in SO questions. It&#39;s not clear whether you&#39;ve just done a sloppy paste job or whether your actual code has screwed up indentation"}, {"owner": {"reputation": 9485, "user_id": 20371, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32c7a412ad0caf812ae974df5eb8ffcd?s=128&d=identicon&r=PG", "display_name": "Yawar", "link": "https://stackoverflow.com/users/20371/yawar"}, "edited": false, "score": 1, "creation_date": 1550291894, "post_id": 54718106, "comment_id": 96225052, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/22073890/remove-an-item-from-a-list-in-haskell\">Remove an item from a list in Haskell</a>"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1550308756, "post_id": 54718106, "comment_id": 96227738, "body": "You might be better off looking at <code>Data.Map</code> and its <code>Map</code> data structure. As well as being more efficient than a list of pairs, it has many convenience functions - including <code>delete</code> which does exactly what you&#39;re looking for. <a href=\"http://hackage.haskell.org/package/containers-0.6.0.1/docs/Data-Map-Strict.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/containers-0.6.0.1/docs/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2158, "user_id": 9991455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ff5d55afd5d829849efbf27962dd320?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo", "link": "https://stackoverflow.com/users/9991455/lorenzo"}, "is_accepted": false, "score": 0, "last_activity_date": 1551305024, "last_edit_date": 1592644375, "creation_date": 1550710967, "answer_id": 54797662, "question_id": 54718106, "link": "https://stackoverflow.com/questions/54718106/how-would-i-go-about-deleting-something-from-a-list-in-haskell/54797662#54797662", "title": "how would I go about deleting something from a list in Haskell", "body": "<h1>Problem</h1>\n<p>First of all, if you're trying to delete one specific element from a list in Haskell you're usually doing something wrong. There are better types to do this, from<code>Data.Map</code> in this case to <code>Data.Ord</code> in many others.</p>\n<p>However, if you want to do it your way, <code>drop</code> is not the function for it. If you look at its type, <code>drop :: Int -&gt; [a] -&gt; [a]</code> you'll realise it only drops the first n elements.</p>\n<h1>Solution</h1>\n<p>You can however use a higher order function, <code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</code> which does what it says on the tin. Just need to give it a function to filter what you need. You can use a lambda function with an easy pattern matching:</p>\n<pre><code>deletePerson :: Name -&gt; [PhoneBook] -&gt; [PhoneBook]\ndeletePerson na = filter (\\(n, p) -&gt; name /= n)\n</code></pre>\n<p>Also note that <code>delete</code> is a function in <code>Data.List</code> that deletes the first occurrence of something in a list</p>\n"}], "owner": {"reputation": 59, "user_id": 9659054, "user_type": "registered", "profile_image": "https://graph.facebook.com/490170168068038/picture?type=large", "display_name": "Mojibar Homan", "link": "https://stackoverflow.com/users/9659054/mojibar-homan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551305024, "creation_date": 1550271488, "last_edit_date": 1550351534, "question_id": 54718106, "link": "https://stackoverflow.com/questions/54718106/how-would-i-go-about-deleting-something-from-a-list-in-haskell", "title": "how would I go about deleting something from a list in Haskell", "body": "<p>I want to make a function that given the name of a person deletes all entries in the phone book with that name.         </p>\n\n<pre><code> type Name = String\n type PhoneNumber = Int\n type Person  = (Name, PhoneNumber)\ntype PhoneBook = [Person]\ndelete::Name -&gt; PhoneBook -&gt; PhoneBook \n</code></pre>\n\n<p>how would go about this\nwould I use drop \nI've been using this but I've been getting error</p>\n\n<pre><code>  delete  :: Name -&gt; PhoneBook -&gt; PhoneBook\n delete name = (drop name xs) \n</code></pre>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 325, "user_id": 10759740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa69b17ab54deb4330b263ea093c485?s=128&d=identicon&r=PG&f=1", "display_name": "R Y", "link": "https://stackoverflow.com/users/10759740/r-y"}, "edited": false, "score": 0, "creation_date": 1550247458, "post_id": 54713076, "comment_id": 96212127, "body": "What do you want to do with the Right value? In this case, it looks like you have to converge the types into a single one, something like: <code>f :: Either Error CertificationRequest -&gt; IO ()</code> or the like."}, {"owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "reply_to_user": {"reputation": 325, "user_id": 10759740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa69b17ab54deb4330b263ea093c485?s=128&d=identicon&r=PG&f=1", "display_name": "R Y", "link": "https://stackoverflow.com/users/10759740/r-y"}, "edited": false, "score": 1, "creation_date": 1550248708, "post_id": 54713076, "comment_id": 96212764, "body": "So The function I am writing should Either Return a Certificate Request or an Error ,"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1550248919, "post_id": 54713076, "comment_id": 96212861, "body": "The second snippet is a part of a <code>do</code> block, which implicitly involves <code>&gt;&gt;=</code> for the monad at hand. The <code>case</code> instead does not use <code>&gt;&gt;=</code> or monads. In general, these constructs are very different."}], "answers": [{"tags": [], "owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "is_accepted": true, "score": 5, "last_activity_date": 1550248498, "creation_date": 1550248498, "answer_id": 54713497, "question_id": 54713076, "link": "https://stackoverflow.com/questions/54713076/how-to-deal-with-functions-returning-a-either-monad/54713497#54713497", "title": "How to deal with functions returning a either monad", "body": "<p>Not sure how you can pass a single <code>parameters</code> to <code>generateCSR</code> since it wants 4 arguments, but I'll chalk it up to pseudocode.</p>\n\n<p><code>generateCSR</code> returns an <code>Either</code> wrapped in some monand <code>m</code>, which must be an instance of <code>MonadRandom</code>, of which <code>IO</code> is a candidate.  You cannot directly use a case on the result; you must use the monad's bind to access the <code>Either</code> within.  In your second example, you used bind with a pattern that requires the <code>Either</code> to be <code>Right</code>, which will not gracefully handle the case that it is <code>Left</code>.  Instead, you can bind the result to a variable and then use a case statement to decide what to do:</p>\n\n<pre><code>f = do\n    r &lt;- generateCSR parameters\n    case r of\n        Left err -&gt; ...\n        Right req -&gt; ...\n</code></pre>\n\n<p>Note that both cases will also have to return something wrapped in the same monad, as required by <code>do</code> (bind).</p>\n"}], "owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 54713497, "answer_count": 1, "score": 0, "last_activity_date": 1550249549, "creation_date": 1550246984, "last_edit_date": 1550249549, "question_id": 54713076, "link": "https://stackoverflow.com/questions/54713076/how-to-deal-with-functions-returning-a-either-monad", "title": "How to deal with functions returning a either monad", "body": "<p>I am trying to incorporate error handling in my code.</p>\n\n<p>I am calling a function </p>\n\n<pre><code>generateCSR :: (MonadRandom m, HashAlgorithmConversion hashAlg, HashAlgorithm hashAlg) \n            =&gt; X520Attributes -&gt; PKCS9Attributes -&gt; KeyPair -&gt; hashAlg \n            -&gt; m (Either Error CertificationRequest) \n</code></pre>\n\n<p>So I need to handle the error in this case. I assumed I could do something like this </p>\n\n<pre><code>case generateCSR (parameters) of\n Right req -&gt; req\n left Error -&gt; putStrLn (\"Error : \" ++ show Error)\n</code></pre>\n\n<p>But this doesn't seem to work.</p>\n\n<p>But if I do something like this </p>\n\n<pre><code> Right req &lt;- generateCSR (parameters)\n putStrLn.show req \n</code></pre>\n\n<p>it gives me an output.</p>\n\n<p>How can I implement the error handling here? Am I doing something completely wrong in the first case (the <code>case of</code> statement) ?</p>\n"}, {"tags": ["haskell", "monads", "lift", "monoids"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1550241474, "post_id": 54711323, "comment_id": 96208523, "body": "<i>List types</i> are monoids; <code>Maybe a</code> is not. You still need to lift <code>(++)</code> to apply it to <code>Maybe</code> lists."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1550244044, "post_id": 54711323, "comment_id": 96210160, "body": "Note that you don&#39;t even need <code>m</code> to be a monad; an applicative would suffice. <code>f :: Applicative g =&gt; g (a -&gt; b -&gt; c) -&gt; g a -&gt; g b -&gt; g c</code> with <code>f gf ga gb = gf &lt;*&gt; ga &lt;*&gt; gb</code>."}], "answers": [{"comments": [{"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1550242569, "post_id": 54711535, "comment_id": 96209234, "body": "But could it not work with different types of functors? like <code>f (Just (++)) (Just [3]) (Left [4])</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1550243196, "post_id": 54711535, "comment_id": 96209621, "body": "No; I think that was a typo in the question. The given type requires the same monad throughout."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1550264269, "post_id": 54711535, "comment_id": 96219671, "body": "Oh, sorry, it&#39;s your question, so it&#39;s not a typo. If you want to operate on values from two different monads, you need something like <code>(Monad m1, Monad m2) =&gt; (a -&gt; b -&gt; c) -&gt; m1 a -&gt; m2 b -&gt; ???</code>. You&#39;ll have to decide which monad the result will live in. However, I don&#39;t recommend this. Let the caller be responsible for converting <code>Just [3]</code> to an <code>Either a b</code> value or <code>Left [4]</code> to a <code>Maybe a</code> value, and keep your function tied to a single monad. (For that matter, I would consider using <code>liftA2 (++) (Just [3]) (Just [4])</code> instead of manually lifting <code>(++)</code> before calling <code>f</code>.)"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 4, "last_activity_date": 1550264418, "last_edit_date": 1550264418, "creation_date": 1550241385, "answer_id": 54711535, "question_id": 54711323, "link": "https://stackoverflow.com/questions/54711323/can-not-lift-multiple-parameters-in-a-monad/54711535#54711535", "title": "Can not lift multiple parameters in a monad", "body": "<p><code>f</code> requires a monad-wrapped function as the <em>first</em> argument. In your first try, you didn't pass the function at all; in the second, you pass <code>(++)</code> as the <em>last</em> argument.</p>\n\n<p>The following works fine:</p>\n\n<pre><code>&gt; f (Just (++)) (Just [3]) (Just [4])\nJust [3,4]\n</code></pre>\n\n<p><code>liftM2</code> (and more generally <code>liftA2</code>) already does something very similar to what you want.</p>\n\n<pre><code>&gt; import Control.Monad (liftM2)\n&gt; liftM2 (++) (Just [3]) (Just [4])\nJust [3,4]\n&gt; import Control.Applicative (liftA2)\n&gt; liftA2 (++) (Just [3]) (Just [4])\nJust [3,4]\n</code></pre>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 54711535, "answer_count": 1, "score": 1, "last_activity_date": 1550264418, "creation_date": 1550240605, "question_id": 54711323, "link": "https://stackoverflow.com/questions/54711323/can-not-lift-multiple-parameters-in-a-monad", "title": "Can not lift multiple parameters in a monad", "body": "<p>Hello i am trying to do the following:</p>\n\n<pre><code>module MyMonad where\nf::(Monad m),=&gt;m (a-&gt;b-&gt;c)-&gt;m a -&gt; m b -&gt; m c\nf mf ma mb=\n    ma &gt;&gt;= \\a -&gt;\n    mb &gt;&gt;= \\b -&gt;\n    mf &gt;&gt;= \\c -&gt;\n        return (c a b) \n</code></pre>\n\n<p>and use it like this :</p>\n\n<pre><code>f (Just 3) (Just 4) \n</code></pre>\n\n<p>And i get the following error:</p>\n\n<pre><code>* Non type-variable argument in the constraint: Num (a -&gt; b -&gt; c)\n      (Use FlexibleContexts to permit this)\n    * When checking the inferred type\n        it :: forall a b c.\n              (Num a, Num (a -&gt; b -&gt; c)) =&gt;\n              Maybe b -&gt; Maybe c\n</code></pre>\n\n<p>I didn't know how to put multiple type constraints so i tried like this:<br><br>\n<code>f (Just [3]) (Just [4]) (++)</code> -- (knowing <code>(++)</code> can be applied to any type - being a <code>monoid</code>).\n<br> <Br>In this case i get the following exception:</p>\n\n<pre><code>* Couldn't match expected type `Maybe b0'\n                  with actual type `[a1] -&gt; [a1] -&gt; [a1]'\n    * Probable cause: `(++)' is applied to too few arguments\n      In the third argument of `f', namely `(++)'\n      In the expression: f (Just [3]) (Left [3]) (++)\n      In an equation for `it': it = f (Just [3]) (Left [3]) (++)\n</code></pre>\n"}, {"tags": ["function", "haskell", "parametric-polymorphism"], "comments": [{"owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "edited": false, "score": 1, "creation_date": 1550210309, "post_id": 54703199, "comment_id": 96192924, "body": "You could use <code>foldMap f</code> instead of <code>intercalate &quot;&quot; . map f</code>. Note that <code>intercalate &quot;&quot;</code> is equivalent to Data.Text.concat."}, {"owner": {"reputation": 3960, "user_id": 1556475, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dbf54fca536242c214a1f99a6b9b8931?s=128&d=identicon&r=PG", "display_name": "Cameron Ball", "link": "https://stackoverflow.com/users/1556475/cameron-ball"}, "reply_to_user": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "edited": false, "score": 0, "creation_date": 1550211758, "post_id": 54703199, "comment_id": 96193305, "body": "Ah, that is nice. Now I have <code>wrap x = foldMap $ (&lt;&gt; x) . (x &lt;&gt;)</code>"}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 1, "creation_date": 1550264589, "post_id": 54703199, "comment_id": 96219795, "body": "With no imports. <code>wr x str = [ x++s++x | s &lt;- str]</code> and <code>concat.wr &quot;!&quot; $ [&quot;one&quot;,&quot;two&quot;,&quot;fix&quot;]</code>"}, {"owner": {"reputation": 3960, "user_id": 1556475, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dbf54fca536242c214a1f99a6b9b8931?s=128&d=identicon&r=PG", "display_name": "Cameron Ball", "link": "https://stackoverflow.com/users/1556475/cameron-ball"}, "edited": false, "score": 0, "creation_date": 1550313486, "post_id": 54703199, "comment_id": 96228788, "body": "I always forget I can use list comprehension on strings, very cool."}], "answers": [{"tags": [], "owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "is_accepted": true, "score": 6, "last_activity_date": 1550211931, "creation_date": 1550211931, "answer_id": 54703703, "question_id": 54703199, "link": "https://stackoverflow.com/questions/54703199/how-can-i-make-this-function-more-elegant/54703703#54703703", "title": "How can I make this function more elegant", "body": "<p>(Copied from my comment so the question can be marked as answered.)</p>\n\n<p>You could use <code>foldMap f</code> instead of <code>intercalate \"\" . map f</code>. Note that <code>intercalate \"\"</code> is equivalent to Data.Text.concat.</p>\n"}, {"comments": [{"owner": {"reputation": 3960, "user_id": 1556475, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dbf54fca536242c214a1f99a6b9b8931?s=128&d=identicon&r=PG", "display_name": "Cameron Ball", "link": "https://stackoverflow.com/users/1556475/cameron-ball"}, "edited": false, "score": 0, "creation_date": 1550254451, "post_id": 54709770, "comment_id": 96215529, "body": "I did have something like this originally, but I found it not so pleasing. Thanks though."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1550262573, "post_id": 54709770, "comment_id": 96218989, "body": "I like your idea, but I&#39;m concerned that the final <code>&lt;&gt;</code> could be a bit of an efficiency problem because <code>intercalate</code> isn&#39;t a &quot;good producer&quot; for list fusion. I think the easiest way to work around that is likely to use <code>foldr</code> directly."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1550265320, "post_id": 54709770, "comment_id": 96220035, "body": "@dfeuer There are no lists being produced here anyway, only <code>Text</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1550269764, "post_id": 54709770, "comment_id": 96221503, "body": "@DanielWagner, ah, silly me. So does that mean some sort of builder is required?"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1550237664, "last_edit_date": 1550237664, "creation_date": 1550235081, "answer_id": 54709770, "question_id": 54703199, "link": "https://stackoverflow.com/questions/54703199/how-can-i-make-this-function-more-elegant/54709770#54709770", "title": "How can I make this function more elegant", "body": "<p>Just to put my hat in the ring... Since the pattern is</p>\n\n<pre><code>xexxexxex\n</code></pre>\n\n<p>(where the <code>e</code>s are placeholders for elements of the original list), another way you can build this output is by putting two <code>x</code>s between each element, and wrapping the bookends manually. So:</p>\n\n<pre><code>wrap x es = x &lt;&gt; intercalate (x &lt;&gt; x) es &lt;&gt; x\n</code></pre>\n\n<p>One small but nice feature of this rewrite is that for input lists of length n, this will incur only n+2 calls to <code>(&lt;&gt;)</code> rather than 3n-1 as in theindigamer's answer.</p>\n"}], "owner": {"reputation": 3960, "user_id": 1556475, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dbf54fca536242c214a1f99a6b9b8931?s=128&d=identicon&r=PG", "display_name": "Cameron Ball", "link": "https://stackoverflow.com/users/1556475/cameron-ball"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 54703703, "answer_count": 2, "score": 0, "last_activity_date": 1550237664, "creation_date": 1550208751, "question_id": 54703199, "link": "https://stackoverflow.com/questions/54703199/how-can-i-make-this-function-more-elegant", "title": "How can I make this function more elegant", "body": "<p>I have the function:</p>\n\n<pre><code>wrap :: Text -&gt; [Text] -&gt; Text\nwrap x = intercalate \"\" . map ((&lt;&gt; x) . (x &lt;&gt;))\n</code></pre>\n\n<p>The purpose of which is to wrap each element of a list with a given string and join them all together.</p>\n\n<p>The brackets around the first argument to map annoy me, and so does the use of \"\". So I wonder is there a more elegant (or generic, I guess) way to express this function?</p>\n"}, {"tags": ["haskell", "ghc", "transpiler"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550244537, "post_id": 54701439, "comment_id": 96210443, "body": "Counter-interpretation: the question you linked to <i>was</i> answered (namely: can&#39;t be done with existing tools, so you gotta build it yourself), you just don&#39;t like the answer."}, {"owner": {"reputation": 1115, "user_id": 890016, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/BO6bH.png?s=128&g=1", "display_name": "Mario Carneiro", "link": "https://stackoverflow.com/users/890016/mario-carneiro"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550354477, "post_id": 54701439, "comment_id": 96239775, "body": "@DanielWagner I&#39;m actually okay with the &quot;build it yourself&quot; answer, but no one is answering the question &quot;<i>How</i> can I build it myself?&quot; As in, what needs to be done, is it a GHC plugin or extension, something using the API, or what?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550366126, "post_id": 54701439, "comment_id": 96242022, "body": "The question @AlexisKing suggested has good pointers on that. My executive summary is &quot;compile to Haskell itself and toss unsafeCoerce in everywhere&quot; or &quot;use the GHC API to build up a Core term directly without serializing to disk first&quot;."}], "owner": {"reputation": 1115, "user_id": 890016, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/BO6bH.png?s=128&g=1", "display_name": "Mario Carneiro", "link": "https://stackoverflow.com/users/890016/mario-carneiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "closed_date": 1550244545, "answer_count": 0, "score": 0, "last_activity_date": 1550193566, "creation_date": 1550193566, "question_id": 54701439, "link": "https://stackoverflow.com/questions/54701439/using-ghc-to-compile-core", "closed_reason": "Duplicate", "title": "Using GHC to compile Core", "body": "<p>I want to write a compiler from another language to produce terms in Haskell Core, and call GHC on the result. Are there any methods to do this? The compiler is not written in Haskell, so it would have to communicate via a serialization format or FFI. I have read about <code>.hcr</code> files for getting core from GHC, but I don't know how to read it back in to finish compilation. Alternatively, I could try to write a plain Haskell file, but this would require a lot of explicit type applications and quoted identifiers, and it seems error prone.</p>\n\n<p>Related: <a href=\"https://stackoverflow.com/q/28059669/890016\">Using GHC API to compile Haskell sources to CORE and CORE to binary</a> discusses the <code>.hcr</code> format and a GHC API that might help, but AFAICT the OP's question wasn't actually answered. Would a GHC plugin help here?</p>\n"}, {"tags": ["haskell", "types"], "answers": [{"tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": true, "score": 2, "last_activity_date": 1550198211, "creation_date": 1550198211, "answer_id": 54701931, "question_id": 54700916, "link": "https://stackoverflow.com/questions/54700916/what-is-the-purpose-of-the-item-type-in-foundation/54701931#54701931", "title": "What is the Purpose of the Item type in Foundation", "body": "<p>You're right that <code>Item</code> just adds complexity when using <code>[Char]</code>. However, the idea behind <code>Item</code> is that it can be used for other types as well. For instance, <code>Item (Array ty)</code> is <code>ty</code>, <code>Item CSV</code> is <code>Row</code>, <code>Item Bitmap</code> is <code>Bool</code> etc. This makes our functions more polymorphic so they may be used more generally: for instance, take <code>fromList :: [Item l] -&gt; l</code>, which may be used in any of the following situations depending on what <code>l</code> is:</p>\n\n<pre><code>fromList :: [a]    -&gt; [a]\nfromList :: [ty]   -&gt; Array ty\nfromList :: [Row]  -&gt; CSV\nfromList :: [Bool] -&gt; Bitmap\n</code></pre>\n\n<p>Which is easier to use than having a bunch of functions <code>fromListArray</code>, <code>fromRowsCSV</code> etc.</p>\n"}, {"tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": false, "score": 2, "last_activity_date": 1550206936, "creation_date": 1550206936, "answer_id": 54702932, "question_id": 54700916, "link": "https://stackoverflow.com/questions/54700916/what-is-the-purpose-of-the-item-type-in-foundation/54702932#54702932", "title": "What is the Purpose of the Item type in Foundation", "body": "<p><code>Item</code> isn't a normal type, but a \"type synonym family\" (poorly named), which is a sort of type-level function. <code>type instance Item [a] = a</code>as you saw means you can replace occurrences (in type signatures) of \"<code>Item [a]</code>\", with \"<code>a</code>\", much like the function declaration <code>snd (_,y) = y</code> means you can replace \"<code>snd (1,2)</code>\" with \"<code>2</code>\".</p>\n\n<p>The point of <code>Item a</code> is it lets you write code that is <em>generic with respect to the argument <code>a</code></em>. Or rather it lets you express the type of such a function.</p>\n\n<p>Usually for a type synonym family like this to be useful it needs to be paired with a type class: the latter lets you define different <em>behavior</em> over different types, the former allows, say, an output type to depend on the type of the input. Multiparameter type-classes + functional dependencies accomplish the same goal.</p>\n\n<p>Sometimes type families are (again, confusingly) called \"associated types\" when they are defined as part of a type class (due to the relationship described in paragraph above), but this is a shallow syntactic thing.</p>\n\n<p>Traditionally type families were \"open\" (like typeclasses), but there are now closed type families which can be helpful for recursion.</p>\n"}], "owner": {"reputation": 371, "user_id": 5589037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8e0afcaf170b7c13a53093cf2f5f84c?s=128&d=identicon&r=PG&f=1", "display_name": "John Walker", "link": "https://stackoverflow.com/users/5589037/john-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 54701931, "answer_count": 2, "score": 2, "last_activity_date": 1550206936, "creation_date": 1550188859, "question_id": 54700916, "link": "https://stackoverflow.com/questions/54700916/what-is-the-purpose-of-the-item-type-in-foundation", "title": "What is the Purpose of the Item type in Foundation", "body": "<p>Both the following compile fine with Foundation (and Prelude as qualified import P) and return the expected string.</p>\n\n<pre><code>-- the inferred type\nblahhh :: Item [Char]\nblahhh = P.head $ toList (\"blahh de blahh de blahh\" :: [Item [Char]])\n\nblahh2 :: [Char]\nblahh2 = blahhh : \": Should be a b\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>blahhh :: Char\nblahhh = P.head $ toList (\"blahh de blahh de blahh\" :: [Char])\n\nblahh2 :: [Char]\nblahh2 = blahhh : \": Should be a b\"\n</code></pre>\n\n<p>I found this a bit confusing at first. I initially thought there was some <code>Item</code> data type I needed to pattern match against within the list.</p>\n\n<p>I then realised that <code>Item</code> extracts the item type from the the list (as documented), so <code>Item [Char] == Char</code>. </p>\n\n<p>My question is what is the purpose of this (<code>Item</code>) and similar such types? What does the extra complexity buy you?</p>\n"}, {"tags": ["haskell", "typeclass", "forall"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 4, "creation_date": 1550183729, "post_id": 54700136, "comment_id": 96187126, "body": "I don&#39;t think you can. But you could always make <code>fooBarClassFunc&#39;</code> the method, and then define <code>fooBarClassFunc :: forall b a. ...</code> as a regular function.  Same effect for users, a little strange for instantiators..."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550184030, "post_id": 54700136, "comment_id": 96187219, "body": "@liqui Yes, of course. But I was more curious if it is possible on the typeclass itself, maybe some special syntax or something that I am not aware of. I don&#39;t particularly need to solve that either, this is just pure curiosity."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1550186922, "post_id": 54700136, "comment_id": 96187987, "body": "I naively believed that <code>QuantifiedConstraints</code> would allow to specify this as well, but it does not seem to allow anything like <code>class forall b a . (C a, C b) =&gt; K a b where</code>. Further, one might want the order to vary from method to method, for maximum generality."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1550198481, "post_id": 54700136, "comment_id": 96190321, "body": "Keep in mind you can still change parameter order in certain situations e.g. you can do <code>class X t where { func :: forall a b. t a -&gt; t b -&gt; t (a, b) }</code>. You just can&#39;t do it with <code>t</code>, which is the type on which the typeclass is defined. Not that that helps very much..."}], "answers": [{"comments": [{"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 0, "creation_date": 1550224562, "post_id": 54706199, "comment_id": 96199055, "body": "There is no need to add another class in order to have a work around, adding a single function <code>otherFooBarClassFunc :: forall b a . FooBar a b =&gt; a -&gt; b -&gt; String</code>, where <code>otherFooBarClassFunc = fooBarClassFunc</code> would suffice.  My question concerns the method attached to the class, not the things that are derived from it."}], "tags": [], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "is_accepted": false, "score": 2, "last_activity_date": 1550222797, "creation_date": 1550222797, "answer_id": 54706199, "question_id": 54700136, "link": "https://stackoverflow.com/questions/54700136/explicit-forall-on-a-type-class-function/54706199#54706199", "title": "Explicit forall on a type class function", "body": "<blockquote>\n  <p>how do you change the order of type variables for the purpose of <code>TypeApplication</code> inside the type class methods?</p>\n</blockquote>\n\n<p>@luqui's answer is good enough, I would think. But why not this:</p>\n\n<pre><code>class (Show b, Show a) =&gt; FooBar b a where\n  fooBarClassFunc :: a -&gt; b -&gt; String\n</code></pre>\n\n<p>You only have one method, so the only consideration driving the order of parameters to the class is for the purpose of <code>TypeApplication</code> inside the methods.</p>\n\n<p>If you have two or more methods for which you want the order of <code>TypeApplication</code> to be different (@chi's point, but why?), then for the other methods either luqui's suggestion, or (equivalently) an other class with a superclass constraint and a default implementation.</p>\n\n<pre><code>class (Show a, Show b, FooBar b a) =&gt; OtherFooBar a b where\n  otherFooBarClassFunc :: a -&gt; b -&gt; String\n  otherFooBarClassFunc = otherFooBarClassFunc'  -- default\ninstance {-# NOOVERLAPPABLE #-} OtherFooBar a b  where {}  -- take default\n</code></pre>\n\n<p>(Assuming <code>otherFooBarClassFunc'</code> is defined in the main class; and that's where the real instance definition goes on.)</p>\n\n<p>There is a lot to be said for <a href=\"https://cs.stackexchange.com/questions/104232/an-alternative-history-of-haskell-being-lazy-without-class\">one method per class</a>, of course.</p>\n\n<p><code>{-# NOOVERLAPPABLE #-}</code> wot we do not 'ave is my little in-joke.</p>\n"}], "owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 2, "answer_count": 1, "score": 13, "last_activity_date": 1550222797, "creation_date": 1550183648, "last_edit_date": 1550186975, "question_id": 54700136, "link": "https://stackoverflow.com/questions/54700136/explicit-forall-on-a-type-class-function", "title": "Explicit forall on a type class function", "body": "<p>Since ghc-8.0 we have a very nice extension called <code>TypeApplications</code>. Which allows us instead of:</p>\n\n<pre><code>\u03bb&gt; show (5 :: Int)\n\"5\"\n</code></pre>\n\n<p>do so something like that:</p>\n\n<pre><code>\u03bb&gt; :set -XTypeApplications\n\u03bb&gt; show @Int 5\n\"5\"\n</code></pre>\n\n<p>Which is really cool. It becomes a bit more involved when we add more type variables, but there are rules that can be used to determine the exact order, and they are very well documented:</p>\n\n<pre><code>showFooBar :: (Show a, Show b) =&gt; a -&gt; b -&gt; String\nshowFooBar a b = show a ++ \" and \" ++ show b\n</code></pre>\n\n<p>So in the function above we would first supply <code>a</code> and then <code>b</code>:</p>\n\n<pre><code>\u03bb&gt; showFooBar @Int @Double 3 4\n\"3 and 4.0\"\n</code></pre>\n\n<p>That's great, but what if I'd like to change the order? No problem there, we can use <code>ExplicitForAll</code> extension (or some other that imply it) to specify it:</p>\n\n<pre><code>{-# LANGUAGE ExplicitForAll #-}\n\nshowFooBar :: forall b a . (Show a, Show b) =&gt; a -&gt; b -&gt; String\nshowFooBar a b = show a ++ \" and \" ++ show b\n</code></pre>\n\n<p>And now we reversed the order of types that we are going to apply:</p>\n\n<pre><code>\u03bb&gt; showFooBar @Int @Double 3 4\n\"3.0 and 4\"\n</code></pre>\n\n<p>The problem is that I can't seem to figure out how to achieve the same affect for functions that are part of a type class. Consider this example:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n\nclass (Show a, Show b) =&gt; FooBar a b where\n  fooBarClassFunc :: a -&gt; b -&gt; String\n</code></pre>\n\n<p>I can't put <code>forall</code> on a function now (eg. <code>fooBarClassFunc :: forall a b . a -&gt; b -&gt; ..</code>, cause that changes the meaning of the function and obviously does not compile.</p>\n\n<p>So, the question is, how do you change the order of type variables for the purpose of <code>TypeApplication</code> inside the type class methods?</p>\n\n<p><em>Edit</em></p>\n\n<p>Just in case, I have tried <code>InstanceSigs</code> extension, and it completely ignores the order of <code>forall</code> type variables as far as <code>TypeApplications</code> are concerned, which is a good thing, otherwise we would end up with behavior that is determined by the instance, rather than the class.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550179443, "post_id": 54699019, "comment_id": 96185450, "body": "Are there other components in your cabal file (e.g. executables, benchmarks, test suites)? Do they also use FDS.Database.Cassandra (but perhaps without depending on cql-io)? Does the version of cql-io chosen by your build tool still export Database.CQL.IO.Log? What is the exact command you are running when you see that error?"}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1550179980, "post_id": 54699019, "comment_id": 96185692, "body": "@DanielWagner thanks for the insightful questions - I answered them in the original question"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1550180037, "post_id": 54699019, "comment_id": 96185713, "body": "Note that the <code>Database.CQL.IO.Log</code> module is actually in the <code>cql-io-lib</code> sublibrary, not <code>cql-io</code> itself. It&#39;s basically a hidden module. I think the error message is not up-to-date with how the new sublibraries feature works. Cf. <a href=\"https://github.com/haskell/cabal/issues/4206\" rel=\"nofollow noreferrer\">github.com/haskell/cabal/issues/4206</a> \u2013 <code>cql-io-lib</code> would need to be declared as <code>visibility: public</code> in the <code>cql-io.cabal</code> file to allow you to use it externally."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1550180438, "post_id": 54699019, "comment_id": 96185917, "body": "ah, i see, i missed that in the cql-io.cabal file! Still investigating, but if I add cql-io-lib I&#39;m told I need to add it to <code>extra-deps</code> in <code>stack.yaml</code>, and if I add it there, I get &quot;The following package identifiers were not found in your indices: cql-io-lib-1.1.0 &quot;. So guessing stack can&#39;t handle this yet."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1550180616, "post_id": 54699019, "comment_id": 96185994, "body": "Hmm, in the last comment (currnetly) in that issue tracker, it is stated &quot;<code>visibility: public</code> in the sublibrary stanza.&quot; is required for external use of the sub library ... don&#39;t see it, so maybe I should take that up with the library developer(s)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1550180637, "post_id": 54699019, "comment_id": 96186008, "body": "@bbarker As hinted in @leftaroundabout&#39;s previous comment, this is not stack&#39;s fault: the cql-io cabal file does not make that module (nor the <code>cql-io-lib</code> library) available externally, perhaps on purpose."}], "answers": [{"tags": [], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "is_accepted": false, "score": 0, "last_activity_date": 1550185870, "last_edit_date": 1550185870, "creation_date": 1550182799, "answer_id": 54699949, "question_id": 54699019, "link": "https://stackoverflow.com/questions/54699019/how-to-diagnose-perhaps-you-need-to-add-xxx-to-the-build-depends-in-your-cabal/54699949#54699949", "title": "How to diagnose &quot;Perhaps you need to add xxx to the build-depends in your .cabal file&quot;, when it is already in the cabal file?", "body": "<p>The comments above were very insightful for the general case of the question (as posed); the answer being, sub-libraries that are recently supported by cabal may not have <code>visibility: true</code> declared.</p>\n\n<p>But in my specific case, the answer is to look at the problematic library's re-exports. I could get around this issue because the cql-io authors re-exported <code>Logger (..)</code> and <code>LogLevel(..)</code> from the main library. </p>\n\n<p>So that would allow me to write my code.</p>\n\n<p>An even better answer that is very specific to my situation, as I was trying to use TinyLog, is that there <a href=\"https://hackage.haskell.org/package/cql-io-tinylog\" rel=\"nofollow noreferrer\">is a library</a> for that already ... <a href=\"https://gitlab.com/romanb/cql-io-tinylog/blob/master/src/Database/CQL/IO/Tinylog.hs\" rel=\"nofollow noreferrer\">here is the code</a> from that library that demonstrates how to get around the issue (and solves the problem for me completely, as I now shouldn't have to write any code).</p>\n\n<p>Here is the relevant excerpt:</p>\n\n<pre><code>module Database.CQL.IO.Tinylog (mkLogger) where\n\nimport Data.ByteString.Builder\nimport Data.ByteString.Lazy (ByteString)\nimport Database.CQL.IO (Logger (..), LogLevel (..))\nimport Database.CQL.IO.Hexdump\n\nimport qualified Data.ByteString.Lazy as L\nimport qualified System.Logger        as Tiny\n\n-- | Create a cql-io 'Logger' that delegates log messages to\n-- the given tinylog 'Tiny.Logger'. Requests and responses are\n-- logged on 'Tiny.Trace' level.\nmkLogger :: Tiny.Logger -&gt; Logger\nmkLogger l = Logger\n    { logMessage  = tinylogMessage  l\n    , logRequest  = tinylogRequest  l\n    , logResponse = tinylogResponse l\n    }\n</code></pre>\n\n<p>And here is how I adjusted my imports in the example above to confirm and get GHC happy (though I will scrap this now in favor of using <code>cql-io-tinylog</code>):</p>\n\n<pre><code>import           Prelude                         hiding(init, log)\nimport           Database.CQL.IO                 hiding(Logger)\nimport qualified Database.CQL.IO                 as CQLIO\nimport qualified Database.CQL.Protocol           as CQL\nimport           Numeric.Natural\nimport           System.Logger                   hiding(defSettings)\n</code></pre>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 860, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1550185870, "creation_date": 1550178184, "last_edit_date": 1550185849, "question_id": 54699019, "link": "https://stackoverflow.com/questions/54699019/how-to-diagnose-perhaps-you-need-to-add-xxx-to-the-build-depends-in-your-cabal", "title": "How to diagnose &quot;Perhaps you need to add xxx to the build-depends in your .cabal file&quot;, when it is already in the cabal file?", "body": "<p>I think the only interesting bits are my imports and my cabal file. Here are the imports and the demonstration of how I would use the problematic import (<code>Database.CQL.IO.Log</code>).</p>\n\n<pre><code>module FDS.Database.Cassandra where\n\nimport           Prelude                         hiding(init)\nimport           Database.CQL.IO                 as Client hiding(Logger)\nimport           Database.CQL.IO.Log             as CQLLog\nimport qualified Database.CQL.Protocol           as CQL\nimport           Numeric.Natural\nimport           System.Logger                   (Logger)\n\ncqlLogger :: Logger -&gt; CQLLog.Logger\ncqlLogger logger = undefined\n</code></pre>\n\n<p>However, I get the error:</p>\n\n<pre><code>src/FDS/Database/Cassandra.hs:7:1: error:                                                                                              \n    Could not load module `Database.CQL.IO.Log'                                                                                                                                    \n    It is a member of the hidden package `cql-io-1.1.0'.                                                                                                                           \n    Perhaps you need to add `cql-io' to the build-depends in your .cabal file.                                                                                                     \n    Use -v to see a list of the files searched for.                                                                                                                                \n  |                                                                                                                                                                                \n7 | import           Database.CQL.IO.Log             as CQLLog                                                                                                                     \n  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                     \n</code></pre>\n\n<p>But as we can see from the cabal file, it is there:</p>\n\n<pre><code>library\n  ghc-options:    -Wall -Wtabs -Wincomplete-record-updates\n  default-extensions:\n      OverloadedStrings\n\n  exposed-modules:\n    FDS\n    , FDS.Config.Core\n    , FDS.Config.Dhall\n    , FDS.Data.Util\n    , FDS.Database.Cassandra\n\n  other-modules:\n    FDS.Data.Hobo.Defs\n\n  build-depends:\n    prelude\n    , base-noprelude    ^&gt;=4.12\n    , bytestring        ^&gt;=0.10.8.2\n    , conduit           ^&gt;=1.3.1\n    , containers        ^&gt;=0.6\n    , cql               ^&gt;=4.0.1\n    , cql-io            ^&gt;=1.1.0\n</code></pre>\n\n<p>One thing to note, I do have cql-io in my <code>extra-deps</code> in <code>stack.yaml</code>, as the latest version wasn't yet in LTS.</p>\n\n<p><strong>Q&amp;A from Comments</strong></p>\n\n<p><strong>Q</strong> Are there other components in your cabal file (e.g. executables, benchmarks, test suites)?</p>\n\n<p><strong>A</strong> Yes</p>\n\n<p><strong>Q</strong> Do they also use FDS.Database.Cassandra (but perhaps without depending on cql-io)? </p>\n\n<p><strong>A</strong> Not yet, but plan to later. So I haven't touched the other components yet.</p>\n\n<p><strong>Q</strong> Does the version of cql-io chosen by your build tool still export Database.CQL.IO.Log? </p>\n\n<p><strong>A</strong> It <a href=\"https://gitlab.com/twittner/cql-io/blob/v1.1.0/cql-io.cabal#L83\" rel=\"nofollow noreferrer\">seems to do so</a>.</p>\n\n<p><strong>Q</strong> What is the exact command you are running when you see that error?</p>\n\n<p><strong>A</strong> <code>stack --nix build</code> The only interesting bit that <code>--nix</code> is doing (AFAIK) is pulling in required system packages, e.g., OpenSSL.</p>\n"}, {"tags": ["haskell", "monomorphism-restriction"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 1, "creation_date": 1550173325, "post_id": 54694372, "comment_id": 96182870, "body": "Perhaps you just need a type signature on <code>bind&#39;</code>? It looks like <code>observe</code> (like <code>Debug.Trace.trace</code>) is &quot;pure&quot;, so the signature should be <code>bind&#39; ::  Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b</code>"}, {"owner": {"reputation": 479, "user_id": 9903901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jack malkovick", "link": "https://stackoverflow.com/users/9903901/jack-malkovick"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1550218318, "post_id": 54694372, "comment_id": 96195816, "body": "It worked. This was so silly... thank you!"}, {"owner": {"reputation": 479, "user_id": 9903901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jack malkovick", "link": "https://stackoverflow.com/users/9903901/jack-malkovick"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1550218589, "post_id": 54694372, "comment_id": 96195925, "body": "@crokeea If you wish, add your comment as an answer so I can accept it."}], "answers": [{"tags": [], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "is_accepted": true, "score": 1, "last_activity_date": 1550259698, "creation_date": 1550259698, "answer_id": 54716045, "question_id": 54694372, "link": "https://stackoverflow.com/questions/54694372/referencing-typeclass-functions/54716045#54716045", "title": "&#39;Referencing&#39; typeclass functions", "body": "<p>It looks like you have found the <a href=\"https://stackoverflow.com/questions/32496864/what-is-the-monomorphism-restriction\">infamous</a> <code>MonomorphismRestriction</code>. <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow noreferrer\">More</a> <a href=\"http://lambda.jstolarek.com/2012/05/towards-understanding-haskells-monomorphism-restriction/\" rel=\"nofollow noreferrer\">info</a>. The links do a great job of explaining what the MonomorphismRestriction is and how it works. </p>\n\n<p>You're not wrong to expect that writing <code>bind'</code> with no signature should \"just work\". However, sometimes the compiler needs a bit of help. In short, due to the MonomorphismRestriction, GHC tries to take the nominally polymorphic signature of <code>bind' :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b</code>, and make it less polymorphic by instantiating some of the type variables.</p>\n\n<p>In your case, it looks like the compiler wants to make <code>bind'</code> only work for one specific <code>Monad m</code>. Without your real code, I can't say for sure, but consider this example:</p>\n\n<pre><code>import Debug.Trace\n\nmain :: IO ()\nmain = (&gt;&gt;=) (return \"hello\") print\n\nbind' = trace \"bind\" (&gt;&gt;=)\n</code></pre>\n\n<p>The compiler produces an error similar to yours: <code>Ambiguous type variable m0</code></p>\n\n<p>However, if you <em>use</em> <code>bind'</code>:</p>\n\n<pre><code>import Debug.Trace\n\nmain :: IO ()\nmain = bind' (return \"hello\") print\n\nbind' = trace \"bind\" (&gt;&gt;=)\n</code></pre>\n\n<p>no error! That's because GHC is <em>inferring</em> that <code>m</code> should be <code>IO</code> since <code>bind'</code> is used in the <code>IO</code> monad.</p>\n\n<p>Alternatively, you can tell GHC to turn off the MonomorphismRestriction:</p>\n\n<pre><code>{-# LANGUAGE NoMonomorphismRestriction #-}\n\nimport Debug.Trace\n\nmain :: IO ()\nmain = (&gt;&gt;=) (return \"hello\") print\n\nbind' = trace \"bind\" (&gt;&gt;=)\n</code></pre>\n\n<p>and it compiles just fine!</p>\n"}], "owner": {"reputation": 479, "user_id": 9903901, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jack malkovick", "link": "https://stackoverflow.com/users/9903901/jack-malkovick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 54716045, "answer_count": 1, "score": 0, "last_activity_date": 1550511676, "creation_date": 1550159746, "last_edit_date": 1550511676, "question_id": 54694372, "link": "https://stackoverflow.com/questions/54694372/referencing-typeclass-functions", "title": "&#39;Referencing&#39; typeclass functions", "body": "<p>I'm a beginner and I'm trying to use <a href=\"https://wiki.haskell.org/Hoed\" rel=\"nofollow noreferrer\">Hoed</a> to trace Haskell evaluations, because maybe it will further help my learning process.</p>\n\n<p>I saw in their examples code like this</p>\n\n<pre><code>isEven :: Int -&gt; Bool\nisEven = observe \"isEven\" isEven'\nisEven' n = mod2 n == 0\n</code></pre>\n\n<p>I was thinking how could I <code>observe</code> in order to trace an instance defined function like <code>&gt;&gt;=</code> for example.</p>\n\n<p>I wrote something like</p>\n\n<p><code>bind' = observe \"bind'\" (&gt;&gt;=)</code></p>\n\n<p>and of course I've got an error</p>\n\n<pre><code>* Ambiguous type variable 'm0' arising from a use of '&gt;&gt;='\n  prevents the constraint '(Monad m0)' from being solved.\n  Relevant bindings include\n    bind' :: m0 a0 -&gt; (a0 -&gt; m0 b0) -&gt; m0 b0 (bound at my.hs:46:1)\n  Probable fix: use a type annotation to specify what 'm0' should be.\n  These potential instances exist:\n  ...\n</code></pre>\n\n<p>Should I / How could I use a type annotation in order to specify which <code>Monad</code> instance's (e.g. Reader, State etc.) <code>&gt;&gt;=</code> function</p>\n"}, {"tags": ["haskell", "operators", "evaluation", "operator-precedence"], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 11019303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bfaec7dd8db91951fb7515a3908c60?s=128&d=identicon&r=PG&f=1", "display_name": "Sniper", "link": "https://stackoverflow.com/users/11019303/sniper"}, "edited": false, "score": 0, "creation_date": 1550159770, "post_id": 54693155, "comment_id": 96176209, "body": "Thanks it actually helped."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 6, "last_activity_date": 1550156171, "last_edit_date": 1550156171, "creation_date": 1550155822, "answer_id": 54693155, "question_id": 54692906, "link": "https://stackoverflow.com/questions/54692906/arithmetic-expression-evaluation-in-haskell/54693155#54693155", "title": "Arithmetic expression evaluation in Haskell", "body": "<p>The default fixity for operators is <a href=\"https://www.haskell.org/onlinereport/decls.html\" rel=\"noreferrer\"><code>infixl 9</code></a> (see <code>4.4.2  Fixity Declarations</code>).</p>\n\n<p>You have not declared the fixity for your <code>:+:</code> etc. operators.</p>\n\n<p>This means that your expression gets parsed as</p>\n\n<pre><code>eval ((Num 2 :+: Num 2) :-: Num 1)  :: Exp\n\n--     Num 2                        :: Exp \n--               Num 2              :: Exp \n--     Num 2 :+: Num 2              :: Exp \n--                          Num 1   :: Exp \n--    (Num 2 :+: Num 2) :-: Num 1   :: Exp \n</code></pre>\n\n<p>So the evaluation proceeded as</p>\n\n<pre><code>  eval ((Num 2 :+: Num 2) :-: Num 1)  -- match with:\n  eval (a                 :-: b    ) = (eval a) - (eval b)\n                                     =  ....\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 1, "last_activity_date": 1550156432, "creation_date": 1550156432, "answer_id": 54693340, "question_id": 54692906, "link": "https://stackoverflow.com/questions/54692906/arithmetic-expression-evaluation-in-haskell/54693340#54693340", "title": "Arithmetic expression evaluation in Haskell", "body": "<p>I think the easiest way to follow what's going on here is just to follow the evaluation through one step at a time. Since as @WillNess has explained the default order of operation is from left to right, your code is evaluated as follows (each individual step comes directly from one of the lines of your definitioni of <code>eval</code>):</p>\n\n<pre><code>eval ((Num 2 :+: Num 2) :-: Num 1)\neval (Num 2 :+: Num 2) - eval(Num 1)\n(eval (Num 2 :+: Num 2)) - 1\n(eval (Num 2) + eval (Num 2)) - 1\n(2 + 2) - 1\n4 - 1\n3\n</code></pre>\n\n<p>I hope this makes it clear.</p>\n"}, {"comments": [{"owner": {"reputation": 395, "user_id": 11019303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bfaec7dd8db91951fb7515a3908c60?s=128&d=identicon&r=PG&f=1", "display_name": "Sniper", "link": "https://stackoverflow.com/users/11019303/sniper"}, "edited": false, "score": 0, "creation_date": 1550159690, "post_id": 54693596, "comment_id": 96176149, "body": "Thanks, everyone i understood what is explained above. but one thing is still confusing how does Haskell identified value constructors (:+:) as operators or is this the default behavior with every value constructor? Usually we position value constructor right after <code>=</code> then values. ?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 395, "user_id": 11019303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bfaec7dd8db91951fb7515a3908c60?s=128&d=identicon&r=PG&f=1", "display_name": "Sniper", "link": "https://stackoverflow.com/users/11019303/sniper"}, "edited": false, "score": 3, "creation_date": 1550163843, "post_id": 54693596, "comment_id": 96178703, "body": "A (non-alphabetic) data constructor that starts with <code>:</code> is infix by default. The simplest one is <code>:</code> itself, which is why you usually write <code>1 : [2,3,4]</code> instead of <code>(:) 1 [2,3,4]</code>. <code>Num 3 :+: Num 4</code> is equivalent to <code>(:+:) (Num 3) (Num 4)</code>"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1550157286, "creation_date": 1550157286, "answer_id": 54693596, "question_id": 54692906, "link": "https://stackoverflow.com/questions/54692906/arithmetic-expression-evaluation-in-haskell/54693596#54693596", "title": "Arithmetic expression evaluation in Haskell", "body": "<p>As pointed out in other answers, the problem is that all your constructors have the same default precedence: they are left-associative with high (9) precedence. You can change that using the <code>infixl</code> directive.</p>\n\n<pre><code>data Exp = Num Int\n       | Exp :+: Exp\n       | Exp :-: Exp\n       | Exp :*: Exp\n       | Exp :/: Exp\n       deriving (Show)\n\n-- Using the same precedences as (+), (-), (*), and (/)\ninfixl 6 :+:, :-:\ninfixl 7 :*:, :/:\n</code></pre>\n\n<p>Now <code>eval $ Num 4 :+: Num 2 :*: Num 3</code> will correctly return 10 instead of 18.</p>\n"}], "owner": {"reputation": 395, "user_id": 11019303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2bfaec7dd8db91951fb7515a3908c60?s=128&d=identicon&r=PG&f=1", "display_name": "Sniper", "link": "https://stackoverflow.com/users/11019303/sniper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 690, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1550157927, "creation_date": 1550155018, "last_edit_date": 1550157927, "question_id": 54692906, "link": "https://stackoverflow.com/questions/54692906/arithmetic-expression-evaluation-in-haskell", "title": "Arithmetic expression evaluation in Haskell", "body": "<p>Here i am trying to evaluate the expression in Haskell using defined values of <code>Exp</code> data type. The function type would be <code>eval :: Exp -&gt; Int</code> and data type is this: </p>\n\n<pre><code>data Exp = Num Int\n       | Exp :+: Exp\n       | Exp :-: Exp\n       | Exp :*: Exp\n       | Exp :/: Exp\n       deriving (Show)\n</code></pre>\n\n<p>and values which i am trying to evaluate are these:</p>\n\n<pre><code> 4 + 5 * 6 , respecting correct precedences of the operators\n 4 + 5 + 6 , respecting, that + binds left-associative\n (4 + 3) * (5 - 2)\n 4 + (4 / (2 - 2))\n</code></pre>\n\n<p>So far this logic is working fine which is: </p>\n\n<pre><code>eval :: Exp -&gt; Int\neval (Num a) = a \neval (a :+: b) = (eval a) + (eval b)\neval (a :-: b) = (eval a) - (eval b)\neval (a :*: b) = (eval a) * (eval b)\neval (a :/: b) = (eval a) `div` (eval b)\n</code></pre>\n\n<p>When i pass this i get <code>3</code> as output which is correct: </p>\n\n<pre><code>eval (Num 2 :+: Num 2 :-: Num 1) \noutput = 3 \n</code></pre>\n\n<p>but i am confused how it evaluated the second part of the expression which <code>:-:</code> what i understood the only pattern matched in first iteration was <code>eval (a :+: b) = (eval a) + (eval b)</code> which returned <code>4</code> as output how it carries <code>4</code> to next iteration to perform the <code>:-:</code> operation?</p>\n\n<p>before that i was trying something like this: </p>\n\n<pre><code>eval :: Exp -> Int\neval (Num a) = a\neval (<b>Num</b> a :+: <b>Num</b> b) = eval (<b>Num</b> a) + eval (<b>Num</b> b)\neval (<b>Num</b> a :-: <b>Num</b> b) = eval (<b>Num</b> a) - eval (<b>Num</b> b)\neval (<b>Num</b> a :*: <b>Num</b> b) = eval (<b>Num</b> a) * eval (<b>Num</b> b)\neval (<b>Num</b> a :/: <b>Num</b> b) = eval (<b>Num</b> a) `div` eval (<b>Num</b> b)</code></pre>\n\n<p>it didn't give the desired results and then i just changed it to the first version. it worked fine but didn't get the proper semantics of it. Any help? Please don't hesitate to go into details. Thanks in advance. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1550177081, "post_id": 54690534, "comment_id": 96184438, "body": "You may find it a bit easier to define this particular instance using <code>liftA2</code> (an <code>Applicative</code> method exported by <code>Control.Applicative</code>) rather than <code>&lt;$&gt;</code> and <code>&lt;*&gt;</code>. I also strongly recommend using typed holes to work things out: <code>traverse fn (Product fa ga) = _ (traverse fn fa) (traverse fn ga)</code> will give you an error message that shows what you&#39;ve gotten and what you still need to produce."}, {"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1550343974, "post_id": 54690534, "comment_id": 96237184, "body": "Thanks, @dfeuer! I&#39;ve used type holes quite a bit on fp-course!"}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 4, "last_activity_date": 1550482785, "last_edit_date": 1550482785, "creation_date": 1550152553, "answer_id": 54692114, "question_id": 54690534, "link": "https://stackoverflow.com/questions/54690534/understanding-traversable-product-type/54692114#54692114", "title": "Understanding (Traversable Product) Type", "body": "<p>Yes. You have</p>\n\n<pre><code>traverse :: (a -&gt; h b) -&gt; f a -&gt; h (f b)\ntraverse    fn            fa  :: h (f b)   -- and,\n\ntraverse :: (a -&gt; h b) -&gt; g a -&gt; h (g b)\ntraverse    fn            ga  :: h (g b)\n</code></pre>\n\n<p>Thus </p>\n\n<pre><code>Product (traverse fn fa)  (traverse fn ga) :: Product h h (f b)\n        (h        (f b))  (h        (g b))\n</code></pre>\n\n<p><i>where the equivalency <code>f b ~ g b</code> i.e. <code>f ~ g</code> has been forced,</i> because <code>Product p q t</code> is defined as </p>\n\n<pre><code>Product (p        t    )  (q        t    )\n------------------------------------------\n       p ~ h   t ~ f b    q ~ h    t ~ g b\n</code></pre>\n\n<p>So plainly applying <code>Product</code> to the two <code>traverse</code> results didn't pan out. </p>\n\n<p>But the two have types <code>h (f b)</code> and <code>h (g b)</code>, and <code>h</code> is an Applicative, and we seek to create a result of type <code>h (Product f g b)</code>  with a <em>combined</em> type <em>on the inside of <code>h</code></em>, so if only we could have</p>\n\n<pre><code>         h (f b)           h (g b)              h r              h s\n        ---------------------------            ----------------------\n         h (Combined  (f b)  (g b))             h (Combined   r    s)\n</code></pre>\n\n<p>and in fact since both <code>b</code>s are the same,</p>\n\n<pre><code>        ---------------------------\n         h (Combined   f      g b )\n</code></pre>\n\n<p>so from <code>foo :: r -&gt; s -&gt; t</code> we want to get <code>bar :: h r -&gt; h s -&gt; h t</code>... If only there was <a href=\"https://hoogle.haskell.org/?hoogle=%28Applicative%20h%29%20%3D%3E%20%28r%20-%3E%20s%20-%3E%20t%29%20-%3E%20%28h%20r%20-%3E%20h%20s%20-%3E%20h%20t%29&amp;scope=set%3Astackage\" rel=\"nofollow noreferrer\">such a function ...</a></p>\n\n<pre><code>baz :: (Applicative h) =&gt; (r -&gt; s -&gt; t) -&gt; (h r -&gt; h s -&gt; h t)\n</code></pre>\n\n<p>... and so the answer is <code>liftA2 Product (traverse fn fa) (traverse fn ga)</code>, applying the data constructor <code>Product</code> to the two traversals' inner results <em>\"in\"</em> (<em>\"inside\"</em>, <em>\"under the covers of\"</em>) the Applicative:</p>\n\n<pre><code>         h r       h s\n           r   -&gt;    s   -&gt;   t\n        ------------------------\n         h                    t\n</code></pre>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 54692114, "answer_count": 1, "score": 3, "last_activity_date": 1550482785, "creation_date": 1550147684, "question_id": 54690534, "link": "https://stackoverflow.com/questions/54690534/understanding-traversable-product-type", "title": "Understanding (Traversable Product) Type", "body": "<p>Given the following from <a href=\"https://github.com/data61/fp-course\" rel=\"nofollow noreferrer\">fp-course</a>:</p>\n\n<pre><code>data Product f g a =\n  Product (f a) (g a)\n\nclass Functor f where\n  -- Pronounced, eff-map.\n  (&lt;$&gt;) ::\n    (a -&gt; b)\n    -&gt; f a\n    -&gt; f b\n\nclass Functor f =&gt; Applicative f where\n  pure ::\n    a -&gt; f a\n  (&lt;*&gt;) ::\n    f (a -&gt; b)\n    -&gt; f a\n    -&gt; f b\n</code></pre>\n\n<p>I attempted to define the <code>Traversable</code> instance for <code>Product f g a</code>:</p>\n\n<pre><code>instance (Traversable f, Traversable g) =&gt;\n  Traversable (Product f g) where\n  traverse :: \n    Applicative h =&gt;\n    (a -&gt; h b)\n    -&gt; Product f g a\n    -&gt; h (Product f g b)  \n  traverse fn (Product fa ga) = Product (traverse fn fa) (traverse fn ga)\n</code></pre>\n\n<p>The compiler shows an error:</p>\n\n<pre><code>src/Course/Traversable.hs:106:33: error:\n    \u2022 Occurs check: cannot construct the infinite type: h ~ Product h h\n      Expected type: h (Product f g b)\n        Actual type: Product h h (f b)\n</code></pre>\n\n<p>I understand how my definition is wrong, but I don't understand how the actual type is <code>Product h h (f b)</code>.</p>\n\n<p>Breaking apart <code>Product (traverse fn fa) (traverse fn ga)</code>'s type, I believe it is:</p>\n\n<pre><code>Product (h (f b)) (h (g b))\n</code></pre>\n\n<p>since <code>traverse</code>'s signature is <code>Applicative f =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)</code>.</p>\n\n<p>Where does the <code>g</code> go per the actual type of <code>Product h h (f b)</code>? Please explain the above actual type.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 4, "creation_date": 1550146412, "post_id": 54690135, "comment_id": 96167801, "body": "I&#39;m a bit confused by how you were attempting this, but you can already add an element to the start of the list with the <code>:</code> operator - so I think just <code>add = (:)</code> will do what you want. (And therefore there&#39;s no need to define your own function, either.)"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 9659054, "user_type": "registered", "profile_image": "https://graph.facebook.com/490170168068038/picture?type=large", "display_name": "Mojibar Homan", "link": "https://stackoverflow.com/users/9659054/mojibar-homan"}, "edited": false, "score": 0, "creation_date": 1550147204, "post_id": 54690174, "comment_id": 96168262, "body": "but now im getting a   Illegal operator \u2018++\u2019 in type \u2018PhoneBook add (a, b) add [(a, b)]                                    ++ []\u2019       Use TypeOperators to allow operators in types      error"}, {"owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "reply_to_user": {"reputation": 59, "user_id": 9659054, "user_type": "registered", "profile_image": "https://graph.facebook.com/490170168068038/picture?type=large", "display_name": "Mojibar Homan", "link": "https://stackoverflow.com/users/9659054/mojibar-homan"}, "edited": false, "score": 3, "creation_date": 1550147559, "post_id": 54690174, "comment_id": 96168467, "body": "I don&#39;t see an <code>=</code> in what you wrote."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 59, "user_id": 9659054, "user_type": "registered", "profile_image": "https://graph.facebook.com/490170168068038/picture?type=large", "display_name": "Mojibar Homan", "link": "https://stackoverflow.com/users/9659054/mojibar-homan"}, "edited": false, "score": 1, "creation_date": 1550156344, "post_id": 54690174, "comment_id": 96174045, "body": "@MojibarHoman In a Haskell source file, you can&#39;t simply &quot;add something at the beginning of a list&quot;, you need to define a function (e.g. <code>add</code>) which takes two parameters (e.g. a <code>person</code> and a <code>phoneBook</code>) and returns a new phonebook build from the parameters."}], "tags": [], "owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "is_accepted": false, "score": 5, "last_activity_date": 1550147965, "last_edit_date": 1550147965, "creation_date": 1550146488, "answer_id": 54690174, "question_id": 54690135, "link": "https://stackoverflow.com/questions/54690135/trying-to-add-a-tuple-in-front-of-a-list-in-haskell-but-receiving-error/54690174#54690174", "title": "Trying to add a tuple in front of a list in Haskell but receiving error?", "body": "<p>You are trying to add a list and a tuple. But <code>++</code> is defined for adding lists to lists, not for adding tuples to lists. Haskell is <em>very</em> strict about types, so it won't let you do this.</p>\n\n<p>You should make the tuple a list:</p>\n\n<pre><code>add [(a,b)] ++ [] \n</code></pre>\n\n<p>Or, as was suggesteed by Robin Zigmond in their <a href=\"https://stackoverflow.com/questions/54690135/trying-to-add-a-tuple-in-front-of-a-list-in-haskell-but-receiving-error/54690174#comment96167801_54690135\">comment</a>, use the <code>:</code> operator:</p>\n\n<pre><code>add (a,b) : [] \n</code></pre>\n\n<p>You have another issue though - your function definition should contain an <code>=</code> operator:</p>\n\n<pre><code>add (a,b) [] = [(a,b)]\n</code></pre>\n\n<p>This is how a function is defined in Haskell. On the lefthand side, it tells Haskell wat the inputs are. On the righthand side, it tells Haskell what they should be transformed into.</p>\n\n<p>You may want to refer to <a href=\"http://learnyouahaskell.com/syntax-in-functions\" rel=\"nofollow noreferrer\">Learn You A Haskell : Syntax in Functions</a> for a nice introduction to defining functions in Haskell.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1550156165, "post_id": 54691277, "comment_id": 96173912, "body": "Note that <code>add person phoneBook = person : phoneBook</code> would also work, since there&#39;s no need to access the <code>name</code> and <code>phoneNumber</code> here. (Above someone also has suggested <code>add = (:)</code> as an eta-contraction of that.)"}], "tags": [], "owner": {"reputation": 1748, "user_id": 936652, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Uwfmf.jpg?s=128&g=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/936652/christophe"}, "is_accepted": false, "score": 1, "last_activity_date": 1550149997, "creation_date": 1550149997, "answer_id": 54691277, "question_id": 54690135, "link": "https://stackoverflow.com/questions/54690135/trying-to-add-a-tuple-in-front-of-a-list-in-haskell-but-receiving-error/54691277#54691277", "title": "Trying to add a tuple in front of a list in Haskell but receiving error?", "body": "<p>Based on your post you can run the following piece of code:</p>\n\n<pre><code> type Name = String\n type PhoneNumber = Int\n type Person  = (Name, PhoneNumber)\n type PhoneBook = [Person]\n\n add :: Person -&gt; PhoneBook -&gt; PhoneBook\n add (name, phoneNumber) phoneBook = (name, phoneNumber) : phoneBook \n\n main = print $ add (\"xyz\", 987) (add (\"abcd\", 123) [])\n</code></pre>\n\n<p>which yields:</p>\n\n<pre><code>[(\"xyz\",987),(\"abcd\",123)]\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9659054, "user_type": "registered", "profile_image": "https://graph.facebook.com/490170168068038/picture?type=large", "display_name": "Mojibar Homan", "link": "https://stackoverflow.com/users/9659054/mojibar-homan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1550156577, "creation_date": 1550146307, "last_edit_date": 1550156577, "question_id": 54690135, "link": "https://stackoverflow.com/questions/54690135/trying-to-add-a-tuple-in-front-of-a-list-in-haskell-but-receiving-error", "title": "Trying to add a tuple in front of a list in Haskell but receiving error?", "body": "<pre><code> type Name = String\n type PhoneNumber = Int\n type Person  = (Name, PhoneNumber)\n type PhoneBook = [Person]\n add :: Person -&gt; PhoneBook -&gt; PhoneBook\n add (a,b) \n add (a,b) ++ [] \n</code></pre>\n\n<p>I'm trying to add an entry in front of the list but its giving me an error </p>\n\n<pre><code>    Parse error: module header, import declaration\n    or top-level declaration expected.\n   |\n30 | add (a,b) : xs\n   | ^^^^^^^^^^^^^^\n</code></pre>\n\n<p>where am I going wrong?</p>\n"}, {"tags": ["haskell", "monads", "pushdown-automaton"], "answers": [{"comments": [{"owner": {"reputation": 542, "user_id": 1956587, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e92d52f1c16bcf435ef24f7a474fde04?s=128&d=identicon&r=PG", "display_name": "tolUene", "link": "https://stackoverflow.com/users/1956587/toluene"}, "edited": false, "score": 0, "creation_date": 1550156677, "post_id": 54689276, "comment_id": 96174280, "body": "I haven&#39;t used the <code>Alternative</code> typeclass yet, could you explain why it&#39;s a better fit than simply using <code>concat</code> here?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 542, "user_id": 1956587, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e92d52f1c16bcf435ef24f7a474fde04?s=128&d=identicon&r=PG", "display_name": "tolUene", "link": "https://stackoverflow.com/users/1956587/toluene"}, "edited": false, "score": 1, "creation_date": 1550164024, "post_id": 54689276, "comment_id": 96178798, "body": "It&#39;s not really a better fit, it&#39;s mostly personal preference. But the point of mentioning it is that with the abstract view of <code>[]</code> as a nondeterminism monad, you need more operations than just <code>(&gt;&gt;=)</code> and <code>return</code> to write this program, and <code>Alternative</code> provides the operations you need here."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 3, "last_activity_date": 1550143436, "creation_date": 1550143436, "answer_id": 54689276, "question_id": 54688480, "link": "https://stackoverflow.com/questions/54688480/pushdown-automata-in-haskell-using-the-list-monad/54689276#54689276", "title": "Pushdown Automata in Haskell using the List Monad", "body": "<p>In the original definition, <code>(++)</code> separates the lookups, which corresponds to choice <code>(&lt;|&gt;)</code> in the nondeterministic interpretation of <code>[]</code>.</p>\n\n<pre><code>deltaStar q rs (x:xs) st = nub . asum $\n  [ do (a, b) &lt;- lookup' (q, Just x, fst $ pop st) rs\n       deltaStar a rs xs $ push b stack\n  , do (a, b) &lt;- lookup' (q, Nothing, fst $ pop st) rs\n       deltaStar a rs (x:xs) $ push b stack\n  , do (a, b) &lt;- lookup' (q, Just x, Nothing) rs\n       deltaStar a rs xs $ push b st\n  , do (a, b) &lt;- lookup' (q, Nothing, Nothing) rs\n       deltaStar a rs (x:xs) $ push b st\n  ] where stack = snd $ pop st\n-- asum [a, b, c d] = a &lt;|&gt; b &lt;|&gt; c &lt;|&gt; d = a ++ b ++ c ++ d\n--                  = concat [a, b, c, d]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 542, "user_id": 1956587, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e92d52f1c16bcf435ef24f7a474fde04?s=128&d=identicon&r=PG", "display_name": "tolUene", "link": "https://stackoverflow.com/users/1956587/toluene"}, "edited": false, "score": 0, "creation_date": 1550185749, "post_id": 54696804, "comment_id": 96187696, "body": "This works perfectly and is exactly what I wanted to do. Thanks!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1550169810, "last_edit_date": 1550169810, "creation_date": 1550168536, "answer_id": 54696804, "question_id": 54688480, "link": "https://stackoverflow.com/questions/54688480/pushdown-automata-in-haskell-using-the-list-monad/54696804#54696804", "title": "Pushdown Automata in Haskell using the List Monad", "body": "<p>Li-yao Xia's answer shows how to use more typeclass-polymorphic operations, but doesn't address the code duplication. In this answer I show how to address that. The main idea is this: there are just two things that vary, and they vary independently, namely whether we consume a letter and whether we consume from the stack. So let's nondeterministically choose for each!</p>\n\n<p>(Warning: untested code follows.)</p>\n\n<pre><code>deltaStar q rs (x:xs) st = do\n    (stackSymbol, st') &lt;- [pop st, (Nothing, st)]\n    (stringSymbol, xs') &lt;- [(Just x, xs), (Nothing, x:xs)]\n    (a, b) &lt;- lookup' (q, stringSymbol, stackSymbol) rs\n    deltaStar a rs xs' (push b st')\n</code></pre>\n"}], "owner": {"reputation": 542, "user_id": 1956587, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e92d52f1c16bcf435ef24f7a474fde04?s=128&d=identicon&r=PG", "display_name": "tolUene", "link": "https://stackoverflow.com/users/1956587/toluene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 54696804, "answer_count": 2, "score": 3, "last_activity_date": 1550169810, "creation_date": 1550140917, "question_id": 54688480, "link": "https://stackoverflow.com/questions/54688480/pushdown-automata-in-haskell-using-the-list-monad", "title": "Pushdown Automata in Haskell using the List Monad", "body": "<p>I'm trying to implement Pushdown Automata (as described in Sipser's Introduction to the Theory of Computation) in Haskell. I have a working definition:</p>\n\n<pre><code>import Data.List\nimport Data.Maybe(fromMaybe)\n\n-- A Pushdown Automaton with states of type q,\n-- inputs of type s, and a stack of type g\ndata PDA q s g = P { state :: [q]\n                   , start :: q\n                   , delta :: [Rule q s g]\n                   -- the transition function is list of relations\n                   , final :: [q]  -- list of accept states\n                   }\n\n-- rules are mappings from a (state, Maybe input, Maybe stack) to\n-- a list of (state, Maybe stack)\n-- Nothing represents the empty element \u03b5\ntype Rule q s g = ((q, Maybe s, Maybe g), [(q, Maybe g)])\n\npush :: Maybe a -&gt; [a] -&gt; [a]\npush (Just x) xs = x:xs\npush Nothing  xs = xs\n\n-- returns the popped element and the stack without that element\npop :: [a] -&gt; (Maybe a, [a])\npop (x:xs) = (Just x, xs)\npop [] = (Nothing, [])\n\nlookup' :: Eq a =&gt; a -&gt; [(a, [b])] -&gt; [b]\nlookup' a xs = fromMaybe [] (lookup a xs)\n\n-- calls deltaStar with the start state and an empty stack,\n-- and checks if any of the resulting states are accept states\naccepts :: (Eq q, Eq s, Eq g) =&gt; PDA g s q -&gt; [s] -&gt; Bool\naccepts p xs = any ((`elem` final p). fst) $ deltaStar (start p) (delta p) xs []\n\ndeltaStar :: (Eq q, Eq s, Eq g)\n          =&gt; q  -- the current state\n          -&gt; [Rule q s g] -- delta\n          -&gt; [s] -- inputs\n          -&gt; [g] -- the stack\n          -&gt; [(q, Maybe g)]\ndeltaStar q rs (x:xs) st = nub . concat $\n  map (\\(a, b) -&gt; deltaStar a rs xs $ push b stack)\n    (lookup' (q, Just x, fst $ pop st) rs) ++\n  map (\\(a, b) -&gt; deltaStar a rs (x:xs) $ push b stack)\n    (lookup' (q, Nothing, fst $ pop st) rs) ++\n  map (\\(a, b) -&gt; deltaStar a rs xs $ push b st)\n    (lookup' (q, Just x, Nothing) rs) ++\n  map (\\(a, b) -&gt; deltaStar a rs (x:xs) $ push b st)\n    (lookup' (q, Nothing, Nothing) rs)\n  where stack = snd $ pop st\ndeltaStar q rs [] st = nub $ (q, Nothing)\n                           : lookup' (q, Nothing, fst $ pop st) rs\n                           ++ lookup' (q, Nothing, Nothing) rs\n</code></pre>\n\n<p>Which gives me the expected results. However, looking at my <code>deltaStar</code> function, I can't help but feel there must be a more elegant way to write it. I manually check for Transitions that have \u03b5 in the input or stack, which I don't think I can get around, but this kind of Non-Determinism using concat and map looks like the <code>List</code> Monad to me. I would love to be able to write something like</p>\n\n<pre><code>deltaStar q rs (x:xs) st = do\n(a, b) &lt;- lookup' (q, Just x, fst $ pop st) rs\n(c, d) &lt;- lookup' (q, Nothing, fst $ pop st) rs\n(e, f) &lt;- lookup' (q, Just x, Nothing) rs\n(g, h) &lt;- lookup' (q, Nothing, Nothing) rs\nconcat [ deltaStar a rs xs $ push b stack\n      , deltaStar c rs (x:xs) $ push d stack\n      , deltaStar e rs xs $ push f st\n      , deltaStar g rs (x:xs) $ push h st]\nwhere stack = snd $ pop st\ndeltaStar q rs [] st = nub $ (q, Nothing)\n                           : lookup' (q, Nothing, fst $ pop st) rs\n                           ++ lookup' (q, Nothing, Nothing) rs\n</code></pre>\n\n<p>But that <code>deltaStar</code> will almost always return <code>[]</code>, as when any of the pattern binds fail, the whole computation will return <code>[]</code>. Is there a solution to this or should I stick to my definition?</p>\n\n<p>I tested my original function with the language <code>True^n False^n</code>, defined as such:</p>\n\n<pre><code>langA :: PDA Int Bool Char\nlangA = P [1,2,3,4]\n          1\n          delta\n          [1,4]\n  where delta = [ ((1, Nothing, Nothing), [(2, Just '$')])\n                , ((2, Just False, Nothing),[(2, Just '0')])\n                , ((2, Just True, Just '0'), [(3, Nothing)])\n                , ((3, Just True, Just '0'), [(3, Nothing)])\n                , ((3, Nothing, Just '$'), [(4, Nothing)])]\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "stack-overflow"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550178066, "post_id": 54685403, "comment_id": 96184873, "body": "Oh by the way you can write <code>summ</code> as <code>summ n = sum [ 1 &#47; i^2 | i &lt;- [1..n] ]</code>. Nice, right?  (Make sure to compile with optimizations for this one)"}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1556586831, "post_id": 54685403, "comment_id": 98479979, "body": "@luqui - I think you&#39;d want <code>sum [ 1 &#47; i^2 | i &lt;- reverse [1..n] ]</code> to avoid loss of precision."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "edited": false, "score": 0, "creation_date": 1556660876, "post_id": 54685403, "comment_id": 98511751, "body": "@Omnifarious interesting!  I had never thought about issues like this.  I can&#39;t quite see why it happens though..."}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1556663860, "post_id": 54685403, "comment_id": 98512532, "body": "@luqui - Happens due to rounding. Floating point numbers work best when the numbers being added together are similar in magnitude. Otherwise, the bits being added from the small number sort of rotate off the end of the large number and don&#39;t even change it. So, even if you add several hundred thousand tiny numbers like that they don&#39;t change the original number at all."}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1556663932, "post_id": 54685403, "comment_id": 98512551, "body": "@luqui - Unfortunately, Haskell&#39;s reverse requires actually evaluating the whole list to be reversed. So you have to come up with some kind of reverse countdown list to make it work without taking gigabytes of memory. Luckily, that&#39;s not too hard."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "edited": false, "score": 0, "creation_date": 1556666078, "post_id": 54685403, "comment_id": 98513016, "body": "@Omnifarious, oh that makes sense.  So for maximum accuracy adding a large list of numbers, we should sort it by increasing magnitude (if it&#39;s a left fold).  ... Right?  That makes intuitive sense, but I can&#39;t rule out that there might be some choice of association e.g. ((x1+x4)+(x2+x5))+x3 which would achieve even better accuracy."}, {"owner": {"reputation": 50273, "user_id": 167958, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0defa74609a4ce5d51f2467b69c509be?s=128&d=identicon&r=PG", "display_name": "Omnifarious", "link": "https://stackoverflow.com/users/167958/omnifarious"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1556666418, "post_id": 54685403, "comment_id": 98513091, "body": "@luqui - As a rule of thumb, yes. I can also imagine that in some specific cases different orderings may be better. There are other rules for other operations as well. I don&#39;t know what they all are, but I do know that making the most of floating point precision is something to be thought through carefully."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 9807234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a247b66199e7b2415be65a45e36b323e?s=128&d=identicon&r=PG&f=1", "display_name": "Terobero", "link": "https://stackoverflow.com/users/9807234/terobero"}, "edited": false, "score": 0, "creation_date": 1550150892, "post_id": 54686366, "comment_id": 96170526, "body": "It has worked and I could get output from 10^9 but it is really slow. I am currently waiting for 10^10 and 10^9 took like 20 minutes. Is this speed normal or is there ways to make it faster?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 69, "user_id": 9807234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a247b66199e7b2415be65a45e36b323e?s=128&d=identicon&r=PG&f=1", "display_name": "Terobero", "link": "https://stackoverflow.com/users/9807234/terobero"}, "edited": false, "score": 1, "creation_date": 1550151048, "post_id": 54686366, "comment_id": 96170622, "body": "@Terobero Are you running the code after compilation with optimization e.g. <code>-O2</code>? If you are running it using GHCi instead, that is usually quite slow."}, {"owner": {"reputation": 69, "user_id": 9807234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a247b66199e7b2415be65a45e36b323e?s=128&d=identicon&r=PG&f=1", "display_name": "Terobero", "link": "https://stackoverflow.com/users/9807234/terobero"}, "edited": false, "score": 0, "creation_date": 1550151665, "post_id": 54686366, "comment_id": 96170989, "body": "Im using VSCode &amp; Stack. How do I do the thing you said in Windows?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 69, "user_id": 9807234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a247b66199e7b2415be65a45e36b323e?s=128&d=identicon&r=PG&f=1", "display_name": "Terobero", "link": "https://stackoverflow.com/users/9807234/terobero"}, "edited": false, "score": 1, "creation_date": 1550153695, "post_id": 54686366, "comment_id": 96172211, "body": "@Terobero I have no idea about VSCode. I guess it does compile code with GHC, since it runs <code>main</code> instead of giving you a REPL prompt (right?). There should be some place in its options where you can add <code>-O2</code> if that&#39;s not already on. From the command line instead I would use <code>stack ghc -- File.hs -O2</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 69, "user_id": 9807234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a247b66199e7b2415be65a45e36b323e?s=128&d=identicon&r=PG&f=1", "display_name": "Terobero", "link": "https://stackoverflow.com/users/9807234/terobero"}, "edited": false, "score": 1, "creation_date": 1550155608, "post_id": 54686366, "comment_id": 96173504, "body": "@Terobero See the last edit. Without <code>errorPercent</code>, and with <code>-O2</code> on, the program with 10^9 here runs in 12s. Your 20 minutes is way too much."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 69, "user_id": 9807234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a247b66199e7b2415be65a45e36b323e?s=128&d=identicon&r=PG&f=1", "display_name": "Terobero", "link": "https://stackoverflow.com/users/9807234/terobero"}, "edited": false, "score": 0, "creation_date": 1550158803, "post_id": 54686366, "comment_id": 96175595, "body": "@Terobero the direct compilation with ghc at the Windows Command prompt is as simple as running <code>C:&gt; ghc -O2 name.hs</code> in the directory in which the file <code>name.hs</code> resides."}, {"owner": {"reputation": 69, "user_id": 9807234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a247b66199e7b2415be65a45e36b323e?s=128&d=identicon&r=PG&f=1", "display_name": "Terobero", "link": "https://stackoverflow.com/users/9807234/terobero"}, "edited": false, "score": 0, "creation_date": 1550178217, "post_id": 54686366, "comment_id": 96184933, "body": "This worked perfectly, thanks. I have one last question. You used type Int and fromIntegral. Is there a reason you did that and not used a Double type?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 69, "user_id": 9807234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a247b66199e7b2415be65a45e36b323e?s=128&d=identicon&r=PG&f=1", "display_name": "Terobero", "link": "https://stackoverflow.com/users/9807234/terobero"}, "edited": false, "score": 1, "creation_date": 1550178577, "post_id": 54686366, "comment_id": 96185094, "body": "@Terobero For integer variables, it&#39;s faster and safer to use <code>Int</code> or some other integral type. Using <code>Double</code> can cause subtle issues since e.g. <code>x == x+1</code> when <code>x</code> is a large enough <code>Double</code>, and rounding errors can easily break the program. I&#39;d tend to avoid floating point except when an inexact approximate value is good enough (e.g. not when we need precise comparisons such as <code>if x == 1 then ...</code>). luqui in his answer shows why using <code>Double</code> does not work here."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1550155504, "last_edit_date": 1550155504, "creation_date": 1550134122, "answer_id": 54686366, "question_id": 54685403, "link": "https://stackoverflow.com/questions/54685403/haskell-recursion-stack-overflow/54686366#54686366", "title": "Haskell - Recursion Stack Overflow", "body": "<p>The problem here is that  sums can not start being computed until the whole 10^9 recursion calls are over. Essentially, you are computing</p>\n\n<pre><code>1/(n**2) + ( 1/((n-1)**2) + ( 1/((n-2)**2) + ....\n</code></pre>\n\n<p>and the parentheses prevent to start summing. Instead, we would like to have</p>\n\n<pre><code>(( 1/(n**2) + 1/((n-1)**2) ) + 1/((n-2)**2) ) + ....\n</code></pre>\n\n<p>The easiest way is to use an \"accumulator\" additional argument:</p>\n\n<pre><code>summ 1 acc = 1 + acc\nsumm n acc = summ (n-1) $! acc + 1/(n**2)\n\nmain = do\n    putStr \"%\"\n    print (errorPercent (summ (10^9) 0))  -- set acc to 0 at the beginning\n</code></pre>\n\n<p>For improving the performance, I'd recommend to add a type signature to <code>summ</code> e.g. <code>summ :: Int -&gt; Double -&gt; Double</code>.</p>\n\n<hr>\n\n<p>Full program below. This runs in 12s here (<code>ghc -O2</code>).</p>\n\n<pre><code>summ :: Int -&gt; Double -&gt; Double\nsumm 1 acc = 1 + acc\nsumm n acc = summ (n-1) $! acc + 1 / (fromIntegral n**2)\n\nmain :: IO ()\nmain = do\n    putStr \"%\"\n    print (summ (10^9) 0)  -- set acc to 0 at the beginning\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 10, "last_activity_date": 1550137269, "last_edit_date": 1550137269, "creation_date": 1550134585, "answer_id": 54686505, "question_id": 54685403, "link": "https://stackoverflow.com/questions/54685403/haskell-recursion-stack-overflow/54686505#54686505", "title": "Haskell - Recursion Stack Overflow", "body": "<p>chi has answered one bit of the question, which I think is the main problem, but there is something else that is bugging me.  When you say <code>10**9</code>, you get a <em>floating point</em> number (because <code>**</code> is \"fractional\" exponentiation).  And then you are using floating point equality to check for the base case of your recursion. </p>\n\n<pre><code>summ 1 = ...\n</code></pre>\n\n<p>The problem with this is that it is possible, and as the argument gets larger, likely, that because of numerical error you will just barely miss the base case and descend into negative values forever.</p>\n\n<pre><code>summ 4 =        ... summ 3\nsumm 3 =        ... summ 2.000001\nsumm 2.000001 = ... summ 1.000001 \nsumm 1.000001 = ... summ 0.000001  -- BASE CASE MISSED!\nsumm 0.000001 = ... summ (-1.000001)\nsumm (-1.000001) = ... summ (-2.000001)\n</code></pre>\n\n<p>and so on.  If you didn't get a stack overflow from 10<sup>9</sup> calls, you surely will with infinitely many.</p>\n\n<p>You should either define your function on integers so there is no rounding error</p>\n\n<pre><code>summ :: Int -&gt; Double\nsumm 1 = 1\nsumm n = 1 / (fromIntegral n ** 2) + summ (n - 1)\n--            ^^^^^^^^^^^^\n-- conversion necessary to go from Int to Double\n\nmain = ... print (summ (10 ^ 9))\n--                      ^^^^^^\n--      use integral exponentiation (^) instead of (**)\n</code></pre>\n\n<p>or use a more forgiving base case</p>\n\n<pre><code>summ :: Double -&gt; Double\nsumm n | n &lt;= 1 = 1\nsumm n = 1 / (n ** 2) + summ (n - 1)\n</code></pre>\n\n<p>In either case, you should definitely take chi's suggestion to do this in accumulator style, and you should also definitely put a type signature.</p>\n\n<p>Here's <a href=\"https://stackoverflow.com/a/2463078/33796\">more on how you get stack overflows in Haskell</a> if you are curious.</p>\n"}], "owner": {"reputation": 69, "user_id": 9807234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a247b66199e7b2415be65a45e36b323e?s=128&d=identicon&r=PG&f=1", "display_name": "Terobero", "link": "https://stackoverflow.com/users/9807234/terobero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 54686366, "answer_count": 2, "score": 4, "last_activity_date": 1550155504, "creation_date": 1550130286, "last_edit_date": 1550141419, "question_id": 54685403, "link": "https://stackoverflow.com/questions/54685403/haskell-recursion-stack-overflow", "title": "Haskell - Recursion Stack Overflow", "body": "<p>I am trying to sum all n from 1 to a very large number (10**9 for now) but it gives stack overflow. Also I don't think putting a stop at 1 and doing the sum n in different rows is the most efficient way but the code below is all my knowledge for Haskell. I really don't know much about functional programming and I would like as much explanation as possible. (Also I have tried putting $! strict in the last line which was told in other places but it changed nothing. I would be glad if you explained the most efficient way I could do this recursive function.)</p>\n\n<pre><code>main :: IO()\n\nsumm 1 = 1\nsumm n = 1/(n**2) + summ (n-1)\n\nexpected_value = pi*pi/6\nerrorPercent n = n / expected_value * 100\n\nmain = do\n    putStr \"%\"\n    print (errorPercent (summ $! (10**9)))\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 0, "creation_date": 1550126912, "post_id": 54684610, "comment_id": 96157494, "body": "Isn&#39;t it <code>(Num a, Eq a, Ratio a) =&gt; a -&gt; a -&gt; Bool</code>?"}, {"owner": {"reputation": 11066, "user_id": 147057, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cf9d83a95db2460ccb18f311fa8a766c?s=128&d=identicon&r=PG", "display_name": "max taldykin", "link": "https://stackoverflow.com/users/147057/max-taldykin"}, "reply_to_user": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 0, "creation_date": 1550127009, "post_id": 54684610, "comment_id": 96157532, "body": "<a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Ratio.html#t:Ratio\" rel=\"nofollow noreferrer\">Ratio</a> is a datatype, not a class"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1550128556, "post_id": 54684610, "comment_id": 96158241, "body": "<code>eq = (==)</code> would work just as well (given the correct signature)."}], "tags": [], "owner": {"reputation": 11066, "user_id": 147057, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cf9d83a95db2460ccb18f311fa8a766c?s=128&d=identicon&r=PG", "display_name": "max taldykin", "link": "https://stackoverflow.com/users/147057/max-taldykin"}, "is_accepted": false, "score": 0, "last_activity_date": 1550126847, "creation_date": 1550126847, "answer_id": 54684610, "question_id": 54684384, "link": "https://stackoverflow.com/questions/54684384/fractional-type-is-in-haskell/54684610#54684610", "title": "fractional type is in Haskell", "body": "<p><a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Ratio.html#v:numerator\" rel=\"nofollow noreferrer\">Data.Ratio.numerator</a> and <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Ratio.html#v:denominator\" rel=\"nofollow noreferrer\">Data.Ratio.denominator</a> return numerator an denominator of the ratio in <em>reduced form</em> so it is safe to compare denominator to 1 to check if ratio is an integer.</p>\n\n<pre><code>import Data.Ratio\n\neq :: (Num a, Eq a) =&gt; Ratio a -&gt; a -&gt; Bool\neq r i = d == 1 &amp;&amp; n == i \n  where\n    n = numerator r\n    d = denominator r\n\nmain = print $ (8/(3-8%3)) `eq` 24\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1407, "user_id": 1032171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BmTWF.png?s=128&g=1", "display_name": "liuyang1", "link": "https://stackoverflow.com/users/1032171/liuyang1"}, "edited": false, "score": 0, "creation_date": 1550136053, "post_id": 54684848, "comment_id": 96161849, "body": "So how about &quot;Rational&quot; in Haskell numeric class hierarchy? Most this kind of picture just miss the Rational type."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 1407, "user_id": 1032171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BmTWF.png?s=128&g=1", "display_name": "liuyang1", "link": "https://stackoverflow.com/users/1032171/liuyang1"}, "edited": false, "score": 0, "creation_date": 1550142999, "post_id": 54684848, "comment_id": 96165987, "body": "@liuyang1 The pictures normally only show standard prelude types and classes. Rational is not built into the compiler and is not a part of the prelude. It&#39;s just a library type. You can define one (or many) like that yourself."}, {"owner": {"reputation": 1407, "user_id": 1032171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BmTWF.png?s=128&g=1", "display_name": "liuyang1", "link": "https://stackoverflow.com/users/1032171/liuyang1"}, "edited": false, "score": 0, "creation_date": 1550144227, "post_id": 54684848, "comment_id": 96166625, "body": "But I think <code>Rational</code> is part of prelude. Run <code>ghci</code> only with prelude, <code>:t (2&#47;3::Rational)</code>, we get <code>(2&#47;3::Rational) :: Rational</code>. And your demo code also pass even without <code>import Data.Ratio</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 1407, "user_id": 1032171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BmTWF.png?s=128&g=1", "display_name": "liuyang1", "link": "https://stackoverflow.com/users/1032171/liuyang1"}, "edited": false, "score": 0, "creation_date": 1550144491, "post_id": 54684848, "comment_id": 96166766, "body": "Hm yes, sorry, my mistake. It&#39;s in the prelude. Don&#39;t know, then"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1550150645, "post_id": 54684848, "comment_id": 96170344, "body": "<code>Rational</code> isn&#39;t actually a distinct type; it&#39;s an alias for <code>Ratio Integer</code>. And since it&#39;s a type constructor, not a type class, it won&#39;t show up in the class hierarchy."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1550154723, "post_id": 54684848, "comment_id": 96172909, "body": "@chepner Types usually appear in these class hierarchies in some way or another. <a href=\"https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Base-classes.svg/510px-Base-classes.svg.png\" rel=\"nofollow noreferrer\">example</a>. There&#39;s nothing wrong with including either <code>Rational</code> a.k.a. <code>Ratio Integer</code> or <code>Integral a =&gt; Ratio a</code> there. It&#39;s not like these pictures need to adhere to some rigid prescribed form."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 8, "last_activity_date": 1550128268, "last_edit_date": 1550128268, "creation_date": 1550127916, "answer_id": 54684848, "question_id": 54684384, "link": "https://stackoverflow.com/questions/54684384/fractional-type-is-in-haskell/54684848#54684848", "title": "fractional type is in Haskell", "body": "<p>Use an explicit type somewhere in the chain. It will force the entire calculation to be performed with the corrrect type.</p>\n\n<pre><code>import Data.Ratio\n\nmain = do\n    print $ 8/(3-8/3) == 24\n    print $ 8/(3-8/3) == (24 :: Rational)\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>False\nTrue\n</code></pre>\n"}], "owner": {"reputation": 1407, "user_id": 1032171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BmTWF.png?s=128&g=1", "display_name": "liuyang1", "link": "https://stackoverflow.com/users/1032171/liuyang1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 1, "accepted_answer_id": 54684848, "answer_count": 2, "score": 4, "last_activity_date": 1550128268, "creation_date": 1550125630, "last_edit_date": 1550125951, "question_id": 54684384, "link": "https://stackoverflow.com/questions/54684384/fractional-type-is-in-haskell", "title": "fractional type is in Haskell", "body": "<p>I want to use rational number type instead of factional type in Haskell (or float/double type in C)</p>\n\n<p>I get below result:</p>\n\n<pre><code>8/(3-8/3)=23.999...\n8/(3-8/3)/=24\n</code></pre>\n\n<p>I know Data.Ratio. However, it support (+) (-) (*) (/) operation on Data.Ratio:</p>\n\n<pre><code>1%3+3%3 == 4 % 3\n8/(3-8%3) == 24 % 1\n</code></pre>\n\n<p>I had checked in Racket:</p>\n\n<pre><code>(= (/ 8 (- 3 (/ 8 3))) 24)\n#t\n</code></pre>\n\n<p>What's correct way to ensure <code>8/(3-8/3) == 24</code> in Haskell?</p>\n"}, {"tags": ["haskell", "haskell-stack", "hackage"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1550122325, "post_id": 54683702, "comment_id": 96155986, "body": "In my professional opinion, screw stack.  Use cabal (and cabal sandbox if there&#39;s dependency trouble) instead.  <code>cabal install pkcs10</code>."}], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "edited": false, "score": 0, "creation_date": 1550123562, "post_id": 54683937, "comment_id": 96156307, "body": "This worked thanks . I was not aware that the case of the letters could result in a problem ."}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 2, "last_activity_date": 1550123220, "creation_date": 1550123220, "answer_id": 54683937, "question_id": 54683702, "link": "https://stackoverflow.com/questions/54683702/using-hackage-libraries/54683937#54683937", "title": "Using Hackage libraries", "body": "<p>The package name in this case is <code>pkcs10</code>. Add it to your .cabal file into <code>build-depends</code> field. Stack should figure out the rest.</p>\n"}], "owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 54683937, "answer_count": 1, "score": 1, "last_activity_date": 1550123220, "creation_date": 1550121894, "question_id": 54683702, "link": "https://stackoverflow.com/questions/54683702/using-hackage-libraries", "title": "Using Hackage libraries", "body": "<p>I am just starting out with Haskell .I am using stack to build my applcation.\nI am trying to use this library from hackage .\n<a href=\"http://hackage.haskell.org/package/pkcs10-0.2.0.0/docs/Data-X509-PKCS10.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/pkcs10-0.2.0.0/docs/Data-X509-PKCS10.html</a></p>\n\n<p>I am not able to figure out how to include this in the code .\nI tried adding X509 and PKCS10 ,PKCS to my cabal file under build depends ,but that doesnt work .\nWhy do I do to use the functions in this library.\nAny links to a tutorial for this would be great ,I tried looking but could not find any.</p>\n"}, {"tags": ["scala", "haskell", "functional-programming", "typeclass", "scala-cats"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1550119175, "post_id": 54682429, "comment_id": 96155206, "body": "Where did you &quot;punch the signature&quot;?  <a href=\"https://hoogle.haskell.org/?hoogle=(c%20-%3E%20a)%20-%3E%20(b%20-%3E%20d)%20-%3E%20f%20a%20b%20-%3E%20f%20c%20d\" rel=\"nofollow noreferrer\">I found it that way</a>.  Fun fact, there are <a href=\"http://haskell.org/hoogle\" rel=\"nofollow noreferrer\">three</a> <a href=\"https://hoogle.haskell.org\" rel=\"nofollow noreferrer\">different</a> <a href=\"https://www.stackage.org/package/hoogle\" rel=\"nofollow noreferrer\">hoogles</a> and they all give different results!  Only <code>hoogle.haskell.org</code> gives a result for your query. :-/"}], "answers": [{"comments": [{"owner": {"reputation": 1061, "user_id": 2946529, "user_type": "registered", "profile_image": "https://graph.facebook.com/890945556/picture?type=large", "display_name": "Nigel Benns", "link": "https://stackoverflow.com/users/2946529/nigel-benns"}, "edited": false, "score": 0, "creation_date": 1550112844, "post_id": 54682459, "comment_id": 96153876, "body": "Thank you I knew I had heard it before and I just couldn&#39;t remember"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1550119820, "post_id": 54682459, "comment_id": 96155348, "body": "Re profuctorial lenses: Some useful links are <a href=\"http://oleg.fi/gists/posts/2017-04-18-glassery.html\" rel=\"nofollow noreferrer\">oleg.fi/gists/posts/2017-04-18-glassery.html</a> (for pure profunctor lenses) as well as <a href=\"https://artyom.me/lens-over-tea-4\" rel=\"nofollow noreferrer\">artyom.me/lens-over-tea-4</a> and <a href=\"https://artyom.me/lens-over-tea-5\" rel=\"nofollow noreferrer\">artyom.me/lens-over-tea-5</a> (for van Laarhoven lenses). The diagrams in the last one in particular is what made profunctors &#39;click&#39; for me, but they&#39;re all fascinating reads."}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 11, "last_activity_date": 1550112171, "creation_date": 1550112171, "answer_id": 54682459, "question_id": 54682429, "link": "https://stackoverflow.com/questions/54682429/name-of-bi-functor-type-class-with-one-contravariant-and-one-covariant-paramet/54682459#54682459", "title": "Name of Bi - Functor type class with one contravariant and one covariant parameter", "body": "<p>This is called a <em>profunctor</em>! It is a <a href=\"http://blog.sigfpe.com/2011/07/profunctors-in-haskell.html\" rel=\"noreferrer\">very useful type of bifunctor</a> that shows up all over the place (for example, <a href=\"https://arxiv.org/ftp/arxiv/papers/1703/1703.10857.pdf\" rel=\"noreferrer\">in the construction of lenses</a>)! In Haskell it is available as <code>Data.Profunctor</code> in the <code>profunctors</code> package. I am not a Scala person but it looks like it is <a href=\"https://typelevel.org/cats/api/cats/arrow/Profunctor.html\" rel=\"noreferrer\">available</a> in <code>cats</code> as well.</p>\n"}], "owner": {"reputation": 1061, "user_id": 2946529, "user_type": "registered", "profile_image": "https://graph.facebook.com/890945556/picture?type=large", "display_name": "Nigel Benns", "link": "https://stackoverflow.com/users/2946529/nigel-benns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 54682459, "answer_count": 1, "score": 10, "last_activity_date": 1550118715, "creation_date": 1550111901, "last_edit_date": 1550118715, "question_id": 54682429, "link": "https://stackoverflow.com/questions/54682429/name-of-bi-functor-type-class-with-one-contravariant-and-one-covariant-paramet", "title": "Name of Bi - Functor type class with one contravariant and one covariant parameter", "body": "<p>I'm looking to see if there is a standard typeclass for a Bi-Functor that has one Contravariant parameter and one Covariant parameter.</p>\n\n<p>punching the signature <code>(c -&gt; a) -&gt; (b -&gt; d) -&gt; f a b -&gt; f c d</code> results in nothing that matches.</p>\n\n<p>Basically in Scala I'm looking to do:</p>\n\n<pre><code>trait CoContraBiFunctor[F[_, _]] {\n  def ccmap[A, B, C, D](fab: F[A, B])(f: C =&gt; A)(g: B =&gt; D): F[C, D]\n}\n\nimplicit val ccFunction: CoContraBiFunctor[Function1] = new CoContraBiFunctor[Function] {\n  override def ccmap[A, B, C, D](fab: Function[A, B])(f: C =&gt; A)(g: B =&gt; D): Function[C, D] = new Function[C, D] {\n    override def apply(c: C): D = g(fab(f(c)))\n  }\n}\n</code></pre>\n\n<p>Anyone have an idea?  I definitely am not the first person to look for this.</p>\n"}]