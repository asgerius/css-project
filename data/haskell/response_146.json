[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1508975701, "post_id": 46943657, "comment_id": 80834957, "body": "You need  to look at your association list, <code>zip xs ys</code> and find the first element with a key (first element of the tuple) equal to <code>f</code> and return the value (second element of the tuple).  Using a <code>Map</code> will make it conceptually easier and operationally much faster."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1508981360, "post_id": 46943657, "comment_id": 80836271, "body": "Have a lookup at the <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:lookup\" rel=\"nofollow noreferrer\"><code>lookup</code></a> function."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1509010897, "post_id": 46943657, "comment_id": 80848854, "body": "You should consider using a Map data type for this job. Have a look at <a href=\"https://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-Map-Lazy.html\" rel=\"nofollow noreferrer\"><code>Data.Map</code></a>"}], "answers": [{"tags": [], "owner": {"reputation": 1055, "user_id": 593298, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51e634a7316f1a4101f65519d2110cce?s=128&d=identicon&r=PG", "display_name": "keep_learning", "link": "https://stackoverflow.com/users/593298/keep-learning"}, "is_accepted": true, "score": 0, "last_activity_date": 1508984124, "creation_date": 1508984124, "answer_id": 46944815, "question_id": 46943657, "link": "https://stackoverflow.com/questions/46943657/basic-encryption-using-higher-order-functions-in-haskell/46944815#46944815", "title": "Basic encryption using higher order functions in Haskell", "body": "<p>The idea is you search the given character in zipped list, and if it there then return second pair and if not then return the character itself.  </p>\n\n<pre><code>encryptf :: Eq a =&gt; [a] -&gt; [a] -&gt; (a -&gt; a)\nencryptf xs ys = \n   let ret = zip xs ys in\n   \\f -&gt; \n      case lookup f ret of\n       Just c -&gt; c\n       Nothing -&gt; f\n\nencryptString :: (a -&gt; a) -&gt; [a] -&gt; [a]\nencryptString f xs = map f xs\n\n*Main&gt; encryptString (encryptf \"abc\" \"xyz\") \"dcba\"\n\"dzyx\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8834515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/745dbf9d8472040a5fe2ebc112b0007b?s=128&d=identicon&r=PG&f=1", "display_name": "Cody", "link": "https://stackoverflow.com/users/8834515/cody"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 46944815, "answer_count": 1, "score": 0, "last_activity_date": 1508984124, "creation_date": 1508974861, "question_id": 46943657, "link": "https://stackoverflow.com/questions/46943657/basic-encryption-using-higher-order-functions-in-haskell", "title": "Basic encryption using higher order functions in Haskell", "body": "<p>I'm working on a problem that runs along the lines of basic encryption. I'm trying to create a function called <code>encryptf</code> that </p>\n\n<ol>\n<li>takes a list xs of a's</li>\n<li>takes a list ys of a's</li>\n<li>returns a function that maps elements of xs to the corresponding elements of ys and maps everything else to itself.</li>\n</ol>\n\n<p>So far it looks like this: </p>\n\n<pre><code>encryptf :: Eq a =&gt; [a] -&gt; [a] -&gt; (a -&gt; a)\nencryptf xs ys = \\f -&gt; head [d | (c,d) &lt;- (zip xs ys)]\n</code></pre>\n\n<p>Then there's a second function called <code>encryptString</code> that looks like this:</p>\n\n<pre><code>encryptString :: (a -&gt; a) -&gt; [a] -&gt; [a]\nencryptString f xs = map f xs\n</code></pre>\n\n<p>and these functions will be used like this:</p>\n\n<pre><code>encryptString (encryptf \"abc\" \"xyz\") \"dcba\"\n</code></pre>\n\n<p>and that would return <code>\"dzyx\"</code></p>\n\n<p>Now I know that my <code>encryptf</code> function is wrong, because it would change everything to the first element of ys. I'm not sure where to go from here. Any help would be appreciated.</p>\n"}, {"tags": ["image", "haskell", "video", "ffmpeg", "juicy-pixels"], "comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1508978067, "post_id": 46942579, "comment_id": 80835518, "body": "Is there a reason that the <code>imageWriter</code> function from your last question isn&#39;t used here? I&#39;m certain that it uses <code>frameWriter</code> under the hood, so it probably doesn&#39;t affect the question, but using it would mean you don&#39;t need to implement conversion yourself."}, {"owner": {"reputation": 1233, "user_id": 7970829, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OGdYb.png?s=128&g=1", "display_name": "oRole", "link": "https://stackoverflow.com/users/7970829/orole"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 1, "creation_date": 1508999817, "post_id": 46942579, "comment_id": 80841808, "body": "@HTNW As I&#39;m pretty new to Haskell, I saw implementing it by myself as a way to improve my skills. Of course I tried your solution too and it helped me a lot to understand how things work in this case but I thought it would probably be easier for the community to understand what I&#39;m trying to do if I split it up a bit."}], "answers": [{"comments": [{"owner": {"reputation": 1233, "user_id": 7970829, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OGdYb.png?s=128&g=1", "display_name": "oRole", "link": "https://stackoverflow.com/users/7970829/orole"}, "edited": false, "score": 0, "creation_date": 1509012292, "post_id": 46950463, "comment_id": 80849852, "body": "I faced the same error on Windows 10 but downloading a version of zlib1.dll that contains the method inflateValidate and replacing the old one solved it. At least I know now that it runs on Ubuntu if everything else fails. Thanks for your efforts!"}], "tags": [], "owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "is_accepted": false, "score": 2, "last_activity_date": 1509009729, "creation_date": 1509009729, "answer_id": 46950463, "question_id": 46942579, "link": "https://stackoverflow.com/questions/46942579/haskell-converting-multiple-images-into-a-video-file-ffmpeg-lights-framewri/46950463#46950463", "title": "Haskell - Converting multiple images into a video file - ffmpeg-lights&#39; frameWriter-function fails", "body": "<p>I suspect issue you are having has something to do with Windows environment and usage of ffmpeg from Haskell (i.e. ffmpeg-simple)</p>\n\n<p>I was able to successfully compile and run your module on Ubuntu 16.04, although I did get a runtime error from ffmpeg:</p>\n\n<pre><code>$ ./main\n[NULL @ 0x1ea6900] Unable to find a suitable output format for 'foo.avi'\nmain: Couldn't allocate output format context\nCallStack (from HasCallStack):\n  error, called at src/Codec/FFmpeg/Encode.hs:214:17 in ffmpeg-light-\n0.12.0-DYHyy7pUAhZ7WHcd6Y2mLO:Codec.FFmpeg.Encode\n</code></pre>\n\n<p>It seems like the above error can be fixed with some ffmpeg arguments tweaking, but since that is not the issue you are experiencing I decided not to go any further with debugging it.</p>\n\n<p>Just in case my <code>main</code>:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  Right (ImageYA8 img) &lt;- readPng \"foo_ya.png\"\n  saveVideo \"foo.avi\" (replicate 10 img) 10\n</code></pre>\n\n<p>I ran the same thing on Windows 7 64-bit and it seems I was unable to fully satisfy the dependencies.</p>\n\n<p>Compilation and dependency installation done on Windows:</p>\n\n<pre><code>&gt; stack exec -- pacman -Syu\n&gt; stack exec -- pacman -S mingw-w64-x86_64-gtk3\n&gt; stack exec -- pacman -S mingw-w64-x86_64-pkg-config\n&gt; stack exec -- pacman -S mingw-w64-x86_64-ffmpeg\n&gt; stack --install-ghc --resolver lts-9.10 exec --package vector --package JuicyPixels --package ffmpeg-light -- ghc main.hs -O2 -threaded\n&gt; stack exec -- main.exe\n</code></pre>\n\n<p>Results in a popup error when ran in <code>cmd</code> (<code>ps</code> simply exits):</p>\n\n<blockquote>\n  <p>The procedure entry point inflateValidate could not be located in the dynamic link library zlib1.dll</p>\n</blockquote>\n\n<p>I am no expert on development on Windows, so I feel like I am missing something. Hope my attempt will be at least a little bit helpful.</p>\n"}], "owner": {"reputation": 1233, "user_id": 7970829, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OGdYb.png?s=128&g=1", "display_name": "oRole", "link": "https://stackoverflow.com/users/7970829/orole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1509009729, "creation_date": 1508968099, "last_edit_date": 1508972978, "question_id": 46942579, "link": "https://stackoverflow.com/questions/46942579/haskell-converting-multiple-images-into-a-video-file-ffmpeg-lights-framewri", "title": "Haskell - Converting multiple images into a video file - ffmpeg-lights&#39; frameWriter-function fails", "body": "<p><strong>Situation</strong><br/>\nCurrently I am working on an application for image-processing that uses ffmpeg-light to fetch all the frames of a given video-file so that the program afterwards can apply grayscaling, as well as edge detection alogrithms to each of the frames.</p>\n\n<p>With the help of friendly stackoverflowers I was able to set up a method capable of converting several images into one video file using ffmpeg-lights' <code>frameWriter</code> function.</p>\n\n<p><strong>Problem</strong><br/>\nThe application runs fine to the moment it hits the <code>frameWriter</code>function and I don't really know why as there are no errors or exception-messages thrown. (OS: Win 10 64bit)  </p>\n\n<p><strong>What did I try?</strong><br/>\nI tried..<br/>\n- different versions of ffmpeg (from 3.2 to 3.4).<br/>\n- ffmpeg.exe using the command line to test if there are any codecs missing, but any conversion I tried worked.<br/>\n- different EncodingParams-combinations: like.. EncodingParams width height fps (Nothing) (Nothing) \"medium\"<br/></p>\n\n<p><strong>Question</strong><br/>\nUnfortunately, none of above worked and the web lacks on information to that specific case. Maybe I missed something essential (like ghc flags or something) or made a bigger mistake within my code. That is why I have to ask you: Do you have any suggestions/advice for me?</p>\n\n<p><strong>Haskell Packages</strong><br/>\n- ffmpeg-light-0.12.0<br/>\n- JuicyPixels-3.2.8.3<br/></p>\n\n<p><strong>Code</strong><br/></p>\n\n<pre><code>{--------------------------------------------------------------------------------------------\n Applies \"juicyToFFmpeg'\" and \"getFPS\" to a list of images and saves the output-video\n to a user defined location.\n---------------------------------------------------------------------------------------------}     \nsaveVideo :: String -&gt; [Image PixelYA8] -&gt; Int -&gt; IO ()\nsaveVideo path imgs fps = do\n         -- program stops after hitting next line --\n         frame &lt;- frameWriter ep path\n         ------------------------------------------------\n         Prelude.mapM_ (frame . Just) ffmpegImgs \n         frame Nothing\n         where ep = EncodingParams width height fps (Just avCodecIdMpeg4) (Just avPixFmtGray8a) \"medium\"\n               width      = toCInt $ imageWidth  $ head imgs\n               height     = toCInt $ imageHeight $ head imgs\n               ffmpegImgs = juicyToFFmpeg' imgs\n               toCInt x   = fromIntegral x :: CInt\n\n{--------------------------------------------------------------------------------------------\n Converts a single image from JuicyPixel-format to ffmpeg-light-format. \n---------------------------------------------------------------------------------------------}      \njuicyToFFmpeg :: Image PixelYA8 -&gt; (AVPixelFormat, V2 CInt, Vector CUChar)\njuicyToFFmpeg img = (avPixFmtGray8a, V2 (toCInt width) (toCInt height), ffmpegData)\n                  where toCInt   x   = fromIntegral x :: CInt\n                        toCUChar x   = fromIntegral x :: CUChar\n                        width        = imageWidth img\n                        height       = imageHeight img\n                        ffmpegData   = VS.map toCUChar (imageData img)\n\n{--------------------------------------------------------------------------------------------\n Converts a list of images from JuicyPixel-format to ffmpeg-light-format. \n---------------------------------------------------------------------------------------------}                        \njuicyToFFmpeg' :: [Image PixelYA8] -&gt; [(AVPixelFormat, V2 CInt, Vector CUChar)]\njuicyToFFmpeg' imgs = Prelude.foldr (\\i acc -&gt; acc++[juicyToFFmpeg i]) [] imgs\n\n{--------------------------------------------------------------------------------------------\n Simply calculates the FPS for image-to-video conversion.\n -&gt; frame :: (Double, DynamicImage) where Double is a timestamp of when it got extracted \n---------------------------------------------------------------------------------------------}\ngetFPS :: [(Double, DynamicImage)] -&gt; Int\ngetFPS frames = div (ceiling $ lastTimestamp - firstTimestamp) frameCount :: Int\n              where firstTimestamp = fst $ head frames\n                    lastTimestamp  = fst $ last frames\n                    frameCount     = length frames\n</code></pre>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1508961053, "post_id": 46940947, "comment_id": 80829146, "body": "Does <code>traverse sequence</code> work?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1508961062, "post_id": 46940947, "comment_id": 80829155, "body": "With no constraints on <code>g</code> this is impossible. How do you turn <code>g (m a)</code> into <code>m (g a)</code>? It depends on what <code>g</code> is."}, {"owner": {"reputation": 313, "user_id": 3219382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ABhji.jpg?s=128&g=1", "display_name": "chronologos", "link": "https://stackoverflow.com/users/3219382/chronologos"}, "edited": false, "score": 0, "creation_date": 1508961227, "post_id": 46940947, "comment_id": 80829227, "body": "g is actually LEdge from <a href=\"https://hackage.haskell.org/package/fgl-5.6.0.0/docs/Data-Graph-Inductive-Graph.html#t:LEdge\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/fgl-5.6.0.0/docs/&hellip;</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1508962007, "post_id": 46940947, "comment_id": 80829632, "body": "So @Ryan&#39;s suggestion should do the trick, right?"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1508962032, "creation_date": 1508962032, "answer_id": 46941197, "question_id": 46940947, "link": "https://stackoverflow.com/questions/46940947/monadrandom-m-g-m-a-m-g-a/46941197#46941197", "title": "MonadRandom m =&gt; [g (m a)] -&gt; m [g a]", "body": "<p>It's pretty straightforward:</p>\n\n<pre><code>sequenceLEdge :: Functor f =&gt; LEdge (f a) -&gt; f (LEdge a)\nsequenceLEdge (l, r, act) = fmap (\\v -&gt; (l, r, v)) act\n</code></pre>\n\n<p>Probably there should be <code>Foldable</code> and <code>Traversable</code> instances for triples and larger tuples so you don't need to write this by hand, but there aren't for now, so...</p>\n"}], "owner": {"reputation": 313, "user_id": 3219382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ABhji.jpg?s=128&g=1", "display_name": "chronologos", "link": "https://stackoverflow.com/users/3219382/chronologos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 46941197, "answer_count": 1, "score": 1, "last_activity_date": 1508962032, "creation_date": 1508960913, "question_id": 46940947, "link": "https://stackoverflow.com/questions/46940947/monadrandom-m-g-m-a-m-g-a", "title": "MonadRandom m =&gt; [g (m a)] -&gt; m [g a]", "body": "<p><code>g a</code> is a concrete type, I am thinking of doing <code>[g (m a)] -&gt; [m (g a)] -&gt;  m [g a]</code>, and I know the last step can be done with <code>sequence :: Monad m =&gt; t (m a) -&gt; m (t a)</code>. How would I achieve the first step?</p>\n"}, {"tags": ["haskell", "if-statement", "list-comprehension"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1508954641, "post_id": 46939145, "comment_id": 80825516, "body": "Can you explain what <code>0</code> is doing in the head of your list comprehension?"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1508962931, "post_id": 46939145, "comment_id": 80830093, "body": "If not with list comprehensions, you may also do by a monadic way like <code>[1..el] &gt;&gt;= return . bool 0 1 . (index ==)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 7066862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d70972b971aef9aab1a5351bbeb7a75?s=128&d=identicon&r=PG&f=1", "display_name": "David Andvett", "link": "https://stackoverflow.com/users/7066862/david-andvett"}, "edited": false, "score": 0, "creation_date": 1508954757, "post_id": 46939209, "comment_id": 80825575, "body": "that&#39;s interesting, i never thought about looking at it that way.  Thanks!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509402075, "post_id": 46939209, "comment_id": 80997262, "body": "the <a href=\"https://en.wikipedia.org/wiki/Levenshtein_distance\" rel=\"nofollow noreferrer\"><i>smallest</i></a> change would probably be <code>[x | n &lt;- [1..el], x&lt;-[if n == index then 1 else 0]]</code>. :)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1509402358, "post_id": 46939209, "comment_id": 80997358, "body": "@WillNess Touch&#233;!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1508955156, "last_edit_date": 1508955156, "creation_date": 1508954610, "answer_id": 46939209, "question_id": 46939145, "link": "https://stackoverflow.com/questions/46939145/how-can-i-use-conditionals-in-list-comprehension/46939209#46939209", "title": "How can i use conditionals in list comprehension?", "body": "<p>The smallest change that fixes that is</p>\n\n<pre><code>myList el index = [if n == index then 1 else 0 | n &lt;- [1..el]]\n</code></pre>\n\n<p>Note that what's at the <em>left</em> of <code>|</code> is what generates the list elements. A list comprehension of the form <code>[ 0 | ...]</code> will only generate zeros, and the <code>...</code> part only decides how long is the resulting list.</p>\n\n<p>Further, in your code the compiler complains because at the <em>right</em> of <code>|</code> we allow only generators (e.g. <code>n &lt;- someList</code>), conditions (e.g. <code>x &gt; 23</code>), or new definitions (<code>let y = ...</code>). In your code the <code>if ...</code> is interpreted to be a condition, and for that it should evaluate to a boolean, but <code>then 1</code> makes the result a number, triggering a type error.</p>\n\n<p>Another solution could be</p>\n\n<pre><code>myList el index = replicate (index-1) 0 ++ [1] ++ replicate (el-index) 0\n</code></pre>\n\n<p>where <code>replicate m 0</code> generates a list with <code>m</code> zeros, and <code>++</code> concatenates.</p>\n\n<p>Finally, note that your <code>index</code> is 1-based. In many programming languages, that's unconventional, since 0-based indexing is more frequently used.</p>\n"}], "owner": {"reputation": 123, "user_id": 7066862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d70972b971aef9aab1a5351bbeb7a75?s=128&d=identicon&r=PG&f=1", "display_name": "David Andvett", "link": "https://stackoverflow.com/users/7066862/david-andvett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508966838, "creation_date": 1508954393, "last_edit_date": 1508966838, "question_id": 46939145, "link": "https://stackoverflow.com/questions/46939145/how-can-i-use-conditionals-in-list-comprehension", "title": "How can i use conditionals in list comprehension?", "body": "<p>I am trying to build a list of 0's using list comprehension.  But i also want to make an index 1 where i choose in the list.  For example myList 5 2 = [0,1,0,0,0] where 5 is the number of elements and 2 is the index.</p>\n\n<pre><code>myList el index = [0 | n &lt;- [1..el], if n == index then 1 else 0]\n</code></pre>\n\n<p>but this results in an error.</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 4, "creation_date": 1508951082, "post_id": 46938118, "comment_id": 80823488, "body": "If <code>x</code> and <code>y</code> are floats then <code>[x,y]</code> is a list of floats.  The function <code>makeList</code> must have a result type of <code>[Float]</code>  but wait, there&#39;s more!  Another definition of <code>makeList</code> results in <code>[makeList p1, makelist p2]</code> so now makelist must have a result type of <code>[[Float]]</code> (and this reasoning can grow till we end up with an infinite nesting of lists). Which is correct?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1508952047, "post_id": 46938118, "comment_id": 80824020, "body": "Why do you need to reduce your well-defined shapes to generic lists in the first place? Your current attempt, for example, loses the distinction between a rectangle and a line."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1508954059, "post_id": 46938118, "comment_id": 80825189, "body": "Note that <code>makeList</code> can not be assigned any type -- it is a function taking arguments of different types. You should reconsider your design. It is usually better to write the intended type before writing the function definition."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1508951945, "post_id": 46938312, "comment_id": 80823964, "body": "This answer is incomplete. If that&#39;s intentional, you should reference that fact and explain why, and if not, well, try implementing your fix and check with GHC that it actually works."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1508951966, "post_id": 46938312, "comment_id": 80823978, "body": "More usefully, a <code>Point</code> and a <code>Vector</code> should probably be represented as singleton lists to be consistent with the other values. <code>makeList (Point x y) = [[x,y]]</code>."}, {"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 0, "creation_date": 1508952167, "post_id": 46938312, "comment_id": 80824104, "body": "Thank you! In the meantime, I&#39;ve gotten around it with makeList x = map read (drop 1 (words (show x)))"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 2, "creation_date": 1509021139, "post_id": 46938312, "comment_id": 80855829, "body": "waaaaaaaaaaaaat"}], "tags": [], "owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "is_accepted": true, "score": 1, "last_activity_date": 1508951458, "creation_date": 1508951458, "answer_id": 46938312, "question_id": 46938118, "link": "https://stackoverflow.com/questions/46938118/why-does-this-program-create-an-error/46938312#46938312", "title": "Why does this program create an error?", "body": "<p>Your function <code>makeList</code> has different types for the cases:</p>\n\n<ul>\n<li><code>makeList (Point x y)</code> has type <code>[Float]</code></li>\n<li><code>makeList (Line p1 p2)</code> has type <code>[[Float]]</code></li>\n</ul>\n\n<p>You may want to use <code>concat</code> to convert a list of list into a simple list.</p>\n"}], "owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 46938312, "answer_count": 1, "score": -1, "last_activity_date": 1509021018, "creation_date": 1508950822, "last_edit_date": 1509021018, "question_id": 46938118, "link": "https://stackoverflow.com/questions/46938118/why-does-this-program-create-an-error", "title": "Why does this program create an error?", "body": "<p>I was trying out Haskell and did this:</p>\n\n<pre><code>data Point  = Point Float Float            deriving (Show)\ndata Vector = Vector Float Float           deriving (Show)\ndata Line   = Line Point Point             deriving (Show)\ndata Rect   = Rect Point Point             deriving (Show)\ndata QGon   = QGon Point Point Point Point deriving (Show)\ndata Circle = Circle Point Float           deriving (Show)\n\nmakeList (Point x y)        = [ x, y ]\nmakeList (Vector x y)       = [ x, y ]\nmakeList (Line p1 p2)       = [ makeList p1, makeList p2 ]\nmakeList (Rect p1 p2)       = [ makeList p1, makeList p2 ]\nmakeList (QGon p1 p2 p3 p4) = [ makeList p1, makeList p2\n                              , makeList p3, makeList p4 ]\n</code></pre>\n\n<p>It produced an error saying that:</p>\n\n<pre><code>Couldn't match type \u2018[Float]\u2019 with \u2018Float\u2019\n    Expected type: Point -&gt; Float\n      Actual type: Point -&gt; [Float]\n  |\n8 | makeList (Point x y)  = [ x, y ]\n</code></pre>\n\n<p>Unfortunately, I can't get hold of the meaning of this.</p>\n"}, {"tags": ["performance", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1508937870, "post_id": 46933258, "comment_id": 80814257, "body": "A list in Haskell is a linked list, so if you want random access in O(1), you probably want to use an array."}, {"owner": {"reputation": 7113, "user_id": 653152, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/HoFfR.jpg?s=128&g=1", "display_name": "Martin Ueding", "link": "https://stackoverflow.com/users/653152/martin-ueding"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1508937930, "post_id": 46933258, "comment_id": 80814303, "body": "@WillemVanOnsem: Oh, I did not know about that! Looking at <a href=\"https://hackage.haskell.org/package/array-0.5.2.0/docs/Data-Array.html\" rel=\"nofollow noreferrer\">Data.Array</a>, it seems to be perfect, it even allows for incremental updates. I&#39;ll update my program and then I&#39;ll report how it goes."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1508937971, "post_id": 46933258, "comment_id": 80814338, "body": "@MartinUeding <code>vector</code> is also handy. See <a href=\"https://stackoverflow.com/questions/9611904/haskell-lists-arrays-vectors-sequences\" title=\"haskell lists arrays vectors sequences\">stackoverflow.com/questions/9611904/&hellip;</a>"}, {"owner": {"reputation": 7113, "user_id": 653152, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/HoFfR.jpg?s=128&g=1", "display_name": "Martin Ueding", "link": "https://stackoverflow.com/users/653152/martin-ueding"}, "edited": false, "score": 0, "creation_date": 1508938944, "post_id": 46933258, "comment_id": 80815039, "body": "With <code>Data.Array</code> instead of <code>[]</code>, the program now needs 10 instead of 17 seconds. The array indexing now takes a lot less of the total time as well. In the C++ implementation my colleague is bound by the random number generator, though he uses Ranlux and I perhaps a linear congruental one? Still it appears more than a factor 10 slower than the C++ implementation, is that normal?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1508939919, "post_id": 46933258, "comment_id": 80815854, "body": "@MartinUeding did you measure the ten seconds in <code>-O2</code> without <code>-prof</code>? Or with <code>-prof</code>? Keep in mind that profiling will make your application slower (usually factor 2-3). I get 5s in your list version (<code>-O2</code>), and 12 seconds if I enable profiling. That being said, the <code>random</code> number generator is slow."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1508950714, "post_id": 46933258, "comment_id": 80823281, "body": "As I commented in @leftaroundabout&#39;s answer, I get ~6 seconds with lists and ~0.01 seconds with unboxed vectors.  N.B. The whole &quot;use a noop IO to force the spine of a list&quot;  method is suspect when it comes to benchmarking."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1508974555, "post_id": 46933258, "comment_id": 80834650, "body": "Sounds like it might be time for <a href=\"http://blog.sigfpe.com/2006/12/evaluating-cellular-automata-is.html\" rel=\"nofollow noreferrer\">comonads</a>!  (Maybe, I don&#39;t really know this algorithm, but it rang a bell.)"}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1508950540, "post_id": 46934141, "comment_id": 80823205, "body": "Using GHC  8.2.1 and <code>-O2</code>:  <code>time .&#47;martin-orig &gt;&#47;dev&#47;null</code> yields <code>5.744 total</code> while <code>time .&#47;martin-vector &gt;&#47;dev&#47;null</code> yields <code>0.019 total</code>"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 9, "last_activity_date": 1508941602, "last_edit_date": 1508941602, "creation_date": 1508939154, "answer_id": 46934141, "question_id": 46933258, "link": "https://stackoverflow.com/questions/46933258/random-access-performance-on-a-1d-haskell-list/46934141#46934141", "title": "Random access performance on a 1D Haskell list", "body": "<p>You can always use <a href=\"http://hackage.haskell.org/package/vector-0.12.0.1/docs/Data-Vector-Unboxed.html\" rel=\"noreferrer\"><code>Data.Vector.Unboxed</code></a>, which is basically the same as <code>std::vector</code>. It has very fast random access, however it doesn't really allow purely-functional updates<sup>\u2020</sup>. You can still do such updates by working in the <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Monad-ST.html\" rel=\"noreferrer\"><code>ST</code> monad</a>, and indeed that's probably the solution that would give you the best performance, but it's not really Haskell-idiomatic.</p>\n\n<p>Better: use a functional structure that allows both lookup and update and log(<em>n</em>)-ish time; this is typical for tree-based structures. <a href=\"http://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-IntMap-Lazy.html#t:IntMap\" rel=\"noreferrer\"><code>IntMap</code></a> should work pretty well.</p>\n\n<p>I wouldn't recommend that either though. Generally, in Haskell you want to <strong>avoid juggling any indices at all</strong>. As you say, algorithms like Metropolis are actually based on a <em>stencil</em>. The operation on each spin shouldn't <em>ever need to see more than its direct neighbours</em>, so it's best to structure your program accordingly.</p>\n\n<p>Even on a simple list, it's easy to achieve efficient access to the direct neighbours: implement</p>\n\n<pre><code>neighboursInList :: [a] -&gt; [(a, (Maybe a, Maybe a))]\n</code></pre>\n\n<p>the actual algorithm is then just a <code>map</code> over these local-environments.</p>\n\n<p>For the periodic case, you should actually make it something like</p>\n\n<pre><code>data Lattice a = Lattice\n     { latticeNodes :: [a]\n     , latticeLength :: Int }\n   deriving (Functor)\n\ndata NodeInLattice a = NodeInLattice\n     { thisNode :: a\n     , xPrev, xNext, yPrev, yNext :: a }\n   deriving (Functor)\n\nneighboursInLattice :: Lattice a -&gt; Lattice (NodeInLattice a)\n</code></pre>\n\n<p>Such an approach has many advantages:</p>\n\n<ul>\n<li>Impossible to make indexing mistakes.</li>\n<li>You don't rely on fast random-access.</li>\n<li>It can be well parallelised. For instance, the <a href=\"http://hackage.haskell.org/package/repa-3.4.1.3/docs/Data-Array-Repa-Stencil.html\" rel=\"noreferrer\">repa library</a> has stencil support built in. And all code that runs on supercomputers <em>must</em> use something like that, because accessing random elements that lie on another node in the cluster is way, <em>way</em> slower than accessing the processor's own node memory.</li>\n</ul>\n\n<hr>\n\n<p><sup>\u2020</sup><sub>To pure-functionally update a vector, you need to make a complete copy.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 3, "last_activity_date": 1508972921, "last_edit_date": 1508972921, "creation_date": 1508972016, "answer_id": 46943239, "question_id": 46933258, "link": "https://stackoverflow.com/questions/46933258/random-access-performance-on-a-1d-haskell-list/46943239#46943239", "title": "Random access performance on a 1D Haskell list", "body": "<p>With profiling turned off, your original version runs in about 5 seconds on my laptop.</p>\n\n<p>Converting the code to use an immutable, unboxed vector (from <code>Data.Vector.Unboxed</code>) is a straightforward modification and reduces the run time to about 1.8 seconds.  Profiling that version shows that the time is dominated by the very slow <code>System.Random</code> generator.</p>\n\n<p>Using a custom generator based on the <code>random-mersenne-pure64</code> package, I can get the run time down to about 0.32 seconds.  Using a linear congruential generator brings the time down to 0.22 seconds.</p>\n\n<p>Re-profiling, the bottleneck appears to be bounds checking on vector operations, so replacing those with their \"unsafe\" counterparts gets the run time down to about 0.17 seconds.</p>\n\n<p>At this point, converting to a mutable, unboxed vector (which is a more involved modification than before) didn't appreciably improve performance, but I didn't work very hard on optimizing it.  (I've seen other algorithms that benefited enormously from using mutable vectors.)</p>\n\n<p>My final code for the LCG version follows.  I tried to keep as much of your original code as was reasonable.  </p>\n\n<p>The one annoying bit is the necessity of specifying the <code>extentBits</code> for the random index generation, and note that the algorithm will be most efficient if the extent is a power of two (because <code>randomIndex</code> generates indexes using the given number of <code>extentBits</code>, and it re-tries until the index is less than <code>extent</code>).</p>\n\n<p>Note that I decided to print the number of <code>True</code>s in the final lattice instead of using a <code>dummy</code> call, since it's a little more reliable for benchmarking.</p>\n\n<pre><code>import Data.Bits ((.&amp;.), shiftL)\nimport Data.Word\nimport qualified Data.Vector as V\n\ntype Spin = Bool\ntype Lattice = V.Vector Spin\n\n-- Lattice extent is fixed to a square.\nextent, extentBits, volume :: Int\nextent = 30\nextentBits = 5  -- no of bits s.t. 2**5 &gt;= 30\nvolume = extent * extent\n\ntemperature :: Double\ntemperature = 0.0\n\n-- Converts a `Spin` into `+1` or `-1`.\nspin :: Spin -&gt; Int\nspin True = 1\nspin False = (-1)\n\n-- Wrap a coordinate for periodic boundary conditions.\nwrap :: Int -&gt; Int\nwrap = flip mod $ extent\n\n-- Converts an unbounded (x,y) index into a linearized index with periodic\n-- boundary conditions.\nindex :: Int -&gt; Int -&gt; Int\nindex x y = wrap x + wrap y * extent\n\n-- Retrieve a single element from the lattice, automatically performing\n-- periodic boundary conditions.\nget :: Lattice -&gt; Int -&gt; Int -&gt; Spin\nget l x y = l `V.unsafeIndex` index x y\n\n-- Toggle the spin of an element\ntoggle :: Lattice -&gt; Int -&gt; Int -&gt; Lattice\ntoggle l x y = l `V.unsafeUpd` [(i, not (l `V.unsafeIndex` i))] -- flip bit at index i\n  where i = index x y\n\n-- Computes the sum of neighboring spins.\nneighborSum :: Lattice -&gt; Int -&gt; Int -&gt; Int\nneighborSum l x y = sum $ map spin $ map (uncurry (get l)) neighbors\n    where\n        neighbors = [(x+1,y), (x-1,y), (x,y+1), (x,y-1)]\n\n-- Computes the energy difference at a certain lattice site if it would be\n-- flipped.\nenergy :: Lattice -&gt; Int -&gt; Int -&gt; Int\nenergy l x y = 2 * neighborSum l x y * spin (get l x y)\n\n-- Populates a lattice given a random seed.\ninitLattice :: Int -&gt; (Lattice,MyGen)\ninitLattice s = (l, rng')\n    where\n        rng = newMyGen s\n        (allRandom, rng') = go [] rng volume\n        go out r 0 = (out, r)\n        go out r n = let (a,r') = randBool r\n                     in go (a:out) r' (n-1)\n\n        l = V.fromList allRandom\n\n-- Performs a single Metropolis update at the given lattice site.\nupdate :: (Lattice, MyGen) -&gt; Int -&gt; Int -&gt; (Lattice, MyGen)\nupdate (l, rng) x y\n  | doUpdate = (toggle l x y, rng')\n  | otherwise = (l, rng')\n    where\n        doUpdate = (shift &lt; 0) || (exp (- fromIntegral shift / temperature) &gt; r)\n        shift = energy l x y\n        (r, rng') = randDouble rng\n\n-- A full sweep through the lattice.\ndoSweep :: (Lattice, MyGen) -&gt; (Lattice, MyGen)\ndoSweep (l, rng) = iterate updateRand (l, rng) !! (extent * extent)\n\nupdateRand :: (Lattice, MyGen) -&gt; (Lattice, MyGen)\nupdateRand (l, rng)\n  = let (x, rng') = randIndex rng\n        (y, rng'') = randIndex rng'\n    in  update (l, rng'') x y\n\n-- Creates a random lattice and performs five sweeps.\nmain :: IO ()\nmain = do let lrngs = iterate doSweep (initLattice 2)\n              l = fst (lrngs !! 1000)\n          print $ V.length (V.filter id l)  -- count the Trues\n\n-- * Random number generation\n\ndata MyGen = MyGen Word32\n\nnewMyGen :: Int -&gt; MyGen\nnewMyGen = MyGen . fromIntegral\n\n-- | Get a (positive) integer with given number of bits.\nrandInt :: Int -&gt; MyGen -&gt; (Int, MyGen)\nrandInt bits (MyGen s) =\n  let s' = 1664525 * s + 1013904223\n      mask = (1 `shiftL` bits) - 1\n  in  (fromIntegral (s' .&amp;. mask), MyGen s')\n\n-- | Random Bool value\nrandBool :: MyGen -&gt; (Bool, MyGen)\nrandBool g = let (i, g') = randInt 1 g\n             in  (if i==1 then True else False, g')\n\n-- | Random index\nrandIndex :: MyGen -&gt; (Int, MyGen)\nrandIndex g = let (i, g') = randInt extentBits g\n              in if i &gt;= extent then randIndex g' else (i, g')\n\n-- | Random [0,1]\nrandDouble :: MyGen -&gt; (Double, MyGen)\nrandDouble rng = let (ri, rng') = randInt 32 rng\n                 in (fromIntegral ri / (2**32), rng')\n</code></pre>\n\n<p>If you prefer to use the MT generator, you can modify the imports and replace a few definitions as below.  Note that I didn't work too hard on testing <code>randInt</code>, so I'm not 100% sure it's 100% correct with all the bit twiddling that's going on there.</p>\n\n<pre><code>import Data.Bits ((.|.), shiftL, shiftR, xor)\nimport Data.Word\nimport qualified Data.Vector as V\nimport System.Random.Mersenne.Pure64\n\n-- replace these definitions:\n\n-- | Mersenne-Twister generator w/ pool of bits\ndata MyGen = MyGen PureMT !Int !Word64 !Int !Word64\n\nnewMyGen :: Int -&gt; MyGen\nnewMyGen seed = MyGen (pureMT (fromIntegral seed)) 0 0 0 0\n\n-- | Split w into bottom n bits and rest\nsplitBits :: Int -&gt; Word64 -&gt; (Word64, Word64)\nsplitBits n w =\n  let w2 = w `shiftR` n             -- top 64-n bits\n      w1 = (w2 `shiftL` n) `xor` w  -- bottom n bits\n  in (w1, w2)\n\n-- | Get a (positive) integer with given number of bits.\nrandInt :: Int -&gt; MyGen -&gt; (Int, MyGen)\nrandInt bits (MyGen p lft1 w1 lft2 w2)\n  -- generate at least 64 bits\n  | let lft = lft1 + lft2, lft &lt; 64\n  = let w1' = w1 .|. (w2 `shiftL` lft1)\n        (w2', p') = randomWord64 p\n    in randInt bits (MyGen p' lft w1' 64 w2')\n  | bits &gt; 64 = error \"randInt has max of 64 bits\"\n  -- if not enough bits in first word, get needed bits from second\n  | bits &gt; lft1\n  = let needed = bits - lft1\n        (bts, w2') = splitBits needed w2\n        out = (w1 `shiftL` needed) .|. bts\n    in (fromIntegral out, MyGen p (lft2 - needed) w2' 0 0)\n  -- otherwise, just take enough bits from first word\n  | otherwise\n  = let (out, w1') = splitBits bits w1\n    in (fromIntegral out, MyGen p (lft1 - bits) w1' lft2 w2)\n</code></pre>\n"}], "owner": {"reputation": 7113, "user_id": 653152, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/HoFfR.jpg?s=128&g=1", "display_name": "Martin Ueding", "link": "https://stackoverflow.com/users/653152/martin-ueding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 2, "accepted_answer_id": 46934141, "answer_count": 2, "score": 4, "last_activity_date": 1562858808, "creation_date": 1508936668, "question_id": 46933258, "link": "https://stackoverflow.com/questions/46933258/random-access-performance-on-a-1d-haskell-list", "title": "Random access performance on a 1D Haskell list", "body": "<p>I have a Haskell program which simulates the Ising  model with the Metropolis\nalgorithm. The main operation is a stencil operation that takes the sum of next\nneighbors in 2D and then multiplies that with the center element. Then the\nelement is perhaps updated.</p>\n\n<p>In C++, where I get decent performance, I use a 1D array and then linearize the\naccess to it with simple index arithmetics. In the past months I have picked up Haskell to broaden my horizon and also tried to implement the Ising model there. The data structure is just a list of <code>Bool</code>:</p>\n\n<pre><code>type Spin = Bool\ntype Lattice = [Spin]\n</code></pre>\n\n<p>Then I have some fixed extent:</p>\n\n<pre><code>extent = 30\n</code></pre>\n\n<p>And a <code>get</code> function which retrieves a particular lattice site, including periodic boundary conditions:</p>\n\n<pre><code>-- Wrap a coordinate for periodic boundary conditions.\nwrap :: Int -&gt; Int\nwrap = flip mod $ extent\n\n-- Converts an unbounded (x,y) index into a linearized index with periodic\n-- boundary conditions.\nindex :: Int -&gt; Int -&gt; Int\nindex x y = wrap x + wrap y * extent\n\n-- Retrieve a single element from the lattice, automatically performing\n-- periodic boundary conditions.\nget :: Lattice -&gt; Int -&gt; Int -&gt; Spin\nget l x y = l !! index x y\n</code></pre>\n\n<p>I use the same thing in C++ and there it works fine, though I know that the\n<code>std::vector</code> guarantees me fast random access.</p>\n\n<p>While profiling, I found that the <code>get</code> function takes up a significant amount\nof computing time:</p>\n\n<pre><code>COST CENTRE                        MODULE                SRC                       no.     entries  %time %alloc   %time %alloc\n\n         get                       Main                  ising.hs:36:1-26          153     899100    8.3    0.4     9.2    1.9\n          index                    Main                  ising.hs:31:1-36          154     899100    0.5    1.2     0.9    1.5\n           wrap                    Main                  ising.hs:26:1-24          155          0    0.4    0.4     0.4    0.4\n         neighborSum               Main                  ising.hs:(40,1)-(43,56)   133     899100    4.9   16.6    46.6   25.3\n          spin                     Main                  ising.hs:(21,1)-(22,17)   135    3596400    0.5    0.4     0.5    0.4\n          neighborSum.neighbors    Main                  ising.hs:43:9-56          134     899100    0.9    0.7     0.9    0.7\n          neighborSum.retriever    Main                  ising.hs:42:9-40          136     899100    0.4    0.0    40.2    7.6\n           neighborSum.retriever.\\ Main                  ising.hs:42:32-40         137    3596400    0.2    0.0    39.8    7.6\n            get                    Main                  ising.hs:36:1-26          138    3596400   33.7    1.4    39.6    7.6\n             index                 Main                  ising.hs:31:1-36          139    3596400    3.1    4.7     5.9    6.1\n              wrap                 Main                  ising.hs:26:1-24          141          0    2.7    1.4     2.7    1.4\n</code></pre>\n\n<p>I have read that the Haskell list is only good when one pushes/pops elements at the front, so performance is only given when one uses it as a stack.</p>\n\n<p>When I \u201cupdate\u201d the lattice, I use <code>splitAt</code> and then <code>++</code> to return a new list which has the one element changed.</p>\n\n<p>Is there something relatively straightforward that I can do do improve the random access performance?</p>\n\n<hr>\n\n<p>The full code is here:</p>\n\n<pre><code>-- Copyright \u00a9 2017 Martin Ueding &lt;dev@martin-ueding.de&gt;\n\n-- Ising model with the Metropolis algorithm. Random choice of lattice site for\n-- a spin flip.\n\nimport qualified Data.Text\nimport System.Random\n\ntype Spin = Bool\ntype Lattice = [Spin]\n\n-- Lattice extent is fixed to a square.\nextent = 30\nvolume = extent * extent\n\ntemperature :: Double\ntemperature = 0.0\n\n-- Converts a `Spin` into `+1` or `-1`.\nspin :: Spin -&gt; Int\nspin True = 1\nspin False = (-1)\n\n-- Wrap a coordinate for periodic boundary conditions.\nwrap :: Int -&gt; Int\nwrap = flip mod $ extent\n\n-- Converts an unbounded (x,y) index into a linearized index with periodic\n-- boundary conditions.\nindex :: Int -&gt; Int -&gt; Int\nindex x y = wrap x + wrap y * extent\n\n-- Retrieve a single element from the lattice, automatically performing\n-- periodic boundary conditions.\nget :: Lattice -&gt; Int -&gt; Int -&gt; Spin\nget l x y = l !! index x y\n\n-- Computes the sum of neighboring spings.\nneighborSum :: Lattice -&gt; Int -&gt; Int -&gt; Int\nneighborSum l x y = sum $ map spin $ map retriever neighbors\n    where\n        retriever = \\(x, y) -&gt; get l x y\n        neighbors = [(x+1,y), (x-1,y), (x,y+1), (x,y-1)]\n\n-- Computes the energy difference at a certain lattice site if it would be\n-- flipped.\nenergy :: Lattice -&gt; Int -&gt; Int -&gt; Int\nenergy l x y = 2 * neighborSum l x y * (spin (get l x y))\n\n-- Converts a full lattice into a textual representation.\nlatticeToString l = unlines lines\n    where\n        spinToChar :: Spin -&gt; String\n        spinToChar True = \"#\"\n        spinToChar False = \".\"\n\n        line :: String\n        line = concat $ map spinToChar l\n\n        lines :: [String]\n        lines = map Data.Text.unpack $ Data.Text.chunksOf extent $ Data.Text.pack line\n\n-- Populates a lattice given a random seed.\ninitLattice :: Int -&gt; (Lattice,StdGen)\ninitLattice s = (l,rng)\n    where\n        rng = mkStdGen s\n\n        allRandom :: Lattice\n        allRandom = randoms rng\n\n        l = take volume allRandom\n\n-- Performs a single Metropolis update at the given lattice site.\nupdate (l,rng) x y\n    | doUpdate = (l',rng')\n    | otherwise = (l,rng')\n    where\n        shift = energy l x y\n\n        r :: Double\n        (r,rng') = random rng\n\n        doUpdate :: Bool\n        doUpdate = (shift &lt; 0) || (exp (- fromIntegral shift / temperature) &gt; r)\n\n        i = index x y\n        (a,b) = splitAt i l\n        l' = a ++ [not $ head b] ++ tail b\n\n-- A full sweep through the lattice.\ndoSweep (l,rng) = doSweep' (l,rng) (extent * extent)\n\n-- Implementation that does the needed number of sweeps at a random lattice\n-- site.\ndoSweep' (l,rng) 0 = (l,rng)\ndoSweep' (l,rng) i = doSweep' (update (l,rng'') x y) (i - 1)\n    where\n        x :: Int\n        (x,rng') = random rng\n\n        y :: Int\n        (y,rng'') = random rng'\n\n-- Creates an IO action that prints the lattice to the screen.\nprintLattice :: (Lattice,StdGen) -&gt; IO ()\nprintLattice (l,rng) = do\n    putStrLn \"\"\n    putStr $ latticeToString l\n\ndummy :: (Lattice,StdGen) -&gt; IO ()\ndummy (l,rng) = do\n    putStr \".\"\n\n-- Creates a random lattice and performs five sweeps.\nmain = do\n    let lrngs = iterate doSweep $ initLattice 2\n    mapM_ dummy $ take 1000 lrngs\n</code></pre>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1508936304, "post_id": 46933108, "comment_id": 80813109, "body": "What do you mean? The first argument has signature <code>(a -&gt; m b)</code> so you can not <i>unwrap</i> the <code>b</code> out of <code>m b</code>."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1508936517, "post_id": 46933108, "comment_id": 80813268, "body": "Why <code>m (t b)</code> not only <code>m b</code>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1508936575, "post_id": 46933108, "comment_id": 80813311, "body": "Because you map some sort of &quot;collection&quot; of <code>a</code>s to a collection of <code>b</code>s."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 10, "creation_date": 1508936640, "post_id": 46933108, "comment_id": 80813364, "body": "There can be many <code>a</code>s within a <code>t a</code> and therefore many <code>m b</code>s produced by <code>mapM</code> so which <code>b</code> do you want in the result? <code>mapM</code> gives you a <code>t b</code> with the same shape as the input <code>t a</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1508938735, "post_id": 46933108, "comment_id": 80814886, "body": "If <code>t</code> is <code>[]</code>, you get back a list wrapped in the monad. If <code>t</code> is <code>Maybe</code>, you get back a <code>Maybe</code> value wrapped in the monad."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 1, "creation_date": 1508944507, "post_id": 46933108, "comment_id": 80819353, "body": "In the second comment you ask about one thing but your question is about another. What do you ask exactly?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1508954446, "post_id": 46933108, "comment_id": 80825416, "body": "Do you know what a traversable type is?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1508974001, "post_id": 46933108, "comment_id": 80834504, "body": "<code>mapM</code> is kind of old-fashioned; most people these days use <code>traverse</code>. The idea is that if I have a container full of values of type <code>a</code>, and a function <code>f :: a -&gt; m b</code> that lets me &quot;do something&quot; with a value of type <code>a</code> to produce a value of type <code>b</code>, then I can use <code>traverse f</code> to &quot;do something&quot; with each element of the container and produce a container containing all of the results."}], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 3, "last_activity_date": 1509006191, "last_edit_date": 1509006191, "creation_date": 1509003339, "answer_id": 46948344, "question_id": 46933108, "link": "https://stackoverflow.com/questions/46933108/advantage-of-wrapping-in-monad/46948344#46948344", "title": "Advantage of wrapping in monad", "body": "<p>I think, it is not about a power, but usefulness.</p>\n\n<p>You could use <code>map</code> over some <code>action :: a -&gt; m b</code>, but then you'd get a <code>[m b]</code> (if we forget about a <code>Traversable</code> for a moment). The <code>mapM</code> does basically the same, but also converts <code>[m b]</code> into <code>m [b]</code> by performing each action sequentially and collecting results. The last operation is called <code>sequence</code>, BTW.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509006191, "creation_date": 1508936229, "question_id": 46933108, "link": "https://stackoverflow.com/questions/46933108/advantage-of-wrapping-in-monad", "title": "Advantage of wrapping in monad", "body": "<p>Look at <code>mapM</code> function: </p>\n\n<pre><code>class (Functor t, Foldable t) =&gt; Traversable (t :: * -&gt; *) where\n  ...\n  mapM :: Monad m =&gt; (a -&gt; m b) -&gt; t a -&gt; m (t b)\n</code></pre>\n\n<p>As you can see, the result is in the monad context.<br>\nWhat is the sense, that <code>t b</code> get wrapped in the monad? What kind of power do I get of that?</p>\n"}, {"tags": ["haskell", "monad-transformers"], "comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1508932703, "post_id": 46931455, "comment_id": 80810387, "body": "This is a good use case for <code>ether</code> package. Check the tutorial here: <a href=\"https://int-index.github.io/ether/\" rel=\"nofollow noreferrer\">int-index.github.io/ether</a>"}, {"owner": {"reputation": 15219, "user_id": 91522, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5de8b254c711059975670fba5ec10ab1?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/91522/eric"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1508933130, "post_id": 46931455, "comment_id": 80810691, "body": "Thanks I just discovered it today and is on my reading list :-)"}, {"owner": {"reputation": 15219, "user_id": 91522, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5de8b254c711059975670fba5ec10ab1?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/91522/eric"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1508969380, "post_id": 46931455, "comment_id": 80833051, "body": "Now that I think about it, I&#39;m not sure this solves my issue. I can indeed use <code>ether</code> to have different constraints, <code>MonadExcept&#39; e1</code> and <code>MonadExcept&#39; e2</code> but I still can&#39;t remove one constraint and by providing a function <code>e1 -&gt; e2</code> and have the resulting constraint being <code>MonadExcept e2</code>."}, {"owner": {"reputation": 15219, "user_id": 91522, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5de8b254c711059975670fba5ec10ab1?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/91522/eric"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1508997078, "post_id": 46931455, "comment_id": 80840484, "body": "More reading leads me to think that what I want to do is actually not possible, <code>MonadError e</code> is a trap and once in a type signature, the <code>e</code> has to bubble up to the top. So the answer seems to be: &quot;use <code>ExceptT</code> if you want to transform errors&quot;."}, {"owner": {"reputation": 15219, "user_id": 91522, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5de8b254c711059975670fba5ec10ab1?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/91522/eric"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1509000406, "post_id": 46931455, "comment_id": 80842160, "body": "Oh dear I have so many questions on that topic... Would that be possible to use lenses for the error type? <code>function1 :: (MonadError e m, MonadIO m, Has String e) -&gt; m Int</code>"}], "answers": [{"comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1509017142, "post_id": 46947134, "comment_id": 80853055, "body": "In Haskell you can do everything. But it doesn&#39;t mean that you should. For example, it&#39;s a bad practice to combine <code>ExceptT</code> and <code>IO</code>. If I want to use <code>MonadError</code> with several exceptions I would create one ADT with constructor for each kind of exception. Pattern with <code>Has</code> is not really useful for <code>MonadError</code> because you don&#39;t want to extract part of exception usually, you want to extract part of some complex configuration. That&#39;s why lenses are usually used with <code>Reader</code> or <code>State</code>."}, {"owner": {"reputation": 15219, "user_id": 91522, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5de8b254c711059975670fba5ec10ab1?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/91522/eric"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1509018111, "post_id": 46947134, "comment_id": 80853679, "body": "Maybe I need to explain why I want to do things this way. I want to use mtl for not having to pass a fix stack of effects throughout my application and I want to have &quot;low-level&quot; application declaring some errors which can then be interpreted as high-level error. For example you get a <code>NetworkError</code> which gets transformed to a <code>CatalogError</code> because that was the context in which the network call was made."}, {"owner": {"reputation": 15219, "user_id": 91522, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5de8b254c711059975670fba5ec10ab1?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/91522/eric"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1509018181, "post_id": 46947134, "comment_id": 80853730, "body": "Creating an ADT for exceptions has the drawback that it is not modular. I need to come with all the exceptions for my whole application at once."}, {"owner": {"reputation": 15219, "user_id": 91522, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5de8b254c711059975670fba5ec10ab1?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/91522/eric"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 1, "creation_date": 1509018536, "post_id": 46947134, "comment_id": 80853976, "body": "Actually I think this is what I&#39;m after: <a href=\"https://github.com/gwils/next-level-mtl-with-classy-optics/blob/master/Slides.pdf\" rel=\"nofollow noreferrer\">github.com/gwils/next-level-mtl-with-classy-optics/blob/mast&zwnj;&#8203;er/&hellip;</a>. Thanks by the way for your help, I am indeed a Haskell beginner and trying to navigate the eco-system :-)"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1509022084, "post_id": 46947134, "comment_id": 80856519, "body": "Yes, using Prisms is what you want for composable exceptions) You still create one data type which holds all exceptions but types of functions are polymorphic and composable. I wouldn&#39;t call yourself a Haskell beginner if you can understand what is written in these slides :)"}, {"owner": {"reputation": 15219, "user_id": 91522, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5de8b254c711059975670fba5ec10ab1?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/91522/eric"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1509023449, "post_id": 46947134, "comment_id": 80857588, "body": "I have been reading Haskell for a long time now, I just decided to start writing some a bit more seriously :-)"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1509023637, "post_id": 46947134, "comment_id": 80857723, "body": "Amazing! I really like to see more people involved in Haskell :) If you have any advice in libraries or technologies or something like that, you can always contact me and ask any questions. Will glad to help in this Haskell journey! :)"}], "tags": [], "owner": {"reputation": 15219, "user_id": 91522, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5de8b254c711059975670fba5ec10ab1?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/91522/eric"}, "is_accepted": false, "score": 1, "last_activity_date": 1587330590, "last_edit_date": 1587330590, "creation_date": 1508998867, "answer_id": 46947134, "question_id": 46931455, "link": "https://stackoverflow.com/questions/46931455/how-can-we-interact-with-2-monaderror-constraints-having-2-different-error-types/46947134#46947134", "title": "How can we interact with 2 MonadError constraints having 2 different error types?", "body": "<p>It turns out that I can use <a href=\"https://hackage.haskell.org/package/transformers-0.5.6.2/docs/Control-Monad-Trans-Except.html#v:runExceptT\" rel=\"nofollow noreferrer\"><code>runExceptT</code></a>:</p>\n\n<pre><code>-- runExceptT :: ExceptT e m a -&gt; m (Either e a)\nfunction3 :: (MonadError String m, MonadIO m) =&gt; m Int\nfunction3 =\n  do ei &lt;- runExceptT function1\n     a  &lt;- either (throwError . show) pure ei\n     b  &lt;- function2\n     return (a + b)\n</code></pre>\n\n<p>So there's a way out of the <code>MonadError e</code> \"trap\". On the other hand I don't know how to encapsulate this <code>runExcept / either throwError</code> pattern.</p>\n"}], "owner": {"reputation": 15219, "user_id": 91522, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5de8b254c711059975670fba5ec10ab1?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/91522/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1587330590, "creation_date": 1508931496, "last_edit_date": 1508998620, "question_id": 46931455, "link": "https://stackoverflow.com/questions/46931455/how-can-we-interact-with-2-monaderror-constraints-having-2-different-error-types", "title": "How can we interact with 2 MonadError constraints having 2 different error types?", "body": "<p>Say I have a function</p>\n\n<pre><code>function1 :: (MonadError String m, MonadIO m) =&gt; m Int\n\nfunction2 :: (MonadError Int m, MonadIO m) =&gt; m Int\n</code></pre>\n\n<p>and a function to transform <code>Int</code> into a <code>String</code></p>\n\n<pre><code>renderException :: Int -&gt; String\n</code></pre>\n\n<p>Is there a way to implement function3, which is reusing all 3 functions?</p>\n\n<pre><code>function3 :: (MonadError String m, MonadIO m) =&gt; m Int\n-- add the results from function1, function2 and \n-- transform function2 error into a String\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1508931972, "post_id": 46930506, "comment_id": 80809873, "body": "Can you try <code>--ghc-options=&quot;-ddump-cmm&quot;</code>?"}, {"owner": {"reputation": 191, "user_id": 8732651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h8U1K.jpg?s=128&g=1", "display_name": "buggymcbugfix", "link": "https://stackoverflow.com/users/8732651/buggymcbugfix"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1508944705, "post_id": 46930506, "comment_id": 80819488, "body": "I had tried that! Doesn&#39;t work :("}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 2, "last_activity_date": 1508939789, "creation_date": 1508939789, "answer_id": 46934382, "question_id": 46930506, "link": "https://stackoverflow.com/questions/46930506/ddump-cmm-not-working-in-a-stack-script/46934382#46934382", "title": "`-ddump-cmm` not working in a Stack Script", "body": "<p>If you run your script manually with the <code>-v</code> flag, using:</p>\n\n<pre><code>$ stack -v script --resolver lts-9.9 --install-ghc\n   --package doctest --package QuickCheck -- -ddump-cmm Script.hs\n</code></pre>\n\n<p>you can see that the Script is actually run with <code>runghc</code>, like so:</p>\n\n<pre><code>runghc -hide-all-packages -packageQuickCheck -packagebase \n    -packagedoctest -ddump-cmm Script.hs\n</code></pre>\n\n<p>It turns out that <code>runghc</code> invokes GHC using something equivalent to:</p>\n\n<pre><code>ghc -ignore-dot-ghci -x hs -hide-all-packages -packageQuickCheck\n   -packagebase -packagedoctest -ddump-cmm\n   -e \":set prog Script.hs\" -e \":main\" Script.hs\n</code></pre>\n\n<p>If you try invoking GHC manually this way, you'll find that the <code>-ddump-simpl</code> flag generates output, but the <code>-ddump-cmm</code> doesn't.  It seems that the <code>-e \":main\"</code> argument switchs GHC from \"compile in advance\" mode to just-in-time compiling.  The \"simpl\" is still generated, but the CMM is presumably generated on an as-needed basis, so the <code>-ddump-cmm</code> flag is ignored.</p>\n\n<p>The <code>stack script</code> command has <code>--compile</code> flag, but it's not clear how to pass options to GHC when this flag is in force.  (It's really an accident that you can pass compiler flags to <code>runghc</code> when not using <code>--compile</code>, I think.)</p>\n\n<p>I think your best bet is to just manually compile the script with GHC.</p>\n"}], "owner": {"reputation": 191, "user_id": 8732651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h8U1K.jpg?s=128&g=1", "display_name": "buggymcbugfix", "link": "https://stackoverflow.com/users/8732651/buggymcbugfix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508939789, "creation_date": 1508928767, "last_edit_date": 1508931729, "question_id": 46930506, "link": "https://stackoverflow.com/questions/46930506/ddump-cmm-not-working-in-a-stack-script", "title": "`-ddump-cmm` not working in a Stack Script", "body": "<p>I am using Stack to write a script and would like to see GHC's C-- output.</p>\n\n<p>I have the following at the top of my script:</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack script\n   --resolver lts-9.9\n   --install-ghc\n   --package doctest\n   --package QuickCheck\n   --\n   -ddump-cmm\n-}\n</code></pre>\n\n<p>The output from <code>-ddump-simpl</code> gets printed to the terminal, but not so with <code>-ddump-cmm</code>. Any ideas?</p>\n"}, {"tags": ["list", "haskell", "quickcheck"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1508926973, "post_id": 46929808, "comment_id": 80806530, "body": "You can generate an index, split at that index, and inject a seven at that place."}, {"owner": {"reputation": 676, "user_id": 4165235, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f35ee4291fd7978fa3619b278d7a8c04?s=128&d=identicon&r=PG&f=1", "display_name": "Salviati", "link": "https://stackoverflow.com/users/4165235/salviati"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1508927398, "post_id": 46929808, "comment_id": 80806772, "body": "@WillemVanOnsem That may work, did not think about that."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1508933902, "post_id": 46929808, "comment_id": 80811280, "body": "Minor point: keep in mind that, mathematically speaking, a &quot;random list&quot; is ambiguous, and might refer to <i>any</i> distribution over the set of all lists. There are many options here. Usually, one uses a distribution that makes the length to be distributed geometrically. Similarly, note that there are many distributions for &quot;random lists containing at least one 7&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1508931649, "post_id": 46931095, "comment_id": 80809654, "body": "The main difference between the two approaches is that, with two separate <code>arbitrary</code> lists, it is very unlikely that both will be empty, i.e. the case <code>[7]</code> may not happen as often as necessary. Thus, generating one list and injecting a seven somewhere is probably better for coverage testing."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1508932074, "last_edit_date": 1508932074, "creation_date": 1508930509, "answer_id": 46931095, "question_id": 46929808, "link": "https://stackoverflow.com/questions/46929808/generate-a-list-that-is-garanteed-to-have-a-7-in-it/46931095#46931095", "title": "Generate a list that is garanteed to have a 7 in it", "body": "<p>You can decide to generate two lists, and then construct a list where we append the lists with a seven sandwiched between them.</p>\n\n<p>For instance:</p>\n\n<pre><code>genSevenList :: Gen [Integer]\ngenSevenList = do\n    la &lt;- arbitrary\n    lb &lt;- arbitrary\n    return $ la ++ 7 : lb\n</code></pre>\n\n<p>The first two statements thus generate two arbitrary <code>[Integer]</code> lists, and then we <code>return $ la ++ 7 : lb</code>. We thus prepend <code>lb</code> with <code>7</code>, and append this to <code>la</code>.</p>\n\n<p>You can also generate one arbitrary list, split it at a random index and then join these parts together as described above. For instance:</p>\n\n<pre><code>genSevenList :: Gen [Integer]\ngenSevenList = do\n    l &lt;- arbitrary\n    k &lt;- choose (0,length l)\n    let (la,lb) = splitAt k l\n    return $ la ++ 7 : lb\n</code></pre>\n\n<p>Although both are capable of generating all possible lists, like @leftroundabout says, it is more likely that the second implementation will come up with shorter lists, since the odds that both <code>aribtrary</code> calls will generate a short list (or an empty list) is not that large.</p>\n"}], "owner": {"reputation": 676, "user_id": 4165235, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f35ee4291fd7978fa3619b278d7a8c04?s=128&d=identicon&r=PG&f=1", "display_name": "Salviati", "link": "https://stackoverflow.com/users/4165235/salviati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 46931095, "answer_count": 1, "score": 2, "last_activity_date": 1509006029, "creation_date": 1508926791, "last_edit_date": 1509006029, "question_id": 46929808, "link": "https://stackoverflow.com/questions/46929808/generate-a-list-that-is-garanteed-to-have-a-7-in-it", "title": "Generate a list that is garanteed to have a 7 in it", "body": "<p>How do I do this? I want something with the structure <code>sevenList :: Gen [Integer]</code> that generates a list and that is guaranteed to always include at least one 7.</p>\n\n<p>I know that if I wanted to generate a list of size n, I could do something like this:</p>\n\n<pre><code>listOfLength n gen = sequence [ gen | i &lt;- [1..n] ]\n</code></pre>\n\n<p>But this is not sufficient because if I for example generate a list of length 10 and a 7 is not generated I have to continue, but at the moment it wont.</p>\n"}, {"tags": ["haskell", "preprocessor"], "answers": [{"comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1508929276, "post_id": 46930445, "comment_id": 80808027, "body": "Thanks for your answer! Your solution is good. My project compiles. I know that I should enable <code>-XCPP</code> pragma. I was interested in some simple solution. Perfectly \u2014 using <code>ghci</code>. I&#39;m interested in values inside my prorject, not in isolation. Creating new <code>Main</code> file for such purposes is not really convenient..."}], "tags": [], "owner": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "is_accepted": false, "score": 2, "last_activity_date": 1508940366, "last_edit_date": 1508940366, "creation_date": 1508928578, "answer_id": 46930445, "question_id": 46929541, "link": "https://stackoverflow.com/questions/46929541/how-to-inspect-cpp-pragmas-in-haskell/46930445#46930445", "title": "How to inspect CPP pragmas in Haskell?", "body": "<p>I believe you'll need to explicitly specify that you intend to use CPP for preprocessing via the <code>LANGUAGE</code> pragma.</p>\n\n<p>For example:</p>\n\n<pre><code>{-# LANGUAGE CPP #-}\nmodule Main where\n\n#if ( __GLASGOW_HASKELL__ &gt;= 821 )\nver = \"&gt;= 821\"\n#else\nver = \"&lt; 821\"\n#endif\n\nmain = putStrLn $ ver -- &lt; 821 on my machine\n</code></pre>\n\n<p>See: </p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/28292476/ghc-version-check-in-code\">GHC version check in code</a></li>\n<li><a href=\"https://downloads.haskell.org/~ghc/7.2.1/docs/html/users_guide/pragmas.html\" rel=\"nofollow noreferrer\">https://downloads.haskell.org/~ghc/7.2.1/docs/html/users_guide/pragmas.html</a></li>\n</ul>\n\n<p>Edit:</p>\n\n<p>You should be able to use preprocessing wherever you need to (I <em>think</em> this example addresses the \"values inside your project\" requirement you refer to in your comment below):</p>\n\n<pre><code>-- Bar.hs\n{-# LANGUAGE CPP #-}\nmodule Bar(ver) where\n\n#if ( __GLASGOW_HASKELL__ &gt;= 821 )\nver = \"&gt;= 821\"\n#else\nver = \"&lt; 821\"\n#endif\n\n-- Foo.hs\nmodule Main where\n\nimport Bar\n\nmain = putStrLn $ ver -- &lt; 821 on my machine\n</code></pre>\n"}], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508940366, "creation_date": 1508925937, "question_id": 46929541, "link": "https://stackoverflow.com/questions/46929541/how-to-inspect-cpp-pragmas-in-haskell", "title": "How to inspect CPP pragmas in Haskell?", "body": "<p>I have such code in program:</p>\n\n<pre><code>#if ( __GLASGOW_HASKELL__ &gt;= 821 )\n  ...\n#else\n  ...\n#endif\n</code></pre>\n\n<p>But it doesn't work as expected. Most likely because I used wrong CPP pragma. So I wonder is there some easy way to inspect value of defined constants or to evaluate CPP pragma?</p>\n"}, {"tags": ["haskell", "monads", "memoization", "monad-transformers"], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 1, "last_activity_date": 1508948028, "creation_date": 1508948028, "answer_id": 46937325, "question_id": 46928272, "link": "https://stackoverflow.com/questions/46928272/combine-monad-memo-with-environment-through-reader-in-haskell/46937325#46937325", "title": "Combine Monad.Memo with environment through Reader in Haskell", "body": "<p>In the version using <code>ReaderT</code>, your <a href=\"https://github.com/a6a3uh/POMDP/blob/c22f649db4be867af6be3a5994b7871f486a4c2e/src/Dynamic.hs#L41\" rel=\"nofollow noreferrer\"><code>Dynamic</code></a> monad has one more layer around <code>MemoQV</code>.</p>\n\n<p>In pseudo-haskell, with:</p>\n\n<pre><code>type R = ReaderT (DynamicEnv n r)\ntype L1 = MemoQ n r\ntype L2 = MemoV n r\n</code></pre>\n\n<p>The type before looked like</p>\n\n<pre><code>   L1 (L2 Identity)\n-- 0   1\n</code></pre>\n\n<p>where we numbered transformers counting from the \"top\" starting from 0.\nIn contrast, <code>Dynamic</code> now looks like</p>\n\n<pre><code>   R (L1 (L2 Identity))\n-- 0  1   2\n</code></pre>\n\n<p>Since you inserted the transformers <code>R</code> at the top, the cache transformers were shifted deeper.</p>\n\n<p>This matters to <code>memol0</code>, <code>memol1</code> and <code>memol2</code> combinators: <code>memolN</code> memoizes a computation using the <code>N</code>th layer (which is thus expected to have a matching type), so you need to update your code accordingly when these layers move.</p>\n\n<p>You use <a href=\"https://github.com/a6a3uh/POMDP/blob/c22f649db4be867af6be3a5994b7871f486a4c2e/src/Dynamic.hs#L136\" rel=\"nofollow noreferrer\"><code>memol1</code> here</a> and <a href=\"https://github.com/a6a3uh/POMDP/blob/c22f649db4be867af6be3a5994b7871f486a4c2e/src/Dynamic.hs#L168\" rel=\"nofollow noreferrer\"><code>memol0</code> here</a>. The file compiles when you shift them up to <code>memol2</code> and <code>memol1</code> respectively.</p>\n"}], "owner": {"reputation": 199, "user_id": 934983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66d4682b43c7ff70e36f40580a0d156f?s=128&d=identicon&r=PG", "display_name": "aliko", "link": "https://stackoverflow.com/users/934983/aliko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 2, "accepted_answer_id": 46937325, "answer_count": 1, "score": 1, "last_activity_date": 1508948028, "creation_date": 1508922325, "question_id": 46928272, "link": "https://stackoverflow.com/questions/46928272/combine-monad-memo-with-environment-through-reader-in-haskell", "title": "Combine Monad.Memo with environment through Reader in Haskell", "body": "<p>I'm doing <a href=\"https://github.com/a6a3uh/POMDP\" rel=\"nofollow noreferrer\">open source library</a> for <a href=\"https://en.wikipedia.org/wiki/Partially_observable_Markov_decision_process\" rel=\"nofollow noreferrer\">POMDP</a>. It uses <a href=\"https://en.wikipedia.org/wiki/Dynamic_programming\" rel=\"nofollow noreferrer\">Dynamic Programming</a> under the hood to search other 2D space with some cost function.</p>\n\n<p>DP implementation in <a href=\"https://github.com/a6a3uh/POMDP/blob/2e496df51dbc4fbdc9c6a13494e381a7672feeec/src/Dynamic.hs\" rel=\"nofollow noreferrer\">master</a> branch is based on <a href=\"http://hackage.haskell.org/package/MemoTrie\" rel=\"nofollow noreferrer\">MemoTrie</a> for DP memoization which uses Haskell's lazy evaluation. And I need to have cost function to be tunable. I believe this will not play nicely with MemoTrie's lazy approach. I did a naive <a href=\"https://github.com/a6a3uh/POMDP/blob/a157a125ae688b380c08aacd45c2f77b70c92855/src/Dynamic.hs\" rel=\"nofollow noreferrer\">try</a> but as expected it takes hours to get through all tests instead of seconds.</p>\n\n<p>I decided monadic approach with <a href=\"http://hackage.haskell.org/package/monad-memo\" rel=\"nofollow noreferrer\">Monad.Memo</a> is a way to go. <a href=\"https://github.com/a6a3uh/POMDP/blob/1f2d6c56b09f2e8098b3a77d8f54d988bfb7e957/src/Dynamic.hs\" rel=\"nofollow noreferrer\">Here is</a> a first try that works though don't use any Reader context. But now I'm struggling with proper way to introduce Reader context for this computation.</p>\n\n<p>This <a href=\"https://github.com/a6a3uh/POMDP/blob/2ba3eea8e0c4de87edb539af88145da97c818daf/src/Dynamic.hs\" rel=\"nofollow noreferrer\">try</a> I used constraints to introduce MonadReader. At the same time I was not able to describe mutual recurrence for fq and fv as a constraint, just tried to memoize only fq. But even then MonadReader type class implementation of MonadMemo puts Reader context as part of key and as my context is a function it hardly could be a (part of) key for mapping. I was only able to unwrap stuff up to Writer monad:</p>\n\n<pre><code>:t fst . startEvalMemo . runWriterT $ fq 1 1 1\n</code></pre>\n\n<p>And was not able to go further to unwrap the Reader as well.</p>\n\n<p>Last try I tried to <a href=\"https://github.com/a6a3uh/POMDP/blob/c22f649db4be867af6be3a5994b7871f486a4c2e/src/Dynamic.hs\" rel=\"nofollow noreferrer\">use</a> ReaderT. But this not compiles giving stuff like</p>\n\n<pre><code>\u2022 Occurs check: cannot construct the infinite type: v ~ [v]\n    arising from a functional dependency between:\n      constraint \u2018MapLike\n                    (containers-0.5.7.1:Data.Map.Base.Map (n, n, n) [v]) (n, n, n) v\u2019\n        arising from a use of \u2018memol1\u2019\n      instance \u2018MapLike (containers-0.5.7.1:Data.Map.Base.Map k v1) k v1\u2019\n        at &lt;no location info&gt;\n\u2022 In the first argument of \u2018for3\u2019, namely \u2018memol1\u2019\n  In the expression: for3 memol1 fv n\n  In an equation for \u2018v\u2019: v = for3 memol1 fv n\n\u2022 Relevant bindings include\n    v :: n -&gt; n -&gt; ReaderT (DynamicEnv n v) (MemoQV n v) v\n      (bound at src/Dynamic.hs:136:9)\n</code></pre>\n\n<p>So I'm struggling to be productive in Haskell but as I'm learning it questions like this take me long time. Would be happy to hear any advise from you!</p>\n"}, {"tags": ["list", "function", "haskell", "recursion", "max"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1508917626, "post_id": 46926662, "comment_id": 80800344, "body": "Well your function will remove values given the <b>next value</b> is smaller than that value. So <code>9</code> is removed in your first example."}, {"owner": {"reputation": 27, "user_id": 8793788, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-1GF-TK3Z-hU/AAAAAAAAAAI/AAAAAAAAHjU/rg0JpaFThNo/photo.jpg?sz=128", "display_name": "lou tej", "link": "https://stackoverflow.com/users/8793788/lou-tej"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1508918366, "post_id": 46926662, "comment_id": 80800769, "body": "Yes, I understand that, but what about the issue that I am posting about?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1508918742, "post_id": 46926662, "comment_id": 80801000, "body": "Your function does not remove the maximum. It removes the first value that is followed by a smaller one -- which may or may not be the maximum. You need to scan the list twice: one to find the maximum, and another one to remove it. Doing in one pass only seems to be more tricky (and possibly require subtle techniques like tying the knot, which you should disregard for now)."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8793788, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-1GF-TK3Z-hU/AAAAAAAAAAI/AAAAAAAAHjU/rg0JpaFThNo/photo.jpg?sz=128", "display_name": "lou tej", "link": "https://stackoverflow.com/users/8793788/lou-tej"}, "edited": false, "score": 0, "creation_date": 1508919589, "post_id": 46927148, "comment_id": 80801498, "body": "The problem doesn&#39;t seem to say that I can use two methods. If there is a way to do one method using another method then I wouldn&#39;t even know where to start with that, the professor didn&#39;t explain that. But thank you and I see now what I did wrong. Oh well, back to the drawing board."}], "tags": [], "owner": {"reputation": 27685, "user_id": 610979, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ku5ga.png?s=128&g=1", "display_name": "Frank Schmitt", "link": "https://stackoverflow.com/users/610979/frank-schmitt"}, "is_accepted": true, "score": 0, "last_activity_date": 1508918830, "creation_date": 1508918830, "answer_id": 46927148, "question_id": 46926662, "link": "https://stackoverflow.com/questions/46926662/unexpected-issue-with-max-function-in-haskell/46927148#46927148", "title": "Unexpected issue with max function in Haskell", "body": "<p>There's nothing weird about the way your function behaves - you defined it to remove <strong>the first number that is larger than its successor</strong>.</p>\n\n<p>To really remove the maximum from a given list, the easiest approach is to:</p>\n\n<ul>\n<li>find the maximum by scanning the whole list</li>\n<li>remove it</li>\n</ul>\n\n<p>An implementation of this approach is pretty straightforward using two helper functions:</p>\n\n<pre><code>  findMax: [Int] -&gt; Int\n  removeElement: [Int] -&gt; Int -&gt; [Int]\n</code></pre>\n\n<p>However, you should also consider edge cases:</p>\n\n<ul>\n<li>what happens if the maximum occurs more than once? I.e. should <code>removeMax [1, 3, 2, 3]</code> return <code>[1,2,3]</code>, <code>[1,2]</code> or <code>[1,3,2</code>] ?</li>\n<li>does your new implementation handle the empty list correctly? (your current one does)</li>\n</ul>\n"}], "owner": {"reputation": 27, "user_id": 8793788, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-1GF-TK3Z-hU/AAAAAAAAAAI/AAAAAAAAHjU/rg0JpaFThNo/photo.jpg?sz=128", "display_name": "lou tej", "link": "https://stackoverflow.com/users/8793788/lou-tej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 46927148, "answer_count": 1, "score": 0, "last_activity_date": 1508922924, "creation_date": 1508917247, "last_edit_date": 1508922924, "question_id": 46926662, "link": "https://stackoverflow.com/questions/46926662/unexpected-issue-with-max-function-in-haskell", "title": "Unexpected issue with max function in Haskell", "body": "<p>I have this function that removes the maximum value of a list and it seems to work, and when I keep adding numbers it works until I add a new high number. Then it will still remove only the old max number. But when I start a new list it will work again. Can anyone explain what is going on, and what I am doing wrong?</p>\n\n<pre><code>    removeMax :: [Int] -&gt; [Int]\n    removeMax [] = []\n    removeMax [x] = [] \n    removeMax (x:y:xs)\n        | x &gt; y = (y:xs)\n        | otherwise = x : removeMax (y:xs)\n</code></pre>\n\n<p>And here is the outputs of several tests I made: </p>\n\n<pre><code>    *Main&gt; removeMax [1,9,3,2,6]\n    [1,3,2,6]\n    *Main&gt; removeMax [1,9,3,2,6,8]\n    [1,3,2,6,8]\n    *Main&gt; removeMax [1,9,3,2,6,8,7]\n    [1,3,2,6,8,7]\n    *Main&gt; removeMax [1,9,3,2,6,8,7,14]\n    [1,3,2,6,8,7,14]\n    *Main&gt; removeMax [1,9,3,2,6,8,7,14]\n    [1,3,2,6,8,7,14]\n    *Main&gt; removeMax [1,9,3,2,6,8,7,14]\n    [1,3,2,6,8,7,14]\n    *Main&gt; removeMax [1,3,14,5]\n    [1,3,5]\n    *Main&gt; removeMax[1,3,8,9]\n    [1,3,8]\n    *Main&gt; removeMax [1,2,3,67,87,12]\n    [1,2,3,67,12]\n    *Main&gt; removeMax [1,2,3,67,87,12,88]\n    [1,2,3,67,12,88]\n</code></pre>\n\n<p>As you can see it works when you keep doing it on new lists and when you use an old list and only add smaller numbers.</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1508922188, "post_id": 46926362, "comment_id": 80803120, "body": "If the <code>[String]</code> argument represents the work you&#39;ve already done, then it being empty is not a very good base case! Your base case should be when there is no work left to do, not when all the work remains to be done. Your base case should probably be something meaning &quot;all the pieces are in the place I wanted them already&quot;."}, {"owner": {"reputation": 409, "user_id": 8829896, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Oa6m_ZN8lOU/AAAAAAAAAAI/AAAAAAAAAB0/tb-UhtBWpbU/photo.jpg?sz=128", "display_name": "Patrick Conboy", "link": "https://stackoverflow.com/users/8829896/patrick-conboy"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1508929676, "post_id": 46926362, "comment_id": 80808294, "body": ".. my base case is so blatantly obvious. I can&#39;t believe I spent 2 hours on this function. Thank you haha. Saying it the way you did made it click for some reason that my base case should be based on n."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1508918295, "creation_date": 1508918295, "answer_id": 46926977, "question_id": 46926362, "link": "https://stackoverflow.com/questions/46926362/recursively-calling-a-function-that-returns-a-list-without-an-empty-list-case/46926977#46926977", "title": "Recursively calling a function, that returns a list, without an empty list case?", "body": "<pre><code>stringFromBoardHelper _ _ _ _ [] = []\n</code></pre>\n\n<p>This line will apply to any tower, and any <code>n</code>, as long as <code>discString</code> is empty.</p>\n\n<p>It is also the first line in the definition, so it is attempted first.</p>\n\n<p>You probably need to either put that line last, or to specialize the <code>_</code>s so that they match against fewer cases. </p>\n\n<p>(This should solve the primary issue you have -- your code might then have others)</p>\n"}], "owner": {"reputation": 409, "user_id": 8829896, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Oa6m_ZN8lOU/AAAAAAAAAAI/AAAAAAAAAB0/tb-UhtBWpbU/photo.jpg?sz=128", "display_name": "Patrick Conboy", "link": "https://stackoverflow.com/users/8829896/patrick-conboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508918295, "creation_date": 1508916253, "last_edit_date": 1508917052, "question_id": 46926362, "link": "https://stackoverflow.com/questions/46926362/recursively-calling-a-function-that-returns-a-list-without-an-empty-list-case", "title": "Recursively calling a function, that returns a list, without an empty list case?", "body": "<p>Okay, I'll try to give all the info needed here. This is one function of many functions we had to implement in my class in order to solve The Tower of Hanoi. The function in question takes in the 3 towers, in reverse order <strong>(biggest>smallest)</strong>, the number of discs in my problem, and a string, which starts as empty, of the levels of the tower that have already been added to the list.</p>\n\n<p>The function needs to recursively step through each level of the towers and print, in individual strings, what discs are in that level. Hopefully, that makes sense. I can elaborate more if need be.</p>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>stringFromBoardHelper :: Tower -&gt; Tower -&gt; Tower -&gt; Int -&gt; [String] -&gt; [String]\nstringFromBoardHelper _ _ _ _ [] = []\nstringFromBoardHelper (t1:t1s) (t2:t2s) (t3:t3s) n discString = if n &gt; 0 \n        then stringFromBoardHelper t1s t2s t3s (n-1) ((stringFromThreeDiscs t1 t2 t3 n) : discString)\n        else discString\n</code></pre>\n\n<p>My problem is that right now my code just returns the empty list as my function starts with an empty list.</p>\n\n<p>However, if I remove the empty listt case, then I get the error for not having exhaustive cases.Any Ideas?</p>\n"}, {"tags": ["haskell", "haskell-stack", "xmonad"], "comments": [{"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1509401998, "post_id": 46925680, "comment_id": 80997223, "body": "Did you configure the x11 package?"}, {"owner": {"reputation": 174, "user_id": 683546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e50dd145a3f45e923e726a9d69f2694?s=128&d=identicon&r=PG", "display_name": "Enrique P&#233;rez Arnaud", "link": "https://stackoverflow.com/users/683546/enrique-p%c3%a9rez-arnaud"}, "reply_to_user": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1509618313, "post_id": 46925680, "comment_id": 81093819, "body": "@Chris Stryczynski I&#39;m not sure what you mean with configuring the x11 package - you mean in stack?"}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1509619236, "post_id": 46925680, "comment_id": 81094548, "body": "It&#39;s mentioned in the github repo readme"}, {"owner": {"reputation": 174, "user_id": 683546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e50dd145a3f45e923e726a9d69f2694?s=128&d=identicon&r=PG", "display_name": "Enrique P&#233;rez Arnaud", "link": "https://stackoverflow.com/users/683546/enrique-p%c3%a9rez-arnaud"}, "reply_to_user": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1509627229, "post_id": 46925680, "comment_id": 81099979, "body": "@ChrisStryczynski As I understand it, the configure step is only needed when you build manually, not when you use cabal  or stack. Do you disagree?"}], "owner": {"reputation": 174, "user_id": 683546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e50dd145a3f45e923e726a9d69f2694?s=128&d=identicon&r=PG", "display_name": "Enrique P&#233;rez Arnaud", "link": "https://stackoverflow.com/users/683546/enrique-p%c3%a9rez-arnaud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1509618614, "creation_date": 1508914031, "last_edit_date": 1509618614, "question_id": 46925680, "link": "https://stackoverflow.com/questions/46925680/error-loading-xmonad-modules-in-ghci-within-a-stack-deployment-of-xmonad-for-d", "title": "Error loading (xmonad) modules in GHCi within a stack deployment of xmonad for development", "body": "<p>I am trying to develop a ManageHook for XMonad, and have deployed a development\nenvironment in the following way (as described <a href=\"https://github.com/xmonad/xmonad-testing\" rel=\"nofollow noreferrer\">here</a>).</p>\n\n<p>In my <code>~/.xmonad/</code> I have a working <code>xmonad.hs</code>. I have also added there\nan <code>~/.xmonad/src/</code> subdir with git checkouts of the xmonad, xmonad-contrib, and\nX11 packages.  And also there in  <code>~/.xmonad/</code> I have an\n<code>xmonad-testing.cabal</code>, <code>stack.yaml</code>, and <code>build</code> files, with contents:</p>\n\n<p>xmonad-testing.cabal:</p>\n\n<pre><code>name:          xmonad-testing\nversion:       0.13\n-- [ ... more metadata ... ]\nbuild-type:    Simple\ncabal-version: &gt;=1.8\n\nexecutable xmonad-testing\n  main-is: xmonad.hs\n  ghc-options: -Wall -fno-warn-missing-signatures\n  build-depends: base, containers, X11, xmonad, xmonad-contrib\n</code></pre>\n\n<p>stack.yaml:</p>\n\n<pre><code>resolver: lts-9.6\n\npackages:\n- .\n- src/xmonad\n- src/xmonad-contrib\n- src/X11\n\nextra-deps:\n- X11-xft-0.3.1\n- directory-1.2.7.1\n- xmobar-0.24.3\n</code></pre>\n\n<p>build:</p>\n\n<pre><code>SRC_DIR=~/.xmonad\n\nEXE_NAME=xmonad-testing\n\noutput_file=$1; shift\n\ncd $SRC_DIR\nstack build\nstack install\nDIR=`stack path --local-bin`/$EXE_NAME\nmv -u $DIR $output_file\n</code></pre>\n\n<p>With this files in place, I can <code>cd ~/.xmonad/</code>, and then run <code>stack setup &amp;&amp;\nstack build &amp;&amp; stack install &amp;&amp; xmonad-testing --recompile</code>, and then I\ncan call the xmonad executable from <code>~/.xinitrc</code> like\n<code>exec ~/.xmonad/xmonad-x86_64-linux</code>, and all goes well, no problem with this, I can edit the\nsources in <code>~/.xmonad/src/</code> and load the changes with mod4Mask-Q.</p>\n\n<p>However, when I execute, in <code>~/.xmonad/</code>, <code>stack ghci</code>, I obtain a couple\nof errors before getting the ghci prompt:</p>\n\n<p>errors from \"stack ghci\":</p>\n\n<pre><code>GHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\n\n/home/eperez/src/git/xmonad/xmonad-contrib/XMonad/Layout/LayoutCombinators.hs:178:0: error:\n     error: unterminated comment\n     (*/**)     = combineTwo (Mirror $ Tall 1 0.1 (1/3))\n\n`gcc' failed in phase `C pre-processor'. (Exit code: 1)\n\n&lt;no location info&gt;: error:\n    Could not find module \u2018Graphics.X11\u2019\n    It is a member of the hidden package \u2018X11-1.8@X11-1.8-9LIA1IrKR3LITr8rHkiWyN\u2019.\n</code></pre>\n\n<p>And then I try to load some module (e.g. XMonad.Actions.TreeSelect) with: <code>:l XMonad.Actions.TreeSelect</code>\nand I get a bunch of errors and the module never loads - a module that\nis actually working in the running X session. What may be the problem? I\nend the post with the errors trying to load the module in ghci:</p>\n\n<p>errors loading xmonad-contrib module in ghci:</p>\n\n<pre><code>Prelude&gt; :l XMonad.Actions.TreeSelect\n\n  [    ......     ]\n  [ MANY WARNINGS ]\n  [    ......     ]\n\n\n/home/eperez/src/git/xmonad/xmonad-contrib/XMonad/Util/Font.hs:117:37: error:\n    \u2022 Couldn't match expected type \u2018X11-1.8:Graphics.X11.Xlib.Types.Display\u2019\n                  with actual type \u2018Display\u2019\n      NB: \u2018Display\u2019 is defined at\n            Graphics/X11/Xlib/Types.hsc:(47,1)-(49,48)\n          \u2018X11-1.8:Graphics.X11.Xlib.Types.Display\u2019\n            is defined in \u2018Graphics.X11.Xlib.Types\u2019 in package \u2018X11-1.8\u2019\n    \u2022 In the first argument of \u2018xftFontOpen\u2019, namely \u2018dpy\u2019\n      In the second argument of \u2018($)\u2019, namely\n        \u2018xftFontOpen\n           dpy (defaultScreenOfDisplay dpy) (drop (length xftPrefix) s)\u2019\n      In a stmt of a 'do' block:\n        xftdraw &lt;- io\n                   $ xftFontOpen\n                       dpy (defaultScreenOfDisplay dpy) (drop (length xftPrefix) s)\n\n/home/eperez/src/git/xmonad/xmonad-contrib/XMonad/Util/Font.hs:117:42: error:\n    \u2022 Couldn't match expected type \u2018X11-1.8:Graphics.X11.Xlib.Types.Screen\u2019\n                  with actual type \u2018Screen\u2019\n      NB: \u2018Screen\u2019 is defined at\n            Graphics/X11/Xlib/Types.hsc:(55,1)-(57,48)\n          \u2018X11-1.8:Graphics.X11.Xlib.Types.Screen\u2019\n            is defined in \u2018Graphics.X11.Xlib.Types\u2019 in package \u2018X11-1.8\u2019\n    \u2022 In the second argument of \u2018xftFontOpen\u2019, namely\n        \u2018(defaultScreenOfDisplay dpy)\u2019\n      In the second argument of \u2018($)\u2019, namely\n        \u2018xftFontOpen\n           dpy (defaultScreenOfDisplay dpy) (drop (length xftPrefix) s)\u2019\n      In a stmt of a 'do' block:\n        xftdraw &lt;- io\n                   $ xftFontOpen\n                       dpy (defaultScreenOfDisplay dpy) (drop (length xftPrefix) s)\n\n/home/eperez/src/git/xmonad/xmonad-contrib/XMonad/Util/Font.hs:130:21: error:\n    \u2022 Couldn't match expected type \u2018X11-1.8:Graphics.X11.Xlib.Types.Display\u2019\n                  with actual type \u2018Display\u2019\n      NB: \u2018Display\u2019 is defined at\n            Graphics/X11/Xlib/Types.hsc:(47,1)-(49,48)\n          \u2018X11-1.8:Graphics.X11.Xlib.Types.Display\u2019\n            is defined in \u2018Graphics.X11.Xlib.Types\u2019 in package \u2018X11-1.8\u2019\n    \u2022 In the first argument of \u2018xftFontClose\u2019, namely \u2018dpy\u2019\n      In the second argument of \u2018($)\u2019, namely \u2018xftFontClose dpy xftfont\u2019\n      In a stmt of a 'do' block: io $ xftFontClose dpy xftfont\n\n/home/eperez/src/git/xmonad/xmonad-contrib/XMonad/Util/Font.hs:141:26: error:\n    \u2022 Couldn't match expected type \u2018X11-1.8:Graphics.X11.Xlib.Types.Display\u2019\n                  with actual type \u2018Display\u2019\n      NB: \u2018Display\u2019 is defined at\n            Graphics/X11/Xlib/Types.hsc:(47,1)-(49,48)\n          \u2018X11-1.8:Graphics.X11.Xlib.Types.Display\u2019\n            is defined in \u2018Graphics.X11.Xlib.Types\u2019 in package \u2018X11-1.8\u2019\n    \u2022 In the first argument of \u2018xftTextExtents\u2019, namely \u2018dpy\u2019\n      In a stmt of a 'do' block: gi &lt;- xftTextExtents dpy xftdraw s\n      In the second argument of \u2018($)\u2019, namely\n        \u2018do { gi &lt;- xftTextExtents dpy xftdraw s;\n              return $ xglyphinfo_xOff gi }\u2019\n\n/home/eperez/src/git/xmonad/xmonad-contrib/XMonad/Util/Font.hs:199:29: error:\n    \u2022 Couldn't match expected type \u2018X11-1.8:Graphics.X11.Xlib.Types.Display\u2019\n                  with actual type \u2018Display\u2019\n      NB: \u2018Display\u2019 is defined at\n            Graphics/X11/Xlib/Types.hsc:(47,1)-(49,48)\n          \u2018X11-1.8:Graphics.X11.Xlib.Types.Display\u2019\n            is defined in \u2018Graphics.X11.Xlib.Types\u2019 in package \u2018X11-1.8\u2019\n    \u2022 In the first argument of \u2018xftTextExtents\u2019, namely \u2018dpy\u2019\n      In the second argument of \u2018($)\u2019, namely \u2018xftTextExtents dpy font s\u2019\n      In a stmt of a 'do' block: gi &lt;- io $ xftTextExtents dpy font s\n\n/home/eperez/src/git/xmonad/xmonad-contrib/XMonad/Util/Font.hs:205:20: error:\n    \u2022 Couldn't match expected type \u2018X11-1.8:Graphics.X11.Xlib.Types.Display\u2019\n                  with actual type \u2018Display\u2019\n      NB: \u2018Display\u2019 is defined at\n            Graphics/X11/Xlib/Types.hsc:(47,1)-(49,48)\n          \u2018X11-1.8:Graphics.X11.Xlib.Types.Display\u2019\n            is defined in \u2018Graphics.X11.Xlib.Types\u2019 in package \u2018X11-1.8\u2019\n    \u2022 In the first argument of \u2018withXftDraw\u2019, namely \u2018dpy\u2019\n      In the expression: withXftDraw dpy drw visual colormap\n      In the second argument of \u2018($)\u2019, namely\n        \u2018withXftDraw dpy drw visual colormap\n         $ \\ draw\n             -&gt; withXftColorName dpy visual colormap fc\n                $ \\ color -&gt; xftDrawString draw color font x y s\u2019\n\n/home/eperez/src/git/xmonad/xmonad-contrib/XMonad/Util/Font.hs:205:28: error:\n    \u2022 Couldn't match expected type \u2018X11-1.8:Graphics.X11.Xlib.Types.Visual\u2019\n                  with actual type \u2018Visual\u2019\n      NB: \u2018Visual\u2019 is defined at\n            Graphics/X11/Xlib/Types.hsc:(63,1)-(65,48)\n          \u2018X11-1.8:Graphics.X11.Xlib.Types.Visual\u2019\n            is defined in \u2018Graphics.X11.Xlib.Types\u2019 in package \u2018X11-1.8\u2019\n    \u2022 In the third argument of \u2018withXftDraw\u2019, namely \u2018visual\u2019\n      In the expression: withXftDraw dpy drw visual colormap\n      In the second argument of \u2018($)\u2019, namely\n        \u2018withXftDraw dpy drw visual colormap\n         $ \\ draw\n             -&gt; withXftColorName dpy visual colormap fc\n                $ \\ color -&gt; xftDrawString draw color font x y s\u2019\n\n/home/eperez/src/git/xmonad/xmonad-contrib/XMonad/Util/Font.hs:206:36: error:\n    \u2022 Couldn't match expected type \u2018X11-1.8:Graphics.X11.Xlib.Types.Display\u2019\n                  with actual type \u2018Display\u2019\n      NB: \u2018Display\u2019 is defined at\n            Graphics/X11/Xlib/Types.hsc:(47,1)-(49,48)\n          \u2018X11-1.8:Graphics.X11.Xlib.Types.Display\u2019\n            is defined in \u2018Graphics.X11.Xlib.Types\u2019 in package \u2018X11-1.8\u2019\n    \u2022 In the first argument of \u2018withXftColorName\u2019, namely \u2018dpy\u2019\n      In the expression: withXftColorName dpy visual colormap fc\n      In the expression:\n        withXftColorName dpy visual colormap fc\n        $ \\ color -&gt; xftDrawString draw color font x y s\n\n/home/eperez/src/git/xmonad/xmonad-contrib/XMonad/Util/Font.hs:206:40: error:\n    \u2022 Couldn't match expected type \u2018X11-1.8:Graphics.X11.Xlib.Types.Visual\u2019\n                  with actual type \u2018Visual\u2019\n      NB: \u2018Visual\u2019 is defined at\n            Graphics/X11/Xlib/Types.hsc:(63,1)-(65,48)\n          \u2018X11-1.8:Graphics.X11.Xlib.Types.Visual\u2019\n            is defined in \u2018Graphics.X11.Xlib.Types\u2019 in package \u2018X11-1.8\u2019\n    \u2022 In the second argument of \u2018withXftColorName\u2019, namely \u2018visual\u2019\n      In the expression: withXftColorName dpy visual colormap fc\n      In the expression:\n        withXftColorName dpy visual colormap fc\n        $ \\ color -&gt; xftDrawString draw color font x y s\nFailed, modules loaded: Graphics.X11, Graphics.X11.Types, Graphics.X11.Xinerama, Graphics.X11.Xlib, Graphics.X11.Xlib.Atom, Graphics.X11.Xlib.Color, Graphics.X11.Xlib.Context, Graphics.X11.Xlib.Cursor, Graphics.X11.Xlib.Display, Graphics.X11.Xlib.Event, Graphics.X11.Xlib.Extras, Graphics.X11.Xlib.Font, Graphics.X11.Xlib.Image, Graphics.X11.Xlib.Internal, Graphics.X11.Xlib.Misc, Graphics.X11.Xlib.Region, Graphics.X11.Xlib.Screen, Graphics.X11.Xlib.Types, Graphics.X11.Xlib.Window, Graphics.X11.Xrandr, Paths_xmonad, XMonad, XMonad.Config, XMonad.Core, XMonad.Hooks.WorkspaceHistory, XMonad.Layout, XMonad.Main, XMonad.ManageHook, XMonad.Operations, XMonad.StackSet, XMonad.Util.ExtensibleState, XMonad.Util.TreeZipper.\n*XMonad.Hooks.WorkspaceHistory&gt;\n</code></pre>\n\n<hr />\n\n<p><strong>Edited to add</strong>:</p>\n\n<p>This is not a solution, but rather a workaround: if I run <code>stack exec -- ghci</code> rather than <code>stack ghci</code>, I have no problems loading whatever modules.</p>\n"}, {"tags": ["haskell", "filter", "list-comprehension"], "comments": [{"owner": {"reputation": 53, "user_id": 5315175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/296dc19f4ed9e20d6aad9039b8af8d86?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Johnny Sotoparra", "link": "https://stackoverflow.com/users/5315175/christian-johnny-sotoparra"}, "edited": false, "score": 0, "creation_date": 1508911236, "post_id": 46924794, "comment_id": 80796730, "body": "nevermind, i was able to figure it out"}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 5315175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/296dc19f4ed9e20d6aad9039b8af8d86?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Johnny Sotoparra", "link": "https://stackoverflow.com/users/5315175/christian-johnny-sotoparra"}, "is_accepted": false, "score": 0, "last_activity_date": 1508911278, "creation_date": 1508911278, "answer_id": 46925000, "question_id": 46924794, "link": "https://stackoverflow.com/questions/46924794/how-to-use-filter-in-list-comprehension/46925000#46925000", "title": "How to use filter in list comprehension?", "body": "<pre><code> setSubtract cmp xs ys = [x | x &lt;- xs, member cmp x ys == False]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1055, "user_id": 593298, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51e634a7316f1a4101f65519d2110cce?s=128&d=identicon&r=PG", "display_name": "keep_learning", "link": "https://stackoverflow.com/users/593298/keep-learning"}, "is_accepted": true, "score": 2, "last_activity_date": 1508933664, "last_edit_date": 1508933664, "creation_date": 1508911337, "answer_id": 46925012, "question_id": 46924794, "link": "https://stackoverflow.com/questions/46924794/how-to-use-filter-in-list-comprehension/46925012#46925012", "title": "How to use filter in list comprehension?", "body": "<p>I changed your code little bit, and filter <code>(== x)</code> <code>ys == []</code> checks that <code>x</code> does not appear in <code>ys</code>. </p>\n\n<p>Here's the definition:</p>\n\n<pre><code>setSubtract xs ys = [x | x &lt;- xs, filter ( == x) ys == []]\n</code></pre>\n\n<p>Here it is in action:</p>\n\n<pre><code>\u03bb&gt;  setSubtract [1,2,3] [3,4,5]\n[1,2]\n\u03bb&gt; setSubtract [1,2,3,4,5,6,7] [3,4,5]\n[1,2,6,7]\n\u03bb&gt; \n</code></pre>\n\n<p>An alternate definition</p>\n\n<pre><code>setSubtract xs ys = [x | x &lt;- xs, not . any ( == x) $ ys]\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5315175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/296dc19f4ed9e20d6aad9039b8af8d86?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Johnny Sotoparra", "link": "https://stackoverflow.com/users/5315175/christian-johnny-sotoparra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 0, "accepted_answer_id": 46925012, "answer_count": 2, "score": 0, "last_activity_date": 1508933664, "creation_date": 1508910308, "question_id": 46924794, "link": "https://stackoverflow.com/questions/46924794/how-to-use-filter-in-list-comprehension", "title": "How to use filter in list comprehension?", "body": "<p>So i'm trying to make a setSubtraction from 2 set lists where it returns the set of all elements that occur in xs but not in ys.  For example xs = [1,2,3] and ys = [3,4,5], then setSubtraction xs ys =  [1,2]</p>\n\n<p>this is what i have so far</p>\n\n<pre><code>setSubtract xs ys = [x | x &lt;- xs, y &lt;- ys, filter (==y) xs]\n</code></pre>\n\n<p>but the filter function seems to be erroring out</p>\n"}, {"tags": ["haskell", "equality", "typeclass", "ghci", "algebraic-data-types"], "answers": [{"tags": [], "owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "is_accepted": false, "score": 7, "last_activity_date": 1508910748, "creation_date": 1508910748, "answer_id": 46924868, "question_id": 46924456, "link": "https://stackoverflow.com/questions/46924456/why-does-a-function-constructed-with-pattern-matching-have-the-eq-type-constrain/46924868#46924868", "title": "Why does a function constructed with pattern matching have the Eq type constraint but not when using a data constructor?", "body": "<p>The <code>matchDataInt</code> function doesn't require an <code>Eq</code> constraint because it <em>specifically matches on an <code>Int</code></em>, and <code>Int</code>s already have an <code>Eq</code> instance.</p>\n\n<p>Your <code>matchInt</code> function doesn't just take <code>Int</code>s as parameters \u2013 it can take <em>any</em> kind of number, as long as you can compare that number for equality.  That's why it has type <code>(Eq a, Num a, Num p) =&gt; a -&gt; p</code>.  You could also give it the type <code>Num p =&gt; Int -&gt; p</code> (specializing <code>a</code> to <code>Int</code>), because <code>Int</code> already has <code>Eq</code> and <code>Num</code> instances.</p>\n\n<p>Your <code>matchDataInt</code> function, on the other hand, takes a <code>Z</code> as an argument, and every <code>Z</code> contains an <code>Int</code>.  Pattern matching against <em>that <code>Int</code></em> incurs an <code>Eq</code> constraint, but <em>only on the <code>Int</code></em>.  You could instead have</p>\n\n<pre><code>data Z' a = Y' a\n\nmatchDataNum :: (Eq a, Num a, Num p) =&gt; Z' a -&gt; p\nmatchDataNum (Y' 1) = 3\nmatchDataNum _      = 4\n</code></pre>\n\n<p>And here, you couldn't remove the <code>Eq a</code> constraint.</p>\n\n<hr>\n\n<p>This all might be slightly clearer with variant functions that didn't return numbers themselves.  If we have</p>\n\n<pre><code>data Z    = Y  Int\ndata Z' a = Y' a\n\nis1 1 = True\nis1 _ = False\n\nisY1 (Y 1) = True\nisY1 _     = False\n\nisY'1 (Y' 1) = True\nisY'1 _      = False\n</code></pre>\n\n<p>then the three functions we've defined have the types</p>\n\n<pre><code>is1   :: (Eq a, Num a) =&gt; a -&gt; Bool\nisY1  :: Z -&gt; Bool\nisY'1 :: (Eq a, Num a) =&gt; Z' a -&gt; Bool\n</code></pre>\n\n<p>We could also define</p>\n\n<pre><code>is1Int :: Int -&gt; Bool\nis1Int 1 = True\nis1Int _ = False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 11, "last_activity_date": 1509899730, "last_edit_date": 1509899730, "creation_date": 1508911974, "answer_id": 46925162, "question_id": 46924456, "link": "https://stackoverflow.com/questions/46924456/why-does-a-function-constructed-with-pattern-matching-have-the-eq-type-constrain/46925162#46925162", "title": "Why does a function constructed with pattern matching have the Eq type constraint but not when using a data constructor?", "body": "<p>Syntactically <code>matchInt</code> is built on a pattern match, but the patern match here is an illusion. <code>1</code> is not a data constructor. Numeric literals are overloaded. <code>1</code> is equivalent to <code>fromInteger #1</code> where <code>#1</code> is a non-overloaded litteral (not expressible in standard Haskell) of type <code>Integer</code>. You cannot really pattern match against such things.</p>\n\n<p>So the compiler lets you write what is syntactically a pattern match, but this notation really denotes a guard:</p>\n\n<pre><code>matchInt 1 = ... -- what is written\nmatchInt x | x == fromInteger #1 = ...  -- what it really means\n</code></pre>\n\n<p>Since the type of <code>matchInt</code> is not explicitly given, it's inferred. It's a function, so the type is some refinement of <code>a-&gt;b</code>. The call to <code>fromInteger</code> gives rise to the constraint <code>Num a</code>, and the call to <code>==</code> gives rise to the constraint <code>Eq a</code>, and that's all we can tell about <code>a</code>.</p>\n\n<p>If OTOH we give the function an explicit signature, say</p>\n\n<pre><code>matchInt :: Int-&gt;Int\n</code></pre>\n\n<p>then we don't need to infer the type, but only check if it satisfies the constraints. Since <code>Int</code> satisfies both <code>Eq Int</code> and <code>Num Int</code>, everything is ok.</p>\n\n<p>And this is what's going on in your second example. The type you match is known to be <code>Int</code>, not because of an explicit type signature but because it is inferred from the <code>Y Int</code> alternative of <code>Z</code>. Here again <code>Int</code> already has all the needed instances.</p>\n"}], "owner": {"reputation": 631, "user_id": 6514691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ee33b08c26c153742e975d043ab892f?s=128&d=identicon&r=PG&f=1", "display_name": "Rick Majpruz", "link": "https://stackoverflow.com/users/6514691/rick-majpruz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "accepted_answer_id": 46925162, "answer_count": 2, "score": 7, "last_activity_date": 1509899730, "creation_date": 1508908393, "last_edit_date": 1508908605, "question_id": 46924456, "link": "https://stackoverflow.com/questions/46924456/why-does-a-function-constructed-with-pattern-matching-have-the-eq-type-constrain", "title": "Why does a function constructed with pattern matching have the Eq type constraint but not when using a data constructor?", "body": "<p>Why does ghci list an <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Eq.html\" rel=\"noreferrer\">equality type</a> constraint in the type signature for this function <code>matchInt</code> which I constructed via pattern matching:</p>\n\n<pre><code>$ ghci\nGHCi, version 8.2.1: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :{\nPrelude| matchInt 1 = 3\nPrelude| matchInt _ = 4\nPrelude| :}\nPrelude&gt; matchInt 1\n3\nPrelude&gt; matchInt 22\n4\nPrelude&gt; :t matchInt\nmatchInt :: (Eq a, Num a, Num p) =&gt; a -&gt; p\n</code></pre>\n\n<p>In contrast, when using a simple data constructor, there is no equality type constraint.</p>\n\n<pre><code>$ ghci\nGHCi, version 8.2.1: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; data Z = Y Int\nPrelude&gt; :{\nPrelude| matchDataInt (Y 1) = 3\nPrelude| matchDataInt _ = 4\nPrelude| :}\nPrelude&gt; matchDataInt (Y 1)\n3\nPrelude&gt; matchDataInt (Y 22)\n4\nPrelude&gt; :t matchDataInt\nmatchDataInt :: Num p =&gt; Z -&gt; p\n</code></pre>\n\n<p>Indeed instances of Z can <strong>not</strong> be compared:</p>\n\n<pre><code>Prelude&gt; Y 22 == Y 33\n&lt;interactive&gt;:11:1: error:\n    \u2022 No instance for (Eq Z) arising from a use of \u2018==\u2019\n    \u2022 In the expression: Y 22 == Y 33\n      In an equation for \u2018it\u2019: it = Y 22 == Y 33\n</code></pre>\n\n<p>So again, why does the <code>matchInt</code> function list equality as a type constraint but not the function <code>matchDataInt</code>?</p>\n\n<p>This <a href=\"https://stackoverflow.com/questions/15512541/why-add-eq-type-constraint-without-using\">question</a> is related. However, if an equality test is needed for <code>matchInt</code> then why isn't it needed for <code>matchDataInt</code>? And here I come to my key point: don't <strong>both</strong> <code>matchInt</code> and <code>matchDataInt</code> have to test against 1 for the pattern matching to operate?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1508905597, "post_id": 46923954, "comment_id": 80794880, "body": "You have an <code>x == x</code> condition. Probably not intended?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1508908275, "post_id": 46923954, "comment_id": 80795658, "body": "You write <code>deleteMax [x] = [x]</code>. But isn&#39;t <code>x</code> the largest element of <code>[x]</code>?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1508908331, "post_id": 46923954, "comment_id": 80795673, "body": "What should happen if the largest element is repeated? Like <code>deleteMax [3,1,3]</code>?"}, {"owner": {"reputation": 1055, "user_id": 593298, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51e634a7316f1a4101f65519d2110cce?s=128&d=identicon&r=PG", "display_name": "keep_learning", "link": "https://stackoverflow.com/users/593298/keep-learning"}, "edited": false, "score": 1, "creation_date": 1508913083, "post_id": 46923954, "comment_id": 80797566, "body": "These two lines are not executed  |x &gt;= y = y: deleteMax xs |x &lt; y = x: deleteMax xs because x == x is always true."}, {"owner": {"reputation": 3, "user_id": 8805334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a16b8c24ef89d84bbba5e9df77171eb?s=128&d=identicon&r=PG&f=1", "display_name": "Capi", "link": "https://stackoverflow.com/users/8805334/capi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1508914529, "post_id": 46923954, "comment_id": 80798376, "body": "Yes sorry i made the mistake and fixed the third line and removed the sixth line. @dfeuer if there are multiples of the same element then only one should be deleted. when i do: deleteMax [1,2,4,4,3] i get [1,4]"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1508914955, "post_id": 46923954, "comment_id": 80798630, "body": "You cannot do it in one pass. <code>[2,1,1,1,1,1,1,1,3]</code>. Should you remove <code>2</code>? You don&#39;t know until tge very end."}, {"owner": {"reputation": 3, "user_id": 8805334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a16b8c24ef89d84bbba5e9df77171eb?s=128&d=identicon&r=PG&f=1", "display_name": "Capi", "link": "https://stackoverflow.com/users/8805334/capi"}, "edited": false, "score": 0, "creation_date": 1508915589, "post_id": 46923954, "comment_id": 80798993, "body": "Yea thats the problem i cant figure out how to make it work without deleting all off the other values. deleteMax [1,2,4,4,3] should return [1,2,4,3] but its not it is deleting every value that is assigned to x."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1508923369, "post_id": 46923954, "comment_id": 80803956, "body": "You could call a helper function which stores the list before the current max the max and go through the list after the current max to see if there&#39;s something bigger."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1508930707, "post_id": 46923954, "comment_id": 80808981, "body": "You need to pass through the list twice. How about writing two functions? One would find the maximum element and the other would remove an element equal to a given one."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1508958334, "post_id": 46923954, "comment_id": 80827637, "body": "I chose the <code>[3,1,3]</code> example for a reason. Do you want that to produce <code>[3,1]</code> or <code>[1,3]</code>? I imagine you probably want to delete the first or last duplicate, but maybe you want to delete one of the others..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1508958941, "post_id": 46923954, "comment_id": 80827981, "body": "@n.m., you can&#39;t do it in one pass, but your approach seems like overkill. There&#39;s no need to perform more than one pass-worth of comparisons. Just find the index of the element to be removed."}, {"owner": {"reputation": 3, "user_id": 8805334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a16b8c24ef89d84bbba5e9df77171eb?s=128&d=identicon&r=PG&f=1", "display_name": "Capi", "link": "https://stackoverflow.com/users/8805334/capi"}, "edited": false, "score": 0, "creation_date": 1508959269, "post_id": 46923954, "comment_id": 80828171, "body": "I see what you are saying i think deleting the first one and getting [1,3] would be the way im thinking. I am still kind of new to haskell so i am trying to learn and figure out how to implement these ideas."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1508967047, "post_id": 46923954, "comment_id": 80832127, "body": "@n.m. Why can&#39;t we do it in one pass?  It&#39;s not like we&#39;d have to tie ourselves in a knot..."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1508968099, "post_id": 46923954, "comment_id": 80832594, "body": "@ThomasM.DuBuisson your input and output lists are on magnetic tapes and you have O(1) RAM. Ready?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1508968176, "post_id": 46923954, "comment_id": 80832622, "body": "@dfeuer I don&#39;t like indexing lists, but that&#39;s another option, yes."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1508970171, "post_id": 46923954, "comment_id": 80833313, "body": "@n.m., equivalently, you can save a zipper representing the position of the most recently encountered maximal element. The downside is that it allocates unnecessarily."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1508970962, "post_id": 46942856, "comment_id": 80833588, "body": "Although you <i>use</i> laziness, your solution is not as lazy as it could be. For example, I would expect <code>deleteMax [1..]</code> to be <code>[1..]</code>. As soon as we know an element is not the maximal element, we can emit it. We can be lazier in some cases if we delete the <i>last</i> copy of the maximal element rather than the <i>first</i> one, as we can then emit <code>3:1:</code> if we see <code>3 : 1 : 3 :</code>, but that&#39;s up to the OP."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1508978142, "post_id": 46942856, "comment_id": 80835535, "body": "I suspect the trick will be to produce a list of &quot;intermediate maxima&quot;. That is, the elements that are ever the largest seen so far. So for <code>[1,5,2,7,8]</code> we&#39;d end up with <code>([1,5,2,7], [1,5,7,8])</code>. I&#39;m not very good at tying knots, so I&#39;m not sure just how to accomplish that."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 0, "last_activity_date": 1508971036, "last_edit_date": 1508971036, "creation_date": 1508969517, "answer_id": 46942856, "question_id": 46923954, "link": "https://stackoverflow.com/questions/46923954/haskell-delete-largest-number-from-a-list/46942856#46942856", "title": "Haskell delete largest number from a list", "body": "<p><strong>This is not your answer</strong></p>\n\n<p>So you are a beginner and as such would like the simple solution of \"how do I find the largest element in a list\" followed by \"how do I remove (one of the) largest element(s) in the list\".  This isn't that answer but it is me avoiding a long comment while also giving you something to come back to in 3 months.</p>\n\n<p><strong>The Lazy Way</strong></p>\n\n<p>One solution, which @n.m. and I were sparring about in comments, is to tie the knot (Googleable term).  In this method you only need one logical pass over the list.  In this case it is basically a trick to hide the pass that constructs the result list.</p>\n\n<p>The idea is that during your pass over the list you do both tasks of 1. Compute the maximum element and 2. Compare with the maximum element and construct the list.  There is nothing here that requires a monad but it can be easiest to see as part of a state monad:</p>\n\n<pre><code>deleteMaxState :: (Ord a) =&gt; [a] -&gt; [a]\ndeleteMaxState []       = []\n</code></pre>\n\n<p>First we handle the base cases so we have a candidate 'maximum' (<code>x</code>) for our recursive operation.</p>\n\n<pre><code>deleteMaxState xs@(fstElem:_) =\n    let (r,(m,_)) = runState (go xs) (fstElem, notMax m)\n        notMax mx v = if (mx &gt; v) then (v:) else id\n        go [] = return []\n        go (x:xs) =\n            do (curr,f) &lt;- get\n               when (x &gt; curr) (put (x,f))\n               f x &lt;$&gt; go xs\n    in r\n</code></pre>\n\n<p>In the loopwe track two values the first, <code>curr</code>, is the largest observed value by this point in our traversal of the list.  The second value, <code>f</code>, is the trick - it is (a function including) the maximum value provided to the computation <em>after</em> the traversal has completed.</p>\n\n<p>The magic is all here:</p>\n\n<pre><code>(r,(m,_)) = runState (go xs) (fstElem, m)\n</code></pre>\n\n<p>The left element of the result state <code>(m,_)</code> was our running maximum. Once the traversal ends we use that value - it becomes the right element <code>(fstElem, m)</code> and thus represents the maximum of the whole list.</p>\n\n<p>We can use <code>f</code> to create thunks that populate portions of the list or just in-line construct our list as a bunch of unevaluated <code>cons</code> computations.</p>\n\n<p>Making this one iota simpler, we can remove the higher-order function <code>f</code> and just have a number (untested):</p>\n\n<pre><code>deleteMaxState xs@(fstElem:_) =\n    let (r,(m,_)) = runState (go xs) (fstElem, m)\n        go [] = return []\n        go (x:xs) =\n            do (curr,theMax) &lt;- get\n               when (x &gt; curr) (put (x,theMax))\n               ((if x &gt;= theMax then Nothing else Just x) :) &lt;$&gt; go xs\n    in catMaybes r\n</code></pre>\n\n<p>Now we can see the second pass pretty explicitly not just as an unevaluated set of \"some computation involving max, consed on the result\" but as an actual pass via <code>catMaybes</code>.</p>\n\n<p>The tying of the knot allows the programmer to write one logical traversal.  This can be nice since it requires only one pattern match and recursive call per constructor of the list elements but at the cost of reasoning about evaluation order.</p>\n"}], "owner": {"reputation": 3, "user_id": 8805334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a16b8c24ef89d84bbba5e9df77171eb?s=128&d=identicon&r=PG&f=1", "display_name": "Capi", "link": "https://stackoverflow.com/users/8805334/capi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 290, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1508971036, "creation_date": 1508905336, "last_edit_date": 1508914391, "question_id": 46923954, "link": "https://stackoverflow.com/questions/46923954/haskell-delete-largest-number-from-a-list", "title": "Haskell delete largest number from a list", "body": "<p>I am trying to figure out how to create a recursive function that will find the largest element in the list and delete it then return the list. This is what i have so far but the problem is that every time i run it it returns the list without any of the values that are assigned to x.</p>\n\n<pre><code>deleteMax :: (Ord a) =&gt; [a] -&gt; [a]\ndeleteMax  [] = []\ndeleteMax [x] = []\ndeleteMax (x:y:xs) \n    |x == y = y: deleteMax xs \n    |x &gt;= y = y: deleteMax xs\n    |x &lt; y = x: deleteMax xs\n</code></pre>\n"}, {"tags": ["haskell", "compiler-errors"], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 8803495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-GggLHj8BIh0/AAAAAAAAAAI/AAAAAAAAAaQ/6rueIMZ0FTk/photo.jpg?sz=128", "display_name": "Pain", "link": "https://stackoverflow.com/users/8803495/pain"}, "is_accepted": false, "score": 0, "last_activity_date": 1508905092, "creation_date": 1508905092, "answer_id": 46923915, "question_id": 46923878, "link": "https://stackoverflow.com/questions/46923878/haskell-parse-error-on-in-otherwise/46923915#46923915", "title": "Haskell : Parse error on &quot;|&quot; in otherwise", "body": "<p>Of course it's when you ask a question that you figure out another way around...\nI still don't know why I had that error, however the simple solution is to use an \"else\" instead.\nWhich I've done and can now fix the multitude of errors from this function.</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 8803495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-GggLHj8BIh0/AAAAAAAAAAI/AAAAAAAAAaQ/6rueIMZ0FTk/photo.jpg?sz=128", "display_name": "Pain", "link": "https://stackoverflow.com/users/8803495/pain"}, "edited": false, "score": 0, "creation_date": 1508944282, "post_id": 46924295, "comment_id": 80819183, "body": "Ah I see, I will remember that next time. No ifs with guards unless fully completed (with else)."}], "tags": [], "owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "is_accepted": true, "score": 3, "last_activity_date": 1508907571, "creation_date": 1508907571, "answer_id": 46924295, "question_id": 46923878, "link": "https://stackoverflow.com/questions/46923878/haskell-parse-error-on-in-otherwise/46924295#46924295", "title": "Haskell : Parse error on &quot;|&quot; in otherwise", "body": "<p>You were close but not quite with the guard syntax, which does not use the <code>if</code>/<code>then</code>/<code>else</code> keywords.</p>\n\n<pre><code>convertElements :: [(String, String, String)] -&gt; [(String, String, String)]\nconvertElements [] = []\nconvertElements (x:y:xs) = x : (a,b,c) : convertElements ((a,b,c) : xs)\n  where b = getSecond y\n        c = getThird y\n        a | containsDash (getThird x) &gt; 0 = last (getThird x)\n          | otherwise = getFirst y\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 8803495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-GggLHj8BIh0/AAAAAAAAAAI/AAAAAAAAAaQ/6rueIMZ0FTk/photo.jpg?sz=128", "display_name": "Pain", "link": "https://stackoverflow.com/users/8803495/pain"}, "edited": false, "score": 0, "creation_date": 1508944238, "post_id": 46926391, "comment_id": 80819137, "body": "Ah this makes a lot of sense, thanks for the extra input :) Does that mean that ALL if statements require an else in Haskell? Can&#39;t I just have it as if this then do that ?"}, {"owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "reply_to_user": {"reputation": 47, "user_id": 8803495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-GggLHj8BIh0/AAAAAAAAAAI/AAAAAAAAAaQ/6rueIMZ0FTk/photo.jpg?sz=128", "display_name": "Pain", "link": "https://stackoverflow.com/users/8803495/pain"}, "edited": false, "score": 0, "creation_date": 1508951494, "post_id": 46926391, "comment_id": 80823717, "body": "@Pain <code>if</code>/<code>then</code>/<code>else</code> is an expression. If there is only a <code>then</code> case, what is the type of the expression when <code>if</code> is not true?  Now, sometimes the result is discardable. For example, there is the <code>when :: Monad m =&gt; Bool -&gt; m () -&gt; m ()</code> function, which is equivalent to <code>return ()</code> if the condition is false."}], "tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 2, "last_activity_date": 1508916334, "creation_date": 1508916334, "answer_id": 46926391, "question_id": 46923878, "link": "https://stackoverflow.com/questions/46923878/haskell-parse-error-on-in-otherwise/46926391#46926391", "title": "Haskell : Parse error on &quot;|&quot; in otherwise", "body": "<p>To expand a bit on @ephemient's answer: <code>|</code> <em>can</em> be followed by <code>if ...</code> but that makes <code>if</code>-expression the guard, so the compiler is expecting to see</p>\n\n<pre><code> a | if ... then ... else ... = ...\n</code></pre>\n\n<p>But the second <code>|</code> shows up before <code>else</code> does, so you get an error there.</p>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 2, "last_activity_date": 1508918951, "creation_date": 1508918951, "answer_id": 46927180, "question_id": 46923878, "link": "https://stackoverflow.com/questions/46923878/haskell-parse-error-on-in-otherwise/46927180#46927180", "title": "Haskell : Parse error on &quot;|&quot; in otherwise", "body": "<p>You can do</p>\n\n<pre><code>a | ...condition... = ...value...\n  | otherwise       = ...value...\n</code></pre>\n\n<p><em>or</em> you can do</p>\n\n<pre><code>a = if ...condition... then ...value... else ...value...\n</code></pre>\n\n<p>But not both. Most particularly, you can't have <code>if</code> without <code>then</code> <em>and</em> <code>else</code>. In Haskell, <code>if</code> isn't a statement, it's an expression (rather like the C ternary operator <code>?:</code>, if you know of that).</p>\n"}], "owner": {"reputation": 47, "user_id": 8803495, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-GggLHj8BIh0/AAAAAAAAAAI/AAAAAAAAAaQ/6rueIMZ0FTk/photo.jpg?sz=128", "display_name": "Pain", "link": "https://stackoverflow.com/users/8803495/pain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 702, "favorite_count": 0, "accepted_answer_id": 46924295, "answer_count": 4, "score": 0, "last_activity_date": 1508918951, "creation_date": 1508904799, "question_id": 46923878, "link": "https://stackoverflow.com/questions/46923878/haskell-parse-error-on-in-otherwise", "title": "Haskell : Parse error on &quot;|&quot; in otherwise", "body": "<p>I am trying to compile the following code, but am getting a \"parse error on \"|\" in the otherwise statement\"</p>\n\n<p>Now I am confused as I have used pretty much similar syntax in a few other functions, the only difference being this one takes 2 elements on a list and tries to reconstruct one (FYI: Did not test it yet as I can't compile, so the code in the convertElements line might be wrong!)</p>\n\n<p>I am using spaces, and everything seems aligned. Any idea as to what would be causing it? I moved it to the bottom of the where in case it helped, but alas it did not.</p>\n\n<pre><code>convertElements :: [(String, String, String)] -&gt; [(String, String, String)]\nconvertElements [] = []\nconvertElements (x:y:xs) = x: (a,b,c) : convertElements((a,b,c) ++ xs)\n                    where b = (getSecond y)\n                          c = (getThird y)\n                          a | if ((containsDash (getThird x)) &gt; 0) then last (getThird x)\n                            | otherwise = (getFirst y)\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 4724765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-ZxRSYYYw3Ok/AAAAAAAAAAI/AAAAAAAAAA8/XcIZ_iULnXU/photo.jpg?sz=128", "display_name": "Charles Zhang", "link": "https://stackoverflow.com/users/4724765/charles-zhang"}, "edited": false, "score": 0, "creation_date": 1508904680, "post_id": 46923689, "comment_id": 80794640, "body": "Understand now! Thanks!"}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 4, "last_activity_date": 1508903555, "creation_date": 1508903555, "answer_id": 46923689, "question_id": 46923581, "link": "https://stackoverflow.com/questions/46923581/couldnt-match-expected-type-integer-t-with-actual-type/46923689#46923689", "title": "Couldn&#39;t match expected type &#39;Integer -&gt; t&#39; with actual type", "body": "<p>Your <code>showPerson</code> function, as declared, has only one argument. This argument is of type <code>People</code>.</p>\n\n<p>However, judging by the error you're quoting, you are trying to call this function with two arguments - <code>\"charles\"</code> and <code>18</code>. The first argument is of type <code>String</code>, second - of type <code>Int</code>.</p>\n\n<p>This is what the compiler is trying to tell you when it says:</p>\n\n<pre><code>The function `showPerson' is applied to two arguments, \nbut its type `People -&gt; [Char]' has only one\n</code></pre>\n\n<p>To correctly call your function, you need to first create a value of type <code>People</code>, then pass that value to the function as argument:</p>\n\n<pre><code>p = Person \"charles\" 18\nshowPerson p\n</code></pre>\n\n<p>Or the same thing in one line:</p>\n\n<pre><code>showPerson (Person \"charles\" 18)\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 4724765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-ZxRSYYYw3Ok/AAAAAAAAAAI/AAAAAAAAAA8/XcIZ_iULnXU/photo.jpg?sz=128", "display_name": "Charles Zhang", "link": "https://stackoverflow.com/users/4724765/charles-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 0, "accepted_answer_id": 46923689, "answer_count": 1, "score": 0, "last_activity_date": 1508903555, "creation_date": 1508902845, "last_edit_date": 1508903200, "question_id": 46923581, "link": "https://stackoverflow.com/questions/46923581/couldnt-match-expected-type-integer-t-with-actual-type", "title": "Couldn&#39;t match expected type &#39;Integer -&gt; t&#39; with actual type", "body": "<p>I'm trying to run this textbook example but I keep getting this error: <br/> </p>\n\n<pre><code>* Couldn't match expected type `Integer -&gt; t'\n              with actual type `[Char]'\n* The function `showPerson' is applied to two arguments,\n  but its type `People -&gt; [Char]' has only one\n  In the expression: showPerson \"charles\" 18\n  In an equation for `it': it = showPerson \"charles\" 18\n* Relevant bindings include it :: t (bound at &lt;interactive&gt;:38:1)\n</code></pre>\n\n<p>I don't understand why I'm getting this error. I'm inputting the correct types. <br/>\nMy code is: <br/></p>\n\n<pre><code>type Name = String \ntype Age = Int\ndata People = Person Name Age\n\nshowPerson :: People -&gt; String\nshowPerson (Person a b) = a ++ \" -- \" ++ show b\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1508901396, "post_id": 46923306, "comment_id": 80793884, "body": "Check the parity of your parentheses."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1508919848, "post_id": 46923746, "comment_id": 80801663, "body": "Much better than the original code. One can also use <code>print</code> instead of <code>putStrLn . show</code>."}], "tags": [], "owner": {"reputation": 1055, "user_id": 593298, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51e634a7316f1a4101f65519d2110cce?s=128&d=identicon&r=PG", "display_name": "keep_learning", "link": "https://stackoverflow.com/users/593298/keep-learning"}, "is_accepted": true, "score": 5, "last_activity_date": 1508903917, "creation_date": 1508903917, "answer_id": 46923746, "question_id": 46923306, "link": "https://stackoverflow.com/questions/46923306/how-to-change-this-do-block-to-original-monad-code/46923746#46923746", "title": "How to change this do block to original monad code?", "body": "<p>I think using case of construct would make your code much clear, but this is just personal choice. Also putStrLn (height+weight) is incorrect, because height and weight are strings and your treating them as integers. Maybe you mean ++ ? </p>\n\n<pre><code>loop height weight =\n  getLine &gt;&gt;= \\line -&gt;\n  case line of\n    \"1\" -&gt; getLine &gt;&gt;= \\height -&gt; loop height weight\n    \"2\" -&gt; getLine &gt;&gt;= \\weight -&gt; loop height weight\n    \"3\" -&gt; putStrLn . show $ (read height :: Int) + (read weight :: Int)\n    _ -&gt; putStrLn \"error\"\n</code></pre>\n"}], "owner": {"reputation": 1277, "user_id": 7254635, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/280e5fa5140a804fcd8fd9dfe3198542?s=128&d=identicon&r=PG&f=1", "display_name": "wang kai", "link": "https://stackoverflow.com/users/7254635/wang-kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 46923746, "answer_count": 1, "score": 1, "last_activity_date": 1508903917, "creation_date": 1508900912, "question_id": 46923306, "link": "https://stackoverflow.com/questions/46923306/how-to-change-this-do-block-to-original-monad-code", "title": "How to change this do block to original monad code?", "body": "<p>I have this code:</p>\n\n<pre><code>loop height weight=do\nline&lt;-getLine\nif line==\"1\" then\n    do\n        height&lt;-getLine\n        loop height weight\nelse if line==\"2\" then\n    do \n        weight&lt;-getLine\n        loop height weight\n    else if line==\"3\" then\n        do\n            putStrLn (height)\n        else\n            do\n                putStrLn \"error\"\n</code></pre>\n\n<p>someone told me there is so much \"do\",I try to change this code not to use \"do\":</p>\n\n<pre><code>loop height weight=\ngetLine&gt;&gt;=(\\line-&gt;(\nif line==\"1\" then\n    getLine&gt;&gt;=(\\height-&gt;\n    loop height weight\nelse if line==\"2\" then\n    getLine&gt;&gt;=(\\weight-&gt;\n    loop height weight\n    else if line==\"3\" then\n            putStrLn (height+weight)\n        else\n                putStrLn \"error\"))))\n</code></pre>\n\n<p>but the compiler told me there is some wrong on line if line==\"2\" and I can't fix it</p>\n\n<p>can you teach me how to change this code without \"do\"?</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 4, "creation_date": 1508890859, "post_id": 46921927, "comment_id": 80791232, "body": "StackOverflow is not a code writing service. Please try to write a solution, and then ask a question if you run into any problems. At the moment, this is not a question. This also looks like homework."}, {"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "edited": false, "score": 4, "creation_date": 1508891493, "post_id": 46921927, "comment_id": 80791387, "body": "Why not do it in two steps: First, find the max, second, modify the list? Should be O(n)"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1508901287, "post_id": 46921927, "comment_id": 80793860, "body": "<code>deleteMax xs = delete (maximum xs) xs</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1055, "user_id": 593298, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51e634a7316f1a4101f65519d2110cce?s=128&d=identicon&r=PG", "display_name": "keep_learning", "link": "https://stackoverflow.com/users/593298/keep-learning"}, "is_accepted": true, "score": 1, "last_activity_date": 1508901968, "creation_date": 1508901968, "answer_id": 46923452, "question_id": 46921927, "link": "https://stackoverflow.com/questions/46921927/remove-maximum-value-of-a-list-in-haskell-using-recursion/46923452#46923452", "title": "Remove maximum value of a list in haskell using recursion", "body": "<p>The findMax function computes the maximum element of list, and removeMax removes the first occurrence of maximum element. You can glue them together to compute what you are looking for. </p>\n\n<pre><code>findMax :: [Int] -&gt; Int -&gt; Int\nfindMax [] acc = acc\nfindMax (h : rest) acc\n  | h &gt; acc = findMax rest h\n  | otherwise = findMax rest acc\n\n\nremoveMax :: [Int] -&gt; Int -&gt; [Int]\nremoveMax []  mx = []\nremoveMax (h : rest) mx\n  | h == mx = rest\n  | otherwise = h : removeMax rest mx  \n\n\u03bb&gt; findMax [2, 1, 4, 4, 3] 0\n4\n\u03bb&gt; removeMax [2, 1, 4, 4, 3] 4\n[2,1,4,3]\n\u03bb&gt; \n</code></pre>\n"}], "owner": {"reputation": 180, "user_id": 4062703, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/800e914a86d649e4f3c7f543398071d8?s=128&d=identicon&r=PG", "display_name": "tontus", "link": "https://stackoverflow.com/users/4062703/tontus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 858, "favorite_count": 0, "closed_date": 1508919655, "accepted_answer_id": 46923452, "answer_count": 1, "score": 0, "last_activity_date": 1508901968, "creation_date": 1508890479, "question_id": 46921927, "link": "https://stackoverflow.com/questions/46921927/remove-maximum-value-of-a-list-in-haskell-using-recursion", "closed_reason": "Not suitable for this site", "title": "Remove maximum value of a list in haskell using recursion", "body": "<p>I am new to functional programming. I want to implement a method that removes the max element from a list of Ints, or if there are duplicates of the max element, just remove one of them using recursion. E.g., [2, 1, 4, 4, 3] should become [2, 1, 4, 3]. Without sorting the list.</p>\n"}, {"tags": ["algorithm", "haskell", "duplicates"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1508885773, "post_id": 46921233, "comment_id": 80790003, "body": "How about you make a recursive function that walks down the first list and removes the matching element from the second list if/when encountered?"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1508919231, "post_id": 46921296, "comment_id": 80801291, "body": "Since the OP is learning Haskell, I guess she want to code this herself as an exercise. In such case, I&#39;d suggest to follow the last solution, exploiting <code>sort</code>, and re-write <code>isect</code> by plain recursion."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1508886079, "creation_date": 1508886079, "answer_id": 46921296, "question_id": 46921233, "link": "https://stackoverflow.com/questions/46921233/haskell-shared-letters-between-two-words/46921296#46921296", "title": "Haskell: shared letters between two words", "body": "<p>You can use the <a href=\"http://hackage.haskell.org/package/multiset\" rel=\"nofollow noreferrer\">multiset</a> package:</p>\n\n<pre><code>Data.MultiSet&gt; fromList \"hello\" `intersection` fromList \"llama\"\nfromOccurList [('l',2)]\nData.MultiSet&gt; fromList \"happy\" `intersection` fromList \"pay\"\nfromOccurList [('a',1),('p',1),('y',1)]\n</code></pre>\n\n<p>The <a href=\"http://hackage.haskell.org/package/data-ordlist\" rel=\"nofollow noreferrer\">data-ordlist</a> package also offers this functionality:</p>\n\n<pre><code>Data.List Data.List.Ordered&gt; sort \"hello\" `isect` sort \"llama\"\n\"ll\"\nData.List Data.List.Ordered&gt; sort \"happy\" `isect` sort \"pay\"\n\"apy\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1509001545, "last_edit_date": 1509001545, "creation_date": 1508944613, "answer_id": 46936155, "question_id": 46921233, "link": "https://stackoverflow.com/questions/46921233/haskell-shared-letters-between-two-words/46936155#46936155", "title": "Haskell: shared letters between two words", "body": "<p>I think this is an ideal case to use Data.Map. I would implement this as follows;</p>\n\n<pre><code>import qualified Data.Map.Lazy as M\n\nsharedLetters :: String -&gt; String -&gt; String\nsharedLetters s1 s2 = let cm = foldr (checkMap (\\(x,y) -&gt; (x,y+1))) charMap s2\n                               where checkMap f c m = if M.member c m then M.adjust f c m\n                                                                      else M.insert c (f (0,0)) m\n                                     charMap        = foldr (checkMap (\\(x,y) -&gt; (x+1,y))) M.empty s1\n                      in M.foldlWithKey (\\r k (v1,v2) -&gt; r ++ replicate (minimum [v1,v2]) k) \"\" cm\n\nmain :: IO String\nmain = do\n  putStr \"Enter first string  :\"\n  s1 &lt;- getLine\n  putStr \"Enter second string :\"\n  s2 &lt;- getLine\n  return $ sharedLetters s1 s2\n\nEnter first string  :happy\nEnter second string :pay\n\"apy\"\n\nEnter first string  :pay\nEnter second string :happy\n\"apy\"\n\nEnter first string  :hello\nEnter second string :llama\n\"ll\"\n\nEnter first string  :llama\nEnter second string :hello\n\"ll\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 0, "last_activity_date": 1508989524, "creation_date": 1508989524, "answer_id": 46945533, "question_id": 46921233, "link": "https://stackoverflow.com/questions/46921233/haskell-shared-letters-between-two-words/46945533#46945533", "title": "Haskell: shared letters between two words", "body": "<p>Here's a nice technique that's worth learning.  Suppose you have two sorted lists:</p>\n\n<pre><code>[1,1,5,10,15,15,18]\n[2,5,8,10,15,20]\n</code></pre>\n\n<p>and you want to merge them together into a single sorted list.  In Haskell, there's a very elegant way to write this algorithm using pattern matching and guards:</p>\n\n<pre><code>merge (x:xs) (y:ys) | x &lt; y     =  x : merge xs (y:ys)\n                    | otherwise =  y : merge (x:xs) ys\nmerge xs [] = xs\nmerge [] ys = ys\n</code></pre>\n\n<p>so that:</p>\n\n<pre><code>&gt; merge [1,1,5,10,15,15,18] [2,5,8,10,15,20]\n[1,1,2,5,5,8,10,10,15,15,15,18,20]\n&gt; \n</code></pre>\n\n<p>In a nutshell, when both lists are non-empty, it compares the heads of both lists and outputs the smallest head; then it uses recursion to output \"the rest\".</p>\n\n<p>It could also have been written with the three cases (less, greater, and equal) all made explicit:</p>\n\n<pre><code>merge (x:xs) (y:ys) | x &lt; y     =  x : merge xs (y:ys)\n                    | x &gt; y     =  y : merge (x:xs) ys\n                    | otherwise =  y : merge (x:xs) ys\nmerge xs [] = xs\nmerge [] ys = ys\n</code></pre>\n\n<p>and this general template can be used to implement a number of interesting algorithms on sorted lists.  Here's one that removes common elements, for example:</p>\n\n<pre><code>uncommon (x:xs) (y:ys) | x &lt; y     =  x : uncommon xs (y:ys)\n                       | x &gt; y     =  y : uncommon (x:xs) ys\n                       | otherwise =  uncommon xs ys\nuncommon xs [] = xs\nuncommon [] ys = ys\n</code></pre>\n\n<p>so that:</p>\n\n<pre><code>&gt; uncommon [1,1,5,10,15,15,18] [2,5,8,10,15,20]\n[1,1,2,8,15,18,20]\n&gt;\n</code></pre>\n\n<p>You might want to try modifying the <code>uncommon</code> function to create a <code>diff</code> function that outputs the result of removing the elements of the second list from the first.  It will require modifying one of the first three guarded cases, and you'll also need to adjust one of the two \"empty list\" pattern matches:</p>\n\n<pre><code>&gt; diff [1,1,5,10,15,15,18] [2,5,8,10,15,20]\n[1,1,15,18]\n&gt;\n</code></pre>\n\n<p>Once you've figured this out, you'll find it easy to create a <code>common</code> function that outputs the shared elements of the two sorted lists to give:</p>\n\n<pre><code>&gt; common [1,1,5,10,15,15,18] [2,5,8,10,15,20]\n[5,10,15]\n&gt;\n</code></pre>\n\n<p>Since strings are just lists of characters, this would work for your problem, too, using <code>sort</code> from <code>Data.List</code> to pre-sort the lists:</p>\n\n<pre><code>&gt; import Data.List\n&gt; common (sort \"hello\") (sort \"llama\")\n\"ll\"\n&gt; common (sort \"happy\") (sort \"pay\")\n\"apy\"\n&gt; \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10557, "user_id": 1157237, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f2f62795a806ed2f35d96af1ba9a539e?s=128&d=identicon&r=PG", "display_name": "gcbenison", "link": "https://stackoverflow.com/users/1157237/gcbenison"}, "is_accepted": false, "score": 0, "last_activity_date": 1509022146, "creation_date": 1509022146, "answer_id": 46954809, "question_id": 46921233, "link": "https://stackoverflow.com/questions/46921233/haskell-shared-letters-between-two-words/46954809#46954809", "title": "Haskell: shared letters between two words", "body": "<p>How about exploiting the fact that every letter shared between the words (allowing duplicates) shows up as a pair of that letter in the set formed from the union of those words?  You can find such pairs efficiently by sorting the union set and picking out duplicates -</p>\n\n<pre><code>let find_dups ([]) = []; find_dups (x:y:xs) | x == y = x:find_dups(xs); find_dups (x:xs) = find_dups(xs)                                              \nlet common_letters word1 word2 = find_dups (sort (word1 ++ word2))\n\n&gt; common_letters \"hello\" \"fellows\"\n\"ello\"\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 7396005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ec94c8d1820a9b655af9c22339c55cd?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy", "link": "https://stackoverflow.com/users/7396005/timothy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "answer_count": 4, "score": 3, "last_activity_date": 1563080757, "creation_date": 1508885658, "last_edit_date": 1563080757, "question_id": 46921233, "link": "https://stackoverflow.com/questions/46921233/haskell-shared-letters-between-two-words", "title": "Haskell: shared letters between two words", "body": "<p>I just started learning Haskell. I am trying to get the list of all common letters between two words, for example, for <code>\"hello\"</code> and <code>\"llama\"</code> that would be <code>[ 'l', 'l' ]</code>, for <code>\"happy\"</code> and <code>\"pay\"</code>, <code>[ 'a', 'p', 'y' ]</code>.</p>\n\n<p>I tried using intersect but I have trouble with duplicates, <code>\"happy\"</code> and <code>\"pay\"</code> result in <code>[ 'a', 'p', 'p', 'y' ]</code>. I can't just remove duplicates cause they can exist, as in the first example.</p>\n\n<p>I would be grateful for any suggestions. Thanks!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 2, "creation_date": 1508883983, "post_id": 46920930, "comment_id": 80789473, "body": "What does &quot;only one cycle&quot; mean?  If you mean a single traversal of the list, are you sure that&#39;s necessary if you take advantage of laziness?"}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1508888743, "post_id": 46921373, "comment_id": 80790735, "body": "This is nicer with <code>scanl</code>, isn&#39;t it? <code>thePriceIsRight max = takeWhile (&lt;= max) . scanl (+) 0</code>. edit: actually I see it is asking for the items themselves, not the cumulative sums. Okay, maybe not so easy to use <code>scanl</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1508886583, "creation_date": 1508886583, "answer_id": 46921373, "question_id": 46920930, "link": "https://stackoverflow.com/questions/46920930/haskell-iterate-if-condition-is-false/46921373#46921373", "title": "Haskell Iterate If Condition is False", "body": "<p>Walk down the list, emitting elements until their total is too big. So:</p>\n\n<pre><code>thePriceIsRight max (x:xs) | x &lt;= max = x : thePriceIsRight (max-x) xs\nthePriceIsRight _ _ = []\n</code></pre>\n\n<p>In ghci:</p>\n\n<pre><code>&gt; thePriceIsRight 30 [1,3,4,5,6,7,8]\n[1,3,4,5,6,7]\n</code></pre>\n"}], "owner": {"reputation": 376, "user_id": 7271772, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/eef9b3cffd3ca044729a43c23f7232d9?s=128&d=identicon&r=PG&f=1", "display_name": "George Morris", "link": "https://stackoverflow.com/users/7271772/george-morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 46921373, "answer_count": 1, "score": 0, "last_activity_date": 1508886583, "creation_date": 1508883613, "question_id": 46920930, "link": "https://stackoverflow.com/questions/46920930/haskell-iterate-if-condition-is-false", "title": "Haskell Iterate If Condition is False", "body": "<p>I have a set of numbers. For example <code>set = [1,3,4,5,6,7,8]</code>. I need to write a loop, that will only choose elements that are in total for example smaller than <code>max = 30</code>. </p>\n\n<pre><code>for(int i = 0;i&lt;set.length();i++) { total = total + set[i]; if (total &lt;= max) return i; }\n.....\nelements are from 0 to returned index\n</code></pre>\n\n<p>I have no idea how to do it recursively in haskell using only one cycle.</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1508882665, "post_id": 46920723, "comment_id": 80789026, "body": "What if one gives the empty list? Or a list with one element?"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1508882790, "post_id": 46920723, "comment_id": 80789058, "body": "Can you think of a way to create a list with every pair of adjacent numbers, <code>f [5, 6, 1, 3, 9] == [(5, 6), (6, 1), (1, 3), (3, 9)]</code>?"}, {"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 0, "creation_date": 1508883162, "post_id": 46920723, "comment_id": 80789204, "body": "Another possibility would be to make a recursive helper function <code>go</code>, that has an additional argument used as intermediate result (your current maximum). The problem: you have to find an initial value. Therefore consider changing the return type of your function and of the intermediate result to an <code>Maybe Int</code>."}], "answers": [{"tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 5, "last_activity_date": 1508883669, "creation_date": 1508883669, "answer_id": 46920947, "question_id": 46920723, "link": "https://stackoverflow.com/questions/46920723/keeping-a-value-during-a-recursive-function/46920947#46920947", "title": "Keeping a value during a recursive function", "body": "<p>Since Haskell lists are lazy, you can solve this problem using a list-based approach instead of explicitly holding onto a maximum without losing efficiency. Starting with the original list:</p>\n\n<pre><code>&gt; let f x = x\n&gt; f [5,6,1,3,9]\n[5,6,1,3,9]\n</code></pre>\n\n<p>get a list of pairs by <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:zip\" rel=\"noreferrer\"><code>zip</code></a>ping the entire list with a left-shifted list:</p>\n\n<pre><code>&gt; let f x = zip x (tail x)\n&gt; f [5,6,1,3,9]\n[(5,6),(6,1),(1,3),(3,9)]\n</code></pre>\n\n<p>use the related function <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:zipWith\" rel=\"noreferrer\"><code>zipWith</code></a> to get products instead of pairs:</p>\n\n<pre><code>&gt; let f x = zipWith (*) x (tail x)\n&gt; f [5,6,1,3,9]\n[30,6,3,27]\n</code></pre>\n\n<p>and get the <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:maximum\" rel=\"noreferrer\">maximum</a> from that list:</p>\n\n<pre><code>&gt; let f x = maximum (zipWith (*) x (tail x))\n&gt; f [5,6,1,3,9]\n30\n</code></pre>\n"}], "owner": {"reputation": 112, "user_id": 5091251, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9b46c1e797643ea0c87d681d760eabc7?s=128&d=identicon&r=PG", "display_name": "Thiago Nogueira", "link": "https://stackoverflow.com/users/5091251/thiago-nogueira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 46920947, "answer_count": 1, "score": 0, "last_activity_date": 1508883669, "creation_date": 1508882364, "last_edit_date": 1508882632, "question_id": 46920723, "link": "https://stackoverflow.com/questions/46920723/keeping-a-value-during-a-recursive-function", "title": "Keeping a value during a recursive function", "body": "<p>In Haskell, I'm trying to solve a problem where I need to have a function that receives a list of integers and returns the biggest product of two adjacent numbers.</p>\n\n<p>Example: f [5,6,1,3,9] would return 30, that is the product of 5 and 6</p>\n\n<p>The function type would be something like this:</p>\n\n<pre><code>f :: [Int] -&gt; Int\n</code></pre>\n\n<p>I thought to solve that using recursion to iterate the list getting the 2 head elements with a pattern like this: <code>(x1:x2:xs)</code>\nThe problem is that I don't know how to keep the product value to compare if the current product is bigger than the last product.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["validation", "security", "haskell", "ssl", "client-certificates"], "comments": [{"owner": {"reputation": 1848, "user_id": 3215929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nwUj2.png?s=128&g=1", "display_name": "Ente", "link": "https://stackoverflow.com/users/3215929/ente"}, "edited": false, "score": 0, "creation_date": 1571858052, "post_id": 46919308, "comment_id": 103383134, "body": "In addition to describing what you have done, I&#39;d suggest also adding some important bits of code. Also I would try asking just one question at a time. Maybe try splitting this huge post, with at least 5 questions, into separate questions."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 1848, "user_id": 3215929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nwUj2.png?s=128&g=1", "display_name": "Ente", "link": "https://stackoverflow.com/users/3215929/ente"}, "edited": false, "score": 0, "creation_date": 1571883489, "post_id": 46919308, "comment_id": 103389792, "body": "@Ente I disagree. This question explains perfectly what&#39;s desired, and there&#39;s no relevant code to be posted. It&#39;s also a single question on how to accomplish a single goal (validating client certificates) that&#39;s just an on/off setting in most programs, so it shouldn&#39;t be split up."}], "owner": {"reputation": 681, "user_id": 1072240, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1ef5bf598c44bbfa8b87fd77ccf2a993?s=128&d=identicon&r=PG", "display_name": "Jason Whittle", "link": "https://stackoverflow.com/users/1072240/jason-whittle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 1, "answer_count": 0, "score": 10, "last_activity_date": 1571276209, "creation_date": 1508876189, "question_id": 46919308, "link": "https://stackoverflow.com/questions/46919308/what-is-the-right-way-to-validate-a-client-tls-cert-using-the-tls-library-in-has", "title": "What is the right way to validate a client TLS cert using the tls library in Haskell?", "body": "<p>I have a working Yesod/Warp server. I would like to equip this server with the ability to allow admin users to authenticate themselves using client-side certificates. Additionally, I would like to assign each administrator their own client certificate, so that I can track them individually on the server. </p>\n\n<p>The current version of the server does not use TLS (it is currently deployed behind a TLS termination proxy), so I have created an additional executable target in the cabal file. This new executable replaces <code>Network.Wai.Handler.Warp.runSettings</code> from the <code>warp</code> package with <code>Network.Wai.Handler.WarpTLS.runTLS</code> from the <code>warp-tls</code> package. </p>\n\n<p>In the <code>Network.Wai.Handler.WarpTLS.TLSSettings</code> I provide to <code>runTLS</code>, I set <code>tlsWantClientCert</code> to <code>True</code> and provide an implementation of <code>onClientCertificate</code>. My question is, what do I need to do in <code>onClientCertificate</code> to make sure that the client cert is valid? What has already been checked about the client cert (if anything), and what still needs to be checked? Right now, the server cert chain and the client certs are unrelated; does the <code>tls</code> library do more if they\u2019re related in some way? </p>\n\n<p><code>Network.TLS</code> has a section labeled \u201cX509 Validation,\u201d but I don\u2019t see anything in that section that performs validation. Looking at the source, it seems that everything in that section comes from the <code>Data.X509.Validation</code> module in the <code>x509-validation</code> package. That module additionally provides a <code>validate</code> function. Is that sufficient? Is there an existing mapping from <code>Data.X509.Validation.FailedReason</code> to <code>Network.TLS.CertificateRejectReason</code>? </p>\n"}, {"tags": ["haskell", "gtk", "gtk3", "haskell-stack", "gtk2hs"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1508876727, "post_id": 46918693, "comment_id": 80786263, "body": "I think <code>stack build</code> uses cabal and your cabal file, which is unambiguous about which package provides the gtk bindings, whereas <code>stack exec -- ghc --make main.hs</code> uses all (with stack installed) packages which in your case includes both gtk versions. I cannot verify this right now, but i will check when I am at home"}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 2042053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8269ce33797e5d4b2fbb726b6e790328?s=128&d=identicon&r=PG", "display_name": "imalison", "link": "https://stackoverflow.com/users/2042053/imalison"}, "edited": false, "score": 0, "creation_date": 1508998386, "post_id": 46943870, "comment_id": 80841086, "body": "The target option seems much better to me. So I take it you would be against changing the behavior of <code>stack ghc</code> to be consistent with that of stack ghci because you don&#39;t want to break backwards compatibility?"}, {"owner": {"reputation": 195, "user_id": 2042053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8269ce33797e5d4b2fbb726b6e790328?s=128&d=identicon&r=PG", "display_name": "imalison", "link": "https://stackoverflow.com/users/2042053/imalison"}, "edited": false, "score": 0, "creation_date": 1508998849, "post_id": 46943870, "comment_id": 80841288, "body": "BTW - Just in case you are curious, the reason that I can&#39;t simply &quot;The most straightforward way to do it is to make a cabal package which has the executable target.&quot; is that this compilation is taking place through the dyre package: <a href=\"https://github.com/willdonnelly/dyre\" rel=\"nofollow noreferrer\">github.com/willdonnelly/dyre</a> . I suppose that things could be changed very significantly so that dyre tries to use stack more directly, but this was the quick and dirty fix that lives in the package ATM."}, {"owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "reply_to_user": {"reputation": 195, "user_id": 2042053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8269ce33797e5d4b2fbb726b6e790328?s=128&d=identicon&r=PG", "display_name": "imalison", "link": "https://stackoverflow.com/users/2042053/imalison"}, "edited": false, "score": 0, "creation_date": 1509005673, "post_id": 46943870, "comment_id": 80845249, "body": "Yeah, <code>stack ghc</code> came before the code for <code>stack ghci</code> existed.  I suppose if breaking changes are desired there it&#39;d probably be better to do them earlier rather than later."}], "tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": false, "score": 0, "last_activity_date": 1508976596, "creation_date": 1508976596, "answer_id": 46943870, "question_id": 46918693, "link": "https://stackoverflow.com/questions/46918693/both-versions-of-the-gtk-package-are-visible-when-running-stack-ghc/46943870#46943870", "title": "Both versions of the gtk package are visible when running `stack ghc`", "body": "<p>There's no builtin way to do this with stack currently.  However, it is possible to get <code>stack ghci</code> to do this.  The most straightforward way to do it is to make a cabal package which has the executable target.  However, if you really want to just use straight ghc, there is a way. Copy-pasting from my comment <a href=\"https://github.com/commercialhaskell/stack/issues/3338#issuecomment-321719239\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<p><code>stack ghc</code> works a bit differently than <code>stack ghci</code>.  It's essentially a synonym for <code>stack exec -- ghc</code>, which will run the right compiler with the right databases, but won't set up anything related to your local packages like include directories etc.  Note that <code>stack ghci</code> takes TARGET arguments whereas <code>stack ghc</code> does not.  Retrospectively, this is a bit inconsistent, but <code>stack ghc</code> came before <code>stack ghci</code>.</p>\n\n<p>It does make sense to have the ability to do something like this, though not sure how to best achieve that.  Some potential options:</p>\n\n<ul>\n<li><p><code>--no-interactive</code> argument on <code>stack ghci</code>.  Would be a bit obtuse.  Weird to run a <code>ghci</code> command when, though it would be using the <code>stack ghci</code> logic.</p></li>\n<li><p>Add <code>--target TARGET</code> option to <code>stack ghc</code>, to tell it to use the environment of a particular local package target.</p></li>\n</ul>\n\n<p>Here's a workaround for now.  Put the following in <code>~/.local/bin/stack-run-ghc.sh</code> and make it user executable:</p>\n\n<pre><code>#/bin/sh\nghc $(echo \"$*\" | sed 's/--interactive//g')\n</code></pre>\n\n<p>This takes the arguments, removes <code>--interactive</code>, and calls ghc.  With this, I can build stack using ghc via the following:</p>\n\n<p><code>stack ghci --with-ghc stack-run-ghc.sh --ghci-options src/main/Main.hs</code></p>\n"}], "owner": {"reputation": 195, "user_id": 2042053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8269ce33797e5d4b2fbb726b6e790328?s=128&d=identicon&r=PG", "display_name": "imalison", "link": "https://stackoverflow.com/users/2042053/imalison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508976596, "creation_date": 1508873751, "question_id": 46918693, "link": "https://stackoverflow.com/questions/46918693/both-versions-of-the-gtk-package-are-visible-when-running-stack-ghc", "title": "Both versions of the gtk package are visible when running `stack ghc`", "body": "<p>A minimal reproduction can be found here:</p>\n\n<p><a href=\"https://github.com/IvanMalison/stack-gtk2hs-bug\" rel=\"nofollow noreferrer\">https://github.com/IvanMalison/stack-gtk2hs-bug</a></p>\n\n<p>Everything works as expected when I use normal stack commands, but when I run the failing command:</p>\n\n<pre><code>stack ghc -- --make main.hs\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>main.hs:3:1: error:\nAmbiguous interface for \u2018Graphics.UI.Gtk\u2019:\n  it was found in multiple packages: gtk-0.14.6 gtk3-0.14.6\n\nmain.hs:4:1: error:\nAmbiguous interface for \u2018Graphics.UI.Gtk.Abstract.Widget\u2019:\n  it was found in multiple packages: gtk-0.14.6 gtk3-0.14.6\n\nmain.hs:5:1: error:\nAmbiguous interface for \u2018Graphics.UI.Gtk.Layout.Table\u2019:\n  it was found in multiple packages: gtk-0.14.6 gtk3-0.14.6\n</code></pre>\n\n<p>The output of <code>stack exec ghc-pkg -- --no-user-package-db list</code> is <a href=\"https://gist.github.com/f19f900988f49e4d03cd61f1cab48baa\" rel=\"nofollow noreferrer\">https://gist.github.com/f19f900988f49e4d03cd61f1cab48baa</a> . This output makes me expect that the reason that this is happening is that some other stack install required gtk (not gtk3 which is what is specified as a dependency in this package) and somehow this package is visible from the stack ghc command for some reason.</p>\n\n<p>Am I misunderstanding the stack ghc command? Shouldn't this essentially do the same thing as stack build?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "edited": false, "score": 0, "creation_date": 1508866274, "post_id": 46916561, "comment_id": 80780589, "body": "Can you do (Just x@A{})?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "edited": false, "score": 2, "creation_date": 1508866349, "post_id": 46916561, "comment_id": 80780629, "body": "@Carbon: sure. The <i>as</i> is a type of pattern. Since you can recurse on patterns, you can recurse with as patterns as well. In this case you thus will match the <code>Just (A a b c d)</code> pattern, but you are only interested in a reference to the content in the <code>Just</code> constructor."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 9, "last_activity_date": 1508866290, "last_edit_date": 1508866290, "creation_date": 1508866029, "answer_id": 46916561, "question_id": 46916479, "link": "https://stackoverflow.com/questions/46916479/get-data-object-from-case-statement/46916561#46916561", "title": "Get data object from case statement", "body": "<p>Yes you can use the <a href=\"https://www.haskell.org/onlinereport/exps.html#sect3.17.1\" rel=\"noreferrer\"><strong>as pattern <code>@</code></strong></a>:</p>\n\n<pre><code>exampleFunc :: Z -&gt; IO ()\nexampleFunc <b>x@</b>(A a b c d) = someOtherFunc <b>x</b></code></pre>\n\n<p>Furthermore by using <em>record syntax</em>, you can even fully omit the parameters <code>a</code>, <code>b</code>, <code>c</code> and <code>d</code> in the head of the function:</p>\n\n<pre><code>exampleFunc :: Z -&gt; IO ()\nexampleFunc x@A<b>{}</b> = someOtherFunc x</code></pre>\n\n<p>This is short for the above code fragment, but without having to specify the parameters. This can be useful if you for instance later plan to change the number of parameters, and you want to prevent having to change all function definitions that rely only on the constructor type (and not the parameters). <a href=\"https://en.wikibooks.org/wiki/Haskell/Pattern_matching#Introduction_to_records\" rel=\"noreferrer\"><em>Record pattern</em></a> can also be useful in case you are only interested in a subset of the parameters.</p>\n\n<p>Since patterns can be used recursively (a pattern as parameter of a constructor), you can also recursively use the as pattern. For example:</p>\n\n<pre><code>yetAnotherFunction :: Maybe Z -&gt; IO ()\nyetAnotherFunction x@(Just y@A{}) = -- ...</code></pre>\n\n<p>So here we obtain a reference to the <code>Just (A a b c d)</code> object, as well as to the <code>A a b c d</code> object. Apparentely <code>yetAnotherFunction</code> is not interested in the parameters of the <code>A</code>  constructor.</p>\n"}], "owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 46916561, "answer_count": 1, "score": 1, "last_activity_date": 1508866290, "creation_date": 1508865740, "question_id": 46916479, "link": "https://stackoverflow.com/questions/46916479/get-data-object-from-case-statement", "title": "Get data object from case statement", "body": "<p>Assume I have:</p>\n\n<pre><code>data Z = A Int Int Int Int | B String  | Char\n\nexampleFunc :: Z -&gt; IO ()\nexampleFunc (A a b c d) = someOtherFunc (A a b c d)\n</code></pre>\n\n<p>Is there a way to pass on the A that gets pattern matched without having to use the constructor in the function definition again?</p>\n"}, {"tags": ["haskell", "monads", "applicative"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 7, "creation_date": 1508857060, "post_id": 46913472, "comment_id": 80774731, "body": "It&#39;s not really a law, so much as an acknowledgement that lots of existing code implement <code>Applicative</code> in terms of a pre-existing <code>Monad</code> class, instead of implementing <code>Applicative</code> from scratch and defining <code>Monad</code> in terms of it. Defining <code>ap = (&lt;*&gt;)</code> would break that could, as <code>(&lt;*&gt;)</code> would then have a circular definition."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1508858978, "post_id": 46913472, "comment_id": 80776034, "body": "@chepner &quot;it&#39;s not really a law&quot; - does &quot;it&quot; here refer to the comment to <code>ap</code> that I posted? I&#39;m asking about the laws <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Applicative.html#t:Applicative\" rel=\"nofollow noreferrer\">here</a> starting &quot;It it is also a Monad it should also satisfy...&quot;, and the same (actually better documented) for <code>Monad</code>. But maybe you&#39;re saying that law is a <i>consequence</i> that Applicative instances are often defined in terms of their <code>Monad</code> instance?"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 6, "creation_date": 1508860967, "post_id": 46913472, "comment_id": 80777494, "body": "It&#39;s worth noting that there are significant Monads where the standard <code>ap</code> is a rather inefficient way to implement <code>&lt;*&gt;</code>. My favourite example is the vectors of a fixed length, where the <code>join</code> takes the diagonal of a square matrix: far better just to zip directly. So, the intention is that, <i>extensionally</i>, we should have <code>fm &lt;*&gt; sm = fm &gt;&gt;= \\ f -&gt; sm &gt;&gt;= \\s -&gt; return (f s)</code>, but to leave open the option to make <code>&lt;*&gt;</code> <i>intensionally</i> more efficient."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1508862338, "post_id": 46913472, "comment_id": 80778320, "body": "&quot;The context is me thinking about Validation and how unsatisfying it is that it can&#39;t seem to have a lawful Monad instance.&quot; Could you expand on what you mean by that? I personally don&#39;t find it at all unsatisfying - <code>Validation</code> <i>can&#39;t</i> have a <code>Monad</code> instance, because then it wouldn&#39;t be <code>Validation</code>. (What I do find unsatisfying is that Haskell doesn&#39;t have <a href=\"https://personal.cis.strath.ac.uk/conor.mcbride/pub/she/idiom.html\" rel=\"nofollow noreferrer\">nice syntactic sugar</a> for <code>Applicative</code> computations. <code>ApplicativeDo</code> helps a little...)"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1508865669, "post_id": 46913472, "comment_id": 80780250, "body": "@BenjaminHodgson I&#39;ve updated the question. Nice syntactic sugar is part of it, but what I&#39;m talking about is accumulating errors as far as possible, e.g. <code>(f &lt;$&gt; x &lt;*&gt; y &lt;*&gt; z) &gt;&gt;= thisMightFailDependingOnInput</code>. We already need to do this sort of composition everywhere, we just don&#39;t use <code>&gt;&gt;=</code> we use <code>bindV</code>."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1508867005, "post_id": 46913472, "comment_id": 80780965, "body": "@chepner I think I was unclear. I probably should have asked about the <code>Monad</code> law. That is I&#39;m trying to understand how precisely Applicative and Monad are meant to relate"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1508869064, "post_id": 46913472, "comment_id": 80782167, "body": "Every Monad gives rise to an Applicative (and for that induced Applicative, <code>&lt;*&gt; = ap</code> will hold definitionally), but given two structures - <code>Monad m</code> and <code>Applicative m</code> - there is no guarantee that these structures agree without the two laws <code>&lt;*&gt; = ap</code> and <code>pure = return</code> (e.g. take the &#39;regular&#39; Monad instance for lists, and the zip-list Applicative instances). While there is nothing fundamentally &#39;wrong&#39; about a Monad and Applicative instance disagreeing, it would probably be confusing to most users (and so it&#39;s prohibited by the Monad laws)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1508869150, "post_id": 46913472, "comment_id": 80782199, "body": "Regarding the edit, I <i>definitely</i> wouldn&#39;t go from &quot;law A implies law B&quot; to &quot;law B is the law we actually care about&quot;."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1508870408, "post_id": 46913472, "comment_id": 80782873, "body": "@DanielWagner what I&#39;m trying to get at are the real laws. It seems to me <code>(&lt;*&gt;) = ap</code> doesn&#39;t strictly imply anything (at least post-AMP). Presumably it&#39;s trying to express some relationship between <code>&lt;*&gt;</code> and the right-hand side of <code>ap</code>. Maybe I&#39;m being pedantic."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1508870886, "post_id": 46913472, "comment_id": 80783152, "body": "@user2407038 thanks, that&#39;s so obvious but really clarifies things for me, including how to think about e.g. a Monad instance for Validation. Would you mind making that an answer?"}], "answers": [{"comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1508878958, "post_id": 46918060, "comment_id": 80787460, "body": "Right, but the definition is free to change. But I&#39;ve realized that <code>(&lt;*&gt;) = ap</code> as a way of documenting the law made more sense pre-AMP; it probably only has one reasonable definition, and it wouldn&#39;t have been possible to define it literally as <code>ap = &lt;*&gt;</code>"}], "tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 4, "last_activity_date": 1508914001, "last_edit_date": 1592644375, "creation_date": 1508871389, "answer_id": 46918060, "question_id": 46913472, "link": "https://stackoverflow.com/questions/46913472/how-exactly-does-the-ap-applicative-monad-law-relate-the-two-classes/46918060#46918060", "title": "How exactly does the `(&lt;*&gt;) = ap` Applicative/Monad law relate the two classes?", "body": "<blockquote>\n<p>So I assume the <code>ap</code> in the <code>(&lt;*&gt;) = ap</code> law is shorthand for &quot;right-hand side of <code>ap</code>&quot; and the law actually expresses a relationship between <code>&gt;&gt;=</code>, <code>return</code> and <code>&lt;*&gt;</code> right?</p>\n<p>It seems to me <code>(&lt;*&gt;) = ap</code> doesn't strictly imply anything (at least post-AMP). Presumably it's trying to express some relationship between <code>&lt;*&gt;</code> and the right-hand side of <code>ap</code>. Maybe I'm being pedantic.</p>\n</blockquote>\n<p>Speaking pedantically, I'd say the opposite: because <code>ap</code> is <a href=\"https://ncatlab.org/nlab/show/equality\" rel=\"nofollow noreferrer\">definitionally equal</a> to its right-hand side, saying <code>(&lt;*&gt;) = ap</code> is exactly the same as saying <code>m1 &lt;*&gt; m2 = do { x1 &lt;- m1; x2 &lt;- m2; return (x1 x2) }</code>. It's just the normal first step of dealing with equalities like that: expanding the definitions.</p>\n<p>Reply to the comment:</p>\n<blockquote>\n<p>Right, but the definition is free to change.</p>\n</blockquote>\n<p>Then the law would change or be removed too. Just as when/if <code>join</code> is added to <code>Monad</code> the current definition will become a law instead.</p>\n<blockquote>\n<p>it wouldn't have been possible to define it literally as <code>ap = &lt;*&gt;</code></p>\n</blockquote>\n<p>Do you mean it would be impossible to define <code>ap</code> or the law in this way?</p>\n<p>If <code>ap</code>, then you are correct: it would have the wrong type. But stating the law like this would be fine.</p>\n"}, {"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 4, "last_activity_date": 1508871849, "creation_date": 1508871849, "answer_id": 46918181, "question_id": 46913472, "link": "https://stackoverflow.com/questions/46913472/how-exactly-does-the-ap-applicative-monad-law-relate-the-two-classes/46918181#46918181", "title": "How exactly does the `(&lt;*&gt;) = ap` Applicative/Monad law relate the two classes?", "body": "<p>Every <code>Monad</code> gives rise to an <code>Applicative</code>, and for that induced <code>Applicative</code>, <code>&lt;*&gt; = ap</code> will hold definitionally. But given two structures - <code>Monad m</code> and <code>Applicative m</code> - there is no guarantee that these structures agree without the two laws <code>&lt;*&gt; = ap</code> and <code>pure = return</code>. For example, take the 'regular' <code>Monad</code> instance for lists, and the zip-list <code>Applicative</code> instance. While there is nothing fundamentally 'wrong' about a <code>Monad</code> and <code>Applicative</code> instance disagreeing, it would probably be confusing to most users, and so it's prohibited by the <code>Monad</code> laws.</p>\n\n<p>tl;dr The laws in question serve to ensure that <code>Monad</code> and <code>Applicative</code> agree in an intuitively obvious way.</p>\n"}], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 734, "favorite_count": 0, "accepted_answer_id": 46918181, "answer_count": 2, "score": 5, "last_activity_date": 1508914001, "creation_date": 1508856052, "last_edit_date": 1508866698, "question_id": 46913472, "link": "https://stackoverflow.com/questions/46913472/how-exactly-does-the-ap-applicative-monad-law-relate-the-two-classes", "title": "How exactly does the `(&lt;*&gt;) = ap` Applicative/Monad law relate the two classes?", "body": "<p><code>ap</code> doesn't have a documented spec, and reads with a comment pointing out it could be <code>&lt;*&gt;</code>, but isn't for practical reasons:</p>\n\n<pre><code>ap                :: (Monad m) =&gt; m (a -&gt; b) -&gt; m a -&gt; m b\nap m1 m2          = do { x1 &lt;- m1; x2 &lt;- m2; return (x1 x2) }\n-- Since many Applicative instances define (&lt;*&gt;) = ap, we\n-- cannot define ap = (&lt;*&gt;)\n</code></pre>\n\n<p>So I assume the <code>ap</code> in the <code>(&lt;*&gt;) = ap</code> law is shorthand for \"right-hand side of ap\" and the law actually expresses a relationship between <code>&gt;&gt;=</code> , <code>return</code> and <code>&lt;*&gt;</code> right? Otherwise the law is meaningless.</p>\n\n<p>The context is me thinking about <code>Validation</code> and how unsatisfying it is that it can't seem to have a lawful <code>Monad</code> instance. I'm also thinking about <code>ApplicativeDo</code> and how that transformation sort of lets us recover from the practical effects of a <code>Monad</code> instance for <code>Validation</code>; what I most often want to do is accumulate errors as far as possible, but still be able to use bind when necessary. We actually export a <code>bindV</code> function which we need to use just about everywhere, it's all kind of absurd. The only practical consequence I can think of the lawlessness is that we accumulate different or fewer errors depending on what sort of composition we use (or how our program might theoretically be transformed by rewrite rules, though I'm not sure why applicative composition would ever get converted to monadic).</p>\n\n<p><strong>EDIT</strong>: The documentation for the same laws in <code>Monad</code> is more extensive:</p>\n\n<blockquote>\n  <p>Furthermore, the Monad and Applicative operations should relate as follows:</p>\n\n<pre><code>pure = return\n(&lt;*&gt;) = ap\n</code></pre>\n  \n  <p>The above laws imply:</p>\n\n<pre><code>fmap f xs  =  xs &gt;&gt;= return . f\n(&gt;&gt;) = (*&gt;)\n</code></pre>\n</blockquote>\n\n<p>\"The above laws imply\"... so is the idea here that these are the real laws we care about? </p>\n\n<p>But now I'm left trying to understand these in the context of <code>Validation</code>. The first law would hold. The second could obviously be made to hold if we just define <code>(&gt;&gt;) = (*&gt;)</code>. </p>\n\n<p>But the documentation for <code>Monad</code> surprisingly says nothing at all (unless I'm just missing it) about how <code>&gt;&gt;</code> should relate. Presumably we want that</p>\n\n<pre><code>a &gt;&gt; b = a &gt;&gt;= \\_ -&gt; b\n</code></pre>\n\n<p>...and <code>(&gt;&gt;)</code> is included in the class so that it can be overridden for efficiency, and this just never quite made it into the docs.</p>\n\n<p>So if <em>that's</em> the case, then I guess the way <code>Monad</code> and <code>Applicative</code> relate is actually something like:</p>\n\n<pre><code>return = pure\nxs &gt;&gt;= return . f = fmap f xs\na &gt;&gt;= \\_ -&gt; b = fmap (const id) a &lt;*&gt; b\n</code></pre>\n"}, {"tags": ["list", "haskell", "types", "list-comprehension"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1508872233, "post_id": 46912756, "comment_id": 80783881, "body": "just put brackets around the <code>sum(take n xs)</code> as in <code>y &lt;- [sum(take n xs)]</code>, and you&#39;re golden. see also <a href=\"https://wiki.haskell.org/Keywords#.3C-\" rel=\"nofollow noreferrer\">this</a>,  <a href=\"https://wiki.haskell.org/Keywords#.2C\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://wiki.haskell.org/Keywords#.7C\" rel=\"nofollow noreferrer\">this</a>."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 7, "last_activity_date": 1508854748, "creation_date": 1508854748, "answer_id": 46912959, "question_id": 46912756, "link": "https://stackoverflow.com/questions/46912756/couldnt-match-expected-type-a-with-actual-type-a/46912959#46912959", "title": "Couldn&#39;t match expected type `[a]&#39; with actual type `a&#39;", "body": "<p><code>sum(take n xs)</code> is <strong>not a list</strong>, so you can not iterate over it. In order to add the result of an expression to a list you <strong>put the expression in the head of the list comprehension</strong>:</p>\n\n<pre><code>subtotal :: Num a =&gt; [a] -&gt; [a]\nsubtotal xs = [<b>sum (take n xs)</b> | n &lt;- [1..length xs]]</code></pre>\n\n<p>But you here use <code>length</code>. <code>length</code> is a bit a dangerous function since lists can be infinite, and then your function will simply keep looping, and never return an element. You can use <code>inits</code> however to obtain all the lists:</p>\n\n<pre><code>Prelude Data.List&gt; inits [1,4,2,5]\n[[],[1],[1,4],[1,4,2],[1,4,2,5]]\n</code></pre>\n\n<p>So you can use:</p>\n\n<pre><code><b>import Data.List(inits)</b>\n\nsubtotal :: Num a =&gt; [a] -&gt; [a]\nsubtotal xs = [<b>sum sub</b> | <b>sub</b> &lt;- <b>tail (inits xs)</b>]</code></pre>\n\n<p>But this is still not very effectively: now we calculate the sum of every sublist. But a problem here is that we calculate the sum of every list separately. This is weird since the sum of the <em>i</em>-th result is simply the sum of the <em>i-1</em>-th result plus the <em>i</em>-th element of <code>xs</code>. We can use <code>scanl1 :: (a -&gt; a -&gt; a) -&gt; [a] -&gt; [a]</code>:</p>\n\n<pre><code>subtotal :: Num a =&gt; [a] -&gt; [a]\nsubtotal xs = scanl1 (+) xs\n</code></pre>\n\n<p>or even more simple and elegant:</p>\n\n<pre><code>subtotal :: Num a =&gt; [a] -&gt; [a]\nsubtotal = scanl1 (+)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 4, "last_activity_date": 1508854757, "creation_date": 1508854757, "answer_id": 46912967, "question_id": 46912756, "link": "https://stackoverflow.com/questions/46912756/couldnt-match-expected-type-a-with-actual-type-a/46912967#46912967", "title": "Couldn&#39;t match expected type `[a]&#39; with actual type `a&#39;", "body": "<p>In a list comprehension, the statement <code>y &lt;- ys</code> means that <code>ys</code> is a list and <code>y</code> iterates over the elements of that list. So <code>y &lt;- sum (take n xs)</code> means that <code>sum</code> produces a list and you iterate over that list. But <code>sum</code> only produces a single number, not a list; so you get an error.</p>\n\n<p>You want to use <code>let</code> instead of <code>&lt;-</code> to assign simple expressions:</p>\n\n<pre><code>subtotal xs = [y | n &lt;- [1..length xs], let y = sum(take n xs)]\n</code></pre>\n\n<p>Or just put the expression directly into the head of the comprehension:</p>\n\n<pre><code>subtotal xs = [sum (take n xs) | n &lt;- [1..length xs]]\n</code></pre>\n\n<p>PS: Your first case (for the empty list) is redundant. It's just a special case of the second.</p>\n"}], "owner": {"reputation": 157, "user_id": 7026851, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh6.googleusercontent.com/-h1VcP9Pdc_U/AAAAAAAAAAI/AAAAAAAAAGc/XvP4_p7qeZM/photo.jpg?sz=128", "display_name": "Sreten Joci\u0107", "link": "https://stackoverflow.com/users/7026851/sreten-joci%c4%87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "accepted_answer_id": 46912959, "answer_count": 2, "score": 2, "last_activity_date": 1508857572, "creation_date": 1508854259, "last_edit_date": 1508857572, "question_id": 46912756, "link": "https://stackoverflow.com/questions/46912756/couldnt-match-expected-type-a-with-actual-type-a", "title": "Couldn&#39;t match expected type `[a]&#39; with actual type `a&#39;", "body": "<p>I have the following function which should adds up all numbers in a given list up to the current position. For example, <code>subtotal [1, 2, 3, 4] = [1, 3, 6, 10]</code>, because 1 = 1, 1 + 2 = 3, 1 + 2 + 3 = 6 and 1 + 2 + 3 + 4 = 10.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>subtotal :: Num a =&gt; [a] -&gt; [a]\nsubtotal [] = []\nsubtotal xs = [y | n &lt;- [1..length xs], y &lt;- sum(take n xs)]\n</code></pre>\n\n<p>The problem is Im getting this error:</p>\n\n<pre><code>cw.hs:3:46: error:\n    * Couldn't match expected type `[a]' with actual type `a'\n      `a' is a rigid type variable bound by\n        the type signature for:\n          subtotal :: forall a. Num a =&gt; [a] -&gt; [a]\n        at cw.hs:1:1-31\n    * In the expression: sum (take n xs)\n      In a stmt of a list comprehension: y &lt;- sum (take n xs)\n      In the expression:\n        [y | n &lt;- [1 .. length xs], y &lt;- sum (take n xs)]\n    * Relevant bindings include\n        xs :: [a] (bound at cw.hs:3:10)\n        subtotal :: [a] -&gt; [a] (bound at cw.hs:2:1)\n  |\n3 | subtotal xs = [y | n &lt;- [1..length xs], y &lt;- sum(take n xs)]\n  |                                              ^^\n</code></pre>\n\n<p>How can I fix it?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1508845873, "post_id": 46909803, "comment_id": 80766148, "body": "My guess would be that <code>onException</code> will execute <code>after a</code>, but then &quot;re-raises&quot; the exception, preventing the remaining of the function to be done, but I have not verified this. Like Python has an <code>try-exception</code> block but with <code>except: print(foo); raise</code> to reraise the exception after doing some instructions."}], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 6, "last_activity_date": 1508846225, "creation_date": 1508846225, "answer_id": 46909959, "question_id": 46909803, "link": "https://stackoverflow.com/questions/46909803/understanding-bracket-function/46909959#46909959", "title": "Understanding `bracket` Function", "body": "<p>From <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Exception-Base.html#v:bracket\" rel=\"noreferrer\">the docs for <code>bracket</code></a>:</p>\n\n<blockquote>\n  <p>When you want to acquire a resource, do some work with it, and then release the resource, it is a good idea to use <code>bracket</code>, because <code>bracket</code> will install the necessary exception handler to release the resource in the event that an exception is raised during the computation. <strong>If an exception is raised, then <code>bracket</code> will re-raise the exception (after performing the release).</strong></p>\n</blockquote>\n\n<p>And <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Exception-Base.html#v:onException\" rel=\"noreferrer\"><code>onException</code></a>:</p>\n\n<blockquote>\n  <p>Like <code>finally</code>, but only performs the final action if there was an exception raised by the computation.</p>\n</blockquote>\n\n<p>So if there is an exception thrown from <code>during a</code>, the first call to <code>after a</code> is executed, then the exception is rethrown, skipping the second <code>after a</code>; if there is no exception, only the second is executed.</p>\n\n<p>Note that in your sample code, you\u2019re <em>returning</em> an exception, not <em>throwing</em> it\u2014to throw, you need to use <code>throw</code> or preferably <code>throwIO :: Exception e =&gt; e -&gt; IO a</code>.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 46909959, "answer_count": 1, "score": 4, "last_activity_date": 1508846225, "creation_date": 1508845733, "question_id": 46909803, "link": "https://stackoverflow.com/questions/46909803/understanding-bracket-function", "title": "Understanding `bracket` Function", "body": "<p>Looking at the <code>bracket</code> function from <a href=\"http://chimera.labs.oreilly.com/books/1230000000929/ch08.html#sec_exceptions\" rel=\"nofollow noreferrer\">Parallel and Concurrent Programming in Haskell</a>:</p>\n\n<pre><code>bracket :: IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c\nbracket before after during = do\n  a &lt;- before\n  c &lt;- during a `onException` after a\n  after a\n  return c\n</code></pre>\n\n<p>In the event of an exception, why does the <code>after</code> function only get called once? In other words, I'm confused at the apparent execution of <code>after a</code> twice in the event of an exception.</p>\n\n<p>But, the code shows that <code>after a</code> only gets called, as I understand, once:</p>\n\n<pre><code>\u03bb: &gt;data MyException = MyException deriving Show\n\u03bb: &gt;instance Exception MyException\n\n\u03bb: &gt;let e = return MyException :: IO MyException\n\n\u03bb: &gt;bracket e (const $ putStrLn \"clean up!\") return\nclean up!\nMyException\n</code></pre>\n"}, {"tags": ["c#", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1508845387, "post_id": 46909589, "comment_id": 80765811, "body": "Afaik there is no method with that functionality, but you can of course write one yourself."}], "answers": [{"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1508860522, "post_id": 46909720, "comment_id": 80777139, "body": "Great minds <a href=\"https://stackoverflow.com/a/26802910/5743988\">think alike?</a>"}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 7, "last_activity_date": 1508845505, "creation_date": 1508845505, "answer_id": 46909720, "question_id": 46909589, "link": "https://stackoverflow.com/questions/46909589/what-is-the-equivalent-of-iterate-function-in-haskell-in-c/46909720#46909720", "title": "What is the equivalent of iterate function in haskell in c#?", "body": "<p>There isn't one but you can write your own:</p>\n\n<pre><code>public static IEnumerable&lt;T&gt; Iterate&lt;T&gt;(T seed, Func&lt;T, T&gt; step)\n{\n    while(true)\n    {\n        yield return seed;\n        seed = step(seed);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 575, "user_id": 4892463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZkQIX.jpg?s=128&g=1", "display_name": "mitaness", "link": "https://stackoverflow.com/users/4892463/mitaness"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "closed_date": 1508860591, "accepted_answer_id": 46909720, "answer_count": 1, "score": 0, "last_activity_date": 1508858357, "creation_date": 1508845158, "question_id": 46909589, "link": "https://stackoverflow.com/questions/46909589/what-is-the-equivalent-of-iterate-function-in-haskell-in-c", "closed_reason": "Duplicate", "title": "What is the equivalent of iterate function in haskell in c#?", "body": "<p>We have iterate function in haskell Prelude</p>\n\n<pre><code>iterate :: (a -&gt; a) -&gt; a -&gt; [a]\niterate f x == [x, f x, f (f x), ...]\n</code></pre>\n\n<p>What is the equivalent in C#?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1508832266, "post_id": 46905174, "comment_id": 80757101, "body": "You don&#39;t have <code>import qualified AST as A</code> in your third program."}, {"owner": {"reputation": 313, "user_id": 1850556, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/97f961d8dbf3bc77984150a62893a076?s=128&d=identicon&r=PG", "display_name": "fhyve", "link": "https://stackoverflow.com/users/1850556/fhyve"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1508832837, "post_id": 46905174, "comment_id": 80757430, "body": "Now I get <code>&quot;Could not find module \u2018AST\u2019     it is a hidden module in the package \u2018CabParser-0.1.0.0@CabPa_&lt;nonsense&gt;</code>"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1508832936, "post_id": 46905174, "comment_id": 80757484, "body": "You&#39;ll have to list it in your <code>.cabal</code> file for <code>CabParser</code>. I don&#39;t remember the field name, but <code>ParseProg</code> will be listed in it already."}, {"owner": {"reputation": 313, "user_id": 1850556, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/97f961d8dbf3bc77984150a62893a076?s=128&d=identicon&r=PG", "display_name": "fhyve", "link": "https://stackoverflow.com/users/1850556/fhyve"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1508833078, "post_id": 46905174, "comment_id": 80757566, "body": "then do I do the configure, build, install again?"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1508833164, "post_id": 46905174, "comment_id": 80757611, "body": "Yep, that&#39;s right."}, {"owner": {"reputation": 313, "user_id": 1850556, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/97f961d8dbf3bc77984150a62893a076?s=128&d=identicon&r=PG", "display_name": "fhyve", "link": "https://stackoverflow.com/users/1850556/fhyve"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1508833239, "post_id": 46905174, "comment_id": 80757664, "body": "Great, this works. If you write this up as an answer, I&#39;ll accept. I can do it otherwise."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1508833372, "post_id": 46905174, "comment_id": 80757738, "body": "You go right ahead."}], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 1850556, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/97f961d8dbf3bc77984150a62893a076?s=128&d=identicon&r=PG", "display_name": "fhyve", "link": "https://stackoverflow.com/users/1850556/fhyve"}, "is_accepted": false, "score": 4, "last_activity_date": 1508833890, "creation_date": 1508833890, "answer_id": 46905675, "question_id": 46905174, "link": "https://stackoverflow.com/questions/46905174/how-to-use-a-data-type-in-a-haskell-package/46905675#46905675", "title": "How to use a data type in a haskell package", "body": "<p>Ryan solved this in the comments. I write the solution here.</p>\n\n<p>The first issue is I did not import the AST in the third file, so it becomes:</p>\n\n<pre><code>import ParseProg\nimport AST as A\n</code></pre>\n\n<p>However, this gives an error</p>\n\n<pre><code>\"Could not find module \u2018AST\u2019 it is a hidden module in the package \u2018CabParser-0.1.0.0@CabPa_&lt;nonsense&gt;\"\n</code></pre>\n\n<p>For some reason, AST is a hidden module in the package CabParser that I am using, so I have to make it an exposed module. In CabParser.cabal in the directory of the package, I add AST to the exposed modules:</p>\n\n<pre><code>exposed-modules:     ParseProg, AST\n</code></pre>\n\n<p>and remove it from the other-modules line. Then I build and install again with</p>\n\n<pre><code>$ cabal configure\n$ cabal build \n$ cabal install\n</code></pre>\n\n<p>Then everything works.</p>\n"}], "owner": {"reputation": 313, "user_id": 1850556, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/97f961d8dbf3bc77984150a62893a076?s=128&d=identicon&r=PG", "display_name": "fhyve", "link": "https://stackoverflow.com/users/1850556/fhyve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508833890, "creation_date": 1508832078, "question_id": 46905174, "link": "https://stackoverflow.com/questions/46905174/how-to-use-a-data-type-in-a-haskell-package", "title": "How to use a data type in a haskell package", "body": "<p>I have three files. The first:</p>\n\n<pre><code>module AST where\n\ndata Prog a b = ...\n</code></pre>\n\n<p>The second</p>\n\n<pre><code>module ParseProg where\n\nimport qualified AST as A\n\nprogToAST :: String -&gt; A.Prog String String\n</code></pre>\n\n<p>This is part of a package used for a homework assignment. I installed it with</p>\n\n<pre><code>$ cabal configure\n$ cabal build \n$ cabal install\n</code></pre>\n\n<p>which seemed to work. My third program (testing) is</p>\n\n<pre><code>import ParseProg\n\nval1 = progToAST \"x\"\n\n-- prog :: A.Prog String String\n\nfun1 :: Int -&gt; Int\nfun1 x = 2\n\n-- val2 = fun1 val1\n</code></pre>\n\n<p>So the import works. If I uncomment prog though, I get </p>\n\n<pre><code>Not in scope: type constructor or class \u2018A.Prog\u2019\n</code></pre>\n\n<p>Same thing if I try Prog or AST.Prog. Checking the type of val1 gets</p>\n\n<pre><code>&gt; :type val1\n&gt; val1 :: CabParser-0.1.0.0:AST.Prog String String\n</code></pre>\n\n<p>And similarly uncommenting val2 gives</p>\n\n<pre><code>Couldn't match expected type \u2018Int\u2019\n            with actual type \u2018CabParser-0.1.0.0:AST.Prog String String\u2019\n</code></pre>\n\n<p>Copying CabParser-0.1.... gives a parse error. How do I use the Prog data type in AST?</p>\n"}, {"tags": ["haskell", "division", "floor"], "answers": [{"comments": [{"owner": {"reputation": 112, "user_id": 5091251, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9b46c1e797643ea0c87d681d760eabc7?s=128&d=identicon&r=PG", "display_name": "Thiago Nogueira", "link": "https://stackoverflow.com/users/5091251/thiago-nogueira"}, "edited": false, "score": 0, "creation_date": 1508809538, "post_id": 46900742, "comment_id": 80748843, "body": "And do you know how to get the ceil of the result?"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 3, "creation_date": 1508810585, "post_id": 46900742, "comment_id": 80749076, "body": "Here&#39;s a hint: <code>(-7) `div` 2 = -4</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1508815677, "post_id": 46900742, "comment_id": 80750236, "body": "Or an alternate hint: <code>(7+2-1) `div` 2 = 4</code>."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 5, "last_activity_date": 1508807819, "creation_date": 1508807819, "answer_id": 46900742, "question_id": 46900632, "link": "https://stackoverflow.com/questions/46900632/floor-of-the-result-of-a-division/46900742#46900742", "title": "Floor of the result of a division", "body": "<p>The function is <code>div</code> from Prelude.</p>\n\n<pre><code>5 `div` 2 == 2\n</code></pre>\n"}], "owner": {"reputation": 112, "user_id": 5091251, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9b46c1e797643ea0c87d681d760eabc7?s=128&d=identicon&r=PG", "display_name": "Thiago Nogueira", "link": "https://stackoverflow.com/users/5091251/thiago-nogueira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 613, "favorite_count": 1, "accepted_answer_id": 46900742, "answer_count": 1, "score": 1, "last_activity_date": 1508807819, "creation_date": 1508806805, "question_id": 46900632, "link": "https://stackoverflow.com/questions/46900632/floor-of-the-result-of-a-division", "title": "Floor of the result of a division", "body": "<p>In Haskell, how can I get the floor of the result of a division between two Integers?</p>\n\n<p>The function would be something like this:</p>\n\n<pre><code>floorOfDivision :: Int -&gt; Int -&gt; Int\nfloorOfDivision x y = x `someFunction` y\n</code></pre>\n"}, {"tags": ["image", "haskell", "video", "ffmpeg", "juicy-pixels"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1508786537, "post_id": 46896784, "comment_id": 80741068, "body": "You can do something like <code>frameWriter e f &gt;&gt;= \\writeFrame -&gt; mapM_ (writeFrame . Just) frames &gt;&gt; writeFrame Nothing</code> where <code>frames</code> is a list of frames in the appropriate format (a 3-tuple - <code>(AVPixelFormat, V2 CInt, Vector CUChar)</code>). Then you just need a function <code>Image PixelYA8 -&gt; (AVPixelFormat, V2 CInt, Vector CUChar)</code> - can you write this function?"}, {"owner": {"reputation": 1233, "user_id": 7970829, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OGdYb.png?s=128&g=1", "display_name": "oRole", "link": "https://stackoverflow.com/users/7970829/orole"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1508797573, "post_id": 46896784, "comment_id": 80746078, "body": "Thanks for that fast reply. While stepping through your code I finally understood how it works."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1508965486, "post_id": 46896784, "comment_id": 80831408, "body": "If you have a new question, don&#39;t edit this old one. Just ask a new question."}], "answers": [{"comments": [{"owner": {"reputation": 1233, "user_id": 7970829, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OGdYb.png?s=128&g=1", "display_name": "oRole", "link": "https://stackoverflow.com/users/7970829/orole"}, "edited": false, "score": 0, "creation_date": 1508797700, "post_id": 46897106, "comment_id": 80746111, "body": "Thanks for your answer! It also helped me solving the problem."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 4, "last_activity_date": 1508794137, "last_edit_date": 1508794137, "creation_date": 1508787029, "answer_id": 46897106, "question_id": 46896784, "link": "https://stackoverflow.com/questions/46896784/haskell-turning-multiple-image-files-into-one-video-file-using-the-ffmpeg-ligh/46897106#46897106", "title": "Haskell - Turning multiple image-files into one video-file using the ffmpeg-light package", "body": "<p>Disclaimer: not familiar with these libraries. Information gleaned from type signatures and documentation.</p>\n\n<p>Use <code>Codec.FFmpeg.Juicy</code>:</p>\n\n<pre><code>Codec.FFmpeg.Juicy.imageWriter ::\n  JuicyPixelFormat p =&gt;\n  EncodingParams -&gt;\n  FilePath -&gt;\n  IO (\n    Maybe (Image p) -&gt; \n    IO ()\n  )\n</code></pre>\n\n<p>Define</p>\n\n<pre><code>instance JuicyPixelFormat PixelYA8 where\n  juicyPixelFormat _  = _ -- in memory format of PixelYA8\n\njuicyToFFmpeg :: [Image PixelYA8] -&gt; FilePath -&gt; IO ()\njuicyToFFmpeg is fp = do writer &lt;- imageWriter params fp\n                         -- give Just image data to writer to append it\n                         forM_ is (writer . Just)\n                         writer Nothing -- finalize, or else you'll break it\n   where params :: EncodingParams\n         params = _ -- Figure out what fps, width, height, etc. you want (hardcode? parameters to juicyToFFmpeg? fold on is?)\n</code></pre>\n\n<hr/>\n\n<h2>Old Answer</h2>\n\n<pre><code>juicyToFFmpeg :: [Image PixelYA8] -&gt; FilePath -&gt; IO ()\njuicyToFFmpeg is fp = do writer &lt;- frameWriter (findEncodingParams is) fp\n                         forM_ is $ \\img -&gt; let form = imgForm img\n                                                dims = imgDims img\n                                                pixs = imgData img\n                                            in writer $ Just (form, dims, pixs)\n                         writer Nothing\n   where findEncodingParams = _\n         imgForm :: Image PixelYA8 -&gt; AVPixelFormat\n         imgForm = _ -- however your images are encoded\n         imgDims :: Image PixelYA8 -&gt; V2 Int\n         imgDims = _ -- duh\n         imgData :: Image PixelYA8 -&gt; Vector CUInt\n         imgData = _ -- Encode as a bunch of integers, following the value of imgForm\n</code></pre>\n"}], "owner": {"reputation": 1233, "user_id": 7970829, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/OGdYb.png?s=128&g=1", "display_name": "oRole", "link": "https://stackoverflow.com/users/7970829/orole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 46897106, "answer_count": 1, "score": 4, "last_activity_date": 1508965535, "creation_date": 1508785785, "last_edit_date": 1508965535, "question_id": 46896784, "link": "https://stackoverflow.com/questions/46896784/haskell-turning-multiple-image-files-into-one-video-file-using-the-ffmpeg-ligh", "title": "Haskell - Turning multiple image-files into one video-file using the ffmpeg-light package", "body": "<p><strong>Background</strong><br/>\nI wrote an application for image-processing which uses the <code>ffmpeg-light</code> package to fetch all the frames of a given video-file so that the program afterwards is able to apply grayscaling, as well as edge detection alogrithms to each of the frames.<br/></p>\n\n<p>Now I'm trying to put all of the frames back into a single video-file.</p>\n\n<p><strong>Used Libs</strong> <br/>\nffmpeg-light-0.12.0<br/>\nJuicyPixels-3.2.8.3 <br/>\n...</p>\n\n<p><strong>What have I tried?</strong><br/>\nI have to be honest, I didn't really try anything because I'm kinda clueless where and how to start. I saw that there is a package called <code>Command</code> which allows running processes/commands using the command line. With that I could use ffmpeg (not <code>ffmpeg-light</code>) to create a video out of image-files which I would have to save to the hard drive first but that would be kinda hacky.<br/><br/>\nWithin the documentation of <code>ffmpeg-light</code> on hackage (<a href=\"https://hackage.haskell.org/package/ffmpeg-light-0.12.0/docs/Codec-FFmpeg-Encode.html#t:EncodingParams\" rel=\"nofollow noreferrer\">ffmpeg-light docu</a>) I found the frameWriter function which sounds promising.</p>\n\n<pre><code>frameWriter :: EncodingParams -&gt; FilePath -&gt; IO (Maybe (AVPixelFormat, V2 CInt, Vector CUChar) -&gt; IO ()) \n</code></pre>\n\n<p>I guess <code>FilePath</code> would be the location where the video file gets stored but I can't really imagine how to apply the frames as <code>EncodingParams</code> to this function.</p>\n\n<p><strong>Others</strong><br/>\nI can access: <br/>\n- <code>r</code>, <code>g</code>, <code>b</code>, <code>a</code> as well as<code>y</code>. <code>a</code> values<br/>\n- image width / height / format</p>\n\n<p><strong>Question</strong> <br/>\nIs there a way to achieve this using the <code>ffmpeg-light</code> package? </p>\n\n<p>As the <code>ffmpeg-light</code> package lacks of documentation when it comes to conversion from images to video, I really would appreciate your help. (I do not expect a fully working solution.)</p>\n\n<p><strong>Code</strong> <br/>\nThe code that reads the frames:</p>\n\n<pre><code>-- Gets and returns all frames that a given video contains\ngetAllFrames :: String -&gt; IO [(Double, DynamicImage)]\ngetAllFrames vidPath = do \n  result &lt;- try (imageReaderTime $ File vidPath) :: IO (Either SomeException (IO (Maybe (Image PixelRGB8, Double)), IO()))\n  case result of \n    Left ex -&gt; do \n                 printStatus \"Invalid video-path or invalid video-format detected.\" \"Video\" \n                 return []\n    Right (getFrame, _) -&gt; addNextFrame getFrame [] \n\n-- Adds up all available framesvideo.\naddNextFrame :: IO (Maybe (Image PixelRGB8, Double)) -&gt; [(Double, DynamicImage)] -&gt; IO [(Double, DynamicImage)]\naddNextFrame getFrame frames = do\n  frame &lt;- getFrame\n  case frame of \n    Nothing -&gt; do \n                 printStatus \"No more frames found.\" \"Video\"\n                 return frames\n    _       -&gt; do                             \n                 newFrameData &lt;- fmap ImageRGB8 . swap . fromJust &lt;$&gt; getFrame \n                 printStatus (\"Frame: \" ++ (show $ length frames) ++ \" added.\") \"Video\"\n                 addNextFrame getFrame (frames ++ [newFrameData]) \n</code></pre>\n\n<p>Where I am stuck / The code that should convert images to video:</p>\n\n<pre><code>-- Converts from several images to video\njuicyToFFmpeg :: [Image PixelYA8] -&gt; ?\njuicyToFFmpeg imgs = undefined\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1508781529, "post_id": 46895604, "comment_id": 80738372, "body": "I think you take this the wrong way: you better work with squares..."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1508781531, "post_id": 46895604, "comment_id": 80738374, "body": "<code>sqrt :: Floating a =&gt; a -&gt; a</code>, <code>mod :: Integral a =&gt; a -&gt; a -&gt; a</code>. What number is both Integral and Floating? Also, once you&#39;ve fixed the types, what does it mean for a number to be congruent to zero, mod one? One is not a very useful modulus."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1508781579, "post_id": 46895604, "comment_id": 80738403, "body": "Use <code>floor</code> instead of <code>`mod` 1 == 0</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1508782804, "post_id": 46895604, "comment_id": 80738994, "body": "This might actually be the monomorphism restriction. Try giving <code>func</code> an explicit type signature."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1508783642, "post_id": 46895604, "comment_id": 80739466, "body": "@amalloy it&#39;s helpful in languages that allow floating point modulo (in Python, for example, <code>2.5 % 1 == 0.5</code>). In this case I think <code>`mod` 1</code> is just checking if the number is whole."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1508785293, "creation_date": 1508785293, "answer_id": 46896662, "question_id": 46895604, "link": "https://stackoverflow.com/questions/46895604/unresolved-top-level-overloading/46896662#46896662", "title": "Unresolved top level overloading", "body": "<p>This happens because of a conflict between these two types:</p>\n\n<pre><code>sqrt :: Floating a =&gt; a -&gt; a\nmod :: Integral a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>Because you write <code>mod (sqrt x) 1</code>, and <code>sqrt</code> is constrained to return the same type as it takes, the compiler is left trying to find a type for <code>x</code> that simultaneously satisfies the <code>Floating</code> constraint of <code>sqrt</code> and the <code>Integral</code> constraint of <code>mod</code>. There are no types in the <code>base</code> library that satisfy both constraints.</p>\n\n<p>A quick fix is to use <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Fixed.html#v:mod-39-\" rel=\"noreferrer\"><code>mod' :: Real a =&gt; a -&gt; a -&gt; a</code></a>:</p>\n\n<pre><code>import Data.Fixed\nfunc = [sqrt (x) + sqrt (y) | x &lt;- [10..99], y &lt;- [10..99], sqrt (x) `mod'` 1 == 0, sqrt (y) `mod'` 1 == 0]\n</code></pre>\n\n<p>However, from the error you posted, it looks like you may not be using GHC, and <code>mod'</code> is probably a GHC-ism. In that case you could copy the definition (and the definition of the helper function <code>div'</code>) from <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/src/Data.Fixed.html#mod%27\" rel=\"noreferrer\">here</a>.</p>\n\n<p>But I recommend a more involved fix. The key observation is that if <code>x = sqrt y</code>, then <code>x*x = y</code>, so we can avoid calling <code>sqrt</code> at all. Instead of iterating over numbers and checking if they have a clean <code>sqrt</code>, we can iterate over square roots; their squares will definitely have clean square roots. A straightforward application of this refactoring might look like this:</p>\n\n<pre><code>sqrts = takeWhile (\\n -&gt; n*n &lt;= 99)\n      . dropWhile (\\n -&gt; n*n &lt;  10)\n      $ [0..]\n\nfunc = [x + y | x &lt;- sqrts, y &lt;- sqrts]\n</code></pre>\n\n<p>Of course, <code>func</code> is a terrible name (it's not even a function!), and <code>sqrts</code> is a constant we could compute ourselves, and is so short we should probably just inline it. So we might then simplify to:</p>\n\n<pre><code>numberSums = [x + y | x &lt;- [4..9], y &lt;- [4..9]]\n</code></pre>\n\n<p>At this point, I would be wondering whether I really wanted to write this at all, preferring just</p>\n\n<pre><code>numberSums = [8..18]\n</code></pre>\n\n<p>which, unlike the previous iteration, doesn't have any duplicates. It has lost all of the explanatory power of why this is an interesting constant, though, so you would definitely want a comment.</p>\n\n<pre><code>-- sums of pairs of numbers, each of whose squares lies in the range [10..99]\nnumberSums = [8..18]\n</code></pre>\n\n<p>This would be my final version.</p>\n\n<p>Also, although the above definitions were not parameterized by the range to search for perfect squares in, all the proposed refactorings can be applied when that is a parameter; I leave this as a good exercise for the reader to check that they have understood each change.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8638529"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1508785298, "creation_date": 1508781225, "question_id": 46895604, "link": "https://stackoverflow.com/questions/46895604/unresolved-top-level-overloading", "title": "Unresolved top level overloading", "body": "<p>Task is to find all two-valued numbers representable as the sum of the sqrt's of two natural numbers.\nI try this:</p>\n\n<pre><code>func = [sqrt (x) + sqrt (y) | x &lt;- [10..99], y &lt;- [10..99], sqrt (x) `mod` 1 == 0, sqrt (y) `mod` 1 == 0]\n</code></pre>\n\n<p>Result: </p>\n\n<blockquote>\n  <p>Unresolved top-level overloading  Binding             : func\n  Outstanding context : (Integral b, Floating b)</p>\n</blockquote>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["haskell", "main"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1508779860, "post_id": 46895199, "comment_id": 80737528, "body": "As the error says there is no Main module. You only have a Test module."}], "answers": [{"comments": [{"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "edited": false, "score": 8, "creation_date": 1540562877, "post_id": 46895256, "comment_id": 92924470, "body": "This answer is also useful in the case where you are using <code>stack</code> and trying to add a second executable in <code>package.yaml</code> with <code>main: App.hs</code>. <code>stack build</code> will fail with the same error as the title of this post, which bought me here :). So the solution is to add a <code>- -main-is App</code> in <code>ghc-options</code> section. Just to share in case someone came here with the same case as mine."}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 6, "creation_date": 1545288448, "post_id": 46895256, "comment_id": 94574838, "body": "What&#39;s the point of having a <code>main-is</code> section in the cabal file if is not respected?"}, {"owner": {"reputation": 2885, "user_id": 1360368, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7997d33ca6f47d0e48080d6f58a72443?s=128&d=identicon&r=PG", "display_name": "Ashesh", "link": "https://stackoverflow.com/users/1360368/ashesh"}, "reply_to_user": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1592990164, "post_id": 46895256, "comment_id": 110619965, "body": "@SaurabhNanda One may argue that the <code>main-is</code> param. in the cabal file expects a .hs or .lhs file, that is an actual file. That doesn&#39;t say anything about the name of the module this file may contain (here, one may also argue that module names and filenames/paths are meant to have a strong relationship within a project: eg. one can have a file src/Foo/Bar.hs containing a module named <code>Foo.Bar</code> but not <code>Foo.Baz</code> but this differs from that standard.)  Thus from a cabal perspective this seems to be the filename, and from GHC&#39;s perspective, it must be the module name."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 32, "last_activity_date": 1508782969, "last_edit_date": 1508782969, "creation_date": 1508779934, "answer_id": 46895256, "question_id": 46895199, "link": "https://stackoverflow.com/questions/46895199/no-output-will-be-generated-because-there-is-no-main-module/46895256#46895256", "title": "No output will be generated because there is no Main module", "body": "<p><code>ghc</code> will assume that the <code>main</code> is located in a module called <code>Main</code> (like the compiler says).</p>\n\n<p><code>ghc</code> however has an option <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#the-main-and-run-commands\" rel=\"noreferrer\"><strong><code>-main-is</code></strong></a> where you can specify the name of the module where the <code>main</code> function is located. So you can compile with:</p>\n\n<pre><code>ghc <b>-main-is Test</b> Test.hs -o my-program</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1290, "user_id": 3088888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b7e0846120d52a1322e4b9ad743bb8?s=128&d=identicon&r=PG&f=1", "display_name": "mjarosie", "link": "https://stackoverflow.com/users/3088888/mjarosie"}, "edited": false, "score": 1, "creation_date": 1574206628, "post_id": 54045351, "comment_id": 104147337, "body": "Thanks, that fixed my issue! Do you know what exactly is causing it? Why test files shouldn&#39;t be defined as modules?"}, {"owner": {"reputation": 456, "user_id": 5122135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FiFoN.jpg?s=128&g=1", "display_name": "Milad", "link": "https://stackoverflow.com/users/5122135/milad"}, "reply_to_user": {"reputation": 1290, "user_id": 3088888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b7e0846120d52a1322e4b9ad743bb8?s=128&d=identicon&r=PG&f=1", "display_name": "mjarosie", "link": "https://stackoverflow.com/users/3088888/mjarosie"}, "edited": false, "score": 0, "creation_date": 1574279248, "post_id": 54045351, "comment_id": 104179648, "body": "No sorry, I actually don\u2019t know the reason, and to say the truth I haven\u2019t given much time to the matter ;)"}, {"owner": {"reputation": 1290, "user_id": 3088888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b7e0846120d52a1322e4b9ad743bb8?s=128&d=identicon&r=PG&f=1", "display_name": "mjarosie", "link": "https://stackoverflow.com/users/3088888/mjarosie"}, "edited": false, "score": 1, "creation_date": 1574295679, "post_id": 54045351, "comment_id": 104185768, "body": "I&#39;ve posted a question here: <a href=\"https://stackoverflow.com/q/58944736\">stackoverflow.com/q/58944736</a>"}], "tags": [], "owner": {"reputation": 456, "user_id": 5122135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FiFoN.jpg?s=128&g=1", "display_name": "Milad", "link": "https://stackoverflow.com/users/5122135/milad"}, "is_accepted": false, "score": 12, "last_activity_date": 1546632358, "creation_date": 1546632358, "answer_id": 54045351, "question_id": 46895199, "link": "https://stackoverflow.com/questions/46895199/no-output-will-be-generated-because-there-is-no-main-module/54045351#54045351", "title": "No output will be generated because there is no Main module", "body": "<p>I had the same problem, but in my case I had caused it by adding a module name to the test source file, <code>test/Spec.hs</code>:</p>\n\n<pre><code>module Tests where\n\nmain :: IO ()\nmain = hspec $ do ...\n</code></pre>\n\n<p>The solution was simply removing the first line:</p>\n\n<pre><code>main :: IO ()\nmain = hspec $ do ...\n</code></pre>\n\n<p>This is also the default when you create a project with stack - e.g., <code>stack new myproject</code>.</p>\n"}], "owner": {"reputation": 1142, "user_id": 5180554, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/5OWnC.jpg?s=128&g=1", "display_name": "Alex Goft", "link": "https://stackoverflow.com/users/5180554/alex-goft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3020, "favorite_count": 4, "accepted_answer_id": 46895256, "answer_count": 2, "score": 18, "last_activity_date": 1546632358, "creation_date": 1508779734, "last_edit_date": 1508780477, "question_id": 46895199, "link": "https://stackoverflow.com/questions/46895199/no-output-will-be-generated-because-there-is-no-main-module", "title": "No output will be generated because there is no Main module", "body": "<p>I wrote a simple module called <code>Test</code>:</p>\n\n<pre><code>module Test (main) where\n\nmain =\n  putStrLn \"Hello\"\n</code></pre>\n\n<p>However, when i try to compile it via the following command line:</p>\n\n<pre><code>ghc Test.hs -o my-program\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>[1 of 1] Compiling Test             ( Test.hs, Test.o )\n\n&lt;no location info&gt;: error:\n    output was redirected with -o, but no output will be generated because there is no Main module.\n</code></pre>\n"}, {"tags": ["haskell", "compiler-errors", "ghc", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1508771978, "post_id": 46892713, "comment_id": 80732982, "body": "The constraint is omitted since it not checked at that point, I guess. We have a <code>Char</code> where we expect a <code>t Char</code>. It&#39;s similar to the error message if you define <code>equal :: a -&gt; b -&gt; Bool; equal x y = x == y</code>. Only if you fix the <code>b</code> to <code>a</code> you get the missing <code>Eq</code> instance error, but before that the (unconstrained) type of <code>(==) :: a -&gt; a -&gt; Bool</code> already stops us from type-checking the <code>equal</code> variant above."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1508772081, "post_id": 46892713, "comment_id": 80733061, "body": "thought sthg in the line of that, but wasn&#39;t sure!"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1508772157, "post_id": 46892713, "comment_id": 80733112, "body": "TBH, one would have to check GHC&#39;s type-checking code. I guess TC comes before instance check. But that <i>may</i> be an interesting follow-up question (as long as it&#39;s on-topic)."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1508772502, "post_id": 46892713, "comment_id": 80733317, "body": "I guess that is a question a bit too broad - but I&#39;ll write one after work ;-)"}, {"owner": {"reputation": 11572, "user_id": 1950321, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rLmaR.jpg?s=128&g=1", "display_name": "James Sampica", "link": "https://stackoverflow.com/users/1950321/james-sampica"}, "edited": false, "score": 0, "creation_date": 1508777146, "post_id": 46892713, "comment_id": 80736021, "body": "Please use the edit link on your question to add additional information. The Post Answer button should be used only for complete answers to the question. - <a href=\"/review/low-quality-posts/17710234\">From Review</a>"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 11572, "user_id": 1950321, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/rLmaR.jpg?s=128&g=1", "display_name": "James Sampica", "link": "https://stackoverflow.com/users/1950321/james-sampica"}, "edited": false, "score": 0, "creation_date": 1508778072, "post_id": 46892713, "comment_id": 80736578, "body": "@Shoe - I updated both the question and the answer to be more complete."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 2, "last_activity_date": 1508777765, "last_edit_date": 1508777765, "creation_date": 1508771299, "answer_id": 46892713, "question_id": 46892710, "link": "https://stackoverflow.com/questions/46892710/why-does-ghci-not-show-the-same-error-message-as-ghc/46892713#46892713", "title": "Why does GHCi not show the same error message as GHC", "body": "<p>Introduced by the FTP (Foldable-Traversable-Proposal) function <code>elem</code> has\ngotten a new type signature.</p>\n\n<pre><code>elem :: (Eq a, Foldable t) =&gt; a -&gt; t a -&gt; Bool\n</code></pre>\n\n<p>And it seems GHCi uses the <code>ExtendedDefaultRules</code> extension which can be deactivated by</p>\n\n<pre><code>:set -NoExtendedDefaultRules\n</code></pre>\n\n<p>This extension and <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10971\" rel=\"nofollow noreferrer\">trac:10971</a> makes <code>Foldable</code> and\n<code>Traversable</code> default to <code>[]</code>.</p>\n\n<h2>update</h2>\n\n<p>The class constraint is not shown, because the type checking for it is done at a later stage.</p>\n"}], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1508777831, "creation_date": 1508771284, "last_edit_date": 1508777831, "question_id": 46892710, "link": "https://stackoverflow.com/questions/46892710/why-does-ghci-not-show-the-same-error-message-as-ghc", "title": "Why does GHCi not show the same error message as GHC", "body": "<p>Reasoning about an error given in <a href=\"https://stackoverflow.com/questions/46886961\">Haskell type error on compilation</a> I found a strange behaviour of GHCi</p>\n\n<h2><code>test.hs</code></h2>\n\n<pre><code>members :: String -&gt; Bool;\nmembers str = and [ b | x &lt;- str, b &lt;- map (elem x) \"abcde\" ]\n</code></pre>\n\n<p>produces the following error message </p>\n\n<pre><code>Prelude&gt; :l test.hs\n[1 of 1] Compiling Main             ( test.hs, interpreted )\n</code></pre>\n\n<blockquote>\n<pre><code>test.hs:2:53: error:\n    \u2022 Couldn't match type \u2018Char\u2019 with \u2018t0 Char\u2019\n      Expected type: [t0 Char]\n        Actual type: [Char]\n    \u2022 In the second argument of \u2018map\u2019, namely \u2018\"abcde\"\u2019\n      In the expression: map (elem x) \"abcde\"\n      In a stmt of a list comprehension: b &lt;- map (elem x) \"abcde\"\n</code></pre>\n</blockquote>\n\n<p>whereas</p>\n\n<h2><code>GHCi</code></h2>\n\n<pre><code>Prelude&gt; members :: String -&gt; Bool; members xs = and [ b | x &lt;- xs, b &lt;- map (elem x) \"abcde\"]\n</code></pre>\n\n<p>produces </p>\n\n<blockquote>\n<pre><code>&lt;interactive&gt;:18:78: error:\n    \u2022 Couldn't match type \u2018Char\u2019 with \u2018[Char]\u2019\n      Expected type: [[Char]]\n        Actual type: [Char]\n    \u2022 In the second argument of \u2018map\u2019, namely \u2018\"abcde\"\u2019\n      In the expression: map (elem x) \"abcde\"\n      In a stmt of a list comprehension: b &lt;- map (elem x) \"abcde\"\n</code></pre>\n</blockquote>\n\n<h2>Update</h2>\n\n<p>What I also do not understand, is why GHC omits the <code>Foldable t0</code> class constraint - I\nwould have expected the error message be something like:</p>\n\n<blockquote>\n<pre><code>test.hs:2:53: error:\n    \u2022 Couldn't match type \u2018Char\u2019 with \u2018t0 Char\u2019\n      Expected type: Foldable t0 =&gt; [t0 Char]\n        Actual type: [Char]\n    \u2022 In the second argument of \u2018map\u2019, namely \u2018\"abcde\"\u2019\n      In the expression: map (elem x) \"abcde\"\n      In a stmt of a list comprehension: b &lt;- map (elem x) \"abcde\"\n</code></pre>\n</blockquote>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 9, "last_activity_date": 1508770304, "creation_date": 1508770304, "answer_id": 46892362, "question_id": 46892024, "link": "https://stackoverflow.com/questions/46892024/why-does-ghc-not-upcast-a-vector-to-a-foldable/46892362#46892362", "title": "Why does GHC not &quot;upcast&quot; a Vector to a Foldable?", "body": "<p>The type of <code>aData</code> says that for any <code>t</code> that the <em>caller</em> chooses, it will return a value of type <code>t a</code>. But the implementation only returns a <code>Vector</code>. \"Upcasting\" as you call it would require converting a <code>Vector</code> to any  <code>Foldable</code> structure, but not only is there no implicit way to do this, it is practically not possible: what if the vector is empty and the users wants a <code>NonEmpty</code> list?</p>\n"}, {"comments": [{"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 2, "creation_date": 1508795853, "post_id": 46896786, "comment_id": 80745515, "body": "The discussion of existential types is good, but the very start of the answer makes it sound like the OP&#39;s code <i>would</i> work if only Haskell supported upcasting. The problem here isn&#39;t that Haskell doesn&#39;t support upcasting, but that it wouldn&#39;t be <b>valid</b> to upcast here because the type the OP wanted to upcast to isn&#39;t actually a supertype of the type they wanted to upcast from. (And in as much as Haskell has subtyping at all, which is only types that are instances of a more polymorphic type, it does support &quot;upcasting&quot;)."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 3, "last_activity_date": 1508799160, "last_edit_date": 1508799160, "creation_date": 1508785789, "answer_id": 46896786, "question_id": 46892024, "link": "https://stackoverflow.com/questions/46892024/why-does-ghc-not-upcast-a-vector-to-a-foldable/46896786#46896786", "title": "Why does GHC not &quot;upcast&quot; a Vector to a Foldable?", "body": "<p><em>Values</em> are not instances of typeclasses. <em>An</em> <code>Int</code> is not a <code>Num</code>; <em>a</em> <code>VectorArray Foo</code> is not an <code>Array</code>. <em>Types</em> are instances of typeclasses: <em><code>Int</code></em> is <code>Num</code>, <em><code>VectorArray</code></em> is <code>Array</code>, <em><code>Vector</code></em> is <code>Foldable</code>. You cannot upcast some <code>x :: Vector Foo</code> to <code>x :: Foldable</code>, because <code>Foldable</code> just isn't applicable to values. Haskell does have subtyping (e.g. <code>mempty :: forall m. Monoid m =&gt; m</code>, but since <code>Group m</code> (if such a class existed) implies <code>Monoid m</code>, <code>mempty :: forall g. Group g =&gt; g</code>, too), but it's a bit arcane and isn't relevant.</p>\n\n<p>You want an existential type:</p>\n\n<pre><code>class Array arr where\n  aRows :: arr a -&gt; Int\n  aCols :: arr a -&gt; Int\n  aData :: arr a -&gt; (exists f. Foldable f =&gt; f a)\n</code></pre>\n\n<p>The syntax <code>exists f. Foldable f =&gt; f a</code> is (somewhat standard) psuedo-Haskell. It means that, whatever it is, it is <code>Foldable</code>, and it contains <code>a</code>s, but you don't know what the containing type exactly is. You can't do this directly, but you can get close:</p>\n\n<pre><code>data SomeFoldable a = forall f. Foldable f =&gt; SomeFoldable (f a)\n-- Can't be a newtype: the Foldable f dictionary needs to be put somewhere\naData :: Array arr =&gt; arr a -&gt; SomeFoldable a\n</code></pre>\n\n<p>The Haskell syntax for existential types is rather perverse, as it uses the opposite quantifier, <code>forall</code> to define them. The justification is that the above creates the constructor</p>\n\n<pre><code>SomeFoldable :: forall f. Foldable f =&gt; f a -&gt; SomeFoldable a\n</code></pre>\n\n<p>which \"forgets\" what <code>f</code> specifically is.</p>\n\n<p>Using these is pretty straightforward, but not as nice as just making <code>Foldable</code> a superclass of <code>Array</code>:</p>\n\n<pre><code>instance Array VectorArray where\n    aRows = vRows\n    aCols = vCols\n    aData = SomeFoldable . vData\n\nsum :: (Num a, Array arr) =&gt; arr a -&gt; a\nsum arr = case aData arr of\n  SomeFoldable fa -&gt; foldl' (+) 0 fa\n-- Need to use patterns to destructure; let won't work (same for GADTs).\n-- Foldable instance in scope on right side of case\n\n-- Example:\ninstance Array [] where\n  aRows _ = 1\n  aCols = length\n  aData = SomeFoldable\nsum [1,2,3] == 6\n</code></pre>\n"}], "owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 46892362, "answer_count": 2, "score": 1, "last_activity_date": 1508799160, "creation_date": 1508769318, "question_id": 46892024, "link": "https://stackoverflow.com/questions/46892024/why-does-ghc-not-upcast-a-vector-to-a-foldable", "title": "Why does GHC not &quot;upcast&quot; a Vector to a Foldable?", "body": "<p>In an attempt to learn how to write more generic code, I tried to write\na simple Array class. The idea is to write some simple array operations only\nwith the functions provided by the Array class and then to write different data types as instances.\nSo I want to write different representations of arrays.</p>\n\n<p>For a first attempt, an array has a number of rows and columns and a container that is foldable. </p>\n\n<pre><code>module Array where\n\nimport qualified Data.Vector as V\nimport           Data.Foldable\n\nclass Array arr where\n    aRows :: arr a -&gt; Int\n    aCols :: arr a -&gt; Int\n    aData :: Foldable t =&gt; arr a -&gt; t a\n\ndata VectorArray a = VectorArray\n    { vRows :: !Int\n    , vCols :: !Int\n    , vData :: !(V.Vector a)}\n\ninstance Array VectorArray where\n    aRows = vRows\n    aCols = vCols\n    aData = vData\n</code></pre>\n\n<p>The last line does not compile:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018t\u2019 with \u2018V.Vector\u2019\n  \u2018t\u2019 is a rigid type variable bound by\n    the type signature for:\n      aData :: forall (t :: * -&gt; *) a. Foldable t =&gt; VectorArray a -&gt; t a\n    at src/Array.hs:19:5\n  Expected type: VectorArray a -&gt; t a\n    Actual type: VectorArray a -&gt; V.Vector a\n\u2022 In the expression: vData\n</code></pre>\n\n<p>My interpretation of the error message: You (programmer) give me a <code>V.Vector</code> a but I (the GHC compiler) \nwant a <code>t a</code> where the <code>t</code> must be an instance of the Foldable class.</p>\n\n<p>Now, a V.Vector is an instance of Foldable. So in every function where I have to pass an instance \nof <em>Foldable</em> as an argument, I can use a value of type <em>V.Vector</em>. \nMy question is: Why does GHC not \"upcast\" a <em>V.Vector</em> to a <em>Foldable</em>? Are there any examples, where\nsuch an upcast would be a source of problems?</p>\n\n<p>PS: The real and good solution to avoid the above error is to drop the <code>aData</code> function from the Array class\nand to make VectorArray an instance of Foldable.</p>\n"}, {"tags": ["haskell", "syntax", "functional-programming", "add"], "comments": [{"owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "edited": false, "score": 2, "creation_date": 1508764244, "post_id": 46890091, "comment_id": 80727531, "body": "It&#39;s called &quot;pointfree&quot;, it&#39;s an inherent property of the lambda calculus Haskell is built on."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 4, "creation_date": 1508764401, "post_id": 46890091, "comment_id": 80727649, "body": "The author could have written <code>add x y = x + y</code>, which is another way of saying <code>add = \\x y -&gt; (+) x y</code> (ie, <code>add</code> is a function with parameters <code>x</code> and <code>y</code> which applies the function <code>(+)</code> to <code>x</code> and <code>y</code>). You can <a href=\"https://en.wikipedia.org/wiki/Lambda_calculus#.CE.B7-conversion\" rel=\"nofollow noreferrer\">eta-reduce</a> this to elide the two arguments."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1508791547, "post_id": 46890091, "comment_id": 80743623, "body": "depends on what you mean by &quot;it&quot;. the parens around the <code>+</code>? the <code>=</code> sign? the name without the arguments?"}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 6, "last_activity_date": 1508768360, "last_edit_date": 1508768360, "creation_date": 1508764663, "answer_id": 46890347, "question_id": 46890091, "link": "https://stackoverflow.com/questions/46890091/haskell-add-operation/46890347#46890347", "title": "Haskell Add-Operation", "body": "<p>Here's an explicit definition:</p>\n\n<pre><code>add a b = a + b\n</code></pre>\n\n<p>There is a feature in Haskell that says that we can rewrite <code>a + b</code> as <code>(+) a b</code>, this is due to the fact that operators are functions in Haskell. So we can rewrite:</p>\n\n<pre><code>add a b = (+) a b\n</code></pre>\n\n<p>But then we're doing nothing extra to the arguments of this function, so we can reduce this function by removing the explicit arguments*. Note that this requires an understanding of how function application in Haskell works:</p>\n\n<pre><code>add = (+)\n</code></pre>\n\n<p>This is because functions are data in Haskell. This is literally saying that <code>plus</code> and the function of addition are the same thing.</p>\n\n<p>In practice, we can see this by substituting:</p>\n\n<pre><code>  add 1 2\n= (+) 1 2 -- Since add = (+), this can be read literally.\n= 1 + 2   -- This is how operators work in Haskell.\n= 3       -- Calculation.\n</code></pre>\n\n<p>This is known as pointfree style in Haskell.</p>\n\n<hr>\n\n<p><em>*As <a href=\"https://stackoverflow.com/users/1523776/benjamin-hodgson\">@Benjamin Hodgson</a> mentioned, this is called <a href=\"https://en.wikipedia.org/wiki/Lambda_calculus#.CE.B7-conversion\" rel=\"nofollow noreferrer\">eta-reduction</a>.</em></p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 5, "last_activity_date": 1508765886, "creation_date": 1508765886, "answer_id": 46890788, "question_id": 46890091, "link": "https://stackoverflow.com/questions/46890091/haskell-add-operation/46890788#46890788", "title": "Haskell Add-Operation", "body": "<p>This \u201cfunctionality\u201d is just variable assignment. It works the same way as writing</p>\n\n<pre><code>three = 3\n</code></pre>\n\n<p><code>3</code> is just a Haskell value, which I can at any point give a new name, refer to it, and get something that's (at least, at runtime) indistinguishable from <code>3</code> itself.</p>\n\n<p>The fact that <code>add</code> has a somewhat more complicated type, namely a <em>function type</em>, changes nothing about the way such variable assignments work. I can certainly define</p>\n\n<pre><code>root = sqrt\n</code></pre>\n\n<p>...and then evaluate <code>root 4</code> to obtain <code>2.0</code> as the result. Or, for any custom function,</p>\n\n<pre><code>foo :: Int -&gt; String\nfoo n = concat $ replicate n (show n)\n\nbar = foo\n\nGHCi&gt; bar 3\n\"333\"\nGHCi&gt; bar 7\n\"7777777\"\n</code></pre>\n\n<p>All that is really no different from how I can also write</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>Python 3.5.2 (default, Sep 14 2017, 22:51:06) \nType 'copyright', 'credits' or 'license' for more information\nIPython 6.1.0 -- An enhanced Interactive Python. Type '?' for help.\n\nIn [1]: import math\n\nIn [2]: root = math.sqrt\n\nIn [3]: root(4)\nOut[3]: 2.0\n</code></pre>\n\n<p>What's a bit more interesting about <code>add</code> is that <code>+</code> is an <em>infix operator</em> (because it consists of non-letter characters). But Haskell allows using such infix operators pretty much just as liberally as any other variables, including that you can define your own. The only thing that's a bit different are the parsing rules. <code>+</code> can not be a standalone syntactic unit but has to be surrounded on each side with with arguments you want to add, or with parentheses. The latter, <code>(+)</code>, is really what <em>the plus operator is</em> from the compiler's point of view: the binary function, <em>not</em> yet applied to any arguments. So, when you want to give this operator a new name, you need to write</p>\n\n<pre><code>add = (+)\n</code></pre>\n\n<p>Incidentally, you could also give it a new operator-name, like</p>\n\n<pre><code>(\u2295) = (+)\n</code></pre>\n\n<p>...that could then be used like <code>3 \u2295 4</code>, just as you can with the standard <code>+</code> operator.</p>\n"}], "owner": {"reputation": 3700, "user_id": 8339141, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f00f93d54fda2f5c1fbe9b21b48f5c95?s=128&d=identicon&r=PG&f=1", "display_name": "Roman", "link": "https://stackoverflow.com/users/8339141/roman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5284, "favorite_count": 0, "accepted_answer_id": 46890347, "answer_count": 2, "score": 3, "last_activity_date": 1508768360, "creation_date": 1508763899, "question_id": 46890091, "link": "https://stackoverflow.com/questions/46890091/haskell-add-operation", "title": "Haskell Add-Operation", "body": "<p>In a <a href=\"https://codefights.com/\" rel=\"nofollow noreferrer\">Codefights</a> challenge where you have to add two numbers the user <a href=\"https://codefights.com/profile/kaiochao\" rel=\"nofollow noreferrer\">kaiochao</a> had a super minimalisic answer</p>\n\n<pre><code>add = (+)\n</code></pre>\n\n<p>How does it work and has this functionality a own name?</p>\n"}, {"tags": ["haskell", "functional-programming", "haskell-stack", "haskell-platform", "guard-statement"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1508758396, "post_id": 46888166, "comment_id": 80723587, "body": "Why no just write <code>let a = if length list == 1 then 10 else 0</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 6, "last_activity_date": 1508758714, "creation_date": 1508758714, "answer_id": 46888423, "question_id": 46888166, "link": "https://stackoverflow.com/questions/46888166/how-to-use-let-with-guards-in-haskell/46888423#46888423", "title": "How to use let with guards in Haskell?", "body": "<p>It's a bit hard to say, but I'm guessing you meant</p>\n\n<pre><code>someFunction :: [] -&gt; Int\nsomeFunction list =\n  let a | length list == 1 = 10\n        | otherwise = 0\n      b | length list == 1 = 10 \n        | otherwise = 0\n  in findValues (a+b)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 8, "last_activity_date": 1508761205, "creation_date": 1508761205, "answer_id": 46889212, "question_id": 46888166, "link": "https://stackoverflow.com/questions/46888166/how-to-use-let-with-guards-in-haskell/46889212#46889212", "title": "How to use let with guards in Haskell?", "body": "<p>This is doable, but keep in mind that <code>length list == 1</code> is very inefficient: it will scan all the entries to count them one by one, spending O(N) time, to compare with 1. </p>\n\n<p>Instead, consider using a <code>case .. of</code> which can check that in constant time.</p>\n\n<pre><code>someFunction :: [] -&gt; Int\nsomeFunction list = let\n   a = case list of\n       [_] -&gt; 10   -- list is of the form [x] for some x\n       _   -&gt; 0    -- list is of any other form\n   b = case list of\n       [_] -&gt; 10\n       _   -&gt; 0\n   in findValues (a+b)\n</code></pre>\n\n<p>or even:</p>\n\n<pre><code>someFunction :: [] -&gt; Int\nsomeFunction list = let\n   (a,b) = case list of\n       [_] -&gt; (10,10)    -- list is of the form [x] for some x\n       _   -&gt; (0 ,0 )    -- list is of any other form\n   in findValues (a+b)\n</code></pre>\n\n<p>(Also note that <code>a</code> and <code>b</code> have the same value: is that intentional, or is the code only an example?)</p>\n\n<p>When possible I'd strongly recommend to avoid guards in favor of pattern matching.</p>\n"}], "owner": {"reputation": 43, "user_id": 8741507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a5237abd2c5665558df7dd293d03579?s=128&d=identicon&r=PG&f=1", "display_name": "Tom coates", "link": "https://stackoverflow.com/users/8741507/tom-coates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 904, "favorite_count": 0, "accepted_answer_id": 46888423, "answer_count": 2, "score": 0, "last_activity_date": 1579369260, "creation_date": 1508757833, "last_edit_date": 1579369260, "question_id": 46888166, "link": "https://stackoverflow.com/questions/46888166/how-to-use-let-with-guards-in-haskell", "title": "How to use let with guards in Haskell?", "body": "<p>I'm trying to do the following in Haskell: </p>\n\n<pre><code> someFunction :: [] -&gt; Int\n someFunction list \n let a\n | length list == 1 = 10\n | otherwise = 0\n b\n | length list == 1 = 10 \n | otherwise = 0\n in findValues (a+b)\n</code></pre>\n\n<p>So that the values of a and b will be dependent on the conditions in the guards being met or not. This syntax keeps giving me errors and I'm not sure why. Do I need to use a where clause or is there a correct \"let\" syntax to achieve what I want?</p>\n\n<p>Thanks for any help</p>\n"}, {"tags": ["haskell", "types", "compiler-errors"], "comments": [{"owner": {"reputation": 27685, "user_id": 610979, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ku5ga.png?s=128&g=1", "display_name": "Frank Schmitt", "link": "https://stackoverflow.com/users/610979/frank-schmitt"}, "edited": false, "score": 3, "creation_date": 1508754727, "post_id": 46886961, "comment_id": 80721448, "body": "Your code is incomplete - what is <code>xs</code> ?"}, {"owner": {"reputation": 1527, "user_id": 5539184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/r4U5R.jpg?s=128&g=1", "display_name": "Rob Murray", "link": "https://stackoverflow.com/users/5539184/rob-murray"}, "reply_to_user": {"reputation": 27685, "user_id": 610979, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ku5ga.png?s=128&g=1", "display_name": "Frank Schmitt", "link": "https://stackoverflow.com/users/610979/frank-schmitt"}, "edited": false, "score": 0, "creation_date": 1508755419, "post_id": 46886961, "comment_id": 80721867, "body": "@FrankSchmitt Sorry that was a typo, edited"}], "answers": [{"comments": [{"owner": {"reputation": 1527, "user_id": 5539184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/r4U5R.jpg?s=128&g=1", "display_name": "Rob Murray", "link": "https://stackoverflow.com/users/5539184/rob-murray"}, "edited": false, "score": 0, "creation_date": 1508759843, "post_id": 46887476, "comment_id": 80724590, "body": "Thanks, just wasn&#39;t sure what was meant by the <code>t0</code> in the error!"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 2, "last_activity_date": 1508755490, "creation_date": 1508755490, "answer_id": 46887476, "question_id": 46886961, "link": "https://stackoverflow.com/questions/46886961/haskell-type-error-on-compilation/46887476#46887476", "title": "Haskell type error on compilation", "body": "<p>The code you gave has a few errors.</p>\n\n<ol>\n<li>As @FramkSchmitt mentioned there is a parameter <code>xs</code> missing.</li>\n<li>you try to map <code>elem x</code> over a list - which would need a list of lists to be correct.</li>\n</ol>\n\n<p>here is what I would guess what you intended.</p>\n\n<pre><code>members :: Code -&gt; Bool\nmembers xs = and [ x `elem` symbols  | x &lt;- xs ]\n</code></pre>\n\n<p>which can be written a bit more concise (I believe tools like hlint would even suggest this simplification).</p>\n\n<pre><code>members' :: Code -&gt; Bool\nmembers' = all (`elem` symbols)\n</code></pre>\n"}], "owner": {"reputation": 1527, "user_id": 5539184, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/r4U5R.jpg?s=128&g=1", "display_name": "Rob Murray", "link": "https://stackoverflow.com/users/5539184/rob-murray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 46887476, "answer_count": 1, "score": 0, "last_activity_date": 1508763774, "creation_date": 1508753834, "last_edit_date": 1508763774, "question_id": 46886961, "link": "https://stackoverflow.com/questions/46886961/haskell-type-error-on-compilation", "title": "Haskell type error on compilation", "body": "<p>I'm not sure why the following code is causing the following error.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>type Symbol = Char\n\nsymbols :: [Symbol]\nsymbols = ['a'..'f']\n\ntype Code = [Symbol]\n\nmembers :: Code -&gt; Bool\nmembers xs = and [ b | x &lt;- xs, b &lt;- map (elem x) symbols ]\n</code></pre>\n\n<p><strong>Compilation Error:</strong></p>\n\n<pre><code>Couldn't match type \u2018Char\u2019 with \u2018t0 Symbol\u2019\n     Expected type: [t0 Symbol]\n       Actual type: [Symbol]\n   \u2022 In the second argument of \u2018map\u2019, namely \u2018symbols\u2019\n     In the expression: map (elem x) symbols\n     In a stmt of a list comprehension: b &lt;- map (elem x) symbols\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1508748446, "creation_date": 1508748446, "answer_id": 46885222, "question_id": 46885123, "link": "https://stackoverflow.com/questions/46885123/how-to-use-user-defined-data-as-param-in-haskell/46885222#46885222", "title": "How to use user defined data as param in haskell?", "body": "<p>You can use the record update notation:</p>\n\n<pre><code>if line==\"1\" then\n    do\n        height'&lt;-getLine\n        loop z{height = height'}\n</code></pre>\n\n<p>Basically, <code>z{height = height'}</code> is a new record value, having the same fields as <code>z</code> except for the updated one. In this case, it is equivalent to <code>A height' (weight z)</code>.</p>\n"}], "owner": {"reputation": 1277, "user_id": 7254635, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/280e5fa5140a804fcd8fd9dfe3198542?s=128&d=identicon&r=PG&f=1", "display_name": "wang kai", "link": "https://stackoverflow.com/users/7254635/wang-kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 46885222, "answer_count": 1, "score": 0, "last_activity_date": 1508748446, "creation_date": 1508748084, "question_id": 46885123, "link": "https://stackoverflow.com/questions/46885123/how-to-use-user-defined-data-as-param-in-haskell", "title": "How to use user defined data as param in haskell?", "body": "<p>I am new to haskell</p>\n\n<p>I have this program:</p>\n\n<pre><code>loop height weight=do\n    line&lt;-getLine\n    if line==\"1\" then\n        do\n            height&lt;-getLine\n            loop height weight\n    else if line==\"2\" then\n        do \n            weight&lt;-getLine\n            loop height weight\n        else if line==\"3\" then\n            do\n                putStrLn (height)\n            else\n                do\n                    putStrLn \"error\"\n\nmain :: IO ()\nmain = do\n    loop \"\" \"\"\n</code></pre>\n\n<p>It works fine,now I change it as this:</p>\n\n<pre><code>data A=A {height::String,weight::String}\n\nloop::A-&gt;IO ()\nloop z=do\nline&lt;-getLine\nif line==\"1\" then\n    do\n        height&lt;-getLine\n        let z.height=height\n        loop z\nelse if line==\"2\" then\n    do \n        weight&lt;-getLine\n        let z.weight=weight\n        loop z\n    else if line==\"3\" then\n        do\n            putStrLn ((height z)++(weight z))\n        else\n            do\n                putStrLn \"error\"\n\nmain :: IO ()\nmain = do\n    let z=A \"\" \"\"\n    loop z\n</code></pre>\n\n<p>this program is wrong \nI know in haskell and other function program there is no assignment\uff0cso let z.height=height is wrong,but I don't know how to write it right.I need some help,thanks!</p>\n"}, {"tags": ["list", "haskell", "lazy-evaluation"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1508732188, "post_id": 46881763, "comment_id": 80710920, "body": "How would you write an algorithm to do this by hand? How far through the two lists would you have to look to conclude, &quot;okay, this value occurs in the first list but never in the second&quot;?"}, {"owner": {"reputation": 437, "user_id": 5299034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10203272588494957/picture?type=large", "display_name": "BrainFRZ", "link": "https://stackoverflow.com/users/5299034/brainfrz"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1508732400, "post_id": 46881763, "comment_id": 80710974, "body": "Oh, of course. If it&#39;s unsorted, there wouldn&#39;t be a way of knowing it wasn&#39;t at the end. I guess sometimes I rely on Haskell&#39;s magic too much without thinking :)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1508771127, "post_id": 46881763, "comment_id": 80732374, "body": "@BrainFRZ I think &quot;If it&#39;s unsorted, then there wouldn&#39;t be a way knowing it wasn&#39;t at the end&quot; is too strong. Certainly the assumptions <code>(\\\\)</code> makes (namely, none) don&#39;t give it a way to know if a particular element might occur later. But I bet I could cook up other special list properties that are not sorted-ness that would nevertheless give you a way to choose when to stop looking for a particular element."}], "answers": [{"comments": [{"owner": {"reputation": 437, "user_id": 5299034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10203272588494957/picture?type=large", "display_name": "BrainFRZ", "link": "https://stackoverflow.com/users/5299034/brainfrz"}, "edited": false, "score": 0, "creation_date": 1508732101, "post_id": 46881790, "comment_id": 80710899, "body": "Thanks! Although I wouldn&#39;t be able to guarantee the lists are sorted. Would this not work at all if it were unsorted? Or would the solution be to sort the lists and then use this? That then begs the question: can sorting be lazy?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 437, "user_id": 5299034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10203272588494957/picture?type=large", "display_name": "BrainFRZ", "link": "https://stackoverflow.com/users/5299034/brainfrz"}, "edited": false, "score": 0, "creation_date": 1508734864, "post_id": 46881790, "comment_id": 80711635, "body": "@BrainFRZ, no, because you could always find a smaller element later on in the list.  (The intuition is that there&#39;s not really any way to know anything about a list without iterating through it.  I think this intuition can be formalized with something like Rice&#39;s theorem)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 437, "user_id": 5299034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10203272588494957/picture?type=large", "display_name": "BrainFRZ", "link": "https://stackoverflow.com/users/5299034/brainfrz"}, "edited": false, "score": 0, "creation_date": 1508770941, "post_id": 46881790, "comment_id": 80732227, "body": "@BrainFRZ Right, this library will not work correctly at all if the lists are unsorted. Sorting cannot be lazy. If you can&#39;t know the lists are sorted, then you will have to know and exploit some other special structure in the lists to be able to do what you ask."}, {"owner": {"reputation": 437, "user_id": 5299034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10203272588494957/picture?type=large", "display_name": "BrainFRZ", "link": "https://stackoverflow.com/users/5299034/brainfrz"}, "edited": false, "score": 0, "creation_date": 1508771903, "post_id": 46881790, "comment_id": 80732930, "body": "Let me know if this should be a separate question, or if it&#39;s off-topic. But, if I differentiate the functions to find their vertices, would I be able to use that and monotonicity to do this? Then I&#39;d only need to sort the vertices, right?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 437, "user_id": 5299034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10203272588494957/picture?type=large", "display_name": "BrainFRZ", "link": "https://stackoverflow.com/users/5299034/brainfrz"}, "edited": false, "score": 0, "creation_date": 1508772988, "post_id": 46881790, "comment_id": 80733637, "body": "@BrainFRZ Hm. I&#39;m not sure I understood that. I suspect you should indeed open a new question, if only to give yourself a few extra characters to explain your goals, the approach you have in mind, and the jargon you&#39;re using."}, {"owner": {"reputation": 437, "user_id": 5299034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10203272588494957/picture?type=large", "display_name": "BrainFRZ", "link": "https://stackoverflow.com/users/5299034/brainfrz"}, "edited": false, "score": 0, "creation_date": 1508796404, "post_id": 46881790, "comment_id": 80745719, "body": "It seems like the question about sorting lazily is already answered here: <a href=\"https://ondergetekende.nl/lazy-sorting-in-python.html\" rel=\"nofollow noreferrer\">ondergetekende.nl/lazy-sorting-in-python.html</a> Someone created an algorithm to perform a lazy sort with a faster result than a C-optimized TimSort when only sorting about 45% of the list. As far as differentiation, I&#39;ll pursue that further on my own and see if it amounts to anything."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 437, "user_id": 5299034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10203272588494957/picture?type=large", "display_name": "BrainFRZ", "link": "https://stackoverflow.com/users/5299034/brainfrz"}, "edited": false, "score": 0, "creation_date": 1508800461, "post_id": 46881790, "comment_id": 80746815, "body": "@BrainFRZ The techniques discussed there are interesting and useful, but not lazy enough: even if all you care about is the very first element of the sorted list, you still have to look at the very least at every element of the unsorted list to produce it. If your unsorted list is infinite..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 437, "user_id": 5299034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10203272588494957/picture?type=large", "display_name": "BrainFRZ", "link": "https://stackoverflow.com/users/5299034/brainfrz"}, "edited": false, "score": 0, "creation_date": 1508800563, "post_id": 46881790, "comment_id": 80746847, "body": "@BrainFRZ (Indeed, for taking just the elements from the front of the list, Haskell&#39;s built-in <code>sort</code> is already appropriately lazy in that sense. Observing the first k elements of a sorted list of length n takes O(n*log k) time.)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1508731437, "creation_date": 1508731437, "answer_id": 46881790, "question_id": 46881763, "link": "https://stackoverflow.com/questions/46881763/how-can-i-lazily-evaluate-a-list-difference-in-haskell/46881790#46881790", "title": "How can I lazily evaluate a list difference in Haskell?", "body": "<p>If the lists are sorted, you may use the <a href=\"http://hackage.haskell.org/package/data-ordlist-0.4.7.0/docs/Data-List-Ordered.html\" rel=\"noreferrer\"><code>data-ordlist</code></a> package.</p>\n\n<pre><code>Data.List.Ordered&gt; take 5 ([1..] `minus` [2,4..])\n[1,3,5,7,9]\n</code></pre>\n"}], "owner": {"reputation": 437, "user_id": 5299034, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10203272588494957/picture?type=large", "display_name": "BrainFRZ", "link": "https://stackoverflow.com/users/5299034/brainfrz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 46881790, "answer_count": 1, "score": 1, "last_activity_date": 1508731437, "creation_date": 1508731216, "question_id": 46881763, "link": "https://stackoverflow.com/questions/46881763/how-can-i-lazily-evaluate-a-list-difference-in-haskell", "title": "How can I lazily evaluate a list difference in Haskell?", "body": "<p>Is there a way of evaluating a list difference between infinite lists? For example, <code>([1..] \\\\ [2*n | n &lt;- [1..]])</code> should evaluate to <code>[1,3,5,7,</code>...<code>]</code>. Unfortunately, it seems to be forcing evaluation on either the first or second list, or both. Is there a way of avoiding this to get answers? Even using <code>take 5 ([1..] \\\\ [2*n | n &lt;- [1..]])</code> doesn't evaluate to <code>[1,3,5,7,9]</code>, which would be obviously correct. Note, the <code>\\\\</code> operator is imported from Data.List.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1508709576, "post_id": 46878998, "comment_id": 80706294, "body": "Have you tried it?"}, {"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1508843859, "post_id": 46878998, "comment_id": 80764796, "body": "No. Thank you for calling me out on it. I should have and then asked a question."}], "answers": [{"comments": [{"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1508844955, "post_id": 46879280, "comment_id": 80765571, "body": "Thanks! Would it be reasonable, then, to remove the <code>takeMVar s</code> in <code>logStop</code>?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1508876974, "post_id": 46879280, "comment_id": 80786388, "body": "@KevinMeredith ... Did you read the first paragraph I quoted?"}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 4, "last_activity_date": 1508707742, "last_edit_date": 1508707742, "creation_date": 1508707186, "answer_id": 46879280, "question_id": 46878998, "link": "https://stackoverflow.com/questions/46878998/understanding-logging-example-in-parallel-and-concurrent-haskell/46879280#46879280", "title": "Understanding Logging Example in Parallel and Concurrent Haskell", "body": "<p>Without <code>putMVar s ()</code>, calling <code>logStop</code> would hang in <code>takeMVar s</code> because nothing else can fill <code>s</code>. Eventually a <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Exception-Base.html#t:BlockedIndefinitelyOnMVar\" rel=\"nofollow noreferrer\"><code>BlockedIndefinitelyOnMVar</code></a> exception would be thrown, killing the hung thread.</p>\n\n<p><code>s</code> exists for orderly shutdown. It guarantees that by the time <code>logStop</code> returns, the log processing thread has actually stopped.</p>\n\n<p>See also this text from the page you linked:</p>\n\n<blockquote>\n  <p>[...] <code>logStop</code> causes the logging service to terminate. The latter operation is important because if we want to shut down the program, we need to be sure that the logging service has finished processing any outstanding requests. Recall from <a href=\"http://chimera.labs.oreilly.com/books/1230000000929/ch07.html#sec_reminders\" rel=\"nofollow noreferrer\">\u201cA Simple Example: Reminders\u201d</a> that when the main thread exits, the program terminates immediately rather than waiting for other threads to terminate first. Hence <code>logStop</code> has an extra requirement: it must not return until the logging service has processed all outstanding requests and stopped.</p>\n</blockquote>\n\n<p>[...]</p>\n\n<blockquote>\n  <p>After sending the command, we call <code>takeMVar</code> on the new <code>MVar</code> to wait for the response. After the logging thread has processed the <code>Stop</code> command, it puts <code>()</code> into this <code>MVar</code>, which allows the <code>takeMVar</code> to continue and <code>logStop</code> to return.</p>\n</blockquote>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 46879280, "answer_count": 1, "score": 1, "last_activity_date": 1508707742, "creation_date": 1508705098, "question_id": 46878998, "link": "https://stackoverflow.com/questions/46878998/understanding-logging-example-in-parallel-and-concurrent-haskell", "title": "Understanding Logging Example in Parallel and Concurrent Haskell", "body": "<p>In the MVar Logging Example from <a href=\"http://chimera.labs.oreilly.com/books/1230000000929/ch07.html#sec_conc-logger\" rel=\"nofollow noreferrer\">Parallel and Concurrent Haskell</a>, it shows the following:</p>\n\n<pre><code>import Control.Concurrent\nimport Control.Concurrent.MVar\n\ndata Logger = Logger (MVar LogCommand)\n\ndata LogCommand = Message String | Stop (MVar ())\n\ninitLogger :: IO Logger\ninitLogger = do\n  m &lt;- newEmptyMVar\n  let l = Logger m\n  forkIO (logger l)\n  return l\n\nlogger :: Logger -&gt; IO ()\nlogger (Logger m) = loop\n  where \n   loop = do\n    cmd &lt;- takeMVar m\n    case cmd of \n      Message msg -&gt; putStrLn msg &gt;&gt; loop\n      Stop s -&gt; do\n        putStrLn \"logger: stop\"\n        putMVar s ()\n\nlogMessage :: Logger -&gt; String -&gt; IO ()\nlogMessage (Logger m) s = putMVar m (Message s)\n\nlogStop :: Logger -&gt; IO ()\nlogStop (Logger m) = do\n  s &lt;- newEmptyMVar\n  putMVar m (Stop s)\n  takeMVar s\n</code></pre>\n\n<p>What would be lost if <code>logger</code>'s last line, namely <code>putMVar s ()</code>, were deleted? </p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1508699867, "post_id": 46878106, "comment_id": 80703387, "body": "Looking at the instances of <code>Adjunction</code> in <a href=\"https://hackage.haskell.org/package/adjunctions\" rel=\"nofollow noreferrer\">adjunctions</a>, it looks like <code>State</code> and <code>Identity</code> are the only ones... Hardly a proof, and I&#39;m no expert, but I thought this factoid was worth a comment..."}, {"owner": {"reputation": 596, "user_id": 2684007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0dc231525b77cbf9b18251173353c74f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon C", "link": "https://stackoverflow.com/users/2684007/simon-c"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1508700505, "post_id": 46878106, "comment_id": 80703594, "body": "The answer might be no! But it might still be useful to consider some other Hask adjoints and the monads they give rise to, even if those monads aren&#39;t well known."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 4, "creation_date": 1508714578, "post_id": 46878106, "comment_id": 80707412, "body": "I&#39;d say no. The right-hand side of any adjunction is always representable -  to wit: <a href=\"https://hackage.haskell.org/package/adjunctions-4.3/docs/Data-Functor-Adjunction.html#v:tabulateAdjunction\" rel=\"nofollow noreferrer\"><code>tabulateAdjunction</code></a> and <a href=\"https://hackage.haskell.org/package/adjunctions-4.3/docs/Data-Functor-Adjunction.html#v:indexAdjunction\" rel=\"nofollow noreferrer\"><code>indexAdjunction</code></a> - so all adjoint endofuctors on Hask are isomorphic to <code>(-&gt;) r</code> and <code>(,) r</code> for some <code>r</code>. (All monads can be derived as the composition of adjoint functors - just not necessarily endofunctors. Sounds like you already knew that though \ud83d\ude09)"}], "owner": {"reputation": 596, "user_id": 2684007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0dc231525b77cbf9b18251173353c74f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon C", "link": "https://stackoverflow.com/users/2684007/simon-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 2, "answer_count": 0, "score": 5, "last_activity_date": 1508699407, "creation_date": 1508699407, "question_id": 46878106, "link": "https://stackoverflow.com/questions/46878106/which-common-monads-arise-from-adjunctions-in-hask", "title": "Which common monads arise from adjunctions in Hask?", "body": "<p>A common example used to illustrate how monads arise from adjoint functors is <a href=\"https://stackoverflow.com/questions/4697320/monads-as-adjunctions/4702513#4702513\"><code>State</code></a>. One of the reasons this is such a good example is that the two adjoint functors, <code>(-&gt;) r</code> and <code>(,) r</code>, are both endofunctors on Hask. Other canonical monads involve adjoint functors into and out of Hask (e.g., <code>[]</code> and <code>Maybe</code>), which makes them harder to appreciate for people who know Haskell, but who have less background in category theory.</p>\n\n<p>Are there any other common monads that arise via adjoint endofunctors on Hask? (Obviously the <code>Identity</code> monad is one such case, but not a very interesting one.)</p>\n"}, {"tags": ["list", "haskell", "filter", "functional-programming", "list-comprehension"], "comments": [{"owner": {"reputation": 15799, "user_id": 404556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f32018ce9b9c7fb9c7587eba9e4dad4?s=128&d=identicon&r=PG", "display_name": "randomir", "link": "https://stackoverflow.com/users/404556/randomir"}, "edited": false, "score": 2, "creation_date": 1508699350, "post_id": 46878057, "comment_id": 80703210, "body": "Nice overview of list comprehensions in haskell: <a href=\"https://wiki.haskell.org/List_comprehension\" rel=\"nofollow noreferrer\">wiki.haskell.org/List_comprehension</a>"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1508723234, "post_id": 46878057, "comment_id": 80709042, "body": "You should really put some more effort into solving these questions yourself. It looks like all you did was copy the solution from <a href=\"https://stackoverflow.com/a/46876590/5743988\">the <code>map</code> implementation that was given to you in your last question</a>. In the future, please explain more of your thought process on why you&#39;re stumped, so that people can help you better."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 7, "last_activity_date": 1508699259, "creation_date": 1508699259, "answer_id": 46878077, "question_id": 46878057, "link": "https://stackoverflow.com/questions/46878057/implementaion-of-filter-function-haskell/46878077#46878077", "title": "Implementaion of filter function haskell", "body": "<p>Yes, you can write it as:</p>\n\n<pre><code>filter' :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter' f xs = [<b>x</b> | x &lt;- xs<b>, f x</b>]</code></pre>\n\n<p>If you add a an expression in list comprehension that evaluates to a boolean, then you have added a filter to the list comprehension: only if <code>f x</code> evaluates to <code>True</code> here, we will add <code>x</code> to the list.</p>\n\n<p>Note that writing <code>filter' _ [] = []</code> is useless: if you provide an empty list, then the list comprehension will also return an empty list, since <code>x</code> will never pick a value out of <code>xs</code> with <code>x &lt;- xs</code>.</p>\n\n<p>But usually it is better to use the <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:filter\" rel=\"noreferrer\"><strong><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</code></strong></a> builtin.</p>\n"}], "owner": {"reputation": 93, "user_id": 8645908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ac0060648db103008eb6511095b26837?s=128&d=identicon&r=PG&f=1", "display_name": "legoniko", "link": "https://stackoverflow.com/users/8645908/legoniko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "accepted_answer_id": 46878077, "answer_count": 1, "score": -1, "last_activity_date": 1508699259, "creation_date": 1508699056, "question_id": 46878057, "link": "https://stackoverflow.com/questions/46878057/implementaion-of-filter-function-haskell", "title": "Implementaion of filter function haskell", "body": "<p>Is there a way to write an implementation of the Haskell filter function using list comprehension?</p>\n\n<p>An error keeps appearing and I am stumped on how to approach it. This is what I have:</p>\n\n<pre><code>filter' :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter' _ [] = []\nfilter' f xs = [f x | x &lt;- xs]\n</code></pre>\n\n<p>Any guidance or link would be much appreciated.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1508695814, "post_id": 46877509, "comment_id": 80701937, "body": "you have to add the dependency to the <code>build-depends</code> section in your <code>cabal</code>-file."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1508695918, "post_id": 46877509, "comment_id": 80701985, "body": "If you come across any issues please post the errors - otherwise helping you will be difficult."}], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1508696370, "post_id": 46877601, "comment_id": 80702147, "body": "I am not sure, but I think <code>parsec</code> is not developed anymore and <code>mega-parsec</code> is the de-facto successor."}, {"owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "edited": false, "score": 0, "creation_date": 1508696495, "post_id": 46877601, "comment_id": 80702209, "body": "It works actually, is it a convention to write the package name and <code>&gt;&gt; current version &amp;&amp; &lt;... </code>"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 2, "last_activity_date": 1508696807, "last_edit_date": 1508696807, "creation_date": 1508696265, "answer_id": 46877601, "question_id": 46877509, "link": "https://stackoverflow.com/questions/46877509/how-to-add-package-dependencies-to-stack-project/46877601#46877601", "title": "how to add package dependencies to stack project", "body": "<p>the syntax you use in your cabal file is not valid</p>\n\n<pre><code>build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5\n             ,       parsec &gt;= 3.1.11 &amp;&amp; &lt; 4\n</code></pre>\n\n<p>should be correct</p>\n\n<h2>update</h2>\n\n<p>the syntax <code>parsec &gt;= 3.1.11 &amp;&amp; &lt; 4</code> is not mere convention but a way to constrain the used library to the bounds, where your package works.</p>\n\n<p><code>parsec &gt;= 3.1.11 &amp;&amp; &lt; 4</code> means that the version of <code>parsec</code> needs to be larger or equal to version <code>3.1.11</code> and strictly less than <code>4</code>.</p>\n"}], "owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 979, "favorite_count": 1, "accepted_answer_id": 46877601, "answer_count": 1, "score": 1, "last_activity_date": 1508696807, "creation_date": 1508695664, "last_edit_date": 1508696147, "question_id": 46877509, "link": "https://stackoverflow.com/questions/46877509/how-to-add-package-dependencies-to-stack-project", "title": "how to add package dependencies to stack project", "body": "<p>how to add package dependencies to stack project. for example lets say I want to add <code>Parsec</code> dependencies to my project so I can import it in a given module and use it</p>\n\n<p>I have added the package name the cable file and I have got the following error :\n<code>Unable to parse cabal file /Users/lambda/development/blog-post/blog-post.cabal: NoParse \"build-depends\" 19</code></p>\n\n<p>my cabal file is as per the below </p>\n\n<pre><code> build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5\n                      ,parsec-3.1.11\n</code></pre>\n"}, {"tags": ["json", "haskell", "aeson"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1508695132, "post_id": 46877222, "comment_id": 80701701, "body": "Try to boil it down to a single question. Your third question can be answered on <a href=\"https://codereview.stackexchange.com\">Code Review</a> as soon as your code works."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 3, "last_activity_date": 1508696469, "creation_date": 1508696469, "answer_id": 46877638, "question_id": 46877222, "link": "https://stackoverflow.com/questions/46877222/parsing-problematic-json-with-aeson/46877638#46877638", "title": "Parsing problematic JSON with Aeson", "body": "<blockquote>\n  <p>There are no \"tag\" keys, so I'm not sure what this means. I suspect it has to do with the generic instances of <code>FromJSON</code> for <code>Ref</code> and <code>Reference</code>. </p>\n</blockquote>\n\n<p>That's spot on. By <a href=\"http://hackage.haskell.org/package/aeson-1.2.3.0/docs/Data-Aeson.html#v:defaultOptions\" rel=\"nofollow noreferrer\">default,</a> aeson will use the <a href=\"http://hackage.haskell.org/package/aeson-1.2.3.0/docs/Data-Aeson.html#v:defaultTaggedObject\" rel=\"nofollow noreferrer\"><code>defaultTaggedObject</code></a> to encode sum types. <code>References</code> is a sum type. Therefore, aeson introduces a tag to distinguish the constructors. You can try that with a short example:</p>\n\n<pre><code>ghci&gt; data Example = A () | B deriving (Generic,ToJSON)\nghci&gt; encode B\n\"{\\\"tag\\\":\\\"B\\\",\\\"contents\\\":[]}\"\n</code></pre>\n\n<p>When you use <code>_depends &lt;- o .:? \"depends\"</code>, the <code>Reference</code> parser does not find its tag. You have to write some parsing code there yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1508717234, "creation_date": 1508717234, "answer_id": 46880367, "question_id": 46877222, "link": "https://stackoverflow.com/questions/46877222/parsing-problematic-json-with-aeson/46880367#46880367", "title": "Parsing problematic JSON with Aeson", "body": "<blockquote>\n  <p>All of this boilerplate is really because of two keys -- \"type\" and\n  \"depends\". Is there a more elegant way to deal with these keys?</p>\n</blockquote>\n\n<p>You could keep the underscores in the field names and use <a href=\"http://hackage.haskell.org/package/aeson-1.2.3.0/docs/Data-Aeson.html#v:fieldLabelModifier\" rel=\"nofollow noreferrer\"><code>fieldLabelModifier</code></a> in the <a href=\"http://hackage.haskell.org/package/aeson-1.2.3.0/docs/Data-Aeson.html#t:Options\" rel=\"nofollow noreferrer\"><code>Options</code></a> data type to strip them for parsing purposes.</p>\n"}], "owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 1, "accepted_answer_id": 46877638, "answer_count": 2, "score": 4, "last_activity_date": 1508717234, "creation_date": 1508693955, "question_id": 46877222, "link": "https://stackoverflow.com/questions/46877222/parsing-problematic-json-with-aeson", "title": "Parsing problematic JSON with Aeson", "body": "<p>I am trying to parse JSON objects, which are generally of the form</p>\n\n<pre><code>{\n  \"objects\": [a bunch of records that can assume a few different forms],\n  \"parameters\": [same deal],\n  \"values\": {\n              \"k1\": \"v1\",\n              \"k2\": \"v2\",\n              ...\n            }\n}\n</code></pre>\n\n<p>using Haskell's Aeson library.  Part of this task is simple in the sense that the <code>parameters</code> and <code>values</code> fields need no custom parsing whatsoever (and so seem to need only a generically derived instance of <code>FromJSON</code>), and <em>most</em> of the records contained within the array associated to <code>objects</code> also need no special parsing.  However, there are some parts of parsing the records within the array of <code>objects</code> that, when considered separately, have documented solutions, but together present problems that I haven't figured out how to address.  </p>\n\n<p>Now, the possible variants of record inside the <code>objects</code> and <code>parameters</code> arrays are finite in number and often contain the same keys; for example, all of them have a \"name\" key or an \"id\" key, or such.  But also many of them have a \"type\" key, which is a reserved keyword, and so cannot be parsed generically.  This is the first problem.  </p>\n\n<p>The second problem is that one of the possible variants of record inside <code>objects</code> can have a key -- \"depends\" let's say -- whose value may assume different types.  It can either be a single record</p>\n\n<pre><code>{\n  \"objects\": [\n    {\n      \"depends\": {\n        \"reference\": \"r1\"\n      },\n    ...\n  ],\n  ...\n}\n</code></pre>\n\n<p>or a list of records</p>\n\n<pre><code>{\n  \"objects\": [\n    \"depends\": [\n      {\"reference\": \"r1\"},\n      {\"reference\": \"r2\"},\n      etc.\n    ],\n  ],\n...\n}\n</code></pre>\n\n<p>and it happens that this is the one field that I would like to manipulate in a custom fashion after converting to a Haskell object (eventually I want to represent the collection of such \"depends\" references as a <code>Data.Graph</code> graph).    </p>\n\n<p>My initial attempt was to create one huge record type that subsumes all of the possible keys in the elements of the <code>objects</code> and <code>parameters</code> arrays.  Something like this:</p>\n\n<pre><code>{-# LANGUAGE DeriveAnyClass    #-}\n{-# LANGUAGE DeriveGeneric     #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE RecordWildCards   #-}\n\nimport Data.Aeson\nimport GHC.Generics\n\ndata Ref = Ref\n  { ref :: String\n  } deriving (Show, Generic, FromJSON, ToJSON)\n\ndata Reference \n  = Reference Ref\n  | References [Ref]\n  deriving (Show, Generic, FromJSON, ToJSON)\n\ntype MString = Maybe String -- I'm writing this a lot using this approach\n\ndata PObject = PObject \n  -- Each of the object/parameter records have these keys\n  { _name    :: String\n  , _id      :: String\n\n  -- Other keys that might appear in a given object/parameter record\n  , _type    :: MString\n  , _role    :: MString\n  , _depends :: Maybe Reference\n\n  -- A bunch more\n  } deriving Show\n\ninstance FromJSON PObject where\n  parseJSON = withObject \"PObject\" $ \\o -&gt; do\n    _name    &lt;- o .: \"name\"\n    _id      &lt;- o .: \"id\"\n    _type    &lt;- o .:? \"type\"\n    _role    &lt;- o .:? \"role\"\n    _depends &lt;- o .:? \"depends\"\n    -- etc.\n    return PObject{..}\n</code></pre>\n\n<p>And then finally, the whole JSON object would be represented like</p>\n\n<pre><code>data MyJSONObject = MyJSONObject\n  { objects    :: Maybe [PObject]\n  , parameters :: Maybe [PObject]\n  , values     :: Maybe Object\n  } deriving (Show, Generic, FromJSON)\n</code></pre>\n\n<p>This works until it tries to parse a \"depends\" field, reporting that</p>\n\n<pre><code>\"Error in $.objects[2].depends: key \\\"tag\\\" not present\"\n</code></pre>\n\n<p>There are no \"tag\" keys, so I'm not sure what this means.  I suspect it has to do with the generic instances of <code>FromJSON</code> for <code>Ref</code> and <code>Reference</code>.  </p>\n\n<p><strong>My questions:</strong></p>\n\n<ol>\n<li>What does this error indicate?  So far in my learning of Haskell, the errors have always been very helpful.  This one is not.  Do I need to do something special for the \"depends\" key in my <code>parseJSON</code> function?</li>\n<li>All of this boilerplate is really because of two keys -- \"type\" and \"depends\".  Is there a more elegant way to deal with these keys?</li>\n<li>Relatedly, this is part of my first <em>real</em> Haskell project, so I have a more general design question.  Experienced Haskellers and Aeson users, how would you lay out your types and instances for this type of JSON?  I tried listing out each possible variant of <code>objects</code>/<code>parameters</code> record as its own separate type, and only writing custom <code>FromJSON</code> instances for those that have a \"depends\" or \"type\" key, but this produced a lot more boilerplate code and in any case doesn't solve any of the other issues I have.  General pointers on \"best practices\", idiomatic usage, etc. would be extremely useful and appreciated.  </li>\n</ol>\n"}, {"tags": ["macos", "haskell", "installation", "atom-editor", "ghc-mod"], "answers": [{"comments": [{"owner": {"reputation": 2952, "user_id": 8547198, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/jUGuR.png?s=128&g=1", "display_name": "mrCarnivore", "link": "https://stackoverflow.com/users/8547198/mrcarnivore"}, "edited": false, "score": 0, "creation_date": 1508742329, "post_id": 46881562, "comment_id": 80714479, "body": "Thanks for the help. base-version 4.10.0.0 really seems to be the reason (it does say &quot;base not &lt; 4.10.0.0&quot; in the error message but I somehow read &lt;= 4.10.0.0 which I could not understand...) However, I even tried stack install - ghc-mod, but the result is the same, since ghc-mod will not be installed with base = 4.10.0.0. I could not find a way to uninstall and unregister it completely, though. Even stack clean did not work... :-("}, {"owner": {"reputation": 2952, "user_id": 8547198, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/jUGuR.png?s=128&g=1", "display_name": "mrCarnivore", "link": "https://stackoverflow.com/users/8547198/mrcarnivore"}, "edited": false, "score": 0, "creation_date": 1508742860, "post_id": 46881562, "comment_id": 80714761, "body": "After trying <i>stack install ghc-mod hoogle hasktags pointfree pointful cabal-install</i> (what they recommend in atom-haskell package) and adding the path that was mentioned during the installation <i>/Users/daniel/.local/bin</i> to the path in atom it seemed to work, and there is no starting error message in atom any more. But still: clicking <i>Haskell IDE/Builder/build project</i> in atom leads to: &quot;ide-haskell-cabal ERROR no cabal found&quot;... :-("}, {"owner": {"reputation": 691, "user_id": 5818274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f1f96eca9ced377b8ebedc809d6a18?s=128&d=identicon&r=PG", "display_name": "Holland Wilson", "link": "https://stackoverflow.com/users/5818274/holland-wilson"}, "edited": false, "score": 0, "creation_date": 1508963143, "post_id": 46881562, "comment_id": 80830199, "body": "You may need to <a href=\"https://atom-haskell.github.io/core-packages/ide-haskell-cabal/\" rel=\"nofollow noreferrer\">configure settings</a> for the <code>ide-haskell-cabal</code> package."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 2, "last_activity_date": 1508729512, "creation_date": 1508729512, "answer_id": 46881562, "question_id": 46876757, "link": "https://stackoverflow.com/questions/46876757/problems-installing-haskell-with-atom-on-a-mac/46881562#46881562", "title": "Problems installing Haskell with Atom on a Mac", "body": "<p>I can advise you on one part of the problem. The error message from <code>cabal</code> is very confusing, but what it means is:</p>\n\n<ul>\n<li><code>ghc-mod</code> does not work with a version 4.10.0.0 of the <code>base</code></li>\n<li>The <code>base</code> library ships with GHC and cannot be changed</li>\n<li>GHC 8.2.1 ships with base 4.10.0.0</li>\n<li>Therefore: you cannot build <code>ghc-mod</code> with the version of the Haskell Platform you downloaded</li>\n</ul>\n\n<p>You can work around this by downloading an older Haskell Platform (8.0.2). In my opinion: it's premature for the promoted Haskell Platform version to be 8.2.1.</p>\n\n<p>Another approach is using Stack, which will manage the installation of GHC installations for you. In this case, running <code>stack install ghc-mod</code> <em>should</em> just work. But since you'll still be using GHC 8.2.1 from the Haskell Platform, it won't do you much good, since ghc-mod is tied to your GHC version.</p>\n\n<p>Personally: I never had success setting up ghc-mod. I've also never used either Atom or VS Code, but I've heard people sharing good experiences with VS Code + Haskero, so if you're looking for an IDE-like experience, that may be something worth considering. I've switched over to using emacs+intero mode, which may be something to consider.</p>\n\n<p>Here are some links that may be helpful on getting started with tooling:</p>\n\n<ul>\n<li><a href=\"https://haskell-lang.org/get-started\" rel=\"nofollow noreferrer\">https://haskell-lang.org/get-started</a></li>\n<li><a href=\"https://haskell-lang.org/intero\" rel=\"nofollow noreferrer\">https://haskell-lang.org/intero</a></li>\n</ul>\n"}], "owner": {"reputation": 2952, "user_id": 8547198, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/jUGuR.png?s=128&g=1", "display_name": "mrCarnivore", "link": "https://stackoverflow.com/users/8547198/mrcarnivore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 651, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1508729512, "creation_date": 1508691218, "last_edit_date": 1508692617, "question_id": 46876757, "link": "https://stackoverflow.com/questions/46876757/problems-installing-haskell-with-atom-on-a-mac", "title": "Problems installing Haskell with Atom on a Mac", "body": "<p>I want to program in Haskell using Atom on a Mac. Therefore I installed the following packages in Atom:</p>\n\n<pre><code>haskell-ghc-mod\nide-haskell\nide-haskell-cabal\nlanguage-haskell\n</code></pre>\n\n<p>After that I installed the Haskell Platform 8.2.1 from here:\n<a href=\"https://www.haskell.org/platform/#osx-none\" rel=\"nofollow noreferrer\">https://www.haskell.org/platform/#osx-none</a></p>\n\n<p>This did not seem to work as I cannot compile and during every start of Atom there is this error message:</p>\n\n<pre><code>Haskell-ghc-mod: ghc-mod failed to launch. It is probably missing or misconfigured. ENOENT\n</code></pre>\n\n<p>Then I tried installing the necessary packages manually as described on <a href=\"https://atom-haskell.github.io/installation/installing-binary-dependencies/\" rel=\"nofollow noreferrer\">https://atom-haskell.github.io/installation/installing-binary-dependencies/</a> which also failed (even unregistering failed):</p>\n\n<pre><code>Daniels-MacBook-Pro:ghc-mod-sandbox daniel$ cabal install ghc-mod stylish-haskell\n\nResolving dependencies...\ncabal: Could not resolve dependencies:\ntrying: ghc-mod-5.8.0.0 (user goal)\nnext goal: base (dependency of ghc-mod-5.8.0.0)\nrejecting: base-4.10.0.0/installed-4.1... (conflict: ghc-mod =&gt; base&lt;4.10 &amp;&amp;\n&gt;=4.6.0.1)\nrejecting: base-4.10.0.0, base-4.9.1.0, base-4.9.0.0, base-4.8.2.0,\nbase-4.8.1.0, base-4.8.0.0, base-4.7.0.2, base-4.7.0.1, base-4.7.0.0,\nbase-4.6.0.1, base-4.6.0.0, base-4.5.1.0, base-4.5.0.0, base-4.4.1.0,\nbase-4.4.0.0, base-4.3.1.0, base-4.3.0.0, base-4.2.0.2, base-4.2.0.1,\nbase-4.2.0.0, base-4.1.0.0, base-4.0.0.0, base-3.0.3.2, base-3.0.3.1\n(constraint from non-upgradeable package requires installed instance)\nAfter searching the rest of the dependency tree exhaustively, these were the\ngoals I've had most trouble fulfilling: base, ghc-mod, syb\nNote: when using a sandbox, all packages are required to have consistent\ndependencies. Try reinstalling/unregistering the offending packages or\nrecreating the sandbox.\nDaniels-MacBook-Pro:ghc-mod-sandbox daniel$ cabal uninstall ghc-mod stylish-haskell\ncabal: This version of 'cabal-install' does not support the 'uninstall'\noperation. It will likely be implemented at some point in the future; in the\nmeantime you're advised to use either 'ghc-pkg unregister ghc-mod' or 'cabal\nsandbox hc-pkg -- unregister ghc-mod'.\n\nDaniels-MacBook-Pro:ghc-mod-sandbox daniel$ ghc-pkg unregister ghc-mod\n\nghc-pkg: cannot find package ghc-mod\n\nDaniels-MacBook-Pro:ghc-mod-sandbox daniel$ cabal sandbox hc-pkg -- unregister ghc-mod\n\nghc-pkg: cannot find package ghc-mod\n\nDaniels-MacBook-Pro:ghc-mod-sandbox daniel$ cabal install ghc-mod stylish-haskell\n\nResolving dependencies...\ncabal: Could not resolve dependencies:\ntrying: ghc-mod-5.8.0.0 (user goal)\nnext goal: base (dependency of ghc-mod-5.8.0.0)\nrejecting: base-4.10.0.0/installed-4.1... (conflict: ghc-mod =&gt; base&lt;4.10 &amp;&amp;\n&gt;=4.6.0.1)\nrejecting: base-4.10.0.0, base-4.9.1.0, base-4.9.0.0, base-4.8.2.0,\nbase-4.8.1.0, base-4.8.0.0, base-4.7.0.2, base-4.7.0.1, base-4.7.0.0,\nbase-4.6.0.1, base-4.6.0.0, base-4.5.1.0, base-4.5.0.0, base-4.4.1.0,\nbase-4.4.0.0, base-4.3.1.0, base-4.3.0.0, base-4.2.0.2, base-4.2.0.1,\nbase-4.2.0.0, base-4.1.0.0, base-4.0.0.0, base-3.0.3.2, base-3.0.3.1\n(constraint from non-upgradeable package requires installed instance)\nAfter searching the rest of the dependency tree exhaustively, these were the\ngoals I've had most trouble fulfilling: base, ghc-mod, syb\nNote: when using a sandbox, all packages are required to have consistent\ndependencies. Try reinstalling/unregistering the offending packages or\nrecreating the sandbox. \n</code></pre>\n\n<p>I already searched stackoverflow for answers but nothing really worked for me. Can anybody tell me what I am missing?</p>\n"}, {"tags": ["list", "haskell", "list-comprehension", "map-function"], "comments": [{"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 2, "creation_date": 1508690290, "post_id": 46876549, "comment_id": 80700075, "body": "The type signature says <code>map</code>, but the implementation says <code>zip</code> (with a redundant case)."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1508690443, "post_id": 46876549, "comment_id": 80700133, "body": "The first argument to <code>map</code> is a function (as per the type signature).  <code>map</code> applies the function to each element of the list, returning the list of results).  You are creating pairs from elements of 2 lists, which is <code>zip</code>"}], "answers": [{"tags": [], "owner": {"reputation": 9806, "user_id": 382982, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9ZaxF.jpg?s=128&g=1", "display_name": "pdoherty926", "link": "https://stackoverflow.com/users/382982/pdoherty926"}, "is_accepted": true, "score": 4, "last_activity_date": 1508691693, "last_edit_date": 1508691693, "creation_date": 1508690215, "answer_id": 46876590, "question_id": 46876549, "link": "https://stackoverflow.com/questions/46876549/map-function-using-list-implementation-haskell/46876590#46876590", "title": "Map Function using list implementation haskell", "body": "<p>I believe you mean \"comprehension\", instead of \"implementation\". </p>\n\n<p>Either way, this would work:</p>\n\n<pre><code>map' f as = [f a | a &lt;- as]\nmap' (* 2) [1..5]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1508717888, "last_edit_date": 1508717888, "creation_date": 1508699445, "answer_id": 46878111, "question_id": 46876549, "link": "https://stackoverflow.com/questions/46876549/map-function-using-list-implementation-haskell/46878111#46878111", "title": "Map Function using list implementation haskell", "body": "<p>Note that </p>\n\n<pre><code>map' f xs = [f x | x &lt;- xs]\n</code></pre>\n\n<p>desugars to</p>\n\n<pre><code>map' f xs = do x &lt;- xs\n               return $ f x\n</code></pre>\n\n<p>which desugars to</p>\n\n<pre><code>map' f xs = xs &gt;&gt;= return . f\n</code></pre>\n\n<p>which is the well-known definition (if you replace <code>map'</code> with <code>fmap</code>) for defining a <code>Functor</code> instance from a <code>Monad</code> instance (thus proving that all monads are also functors).</p>\n\n<p>Specifically, it shows that a list comprehension is simply a disguised version of the definition of <code>map</code> in terms of monadic operators.</p>\n"}], "owner": {"reputation": 93, "user_id": 8645908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ac0060648db103008eb6511095b26837?s=128&d=identicon&r=PG&f=1", "display_name": "legoniko", "link": "https://stackoverflow.com/users/8645908/legoniko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1628, "favorite_count": 0, "accepted_answer_id": 46876590, "answer_count": 2, "score": -1, "last_activity_date": 1508717888, "creation_date": 1508689995, "last_edit_date": 1508690266, "question_id": 46876549, "link": "https://stackoverflow.com/questions/46876549/map-function-using-list-implementation-haskell", "title": "Map Function using list implementation haskell", "body": "<p>Is there a way to write an implementation of the Haskell <code>map</code> function using list implementation?</p>\n\n<p>I keep getting an error and I do not think I am on the right track. This is what I have:</p>\n\n<pre><code>map' :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmap' _ [] = []\nmap' xs ys = [ (x, y) | x &lt;- xs | y &lt;- ys ]\n</code></pre>\n\n<p>Any help or link that will guide me in the right direction would be much appreciated.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1508688217, "post_id": 46876162, "comment_id": 80699291, "body": "Hint: how to convert a binary list to its numeric equivalent?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 8, "creation_date": 1508689635, "post_id": 46876162, "comment_id": 80699829, "body": "Which part are you having trouble with?  What have you tried (or thought about trying) so far?"}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 1612614, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1eb300f91a6949bb637dfe98bbb9d11f?s=128&d=identicon&r=PG", "display_name": "Matt Ahrens", "link": "https://stackoverflow.com/users/1612614/matt-ahrens"}, "is_accepted": false, "score": 1, "last_activity_date": 1508708929, "creation_date": 1508708929, "answer_id": 46879476, "question_id": 46876162, "link": "https://stackoverflow.com/questions/46876162/calculate-character-represented-by-binary/46879476#46879476", "title": "Calculate Character represented by Binary", "body": "<p>You can:</p>\n\n<ol>\n<li>Write a function that converts a list of integers (binary) into a base 10 integer (Int)</li>\n<li>compose that function with <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Char.html#v:chr\" rel=\"nofollow noreferrer\"><code>chr</code></a> from the module <code>Data.Char</code></li>\n<li>use <code>map</code> to apply those composed functions (which convert binary to base 10 and then to a character) to map over the list of binary reps and turn it into a list of characters -- which is a String.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": false, "score": 1, "last_activity_date": 1508711126, "creation_date": 1508711126, "answer_id": 46879754, "question_id": 46876162, "link": "https://stackoverflow.com/questions/46876162/calculate-character-represented-by-binary/46879754#46879754", "title": "Calculate Character represented by Binary", "body": "<p>You can do a <code>foldl</code> over a list to calculate its integer value, then use <code>chr</code> to interpret the integer as a unicode code point (of which ascii is a subset).</p>\n\n<pre><code>\u03bb&gt; import Data.Char (chr)\n\u03bb&gt; fmap (chr . foldl (\\x y -&gt; 2*x + y) 0) [[0,1,1,0,0,0,0,1],[0,1,1,0,0,0,1,0]]\n\"ab\"\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 7841878, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ea84e22431b5da70d9f514ee95767b09?s=128&d=identicon&r=PG&f=1", "display_name": "James Hamish", "link": "https://stackoverflow.com/users/7841878/james-hamish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1508711126, "creation_date": 1508687952, "last_edit_date": 1508688046, "question_id": 46876162, "link": "https://stackoverflow.com/questions/46876162/calculate-character-represented-by-binary", "title": "Calculate Character represented by Binary", "body": "<p>I have an <code>[[Int]]</code> with value such as <code>[[0,1,1,0,0,0,0,1],[0,1,1,0,0,0,1,0]]</code>.</p>\n\n<p>I need to convert this to the ascii representation such as \"ab\".</p>\n\n<p>Could somebody give me some pointers about how I would go about doing this in Haskell?</p>\n"}, {"tags": ["html", "haskell", "functional-programming", "hamlet"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8815059, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZAm2QjiG6gE/AAAAAAAAAAI/AAAAAAAABJg/1oNW7DxIsXs/photo.jpg?sz=128", "display_name": "Narciso jr", "link": "https://stackoverflow.com/users/8815059/narciso-jr"}, "edited": false, "score": 0, "creation_date": 1508690516, "post_id": 46876057, "comment_id": 80700160, "body": "Thanks for your answer, but now I&#39;m getting an error with the $doctype 5 line:      /home/ubuntu/workspace/yesodvazio/src/Handler/Index.hs:16:9:       error:      parse error on input \u2018$\u2019      Perhaps you intended to use TemplateHaskell"}, {"owner": {"reputation": 1, "user_id": 8815059, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZAm2QjiG6gE/AAAAAAAAAAI/AAAAAAAABJg/1oNW7DxIsXs/photo.jpg?sz=128", "display_name": "Narciso jr", "link": "https://stackoverflow.com/users/8815059/narciso-jr"}, "edited": false, "score": 0, "creation_date": 1508692171, "post_id": 46876057, "comment_id": 80700762, "body": "I deleted the TemplateHaskell and added the QuasiQuotes line, just like you said, then came an error at the &quot;[hamlet|&quot; and &quot;[cassius|&quot; lines because I forgot using space between the |, and after this, this error that I pasted above showed up"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 1, "user_id": 8815059, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZAm2QjiG6gE/AAAAAAAAAAI/AAAAAAAABJg/1oNW7DxIsXs/photo.jpg?sz=128", "display_name": "Narciso jr", "link": "https://stackoverflow.com/users/8815059/narciso-jr"}, "edited": false, "score": 0, "creation_date": 1508692329, "post_id": 46876057, "comment_id": 80700809, "body": "No, don&#39;t add a space before the <code>|</code>.  I only showed spaces in my example to show you that Haskell was parsing it as a list comprehension (which is usually written with spaces).  Delete your space -- it must start with <code>[hamlet| ...</code>.  Spaces <b>after</b> the <code>|</code> are fine, but not before."}, {"owner": {"reputation": 1, "user_id": 8815059, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZAm2QjiG6gE/AAAAAAAAAAI/AAAAAAAABJg/1oNW7DxIsXs/photo.jpg?sz=128", "display_name": "Narciso jr", "link": "https://stackoverflow.com/users/8815059/narciso-jr"}, "edited": false, "score": 0, "creation_date": 1508693177, "post_id": 46876057, "comment_id": 80701067, "body": "If I delete the spaces before it shows these errors:      /home/ubuntu/workspace/yesodvazio/src/Handler/Index.hs:15:37&zwnj;&#8203;:      error:Variable not in scope: bootstrap_css :: Route Static      /home/ubuntu/workspace/yesodvazio/src/Handler/Index.hs:16:21&zwnj;&#8203;: error:     \u2022 Couldn&#39;t match expected type \u2018WidgetT App IO a0\u2019                   with actual type \u2018t0                                     -&gt; blaze-markup-0.8.0.0:Text.Blaze.Internal.Markup\u2019  Being the last one repeated at the Cassius line"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 1, "user_id": 8815059, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZAm2QjiG6gE/AAAAAAAAAAI/AAAAAAAABJg/1oNW7DxIsXs/photo.jpg?sz=128", "display_name": "Narciso jr", "link": "https://stackoverflow.com/users/8815059/narciso-jr"}, "edited": false, "score": 1, "creation_date": 1508694021, "post_id": 46876057, "comment_id": 80701318, "body": "Yes, so your problem is solved, and you have other problems:  you&#39;ve failed to define <code>bootstrap_css</code>, for one thing."}, {"owner": {"reputation": 1, "user_id": 8815059, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZAm2QjiG6gE/AAAAAAAAAAI/AAAAAAAABJg/1oNW7DxIsXs/photo.jpg?sz=128", "display_name": "Narciso jr", "link": "https://stackoverflow.com/users/8815059/narciso-jr"}, "edited": false, "score": 0, "creation_date": 1508695936, "post_id": 46876057, "comment_id": 80701993, "body": "But the boostrap_css error is just one of the problems, there is errors at the [hamlet| and [cassius| lines too  /home/ubuntu/workspace/yesodvazio/src/Handler/Index.hs:15:21&zwnj;&#8203;: error:     \u2022 Couldn&#39;t match expected type \u2018WidgetT App IO a0\u2019                   with actual type \u2018t0                                     -&gt; blaze-markup-0.8.0.0:Text.Blaze.Internal.Markup\u2019"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 1, "user_id": 8815059, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZAm2QjiG6gE/AAAAAAAAAAI/AAAAAAAABJg/1oNW7DxIsXs/photo.jpg?sz=128", "display_name": "Narciso jr", "link": "https://stackoverflow.com/users/8815059/narciso-jr"}, "edited": false, "score": 3, "creation_date": 1508696552, "post_id": 46876057, "comment_id": 80702231, "body": "Stack Overflow isn&#39;t a code debugging or code writing service, so I don&#39;t think anyone is going to be willing to have an extended conversation in the comments to help you fix all the bugs in your code.  Now that you have a new problem unrelated to your old problem, I would suggest that you submit a new question, with an accurate <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that demonstrates the new error messages."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 2, "last_activity_date": 1508692534, "last_edit_date": 1508692534, "creation_date": 1508687408, "answer_id": 46876057, "question_id": 46875832, "link": "https://stackoverflow.com/questions/46875832/problems-with-haskell-hamlet/46876057#46876057", "title": "Problems with Haskell/Hamlet", "body": "<p>You need to enable:</p>\n\n<pre><code>{-# LANGUAGE QuasiQuotes #-}\n</code></pre>\n\n<p>instead of <code>TemplateHaskell</code> or else GHC tries to parse your <code>[hamlet|...|]</code> clause as if it was the start of a list comprehension, like this:</p>\n\n<pre><code>[ hamlet | hamlet &lt;- [\"alas\", \"poor\", \"yorick\"] ]\n^^^^^^^^^^ -- GHC thinks you're starting to write this\n           -- and can't parse the rest.\n</code></pre>\n\n<p>(The <code>TemplateHaskell</code> extension <em>only</em> enables quasiquote syntax for the specific quasiquote types that it recognizes, and tries to parse everything else as list comprehension syntax.)</p>\n"}], "owner": {"reputation": 1, "user_id": 8815059, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ZAm2QjiG6gE/AAAAAAAAAAI/AAAAAAAABJg/1oNW7DxIsXs/photo.jpg?sz=128", "display_name": "Narciso jr", "link": "https://stackoverflow.com/users/8815059/narciso-jr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508692534, "creation_date": 1508686013, "question_id": 46875832, "link": "https://stackoverflow.com/questions/46875832/problems-with-haskell-hamlet", "title": "Problems with Haskell/Hamlet", "body": "<p>I'm a beginner at haskell and I'm trying to use hamlet, but I'm no getting the syntax right. When I use this Code: </p>\n\n<pre><code>{-# LANGUAGE NoImplicitPrelude #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE TypeFamilies #-}\nmodule Handler.Index where\n\nimport Import\nimport Network.HTTP.Types.Status\nimport Database.Persist.Postgresql\n\ngetIndexR :: Handler Html\ngetIndexR = defaultLayout $ do\naddStylesheet $ StaticR bootstrap_css\n[hamlet|\n        $doctype 5\n        &lt;html&gt;\n            &lt;head&gt;\n\n            &lt;body&gt;\n\n        |]\n\n[cassius|\n        .classe\n            background: red;\n        |]\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>romefeller:~/workspace/yesodvazio (master) $ stack build &amp;&amp; stack exec \naulahaskell\naulahaskell-0.0.0: build (lib + exe)\nPreprocessing library aulahaskell-0.0.0...\n[8 of 9] Compiling Handler.Index    ( src/Handler/Index.hs, .stack-\nwork/dist/x86_64-linux/Cabal-1.24.2.0/build/Handler/Index.o )\n\n/home/ubuntu/workspace/yesodvazio/src/Handler/Index.hs:18:17: error: parse \nerror on input \u2018&lt;\u2019\n\n--  While building package aulahaskell-0.0.0 using:\n  /home/ubuntu/.stack/setup-exe-cache/x86_64-linux/Cabal-\nsimple_mPHDZzAJ_1.24.2.0_ghc-8.0.2 --builddir=.stack-work/dist/x86_64-\nlinux/Cabal-1.24.2.0 build lib:aulahaskell exe:aulahaskell --ghc-options \" -\nddump-hi -ddump-to-file\"\nProcess exited with code: ExitFailure 1\n</code></pre>\n\n<p>What am I missing? Do I need to import any librarie or something? </p>\n"}, {"tags": ["haskell", "configuration", "haskell-stack"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1508685103, "post_id": 46875345, "comment_id": 80698247, "body": "What about putting the configuration in your project specific stack.yaml instead?"}, {"owner": {"reputation": 4918, "user_id": 1631106, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42cac823ac4fa7a9c9e91599a0ff528f?s=128&d=identicon&r=PG", "display_name": "ivan", "link": "https://stackoverflow.com/users/1631106/ivan"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1508685791, "post_id": 46875345, "comment_id": 80698457, "body": "@MichaelSnoyman I was actually running into this when running <code>stack new</code>, so I didn&#39;t have a project specific config yet. I suppose I could add work-specific config files to each work project. That seems like a lot of duplication so I was hoping to find another way."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1508685865, "post_id": 46875345, "comment_id": 80698484, "body": "Another option would be setting the <code>STACK_ROOT</code> environment variable to different paths depending on what index you want to use. There&#39;s no built-in feature to do something based on directories like you&#39;re asking."}], "owner": {"reputation": 4918, "user_id": 1631106, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42cac823ac4fa7a9c9e91599a0ff528f?s=128&d=identicon&r=PG", "display_name": "ivan", "link": "https://stackoverflow.com/users/1631106/ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508706815, "creation_date": 1508683204, "last_edit_date": 1508706815, "question_id": 46875345, "link": "https://stackoverflow.com/questions/46875345/haskell-stack-separate-work-and-non-work-configs", "title": "Haskell Stack: separate work and non-work configs?", "body": "<p>My <code>~/.stack/config.yml</code> contains a private package-index in addition to Hackage. This is for work. I'd like to manage this so work projects will use Hackage and the work-specific index, while non-work projects will just use Hackage.</p>\n\n<p>Git recently added conditional includes (<code>includeIf</code>) to <a href=\"https://git-scm.com/docs/git-config\" rel=\"nofollow noreferrer\">git config</a>, which makes it possible to adjust configs based on the path to the repo. Does something like this exist for Haskell Stack, or is there some other solution I can reach for?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 521, "user_id": 7126380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207438513426512/picture?type=large", "display_name": "Johnny Liao", "link": "https://stackoverflow.com/users/7126380/johnny-liao"}, "edited": false, "score": 1, "creation_date": 1508680049, "post_id": 46874222, "comment_id": 80696484, "body": "Thx. I see it now. And with z :: t in expression, banana (x :: (a -&gt; m b)) (y :: m a) can produce exactly the right resulting type (m b)."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 2, "last_activity_date": 1508676312, "creation_date": 1508676312, "answer_id": 46874222, "question_id": 46873964, "link": "https://stackoverflow.com/questions/46873964/20-intermediate-haskell-exercise-exercise-9/46874222#46874222", "title": "20 intermediate haskell exercise - Exercise 9", "body": "<p>The key insight is that the signature </p>\n\n<pre><code>(a -&gt; (t-&gt;b)) -&gt; (t-&gt;a) -&gt; (t-&gt;b)\n</code></pre>\n\n<p>Is equivalent to:</p>\n\n<pre><code>(a -&gt; (t-&gt;b)) -&gt; (t-&gt;a) -&gt; t -&gt; b\n</code></pre>\n\n<p>This means that the binding <code>banana x y z</code> binds the following:</p>\n\n<pre><code>x :: a -&gt; (t-&gt;b)\ny :: t -&gt; a\nz :: t\n</code></pre>\n\n<p>And therefore:</p>\n\n<pre><code>y z :: a\nx $ y z :: t -&gt; b\n(x $ y z) z :: b\n</code></pre>\n"}], "owner": {"reputation": 521, "user_id": 7126380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207438513426512/picture?type=large", "display_name": "Johnny Liao", "link": "https://stackoverflow.com/users/7126380/johnny-liao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 46874222, "answer_count": 1, "score": 1, "last_activity_date": 1508676312, "creation_date": 1508674650, "question_id": 46873964, "link": "https://stackoverflow.com/questions/46873964/20-intermediate-haskell-exercise-exercise-9", "title": "20 intermediate haskell exercise - Exercise 9", "body": "<p>I was working on 20 intermediate haskell exercise. And Exercise 9 is:</p>\n\n<pre><code>class Misty m where\n    banana :: (a -&gt; m b) -&gt; m a -&gt; m b\n    unicorn :: a -&gt; m a\n</code></pre>\n\n<p>And the solution offered <a href=\"https://gist.github.com/dmalikov/1493055\" rel=\"nofollow noreferrer\">here</a> is</p>\n\n<pre><code>instance Misty ((-&gt;) t) where\n    banana x y z = (x $ y z) z\n    unicorn f _ = f\n</code></pre>\n\n<p>If I replace m with ((->) t) in banana's type signature, I get</p>\n\n<pre><code>(a -&gt; (t-&gt;b)) -&gt; (t-&gt;a) -&gt; (t-&gt;b)\n</code></pre>\n\n<p>It seems a binding function for ((->) t). So why does banana needs three arguments? And why the answer is (x $ y z) z?</p>\n\n<p>Thank you for help. :)</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1508682652, "post_id": 46873934, "comment_id": 80697418, "body": "have you tried adding a dummy main (<code>main = putStrLn &quot;It works!&quot;</code>)to your <code>Test.hs</code>-file, each executable <b>must</b> include such a function. - I don&#39;t think ghc is interested in issuing warnings when there are more critical mistakes at hand"}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 4, "last_activity_date": 1508857476, "last_edit_date": 1508857476, "creation_date": 1508684651, "answer_id": 46875571, "question_id": 46873934, "link": "https://stackoverflow.com/questions/46873934/why-does-stack-not-pass-my-ghc-options-to-the-compiler/46875571#46875571", "title": "Why does stack not pass my ghc-options to the compiler?", "body": "<p>The options <code>-ddump-hi -ddump-to-file</code> are being passed <strong>by Stack to Cabal</strong>.  Cabal then adds them to the options specified in the <code>.cabal</code> file before passing them along to GHC.</p>\n\n<p>If you run Stack with:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>stack -v --cabal-verbose\n</code></pre>\n\n<p>and search through the output, you'll see that your options <em>are</em> in fact being passed to GHC.</p>\n\n<p>As @epsilonhalbe noted, GHC isn't complaining about the more minor issues when it discovers that <code>main</code> is missing, so if you add:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>main = undefined\n</code></pre>\n\n<p>to the bottom of your program, you'll get the warnings you're expecting.</p>\n"}], "owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 1, "accepted_answer_id": 46875571, "answer_count": 1, "score": 4, "last_activity_date": 1508857476, "creation_date": 1508674417, "question_id": 46873934, "link": "https://stackoverflow.com/questions/46873934/why-does-stack-not-pass-my-ghc-options-to-the-compiler", "title": "Why does stack not pass my ghc-options to the compiler?", "body": "<p>In the cabal file I specify the GHC options <code>-Wall</code> and <code>-O2</code>:</p>\n\n<pre><code>name:               Test\nversion:            0.1.0.0\nbuild-type:         Simple\ncabal-version:      &gt;=1.8\n\nexecutable Test\n  hs-source-dirs:   src\n  main-is:          Test.hs\n  build-depends:    base &gt;=4.8 &amp;&amp; &lt;4.10\n  ghc-options:      -Wall -O2\n</code></pre>\n\n<p>When I compile the program Test.hs:</p>\n\n<pre><code>data Color = Red | Green | Blue\n\nfoo :: Color -&gt; Int\nfoo Red = 0\nfoo Green = 1\n-- foo Blue is intentionally missing!!\n</code></pre>\n\n<p>I get the error:</p>\n\n<pre><code>Preprocessing executable 'Test' for Test-0.1.0.0...\n[1 of 1] Compiling Main             ( src/Test.hs, .stack-work/dist/x86_64-linux-nopie/Cabal-1.24.2.0/build/Test/Test-tmp/Main.o )\n\n/home/user/Projekte/HaskellTutorials/Test/src/Test.hs:1:1: error:\n    The IO action \u2018main\u2019 is not defined in module \u2018Main\u2019\n\n--  While building package Test-0.1.0.0 using:\n      /home/user/.stack/setup-exe-cache/x86_64-linux-nopie/Cabal-simple_mPHDZzAJ_1.24.2.0_ghc-8.0.2 --build\n      dir=.stack-work/dist/x86_64-linux-nopie/Cabal-1.24.2.0 build exe:Test --ghc-options \" -ddump-hi -ddump-to-file\"\n    Process exited with code: ExitFailure 1\n</code></pre>\n\n<p>The error about the missing main action is not the problem.\nLook at the text at the end of the second last line:</p>\n\n<blockquote>\n  <p>build exe:Test --ghc-options \" -ddump-hi -ddump-to-file\"</p>\n</blockquote>\n\n<p>Why do I not see my GHC options <em>-Wall -O2</em>? (I fear, I did some stupid little mistake ...)</p>\n\n<p>PS:<br>\nstack version is: Version 1.5.1, Git revision 600c1f01435a10d127938709556c1682ecfd694e (4861 commits) x86_64 hpack-0.17.1<br>\nLTS: 8.17</p>\n"}, {"tags": ["haskell", "aeson"], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 2, "last_activity_date": 1508639823, "last_edit_date": 1508639823, "creation_date": 1508639381, "answer_id": 46869940, "question_id": 46869773, "link": "https://stackoverflow.com/questions/46869773/defining-fromjson-on-uri/46869940#46869940", "title": "Defining FromJSON on URI", "body": "<p>Your instance expects a JSON object of shape <code>{ \"value\": \"url\" }</code>, but the <code>toJSON</code> instance you're using obviously produces a plain string, as your interactive output clearly indicates. </p>\n\n<p>For the last expression in your interactive session to work, you need to make <code>To</code> and <code>From</code> instances symmetrical: either make the <code>ToJSON</code> instance produce an object <code>{ \"value\": \"url\" }</code> or make the <code>FromJSON</code> instance expect a plain string.</p>\n\n<p>Also, as an aside, your instance could be expressed in a much shorter way using the <code>.:</code> operator:</p>\n\n<pre><code>instance FromJSON URI where\n    parseJSON = withObject \"URI\" $ \\v -&gt; do\n        mUri &lt;- parseURI . T.unpack &lt;$&gt; v .: \"value\"\n        maybe (fail \"Bad URI\") pure mUri\n</code></pre>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 46869940, "answer_count": 1, "score": 1, "last_activity_date": 1508639823, "creation_date": 1508636986, "question_id": 46869773, "link": "https://stackoverflow.com/questions/46869773/defining-fromjson-on-uri", "title": "Defining FromJSON on URI", "body": "<p>Using <a href=\"https://hackage.haskell.org/package/network-uri-2.6.1.0/docs/Network-URI.html\" rel=\"nofollow noreferrer\">Network-URI</a> and Aeson, I defined the following <code>FROMJson URI</code>. </p>\n\n<p>In short, I'm trying to implement a JSON Decoder requiring: </p>\n\n<p><code>{ \"value\" : X }</code> where <code>X</code> is a JSON String that evaluates to <code>Just</code> for <a href=\"https://hackage.haskell.org/package/network-uri-2.6.1.0/docs/Network-URI.html\" rel=\"nofollow noreferrer\">parseURI</a>(<code>X</code>).</p>\n\n<pre><code>instance FromJSON URI where\n    parseJSON = withObject \"URI\" $ \\v -&gt;\n      case Data.HashMap.Lazy.lookup \"value\" v of\n        Just (String str) -&gt; let unpacked = T.unpack str in\n          case parseURI unpacked of\n            Just uri -&gt; pure uri\n            Nothing  -&gt; fail $ \"String:\" ++ unpacked ++ \"is not a valid URI.\"\n        Just value        -&gt; typeMismatch \"value\" value\n        Nothing           -&gt; fail $ \"JSON object does not have 'value' key.\"\n</code></pre>\n\n<p>However, for a valid <code>URI</code>, my code isn't working:</p>\n\n<pre><code>\u03bb: &gt;parseURI \"http://www.foo.com\"\nJust http://www.foo.com\n\n\u03bb: &gt;toJSON $ URI \"http\" Nothing \"//www.foo.com\" \"\" \"\"\nString \"http//www.foo.com\"\n\n\u03bb: &gt;fromJSON $ toJSON $ URI \"http\" Nothing \"//www.foo.com\" \"\" \"\"\nError \"expected (), encountered String\"\n</code></pre>\n\n<p>How can I fix my <code>FromJSON</code> instance?</p>\n"}, {"tags": ["javascript", "c", "haskell", "emscripten", "ghcjs"], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 524111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a81d5e0931dbf23e07f52084d8f5187?s=128&d=identicon&r=PG", "display_name": "bitonic", "link": "https://stackoverflow.com/users/524111/bitonic"}, "is_accepted": false, "score": 0, "last_activity_date": 1511924489, "last_edit_date": 1511924489, "creation_date": 1511839355, "answer_id": 47523461, "question_id": 46868261, "link": "https://stackoverflow.com/questions/46868261/ccall-import-of-emscripten-export-in-ghcjs/47523461#47523461", "title": "ccall import of emscripten export in GHCJS", "body": "<p>Pointer types can be converted to and from integers: <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Foreign-Ptr.html#t:IntPtr\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/base-4.10.0.0/docs/Foreign-Ptr.html#t:IntPtr</a> . Thus, you ought to be able to convert to / from any format that emscripten requires using those functions.</p>\n"}], "owner": {"reputation": 123, "user_id": 6257921, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vMSb-u_jr9Q/AAAAAAAAAAI/AAAAAAAABLk/0-qCDsnM1MY/photo.jpg?sz=128", "display_name": "Graham Leach-Krouse", "link": "https://stackoverflow.com/users/6257921/graham-leach-krouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1511924489, "creation_date": 1508621177, "question_id": 46868261, "link": "https://stackoverflow.com/questions/46868261/ccall-import-of-emscripten-export-in-ghcjs", "title": "ccall import of emscripten export in GHCJS", "body": "<p>I'm trying to port the haskell library <a href=\"https://hackage.haskell.org/package/minisat\" rel=\"nofollow noreferrer\">minisat</a> to JavaScript using ghcjs, for integration in a larger haskell-ghcjs project.</p>\n\n<p>minisat contains a couple of ffi imports from a c library. I've manged to compile the c library to javascript using emscripten, and to export the functions that minisat requires. So far, so good.</p>\n\n<p>However, there are a couple of imports that look like this: </p>\n\n<p><code>foreign import ccall safe minisat_solve :: Solver -&gt; Int -&gt; Ptr (Lit) -&gt; IO (Bool)</code></p>\n\n<p>which imports a function that looks like this:</p>\n\n<p><code>int  minisat_solve(minisat_solver *s, int len, minisat_Lit *ps)</code></p>\n\n<p>My understanding, from <a href=\"https://kripken.github.io/emscripten-site/docs/porting/connecting_cpp_and_javascript/Interacting-with-code.html#calling-compiled-c-functions-from-javascript-using-ccall-cwrap\" rel=\"nofollow noreferrer\">the documentation</a>, is that when emscripten exports a function that takes or returns a pointer, the pointer becomes a JavaScript number type. </p>\n\n<p>The <a href=\"https://github.com/ghcjs/ghcjs/blob/master/doc/foreign-function-interface.md\" rel=\"nofollow noreferrer\">ghcjs documentation</a> suggests that it should be possible to leave the existing foreign imports in place, by appropriately wrapping a JavaScript function. However, ghcjs represents pointer types as roughly a pair consisting of a JavaScript object and number.</p>\n\n<p>I think the wrapper code should be roughly</p>\n\n<pre><code>function h$minisat_solve(...){\n   ...\n   minisat_solve(...)\n   ...\n}\n\nfunction minisat_solve = Module.cwrap('minisat_solve',...,...)\n</code></pre>\n\n<p>But I'm stumped by the type mismatch.</p>\n\n<p>So, here's the challenge: Explain how to properly wrap an emscripten export for <code>ccall</code> import by <code>ghcjs</code>, using the above wrapper code as an example (or a counterexample, if I've got it completely wrong)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1508626862, "post_id": 46867892, "comment_id": 80685021, "body": "You need a function like <code>forall n . Proxy n -&gt; ((1 &lt;=? n) ~ &#39;True =&gt; x) -&gt; ((1 &lt;=? n) ~ &#39;False =&gt; x) -&gt; x</code> which replaces the value-level pattern match (i.e. <code>.. | userInput &lt;= 0 = 0</code>)."}, {"owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1508634556, "post_id": 46867892, "comment_id": 80686335, "body": "To implement such a function, I still need to be able to inspect <code>n</code> in such a way that the compiler knows whether <code>1 &lt;=? n</code> eqauls <code>&#39;True</code> or <code>&#39;False</code>. So this just seems to move the problem to another place."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 2, "creation_date": 1508665358, "post_id": 46867892, "comment_id": 80692382, "body": "@SamDeMeyer The &quot;typelits-witnesses&quot; provides some extra functions for <code>GHC.TypeLits</code> that help with these kinds of tasks. See for example <a href=\"https://stackoverflow.com/a/34387963/1364288\">stackoverflow.com/a/34387963/1364288</a> and <a href=\"https://stackoverflow.com/a/39812205/1364288\">stackoverflow.com/a/39812205/1364288</a>"}, {"owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1508674079, "post_id": 46867892, "comment_id": 80694708, "body": "@danidiaz Thx, I had already started writing similar code as in <code>typelits-witnesses</code> before I read your answer. It&#39;s nice to see that someone else already implemented it for me :)."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1508858946, "post_id": 46867892, "comment_id": 80776015, "body": "See also <a href=\"https://stackoverflow.com/questions/41492754/could-not-deduce-knownnat-in-two-existentials-with-respect-to-the-singletons-lib/41496362#41496362\" title=\"could not deduce knownnat in two existentials with respect to the singletons lib\">stackoverflow.com/questions/41492754/&hellip;</a>"}, {"owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1508867052, "post_id": 46867892, "comment_id": 80781001, "body": "@gallais, thx, <code>user3237465</code>&#39;s answer in that post is also quite useful since it has no extra dependencies."}], "answers": [{"tags": [], "owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "is_accepted": true, "score": 1, "last_activity_date": 1508867208, "last_edit_date": 1508867208, "creation_date": 1508673746, "answer_id": 46873829, "question_id": 46867892, "link": "https://stackoverflow.com/questions/46867892/how-to-satisfy-constraints-on-existentially-quantified-values/46873829#46873829", "title": "How to satisfy constraints on existentially quantified values?", "body": "<p>Thanks @danidiaz for pointing me in the right direction, the <code>typelist-witnesses</code> documentation provides a <a href=\"http://hackage.haskell.org/package/typelits-witnesses-0.2.3.0/docs/GHC-TypeLits-Compare.html\" rel=\"nofollow noreferrer\">nearly direct answer</a> to my question. Seems like I was using the wrong search terms when googling for a solution.</p>\n\n<p>So here is a self contained compileable solution:</p>\n\n<pre><code>{-# LANGUAGE DataKinds           #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE TypeOperators       #-}\n{-# LANGUAGE TypeFamilies        #-}\n\nimport Data.Proxy                   (Proxy (..))\nimport Data.Type.Equality           ((:~:)(Refl))\nimport GHC.TypeLits\nimport GHC.TypeLits.Compare\nimport Numeric.LinearAlgebra.Static\n\nexistentialCrisis :: Int -&gt; Int -&gt; IO (Double)\nexistentialCrisis seed userInput =\n    case someNatVal (fromIntegral userInput) of\n      Nothing -&gt; print \"someNatVal failed\" &gt;&gt; return 0\n      Just (SomeNat (proxy :: Proxy n)) -&gt;\n        case isLE (Proxy :: Proxy 1) proxy of\n          Nothing -&gt; print \"isLE failed\" &gt;&gt; return 0\n          Just Refl -&gt;\n            let someVector = randomVector seed Gaussian :: R n\n            in do\n              print userInput\n              -- I know that 'n &gt; 0' and so does the compiler\n              return (mean someVector)\n</code></pre>\n\n<p>And it works with input only known at runtime:</p>\n\n<pre><code>\u03bb: :l ExistentialCrisis.hs \n\u03bb: existentialCrisis 41 1\n(0.2596687587224799 :: R 1)\n0.2596687587224799\n*Main\n\u03bb: existentialCrisis 41 0\n\"isLE failed\"\n0.0\n*Main\n\u03bb: existentialCrisis 41 (-1)\n\"someNatVal failed\"\n0.0\n</code></pre>\n\n<p>It seems like <code>typelist-witnesses</code> does a lot <code>unsafeCoerce</code>ing under the hood. But the interface is type-safe so it doesn't really matter that much for practical use cases.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>If this question was of interest to you, might also find this post interesting: <a href=\"https://stackoverflow.com/a/41615278/2496293\">https://stackoverflow.com/a/41615278/2496293</a></p>\n"}], "owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 46873829, "answer_count": 1, "score": 2, "last_activity_date": 1508867208, "creation_date": 1508618693, "question_id": 46867892, "link": "https://stackoverflow.com/questions/46867892/how-to-satisfy-constraints-on-existentially-quantified-values", "title": "How to satisfy constraints on existentially quantified values?", "body": "<p>In an attempt at learning how to work with dependent data types in haskell I encountered the following problem:</p>\n\n<p>Suppose you have a function such as:</p>\n\n<pre><code>mean :: ((1 GHC.TypeLits.&lt;=? n) ~ 'True, GHC.TypeLits.KnownNat n) =&gt; R n -&gt; \u211d\n</code></pre>\n\n<p>defined in the <code>hmatrix</code> library, then how do you use this on a vector that has an existential type? E.g.:</p>\n\n<pre><code>{-# LANGUAGE DataKinds           #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE TypeOperators       #-}\n\nimport Data.Proxy                   (Proxy (..))\nimport GHC.TypeLits\nimport Numeric.LinearAlgebra.Static\n\ngetUserInput =\n  let userInput = 3   -- pretend it's unknown at compile time\n      seed      = 42\n  in existentialCrisis seed userInput\n\nexistentialCrisis seed userInput\n  | userInput &lt;= 0 = 0\n  | otherwise =\n    case someNatVal userInput of\n      Nothing -&gt; undefined -- let's ignore this case for now\n      Just (SomeNat (proxy :: Proxy n)) -&gt;\n        let someVector = randomVector seed Gaussian :: R n\n        in mean someVector -- I know that 'n &gt; 0' but the compiler doesn't\n</code></pre>\n\n<p>This gives the following error:</p>\n\n<pre><code>\u2022 Couldn't match type \u20181 &lt;=? n\u2019 with \u2018'True\u2019\n    arising from a use of \u2018mean\u2019\n</code></pre>\n\n<p>Makes sense indeed, but after some googling and fiddling around, I could not find out how to deal with this. How can I get hold of an <code>n :: Nat</code>, based on user input, such that it satisfies the <code>1 &lt;= n</code> constraint?. I believe it must be possible since the <code>someNatVal</code> function already succeeds in satisfying the <code>KnownNat</code> constraint based on the condition that the input is not negative.</p>\n\n<p>It seems to me that this is a common thing when working with dependent types, and maybe the answer is obvious but I don't see it.</p>\n\n<p>So my question:</p>\n\n<p><em>How, in general, can I bring an existential type in scope satisfying the constraints required for some function?</em></p>\n\n<p>My attempts:</p>\n\n<ul>\n<li><p>To my surprise, even the following modification</p>\n\n<pre><code>    let someVector = randomVector seed Gaussian :: R (n + 1)\n</code></pre>\n\n<p>gave a type error:</p>\n\n<pre><code>\u2022 Couldn't match type \u20181 &lt;=? (n + 1)\u2019 with \u2018'True\u2019\n    arising from a use of \u2018mean\u2019\n</code></pre>\n\n<p>Also, adding an extra instance to <code>&lt;=?</code> to prove this equality does not work as <code>&lt;=?</code> is closed.</p></li>\n<li><p>I tried an approach combining <code>GADTs</code> with typeclasses as in <a href=\"https://stackoverflow.com/a/46495696/2496293\">this answer to a previous question of mine</a> but could not make it work.</p></li>\n</ul>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1508618644, "post_id": 46867859, "comment_id": 80683096, "body": "Because that is the most generic signature. Mind that <code>MkCompose</code> is a constructor. In your second example, the parameter is already filled in."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1508618745, "post_id": 46867859, "comment_id": 80683125, "body": "What exactly is the problem here? <code>MkCompose</code> is a constructor, it&#39;s a function by definition. What exactly isn&#39;t clear about that?"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1508619099, "post_id": 46867859, "comment_id": 80683203, "body": "Aha. I am so stupid. It was not clear why it shows as function <code>f (g x) -&gt; Compose f g x</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1508621736, "post_id": 46867859, "comment_id": 80683890, "body": "What type were you expecting <code>MkCompose</code> to have?"}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 4, "last_activity_date": 1508619087, "creation_date": 1508619087, "answer_id": 46867943, "question_id": 46867859, "link": "https://stackoverflow.com/questions/46867859/type-signature-as-function/46867943#46867943", "title": "Type signature as function", "body": "<p>When you write:</p>\n\n<pre><code>data Compose f g x = MkCompose (f (g x))\n</code></pre>\n\n<p>You are saying that:</p>\n\n<pre><code>MkCompose :: f (g x) -&gt; Compose f g x\n</code></pre>\n\n<p>That is the definition of <code>Compose</code>; this is what a <code>data</code> declaration does.</p>\n\n<p>However, when you give it an argument (since it is a function), like the following, <code>f</code>, <code>g</code>, and <code>x</code> are given specific types:</p>\n\n<pre><code>\u03bb&gt; :t MkCompose [[1]]                    -- f = [], g = [], x = Num n =&gt; n.\nMkCompose 1 :: Num n =&gt; Compose [] [] n  -- As in the definition.\n</code></pre>\n\n<p><code>MkCompose</code> has a function type exactly because it is a function; it takes a value and returns another.</p>\n\n<p>If this isn't clear, here are some other examples:</p>\n\n<ul>\n<li><code>MkCompose (Just [1]) :: Num n =&gt; Compose Maybe [] n</code>, since <code>Just [1] :: Num n =&gt; Maybe [n]</code>. In this case, <code>f = Maybe</code>, <code>g = []</code>, and <code>x = Num n =&gt; n</code>.</li>\n<li><code>MkCompose getLine :: Compose IO [] Char</code>, since <code>getLine :: IO [Char]</code>. In this case, <code>f = IO</code>, <code>g = []</code>, and <code>x = Char</code>.</li>\n<li><code>MkCompose [[]] :: Compose [] [] x</code>, since <code>[[]] :: [[x]]</code>. In this case, <code>f = []</code>, <code>g = []</code>, but <code>x</code> can be anything.</li>\n</ul>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 46867943, "answer_count": 1, "score": 0, "last_activity_date": 1508619087, "creation_date": 1508618459, "question_id": 46867859, "link": "https://stackoverflow.com/questions/46867859/type-signature-as-function", "title": "Type signature as function", "body": "<p>I have following type constructor and data constructor:</p>\n\n<pre><code>data Compose f g x = MkCompose (f (g x))\n</code></pre>\n\n<p>Get type signature in the prelude about Compose, it shows: </p>\n\n<pre><code>MkCompose :: f (g x) -&gt; Compose f g x\n</code></pre>\n\n<p>Why it shows like a function?   </p>\n\n<p>When I apply the type as following:</p>\n\n<pre><code>*ComposeExercise&gt; :t MkCompose [[42]]\nMkCompose [[42]] :: Num x =&gt; Compose [] [] x\n</code></pre>\n\n<p>Then for me, it is clear.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 4, "creation_date": 1508618138, "post_id": 46867799, "comment_id": 80682945, "body": "<a href=\"https://www.well-typed.com/blog/2017/09/visualize-cbn/\" rel=\"nofollow noreferrer\">well-typed.com/blog/2017/09/visualize-cbn</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1508621847, "post_id": 46867799, "comment_id": 80683917, "body": "<a href=\"http://chrisuehlinger.com/LambdaBubblePop/\" rel=\"nofollow noreferrer\">chrisuehlinger.com/LambdaBubblePop</a>"}, {"owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "edited": false, "score": 0, "creation_date": 1508688064, "post_id": 46867799, "comment_id": 80699239, "body": "Thanks. Those are both very nice."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1508758145, "post_id": 46867799, "comment_id": 80723443, "body": "Any reason why those are comments rather than answers?"}, {"owner": {"reputation": 522, "user_id": 1611102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b464a54d2edba7c4979e018d0b81cd1a?s=128&d=identicon&r=PG", "display_name": "cpchung", "link": "https://stackoverflow.com/users/1611102/cpchung"}, "edited": false, "score": 0, "creation_date": 1586483514, "post_id": 46867799, "comment_id": 108151053, "body": "This is a wonderful tool! can it support complex expression like this one? <a href=\"https://stackoverflow.com/questions/61123307/how-to-print-intermediate-result-in-functor-and-applicative-in-haskell\" title=\"how to print intermediate result in functor and applicative in haskell\">stackoverflow.com/questions/61123307/&hellip;</a>"}], "owner": {"reputation": 2366, "user_id": 1112406, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/abd557d2593a8fa81511a817b83c8f4b?s=128&d=identicon&r=PG", "display_name": "RussAbbott", "link": "https://stackoverflow.com/users/1112406/russabbott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 274, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1508618015, "creation_date": 1508618015, "question_id": 46867799, "link": "https://stackoverflow.com/questions/46867799/generating-a-step-by-step-reduction-of-a-haskell-expression", "title": "Generating a step-by-step reduction of a Haskell expression", "body": "<p>Is there a system that will generate a step-by-step reduction of a Haskell expression? The intent is to provide a tutorial example of lazy evaluation. It would be nice if it were written in Haskell, but that isn't a requirement. </p>\n\n<p>For example, assume we have:</p>\n\n<pre><code>myCycle xs = xs `myAppend` myCycle xs\n\n[] `myAppend` ys = ys\n(x:xs) `myAppend` ys = x: (xs `myAppend` ys)\n\nmyTake 0 _  = []\nmyTake _ [] = []\nmyTake n (x:xs) = x: (myTake (n-1) xs)\n</code></pre>\n\n<p>The evaluation of <code>&gt; myTake 3 $ myCycle [1, 2]</code> should show a sequence like this. (Please correct me if I made any mistakes in this.)</p>\n\n<pre><code>&gt;  myTake 3 $ myCycle [1, 2]\n=&gt; myTake 3 ([1, 2] `myAppend` myCycle [1, 2])\n=&gt; myTake 3 (1:([2] `myAppend` myCycle [1, 2]))\n=&gt; 1: myTake 2 ([2] `myAppend` myCycle [1, 2]) -- Not showing 3-1 =&gt; 2\n=&gt; 1: myTake 2 (2:([] `myAppend` myCycle [1, 2]))\n=&gt; 1:2: myTake 1 ([] `myAppend` myCycle [1, 2])\n=&gt; 1:2: myTake 1 (myCycle [1, 2])\n=&gt; 1:2: myTake 1 ([1, 2] `myAppend` myCycle [1, 2])\n=&gt; 1:2: myTake 1 (1:([2] `myAppend` myCycle [1, 2]))\n=&gt; 1:2:1: myTake 0 ([2] `myAppend` myCycle [1, 2])\n=&gt; 1:2:1:[] = [1, 2, 1]\n</code></pre>\n\n<p>The point of all this is to illustrate how lazy evaluation makes infinite lists possible. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1508611349, "post_id": 46866710, "comment_id": 80680903, "body": "In <code>printList (Node v n)</code>, <code>v</code> and <code>n</code> are arguments, but in <code>x == (Node v n)</code> they are two undefined variables."}, {"owner": {"reputation": 343, "user_id": 846907, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7Vufg.jpg?s=128&g=1", "display_name": "Safwan Ahmad", "link": "https://stackoverflow.com/users/846907/safwan-ahmad"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1508611614, "post_id": 46866710, "comment_id": 80680983, "body": "@ForceBru So is there a way to distinguish which Data constructor x is using?"}], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 846907, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7Vufg.jpg?s=128&g=1", "display_name": "Safwan Ahmad", "link": "https://stackoverflow.com/users/846907/safwan-ahmad"}, "edited": false, "score": 0, "creation_date": 1508612038, "post_id": 46866775, "comment_id": 80681125, "body": "But a piece of code that I wrote earlier has a function parameter <code>x</code> being compared against data constructors line <code>Meter</code>. Here&#39;s the code:  <code>data MetricUnit = Meter | Litre | Kilogram                  deriving (Show, Eq)</code>                                                                                      <code>returnMetricSymbol x | x == Meter = &quot;m&quot;                    | x == Litre = &quot;L&quot;                    | x == Kilogram = &quot;kg&quot;</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 343, "user_id": 846907, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7Vufg.jpg?s=128&g=1", "display_name": "Safwan Ahmad", "link": "https://stackoverflow.com/users/846907/safwan-ahmad"}, "edited": false, "score": 1, "creation_date": 1508612388, "post_id": 46866775, "comment_id": 80681263, "body": "@SafwanAhmad: that&#39;s because (1) you added <code>derving Eq</code>, and (2) here you only check for equality, you do not need to <i>unpack</i> the constructor, there are no parameters in your code that you are interested in."}, {"owner": {"reputation": 343, "user_id": 846907, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7Vufg.jpg?s=128&g=1", "display_name": "Safwan Ahmad", "link": "https://stackoverflow.com/users/846907/safwan-ahmad"}, "edited": false, "score": 0, "creation_date": 1508612876, "post_id": 46866775, "comment_id": 80681436, "body": "Ok so my understanding is that using a Data constructor inside the guard statement is essentially creating new variables whereas if I use the same Data constructor as a function parameter, it is pattern matched. This means my code in the comment above is working by sheer chance because <code>Meter</code> is creating a new variable that  gets compared to <code>x</code> and the comparison is possible because I have derived <code>Eq</code>. Right?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 343, "user_id": 846907, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7Vufg.jpg?s=128&g=1", "display_name": "Safwan Ahmad", "link": "https://stackoverflow.com/users/846907/safwan-ahmad"}, "edited": false, "score": 0, "creation_date": 1508613125, "post_id": 46866775, "comment_id": 80681519, "body": "More or less. By <code>deriving Eq</code>, you have defined implicitly a function <code>(==) :: MetricUnit -&gt; MetricUnit -&gt; Bool</code>. But for Haskell <code>==</code> is <i>just another function</i>. So for Haskell the <code>x == Meter</code> is no more special than <code>otherFunction x Meter</code>. It simply evaluates this and that returns <code>True</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1508611511, "creation_date": 1508611511, "answer_id": 46866775, "question_id": 46866710, "link": "https://stackoverflow.com/questions/46866710/variable-not-in-scope-error-in-function-using-guards/46866775#46866775", "title": "Variable not in scope error in function using guards", "body": "<p>You do not do <em>pattern matching</em> by using an equality check: it is possible that two different patterns are considered equal.</p>\n\n<p>So what you can do is <em>define a pattern</em> in the head of one of the clauses of your function. For instance:</p>\n\n<pre><code>printList :: List -&gt; String\nprintList <b>(Node v n)</b> = show v ++ \" \" ++ printList n\nprintList _ = show '_'</code></pre>\n\n<p>So now Haskell will, for a given <code>List</code> check if it matches with the <code>Node v n</code> pattern, and if so unpack the element and assign the head to <code>v</code> and the tail to <code>n</code>.</p>\n\n<p>We can however still improve the code. Usually you better do not use wildcard patterns, but use all possible patterns. Since if you later want to alter the definition of <code>List</code>, the compiler can give you a warning that you forgot a pattern:</p>\n\n<pre><code>printList :: List -&gt; String\nprintList (Node v n) = show v ++ \" \" ++ printList n\nprintList <b>Empty</b> = show '_'</code></pre>\n\n<p>Another thing we can improve is using <code>\"_\"</code> over <code>show '_'</code>. Since <strong><code>show '_'</code> will add quotes to the content</strong>. For instance:</p>\n\n<pre><code>printList :: List -&gt; String\nprintList (Node v n) = show v ++ \" \" ++ printList n\nprintList Empty = <b>\"_\"</b></code></pre>\n\n<p>Finally we can also use a \"cons\" construction over appending with a singleton list:</p>\n\n<pre><code>printList :: List -&gt; String\nprintList (Node v n) = show v ++ <b>' ' :</b> printList n\nprintList Empty = <b>\"_\"</b></code></pre>\n"}], "owner": {"reputation": 343, "user_id": 846907, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7Vufg.jpg?s=128&g=1", "display_name": "Safwan Ahmad", "link": "https://stackoverflow.com/users/846907/safwan-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 1, "accepted_answer_id": 46866775, "answer_count": 1, "score": 1, "last_activity_date": 1508612327, "creation_date": 1508611096, "last_edit_date": 1508612327, "question_id": 46866710, "link": "https://stackoverflow.com/questions/46866710/variable-not-in-scope-error-in-function-using-guards", "title": "Variable not in scope error in function using guards", "body": "<p>I am trying to print a linked list in Haskell using the following code:</p>\n\n<pre><code>data List = Node {value:: Double, next:: List}\n          |   Empty\n\nprintList :: List -&gt; String\nprintList x | x == (Node v n) = show v ++ \" \" ++ printList n\n            | otherwise = show '_'\n</code></pre>\n\n<p>And getting the compilation error:</p>\n\n<pre><code>:load scratch.hs\n[1 of 1] Compiling Main             ( scratch.hs, interpreted )\n\nscratch.hs:5:26: error: Variable not in scope: v :: Double\n\nscratch.hs:5:28: error: Variable not in scope: n :: List\n\nscratch.hs:5:38: error: Variable not in scope: v\n\nscratch.hs:5:53: error: Variable not in scope: n :: List\nFailed, modules loaded: none.\n</code></pre>\n\n<p>While I'm able to do the same using pattern matching without guards.</p>\n\n<pre><code>printList (Node v n) = show v ++ \" \" ++ printList n\nprintList Empty = \"\"\n</code></pre>\n\n<p>What's wrong with the first code?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 23130, "user_id": 8586227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BRnwg.png?s=128&g=1", "display_name": "Davis Herring", "link": "https://stackoverflow.com/users/8586227/davis-herring"}, "edited": false, "score": 4, "creation_date": 1508605891, "post_id": 46865824, "comment_id": 80679138, "body": "How can you convert an arbitrary <code>Ord a</code> to <code>Int</code>?  Are you looking for indices instead of elements?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1508606248, "post_id": 46865824, "comment_id": 80679255, "body": "What would <code>pMaiore [(&quot;Hello&quot;,True)]</code> return? You probably are using a too general type if you need an <code>Int</code> back."}, {"owner": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "edited": false, "score": 1, "creation_date": 1508606533, "post_id": 46865824, "comment_id": 80679356, "body": "the objective of the function is to form a list of numbers to say the number of the position of the biggest number , i dont get what u mean with indices , btw i need to keep with the type has is a part of an exercise"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1508607262, "post_id": 46865824, "comment_id": 80679595, "body": "By &quot;indices&quot; Davis is meaning what you called &quot;the number of the position&quot;. The point is, you actually do not want to convert <code>x</code> to anything -- you want the position of <code>x</code> to be returned. For that, you have to remember the original position of <code>x</code>. A common trick here is to pre-process the list so that instead of <code>[x1,x2,x3...]</code> we work on <code>[(x1,1),(x2,2),(x3,3),...]</code>. After this preprocessing, each element is paired with the original position, so the task is easier."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1508607467, "post_id": 46865824, "comment_id": 80679668, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/14550458/find-max-element-and-index-of-a-list-in-haskell\">Find max element and index of a list in Haskell</a>"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 1, "creation_date": 1508609247, "post_id": 46865824, "comment_id": 80680253, "body": "Sorry, but that can&#39;t be done. All you know about &quot;a&quot; is that it is an instance of &quot;Ord&quot;. You need it to be an instance of Num as well if you want to convert it to an integer."}], "answers": [{"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": true, "score": 1, "last_activity_date": 1508609592, "creation_date": 1508609592, "answer_id": 46866465, "question_id": 46865824, "link": "https://stackoverflow.com/questions/46865824/convert-element-of-list-to-int-in-haskell/46866465#46866465", "title": "convert element of list to int in haskell?", "body": "<p>How about this?</p>\n\n<pre><code>pMaiore :: (Ord a, Integral a) =&gt; [a] -&gt; Int\n\npMaiore [x]= fromIntegral x              --give x but converted to Int\npMaiore (x:xs:xss)= if x&gt;=xs then pMaiore(x:xss)\n                    else  pMaiore(x:xss)          --when x&lt;xs\n</code></pre>\n\n<p>If you want to convert an <code>a</code> into an <code>Int</code> you have to have some connection between them. One way is to use a typeclass. If you know that <code>a</code> is going to be a floating point then you can use <code>RealFrac</code> instead, and then the <code>round</code> function will work.</p>\n"}], "owner": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 46866465, "answer_count": 1, "score": 0, "last_activity_date": 1508673243, "creation_date": 1508605715, "last_edit_date": 1508673243, "question_id": 46865824, "link": "https://stackoverflow.com/questions/46865824/convert-element-of-list-to-int-in-haskell", "title": "convert element of list to int in haskell?", "body": "<p>I am trying to make a function, and I need to specify what happens if the list has only 1 element. I want the function to return the element, but I don't know how to convert the element to an <code>Int</code>. Any help? I've tried <code>round</code>, <code>frominteger</code>, <code>realtofrac</code>, but nothing worked.</p>\n\n<pre><code>pMaiore :: Ord a =&gt; [a] -&gt; Int\n\npMaiore [x]=                                      --give x but converted to Int\npMaiore (x:xs:xss)= if x&gt;=xs then pMaiore(x:xss)\n                    else  pMaiore(x:xss)          --when x&lt;xs\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 1481, "user_id": 2885946, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8CNNA.png?s=128&g=1", "display_name": "ryo", "link": "https://stackoverflow.com/users/2885946/ryo"}, "edited": false, "score": 0, "creation_date": 1508638091, "post_id": 46864795, "comment_id": 80686893, "body": "Thank you very much for your very useful information!  Currently I&#39;m using LTS Haskell 9.1 (ghc-8.0.2)."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 8, "last_activity_date": 1508599251, "creation_date": 1508599251, "answer_id": 46864795, "question_id": 46864367, "link": "https://stackoverflow.com/questions/46864367/how-to-change-missing-fields-warning-to-an-error-in-ghc/46864795#46864795", "title": "How to change missing-fields warning to an error in GHC", "body": "<p>This only works in GHC 8.2.1 and above. If you're using <code>stack</code>, the current LTS resolver is only on 8.0.2. Either update your GHC (in <code>stack</code>, that would be setting <code>compiler: ghc-8.2.1</code>), or just make <em>all</em> warnings into errors with <code>-Werror -Wmissing-fields</code>, and sit tight until the feature is more widely available. (If you trigger another warning, say <code>missing-methods</code>, it <em>stays</em> a warning in the former, but becomes an error in the latter.)</p>\n"}, {"tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 0, "last_activity_date": 1508604733, "creation_date": 1508604733, "answer_id": 46865666, "question_id": 46864367, "link": "https://stackoverflow.com/questions/46864367/how-to-change-missing-fields-warning-to-an-error-in-ghc/46865666#46865666", "title": "How to change missing-fields warning to an error in GHC", "body": "<p>Just make fields strict. This is a good practice in general because it helps to avoid space leaks and can lead to other optimizations. In case you don't really rely on laziness, you can convert fields to strict.</p>\n"}], "owner": {"reputation": 1481, "user_id": 2885946, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8CNNA.png?s=128&g=1", "display_name": "ryo", "link": "https://stackoverflow.com/users/2885946/ryo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 3, "accepted_answer_id": 46864795, "answer_count": 2, "score": 5, "last_activity_date": 1508604733, "creation_date": 1508596446, "question_id": 46864367, "link": "https://stackoverflow.com/questions/46864367/how-to-change-missing-fields-warning-to-an-error-in-ghc", "title": "How to change missing-fields warning to an error in GHC", "body": "<p>I'm using GHC on haskell-stack project. I'd like to lift missing-fields warning up to a compile error.</p>\n\n<p>I tried to do the following, but it doesn't work.</p>\n\n<pre><code>{-# OPTIONS_GHC -Werror=missing-fields #-} -- DOESN'T WORK\n</code></pre>\n\n<p>Could you tell how to lift missing fields warning up to a compile error?</p>\n"}, {"tags": ["arrays", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 3, "last_activity_date": 1508597086, "creation_date": 1508597086, "answer_id": 46864463, "question_id": 46864208, "link": "https://stackoverflow.com/questions/46864208/print-each-element-of-a-carray/46864463#46864463", "title": "Print each element of a CArray", "body": "<pre><code>mapM_ print (IArr.elems arr)\n</code></pre>\n\n<p>This looks like the easiest solution.</p>\n"}], "owner": {"reputation": 827, "user_id": 1276388, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4ae985df9e533570f5ac2ea9bfc25dfd?s=128&d=identicon&r=PG", "display_name": "\u0397\u03bb\u03b5\u03ba\u03c4\u03c1\u03bf\u03bb\u03cc\u03b3\u03bf\u03c2 \u039c\u03b7\u03c7\u03b1\u03bd\u03b9\u03ba\u03cc\u03c2", "link": "https://stackoverflow.com/users/1276388/%ce%97%ce%bb%ce%b5%ce%ba%cf%84%cf%81%ce%bf%ce%bb%cf%8c%ce%b3%ce%bf%cf%82-%ce%9c%ce%b7%cf%87%ce%b1%ce%bd%ce%b9%ce%ba%cf%8c%cf%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 46864463, "answer_count": 1, "score": 1, "last_activity_date": 1508597086, "creation_date": 1508595527, "last_edit_date": 1508596750, "question_id": 46864208, "link": "https://stackoverflow.com/questions/46864208/print-each-element-of-a-carray", "title": "Print each element of a CArray", "body": "<p>I have this <a href=\"https://hackage.haskell.org/package/carray-0.1.6.8/docs/Data-Array-CArray.html#g:5\" rel=\"nofollow noreferrer\">CArray</a> </p>\n\n<pre><code>import qualified Data.Array.CArray as CArr\nimport qualified Data.Array.IArray as IArr\n\narr :: CArr.CArray Int Double\narr = IArr.array (1, 4)  $ zip [1..4] [1..4]\n</code></pre>\n\n<p>How do I print each element of CArray? Something like this pseudocode if <code>arr</code> is a list:</p>\n\n<pre><code>mapM_ print arr\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1508605612, "post_id": 46863557, "comment_id": 80679018, "body": "It seems you&#39;ve not yet covered some fundamental topics in Haskell, particularly monads. I&#39;d recommend avoiding <code>IO</code> until you&#39;ve at least read the <a href=\"http://learnyouahaskell.com/input-and-output\" rel=\"nofollow noreferrer\">learn you a Haskell chapter on it</a>, or even the <a href=\"http://learnyouahaskell.com/a-fistful-of-monads\" rel=\"nofollow noreferrer\">chapter on monads</a>."}], "answers": [{"comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1508600110, "post_id": 46863795, "comment_id": 80677271, "body": "As for b) you could simply write a function with type <code>String -&gt; Msg -&gt; Msg</code> outside of the <code>Monoid</code> &quot;interface&quot;."}, {"owner": {"reputation": 385, "user_id": 2859991, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3c547fb480ac3d021b40efcab7d9f7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Itzko", "link": "https://stackoverflow.com/users/2859991/dvir-itzko"}, "edited": false, "score": 0, "creation_date": 1508669102, "post_id": 46863795, "comment_id": 80693407, "body": "Thanks. Your commnet really helped!. I have just one question: you said I can write : <code>getCurrentTime &gt;&gt;= \\theTime -&gt; pure (MJust theTime &quot;foo&quot;)</code> I want to maybe create my own monad so I can use the &gt;&gt;= in order to concatinate msgs together (I think it will be better than using the monoid and <code>mappend</code>. Do you think I can do that? and if I can, what do I need to succeed?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 385, "user_id": 2859991, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3c547fb480ac3d021b40efcab7d9f7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Itzko", "link": "https://stackoverflow.com/users/2859991/dvir-itzko"}, "edited": false, "score": 0, "creation_date": 1508680320, "post_id": 46863795, "comment_id": 80696554, "body": "@DvirItzko Your <code>Msg</code> type doesn&#39;t fit <code>Monoid</code> because times are difficult to &quot;smash togeter&quot;. Perhaps you simply could use a list <code>[Msg]</code>? Lists are automatically monoids.  There already is a type called <code>Writer</code> that let&#39;s you accumulate a monoidal &quot;log&quot; as a side effect of doing other things <a href=\"http://hackage.haskell.org/package/transformers-0.5.5.0/docs/Control-Monad-Trans-Writer-Strict.html#t:Writer\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/transformers-0.5.5.0/docs/&hellip;</a> If you want to perform IO stuff as well you&#39;ll need the &quot;transformer&quot; variant: <a href=\"http://hackage.haskell.org/package/transformers-0.5.5.0/docs/Control-Monad-Trans-Writer-Strict.html#t:WriterT\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/transformers-0.5.5.0/docs/&hellip;</a>"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 385, "user_id": 2859991, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3c547fb480ac3d021b40efcab7d9f7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Itzko", "link": "https://stackoverflow.com/users/2859991/dvir-itzko"}, "edited": false, "score": 0, "creation_date": 1508680355, "post_id": 46863795, "comment_id": 80696566, "body": "@DvirItzko See also <a href=\"https://en.wikibooks.org/wiki/Haskell/Monad_transformers\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Haskell/Monad_transformers</a>  and <a href=\"http://adit.io/posts/2013-06-10-three-useful-monads.html#the-writer-monad\" rel=\"nofollow noreferrer\">adit.io/posts/&hellip;</a>"}, {"owner": {"reputation": 385, "user_id": 2859991, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3c547fb480ac3d021b40efcab7d9f7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Itzko", "link": "https://stackoverflow.com/users/2859991/dvir-itzko"}, "edited": false, "score": 0, "creation_date": 1508785915, "post_id": 46863795, "comment_id": 80740726, "body": "@danidaiz I&#39;m having trouble with your answer. Now that I get IO Msg instead of Msg object, I&#39;m not sure what to do with it. For example, I want to use putStrLn on it.  Before I used bind,  I just implemented the Show Msg and the I called <code>putStrLn show msg</code> But now it doesn&#39;t work because it returns IO Msg and not Msg."}, {"owner": {"reputation": 385, "user_id": 2859991, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3c547fb480ac3d021b40efcab7d9f7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Itzko", "link": "https://stackoverflow.com/users/2859991/dvir-itzko"}, "edited": false, "score": 0, "creation_date": 1508786449, "post_id": 46863795, "comment_id": 80741010, "body": "I don&#39;t have a problem with &quot;smash together&quot; time because I can do something like this: <code>instance Monoid (Msg a) where     mempty  = MNothing     (MJust t s) </code>mappend` (MJust t&#39; s&#39;) = MJust (minimum (t,t&#39;))  (s++s&#39;)` Meaning I decided to take to minumum of times and just append the string. The problem is that it doesn&#39;t work and I&#39;m trying to understand why"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 385, "user_id": 2859991, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3c547fb480ac3d021b40efcab7d9f7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Itzko", "link": "https://stackoverflow.com/users/2859991/dvir-itzko"}, "edited": false, "score": 0, "creation_date": 1508791304, "post_id": 46863795, "comment_id": 80743484, "body": "@DvirItzko <code>putStrLn</code> has type <code>String -&gt; IO ()</code>. You can use <code>(&gt;&gt;=)</code> to combine it with your <code>IO Msg</code>, and get a value of type <code>IO ()</code> in return, that, when executed, will construct a <code>Msg</code> and then print it. Remember that <code>main</code> is a value of type <code>IO ()</code> in Haskell."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 4, "last_activity_date": 1508605721, "last_edit_date": 1508605721, "creation_date": 1508592916, "answer_id": 46863795, "question_id": 46863557, "link": "https://stackoverflow.com/questions/46863557/writing-my-own-log-data-type-haskell/46863795#46863795", "title": "writing my own log data type haskell", "body": "<blockquote>\n  <p>With the Msg type, I'm having truble creating a MJust variable, the\n  reason is that calling getCurrentTime returns IO UTCTime , and I want\n  to have UTCTime . How can I solve this?</p>\n</blockquote>\n\n<p>There exist a number of functions for <code>IO</code> that help solve these \"mismatches\"\n (they are more general and work for other types as well, but that doesn't concern us now.)</p>\n\n<p>The important idea is that you don't extract values out of <code>IO</code>. Instead of that, you \"lift\" functions to work <em>inside</em> <code>IO</code>!</p>\n\n<p>For example, the <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:fmap\" rel=\"nofollow noreferrer\"><code>fmap</code></a> function (also called <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Applicative.html#v:liftA\" rel=\"nofollow noreferrer\"><code>liftA</code></a>) transforms a function so that it works inside <code>IO</code>:</p>\n\n<blockquote>\n<pre><code>fmap :: (a -&gt; b) -&gt; IO a -&gt; IO b\n</code></pre>\n</blockquote>\n\n<p><a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Applicative.html#v:liftA2\" rel=\"nofollow noreferrer\"><code>liftA2</code></a> let's you apply a two-argument function to arguments that live inside <code>IO</code>:</p>\n\n<blockquote>\n<pre><code>liftA2 :: (a -&gt; b -&gt; c) -&gt; IO a -&gt; IO b -&gt; IO c\n</code></pre>\n</blockquote>\n\n<p><a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:return\" rel=\"nofollow noreferrer\"><code>return</code></a> (also called <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:pure\" rel=\"nofollow noreferrer\"><code>pure</code></a>) lets you put any value inside <code>IO</code>:</p>\n\n<blockquote>\n<pre><code>return :: a -&gt; IO a\n</code></pre>\n</blockquote>\n\n<p>In your case, you could create a value of type <code>IO Msg</code> like this</p>\n\n<blockquote>\n<pre><code>liftA2 MJust getCurrentTime (pure \"somestring\")\n</code></pre>\n</blockquote>\n\n<p>Remember, you don't get the <code>UTCTime</code> out of <code>IO</code>. Instead, you bring everything you need inside <code>IO</code>.</p>\n\n<p>There also exists the more flexible function/operator <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Monad.html#v:-62--62--61-\" rel=\"nofollow noreferrer\"><code>(&gt;&gt;=)</code></a> (called \"bind\") that lets you build composite <code>IO</code> operations in which the second operation depends on a value returned by the first one:</p>\n\n<blockquote>\n<pre><code>(&gt;&gt;=) :: IO a -&gt; (a -&gt; IO b) -&gt; IO b\n</code></pre>\n</blockquote>\n\n<p>Notice that we can decide what <code>IO b</code> to perform based on the result of the <code>IO a</code>.</p>\n\n<p>A trivial example:</p>\n\n<pre><code>getLine &gt;&gt;= \\msg -&gt; if msg == \"foo\" then putStr \"yay\" else putStr \"nay\"\n</code></pre>\n\n<p>And again the <code>IO Msg</code>:</p>\n\n<pre><code>getCurrentTime &gt;&gt;= \\theTime -&gt; pure (MJust theTime \"foo\")\n</code></pre>\n\n<p>Using <code>(&gt;&gt;=)</code> we can construct sequences of operations that are quite similar to blocks of statements in an imperative language. But writing all those <code>(&gt;&gt;=)</code> can get unwidely, so there is a bit of syntactic sugar called <a href=\"https://en.wikibooks.org/wiki/Haskell/do_notation\" rel=\"nofollow noreferrer\">do-notation</a> that makes things easier.</p>\n\n<p>The <code>IO Msg</code> in do-notation:</p>\n\n<pre><code>do theTime &lt;- getCurrentTime \n   pure (MJust theTime \"foo\")\n</code></pre>\n\n<p>Here the <code>&lt;-</code> is not an actual operator like <code>(&gt;&gt;=)</code> but part of the syntactic sugar.</p>\n"}, {"comments": [{"owner": {"reputation": 385, "user_id": 2859991, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3c547fb480ac3d021b40efcab7d9f7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Itzko", "link": "https://stackoverflow.com/users/2859991/dvir-itzko"}, "edited": false, "score": 0, "creation_date": 1508670018, "post_id": 46868126, "comment_id": 80693642, "body": "I have a problem . Now I can&#39;t use Show to see the message.  before I had  <code>instance Show (Msg a) where     show (MNothing) = &quot;&quot;     show (MJust t s) = show t ++ s</code> But now it doesn&#39;t work, I get: `    Couldn&#39;t match expected type \u2018[Char]\u2019 with actual type \u2018a\u2019       \u2018a\u2019 is a rigid type variable bound by           the instance declaration at Server.hs:41:10     Relevant bindings include       s :: a (bound at Server.hs:43:19)       show :: Msg a -&gt; String (bound at Server.hs:42:5)     In the second argument of \u2018(++)\u2019, namely \u2018s\u2019     In the expression: show t ++ s`"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 385, "user_id": 2859991, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3c547fb480ac3d021b40efcab7d9f7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Itzko", "link": "https://stackoverflow.com/users/2859991/dvir-itzko"}, "edited": false, "score": 0, "creation_date": 1508702008, "post_id": 46868126, "comment_id": 80704080, "body": "I wouldn&#39;t use <code>show</code> for this, which generally outputs valid Haskell code -- just use <code>deriving (Show)</code> on the data decl.  Then for your custom render define <code>renderMsg :: Msg String -&gt; String</code>."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 1, "last_activity_date": 1508620304, "creation_date": 1508620304, "answer_id": 46868126, "question_id": 46863557, "link": "https://stackoverflow.com/questions/46863557/writing-my-own-log-data-type-haskell/46868126#46868126", "title": "writing my own log data type haskell", "body": "<p>As for (2), the way I would solve this is to make <code>Msg</code> a <code>Functor</code>:</p>\n\n<pre><code>data Msg a = MNothing | MJust UTCTime a\n\ninstance Functor Msg where\n    fmap f MNothing = MNothing\n    fmap f (MJust t x) = MJust t (f x)\n</code></pre>\n\n<p>Then to concat with a string you can use <code>fmap</code>:</p>\n\n<pre><code>msg' = fmap (++ \" in bed\") msg\n</code></pre>\n"}], "owner": {"reputation": 385, "user_id": 2859991, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3c547fb480ac3d021b40efcab7d9f7f8?s=128&d=identicon&r=PG&f=1", "display_name": "Dvir Itzko", "link": "https://stackoverflow.com/users/2859991/dvir-itzko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1508620304, "creation_date": 1508591334, "last_edit_date": 1508605450, "question_id": 46863557, "link": "https://stackoverflow.com/questions/46863557/writing-my-own-log-data-type-haskell", "title": "writing my own log data type haskell", "body": "<p>I'm pretty new to Haskell and I'm writing a program in which I want to have a log message with the creation time and having the possibilty to appand text to the current msg so that only the message will change but the time will stay the time of creation.\nI tried to do the following:</p>\n\n<pre><code> data Msg = MNothing | MJust UTCTime String \n</code></pre>\n\n<p><code>M</code> is for Message, and the reason for the <code>MNothing</code> is so there will be a possibility for an empty message.</p>\n\n<p>I also wrote: </p>\n\n<pre><code>instance Monoid Msg where\n    mempty = MNothing\n    (MJust t s) `mappend` (MJust t' s') = MJust (minimum (t,t'))  (s++s')\n</code></pre>\n\n<p>This way I can use <code>mappend</code> for two messages and it will take the earliest time from the messages.</p>\n\n<p>My problems are:</p>\n\n<ol>\n<li><p>With the Msg type, I'm having trouble creating an <code>MJust</code> variable, the reason is that calling <code>getCurrentTime</code> returns <code>IO UTCTime</code> , and I want to have <code>UTCTime</code>. How can I solve this?</p></li>\n<li><p>I can only <code>concat</code> two Msgs, but it is kind of pointless to do so, is it possible to be able to concat <code>Msg</code> with normal <code>String</code> (or <code>[Char]</code>)?</p></li>\n</ol>\n\n<p>I'm new to Haskell so maybe I'm missing something? Thanks.</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 71, "user_id": 3679331, "user_type": "registered", "profile_image": "https://graph.facebook.com/521210191/picture?type=large", "display_name": "ricardos", "link": "https://stackoverflow.com/users/3679331/ricardos"}, "edited": false, "score": 0, "creation_date": 1508582318, "post_id": 46862376, "comment_id": 80672132, "body": "Please do not recommend the Yesod book, the solution there is very ad-hoc for passwords or values that disappear: eResult is an unused value."}, {"owner": {"reputation": 71, "user_id": 3679331, "user_type": "registered", "profile_image": "https://graph.facebook.com/521210191/picture?type=large", "display_name": "ricardos", "link": "https://stackoverflow.com/users/3679331/ricardos"}, "edited": false, "score": 0, "creation_date": 1508582840, "post_id": 46862376, "comment_id": 80672261, "body": "This problem seems to affect the standard multi* checkbox* functions, one error blank the whole field."}], "owner": {"reputation": 71, "user_id": 3679331, "user_type": "registered", "profile_image": "https://graph.facebook.com/521210191/picture?type=large", "display_name": "ricardos", "link": "https://stackoverflow.com/users/3679331/ricardos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508582185, "creation_date": 1508582185, "question_id": 46862376, "link": "https://stackoverflow.com/questions/46862376/how-can-i-create-dynamic-sized-fields-in-yesod", "title": "How can I create dynamic sized Fields in Yesod?", "body": "<p>I found a way to compose several <code>intField</code> (for example) into something that looks like <code>Field m [Int]</code>\nThe function signature is:</p>\n\n<pre><code>multiplyField :: Monad m =&gt; (RenderMessage (HandlerSite m) FormMessage, Show a)\n              =&gt; Field m a -&gt; Field m [a]\n</code></pre>\n\n<p>Of course, this can work fine (except for those multiselect stuff)</p>\n\n<p>The parser works in acceptable way.\nBut the fieldView is horrible:</p>\n\n<pre><code>fieldView = \\theId name attrs vals isReq -&gt; do\n                    let views = map (\\val -&gt; view1 theId name attrs val isReq) $ sequenceA vals\n                    [whamlet|$forall view &lt;- views\n                               ^{view}\n                            |]\n</code></pre>\n\n<p>The problem is that the whole error for several fields in collapsed into only one val (<code>Left Text [a]</code>) </p>\n\n<p>This solution works fine if the user always introduce the right data, but if there is an error, all the fields disappear but one.</p>\n\n<p>I don't get why the parser supports n values <code>[Text]</code> but the view no.</p>\n\n<p>How can I get something like <code>[Left Text a]</code> instead of that <code>Left Text [a]</code>?</p>\n"}, {"tags": ["haskell", "package-managers", "haskell-stack", "nix"], "comments": [{"owner": {"reputation": 5983, "user_id": 1562296, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f643de61d412c728930a1365befd9930?s=128&d=identicon&r=PG", "display_name": "MarcDefiant", "link": "https://stackoverflow.com/users/1562296/marcdefiant"}, "edited": false, "score": 1, "creation_date": 1509114113, "post_id": 46861022, "comment_id": 80902013, "body": "The Nix Manual has a section called &quot;How to build a Haskell project using Stack&quot; <a href=\"https://nixos.org/nixpkgs/manual/#how-to-build-a-haskell-project-using-stack\" rel=\"nofollow noreferrer\">nixos.org/nixpkgs/manual/&hellip;</a> . Use <code>haskell.lib.buildStackProject</code> instead of <code>stdenv.mkDerivation</code>."}], "answers": [{"comments": [{"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1510046389, "post_id": 47110522, "comment_id": 81257675, "body": "Any ideas on how to use the latest <code>nix</code> (that includes those changes)?"}, {"owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 1, "creation_date": 1510120196, "post_id": 47110522, "comment_id": 81294237, "body": "@DamianNadales You could use <code>-I nixpkgs=&#47;path&#47;to&#47;repo</code> flag with most <code>nix-*</code> command. If you don&#39;t want to clone <a href=\"https://github.com/NixOS/nixpkgs\" rel=\"nofollow noreferrer\">nixpkgs</a> you can just use the snapshot url provided by github like this <code>nix-shell -I nixpkgs=https:&#47;&#47;github.com&#47;NixOS&#47;nixpkgs&#47;archive&#47;master.tar.&zwnj;&#8203;gz -p stack</code>"}], "tags": [], "owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "is_accepted": true, "score": 4, "last_activity_date": 1509799872, "last_edit_date": 1509799872, "creation_date": 1509797022, "answer_id": 47110522, "question_id": 46861022, "link": "https://stackoverflow.com/questions/46861022/generating-a-nix-package-from-a-stack-project/47110522#47110522", "title": "Generating a Nix package from a stack project", "body": "<p>With this recent <a href=\"https://github.com/NixOS/nixpkgs/pull/30072\" rel=\"nofollow noreferrer\">merge</a>, I am able to build and installed a simple stack project using following steps:</p>\n\n<ol>\n<li>Create new <code>hello</code> project with <code>stack new hello</code></li>\n<li><p>Add following lines to <code>stack.yaml</code></p>\n\n<pre><code>nix:\n  enable: true\n  shell-file: default.nix\n</code></pre></li>\n<li><p>Create <code>default.nix</code></p>\n\n<pre><code>with (import &lt;nixpkgs&gt; { });\n\nhaskell.lib.buildStackProject {\n  name = \"hello\";\n  src = ./.;\n}\n</code></pre></li>\n</ol>\n\n<p>At this point, I am able to run <code>nix-build</code> to build the project and result will be at <code>./result/bin/hello-exe</code></p>\n\n<p>If I want to install, I would run <code>nix-env -i -f default.nix</code></p>\n\n<hr>\n\n<p>Side note: <code>nix-build</code> will download stack's build plan every time it run.</p>\n\n<p>I want to incrementally build my project while making changes so I mainly just drop in the shell and call <code>stack build</code> there.</p>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 3, "accepted_answer_id": 47110522, "answer_count": 1, "score": 8, "last_activity_date": 1526474177, "creation_date": 1508570594, "question_id": 46861022, "link": "https://stackoverflow.com/questions/46861022/generating-a-nix-package-from-a-stack-project", "title": "Generating a Nix package from a stack project", "body": "<p>I have a software application that can be built and installed with <code>stack</code>. I would like to offer a binary package as well for Linux and Mac. For this purpose I'm considering <code>nix</code>, since, among other things, it can be used in Linux and Mac. This will save me the trouble of having to maintain two package types.</p>\n\n<p>After reading about how <code>nix</code> packages are defined, I would expect that a <code>stack</code> based project could be built with a configuration that would look like:</p>\n\n<pre><code>{ stdenv, fetchurl, stack }: # we need to depend on stack\n\nstdenv.mkDerivation { \n  name = \"some-haskell-package-0.1\"; \n  builder = ./builder.sh; # here we would call `stack install` \n  src = fetchurl {  # ...\n  };\n}\n</code></pre>\n\n<p>Looking at the resources available online, I cannot find any description of how this could be done. I don't know if this means that <code>stack</code> and <code>nix</code> are not intended to be used in this way.</p>\n\n<p>The only thing I could find in the manual is <a href=\"https://nixos.org/nixpkgs/manual/#how-to-build-a-haskell-project-using-stack\" rel=\"noreferrer\">how <code>stack</code> can use <code>nix</code></a>, and a <a href=\"https://github.com/input-output-hk/stack2nix\" rel=\"noreferrer\"><code>stack</code> to <code>nix</code></a> conversion tool.</p>\n\n<p>I'm also open to alternatives for multi-platform packaging.</p>\n"}, {"tags": ["list", "function", "haskell", "recursion"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1508563921, "post_id": 46860351, "comment_id": 80668285, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/46859829/high-order-function-with-recusion-in-haskell\">High Order Function With Recusion in Haskell</a>"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 2, "creation_date": 1508565624, "post_id": 46860351, "comment_id": 80668577, "body": "For future reference, you should include the error message as part of your question.  It not only helps those trying to answer but will help people find your question in the future if they have a similar problem and try searching on the error message."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8793788, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-1GF-TK3Z-hU/AAAAAAAAAAI/AAAAAAAAHjU/rg0JpaFThNo/photo.jpg?sz=128", "display_name": "lou tej", "link": "https://stackoverflow.com/users/8793788/lou-tej"}, "edited": false, "score": 0, "creation_date": 1508569224, "post_id": 46860598, "comment_id": 80669176, "body": "god amongst men! Thank You"}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 4, "last_activity_date": 1508566550, "creation_date": 1508566550, "answer_id": 46860598, "question_id": 46860351, "link": "https://stackoverflow.com/questions/46860351/a-haskell-list-involving-recursion-and-high-order-functions/46860598#46860598", "title": "A Haskell List Involving Recursion and High Order Functions", "body": "<p>When I try your code, I get the following (admittedly somewhat lengthy and confusing) error message:</p>\n\n<pre><code>EveryOther.hs:4:42: error:\n    \u2022 Couldn't match type \u2018b\u2019 with \u2018a\u2019\n      \u2018b\u2019 is a rigid type variable bound by\n        the type signature for:\n          applyToEveryOther :: forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]\n        at EveryOther.hs:1:22\n      \u2018a\u2019 is a rigid type variable bound by\n        the type signature for:\n          applyToEveryOther :: forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]\n        at EveryOther.hs:1:22\n      Expected type: [a]\n        Actual type: [b]\n    \u2022 In the second argument of \u2018(:)\u2019, namely \u2018applyToEveryOther f xs\u2019\n      In the second argument of \u2018(:)\u2019, namely\n        \u2018y : applyToEveryOther f xs\u2019\n      In the expression: f x : y : applyToEveryOther f xs\n    \u2022 Relevant bindings include\n        xs :: [a] (bound at EveryOther.hs:4:26)\n        y :: a (bound at EveryOther.hs:4:24)\n        x :: a (bound at EveryOther.hs:4:22)\n        f :: a -&gt; b (bound at EveryOther.hs:4:19)\n        applyToEveryOther :: (a -&gt; b) -&gt; [a] -&gt; [b]\n           (bound at EveryOther.hs:2:1)\n</code></pre>\n\n<p>However, it's worth trying to figure out what GHC is saying here.  As per the second bullet point, GHC was processing the subexpression <code>y : applyToEveryOther f xs</code>, and specifically looking at the second argument to the <code>:</code> operator in that expression (namely <code>applyToEveryOther f xs</code>.  It expected that expression to have type <code>[a]</code>, but the actual type of the expression was type <code>[b]</code>.</p>\n\n<p>Here, <code>a</code> and <code>b</code> are both \"rigid\" types, meaning simply that they were specified explicitly by the programmer.  GHC also notes, in the relevant bindings, that <code>y</code> had type <code>a</code>.</p>\n\n<p>So, to sum up, you asked GHC to evaluate the expression:</p>\n\n<pre><code>y : applyToEveryOther f xs\n</code></pre>\n\n<p>where you already specified that <code>y</code> had type <code>a</code> and <code>applyToEveryOther f xs</code> had type <code>[b]</code>, and GHC refused to do this because lists in Haskell can't mix two different types.</p>\n\n<p>And that's kind of the key to the whole problem.  You want to transform some of the elements of your <code>[a]</code> list from <code>a</code> to <code>b</code>, but then you want to return a mixed list of <code>a</code>s and <code>b</code>s.  Haskell can't do that!</p>\n\n<p>The only way your function can work is if you change the signature so that <code>a</code> and <code>b</code> are the same type:</p>\n\n<pre><code>applyToEveryOther :: (a -&gt; a) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>and your code will work fine.</p>\n\n<p>Another way you could \"discover\" the correct signature is to leave it out and have Haskell infer the most general possible signature.  If you load the code (without the explicit signature) into GHCi and ask for the type, you get:</p>\n\n<pre><code>&gt; :t applyToEveryOther\napplyToEveryOther :: (a -&gt; a) -&gt; [a] -&gt; [a]\n&gt;\n</code></pre>\n\n<p>which is the most general possible type for this function. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7784908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/280a16ff968b8d9982bf2406335f6821?s=128&d=identicon&r=PG&f=1", "display_name": "val", "link": "https://stackoverflow.com/users/7784908/val"}, "is_accepted": false, "score": 0, "last_activity_date": 1508596510, "creation_date": 1508596510, "answer_id": 46864376, "question_id": 46860351, "link": "https://stackoverflow.com/questions/46860351/a-haskell-list-involving-recursion-and-high-order-functions/46864376#46864376", "title": "A Haskell List Involving Recursion and High Order Functions", "body": "<p>If I understood correctly you wanted both, the original and transformed values.</p>\n\n<p>However evaluating <code>applyToEveryOther (+3) [0,1,2]</code> returns [3,1,5]. If you want [0,3,1,4,2,5] as a result, try</p>\n\n<pre><code>applyToEveryOther _ [] = []\napplyToEveryOther f [x] = [x,f x]\napplyToEveryOther f (x:xs) = x: f x : applyToEveryOther f xs\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8793788, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-1GF-TK3Z-hU/AAAAAAAAAAI/AAAAAAAAHjU/rg0JpaFThNo/photo.jpg?sz=128", "display_name": "lou tej", "link": "https://stackoverflow.com/users/8793788/lou-tej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 46860598, "answer_count": 2, "score": 1, "last_activity_date": 1508596510, "creation_date": 1508563593, "last_edit_date": 1508565554, "question_id": 46860351, "link": "https://stackoverflow.com/questions/46860351/a-haskell-list-involving-recursion-and-high-order-functions", "title": "A Haskell List Involving Recursion and High Order Functions", "body": "<p>Now I have this code that takes a list and does something to the first element and then to every other one. And it returns a list of the transformed elements. The problem I am having is that I want to have a list that contains the untransformed and the transformed elements. This is what I have so far: </p>\n\n<pre><code>applyToEveryOther :: (a -&gt; b) -&gt; [a] -&gt; [b]\napplyToEveryOther _ [] = []\napplyToEveryOther f [x] = [f x]\napplyToEveryOther f (x:y:xs) = f x : y : applyToEveryOther f xs\n</code></pre>\n\n<p>The error it is giving me says there is a problem with the <code>: y</code> part of the function</p>\n"}, {"tags": ["list", "haskell", "recursion"], "comments": [{"owner": {"reputation": 6415, "user_id": 1416525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6f23f148b7241e345a61d193ed205685?s=128&d=identicon&r=PG", "display_name": "cdk", "link": "https://stackoverflow.com/users/1416525/cdk"}, "edited": false, "score": 1, "creation_date": 1508557524, "post_id": 46859829, "comment_id": 80667342, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17383169/haskell-double-every-2nd-element-in-list\">Haskell: Double every 2nd element in list</a>"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8793788, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-1GF-TK3Z-hU/AAAAAAAAAAI/AAAAAAAAHjU/rg0JpaFThNo/photo.jpg?sz=128", "display_name": "lou tej", "link": "https://stackoverflow.com/users/8793788/lou-tej"}, "edited": false, "score": 0, "creation_date": 1508560449, "post_id": 46859938, "comment_id": 80667753, "body": "If I have another question on this.. if I wanted to actually keep the whole list, not just keep the ones that got transformed, how would I go about doing this. I&#39;m new to this and wasn&#39;t sure if I make a new post or not"}, {"owner": {"reputation": 287228, "user_id": 1240268, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/RN9Mw.jpg?s=128&g=1", "display_name": "Andy Hayden", "link": "https://stackoverflow.com/users/1240268/andy-hayden"}, "reply_to_user": {"reputation": 27, "user_id": 8793788, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-1GF-TK3Z-hU/AAAAAAAAAAI/AAAAAAAAHjU/rg0JpaFThNo/photo.jpg?sz=128", "display_name": "lou tej", "link": "https://stackoverflow.com/users/8793788/lou-tej"}, "edited": false, "score": 0, "creation_date": 1508560797, "post_id": 46859938, "comment_id": 80667805, "body": "@loutej definitely a new post! (I think the answer is <code>f x : y : applyToEveryOther f xs</code> but it&#39;ll be formatted better and more useful to others as a fresh post)."}], "tags": [], "owner": {"reputation": 287228, "user_id": 1240268, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/RN9Mw.jpg?s=128&g=1", "display_name": "Andy Hayden", "link": "https://stackoverflow.com/users/1240268/andy-hayden"}, "is_accepted": true, "score": 4, "last_activity_date": 1508558647, "creation_date": 1508558647, "answer_id": 46859938, "question_id": 46859829, "link": "https://stackoverflow.com/questions/46859829/non-exhaustive-pattern-error-in-recursive-function/46859938#46859938", "title": "Non-exhaustive pattern error in recursive function", "body": "<p>The single element case should also return a List (of type <code>[b]</code>):</p>\n\n<pre><code>applyToEveryOther f [x] = [f x]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1508596692, "last_edit_date": 1508596692, "creation_date": 1508594988, "answer_id": 46864116, "question_id": 46859829, "link": "https://stackoverflow.com/questions/46859829/non-exhaustive-pattern-error-in-recursive-function/46864116#46864116", "title": "Non-exhaustive pattern error in recursive function", "body": "<p>Another solution that doesn't use explicit recursion, but just higher-order functions:</p>\n\n<pre><code>import Data.List (cycle)\n\napplyToEveryOther f = zipWith ($) (cycle [f, id])\n</code></pre>\n\n<p><code>cycle</code> creates an infinite list of alternating functions <code>f</code>, <code>id</code>, <code>f</code>, <code>id</code>, etc.</p>\n\n<p><code>zipWith ($)</code> applies the functions in the list to the corresponding elements of your input list.</p>\n\n<pre><code>[(+1), id, (+1), id, (+1), id, (+1), id, ...]\n[   1,  2,    3,  4,    5,  6,    7,  8     ]\n=============================================\n[   2,  2,    4,  4,    6,  6,    8,  8     ]\n</code></pre>\n\n<p>(Hat tip: the problem of applying a list of functions piecewise to a list of arguments, along with a solution using <code>zipWith ($)</code>, <a href=\"https://twitter.com/1HaskellADay/status/921389376931758081\" rel=\"nofollow noreferrer\">appeared recently</a> on the 1HaskellADay twitter feed.)</p>\n\n<p>(My own inferior solution was to use the <code>ZipList</code> type constructor found in <code>Control.Applicative</code>; applied here, it would look something like</p>\n\n<pre><code>import Control.Applicative\n\napplyToEveryOther f xs = let fs = cycle [f,id]\n                          in getZipList (ZipList fs &lt;*&gt; ZipList xs)\n</code></pre>\n\n<p>)</p>\n"}], "owner": {"reputation": 27, "user_id": 8793788, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-1GF-TK3Z-hU/AAAAAAAAAAI/AAAAAAAAHjU/rg0JpaFThNo/photo.jpg?sz=128", "display_name": "lou tej", "link": "https://stackoverflow.com/users/8793788/lou-tej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 46859938, "answer_count": 2, "score": 1, "last_activity_date": 1508648985, "creation_date": 1508557354, "last_edit_date": 1508648985, "question_id": 46859829, "link": "https://stackoverflow.com/questions/46859829/non-exhaustive-pattern-error-in-recursive-function", "title": "Non-exhaustive pattern error in recursive function", "body": "<p>I am trying to use recursion and higher-order functions to do something to the first element of a list and then to every other element in the list, so for example add 3 to the 1st, 3rd, 5th.. etc.</p>\n\n<p>The problem I am having is that it gives me the <code>non-exhaustive pattern</code> error. Any help would be appreciated. Here is what I have so far: </p>\n\n<pre><code>applyToEveryOther :: (a -&gt; b) -&gt; [a] -&gt; [b]\napplyToEveryOther _ [] = []\napplyToEveryOther f (x:y:xs) = f x : applyToEveryOther f xs\n</code></pre>\n\n<p>and these are some additional lines that I have tried but don't help:</p>\n\n<pre><code>applyToEveryOther _ [x] = f x\napplyToEveryOther f [x] = f x\n</code></pre>\n"}, {"tags": ["haskell", "user-defined-types"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1508555186, "post_id": 46859619, "comment_id": 80666999, "body": "Is <code>aux2</code> supposed to be a function, or a list? You&#39;ve defined it as a function, but you&#39;re not using any parameters, and it&#39;s written as if <code>aux</code> is a list which you could <code>filter</code>, when actually <code>aux</code> is a function."}, {"owner": {"reputation": 5, "user_id": 8577388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f732fa5f21e08c5015512299962d5e?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Perez", "link": "https://stackoverflow.com/users/8577388/ricardo-perez"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1508557648, "post_id": 46859619, "comment_id": 80667359, "body": "It is a funcion, but i want to use the resulting list in another function."}], "answers": [{"tags": [], "owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "is_accepted": true, "score": 0, "last_activity_date": 1508567220, "creation_date": 1508567220, "answer_id": 46860666, "question_id": 46859619, "link": "https://stackoverflow.com/questions/46859619/haskell-no-instance-for-foldable-type-arising-from-a-use-of-null/46860666#46860666", "title": "Haskell- No instance for (Foldable ((-&gt;) [Type]) arising from a use of \u2018null\u2019", "body": "<p>Since <code>filter</code> has type <code>(a -&gt; Bool) -&gt; [a] -&gt; [a]</code> your definition for <code>aux2</code> looks weird. The second argument to <code>filter</code> is a simple list, not a function (<code>aux</code> in your case). You either need more arguments to <code>aux</code> or skip <code>aux</code> to get the types right:</p>\n\n<pre><code>aux2 :: Prop -&gt; [Estados] -&gt; [Booleano]\naux2 a b = filter comparador2 (aux a b)\n\n\naux2 :: [Booleano] -&gt; [Booleano]\naux2 = filter comparador2\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8577388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f732fa5f21e08c5015512299962d5e?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo Perez", "link": "https://stackoverflow.com/users/8577388/ricardo-perez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 46860666, "answer_count": 1, "score": -1, "last_activity_date": 1508567220, "creation_date": 1508554514, "last_edit_date": 1508566856, "question_id": 46859619, "link": "https://stackoverflow.com/questions/46859619/haskell-no-instance-for-foldable-type-arising-from-a-use-of-null", "title": "Haskell- No instance for (Foldable ((-&gt;) [Type]) arising from a use of \u2018null\u2019", "body": "<p>I have the following error, kept in mind that \"Booleano\" corresponds to an user-define type.</p>\n\n<pre><code>Prop.hs:173:28: error:\n    \u2022 No instance for (Foldable ((-&gt;) [Booleano]))\n        arising from a use of \u2018null\u2019\n    \u2022 In the first argument of \u2018(==)\u2019, namely \u2018(null aux2)\u2019\n      In the expression: ((null aux2) == True)\n      In the expression:\n        if ((null aux2) == True) then Falso else Verdadero\nProp.hs:184:16: error:\n    \u2022 No instance for (Eq Booleano) arising from a use of \u2018==\u2019\n    \u2022 In the expression: x == Falso\n      In an equation for \u2018comparador2\u2019: comparador2 x = x == Falso*\n</code></pre>\n\n<p>Im working with this code:</p>\n\n<pre><code>type Estados = [(String,Booleano)]\n\nesTautologia :: Prop -&gt; [Estados] -&gt; Booleano\nesTautologia p est =  if (null aux2 == True ) then \n              Falso\n                  else\n              Verdadero \naux :: Prop -&gt; [Estados] -&gt; [Booleano]\naux p est= map (interp p) est\n\naux2:: [Booleano] -&gt; [Booleano]\naux2= filter comparador2 aux\n\ncomparador2:: Booleano -&gt; Bool\ncomparador2 x= x == Falso\n</code></pre>\n\n<p>The type Prop it's for making logic arguments, so, Prop isn't a key problem. \nThanks for the help, if you need another especification, please tell me.</p>\n"}, {"tags": ["haskell", "yesod", "haskell-stack", "template-haskell"], "answers": [{"comments": [{"owner": {"reputation": 1634, "user_id": 2093075, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6198d2d199a48b8d61e01ecdc4b0c81a?s=128&d=identicon&r=PG", "display_name": "Pedro Hoehl Carvalho", "link": "https://stackoverflow.com/users/2093075/pedro-hoehl-carvalho"}, "edited": false, "score": 0, "creation_date": 1508535372, "post_id": 46857608, "comment_id": 80662965, "body": "Can I use <code>whamletFile</code> to import external <code>.lucius</code> files? I was under the impression it would only work with <code>.hamlet</code> files.  I ended up importing using Text.Hamlet."}, {"owner": {"reputation": 554, "user_id": 1146898, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/413b69be81046e5a73b343424248ce73?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/1146898/ben"}, "reply_to_user": {"reputation": 1634, "user_id": 2093075, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6198d2d199a48b8d61e01ecdc4b0c81a?s=128&d=identicon&r=PG", "display_name": "Pedro Hoehl Carvalho", "link": "https://stackoverflow.com/users/2093075/pedro-hoehl-carvalho"}, "edited": false, "score": 0, "creation_date": 1508549751, "post_id": 46857608, "comment_id": 80666140, "body": "You cannot use <code>whamletFile</code> to import lucius files, but you can use the <code>widgetFile</code> function which will import all 3 hamlet, lucius, and cassius files."}, {"owner": {"reputation": 1634, "user_id": 2093075, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6198d2d199a48b8d61e01ecdc4b0c81a?s=128&d=identicon&r=PG", "display_name": "Pedro Hoehl Carvalho", "link": "https://stackoverflow.com/users/2093075/pedro-hoehl-carvalho"}, "edited": false, "score": 0, "creation_date": 1508550443, "post_id": 46857608, "comment_id": 80666262, "body": "But <code>widgetFile</code> is not included in the core yesod library, right? I would have to add yesod-scaffold to my dependency list, which seems like an overkill, considering that\u2019s the only function I\u2019ll use."}, {"owner": {"reputation": 554, "user_id": 1146898, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/413b69be81046e5a73b343424248ce73?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/1146898/ben"}, "reply_to_user": {"reputation": 1634, "user_id": 2093075, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6198d2d199a48b8d61e01ecdc4b0c81a?s=128&d=identicon&r=PG", "display_name": "Pedro Hoehl Carvalho", "link": "https://stackoverflow.com/users/2093075/pedro-hoehl-carvalho"}, "edited": false, "score": 0, "creation_date": 1508619690, "post_id": 46857608, "comment_id": 80683380, "body": "The yesod-scaffold repo is used by <code>stack new</code> to generate new project templates. I don&#39;t think you can even include it as a dependency with cabal/stack. You could just copy the function into your project though: <a href=\"https://github.com/bitemyapp/ghcjs-starter-project/blob/master/backend/Settings.hs#L85-L105\" rel=\"nofollow noreferrer\">github.com/bitemyapp/ghcjs-starter-project/blob/master/backe&zwnj;&#8203;nd/&hellip;</a>"}], "tags": [], "owner": {"reputation": 554, "user_id": 1146898, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/413b69be81046e5a73b343424248ce73?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/1146898/ben"}, "is_accepted": true, "score": 3, "last_activity_date": 1508535012, "creation_date": 1508535012, "answer_id": 46857608, "question_id": 46857021, "link": "https://stackoverflow.com/questions/46857021/hamletfile-luciusfile-juliusfile-variables-not-in-scope/46857608#46857608", "title": "hamletFile, luciusFile, juliusFile variables not in scope", "body": "<p>Why don't you just use <code>whamletFile</code>? Most of the time you want a widget.</p>\n\n<p>It seems <code>hamletFile</code> is not re-exported.</p>\n\n<pre><code>\u03bb import Yesod\n\u03bb :t hamletFile\n\n&lt;interactive&gt;:1:1: error:\n    \u2022 Variable not in scope: hamletFile\n    \u2022 Perhaps you meant \u2018whamletFile\u2019 (imported from Yesod)\n</code></pre>\n\n<p>If you really need it, you could bring it in from <a href=\"https://www.stackage.org/haddock/lts-9.9/shakespeare-2.0.14/Text-Hamlet.html#v:hamletFile\" rel=\"nofollow noreferrer\">Text.Hamlet</a>.</p>\n\n<p>FWIW the <a href=\"https://github.com/yesodweb/yesod-scaffold\" rel=\"nofollow noreferrer\">Yesod scaffolding</a> defines a function</p>\n\n<pre><code>widgetFile :: String -&gt; Q Exp\nwidgetFile = (if appReloadTemplates compileTimeAppSettings\n                then widgetFileReload\n                else widgetFileNoReload)\n              widgetFileSettings\n</code></pre>\n\n<p>And then I just use this everywhere like <code>$(Settings.widgetFile \"homepage\")</code> which by default brings in the hamlet, lucius, and cassius files for \"homepage\". You can see more info at <a href=\"https://github.com/yesodweb/yesod/wiki/Overriding-widgetFile\" rel=\"nofollow noreferrer\">Overriding-widgetFile on the Yesod wiki</a></p>\n"}], "owner": {"reputation": 1634, "user_id": 2093075, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6198d2d199a48b8d61e01ecdc4b0c81a?s=128&d=identicon&r=PG", "display_name": "Pedro Hoehl Carvalho", "link": "https://stackoverflow.com/users/2093075/pedro-hoehl-carvalho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 0, "accepted_answer_id": 46857608, "answer_count": 1, "score": 2, "last_activity_date": 1508535012, "creation_date": 1508532064, "question_id": 46857021, "link": "https://stackoverflow.com/questions/46857021/hamletfile-luciusfile-juliusfile-variables-not-in-scope", "title": "hamletFile, luciusFile, juliusFile variables not in scope", "body": "<p>I'm building a simple application using Yesod and I'm having a hard time bringing in external files. Here is my code:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings     #-}\n{-# LANGUAGE QuasiQuotes           #-}\n{-# LANGUAGE TemplateHaskell       #-}\n{-# LANGUAGE TypeFamilies          #-}\nimport           Yesod\n\ndata GomokuServer = GomokuServer\n\nmkYesod \"GomokuServer\" [parseRoutes|\n/ HomeR GET\n|]\n\ninstance Yesod GomokuServer\n\ngetHomeR :: Handler Html\ngetHomeR = defaultLayout $ do \n        $(hamletFile \"./src/templates/home.hamlet\")\n        $(luciusFile \"./src/templates/home.lucius\")\n\nmain :: IO ()\nmain = warp 3000 GomokuServer\n</code></pre>\n\n<p>It works great when I use quasiquotes, or if I replace <code>hamletFile</code> with <code>whamletFile</code>, but otherwise it won't compile because it can't find <code>hamletFile</code> or <code>luciusFile</code>. I'm using Yesod version 1.4 and I thought those methods where imported with the core Yesod package. Are they not?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1508522988, "post_id": 46854836, "comment_id": 80657252, "body": "You forgot to ask a question. But yes, you need a stop condition (base case)"}, {"owner": {"reputation": 105, "user_id": 7841878, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ea84e22431b5da70d9f514ee95767b09?s=128&d=identicon&r=PG&f=1", "display_name": "James Hamish", "link": "https://stackoverflow.com/users/7841878/james-hamish"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1508523070, "post_id": 46854836, "comment_id": 80657291, "body": "I have edited now"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1508523126, "post_id": 46854836, "comment_id": 80657317, "body": "<code>0</code> is not a list."}], "answers": [{"tags": [], "owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "is_accepted": false, "score": 4, "last_activity_date": 1508523557, "creation_date": 1508523557, "answer_id": 46855056, "question_id": 46854836, "link": "https://stackoverflow.com/questions/46854836/haskell-recurse-and-add-to-a-list/46855056#46855056", "title": "Haskell recurse and add to a list", "body": "<p>I think in this particular case, you could use <code>scanl1</code> like:</p>\n\n<pre><code>scanl1 (+) [1,2,3,4] -- [1,3,6,10]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6788, "user_id": 1748754, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jjk7p.jpg?s=128&g=1", "display_name": "erewok", "link": "https://stackoverflow.com/users/1748754/erewok"}, "is_accepted": false, "score": 0, "last_activity_date": 1508523574, "creation_date": 1508523574, "answer_id": 46855061, "question_id": 46854836, "link": "https://stackoverflow.com/questions/46854836/haskell-recurse-and-add-to-a-list/46855061#46855061", "title": "Haskell recurse and add to a list", "body": "<p>When iterating over lists, we often use folds, which is a way of reducing the list to a particular value. </p>\n\n<p>There's also another type of operation, which is a fold that collects all results along the way, and that's called a <code>scan</code> (from the <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:scanl\" rel=\"nofollow noreferrer\">docs</a>):</p>\n\n<pre><code>scanl                   = scanlGo\n  where\n    scanlGo           :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b]\n    scanlGo f q ls    = q : (case ls of\n                               []   -&gt; []\n                               x:xs -&gt; scanlGo f (f q x) xs)\n</code></pre>\n\n<p>So the scan takes three arguments: a function that takes two values and returns a value, a starter value, and a list of values.</p>\n\n<p>The scan will then return a list.</p>\n\n<p>Thus, what you need is a function that takes two values and returns something of the same type as the first (it's okay if both are the same). Binary addition would work here: <code>+</code>. </p>\n\n<p>You also need a value to start off with (the <code>b</code>, which is the second argument to our function), and 0 is the identity for integer addition, so we should use that.</p>\n\n<p>Finally, we pass your list to get the result.</p>\n\n<p>Try to figure out how to write you function as a fold and then as a scan and you will discover the answer.</p>\n"}, {"comments": [{"owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "reply_to_user": {"reputation": 105, "user_id": 7841878, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ea84e22431b5da70d9f514ee95767b09?s=128&d=identicon&r=PG&f=1", "display_name": "James Hamish", "link": "https://stackoverflow.com/users/7841878/james-hamish"}, "edited": false, "score": 1, "creation_date": 1508523974, "post_id": 46855062, "comment_id": 80657754, "body": "@JamesHamish Sure, I&#39;ll expand the answer. I should mention that the more idiomatic way to do this is <code>scanl</code>, as shown in the other answer, so you might want to use/accept that."}], "tags": [], "owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "is_accepted": true, "score": 4, "last_activity_date": 1508524798, "last_edit_date": 1508524798, "creation_date": 1508523581, "answer_id": 46855062, "question_id": 46854836, "link": "https://stackoverflow.com/questions/46854836/haskell-recurse-and-add-to-a-list/46855062#46855062", "title": "Haskell recurse and add to a list", "body": "<p>Your problem here isn't how to append, but rather how to calculate the value in the first place. Each item needs to be substituted with a sum of itself with all the items preceding it.</p>\n\n<p>Here is one way to do it:</p>\n\n<pre><code>Prelude&gt; func (x:xs) = x:map (+ x) (func xs); func [] = []\nPrelude&gt; func [1, 2, 3, 4]\n[1,3,6,10]\n</code></pre>\n\n<p>How does this work? We're given a list that starts with the element <code>x</code> and has the remaining elements <code>xs</code>. We want to increment every item in <code>xs</code> by <code>x</code>, after recursively applying the algorithm to <code>xs</code>.</p>\n\n<p>This is what <code>x:map (+ x) (func xs)</code> does. It reads as \"prepend <code>x</code> to the result of mapping every element in <code>func xs</code> through an increment by <code>x</code>\".</p>\n\n<hr>\n\n<p>E.g. for <code>[1, 2, 3, 4]</code>, we want <code>1</code> to be added to every member of the result of recursively applying the algorithm to <code>[2, 3, 4]</code>, then prepended. For <code>[2, 3, 4]</code> we want <code>2</code> to be ... to <code>[3, 4]</code>. And so on, until eventually for <code>[4]</code> we want <code>4</code> to be added and prepended to the result of applying the algorithm to <code>[]</code>.</p>\n\n<p>This is where our base case (<code>func [] = []</code>) kicks in: the algorithm is defined so that it returns an empty list unchanged. Hence <code>func [4]</code> is <code>[4]</code>, <code>func [3, 4]</code> is <code>[3, 7]</code>, and you keep incrementing and prepending until you get <code>[1,3,6,10]</code>.</p>\n"}], "owner": {"reputation": 105, "user_id": 7841878, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ea84e22431b5da70d9f514ee95767b09?s=128&d=identicon&r=PG&f=1", "display_name": "James Hamish", "link": "https://stackoverflow.com/users/7841878/james-hamish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "accepted_answer_id": 46855062, "answer_count": 3, "score": 1, "last_activity_date": 1508534793, "creation_date": 1508522642, "last_edit_date": 1508534793, "question_id": 46854836, "link": "https://stackoverflow.com/questions/46854836/haskell-recurse-and-add-to-a-list", "title": "Haskell recurse and add to a list", "body": "<p>I'm a Haskell beginner,</p>\n\n<p>I have a function </p>\n\n<pre><code>func :: Num a =&gt; [a] -&gt; [a]\nfunc [] = []\nfunc (x:xs) = x + func xs\n</code></pre>\n\n<p>Each recursion I want to append the value to a list for my output. This function will sum consecutive indexes in a list so that the input <code>[1, 2, 3, 4]</code> produces <code>[1, 3, 6, 10]</code>.</p>\n\n<p>How do I append the value generated each time to my list?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 4, "creation_date": 1508521500, "post_id": 46854417, "comment_id": 80656532, "body": "I would probably write the it with explicit recursion. That can look pretty clean here, I think."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1508524769, "post_id": 46854737, "comment_id": 80658179, "body": "Minor nit: you want <code>k+1</code>, not <code>k</code>, since you are dropping the first element for which the term is greater than or equal to 2.99/4."}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": false, "score": 7, "last_activity_date": 1508524889, "last_edit_date": 1508524889, "creation_date": 1508522195, "answer_id": 46854737, "question_id": 46854417, "link": "https://stackoverflow.com/questions/46854417/how-to-implement-a-loop-with-conditional-breaks-in-haskell/46854737#46854737", "title": "how to implement a loop with conditional breaks in Haskell", "body": "<p>I like to work backwards in these sort of situations:</p>\n\n<pre><code>main = print k where\n  k = 1 + length (takeWhile (&lt; (2.99/4)) partialSums)\n  partialSums = scanl1 (+) terms\n  terms = [ 1.0/(k*k+2.0*k) | k &lt;- [1..] ] \n</code></pre>\n\n<p>How this works:</p>\n\n<p><code>terms</code> is an infinite list, but since Haskell is lazy, we'll only calculate as much of each term as we demand:</p>\n\n<pre><code>\u03bb terms = [ 1.0/(k*k+2.0*k) | k &lt;- [1..] ] :: [Double]\n\u03bb take 5 terms\n[0.3333333333333333,0.125,6.666666666666667e-2,4.1666666666666664e-2,2.857142857142857e-2]\n\u03bb :p terms\nterms = 0.3333333333333333 : 0.125 : 6.666666666666667e-2 :\n        4.1666666666666664e-2 : 2.857142857142857e-2 : (_t5::[Double])\n</code></pre>\n\n<p><code>partialSums</code> is another infinite list, based on the contents of <code>terms</code> (using <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:scanl1\" rel=\"noreferrer\"><code>scanl1</code></a>). It lets us amortize the work that you do computing <code>termSum</code>:</p>\n\n<pre><code>\u03bb partialSums = scanl1 (+) terms\n\u03bb take 5 partialSums \n[0.3333333333333333,0.4583333333333333,0.525,0.5666666666666667,0.5952380952380952]\n</code></pre>\n\n<p>The <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:takeWhile\" rel=\"noreferrer\"><code>takeWhile (&lt; (2.99/4))</code></a> then determines how many terms of <code>partialSums</code> we need to generate and thereby how many terms of\n<code>terms</code> we need to generate:</p>\n\n<pre><code>\u03bb length (takeWhile (&lt; (2.99/4)) partialSums)\n398\n</code></pre>\n\n<p>If we check, we can see that the sum of the first 398 <code>terms</code> are less than <code>2.99 / 4</code>, but the 399th bumps it over:</p>\n\n<pre><code>\u03bb sum (take 398 terms) &lt; 2.99/4\nTrue\n\u03bb sum (take 399 terms) &lt; 2.99/4\nFalse\n</code></pre>\n\n<p>Or, equivalently that the 397th partial sum (0-based index) is less than the target and that the 398th is not:</p>\n\n<pre><code>\u03bb partialSums !! 397 &lt; 2.99/4\nTrue\n\u03bb partialSums !! 398 &lt; 2.99/4\nFalse\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1508534361, "post_id": 46854871, "comment_id": 80662565, "body": "What does <code>fix</code> do?"}], "tags": [], "owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "is_accepted": true, "score": 5, "last_activity_date": 1508522791, "creation_date": 1508522791, "answer_id": 46854871, "question_id": 46854417, "link": "https://stackoverflow.com/questions/46854417/how-to-implement-a-loop-with-conditional-breaks-in-haskell/46854871#46854871", "title": "how to implement a loop with conditional breaks in Haskell", "body": "<p>Essentially explicit recursion, but I like <code>fix</code> for loops like this:</p>\n\n<pre><code>import Data.Function (fix)\n\nterm k = 1.0 / (k*k+2.0*k)\n\nmain = print $ fix (\\f total k -&gt;\n                      let new = total + term k\n                      in if new &gt;= 2.99/4.0 then k else f new (k+1)\n                   ) 0 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 1, "creation_date": 1508540925, "post_id": 46857862, "comment_id": 80664497, "body": "For the curious: continuations are basically FP&#39;s version of <code>goto</code>. <code>callCC</code> introduces a &quot;label&quot;; it passes a continuation to its argument, and when that continuation is called (&quot;goto&quot;) with some argument <code>x</code>, control jumps to after the <code>callCC</code>, and the value of <code>x</code> is returned."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1508553767, "post_id": 46857862, "comment_id": 80666799, "body": "That is a nice joke. But this mucking about with <code>IORef</code> seems like inefficient overkill. Why not use <code>ContT</code> with <code>State</code>? Oh, I guess that would get in the way of the <code>print</code> in the punchline...."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1508569641, "post_id": 46857862, "comment_id": 80669247, "body": "@dfeuer I agree. I needed IO for the <code>print</code>. I could have used <code>ContT+StateT+IO</code>, I think. Refs are indeed overkill for this, but I wanted to show a very general (even if not very elegant) way to do it."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1508602453, "last_edit_date": 1508602453, "creation_date": 1508536478, "answer_id": 46857862, "question_id": 46854417, "link": "https://stackoverflow.com/questions/46854417/how-to-implement-a-loop-with-conditional-breaks-in-haskell/46857862#46857862", "title": "how to implement a loop with conditional breaks in Haskell", "body": "<blockquote>\n  <p>It's a simple and easy stuff if I use another language, like c/c++</p>\n</blockquote>\n\n<p>Well, let's do it in the same way, then.</p>\n\n<pre><code>import Prelude hiding (break)\nimport Data.IORef\nimport Control.Monad.Cont\nimport Data.Foldable\nimport Control.Monad (when)\n\n-- long double term(int k) { return 1.0/(k*k+2.0*k); }\nterm :: Int -&gt; Double\nterm k = 1.0/(k'*k'+2.0*k')\n   where k' = fromIntegral k\n\n-- int main() {\nmain :: IO ()\nmain = flip runContT return $ do\n   -- long double total = 0.0;\n   total &lt;- lift $ newIORef (0.0 :: Double)\n   -- for (int k=1;;k++) {\n   callCC $ \\break -&gt;\n      for_ [1..] $ \\k -&gt; do\n         -- total += term(k);\n         lift $ modifyIORef total (+ term k)\n         -- if (total&gt;=2.99/4.0) {\n         totalV &lt;- lift $ readIORef total\n         when (totalV &gt;= 2.99/4.0) $ do\n            -- std::cout &lt;&lt; k &lt;&lt; std::endl;\n            lift $ print k\n            -- break;\n            break ()\n</code></pre>\n\n<p>Yes, the above is more of a joke than a serious answer. Still, it's nice to see that, at least in theory, it is possible to write imperative code in Haskell.</p>\n\n<p>It just leads to non-idiomatic Haskell, which is not that much harder to read or write than the original code. After all, what's a <code>callCC</code> or two between friends? :-P</p>\n"}], "owner": {"reputation": 697, "user_id": 5821028, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f02b2f13bdf83954535307af466460a7?s=128&d=identicon&r=PG&f=1", "display_name": "eii0000", "link": "https://stackoverflow.com/users/5821028/eii0000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 46854871, "answer_count": 3, "score": 4, "last_activity_date": 1508804235, "creation_date": 1508520851, "last_edit_date": 1508804235, "question_id": 46854417, "link": "https://stackoverflow.com/questions/46854417/how-to-implement-a-loop-with-conditional-breaks-in-haskell", "title": "how to implement a loop with conditional breaks in Haskell", "body": "<p>I want to find out the first n that satisfies <img src=\"https://chart.googleapis.com/chart?cht=tx&amp;chl=f%28n%29%3D%5Csum_%7Bk%3D1%7D%5E%7Bn%7D%7B1%2F%28k%2Ak%2B2k%29%7D%3E%3D2.99%2F4.0\" alt=\"f(n)=\\sum_{k=1}^{n}{1/(k*k+2k)}&gt;=2.99/4.0\">. It's a simple and easy stuff if I use another language, like c/c++, but I don't know how to implement it in Haskell.</p>\n\n<pre><code>#include &lt;iostream&gt;\nlong double term(int k) { return 1.0/(k*k+2.0*k); }\nint main() {\n    long double total = 0.0;\n    for (int k=1;;k++) {\n        total += term(k);\n        if (total&gt;=2.99/4.0) {\n            std::cout &lt;&lt; k &lt;&lt; std::endl;\n            break;\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I used dropWhile with an ordered list and take 1 to pick up the first one.</p>\n\n<pre><code>term k = 1.0/(k*k+2.0*k)\ntermSum n = sum $ take n $ map term [1..]\nmain = do\n  let [(n,val)] = take 1 $ dropWhile (\\(a,b)-&gt;b &lt;= 2.99/4.0) $ map (\\n-&gt;(n,termSum n)) [1..]\n  print n\n</code></pre>\n\n<p>I know it's horrible. What is the best and intuitive way to write this?</p>\n\n<p>Re:\nThank you for the great answers! The one using fix function seems to be the fastest in my machine (Redhat 6.4 64bit / 80GB memory)</p>\n\n<p>method#0 take 1 and dropWhile (my initial implementation)</p>\n\n<pre><code>threshold=0.74999         n=99999     time=52.167 sec\n</code></pre>\n\n<p>method#1 using fix function</p>\n\n<pre><code>threshold=0.74999         n=99999     time=0.005 sec\nthreshold=0.74999999      n=101554197 time=1.077 sec\nthreshold=0.7499999936263 n=134217004 time=1.407 sec\n</code></pre>\n\n<p>method#2 working backwards</p>\n\n<pre><code>threshold=0.74999         n=99999     time=0.026 sec\nthreshold=0.74999999      n=101554197 time=21.523 sec\nthreshold=0.7499999936263 n=134217004 time=25.247 sec\n</code></pre>\n\n<p>method#3 imperative way</p>\n\n<pre><code>threshold=0.74999         n=99999     time=0.008 sec\nthreshold=0.74999999      n=101554197 time=2.460 sec\nthreshold=0.7499999936263 n=134217004 time=3.254 sec\n</code></pre>\n\n<p>ReRe:\nI noticed that whatever implementation I used (fix, imperative way, or recursive way), if the threshold is larger than 0.7499999936264... it never ends.. in order for f(n) to be larger than 0.7499999936264, I thought we just needed to compute the terms up to 150,000,000 since ![f(n)=\\frac_{3n^2+5n}^{4n^2+12n+8}]. I used Integer instead of Int, but it did not help either. Is there any reason why it does not finish if I set the threshold larger than 0.7499999936264 ...?</p>\n"}, {"tags": ["haskell", "opaleye"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1508592893, "post_id": 46853074, "comment_id": 80674982, "body": "Do you need to use the <code>Join</code> module over the <code>FunctionalJoin</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "is_accepted": false, "score": 0, "last_activity_date": 1508593847, "creation_date": 1508593847, "answer_id": 46863946, "question_id": 46853074, "link": "https://stackoverflow.com/questions/46853074/left-join-in-opaleye/46863946#46863946", "title": "Left join in Opaleye", "body": "<p>Trying changing the following:</p>\n\n<pre><code>query :: Query (ModelAColumn, Maybe ModelBColumn)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>query :: Query ((Column PGUuid) (Column (Nullable PGUuid))\n               , (Column (Nullable PGUuid)) (Column (Nullable PGText)))\n</code></pre>\n\n<p>Try to get that to type-check WITHOUT calling <code>runQuery</code> on it. Once that works, come back for the rest of the solution.</p>\n"}, {"tags": [], "owner": {"reputation": 44, "user_id": 4457099, "user_type": "registered", "profile_image": "https://graph.facebook.com/1473465026/picture?type=large", "display_name": "Kahlil Abreu", "link": "https://stackoverflow.com/users/4457099/kahlil-abreu"}, "is_accepted": false, "score": 0, "last_activity_date": 1508594446, "creation_date": 1508594446, "answer_id": 46864040, "question_id": 46853074, "link": "https://stackoverflow.com/questions/46853074/left-join-in-opaleye/46864040#46864040", "title": "Left join in Opaleye", "body": "<p>You need to use a <code>Functional Join</code>, specifically <code>leftJoinF</code>.</p>\n\n<p>Check out this <a href=\"https://hackage.haskell.org/package/opaleye-0.5.4.0/docs/Opaleye-FunctionalJoin.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/opaleye-0.5.4.0/docs/Opaleye-FunctionalJoin.html</a></p>\n\n<p>You would need to provide the results of a select on your two tables as the 4th and 5th argument to it. \nAn equivalent of <code>foreignA == primB</code> as the 3rd argument. </p>\n\n<p>For your 2nd argument you would have to specify some default value that should be used whenever the <code>Maybe ModelB</code> being returned is a <code>Nothing</code></p>\n"}, {"comments": [{"owner": {"reputation": 1242, "user_id": 3252252, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/4V81y.jpg?s=128&g=1", "display_name": "Jesuspc", "link": "https://stackoverflow.com/users/3252252/jesuspc"}, "edited": false, "score": 0, "creation_date": 1508599846, "post_id": 46864741, "comment_id": 80677179, "body": "Thank you very much! And apologies for the weird syntax."}, {"owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "reply_to_user": {"reputation": 1242, "user_id": 3252252, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/4V81y.jpg?s=128&g=1", "display_name": "Jesuspc", "link": "https://stackoverflow.com/users/3252252/jesuspc"}, "edited": false, "score": 1, "creation_date": 1508840864, "post_id": 46864741, "comment_id": 80762879, "body": "You&#39;re welcome!  I will be happy to answer any more questions you have about Opaleye."}], "tags": [], "owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "is_accepted": true, "score": 3, "last_activity_date": 1508598904, "creation_date": 1508598904, "answer_id": 46864741, "question_id": 46853074, "link": "https://stackoverflow.com/questions/46853074/left-join-in-opaleye/46864741#46864741", "title": "Left join in Opaleye", "body": "<p>There are a couple of misunderstandings here.  I produced a full working version below.</p>\n\n<p>Firstly, the return type of the <code>leftJoin</code> is not</p>\n\n<pre><code>Query (ModelAColumn, Maybe ModelBColumn)\n</code></pre>\n\n<p>You have to do</p>\n\n<pre><code>type ModelBNullableColumn = ModelB' (Column (Nullable PGUuid))\n                                    (Column (Nullable PGText))\n</code></pre>\n\n<p>and then use</p>\n\n<pre><code>Query (ModelAColumn, ModelBNullableColumn)\n</code></pre>\n\n<p>Secondly, the return type of the <code>runQuery</code> is not</p>\n\n<pre><code>IO [(ModelA, Maybe ModelB)]\n</code></pre>\n\n<p>You have to do</p>\n\n<pre><code>type ModelBMaybe = ModelB' (Maybe UUID) (Maybe String)\n</code></pre>\n\n<p>and use</p>\n\n<pre><code>IO [(ModelA, ModelBMaybe)]\n</code></pre>\n\n<p>The reason for these differences is that <code>Nullable</code> and <code>Maybe</code> must be applied directly to every column and value in the <code>ModelBColumn</code> and <code>ModelB</code> not to the values as a whole.</p>\n\n<p>(There are also some weird syntax errors like</p>\n\n<pre><code>ModelA { tableColumn \"uuid\", tableColumn \"foreign\" }\n</code></pre>\n\n<p>which means your code has no hope of compiling.  I fixed those, too.)</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n\nimport           Opaleye hiding (table)\nimport qualified Opaleye\nimport Data.Profunctor.Product.TH\nimport Database.PostgreSQL.Simple hiding (Query)\nimport Data.UUID\n\ndata ModelA' a b = ModelA { primA :: a, foreignA :: b }\ntype ModelA = ModelA' UUID (Maybe UUID)\ntype ModelAColumn = ModelA' (Column PGUuid) (Column (Nullable PGUuid))\n\n$(makeAdaptorAndInstance \"pModelA\" ''ModelA')\n\nmodelAtable :: Table ModelAColumn ModelAColumn\nmodelAtable = Opaleye.table \"model_a\" $ pModelA ModelA { primA = tableColumn \"uuid\", foreignA = tableColumn \"foreign\" }\n\ndata ModelB' a b = ModelB { primB :: a, valB :: b }\ntype ModelB = ModelB' UUID String\ntype ModelBMaybe = ModelB' (Maybe UUID) (Maybe String)\ntype ModelBColumn = ModelB' (Column PGUuid) (Column PGText)\ntype ModelBNullableColumn = ModelB' (Column (Nullable PGUuid)) (Column (Nullable PGText))\n\n$(makeAdaptorAndInstance \"pModelB\" ''ModelB')\n\nmodelBtable :: Table ModelBColumn ModelBColumn\nmodelBtable = Opaleye.table \"model_b\" $ pModelB ModelB { primB = tableColumn \"uuid\", valB = tableColumn \"val\" }\n\ndoJoin :: Connection -&gt; IO [(ModelA, ModelBMaybe)]\ndoJoin conn = runQuery conn query\n  where\n    query :: Query (ModelAColumn, ModelBNullableColumn)\n    query = leftJoin (queryTable modelAtable) (queryTable modelBtable) (\\(ma, mb) -&gt; matchNullable (pgBool False) (.== primB mb) (foreignA ma))\n\nmain :: IO ()\nmain = return ()\n</code></pre>\n"}], "owner": {"reputation": 1242, "user_id": 3252252, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/4V81y.jpg?s=128&g=1", "display_name": "Jesuspc", "link": "https://stackoverflow.com/users/3252252/jesuspc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 46864741, "answer_count": 3, "score": 3, "last_activity_date": 1511259825, "creation_date": 1508515628, "last_edit_date": 1511259825, "question_id": 46853074, "link": "https://stackoverflow.com/questions/46853074/left-join-in-opaleye", "title": "Left join in Opaleye", "body": "<p>I have been trying to run a left join using Opaleye in a project but I'm not being able to make the code compile. I start with two \"models\" which represent tables that are associated:</p>\n\n<p>First:</p>\n\n<pre><code>data ModelA' a b = Model { primA :: a, foreignA :: b }\ntype ModelA = ModelA' UUID UUID\ntype ModelAColumn = ModelA' (Column PGUuid) (Column (Nullable PGUuid))\n\n$(makeAdaptorAndInstance \"pModelA\" ''ModelA')\n\ntable :: Table ModelAColumn ModelAColumn\ntable = Opaleye.table \"model_a\" $ pModelA (ModelA (tableColumn \"uuid\") (tableColumn \"foreign\"))\n</code></pre>\n\n<p>And also:</p>\n\n<pre><code>data ModelB' a b = Model { primB :: a, valB :: b }\ntype ModelB = ModelB' UUID String\ntype ModelBColumn = ModelB' (Column PGUuid) (Column PGText)\n\n$(makeAdaptorAndInstance \"pModelB\" ''ModelB')\n\ntable :: Table ModelBColumn ModelBColumn\ntable = Opaleye.table \"model_b\" $ pModelB (ModelB (tableColumn \"uuid\") (tableColumn \"val\"))\n</code></pre>\n\n<p>As the types reflect, <strong>ModelA</strong> can have no <strong>ModelB</strong> associated.</p>\n\n<p>I need a query to obtain pairs of <strong>(ModelA, Maybe ModelB)</strong> given by the left join between the tables on foreignA == primB. I was expecting it to look like:</p>\n\n<pre><code>doJoin :: Connection -&gt; IO [(ModelA, Maybe ModelB)]\ndoJoin conn = runQuery conn query\n  where\n    query :: Query (ModelAColumn, Maybe ModelBColumn)\n    query = leftJoin (queryTable ModelA.table) (queryTable ModelB.table) (\\(ma, mb) -&gt; foreignA ma .== primB mb)\n</code></pre>\n\n<p>But this does not work. I've also tried multiple variants, in particular I replaced the type signature in query to explicitly state the nullability of the columns at the right:</p>\n\n<pre><code>query :: Query (ModelAColumn, (Column (Nullable PGUuid), Column (Nullable PGText))\n</code></pre>\n\n<p>But this fails with:</p>\n\n<blockquote>\n  <p>No instance for Data.Profunctor.Product.Default.Class.Default\n  Opaleye.Internal.Join.NullMaker ModelBColumn (Column (Nullable\n  PGUuid), Column (Nullable PGText).</p>\n</blockquote>\n\n<p>How can I make this query in Opaleye?</p>\n"}, {"tags": ["haskell", "servant"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 8, "last_activity_date": 1508501437, "creation_date": 1508501437, "answer_id": 46848786, "question_id": 46848570, "link": "https://stackoverflow.com/questions/46848570/understanding-why-mvar-isnt-updating/46848786#46848786", "title": "Understanding Why MVar Isn&#39;t Updating?", "body": "<p>This looks wrong:</p>\n\n<pre><code>server :: IO (MVar (Map TinyUrl String)) -&gt; Server API\nserver ioMap = ...\n</code></pre>\n\n<p><code>ioMap</code> above is an IO action that, in your case, will create a new <code>MVar</code> every time it is used. Your get/put methods generate their own map every time, and throw it away!</p>\n\n<p>You want something like:</p>\n\n<pre><code>server :: MVar (Map TinyUrl String) -&gt; Server API\nserver map = ...\n\napp :: MVar (Map TinyUrl String) -&gt; Application\napp map = serve tinyUrlAPI (server map)\n\nmain :: IO ()\nmain = do\n  map &lt;- newMVar $ Data.Map.empty -- run this only once\n  run 8081 $ app map\n</code></pre>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 46848786, "answer_count": 1, "score": 1, "last_activity_date": 1508501437, "creation_date": 1508500557, "question_id": 46848570, "link": "https://stackoverflow.com/questions/46848570/understanding-why-mvar-isnt-updating", "title": "Understanding Why MVar Isn&#39;t Updating?", "body": "<p>Given the following \"TinyUrl\" web app:</p>\n\n<pre><code>import Prelude ()\nimport Prelude.Compat\nimport Data.Aeson.Types\nimport GHC.Generics\nimport Lucid\nimport Network.Wai\nimport Network.Wai.Handler.Warp\nimport Servant\nimport Servant.HTML.Lucid\nimport Control.Concurrent.MVar\nimport Data.Map\nimport Control.Monad.Except\n\ntype API = \"tinyUrl\" :&gt; ValueAPI\n\ntype ValueAPI = Capture \"value\" String :&gt; (\n                       Get '[JSON] ResolvedTinyUrl\n                  :&lt;|&gt; ReqBody '[JSON] UpdatedTinyUrl :&gt; PutNoContent '[JSON] NoContent\n        )\n\nnewtype TinyUrl = TinyUrl String deriving (Generic, Ord, Eq, Show)\n\ninstance ToJSON TinyUrl\n\nnewtype ResolvedTinyUrl = ResolvedTinyUrl { value :: TinyUrl } deriving Generic\n\ndata UpdatedTinyUrl = UpdatedTinyUrl\n  { v :: String } deriving Generic\n\ninstance ToJSON ResolvedTinyUrl\n\ninstance FromJSON UpdatedTinyUrl\n\nnewtype ResolvedUrls = ResolvedUrls (MVar (Map TinyUrl String))\n\ntinyUrlAPI :: Proxy API\ntinyUrlAPI = Proxy\n\nserver :: IO (MVar (Map TinyUrl String)) -&gt; Server API\nserver ioMap = tinyUrlOperations\n\n  where tinyUrlOperations v =\n          get v :&lt;|&gt; put v\n\n          where get :: String -&gt; Handler ResolvedTinyUrl\n                get s = Handler $ do\n                  map    &lt;- lift $ ioMap\n                  m      &lt;- lift $ readMVar map\n                  _      &lt;- lift $ putStrLn (\"m \" ++ show m)\n                  found  &lt;- lift $ return $ Data.Map.lookup (TinyUrl s) m\n                  case found of\n                     Just a  -&gt; return $ ResolvedTinyUrl (TinyUrl a)\n                     Nothing -&gt; (lift $ putStrLn (\"did not find \" ++ s)) &gt;&gt; throwError err404\n\n                put :: String -&gt; UpdatedTinyUrl -&gt; Handler NoContent\n                put key (UpdatedTinyUrl value) = Handler $ do\n                 map     &lt;- lift $ ioMap\n                 m       &lt;- lift $ takeMVar map\n                 updated &lt;- lift $ return $ Data.Map.insert (TinyUrl key) value m\n                 _       &lt;- lift $ putStrLn $ \"updated:\" ++ (show updated)\n                 _       &lt;- lift $ putMVar map updated\n                 return NoContent\n\n\napp :: IO (MVar (Map TinyUrl String)) -&gt; Application\napp map = serve tinyUrlAPI (server map)\n\nmain :: IO ()\nmain = run 8081 $ app (newMVar $ Data.Map.empty)\n</code></pre>\n\n<p>After starting the app locally, I don't understand why my <code>PUT</code> doesn't actually update the <code>MVar Map</code>.</p>\n\n<pre><code>$curl -i -X PUT -H \"Content-Type: application/json\" -d '{\"v\" : \"bar\"}'  \\\n     localhost:8081/tinyUrl/foo\nHTTP/1.1 204 No Content\nDate: Fri, 20 Oct 2017 11:52:41 GMT\nServer: Warp/3.2.13\nContent-Type: application/json;charset=utf-8\n\n$curl -i localhost:8081/tinyUrl/foo\nHTTP/1.1 404 Not Found\nTransfer-Encoding: chunked\nDate: Fri, 20 Oct 2017 11:52:46 GMT\nServer: Warp/3.2.13\n</code></pre>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1508496989, "post_id": 46846722, "comment_id": 80642584, "body": "You might find this a bit easier with an adjustment to the problem. Rather than returning a whole JSON blob which has been filtered, try returning the two pieces: <code>data Result = Result { path :: [String], piece :: Value }</code>. You can then straightforwardly rebuild a whole JSON value from that."}], "answers": [{"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 1, "last_activity_date": 1508577779, "last_edit_date": 1508577779, "creation_date": 1508535374, "answer_id": 46857667, "question_id": 46846722, "link": "https://stackoverflow.com/questions/46846722/traverse-rewrite-a-json-value/46857667#46857667", "title": "Traverse/Rewrite a JSON Value", "body": "<p>Following Benjamin Hodgson's idea of having a separate data type for paths, here's a possible solution which uses <em>lens-aeson</em> and <code>Control.Lens.Plated</code>:</p>\n\n<pre><code>import Control.Lens\nimport Control.Lens.Plated (para)\nimport Data.Foldable (asum)\nimport Data.Aeson\nimport qualified Data.Aeson.Lens\nimport Data.Text (Text)\n\ndata JsonPathPiece = Key Text | Index Int deriving Show\n\ndata JsonPath = JsonPath [JsonPathPiece] Value deriving Show\n\npath :: Text -&gt; Value -&gt; Maybe JsonPath\npath key = para go\n    where\n    go :: Value -&gt; [Maybe JsonPath] -&gt; Maybe JsonPath\n    go v previous = case v of\n        Object o  -&gt; asum $ keyFound o : zipIntoMaybes Key o previous\n        Array as  -&gt; asum $ zipIntoMaybes Index as previous\n        _         -&gt; Nothing\n    keyFound = preview (ix key.to (JsonPath [Key key]))\n    zipIntoMaybes makePiece as mbs =\n        zipWith fmap (toListOf (ifolded.asIndex.to makePiece.to addPiece) as) mbs\n    addPiece piece (JsonPath pieces v) = JsonPath (piece:pieces) v\n</code></pre>\n\n<p><a href=\"http://hackage.haskell.org/package/lens-4.15.4/docs/Control-Lens-Plated.html#v:para\" rel=\"nofollow noreferrer\"><code>para</code></a> is a paramorphism that \"destroys\" a <code>Value</code> starting form the leaves. When processing each node, we have access to the results obtained for its children.</p>\n\n<p><a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Foldable.html#v:asum\" rel=\"nofollow noreferrer\"><code>asum</code></a> for <code>Maybe</code>returns the first <code>Just</code> from the left.</p>\n\n<p><a href=\"http://hackage.haskell.org/package/lens-4.15.4/docs/Control-Lens-Indexed.html#v:ifolded\" rel=\"nofollow noreferrer\"><code>ifolded.asIndex</code></a> produces the list of keys of a map, or the list of integer indices for a vector. They are matched one for one with the results for the children of the current node.</p>\n"}], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 46857667, "answer_count": 1, "score": 0, "last_activity_date": 1508577779, "creation_date": 1508493648, "question_id": 46846722, "link": "https://stackoverflow.com/questions/46846722/traverse-rewrite-a-json-value", "title": "Traverse/Rewrite a JSON Value", "body": "<p>I have the following json-data</p>\n\n<pre><code>value :: Maybe Value\nvalue = decode\n    \"{ \\\"import\\\"  : { \\\"starttime\\\": \\\"2017-02-20T18:45:456.45645\\\" \\\n                   \\ , \\\"endtime\\\"  : \\\"2017-02-20T18:45:456.45645\\\" \\\n                   \\ } \\\n   \\ , \\\"export\\\"  : { \\\"starttime\\\": \\\"2017-02-20T18:45:456.45645\\\" \\\n                   \\ , \\\"endtime\\\"  : \\\"2017-02-20T18:45:456.45645\\\" \\\n                   \\ } \\\n   \\ , \\\"cleanup\\\" : { \\\"starttime\\\": \\\"2017-02-20T18:45:456.45645\\\" \\\n                   \\ , \\\"endtime\\\"  : \\\"2017-02-20T18:45:456.45645\\\" \\\n                   \\ , \\\"errormsg\\\" : \\\"It is dead Jim!\\\" \\\n                   \\ } \\\n   \\ }\"\n</code></pre>\n\n<p>and my goal would be to rewrite this object such that it only contains the \"direct path\" to a given key - e.g. if I search for \"errormsg\" it should only be </p>\n\n<pre><code>Just \"{\\\"cleanup\\\":\\\"It is dead Jim!\\\"}\"\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Just \"{\\\"cleanup\\\": {\\\"errormsg\\\":\\\"It is dead Jim!\\\"}}\"\n</code></pre>\n\n<p>and <code>Nothing</code> in the case where the key is not present, my knowledge about Prisms and Traversals is still in the stage of development so the only thing I managed to do is:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack runhaskell --package=lens --package=aeson --package=lens-aeson-lens --package=bytestring\n{-# LANGUAGE OverloadedStrings #-}\nmodule Main where\n\nimport Control.Lens\nimport Data.Aeson\nimport Data.Foldable\nimport Data.Aeson.Lens\nimport Data.Maybe\nimport qualified Data.ByteString.Lazy.Char8 as B\n\nvalue :: Maybe Value\nvalue = decode\n    \"{ \\\"import\\\"  : { \\\"starttime\\\": \\\"2017-02-20T18:45:456.45645\\\" \\\n                   \\ , \\\"endtime\\\"  : \\\"2017-02-20T18:45:456.45645\\\" \\\n                   \\ } \\\n   \\ , \\\"export\\\"  : { \\\"starttime\\\": \\\"2017-02-20T18:45:456.45645\\\" \\\n                   \\ , \\\"endtime\\\"  : \\\"2017-02-20T18:45:456.45645\\\" \\\n                   \\ } \\\n   \\ , \\\"cleanup\\\" : { \\\"starttime\\\": \\\"2017-02-20T18:45:456.45645\\\" \\\n                   \\ , \\\"endtime\\\"  : \\\"2017-02-20T18:45:456.45645\\\" \\\n                   \\ , \\\"errormsg\\\" : \\\"It is dead Jim!\\\" \\\n                   \\ } \\\n   \\ }\"\n\nmain :: IO ()\nmain = do\n  traverse_ (traverse (B.putStrLn . encode))\n            [ value &amp; _Just . members %~ fromMaybe Null . preview (key \"errormsg\")\n            , value &amp; _Just . members %~ fromMaybe Null . preview (key \"not here\")\n            ]\n</code></pre>\n\n<p>which yields</p>\n\n<pre><code>{\"export\":null,\"cleanup\":\"It is dead Jim!\",\"import\":null}\n{\"export\":null,\"cleanup\":null,\"import\":null}\n</code></pre>\n"}, {"tags": ["haskell", "web-applications", "latex", "spell-checking"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1508493563, "post_id": 46845340, "comment_id": 80640834, "body": "Well, something like <a href=\"http://hackage.haskell.org/package/darcs-2.12.5/docs/Darcs-Patch.html\" rel=\"nofollow noreferrer\">Darcs&#39; data structures</a> would probably work well. But, I wonder whether your whole approach really makes sense... \u201cremove formatting, run spell-checker on single block of plaintext, re-inject formatting\u201d? Sounds quite hackish to me. What&#39;s wrong with just running the checker on individual chunks of plaintext that are there anyway?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1508493818, "post_id": 46845340, "comment_id": 80640953, "body": "And, yes, this question is too broad for StackOverflow..."}, {"owner": {"reputation": 3240, "user_id": 3031069, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/99963eedbe0698475d7443bf95edb43e?s=128&d=identicon&r=PG&f=1", "display_name": "choeger", "link": "https://stackoverflow.com/users/3031069/choeger"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1508496348, "post_id": 46845340, "comment_id": 80642265, "body": "Well, a grammar checker needs whole sentences. And sentences are often interrupted by formatting."}], "answers": [{"tags": [], "owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "is_accepted": false, "score": 0, "last_activity_date": 1508531743, "creation_date": 1508531743, "answer_id": 46856949, "question_id": 46845340, "link": "https://stackoverflow.com/questions/46845340/data-structure-for-a-grammar-checker-for-latex-sources/46856949#46856949", "title": "Data structure for a grammar checker for LaTeX sources", "body": "<p>Instead of removing and then adding the text formatting, you could parse the souce text into a stream of annotated tokens:</p>\n\n<pre><code>data AnnotatedChar = AC\n    { char       :: Char\n    , formatting :: String\n    }\n</code></pre>\n\n<p>The following source:</p>\n\n<pre><code>Is \\emph{good}.\n</code></pre>\n\n<p>would be parsed as:</p>\n\n<pre><code>[AC 'I' \"\", AC 's' \"\", AC ' ' \"\\emph{\", AC 'g' \"\", ...\n</code></pre>\n\n<p>Then, extract only the <code>char</code>s from this list, send them to Grammarly, and get back the result. Now, diff the list of annotated characters with the list of characters you got from Grammarly. This way, you only to deal with a list of characters, but keep the annotations.</p>\n"}], "owner": {"reputation": 3240, "user_id": 3031069, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/99963eedbe0698475d7443bf95edb43e?s=128&d=identicon&r=PG&f=1", "display_name": "choeger", "link": "https://stackoverflow.com/users/3031069/choeger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 289, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508531743, "creation_date": 1508488817, "last_edit_date": 1508496360, "question_id": 46845340, "link": "https://stackoverflow.com/questions/46845340/data-structure-for-a-grammar-checker-for-latex-sources", "title": "Data structure for a grammar checker for LaTeX sources", "body": "<p>Let me start with acknowledging that this is a rather broad question, but I need to start somewhere and reduce the design space a bit.</p>\n\n<p><strong>The problem</strong></p>\n\n<p>Grammarly is an online app that provides grammar and spell-checking as a browser plugin. Currently, there neither exists support for text editors nor latex sources. Grammarly is apparently often confused when forced to deal with annotated text or text that is formatted (e.g.  contains wrapped lines). I guess many people could use that tool when writing up scientific papers or pretty much any other LaTeX tool. I also presume that other solutions exist or will soon pop up that work similarly.</p>\n\n<p><strong>The solution</strong></p>\n\n<p>In principle, it is not necessary to support Grammarly directly in, e.g., emacs. It suffices to provide a convenient interface to check multiple source files at once. To that end, a simple web app could walk through a directory, read all .tex sources, remove all formatting and markup, and expose the files as an HTML document. The user could open that document, run Grammarly, and apply any fixes. The app would have to take the corrected text and reapply formatting, markdown, etc. to save the now fixed source file. </p>\n\n<p><strong>The question(s)</strong></p>\n\n<p>While it is reasonably simple to create such a web application, there are other requirements to be considered: LaTeX parsing (up to \"standard\" syntax) and a library like HaTeX could deal with parsing and interpretation. But the process of editing needs some thought. Presuming that the removal of formatting can be implemented by only deleting content, it should be possible to take a correction as a diff and reapply it to the formatted document. </p>\n\n<p>In Haskell, is there a data structure for text editing that supports this use case. That is, a representation of text that can store deletions, find diffs, undo deletions, and move a diff accordingly? If not in Haskell, does something like this exist somewhere else?</p>\n\n<p>Bonus question 2: What is the simplest (as in loc required) web framework in Haskell to set up such a web app? It would serve one HTML document and accept updated versions of the text files. No database is required.</p>\n"}, {"tags": ["rest", "haskell", "routes", "scotty"], "answers": [{"comments": [{"owner": {"reputation": 773, "user_id": 5476912, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/sMjhL.jpg?s=128&g=1", "display_name": "ColdHands", "link": "https://stackoverflow.com/users/5476912/coldhands"}, "edited": false, "score": 0, "creation_date": 1508504407, "post_id": 46847068, "comment_id": 80646473, "body": "but <code>get &quot;&#47;:word&quot;</code> will return &#39;file not found&#39; when the second param is provieded with something like <code>http:&#47;&#47;hostip.com&#47;:word&#47;:second_param</code>. And i need to get &quot; * &quot;. I know haskell and scotty in particular supports regex in its RoutePatterns, but don&#39;t know how regex, socotty regex works and how it translates form String to RoutePattern type"}], "tags": [], "owner": {"reputation": 412, "user_id": 6593641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xVNVQ.jpg?s=128&g=1", "display_name": "madnight", "link": "https://stackoverflow.com/users/6593641/madnight"}, "is_accepted": false, "score": 0, "last_activity_date": 1508494785, "creation_date": 1508494785, "answer_id": 46847068, "question_id": 46844886, "link": "https://stackoverflow.com/questions/46844886/how-to-match-all-requests-catch-all-with-haskell-scotty/46847068#46847068", "title": "How to match all requests (catch all) with Haskell Scotty?", "body": "<p>Same as in the provided example:\n<a href=\"https://github.com/scotty-web/scotty\" rel=\"nofollow noreferrer\">https://github.com/scotty-web/scotty</a></p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Web.Scotty\nimport Data.Monoid (mconcat)\n\nmain = scotty 3000 $\n    get \"/:word\" $ do\n        file \"./index.html\"\n</code></pre>\n"}], "owner": {"reputation": 773, "user_id": 5476912, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/sMjhL.jpg?s=128&g=1", "display_name": "ColdHands", "link": "https://stackoverflow.com/users/5476912/coldhands"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592089169, "creation_date": 1508487062, "last_edit_date": 1592089169, "question_id": 46844886, "link": "https://stackoverflow.com/questions/46844886/how-to-match-all-requests-catch-all-with-haskell-scotty", "title": "How to match all requests (catch all) with Haskell Scotty?", "body": "<p>I have a simple server</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Web.Scotty\nimport Data.Text\nimport Data.Monoid (mconcat)\n\nserver :: ScottyM ()\nserver = do\n  get \"/\" $ file \"./index.html\"\n</code></pre>\n\n<p>And i want to serve <code>index.html</code> on all the routes eg. <code>get \"*\" $ file \"./index.html\"</code>, but that doesn't work. How to achieve that?</p>\n"}, {"tags": ["haskell", "opaleye"], "answers": [{"tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": true, "score": 4, "last_activity_date": 1508469002, "creation_date": 1508469002, "answer_id": 46841858, "question_id": 46840086, "link": "https://stackoverflow.com/questions/46840086/can-haskells-opaleye-dsl-generate-any-given-sql/46841858#46841858", "title": "Can Haskell&#39;s Opaleye DSL generate any given SQL?", "body": "<p>According to <a href=\"https://github.com/tomjaguarpaw/haskell-opaleye/blob/35de12d5736bf785ae7fc687055ea4450fd9ded7/Doc/Tutorial/TutorialBasic.lhs#L41-L43\" rel=\"nofollow noreferrer\">the Opaleye tutorial</a>, creating tables and databases is currently unsupported:</p>\n\n<blockquote>\n  <p>Opaleye assumes that a Postgres database already exists.  Currently\n  there is no support for creating databases or tables, though these\n  features may be added later according to demand.</p>\n</blockquote>\n"}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 46841858, "answer_count": 1, "score": 0, "last_activity_date": 1508548913, "creation_date": 1508453961, "last_edit_date": 1508548913, "question_id": 46840086, "link": "https://stackoverflow.com/questions/46840086/can-haskells-opaleye-dsl-generate-any-given-sql", "title": "Can Haskell&#39;s Opaleye DSL generate any given SQL?", "body": "<p>My team uses <code>Opaleye</code> to query <code>Postgres</code> from <code>Haskell</code>.</p>\n\n<p>However, we also use raw <code>SQL</code> to do such things as:</p>\n\n<ul>\n<li><p>Initialize the database. Including commands <code>create database</code> and <code>create table</code></p></li>\n<li><p>Perform database migrations when we change our schema, including varied commands.</p></li>\n</ul>\n\n<p><strong>Is it possible to entirely replace this raw <code>SQL</code> code with <code>Opaleye</code>?</strong></p>\n\n<p>Can <code>Opaleye</code> replace any <code>SQL</code>?</p>\n"}, {"tags": ["haskell", "threepenny-gui"], "comments": [{"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 1, "creation_date": 1508443464, "post_id": 46836842, "comment_id": 80623674, "body": "I&#39;m not aware of any browser feature that exposes the full file path. I think even the <code>FileList</code>/<code>FileReader</code> API abstracts that away. My thought would be to implement a file chooser UI, interacting with the directory structure from the server since it&#39;s local (I believe?) and navigating the tree in the browser."}], "answers": [{"tags": [], "owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "is_accepted": true, "score": 1, "last_activity_date": 1509480882, "creation_date": 1509480882, "answer_id": 47043828, "question_id": 46836842, "link": "https://stackoverflow.com/questions/46836842/threepenny-gui-get-file-path-via-file-input/47043828#47043828", "title": "Threepenny-gui: get file path via &#39;file&#39; input", "body": "<p>As far as I know, web browsers do not allow you to obtain a filepath via the  fields, for reasons of security. You can only obtain the file contents. Of course, you can always ask for a filepath in a plaintext input field, but that is certainly less convenient for the user.</p>\n\n<p>Filepaths can be obtained from a file chooser dialog if you <a href=\"https://github.com/HeinrichApfelmus/threepenny-gui/blob/master/doc/electron.md\" rel=\"nofollow noreferrer\">combine Threepenny with the Electron framework</a>. Working with files is one of the reasons for using Electron.</p>\n"}], "owner": {"reputation": 107, "user_id": 2296133, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bdf9c39adeda0dad75919f40df4dbb4e?s=128&d=identicon&r=PG", "display_name": "Triostrong", "link": "https://stackoverflow.com/users/2296133/triostrong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 47043828, "answer_count": 1, "score": 1, "last_activity_date": 1509480882, "creation_date": 1508438873, "question_id": 46836842, "link": "https://stackoverflow.com/questions/46836842/threepenny-gui-get-file-path-via-file-input", "title": "Threepenny-gui: get file path via &#39;file&#39; input", "body": "<p>I am going to write simple frontend for my console tool. Generally, it takes a few parameters and input file path for further opening and processing.\nMy idea was to place something like  </p>\n\n<pre><code> UI.input # set (attr \"type\") \"file\" # set UI.text \"input filename\"\n</code></pre>\n\n<p>And then get the selected file path via 'value'.\nBut it appears that due to security reasons browsers do not provide full path to selected file.<br>\nIs it possible to place any file chooser with threepenny-gui?</p>\n"}, {"tags": ["haskell", "emacs"], "comments": [{"owner": {"reputation": 47278, "user_id": 18627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b31b9d123bff80f00317a1df0dd00e2?s=128&d=identicon&r=PG", "display_name": "Alex Ott", "link": "https://stackoverflow.com/users/18627/alex-ott"}, "edited": false, "score": 1, "creation_date": 1508440045, "post_id": 46836624, "comment_id": 80621818, "body": "What version of GHC? It could be related to this bug: <a href=\"https://github.com/haskell/haskell-mode/issues/1553\" rel=\"nofollow noreferrer\">github.com/haskell/haskell-mode/issues/1553</a>"}, {"owner": {"reputation": 71, "user_id": 3679331, "user_type": "registered", "profile_image": "https://graph.facebook.com/521210191/picture?type=large", "display_name": "ricardos", "link": "https://stackoverflow.com/users/3679331/ricardos"}, "reply_to_user": {"reputation": 47278, "user_id": 18627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b31b9d123bff80f00317a1df0dd00e2?s=128&d=identicon&r=PG", "display_name": "Alex Ott", "link": "https://stackoverflow.com/users/18627/alex-ott"}, "edited": false, "score": 0, "creation_date": 1508441038, "post_id": 46836624, "comment_id": 80622298, "body": "Exactly that version - 8.2.1"}], "owner": {"reputation": 71, "user_id": 3679331, "user_type": "registered", "profile_image": "https://graph.facebook.com/521210191/picture?type=large", "display_name": "ricardos", "link": "https://stackoverflow.com/users/3679331/ricardos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 381, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1508437945, "creation_date": 1508437945, "question_id": 46836624, "link": "https://stackoverflow.com/questions/46836624/how-to-switch-to-haskell-interactive-and-reload-last-line-in-emacs", "title": "How to switch to Haskell Interactive and reload last line in emacs?", "body": "<p>Is there a command available to load the the current buffer to the haskell process and execute the previous line I introduced in the ghci?\nI am trying to make a function for this, but I get \"Unexpected response from haskell process.\" because of this line: haskell-interactive-mode-history-previous</p>\n\n<pre><code> (defun reload-haskell-last-line () (interactive)\n  \"blablabla\"\n  (haskell-process-load-file)\n  (haskell-interactive-switch)\n  (haskell-interactive-mode-history-previous)\n  (haskell-interactive-mode-return)\n  )\n</code></pre>\n\n<p>This can be super handy for developing.\nIf this is not the right way, what do you usually use?\nAtom haskell-ide repl has a similar feature, that I would like to replicate in emacs</p>\n"}, {"tags": ["eclipse", "haskell"], "owner": {"reputation": 11, "user_id": 8802883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f3a7a3835fc3610dd592815f651bd2?s=128&d=identicon&r=PG&f=1", "display_name": "Krystian \u017byci\u0144ski", "link": "https://stackoverflow.com/users/8802883/krystian-%c5%bbyci%c5%84ski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1508437981, "creation_date": 1508437209, "last_edit_date": 1508437981, "question_id": 46836443, "link": "https://stackoverflow.com/questions/46836443/opening-wizard-selected-wizard-could-not-be-started", "title": "Opening Wizard: Selected wizard could not be started", "body": "<p>I've got an error while trying to start Haskell project in Eclipse.</p>\n\n<p>Here are error details:</p>\n\n<pre><code>The selected wizard could not be started.\n\nPlug-in net.sf.eclipsefp.haskell.ui was unable to load class net.sf.eclipsefp.haskell.ui.wizards.NewHaskellProjectWizard.\nAn error occurred while automatically activating bundle net.sf.eclipsefp.haskell.ui (504).\n</code></pre>\n\n<p>Any ideas what can i do to fix it?</p>\n"}, {"tags": ["parsing", "haskell", "parsec"], "comments": [{"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1508437804, "post_id": 46836435, "comment_id": 80620731, "body": "I don&#39;t think you can compose <code>Parser</code>s that way since they would both be reading from the underlying stream. I think you may be better defining each as <code>String -&gt; String</code>, and when you have a <code>Parser String</code> you&#39;d like to normalize you could <code>fmap (normalizeWS . normalizeCase)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1508446380, "post_id": 46837308, "comment_id": 80625160, "body": "This will not compose well: <code>feeds p1 p2 &gt;&gt; p3</code> does not behave like &quot;consume what <code>p1</code> consumes, pass the result of that consumption to <code>p2</code>, then parse the remaining unconsumed input as <code>p3</code> would&quot;. And it is not easy to fix it to work that way, either, sadly; certainly the most obvious <code>getInput</code>/<code>setInput</code> gymnastics for fixing this particular case just makes the bug more subtle rather than actually working in all cases."}], "tags": [], "owner": {"reputation": 1795, "user_id": 1839343, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b26d97dd045ce61904e7c6d1a9775e0c?s=128&d=identicon&r=PG", "display_name": "jules", "link": "https://stackoverflow.com/users/1839343/jules"}, "is_accepted": false, "score": 1, "last_activity_date": 1508440719, "creation_date": 1508440719, "answer_id": 46837308, "question_id": 46836435, "link": "https://stackoverflow.com/questions/46836435/parsec-feeding-output-of-one-parser-to-another/46837308#46837308", "title": "parsec: feeding output of one parser to another", "body": "<p>I solved the problem using this approach ... maybe there is a more elegant way</p>\n\n<pre><code>preprocessor :: Parser String\npreprocessor = normalizeCase `feeds` expandKettensatz `feeds` normalizeWs\n\nfeeds :: Parser String -&gt; Parser String -&gt; Parser String\nfeeds p1 p2 = do\n  s &lt;- p1\n  setInput s\n  p2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": false, "score": 0, "last_activity_date": 1508440892, "creation_date": 1508440892, "answer_id": 46837356, "question_id": 46836435, "link": "https://stackoverflow.com/questions/46836435/parsec-feeding-output-of-one-parser-to-another/46837356#46837356", "title": "parsec: feeding output of one parser to another", "body": "<p>If you have functions like</p>\n\n<pre><code>normalizeWhitespace :: Stream s m Char =&gt; ParsecT s u m String\nnormalizeCase :: Stream s m Char =&gt; Set String -&gt; Parsec s u m String\n</code></pre>\n\n<p>You could chain them together using <code>runParser</code> and <code>&gt;&gt;=</code>:</p>\n\n<pre><code>runBoth :: Stream s Identity Char =&gt; Set String -&gt; SourceName -&gt; s -&gt; Either ParseError String\nrunBoth wordSet src input = do\n  input &lt;- runParser normalizeWhitespace () src input\n  runParser (normalizeCase wordSet) () src input\n</code></pre>\n\n<p>But this doesn't give you a parser that you can chain together with other parsers. </p>\n\n<p>This isn't terribly surprising, as parser composition in Parsec is all about\ncomposing parsers that operate on the same stream, whereas these operate on\ndifferent streams.</p>\n\n<p>Having multiple different streams is pretty common too - using the output of <a href=\"https://stackoverflow.com/a/380487/9859\">a tokenization or lexing\npass as input to parsing</a> can make the process easier\nto understand, but <a href=\"https://stackoverflow.com/questions/15216202/should-i-use-a-lexer-when-using-a-parser-combinator-library-like-parsec\">Parsec is a little easier to use out of the box as a direct parser (without\nlexing/tokenization)</a>.</p>\n"}], "owner": {"reputation": 1795, "user_id": 1839343, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b26d97dd045ce61904e7c6d1a9775e0c?s=128&d=identicon&r=PG", "display_name": "jules", "link": "https://stackoverflow.com/users/1839343/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "closed_date": 1508446260, "answer_count": 2, "score": 2, "last_activity_date": 1508440892, "creation_date": 1508437183, "question_id": 46836435, "link": "https://stackoverflow.com/questions/46836435/parsec-feeding-output-of-one-parser-to-another", "closed_reason": "Duplicate", "title": "parsec: feeding output of one parser to another", "body": "<p>I use (abuse) parsers to do some string transformation e.g. <code>normalizeWS :: Parser String</code> removes duplicate whitespace and <code>normalizeCase</code> maps specific strings to lower case. I use parsers because the input data has some structure for example literate strings have to be left untransformed. Is there an elegant way to feed the output of one parser as input to the next and thus form a transformation pipeline? Something in the vein of <code>normalizeWS . normalizeCase</code> (which of course doesnt work)?</p>\n\n<p>Many thanks in advance!</p>\n"}, {"tags": ["haskell", "cabal", "cabal-install", "ghc-pkg"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1508535410, "last_edit_date": 1508535410, "creation_date": 1508446007, "answer_id": 46838635, "question_id": 46835003, "link": "https://stackoverflow.com/questions/46835003/using-ghc-pkg-list-and-cabal-list-installed-give-different-lists/46838635#46838635", "title": "Using ghc-pkg list and cabal list --installed give different lists", "body": "<p>Two hypotheses spring to mind:</p>\n\n<ol>\n<li><p><code>cabal</code> is choosing a different version of <code>ghc</code> and its attending toolsuite than your shell is. You can check for this discrepancy by running these two commands:</p>\n\n<pre><code>cabal exec -- ghc --version\nghc --version\n</code></pre>\n\n<p>Do they say the same thing? If so, reject this hypothesis. Otherwise you should decide whether you like the shell's choice or cabal's choice better (I recommend preferring your shell's choice).</p>\n\n<p>If you like <code>cabal</code>'s choice better, you can use a specific version of GHC (and other GHC tools) by appending <code>-&lt;version&gt;</code> to the command; e.g. try <code>ghc-pkg-7.10.3 list</code> to see what is in the package database for version 7.10.3, or <code>ghci-7.10.3</code> to run a specific version of the REPL. You can make these changes permanent by adding symlinks or similar to your <code>PATH</code>.</p>\n\n<p>If you like your shell's choice better, you can ask <code>cabal</code> to use that version with <code>cabal configure -w ghc</code>; or if you are worried that <code>cabal</code> and your shell will resolve <code>ghc</code> differently, you could ask for a specific version with <code>cabal configure -w ghc-7.10.3</code> or similar.</p></li>\n<li><p>Your shell agrees with <code>cabal</code> about what version of GHC to use, but you are in a cabal sandbox. <code>cabal list --installed</code> is telling you what's installed in the sandbox, but <code>ghc-pkg list</code> is telling you what's installed in your user package database. You can check for discrepancies between these two commands:</p>\n\n<pre><code>cabal exec -- ghc-pkg list numbers\nghc-pkg list numbers\n</code></pre>\n\n<p>(If you have a newish cabal -- not sure which version this appeared in -- you could also try <code>cabal hc-pkg list</code> instead of <code>cabal exec -- ghc-pkg list</code>. This is likely to be the more forward-compatible way, so a good habit to develop.)</p>\n\n<p>If these print the same things, reject this hypothesis. Otherwise you should decide whether you want to continue using a sandbox or not (I recommend continuing to use a sandbox).</p>\n\n<p>If you want to stop using a sandbox, you can pass <code>--ignore-sandbox</code> to <code>cabal</code>. To make this permanent, look in the <code>cabal.sandbox.config</code> file, which will contain a pointer to the actual sandbox (usually <code>.cabal.sandbox</code>). Delete both the config and the sandbox. You can also globally ignore sandboxes by adding <code>ignore-sandbox: True</code> to your <code>~/.cabal/config</code>, but I strongly recommend against this.</p>\n\n<p>If you want to keep the sandbox, you will need to use <code>cabal exec</code> for all of your GHC toolsuite needs to make sure the correct package database is selected. For example, try <code>cabal exec ghci</code> to run the REPL with access to the sandbox package database.</p></li>\n</ol>\n\n<p>These hypotheses are not mutually exclusive: <em>both</em> may happen. In that case I strongly recommend choosing the final solution (\"use <code>cabal exec</code> for all GHC toolsuite executions\"), as it handles both problems transparently: the standard GHC toolsuite commands will be rewritten to refer to explicitly versioned ones (e.g. <code>cabal exec ghc</code> will actually execute <code>ghc-7.10.3</code>) and the environment will be set up to point at the correct package database.</p>\n"}, {"comments": [{"owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "edited": false, "score": 0, "creation_date": 1508531871, "post_id": 46855500, "comment_id": 80661520, "body": "Note: Do not accidentally delete <code>.cabal&#47;config</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1508534896, "post_id": 46855500, "comment_id": 80662796, "body": "I consider this answer to be the &quot;nuclear option&quot;. I strongly recommend that future readers attempt gentler solutions first; e.g. if  <code>cabal</code> has chosen a different version of GHC than you wanted, you can use <code>cabal configure</code> to select another version (as in <code>cabal configure -w ghc-7.10.3</code>). I&#39;ll edit my answer to include some comments on this solution. Manually deleting cabal sandboxes is okay (currently <code>cabal</code> does not have a way to delete them in a non-manual way), but you should understand why the sandbox exists first and be sure you actually don&#39;t want it..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1508535871, "post_id": 46855500, "comment_id": 80663120, "body": "Oh, and I misread; given the details here, I strongly suspect my other proposed hypothesis (&quot;you are in a cabal sandbox, and <code>cabal list --installed</code> is telling you what&#39;s installed in the sandbox, but <code>ghc-pkg list</code> is telling you what&#39;s installed in your user package database&quot;) was the correct one. <code>cabal configure</code> won&#39;t help with that, but I outline two gentler solutions to this problem in my answer."}], "tags": [], "owner": {"reputation": 11, "user_id": 8802335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e67ef12935927edb4477e565a6cb0eae?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo D.", "link": "https://stackoverflow.com/users/8802335/pablo-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1508525325, "creation_date": 1508525325, "answer_id": 46855500, "question_id": 46835003, "link": "https://stackoverflow.com/questions/46835003/using-ghc-pkg-list-and-cabal-list-installed-give-different-lists/46855500#46855500", "title": "Using ghc-pkg list and cabal list --installed give different lists", "body": "<p>The answer to this </p>\n\n<blockquote>\n  <p>You can check for this discrepancy by running these two commands:</p>\n  \n  <p>cabal exec -- ghc --version\n  ghc --version</p>\n  \n  <p>Do they say the same thing?</p>\n</blockquote>\n\n<p>was yes. I don't remember the second option, but I've managed to solve it myself. What I specifically did was:</p>\n\n<ol>\n<li>run the command \"rm -rf .cabal\" (without commmas) to delete the cabal configuration.</li>\n<li>run \"rm -rf .cabal-sandbox\"</li>\n<li>run \"rm -rf .ghc\"</li>\n<li>cabal new-build cabal (not sure if this helped or not)</li>\n<li>In admin mode (sudo) I edited the cabal config file and changed Ignore Sandbox to True --> <strong>would this give me problems in the future? should I change it back to false? please answer</strong></li>\n<li>Had to delete a cabal.sandbox.config that was giving some troubles</li>\n<li>cabal install cabal-install</li>\n<li>cabal update</li>\n</ol>\n\n<p>Now the ghc-pkg list command and the cabal list --installed show both my installed packages, and they work without problems.</p>\n\n<p>Ps. I gave detailed information from the process in case anyone needs it in the future. Still not sure what caused that cabal and ghc didn't show the same pkgs.</p>\n"}], "owner": {"reputation": 11, "user_id": 8802335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e67ef12935927edb4477e565a6cb0eae?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo D.", "link": "https://stackoverflow.com/users/8802335/pablo-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1062, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1508535410, "creation_date": 1508431787, "last_edit_date": 1508432254, "question_id": 46835003, "link": "https://stackoverflow.com/questions/46835003/using-ghc-pkg-list-and-cabal-list-installed-give-different-lists", "title": "Using ghc-pkg list and cabal list --installed give different lists", "body": "<p>I'm trying to load my .hs file but when I <code>import Data.Numbers.CReal</code>, it gives me the error <code>Failed to load interface for 'Data.Numbers.CReal'</code>. I have runned <code>cabal install numbers</code> and if I <code>cabal list --installed</code> the number pkg appears, but if I <code>ghc-pkg list</code> it doesn't (also if I <code>ghc-pkg check</code>it gives LOTS of haddock warnings). Is it related to my non-loading file? How can I solve this?</p>\n\n<p>Ps. I know how to import packages, but I'm not sure if I am importing this one properly.</p>\n\n<p>Thanks and sorry if I didn't explained myself correctly.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1508431656, "post_id": 46834682, "comment_id": 80617516, "body": "<code>checkPerm</code> must have a return type of <code>[Int]</code>, so why are you saying <code>checkPerm _ () = &quot;&quot;</code> (type <code>[Char]</code>)?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1508433551, "post_id": 46834682, "comment_id": 80618457, "body": "Also, are you sure you want <code>intSumlist _ []</code> to be true? The sum of an empty list is generally considered 0, and you will never actually be calling <code>intSumList</code> on an empty list anyway; just use <code>intSumList x y = x == sum y</code>."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 1, "last_activity_date": 1508433484, "creation_date": 1508433484, "answer_id": 46835467, "question_id": 46834682, "link": "https://stackoverflow.com/questions/46834682/how-can-i-return-a-list-from-list-of-list-haskell/46835467#46835467", "title": "How can I return a list from list of list Haskell", "body": "<p>Your immediate problem is that <code>checkPerm</code> is returning an empty list of type <code>[Char]</code>, not <code>[Int]</code>, when it gets an empty list as its second argument.</p>\n\n<p>However, <code>checkPerm</code> is basically reimplementing <code>Data.List.find</code>.</p>\n\n<pre><code>import qualified Data.List as DL\nimport Data.Maybe\nimport Control.Monad\n\nfind :: (Int,Int,Int,Int) -&gt; [Int]\nfind (x,z,y,s) = fromMaybe [] (DL.find p l)\n                 where makePred x lo hi p = intSumList x (slice lo hi p)\n                       p1 = makePred x 1 5\n                       p2 = makePred z 2 6\n                       p3 = makePred y 4 8\n                       p4 = makePred s 5 9\n                       p = liftM4 (&amp;&amp;) p1 p2 p3 p4\n                       l = DL.permutations [1..9]\n</code></pre>\n\n<p><code>DL.find</code> returns <code>Nothing</code> if no match is found, or <code>Just l</code> for a a matching list <code>l</code>. <code>fromMaybe</code> converts this value to either an empty list or the found list. You might consider leaving the return value of <code>find</code> as <code>Maybe [Int]</code> instead, though.</p>\n"}], "owner": {"reputation": 137, "user_id": 8383476, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/66893da737c29fad8518f5fed5827587?s=128&d=identicon&r=PG&f=1", "display_name": "ProPall", "link": "https://stackoverflow.com/users/8383476/propall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 46835467, "answer_count": 1, "score": 0, "last_activity_date": 1508433484, "creation_date": 1508430586, "last_edit_date": 1508431196, "question_id": 46834682, "link": "https://stackoverflow.com/questions/46834682/how-can-i-return-a-list-from-list-of-list-haskell", "title": "How can I return a list from list of list Haskell", "body": "<p>Basically, I have a function which checks every permutation of <code>[1..9]</code> by several conditions. Plus I have a function which checks if the sum of the list is equal to a number and a function which slice the list. The problem is that it returns an error <code>Couldn't match type 'Int' with 'Char'</code>. It points on the list which function has to return if all conditions are true.\nHere is the code itself :</p>\n\n<pre><code>intSumList :: Int -&gt; [Int] -&gt; Bool\nintSumList _ [] = True\nintSumList x (y:ys)\n                    | x == sum (y:ys) = True\n                    | otherwise =  False\nslice :: Int -&gt; Int -&gt; [Int] -&gt; [Int]\nslice from to s = take (to - from + 1)(drop from s)\n\nfind :: (Int,Int,Int,Int) -&gt; [Int]\nfind (x,z,y,s) = checkPerm (x,z,y,s) l\n                 where\n                   l = L.permutations [1..9]\n                   checkPerm (_,_,_,_ ) [] = \"\"\n                   checkPerm (x,z,y,s) (p:pz)\n                      | intSumList x (slice 1 5 p) &amp;&amp; intSumList z (slice 2 6 p) &amp;&amp; \n                        intSumList y (slice 4 8 p) &amp;&amp; intSumList s (slice 5 9 p) = p\n                      | otherwise = permutations (x,z,y,s) pz\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 3, "creation_date": 1508430521, "post_id": 46834570, "comment_id": 80616866, "body": "What <code>MonadRandom</code> do you want <code>m</code> to be?"}, {"owner": {"reputation": 313, "user_id": 3219382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ABhji.jpg?s=128&g=1", "display_name": "chronologos", "link": "https://stackoverflow.com/users/3219382/chronologos"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1508430755, "post_id": 46834570, "comment_id": 80617004, "body": "I&#39;m new to Haskell and am not sure what it should be. The function injecting randomness in weightedGrid is  getRandomR from Control.Monad.Random if that helps."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1508430902, "post_id": 46834570, "comment_id": 80617082, "body": "Some possible values for <code>m</code> would be <a href=\"http://hackage.haskell.org/package/MonadRandom-0.5.1/docs/Control-Monad-Trans-Random-Lazy.html#t:Rand\" rel=\"nofollow noreferrer\"><code>Rand</code></a> or <code>IO</code>. The compiler doesn&#39;t know which one to use unless you give a type annotation to the result of your call to <code>weightedGrid</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1508434232, "post_id": 46834570, "comment_id": 80618827, "body": "<code>fmap prettyPrint (weightedGrid 10 10)</code> will help, assuming you figure out how to properly specify which specific monad to use to generate the random values."}], "answers": [{"tags": [], "owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "is_accepted": true, "score": 1, "last_activity_date": 1508692473, "creation_date": 1508692473, "answer_id": 46876950, "question_id": 46834570, "link": "https://stackoverflow.com/questions/46834570/making-monad-type-showable/46876950#46876950", "title": "Making Monad type showable", "body": "<p>You will want your pretty printer to have type:</p>\n\n<pre><code>prettyPrint :: WeightedWall -&gt; String\n</code></pre>\n\n<p>Then, you will need to pluck a <code>WeightedWall</code> from your <code>MonadRandom</code> instance, pass it to <code>prettyPrint</code>, and then print the <code>String</code> in the <code>IO</code> monad.</p>\n\n<p>The <code>getRandomR</code> function is a member of the <code>MonadRandom</code> typeclass, so it doesn't tell us which <code>MonadRandom</code> instance you are using.  I'm going to assume <code>IO</code> since it kills two birds with one stone (the random source and the printing).  Your <code>main</code> function could look as follows:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    ww &lt;- weightedGrid 10 10  -- pluck weighted wall from MonadRandom instance IO\n    putStrLn $ prettyPrint ww\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 313, "user_id": 3219382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ABhji.jpg?s=128&g=1", "display_name": "chronologos", "link": "https://stackoverflow.com/users/3219382/chronologos"}, "is_accepted": false, "score": 0, "last_activity_date": 1508949035, "creation_date": 1508949035, "answer_id": 46937639, "question_id": 46834570, "link": "https://stackoverflow.com/questions/46834570/making-monad-type-showable/46937639#46937639", "title": "Making Monad type showable", "body": "<p>I ended up doing:</p>\n\n<pre><code>pp :: WeightedWall -&gt; String\npp (WeightedWall (a, b, c) _) = show a ++ \" \" ++ show b ++ \" \" ++ show c\n\nmain :: IO ()\nmain = do\n  ww &lt;- mapM Data.Graph.Inductive.edgeLabel $ labEdges (weightedGrid 10 10)\n  forM_ (map pp ww) putStrLn\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 3219382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ABhji.jpg?s=128&g=1", "display_name": "chronologos", "link": "https://stackoverflow.com/users/3219382/chronologos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 46876950, "answer_count": 2, "score": 0, "last_activity_date": 1508949035, "creation_date": 1508430164, "question_id": 46834570, "link": "https://stackoverflow.com/questions/46834570/making-monad-type-showable", "title": "Making Monad type showable", "body": "<p>I am making a maze generator and wish to visualize the maze by printing. I have a wall type and a function that generates a random maze of those walls.</p>\n\n<pre><code>import qualified Data.Graph.Inductive as Graph\nimport           Data.Graph.Inductive (Gr, prettyPrint)\ndata WeightedWall = WeightedWall (Int, Int, Int) Orientation deriving (Eq)\nweightedGrid :: MonadRandom m =&gt; Int -&gt; Int -&gt; Gr () (m WeightedWall)\n</code></pre>\n\n<p>However, when I call <code>prettyPrint(weightedGrid 10 10)</code>, I get this error:</p>\n\n<pre><code>  Ambiguous type variable \u2018m0\u2019 arising from a use of \u2018prettyPrint\u2019\n  prevents the constraint \u2018(Show\n                              (m0 WeightedWall))\u2019 from being solved.\n  Probable fix: use a type annotation to specify what \u2018m0\u2019 should be.\n</code></pre>\n\n<p>What am I missing in my code to fix this?</p>\n"}, {"tags": ["haskell", "singleton-type"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1508431036, "post_id": 46834285, "comment_id": 80617150, "body": "Your way is fine - <code>IsString</code> is handled just fine by <code>singletons</code> (at least for me - this code works fine). Note that the inferred type is <code>.. -&gt; String</code> unless you have <code>OverloadedStrings</code> enabled, so if you really want the simple return type, put this code in a module without it. Or, just have <code>cn&#39; :: EventScans -&gt; String; cn&#39; = cn</code> somewhere."}, {"owner": {"reputation": 2087, "user_id": 103377, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b4bc128655739e58e2a52b1c4b37ff41?s=128&d=identicon&r=PG", "display_name": "Ben Ford", "link": "https://stackoverflow.com/users/103377/ben-ford"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1508439957, "post_id": 46834285, "comment_id": 80621779, "body": "@user2407038 I edited to make the question a bit clearer."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1508443955, "post_id": 46834285, "comment_id": 80623938, "body": "The error seems to be telling you to set -XTypeInType. Does that help?"}, {"owner": {"reputation": 2087, "user_id": 103377, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b4bc128655739e58e2a52b1c4b37ff41?s=128&d=identicon&r=PG", "display_name": "Ben Ford", "link": "https://stackoverflow.com/users/103377/ben-ford"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1508447136, "post_id": 46834285, "comment_id": 80625501, "body": "@HTNW unfortunately not :-("}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1508449807, "post_id": 46834285, "comment_id": 80626643, "body": "The code you posted originally, without a type signature on <code>cn</code>, works fine (i.e. leave the type to be inferred)."}, {"owner": {"reputation": 2087, "user_id": 103377, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b4bc128655739e58e2a52b1c4b37ff41?s=128&d=identicon&r=PG", "display_name": "Ben Ford", "link": "https://stackoverflow.com/users/103377/ben-ford"}, "edited": false, "score": 0, "creation_date": 1508482797, "post_id": 46834285, "comment_id": 80635209, "body": "I could leave the type inferred in this case (although I prefer not to). But I&#39;m interested in the underlying problem, and whether there&#39;s a way round it."}], "answers": [{"tags": [], "owner": {"reputation": 2087, "user_id": 103377, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b4bc128655739e58e2a52b1c4b37ff41?s=128&d=identicon&r=PG", "display_name": "Ben Ford", "link": "https://stackoverflow.com/users/103377/ben-ford"}, "is_accepted": false, "score": 0, "last_activity_date": 1508765280, "creation_date": 1508765280, "answer_id": 46890569, "question_id": 46834285, "link": "https://stackoverflow.com/questions/46834285/how-do-i-promote-a-function-that-returns-a-string-with-singletons/46890569#46890569", "title": "How do I promote a function that returns a String with singletons?", "body": "<p>From the related issue I opened on github, this is coming about because <code>IsString</code> doesn't singletonize yet. See <a href=\"https://github.com/goldfirere/singletons/issues/267\" rel=\"nofollow noreferrer\">https://github.com/goldfirere/singletons/issues/267</a> for details.</p>\n"}, {"tags": [], "owner": {"reputation": 1079, "user_id": 2800673, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000382675971/picture?type=large", "display_name": "Jappie Kerk", "link": "https://stackoverflow.com/users/2800673/jappie-kerk"}, "is_accepted": false, "score": 0, "last_activity_date": 1561996437, "creation_date": 1561996437, "answer_id": 56838716, "question_id": 46834285, "link": "https://stackoverflow.com/questions/46834285/how-do-i-promote-a-function-that-returns-a-string-with-singletons/56838716#56838716", "title": "How do I promote a function that returns a String with singletons?", "body": "<p>You either need to disable OverloadedStrings, or you need to be explicit about their type, by doing:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\n$(singletons [d|\n       data EventScans\n        = PassThrough\n        | SuiteProgress\n\n       -- cn :: EventScans -&gt; [Char]\n       cn PassThrough = (\"all-events\" :: String)\n       cn SuiteProgress = (\"suite-progress\" :: String)\n    |])\n</code></pre>\n\n<p>I think it doens't want to do this because now you're asking for 2 layers of polymorpism (value, and type level). I doubt you need it so just be explicit.</p>\n\n<p>But the thing you're making here doesnt' really need singletons anyway.\nSingletons is only neccisary for going from value to type, in this case you know all values and therefore can go back to plain ol' typefamilies:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances   #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE TypeApplications    #-}\n{-# LANGUAGE TypeFamilies        #-}\n\nmodule Main where\n\nimport           Data.Proxy\nimport           GHC.TypeLits\n\ntest1 :: String\ntest1 = getStat $ Proxy @PassTrough\n\ntest2 :: String\ntest2 = getStat $ Proxy @SuiteProgress\n\ndata PassTrough\ndata SuiteProgress\n\ntype family Cn d :: Symbol where\n  Cn PassTrough = \"all-events\"\n  Cn SuiteProgress = \"suite-progress\"\n\ngetStat :: forall a b . ((Cn a) ~ b, KnownSymbol b) =&gt; Proxy a -&gt; String\ngetStat _ = symbolVal $ Proxy @b\n\n</code></pre>\n"}], "owner": {"reputation": 2087, "user_id": 103377, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b4bc128655739e58e2a52b1c4b37ff41?s=128&d=identicon&r=PG", "display_name": "Ben Ford", "link": "https://stackoverflow.com/users/103377/ben-ford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1561996437, "creation_date": 1508429268, "last_edit_date": 1508440369, "question_id": 46834285, "link": "https://stackoverflow.com/questions/46834285/how-do-i-promote-a-function-that-returns-a-string-with-singletons", "title": "How do I promote a function that returns a String with singletons?", "body": "<p>Using stack with lts-9.2 (and singletons-2.1), I have this:</p>\n\n<pre><code>   $(singletons [d|\n       data EventScans\n        = PassThrough\n        | SuiteProgress\n\n       -- cn :: EventScans -&gt; [Char]\n       cn PassThrough = \"all-events\"\n       cn SuiteProgress = \"suite-progress\"\n    |])\n</code></pre>\n\n<p>I can't give this function a type signature and the inferred type signature is<code>cn :: IsString t =&gt; EventScans -&gt; t</code>. AFAIK <code>IsString</code> doesn't singletonize.</p>\n\n<p>Without the type signature on <code>cn</code> I get the <code>Cn</code> type family as expected. If I try to add the type signature I get:</p>\n\n<pre><code>* Expected kind `[Char]', but `\"all-events\"' has kind `Symbol'\n* In the type `\"all-events\"'\n  In the type family declaration for `Cn' (haskell-stack-ghc)\n</code></pre>\n\n<p>What's the right way to do this?</p>\n\n<p><strong>edit</strong> If I try to include the type signature <code>cn :: IsString t =&gt; EventScans  -&gt; t</code> I get the following error:</p>\n\n<pre><code>Variable `a_agPb' used as both a kind and a type\n Did you intend to use TypeInType? (haskell-stack-ghc)\nNot in scope: type constructor or class `SIsString'\n  Perhaps you meant `IsString' (imported from Data.String) (haskell-stack-ghc)\n</code></pre>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1508423536, "post_id": 46832366, "comment_id": 80612218, "body": "<code>chk f x y = f x == y</code> only requires <code>f x</code> and <code>y</code> to be comparable with <code>==</code>, and they\u2019re both a <code>b</code>, so <code>Eq b</code> is all that\u2019s necessary."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1508425421, "post_id": 46832366, "comment_id": 80613546, "body": "Also note that <code>a</code> and <code>b</code> might be the same type -- they don&#39;t have to be different (nor they have to be equal)."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1508427245, "post_id": 46832366, "comment_id": 80614804, "body": "<code>Eq b</code> means <i>values</i> of some type <code>b</code> can be compared for equality (i.e. the have implementations for <code>==</code>. So you&#39;re right that the type variables already indicate which values must be of the same type; but one <code>b</code> might be (0 :: Int) and the other (42 :: Int)"}], "answers": [{"tags": [], "owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "is_accepted": false, "score": 3, "last_activity_date": 1508423651, "creation_date": 1508423651, "answer_id": 46832447, "question_id": 46832366, "link": "https://stackoverflow.com/questions/46832366/haskell-function-to-find-out-by-type-definition/46832447#46832447", "title": "Haskell: function to find out by type definition", "body": "<p>Such a function would only be able to compare two values of type <code>b</code> for equality, no <code>a</code>s involved.</p>\n\n<p>If you look at the type, there is one implementation that seems to be the obvious one:</p>\n\n<pre><code>chk :: Eq b =&gt; (a -&gt; b) -&gt; a -&gt; b -&gt; Bool \nchk f x y =\n  let z = f x -- z :: b\n  in y == z -- comparison of two values of type b\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 0, "last_activity_date": 1508489258, "creation_date": 1508489258, "answer_id": 46845483, "question_id": 46832366, "link": "https://stackoverflow.com/questions/46832366/haskell-function-to-find-out-by-type-definition/46845483#46845483", "title": "Haskell: function to find out by type definition", "body": "<p>You need to clearly separate in your mind the difference between <em>type variables</em> and <em>normal variables</em>.</p>\n\n<p>The type <code>(Eq b) =&gt;...</code> means that <code>b</code> can be any <em>type</em>, provided that <em>values</em> of that type are comparable. So <code>b = Int</code> would work, because we can compare <code>Int</code> values (e.g., <code>3 == 5</code> is false, but <code>2 == 2</code> is true). But <code>b = IO Int</code> would not work, since you cannot compare I/O operations for equality.</p>\n\n<p>All of this has <em>nothing to do with</em> whether <code>a == b</code>; both <code>a</code> and <code>b</code> are <em>types</em>, not <em>values</em>. The type says that <code>a</code> can be any type, and <code>b</code> can also be any type (if it implements <code>Eq</code>). In particular, it's possible for <code>a</code> and <code>b</code> to be <em>the same</em> type, but it's also possible for them to be different types. Using different type variables says that these <em>can</em> be different types, not that they <em>must</em> be different.</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": -1, "last_activity_date": 1508492230, "creation_date": 1508492230, "answer_id": 46846309, "question_id": 46832366, "link": "https://stackoverflow.com/questions/46832366/haskell-function-to-find-out-by-type-definition/46846309#46846309", "title": "Haskell: function to find out by type definition", "body": "<p>Ler's see how we could deduce a sensible implementation of <code>chk</code> from its type.</p>\n\n<p>Having two values, one of type <code>a</code> and one of type <code>b</code>, we can't do much with them. Both types are unknown. (They may be in fact the same type but we don't know that). We know we can compare two values of type <code>b</code> for equality,  but there's only one such value at our disposal. We can compare it with itself but this doesn't make much sense. If we had another value of type <code>b</code>, we could compare the two.</p>\n\n<p>But there are three arguments, one of type <code>a</code>, one of type <code>b</code>, and one is a function of type <code>a-&gt;b</code>. The only other thing we can do with them (apart from comparing a value with itself) is to apply the function to the value of type <code>a</code>. The result of this application has type <code>b</code>. But wait, this is exactly what we wanted, another value of type <code>b</code> to complete the comparison. And since the result of the comparison is of type <code>Bool</code>, this is exactly what we need to complete <code>chk</code>.</p>\n\n<pre><code>chk f x y = f x == y\n</code></pre>\n\n<p>And this is the one of two non-trivial ways to write this function. The other one replaces <code>==</code> with <code>/=</code>.</p>\n\n<p>There are in fact a very limited amount of functions of this type and we can enumerate them all. If you only take into account total functions and require that equality is reflexive and symmetric, then there are only two other functions of this type:</p>\n\n<pre><code>chk0 f x y = True\nchk1 f x y = False\n</code></pre>\n\n<p>If you drop these restrictions, you can write also:</p>\n\n<pre><code>chk2 f x y = undefined\nchk3 f x y = y == y // may be different from just True\nchk4 f x y = f x == f x\n</code></pre>\n\n<p>and perhaps a dozen more.</p>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1508492230, "creation_date": 1508423394, "last_edit_date": 1508423641, "question_id": 46832366, "link": "https://stackoverflow.com/questions/46832366/haskell-function-to-find-out-by-type-definition", "title": "Haskell: function to find out by type definition", "body": "<p>Also owing to all your help, I made some steps in understanding the type system in Haskell. What I still don't understand is a construction like this:</p>\n\n<pre><code>chk :: Eq b =&gt; (a -&gt; b) -&gt; a -&gt; b -&gt; Bool\n</code></pre>\n\n<ul>\n<li>Why is the class constraint only on <code>'b'</code>, while you cannot compare different types?</li>\n<li>Isn't <code>a</code>/<code>b</code> used to indicate different types anyway?\nIf I got this all wrong, can you show me a function that would typecheck like that?</li>\n</ul>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1508482509, "post_id": 46833365, "comment_id": 80635057, "body": "The first example <code>IsntMonad</code>, why it is not a monad? It is not possible to write <code>instance Monad IsntMonad where  (IsntMonad a)  &gt;&gt;= k = ???</code> ?"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1508484076, "post_id": 46833365, "comment_id": 80635799, "body": "Yes, but it isn&#39;t full answer. When you try to write the instance you will find that you can not extract value from the <code>IO</code> that would then apply it to the arrow of the Kleisli <code>k :: a -&gt; IsntMonad b</code>."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1508485872, "post_id": 46833365, "comment_id": 80636691, "body": "What is exactly Kleisli? I thought it is monad composition like function composition with fish <code>&gt;=&gt;</code> operator."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1508487607, "post_id": 46833365, "comment_id": 80637547, "body": "Look at signature of <code>(&gt;&gt;=)</code> - <code>Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b</code>. The second argument sometimes called Kleisli arrow (it&#39;s from Kleisli category which naturally associated to any monad, where composition is <code>(&gt;=&gt;)</code>). That&#39;s why the variable of second argument is called <code>k</code> (the first letter of Kleisli)."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1508514123, "post_id": 46833365, "comment_id": 80652631, "body": "You mentioned <i>This means that in cases of failure in <code>StateT s Maybe</code>, we lose state, but in <code>MaybeT (State s)</code> we save the state in which the error occurred.</i> could you please show me an example."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1508529208, "post_id": 46833365, "comment_id": 80660315, "body": "Here example with mtl library: <code>flip execStateT 0 (modify (+1) &gt;&gt; empty &gt;&gt; modify (+1) :: StateT Int Maybe ()) =&gt; Nothing; flip execState 0 $ runMaybeT (modify (+1) &gt;&gt; empty &gt;&gt; modify (+1) :: MaybeT (State Int) ()) =&gt; 1</code>"}], "tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": true, "score": 8, "last_activity_date": 1508436967, "last_edit_date": 1508436967, "creation_date": 1508426389, "answer_id": 46833365, "question_id": 46831992, "link": "https://stackoverflow.com/questions/46831992/the-usage-of-monad-transformers/46833365#46833365", "title": "The usage of monad transformers", "body": "<p>The author tries to say that the composition of any two monads isn't possible. This isn't because language is bad, but because there are monads whose composition isn't a monad.</p>\n\n<p>For instance, <code>IsntMonad</code> isn't a monad:</p>\n\n<pre><code>newtype IsntMonad a = IsntMonad (Maybe (IO a))\n\ninstance Monad IsntMonad where\n    m &gt;&gt;= k = ???\n</code></pre>\n\n<p>But, <code>IsMonad</code> is a monad:</p>\n\n<pre><code>newtype IsMonad a = IsMonad { runIsMonad :: IO (Maybe a) }\n\ninstance Monad IsMonad where\n    (IsMonad ioma) &gt;&gt;= k = IsMonad $ do\n        ma &lt;- ioma\n        case ma of\n          Just a -&gt; runIsMonad $ k a\n          Nothing -&gt; return Nothing\n</code></pre>\n\n<p>So, monad transformers it's just a way to make possibility of composition. But how it works, if we know that it isn't possible in general case? Yes, it's not possible for any two monads, but it's possible for some concrete monad and any other monad.</p>\n\n<p>So, there are monads which can be compose with any other monad. Such monads in the first approximation are monad transformers.</p>\n\n<p>For instance, the monad <code>Maybe</code> can be compose with any other monad like this: <code>Monad m =&gt; m (Maybe a)</code>, so <code>m (Maybe a)</code> is a monad. But how we can do instance of monad for it?</p>\n\n<pre><code>instance Monad m =&gt; Monad ??? where ...\n</code></pre>\n\n<p>Then <code>MaybeT</code> appears as helper, it is called a monad transformer (the suffix <code>T</code> hints on that).</p>\n\n<pre><code>newtype MaybeT m a = MaybeT { runMaybeT :: m (Maybe a) }\n\ninstance Monad m =&gt; Monad (MaybeT m) where\n    m &gt;&gt;= k = MaybeT $ do\n        ma &lt;- runMaybeT m\n        case ma of\n          Just a -&gt; runMaybeT $ k a\n          Nothing -&gt; return Nothing\n</code></pre>\n\n<p>After that, automatically <code>MaybeT IO</code>, <code>MaybeT []</code>, <code>MaybeT STM</code> ... are monads. You don't need to write instances for them. This is what they are good for.</p>\n\n<hr>\n\n<p>We understood what monad transformers are just way to composition of monads. But it isn't an answer on: What is the composition of monads good for? Why did we spend our time and energy on finding a way to combine monads?</p>\n\n<p>Well, as you known, any monad associated with some sort of effects. If we compose two monads we also compose them effects and this result we will be get automatically.</p>\n\n<p>For example:</p>\n\n<pre><code>StateT s Maybe a -- a computation with a state `s` which can fail\nReaderT e Maybe a -- a computation with access to an environment `e` and option to fail\nReaderT e (StateT s Maybe) a -- a computation with state `s`, access to an environment `e` and option to fail\n...\n</code></pre>\n\n<p>Composition of monads isn't commutative. For example, <code>MaybeT (State s)</code> isn't same thing as <code>StateT s Maybe</code>. A simple way to understand what effects will be produced by the composition is to remember that effects are produced from the inner monad to the outer monad. <code>MaybeT (State s)</code> the first effect will be produced by <code>State s</code> monad then by <code>Maybe</code>. But in <code>StateT s Maybe</code> the first effect will be produced by <code>Maybe</code> then by <code>State s</code>. This means that in cases of failure in <code>StateT s Maybe</code>, we lose state, but in<code>MaybeT (State s)</code>we save the state in which the error occurred.</p>\n\n<p>So, the composition of monads is a simple way to build more complex monads just on type level.</p>\n\n<p>How can this be applied in practice? For example, let's image situation. You have something and options to transform it. Imperative code can look like this:</p>\n\n<pre><code>thing = defaultValue;\nif (transformByOption0)\n    doTransformationByOption0(thing);\nif (transformByOption1)\n    doTransformationByOption1(thing);\n...\n</code></pre>\n\n<p>In Haskell we can write:</p>\n\n<pre><code>thing &lt;- flip execStateT defaultValue $ do\n    when transformByOption0 $\n        modify doTransformationByOption0\n    when transformByOption1 $\n        modify doTransformationByOption1\n    when transformByOption2 $\n        put =&lt;&lt; doMonadicTransformationByOption2 =&lt;&lt; get\n    ...\n</code></pre>\n\n<p>What happend here? I locally wrapped some of my monad (it could be any) a monad <code>State MyThing</code> so that it would be easy and simple to solve this problem. It's just a one from billion examples where composition of monads can easily solve your problems.</p>\n"}, {"tags": [], "owner": {"reputation": 368, "user_id": 2492166, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/54b4fd0a3406e65b532e27dfd9b3ad0d?s=128&d=identicon&r=PG", "display_name": "Iron Gremlin", "link": "https://stackoverflow.com/users/2492166/iron-gremlin"}, "is_accepted": false, "score": 0, "last_activity_date": 1508430731, "creation_date": 1508430731, "answer_id": 46834725, "question_id": 46831992, "link": "https://stackoverflow.com/questions/46831992/the-usage-of-monad-transformers/46834725#46834725", "title": "The usage of monad transformers", "body": "<p>A monad transformer is a monad which allows the composition of effects between itself and some other monad.</p>\n\n<p>The effect of <code>Reader</code> would be the environment accessible within it's context by the function <code>ask</code></p>\n\n<p>The effect of <code>State</code> would be the state accessible by <code>get</code> and modifiable by <code>put</code>.</p>\n\n<p>A monad transformer, <code>StateT a m s</code> would be a monad transformer capable of carrying around it's state and also providing some effect from a monad, <code>m</code>.</p>\n\n<p>An instance of a monad transformer stack could be:\n<code>StateT Int (Reader String) Int</code>, representing a computation with a Reader environment of type <code>String</code>, a state with a type of <code>Int</code>, and a return type of <code>Int</code>. If <code>Reader</code> were instead <code>ReaderT</code>, you could chain this with say, <code>IO</code>, and also read/write some files or something, all in the same function.</p>\n\n<p>There is quite a bit of detail that I'm glossing over there in terms of how that all gets implemented, but that's what a monad transformer is, and why you'd use one.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1212, "favorite_count": 1, "accepted_answer_id": 46833365, "answer_count": 2, "score": 3, "last_activity_date": 1508469303, "creation_date": 1508422385, "last_edit_date": 1508469303, "question_id": 46831992, "link": "https://stackoverflow.com/questions/46831992/the-usage-of-monad-transformers", "title": "The usage of monad transformers", "body": "<p>I am reading about monad transformers in the Haskell book.</p>\n\n<p>The author mentioned following:</p>\n\n<blockquote>\n  <p>What about Monad? There\u2019s no problem composing two arbitrary datatypes\n  that have Monad instances. We saw this already when we used Compose\n  with Maybe and list, which both have Monad instances defined. However,\n  the result of having done so does not give you a Monad.   </p>\n  \n  <p>The issue comes down to a lack of information. Both types Compose is\n  working with are polymorphic, so when you try to write bind for the\n  Monad, you\u2019re trying to combine two polymorphic binds into a single\n  combined bind. This, it turns out, is not possible:  </p>\n\n<pre><code>{-# LANGUAGE InstanceSigs #-}\n-- impossible.\ninstance (Monad f, Monad g) =&gt; Monad (Compose f g) where\n  return = pure\n  (&gt;&gt;=) :: Compose f g a\n  -&gt; (a -&gt; Compose f g b)\n  -&gt; Compose f g b\n  (&gt;&gt;=) = ???\n</code></pre>\n  \n  <p>These are the types we\u2019re trying to combine, because \ud835\udc53 and \ud835\udc54 are\n  necessarily both monads with their own Monad instances:</p>\n\n<pre><code>Monad f =&gt; f a -&gt; (a -&gt; f b) -&gt; f b\nMonad g =&gt; g a -&gt; (a -&gt; g b) -&gt; g b\n</code></pre>\n  \n  <p>From those, we are trying to write this bind:</p>\n\n<pre><code>(Monad f, Monad g) =&gt; f (g a) -&gt; (a -&gt; f (g b)) -&gt; f (g b)\n</code></pre>\n  \n  <p>Or formulated differently:</p>\n\n<pre><code>(Monad f, Monad g) =&gt; f (g (f (g a))) -&gt; f (g a)\n</code></pre>\n  \n  <p>And this is not possible. There\u2019s not a good way to join that final \ud835\udc53\n  and \ud835\udc54. It\u2019s a great exercise to try to make it work, because the\n  barriers you\u2019ll run into are instructive in their own right. You can\n  also read Composing monads1 by Mark P. Jones and Luc Duponcheel to see\n  why it\u2019s not possible.</p>\n</blockquote>\n\n<p>I could not figure it out. What does he mean? What, exactly, is a monad transformer and what is it good for?</p>\n"}, {"tags": ["parsing", "haskell", "megaparsec"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1508418845, "post_id": 46829438, "comment_id": 80608775, "body": "This is weird, since <code>option x p = p &lt;|&gt; pure x</code> be definition, so I can&#39;t see why making two branches as you say would help, since it would be equivalent to <code>p &lt;|&gt; p &lt;|&gt; pure x</code>."}, {"owner": {"reputation": 183, "user_id": 7387538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207502264703363/picture?type=large", "display_name": "ttylec", "link": "https://stackoverflow.com/users/7387538/ttylec"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1508433690, "post_id": 46829438, "comment_id": 80618527, "body": "By making two branches I meant parser: <code>p3 = ((&lt;&gt;) &lt;$&gt; rword &quot;opt&quot; &lt;*&gt; p1) &lt;|&gt; p1</code>. That parser in custom error reports that it expects &quot;foo&quot;, &quot;bar&quot; or &quot;opt&quot;. While <code>p2</code> informs only on &quot;foo&quot; and &quot;bar&quot;, despite the fact that &quot;opt&quot; would be fine too."}, {"owner": {"reputation": 183, "user_id": 7387538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207502264703363/picture?type=large", "display_name": "ttylec", "link": "https://stackoverflow.com/users/7387538/ttylec"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1508434090, "post_id": 46829438, "comment_id": 80618747, "body": "However, your comment explains why <code>option</code> does produce custom error: <code>pure</code> is parser that always succeeds, so the whole <code>option</code> parser does not need any input to succeed. The question is still valid: how elegantly get what is expected by optional parser."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1508435155, "post_id": 46829438, "comment_id": 80619319, "body": "Is using <code>label</code> / <code>&lt;?&gt;</code> of any help for your issue? It is not the same, but..."}], "owner": {"reputation": 183, "user_id": 7387538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207502264703363/picture?type=large", "display_name": "ttylec", "link": "https://stackoverflow.com/users/7387538/ttylec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 1, "answer_count": 0, "score": 9, "last_activity_date": 1508414706, "creation_date": 1508414706, "question_id": 46829438, "link": "https://stackoverflow.com/questions/46829438/auto-completion-suggestions-from-parse-error", "title": "Auto-completion suggestions from parse error", "body": "<p>I am writing a parser for a custom jupter kernel using megaparsec. I was able to re-use the parser to provide completions too: the custom error message generated from the megaparsec library are transformed to the list of expected symbols. It that way, whenever I change the parser, completion automatically adjust itself. Which is great.</p>\n\n<p>The only thing I am struggling is how to get info from the <em>optional</em> parsers. The minimal example illustrating what I want to achieve is following:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nmodule Main where\n\nimport Control.Applicative\nimport Text.Megaparsec\nimport Text.Megaparsec.Char\nimport qualified Text.Megaparsec.Char.Lexer as L\nimport Data.Monoid\nimport Data.Text (Text)\nimport Data.Set (singleton)\n\ntype Parser = Parsec MyError Text\n\ndata MyError = ExpectKeyword Text deriving (Eq, Ord, Show)\n\nlexeme = L.lexeme sc\nsc = L.space (skipSome (oneOf [' ', '\\t'])) empty empty\n\n-- | Reserved words\nrword :: Text -&gt; Parser Text\nrword w = region (fancyExpect (ExpectKeyword w)) $\n          lexeme (string w *&gt; return w)\n\nfancyExpect f e = FancyError (errorPos e) (singleton . ErrorCustom $ f)\n\np1 = rword \"foo\" &lt;|&gt; rword \"bar\"\n\np2 = (&lt;&gt;) &lt;$&gt; option \"def\" (rword \"opt\") &lt;*&gt; p1\n\nmain = do\n  putStrLn . show $ parse p1 \"\" (\"xyz\" :: Text) -- shows \"foo\" and \"bar\" in errors\n  putStrLn . show $ parse p2 \"\" (\"xyz\" :: Text) -- like above, no optional \"opt\"\n</code></pre>\n\n<p>In the first case, parser fails and I get the list of all errors from all alternatives. Ideally, in the second case I would like to see the error of the failed optional parser too.</p>\n\n<p>This example can be simply solved by removing <code>option</code> and making two branches with <code>&lt;|&gt;</code>: one with option and the other without. However in real case the optional part is a permutation parser consisting of several optional parts, so such trick is not feasible.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 1, "answer_count": 0, "score": 4, "last_activity_date": 1508408657, "creation_date": 1508408657, "question_id": 46827759, "link": "https://stackoverflow.com/questions/46827759/how-to-display-a-progress-bar-while-building-with-stack", "title": "How to display a progress bar while building with stack?", "body": "<p>Is there any way to display a progress bar on the terminal while stack is building a large component of the project? Currently the <code>Progress n/m</code> display works only at a package level. I'm looking for something at the package+module level, if possible.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 2, "last_activity_date": 1508405821, "creation_date": 1508405821, "answer_id": 46826929, "question_id": 46826700, "link": "https://stackoverflow.com/questions/46826700/how-to-create-a-generic-complex-type-in-haskell/46826929#46826929", "title": "How to create a generic Complex type in haskell?", "body": "<p>While you could, as the compiler message instructs, use <code>ExistentialQuantification</code>, you could also define the type like this:</p>\n\n<pre><code>data Complex a = Complex a a deriving (Show, Eq)\n</code></pre>\n\n<p>It's a completely unconstrained type, so perhaps another name would be more appropriate... This type seems to often be called <code>Pair</code>...</p>\n\n<p>When you write functions, however, you can constrain the values contained in the type:</p>\n\n<pre><code>myFunction :: Num a =&gt; Complex a -&gt; a\nmyFunction (Complex x y) = x + y\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "is_accepted": false, "score": 3, "last_activity_date": 1508406885, "creation_date": 1508406885, "answer_id": 46827240, "question_id": 46826700, "link": "https://stackoverflow.com/questions/46826700/how-to-create-a-generic-complex-type-in-haskell/46827240#46827240", "title": "How to create a generic Complex type in haskell?", "body": "<p>Type constructors cannot be constrained in pure Haskell, only functions can. So it is supposed that you declare </p>\n\n<pre><code>data Complex a = Complex a a\n</code></pre>\n\n<p>and then constrain functions, like</p>\n\n<pre><code>conjugate :: (Num a) =&gt; Complex a -&gt; Complex a\nconjugate (Complex x y) = Complex x (-y)\n</code></pre>\n\n<p>In fact, the type and constraint for <code>conjugate</code> can be derived by the compiler, so you can just define the implementation:</p>\n\n<pre><code>conjugate (Complex x y) = Complex x (-y)\n</code></pre>\n\n<p>However, if you really wish to constrain the type constructor <code>Complex</code>, you can turn on some <em>extensions</em> that enable it, namely <code>ExistentialQuantification</code> or <code>GADTs</code>, as the compiler suggests. To do this, add this line to the very beginning of your file:</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n</code></pre>\n\n<p>Those are called <a href=\"https://downloads.haskell.org/~ghc/7.0.3/docs/html/users_guide/pragmas.html\" rel=\"nofollow noreferrer\">pragmas</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 12, "last_activity_date": 1508407052, "creation_date": 1508407052, "answer_id": 46827300, "question_id": 46826700, "link": "https://stackoverflow.com/questions/46826700/how-to-create-a-generic-complex-type-in-haskell/46827300#46827300", "title": "How to create a generic Complex type in haskell?", "body": "<p>Traditional <code>data</code> in Haskell is just that: <em>data</em>. It doesn't need to know anything about the properties of its fields, it just needs to be able to <em>store</em> them. Hence there's no real need to constrain the fields at that point; just make it</p>\n\n<pre><code>data Complex a = Complex !a !a\n</code></pre>\n\n<p>(<code>!</code> because strict fields are better for performance).</p>\n\n<p>Of course when you then implement the <code>Num</code> instance, you <em>will</em> need a constraint:</p>\n\n<pre><code>instance (Num a) =&gt; Num (Complex a) where\n  fromInteger = (`Complex`0) . fromInteger\n  Complex r i + Complex \u03c1 \u03b9 = Complex (r+\u03c1) (i+\u03b9)\n  ...\n</code></pre>\n\n<p>...in fact, you need the much stronger constraint <code>RealFloat a</code> to implement <code>abs</code>, at least that's how <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/src/Data.Complex.html#line-120\" rel=\"noreferrer\">the standard version does it</a>. (Which means, <code>Complex Int</code> is actually not usable, not with the standard <code>Num</code> hierarchy; you need e.g. <code>Complex Double</code>.)</p>\n\n<p>That said, it is also possible to bake the constraint in to the data type itself. The ExistentialTypes syntax you tried is highly limiting though and not suitable for this; what you want instead is the <a href=\"https://en.wikibooks.org/wiki/Haskell/GADT\" rel=\"noreferrer\">GADT</a></p>\n\n<pre><code>data Complex a where\n   Complex :: Num a =&gt; a -&gt; a -&gt; Complex a\n</code></pre>\n\n<p>With that in place, you could then implement e.g. addition without mentioning any constraint in the signature</p>\n\n<pre><code>cplxAdd :: Complex a -&gt; Complex a -&gt; Complex a\ncplxAdd (Complex r i) (Complex \u03c1 \u03b9) = Complex (r+\u03c1) (i+\u03b9)\n</code></pre>\n\n<p>You would now need to fulfill <code>Num</code> <em>whenever you try to construct</em> a <code>Complex</code> value though. That means, you'd still need an explicit constraint in the <code>Num</code> instance.</p>\n\n<p>Also, this version is potentially much slower, because the <code>Num</code> dictionary actually needs to be stored in the runtime representation.</p>\n"}], "owner": {"reputation": 155, "user_id": 1904497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/STG9Y.jpg?s=128&g=1", "display_name": "ksceriath", "link": "https://stackoverflow.com/users/1904497/ksceriath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 789, "favorite_count": 0, "accepted_answer_id": 46827300, "answer_count": 3, "score": 8, "last_activity_date": 1508433082, "creation_date": 1508405155, "last_edit_date": 1508433082, "question_id": 46826700, "link": "https://stackoverflow.com/questions/46826700/how-to-create-a-generic-complex-type-in-haskell", "title": "How to create a generic Complex type in haskell?", "body": "<p>I want to create a Complex type to represent complex numbers.</p>\n\n<p>Following works:</p>\n\n<pre><code>Prelude&gt; data Complex = Complex Int Int\n\nPrelude&gt; :t Complex\nComplex :: Int -&gt; Int -&gt; Complex\n</code></pre>\n\n<p>How can I change this to accept any Num type, instead of just Int.</p>\n\n<p>I tried following:</p>\n\n<pre><code>Prelude&gt; data Complex a = Num a =&gt; Complex a a\n</code></pre>\n\n<p>but got this:</p>\n\n<pre><code>* Data constructor `Complex' has existential type variables, a context, or a specialised result type\n    Complex :: forall a. Num a =&gt; a -&gt; a -&gt; Complex a\n    (Use ExistentialQuantification or GADTs to allow this)\n* In the definition of data constructor `Complex'\n  In the data type declaration for `Complex'\n</code></pre>\n\n<p>I'm not really sure what to make of this error. Any help is appreciated.</p>\n"}, {"tags": ["haskell", "testing", "encoding", "barcode", "decoding"], "answers": [{"tags": [], "owner": {"reputation": 1556, "user_id": 769938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6741b0776cce2a17ad67212ad1bf9e87?s=128&d=identicon&r=PG", "display_name": "Brian Anderson", "link": "https://stackoverflow.com/users/769938/brian-anderson"}, "is_accepted": false, "score": 2, "last_activity_date": 1508493654, "creation_date": 1508493654, "answer_id": 46846725, "question_id": 46825859, "link": "https://stackoverflow.com/questions/46825859/ean13-barcode-encoding-in-haskell-how-to-test-it/46846725#46846725", "title": "EAN13 Barcode Encoding in Haskell: How to test it?", "body": "<p><a href=\"https://i.stack.imgur.com/QHT70.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QHT70.png\" alt=\"enter image description here\"></a></p>\n\n<p>It looks like there are three problems with your sequence of 1's and 0's. The first is your [A] EAN-13 center code seems to be overwriting the beginning of your sixth character. It should really be where [B] is. And you've got an extra 4 zeroes and an extra end marker tacked on to the end of your sequence.</p>\n\n<p>Here's a tool that does the work of generating the checksum and laying out the 1's and 0's:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var arrayCodeEANBin, arrayStructEAN;\r\narrayCodeEANBin = [ [ '0001101', '0011001', '0010011', '0111101', '0100011', '0110001', '0101111', '0111011', '0110111', '0001011' ], [ '0100111', '0110011', '0011011', '0100001', '0011101', '0111001', '0000101', '0010001', '0001001', '0010111' ], [ '1110010', '1100110', '1101100', '1000010', '1011100', '1001110', '1010000', '1000100', '1001000', '1110100' ] ];\r\narrayStructEAN = ['000000', '001011', '001101', '001110', '010011', '011001', '011100', '010101', '010110', '011010']\r\n\r\nvar strRaw = \"\";\r\nvar strText = \"\";\r\n\r\nfunction funcEAN() { // EAN-13\r\nvar intSumOdd = 0, intSumEven = 0, intCheck, i, j, strStruct;\r\n// Compute check digit and add it to raw string\r\n for (i = 0; i &lt; 12; i += 2) {\r\n  intSumEven += parseInt(strText[i]);\r\n  intSumOdd += parseInt(strText[i+1]);\r\n }\r\n intCheck = ((intSumOdd * 3) + intSumEven) % 10;\r\n if (intCheck &gt; 0) {\r\n \tintCheck = 10 - intCheck;\r\n }\r\n strText += intCheck;\r\n// Converts Code EAN array into string of 1's and 0's\r\n strRaw = \"101\"\r\n// First six bar sequences\r\n for (i = 1; i &lt; 7; i += 1) {\r\n   strStruct = arrayStructEAN[strText[0]];\r\n   strRaw += arrayCodeEANBin[strStruct[i-1]][strText[i]];\r\n }\r\n// Middle sequence\r\n strRaw += \"01010\";\r\n// Last six bar sequences, including check digit\r\n for (i = 0; i &lt; 6; i += 1) {\r\n  strRaw += arrayCodeEANBin[2][strText[i+7]];\r\n }\r\n strRaw += \"101\";\r\n} // End EAN-13\r\n\r\n\r\nvar buttonBarcode = document.getElementById(\"btnGenBar\");\r\nbuttonBarcode.onclick = function () {\r\n strText = document.getElementById(\"textBarcode\").value;\r\n funcEAN();\r\n document.getElementById(\"textRaw\").value = strRaw;\r\n document.getElementById(\"textRaw\").select();\r\n}</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;head&gt;\r\n&lt;title&gt;EAN-13 Barcodes in vanilla JavaScript&lt;/title&gt;\r\n&lt;meta http-equiv=\"Content-Type\" content=\"text/html;charset=utf-8\" &gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n &lt;div id=\"inputForm\"&gt;\r\n \tEnter Text:&amp;nbsp;&lt;input type=\"text\" id=\"textBarcode\" tabindex=1/&gt;\r\n \t&amp;nbsp;&lt;input type=\"button\" id=\"btnGenBar\" value=\"Gen 1's and 0's\" tabindex=4/&gt;\r\n &lt;/div&gt;\r\n &lt;p&gt;&lt;/p&gt;\r\n &lt;div id=\"result\"&gt;&lt;/div&gt;\r\n &lt;p&gt;&lt;/p&gt;\r\n &lt;textarea rows=\"3\" cols=\"110\" id=\"textRaw\" tabindex=0&gt;&lt;/textarea&gt;\r\n&lt;script type=\"text/javascript\" src=\"./SO_JS-EAN-13.js\"&gt;&lt;/script&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>If you want to see the actual barcode generated, I have a <a href=\"https://codepen.io/notionovus/pen/KXEWdK\" rel=\"nofollow noreferrer\">codepen</a>. It doesn't add the formatted text, but the barcode scans.</p>\n"}, {"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 3, "last_activity_date": 1508602313, "creation_date": 1508602313, "answer_id": 46865240, "question_id": 46825859, "link": "https://stackoverflow.com/questions/46825859/ean13-barcode-encoding-in-haskell-how-to-test-it/46865240#46865240", "title": "EAN13 Barcode Encoding in Haskell: How to test it?", "body": "<p>You have two bugs in your implementation:</p>\n\n<p>First, in <code>encodeDigits</code>, you've written <code>splitAt 5</code> when it should be <code>splitAt 6</code>.  This fixes the encoding bug noted by @Brian Anderson.</p>\n\n<p>Second, in <code>bestScores</code>, you've written:</p>\n\n<pre><code>[(distance d (scaleToOne ps), n) | d &lt;- srl, n &lt;- digits]\n</code></pre>\n\n<p>when you should have written:</p>\n\n<pre><code>zip [distance d (scaleToOne ps) | d &lt;- srl] digits\n</code></pre>\n\n<p>This fixes your decoding bug.</p>\n\n<p>I wish I could say I used my superhuman debugging skills to find these bugs, but I just happened to have my own copy of <code>Barcode.hs</code> around from when I did Chapter 12 myself a few years ago.</p>\n"}], "owner": {"reputation": 2260, "user_id": 5687152, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/J754G.jpg?s=128&g=1", "display_name": "mabe02", "link": "https://stackoverflow.com/users/5687152/mabe02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 46865240, "answer_count": 2, "score": 2, "last_activity_date": 1508602313, "creation_date": 1508402366, "question_id": 46825859, "link": "https://stackoverflow.com/questions/46825859/ean13-barcode-encoding-in-haskell-how-to-test-it", "title": "EAN13 Barcode Encoding in Haskell: How to test it?", "body": "<p>I am completing the <a href=\"http://book.realworldhaskell.org/read/barcode-recognition.html\" rel=\"nofollow noreferrer\">chapter 12 of <strong>Real World Haskell</strong></a>. In this chapter, the author explains how to perform Barcode Recognition with <a href=\"http://www.barcodeisland.com/ean13.phtml#Encoding%20Table\" rel=\"nofollow noreferrer\">EAN13 encoding</a>.</p>\n\n<p>I reproduced the most of the code from <a href=\"https://github.com/mberlanda/real_world_haskell/blob/bf956f597a4efb377c174502a1d2752be184cd79/ch12/Barcode.hs\" rel=\"nofollow noreferrer\">the book snippets into my repo</a> and when I finally arrived to check if my over 300 rows of code where working as expected, I got a bad news:</p>\n\n<pre><code>-- Finding the Correct Sequence\n*Main&gt; let input = zip (runLengths $ encodeEAN13 \"9780132114677\") (cycle [Zero, One])\n*Main&gt; listToMaybe . solve . candidateDigits $ input\nJust [0,2,0,1,0,0,0,0,0,0,0,0,1] -- WRONG Actual\nJust [9,7,8,0,1,3,2,1,1,4,6,7,7] -- Expected\n</code></pre>\n\n<p>Since the book was published, I noticed the some type signatures have changed such as:</p>\n\n<pre><code>$ ghci\nGHCi, version 7.10.3: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; import qualified Data.Map as M\nPrelude M&gt; :t M.lookup\nM.lookup :: Ord k =&gt; k -&gt; M.Map k a -&gt; Maybe a\n-- in the book: M.lookup :: (Ord k, Monad m) =&gt; k -&gt; M.Map k a -&gt; m a\n</code></pre>\n\n<p>I tried to reproduce in GHCi every example and, except from the last one, I always get the same result as the book.</p>\n\n<p><strong>Has anyone covered that topic from this book?</strong></p>\n\n<p>The author is not explaining every single line of code and, in particular, the <code>input</code> variable is not defined anywhere <code>let input = zip (runLengths $ encodeEAN13 \"9780132114677\") (cycle [Zero, One])</code></p>\n\n<p><strong>Some EAN13 encoded barcode for testing?</strong></p>\n\n<p>In case no one knows this book, would you have some sample of <em>EAN13 encoded</em> barcodes such as:</p>\n\n<pre><code>*Main M&gt; encodeEAN13 \"9780132114677\"\n\"101011101100010010100111001100101000010101011011001100110110011010111001010000100010010001001010000101\"\n</code></pre>\n\n<p>To make sure that my tests on functions are correct?</p>\n\n<p>Thank you very much in advance</p>\n"}, {"tags": ["haskell", "typeclass", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1508398995, "post_id": 46824910, "comment_id": 80597363, "body": "Additional remark: <code>Combine</code> either needs a <code>Show</code> instance, or must be used with <code>Blind</code>. Otherwise <code>quickCheck (assocTestFunc :: \u2026)</code> won&#39;t type-check."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1508401606, "post_id": 46824910, "comment_id": 80598707, "body": "Not only that, but an <code>Eq</code> instance is also required."}, {"owner": {"reputation": 315, "user_id": 3811161, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100006587713523/picture?type=large", "display_name": "PoppinDouble", "link": "https://stackoverflow.com/users/3811161/poppindouble"}, "edited": false, "score": 0, "creation_date": 1508403958, "post_id": 46824910, "comment_id": 80600131, "body": "yes, both of you are right, is it possible to give a full implementation of both Show instance and Eq instance for this data type? Thanks!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 315, "user_id": 3811161, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100006587713523/picture?type=large", "display_name": "PoppinDouble", "link": "https://stackoverflow.com/users/3811161/poppindouble"}, "edited": false, "score": 0, "creation_date": 1508406091, "post_id": 46824910, "comment_id": 80601367, "body": "@PoppinDouble Not in general. How would you print a function <code>Integer -&gt; Bool</code>? You can add a dummy instance like <code>instance Show (Combine a b) where show _ = &quot;&lt;&lt;fun&gt;&gt;&quot;</code> but it would not be very informative. You might achieve better results if you are more specific on what <code>a,b</code> are."}, {"owner": {"reputation": 315, "user_id": 3811161, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100006587713523/picture?type=large", "display_name": "PoppinDouble", "link": "https://stackoverflow.com/users/3811161/poppindouble"}, "edited": false, "score": 0, "creation_date": 1508438864, "post_id": 46824910, "comment_id": 80621218, "body": "@chi yes, your are right, for the Show instance, it will be not that informative in this way, how about the Eq instance, how could we implement == for a function type?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 315, "user_id": 3811161, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100006587713523/picture?type=large", "display_name": "PoppinDouble", "link": "https://stackoverflow.com/users/3811161/poppindouble"}, "edited": false, "score": 1, "creation_date": 1508444518, "post_id": 46824910, "comment_id": 80624246, "body": "@PoppinDouble I&#39;m afraid you can&#39;t for the same reason: to compare two functions one needs to evaluate it on all its inputs (possibly infinitely many). I&#39;d suggest you use quickcheck to test it only on a few random points. I.e. instead of checking <code>f==g</code> you need to check something like <code>forall (\\x -&gt; f x==g x)</code>. This means that you can&#39;t use your nice <code>assocTestFunc</code> for that. It is a pity, but we can&#39;t avoid computability limitations. I can&#39;t see a better approach at the moment."}, {"owner": {"reputation": 315, "user_id": 3811161, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100006587713523/picture?type=large", "display_name": "PoppinDouble", "link": "https://stackoverflow.com/users/3811161/poppindouble"}, "edited": false, "score": 0, "creation_date": 1508491221, "post_id": 46824910, "comment_id": 80639531, "body": "@chi Thank you so much! Yes, I think i will just write several unit test. Thanks again! :)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1508401326, "last_edit_date": 1508401326, "creation_date": 1508398884, "answer_id": 46824910, "question_id": 46824657, "link": "https://stackoverflow.com/questions/46824657/how-to-implement-the-arbitrary-instance-for-data-type-like-this/46824910#46824910", "title": "How to implement the Arbitrary instance for data type like this?", "body": "<p>You can exploit the predefined instance for functions.</p>\n\n<pre><code>instance (CoArbitrary a, Arbitrary b) =&gt; Arbitrary(Combine a b) where\n   arbitrary = Combine &lt;$&gt; arbitrary\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 3811161, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100006587713523/picture?type=large", "display_name": "PoppinDouble", "link": "https://stackoverflow.com/users/3811161/poppindouble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 46824910, "answer_count": 1, "score": 2, "last_activity_date": 1508401326, "creation_date": 1508397996, "question_id": 46824657, "link": "https://stackoverflow.com/questions/46824657/how-to-implement-the-arbitrary-instance-for-data-type-like-this", "title": "How to implement the Arbitrary instance for data type like this?", "body": "<p>I am new to Haskell, I am trying to write a test case to prove the associative law for Semigroup typeclass.</p>\n\n<p>The data type define as followed:</p>\n\n<pre><code>newtype Combine a b = Combine {unCombine :: (a -&gt; b)}\n</code></pre>\n\n<p>The implementation of Semigroup as followed:</p>\n\n<pre><code>instance (Semigroup b) =&gt; Semigroup (Combine a b) where \n  (Combine f) &lt;&gt; (Combine g) = Combine (\\x -&gt; f x &lt;&gt; g x)\n</code></pre>\n\n<p>I already wrote a associative test function</p>\n\n<pre><code>assocTestFunc :: (Eq m, Semigroup m) =&gt; m -&gt; m -&gt; m -&gt; Bool\nassocTestFunc a b c = (a &lt;&gt; b) &lt;&gt; c == a &lt;&gt; (b &lt;&gt; c)\n</code></pre>\n\n<p>and also defined a type alias like this:</p>\n\n<pre><code>type CombineAssoc = Combine String Ordering -&gt; Combine String Ordering -&gt; Combine String Ordering -&gt; Bool\n</code></pre>\n\n<p>So in my main function, I can test it like this:</p>\n\n<pre><code>  quickCheck (assocTestFunc :: CombineAssoc)\n</code></pre>\n\n<p>However I am having a hard time to implement the <code>Arbitrary</code> instance for the <code>Combine a b</code> data type. \nThanks advance for any help.</p>\n"}]