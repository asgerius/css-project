[{"tags": ["haskell", "haskell-diagrams"], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1558575230, "post_id": 56266588, "comment_id": 99149898, "body": "I believe the OP&#39;s code is fine, except for the subtle detail I discuss in my answer (so subtle, in fact, that I wonder whether <code>B.difference</code> was actually meant to work like that)."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 1, "last_activity_date": 1558571056, "creation_date": 1558571056, "answer_id": 56266588, "question_id": 56266291, "link": "https://stackoverflow.com/questions/56266291/how-to-combine-shapes-via-set-operations/56266588#56266588", "title": "How to combine shapes via set operations?", "body": "<p>I'm not an expert on Diagrams, but it looks like you are combining stroke paths rather than the shapes they represent. <a href=\"https://archives.haskell.org/projects.haskell.org/diagrams/doc/manual.html#fill-rules\" rel=\"nofollow noreferrer\">Fill Rules</a> has some interesting things to say about how the Winding fill rule behaves for stroke paths that overlap themselves, which seems relevant to explaining why you get the result you do.</p>\n\n<p>Instead, I'd suggest using the techniques in <a href=\"https://archives.haskell.org/projects.haskell.org/diagrams/doc/manual.html#composing-diagrams\" rel=\"nofollow noreferrer\">Composing diagrams</a>, such as <code>atop</code>, to compose the completed shapes.</p>\n"}, {"comments": [{"owner": {"reputation": 1943, "user_id": 305559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc113924265dbeb535c8b2fefe4e33ee?s=128&d=identicon&r=PG", "display_name": "Brent Yorgey", "link": "https://stackoverflow.com/users/305559/brent-yorgey"}, "edited": false, "score": 2, "creation_date": 1558646683, "post_id": 56266943, "comment_id": 99180219, "body": "Yeah, I would call this a bug in <code>B.difference</code>.  It&#39;s not the first time we&#39;ve run into such issues with boolean path operations.  <a href=\"https://github.com/kuribas/cubicbezier/issues/6\" rel=\"nofollow noreferrer\">github.com/kuribas/cubicbezier/issues/6</a> is relevant."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 1943, "user_id": 305559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc113924265dbeb535c8b2fefe4e33ee?s=128&d=identicon&r=PG", "display_name": "Brent Yorgey", "link": "https://stackoverflow.com/users/305559/brent-yorgey"}, "edited": false, "score": 0, "creation_date": 1558655465, "post_id": 56266943, "comment_id": 99182255, "body": "@BrentYorgey It&#39;s good to know it is a known issue. Thanks for chiming in."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 4, "last_activity_date": 1558576075, "last_edit_date": 1558576075, "creation_date": 1558574806, "answer_id": 56266943, "question_id": 56266291, "link": "https://stackoverflow.com/questions/56266291/how-to-combine-shapes-via-set-operations/56266943#56266943", "title": "How to combine shapes via set operations?", "body": "<p>This particular usage of <code>B.difference</code> reverses the direction of the <code>shorterSquare</code> path, so you need to <a href=\"http://hackage.haskell.org/package/diagrams-lib-1.4.2.2/docs/Diagrams-Path.html#v:reversePath\" rel=\"nofollow noreferrer\">re-reverse it</a>:</p>\n\n<pre><code>shorterSquare = B.difference Winding (square 2) (square 2 # translateX 1)\n    # reversePath\n</code></pre>\n\n<p>As this is quite subtle, it is worth it to spend a moment describing how I diagnosed it. Firstly, such fill rule wackiness felt quite like the sort of issue caused by path (or face, etc.) orientations. Secondly, redefining <code>shorterSquare</code> as...</p>\n\n<pre><code>shorterSquare = square 2 # scaleX 0.5 # translateX 0.5\n</code></pre>\n\n<p>... gives the expected result. That means the issue has to do with <code>B.difference</code> and the definition of <code>shorterSquare</code>, rather than with <code>B.union</code>. Confirmation can be obtained through <a href=\"http://hackage.haskell.org/package/diagrams-lib-1.4.2.2/docs/Diagrams-Path.html#v:pathVertices\" rel=\"nofollow noreferrer\"><code>pathVertices</code></a>:</p>\n\n<pre><code>GHCi&gt; -- Counterclockwise.\nGHCi&gt; pathVertices $ square 2 # scaleX 0.5 # translateX 0.5\n[[P (V2 1.0 (-1.0)),P (V2 0.9999999999999999 1.0),P (V2 (-1.1102230246251565e-16) 1.0),P (V2 (-2.220446049250313e-16) (-1.0))]]\nGHCi&gt; -- Clockwise.\nGHCi&gt; pathVertices $ B.difference Winding (square 2) (square 2 # translateX 1)\n[[P (V2 (-1.0) 1.0),P (V2 0.0 1.0),P (V2 0.0 (-1.0)),P (V2 (-1.0) (-1.0))]]\n</code></pre>\n"}], "owner": {"reputation": 2966, "user_id": 3014199, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/72332b0ac6ee78bc829c378c6c747e0e?s=128&d=identicon&r=PG", "display_name": "peer", "link": "https://stackoverflow.com/users/3014199/peer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 56266943, "answer_count": 2, "score": 2, "last_activity_date": 1558576352, "creation_date": 1558568278, "last_edit_date": 1558576352, "question_id": 56266291, "link": "https://stackoverflow.com/questions/56266291/how-to-combine-shapes-via-set-operations", "title": "How to combine shapes via set operations?", "body": "<p>I would like to subtract one shape from another, and then combine the resulting shape with another shape. In my example a square is to be clipped in half and that clipped version is to be extended by a half circle to the right.\nSo I subtract one square from the other via <code>difference</code> and make a <code>union</code> with the whole circle assuming that overlapping areas will just merge.\nI'm thinking in terms of set operations where  <code>({1,2,3,4} / {3,4}) U {2,3}</code> equals <code>{1,2,3}</code> but in my implementation it equals <code>{1,3}</code>:</p>\n\n<pre><code>import Diagrams.Backend.SVG.CmdLine\n\n{-# LANGUAGE NoMonomorphismRestriction #-}\n{-# LANGUAGE FlexibleContexts          #-}\n{-# LANGUAGE TypeFamilies              #-}\n\nimport Diagrams.Prelude\nimport qualified Diagrams.TwoD.Path.Boolean as B\n\nmain = mainWith (combination # fc red # bgFrame 0.1 white)\n  where\n    combination :: QDiagram B V2 Double Any\n    combination = strokePath plusCircle\n    shorterSquare = B.difference Winding (square 2) (square 2 # translateX 1)\n\n    plusCircle = B.union Winding (circle 1 &lt;&gt; shorterSquare)\n</code></pre>\n\n<p>But I get this: <a href=\"https://i.stack.imgur.com/gyuV3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gyuV3.png\" alt=\"enter image description here\"></a>\nThis is not what I want, I want the half circle merged with the rectangle, and the result to be filled just red with no lines inside.</p>\n"}, {"tags": ["haskell", "functional-programming", "haskell-stack"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1558565277, "post_id": 56265914, "comment_id": 99148102, "body": "Because you don&#39;t have the <code>stream-fusion</code> library installed?"}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 4, "creation_date": 1558565932, "post_id": 56265914, "comment_id": 99148249, "body": "Please do not post images that have important text on them. You should paste your error message directly"}], "answers": [{"tags": [], "owner": {"reputation": 1290, "user_id": 5499871, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206799318615183/picture?type=large", "display_name": "Izaak Weiss", "link": "https://stackoverflow.com/users/5499871/izaak-weiss"}, "is_accepted": true, "score": 5, "last_activity_date": 1558565313, "creation_date": 1558565313, "answer_id": 56265934, "question_id": 56265914, "link": "https://stackoverflow.com/questions/56265914/can-not-import-data-stream-in-haskell/56265934#56265934", "title": "Can not import Data.Stream in Haskell", "body": "<p>The module Data.Stream is not part of the standard library. You need to install a package that provides it first, probably using <a href=\"https://www.haskell.org/cabal/\" rel=\"noreferrer\">Cabal</a> or <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"noreferrer\">Stack</a>.</p>\n"}], "owner": {"reputation": 61, "user_id": 10908519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73a0794210258059268b0cca1cbffc69?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Gao", "link": "https://stackoverflow.com/users/10908519/y-gao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 56265934, "answer_count": 1, "score": 0, "last_activity_date": 1558566624, "creation_date": 1558565182, "last_edit_date": 1558566624, "question_id": 56265914, "link": "https://stackoverflow.com/questions/56265914/can-not-import-data-stream-in-haskell", "title": "Can not import Data.Stream in Haskell", "body": "<p>Why can't I import Data.Stream in Haskell?</p>\n\n<pre><code>Prelude&gt; import Data.Stream\n\n&lt;no location info&gt;: error:\n    Could not find module \u2018Data.Stream\u2019\n    Perhaps you meant Data.String (from base-4.12.0.0)\n</code></pre>\n"}, {"tags": ["list", "haskell", "filter"], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1558562143, "post_id": 56264329, "comment_id": 99147317, "body": "That point-free version is a little hairy\u2014I\u2019d prefer something like <code>selectUnless = pre (not .) . filtered (.)</code> where <code>pre = flip (.)</code> and <code>filtered = (`on` filter)</code>, or the partially point-free version <code>filter (f &lt;&amp;&amp;&gt; not . g)</code> in the answer by Rein Henrichs"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1558562501, "last_edit_date": 1558562501, "creation_date": 1558556029, "answer_id": 56264329, "question_id": 56264267, "link": "https://stackoverflow.com/questions/56264267/haskell-list-filtering-with-two-arguments/56264329#56264329", "title": "Haskell list filtering with two arguments", "body": "<p>Haskell has a <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:not\" rel=\"nofollow noreferrer\"><strong><code>not :: Bool -&gt; Bool</code></strong></a> operator that transforms <code>True</code> into <code>False</code> and vice versa.</p>\n\n<p>The problem is of course that <code>gx</code> is <em>not</em> a <code>Bool</code>, but a function <code>t -&gt; Bool</code>. We can however construct a function like:</p>\n\n<pre><code>\\x -&gt; not (gx x)\n</code></pre>\n\n<p>This will thus apply <code>not</code> to the result of <code>gx x</code>. Or we can use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:.\" rel=\"nofollow noreferrer\"><strong><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code></strong></a>, like:</p>\n\n<pre><code>selectUnless :: (t -&gt; Bool) -&gt; (t -&gt; Bool) -&gt; [t] -&gt; [t]\nselectUnless fx gx = filter (<b>not . gx</b>) . filter fx</code></pre>\n\n<p>We can even make thus completely point-free by using <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Applicative.html#v:liftA2\" rel=\"nofollow noreferrer\"><strong><code>liftA2 :: Applicative f =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c</code></strong></a>:</p>\n\n<pre><code>import Control.Applicative(liftA2)\n\nselectUnless :: (t -&gt; Bool) -&gt; (t -&gt; Bool) -&gt; [t] -&gt; [t]\nselectUnless = (filter .) . (. (not .)) . liftA2 (&amp;&amp;)</code></pre>\n\n<p>or a more elegant solution provided by <a href=\"https://stackoverflow.com/questions/56264267/haskell-list-filtering-with-two-arguments/56264329?noredirect=1#comment99147317_56264329\">@JonPurdy</a>:</p>\n\n<pre><code>import Control.Applicative(liftA2)\nimport Data.Function(on)\n\npre :: (a -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c\npre = flip (.)\n\nfiltered :: (([a] -&gt; [a]) -&gt; ([a] -&gt; [a]) -&gt; c) -&gt; (a -&gt; Bool) -&gt; (a -&gt; Bool) -&gt; c\nfiltered = (`on` filter)\n\nselectUnless :: (a -&gt; Bool) -&gt; (a -&gt; Bool) -&gt; [a] -&gt; [a]\nselectUnless = pre (not .) . filtered (.)</code></pre>\n\n<p>Note that your original code could not process an empty list: indeed you only specified the <code>(x:xs)</code> pattern in your function for the list, not <code>[]</code>. It is not necessary however to use extra patterns here, <code>filter</code> already can handle both empty and non-empty lists.</p>\n"}, {"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1558562245, "post_id": 56264382, "comment_id": 99147346, "body": "That operator is even more handy with a <code>Monad</code> constraint to make it properly short-circuiting: <code>a &lt;&amp;&amp;&gt; b = a &gt;&gt;= \\case True -&gt; b; False -&gt; pure False</code> (and analogously for <code>&lt;||&gt;</code>)"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1558566631, "post_id": 56264382, "comment_id": 99148380, "body": "@JonPurdy As <a href=\"https://stackoverflow.com/questions/55854726/how-to-nicely-denote-the-alternative-of-three-conditions/55854925#55854925\">was pointed out to me</a> when I said the same thing... to myself... the <code>(-&gt;) r</code> Applicative is already short-circuiting. You would only need to do this if you want it to be short-circuiting with arbitrary Monads."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1558571587, "post_id": 56264382, "comment_id": 99149286, "body": "Right, I should have clarified that this <i>does</i> do short-circuiting evaluation, just not <i>execution</i> of effects for other choices of <code>m</code>"}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 4, "last_activity_date": 1558556263, "creation_date": 1558556263, "answer_id": 56264382, "question_id": 56264267, "link": "https://stackoverflow.com/questions/56264267/haskell-list-filtering-with-two-arguments/56264382#56264382", "title": "Haskell list filtering with two arguments", "body": "<p>Because <code>filter f . filter g = filter (\\x -&gt; f x &amp;&amp; g x)</code>, we only need some way to invert <code>g</code>. This exists as <code>not</code>, as Willem mentions. So we have:</p>\n\n<pre><code>selectUnless f g = filter (\\x -&gt; f x &amp;&amp; not (g x))\n</code></pre>\n\n<p>If you want to be a bit more clever, you can lift <code>&amp;&amp;</code>:</p>\n\n<pre><code>(&lt;&amp;&amp;&gt;) = liftA2 (&amp;&amp;)\ninfixr 3 &lt;&amp;&amp;&gt;\n\nselectUnless f g = filter (f &lt;&amp;&amp;&gt; not . g) \n</code></pre>\n\n<p>You might even decide that this is concise and intention-revealing enough to not need its own name.</p>\n"}], "owner": {"reputation": 39, "user_id": 11248089, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HvqPECHw034/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rda3KbdXlEBYuEdWw0eSbzfv3gQhQ/mo/photo.jpg?sz=128", "display_name": "xentaquadrin", "link": "https://stackoverflow.com/users/11248089/xentaquadrin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 56264329, "answer_count": 2, "score": 0, "last_activity_date": 1558601664, "creation_date": 1558555738, "last_edit_date": 1558601664, "question_id": 56264267, "link": "https://stackoverflow.com/questions/56264267/haskell-list-filtering-with-two-arguments", "title": "Haskell list filtering with two arguments", "body": "<p>I have to write a function, which filters with one argument that results <code>True</code>, then filters with another argument which results <code>False</code></p>\n\n<p>I tried this:</p>\n\n<pre><code>selectUnless :: (t -&gt; Bool) -&gt; (t -&gt; Bool) -&gt; [t] -&gt; [t]\nselectUnless fx gx (x:xs) = filter gx (filter fx (x:xs))\n</code></pre>\n\n<p>But I need that list where \"not gx\".</p>\n\n<p>For example:</p>\n\n<pre><code>selectUnless (&gt;= 2) (==2) [1,2,3,4] == [3,4]\nselectUnless even odd [1..50] == [2,4..50]\n</code></pre>\n"}, {"tags": ["function", "haskell", "lambda", "filter", "higher-order-functions"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1558543767, "post_id": 56261571, "comment_id": 99139662, "body": "What exactly you do not understand here?"}, {"owner": {"reputation": 101, "user_id": 11493867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b70e3500af8bde8fc6b7b7d862e08b?s=128&d=identicon&r=PG&f=1", "display_name": "alekq", "link": "https://stackoverflow.com/users/11493867/alekq"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558543949, "post_id": 56261571, "comment_id": 99139767, "body": "I can&#39;t put any example argument to make it works"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558544007, "post_id": 56261571, "comment_id": 99139790, "body": "did you derive what the type is of <code>elim</code>?"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1558544062, "post_id": 56261571, "comment_id": 99139815, "body": "You&#39;re most of the way there. You have <code>filter (\\p -&gt; &lt;known&gt; &amp;&amp; &lt;known&gt;) ps</code>. Do you know what <code>filter</code> does?"}, {"owner": {"reputation": 101, "user_id": 11493867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b70e3500af8bde8fc6b7b7d862e08b?s=128&d=identicon&r=PG&f=1", "display_name": "alekq", "link": "https://stackoverflow.com/users/11493867/alekq"}, "edited": false, "score": 0, "creation_date": 1558544104, "post_id": 56261571, "comment_id": 99139842, "body": "yes,   :: (Eq a, Foldable t, Foldable t1, Foldable t2) =&gt;      t a -&gt; t1 a -&gt; [t2 a] -&gt; [t2 a]"}, {"owner": {"reputation": 101, "user_id": 11493867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b70e3500af8bde8fc6b7b7d862e08b?s=128&d=identicon&r=PG&f=1", "display_name": "alekq", "link": "https://stackoverflow.com/users/11493867/alekq"}, "edited": false, "score": 0, "creation_date": 1558544179, "post_id": 56261571, "comment_id": 99139877, "body": "yes, i think i quite know how filter work, but i don&#39;t understand how it works with (True) or (False)"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 1, "creation_date": 1558544202, "post_id": 56261571, "comment_id": 99139888, "body": "For clarity you could also say <code>:: (Eq a) =&gt; [a] -&gt; [a] -&gt; [[a]] -&gt; [[a]]</code>"}, {"owner": {"reputation": 101, "user_id": 11493867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b70e3500af8bde8fc6b7b7d862e08b?s=128&d=identicon&r=PG&f=1", "display_name": "alekq", "link": "https://stackoverflow.com/users/11493867/alekq"}, "reply_to_user": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1558544335, "post_id": 56261571, "comment_id": 99139955, "body": "oh @DarthFennec its a good hint"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 1, "creation_date": 1558545488, "post_id": 56261571, "comment_id": 99140435, "body": "&quot;yes, i think i quite know how filter work, but i don&#39;t understand how it works with (True) or (False)&quot; I&#39;m not sure what you&#39;re confused about. <code>filter</code> takes a function that returns a <code>True</code> or <code>False</code>, that&#39;s how it knows what to filter. You have an expression that is <code>True</code> iff everything in <code>b</code> is in <code>p</code>, and you have an expression that is <code>True</code> iff nothing in <code>w</code> is in <code>p</code>. You&#39;re filtering out <code>p</code>s that don&#39;t pass both of these tests."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 3, "last_activity_date": 1558552191, "last_edit_date": 1558552191, "creation_date": 1558547848, "answer_id": 56262488, "question_id": 56261571, "link": "https://stackoverflow.com/questions/56261571/filter-function-in-nonogram-solver/56262488#56262488", "title": "Filter function in nonogram solver", "body": "<p>First, help yourself to a little whitespace to aid understanding, and name your subexpressions:</p>\n\n<pre><code>elim b w ps = filter (\\p -&gt; all (\\x -&gt; x `elem`    p) b  &amp;&amp;\n                            all (\\x -&gt; x `notElem` p) w\n                       ) ps\n\n            = filter foo ps\n                where\n                   foo p =  all (\\x -&gt; x `elem`    p) b  &amp;&amp;\n                            all (\\x -&gt; x `notElem` p) w\n\n            = filter foo ps\n                where\n                   foo p =  all tst1 b  &amp;&amp;  all tst2 w\n                      where\n                         tst1 = (\\x -&gt; x `elem`    p)\n                         tst2 = (\\x -&gt; x `notElem` p)\n\n            = filter foo ps\n                where\n                   foo p =  (&amp;&amp;)  (all tst1 b)  (all tst2 w)\n                      where\n                         tst1 x = elem    x p\n                         tst2 y = notElem y p\n</code></pre>\n\n<p>Now what does that do? Or better yet, what is it? Let's go by some types to build up our insight here:</p>\n\n<pre><code>filter :: (a -&gt;                Bool) -&gt; [a] -&gt; [a]\nfoo    ::  a -&gt;                Bool\nps     ::                               [a]\nfilter    foo                           ps  :: [a]\np      ::  a\nfoo        p                :: Bool\n(&amp;&amp;)        :: Bool -&gt; Bool -&gt; Bool\nall tst1 b  :: Bool\nall tst2 w  ::         Bool\n---------------------------\nall  :: (t -&gt; Bool) -&gt; [t] -&gt; Bool\ntst1 ::  t -&gt; Bool\ntst2 ::  t -&gt; Bool\nb    ::                [t]\nw    ::                [t]\n---------------------------\n......\n---------------------------\nelim             b      w               ps  :: [a]\nelim ::         [t] -&gt; [t] -&gt;           [a] -&gt; [a]          \n</code></pre>\n\n<p>Complete the picture by working through the types of <code>tst1</code> and <code>tst2</code> to find out the relationship between the <code>t</code> and <code>a</code> types.</p>\n\n<hr>\n\n<pre><code>tst1    ::         t        -&gt; Bool          -- tst1 x = elem    x p\ntst2    ::         t        -&gt; Bool          -- tst2 y = notElem y p\nx       ::         t\ny       ::         t\nelem    :: Eq t =&gt; t -&gt; [t] -&gt; Bool\nnotElem :: Eq t =&gt; t -&gt; [t] -&gt; Bool\np       ::              [t]                  -- it was : a !\n</code></pre>\n\n<p>Thus <code>a ~ [t]</code> and <code>[a] ~ [[t]]</code> and finally,</p>\n\n<pre><code>elim             b      w               ps  :: [[t]]\nelim :: Eq t =&gt; [t] -&gt; [t] -&gt;         [[t]] -&gt; [[t]] \n</code></pre>\n\n<p>So then <code>filter foo</code> leaves only those <code>p</code>s in <code>ps</code> for which <code>foo p == True</code>. </p>\n\n<p>And that means <code>all tst1 b == True</code> <em>and</em>  <code>all tst2 w == True</code>.</p>\n\n<p>And that means, every <code>x</code> in <code>b</code> is an element of <code>p</code>, and every <code>y</code> in <code>w</code> is <em>not</em> an element in <code>p</code>. Or in other words only such <code>p</code>s in <code>ps</code> are left alone in the resulting list for which </p>\n\n<pre><code>foo p =  (b \\\\ p) == []   &amp;&amp;   (p \\\\ w) == p\n</code></pre>\n\n<p>holds:</p>\n\n<pre><code>import Data.List (\\\\)\n\nelim b w ps = [ p | p &lt;- ps, (b \\\\ p) == [], (p \\\\ w) == p ]\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 11493867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b70e3500af8bde8fc6b7b7d862e08b?s=128&d=identicon&r=PG&f=1", "display_name": "alekq", "link": "https://stackoverflow.com/users/11493867/alekq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 56262488, "answer_count": 1, "score": -1, "last_activity_date": 1558552191, "creation_date": 1558543597, "last_edit_date": 1558546001, "question_id": 56261571, "link": "https://stackoverflow.com/questions/56261571/filter-function-in-nonogram-solver", "title": "Filter function in nonogram solver", "body": "<p>I have to understand the Deductive solver By Ted Yin from <a href=\"https://wiki.haskell.org/Nonogram\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Nonogram</a></p>\n\n<p>i don't know how </p>\n\n<pre><code>elim b w ps = filter (\\p -&gt; all (\\x -&gt; x `elem` p) b &amp;&amp;\n                            all (\\x -&gt; x `notElem` p) w) ps\n</code></pre>\n\n<p>works. I only know that </p>\n\n<pre><code>all (\\x -&gt; x `notElem` [1]) [1,2,3,4]\n</code></pre>\n\n<p>gives <code>False</code>, and </p>\n\n<pre><code>all (\\x -&gt; x `elem` [1]) [1,1,1,1]\n</code></pre>\n\n<p>gives <code>True</code>.</p>\n\n<p>but i don't know hot to run all <code>elim</code> function and how it works</p>\n"}, {"tags": ["haskell", "compiler-errors", "ghc"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 4, "creation_date": 1558542695, "post_id": 56261282, "comment_id": 99139202, "body": "it&#39;s just a requirement for each function to have the same number of arguments specified in every clause of its definition. someone will probably explain why, but you can just treat is as a compiler requirement. you can change the second clause to <code>revList xs = go [] xs ...</code> and it will compile."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1558542817, "post_id": 56261282, "comment_id": 99139253, "body": "Or you could remove the first clause entirely. It isn&#39;t necessary."}, {"owner": {"reputation": 1762, "user_id": 3760519, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/92f83bbbf421e12a53e8111040d3d280?s=128&d=identicon&r=PG&f=1", "display_name": "Chechy Levas", "link": "https://stackoverflow.com/users/3760519/chechy-levas"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1558542865, "post_id": 56261282, "comment_id": 99139270, "body": "@Carl I said as much in the question."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1558543036, "post_id": 56261282, "comment_id": 99139347, "body": "I always figured this was a requirement because mismatched numbers of arguments are nearly always a sign of missing parentheses or another easy-to-miss syntactic oversight. Of course in those cases it would most likely fail with a type mismatch or something, but it might be more difficult to trace the source of that kind of error."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 2, "creation_date": 1558543587, "post_id": 56261282, "comment_id": 99139572, "body": "&quot;Also, I thought I could put has many patterns as I like, and the first match will be chosen.&quot; You&#39;re correct. If there&#39;s a runtime error on your second pattern, but a call to the function matches the first pattern, you won&#39;t get an error. But this is a compile-time error, and all compile-time errors are presented during compilation. This is actually great, because it means you don&#39;t need to test every code path to catch most errors, like you do in Python or Javascript."}], "owner": {"reputation": 1762, "user_id": 3760519, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/92f83bbbf421e12a53e8111040d3d280?s=128&d=identicon&r=PG&f=1", "display_name": "Chechy Levas", "link": "https://stackoverflow.com/users/3760519/chechy-levas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "closed_date": 1558542728, "answer_count": 0, "score": 0, "last_activity_date": 1558552648, "creation_date": 1558542420, "last_edit_date": 1558552648, "question_id": 56261282, "link": "https://stackoverflow.com/questions/56261282/haskell-why-does-ghc-complain-that-equations-for-revlist-have-different-numb", "closed_reason": "Duplicate", "title": "Haskell: why does GHC complain that &quot;Equations for \u2018revList\u2019 have different numbers of arguments&quot;?", "body": "<p>Why is the following not allowed?</p>\n\n<pre><code>revList :: [Integer] -&gt; [Integer]\nrevList [] = []\nrevList = go []\n    where \n        go acc [] = acc\n        go acc (x:xs) = go (x:acc) xs\n</code></pre>\n\n<p>I get that removing the second line lets is compile, but I'd like to understand why. The type for <code>revList</code> is the same for both definitions, no? Also, I thought I could put has many patterns as I like, and the first match will be chosen. So I don't quite understand what is the problem here.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 3, "creation_date": 1558540552, "post_id": 56260738, "comment_id": 99138029, "body": "Where are you getting your type for <code>f</code> from? Same question for the type of <code>g x</code>. Also, why are you looking at either of those? If all you want to know is the type of <code>square (f (g x))</code> and you already know that <code>square :: Int -&gt; Int</code> then <code>square (f (g x))</code> must be <code>Int</code> assuming everything typechecks, regardless of what the types of <code>f</code>, <code>g</code> or <code>x</code> are."}, {"owner": {"reputation": 257, "user_id": 10654327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93dc6d9196997587c8bbdf9ba4cc7fa?s=128&d=identicon&r=PG&f=1", "display_name": "heisenberg7584", "link": "https://stackoverflow.com/users/10654327/heisenberg7584"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1558540800, "post_id": 56260738, "comment_id": 99138188, "body": "true but i need type of whole expression (most general type) not just the type of its result"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 3, "creation_date": 1558541105, "post_id": 56260738, "comment_id": 99138351, "body": "The most general type of the expression is <code>Int</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1558551372, "post_id": 56260738, "comment_id": 99142944, "body": "@heisenberg7584 In almost all modern type systems, the type of a whole expression is <i>less general</i> than the type of its result."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 4, "last_activity_date": 1558544190, "creation_date": 1558544190, "answer_id": 56261719, "question_id": 56260738, "link": "https://stackoverflow.com/questions/56260738/find-type-of-square-f-g-x-in-haskell/56261719#56261719", "title": "Find type of square (f (g x)) in Haskell", "body": "<p>You are overgeneralizing in some way I don't quite follow.</p>\n\n<p>If you are stating that <code>x :: b</code>, then if you can apply <code>g</code> to <code>x</code>, <code>g :: b -&gt; c</code> for some type <code>c</code>.</p>\n\n<p>Similarly, since you can apply <code>f</code> to <code>g x</code>, then <code>f :: c -&gt; d</code> for some type <code>d</code>; it's argument type must be the same as the return type of <code>g</code>.</p>\n\n<p>Finally, you know that <code>square :: Int -&gt; Int</code> and that you can apply <code>square</code> to the return value of <code>f</code>. That means <code>f :: c -&gt; Int</code> by unifying the return type of <code>f</code> with the argument type of <code>square</code>.</p>\n\n<p>That's as far as you can go, though:</p>\n\n<pre><code>square :: Int -&gt; Int\nf :: c -&gt; Int\ng :: b -&gt; c\nx :: b\n</code></pre>\n\n<p>You then know that <code>g x :: c</code> and <code>f (g x) :: Int</code>, meaning <code>square (f (g x)) :: Int</code> as well.</p>\n"}], "owner": {"reputation": 257, "user_id": 10654327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93dc6d9196997587c8bbdf9ba4cc7fa?s=128&d=identicon&r=PG&f=1", "display_name": "heisenberg7584", "link": "https://stackoverflow.com/users/10654327/heisenberg7584"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 56261719, "answer_count": 1, "score": -2, "last_activity_date": 1558544190, "creation_date": 1558540394, "question_id": 56260738, "link": "https://stackoverflow.com/questions/56260738/find-type-of-square-f-g-x-in-haskell", "title": "Find type of square (f (g x)) in Haskell", "body": "<p>Hello I have a problem with finding type for square (f (g x)). Here is what I have.</p>\n\n<pre><code>square :: Int -&gt; Int\n{x : b} |- g x :: (b -&gt; c) -&gt; c\nf :: (((b -&gt; c) -&gt; c) -&gt; d) -&gt; d\n</code></pre>\n\n<p>I am a bit confused if it's correct and what now. <code>d</code> must be an <code>Int</code> as well as whole expression <code>(((b -&gt; c) -&gt; c) -&gt; d)</code> but I feel like I did sth wrong here...</p>\n"}, {"tags": ["haskell", "random", "io", "io-monad", "do-notation"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1558522991, "post_id": 56255158, "comment_id": 99127450, "body": "<code>randSubset</code> creates an <code>IO [Char]</code>, so you can not iterate over that."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1558523312, "post_id": 56255158, "comment_id": 99127600, "body": "Have you learnt how to use monads and <code>do</code>-notation? You&#39;ll find all IO fairly difficult until you grok that. I&#39;d recommend <a href=\"http://learnyouahaskell.com/a-fistful-of-monads\" rel=\"nofollow noreferrer\">the LYAH chapter on monads</a> if not the entirety of LYAH to understand this."}, {"owner": {"reputation": 85, "user_id": 8050257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69b113c8f08b4bb6c2a0dd7459bfee06?s=128&d=identicon&r=PG&f=1", "display_name": "Enirsa", "link": "https://stackoverflow.com/users/8050257/enirsa"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558523324, "post_id": 56255158, "comment_id": 99127607, "body": "@Willem Van Onsem, you&#39;re right! In fact, I don&#39;t even want to iterate over that. I just want to take the whole subsets (new every time) and place them into the cells n*n times. How do I do that?"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1558526150, "last_edit_date": 1558526150, "creation_date": 1558523409, "answer_id": 56255495, "question_id": 56255158, "link": "https://stackoverflow.com/questions/56255158/random-grid-of-elements-using-haskell/56255495#56255495", "title": "Random grid of elements using Haskell", "body": "<p>Like the error already says, your list comprehension has a generator:</p>\n\n<pre><code>formGrid n = [[subset | _ &lt;- [0..(n - 1)], <b>subset &lt;- randSubset</b>] | _ &lt;- [0..(n - 1)]]</code></pre>\n\n<p>So that means that it expects <code>randSubset</code> to be a list of something, but it is not a list of something, it is an <code>IO</code> of a list of something. You thus can not use that.</p>\n\n<p>The type of your function is also a bit problematic, you use <code>[[IO [Char]]]</code>, so a matrix of <code>IO [Char]</code>s.</p>\n\n<p>You are likely looking for <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Monad.html#v:replicateM\" rel=\"nofollow noreferrer\"><strong><code>replicateM :: Monad m =&gt; Int -&gt; m a -&gt; m [a]</code></strong></a>, so then your program looks like:</p>\n\n<pre><code>import Control.Monad(<b>replicateM</b>)\n\nformGrid :: Int -&gt; <b>IO [[[Char]]]</b>\nformGrid n = <B>replicateM n</b> (<b>replicateM n</b> randSubset)</code></pre>\n\n<p>For example:</p>\n\n<pre><code>Main&gt; formGrid 3\n[[\"WSNE\",\"WNS\",\"S\"],[\"WN\",\"SN\",\"WEN\"],[\"SEWN\",\"ESN\",\"NESW\"]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1558527464, "creation_date": 1558527464, "answer_id": 56256630, "question_id": 56255158, "link": "https://stackoverflow.com/questions/56255158/random-grid-of-elements-using-haskell/56256630#56256630", "title": "Random grid of elements using Haskell", "body": "<p>To complement Willem's answer, I'll add that your <code>randSubset</code> looks rather complex. Here's a simpler alternative</p>\n\n<pre><code>randSubset :: IO String\nrandSubset = do\n  n &lt;- sample (Uniform 1 4)        -- choose how many elements\n  sample (shuffleNofM n 4 \"NSWE\")  -- take that many elements\n</code></pre>\n\n<p>(That's <code>sample</code> from <code>Data.Random</code>, by the way)</p>\n\n<p>You should check that this is indeed the intended distribution of subsets. Note that this is not a uniform distribution: <code>N</code> is more likely than <code>NS</code> (or even both <code>NS</code> and <code>SN</code> combined). Also note that each permutation of the same subset can occur, so we are not really sampling \"subsets\". I don't know which distribution is used by your Python code -- it might be the same, after all.</p>\n\n<p>If you work inside <code>IO</code>, I think it's simpler if you use <code>sample (someDistribution)</code> rather than working at the lower level of <code>RVar</code>s.</p>\n\n<p>After this, you can use <code>replicateM</code> to generate your grid, as Willem showed.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1559492537, "creation_date": 1559492537, "answer_id": 56416813, "question_id": 56255158, "link": "https://stackoverflow.com/questions/56255158/random-grid-of-elements-using-haskell/56416813#56416813", "title": "Random grid of elements using Haskell", "body": "<p>You tried to jump too far at once. Start small, </p>\n\n<pre><code>formRow :: Int -&gt; IO [[Char]]\nformRow 0 = return [] \nformRow n = do { \n     subset  &lt;- randSubset ;     -- subset :: [Char]   &lt;-  randSubset :: IO [Char]\n     subsets &lt;- formRow (n-1) ;  --           ~~~~~~                        ~~~~~~\n     return (subset : subsets)   -- IO [[Char]]\n     }\n</code></pre>\n\n<p>... just using what you already have, here. Then do the same with the rows,</p>\n\n<pre><code>formGrid :: Int -&gt; IO [[[Char]]]\nformGrid 0 = return [] \nformGrid n = do { \n     row  &lt;- formRow n ;        -- row :: [[Char]]   &lt;-  formRow n :: IO [[Char]]\n     rows &lt;- formGrid (n-1) ;   --        ~~~~~~~~                       ~~~~~~~~\n     return (row : rows)        -- IO [[[Char]]]\n     }\n</code></pre>\n\n<p>and you're done. Don't fear the <em><code>do</code></em> notation, it's your friend. It is easy to program in, as it is its whole purpose.</p>\n\n<p>When you've coded your next monadic combinator, check out its type <a href=\"https://hoogle.haskell.org/?hoogle=Int%20-%3E%20IO%20a%20-%3E%20IO%20%5Ba%5D\" rel=\"nofollow noreferrer\">on Hoogle</a> and see whether it already is in the library. </p>\n\n<p>Indeed, abstracting, we see we've reimplemented</p>\n\n<pre><code>replicateM :: Monad m =&gt; Int -&gt; m a -&gt; m [a]\n\nformRow n = replicateM n randSubset \nformGrid n = replicateM n (formRow n)\n           = replicateM n (replicateM n randSubset)\n</code></pre>\n\n<p>(just as Willem's answer says; but now we know <em>how</em> and <em>why</em>).</p>\n"}], "owner": {"reputation": 85, "user_id": 8050257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69b113c8f08b4bb6c2a0dd7459bfee06?s=128&d=identicon&r=PG&f=1", "display_name": "Enirsa", "link": "https://stackoverflow.com/users/8050257/enirsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 56255495, "answer_count": 3, "score": 2, "last_activity_date": 1559492537, "creation_date": 1558522254, "last_edit_date": 1559492453, "question_id": 56255158, "link": "https://stackoverflow.com/questions/56255158/random-grid-of-elements-using-haskell", "title": "Random grid of elements using Haskell", "body": "<p>Having absolutely zero experience with Haskell, I need to come up with a code equivalent to this Python one:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>from random import choice, sample\n\ndef random_subset():\n    return tuple(sample(('N', 'S', 'W', 'E'), choice((1, 2, 3, 4))))\n\ndef form_grid(n):\n    return [[random_subset() for _ in range(n)] for _ in range(n)]\n\nform_grid(10)\n</code></pre>\n\n<p>which produces something like this:</p>\n\n<pre><code>N     ESWN  SNEW  NSE   EWSN  E     ENSW  N     NSWE  WES   \nNE    WNS   SWEN  EWN   ENWS  WEN   WS    W     ENSW  NW    \nWENS  NWE   SNEW  ES    E     S     ES    SENW  EW    WEN   \nNSE   NE    WNE   NEWS  SNE   W     SWNE  NSWE  SNEW  EN    \nS     SNW   WNES  S     WESN  E     ES    N     ESN   ES    \nSWEN  S     WSNE  NEWS  WESN  E     S     SE    E     N     \nNEW   S     NEW   WS    W     EN    N     NWS   E     WENS  \nWN    NWE   S     SEW   NESW  EWSN  WENS  ES    NWS   WN    \nW     NWE   N     N     ES    E     E     WN    SWNE  NES   \nWENS  NWE   NW    WESN  SW    NES   ENWS  SE    N     SWNE \n</code></pre>\n\n<p>I, for the love of god, can't wrap my head around Haskell's concept of IO (randomness in particular). The best I could come up with is this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Random hiding (shuffle, sample)\nimport Data.Random.Source.Std\nimport Data.Random.Extras\n\nrandSubset :: IO [Char]\nrandSubset = do\n    len &lt;- runRVar (choice [1..4]) StdRandom :: IO Int\n    subset &lt;- runRVar (sample len ['N', 'S', 'W', 'E']) StdRandom :: IO [Char]\n    return subset\n\nformGrid :: Int -&gt; [[IO [Char]]]\nformGrid n = [[subset | _ &lt;- [0..(n - 1)], subset &lt;- randSubset] | _ &lt;- [0..(n - 1)]]\n</code></pre>\n\n<p>which still didn't do it:</p>\n\n<pre><code>error:\n    * Couldn't match expected type `[IO [Char]]'\n                  with actual type `IO [Char]'\n    * In the expression: randSubset\n      In a stmt of a list comprehension: subset &lt;- randSubset\n      In the expression:\n        [subset | _ &lt;- [0 .. (n - 1)], subset &lt;- randSubset]\n   |\n12 | formGrid n = [[subset | _ &lt;- [0..(n - 1)], subset &lt;- randSubset] | _ &lt;- [0..(n - 1)]]\n   |                                                      ^^^^^^^^^^\n</code></pre>\n\n<p>Quick googling didn't help much - I probably didn't use the most accurate keywords for this problem I'm facing. Making random changes and hoping for the best is getting pretty frustrating, but I really have neither time, nor energy to dive into Haskell properly (even though it's a shame), so for now, I'd love someone to just point me to what's wrong with this code.</p>\n"}, {"tags": ["haskell", "functional-programming", "tree", "abstract-syntax-tree", "gadt"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 3, "creation_date": 1558460793, "post_id": 56243730, "comment_id": 99106220, "body": "The error mentions <code>Operator</code> but it is nowhere in your definition. Also, add a type signature to top-level functions <code>eval :: Tree l -&gt; l</code>. This is generally considered good practice, but especially with GADTs this is crucial because that type is not inferred."}, {"owner": {"reputation": 443, "user_id": 5708707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7be52081ff7ad4f03fae7c0dab0872f?s=128&d=identicon&r=PG&f=1", "display_name": "OctarineSorcerer", "link": "https://stackoverflow.com/users/5708707/octarinesorcerer"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1558461031, "post_id": 56243730, "comment_id": 99106322, "body": "Ah yes, the error thing was from other experimentation. I&#39;ll just sort that out a minute, and update the question. Didn&#39;t know about the type signature, I&#39;ll do that!"}, {"owner": {"reputation": 443, "user_id": 5708707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7be52081ff7ad4f03fae7c0dab0872f?s=128&d=identicon&r=PG&f=1", "display_name": "OctarineSorcerer", "link": "https://stackoverflow.com/users/5708707/octarinesorcerer"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1558461756, "post_id": 56243730, "comment_id": 99106656, "body": "Oh wow! Defining <code>eval</code> as ``` eval :: Tree a -&gt; a eval (Leaf l) = l eval (Operation left op right) = op (eval left) (eval right) ``` worked fine! Much appreciated. If you write your comment as an answer, I&#39;ll happily accept it. Though, could you explain why types aren&#39;t inferred for GADTs? I&#39;m still a little confused with them"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1558465748, "post_id": 56243730, "comment_id": 99108292, "body": "GADTs are too complex to infer types, and IIRC in some cases multiple types could be inferred. We need the programmer to specify the type during elimination (pattern matching). E.g. <code>foo Refl x = x</code> could have type <code>foo :: (a:~:b) -&gt; a -&gt; b</code> and <code>foo :: (a:~:b) -&gt; b -&gt; a</code> and <code>foo :: (a:~:b) -&gt; a -&gt; a</code> and <code>foo :: (a:~:b) -&gt; b -&gt; b</code> or even <code>foo :: (a:~:b) -&gt; c -&gt; c</code>. Which one should be inferred? It&#39;s impossible to guess what the user wanted."}, {"owner": {"reputation": 1290, "user_id": 5499871, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206799318615183/picture?type=large", "display_name": "Izaak Weiss", "link": "https://stackoverflow.com/users/5499871/izaak-weiss"}, "edited": false, "score": 0, "creation_date": 1558466383, "post_id": 56243730, "comment_id": 99108620, "body": "You should answer your own question so that this shows up as having an answer."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1558479058, "post_id": 56243730, "comment_id": 99112860, "body": "you should put the answer in the answer section, not the question section."}], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 13, "last_activity_date": 1558466932, "creation_date": 1558466932, "answer_id": 56245212, "question_id": 56243730, "link": "https://stackoverflow.com/questions/56243730/how-to-evaluate-this-generic-abstract-syntax-tree-in-haskell/56245212#56245212", "title": "How to evaluate this generic abstract syntax tree in Haskell?", "body": "<p>Add a type signature to top-level functions:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>eval :: Tree l -&gt; l\n</code></pre>\n\n<p>This is generally considered good practice, but this is especially crucial with GADTs because that type is not inferred otherwise.</p>\n"}], "owner": {"reputation": 443, "user_id": 5708707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7be52081ff7ad4f03fae7c0dab0872f?s=128&d=identicon&r=PG&f=1", "display_name": "OctarineSorcerer", "link": "https://stackoverflow.com/users/5708707/octarinesorcerer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "accepted_answer_id": 56245212, "answer_count": 1, "score": 3, "last_activity_date": 1558511104, "creation_date": 1558460454, "last_edit_date": 1558511104, "question_id": 56243730, "link": "https://stackoverflow.com/questions/56243730/how-to-evaluate-this-generic-abstract-syntax-tree-in-haskell", "title": "How to evaluate this generic abstract syntax tree in Haskell?", "body": "<p>I've been interested in seeing if I can make a very simple AST that consists of operations and leaf nodes. But more specifically, I'd like to be able to use any type as the leaf node, as opposed to explicitly specifying it in the AST data type itself, like this.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- Instead of this\ndata Tree = Number Int | Word String | Operation Tree (Tree -&gt; Tree -&gt; Tree) Tree\n\n-- I'd like something along the lines of this\ndata Tree a = Leaf a | Operation Tree (Tree -&gt; Tree -&gt; Tree) Tree\n</code></pre>\n\n<p>This isn't necessarily of great practicality, but it's something that I want to see if it's possible. The closest I've managed thus far has required me to fumble about some with the concept of GADTs:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE GADTs #-}\n\ndata Tree l where\n  Leaf :: l -&gt; Tree l\n  Operation :: Tree a -&gt; (a -&gt; b -&gt; c) -&gt; Tree b -&gt; Tree c\n\nlet fivePlus2 = Operation (Leaf 5) (+) (Leaf 2)\n\neval (Leaf l) = l\neval (Operation left op right) = op (eval left) (eval right)\n</code></pre>\n\n<p>With the idea that I could run <code>eval fivePlus2</code>, and get 7. However, the defining eval for Operation (that last line) results in the following very obscure error:</p>\n\n<pre><code>&lt;interactive&gt;:187:38: error:\n    \u2022 Couldn't match type \u2018a\u2019 with \u2018p\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n        a pattern with constructor:\n          Operation :: forall a b c.\n                       Tree a -&gt; (a -&gt; b -&gt; c) -&gt; Tree b -&gt; Tree c,\n        in an equation for \u2018eval\u2019\n        at &lt;interactive&gt;:187:7-29\n      \u2018p\u2019 is a rigid type variable bound by\n        the inferred type of eval :: Tree p -&gt; p\n        at &lt;interactive&gt;:187:1-60\n      Expected type: Tree a -&gt; a\n        Actual type: Tree p -&gt; p\n    \u2022 In the first argument of \u2018op\u2019, namely \u2018(eval left)\u2019\n      In the expression: op (eval left) (eval right)\n      In an equation for \u2018eval\u2019:\n          eval (Operation left op right) = op (eval left) (eval right)\n    \u2022 Relevant bindings include\n        op :: a -&gt; b -&gt; p (bound at &lt;interactive&gt;:187:22)\n        left :: Tree a (bound at &lt;interactive&gt;:187:17)\n        eval :: Tree p -&gt; p (bound at &lt;interactive&gt;:187:1)\n\n&lt;interactive&gt;:187:50: error:\n    \u2022 Couldn't match type \u2018b\u2019 with \u2018p\u2019\n      \u2018b\u2019 is a rigid type variable bound by\n        a pattern with constructor:\n          Operation :: forall a b c.\n                       Tree a -&gt; (a -&gt; b -&gt; c) -&gt; Tree b -&gt; Tree c,\n        in an equation for \u2018eval\u2019\n        at &lt;interactive&gt;:187:7-29\n      \u2018p\u2019 is a rigid type variable bound by\n        the inferred type of eval :: Tree p -&gt; p\n        at &lt;interactive&gt;:187:1-60\n      Expected type: Tree b -&gt; b\n        Actual type: Tree p -&gt; p\n    \u2022 In the second argument of \u2018op\u2019, namely \u2018(eval right)\u2019\n      In the expression: op (eval left) (eval right)\n      In an equation for \u2018eval\u2019:\n          eval (Operation left op right) = op (eval left) (eval right)\n    \u2022 Relevant bindings include\n        right :: Tree b (bound at &lt;interactive&gt;:187:25)\n        op :: a -&gt; b -&gt; p (bound at &lt;interactive&gt;:187:22)\n        eval :: Tree p -&gt; p (bound at &lt;interactive&gt;:187:1)\n</code></pre>\n\n<p>I'm honestly not sure at all what this means, and I'm rather out of my depth here, having initially tried this in F# and finding it wasn't expressive enough. I've not done functional programming in a while, and am very much a beginner in Haskell, so I'd greatly appreciate it if answers were explained like I was 5.</p>\n\n<p>If it turns out evaluating such a tree isn't possible, that's fine, but I'd very much like to know what the logic behind it is. Thank you!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1558474174, "post_id": 56242405, "comment_id": 99111677, "body": "I really don&#39;t understand what you&#39;re asking for. Can you try to explain more concretely, with examples? Show a recursive type and how you&#39;d write the show functions recursively by hand. It sounds like you may want to look at generics, but I can hardly guess."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1558531480, "post_id": 56242405, "comment_id": 99132326, "body": "Because of how <code>-&gt;</code> is defined, your two functions aren&#39;t as similar as they appear. <code>showFn1 :: a -&gt; b</code> while <code>showFn2 :: c -&gt; d</code> for 4 distinct types <code>a</code>, <code>b</code>, <code>c</code>, and <code>d</code>. The only thing they have in common is what <i>all</i> functions have in common: they map an argument type to a return type."}], "answers": [{"comments": [{"owner": {"reputation": 1416, "user_id": 1769679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NIcLL.png?s=128&g=1", "display_name": "Asa", "link": "https://stackoverflow.com/users/1769679/asa"}, "edited": false, "score": 0, "creation_date": 1558456249, "post_id": 56242639, "comment_id": 99104146, "body": "This is not quite what I&#39;m looking for because the values to be shown are not fixed."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1416, "user_id": 1769679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NIcLL.png?s=128&g=1", "display_name": "Asa", "link": "https://stackoverflow.com/users/1769679/asa"}, "edited": false, "score": 0, "creation_date": 1558456328, "post_id": 56242639, "comment_id": 99104177, "body": "@Asa Can you elaborate a little bit on why that changes anything? <code>spacedString</code> -- and the <code>unwords</code>+list construction version -- both still work fine if the values chosen are dynamically determined rather than literals."}, {"owner": {"reputation": 1416, "user_id": 1769679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NIcLL.png?s=128&g=1", "display_name": "Asa", "link": "https://stackoverflow.com/users/1769679/asa"}, "edited": false, "score": 0, "creation_date": 1558456378, "post_id": 56242639, "comment_id": 99104199, "body": "If it helps the <code>fnCollection</code> is part of application state and the functions in it may be called many times with different values over the life of the application. The simple way to implement this is to just implement the functions in the collection by hand, but their implementations are so regular that I would rather abstract that away if possible."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1416, "user_id": 1769679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NIcLL.png?s=128&g=1", "display_name": "Asa", "link": "https://stackoverflow.com/users/1769679/asa"}, "edited": false, "score": 0, "creation_date": 1558456807, "post_id": 56242639, "comment_id": 99104402, "body": "@Asa I see nothing incompatible between this clarification and anything in my answer."}, {"owner": {"reputation": 1416, "user_id": 1769679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NIcLL.png?s=128&g=1", "display_name": "Asa", "link": "https://stackoverflow.com/users/1769679/asa"}, "edited": false, "score": 0, "creation_date": 1558456825, "post_id": 56242639, "comment_id": 99104409, "body": "The assumption #1 requires that <code>ShowMe</code>s hold the fixed values to be constructed. In fact, I don&#39;t intend them to ever be constructed and instead be a structure that gets mapped to <code>-&gt;</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1416, "user_id": 1769679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NIcLL.png?s=128&g=1", "display_name": "Asa", "link": "https://stackoverflow.com/users/1769679/asa"}, "edited": false, "score": 0, "creation_date": 1558456911, "post_id": 56242639, "comment_id": 99104451, "body": "@Asa Ah, got it. Okay. So there&#39;s still a few things about the setup I don&#39;t understand, then. Let&#39;s start here: why does <code>ShowMe</code> exist at all (why not just use <code>-&gt;</code>)?"}, {"owner": {"reputation": 1416, "user_id": 1769679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NIcLL.png?s=128&g=1", "display_name": "Asa", "link": "https://stackoverflow.com/users/1769679/asa"}, "edited": false, "score": 0, "creation_date": 1558457013, "post_id": 56242639, "comment_id": 99104508, "body": "Because I think there is a middleman abstraction necessary for the solution of the problem, but maybe it was a confusing addition to my question. Let me rephrase it."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1558456198, "last_edit_date": 1558456198, "creation_date": 1558455896, "answer_id": 56242639, "question_id": 56242405, "link": "https://stackoverflow.com/questions/56242405/generating-functions-from-a-recursive-type/56242639#56242639", "title": "Generating functions from a recursive type", "body": "<p>I'm not super sure I understand the setup. I'm going to make a few assumptions:</p>\n\n<ol>\n<li><code>data ShowMe a b = ShowMe a b</code></li>\n<li>You want a new class which shows the two parts of a <code>ShowMe</code>, separating them by a space, so that for example <code>showFn1</code> and <code>showFn2</code> can be implemented just by dispatching to the method of this new class.</li>\n<li><code>ShowFns</code> and <code>fnCollection</code> were red herrings, part of an XY-problem, or thinkos, and can be completely ignored.</li>\n</ol>\n\n<p>Under these assumptions, here is how I would proceed:</p>\n\n<pre><code>class SpacedString a where spacedString :: a -&gt; String\ninstance SpacedString () where spacedString _ = \"\"\ninstance (Show a, SpacedString b) =&gt; SpacedString (ShowMe a b) where\n    spacedString (ShowMe a b) = show a &lt;&gt; \" \" &lt;&gt; spacedString b\n</code></pre>\n\n<p>Try it out in ghci:</p>\n\n<pre><code>&gt; spacedString (ShowMe (3 :: Int) (ShowMe True (ShowMe 2.5 ())))\n\"3 True 2.5 \"\n&gt; spacedString (ShowMe 2.5 (ShowMe 'a' ()))\n\"2.5 'a' \"\n</code></pre>\n\n<p>The extra trailing space can be eliminated if necessary by making the class method produce a list of strings and having a single top-level helper function that combines <code>unwords</code> and the class method.</p>\n\n<p>...it all seems a bit perverse, though, given how much less boilerplate code there is and how many fewer nested parentheses there are in this version:</p>\n\n<pre><code>&gt; unwords [show (3 :: Int), show True, show 2.5]\n\"3 True 2.5\"\n&gt; unwords [show 2.5, show 'a']\n\"2.5 'a'\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1416, "user_id": 1769679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NIcLL.png?s=128&g=1", "display_name": "Asa", "link": "https://stackoverflow.com/users/1769679/asa"}, "edited": false, "score": 0, "creation_date": 1558476915, "post_id": 56245520, "comment_id": 99112394, "body": "This is what I am looking for! It\u2019s good to know there is a name for this as well. Thank you for being persistent in asking for clarifications."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 7, "last_activity_date": 1558468516, "creation_date": 1558468516, "answer_id": 56245520, "question_id": 56242405, "link": "https://stackoverflow.com/questions/56242405/generating-functions-from-a-recursive-type/56245520#56245520", "title": "Generating functions from a recursive type", "body": "<p>The standard trick for implementing variadic functions looks like this:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\nclass ShowMe a where showMeRaw :: [String] -&gt; a\ninstance ShowMe String where showMeRaw = unwords . reverse\ninstance (Show a, ShowMe b) =&gt; ShowMe (a -&gt; b) where\n    showMeRaw ss a = showMeRaw (show a : ss)\n</code></pre>\n\n<p>One then normally adds a single top-level helper:</p>\n\n<pre><code>showMe :: ShowMe a =&gt; a\nshowMe = showMeRaw []\n</code></pre>\n\n<p>Then your <code>showFun1'</code> and <code>showFun2'</code> would both be just calls to <code>showMe</code>. Try it out in ghci:</p>\n\n<pre><code>&gt; (showMe :: Int -&gt; Bool -&gt; Double -&gt; String) 3 True 2.5\n\"3 True 2.5\"\n&gt; (showMe :: Double -&gt; Char -&gt; String) 2.5 'a'\n\"2.5 'a'\"\n</code></pre>\n"}], "owner": {"reputation": 1416, "user_id": 1769679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NIcLL.png?s=128&g=1", "display_name": "Asa", "link": "https://stackoverflow.com/users/1769679/asa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "accepted_answer_id": 56245520, "answer_count": 2, "score": 4, "last_activity_date": 1558468516, "creation_date": 1558455048, "last_edit_date": 1558468514, "question_id": 56242405, "link": "https://stackoverflow.com/questions/56242405/generating-functions-from-a-recursive-type", "title": "Generating functions from a recursive type", "body": "<p>Suppose in my application I have a set of functions that have very regular implementations (like specific logging functions). I have a type</p>\n\n<pre><code>data ShowFns = \n  { showFn1 :: Int -&gt; Bool -&gt; Double -&gt; String\n  , showFn2 :: Double -&gt; Char -&gt; String\n  }\n</code></pre>\n\n<p>Both of these could be implemented simply as</p>\n\n<pre><code>showFn1' :: Int -&gt; Bool -&gt; Double -&gt; String\nshowFn1' a b c = show a &lt;&gt; \" \" &lt;&gt; show b &lt;&gt; \" \" &lt;&gt; show c\n\nshowFn2' :: Double -&gt; Char -&gt; String\nshowFn2' a b = show a &lt;&gt; \" \" &lt;&gt; show b\n\nfnCollection :: ShowFns\nfnCollection = ShowFns showFn1' showFn2'\n</code></pre>\n\n<p>However, it seems like this repetitive pattern could be derived from a recursive type where all the leaf types have <code>Show</code> instances. </p>\n\n<p>I would rather write: </p>\n\n<pre><code>fnCollection :: ShowFns\nfnCollection = ShowFns toShowFn toShowFn\n</code></pre>\n\n<p>I have a sense this is possible because this is sorta how the Servant machinery works but servant is a bit more complicated and I haven't been able to replicate that machinery down to my simpler example. I have tried a few formulations with open type families but I can't seem to get the type system to reconcile the recursive case <code>ShowMe</code> and the base case <code>()</code>.  </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1558452189, "post_id": 56241390, "comment_id": 99101926, "body": "I can&#39;t understand what is the issue here, apart from a generic &quot;I don&#39;t understand how type inference works&quot;, which is too broad. Can you be more specific?"}, {"owner": {"reputation": 257, "user_id": 10654327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93dc6d9196997587c8bbdf9ba4cc7fa?s=128&d=identicon&r=PG&f=1", "display_name": "heisenberg7584", "link": "https://stackoverflow.com/users/10654327/heisenberg7584"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1558452344, "post_id": 56241390, "comment_id": 99102021, "body": "@chi an issue are basically these examples given, their evaluation of their types so the given results will be computed"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1558452540, "post_id": 56241390, "comment_id": 99102131, "body": "@heisenberg7584 You&#39;ve given the types right there. What <i>specific</i> problem are you having in understanding why those types are correct? Please edit your question to add this information."}, {"owner": {"reputation": 257, "user_id": 10654327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93dc6d9196997587c8bbdf9ba4cc7fa?s=128&d=identicon&r=PG&f=1", "display_name": "heisenberg7584", "link": "https://stackoverflow.com/users/10654327/heisenberg7584"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1558452686, "post_id": 56241390, "comment_id": 99102208, "body": "@AJFarmar edit done"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1558452725, "post_id": 56241390, "comment_id": 99102234, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/q/12532552/791604\">What part of Hindley-Milner do you not understand?</a>. If not a duplicate, talk about why."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1558453634, "post_id": 56241390, "comment_id": 99102731, "body": "There&#39;s nothing special here about the functions being anonymous. <code>func x = x 5</code> is the exact same function as your first one, and therefore has the same type."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1558453775, "post_id": 56241390, "comment_id": 99102811, "body": "And that function takes its argument and applies it to 5, so that argument must be a function that takes a number, and then the overall function returns that function argument&#39;s return type. This is perfectly logical, and exactly what the type signature tells you - so please explain further which part you are struggling to understand."}], "answers": [{"comments": [{"owner": {"reputation": 754, "user_id": 2140910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CtvpI.jpg?s=128&g=1", "display_name": "Bjartur Thorlacius", "link": "https://stackoverflow.com/users/2140910/bjartur-thorlacius"}, "edited": false, "score": 0, "creation_date": 1558455033, "post_id": 56242368, "comment_id": 99103531, "body": "You can also choose more restrictive types. For example you could define the more specialized version of your function as: <code>\\function -&gt; function 5 :: (Float -&gt; String) -&gt; String</code>"}], "tags": [], "owner": {"reputation": 754, "user_id": 2140910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CtvpI.jpg?s=128&g=1", "display_name": "Bjartur Thorlacius", "link": "https://stackoverflow.com/users/2140910/bjartur-thorlacius"}, "is_accepted": false, "score": 2, "last_activity_date": 1558454916, "creation_date": 1558454916, "answer_id": 56242368, "question_id": 56241390, "link": "https://stackoverflow.com/questions/56241390/type-of-anonymous-functions-in-haskell/56242368#56242368", "title": "Type of anonymous functions in Haskell", "body": "<p>The following are three equivalent ways to write your first function:</p>\n\n<pre><code>f :: Num t1 =&gt; (t1 -&gt; t2) -&gt; t2\nf = \\x -&gt; x 5\n\ng :: Num t1 =&gt; (t1 -&gt; t2) -&gt; t2\ng x = x 5\n\nh :: Num t1 =&gt; (t1 -&gt; t2) -&gt; t2\nh = ($ 5)\n</code></pre>\n\n<p>Note that this function, no matter which syntax you use in its definition, is a second-order function. That means that its argument, <code>x</code>, is itself a function. That is, <code>x</code> must have a type of the form <code>x :: Constraint1 t1, Constraint2 t2 =&gt; t1 -&gt; t2</code>. More specifically, <code>x</code> must accept <code>5</code> as its first (and possibly only) argument. But that's the only inherent constraint on its argument. <code>5 :: Num t1 =&gt; t1</code>, so <code>x :: Num t1, Constraint2 t2 =&gt; t1 -&gt; t2</code>. There is no inherent constraint on the return value of <code>x</code>, so the most general (permissive) type is <code>x :: Num t1 =&gt; t1 -&gt; t2</code>.</p>\n\n<p>So that gives us the type for the argument of your function: <code>\\x -&gt; x 5 :: Num t1 =&gt; (t1 -&gt; t2) -&gt; ?</code>. But what about the return type? Well, your function just applies <code>x</code> to 5 and evaluates to (returns) the result, so your function returns the same type as <code>x</code>. Assuming your function can accept any possible function <code>x</code>, its type is thus <code>\\x -&gt; x 5 :: Num t1 =&gt; (t1 -&gt; t2) -&gt; t2</code>.</p>\n\n<p>Note also that you can use any lowercase names you want, both for the parameter and the type variables. Thus you could just as well have written <code>\\function -&gt; function 5 :: Num five =&gt; (five -&gt; result) -&gt; result</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 257, "user_id": 10654327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93dc6d9196997587c8bbdf9ba4cc7fa?s=128&d=identicon&r=PG&f=1", "display_name": "heisenberg7584", "link": "https://stackoverflow.com/users/10654327/heisenberg7584"}, "edited": false, "score": 0, "creation_date": 1558546000, "post_id": 56242543, "comment_id": 99140635, "body": "Okey, it helps a lot... But what if we have an expression like; <code>\\x -&gt; f x y</code>. As I understand this is the same as func x = x y right ? How can we type this one when y is not even an argument here..."}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "reply_to_user": {"reputation": 257, "user_id": 10654327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93dc6d9196997587c8bbdf9ba4cc7fa?s=128&d=identicon&r=PG&f=1", "display_name": "heisenberg7584", "link": "https://stackoverflow.com/users/10654327/heisenberg7584"}, "edited": false, "score": 0, "creation_date": 1558552010, "post_id": 56242543, "comment_id": 99143206, "body": "@heisenberg7584 Correct, the system refuses to give a type for \\x -&gt; f x y until you have defined f and y. In theory, maybe it could say something like (f:: t1-&gt;t2-&gt;t3) =&gt; t1-&gt; t3 but cannot be bothered. Better safe than sorry I guess."}, {"owner": {"reputation": 257, "user_id": 10654327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93dc6d9196997587c8bbdf9ba4cc7fa?s=128&d=identicon&r=PG&f=1", "display_name": "heisenberg7584", "link": "https://stackoverflow.com/users/10654327/heisenberg7584"}, "edited": false, "score": 1, "creation_date": 1558712469, "post_id": 56242543, "comment_id": 99203998, "body": "so sorry, just last one. So am I right that when we have \\y -&gt; x + y the type is <code>Num a =&gt; a -&gt; a</code> because on the left side of expression there is just y so as an x we put some constant for example x = 3. So we remove one part from (+) type because x is a constant here. In case our expression was \\ x y -&gt; x + y we have no constants here so the type would be <code>Num a =&gt; a -&gt; a -&gt; a</code> and on the other hand type of <code>g=x+y</code> is just Num a=&gt;a whatever x and y are just assuming they are numbers right?"}, {"owner": {"reputation": 305, "user_id": 9301734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2de7afc05983df872e451ae19df7ef2?s=128&d=identicon&r=PG&f=1", "display_name": "jake-ferguson", "link": "https://stackoverflow.com/users/9301734/jake-ferguson"}, "reply_to_user": {"reputation": 257, "user_id": 10654327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93dc6d9196997587c8bbdf9ba4cc7fa?s=128&d=identicon&r=PG&f=1", "display_name": "heisenberg7584", "link": "https://stackoverflow.com/users/10654327/heisenberg7584"}, "edited": false, "score": 1, "creation_date": 1558716186, "post_id": 56242543, "comment_id": 99205587, "body": "@heisenberg7584 basically in a very simple way if you have expression like \\x -&gt; f x y the type result is A -&gt; B where A is a type of x and B is the type of whole expression f x y"}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "reply_to_user": {"reputation": 257, "user_id": 10654327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93dc6d9196997587c8bbdf9ba4cc7fa?s=128&d=identicon&r=PG&f=1", "display_name": "heisenberg7584", "link": "https://stackoverflow.com/users/10654327/heisenberg7584"}, "edited": false, "score": 0, "creation_date": 1558735605, "post_id": 56242543, "comment_id": 99212168, "body": "@heisenberg7584 If, under ghci, you ask for &quot;:t 4&quot; and then &quot;:t (+)&quot;, you will see that 4 does not have a type, just a type constraint of <i>Num a</i> ; the + sign has &quot;Num a =&gt; a-&gt;a-&gt;a&quot; which means that + forces its two operands and its result to have the same (numeric) type. So in an expression such as x+4, the + sign sort of extends the type constraint of 4, Num, to the other operand, x. So you cannot add an Int and a Double without using some explicit conversion operator. And &quot;\\x y -&gt;x+y&quot; has the same type constraint as + because it is essentially the same thing as +. Hope that helps."}], "tags": [], "owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "is_accepted": false, "score": 5, "last_activity_date": 1558459251, "last_edit_date": 1558459251, "creation_date": 1558455560, "answer_id": 56242543, "question_id": 56241390, "link": "https://stackoverflow.com/questions/56241390/type-of-anonymous-functions-in-haskell/56242543#56242543", "title": "Type of anonymous functions in Haskell", "body": "<p><em>>> How do we get these types ?</em></p>\n\n<p>These types are what the Haskell system can deduce from the only thing it has, that is the definition given by the user, such as \"x 5\".</p>\n\n<p>The important thing is not that the function is anonymous. It is that the function is <strong>not explicitely typed</strong>, so the Haskell system has to \"guess\" the type from the expression.</p>\n\n<pre><code>Prelude&gt; let a=4\nPrelude&gt; :t  \\x -&gt; a * x\n\\x -&gt; a * x :: Num a =&gt; a -&gt; a\nPrelude&gt; \nPrelude&gt; let f1 x = a*x\nPrelude&gt; :t f1\nf1 :: Num a =&gt; a -&gt; a\nPrelude&gt; \n</code></pre>\n\n<p>So, exactly same type for anonymous and named versions.</p>\n\n<p>Of course, you can be more specific:</p>\n\n<pre><code>Prelude&gt; let f4 :: Double -&gt; Double ; f4 x = 4*x\nPrelude&gt; :t f4\nf4 :: Double -&gt; Double\nPrelude&gt;\n</code></pre>\n\n<p>Haskell does not force you to explicitly type everything.\nIt takes all explicit typing info (such as for f4), and implicit typing info produced by your definitions and your calls to library functions, as typing constraints.</p>\n\n<p>If the constraints can be resolved unambiguously, fine; that's called <em>type inference</em> as mentioned by <em>chi</em> above. Otherwise, if the typing constraints are contradictory or ambiguous, execution aborts.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1558769788, "post_id": 56298133, "comment_id": 99216786, "body": "... except that <code>\\f -&gt; f x</code> has no type."}, {"owner": {"reputation": 305, "user_id": 9301734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2de7afc05983df872e451ae19df7ef2?s=128&d=identicon&r=PG&f=1", "display_name": "jake-ferguson", "link": "https://stackoverflow.com/users/9301734/jake-ferguson"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1558782819, "post_id": 56298133, "comment_id": 99219329, "body": "It has. We assume x is type of \u03b1. x is an argument in function f, so f :: \u03b1 -&gt; \u03b2. \u03b2 is type of result of function f. So summing up we get (\\f -&gt; f x) :: (\u03b1 -&gt; \u03b2 ) -&gt; \u03b2"}], "tags": [], "owner": {"reputation": 305, "user_id": 9301734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2de7afc05983df872e451ae19df7ef2?s=128&d=identicon&r=PG&f=1", "display_name": "jake-ferguson", "link": "https://stackoverflow.com/users/9301734/jake-ferguson"}, "is_accepted": false, "score": 0, "last_activity_date": 1558769753, "last_edit_date": 1558769753, "creation_date": 1558723685, "answer_id": 56298133, "question_id": 56241390, "link": "https://stackoverflow.com/questions/56241390/type-of-anonymous-functions-in-haskell/56298133#56298133", "title": "Type of anonymous functions in Haskell", "body": "<p>I think you are complicating it in a way you don't have to. Basically <strong>when you have an anonymous function in Haskell and want to find type of it you need to find two types: first the one that is before <code>-&gt;</code> symbol and then the type of whole expression on the right of the arrow <code>-&gt;</code></strong>. Base on your example:</p>\n\n<pre><code>\\x -&gt; x 5\n</code></pre>\n\n<p>We need to find the type of x which we know is a function that has one argument of some type belonging to the typeclass <code>Num</code>, and returns some unknown type - let's say <code>t</code>:</p>\n\n<pre><code>x :: Num a =&gt; a -&gt; t\n</code></pre>\n\n<p>So <code>x</code> function returns something of type <code>t</code>:</p>\n\n<pre><code>x 5 :: t\n</code></pre>\n\n<p>And here's our answer:</p>\n\n<pre><code>\\x -&gt; x 5 :: Num a =&gt; (a -&gt; t) -&gt; t\n</code></pre>\n\n<p>The same situation is with the last one:</p>\n\n<pre><code>\\f -&gt; f x\n</code></pre>\n\n<p>f is again some function but this time we don't know the type of its argument</p>\n\n<pre><code>f :: a -&gt; b\n</code></pre>\n\n<p>so <code>a</code> is type of <code>x</code> and the whole expression on the right returns <code>b</code></p>\n\n<pre><code>f x :: b\n</code></pre>\n\n<p>And again - here it is, we have a type of the expression on the left of <code>-&gt;</code> and on the right.</p>\n\n<pre><code>\\f -&gt; f x :: (a -&gt; b) -&gt; b\n</code></pre>\n"}], "owner": {"reputation": 257, "user_id": 10654327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93dc6d9196997587c8bbdf9ba4cc7fa?s=128&d=identicon&r=PG&f=1", "display_name": "heisenberg7584", "link": "https://stackoverflow.com/users/10654327/heisenberg7584"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 2, "answer_count": 3, "score": 0, "last_activity_date": 1558769753, "creation_date": 1558451559, "last_edit_date": 1558452673, "question_id": 56241390, "link": "https://stackoverflow.com/questions/56241390/type-of-anonymous-functions-in-haskell", "title": "Type of anonymous functions in Haskell", "body": "<p>I have a problem with typing anonymous functions in Haskell. For example when we have:</p>\n\n<pre><code>\\x -&gt; x 5\n</code></pre>\n\n<p>The type checked in GHCI is <code>Num t1 =&gt; (t1 -&gt; t2) -&gt; t2</code> while I was sure it is the opposite.Similarly type</p>\n\n<pre><code>\\x -&gt; a * x\n</code></pre>\n\n<p>is <code>Num a =&gt; a -&gt; a</code> (I know we need to assume that a is an Integer as the type of (*) is Int -> Int -> Int (without typeclasses).<br>\nAnother example would be</p>\n\n<pre><code>\\f -&gt; f x\n</code></pre>\n\n<p>And as far as I checked is sth like (a -> b) -> b</p>\n\n<p>But I am totally concerned about typing anonymous function. What is the magic power to understand this? Maybe a way to rewrite this function to a \"normal\" one to see the type clearly?</p>\n\n<p>SO MY QUESTION IS: <strong>How do we get these types? Where they come from and how to evaluate this?</strong></p>\n"}, {"tags": ["windows", "haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 18287, "user_id": 1029453, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x570w.jpg?s=128&g=1", "display_name": "Richard Huxton", "link": "https://stackoverflow.com/users/1029453/richard-huxton"}, "edited": false, "score": 1, "creation_date": 1558418035, "post_id": 56231632, "comment_id": 99083020, "body": "Do you have a proxy configured for your normal web access? Because it doesn&#39;t show one above"}, {"owner": {"reputation": 1762, "user_id": 3760519, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/92f83bbbf421e12a53e8111040d3d280?s=128&d=identicon&r=PG&f=1", "display_name": "Chechy Levas", "link": "https://stackoverflow.com/users/3760519/chechy-levas"}, "reply_to_user": {"reputation": 18287, "user_id": 1029453, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x570w.jpg?s=128&g=1", "display_name": "Richard Huxton", "link": "https://stackoverflow.com/users/1029453/richard-huxton"}, "edited": false, "score": 0, "creation_date": 1558418350, "post_id": 56231632, "comment_id": 99083115, "body": "As far as I can tell, there is no proxy configured. Also, check my update, I added some more information. HTTPS works, but HTTP does not. Can I get stack to use HTTPS?"}, {"owner": {"reputation": 1762, "user_id": 3760519, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/92f83bbbf421e12a53e8111040d3d280?s=128&d=identicon&r=PG&f=1", "display_name": "Chechy Levas", "link": "https://stackoverflow.com/users/3760519/chechy-levas"}, "reply_to_user": {"reputation": 18287, "user_id": 1029453, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x570w.jpg?s=128&g=1", "display_name": "Richard Huxton", "link": "https://stackoverflow.com/users/1029453/richard-huxton"}, "edited": false, "score": 0, "creation_date": 1558420046, "post_id": 56231632, "comment_id": 99083774, "body": "Actually scratch my previous comment, don&#39;t know how I came up with that but HTTP does in fact work, even from Postman. I will revert my update."}, {"owner": {"reputation": 452, "user_id": 3531310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c879bfa7b230a3b1a3f96fd3cb830e?s=128&d=identicon&r=PG&f=1", "display_name": "jaroslawj", "link": "https://stackoverflow.com/users/3531310/jaroslawj"}, "edited": false, "score": 0, "creation_date": 1558426603, "post_id": 56231632, "comment_id": 99086749, "body": "As Richard wrote, please check in your browser if it has proxy enabled (auto?). If yes, you must configure stack to use it <a href=\"https://github.com/commercialhaskell/stack/issues/1673\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/1673</a>"}, {"owner": {"reputation": 1762, "user_id": 3760519, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/92f83bbbf421e12a53e8111040d3d280?s=128&d=identicon&r=PG&f=1", "display_name": "Chechy Levas", "link": "https://stackoverflow.com/users/3760519/chechy-levas"}, "edited": false, "score": 0, "creation_date": 1558427169, "post_id": 56231632, "comment_id": 99087033, "body": "The box next to &quot;Use a proxy server for you LAN ...&quot; is not checked. Is that conclusive proof in a work environment with a network management team?"}], "owner": {"reputation": 1762, "user_id": 3760519, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/92f83bbbf421e12a53e8111040d3d280?s=128&d=identicon&r=PG&f=1", "display_name": "Chechy Levas", "link": "https://stackoverflow.com/users/3760519/chechy-levas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 654, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1558420074, "creation_date": 1558416676, "last_edit_date": 1558420074, "question_id": 56231632, "link": "https://stackoverflow.com/questions/56231632/haskell-stack-how-can-i-fix-this-connection-timeout", "title": "Haskell stack: How can I fix this connection timeout?", "body": "<p>I have some downtime at work and would like to spend it getting familiar with Haskell.</p>\n\n<p>I am trying a simple <code>HellowWorld.fs</code>, which works fine at home, but doesn't at work.</p>\n\n<p>I have a 'developer' account with the ability to install software, and generally IT can be convinced to unblock various network restrictions, but I have to be able to describe exactly what needs to be unblocked.</p>\n\n<p>Here is what I am seeing:</p>\n\n<pre><code>C:\\WorkSpace&gt;stack HelloWorld.hs\nDownloading lts-13.7 build plan ...\nRedownloadHttpError (HttpExceptionRequest Request {\n  host                 = \"raw.githubusercontent.com\"\n  port                 = 443\n  secure               = True\n  requestHeaders       = [(\"User-Agent\",\"The Haskell Stack\")]\n  path                 = \"/fpco/lts-haskell/master//lts-13.7.yaml\"\n  queryString          = \"\"\n  method               = \"GET\"\n  proxy                = Nothing\n  rawBody              = False\n  redirectCount        = 10\n  responseTimeout      = ResponseTimeoutDefault\n  requestVersion       = HTTP/1.1\n}\n ConnectionTimeout)\nAccess violation in generated code when reading 00007ffc39deffff\n</code></pre>\n\n<p>This is from Windows 10 command prompt.</p>\n\n<p>I can navigate just fine to <a href=\"https://raw.githubusercontent.com/fpco/lts-haskell/master//lts-13.7.yaml\" rel=\"nofollow noreferrer\">raw.githubusercontent.com/fpco/lts-haskell/master//lts-13.7.yaml</a> from my browser. Is that even where the problem is in this case? How can I diagnose what the problem is and then communicate the solution to IT? Even better, how can I solve it without getting IT involved?</p>\n"}, {"tags": ["string", "haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1558385834, "post_id": 56227989, "comment_id": 99076392, "body": "Yes, there are good libraries for pretty-printing. ...but the question is still off-topic by SO rules, because the answer shifts over time."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1558386411, "post_id": 56227989, "comment_id": 99076594, "body": "I&#39;d move your pretty printing function outside from <code>Show</code>. The <code>Show</code> typeclass should not indent anything, since indentation copes with showing values of type <code>(A,B)</code>, <code>[A]</code>, and virtually any other container type. Further, the widespread convention is that <code>Show</code> should output its data using Haskell&#39;s syntax (breaking this in a library would be pretty bad -- in a program less so, though)."}, {"owner": {"reputation": 436, "user_id": 2227966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1471a2a4abd39213b3cd2b6296b120d1?s=128&d=identicon&r=PG", "display_name": "Kevin Bradner", "link": "https://stackoverflow.com/users/2227966/kevin-bradner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1558389338, "post_id": 56227989, "comment_id": 99077426, "body": "Thanks @chi, this clears things up."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1558420384, "post_id": 56227989, "comment_id": 99083917, "body": "I would consider just going for YAML serialization."}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1558400810, "post_id": 56228083, "comment_id": 99079561, "body": "Nice answer.   State is unnecessary for indentation -- a simple function parameter (aka Reader) suffices."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 11, "last_activity_date": 1558422087, "last_edit_date": 1558422087, "creation_date": 1558385816, "answer_id": 56228083, "question_id": 56227989, "link": "https://stackoverflow.com/questions/56227989/indent-all-lines-in-a-string/56228083#56228083", "title": "Indent all lines in a string", "body": "<p>We can solve this by using <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:lines\" rel=\"nofollow noreferrer\"><strong><code>lines :: String -&gt; [String]</code></strong></a> and <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:unlines\" rel=\"nofollow noreferrer\"><strong><code>unlines :: [String] -&gt; String</code></strong></a> to move from a <code>String</code> to a list of <code>String</code>s and back.</p>\n\n<p>In between, we can make use of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:lines\" rel=\"nofollow noreferrer\"><strong><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code></strong></a> to prepend all lines (a <code>String</code> is a list of <code>Char</code>s) with a tab, like:</p>\n\n<pre><code>indent :: String -&gt; String\nindent = unlines . map ('\\t' :) . lines</code></pre>\n\n<p>For example:</p>\n\n<pre><code>Prelude&gt; indent (show (SndLevel 5))\n\"\\tSndLevel: \\n\\t\\t5\\n\"\n</code></pre>\n\n<p>We can use this in our defintion of <code>Show</code> for both <code>SndLevel</code> and <code>TopLevel</code> like:</p>\n\n<pre><code>instance Show SndLevel where\n    show (SndLevel n) = &quot;SndLevel:&quot; ++ '\\n' : indent (show n)\n\ninstance Show TopLevel where\n    show (TopLevel n) = &quot;TopLevel:&quot; ++ '\\n' : indent (show n)</code></pre>\n\n<p>This thus gives us:</p>\n\n<pre><code>Prelude&gt; print (TopLevel (SndLevel 5))\nTopLevel:\n    SndLevel:\n        5\n</code></pre>\n\n<p>That being said, a <code>Show</code> is usually used to show a representation of the object that can usually be \"injected\" back inh the compiler/interpreter. The idea of using indentation is not bad at all, but perhaps it makes sence to define your own typeclass for that. You could make that typeclass more efficient by using a parameter that is passed and updated, that keeps track of the indentation level.</p>\n\n<p>There are furthermore several <a href=\"https://www.reddit.com/r/haskell/comments/8ilw75/there_are_too_many_prettyprinting_libraries/\" rel=\"nofollow noreferrer\">\"<em>pretty printing</em>\" libraries [Reddit]</a> that can print the structure of an object nicely. So instead of \"<em>reinventing the wheel</em>\", it might be worth using one of the packages listed on the Reddit page.</p>\n"}], "owner": {"reputation": 436, "user_id": 2227966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1471a2a4abd39213b3cd2b6296b120d1?s=128&d=identicon&r=PG", "display_name": "Kevin Bradner", "link": "https://stackoverflow.com/users/2227966/kevin-bradner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 56228083, "answer_count": 1, "score": 6, "last_activity_date": 1558422087, "creation_date": 1558385334, "last_edit_date": 1558389927, "question_id": 56227989, "link": "https://stackoverflow.com/questions/56227989/indent-all-lines-in-a-string", "title": "Indent all lines in a string", "body": "<p>I have some types with custom <code>Show</code> instances defined. They are structured like this:</p>\n\n<pre><code>data TopLevel = TopLevel SndLevel\ndata SndLevel = SndLevel Int\n\ninstance Show SndLevel where\n  show (SndLevel i) = \"SndLevel: \\n\\t\" ++ (show i)\n</code></pre>\n\n<p>My <code>Show</code> instance for <code>SndLevel</code> produces nice looking strings that look like the following when they appear in my output:</p>\n\n<pre><code>SndLevel: \n  5\n</code></pre>\n\n<p>I would like to create a <code>Show</code> instance for <code>topLevel</code> that causes <code>TopLevel (SndLevel 5)</code> to look like this when printed to the terminal:</p>\n\n<pre><code>TopLevel\n  SndLevel\n    5\n</code></pre>\n\n<p>I was hoping to find a function built into Haskell that would add <code>\"\\t\"</code> at the front of a string and before each location where <code>\"\\n\"</code> appears in that string.</p>\n\n<p>The best solution I found would go along the lines of the answer in <a href=\"https://stackoverflow.com/questions/19545253/haskell-replace-characters-in-string\">this</a> post. In this case, I would replace <code>\"\\n\"</code> with <code>\"\\t\\n\"</code>.</p>\n\n<p>I assume I'm not the first person to need Show instances for hierarchically organized data in Haskell, so I would like to know if there is a more idiomatic way to get this done. Is there some better solution to my problem?</p>\n\n<p>p.s: I realize this kind of printing is not the best for the example datatypes I use above. The real datatypes I want to write instances for are product types, and so they don't read well when stretched out on one line. With that in mind, if there is a popular way to deal with this kind of problem without newlines and tabs, that could also solve my problem.</p>\n"}, {"tags": ["haskell", "ghc", "typeclass", "ghci", "overlapping-instances"], "answers": [{"comments": [{"owner": {"reputation": 569, "user_id": 1378376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c593899e94bea32edec0b39c01106f3e?s=128&d=identicon&r=PG", "display_name": "tophat", "link": "https://stackoverflow.com/users/1378376/tophat"}, "edited": false, "score": 0, "creation_date": 1558383677, "post_id": 56227599, "comment_id": 99075643, "body": "Huh. That works! Thanks! Some curiosities: How should one know to do this and why is this not needed in GHCi? Also, any advice on my tangential question?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 569, "user_id": 1378376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c593899e94bea32edec0b39c01106f3e?s=128&d=identicon&r=PG", "display_name": "tophat", "link": "https://stackoverflow.com/users/1378376/tophat"}, "edited": false, "score": 1, "creation_date": 1558384407, "post_id": 56227599, "comment_id": 99075901, "body": "@tophat GHCi uses the &quot;extended default rules&quot; where in some erroneous/ambiguous cases it defaults type variables in an aggressive way, often to <code>()</code>. That&#39;s done so that entering <code>[]</code> in GHCi does not cause an error -- that would be equivalent to <code>print []</code> which is ambiguous since e.g. an empty list of ints is printed differently from an empty list of chars. I don&#39;t know if it&#39;s possible to make GHCi infer the proper signature -- variadic functions do not fit well in Haskell&#39;s type system."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1558396435, "last_edit_date": 1558396435, "creation_date": 1558383290, "answer_id": 56227599, "question_id": 56227475, "link": "https://stackoverflow.com/questions/56227475/why-does-this-function-using-a-typeclass-with-overlapping-instances-behave-diffe/56227599#56227599", "title": "Why does this function using a typeclass with overlapping instances behave differently in GHCi?", "body": "<p>You need to instantiate <code>fpack</code> manually.</p>\n\n<pre><code>pack :: forall a r . FPack (a -&gt; a) r =&gt; r\npack = fpack @(a-&gt;a) @r id\n</code></pre>\n\n<p>This requires <code>ScopedTypeVariables, TypeApplications, AllowAmbiguousTypes</code>.</p>\n\n<p>Alternatively, provide a type for <code>id</code>.</p>\n\n<pre><code>pack :: forall a r . FPack (a -&gt; a) r =&gt; r\npack = fpack (id :: a -&gt; a)\n</code></pre>\n\n<p>The issue it that GHC can't see if it should use the <code>fpack</code> provided by that <code>FPack (a-&gt;a) r</code> constraint. That might be puzzling at first, but note that <code>fpack (id :: T -&gt; T)</code> could also correctly generate <code>r</code> if there is some <code>instance FPack (T -&gt; T) r</code> available. Since <code>id</code> could be both <code>a -&gt; a</code> and <code>T -&gt; T</code> (for any <code>T</code>), GHC can not safely choose.</p>\n\n<p>One can see this phenomenon in the type error, since GHC mentions <code>a0</code>. That type variable stands for some type which might be <code>a</code>, but might also be something else. One then can try to guess why the code isn't forcing <code>a0 = a</code>, pretending there are other instances around that could be used instead.</p>\n"}], "owner": {"reputation": 569, "user_id": 1378376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c593899e94bea32edec0b39c01106f3e?s=128&d=identicon&r=PG", "display_name": "tophat", "link": "https://stackoverflow.com/users/1378376/tophat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 56227599, "answer_count": 1, "score": 3, "last_activity_date": 1558624437, "creation_date": 1558382697, "last_edit_date": 1592644375, "question_id": 56227475, "link": "https://stackoverflow.com/questions/56227475/why-does-this-function-using-a-typeclass-with-overlapping-instances-behave-diffe", "title": "Why does this function using a typeclass with overlapping instances behave differently in GHCi?", "body": "<h1>Background</h1>\n<p>I have written the following code in Haskell (GHC 8.6.3):</p>\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE \n  NoImplicitPrelude,\n  MultiParamTypeClasses,\n  FlexibleInstances, FlexibleContexts,\n  TypeFamilies, UndecidableInstances,\n  AllowAmbiguousTypes\n#-}\n\nimport Prelude(Char, Show, show, undefined, id)\n\ndata Nil\nnil :: Nil\nnil = undefined\n\ninstance Show Nil where\n  show _ = &quot;nil&quot;\n\ndata Cons x xs = Cons x xs \n  deriving Show\n\nclass FPack f r where\n  fpack :: f -&gt; r\n\ninstance {-# OVERLAPPABLE #-} f ~ (Nil -&gt; r) =&gt; FPack f r where\n  fpack f = f nil\n\ninstance (FPack (x -&gt; b) r, f ~ (Cons a x -&gt; b)) =&gt; FPack f (a -&gt; r) where\n  fpack f a = fpack (\\x -&gt; f (Cons a x))\n</code></pre>\n<p>The idea behind this code is to produce a function of variable arity that takes its arguments and packs them into a heterogeneous list.</p>\n<p>For example, the following</p>\n<pre class=\"lang-hs prettyprint-override\"><code>fpack id &quot;a&quot; &quot;b&quot; :: Cons [Char] (Cons [Char] Nil)\n</code></pre>\n<p>produces the list <code>Cons &quot;a&quot; (Cons &quot;b&quot; nil)</code>.</p>\n<h1>Problem</h1>\n<p>In general, I want to call <code>fpack</code> by passing <code>id</code> as its <code>f</code> parameter (like above) so I wish to define the following function as a shorthand:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>pack = fpack id\n</code></pre>\n<p>If I load the above program into GHCi and execute the above line, pack is defined as desired and its type (as given by <code>:t</code>) is <code>FPack (a -&gt; a) r =&gt; r</code>.\nSo I defined the function like so in my program:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>pack :: FPack (a -&gt; a) r =&gt; r\npack = fpack id\n</code></pre>\n<p>But this gives the following error when loading said program into GHCi:</p>\n<pre><code>bugs\\so-pack.hs:31:8: error:\n    * Overlapping instances for FPack (a0 -&gt; a0) r\n        arising from a use of `fpack'\n      Matching givens (or their superclasses):\n        FPack (a -&gt; a) r\n          bound by the type signature for:\n                     pack :: forall a r. FPack (a -&gt; a) r =&gt; r\n          at bugs\\so-pack.hs:30:1-29\n      Matching instances:\n        instance [overlappable] (f ~ (Nil -&gt; r)) =&gt; FPack f r\n          -- Defined at bugs\\so-pack.hs:24:31\n        instance (FPack (x -&gt; b) r, f ~ (Cons a x -&gt; b)) =&gt;\n                 FPack f (a -&gt; r)\n          -- Defined at bugs\\so-pack.hs:27:10\n      (The choice depends on the instantiation of `a0, r')\n    * In the expression: fpack id\n      In an equation for `pack': pack = fpack id\n   |\n31 | pack = fpack id\n   |     \n</code></pre>\n<p>This leads me to my questions. Why does this function work when defined in GHCi, but not when defined in the program proper? Is there a way I can make this work in the program proper? If so, how?</p>\n<h1>My Thoughts</h1>\n<p>From what I understand about GHC and Haskell, this error comes from the fact that <code>pack</code> could resolve to either one of the two overlapping instances, and that bothers GHC. However, I thought that the <code>AllowAmbiguousTypes</code> option should solve that problem by deferring instance selection to the final call site. Unfortunately, that apparently that isn't sufficient. I am curious as to why, but I am even more curious as to why GHCi accepts this definition in its REPL loop but it does not accept it when it is inside a program.</p>\n<h1>A Tangent</h1>\n<p>I have another question regarding this program that is not directly related to main thrust of this question, but I thought it might be wise to ask it here rather than create another question about the same program.</p>\n<p>As seen in the example above i.e.</p>\n<pre class=\"lang-hs prettyprint-override\"><code>fpack id &quot;a&quot; &quot;b&quot; :: Cons [Char] (Cons [Char] Nil)\n</code></pre>\n<p>I have to provide an explicit type signature to <code>fpack</code> in order for it to work as desired. If I don't provide one (i.e. just call <code>fpack id &quot;a&quot; &quot;b&quot;</code>), GHCi produces the following error:</p>\n<pre><code>&lt;interactive&gt;:120:1: error:\n    * Couldn't match type `Cons [Char] (Cons [Char] Nil)' with `()'\n        arising from a use of `it'\n    * In the first argument of `System.IO.print', namely `it'\n      In a stmt of an interactive GHCi command: System.IO.print it\n</code></pre>\n<p>Is there any way I could alter the definition of <code>fpack</code> to get GHC to infer the proper type signature?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1558424553, "post_id": 56227392, "comment_id": 99085810, "body": "Your fold evaluates to <code>((([1] ++ 1) ++ 2) ++ 3)</code> which is ill typed, since <code>++</code> needs two lists. GHC tries to make this work by converting each of <code>1,2,3</code> to a list, by requiring <code>Num [a]</code>, which fails."}], "answers": [{"comments": [{"owner": {"reputation": 257, "user_id": 10654327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93dc6d9196997587c8bbdf9ba4cc7fa?s=128&d=identicon&r=PG&f=1", "display_name": "heisenberg7584", "link": "https://stackoverflow.com/users/10654327/heisenberg7584"}, "edited": false, "score": 0, "creation_date": 1558384134, "post_id": 56227484, "comment_id": 99075816, "body": "so in this cas t [a] is something like [[a]] ? so this type without typeclasses would be [a] -&gt; [[a]] -&gt; [a] right?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 257, "user_id": 10654327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93dc6d9196997587c8bbdf9ba4cc7fa?s=128&d=identicon&r=PG&f=1", "display_name": "heisenberg7584", "link": "https://stackoverflow.com/users/10654327/heisenberg7584"}, "edited": false, "score": 0, "creation_date": 1558384238, "post_id": 56227484, "comment_id": 99075853, "body": "@heisenberg7584: indeed, since <code>[[b]]</code> in its canocnical form is <code>[] ([] b)</code>. So then it specifies <code>t ~ []</code>, and hence it sees <code>[] b ~ [] a</code>, and thus <code>b ~ a</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 8, "last_activity_date": 1558382746, "creation_date": 1558382746, "answer_id": 56227484, "question_id": 56227392, "link": "https://stackoverflow.com/questions/56227392/non-type-variable-argument-in-the-constraint-error-while-using-foldl-with/56227484#56227484", "title": "Non type-variable argument in the constraint error while using foldl with ++", "body": "<p>I think you misunderstand the type of your <code>foldl (++)</code> function, the <code>t</code> is important here:</p>\n\n<pre><code>foldl (++) :: <b>Foldable t</b> =&gt; [a] -&gt; <b>t</b> [a] -&gt; [a]</code></pre>\n\n<p>If you pass <code>[1] :: Num n =&gt; [n]</code> as a first argument, that is not a problem, since then your <code>[1]</code> as type <code>[a]</code>, and hence <code>a ~ n</code>.</p>\n\n<p>The second argument however <em>is</em> a problem. You here pass a list <code>[1,2,3] :: Num m =&gt; [m]</code>, with a type <code>Num m =&gt; [m]</code>, or more canonical <code>Num m =&gt; [] m</code>. The only possible way to let this match with <code>t [a]</code>, is to set <code>t ~ []</code> (<code>t</code> is the list <em>type</em> constructor), and then <code>[a]</code> should match with <code>m</code>, but Haskell does not know a <code>Num</code> type <code>m</code> that is a list <code>[a]</code>, hence it fails.</p>\n\n<p>You can call this with for example:</p>\n\n<pre><code>Prelude&gt; foldl (++) [1] <b>[</b>[2], [3,4]<b>]</b>\n[1,2,3,4]</code></pre>\n\n<p>Since Haskell here will generate an expression that looks like:</p>\n\n<pre><code>(([1] ++ [2]) ++ [3]) ++ [4]\n</code></pre>\n\n<p>which is equivalent to:</p>\n\n<pre><code>[1,2,3,4]\n</code></pre>\n\n<p>We can also pass other <code>Foldable</code> types, like a <code>Maybe</code> for example:</p>\n\n<pre><code>Prelude&gt; foldl (++) [1] (<b>Just</b> [2])\n[1,2]\nPrelude&gt; foldl (++) [1] <b>Nothing</b>\n[1]</code></pre>\n\n<p>In that case the second parameter should have type <code>Maybe [Int]</code>.</p>\n"}], "owner": {"reputation": 257, "user_id": 10654327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a93dc6d9196997587c8bbdf9ba4cc7fa?s=128&d=identicon&r=PG&f=1", "display_name": "heisenberg7584", "link": "https://stackoverflow.com/users/10654327/heisenberg7584"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 56227484, "answer_count": 1, "score": 2, "last_activity_date": 1558382746, "creation_date": 1558382279, "question_id": 56227392, "link": "https://stackoverflow.com/questions/56227392/non-type-variable-argument-in-the-constraint-error-while-using-foldl-with", "title": "Non type-variable argument in the constraint error while using foldl with ++", "body": "<p>I am trying to use fold with ++. It should work as I check the type of it:</p>\n\n<pre><code>&gt; :t foldl (++)\nfoldl (++) :: Foldable t =&gt; [a] -&gt; t [a] -&gt; [a]\n</code></pre>\n\n<p>When I try to use it like this</p>\n\n<pre><code>&gt; foldl (++) [1] [1,2,3]\n</code></pre>\n\n<p>I get an error like:</p>\n\n<blockquote>\n  <p>Non type-variable argument in the constraint: Num [a]\n      (Use FlexibleContexts to permit this)</p>\n</blockquote>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["haskell", "category-abstractions"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1558377795, "post_id": 56226380, "comment_id": 99073515, "body": "I&#39;d needs to be <code>{ (a,a) | a in A }</code>. Since your model of relation is a finite map, you can only do this if A is finite."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1558378296, "post_id": 56226380, "comment_id": 99073687, "body": "Unrelated question: why import <code>GHC.Base</code>?"}, {"owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1558378500, "post_id": 56226380, "comment_id": 99073760, "body": "@Li-yaoXia In other definitions of Category instances I&#39;ve seen define id like this. Furthermore, it obviously works by itself; that is GHC.Base.id R mp == R mp, which, in my opinion shows that the identity relationship exists on R."}, {"owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1558378718, "post_id": 56226380, "comment_id": 99073858, "body": "@luqui So you think that I should define R as a simple Set (a,b)? So how should &#39;id&#39; be defined in this case? (The composition of relation as Set of pairs seems easy to me.)"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1558378923, "post_id": 56226380, "comment_id": 99073924, "body": "@AlbertoCapitani No the <code>Set (a,b)</code> is still required to be finite.  I would actually go for something like <code>a -&gt; Set b</code> (&quot;locally finite&quot;), or maybe even <code>a -&gt; b -&gt; Bool</code>"}, {"owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "edited": false, "score": 0, "creation_date": 1558379449, "post_id": 56226380, "comment_id": 99074096, "body": "@luqio Maybe like a characteristic function over a relation that compose with another one if the first one give true and the second argument is in second function&#39;s domain?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1558379627, "post_id": 56226380, "comment_id": 99074158, "body": "I don&#39;t understand the explanation about GHC.Base. As far as I can tell it&#39;s an internal library which is not meant to be used. It definitely has nothing to do with user-defined <code>Category</code> instances."}, {"owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1558379740, "post_id": 56226380, "comment_id": 99074188, "body": "@Li-yaoXia It was only a tentative solution. Now, after your explanations, it seems little sense."}], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 7, "last_activity_date": 1558379389, "creation_date": 1558379389, "answer_id": 56226799, "question_id": 56226380, "link": "https://stackoverflow.com/questions/56226380/difficulty-in-defining-the-relation-type-as-an-instance-of-the-category-class/56226799#56226799", "title": "Difficulty in defining the Relation type as an instance of the Category class", "body": "<p><code>Relation</code> cannot be an instance of <code>Category</code>:</p>\n\n<ol>\n<li><p>as luqui points out in the comments, <code>Relation</code> only represents finite relations (when viewed as sets of pairs), but the identity relation on an infinite set is infinite;</p></li>\n<li><p>composition is not defined on all types, only on instances of <code>Ord</code>.</p></li>\n</ol>\n\n<p>Here's one way to address those issues and make <code>Relation</code> an instance of <code>Category</code>:</p>\n\n<ol>\n<li>add a trivial element to represent the identity relation (this is the same idea behind making a monoid out of a semigroup with <code>Option</code>);</li>\n<li>make the other \"nontrivial\" relations carry the <code>Ord</code> instances.</li>\n</ol>\n\n<p>This can be done using GADTs.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE GADTs #-}\n\ndata Relation a b where\n  Id :: Relation a a\n  R :: (Ord a, Ord b) =&gt; Map a (Set b) -&gt; Relation a b\n\ninstance Category Relation where\n  id = Id\n  Id . r = r\n  r . Id = r\n  R r1 . R r2 = ...\n</code></pre>\n"}], "owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 56226799, "answer_count": 1, "score": 3, "last_activity_date": 1559485030, "creation_date": 1558377134, "last_edit_date": 1559485030, "question_id": 56226380, "link": "https://stackoverflow.com/questions/56226380/difficulty-in-defining-the-relation-type-as-an-instance-of-the-category-class", "title": "Difficulty in defining the Relation type as an instance of the Category class", "body": "<p>I'm trying to define Relation a b as a Category instance. It seems to me that the composer operator is well defined and respects the associative law. When it comes to the id, I can't find a correct definition. What am I doing wrong?</p>\n\n<pre><code>import Data.Map as M\nimport Data.Set as S\nimport Control.Category as Cat\n\nnewtype Relation a b = R (Map a (Set b)) deriving (Show, Eq)\n\n-- instance Cat.Category Relation where\n    -- id = \n    -- (.) = (\u00b0)\n\n-- GHC.Base.id r1\n-- &gt; R (fromList [(10,fromList \"abef\"),(30,fromList \"GRTXa\")])\n\nr1 = R $ M.fromList [(10,S.fromList \"abfe\"),(30,S.fromList \"aXGRT\")]\nr2 = R $ M.fromList [('a',S.fromList [Just \"Apple\",Just \"Ask\"]),('b',S.fromList [Just \"book\",Just \"brother\"]),('T',S.fromList [Just \"Table\"]),('?',S.fromList [Just \"Apple\",Just \"brother\"])]\n\n-- ex. r1 \u00b0 r2 = R (fromList [(10,fromList [Just \"Apple\",Just \"Ask\",Just \"book\",Just \"brother\"]),(30,fromList [Just \"Apple\",Just \"Ask\",Just \"Table\"])])\n\n\n(\u00b0) :: (Ord a, Ord k, Ord b) =&gt; Relation a k -&gt; Relation k b -&gt; Relation a b   \nR mp1 \u00b0 R mp2\n  | M.null mp1 || M.null mp2 = R M.empty \n  | otherwise = R $ M.foldrWithKey (\\k s acc -&gt; M.insert k (S.foldr (\\x acc2 -&gt; case M.lookup x mp2 of\n                                                                                  Nothing -&gt; acc2\n                                                                                  Just s2 -&gt; S.union s2 acc2\n                                                                    ) S.empty s) acc\n                                   ) M.empty mp1\n</code></pre>\n"}, {"tags": ["haskell", "attoparsec"], "comments": [{"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "edited": false, "score": 0, "creation_date": 1558375695, "post_id": 56225978, "comment_id": 99072728, "body": "Is the best thing to do a 2 part parse here, first to a comma separated list, then on each element? Isn&#39;t that slow?"}, {"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "edited": false, "score": 0, "creation_date": 1558377003, "post_id": 56225978, "comment_id": 99073219, "body": "I have this horrible solution but it makes me feel bad because it is bad <code>join $ sequence &lt;$&gt; (fmap . fmap) (A.parseOnly ld . pack)  (A.parseOnly parseCommaList (pack &quot;1,2,34.2&quot;))</code>"}, {"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "edited": false, "score": 0, "creation_date": 1558377023, "post_id": 56225978, "comment_id": 99073227, "body": "where <code>parseCommaList = sepBy1&#39; (A.many1 (A.notChar &#39;,&#39;)) (A.char &#39;,&#39;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1558380347, "creation_date": 1558380347, "answer_id": 56226997, "question_id": 56225978, "link": "https://stackoverflow.com/questions/56225978/attoparsec-ensure-entire-contents-consumed-with-sepby1/56226997#56226997", "title": "Attoparsec - ensure entire contents consumed with sepBy1", "body": "<p>You could use a tiny bit of lookahead to decide whether you reached the end of a list element. So:</p>\n\n<pre><code>int :: Parser Int\nint = do\n    i &lt;- A.signed A.decimal\n    next &lt;- A.peekChar\n    case next of\n        Nothing -&gt; pure i\n        Just ',' -&gt; pure i\n        _ -&gt; fail \"nah\"\n</code></pre>\n"}], "owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 56226997, "answer_count": 1, "score": 2, "last_activity_date": 1558380347, "creation_date": 1558375107, "last_edit_date": 1558375419, "question_id": 56225978, "link": "https://stackoverflow.com/questions/56225978/attoparsec-ensure-entire-contents-consumed-with-sepby1", "title": "Attoparsec - ensure entire contents consumed with sepBy1", "body": "<p>I would like the below code to return <code>[LoadInt 1,LoadDub 2.5,LoadInt 3]</code>, but it fails after parsing <code>[LoadInt 1,LoadDub 2]</code> and facing <code>.5,3</code>. How do I make it so it must parse all the way to the comma for a parse to succeed, and an <code>int</code> parse on <code>2.5</code> is a fail?</p>\n\n<pre><code>import qualified Data.Attoparsec.ByteString.Char8 as A\nimport Data.Attoparsec.ByteString.Char8 (Parser)\nimport Data.ByteString.Char8 (pack)\nimport Data.Attoparsec.Combinator\nimport Control.Applicative ((*&gt;),(&lt;$&gt;),(&lt;|&gt;))\ndata LoadNum = LoadInt Int | LoadDub Double deriving (Show)\n\nsomeFunc :: IO ()\nsomeFunc = putStrLn . show $ A.parseOnly (lnParser &lt;* A.endOfInput) (pack testString)\n\n\ntestString :: String\ntestString = \"1,2.5,3\"\n\nlnParser :: Parser [LoadNum]\nlnParser = (sepBy1' (ld &lt;* A.atEnd) (A.char ','))\n\ndouble :: Parser Double\ndouble = A.double\n\nint :: Parser Int\nint = A.signed A.decimal\n\nld :: Parser LoadNum\nld = ((LoadInt &lt;$&gt; int ) &lt;|&gt; (LoadDub &lt;$&gt; double))\n</code></pre>\n"}, {"tags": ["if-statement", "haskell", "ncurses", "io-monad", "do-notation"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1558367644, "post_id": 56224321, "comment_id": 99069492, "body": "<code>do</code> is not a function; it&#39;s a keyword that introduces a block of syntactic sugar."}, {"owner": {"reputation": 12902, "user_id": 207716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5db2fd504687aeda73c3561a83b43ac?s=128&d=identicon&r=PG", "display_name": "jk.", "link": "https://stackoverflow.com/users/207716/jk"}, "edited": false, "score": 0, "creation_date": 1558367685, "post_id": 56224321, "comment_id": 99069520, "body": "everything in Haskell is an expression, so..."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 4, "last_activity_date": 1558367519, "creation_date": 1558367519, "answer_id": 56224369, "question_id": 56224321, "link": "https://stackoverflow.com/questions/56224321/if-statement-in-do-block-gives-error-message/56224369#56224369", "title": "if statement in do block gives error message", "body": "<p>In Haskell, <code>if</code> expressions must have both <code>then</code> and <code>else</code> clauses.</p>\n\n<p>Without the <code>else</code>, you get the error.</p>\n\n<p>Both the consequent and the alternative clause must have the same type.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1558367918, "post_id": 56224377, "comment_id": 99069620, "body": "but the loop will continue, won&#39;t it? (unless <code>gameOver</code> throws an exception, but that would be bad style). explicit <code>if</code> will force us to place <code>loop ...</code> into just one, appropriate clause."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 7, "last_activity_date": 1558367552, "creation_date": 1558367552, "answer_id": 56224377, "question_id": 56224321, "link": "https://stackoverflow.com/questions/56224321/if-statement-in-do-block-gives-error-message/56224377#56224377", "title": "if statement in do block gives error message", "body": "<p><code>if</code>s need <code>else</code>s. Period. You can use the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Monad.html#v:when\" rel=\"noreferrer\"><code>when</code></a> function for when you need the imperative style \"if this, then do that, else do nothing,\" but there is no built-in syntax:</p>\n\n<pre><code>import Control.Monad\n\nwhen (length (filter (==(p1x, p1y)) list) &gt; 0) $ gameOver w \"player one lost\"\nwhen (length (filter (==(p2x, p2y)) list) &gt; 0) $ gameOver w \"player two lost\"\n</code></pre>\n\n<p>The definition of <code>when</code> is</p>\n\n<pre><code>when cond action = if cond then action else pure ()\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 11295023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e4f4d288ee8e206796cea1221f66be8?s=128&d=identicon&r=PG&f=1", "display_name": "abc556", "link": "https://stackoverflow.com/users/11295023/abc556"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "closed_date": 1558369792, "accepted_answer_id": 56224377, "answer_count": 2, "score": -1, "last_activity_date": 1558369826, "creation_date": 1558367284, "last_edit_date": 1558369826, "question_id": 56224321, "link": "https://stackoverflow.com/questions/56224321/if-statement-in-do-block-gives-error-message", "closed_reason": "Duplicate", "title": "if statement in do block gives error message", "body": "<p>I'm trying to make a very simple snake-like game where, if you try to go to a x,y coordinate you have already visited, you lose the game.</p>\n\n<p>This is code that's working so far (you can move player 1 with arrowkeys and player 2 with wasd):</p>\n\n<pre><code>import UI.NCurses\n\nmain :: IO ()    \nmain = runCurses $ do\n    w &lt;- defaultWindow\n    updateWindow w $ do\n        drawBorder Nothing Nothing Nothing Nothing Nothing Nothing Nothing Nothing\n    render\n    loop w [] 1 1 0 0 10 10 0 0\n\nloop :: Window -&gt; [(Integer, Integer)] -&gt; Integer -&gt; Integer -&gt; Integer -&gt; Integer -&gt; Integer -&gt; Integer -&gt; Integer -&gt; Integer -&gt;  Curses ()\nloop w list p1x p1y p1oldDx p1oldDy p2x p2y p2oldDx p2oldDy = do\n    e &lt;- getEvent w (Just 100)\n\n    let coordList = updateXY e p1oldDx p1oldDy p2oldDx p2oldDy\n    let p1dX = coordList !! 0\n    let p1dY = coordList !! 1\n    let p2dX = coordList !! 2\n    let p2dY = coordList !! 3\n\n    updateWindow w $ do\n        moveCursor (p1y+p1dY) (p1x+p1dX)\n        drawString (\"#\")\n        moveCursor (p2y+p2dY) (p2x+p2dX)\n        drawString (\"#\")\n    render\n\n    let updatedList = list ++ [(p1y+p1dY, p1x+p1dX)] ++ [(p2y+p2dY, p2x+p2dX)]\n\n    loop w updatedList (p1x+p1dX) (p1y+p1dY) p1dX p1dY (p2x+p2dX) (p2y+p2dY) p2dX p2dY\n\nupdateXY :: Maybe Event -&gt; Integer -&gt; Integer  -&gt; Integer -&gt; Integer -&gt; [Integer]\nupdateXY e p1oldX p1oldY p2oldX p2oldY\n    | e == Just (EventSpecialKey KeyLeftArrow) = [-1, 0, p2oldX, p2oldY]\n    | e == Just (EventSpecialKey KeyRightArrow) = [1, 0, p2oldX, p2oldY]\n    | e == Just (EventSpecialKey KeyDownArrow) = [0, 1, p2oldX, p2oldY]\n    | e == Just (EventSpecialKey KeyUpArrow) = [0, -1, p2oldX, p2oldY]\n    | e == Just (EventCharacter 'a') = [p1oldX, p1oldY, -1, 0]\n    | e == Just (EventCharacter 'd') = [p1oldX, p1oldY, 1, 0]\n    | e == Just (EventCharacter 's') = [p1oldX, p1oldY, 0, 1]\n    | e == Just (EventCharacter 'w') = [p1oldX, p1oldY, 0, -1]\n    | p1oldX /= 0 = [p1oldX, 0, p2oldX, p2oldY]\n    | p1oldY /= 0 = [0, p1oldY, p2oldX, p2oldY]\n    | p2oldX /= 0 = [p1oldX, p1oldY, p2oldX, 0]\n    | p2oldY /= 0 = [p1oldX, p1oldY, 0, p2oldY]\n    | otherwise = [1, 0, 1, 0] -- Starts moving in x-direction. Change to (0,0) for stand-still\n\n\n</code></pre>\n\n<p>So as you move, \"#\" characters are put down. The above code does nothing if you go to a coordinate which already has a \"#\" on it, so I tried changing the loop function by adding this just before the <code>let updatedList...</code>:</p>\n\n<pre><code>if length (filter (==(p1x, p1y)) list) &gt; 0 then gameOver w \"player one lost\"\nif length (filter (==(p2x, p2y)) list) &gt; 0 then gameOver w \"player two lost\"\n</code></pre>\n\n<p>And adding a temporary gameOver function:</p>\n\n<pre><code>gameOver w player = \n    updateWindow w $ do\n        moveCursor (10) (10)\n        drawString (player)\n    render\n</code></pre>\n\n<p>But when I try to load this file in GHCI I get the following error message:\nparse error on input 'if'</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "edited": false, "score": 1, "creation_date": 1558377392, "post_id": 56224499, "comment_id": 99073373, "body": "Hi @chi, thanks. This looks like it should be the right answer for my bigger question. It is disappointing that I can still get away with using ToNProxyK for unsatisfied instances. For example, I asked ghc, &quot;:kind! (ToNProxyK Bool 3 True)&quot; and it told me &quot;= ToNProxyK Bool 1 &#39;True&quot;. I had hoped it would say &quot;No Instance &#39;HasNProxyK Bool&#39;&quot;. Its the same for some simple signatures I wrote, I get the No Instance error if I include the class constraint, but if I forget it and just call the family then ghc is no help."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1558369301, "last_edit_date": 1558369301, "creation_date": 1558368105, "answer_id": 56224499, "question_id": 56223495, "link": "https://stackoverflow.com/questions/56223495/how-to-constrain-kinds-in-a-type-family/56224499#56224499", "title": "How to constrain kinds in a type family", "body": "<p>I can't find a perfect way to achieve a constrained closed type family, which is what you want, as far as I can understand.</p>\n\n<p>However, for your specific case, it might be enough to use a type family declared inside a type class, which allows to constrain <code>k</code> as you wish.</p>\n\n<pre><code>class HasNProxyK k =&gt; C k (n :: Nat) (a :: k) where\n    type ToNProxyK k n a :: k\n\ninstance C Type n a where\n    type ToNProxyK Type n a = NProxyK n a\n\ninstance HasNProxyK k =&gt; C (j -&gt; k) n a where\n    type ToNProxyK (j -&gt; k) n a = NProxyK n a\n</code></pre>\n\n<p>By doing that, we lose the \"top-down\" handling of <em>closed</em> type families. In your case, there is no overlap between <code>Type</code> and <code>j -&gt; k</code>, so it should not be an issue.</p>\n\n<hr>\n\n<p>Simpler variant:</p>\n\n<pre><code>class HasNProxyK k =&gt; C k where\n    type ToNProxyK k (n :: Nat) (a :: k) :: k\n\ninstance C Type where\n    type ToNProxyK Type n a = NProxyK n a\n\ninstance HasNProxyK k =&gt; C (j -&gt; k) where\n    type ToNProxyK (j -&gt; k) n a = NProxyK n a\n</code></pre>\n"}], "owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 56224499, "answer_count": 1, "score": 3, "last_activity_date": 1558369301, "creation_date": 1558364142, "question_id": 56223495, "link": "https://stackoverflow.com/questions/56223495/how-to-constrain-kinds-in-a-type-family", "title": "How to constrain kinds in a type family", "body": "<p>In a recent question of mine I found an <a href=\"https://stackoverflow.com/a/56222692/5198575\">answer</a> using a type class of kinds. NB that in <code>HasNProxyK k</code>, <code>k</code> is the kind of the second <code>NProxyK</code> parameter.</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE PolyKinds #-}\n{-# LANGUAGE TypeInType #-}\n\nimport GHC.TypeLits hiding ( (*) )\nimport Data.Kind\n\nclass HasNProxyK j where\n  data NProxyK (n :: Nat) (a::j) :: k\ninstance HasNProxyK Type where\n  data NProxyK n a = NProxyK0\ninstance HasNProxyK k =&gt; HasNProxyK (j -&gt; k) where\n  data NProxyK n f = NProxyKSuc -- or NProxyKS (ProxyK n (f a))\n\ntype family ToNProxyK (n :: Nat) (a :: k) :: k where\n  ToNProxyK n (a :: Type) = NProxyK n a\n  ToNProxyK n (a :: j -&gt; k) = NProxyK n a\n</code></pre>\n\n<p>I'm unsatisfied with the above in at least one way. I would have liked to declare the type family with a <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#constraints-in-kinds\" rel=\"nofollow noreferrer\">constraint in its kind</a>, something like: </p>\n\n<pre><code>type family ToNProxyK (n :: Nat) (a :: HasNProxyK k =&gt; k) :: k where\n   ToNProxyK n (a::Type) = Type\n   ToNProxyK n (a :: j -&gt; k) = NProxyK n a\n</code></pre>\n\n<p>My intent being that I'm constraining the kind of <code>a</code> to belong to <code>HasNProxyK</code>. And in order to use the type family i must know that the class instance is satisfied--hopefully catching declarations like <code>ToNProxyK 3 True</code> at compilation. However, when I try the above ghc tells me:</p>\n\n<pre><code>src/Traversal.hs:359:15: error:\n    \u2022 Expected kind \u2018HasNProxyK k0 =&gt; k0\u2019,\n        but \u2018(a :: Type)\u2019 has kind \u2018*\u2019\n    \u2022 In the second argument of \u2018ToNProxyK\u2019, namely \u2018(a :: Type)\u2019\n      In the type family declaration for \u2018ToNProxyK\u2019\n    |\n359 |   ToNProxyK n (a :: Type) = NProxyK n a\n    |               ^^^^^^^^^^^\n</code></pre>\n\n<p>What I get from this is that I'm not actually declaring what I think I'm declaring. That I've specified a new kind, not just restricted the kinds which\nare accepted. I've also tried including the constraint in the member types (<code>HasNProxyK Type =&gt; Type</code>) but that just leads to other problems.</p>\n\n<p>So, what am I actually declaring in my constrained kind family? Is there a way to constrain <code>k</code> in this type family to disallow types such as <code>ToNProxyK n True</code>?</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558362742, "post_id": 56223033, "comment_id": 99066716, "body": "Yes, if I recall correctly the source code is stored in <code>~&#47;.cabal&#47;packages&#47;</code>."}, {"owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "edited": false, "score": 0, "creation_date": 1558366107, "post_id": 56223033, "comment_id": 99068677, "body": "Related: <a href=\"https://stackoverflow.com/questions/31332033/how-to-completly-remove-packages-installed-by-cabal\" title=\"how to completly remove packages installed by cabal\">stackoverflow.com/questions/31332033/&hellip;</a>"}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 0, "creation_date": 1558386526, "post_id": 56223033, "comment_id": 99076626, "body": "If you can you may try to move to stack. It generates much less problems as I see"}], "answers": [{"comments": [{"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1570865875, "post_id": 58351566, "comment_id": 103057952, "body": "This is exactly what I wanted to know. Thanks."}], "tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 0, "last_activity_date": 1570862404, "creation_date": 1570862404, "answer_id": 58351566, "question_id": 56223033, "link": "https://stackoverflow.com/questions/56223033/cabal-installed-packages-cache-cleanup-issue/58351566#58351566", "title": "Cabal installed packages cache cleanup issue", "body": "<p>Yes. The tarballs are downloaded to the <code>~/.cabal/packages</code> directory, and can be deleted from there. The packages are installed to the <code>~./cabal/store</code> directory (with v2-install) and elsewhere in <code>~/.cabal</code> for v1-install. But you shouldn't delete either incrementally, as you'll almost certainly break dependencies.</p>\n"}], "owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 58351566, "answer_count": 1, "score": 1, "last_activity_date": 1570862404, "creation_date": 1558362566, "question_id": 56223033, "link": "https://stackoverflow.com/questions/56223033/cabal-installed-packages-cache-cleanup-issue", "title": "Cabal installed packages cache cleanup issue", "body": "<p>If I give following command: </p>\n\n<pre><code>cabal install &lt;pkgname&gt;\n</code></pre>\n\n<p>the package and its dependencies will be downloaded and installed. </p>\n\n<p>Do these packages remain in some place like cache and take up space? If so, how can these be deleted to increase space?</p>\n"}, {"tags": ["haskell", "monads", "state-monad"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1558358288, "post_id": 56221794, "comment_id": 99064047, "body": "It is the <i>initial</i> state, so one creates functions where the state is passed (and sometimes modified) and passed to the next state."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1558358410, "post_id": 56221794, "comment_id": 99064117, "body": "We thus take two states, and create a new <code>State</code>. A <code>State</code> is in fact not the sate, but a <i>change</i> of state. We thus create a new change of state that first passes <code>s</code> through the first one, and the result <code>(a, s&#39;)</code> contains the modified state <code>s&#39;</code> that is then passed to the next one."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1558360466, "post_id": 56221794, "comment_id": 99065389, "body": "Think of a <code>State s a</code> value as a &quot;state transformer&quot;, a machine which can modify the state, when fed with one, and produce a value of type <code>a</code> in the process. The concrete, real, initial state is passed when one finally decides to run the monadic computation using <code>runState myStateValue myInitialState</code>. This is a typical workflow with monads: you use a lot of <code>&gt;&gt;=&#47;return</code> to build a value of type <code>M a</code>, and at the very last step you use <code>runM</code> to turn that <code>M a</code> into some usable type, breaking the monadic abstraction."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1558361487, "post_id": 56221794, "comment_id": 99065996, "body": "you write <code>let x = runState st argument</code> inside your IO do block, or <code>runState (do { x &lt;- get ; return (x+1) }) 0</code>. but that is a <i>new question</i>."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 5, "last_activity_date": 1558370876, "last_edit_date": 1558370876, "creation_date": 1558358650, "answer_id": 56221913, "question_id": 56221794, "link": "https://stackoverflow.com/questions/56221794/understanding-the-state-argument-in-the-state-monad/56221913#56221913", "title": "Understanding the state argument in the State Monad", "body": "<blockquote>\n  <p>when you say <code>State $ \\s -&gt;....</code>, where does <code>s</code> come from ?</p>\n</blockquote>\n\n<p>It <em>will</em> come from the invocation, when <code>runState</code> <em>will</em> supply the initial state value to the state-monadic value, to run the combined computation it describes:</p>\n\n<pre><code>st = do { x &lt;- get ; return (x+1) }\n\nx = runState st 0    -- x is (1,0)\n</code></pre>\n\n<hr>\n\n<p>I also sense another possible misunderstanding on your part: you write: \"<em>when</em> is that initial <code>(\\s -&gt; ...) argument</code> called?\" There's no \"initial\" lambda: the lambdas are all nested inside! </p>\n\n<pre><code>do { a &lt;- as; b &lt;- bs; c &lt;- foo b; return c }\n</code></pre>\n\n<p>translates as </p>\n\n<pre><code>as &gt;&gt;= (\\a -&gt; bs &gt;&gt;= (\\b -&gt; foo b &gt;&gt;= (\\c -&gt; return c)))\n</code></pre>\n\n<p>so it's not \"initial\", that's one combined all-enclosing lambda that is called with the initial state! </p>\n\n<p>And then <em>it</em> will call </p>\n\n<pre><code>let (a,s1) = runState as s0\n</code></pre>\n\n<p>etc. with that \"initial\" <code>as</code> in the <code>do</code> block.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 3, "creation_date": 1558360284, "post_id": 56222078, "comment_id": 99065265, "body": "my preferred wording is, &quot;a <code>do</code> block does not perform, it <i>describes</i> a computation <i>to be</i> performed.&quot; :)"}, {"owner": {"reputation": 11377, "user_id": 553279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de617e09030cad8f06663113eeea27cc?s=128&d=identicon&r=PG", "display_name": "fdreger", "link": "https://stackoverflow.com/users/553279/fdreger"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1558360994, "post_id": 56222078, "comment_id": 99065703, "body": "@WillNess <code>do</code> is not different than any other function :) Would you say that <code>find</code> &quot;describes finding a value in a foldable&quot; or would you say that <code>find</code> &quot;finds a value in a foldable&quot;? :-)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1558361520, "post_id": 56222078, "comment_id": 99066019, "body": "<code>do</code> is <i>quite</i> different from any other function, namely it is not a function at all."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1558361831, "post_id": 56222078, "comment_id": 99066200, "body": "<code>find</code>&#39;s source code describes finding a value in a Foldable indeed; trouble is it&#39;s not a Haskell value at all. Each line in a <code>do</code> block (the portion to the right of <code>&lt;-</code>, if present) <i>is</i> a Haskell value. that&#39;s the difference."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1558376375, "post_id": 56222078, "comment_id": 99072976, "body": "@WillNess What does &quot;it&quot; refer to in &quot;trouble is it&#39;s not a Haskell value at all&quot;? I&#39;m having trouble parsing that phrase in a way that makes it correct."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1558376745, "post_id": 56222078, "comment_id": 99073112, "body": "@fdreger <code>find</code> describes finding a value in a foldable. The (fully saturated) application of <code>find</code> (and the evaluation of this expression) is what finds a value in a foldable. Similarly, a <code>State</code> action describes the modification of some initial state. The application of that action to an initial state (modulo newtype unwrapping) is what modifies that initial state."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1558412510, "post_id": 56222078, "comment_id": 99081547, "body": "@ReinHenrichs &quot;<code>find</code>&#39;s source code is not a Haskell value&quot; is what I meant."}], "tags": [], "owner": {"reputation": 11377, "user_id": 553279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de617e09030cad8f06663113eeea27cc?s=128&d=identicon&r=PG", "display_name": "fdreger", "link": "https://stackoverflow.com/users/553279/fdreger"}, "is_accepted": false, "score": 2, "last_activity_date": 1558361089, "last_edit_date": 1558361089, "creation_date": 1558359273, "answer_id": 56222078, "question_id": 56221794, "link": "https://stackoverflow.com/questions/56221794/understanding-the-state-argument-in-the-state-monad/56222078#56222078", "title": "Understanding the state argument in the State Monad", "body": "<p>the <code>do</code> block does not <em>perform</em> any stateful computation - it only assembles some smaller stateful computations into one bigger stateful computation. At the <code>do</code> level, the actual state does not exist.</p>\n\n<p>It would be simpler and maybe even more accurate if the monad was called \"a stateful computation\". Or \"a function that takes state of type S and returns another state of the same type alongside its actual result\". Then you could imagine <code>&gt;&gt;=</code> as \"combines two functions of the aforementioned type into one, such that the state returned by the first one is be passed as a parameter to the second one\".</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1558365862, "last_edit_date": 1558365862, "creation_date": 1558363263, "answer_id": 56223251, "question_id": 56221794, "link": "https://stackoverflow.com/questions/56221794/understanding-the-state-argument-in-the-state-monad/56223251#56223251", "title": "Understanding the state argument in the State Monad", "body": "<p><code>State</code> is just a wrapper around functions of type <code>s -&gt; (a, s)</code>. <code>runState</code> doesn't actually \"run\" anything; it just gives back the function wrapped by the <code>State</code> constructor. You can, however, compare <code>runState</code> to the <code>($)</code> operator for functions.</p>\n\n<pre><code>($)             f  x = f x\nrunState (State f) s = f s\n</code></pre>\n\n<p>That makes <code>(=&lt;&lt;) = flip (&gt;&gt;=)</code> similar to <code>(&lt;&lt;&lt;) = (.)</code>; just rather than taking two functions and returning a third function, it takes a function (that returns a <code>State</code>) and a <code>State</code> and produces a second <code>State</code>. </p>\n\n<p>However, we'll make a direct comparison of <code>(&gt;&gt;=)</code> to <code>(&gt;&gt;&gt;) = flip (.)</code> so that the types align better. (Similarly, you could compare <code>(.)</code> to <code>(=&lt;&lt;)</code>.)</p>\n\n<pre><code>-- f :: t -&gt; a\n-- g ::      a -&gt; b\nf &gt;&gt;&gt; g =         \\t -&gt; let a       = ($)      f     t\n                        in            ($)      g     a\n-- m :: State s a\n-- g ::         a -&gt; State s b\nm &gt;&gt;= g = State $ \\s -&gt; let (a, s') = runState m     s\n                        in            runState (g a) s'\n</code></pre>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 56221913, "answer_count": 3, "score": 5, "last_activity_date": 1558370876, "creation_date": 1558358235, "last_edit_date": 1558370435, "question_id": 56221794, "link": "https://stackoverflow.com/questions/56221794/understanding-the-state-argument-in-the-state-monad", "title": "Understanding the state argument in the State Monad", "body": "<p>I'm trying so hard to wrap my head around the State Monad, and I do not understand the following:</p>\n\n<p>Given the implementation of <code>return</code> and <code>(&gt;&gt;=)</code>, when you say <code>State $ \\s -&gt;....</code>, where does <code>s</code> come from? I mean,  when you start performing <code>&gt;&gt;= ... &gt;&gt;=</code>, doesn't it mean that somewhere in your beginning of the chain you somehow have to provide for that initial parameter? </p>\n\n<pre><code>newtype State s a=State { runState::s-&gt;(a,s) }\n\n instance Monad (State s) where\n        return a=State $ \\s-&gt;(a,s)\n        (&gt;&gt;=) m g=State $ \\s -&gt; let (a,s')= runState m s in\n                                   runState (g a) s'\n</code></pre>\n\n<p>In <code>(&gt;&gt;=)</code> you say <code>State $ \\s -&gt; runState m s</code>, and I do not get <em>when</em> is that initial <code>(\\s -&gt; ...) argument</code> (with a <strong>REAL</strong> <code>argument</code>) called? </p>\n\n<p>Can someone explain, please?</p>\n\n<p><strong>Later Edit</strong>:</p>\n\n<p>Can someone show me how would the <code>initial</code> state be set, let's say if it needs to get a value using <code>getLine</code>?</p>\n\n<pre><code>main::IO()\nmain=do\n  argument&lt;-getLine\n  --how do i set initial state with argument?\n  m &gt;&gt; f1 &gt;&gt; f2 &gt;&gt; f3\n</code></pre>\n"}, {"tags": ["c", "haskell", "stdin", "eof", "io-monad"], "answers": [{"comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1558362639, "post_id": 56221755, "comment_id": 99066670, "body": "This seems to imply that Haskell immediately closes a handle once it reads an EOF from it. Can you confirm this is what you&#39;re saying? (See also the update to my question.)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1558363098, "post_id": 56221755, "comment_id": 99066899, "body": "EOF does not close the file handle. What&#39;s more, this way of doing things is very unsafe, because of the way lazy IO interleaves effects."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1558372016, "post_id": 56221755, "comment_id": 99071289, "body": "@DanielWagner did you mean the <code>openFile</code>, or the <code>hDuplicate</code> way? or both?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1558373464, "post_id": 56221755, "comment_id": 99071856, "body": "@WillNess Calling <code>hGetContents</code> on two copies of <code>stdin</code> is unsafe, whether you got those two copies from <code>openFile</code> or <code>hDuplicate</code>. It&#39;s not &quot;unsafe&quot; in the &quot;type unsafe&quot; sense, but it&#39;s &quot;unsafe&quot; in the sense that the uncontrollable order in which lazy evaluation forces computations will control which of the two results of <code>getContents</code> &quot;see&quot; which inputs."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1558373751, "post_id": 56221755, "comment_id": 99071965, "body": "@DanielWagner thanks. so a char on stdin might enter either one of the two handles, nondeterministically? and if I, say, stop using <code>h1</code> at some point in my <code>do</code> block and only refer to <code>h2</code> from that point on, the result will be that some chars on stdin might get skipped when I &quot;look&quot; at it only through <code>h2</code>, is that it? if I use only <code>hGetChar</code>, say? or is the problem lies only and specifically in <code>hGetContents</code>? what about <code>hGetBuf</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1558374546, "post_id": 56221755, "comment_id": 99072280, "body": "@WillNess The problem is specifically with <code>hGetContents</code>: the order of evaluation of pure values that depend on the <code>String</code> returned by <code>hGetContents</code> determines which of the two <code>String</code>s contains the next inputted character. With <code>hGetBuf</code> and friends, the order of execution of <code>IO</code> actions determines it; but this is okay, because we have a solid story for controlling what order <code>IO</code> actions are executed in (that&#39;s the whole point of <code>IO</code> in the first place)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1558374807, "post_id": 56221755, "comment_id": 99072379, "body": "@DanielWagner aha. great. thanks! one more thing: so hGetBuf, say, is atomic? i.e. not lazy I mean? yeah looks like it must be, it returns an Int count of chars read.  thanks!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1558375263, "post_id": 56221755, "comment_id": 99072554, "body": "@WillNess As you say it depends what you mean by atomic. I would be wary of calling it on the same handle from two different threads (read: I would source-dive first); but then I can&#39;t think of a time when I have wanted to do something like that anyway. But if what you really mean is &quot;Does it do lazy IO/call <code>unsafeInterleaveIO</code> like <code>hGetContents</code> does?&quot; then the answer is no."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1558405141, "post_id": 56221755, "comment_id": 99080255, "body": "&quot;So once a file reaches EOF, it&#39;s at EOF forever.&quot; That seems to be false, given @DanielWagner&#39;s answer"}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1558413784, "post_id": 56221755, "comment_id": 99081813, "body": "@JosephSible: Fair enough, I removed that sentence."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": false, "score": 0, "last_activity_date": 1558413772, "last_edit_date": 1558413772, "creation_date": 1558358065, "answer_id": 56221755, "question_id": 56221606, "link": "https://stackoverflow.com/questions/56221606/how-do-i-read-from-standard-input-again-after-an-eof/56221755#56221755", "title": "How do I read from standard input again after an EOF?", "body": "<p>A quick search of the GHC source code shows that <code>clearerr()</code> is not used at all there.  However, you can open <code>/dev/stdin</code> again, since it looks like you're using Linux or similar.  Try this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>stdin2 &lt;- openFile \"/dev/stdin\" ReadMode\n</code></pre>\n\n<p>You can also use <code>hDuplicate</code>.  See here: <a href=\"https://stackoverflow.com/questions/17123897/portably-opening-a-handle-to-stdin-many-times-in-a-single-session\">Portably opening a handle to stdin many times in a single session</a></p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1558399359, "last_edit_date": 1558399359, "creation_date": 1558363316, "answer_id": 56223271, "question_id": 56221606, "link": "https://stackoverflow.com/questions/56221606/how-do-i-read-from-standard-input-again-after-an-eof/56223271#56223271", "title": "How do I read from standard input again after an EOF?", "body": "<p>You can't use <code>getContents</code>, because <code>hGetContents</code> (semi-)closes the handle it's passed and <code>getContents</code> calls <code>hGetContents</code>. But there's no problem with reading from a handle again after EOF with most of the other functions from the standard library. Here's a simple but inefficient example of reading all the characters without using <code>getContents</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Control.Exception\nimport System.IO.Error\n\nreadAll = go [] where\n    handler cs err = if isEOFError err\n        then return (reverse cs)\n        else throwIO err\n    go cs = catch (do\n        c &lt;- getChar\n        go (c:cs))\n        (handler cs)\n\nmain = do\n    all &lt;- readAll\n    putStrLn $ \"got: \" ++ all\n    putStrLn \"go again, mate\"\n    all &lt;- readAll\n    putStrLn $ \"got: \" ++ all\n</code></pre>\n\n<p>If you want better efficiency, there are various functions available for reading lines-at-a-time or other large chunks in the standard library, rather than one character at a time.</p>\n"}], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "accepted_answer_id": 56223271, "answer_count": 2, "score": 5, "last_activity_date": 1558413772, "creation_date": 1558357461, "last_edit_date": 1558399638, "question_id": 56221606, "link": "https://stackoverflow.com/questions/56221606/how-do-i-read-from-standard-input-again-after-an-eof", "title": "How do I read from standard input again after an EOF?", "body": "<p>I have the following C program:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid readAndEchoAll(void) {\n    for(;;) {\n        char buf[100];\n        ssize_t size = read(STDIN_FILENO, buf, sizeof(buf));\n        if(size &lt;= 0) {\n            return;\n        }\n        fwrite(buf, 1, size, stdout);\n    }\n}\n\nint main(void) {\n    puts(\"Reading and echoing STDIN until first EOF...\");\n    readAndEchoAll();\n    puts(\"Got first EOF. Now reading and echoing STDIN until second EOF...\");\n    readAndEchoAll();\n    puts(\"Got second EOF.\");\n    return 0;\n}\n</code></pre>\n\n<p>When I run it, it works the way I want it to. Here's what it does:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Reading and echoing STDIN until first EOF...\nasdf\n^Dasdf\nGot first EOF. Now reading and echoing STDIN until second EOF...\nfdsa\n^Dfdsa\nGot second EOF.\n</code></pre>\n\n<p>I'm trying to create an equivalent Haskell program. Here's my attempt:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>readAndEchoAll :: IO ()\nreadAndEchoAll = do\n    buf &lt;- getContents\n    putStr buf\n\nmain :: IO ()\nmain = do\n    putStrLn \"Reading and echoing STDIN until first EOF...\"\n    readAndEchoAll\n    putStrLn \"Got first EOF. Now reading and echoing STDIN until second EOF...\"\n    -- ???\n    readAndEchoAll\n    putStrLn \"Got second EOF.\"\n</code></pre>\n\n<p>This doesn't work. Here's what it does:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Reading and echoing STDIN until first EOF...\nasdf\n^Dasdf\nGot first EOF. Now reading and echoing STDIN until second EOF...\nreadtwice.hs: &lt;stdin&gt;: hGetContents: illegal operation (handle is closed)\n</code></pre>\n\n<p>How do I make this work like the C program? <s>I assume that I need to put some equivalent of <code>clearerr(stdin);</code> where I have <code>-- ???</code>, but I'm not sure what that equivalent is.</s></p>\n\n<p><strong>Update:</strong> Turns out <code>clearerr</code> is a bit of a red herring, as it's exclusive to the standard C API. When using the POSIX API, you can just read again without needing to do anything equivalent to it. So rather than make Haskell do anything extra, I need to make it not do something: not prevent further reads once it sees EOF.</p>\n"}, {"tags": ["dictionary", "haskell", "compiler-errors", "type-mismatch", "do-notation"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1558356141, "post_id": 56220990, "comment_id": 99062857, "body": "see <a href=\"https://stackoverflow.com/a/50815136/849891\">this</a> for a general description of <a href=\"https://stackoverflow.com/questions/tagged/do-notation\">do-notation</a>."}], "answers": [{"comments": [{"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558355413, "post_id": 56221036, "comment_id": 99062433, "body": "Can I not change original dictionary using <code>let dict =...</code>"}, {"owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "reply_to_user": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558355450, "post_id": 56221036, "comment_id": 99062455, "body": "You would not change it, but introduce a name that shadows the original name."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558355498, "post_id": 56221036, "comment_id": 99062486, "body": "I have to repeat this insert process many times. I see that it is not working on second time itself."}, {"owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "reply_to_user": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558355585, "post_id": 56221036, "comment_id": 99062542, "body": "Notice that <code>insert</code> does not mutate, but returns a new dictionary every time. If you need to insert many elements, you can make a function <code>insertMany</code> that uses a fold or recursion."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558355644, "post_id": 56221036, "comment_id": 99062573, "body": "Ok. I need that as the answer please."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1558355681, "post_id": 56221036, "comment_id": 99062598, "body": "<code>let</code>&#39;s bindings are recursive so it wouldn&#39;t work with the same name, <code>let dict = ....dict....</code>. Instead, <i>inside a <code>do</code> block</i>, you <i>can</i> write <code>dict &lt;- return (....dict....)</code>, even if it&#39;s a bit hackish. That <i>will</i> create a new name shadowing the previous one."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558355758, "post_id": 56221036, "comment_id": 99062652, "body": "Dictionaries / association lists are very useful and there in most languages. What is the correct way to create, add multiple items and to lookup an item to a dictionary in Haskell. That is what I am trying to understand."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1558355827, "post_id": 56221036, "comment_id": 99062697, "body": "see <a href=\"https://stackoverflow.com/questions/11922134/how-to-increment-a-variable-in-functional-programming\">how to increment a variable in functional programming</a>."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558355983, "post_id": 56221036, "comment_id": 99062782, "body": "<code>d &lt;- (return insert (&quot;2key&quot;, &quot;2value&quot;) d)</code> does not work. Gives error: <code>Couldn&#39;t match type \u2018[(a0, b0)] -&gt; [(a0, b0)]\u2019                     with \u2018IO [([Char], b1)]\u2019</code>"}, {"owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "reply_to_user": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558356217, "post_id": 56221036, "comment_id": 99062901, "body": "@rnso I added an example of <code>insertMany</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1558356432, "post_id": 56221036, "comment_id": 99063011, "body": "perhaps <code>insertMany [(&quot;onekey&quot;, &quot;newvalue&quot;), (&quot;anotherkey&quot;, &quot;anothervalue&quot;)]</code>?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558356569, "post_id": 56221036, "comment_id": 99063080, "body": "@rnso that should&#39;ve been <code>d &lt;- return (insert (&quot;2key&quot;, &quot;2value&quot;) d)</code>. And yes, you can repeat that as many time as you&#39;d like. Although, it will definitely be bad style; using a fold-based function is much more idiomatic."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558359489, "post_id": 56221036, "comment_id": 99064780, "body": "Thanks for a detailed answer. I would be great if you could also mention if and how I can do <code>let d = insert (k, v) dict</code> multiple times to the same <code>d</code> with varying values of <code>k</code> and <code>v</code>."}], "tags": [], "owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "is_accepted": true, "score": 5, "last_activity_date": 1558362357, "last_edit_date": 1558362357, "creation_date": 1558355282, "answer_id": 56221036, "question_id": 56220990, "link": "https://stackoverflow.com/questions/56220990/why-this-dictionary-function-is-not-working/56221036#56221036", "title": "Why this dictionary function is not working", "body": "<p>You need to use <code>let</code> to bind the new dictionary to a name:</p>\n\n<pre><code>import Data.List (lookup)\n\ninsert :: Eq a =&gt; (a,b) -&gt; [(a,b)] -&gt; [(a,b)]\ninsert (a,b)  []           = [(a,b)]\ninsert (a,b) ((c,d):rest) = if a == c\n    then (a,b) : rest\n    else (c,d) : insert (a,b) rest\n\ndict :: [(String, String)]\ndict = [(\"\", \"\")]\n\nmain = do\n    let d = insert (\"onekey\", \"onevalue\") dict\n    print d\n    print $ lookup \"onekey\" d\n</code></pre>\n\n<p>You ask about inserting multiple elements. For this you could use a fold to write a function called <code>insertMany</code>. You should probably be using <code>foldl'</code> but I'll leave that as an exercise to find out why.</p>\n\n<pre><code>import Data.List (lookup)\n\ninsert :: Eq a =&gt; (a,b) -&gt; [(a,b)] -&gt; [(a,b)]\ninsert (a,b)  []           = [(a,b)]\ninsert (a,b) ((c,d):rest) = if a == c\n    then (a,b) : rest\n    else (c,d) : insert (a,b) rest\n\ninsertMany :: Eq a =&gt; [(a,b)] -&gt; [(a,b)] -&gt; [(a,b)]\ninsertMany elements dict =\n  foldl (flip insert) dict elements\n\ndict :: [(String, String)]\ndict = [(\"\", \"\")]\n\nmain = do\n    let d = insert (\"onekey\", \"onevalue\") dict\n    print d\n    print $ lookup \"onekey\" d\n    print $ insertMany [(\"onekey\", \"newvalue\"), (\"anotherkey\", \"anothervalue\")]\n      dict\n</code></pre>\n"}], "owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 56221036, "answer_count": 1, "score": 0, "last_activity_date": 1558362357, "creation_date": 1558355125, "last_edit_date": 1558356320, "question_id": 56220990, "link": "https://stackoverflow.com/questions/56220990/why-this-dictionary-function-is-not-working", "title": "Why this dictionary function is not working", "body": "<p>I am trying to create and use a dictionary with code from <a href=\"https://stackoverflow.com/questions/20567255/functionality-of-adding-to-lists-in-haskell-overwriting-an-existing-list\">here</a>: </p>\n\n<pre><code>import Data.List (lookup)\n\ninsert :: Eq a =&gt; (a,b) -&gt; [(a,b)] -&gt; [(a,b)]\ninsert (a,b)  []           = [(a,b)]\ninsert (a,b) ((c,d):rest) = if a == c\n    then (a,b) : rest\n    else (c,d) : insert (a,b) rest\n\ndict :: [(String, String)]\ndict = [(\"\", \"\")]\n\nmain = do \n    insert (\"onekey\", \"onevalue\") dict\n    print dict\n    print $ lookup \"onekey\" dict\n</code></pre>\n\n<p>But I am getting following error: </p>\n\n<pre><code>$ runghc rndict.hs\n\nrndict.hs:22:1: error:\n    \u2022 Couldn't match expected type \u2018IO t0\u2019 with actual type \u2018[()]\u2019\n    \u2022 In the expression: main\n      When checking the type of the IO action \u2018main\u2019\n\nrndict.hs:24:9: error:\n    \u2022 Couldn't match type \u2018IO\u2019 with \u2018[]\u2019\n      Expected type: [()]\n        Actual type: IO ()\n    \u2022 In a stmt of a 'do' block: print dict\n      In the expression:\n        do { insert (\"onekey\", \"onevalue\") dict;\n             print dict;\n             print $ lookup \"onekey\" dict }\n      In an equation for \u2018main\u2019:\n          main\n            = do { insert (\"onekey\", \"onevalue\") dict;\n                   print dict;\n                   print $ lookup \"onekey\" dict }\n\nrndict.hs:25:9: error:\n    \u2022 Couldn't match type \u2018IO\u2019 with \u2018[]\u2019\n      Expected type: [()]\n        Actual type: IO ()\n    \u2022 In a stmt of a 'do' block: print $ lookup \"onekey\" dict\n      In the expression:\n        do { insert (\"onekey\", \"onevalue\") dict;\n             print dict;\n             print $ lookup \"onekey\" dict }\n      In an equation for \u2018main\u2019:\n          main\n            = do { insert (\"onekey\", \"onevalue\") dict;\n                   print dict;\n                   print $ lookup \"onekey\" dict }\n</code></pre>\n\n<p>What is the problem and what is the correct way to use dictionaries in Haskell?</p>\n"}, {"tags": ["haskell", "boolean", "monads", "io-monad", "do-notation"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1558355183, "post_id": 56220932, "comment_id": 99062287, "body": "Do you understand what &quot;pure&quot; means in the statement &quot;Haskell is a pure functional language&quot;?"}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1558355228, "post_id": 56220932, "comment_id": 99062308, "body": "I have read/heard about it but do not understand it fully."}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 0, "creation_date": 1558356603, "post_id": 56220932, "comment_id": 99063095, "body": "<code>do</code> notation always gets you some type of <code>IO</code> value (e.g. <code>IO Bool</code>, in this case), so this is pretty straightforward."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1558359392, "post_id": 56220932, "comment_id": 99064723, "body": "In short, Haskell has no <i>statements</i>."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558359717, "post_id": 56220932, "comment_id": 99064921, "body": "What is disadvantage of simple statements? Why are they being avoided here so much?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1558371578, "post_id": 56220932, "comment_id": 99071117, "body": "by &quot;statement&quot; in functional programming vernacular is meant something that has no value, and is used for its effect. it is popular to say that &quot;functional&quot; are &quot;expression-oriented&quot; languages where <i>expressions</i> are <i>evaluated</i> for their value. so in Scheme for example, instead of having an explicit <code>return</code> <i>statement</i> like they have in C, simply the last evaluated expression&#39;s value is returned as the overall expression&#39;s value."}], "answers": [{"tags": [], "owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "is_accepted": false, "score": 3, "last_activity_date": 1558356934, "creation_date": 1558356934, "answer_id": 56221469, "question_id": 56220932, "link": "https://stackoverflow.com/questions/56220932/why-cant-i-put-a-print-function-statement-here/56221469#56221469", "title": "Why can&#39;t I put a print function statement here?", "body": "<p>You might be confused by the same print line working in <code>toTry</code>, but not in <code>isBinary</code>. The difference stems from the declaration:</p>\n\n<pre><code>isBinary :: String -&gt; Bool\n</code></pre>\n\n<p>This means that <code>isBinary</code> is a pure function (i.e. no side effects), taking a string and returning a boolean. In fact, you could simplify it to</p>\n\n<pre><code>isBinary ss = any (\\c -&gt; ord c &gt; 127) ss \n</code></pre>\n\n<p>or even use the point-free style</p>\n\n<pre><code>isBinary = any (\\c -&gt; ord c &gt; 127)\n</code></pre>\n\n<p>However, <code>toTry</code> is </p>\n\n<pre><code>toTry :: String -&gt; IO ()\n</code></pre>\n\n<p>I.e. it takes a string and returns the <code>IO</code> monad which is impure (can have side effects, such as printing text to the console).</p>\n\n<p>Haskell is a language that encourages using pure functions, and enforces it using the type system, by forcing the programmer to explicitly mark impure code.</p>\n\n<p>Further reading:\n<a href=\"https://stackoverflow.com/questions/4382223/what-does-pure-mean-in-pure-functional-language\">What does &quot;pure&quot; mean in &quot;pure functional language&quot;?</a> </p>\n"}, {"comments": [{"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 0, "creation_date": 1558430941, "post_id": 56221543, "comment_id": 99089273, "body": "Great answer, I would also add a short explanation about <code>return</code> in haskell vs. its meaning in other languages as this causes confusion to many learners."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 0, "creation_date": 1558598137, "post_id": 56221543, "comment_id": 99155890, "body": "@m-aroosi thanks for the edit! I would often notice this error in posts of others, and here I made it myself. the irony!"}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 4, "last_activity_date": 1558568852, "last_edit_date": 1558568852, "creation_date": 1558357222, "answer_id": 56221543, "question_id": 56220932, "link": "https://stackoverflow.com/questions/56220932/why-cant-i-put-a-print-function-statement-here/56221543#56221543", "title": "Why can&#39;t I put a print function statement here?", "body": "<p>The answer is, \"because <em>types</em>\". Specifically:</p>\n\n<pre><code>isBinary :: String -&gt; Bool\nisBinary ss = do \n  ....\n</code></pre>\n\n<p>Since it's a <code>do</code> block, the return type of <code>isBinary</code> <em>must</em> match a monadic type <code>Monad m =&gt; m t</code> for some <code>m</code> and some <code>t</code>. Here, since <code>print \"\" :: IO ()</code>, <code>m</code> is <code>IO</code>, so it should've been</p>\n\n<pre><code>isBinary :: String -&gt; IO Bool\nisBinary ss = do \n</code></pre>\n\n<p>and now</p>\n\n<pre><code>    print \"In isBinary fn\"                 -- works\n    let ans = any (\\c -&gt; ord c &gt; 127) ss   -- also works\n    ans                                    -- doesn't work\n</code></pre>\n\n<p><code>ans</code> doesn't work because of types, again. Its type is <code>Bool</code>, but it must be <code>IO Bool</code> -- first, because this <code>do</code> block belongs to <code>IO</code> monad, on account of <code>print</code>; and second, because of the return type of the function as a whole. </p>\n\n<p>Instead, use</p>\n\n<pre><code>    return ans\n</code></pre>\n\n<p>and now it'll work, because <code>return</code> injects a value into the monadic context, and being the last <code>do</code> block value it becomes the value produced by the <code>do</code> block overall (if <code>return val</code> appears in the middle it just passes the <code>val</code> to the next step in the combined computation).</p>\n\n<p>The function <code>toTry</code> will have to be augmented to use the new definition:</p>\n\n<pre><code>toTry :: String -&gt; IO ()  \ntoTry firline = do\n        print \"In toTry fn.\"\n        -- let answer = isBinary firline    -- incorrect, now!\n        answer &lt;- isBinary firline          -- isBinary ... :: IO Bool\n        if not answer then do               --       answer ::    Bool\n            print \"Sent line not binary: \"\n        else\n            print \"Sent line binary\"\n</code></pre>\n\n<p><code>m a</code> on the right of <code>&lt;-</code>, <code>a</code> on the left.</p>\n\n<p>See <a href=\"https://stackoverflow.com/a/50815136/849891\">this</a> for a general description of <code>do</code> notation.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 2, "last_activity_date": 1558388195, "last_edit_date": 1592644375, "creation_date": 1558388195, "answer_id": 56228472, "question_id": 56220932, "link": "https://stackoverflow.com/questions/56220932/why-cant-i-put-a-print-function-statement-here/56228472#56228472", "title": "Why can&#39;t I put a print function statement here?", "body": "<p>Looking at your code, it seems your use of <code>print</code> in <code>isBinary</code> is not an integral part of what you want the function to do, but merely a debug print statement that will be removed later on. In that case, you do not want to change the type of <code>isBinary</code> to <code>String -&gt; IO Bool</code> (for more on that, see <a href=\"https://stackoverflow.com/a/56221543/2751851\">Will Ness' answer</a>), as you don't actually need <code>IO</code> except for debugging. Rather, the core libraries offer <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Debug-Trace.html\" rel=\"nofollow noreferrer\">the <code>Debug.Trace</code> module</a>, which caters to this kind of situation. With it, we can add your debug print statement like this:</p>\n<pre><code>isBinary :: String -&gt; Bool\nisBinary ss = trace &quot;In isBinary fn&quot; $ any (\\c -&gt; ord c &gt; 127) ss\n</code></pre>\n<p>Then, once you are done debugging, you can remove the use of <code>trace</code> -- and it bears repeating you really should do that later on. Quoting the <code>Debug.Trace</code> documentation:</p>\n<blockquote>\n<p>Functions for tracing and monitoring execution.</p>\n<p>These can be useful for investigating bugs or performance problems. They should <em>not</em> be used in production code.</p>\n</blockquote>\n"}], "owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 56221543, "answer_count": 3, "score": 2, "last_activity_date": 1558598238, "creation_date": 1558354953, "last_edit_date": 1558598238, "question_id": 56220932, "link": "https://stackoverflow.com/questions/56220932/why-cant-i-put-a-print-function-statement-here", "title": "Why can&#39;t I put a print function statement here?", "body": "<p>I am trying following code with try-catch block: </p>\n\n<pre><code>import System.Environment  \nimport System.IO  \nimport System.IO.Error  \nimport Control.Exception\n\nisBinary :: String -&gt; Bool\nisBinary ss = do \n    print \"In isBinary fn\"   -- works if this line is removed.\n    let ans = any (\\c -&gt; ord c &gt; 127) ss\n    ans\n\ntoTry :: String -&gt; IO ()  \ntoTry firline = do\n        print \"In toTry fn.\"\n        let answer = isBinary firline\n        if not answer then do\n            print \"Sent line not binary: \"\n        else\n            print \"Sent line binary\"\n\nhandler :: IOError -&gt; IO ()  \nhandler e = putStrLn \"Whoops, had some trouble!\"  \n\nss = \"this is a test\"\nmain = do \n    toTry ss `catch` handler\n</code></pre>\n\n<p>However, I am getting following error: </p>\n\n<pre><code>$ runghc trycatch3.hs \n\ntrycatch3.hs:9:9: error:\n    \u2022 Couldn't match expected type \u2018Bool\u2019 with actual type \u2018IO Bool\u2019\n    \u2022 In a stmt of a 'do' block: print \"in isBinary fn\"\n      In the expression:\n        do { print \"in isBinary fn\";\n             let ans = any (\\ c -&gt; ...) ss;\n             return ans }\n      In an equation for \u2018isBinary\u2019:\n          isBinary ss\n            = do { print \"in isBinary fn\";\n                   let ans = ...;\n                   return ans }\n\ntrycatch3.hs:10:30: error:\n    \u2022 Variable not in scope: ord :: Char -&gt; Integer\n    \u2022 Perhaps you meant one of these:\n        \u2018or\u2019 (imported from Prelude), \u2018odd\u2019 (imported from Prelude)\n</code></pre>\n\n<p>The error goes away and program works well if the print statement is removed from isBinary function. </p>\n\n<p>Why can't I put print statement in this function?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1558352447, "post_id": 56219779, "comment_id": 99060879, "body": "Not as far as I&#39;m aware. What you&#39;re asking for is sufficiently weird (in that I&#39;ve never seen a program act this way) that it&#39;s not really something that fits in a standard library. Lots of older command line applications used a single <code>.</code> on one line as a multiline text terminator, so you could do <i>that</i> if you really wanted to."}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1558352684, "post_id": 56219779, "comment_id": 99060997, "body": "@Cubic Not that weird obviously as &quot;Learn you a haskell for the greater good&quot; web site shows examples (which do not work) and given that you still have to type <code>:{</code> etc. for multiline input in ghci instead of simply typing away until <code>CTRL-D</code>. In the meantime I looked at github for the source of <code>getContents</code> and see that it is mapped to <code>primGetContents</code>. Any idea where I can find the source code for that?"}, {"owner": {"reputation": 2032, "user_id": 3403369, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2f22e034ed5c2f2adc584dc721718fb4?s=128&d=identicon&r=PG", "display_name": "robx", "link": "https://stackoverflow.com/users/3403369/robx"}, "edited": false, "score": 0, "creation_date": 1575206474, "post_id": 56219779, "comment_id": 104480237, "body": "I think this is a valid question, just ran into the same problem. On the python command line, calling <code>sys.stdin.read()</code> just works. I assume the problem is with GHCI substituting EOT for EOF, which may be to work around <code>getContents</code> semi-closing the handle on EOF, compare <a href=\"https://stackoverflow.com/questions/12119420/haskell-ghci-using-eof-character-on-stdin-with-getcontents\" title=\"haskell ghci using eof character on stdin with getcontents\">stackoverflow.com/questions/12119420/&hellip;</a>."}], "answers": [{"tags": [], "owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "is_accepted": false, "score": 2, "last_activity_date": 1558366431, "creation_date": 1558366431, "answer_id": 56224088, "question_id": 56219779, "link": "https://stackoverflow.com/questions/56219779/how-can-i-read-mutiple-lines-from-stdin-within-ghci-more-than-once/56224088#56224088", "title": "How can I read mutiple lines from stdin within GHCI more than once?", "body": "<p>Here is the function I was looking for:</p>\n\n<pre><code>getContentsEOT :: IO String\ngetContentsEOT = \n    getChar &gt;&gt;= \\c -&gt; \n        if c == '\\EOT' \n            then return \"\" \n            else getContentsEOT &gt;&gt;= \\s -&gt; \n                return (c:s)\n</code></pre>\n"}], "owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1558366431, "creation_date": 1558350654, "question_id": 56219779, "link": "https://stackoverflow.com/questions/56219779/how-can-i-read-mutiple-lines-from-stdin-within-ghci-more-than-once", "title": "How can I read mutiple lines from stdin within GHCI more than once?", "body": "<p>In contrast to the information in \"learn you a haskell\", on my windows system, ghci translates <code>CTRL-D</code> to <code>EOT</code>, not <code>EOF</code>.</p>\n\n<p>Thus, when I do something like:</p>\n\n<pre><code>input &lt;- getContents\ndoSomething input\n</code></pre>\n\n<p>, where <code>doSomething</code> is a function which consumes the input.<br>\nDoing that, I have to press <code>CTRL-Z</code> to end my input text, which makes sense since <code>getContents</code> is intended for process piping... </p>\n\n<p>But if I repeat the above steps a second time, it fails because <code>stdin</code> is closed.</p>\n\n<p>So, while browsing <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/System-IO.html\" rel=\"nofollow noreferrer\">System.IO</a>, I could not find an alternative to <code>getContents</code>, which would react on <code>EOT</code>. </p>\n\n<p>Do I have to write such a function myself or is it to be found in another package, maybe?</p>\n\n<p>Btw, the version of GHCI, I use is <code>8.2.2</code>.<br>\nAlso, I do not want single line processing. I am aware of <code>getLine</code> but it is not what I want in this case.</p>\n"}, {"tags": ["haskell", "gloss"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11508944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0f807f1b26e78d8c97e77165f925f52?s=128&d=identicon&r=PG&f=1", "display_name": "grimbar", "link": "https://stackoverflow.com/users/11508944/grimbar"}, "edited": false, "score": 0, "creation_date": 1558350604, "post_id": 56219100, "comment_id": 99059865, "body": "grid as well as units is not a picture, it is already built with the &quot;pictures&quot; function, so it should be of the type [Picture]. However (units &lt;&gt;grid) worked. No idea what that is but thank you very much. edit: Both your solutions work btw. How I did not just try and error this is beyond me."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 33, "user_id": 11508944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0f807f1b26e78d8c97e77165f925f52?s=128&d=identicon&r=PG&f=1", "display_name": "grimbar", "link": "https://stackoverflow.com/users/11508944/grimbar"}, "edited": false, "score": 0, "creation_date": 1558350668, "post_id": 56219100, "comment_id": 99059889, "body": "@gimbar: but <code>pictures</code> has type <code>[Picture] -&gt; Picture</code> <a href=\"https://hackage.haskell.org/package/gloss-1.13.0.1/docs/Graphics-Gloss-Data-Picture.html#v:pictures\" rel=\"nofollow noreferrer\">ref</a>, so you collapsed it to a <code>Picture</code>, note that the compiler also derived that type."}, {"owner": {"reputation": 33, "user_id": 11508944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0f807f1b26e78d8c97e77165f925f52?s=128&d=identicon&r=PG&f=1", "display_name": "grimbar", "link": "https://stackoverflow.com/users/11508944/grimbar"}, "edited": false, "score": 1, "creation_date": 1558350875, "post_id": 56219100, "comment_id": 99060002, "body": "@Wiilem Van Onsem You are right, too. How I missed these obvious things is troubling. I pondered over this for a whole weekend."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1558359302, "post_id": 56219100, "comment_id": 99064671, "body": "Missing these things may have something to do with insisting you can run before you learn to walk. Have you considered studying the fundamentals of the language?"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1558348356, "creation_date": 1558348356, "answer_id": 56219100, "question_id": 56218986, "link": "https://stackoverflow.com/questions/56218986/is-there-a-way-to-merge-two-sets-of-pictures-into-one/56219100#56219100", "title": "Is there a way to merge two sets of pictures into one?", "body": "<p>The <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-43--43-\" rel=\"nofollow noreferrer\"><strong><code>(++) :: [a] -&gt; [a] -&gt; [a]</code></strong></a> function appends two lists, a <code>Picture</code> is not a list, so you can not use that function.</p>\n\n<p>You can however use the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-60--62-\" rel=\"nofollow noreferrer\"><strong><code>(&lt;&gt;) :: Semigroup m =&gt; m -&gt; m -&gt; m</code></strong></a> here, since a <code>Picture</code> is an instance of a <code>Semigroup</code>:</p>\n\n<p>we thus can write it like:</p>\n\n<pre><code>main = display window backgroundColor (<b>units &lt;&gt; grid</b>)</code></pre>\n\n<p>or you can use <a href=\"https://hackage.haskell.org/package/gloss-1.13.0.1/docs/Graphics-Gloss-Data-Picture.html#v:pictures\" rel=\"nofollow noreferrer\"><strong><code>pictures :: [Picture] -&gt; Picture</code></strong></a> again, and include your <code>units</code> and <code>grid</code>, like:</p>\n\n<pre><code>main = display window backgroundColor (<b>pictures [units, grid]</b>)</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11508944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0f807f1b26e78d8c97e77165f925f52?s=128&d=identicon&r=PG&f=1", "display_name": "grimbar", "link": "https://stackoverflow.com/users/11508944/grimbar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 56219100, "answer_count": 1, "score": 0, "last_activity_date": 1558394935, "creation_date": 1558347945, "last_edit_date": 1558394935, "question_id": 56218986, "link": "https://stackoverflow.com/questions/56218986/is-there-a-way-to-merge-two-sets-of-pictures-into-one", "title": "Is there a way to merge two sets of pictures into one?", "body": "<p>I am trying to display a grid of lines with a set of cells that fill the squares in said lines. </p>\n\n<p>I have already tried concatenating them like simple lists.</p>\n\n<p>This is the grid of lines. It is displayed correctly on its own.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>grid = translate (fromIntegral width * (-0.5)) \n                 (fromIntegral height * (-0.5)) \n                 (pictures (concat [\n                                    [line [(i * unitWidth, 0.0)\n                                          ,(i * unitWidth, fromIntegral height)]\n                                    ,line [(0.0, i * unitHeight)\n                                          ,(fromIntegral width, i * unitHeight)]\n                                    ]\n                                   | i &lt;- [1..gridDimension]]\n                            )\n                 )\n</code></pre>\n\n<p>This is the set of units that are drawn between the lines, also displayed correctly on its own.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>units = pictures [translate ((x*unitWidth - unitWidth/2) + (fromIntegral width*(-0.5))) \n                            ((y*unitHeight - unitHeight/2) + (fromIntegral height*(-0.5)))\n                            unit\n                 | x &lt;- [1..gridDimension], y &lt;- [1..gridDimension]]\n</code></pre>\n\n<p>My main method:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>main = display window backgroundColor units\n</code></pre>\n\n<p>I can exchange units for grid in this place and it works fine.\nI also tried this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>main = display window backgroundColor (units++grid)\n</code></pre>\n\n<p>It threw the following error:</p>\n\n<pre><code>40: error:\n    \u2022 Couldn't match expected type \u2018[a0]\u2019 with actual type \u2018Picture\u2019\n    \u2022 In the first argument of \u2018(++)\u2019, namely \u2018grid\u2019\n      In the third argument of \u2018display\u2019, namely \u2018(grid ++ units)\u2019\n      In the expression: display window backgroundColor (grid ++ units)\n   |\n10 | main = display window backgroundColor (grid++units)\n   |                                        ^^^^\n\n/home/georg/Desktop/THM/6_semester/funktionale_programmierung/my/app/Main.hs:10:40: error:\n    \u2022 Couldn't match expected type \u2018Picture\u2019 with actual type \u2018[a0]\u2019\n    \u2022 In the third argument of \u2018display\u2019, namely \u2018(grid ++ units)\u2019\n      In the expression: display window backgroundColor (grid ++ units)\n      In an equation for \u2018main\u2019:\n          main = display window backgroundColor (grid ++ units)\n   |\n10 | main = display window backgroundColor (grid++units)\n   |                                        ^^^^^^^^^^^\n\n/home/georg/Desktop/THM/6_semester/funktionale_programmierung/my/app/Main.hs:10:46: error:\n    \u2022 Couldn't match expected type \u2018[a0]\u2019 with actual type \u2018Picture\u2019\n    \u2022 In the second argument of \u2018(++)\u2019, namely \u2018units\u2019\n      In the third argument of \u2018display\u2019, namely \u2018(grid ++ units)\u2019\n      In the expression: display window backgroundColor (grid ++ units)\n   |\n10 | main = display window backgroundColor (grid++units)\n   |                                              ^^^^^\n</code></pre>\n"}, {"tags": ["haskell", "exception"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1558346368, "post_id": 56218488, "comment_id": 99057557, "body": "You should <code>import Control.Exception(catch)</code>, you can see the name of the module at the top of the documentation, like <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Exception.html#v:catch\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558347054, "post_id": 56218488, "comment_id": 99057878, "body": "Yes it works. They should have put it in demo code."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558347275, "post_id": 56218488, "comment_id": 99057991, "body": "in the &quot;early days&quot;, it was part of <code>System.IO.Error</code>: <a href=\"https://hackage.haskell.org/package/base-4.0.0.0/docs/System-IO-Error.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.0.0.0/docs/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1558352222, "last_edit_date": 1558352222, "creation_date": 1558350903, "answer_id": 56219858, "question_id": 56218488, "link": "https://stackoverflow.com/questions/56218488/why-this-try-catch-example-is-not-working/56219858#56219858", "title": "Why this try catch example is not working", "body": "<p>The example in <a href=\"http://learnyouahaskell.com/input-and-output#exceptions\" rel=\"nofollow noreferrer\"><em>Learn You a Haskell for the Greater Good</em></a> is <em>outdated</em>, the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Exception.html#v:catch\" rel=\"nofollow noreferrer\"><strong><code>catch :: Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a</code></strong></a> function is part of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Exception.html\" rel=\"nofollow noreferrer\"><strong><code>Control.Exception</code></strong></a>.</p>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/System-IO-Error.html\" rel=\"nofollow noreferrer\"><strong><code>System.IO.Error</code></strong></a> however still has a catch function that is here applicable: <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/System-IO-Error.html#v:catchIOError\" rel=\"nofollow noreferrer\"><strong><code>catchIOError :: IO a -&gt; (IOError -&gt; IO a) -&gt; IO a</code></strong></a>, but as the documentation says:</p>\n\n<blockquote>\n  <p>The <code>catchIOError</code> function establishes a handler that receives any <code>IOException</code> raised in the action protected by <code>catchIOError</code>. An IOException is caught by the most recent handler established by one of the exception handling functions. These handlers are not selective: all <code>IOExceptions</code> are caught.</p>\n  \n  <p>(...)</p>\n  \n  <p><strong>Non-I/O exceptions are not caught by this</strong> variant; to catch all exceptions, use <code>catch</code> from <code>Control.Exception</code>.</p>\n</blockquote>\n\n<p>So you can fix the problem here by using <code>catchIOError</code> (since you are dealing with an <code>IOError</code>, but as specified in the documentation, this only covers a limited set of exceptions), or you can import <code>catch</code> from <code>Control.Exception</code>:</p>\n\n<pre><code><b>import Control.Exception(catch)</b>\n\nimport System.Environment  \nimport System.IO  \nimport System.IO.Error\n\nmain :: IO ()\nmain = toTry `<b>catch</b>` handler  \n\ntoTry :: IO ()  \ntoTry = do (fileName:_) &lt;- getArgs  \n           contents &lt;- readFile fileName  \n           putStrLn $ &quot;The file has &quot; ++ show (length (lines contents)) ++ &quot; lines!&quot;\n\nhandler :: IOError -&gt; IO ()  \nhandler e = putStrLn &quot;Whoops, had some trouble!&quot;</code></pre>\n"}], "owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56219858, "answer_count": 1, "score": 3, "last_activity_date": 1558352222, "creation_date": 1558346223, "question_id": 56218488, "link": "https://stackoverflow.com/questions/56218488/why-this-try-catch-example-is-not-working", "title": "Why this try catch example is not working", "body": "<p>I have following demo code from <a href=\"http://learnyouahaskell.com/input-and-output#exceptions\" rel=\"nofollow noreferrer\">here</a>: </p>\n\n<pre><code>import System.Environment  \nimport System.IO  \nimport System.IO.Error  \n\nmain = toTry `catch` handler  \n\ntoTry :: IO ()  \ntoTry = do (fileName:_) &lt;- getArgs  \n           contents &lt;- readFile fileName  \n           putStrLn $ \"The file has \" ++ show (length (lines contents)) ++ \" lines!\"  \n\nhandler :: IOError -&gt; IO ()  \nhandler e = putStrLn \"Whoops, had some trouble!\"\n</code></pre>\n\n<p>But it is giving me error:</p>\n\n<pre><code>runghc trycatch2.hs \n\ntrycatch2.hs:5:14: error:\n    Variable not in scope: catch :: IO () -&gt; (IOError -&gt; IO ()) -&gt; t\n</code></pre>\n\n<p>Where is the problem and how can it be solved? Thanks.</p>\n"}, {"tags": ["haskell", "compiler-optimization"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1558336385, "post_id": 56215430, "comment_id": 99052454, "body": "Look at the &quot;full laziness&quot; transformation"}, {"owner": {"reputation": 542, "user_id": 4440871, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/8gHuC.jpg?s=128&g=1", "display_name": "Fabian Schneider", "link": "https://stackoverflow.com/users/4440871/fabian-schneider"}, "edited": false, "score": 1, "creation_date": 1558337183, "post_id": 56215430, "comment_id": 99052791, "body": "As I understand it the Haskell compiler is implemented using graph reduction; shouldn&#39;t this take care of that problem at compile time? (just a thought...)"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1558346145, "post_id": 56215430, "comment_id": 99057432, "body": "The GHC Core output for this program evaluates <code>x * x * x</code> exactly once. We need to consider much more than lambda lifting to reason about program performance. Also, GHC does closure conversion instead of lambda lifting AFAIK, strictly speaking."}], "owner": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 214, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1558334046, "creation_date": 1558334046, "question_id": 56215430, "link": "https://stackoverflow.com/questions/56215430/is-lambda-lifting-necessary", "title": "Is Lambda Lifting necessary?", "body": "<p>Many functional programming language's compiler has a Lambda Lifting pass, and I'm wondering, is this the best way to implement a functional programming language?</p>\n\n<p>Let's consider the following example:</p>\n\n<pre><code>foo :: Int -&gt; Int -&gt; Int\nfoo = \\x -&gt; \\y -&gt; x * x * x + y\n\nmain = print $ sum (map (foo 5) [0..100])\n</code></pre>\n\n<p>if without lambda lifting, we need to calc <code>x * x * x</code> only 1 time, but if with lambda lifting, we will need to calc <code>x * x * x</code> 100 times.</p>\n\n<p>So I'm wondering, did GHC always do lambda lifting even in the above case? is it necessary? Or is there any alternative FP lang compiling technology which can handle the above case better?</p>\n"}, {"tags": ["haskell", "filter", "list-comprehension", "higher-order-functions"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1558353026, "post_id": 56215405, "comment_id": 99061199, "body": "&quot;it always throws a compiler error&quot; should be followed by the full error message. Posting the errors you get is very useful to potential answerers. Please remember that for future questions."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 4, "last_activity_date": 1568631276, "last_edit_date": 1568631276, "creation_date": 1558334010, "answer_id": 56215421, "question_id": 56215405, "link": "https://stackoverflow.com/questions/56215405/custom-filter-function-with-predicate-using-list-comprehension/56215421#56215421", "title": "Custom Filter Function with Predicate using List Comprehension", "body": "<p>It is as simple as </p>\n\n<pre><code>      [x | x &lt;- xs, p x]\n</code></pre>\n\n<p>Since <code>p :: a -&gt; Bool</code>, and <code>xs :: [a]</code>, to get a Boolean we need to <em>apply</em> the function to an argument; and by the list comprehension semantics we have <code>x :: a</code>. </p>\n\n<p>The <em>application</em> rule of type inference is</p>\n\n<pre><code>            x :: a\n          p   :: a -&gt; b\n         ---------------\n          p x ::      b\n</code></pre>\n\n<p>And you don't need the pattern matching, list comprehension will take care of that. </p>\n\n<p>So overall, it is</p>\n\n<pre><code>lcFilter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nlcFilter p xs = [x | x &lt;- xs, p]\n</code></pre>\n\n<hr>\n\n<p>List comprehensions are fun. One rule they follow is</p>\n\n<pre><code>    [ ... | x &lt;- (xs            ++                ys), .... ]  ===\n    [ ... | x &lt;-  xs, ....  ]   ++   [ ... | x &lt;- ys , .... ]\n</code></pre>\n\n<p>As a consequence, we also have</p>\n\n<pre><code>    [ ... | x &lt;- ([y]           ++                ys), .... ]  ===\n    [ ... | x &lt;-  [y], .... ]   ++   [ ... | x &lt;- ys , .... ]  ===\n    [ ...{x/y} | ....{x/y}  ]   ++   [ ... | x &lt;- ys , .... ]  \n</code></pre>\n\n<p>where <code>{x/y}</code> means <em>\"replace <code>x</code> by <code>y</code> throughout\"</em>. Thus, a list <code>[a,b,...,n]</code> is transformed by your definition into </p>\n\n<pre><code>    [  a,           b,          ...,    n        ]             ===&gt;\n    [  a | p a] ++ [b | p b] ++ ... ++ [n | p n  ]\n</code></pre>\n\n<p>This can be further understood in terms of / serve as a nice illustration to / the concepts of <em>monads</em>, or of <em>monoids</em>, but we'll leave that for another day. :)</p>\n"}], "owner": {"reputation": 61, "user_id": 4360704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b13b095f0db76a623ca6b1140092cee?s=128&d=identicon&r=PG&f=1", "display_name": "thekevin", "link": "https://stackoverflow.com/users/4360704/thekevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1568631276, "creation_date": 1558333908, "last_edit_date": 1558371244, "question_id": 56215405, "link": "https://stackoverflow.com/questions/56215405/custom-filter-function-with-predicate-using-list-comprehension", "title": "Custom Filter Function with Predicate using List Comprehension", "body": "<p>I need to develop my own filter function similar to how <code>filter</code> works in Haskell but by using list comprehension and a predicate. So I would put <code>lcFilter (&gt;3) [1,2,3,4,5,6,10,444,3]</code> in ghci and it would print all numbers greater than 3.</p>\n\n<p>My code is based on a recursion example which I'm good at but I can't seem to convert to list comprehension. It seams no matter what I put in <code>[x | x&lt;-xs, p]</code> it always throws a compiler error. I know the <code>p</code> part is wrong. I've tried <code>==p</code>, <code>xs==p</code> and just about everything else I could think of. This makes me think some other part might be wrong but I'm really not sure.</p>\n\n<p>Here is the code for my function <code>lcFilter</code>. I'm not sure if some or all of it is wrong so I'm posting the whole thing.</p>\n\n<pre><code>lcFilter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nlcFilter _ [] = []\nlcFilter p (x:xs) = [x | x&lt;-xs, p]\n</code></pre>\n\n<p>If I type <code>lcFilter (&gt;3) [1,2,3,4,5]</code> it should print <code>[4,5]</code> just like the standard Haskell <code>filter</code> function.</p>\n"}, {"tags": ["haskell", "pattern-matching", "ghci"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558291609, "post_id": 56210942, "comment_id": 99043081, "body": "I assume you defined this in the terminal? <a href=\"https://stackoverflow.com/q/26738392/67579\">stackoverflow.com/q/26738392/67579</a>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1558291949, "post_id": 56210942, "comment_id": 99043151, "body": "In addition to the question suggested by Willem, there are ways to make it work directly in GHCi. See <a href=\"https://stackoverflow.com/q/42593284/2751851\"><i>Function definition by special cases in GHCi</i></a>."}], "owner": {"reputation": 448, "user_id": 4743466, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/35b9eee7a42e06c9845b2a5df2be4596?s=128&d=identicon&r=PG", "display_name": "Erik Vesterlund", "link": "https://stackoverflow.com/users/4743466/erik-vesterlund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "closed_date": 1558291615, "answer_count": 0, "score": 0, "last_activity_date": 1558291992, "creation_date": 1558291531, "last_edit_date": 1558291992, "question_id": 56210942, "link": "https://stackoverflow.com/questions/56210942/incorrect-non-exhaustive-patterns-exception-in-haskell", "closed_reason": "Duplicate", "title": "Incorrect &#39;non-exhaustive patterns&#39; exception in Haskell?", "body": "<p>I'm going through Learn you a Haskell and some of the examples don't seem to work. I'm assuming that tutorial is reputable enough, so I'm a bit surprised. A couple of examples, in GHCi 8.0.2:</p>\n\n<pre><code>length' [] = 0  \nlength' (_:xs) = 1 + length' xs\nl = [1,2,3]\nlength' l\n*** Exception: &lt;interactive&gt;:2:1-31: Non-exhaustive patterns in function length'\n</code></pre>\n\n<pre><code>sum' [] = 0\nsum' (x:xs) = x + sum' xs\nl = [1,2,3]\nsum' l\n*** Exception: &lt;interactive&gt;:2:1-25: Non-exhaustive patterns in function sum'\n</code></pre>\n\n<p>From here: <a href=\"http://learnyouahaskell.com/syntax-in-functions\" rel=\"nofollow noreferrer\">http://learnyouahaskell.com/syntax-in-functions</a>.</p>\n\n<p>The functions look correct enough, so, what's going on here, what did I do wrong?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1558285354, "post_id": 56210092, "comment_id": 99041320, "body": "I&#39;m not entirely sure of what&#39;s going on here, but if you want a list with 2 items, they have to be comma-separated. Try <code>Room.items = [Item.Item { Item.name = &quot;Trident&quot; }, Item.Item { Item.name = &quot;Trident2&quot; }</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1558285576, "post_id": 56210092, "comment_id": 99041397, "body": "In a list, you separate items with a comma, as in <code>[1, 2, 3]</code>. I&#39;m not sure what <code>[ Item.Item { Item.name = &quot;Trident&quot; } { Item.name = &quot;Trident2&quot; } ]</code> ever means, but it&#39;s not a list of two items."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1558292300, "post_id": 56210092, "comment_id": 99043240, "body": "It&#39;s record syntax for updating the value with a new field."}], "answers": [{"tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": false, "score": 6, "last_activity_date": 1558285367, "creation_date": 1558285367, "answer_id": 56210119, "question_id": 56210092, "link": "https://stackoverflow.com/questions/56210092/listing-items-in-haskell/56210119#56210119", "title": "Listing Items in Haskell", "body": "<p>Assuming <code>Item.Item</code> is the name of a data constructor with record syntax, you simply need to use it twice.</p>\n\n<pre><code>Room.items = [\n   Item.Item { Item.name = \"Trident\" }, Item.Item { Item.name = \"Trident2\" }\n]\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5069372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5950a14cf9cc9deae55fbfd469f4351?s=128&d=identicon&r=PG&f=1", "display_name": "lynchbox", "link": "https://stackoverflow.com/users/5069372/lynchbox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558300929, "creation_date": 1558285172, "last_edit_date": 1558300929, "question_id": 56210092, "link": "https://stackoverflow.com/questions/56210092/listing-items-in-haskell", "title": "Listing Items in Haskell", "body": "<p>I'm having some trouble creating a list of items in Haskell for a text based adventure game. </p>\n\n<pre><code>(\"cavern\",\nRoom.Room { Room.name = \"Cavern\"\n     , Room.description = \"\"\n     , Room.directions = Map.fromList [\n         (North, \"hall\") ]\n     , Room.visited = False\n     , Room.items = [\n         Item.Item { Item.name = \"Trident\" } ]\n     })\n</code></pre>\n\n<p>Is the code and i'm trying to add multiple items to a room however nothing I've tried seems to work the closest I got was using</p>\n\n<pre><code>(\"cavern\",\nRoom.Room { Room.name = \"Cavern\"\n     , Room.description = \"\"\n     , Room.directions = Map.fromList [\n         (North, \"hall\") ]\n     , Room.visited = False\n     , Room.items = [\n         Item.Item { Item.name = \"Trident\" } { Item.name = \"Trident2\" } ]\n     })\n</code></pre>\n\n<p>But this just made it so the last item block was the only item in the room</p>\n"}, {"tags": ["haskell", "character"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 5, "creation_date": 1558281576, "post_id": 56209413, "comment_id": 99040305, "body": "(1) <code>isBinary</code> doesn&#39;t need a do-block, because you aren&#39;t using <code>IO</code> or any other monad there. (2) Adding type signatures to your top-level definitions would have resulted in a clearer error message. (3) <code>any (&gt;127) ss</code> is trying to use a test for numbers (<code>(&gt;127)</code>) on characters (the elements of <code>ss</code>). You need to convert the characters to numbers before doing so."}], "answers": [{"comments": [{"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558286113, "post_id": 56209624, "comment_id": 99041594, "body": "Very well explained. Can we use <code>charToInt</code> ?  ( <a href=\"https://hackage.haskell.org/package/basement-0.0.10/docs/Basement-IntegralConv.html#v:charToInt\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/basement-0.0.10/docs/&hellip;</a> )"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 1, "creation_date": 1558286749, "post_id": 56209624, "comment_id": 99041791, "body": "@rnso You probably wouldn&#39;t want to because that function is in a separate package, and would require a dependency."}], "tags": [], "owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "is_accepted": true, "score": 5, "last_activity_date": 1558293351, "last_edit_date": 1558293351, "creation_date": 1558282063, "answer_id": 56209624, "question_id": 56209413, "link": "https://stackoverflow.com/questions/56209413/function-to-find-if-any-char-as-int-is-127/56209624#56209624", "title": "Function to find if any char as int is &gt; 127", "body": "<p>The problem is that <code>Char</code> is not a numeric type (unlike in a language like C) - this is what the <code>No instance for (Num Char) arising from a use of \u2018isbinary'</code> is trying to tell you. You need to explicitly convert it. Let's search - I typed <code>Char -&gt; Int</code> into <a href=\"https://hoogle.haskell.org/?hoogle=Char%20-%3E%20Int\" rel=\"nofollow noreferrer\">Hoogle</a>. The second result <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Char.html#v:ord\" rel=\"nofollow noreferrer\"><code>ord</code></a> is what we're looking for.</p>\n\n<pre><code>import Data.Char (ord)\n\nisbinary :: String -&gt; Bool\nisbinary s = any (\\c -&gt; ord c &gt; 127) s\n</code></pre>\n\n<p>To make the intent clearer, it you could use the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Char.html#v:isAscii\" rel=\"nofollow noreferrer\">isAscii</a> function </p>\n\n<pre><code>import Data.Char (isAscii)\n\nisbinary :: String -&gt; Bool\nisbinary s = any (\\c -&gt; not (isAscii c)) s\n</code></pre>\n\n<p>Cleaning up the code a little bit (we usually eta-reduce and use camelCase names)</p>\n\n<pre><code>import Data.Char (isAscii)\n\nisBinary :: String -&gt; Bool\nisBinary = any (not . isAscii)\n</code></pre>\n\n<p>One more possible solution is to write <code>isBinary = any (&gt; '\\127')</code>.</p>\n"}], "owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 56209624, "answer_count": 1, "score": 0, "last_activity_date": 1558293351, "creation_date": 1558280685, "last_edit_date": 1558281048, "question_id": 56209413, "link": "https://stackoverflow.com/questions/56209413/function-to-find-if-any-char-as-int-is-127", "title": "Function to find if any char as int is &gt; 127", "body": "<p>I have following simple code to find if any character of string converted to int is > 127 : </p>\n\n<pre><code>isbinary ss = do\n    if any (&gt;127) ss \n    then return \"True\"\n    else return \"False\"\n\nmystr = \"this is a test\"\nmain = do \n    print (isbinary mystr)\n</code></pre>\n\n<p>However, I am getting following error: </p>\n\n<pre><code>$ runghc isbinary.hs\n\nisbinary.hs:9:9: error:\n    \u2022 Ambiguous type variable \u2018m0\u2019 arising from a use of \u2018print\u2019\n      prevents the constraint \u2018(Show (m0 [Char]))\u2019 from being solved.\n      Probable fix: use a type annotation to specify what \u2018m0\u2019 should be.\n      These potential instances exist:\n        instance (Show a, Show b) =&gt; Show (Either a b)\n          -- Defined in \u2018Data.Either\u2019\n        instance Show a =&gt; Show (Maybe a) -- Defined in \u2018GHC.Show\u2019\n        instance (Show a, Show b) =&gt; Show (a, b) -- Defined in \u2018GHC.Show\u2019\n        ...plus 14 others\n        ...plus 24 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    \u2022 In a stmt of a 'do' block: print (isbinary mystr)\n      In the expression: do { print (isbinary mystr) }\n      In an equation for \u2018main\u2019: main = do { print (isbinary mystr) }\n\nisbinary.hs:9:16: error:\n    \u2022 No instance for (Num Char) arising from a use of \u2018isbinary\u2019\n    \u2022 In the first argument of \u2018print\u2019, namely \u2018(isbinary mystr)\u2019\n      In a stmt of a 'do' block: print (isbinary mystr)\n      In the expression: do { print (isbinary mystr) }\n</code></pre>\n\n<p><code>print $ isbinary mystr</code> also does not work.</p>\n\n<p>Where is the problem and how can it be solved? Thanks.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 6, "creation_date": 1558279412, "post_id": 56209194, "comment_id": 99039682, "body": "Since you usee as pattern <code>pairs@((x1,x2):xs)</code>, <code>pairs == []</code> can never be true."}, {"owner": {"reputation": 19, "user_id": 11524119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/421f1a0235f5d3da707dbe12b73e0128?s=128&d=identicon&r=PG&f=1", "display_name": "Axel1999", "link": "https://stackoverflow.com/users/11524119/axel1999"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558279974, "post_id": 56209194, "comment_id": 99039821, "body": "I don&#39;t quite understand what you mean"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558280020, "post_id": 56209194, "comment_id": 99039840, "body": "do you understand what the <code>(_:_)</code> pattern means?"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1558279888, "creation_date": 1558279888, "answer_id": 56209303, "question_id": 56209194, "link": "https://stackoverflow.com/questions/56209194/non-exhaustive-patterns-in-a-function-haskell/56209303#56209303", "title": "Non-exhaustive patterns in a function [Haskell]", "body": "<p>The only pattern you specify is:</p>\n\n<pre><code>neighbours <b>pairs@((x1,x2):xs)</b> inputWord</code></pre>\n\n<p>This thus means that this only works for non-empty lists. Indeed, the pattern <code>((x1, x2):xs)</code> \"fires\" given it matches with a \"cons\" with <code>(x1, x2)</code> the first element of the list, and <code>xs</code> the rest of the elements.</p>\n\n<p>The check <code>pair == []</code> will never succeed, since the pattern already means that this can never be an empty list.</p>\n\n<p>We can add a clause for the empty list pattern, for example as first pattern to match. Furthermore we can improve the readability of the code by using the <code>((<b>(x11, x12)</b>, x2):xs)</code> pattern for a non-empty list. We then do not need to use <code>fst</code> and <code>snd</code>, but can use <code>x11</code> and <code>x12</code> directly:</p>\n\n<pre><code>neighbours :: Eq a =&gt; [((a, a), b)] -&gt; a -&gt; [(a, b)]\nneighbours <b>[] _ = []</b>\nneighbours pairs@((<b>(x11, x12)</b>,x2):xs) inputWord\n    | inputWord == x11 = (x11, x2) : tl\n    | inputWord == x12 = (x12, x2) : tl\n    | otherwise = tl\n    where tl = neighbours xs inputWord</code></pre>\n\n<p>For example:</p>\n\n<pre><code>Prelude&gt; neighbours [(('a', 'b'), 1), (('b', 'a'), 2), (('b', 'b'), 3), (('a', 'a'), 4)] 'a'\n[('a',1),('a',2),('a',4)]\n</code></pre>\n\n<p>This function is however a bit \"asymetrical\" since for the two elements in the tuple, it \"prefers\" the first element over the second element. If the two items <code>x11</code> and <code>x12</code> are both equal to <code>inputWord</code>, it might make more sense to <em>yield</em> them both.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1558280402, "creation_date": 1558280402, "answer_id": 56209366, "question_id": 56209194, "link": "https://stackoverflow.com/questions/56209194/non-exhaustive-patterns-in-a-function-haskell/56209366#56209366", "title": "Non-exhaustive patterns in a function [Haskell]", "body": "<p>If you define a helper function to do the comparison to <code>inputWord</code>, the definition of <code>neighbors</code> becomes much simpler:</p>\n\n<pre><code>-- You can use other, more descriptive names instead.\ntype Foo = ((String, String), Int)\ntype Bar = (String, Int)\n\n-- If it seems odd that I'm using [Bar] instead of Maybe Bar, see below\nmyLookup :: String -&gt; Foo -&gt; [Bar]\nmyLookup s ((s1, s2), i) | s == s1 = [(s2, i)]\n                         | s == s2 = [(s1, i)]\n                         | otherwise = []\n\nneighbors :: [Foo] -&gt; String -&gt; [Bar]\nneighbors [] _ = []\nneighbors (x:xs) inputWord = case myLookup inputWord x of\n                               []  -&gt;     neighbors xs inputWord\n                               [y] -&gt; y : neighbors xs inputWord\n</code></pre>\n\n<p>It can be further simplified using <code>concatMap</code>, which simply concatenates\nthe results of applying <code>myLookup inputWord</code> to each element of the input.</p>\n\n<pre><code>neighbors :: [Foo] -&gt; String -&gt; [Bar]\nneighbors xs inputWord = concatMap (myLookup inputWord) xs\n</code></pre>\n\n<hr>\n\n<p>With this pattern in mind, we can switch to using the stricter <code>Maybe Bar</code> return type for <code>myLookup</code> by using <code>mapMaybe</code> from <code>Data.Maybe</code> instead of <code>concatMap</code>.</p>\n\n<pre><code>import Data.Maybe (mapMaybe)\n\ntype Foo = ((String, String), Int)\ntype Bar = (String, Int)\n\nmyLookup :: String -&gt; Foo -&gt; Maybe Bar\nmyLookup s ((s1, s2), i) | s == s1 = Just (s2, i)\n                         | s == s2 = Just (s1, i)\n                         | otherwise = Nothing\n\nneighbors :: [Foo] -&gt; String -&gt; [Bar]\nneighbors xs inputWord = mapMaybe (myLookup inputWord) xs\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11524119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/421f1a0235f5d3da707dbe12b73e0128?s=128&d=identicon&r=PG&f=1", "display_name": "Axel1999", "link": "https://stackoverflow.com/users/11524119/axel1999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 56209303, "answer_count": 2, "score": 0, "last_activity_date": 1558280402, "creation_date": 1558279234, "last_edit_date": 1558279387, "question_id": 56209194, "link": "https://stackoverflow.com/questions/56209194/non-exhaustive-patterns-in-a-function-haskell", "title": "Non-exhaustive patterns in a function [Haskell]", "body": "<p>I have to make a function neighbours :: [((String, String), Int)] -> String -> [(String, Int)] </p>\n\n<p>This is the function I came up with:</p>\n\n<pre><code>neighbours pairs@((x1,x2):xs) inputWord\n | pairs == [] = []\n | fst x1 == inputWord = ((snd x1), x2) : (neighbours xs inputWord)\n | snd x1 == inputWord = ((fst x1), x2) : (neighbours xs inputWord)\n | otherwise = (neighbours xs inputWord)\n</code></pre>\n\n<p>The output is supposed to be a list of tuples with the strings that were paired with inputWord in the tuple x1, together with the integer x2</p>\n\n<p>The problem is that I get non-exhaustive patterns that I don't believe should be there.</p>\n\n<p>I tried to replace <code>pairs == [] = []</code> with <code>xs == [] = []</code></p>\n\n<p>This made the non-exhaustive patterns disappear for when the list was not empty, but it also prevented the function from traversing the last tuple of tuples.</p>\n"}, {"tags": ["file", "haskell", "binaryfiles"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 5, "creation_date": 1558271065, "post_id": 56208067, "comment_id": 99037535, "body": "What do you mean the file &#39;is binary&#39;? This is a computer \u2014 <i>every</i> file is binary!"}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1558271094, "post_id": 56208067, "comment_id": 99037544, "body": "Having unprintable characters. What will be proper term for this?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1558271178, "post_id": 56208067, "comment_id": 99037562, "body": "Please edit your question to reflect this."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1558271275, "post_id": 56208067, "comment_id": 99037582, "body": "Relevant: <a href=\"https://hoogle.haskell.org/?hoogle=isUTF8Encoded+%3A%3A+String+-%3E+Bool\" rel=\"nofollow noreferrer\"><code>isUTF8Encoded :: String -&gt; Bool</code></a>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1558271309, "post_id": 56208067, "comment_id": 99037592, "body": "You should open the file in binary mode and read its bytes (<code>hGetLine</code> does not seem appropriate), e.g. using bytestrings. Then you can try to decode its contents using ASCII or UTF8 (or what you think it&#39;s more appropriate). If the decoding fails, the file was &quot;binary&quot;. If it suceeds, you might want to check for non printable chars. It all depends on the precise definition for &quot;binary&quot;."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1558271580, "post_id": 56208067, "comment_id": 99037653, "body": "@AJFarmar IMO, it&#39;s very unfortunate that <code>isUTF8Encoded</code> works on strings rather than <code>[Word8]</code> or bytestrings. (In <code>Data.ByteString.UTF8</code> there&#39;s no similar function, for some reason.)"}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558272639, "post_id": 56208067, "comment_id": 99037936, "body": "I need to find about character encoding from file handle itself. Pl see the edit in my question above."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1558274282, "post_id": 56208067, "comment_id": 99038317, "body": "In general, you cannot infer character encoding from the file; you have to <i>know</i> how it is encoded."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558275501, "post_id": 56208067, "comment_id": 99038615, "body": "So, the only way is to enclose this in try-catch type of block? Could you post an answer."}, {"owner": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 0, "creation_date": 1558607930, "post_id": 56208067, "comment_id": 99161317, "body": "The basic answer to this question is that there is no correct way to do what you&#39;re asking. A file may <i>look</i> as though it contains unprintable characters (by whatever definition), but you may just be using the wrong encoding to decode the contents, with a different encoding it may contain printable characters. But for a given file, it may be possible to find an encoding that only yields printable characters, even if the file isn&#39;t meant to contain text. So basically, there is no correct way. You can add heuristics and guesses, but they will never be 100% &quot;correct&quot;, 100% of the time."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558616878, "post_id": 56208067, "comment_id": 99166262, "body": "For practical purposes, I only want to know if any character in the string is of ASCII or int value &gt; 127. What is best code for it?"}], "answers": [{"tags": [], "owner": {"reputation": 1058, "user_id": 514723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda2cf2c56094de269a607dd0b3e1662?s=128&d=identicon&r=PG", "display_name": "Zouppen", "link": "https://stackoverflow.com/users/514723/zouppen"}, "is_accepted": true, "score": 1, "last_activity_date": 1558607575, "creation_date": 1558607575, "answer_id": 56273292, "question_id": 56208067, "link": "https://stackoverflow.com/questions/56208067/how-to-find-if-a-file-is-binary/56273292#56273292", "title": "How to find if a file is binary", "body": "<p>The definition of binary is quite vague, but assuming you mean content which is not valid UTF-8 text.</p>\n\n<p>You should use <code>toString</code> in <code>Data.ByteString.UTF8</code> which replaces non-UTF-8 characters with a replacement character but doesn't fail with an error.</p>\n\n<p>Converting your example to use UTF-8 ByteStrings:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Monoid\nimport System.IO\nimport System.Directory\nimport qualified Data.ByteString as B\nimport qualified Data.ByteString.UTF8 as B\n\nreadALine :: FilePath -&gt; IO ()\nreadALine fname = do\n  putStr . show $ \"Filename: \" ++ fname ++ \"; \"\n  fs &lt;- getFileSize fname\n  if fs &gt; 0 then do\n      hand &lt;- openFile fname ReadMode\n      fline  &lt;- B.hGetLine hand\n      hClose hand\n      print $ \"First line: \" &lt;&gt; B.toString fline\n  else return ()\n</code></pre>\n\n<p>This code doesn't fail on binary but is not really detecting binary content. If you want to detect binary, look for <code>B.replacement_char</code> in your data. To detect non-printable characters, you may look for code points smaller than 32 (space character) as well.</p>\n"}], "owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 56273292, "answer_count": 1, "score": -2, "last_activity_date": 1558607575, "creation_date": 1558270711, "last_edit_date": 1558272550, "question_id": 56208067, "link": "https://stackoverflow.com/questions/56208067/how-to-find-if-a-file-is-binary", "title": "How to find if a file is binary", "body": "<p>I am trying to read text of all files in a folder with following code:</p>\n\n<pre><code>readALine :: FilePath -&gt; IO ()\nreadALine fname = do \n  putStr . show $ \"Filename: \" ++ fname ++ \"; \"\n  fs &lt;- getFileSize fname\n  if fs &gt; 0 then do \n      hand &lt;- openFile fname ReadMode\n      fline  &lt;- hGetLine hand\n      hClose hand\n      print $ \"First line: \" &lt;&gt; fline\n  else return ()\n</code></pre>\n\n<p>However, some of these files are binary. How can I find if a given file is binary? I could not find any such function in <a href=\"https://hoogle.haskell.org/?hoogle=binary%20file\" rel=\"nofollow noreferrer\">https://hoogle.haskell.org/?hoogle=binary%20file</a></p>\n\n<p>Thanks for your help.</p>\n\n<p>Edit: By binary I mean the file has unprintable characters. I am not sure of proper term for these files.</p>\n\n<p>I installed UTF8-string and modified the code: </p>\n\n<pre><code>readALine :: FilePath -&gt; IO ()\nreadALine fname = do \n  putStr . show $ \"Filename: \" ++ fname ++ \"; \"\n  fs &lt;- getFileSize fname\n  if fs &gt; 0 then do \n      hand &lt;- openFile fname ReadMode\n      fline  &lt;- hGetLine hand\n      hClose hand\n      if isUTF8Encoded (unpack fline) then do\n        print $ \"Not binary file.\"\n        print $ \"First line: \" &lt;&gt; fline\n      else return ()\n  else return ()\n</code></pre>\n\n<p>Now it works but on encountering a 'binary' executable file (called esync.x), there is error at <code>hGetLine hand</code> expression:</p>\n\n<pre><code>\"Filename: ./esync.x; \"firstline2.hs: ./esync.x: hGetLine: invalid argument (invalid byte sequence)\n</code></pre>\n\n<p>How can I check about characters from file handle itself?</p>\n"}, {"tags": ["file", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558268611, "post_id": 56207757, "comment_id": 99036885, "body": "Are you sure you installed the <code>directory-1.3.3.2</code> package (look at the version of the package). Since <code>getFileSize</code> is a <code>FilePath -&gt; IO Int</code>, you should first obtain the filesize with <code>fs &lt;- getFileSize ff; if fs &gt; 0 ...</code>."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558268668, "post_id": 56207757, "comment_id": 99036900, "body": "How do I check package version? I am working on Debian Stable Linux with ghc version: <code>The Glorious Glasgow Haskell Compilation System, version 8.0.1</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558268810, "post_id": 56207757, "comment_id": 99036936, "body": "You can check <code>cabal list directory</code> and look what version is listed under <code>Installed versions:</code>."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558269068, "post_id": 56207757, "comment_id": 99037011, "body": "<code>Installed versions: 1.2.6.2</code> while needed is <code>1.2.7.0</code> or later. How do I resolve this?"}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558269218, "post_id": 56207757, "comment_id": 99037049, "body": "Can I use <code>fileSize</code>: <a href=\"https://hackage.haskell.org/package/MissingH-1.4.2.0/docs/System-IO-HVFS-InstanceHelpers.html#v:fileSize\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/MissingH-1.4.2.0/docs/&hellip;</a>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558269294, "post_id": 56207757, "comment_id": 99037065, "body": "@mso: what about <code>cabal install directory-1.3.3.2</code>."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558269524, "post_id": 56207757, "comment_id": 99037122, "body": "@WillemVanOnsem Pl see edit in my question above."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1558269598, "post_id": 56207757, "comment_id": 99037141, "body": "@rnso That&#39;s a different question. Please don&#39;t ask new questions by editing old ones."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558269655, "post_id": 56207757, "comment_id": 99037154, "body": "OK. If you enter your comments as an answer, I will accept it."}], "owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558269673, "creation_date": 1558268448, "last_edit_date": 1558269673, "question_id": 56207757, "link": "https://stackoverflow.com/questions/56207757/why-getfilesize-not-being-imported", "title": "Why getFileSize not being imported", "body": "<p>I am trying following code:</p>\n\n<pre><code> import System.Directory (getDirectoryContents, doesFileExist, getFileSize)\n\n-- ...more code\n\nreadALine :: FilePath -&gt; IO ()\nreadALine fname = do \n  print $ \"Filename: \" ++ fname\n  ff &lt;- openFile fname ReadMode\n  if getFileSize ff &gt; 0 then do \n      fline  &lt;- hGetLine ff\n      hClose ff\n      print $ \"First line: \" &lt;&gt; fline\n  else return ()\n</code></pre>\n\n<p>But getting following error:</p>\n\n<pre><code>$ runghc firstline2.hs\n\nfirstline2.hs:6:63: error:\n    Module \u2018System.Directory\u2019 does not export \u2018getFileSize\u2019\n</code></pre>\n\n<p>Why this is not getting imported when it exists in <a href=\"https://hackage.haskell.org/package/directory-1.3.3.2/docs/System-Directory.html#v:getFileSize\" rel=\"nofollow noreferrer\">package</a>?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 17989, "user_id": 365102, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e3139989e6548e7deac2cd45253d60df?s=128&d=identicon&r=PG", "display_name": "Mateen Ulhaq", "link": "https://stackoverflow.com/users/365102/mateen-ulhaq"}, "edited": false, "score": 3, "creation_date": 1558264292, "post_id": 56207121, "comment_id": 99035943, "body": "<code>squareList = map (**2)</code>. You can &quot;upgrade&quot; a function to work on lists. What&#39;s not convenient about that?"}, {"owner": {"reputation": 17989, "user_id": 365102, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e3139989e6548e7deac2cd45253d60df?s=128&d=identicon&r=PG", "display_name": "Mateen Ulhaq", "link": "https://stackoverflow.com/users/365102/mateen-ulhaq"}, "edited": false, "score": 1, "creation_date": 1558264409, "post_id": 56207121, "comment_id": 99035969, "body": "<code>map</code> is also <code>fmap</code>. <code>fmap</code> is usually thought of as something that &quot;upgrades&quot; functions to work with special types (Functors)."}, {"owner": {"reputation": 1684, "user_id": 6856361, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-reTr7DecElc/AAAAAAAAAAI/AAAAAAAAAoc/tgkHGpJKIq0/photo.jpg?sz=128", "display_name": "Izbassar Tolegen", "link": "https://stackoverflow.com/users/6856361/izbassar-tolegen"}, "reply_to_user": {"reputation": 17989, "user_id": 365102, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e3139989e6548e7deac2cd45253d60df?s=128&d=identicon&r=PG", "display_name": "Mateen Ulhaq", "link": "https://stackoverflow.com/users/365102/mateen-ulhaq"}, "edited": false, "score": 0, "creation_date": 1558264470, "post_id": 56207121, "comment_id": 99035980, "body": "@MateenUlhaq I don&#39;t want to argue about what is convenient or not. I&#39;m curious about the reasoning behind such a decision, that&#39;s all. In other languages, the decision is different, which I just get used to."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 3, "creation_date": 1558264680, "post_id": 56207121, "comment_id": 99036028, "body": "@IzbassarTolegen The reasoning <i>is</i>  that it&#39;s very convenient."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 4, "creation_date": 1558264857, "post_id": 56207121, "comment_id": 99036064, "body": "@IzbassarTolegen In fact, for many functions in Haskell, the <i>only</i> reason for their argument order is convenience. For more details on argument order, see <a href=\"https://wiki.haskell.org/Parameter_order\" rel=\"nofollow noreferrer\">HaskellWiki</a>, <a href=\"https://stackoverflow.com/questions/31736467/is-there-significance-in-the-order-of-haskell-function-parameters\">this SO answer</a>, and <a href=\"https://stackoverflow.com/questions/5863128/ordering-of-parameters-to-make-use-of-currying\">this answer</a>."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 2, "creation_date": 1558266990, "post_id": 56207121, "comment_id": 99036496, "body": "In Scala the function isn&#39;t the second argument to <code>map</code> - it&#39;s the only argument to <code>map</code>. The function couldn&#39;t be on the left of the method name because then you&#39;d be calling <code>map</code> on the function object, not on the list, and functions don&#39;t have a method named <code>map</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1558280670, "post_id": 56207121, "comment_id": 99040018, "body": "for the function <code>(&gt;&gt;=)</code>, a function is its <i>second</i> argument, not first. Also for the function <code>(&amp;)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "is_accepted": true, "score": 6, "last_activity_date": 1558386394, "last_edit_date": 1558386394, "creation_date": 1558267919, "answer_id": 56207670, "question_id": 56207121, "link": "https://stackoverflow.com/questions/56207121/why-function-is-the-first-argument-in-haskell/56207670#56207670", "title": "Why function is the first argument in Haskell", "body": "<p>It is just a convention. This order is in most cases more useful than the opposite, because usually from <code>Data.List</code> library you would rather expect utilities that will allow you to \"transform given list\" than \"describe how to transform some fixed list\".</p>\n\n<p>Check this case:</p>\n\n<pre><code>f :: [Int] -&gt; [Int]\nf = map (+1)\n</code></pre>\n\n<p>Here <code>f</code> Is a function that increments all elements of any <code>Int</code> list. It could be called <code>incrAll</code> and it would sound more flexible than</p>\n\n<pre><code>g :: (Int -&gt; a) -&gt; [a]\ng f = map f [1,2,3] \n</code></pre>\n\n<p>that is fixed to work on this particular <code>[1,2,3]</code> list. Of course, it may find some usage but it is less likely in general. <code>f</code> after single application is still a function that \"works on lists\". </p>\n\n<p>As I know Scala you may write something like <code>f = _.map(incr)</code> which is way nicer than (assuming <code>flipmap = flip map</code>) <code>\\l -&gt; flipmap l incr</code> or <code>flip flipmap incr</code>, but unfortunately Haskell does not support this kind of sugar. Next thing is that in Scala <code>map</code> has just one argument and it \"belongs\" to some list, so the order is quite similar to Haskell \u2013 the difference is in the philosophy of objective and functional approaches.</p>\n"}], "owner": {"reputation": 1684, "user_id": 6856361, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh6.googleusercontent.com/-reTr7DecElc/AAAAAAAAAAI/AAAAAAAAAoc/tgkHGpJKIq0/photo.jpg?sz=128", "display_name": "Izbassar Tolegen", "link": "https://stackoverflow.com/users/6856361/izbassar-tolegen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 56207670, "answer_count": 1, "score": 3, "last_activity_date": 1558386394, "creation_date": 1558263624, "last_edit_date": 1558264395, "question_id": 56207121, "link": "https://stackoverflow.com/questions/56207121/why-function-is-the-first-argument-in-haskell", "title": "Why function is the first argument in Haskell", "body": "<p>I started to learn Haskell. I'm curious about why in Haskell the function is taken as the first argument for the higher order functions for lists. For example here is a definition of <code>map</code>:</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>It means that I can use it either in prefix or operator form like that:</p>\n\n<pre><code>-- yields [3,5,7]\nmap (+ 2) [1,3,5]\n-- we can chain like that\nfilter (&lt; 4) (map (+ 2) [1,3,5])\n\n-- or in operator form \n(+ 2) `map` [1,3,5]\n(&lt; 4) `filter` ((+ 2) `map` [1,3,5])\n</code></pre>\n\n<p>In Scala the same can be written as follows:</p>\n\n<pre><code>List(1,3,5) map (_ + 2)\n// we can chain as follows:\nList(1,3,5) map (_ + 2) filter (_ &lt; 4)\n</code></pre>\n\n<p>So the order is reversed and we take the function as the second argument. What is the reason on arguments ordering in Haskell?</p>\n"}, {"tags": ["file", "haskell", "directory"], "answers": [{"comments": [{"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558267156, "post_id": 56206757, "comment_id": 99036533, "body": "I am trying <code>onlyFiles &lt;- filterM doesFileExist files</code> but it is giving error <code>Variable not in scope: filterM ::....</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558267192, "post_id": 56206757, "comment_id": 99036544, "body": "@mso: you need to import that as well, with <code>import Control.Monad(filterM)</code>"}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "edited": false, "score": 0, "creation_date": 1558267740, "post_id": 56206757, "comment_id": 99036674, "body": "Pl see this: <a href=\"https://stackoverflow.com/questions/56207643/code-block-error-in-simple-if-then-statement\" title=\"code block error in simple if then statement\">stackoverflow.com/questions/56207643/&hellip;</a>"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1558260444, "creation_date": 1558260444, "answer_id": 56206757, "question_id": 56206609, "link": "https://stackoverflow.com/questions/56206609/multiple-errors-in-reading-all-files-one-by-one/56206757#56206757", "title": "Multiple errors in reading all files one by one", "body": "<p>You forgot to <em>import</em> the function in your file, like:</p>\n\n<pre><code>import Data.Text.IO(hGetLine)\n</code></pre>\n\n<p>But still there are a lot of errors here, sine <code>hGetLine</code> expects a <code>Handle</code> not a file path. You need to open the file first, with <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/System-IO.html#v:openFile\" rel=\"nofollow noreferrer\"><strong><code>openFile :: FilePath -&gt; IOMode -&gt; IO Handle</code></strong></a>, and you need to close the handle after reading the line, with <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/System-IO.html#v:hClose\" rel=\"nofollow noreferrer\"><strong><code>hClose :: Handle -&gt; IO ()</code></strong></a>.</p>\n\n<p>In your <code>main</code> you write:</p>\n\n<pre><code><s>map</s> <s>(readALine f)</s> files</code></pre>\n\n<p>but <code>f</code> is not defined here. If you want to apply <code>readALine</code>, then you write <code>readALine</code>. Since <code>readALine</code> has type <code>String -&gt; IO ()</code>, you should use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:mapM_\" rel=\"nofollow noreferrer\"><strong><code>mapM_ :: Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m ()</code></strong></a>.</p>\n\n<p>Finally since <a href=\"https://hackage.haskell.org/package/text-1.2.3.1/docs/Data-Text-IO.html#v:hGetLine\" rel=\"nofollow noreferrer\"><strong><code>hGetLine :: Handler -&gt; IO Text</code></strong></a> returns an <code>IO Text</code> and not an <code>IO String</code>, you can not concatenate a <code>\"first line: \" :: String</code> to it, we can use the <code>OverloadedStrings</code> pragma, such that the <code>\"first line: \"</code> is interpreted as a <code>Text</code> here, and use the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-60--62-\" rel=\"nofollow noreferrer\"><strong>`(&lt;>) :: Semigroup s => s -> s -> s</strong></a> to perform a concatenation.</p>\n\n<p>Usually it is better to specify the signature of top level functions as well, although not strictly required, it shows some information about what the function is expecting as input and what it is doing.</p>\n\n<pre><code>{-# <b>LANGUAGE OverloadedStrings</b> #-}\n\nimport Data.Semigroup(<b>(&lt;&gt;)</b>)\nimport Data.Text.IO(hGetLine)\n\nimport System.Directory (getDirectoryContents)\nimport System.FilePath ((&lt;/&gt;))\nimport System.IO(<b>IOMode(ReadMode), openFile, hClose</b>)\n\ngetAbsoluteDirContents :: String -&gt; IO [FilePath]\ngetAbsoluteDirContents dir = do\n  contents &lt;- getDirectoryContents dir\n  return $ map (dir &lt;/&gt;) contents\n\nreadALine :: FilePath -&gt; IO ()\nreadALine x = do \n  print $ &quot;Filename: &quot; ++ x\n  <b>h &lt;- openFile x ReadMode</b>\n  f  &lt;- hGetLine <b>h</b>\n  <b>hClose h</b>\n  print $ &quot;First line: &quot; <b>&lt;&gt;</b> f\n\nmain :: IO ()\nmain = do \n  files &lt;- getAbsoluteDirContents &quot;.&quot;\n  print files\n  <b>mapM_ readALine</b> files</code></pre>\n\n<p>That being said, the program is still not working semantically correct, since your program will aim to open directories (like <code>.</code> and <code>..</code> as well). You thus will need to implement a proper filtering mechanism as well to prevent opening directories. You can use <a href=\"https://hackage.haskell.org/package/system-fileio-0.3.16.4/docs/Filesystem.html#v:isFile\" rel=\"nofollow noreferrer\"><strong><code>isFile :: FilePath -&gt; IO Bool</code></strong></a> for this, I leave that as an exercise.</p>\n"}], "owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 56206757, "answer_count": 1, "score": 1, "last_activity_date": 1558260444, "creation_date": 1558259098, "question_id": 56206609, "link": "https://stackoverflow.com/questions/56206609/multiple-errors-in-reading-all-files-one-by-one", "title": "Multiple errors in reading all files one by one", "body": "<p>I am trying to learn Haskell. I want to create a small program which gets list of files from current directory, read them one by one and prints their first line. I tried:</p>\n\n<pre><code>import System.Directory (getDirectoryContents)\nimport System.FilePath ((&lt;/&gt;))\n\ngetAbsoluteDirContents :: String -&gt; IO [FilePath]\n\ngetAbsoluteDirContents dir = do\n  contents &lt;- getDirectoryContents dir\n  return $ map (dir &lt;/&gt;) contents\n\nreadALine x = do \n  print $ \"Filename: \" ++ x\n  f  &lt;- hGetLine x\n  print $ \"First line: \" ++ f \n\nmain = do \n  files &lt;- getAbsoluteDirContents \".\"\n  print files\n  map (readALine f) files\n</code></pre>\n\n<p>However, this code is giving following detailed error: </p>\n\n<pre><code>$ ghc -o firstline.hsx firstline.hs\n[1 of 1] Compiling Main             ( firstline.hs, firstline.o )\n\nfirstline.hs:13:9: error:\n    \u2022 Variable not in scope: hGetLine :: [Char] -&gt; IO [Char]\n    \u2022 Perhaps you meant \u2018getLine\u2019 (imported from Prelude)\n\nfirstline.hs:19:3: error:\n    \u2022 Couldn't match type \u2018[]\u2019 with \u2018IO\u2019\n      Expected type: IO b\n        Actual type: [b]\n    \u2022 In a stmt of a 'do' block: map (readALine f) files\n      In the expression:\n        do { files &lt;- getAbsoluteDirContents \".\";\n             print files;\n             map (readALine f) files }\n      In an equation for \u2018main\u2019:\n          main\n            = do { files &lt;- getAbsoluteDirContents \".\";\n                   print files;\n                   map (readALine f) files }\n\nfirstline.hs:19:8: error:\n    \u2022 Couldn't match expected type \u2018FilePath -&gt; b\u2019\n                  with actual type \u2018IO ()\u2019\n    \u2022 Possible cause: \u2018readALine\u2019 is applied to too many arguments\n      In the first argument of \u2018map\u2019, namely \u2018(readALine f)\u2019\n      In a stmt of a 'do' block: map (readALine f) files\n      In the expression:\n        do { files &lt;- getAbsoluteDirContents \".\";\n             print files;\n             map (readALine f) files }\n    \u2022 Relevant bindings include\n        main :: IO b (bound at firstline.hs:16:1)\n\nfirstline.hs:19:18: error: Variable not in scope: f :: [Char]\n</code></pre>\n\n<p>I think main problem is <code>hGetLine</code> function is not correct. I saw this function <a href=\"https://hackage.haskell.org/package/text-1.2.3.1/docs/Data-Text-IO.html#v:hGetLine\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>There is also problem with <code>map (readALine f) files</code> expression.</p>\n\n<p>Where are the problems and how can they be solved? Thanks for your help.</p>\n"}, {"tags": ["haskell", "newtons-method"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1558216787, "post_id": 56203143, "comment_id": 99028789, "body": "Maybe you want to consider <code>takeWhile</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1558218219, "post_id": 56203143, "comment_id": 99029066, "body": "&quot;<i>the list returned by <code>iterate</code> is infinite, so I cannot use a tail function on it.</i>&quot; Why not? <code>tail</code> works fine on infinite lists."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1558218280, "post_id": 56203143, "comment_id": 99029073, "body": "Tangential note: if you want to use <code>newton</code> with different functions and margins, you might it useful to pass <code>f</code>, <code>g</code> and <code>margin</code> as arguments."}, {"owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "edited": false, "score": 1, "creation_date": 1558230234, "post_id": 56203143, "comment_id": 99030398, "body": "How about the <code>until</code> function?"}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 1, "last_activity_date": 1558218133, "creation_date": 1558218133, "answer_id": 56203283, "question_id": 56203143, "link": "https://stackoverflow.com/questions/56203143/stopping-an-iterate-loop-by-a-condition-and-returning-the-value-that-matched-the/56203283#56203283", "title": "Stopping an iterate loop by a condition and returning the value that matched the condition", "body": "<p>You want to test pairs of consecutive values generated by <code>newton</code>. That means <code>dropWhile</code> from the Prelude won't be quite enough, as it only tests individual elements. Instead, you can use something like this <a href=\"https://hackage.haskell.org/package/MissingH-1.4.2.0/docs/Data-List-Utils.html#v:dropWhileList\" rel=\"nofollow noreferrer\"><code>dropWhileList</code></a> from <em>MissingH</em>:</p>\n\n<pre><code>newton :: Double -&gt; Double\nnewton x0 = dropWhileList (not . goal) (iterate step x0) !! 1\n    where\n    step xn = xn - ((f xn)/(g xn))\n    goal (xa:xb:_) = abs (xb - xa) &lt; margin\n    goal _ = False\n</code></pre>\n\n<p><code>!! 1</code> give you the second element of the list. While it is a partial function (it fails if the list doesn't have a second element), here it is safe to use (as <code>iterate</code> generates an infinite list, you will have a result as long as the Newton's method converges).</p>\n"}, {"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1558219021, "post_id": 56203334, "comment_id": 99029188, "body": "I&#39;d say this answer is a definite improvement: if &quot;you want to test pairs of consecutive values&quot;, you are better off literally testing <i>pairs</i> of values :)"}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 4, "last_activity_date": 1558218644, "creation_date": 1558218644, "answer_id": 56203334, "question_id": 56203143, "link": "https://stackoverflow.com/questions/56203143/stopping-an-iterate-loop-by-a-condition-and-returning-the-value-that-matched-the/56203334#56203334", "title": "Stopping an iterate loop by a condition and returning the value that matched the condition", "body": "<p>A variation of duplode's answer that only uses standard functions:</p>\n\n<pre><code>newton :: Double -&gt; Double\nnewton x0 = (snd . head . dropWhile (not . goal)) (zip approxs (tail approxs)) \n    where\n    approxs = iterate step x0\n    step xn = xn - (f xn / g xn)\n    goal (xa, xb) = abs (xb - xa) &lt; margin\n</code></pre>\n\n<p>To determine whether our goal has been reached, we need to examine adjacent pairs of elements of the infinite list produced by <code>iterate</code>. To do that, we use the standard trick of zipping up the list with its own tail. (If you're feeling extra cheeky, consider using <code>(zip &lt;*&gt; tail) approxs</code> instead of <code>zip approxs (tail approxs)</code>. That way you don't have to mention <code>approxs</code> twice in the expression, which is admittedly a bit pointless.)</p>\n\n<p>This gives us an infinite list of pairs, from which we drop elements until the difference between components of a pair gets small enough. At that point we extract the head of the remaining list (a pair) and take the second component.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 0, "last_activity_date": 1558389115, "creation_date": 1558389115, "answer_id": 56228623, "question_id": 56203143, "link": "https://stackoverflow.com/questions/56203143/stopping-an-iterate-loop-by-a-condition-and-returning-the-value-that-matched-the/56228623#56228623", "title": "Stopping an iterate loop by a condition and returning the value that matched the condition", "body": "<p>Picking up <a href=\"https://stackoverflow.com/users/4892417/oisdk\">oisdk</a>'s suggestion of using <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:until\" rel=\"nofollow noreferrer\"><code>until</code></a>...</p>\n\n<pre><code>until :: (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; a -&gt; a \n</code></pre>\n\n<p>... for an implementation that doesn't literally generate a list:</p>\n\n<pre><code>newton :: Double -&gt; Double\nnewton = snd . until goal (move . snd) . move\n    where\n    step xn = xn - (f xn)/(g xn)\n    move xn = (xn, step xn) -- The cheeky spelling is (,) &lt;*&gt; step\n    goal (xa,xb) = abs (xb - xa) &lt; margin\n</code></pre>\n\n<p>It is worth it comparing this with <a href=\"https://stackoverflow.com/a/56203334/2751851\">melpomene's <code>zip</code>-based implementation</a> and noting the parallels.</p>\n"}], "owner": {"reputation": 63, "user_id": 4785998, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-z6rpF9eQm0o/AAAAAAAAAAI/AAAAAAAAADA/uUXYDZ6EESo/photo.jpg?sz=128", "display_name": "MasterGeekMX", "link": "https://stackoverflow.com/users/4785998/mastergeekmx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 56203334, "answer_count": 3, "score": 0, "last_activity_date": 1558389115, "creation_date": 1558216636, "last_edit_date": 1558221115, "question_id": 56203143, "link": "https://stackoverflow.com/questions/56203143/stopping-an-iterate-loop-by-a-condition-and-returning-the-value-that-matched-the", "title": "Stopping an iterate loop by a condition and returning the value that matched the condition", "body": "<p>I'm trying to implement the Newton-Raphson method on Haskell, and so far I have managed to get it working by using the <code>iterate</code> function, but the problem is that it retuns an infinte list due the nature of the iterate function, so I'm looking to find a way of stopping the loop when the value obtained in an iteration falls into a set margin of error, and returning said value</p>\n\n<p>I looked some blog posts and even some questions on here, but I'm fairly new to haskell and not fully versed on the syntaxis, so for me reading code exmples or documentation is really hard by now.</p>\n\n<p>Definitions of f(x) and g(x) (the derivative) are irelevant:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>newton x0 = iterate step x0\n    where step xn = xn - ((f xn)/(g xn))\n</code></pre>\n\n<p>I'm currently working by taking the first elements of the list given, using <code>take 4 $ newton 3.5</code> in the GHCi prompt, but the list returned by <code>iterate</code> is infinite, so I cannot use a tail function on it.</p>\n\n<p>My idea is to set a constant somewhere, <code>margin = 0.0001</code> or something like that, and when the last iteration of the newton function falls behind the margin, the <code>iterate</code> function stops, and I have the final result</p>\n"}, {"tags": ["haskell", "operator-precedence"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1558214189, "post_id": 56202894, "comment_id": 99028340, "body": "those are built-in syntax, not functions, so that&#39;s why <code>:i</code> doesn&#39;t work. As for the relative precedence of these &quot;operators&quot;, what actual piece of code gives rise to the question?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1558214213, "post_id": 56202894, "comment_id": 99028345, "body": "Those are not functions defined in Haskell, but language tokens. The precedence can be derived from the <a href=\"https://www.haskell.org/onlinereport/syntax-iso.html\" rel=\"nofollow noreferrer\">language grammar</a>."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1558214364, "post_id": 56202894, "comment_id": 99028370, "body": "Why do you think <code>=</code> is an operator? It doesn&#39;t behave like any operator, since it doesn&#39;t return anything. Calling it an operator is misguided."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1558214739, "post_id": 56202894, "comment_id": 99028437, "body": "<code>:i (-&gt;)</code> doesn&#39;t give me a syntax error. It tells me the precendence is <code>infixr 0</code>"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1558214960, "post_id": 56202894, "comment_id": 99028467, "body": "@4castle <code>(-&gt;)</code> is an operator in some sense, e.g. <code>(-&gt;) a</code> is a functor. However, it is type-level, and thus isn&#39;t like other &#39;operators&#39;"}, {"owner": {"reputation": 1253, "user_id": 1953032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/020d3fd48193f1d22e5316296dad15ce?s=128&d=identicon&r=PG", "display_name": "egst", "link": "https://stackoverflow.com/users/1953032/egst"}, "edited": false, "score": 0, "creation_date": 1558217458, "post_id": 56202894, "comment_id": 99028916, "body": "I never said, that these are operators. I just want to be sure when to use parentheses when dealing with these tokens (thanks for mentioning this term, I didn&#39;t know what to call these) and other actual operators. Like for example in <code>function (head:tail)</code> the ` ` has some kind of &quot;precedence&quot; that is lower that that of <code>:</code>."}, {"owner": {"reputation": 1253, "user_id": 1953032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/020d3fd48193f1d22e5316296dad15ce?s=128&d=identicon&r=PG", "display_name": "egst", "link": "https://stackoverflow.com/users/1953032/egst"}, "edited": false, "score": 0, "creation_date": 1558218507, "post_id": 56202894, "comment_id": 99029106, "body": "(Edit: I meant &quot;higher precedence&quot;.)"}], "answers": [{"comments": [{"owner": {"reputation": 1253, "user_id": 1953032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/020d3fd48193f1d22e5316296dad15ce?s=128&d=identicon&r=PG", "display_name": "egst", "link": "https://stackoverflow.com/users/1953032/egst"}, "edited": false, "score": 0, "creation_date": 1558218689, "post_id": 56203284, "comment_id": 99029136, "body": "The question about <code>=</code> was based on my mistaken understanding of it, but for the other two this explanation is exactly what I needed."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1558218789, "post_id": 56203284, "comment_id": 99029152, "body": "A footnote on <code>(-&gt;)</code>: in spite of what GHCi says, its precedence is <code>-1</code> rather than <code>0</code>, as discussed in <a href=\"https://gitlab.haskell.org/ghc/ghc/issues/15235\" rel=\"nofollow noreferrer\">GHC issue #15235</a> (that is set to be fixed in GHC 8.8.1)."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1558225368, "post_id": 56203284, "comment_id": 99029876, "body": "@duplode That&#39;s very helpful, and in fact justifies my characterisation of <code>-&gt;</code> as having &#39;infinitely low&#39; precedence. Thank you!"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 2, "creation_date": 1558388424, "post_id": 56203284, "comment_id": 99077172, "body": "Also worth noting that record update <code>x { y = z }</code> &amp; construction <code>X { y = z }</code> have higher precedence than function application, so you can do e.g. <code>pure SomeRecord { srValue = 42 }</code> rather than <code>pure $ SomeRecord \u2026</code>"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1558398457, "post_id": 56203284, "comment_id": 99079153, "body": "@JonPurdy I believe that&#39;s <i>lower</i> precedence, not higher."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1558470882, "post_id": 56203284, "comment_id": 99110394, "body": "@AJFarmar: No\u2014<code>pure X { y = z }</code> is parsed as <code>pure (X { y = z })</code>, not <code>(pure X) { y = z }</code>"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1558475580, "post_id": 56203284, "comment_id": 99112109, "body": "@JonPurdy Sorry, my mistake\u2014you&#39;re right, it&#39;s higher."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 9, "last_activity_date": 1558225501, "last_edit_date": 1558225501, "creation_date": 1558218136, "answer_id": 56203284, "question_id": 56202894, "link": "https://stackoverflow.com/questions/56202894/what-is-the-precedence-of-and-in-haskell/56203284#56203284", "title": "What is the precedence of `-&gt;`, `=` and ` ` in Haskell?", "body": "<ul>\n<li><code>-&gt;</code> is a type-level operator (<code>(-&gt;) :: * -&gt; * -&gt; *</code>), and as mentioned in comments, <code>:i (-&gt;)</code> reveals that it is <code>infixr 0</code>*.</li>\n<li>Function application could be seen as having 'infinitely high' left precedence, that is to say if <code>%</code> is any operator, then <code>f x % y</code> will always be read as <code>(f x) % y</code> no matter what precedence <code>%</code> has, and <code>f x y z</code> is always read as <code>((f x) y) z</code>.** This isn't documented as having a precedence, because it isn't an operator, and 'infinite' precedence can't be declared in Haskell.</li>\n<li><code>=</code> cannot be seen as having precendence, as it is always <em>declaration</em> rather than an <em>expression</em>, so putting parentheses around it is absurd. It is not an operator, hence cannot have precedence.</li>\n</ul>\n\n<hr>\n\n<p><em>* As pointed out in a below comment, this actually behaves as if it has precedence <code>infixr -1</code>, but this is not permitted in ordinary operators \u2014 this is syntactic rather than semantic.</em></p>\n\n<p><em>** Note that this is the 'opposite' of <code>-&gt;</code>, which could be seen as having 'infinitely low', right precedence. Can you see why this is natural?</em></p>\n"}], "owner": {"reputation": 1253, "user_id": 1953032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/020d3fd48193f1d22e5316296dad15ce?s=128&d=identicon&r=PG", "display_name": "egst", "link": "https://stackoverflow.com/users/1953032/egst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 56203284, "answer_count": 1, "score": 5, "last_activity_date": 1558225501, "creation_date": 1558213971, "last_edit_date": 1558221206, "question_id": 56202894, "link": "https://stackoverflow.com/questions/56202894/what-is-the-precedence-of-and-in-haskell", "title": "What is the precedence of `-&gt;`, `=` and ` ` in Haskell?", "body": "<p>I'm trying to figure out some default operator precedences in Haskell, but I was unable to find some good documentation on <code>-&gt;</code>, <code>=</code> and <code></code> (as in <code>f x</code>). So I tried <code>:i (-&gt;)</code> and <code>:i (=)</code> in GHCI to get some info, but it gives me a syntax error.</p>\n\n<p>Apparently these \"tokens\" are just a built-in part of the syntax, so no wonder, that <code>:i</code> doesn't work.</p>\n\n<p>I'm new to Haskell, so I wasn't aware of the fact, that <code>=</code> doesn't return any value, I just mistakingly assumed, that it behaves as its equivalents in imperative languages, which is wrong of course.</p>\n\n<p><code>-&gt;</code> and <code></code>,  on the other hand, behave as operators. They return a type/value and are right/left associative respectively. And they have some sort of perecedence when used along with actual operators.</p>\n"}, {"tags": ["haskell", "recursion", "binary-search-tree"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1558200439, "post_id": 56201300, "comment_id": 99025382, "body": "What is not working with your attempt?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1558201171, "post_id": 56201300, "comment_id": 99025567, "body": "You haven&#39;t actually asked a question, which leads me to believe that the implicit question is &quot;write my code for me.&quot; Please edit your question to show an attempt and/or a specific question. In the meantime, <a href=\"http://idownvotedbecau.se/noattempt/\" rel=\"nofollow noreferrer\">idownvotedbecau.se/noattempt</a>"}, {"owner": {"reputation": 31, "user_id": 11521180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cb518dea83235a0a4891e588b591f71?s=128&d=identicon&r=PG&f=1", "display_name": "JVFeijo", "link": "https://stackoverflow.com/users/11521180/jvfeijo"}, "edited": false, "score": 0, "creation_date": 1558201330, "post_id": 56201300, "comment_id": 99025603, "body": "I thought of asking from left to right if the number I&#39;m trying to insert is lesser than the integer inside the leaf but it keeps inserting afterwards when there are other numbers greater than it."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1558201827, "post_id": 56201300, "comment_id": 99025720, "body": "@JVFeijo Please <a href=\"https://stackoverflow.com/posts/56201300/edit\">edit your question</a> to include <b>specific code</b> with a <b>specific problem</b>. A comment with a vague idea is insufficient."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1558203444, "post_id": 56201300, "comment_id": 99026162, "body": "You can&#39;t build a binary search tree with that definition; it&#39;s just an inefficient encoding of a list, because there&#39;s no basis for deciding which branch to follow from any particular interior node."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1558203545, "post_id": 56201300, "comment_id": 99026189, "body": "A binary search tree is a tree that has the property that each node contains a unique value, and all values in the left (right) subtree of a given node <code>X</code> are smaller (greater) than the value at <code>X</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558203623, "post_id": 56201300, "comment_id": 99026201, "body": "A binary search tree typically has <i>inodes</i>: it contains elements in the nodes that are not leafs as well, so a better definition is <code>data Tree = Leaf Int | Branch Tree Int Tree</code>, otherwise you can only insert/search/... in <i>O(log^2 n)</i>, and it would make the algorithm <i>very complex</i>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558211579, "post_id": 56201300, "comment_id": 99027833, "body": "@WillemVanOnsem Where did you come up with log^2(n)? The obvious search algorithm I can think of for the type defined in the question is O(n), searching every leaf in order. This is especially clear for a degenerate tree, where every left branch is a Leaf, making the tree effectively a linked list."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1558211780, "post_id": 56201300, "comment_id": 99027872, "body": "@amalloy: you can move down the tree, for example taking the rightmost node of the left subtree to find the largest value of the right subtree, if the tree is balanced (we can balance the tree), then we can detect that in <i>O(log n)</i>, based on that value, we search the left or right subtree, and each step we again perform the same action to detect the &quot;spit value&quot;."}, {"owner": {"reputation": 31, "user_id": 11521180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cb518dea83235a0a4891e588b591f71?s=128&d=identicon&r=PG&f=1", "display_name": "JVFeijo", "link": "https://stackoverflow.com/users/11521180/jvfeijo"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558297299, "post_id": 56201300, "comment_id": 99044540, "body": "@Willem Van Onsem, I&#39;ve done as you suggested. What do you think?"}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1560708433, "post_id": 56201300, "comment_id": 99815674, "body": "I was looking at your most recent question, but then found it deleted. If you still want someone to look into it, please let me know."}, {"owner": {"reputation": 31, "user_id": 11521180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cb518dea83235a0a4891e588b591f71?s=128&d=identicon&r=PG&f=1", "display_name": "JVFeijo", "link": "https://stackoverflow.com/users/11521180/jvfeijo"}, "reply_to_user": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1560712629, "post_id": 56201300, "comment_id": 99816689, "body": "@trincot: Where can we talk? Do I have to make another question?"}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1560712823, "post_id": 56201300, "comment_id": 99816726, "body": "You could <a href=\"https://stackoverflow.com/questions/56615112/depth-first-search-javascript-heap-out-of-memory\">go back to it</a> and undelete it (I think). Note that I would then still need some time to prepare my answer. I just don&#39;t want to waste time on it, if it is not there anymore ;-)"}, {"owner": {"reputation": 31, "user_id": 11521180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cb518dea83235a0a4891e588b591f71?s=128&d=identicon&r=PG&f=1", "display_name": "JVFeijo", "link": "https://stackoverflow.com/users/11521180/jvfeijo"}, "reply_to_user": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 1, "creation_date": 1560714141, "post_id": 56201300, "comment_id": 99817052, "body": "@trincot: I think I&#39;ve found the problem already. If something else happens I&#39;ll undelete the question for sure. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11521180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cb518dea83235a0a4891e588b591f71?s=128&d=identicon&r=PG&f=1", "display_name": "JVFeijo", "link": "https://stackoverflow.com/users/11521180/jvfeijo"}, "edited": false, "score": 2, "creation_date": 1558202261, "post_id": 56201390, "comment_id": 99025823, "body": "I have edited my question. I have searched a bit but the leaf storing the value thing is what made it difficult to find anything related. It&#39;s not even a homework is just practice exercise. I got stuck and I cant seem to understand what is the thought process for solving this problem."}, {"owner": {"reputation": 343, "user_id": 5085294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TOFvi.png?s=128&g=1", "display_name": "Christof Schramm", "link": "https://stackoverflow.com/users/5085294/christof-schramm"}, "reply_to_user": {"reputation": 31, "user_id": 11521180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cb518dea83235a0a4891e588b591f71?s=128&d=identicon&r=PG&f=1", "display_name": "JVFeijo", "link": "https://stackoverflow.com/users/11521180/jvfeijo"}, "edited": false, "score": 0, "creation_date": 1558206537, "post_id": 56201390, "comment_id": 99026779, "body": "Is your tree data type definition given in your question? If not you might have an easier time if you don&#39;t only store your values in the leaves of the tree but also in the internal node. Something like <code>data Tree = Node Int Tree Tree | Leaf </code>. @chepners comments on the question are very much relevant here as well."}, {"owner": {"reputation": 31, "user_id": 11521180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cb518dea83235a0a4891e588b591f71?s=128&d=identicon&r=PG&f=1", "display_name": "JVFeijo", "link": "https://stackoverflow.com/users/11521180/jvfeijo"}, "edited": false, "score": 0, "creation_date": 1558291414, "post_id": 56201390, "comment_id": 99043026, "body": "Yes, it is. The exercise before that was with your tree definition and I&#39;ve managed to finish. My problem began when it was required to store the value only in the leaf."}], "tags": [], "owner": {"reputation": 343, "user_id": 5085294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TOFvi.png?s=128&g=1", "display_name": "Christof Schramm", "link": "https://stackoverflow.com/users/5085294/christof-schramm"}, "is_accepted": false, "score": 3, "last_activity_date": 1558344018, "last_edit_date": 1558344018, "creation_date": 1558201301, "answer_id": 56201390, "question_id": 56201300, "link": "https://stackoverflow.com/questions/56201300/insertion-in-a-binary-search-treedata-stored-at-leaf-node-only/56201390#56201390", "title": "Insertion in a binary search tree(data stored at leaf node only)", "body": "<p>The technique you require to solve this problem is called <a href=\"https://en.m.wikipedia.org/wiki/Pattern_matching\" rel=\"nofollow noreferrer\">pattern matching</a> combined with conditional branching (if / pattern guards).</p>\n\n<p>You can do this either by using a <code>case</code> statement or by defining alternative function definitions with something like this:</p>\n\n<pre><code>maybeAddOne :: Maybe Int -&gt; Maybe Int\nmaybeAddOne Nothing = Nothing\nmaybeAddOne (Just a) \n  | a &lt; 5 = Just (a + 1)\n  | otherwise = Just a\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 11521180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cb518dea83235a0a4891e588b591f71?s=128&d=identicon&r=PG&f=1", "display_name": "JVFeijo", "link": "https://stackoverflow.com/users/11521180/jvfeijo"}, "edited": false, "score": 0, "creation_date": 1558291225, "post_id": 56202205, "comment_id": 99042979, "body": "First of all, thank you for your time. I agree that your tree definition would be better but it&#39;s part of the exercise the value be stored only in the leaf. Actually, the exercise before that is with the value stored in the node."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1558207744, "creation_date": 1558207744, "answer_id": 56202205, "question_id": 56201300, "link": "https://stackoverflow.com/questions/56201300/insertion-in-a-binary-search-treedata-stored-at-leaf-node-only/56202205#56202205", "title": "Insertion in a binary search tree(data stored at leaf node only)", "body": "<p>Given your current type, you have no basis for deciding which subtree to insert the new value into; you don't have any values to compare to until you reach a leaf.</p>\n\n<p>Start with a proper search tree:</p>\n\n<pre><code>data BST = Node Int BST BST | Empty\n</code></pre>\n\n<p>Each node contains a single value, and your <code>insert</code> function must maintain the search property, which states that for a given node <code>Node x left right</code>, all values in <code>left</code> are less than <code>x</code>, and all values in <code>right</code> are greater than <code>x</code>. (If you try to insert <code>x</code> when it is already present, you don't need to do anything: keys are unique.)</p>\n\n<pre><code>insert :: BST -&gt; Int -&gt; BST\ninsert Empty x = Node x Empty Empty  -- replace the empty tree with a single leaf\ninsert t@(Node y left right) | x == y = t  -- do nothing\n                             | x &lt; y = ...\n                             | otherwise = ...\n</code></pre>\n\n<p>I leave it as an exercise to determine what to do in the cases where <code>x /= y</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 11521180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cb518dea83235a0a4891e588b591f71?s=128&d=identicon&r=PG&f=1", "display_name": "JVFeijo", "link": "https://stackoverflow.com/users/11521180/jvfeijo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1558344018, "creation_date": 1558200406, "last_edit_date": 1558297193, "question_id": 56201300, "link": "https://stackoverflow.com/questions/56201300/insertion-in-a-binary-search-treedata-stored-at-leaf-node-only", "title": "Insertion in a binary search tree(data stored at leaf node only)", "body": "<p>I'm using Haskell for this class I'm in and I have to make an insertion of in a binary search tree with recursion. Here is my tree definition:</p>\n\n<blockquote>\n  <p>data Tree = Leaf Int | Branch Tree Tree</p>\n</blockquote>\n\n<p>An example would be:</p>\n\n<blockquote>\n  <p>tree1 = Branch ((Branch (Leaf 2) (Leaf 4)) (Branch (Leaf 6) (Leaf 10)))</p>\n</blockquote>\n\n<p>My insert function should get a Tree and an Int and return a Tree:</p>\n\n<blockquote>\n  <p>insert :: Tree -> Int -> Tree</p>\n</blockquote>\n\n<p>I just cant understand how to go about this problem.</p>\n\n<p>edit:\nI know pattern matching. Here is what i thought.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>insert :: Tree -&gt; Int -&gt; Tree\ninsert (Leaf i) j = if (i &gt; j) than Branch (Leaf j) (Leaf i)\n                    else Leaf i\ninsert (Branch l r) j = Branch (insert l j) (insert r j)\n</code></pre>\n\n<p>I know this is wrong. It gets the value inserted more than once if there are two or more numbers greater than j.</p>\n\n<p>edit2:\nSo I followed @Willem Van Onsem suggestion and got this:</p>\n\n<pre><code>infimum :: Tree -&gt; Int\n\ninfimum (Leaf i) = i;\ninfimum (Branch l r) = infimum r\n\ninsert :: Tree -&gt; Int -&gt; Tree\ninsert (Leaf i) j = if (j &gt; i) then Branch (Leaf i) (Leaf j)\n                    else Branch (Leaf j) (Leaf i)\ninsert (Branch l r) j = if (j &gt; (infimum l)) then Branch l (insert r j)\n                        else Branch (insert l j) r\n</code></pre>\n\n<p>It works. I guess it cant be done with one function only.</p>\n"}, {"tags": ["haskell", "category-theory", "monoids"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1558195133, "post_id": 56200485, "comment_id": 99024140, "body": "Do you understand what monoid is from a set theory perspective? Definitions just <i>are</i> -- there&#39;s little answer that can be given to &quot;why is the definition that way&quot; other than &quot;because we observe there are a bunch of things we want to talk about uniformly that are that way&quot;. So I can&#39;t really imagine answering that question sensibly. But I could imagine plausibly answering &quot;How does this definition correspond with the various parts of the set theory definition?&quot;."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1558195365, "post_id": 56200485, "comment_id": 99024186, "body": "Okay. Since your (now deleted) comment says you grok the set theory definition, when I get back from lunch if there&#39;s no answer yet I&#39;ll write up a description of how the parts of the two definitions correspond; and the connection to the category with one object that&#39;s induced by the definition."}, {"owner": {"reputation": 3310, "user_id": 8362765, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1882004112073375/picture?type=large", "display_name": "Bogdan Vakulenko", "link": "https://stackoverflow.com/users/8362765/bogdan-vakulenko"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1558196741, "post_id": 56200485, "comment_id": 99024493, "body": "@daniel-wanger Yes, I understand what monoid is from set theory (at least the main idea). I even have some &quot;non-stable&quot; understanding of what it is in category theory. The main problem for me now (at least I think it&#39;s the main one)) is that I don&#39;t understand how to read notations. Is there kind of rule that say that on the left side (domain) there can be object only?. Because definition like this <code>I -&gt; M</code> looks very strange for me. Like it&#39;s morphism from object <code>I</code> (which is not object) to <code>M</code>. Or <code>M \u2297 M</code> is kind of domain. But I would really appreciated for any answer."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 8, "creation_date": 1558197191, "post_id": 56200485, "comment_id": 99024590, "body": "Warning! There are different but related notions at work! A category with one object corresponds to the traditional notion of a monoid (e.g., the ways you can get from where you are to where you are by hopping on the spot). The notion of <i>monoidal category</i> is something else: they can have much more interesting collections of objects in which (X) and I induce monoid-like structure (the way (,) on Haskell types is associative and absorbs () up to isomorphism)."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1558202215, "post_id": 56200485, "comment_id": 99025811, "body": "The words &quot;<i>monoidal</i> category&quot; are essential, and it&#39;s where these operators you are asking about come from. You seem to be ignoring them."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1558202390, "post_id": 56200485, "comment_id": 99025856, "body": "@BogdanVakulenko Yes, <code>I -&gt; M</code> is a morphism from object <code>I</code>. Why do you say <code>I</code> is not an object? Yes, <code>M \u2297 M</code> is a kind of domain. These notations are introduced by the &quot;a monoidal category (C, \u2297, I)&quot; part of the definition you quoted."}, {"owner": {"reputation": 3310, "user_id": 8362765, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1882004112073375/picture?type=large", "display_name": "Bogdan Vakulenko", "link": "https://stackoverflow.com/users/8362765/bogdan-vakulenko"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1558202425, "post_id": 56200485, "comment_id": 99025862, "body": "@luqui It seems that I was. But now it seem to be getting clearer."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 20, "last_activity_date": 1558201229, "last_edit_date": 1558201229, "creation_date": 1558196684, "answer_id": 56200814, "question_id": 56200485, "link": "https://stackoverflow.com/questions/56200485/dont-understand-notation-of-morphisms-in-monoid-definition/56200814#56200814", "title": "Don&#39;t understand notation of morphisms in Monoid definition", "body": "<blockquote>\n  <p>Is <code>M \u2297 M</code> some how related to cartesian product, so domain of the morphism is defined as <code>M x M</code> ?</p>\n</blockquote>\n\n<p>Exactly. More specifically, we get those monoids that are expressed by the <code>Monoid</code> class from <em>base</em> by picking <strong>Hask</strong> (the category with all Haskell types as objects and all Haskell functions as morphisms) as <em>C</em>, <code>(,)</code> (the pair type constructor) as <em>\u2297</em>, and <code>()</code> (the unit type) as <em>I</em>. The signatures of <em>\u03bc</em> and <em>\u03b7</em>, translated to Haskell, then become:</p>\n\n<pre><code>\u03bc :: (M, M) -&gt; M\n\u03b7 :: () -&gt; M\n</code></pre>\n\n<p>By currying <em>\u03bc</em>, and making use of how <code>() -&gt; M</code> functions are in one-to-one correspondence to <code>M</code> values (all of them look like <code>\\() -&gt; m</code> for some <code>m</code>), we get the familiar <code>Monoid</code> methods:</p>\n\n<pre><code>mappend :: M -&gt; M -&gt; M\nmempty :: M\n</code></pre>\n\n<p>Note that the categorical definition is far more general than just <code>Monoid</code>. For instance, we might keep working in <strong>Hask</strong> while replacing <code>(,)</code> and <code>()</code> with their duals, <code>Either</code> and <code>Void</code>, thus getting:</p>\n\n<pre><code>\u03bc :: Either A A -&gt; A\n\u03b7 :: Void -&gt; A\n</code></pre>\n\n<p>Every Haskell type is a monoid <em>in this particular manner</em> (<em>\u03bc</em> is <code>either id id</code>, and <em>\u03b7</em> is <a href=\"http://hackage.haskell.org/package/base/docs/Data-Void.html#v:absurd\" rel=\"noreferrer\"><code>absurd</code></a>).</p>\n\n<hr>\n\n<p>Another example is taking <em>C</em> to be the category of Haskell <code>Functor</code>s (with natural transformations between them -- which I will write as <code>type f ~&gt; g = forall a. f a -&gt; g a</code> -- as morphisms), <a href=\"http://hackage.haskell.org/package/base/docs/Data-Functor-Compose.html\" rel=\"noreferrer\"><code>Compose</code></a> as <em>\u2297</em>, and <a href=\"http://hackage.haskell.org/package/base/docs/Data-Functor-Identity.html\" rel=\"noreferrer\"><code>Identity</code></a> as <em>I</em>:</p>\n\n<pre><code>-- Note the arrows here are ~&gt;, and not -&gt;\n\u03bc :: Compose M M ~&gt; M\n\u03b7 :: Identity ~&gt; M\n</code></pre>\n\n<p>These two are commonly written as:</p>\n\n<pre><code>-- \"Inlining\" the definitions of Compose, Identity, and ~&gt;\njoin :: M (M a) -&gt; M a\nreturn :: a -&gt; M a\n</code></pre>\n\n<p>In other words, a <code>Monad</code> is a monoid in the category of <code>Functor</code>s (which is the <strong>Hask</strong>-specific version of \"a monad is a monoid in the category of endofucntors\"). It is worth mentioning that, as in the other example, this is not the only way to get monoids out of that category (see the final paragraph of <a href=\"https://stackoverflow.com/a/35047673/2751851\">this answer</a> for pointers -- the rest of it, in fact, might be relevant reading, as it discusses the notion of monoidal category).</p>\n"}], "owner": {"reputation": 3310, "user_id": 8362765, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1882004112073375/picture?type=large", "display_name": "Bogdan Vakulenko", "link": "https://stackoverflow.com/users/8362765/bogdan-vakulenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 3, "accepted_answer_id": 56200814, "answer_count": 1, "score": 11, "last_activity_date": 1558212005, "creation_date": 1558194103, "last_edit_date": 1592644375, "question_id": 56200485, "link": "https://stackoverflow.com/questions/56200485/dont-understand-notation-of-morphisms-in-monoid-definition", "title": "Don&#39;t understand notation of morphisms in Monoid definition", "body": "<p>I'm trying to understand what <code>Monoid</code> is from a category theory perspective, but I'm a bit confused with the notation used to describe it. Here is Wikipedia:</p>\n<blockquote>\n<p>In category theory, a monoid (or monoid object) (M, \u03bc, \u03b7) in a monoidal category (C, \u2297, I) is an object M together with two morphisms</p>\n<p>\u03bc: M \u2297 M \u2192 M called multiplication,</p>\n<p>\u03b7: I \u2192 M called unit</p>\n</blockquote>\n<p>My confusion is about the morphism notation. Why is the binary operation <code>\u2297</code> a part of the morphism notation? My understanding of a morphism is that it's a kind of function that can map from one type to another (domain to codomain), like <code>M \u2192 M</code>. Why is the operation <code>\u2297</code> a part of the domain in the definition? The second confusion is about <code>I</code>. Why is <code>I</code> a domain? There is no <code>I</code> object in a <code>Monoid</code> at all. It's just a neutral element of the object <code>M</code>.</p>\n<p>I understand that <code>Monoid</code> is a category with one object, an identity morphism, and a binary operation defined on this object, but the notation makes me think that I don't understand something.</p>\n<p>Is <code>M \u2297 M</code> somehow related to the cartesian product, so that the domain of the morphism is defined as <code>M x M</code>?</p>\n<p><strong>Edit:</strong> I got a really helpful answer for my question on the <a href=\"https://math.stackexchange.com/questions/3230740/what-are-the-domains-of-the-multiplication-and-unit-morphisms-of-a-monoid-object\">Mathematics Stack Exchange</a>.</p>\n"}, {"tags": ["haskell", "x11", "window-managers", "xmonad"], "comments": [{"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 1, "creation_date": 1558183150, "post_id": 56197066, "comment_id": 99021181, "body": "It seems <code>spawnOn</code> is exactly what you need. I would just investigate why that isn&#39;t working. Possibly ask another question and provide a MVCE (<a href=\"https://stackoverflow.com/help/reprex\">stackoverflow.com/help/reprex</a>)?"}, {"owner": {"reputation": 269, "user_id": 11810350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2aecb38e76cafa74638c87e7c2402c6?s=128&d=identicon&r=PG", "display_name": "user138278", "link": "https://stackoverflow.com/users/11810350/user138278"}, "edited": false, "score": 0, "creation_date": 1571528046, "post_id": 56197066, "comment_id": 103271999, "body": "can you post your code?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12320244, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P2Qki.png?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/12320244/pierre"}, "is_accepted": false, "score": 1, "last_activity_date": 1584223066, "creation_date": 1584223066, "answer_id": 60687669, "question_id": 56197066, "link": "https://stackoverflow.com/questions/56197066/how-to-start-up-xmonad-with-apps-on-other-workspaces/60687669#60687669", "title": "How to start up xmonad with apps on other workspaces", "body": "<p>Install wmctrl</p>\n\n<pre><code>sudo apt install wmctrl\n</code></pre>\n\n<p>And create a script (in this example thunderbird on the second workspace (<code>-t 1</code>)):</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>#!/bin/sh\n\n (thunderbird &amp;)  &amp; sleep 5 &amp;&amp; \nsh -c \"wmctrl -i -r `wmctrl -l | grep Thunderbird` -t 1\"\n</code></pre>\n\n<p>To know your application name on wmctrl you can view it by taping on your terminal :</p>\n\n<pre><code>wmctrl -l\n</code></pre>\n\n<p>And replace it with the correct name in the script.</p>\n\n<p>Be carrefull with the capital letter (\"Thunderbird\" not \"thunderbird\") !!</p>\n\n<p>Other example with firefox on the 3d workspace (<code>-t 2</code>):</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>#!/bin/sh\n(firefox &amp;)  &amp; sleep 5 &amp;&amp; \nsh -c \"wmctrl -i -r `wmctrl -l | grep Firefox` -t 2\"\n</code></pre>\n\n<h1>Bonus :</h1>\n\n<p>Here is the command to execute at start-up :</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>sh -c \"thunderbird  &amp; sleep 5 &amp;&amp; wmctrl -i -r `wmctrl -l | grep Thunderbird` -t 1\"\n</code></pre>\n\n<p>Work on Debain 10 with Cinnamon. But should work for all</p>\n"}], "owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1584223066, "creation_date": 1558166268, "last_edit_date": 1558178271, "question_id": 56197066, "link": "https://stackoverflow.com/questions/56197066/how-to-start-up-xmonad-with-apps-on-other-workspaces", "title": "How to start up xmonad with apps on other workspaces", "body": "<p>I'm trying to write an xmonad.hs which, at startup, launches some apps on some workspaces.  Several of these apps (e.g., <code>atop</code>) will run within a terminal (<code>urxvt</code> being my preference).</p>\n\n<p>This has been asked a few times before, e.g, <a href=\"https://stackoverflow.com/questions/10976044/xmonad-spawn-programs-on-startup-in-specified-workspace\">here</a>, <a href=\"https://superuser.com/questions/478498/start-applications-on-specific-workspaces-in-xmonad\">here</a>, and is obliquely touched on on the <a href=\"https://wiki.haskell.org/Xmonad/General_xmonad.hs_config_tips#Making_window_float_by_default.2C_or_send_it_to_specific_workspace\" rel=\"nofollow noreferrer\">XMonad FAQ</a>.</p>\n\n<p>However, these rely on:</p>\n\n<ol>\n<li><p>using <code>spawnOn</code> from <a href=\"https://hackage.haskell.org/package/xmonad-contrib-0.15/docs/XMonad-Actions-SpawnOn.html\" rel=\"nofollow noreferrer\"><code>XMonad.Actions.SpawnOn</code></a>, which flat doesn't work (testing with <code>urxvt</code>, and also <code>xclock</code> as a simple example); it gets sent to the current workspace.</p></li>\n<li><p>using <code>spawn prog &gt;&gt; windows $ greedyView &lt;workspace&gt;</code>, which kinda works, but has major timing issues - e.g., if you run two in succession, with different workspaces, both progs end up on the latter workspace.  FWIW, I experimented with using threaddelay to assist; it didn't make any discernable difference, even with a 10s delay between spawns (I remembered that threadDelay is in microseconds, and so used 10000000).</p></li>\n<li><p>rely on using general hooks for programs - meaning that <em>whenever</em> I start them up, they'll get sent to the given workspace.  That's not what I want; I just want them placed there at startup.</p></li>\n</ol>\n\n<p>Relatedly, it surprises me that the API doesn't let me start up an app and then give me a reference to that app/window (potentially with a timeout); so that I can confidently send <strong>that app/window</strong> to a workspace.</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 463, "user_id": 3203476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7935bf89df5baff4e39ea43be4ce4e?s=128&d=identicon&r=PG&f=1", "display_name": "user3203476", "link": "https://stackoverflow.com/users/3203476/user3203476"}, "edited": false, "score": 0, "creation_date": 1558164575, "post_id": 56196489, "comment_id": 99017435, "body": "thank you, so just to confirm: the , is not the same as the one for tuples ? <a href=\"https://hackage.haskell.org/package/ghc-prim-0.5.3/docs/GHC-Tuple.html#t:-40--44--44--41-\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/ghc-prim-0.5.3/docs/&hellip;</a>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 8, "creation_date": 1558164900, "post_id": 56196489, "comment_id": 99017500, "body": "It is the same character (the comma <code>,</code>) but no, it is not part of the same construct.  Curiously, you can think of them as the same <i>concept</i> - a tuple and a record with multiple fields are just two different <a href=\"https://en.wikipedia.org/wiki/Product_type\" rel=\"nofollow noreferrer\">product types</a>.  The tuple, <code>(,)</code> is a data constructor that lacks field names and has special syntax by virtue of being built into the language.  <code>Person</code> is a data constructor with explicit field name but otherwise isomorphic (of identical utility) to tuple type <code>(Int, String)</code>."}], "tags": [], "owner": {"reputation": 4614, "user_id": 1378868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a42920594ee2a0cc33012c407fd9d5?s=128&d=identicon&r=PG", "display_name": "snak", "link": "https://stackoverflow.com/users/1378868/snak"}, "is_accepted": true, "score": 10, "last_activity_date": 1558160322, "creation_date": 1558160322, "answer_id": 56196489, "question_id": 56196355, "link": "https://stackoverflow.com/questions/56196355/haskell-what-is-the-definition-for-and/56196489#56196489", "title": "Haskell: What is the definition for &#39;{&#39; &#39;}&#39; and &#39;,&#39;?", "body": "<p>No. These are not functions, but part of a datatype declaration using the record syntax. See <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-700004.2.1\" rel=\"noreferrer\">4.2 User-Defined Datatypes</a> in Haskell Report for details.</p>\n"}], "owner": {"reputation": 463, "user_id": 3203476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7935bf89df5baff4e39ea43be4ce4e?s=128&d=identicon&r=PG&f=1", "display_name": "user3203476", "link": "https://stackoverflow.com/users/3203476/user3203476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 56196489, "answer_count": 1, "score": 1, "last_activity_date": 1558160322, "creation_date": 1558158625, "question_id": 56196355, "link": "https://stackoverflow.com/questions/56196355/haskell-what-is-the-definition-for-and", "title": "Haskell: What is the definition for &#39;{&#39; &#39;}&#39; and &#39;,&#39;?", "body": "<p>I was trying lo look up the definition for <code>{</code> and <code>}</code> and <code>,</code> as used in the following for example, but I could not find them. Are these functions ?</p>\n\n<pre><code>data Person = Person { \n  pID :: Int, \n  pName :: String \n} deriving (Show)\n</code></pre>\n"}, {"tags": ["haskell", "exponent"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1558134437, "post_id": 56194525, "comment_id": 99013502, "body": "Nope, no idea. Perhaps you should include the exact error -- and for that matter, the complete code that causes it, since this code on its own doesn&#39;t."}, {"owner": {"reputation": 11, "user_id": 11518452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IJEAoWRS3ic/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdAONWinaGxGptZ_Y8w1OXj-bewnA/mo/photo.jpg?sz=128", "display_name": "user11518452", "link": "https://stackoverflow.com/users/11518452/user11518452"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1558134859, "post_id": 56194525, "comment_id": 99013567, "body": "@DanielWagner Ok I edited the post to give a more precise error."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1558143003, "post_id": 56194525, "comment_id": 99014717, "body": "This is basically the same algorithm the base library uses to implement <code>(^)</code>, so you might want to look at <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Real.html#%5E\" rel=\"nofollow noreferrer\">its source code</a>."}], "answers": [{"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1558135433, "post_id": 56194675, "comment_id": 99013659, "body": "This could also be fixed by writing <code>let a = (pow b q) in a*a</code> instead of <code>pow (pow b q) 2</code>, which recurses too much."}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 2, "last_activity_date": 1558135266, "creation_date": 1558135266, "answer_id": 56194675, "question_id": 56194525, "link": "https://stackoverflow.com/questions/56194525/algorithm-to-calculate-exponent-using-recursion-and-mod/56194675#56194675", "title": "Algorithm to calculate exponent using recursion and mod", "body": "<p>You also need to provide a base case for when <code>e</code> is <code>2</code>:</p>\n\n<pre><code>pow b 2 = b * b\n</code></pre>\n\n<p>Without this, your recursion doesn't end, because it becomes <code>pow (pow b 1) 2</code> and you don't get anywhere.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1558135428, "creation_date": 1558135428, "answer_id": 56194692, "question_id": 56194525, "link": "https://stackoverflow.com/questions/56194525/algorithm-to-calculate-exponent-using-recursion-and-mod/56194692#56194692", "title": "Algorithm to calculate exponent using recursion and mod", "body": "<p>If you try evaluating <code>pow b 2</code> by hand you'll quickly see why. Since <code>divMod 2 2 = (1, 0)</code>, we expand from <code>pow b 2</code> to <code>pow (pow b 1) 2</code>. Note that this is <em>also</em> of the form <code>pow b' 2</code>, with <code>b' = pow b 1</code>. So we just get an infinite chain:</p>\n\n<pre><code>pow b 2\n=\npow (pow b 1) 2\n=\npow (pow (pow b 1) 1) 2\n=\npow (pow (pow (pow b 1) 1) 1) 2\n=\n...\n</code></pre>\n\n<p>There's a couple ways to solve it. You could add a base case for <code>e == 2</code>, or instead of recursively calling <code>pow</code> twice you could just do the multiplication yourself (as in replacing <code>pow foo 2</code> with <code>foo * foo</code> in your existing code).</p>\n"}, {"tags": [], "owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "is_accepted": false, "score": 1, "last_activity_date": 1558286723, "last_edit_date": 1558286723, "creation_date": 1558286307, "answer_id": 56210235, "question_id": 56194525, "link": "https://stackoverflow.com/questions/56194525/algorithm-to-calculate-exponent-using-recursion-and-mod/56210235#56210235", "title": "Algorithm to calculate exponent using recursion and mod", "body": "<p>As mentioned in the previous answers, your code <em>almost</em> works, and it is just a matter of allowing the recursion to stop.</p>\n\n<p>See the code below for a possible fix. The argument of the recursive call is at most half the current argument, hence the recursion will have to stop.</p>\n\n<p>On a side note, this algorithm is more than 2,000 years old, and originated in ancient India. Please treat it with all due respect :-)\n<a href=\"https://mathoverflow.net/questions/107708/origin-of-square-and-multiply-algorithm\">https://mathoverflow.net/questions/107708/origin-of-square-and-multiply-algorithm</a></p>\n\n<pre><code>pow :: Integer -&gt; Integer -&gt; Integer\npow b e\n    | e == 0 = 1\n    | r == 0 = let bpq = pow b q  in  bpq*bpq\n    | r == 1 = let bpq = pow b q  in  bpq*bpq*b\n  where\n    (q, r) = divMod e 2\n\nmain = do\n    let b = 3 :: Integer\n    let e = 7 :: Integer\n    let x = b^e\n    putStrLn (\"b^e     = \" ++ show x)\n    let y = pow b e\n    putStrLn (\"pow b e = \" ++ show y)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11518452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IJEAoWRS3ic/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdAONWinaGxGptZ_Y8w1OXj-bewnA/mo/photo.jpg?sz=128", "display_name": "user11518452", "link": "https://stackoverflow.com/users/11518452/user11518452"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 56194692, "answer_count": 3, "score": 0, "last_activity_date": 1558286723, "creation_date": 1558134125, "last_edit_date": 1558135194, "question_id": 56194525, "link": "https://stackoverflow.com/questions/56194525/algorithm-to-calculate-exponent-using-recursion-and-mod", "title": "Algorithm to calculate exponent using recursion and mod", "body": "<p>I was taught a different way to calculate exponents using mod and recursion, but I don't fully understand it. The method is: To do <code>b^e</code>, we can break it down like so: </p>\n\n<pre><code>  q = e div 2\n  r = e mod 2\nthen e = 2q+r, and r could be 0 or 1.\n\nIf r=0:\n\n    b^e = (b^q)^2\n\nIf r=1:\n\n    b^e = (b^q)^2 * b\n\nbase case: b^0 = 1.\n</code></pre>\n\n<p>For example: <code>2^2, b=2, e=2</code>.</p>\n\n<pre><code>q = 2/2 = 1\nr = 2mod2 = 0\n\nr=0, therefore 2^2 = 2^1^2\n</code></pre>\n\n<p>I am trying to code this. </p>\n\n<pre><code>pow :: Integer -&gt; Integer -&gt; Integer\npow b e\n    | e == 0 = 1\n    | r == 0 = pow (pow b q) 2\n    | r == 1 = b * pow (pow b q) 2\n  where\n    (q, r) = divMod e 2\n</code></pre>\n\n<p>But the code does not end any time when <code>e!=0</code>, for example, <code>pow (-2) 4</code> or <code>pow 1 1</code> goes on forever. Any idea why?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1558130911, "post_id": 56193769, "comment_id": 99012752, "body": "And if you want to get fancy, you could write <code>isThisDeviceTheOneIWant n a b = ((a,b)==) &lt;$&gt; getOneDesc n</code>. I recommend this for the expert, so that readers need not double-check for something sneaky going on in this otherwise simple <code>do</code> block; but for a beginner it might be a bit much."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1558167428, "last_edit_date": 1558167428, "creation_date": 1558128508, "answer_id": 56193769, "question_id": 56193747, "link": "https://stackoverflow.com/questions/56193747/how-to-properly-choose-which-usb-device-to-connect-to/56193769#56193769", "title": "How To Properly Choose Which USB Device To Connect To?", "body": "<p>Your <code>getOneDesc</code> is an <code>IO (VendorId, ProductId)</code>, so that means that the result type of your <code>return (x == a) &amp;&amp; (y == b)</code> has type <code>IO Bool</code>. So you should change the type of your function. You must also add parentheses around the argument you pass to <code>return</code> (because in Haskell, <code>return</code> is not a keyword, just a plain function).</p>\n\n<pre><code>isThisDeviceTheOneIWant :: Int -&gt; VendorId -&gt; ProductId -&gt; <b>IO Bool</b>\nisThisDeviceTheOneIWant n a b = do\n    (x, y) &lt;- getOneDesc n\n    return <b>(</b>(x == a) &amp;&amp; (y == b)<b>)</b></code></pre>\n\n<p>You can not make the <code>isThisDeviceTheOneIWant</code> return a <code>Bool</code>, since the <code>getOneDesc</code>  returns an <code>IO (VendorId, ProductId)</code>, and you can <a href=\"https://stackoverflow.com/q/11467066/67579\"><em>not</em> get an <code>a</code> out of an <code>IO a</code></a>.</p>\n\n<p>We can, like <a href=\"https://stackoverflow.com/questions/56193747/how-to-properly-choose-which-usb-device-to-connect-to/56193769?noredirect=1#comment99012752_56193769\">@DanielWagner</a> says, use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:fmap\" rel=\"nofollow noreferrer\"><strong><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code></strong></a> to process the result of the <code>getOneDesc n</code>, like:</p>\n\n<pre><code>isThisDeviceTheOneIWant :: Int -&gt; VendorId -&gt; ProductId -&gt; IO Bool\nisThisDeviceTheOneIWant n a b = <b>fmap ((a, b) ==)</b> (getOneDesc n)</code></pre>\n\n<p>or use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-60--36--62-\" rel=\"nofollow noreferrer\"><strong><code>(&lt;$&gt;) :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code></strong></a> which is the same as <code>fmap</code>:</p>\n\n<pre><code>isThisDeviceTheOneIWant :: Int -&gt; VendorId -&gt; ProductId -&gt; IO Bool\nisThisDeviceTheOneIWant n a b = ((a, b) ==) <b>&lt;$&gt;</b> getOneDesc n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 9985445, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y4ooBZ_hzRc/AAAAAAAAAAI/AAAAAAAAAtQ/dL_nPMm3FLM/photo.jpg?sz=128", "display_name": "James Strieter", "link": "https://stackoverflow.com/users/9985445/james-strieter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 56193769, "answer_count": 1, "score": 3, "last_activity_date": 1558167428, "creation_date": 1558128306, "question_id": 56193747, "link": "https://stackoverflow.com/questions/56193747/how-to-properly-choose-which-usb-device-to-connect-to", "title": "How To Properly Choose Which USB Device To Connect To?", "body": "<p>I am new to both USB drivers and Haskell. I am trying to connect to Tomu (an ARM micocontroller that fits in a USB port) using System.USB. I tried this example: <a href=\"https://github.com/basvandijk/usb-example/blob/master/example.hs\" rel=\"nofollow noreferrer\">https://github.com/basvandijk/usb-example/blob/master/example.hs</a>, but it is several years out of date. I am trying to do hello world on USB, but getting type errors. </p>\n\n<p>The following code works: </p>\n\n<pre><code>module Lib where\n\nimport System.USB\nimport System.USB.IO\nimport Data.Vector \nimport Data.Maybe\n\ngetOneDesc :: Int -&gt; IO (VendorId, ProductId) \ngetOneDesc n = do\n    usbConn &lt;- newCtx\n    devList &lt;- getDevices usbConn\n    f &lt;- getDeviceDesc $ devList ! n\n    let f0 = deviceVendorId f\n    let f1 = deviceProductId f\n    return (f0, f1)\n</code></pre>\n\n<p>At the repl, I can type getOneDesc 0 and I get something like this: </p>\n\n<pre><code>(300, 42)\n</code></pre>\n\n<p>I figured I ought to be able to do something like this:</p>\n\n<pre><code>isThisDeviceTheOneIWant :: Int -&gt; VendorId -&gt; ProductId -&gt; Bool\nisThisDeviceTheOneIWant n a b = do\n    (x, y) &lt;- getOneDesc n\n    return (x == a) &amp;&amp; (y == b)\n</code></pre>\n\n<p>But I encounter type errors. </p>\n\n<p>Can anybody see what's wrong with this?</p>\n"}, {"tags": ["haskell", "functional-programming", "state-machine", "folding"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1558126665, "post_id": 56193466, "comment_id": 99011567, "body": "What is your question?"}, {"owner": {"reputation": 39, "user_id": 11248089, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HvqPECHw034/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rda3KbdXlEBYuEdWw0eSbzfv3gQhQ/mo/photo.jpg?sz=128", "display_name": "xentaquadrin", "link": "https://stackoverflow.com/users/11248089/xentaquadrin"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558127122, "post_id": 56193466, "comment_id": 99011698, "body": "How to write the fsm function with foldl or foldr"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 6, "creation_date": 1558129413, "post_id": 56193466, "comment_id": 99012348, "body": "It is your responsibility to attempt this goal. If you find that your approaches do not work, and <i>even after trying very hard</i> cannot figure out why, then outline what approach you took, what you expected the outcome of that approach to be and why, and what the outcome actually was. (If the actual outcome is a compiler error, then the correct way to communicate it is to copy and paste the complete error into your question.) Then we can help you identify the flaw in your reasoning."}], "answers": [{"tags": [], "owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": false, "score": 0, "last_activity_date": 1558130561, "creation_date": 1558130561, "answer_id": 56194087, "question_id": 56193466, "link": "https://stackoverflow.com/questions/56193466/how-to-use-foldl-foldr-on-strings-in-a-state-machine/56194087#56194087", "title": "How to use foldl/foldr on strings in a state machine?", "body": "<p>If you fill in the initial state and the string to process in <code>foldl</code>, the types basically imply the rest:</p>\n\n<pre><code>-- foldl :: Foldable t =&gt; (State -&gt; Char -&gt; State) -&gt; State -&gt; [Char] -&gt; State\nfsm def str = foldl x start str\n</code></pre>\n\n<p>Here <code>x</code> must have type <code>State -&gt; Char -&gt; State</code> and give you the next state given the current one and the next character, which is what your <code>step</code> function does given a <code>Definition</code> that you have. This gives you:</p>\n\n<pre><code>fsm def str = foldl (step def) start str :: State\n</code></pre>\n\n<p>Now you have a <code>State</code> but need a <code>Bool</code> saying if it's accepted, which is just a simple comparison:</p>\n\n<pre><code>fsm def str = foldl (step def) start str == accept\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 11248089, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HvqPECHw034/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rda3KbdXlEBYuEdWw0eSbzfv3gQhQ/mo/photo.jpg?sz=128", "display_name": "xentaquadrin", "link": "https://stackoverflow.com/users/11248089/xentaquadrin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1558130561, "creation_date": 1558126589, "question_id": 56193466, "link": "https://stackoverflow.com/questions/56193466/how-to-use-foldl-foldr-on-strings-in-a-state-machine", "title": "How to use foldl/foldr on strings in a state machine?", "body": "<p>I have to make a state machine, which equals a text editor's search funtion.</p>\n\n<p>I need to use foldl/foldr to apply the function to every character of a string.</p>\n\n<p>I have a few states, which I have to work with:</p>\n\n<pre><code>type State = Int\n\nstart :: State\nstart = 0\n\naccept :: State\naccept = (-2)\n\nreject :: State\nreject = (-1)\n</code></pre>\n\n<p>And I have type synonim : <code>type Definition = [(State, Char -&gt; State)]</code></p>\n\n<p>The function should look like this: <code>fsm :: Definition -&gt; String -&gt; Bool</code></p>\n\n<p>My code looks like this right now:</p>\n\n<pre><code>transition :: Char -&gt; State -&gt; (Char -&gt; State)\n\ntransition x y z\n | x == z = y\n | x == '*' = y\n | otherwise = reject\n\ntransitions :: [(Char, State)] -&gt; (Char -&gt; State)\n\ntransitions ((a,b):xs) e \n | a == e || a == '*' = b\n | a /= e || a /= '*' = transitions xs e\n | otherwise = reject\n\n\nstep :: Definition -&gt; State -&gt; Char -&gt; State\n\nstep ((a,b):xs) e f\n | a == e = b f\n | a /= e = step xs e f\n | otherwise = reject\n</code></pre>\n\n<p>It has a starting state, apply transition or transitions function and if it is accepted, the state accepted is the next starting state.</p>\n\n<p>Here is some test cases, which I have to test the function:</p>\n\n<pre><code>fsm [ (start, transition '*' accept)] \"x\" == True\n\nfsm [ (start, transition 'a' 1)\n    , (1, transition 'l' 2)\n    , (2, transition '*' accept)\n    ] \"alma\" == True\n\nfsm [ (start, transition '*' 1)\n    , (1, transition '*' 2)\n    , (2, transition 'x' 3)\n    , (3, transition '*' accept)\n    ] \"taxi\" == True\n\nfsm [ (start, transitions [('\\n',accept), ('*', 1)])\n    , (1, transition '*' start) \n    ] \"aa\\n\" == True\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1558120233, "post_id": 56192019, "comment_id": 99009219, "body": "This is like, verbatim the motivating example for QuantifiedConstraints. You okay with restricting yourself to very new compiler versions?"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 1, "creation_date": 1558128443, "post_id": 56192019, "comment_id": 99012116, "body": "This looks like a compiler bug through and through. The complaints about a type variable <code>z</code> when we should be instantiating <code>z ~ YTree f g a</code> seem very strange. Perhaps GHC&#39;s getting stuck; it wants <code>Ord (YTree f g a)</code>, finds the current instance to satisfy that want, but then is confused because it has to cough up evidence for the quantified contexts."}, {"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 0, "creation_date": 1558175237, "post_id": 56192019, "comment_id": 99019501, "body": "@Daniel_Wagner yes, I am okay with that. It&#39;s not something in production or anything that needs compatibility."}], "answers": [{"tags": [], "owner": {"reputation": 738, "user_id": 8075159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8709365a90d8a840b976b0f132f912e5?s=128&d=identicon&r=PG&f=1", "display_name": "Hogeyama", "link": "https://stackoverflow.com/users/8075159/hogeyama"}, "is_accepted": true, "score": 3, "last_activity_date": 1558154285, "creation_date": 1558154285, "answer_id": 56196010, "question_id": 56192019, "link": "https://stackoverflow.com/questions/56192019/is-it-possible-to-derive-an-implementation-for-ord-for-this-tree-type-and-if/56196010#56196010", "title": "Is it possible to derive an implementation for `Ord` for this tree type? And if not, why?", "body": "<pre><code>deriving instance\n  ( Ord a, forall x y. (Ord x, Ord y) =&gt; Ord (f x y), forall z. Ord z =&gt; Ord (g z)\n  , Eq  a, forall x y. (Eq  x, Eq  y) =&gt; Eq  (f x y), forall z. Eq  z =&gt; Eq  (g z)\n  ) =&gt; Ord (YTree f g a)\n</code></pre>\n\n<p>will compile but I don't know why we need <code>Eq</code> constraints.</p>\n"}], "owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 2, "accepted_answer_id": 56196010, "answer_count": 1, "score": 4, "last_activity_date": 1558175074, "creation_date": 1558118833, "last_edit_date": 1558175074, "question_id": 56192019, "link": "https://stackoverflow.com/questions/56192019/is-it-possible-to-derive-an-implementation-for-ord-for-this-tree-type-and-if", "title": "Is it possible to derive an implementation for `Ord` for this tree type? And if not, why?", "body": "<p>I have defined the following very generic tree type:</p>\n\n<pre><code>data YTree f g a = YNode (f a (g (YTree f g a)))\n</code></pre>\n\n<p>I have defined a functor instance as follows (to demonstrate that it is possible to work with):</p>\n\n<pre><code>instance (Bifunctor f, Functor g) =&gt; Functor (YTree f g) where\n    fmap f (YNode m) = YNode $ bimap f (fmap (fmap f)) m\n</code></pre>\n\n<p>I then successfully derived some instances (using <code>StandaloneDeriving</code>, <code>ExplicitForAll</code> and <code>QuantifiedConstraints</code>):</p>\n\n<pre><code>deriving instance (Show a, forall x y. (Show x, Show y) =&gt; Show (f x y), forall z. Show z =&gt; Show (g z)) =&gt; Show (YTree f g a)\nderiving instance (Read a, forall x y. (Read x, Read y) =&gt; Read (f x y), forall z. Read z =&gt; Read (g z)) =&gt; Read (YTree f g a)\nderiving instance (Eq a, forall x y. (Eq x, Eq y) =&gt; Eq (f x y), forall z. Eq z =&gt; Eq (g z)) =&gt; Eq (YTree f g a)\n</code></pre>\n\n<p>However, the following <code>deriving instance</code> clause throws an error when included:</p>\n\n<pre><code>deriving instance (Ord a, forall x y. (Ord x, Ord y) =&gt; Ord (f x y), forall z. Ord z =&gt; Ord (g z)) =&gt; Ord (YTree f g a)\n</code></pre>\n\n<p>Namely, </p>\n\n<pre><code>Data\\Tree\\Generalized.hs:32:1: error:\n    * Could not deduce (Ord z)\n        arising from the superclasses of an instance declaration\n      from the context: (Ord a,\n                         forall x y. (Ord x, Ord y) =&gt; Ord (f x y),\n                         forall z. Ord z =&gt; Ord (g z))\n        bound by the instance declaration\n        at Data\\Tree\\Generalized.hs:32:1-119\n      or from: Eq z\n        bound by a quantified context at Data\\Tree\\Generalized.hs:1:1\n      Possible fix: add (Ord z) to the context of a quantified context\n    * In the instance declaration for `Ord (YTree f g a)'\n   |\n32 | deriving instance (Ord a, forall x y. (Ord x, Ord y) =&gt; Ord (f x y), forall z. Ord z =&gt; Ord (g z)) =&gt; Ord (YTree f g a)\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>as well as another error.</p>\n\n<p>As far as I can see, the implementation would simply be:</p>\n\n<pre><code>instance (Ord a, forall x y. (Ord x, Ord y) =&gt; Ord (f x y), forall z. Ord z =&gt; Ord (g z)) =&gt; Ord (YTree f g a) where\n    compare (YNode x) (YNode y) = compare x y\n</code></pre>\n\n<p>This produces the same error, though.</p>\n\n<p>Is it possible to derive this? Why doesn't it work currently? Is it even possible to implement? Am I dead wrong?</p>\n"}, {"tags": ["haskell", "monads"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1558118436, "creation_date": 1558118436, "answer_id": 56191936, "question_id": 56191775, "link": "https://stackoverflow.com/questions/56191775/fail-zero-as-a-way-to-generate-nothing-in-simple-a-maybe-a-example/56191936#56191936", "title": "`fail &quot;zero&quot;` as a way to generate Nothing in simple `a -&gt; Maybe a` example", "body": "<blockquote>\n  <p>Is it a proper reading <code>(\\ x -&gt; if (x == 0) then fail \"zero\" else Just (x + 1) )</code> attempts to be simple case for <code>a -&gt; Maybe a</code> function?</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <p>What prevents us from using  <code>(\\ x -&gt; if (x == 0) then Nothing else Just (x + 1) )</code> if we just needed an illustration of <code>a -&gt; Maybe a</code>?</p>\n</blockquote>\n\n<p>Nothing.</p>\n"}, {"comments": [{"owner": {"reputation": 3079, "user_id": 1758363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hBUXs.jpg?s=128&g=1", "display_name": "Evgeny", "link": "https://stackoverflow.com/users/1758363/evgeny"}, "edited": false, "score": 0, "creation_date": 1558121333, "post_id": 56192416, "comment_id": 99009618, "body": "Thank you for addition! The <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:fail\" rel=\"nofollow noreferrer\">docs</a> say <code>fail</code> <i>is invoked on pattern-match failure in a do expression.</i> Is this useful for anything else? Another way of keeping track of failed computations, like <code>Either</code>?"}, {"owner": {"reputation": 1290, "user_id": 5499871, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206799318615183/picture?type=large", "display_name": "Izaak Weiss", "link": "https://stackoverflow.com/users/5499871/izaak-weiss"}, "reply_to_user": {"reputation": 3079, "user_id": 1758363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hBUXs.jpg?s=128&g=1", "display_name": "Evgeny", "link": "https://stackoverflow.com/users/1758363/evgeny"}, "edited": false, "score": 2, "creation_date": 1558121734, "post_id": 56192416, "comment_id": 99009779, "body": "Edited post to include details of what &quot;invoked on pattern match failure&quot; means. It&#39;s mostly a way of making &quot;failed computations&quot; generic over different kinds of <code>Monad</code>s. One of my favorite uses of this is that you can write a lot of code that is generic over MonadFail, and then choose what type of error you want just by changing the types and some basic definitions."}, {"owner": {"reputation": 3079, "user_id": 1758363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hBUXs.jpg?s=128&g=1", "display_name": "Evgeny", "link": "https://stackoverflow.com/users/1758363/evgeny"}, "edited": false, "score": 0, "creation_date": 1558121848, "post_id": 56192416, "comment_id": 99009830, "body": "Thank you for example @Izaak Weiss and the <code>MonadFail</code> workflow comment!"}], "tags": [], "owner": {"reputation": 1290, "user_id": 5499871, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206799318615183/picture?type=large", "display_name": "Izaak Weiss", "link": "https://stackoverflow.com/users/5499871/izaak-weiss"}, "is_accepted": false, "score": 4, "last_activity_date": 1558621940, "last_edit_date": 1558621940, "creation_date": 1558120945, "answer_id": 56192416, "question_id": 56191775, "link": "https://stackoverflow.com/questions/56191775/fail-zero-as-a-way-to-generate-nothing-in-simple-a-maybe-a-example/56192416#56192416", "title": "`fail &quot;zero&quot;` as a way to generate Nothing in simple `a -&gt; Maybe a` example", "body": "<p>To elaborate on Daniel's entirely correct answer, <code>fail</code> is a function from the <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Monad-Fail.html\" rel=\"nofollow noreferrer\"><code>MonadFail</code></a> typeclass. It was originally in the <code>Monad</code> typeclass, but it didn't really belong there, as some <code>Monad</code>s don't have a conception of failure. For those that do have a conception of failure, <code>fail</code> has the type <code>MonadFail m =&gt; String -&gt; m a</code>. That is, for any type that implements the <code>MonadFail</code> interface, and any type <code>a</code>, <code>fail</code> can take a string and produce an instance of that type paramaterized by <code>a</code>.</p>\n\n<p>For <code>Maybe a</code>, <code>fail s = Nothing</code>.</p>\n\n<p>For <code>[a]</code>, <code>fail s = []</code>.</p>\n\n<p>For <code>IO a</code>, <code>fail</code> raises an exception containing the string.</p>\n\n<p>Many people write instances of <code>MonadFail</code> for types like <code>Either String a</code>, where <code>fail s = Left s</code>. The main reason this is not part of the standard library is because <code>Either</code> is a fairly abstract type, and although it's common to treat <code>Right</code> as success and <code>Left</code> as failure, it can be reasonably used as a <code>Monad</code> with the semantics flipped. (For instance, if you want to try N things, and move on to the next thing if one thing fails, but take the first result, then you need to use <code>Left</code> as the success case.)</p>\n\n<p>Edit:</p>\n\n<p>Also, when you write some code like</p>\n\n<pre><code>do \n  Just y &lt;- getMaybe x\n  return y\n</code></pre>\n\n<p>That gets desugared to:</p>\n\n<pre><code>do\n  case getMaybe x of\n    Just y -&gt; return y\n    _      -&gt; fail \"Failed pattern match\"\n</code></pre>\n\n<p>This means that a failed pattern match will throw an exception in <code>IO a</code>, but be an empty list in <code>[a]</code>, and be a <code>Nothing</code> in a <code>Maybe a</code>.</p>\n"}], "owner": {"reputation": 3079, "user_id": 1758363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hBUXs.jpg?s=128&g=1", "display_name": "Evgeny", "link": "https://stackoverflow.com/users/1758363/evgeny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 56191936, "answer_count": 2, "score": 1, "last_activity_date": 1558621940, "creation_date": 1558117608, "last_edit_date": 1558171456, "question_id": 56191775, "link": "https://stackoverflow.com/questions/56191775/fail-zero-as-a-way-to-generate-nothing-in-simple-a-maybe-a-example", "title": "`fail &quot;zero&quot;` as a way to generate Nothing in simple `a -&gt; Maybe a` example", "body": "<p>I'm reading <a href=\"https://wiki.haskell.org/Simple_monad_examples\" rel=\"nofollow noreferrer\">a revealing example of using a bind operator</a>: </p>\n\n<pre><code>Just 5 &gt;&gt;= (\\ x -&gt; if (x == 0) then fail \"zero\" else Just (x + 1) )\n</code></pre>\n\n<p>returns <code>Just 6</code>.</p>\n\n<p>I'm confused by the behaviour of <code>fail</code> and its usefulness in the example. \nWhen looking at the code I thought <code>fail \"zero\"</code> may have a meaning:</p>\n\n<ul>\n<li>program never gets to that point </li>\n<li>laziness</li>\n<li>something else.</li>\n</ul>\n\n<p>Then I realised that after a type cohesion, an exception becomes <code>Nothing</code> (documented <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:fail\" rel=\"nofollow noreferrer\">here</a>). Still confusing for me that without type enforcement <code>fail</code> is just an error in program. </p>\n\n<pre><code>Prelude&gt; fail \"zero\" :: Maybe Int\nNothing\nPrelude&gt; fail \"abc\" :: [Int]\n[]\nPrelude&gt; fail \"zero\"\n*** Exception: user error (zero)\n</code></pre>\n\n<p>My question is about usefulness of <code>fail \"zero\"</code> in this example.</p>\n\n<p>Is it a proper reading <code>(\\ x -&gt; if (x == 0) then fail \"zero\" else Just (x + 1) )</code> attempts to be simple case for <code>a -&gt; Maybe a</code> function? </p>\n\n<p>What prevents us from using  <code>(\\ x -&gt; if (x == 0) then Nothing else Just (x + 1) )</code> if we just needed an illustration of <code>a -&gt; Maybe a</code>?</p>\n\n<p>I found this version below a much easier and shorter way to grasp same example.</p>\n\n<pre><code>Prelude&gt; g x = if (x == 0) then Nothing else Just (x + 1)\nPrelude&gt; Just 0 &gt;&gt;= g\nNothing\nPrelude&gt; Just 1 &gt;&gt;= g\nJust 2\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1558117348, "post_id": 56191326, "comment_id": 99008191, "body": "How about a regex? They can contain end string anchors and you can just match the initial segment something like &quot;(.*)bar$&quot;"}, {"owner": {"reputation": 549, "user_id": 1892304, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/032459944d4979a26de876a457b604c9?s=128&d=identicon&r=PG", "display_name": "user1892304", "link": "https://stackoverflow.com/users/1892304/user1892304"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1558117392, "post_id": 56191326, "comment_id": 99008207, "body": "I was not aware of regex in Haskell. What would that look like?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1558118629, "post_id": 56191326, "comment_id": 99008650, "body": "Perhaps it is time to write an actual parser. (I bet you&#39;re asking this because it&#39;s part of a larger piece of code that&#39;s actually doing parsing anyway.) <a href=\"https://stackoverflow.com/q/52556531/791604\">See also.</a>"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1558140054, "post_id": 56191326, "comment_id": 99014372, "body": "To open a window into the depth of this problem: what does <code>f (x ++ y) = (x,y)</code> compute?"}], "answers": [{"comments": [{"owner": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "edited": false, "score": 0, "creation_date": 1558120951, "post_id": 56191695, "comment_id": 99009480, "body": "I think it&#39;s a mistake to advise against something because of performance reasons when the question doesn&#39;t have any interest in performance - premature optimisation is the root of all evil."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "edited": false, "score": 1, "creation_date": 1558122478, "post_id": 56191695, "comment_id": 99010072, "body": "Feel free to do slow things all you want. My answer recommends doing exactly those slow things...but do them in a guard, where you can <i>see</i> that they&#39;re expensive."}, {"owner": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "edited": false, "score": 0, "creation_date": 1558126865, "post_id": 56191695, "comment_id": 99011629, "body": "That&#39;s still coding with performance in mind when performance is not yet an issue - who cares that this is expensive? You don&#39;t even know if this code is going to be shared in a way that means the person reading it wouldn&#39;t know the behaviour of the &quot;pattern match&quot;."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 0, "last_activity_date": 1558117218, "creation_date": 1558117218, "answer_id": 56191695, "question_id": 56191326, "link": "https://stackoverflow.com/questions/56191326/how-can-i-concisely-match-a-list-according-to-its-latter-half-and-bind-its-for/56191695#56191695", "title": "How can I concisely match a list according to its latter half, and bind it&#39;s former half accordingly?", "body": "<p>Don't do it with pattern matching. Pattern matches are typically cheap and match the structure of the input data. This is a very expensive pattern written as if it were very cheap to compute. If you want to do this, write it as a guard clause, where you can make it clear exactly what's happening.</p>\n"}, {"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 3, "last_activity_date": 1558120029, "creation_date": 1558120029, "answer_id": 56192233, "question_id": 56191326, "link": "https://stackoverflow.com/questions/56191326/how-can-i-concisely-match-a-list-according-to-its-latter-half-and-bind-its-for/56192233#56192233", "title": "How can I concisely match a list according to its latter half, and bind it&#39;s former half accordingly?", "body": "<p>On built-in <code>String</code>, this is a very bad idea, since your pattern match turns out to be quite expensive. On other string types, like <code>Text</code> or <code>ByteString</code>, you can use pattern guards:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport qualified Data.Text as T\n\nf :: Text -&gt; Text\nf x | Just x' &lt;- T.stripSuffix \"bar\" x = ...\n</code></pre>\n\n<p>Or with <code>ViewPatterns</code> (of which I am less fond):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE OverloadedStrings, ViewPatterns #-}\n\nimport qualified Data.Text as T\n\nf :: Text -&gt; Text\nf (T.stripSuffix \"bar\" -&gt; Just x') = ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": false, "score": 2, "last_activity_date": 1558126984, "last_edit_date": 1558126984, "creation_date": 1558124526, "answer_id": 56193101, "question_id": 56191326, "link": "https://stackoverflow.com/questions/56191326/how-can-i-concisely-match-a-list-according-to-its-latter-half-and-bind-its-for/56193101#56193101", "title": "How can I concisely match a list according to its latter half, and bind it&#39;s former half accordingly?", "body": "<pre><code>stripSuffix :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Maybe [a]\nstripSuffix needle = go &lt;*&gt; drop (length needle)\n  where\n    go xs [] = if xs == needle then Just [] else Nothing\n    go (x:xs) (_:ys) = (x:) &lt;$&gt; go xs ys\n\nf (stripSuffix \"bar\" -&gt; Just pref) = pref\n</code></pre>\n\n<p>I haven't tested it too much but this is a simple solution that doesn't bring in extra machinery of regexs / parsers.</p>\n"}, {"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1558128966, "post_id": 56193484, "comment_id": 99012236, "body": "I would advise against using TH for trivial tasks like this. Besides hurting readability, it also impacts compile times. Also, your <code>+++</code> is plain wrong - it forgets to check that the suffix matches! Instead of a hitting non-exhaustive cases error, <code>f &quot;hello&quot;</code> happily returns <code>&quot;he&quot;</code>. That&#39;s because <code>ViewPatterns</code> introduces a new <code>y</code> variable instead of asserting it is equal to your outer <code>y</code>. IMO, the complexity of this solution outweighs the small syntactic benefit."}, {"owner": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1558134921, "post_id": 56193484, "comment_id": 99013581, "body": "Thanks for pointing that out - I was a bit naive with the quasiquoting mechanics. The updated version works. But I don&#39;t think readability or compile times are important enough to discount these kinds of solutions unless the person asking says so. The question is about the syntactic benefit - that&#39;s what I want to answer."}], "tags": [], "owner": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "is_accepted": false, "score": 0, "last_activity_date": 1558134642, "last_edit_date": 1558134642, "creation_date": 1558126674, "answer_id": 56193484, "question_id": 56191326, "link": "https://stackoverflow.com/questions/56191326/how-can-i-concisely-match-a-list-according-to-its-latter-half-and-bind-its-for/56193484#56193484", "title": "How can I concisely match a list according to its latter half, and bind it&#39;s former half accordingly?", "body": "<p>This is <em>almost</em> possible with TemplateHaskell - someone more experienced with it could improve on this answer.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Language.Haskell.TH\nimport Language.Haskell.TH.Syntax\n\n(+++) :: Q Pat -&gt; String -&gt; Q Pat\nx +++ y = [p| ((\\string -&gt; splitAt (length string - length y) string) -&gt; (x, $literal_pattern)) |]\n  where literal_pattern = returnQ (LitP (StringL y))\n</code></pre>\n\n<p>This is usable in the pattern position, and you can pass in a pattern as the first argument using TemplateHaskell's quasiquoting:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f $([p|x|] +++ \"bar\") = x\n</code></pre>\n\n<p>Rather annoyingly, I can't find any explanation of how you can pass a pattern to a TemplateHaskell splice any more succintly than this.</p>\n"}], "owner": {"reputation": 549, "user_id": 1892304, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/032459944d4979a26de876a457b604c9?s=128&d=identicon&r=PG", "display_name": "user1892304", "link": "https://stackoverflow.com/users/1892304/user1892304"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1558134642, "creation_date": 1558115513, "question_id": 56191326, "link": "https://stackoverflow.com/questions/56191326/how-can-i-concisely-match-a-list-according-to-its-latter-half-and-bind-its-for", "title": "How can I concisely match a list according to its latter half, and bind it&#39;s former half accordingly?", "body": "<p>Suppose I have a function <code>f :: String -&gt; String</code> and want to match arguments of the form</p>\n\n<pre><code>_ ++ \"bar\"\n</code></pre>\n\n<p>where <code>_</code> is an unspecified string that I would like to return. In other words, I want to match arguments like <code>foobar</code> and <code>bazbar</code> and return <code>foo</code> and <code>baz</code> respectively.</p>\n\n<p>Using <code>ViewPatterns</code> this is possible as follows:</p>\n\n<pre><code>{-# LANGUAGE ViewPatterns #-}\n\nf :: String -&gt; String\nf x@(reverse . take 3 $ reverse -&gt; \"bar\") = take (n-3) x\n    where n = length x\n</code></pre>\n\n<p>...but this is far from ideal. Mainly because things will get hairy very quickly if I decide that I want to combine two or more such patterns.</p>\n\n<p>Ideally, I want something to be able to write something like this:</p>\n\n<pre><code>f (x:\"bar\") = x\n</code></pre>\n\n<p>but unfortunately this is not valid Haskell.</p>\n\n<p>Is there an adequate solution in ViewPatterns or another extension?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 6, "creation_date": 1558119646, "post_id": 56190913, "comment_id": 99009007, "body": "Once you are dealing with a runtime that reserves the right to stop the world and do garbage collection, you aren&#39;t really &quot;real time&quot;.  You can likely engineer something that will generally work within your constraints most of the time, but when you say things like &quot;never&quot; deviate more than 5%, it&#39;s harder to make those promises."}, {"owner": {"reputation": 181, "user_id": 9985445, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y4ooBZ_hzRc/AAAAAAAAAAI/AAAAAAAAAtQ/dL_nPMm3FLM/photo.jpg?sz=128", "display_name": "James Strieter", "link": "https://stackoverflow.com/users/9985445/james-strieter"}, "reply_to_user": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1558120093, "post_id": 56190913, "comment_id": 99009157, "body": "Good point. I guess when I say never, what I mean is really rare. So if GC takes up an entire second once a year I can live with that. Is there any good way of gathering statistical data?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1558127857, "post_id": 56190913, "comment_id": 99011935, "body": "There are different types of real-time systems. Soft real-time systems allow some deadlines to be missed. In audio processing specifically, many systems use a buffer to allow for missed deadlines. Real-time garbage collection is also an area of active research."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1558128703, "post_id": 56190913, "comment_id": 99012177, "body": "<a href=\"http://hackage.haskell.org/package/atom\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/atom</a>"}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 4, "last_activity_date": 1558132989, "last_edit_date": 1558132989, "creation_date": 1558132303, "answer_id": 56194310, "question_id": 56190913, "link": "https://stackoverflow.com/questions/56190913/how-to-force-evaluation-x-times-per-second/56194310#56194310", "title": "How to force evaluation X times per second?", "body": "<p>You can try but I'm not optimistic.  The GC and RTS will impact you in a significant negative manner but it's not possible for me to say if you'll care.</p>\n\n<p>Eventloop is ... huge... personally I'd do something custom and light weight.</p>\n\n<p>Don't use a \"sleep then logic\" setup because the \"logic\" part is not free and you'll end up with longer pauses than desired.  My tests with \"fork logic then sleep\" show similarly bad behavior because <code>sleep</code> won't start till the RTS schedules the parent thread again.</p>\n\n<p><strong>Custom solution using absolute times to avoid drift</strong></p>\n\n<p>A custom solution would look something like:</p>\n\n<pre><code>import Control.Concurrent\nimport Control.Monad\nimport Data.Time\n\nperiodic :: NominalDiffTime -&gt; UTCTime -&gt; IO () -&gt; IO ()\nperiodic delayTime base operation =\n  do start &lt;- getCurrentTime\n     let end = addUTCTime delayTime base\n         microSeconds = floor $ (1000000 :: Double) * realToFrac (diffUTCTime end start)\n     threadDelay microSeconds\n     void $ forkIO operation\n     periodic delayTime end operation\n\nmain :: IO ()\nmain =\n  do start &lt;- getCurrentTime\n     forkIO $ periodic (1/98) start (getCurrentTime &gt;&gt;= print)\n     threadDelay 10000000 -- 10 seconds\n</code></pre>\n\n<p>This is simple and gets you really close to what any framework will offer unless you need some snazzy features like canceling events.  You also get close to your desired period:</p>\n\n<pre><code>import Control.Concurrent\nimport Control.Monad\nimport Data.Time\n\nperiodic :: NominalDiffTime -&gt; UTCTime -&gt; IO () -&gt; IO ()\nperiodic delayTime base operation =\n  do start &lt;- getCurrentTime\n     let end = addUTCTime delayTime base\n         microSeconds = floor $ (1000000 :: Double) * realToFrac (diffUTCTime end start)\n     threadDelay microSeconds\n     void $ forkIO operation\n     periodic delayTime end operation\n\nmain :: IO ()\nmain =\n  do start &lt;- getCurrentTime\n     forkIO $ periodic (1/98) start (getCurrentTime &gt;&gt;= print)\n     threadDelay 10000000 -- 10 seconds\n</code></pre>\n\n<p>Results in:</p>\n\n<pre><code>% ./y | wc -l\n980\n</code></pre>\n\n<p>And you can analyze the printed times to get your confidence interval, but that will get worse as the load changes, heap grows, and GC needs to do more pauses.</p>\n\n<p><strong>Actual Answers</strong></p>\n\n<p>EDIT because you have actual questions.</p>\n\n<blockquote>\n  <p>1) Is this the kind of thing Haskell can do?</p>\n</blockquote>\n\n<p>It is not really something Haskell is for - the GHC RTS is not geared for even soft real time work like audio.</p>\n\n<blockquote>\n  <p>2) Is the sleep part inefficient? Or can other Haskell threads occupy the same OS thread while myEventLoop is executing the sleep part?</p>\n</blockquote>\n\n<p>Multiple Haskell threads can occupy the same OS thread, no issues.</p>\n\n<blockquote>\n  <p>3) Assuming sleeping is a good idea, hard coding the sleep time most likely is not. I can read the time stamp counter (TSC) since the program is running on an x86 architecture, but that approach could be problematic if GHC decides to chop up the program into microthreads, sending some to 1 CPU core and others to a different CPU core, as different cores can have different values for TSC. Is this a thing I should be worried about, and if so, what is a better approach?</p>\n</blockquote>\n\n<p>Yes, you should worry about getting the Haskell thread moved around from core to core and OS thread to OS thread.  The above is my attempt at a home grown approach.  Eleven years ago I wrote <code>control-event</code> (on hackage) to solve this same problem for me but my time constraints were less of an issue and needs a bit different.  These days you can use the GHC event manager directly, though I'd avoid it because of the lower level API and it doesn't solve your underlying issue with the GC pauses.</p>\n"}], "owner": {"reputation": 181, "user_id": 9985445, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y4ooBZ_hzRc/AAAAAAAAAAI/AAAAAAAAAtQ/dL_nPMm3FLM/photo.jpg?sz=128", "display_name": "James Strieter", "link": "https://stackoverflow.com/users/9985445/james-strieter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 2, "accepted_answer_id": 56194310, "answer_count": 1, "score": 6, "last_activity_date": 1558132989, "creation_date": 1558113411, "question_id": 56190913, "link": "https://stackoverflow.com/questions/56190913/how-to-force-evaluation-x-times-per-second", "title": "How to force evaluation X times per second?", "body": "<p>I need a real time event loop that does something like this:</p>\n\n<pre><code>myEventLoop = do\n    businessLogic x0 x1 x2 ... xN\n    sleep 0.01\n    myEventLoop\n</code></pre>\n\n<p>I know about the eventloop package, but it seems to geared more towards web applications, and what I need is real time signal processing. Let's say the sample rate is 100 Hz. The sample rate doesn't need be super precise; if it's only 98 Hz once in awhile that's not a big deal. But I never want it to deviate more than 5%. For the moment we're only talking about GHC executing +/-5%. Ignore timing errors due to the OS. </p>\n\n<p>My questions are:\n1) Is this the kind of thing Haskell can do? I'm a bit concerned about the +/- 5% part. \n2) Is the sleep part inefficient? Or can other Haskell threads occupy the same OS thread while myEventLoop is executing the sleep part?\n3) Assuming sleeping is a good idea, hard coding the sleep time most likely is not. I can read the time stamp counter (TSC) since the program is running on an x86 architecture, but that approach could be problematic if GHC decides to chop up the program into microthreads, sending some to 1 CPU core and others to a different CPU core, as different cores can have different values for TSC. Is this a thing I should be worried about, and if so, what is a better approach?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1558114999, "post_id": 56190329, "comment_id": 99007294, "body": "FYI, type errors are not platform dependent. Just the GHC version will do, and maybe the versions of relevant non-base packages you&#39;re using."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1558115093, "post_id": 56190329, "comment_id": 99007329, "body": "Your <code>dummy</code> doesn&#39;t use the <code>Applicative</code> instance. Does the real function?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1558115196, "post_id": 56190329, "comment_id": 99007379, "body": "Also: <code>data Nat = Z | S Nat</code> is so common that using an <code>N</code> constructor instead throws everyone for a loop. You should rename the singleton <code>Vector</code> constructor to free up <code>S</code>."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1558116961, "post_id": 56191382, "comment_id": 99008042, "body": "All of the information available in an <code>SNat n</code> is also available in an <code>Vector n a</code> (just follow the left branch all the way down), so it seems odd that this would help at all. Can you comment on why it would?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1558117207, "post_id": 56191382, "comment_id": 99008149, "body": "I note that you actually made <i>two</i> changes in your final code block: one was adding an <code>SNat</code> argument, either implicitly via a <code>KnownNat</code> constraint or explicitly as an argument, and the other was leaving off the existing <code>Applicative</code> constraint. The latter is enough; per my previous comment, the former seems to be a complete red herring."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1558117217, "last_edit_date": 1558117217, "creation_date": 1558115735, "answer_id": 56191382, "question_id": 56190329, "link": "https://stackoverflow.com/questions/56190329/more-applicative-trouble-with-a-vector-type-enforcing-length-2n/56191382#56191382", "title": "More Applicative trouble with a vector type enforcing length 2^n", "body": "<p>I'm going to rename your constructors for the sake of my sanity.</p>\n\n<pre><code>data Nat = Z | S Nat\n\ndata Vector n a where\n  Leaf :: a -&gt; Vector 'Z a\n  Branch :: Vector n a -&gt; Vector n a -&gt; Vector ('S n) a\n</code></pre>\n\n<p>The trouble is in the recursive case. Knowing <code>Applicative ('S n)</code> does not give you <code>Applicative n</code>; you can use only <em>superclass</em> constraints, not <em>instance</em> constraints, for this. The reason is that an instance constraint just says how to construct a dictionary; it doesn't say anything about what's in it.</p>\n\n<p>I suspect that what you probably want is a very common folklore mechanism using a \"singleton\" type.</p>\n\n<pre><code>data SNat n where\n  SZ :: SNat 'Z\n  SS :: SNat n -&gt; SNat ('S n)\n\nclass KnownNat n where\n  known :: SNat n\n\ninstance Known 'Z where\n  known = SZ\n\ninstance Known n =&gt; Known ('S n) where\n  known = SS known\n</code></pre>\n\n<p>Now you can write functions that work with <code>SNat</code>s, and ones that work implicitly with <code>KnownNat</code>.</p>\n\n<pre><code>dummy :: KnownNat n =&gt; Vector n Int -&gt; Vector n Int -&gt; Int\ndummy = dummy' known\n\ndummy' :: SNat n -&gt; Vector n Int -&gt; Vector n Int -&gt; Int\n</code></pre>\n\n<p>Note: if you look at my answer to your previous question, you'll see that only the <code>pure</code> method of <code>Applicative</code> is size-dependent. So if you don't need <code>pure</code>, you can probably yank the constraint altogether.</p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 11514944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d7af49ed3ab1f7184cde90d699269c?s=128&d=identicon&r=PG&f=1", "display_name": "John Poe", "link": "https://stackoverflow.com/users/11514944/john-poe"}, "edited": false, "score": 0, "creation_date": 1558370822, "post_id": 56191669, "comment_id": 99070812, "body": "Thanks, yes the motivating example is too simple. I hope the updated version doesn&#39;t have this problem anymore."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 113, "user_id": 11514944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d7af49ed3ab1f7184cde90d699269c?s=128&d=identicon&r=PG&f=1", "display_name": "John Poe", "link": "https://stackoverflow.com/users/11514944/john-poe"}, "edited": false, "score": 0, "creation_date": 1558375109, "post_id": 56191669, "comment_id": 99072494, "body": "@JohnPoe I&#39;ve updated my answer to accommodate the new problem."}, {"owner": {"reputation": 113, "user_id": 11514944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d7af49ed3ab1f7184cde90d699269c?s=128&d=identicon&r=PG&f=1", "display_name": "John Poe", "link": "https://stackoverflow.com/users/11514944/john-poe"}, "edited": false, "score": 0, "creation_date": 1558531423, "post_id": 56191669, "comment_id": 99132280, "body": "Thanks for your magical solution. I do not have any clue how to interpret the three lines defining withApplicative, but I guess that I&#39;ll have to learn still quite a bit of haskell until I&#39;ll tackle the task to understand what&#39;s going on here. Quadratic cost is OK also for my real use case, but I&#39;ll wait anyway few days until I&#39;ll accept your solution, hoping for a different solution closer to my current knowledge of haskell."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 113, "user_id": 11514944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d7af49ed3ab1f7184cde90d699269c?s=128&d=identicon&r=PG&f=1", "display_name": "John Poe", "link": "https://stackoverflow.com/users/11514944/john-poe"}, "edited": false, "score": 0, "creation_date": 1558577687, "post_id": 56191669, "comment_id": 99150317, "body": "@JohnPoe I took a stab at writing a bit more expository text on how the solution works. Now that I&#39;ve written it I&#39;m not certain whether it will be helpful or cause even more confusion; I invite you to take a stab at reading it and let me know which it was in the end."}, {"owner": {"reputation": 113, "user_id": 11514944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d7af49ed3ab1f7184cde90d699269c?s=128&d=identicon&r=PG&f=1", "display_name": "John Poe", "link": "https://stackoverflow.com/users/11514944/john-poe"}, "edited": false, "score": 0, "creation_date": 1558603720, "post_id": 56191669, "comment_id": 99159017, "body": "Wonderful explanation! I did not expect that it possible to describe what&#39;s going on my level. Instead of finding a solution on my level of understanding, you lifted my understanding up to the level of your solution. Thank you very much!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1558577631, "last_edit_date": 1558577631, "creation_date": 1558117087, "answer_id": 56191669, "question_id": 56190329, "link": "https://stackoverflow.com/questions/56190329/more-applicative-trouble-with-a-vector-type-enforcing-length-2n/56191669#56191669", "title": "More Applicative trouble with a vector type enforcing length 2^n", "body": "<p>Good question! One way to do this is to recover an <code>Applicative</code> instance just in time, recursing over the spine of the tree when we discover we need it. So:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\nwithApplicative :: Vector n t -&gt; (Applicative (Vector n) =&gt; a) -&gt; a\nwithApplicative S{} a = a\nwithApplicative (V v _) a = withApplicative v a\n</code></pre>\n\n<p>Armed with this, we can call for the appropriate instance without putting it in our context:</p>\n\n<pre><code>dummy :: Vector n Int -&gt; Vector n Int -&gt; Int\ndummy (S a) (S b) = a + b\ndummy (V a a') (V b b') = withApplicative a (dummy (a*b) (a'*b'))\n</code></pre>\n\n<p>Since <code>withApplicative</code> is linear in the depth of your tree, and we call <code>withApplicative</code> once at each depth, this adds a runtime component that is quadratic in the depth of your tree to build up appropriate <code>Applicative</code> dictionaries. With some work it should be possible to share the dictionaries across recursive calls to drop the cost to linear in the depth; but since the computation itself is already exponential in the depth, perhaps an extra quadratic cost is small enough already.</p>\n\n<p><strong>What's going on with <code>withApplicative</code>?</strong></p>\n\n<p>Okay, we've got a <code>Vector n t</code> in our hands. Now, we carefully set up <code>Vector</code> so that it only accepts <code>Nat</code>-kinded values of <code>n</code>, and we smart programmers know that a <code>Nat</code> is some longish sequence of applications of <code>N</code>s to a final <code>Z</code>. But the compiler doesn't know that*, it just knows that it has some type <code>n</code> of kind <code>Nat</code>. Consequently, since it doesn't know it's a bunch of <code>N</code>s applied to <code>Z</code>, it doesn't know how to build up an <code>Applicative</code> instance -- since all the <code>Applicative</code> instances for <code>Vector</code> demand that the <code>Nat</code> argument to <code>Vector</code> be visibly either a <code>Z</code> or an <code>N _</code>. The type variable <code>n</code> is neither of these. This is the problem we are setting out to solve.</p>\n\n<p>Or, you can take this alternative description of the problem: even if we tell the compiler that we have an <code>Applicative</code> instance for <code>Vector n</code>, as soon as we discover that <code>n ~ N n'</code> (say, by pattern-matching on the <code>Vector</code> and seeing that it's got a <code>V</code> constructor at its head), we are back to square one on the recursive call, because we haven't told the compiler that we have an <code>Applicative</code> instance for <code>Vector n'</code>. So an alternative way of thinking of the solution is that we'd like to have some way of saying that if we've got an <code>Applicative</code> instance for <code>Vector n</code>, we must have had an <code>Applicative</code> instance for all the predecessors of <code>n</code> (all the \"smaller\" <code>Nat</code>s).</p>\n\n<p>But wait! We have a trick up our sleeves. We've stored away some information in our <code>Vector</code> that, through pattern matching, lets us figure out <em>exactly</em> what <code>Nat</code> that <code>n</code> variable is! Namely: <code>S _</code> vectors have got <code>n ~ Z</code>, and <code>V _ _</code> vectors have got <code>n ~ N n'</code> (then we must recurse to figure out what <code>n'</code> is). So if we were somehow able to pattern match all the way down to an <code>S</code>, we would have simultaneously caused the type-checker to know the value of <code>n</code> all the way down to a <code>Z</code>. Then it could work its way back up, constructing <code>Applicative</code> instances for <code>Z</code> and then <code>N Z</code> and then <code>N (N Z)</code> and so on all the way back up to the value it now knows for <code>n</code>.</p>\n\n<p>So this is the plan: if we need an <code>Applicative</code> instance to compute a thing, pattern match on applications of <code>V</code> all the way down to an <code>S</code> to learn how many applications of <code>N</code> there are to a <code>Z</code>; then use this knowledge to build the instance.</p>\n\n<p>That's the intuition. Let's get to the mechanics.</p>\n\n<pre><code>withApplicative :: Vector n t -&gt; (Applicative (Vector n) =&gt; a) -&gt; a\n</code></pre>\n\n<p>This type signature says: suppose you need an <code>Applicative</code> instance to compute a thing -- specifically, an <code>a</code> thing. That is, suppose you've got a computation of type <code>Applicative (Vector n) =&gt; a</code>. If you <em>also</em> have a <code>Vector n t</code>, I can pattern match on that <code>Vector</code> to learn the value of <code>n</code> and build you the <code>Applicative</code> instance, so I can give you back an <code>a</code> thing that has already used the <code>Applicative</code> instance and doesn't need it any more. Compare this type:</p>\n\n<pre><code>withFoo :: Foo -&gt; (Foo -&gt; a) -&gt; a\n</code></pre>\n\n<p>\"If you have a thing that depends on a <code>Foo</code>, and a <code>Foo</code>, I can give you the corresponding thing.\" And this type:</p>\n\n<pre><code>withComputedFoo :: Bar -&gt; (Foo -&gt; a) -&gt; a\n</code></pre>\n\n<p>\"If you have a thing that depends on a <code>Foo</code>, I can cook up a <code>Foo</code> to hand it even if you give me a <code>Bar</code> instead.\" (For example, <code>withComputedFoo</code> might contain within it a function of type <code>Bar -&gt; Foo</code> which it applies to the <code>Bar</code> you give it.) And now revisiting our type:</p>\n\n<pre><code>withApplicative :: Vector n t -&gt; (Applicative (Vector n) =&gt; a) -&gt; a\n</code></pre>\n\n<p>\"If you have a thing that depends on an <code>Applicative (Vector n)</code> dictionary, if you hand me a <code>Vector n t</code> I'll cook up the dictionary for you and give you the corresponding thing.\"</p>\n\n<p>Alright, but how does it work?</p>\n\n<pre><code>withApplicative S{} a = a\n</code></pre>\n\n<p>If you handed me a vector whose constructor is <code>S</code>, then I know that <code>n</code> was <code>Z</code>. So now I've learned that whereas before I had <code>a :: Applicative (Vector n) =&gt; a</code>, now I have <code>a :: Applicative (Vector Z) =&gt; a</code>. Since there's an <code>Applicative (Vector Z)</code> instance in the global scope, I can just use that, so I can also give this the type <code>a :: a</code>. Done with this case!</p>\n\n<pre><code>withApplicative (V v _) a = withApplicative v a\n</code></pre>\n\n<p>If you handed me a vector whose constructor is <code>V</code> instead, then I know that <code>n</code> was actually <code>N n'</code> for some <code>n'</code> (and crucially, <code>v :: Vector n' t</code>). So now whereas before I had <code>a :: Applicative (Vector n) =&gt; a</code>, now I have <code>a :: Applicative (Vector (N n')) =&gt; a</code>. Ah! But we have an instance <code>Applicative (Vector n) =&gt; Applicative Vector (N n)</code> in the global scope, so this constraint can be simplified a little bit to just <code>a :: Applicative (Vector n') =&gt; a</code>. Since we have a vector of length <code>n'</code> lying around -- namely, <code>v</code> -- now we can recurse, although notice that the <code>Nat</code>-kinded type in the recursive call has changed! Now we are calling <code>withApplicative</code> with <code>v :: Vector n' t</code> and <code>a :: Applicative (Vector n') =&gt; a</code>, that is, with <code>n</code>'s predecessor, <code>n'</code>.</p>\n\n<p>And that's all she wrote! The recursion takes care of building the dictionary for the predecessor, and we use the globally-available instance for building the slightly larger dictionary for <code>n</code>, and we're on our way.</p>\n\n<p>* The compiler doesn't know it because it isn't, in fact, true. We're lying to ourselves. But it's close enough to true to be a useful mental model.</p>\n\n<p><strong>Answer to a previous version of the question follows.</strong></p>\n\n<p>Your <code>dummy</code> compiles just fine for me if I just leave off the <code>Applicative</code> constraint:</p>\n\n<pre><code>dummy :: Vector n Int -&gt; Vector n Int -&gt; Int\ndummy (S a) (S b)       = a + b\ndummy (V a a') (V b b') = let c  = dummy a b\n                              c' = dummy a' b'\n                          in c + c'\n</code></pre>\n\n<p>(Perhaps you need to make your motivating example a little bit more complicated to really capture what's hard about your problem...?)</p>\n"}], "owner": {"reputation": 113, "user_id": 11514944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d7af49ed3ab1f7184cde90d699269c?s=128&d=identicon&r=PG&f=1", "display_name": "John Poe", "link": "https://stackoverflow.com/users/11514944/john-poe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 56191669, "answer_count": 2, "score": -1, "last_activity_date": 1558577631, "creation_date": 1558110686, "last_edit_date": 1558370280, "question_id": 56190329, "link": "https://stackoverflow.com/questions/56190329/more-applicative-trouble-with-a-vector-type-enforcing-length-2n", "title": "More Applicative trouble with a vector type enforcing length 2^n", "body": "<p>Sorry for the botched up first version of the simplified function, I hope that the updated second version below makes more sense. Sorry also for the non-standard notation, but I didn't/don't care much about the auxiliary type Nat and preferred to save some typing for my \"scalar vectors\" (for my next question I promise to value the sanity of my readers higher, and adapt my code before posting).</p>\n\n<hr>\n\n<p>I'm using the same vector type constrained to have $2^n$ elements as in <a href=\"https://stackoverflow.com/q/56184777/11514944\">my question few hours ago</a>:</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds, FlexibleInstances, FlexibleContexts #-}\n\ndata Nat = Z | N Nat\ndata Vector n t where\n  S :: t -&gt; Vector Z t\n  V :: Vector n t -&gt; Vector n t -&gt; Vector (N n) t\n\ninstance Functor (Vector n) where\n  fmap f (S t ) = S (f t)\n  fmap f (V t t') = V (fmap f t) (fmap f t')\n\ninstance Applicative (Vector Z) where\n  pure = S\n  S f &lt;*&gt; S a = S (f a)\ninstance Applicative (Vector n) =&gt; Applicative (Vector (N n)) where\n  pure a = let a' = pure a in V a' a'\n  V f f' &lt;*&gt; V a a' = V (f &lt;*&gt; a) (f' &lt;*&gt; a')\n\ninstance (Num t, Applicative (Vector n)) =&gt; Num (Vector n t) where\n  v + v' = (+) &lt;$&gt; v &lt;*&gt; v'\n  v * v' = (*) &lt;$&gt; v &lt;*&gt; v'\n  abs = fmap abs\n  signum = fmap signum\n  fromInteger = pure . fromInteger\n  negate = fmap negate\n</code></pre>\n\n<p>Now I failed to implement a quite complex recursive function that I cannot reproduce here, but the essence of my problems can be seen in this much simpler function (that doesn't make much sense, sorry):</p>\n\n<pre><code>dummy :: Applicative (Vector n) =&gt; Vector n Int -&gt; Vector n Int -&gt; Int\ndummy (S a) (S b)       = a + b\ndummy (V a a') (V b b') = dummy (a*b) (a'*b')\n</code></pre>\n\n<p>The error message my compiler (ghci, still Haskell Platform 8.0.2-a on Windows 7) gives me is (slightly shortened):</p>\n\n<pre><code>\u2022 Could not deduce (Applicative (Vector n2))\n    arising from a use of \u2018dummy\u2019\n  from the context: Applicative (Vector n)\n    bound by the type signature for:\n               dummy :: Applicative (Vector n) =&gt;\n                        Vector n Int -&gt; Vector n Int -&gt; Int\n    at ...\n  or from: n ~ 'N n2\n    bound by a pattern with constructor:\n               V :: forall t (n :: Nat).\n                    Vector n t -&gt; Vector n t -&gt; Vector ('N n) t,\n             in an equation for \u2018dummy\u2019\n    at ...\n\u2022 In the expression: dummy (a * b) (a' * b')\n  In an equation for \u2018dummy\u2019:\n      dummy (V a a') (V b b') = dummy (a * b) (a' * b')\n</code></pre>\n\n<p>To me it looks similar to the problem in <a href=\"https://stackoverflow.com/questions/33331925/applicative-instance-of-a-vector-with-kind-nats\">this question</a>.</p>\n\n<p>I tried way around it, by defining separately</p>\n\n<pre><code>dummy :: Applicative (Vector Z) =&gt; Vector n Int -&gt; Vector n Int -&gt; Int\ndummy = ...\n</code></pre>\n\n<p>and</p>\n\n<pre><code>dummy :: Applicative (Vector n) =&gt; Vector (N n) Int -&gt; Vector (N n) Int -&gt; Int\ndummy = ...\n</code></pre>\n\n<p>but then the Compiler complains</p>\n\n<pre><code>...: error:\n  Duplicate type signatures for \u2018dummy\u2019\n  at ...\n</code></pre>\n\n<p>Do I have to define a type class with the only function dummy and then make <code>Vector Z</code> and (Vector (N n)) instances of it?</p>\n\n<pre><code>class Dummy d where\n  dummy :: d -&gt; d -&gt; Int\ninstance Dummy (Vector Z Int) where\n  dummy (S a) (S b) = a + b\ninstance (Applicative (Vector n), Dummy (Vector n Int)) =&gt; Dummy (Vector (N n) Int) where\n  dummy (V a a') (V b b') = dummy (a*b) (a'*b')\n</code></pre>\n\n<p>The compiler takes it, but is there no better way to do it?</p>\n\n<hr>\n\n<p>I guess dfeuer's answer contains a better solution, but I wasn't able to adapt it to my definition of Nat (yet).</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 2, "creation_date": 1558106916, "post_id": 56187890, "comment_id": 99003991, "body": "Close voters: This question isn&#39;t asking for any off-site resources."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1558110385, "post_id": 56187890, "comment_id": 99005473, "body": "@4castle Ask yourself the question this way: there is a huge set of standard libraries, with probably hundreds of thousands of functions in them in toto. Is it useful for StackOverflow to have one question per function on Hackage? I know my answer: a firm and resounding &quot;no&quot;. Not only is it wasted, redundant work, it is <i>less searchable</i> than Hackage itself, because SO does not have a Hoogle-alike."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1558110714, "post_id": 56187890, "comment_id": 99005583, "body": "@DanielWagner I agree, there shouldn&#39;t be a question for every function. That doesn&#39;t mean it&#39;s off-topic. That would be a downvote reason. However, this function is pretty standard, and I remember searching for this function before, not thinking to use the word &quot;prefix&quot;, so I&#39;m not downvoting."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1558101647, "post_id": 56187891, "comment_id": 99001021, "body": "Self-answering an off-topic question doesn&#39;t make it on-topic."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1558101972, "post_id": 56187891, "comment_id": 99001208, "body": "For <code>String</code>s, you can make use of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:isPrefixOf\" rel=\"nofollow noreferrer\"><code>isPrefix :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool</code></a>. This is of course less efficient for large strings."}, {"owner": {"reputation": 24109, "user_id": 775954, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9f5a87db35489d2958945f35b457f1ee?s=128&d=identicon&r=PG", "display_name": "Matthias Braun", "link": "https://stackoverflow.com/users/775954/matthias-braun"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1558102727, "post_id": 56187891, "comment_id": 99001672, "body": "@chepner: It&#39;s about a specific programming problem, that&#39;s why I regarded the question as on-topic."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1558102843, "post_id": 56187891, "comment_id": 99001747, "body": "From <a href=\"https://stackoverflow.com/help/on-topic\">stackoverflow.com/help/on-topic</a>: &quot;Questions asking us to recommend or find a book, tool, software library, tutorial or other off-site resource are off-topic for Stack Overflow as they tend to attract opinionated answers and spam. Instead, describe the problem and what has been done so far to solve it.&quot;"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1558102892, "post_id": 56187891, "comment_id": 99001773, "body": "A specific problem would involve your attempt to <i>write</i> <code>startsWith</code>, not simply ask if such a function already exists."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1558104653, "post_id": 56187891, "comment_id": 99002775, "body": "@chepner This question isn&#39;t looking for off-site resources, and including an attempt to solve the problem in the question isn&#39;t necessary here because it was self-answered, therefore there&#39;s no risk of feeding a help vampire."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1558104847, "post_id": 56187891, "comment_id": 99002873, "body": "@4castle Where on Stack Overflow is Haskell&#39;s <code>text</code> library hosted?"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1558104960, "post_id": 56187891, "comment_id": 99002943, "body": "@chepner Answers are aloud to recommend offsite resources, but questions can&#39;t ask for them."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1558106996, "post_id": 56187891, "comment_id": 99004031, "body": "This is not a good answer, as it unnecessarily restricts the type from <code>String</code> to <code>Text</code>, without any mention of how to convert between the two<code>, the advantages or disadvantages of the two, or a </code>String`-specific solution. The question says &#39;string,&#39; so answer about strings!"}, {"owner": {"reputation": 24109, "user_id": 775954, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9f5a87db35489d2958945f35b457f1ee?s=128&d=identicon&r=PG", "display_name": "Matthias Braun", "link": "https://stackoverflow.com/users/775954/matthias-braun"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1558108230, "post_id": 56187891, "comment_id": 99004568, "body": "@AJFarmar: In a program where you&#39;re already dealing with <code>Text</code>, this is quite useful. And thanks to <code>OverloadedStrings</code> it&#39;s not that much a leap from <code>String</code> to <code>Text</code>. But thankfully, people can add an alternative answer, like <a href=\"https://stackoverflow.com/questions/56187890/check-if-string-starts-with-other-string-in-haskell/56187891#56189586\">chi did</a>."}], "tags": [], "owner": {"reputation": 24109, "user_id": 775954, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9f5a87db35489d2958945f35b457f1ee?s=128&d=identicon&r=PG", "display_name": "Matthias Braun", "link": "https://stackoverflow.com/users/775954/matthias-braun"}, "is_accepted": false, "score": 5, "last_activity_date": 1558101521, "last_edit_date": 1558101521, "creation_date": 1558101191, "answer_id": 56187891, "question_id": 56187890, "link": "https://stackoverflow.com/questions/56187890/check-if-string-starts-with-other-string-in-haskell/56187891#56187891", "title": "Check if string starts with other string in Haskell", "body": "<h1>with <a href=\"https://hackage.haskell.org/package/text-1.2.2.1/docs/Data-Text.html#v:isPrefixOf\" rel=\"noreferrer\"><code>Data.Text</code></a></h1>\n\n<p>You can use <a href=\"https://hackage.haskell.org/package/text-1.2.2.1/docs/Data-Text.html#v:isPrefixOf\" rel=\"noreferrer\"><code>isPrefixOf</code></a> to check whether one string starts with another:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport qualified Data.Text as T\n\nT.isPrefixOf \"(\" \"(test string)\"\n</code></pre>\n\n<p>To include <code>Data.Text</code> in your project, add <code>text</code> as a dependency in your Cabal file:</p>\n\n<pre><code>build-depends:\n    base &gt;=4.7 &amp;&amp; &lt;5\n  , text\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 12, "last_activity_date": 1578160972, "last_edit_date": 1578160972, "creation_date": 1558107336, "answer_id": 56189586, "question_id": 56187890, "link": "https://stackoverflow.com/questions/56187890/check-if-string-starts-with-other-string-in-haskell/56189586#56189586", "title": "Check if string starts with other string in Haskell", "body": "<p>Since strings are lists of characters, we can import <code>Data.List</code> and use the general function <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:isPrefixOf\" rel=\"noreferrer\"><code>isPrefixOf</code></a>:</p>\n\n<pre><code>isPrefixOf :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>Prelude Data.List&gt; isPrefixOf \"abc\" \"abcxyz\"\nTrue\n</code></pre>\n"}], "owner": {"reputation": 24109, "user_id": 775954, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9f5a87db35489d2958945f35b457f1ee?s=128&d=identicon&r=PG", "display_name": "Matthias Braun", "link": "https://stackoverflow.com/users/775954/matthias-braun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2561, "favorite_count": 0, "accepted_answer_id": 56189586, "answer_count": 2, "score": 6, "last_activity_date": 1578160972, "creation_date": 1558101191, "question_id": 56187890, "link": "https://stackoverflow.com/questions/56187890/check-if-string-starts-with-other-string-in-haskell", "title": "Check if string starts with other string in Haskell", "body": "<p>I'd like to know whether my string starts with another string. For example:</p>\n\n<pre><code>startsWith \"(\" \"(test string)\" == True\n</code></pre>\n\n<p>Is there such a function that comes with Haskell?</p>\n"}, {"tags": ["haskell", "io", "conditional-statements", "getline"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1558095720, "creation_date": 1558095720, "answer_id": 56186344, "question_id": 56186181, "link": "https://stackoverflow.com/questions/56186181/converting-user-input-integer-to-conditional-print-statements/56186344#56186344", "title": "Converting user input (Integer) to conditional print statements", "body": "<p>To remove the first warning, replace tabs with spaces.</p>\n\n<p>To fix the error, add <code>num</code> to <code>&lt;=3</code></p>\n\n<pre><code>if num &gt;=1 &amp;&amp; num &lt;=3\n</code></pre>\n\n<p>You will also need to add a <code>putStrLn</code> here:</p>\n\n<pre><code>else putStrLn \"Wrong health range indicated\"\n</code></pre>\n\n<p>Also, you can't use <code>getLine</code> as in <code>getLine &lt;= 7</code>. \nShouldn't that be <code>num</code> instead?\nDo you really want to read another number from the user?</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1558106529, "post_id": 56186446, "comment_id": 99003777, "body": "Prefer <code>readLn</code> to <code>getLine</code>+<code>read</code>: it Does The Right Thing with exceptions when the input can&#39;t be parsed. In this particular case it doesn&#39;t matter, but it&#39;s a good habit to get into."}], "tags": [], "owner": {"reputation": 7207, "user_id": 338846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f1871f7b7f5b4b39d59b72dfbe42b8f5?s=128&d=identicon&r=PG", "display_name": "Alexey Raga", "link": "https://stackoverflow.com/users/338846/alexey-raga"}, "is_accepted": false, "score": 8, "last_activity_date": 1558096055, "creation_date": 1558096055, "answer_id": 56186446, "question_id": 56186181, "link": "https://stackoverflow.com/questions/56186181/converting-user-input-integer-to-conditional-print-statements/56186446#56186446", "title": "Converting user input (Integer) to conditional print statements", "body": "<p>One immediate problem is that you write:</p>\n\n<pre><code>if num &gt;=1 &amp;&amp; &lt;=3\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>if num &gt;=1 &amp;&amp; num &lt;= 3\n</code></pre>\n\n<p>But even then it will not work since the type of <code>num</code> is <code>String</code> (since you use <code>getLine :: IO String</code>, and you cannot compare it with numeric values.</p>\n\n<p>You would need to use something like <code>read</code> to \"read\" the string into a numeric value (note that it'll crash if the string does not represent a numeric value).</p>\n\n<p>Next, expressions like <code>getLine &lt;= 7</code> will not work either, for the same reason: <code>getLine :: IO String</code>, so you cannot compare <code>IO String</code> with a numeric value.</p>\n\n<p>This code will work:</p>\n\n<pre><code>health :: IO ()\nhealth = do\n            putStrLn \"State your health using numbers 1 - 10: \"\n            str &lt;- getLine\n            let num = read str\n            --putStrLn \"Your health is: \"\n            if (num &gt;=1 &amp;&amp; num &lt;=3 )\n               then putStrLn \"Your health is poor\"\n               else if num &gt;=4 &amp;&amp; num &lt;=7\n                  then putStrLn \"Your health is OK\"\n               else if num &gt;=8 &amp;&amp; num &lt;=10\n                  then putStrLn \"your health is fanstastic\"\n                  else putStrLn \"Wrong health range indicated\"\n</code></pre>\n\n<p>However I'd recommend you to look at <code>case</code> expressions or/and <code>MultiWayIf</code> as this may be a better way of writing this code:</p>\n\n<pre><code>health :: IO ()\nhealth = do\n  putStrLn \"State your health using numbers 1 - 10: \"\n  str &lt;- getLine\n  case read str of\n    num | num &gt;= 1 &amp;&amp; num &lt;= 3 -&gt; putStrLn \"Your health is poor\"\n    num | num &gt;= 4 &amp;&amp; num &lt;= 7 -&gt; putStrLn \"Your health is OK\"\n    num | num &gt;= 8 &amp;&amp; num &lt;=10 -&gt; putStrLn \"your health is fanstastic\"\n    _ -&gt; putStrLn \"Wrong health range indicated\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1558097657, "last_edit_date": 1558097657, "creation_date": 1558096813, "answer_id": 56186622, "question_id": 56186181, "link": "https://stackoverflow.com/questions/56186181/converting-user-input-integer-to-conditional-print-statements/56186622#56186622", "title": "Converting user input (Integer) to conditional print statements", "body": "<p>You make some mistakes here, mainly with the types:</p>\n\n<p>The line:</p>\n\n<pre><code>num &lt;- getLine\n</code></pre>\n\n<p>means that <code>num</code> is a <code>String</code>, but you later use it as a number. You probably want to use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:readLn\" rel=\"nofollow noreferrer\"><strong><code>readLn :: Read a =&gt; IO a</code></strong></a>, and probably it is better to specify the type as well:</p>\n\n<pre><code>num &lt;- <b>readLn :: IO Int</b></code></pre>\n\n<p>In your first <code>if</code> cases:</p>\n\n<pre><code>if num &gt;=1 &amp;&amp; &lt;=3\n</code></pre>\n\n<p>Is wrong since it is parsed as <code>(num &gt;= 1) &amp;&amp; (&lt;= 3)</code>. The right operator is thus <em>not</em> a <code>Bool</code>, but an <code>(Num n, Ord n) =&gt; n -&gt; Bool</code>, so a function. A function is not <code>True</code> or <code>False</code>.</p>\n\n<p>You should replace it with:</p>\n\n<pre><code>if num &gt;=1 && <b>num &lt;=3</b></code></pre>\n\n<p>Later you write:</p>\n\n<pre><code>if num &gt;=4 && getLine &lt;=7</code></pre>\n\n<p>but here again the types do not match: <code>getLine</code> has type <code>IO String</code>, so it is not a number, it is even not an <code>IO Int</code>. You probably want to reuse the <code>num</code>, so:</p>\n\n<pre><code>if num &gt;=4 && <b>num</b> &lt;=7</code></pre>\n\n<p>Finally in the <code>else</code> stament, you write:</p>\n\n<pre><code>else <b>\"Wrong health range indicated\"</b></code></pre>\n\n<p>But the type of <code>health</code> is <code>IO ()</code>, not <code>String</code>, you thus should use <code>putStrLn</code>:</p>\n\n<pre><code>else <b>putStrLn</b> \"Wrong health range indicated\"</code></pre>\n\n<p>You can factor the <code>putStrLn</code> out, into:</p>\n\n<pre><code>health :: IO ()\nhealth = do \n    putStrLn \"State your health using numbers 1 - 10: \"\n    num &lt;- <b>readLn :: IO Int</b>\n    --putStrLn \"Your health is: \"\n    <b>putStrLn</b> $\n        if <b>num &lt;= 0 || num &gt; 10</b> then \"Wrong health range indicated\"\n        else if num &lt;= 3 then \"Your health is poor\"\n        else if num &lt;= 7 then \"Your health is OK\"\n        else \"your health is fanstastic\"</code></pre>\n\n<p>The above is still not ideal, since reading a string into an <code>Int</code> can go wrong. So it might help to use <code>readMaybe</code> here to make the program safer.</p>\n"}], "owner": {"reputation": 35, "user_id": 8310684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3bb526557dcc22635761c9d4a058d9a?s=128&d=identicon&r=PG&f=1", "display_name": "Emanuel", "link": "https://stackoverflow.com/users/8310684/emanuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56186622, "answer_count": 3, "score": 1, "last_activity_date": 1579800063, "creation_date": 1558095163, "last_edit_date": 1579800063, "question_id": 56186181, "link": "https://stackoverflow.com/questions/56186181/converting-user-input-integer-to-conditional-print-statements", "title": "Converting user input (Integer) to conditional print statements", "body": "<p>I am trying to get a numeric value from the user (ranging 1-10) and using conditional statements (<code>if number &gt;= 1 &amp;&amp; &lt;=3</code>) print out health status (e.g. <code>putStrLn \"your health is poor\"</code>) but getting error message that I can't go past</p>\n\n<pre><code>health :: IO ()\nhealth = do \n        putStrLn \"State your health using numbers 1 - 10: \"\n        num &lt;- getLine\n        --putStrLn \"Your health is: \"\n        if num &gt;=1 &amp;&amp; &lt;=3\n              then \n               do putStrLn \"Your health is poor\"\n           else if num &gt;=4 &amp;&amp; getLine &lt;=7\n              then putStrLn \"Your health is OK\"\n           else if num &gt;=8 &amp;&amp; getLine&lt;=10\n              then putStrLn \"your health is fanstastic\"\n              else \"Wrong health range indicated\"\n</code></pre>\n\n<p>Error message:</p>\n\n<pre><code>healthCheck.hs:9:1: warning: [-Wtabs]\nTab character found here, and in five further locations.\nPlease use spaces instead.\n|\n9 |                         --putStrLn \"Your health is: \"   | ^^^^^^^^\n\nhealthCheck.hs:10:39: error: parse error on input \u2018&lt;=\u2019\n|\n10 |                         if num &gt;=1 &amp;&amp; &lt;=3    |\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1558090066, "post_id": 56184777, "comment_id": 98994899, "body": "You should write it like <code>instance (Num t, Applicative (Vector n)) =&gt; Num (Vector n t) where</code> since otherwise you can indeed not use <code>(&lt;*&gt;)</code>."}, {"owner": {"reputation": 113, "user_id": 11514944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d7af49ed3ab1f7184cde90d699269c?s=128&d=identicon&r=PG&f=1", "display_name": "John Poe", "link": "https://stackoverflow.com/users/11514944/john-poe"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558095522, "post_id": 56184777, "comment_id": 98997715, "body": "Thanks a lot, I somehow wrongly assumed that the compiler knows that all (Vector n) are Applicatives."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1558108464, "post_id": 56184777, "comment_id": 99004667, "body": "@JohnPoe Counter-intuitively, not all of them are applicatives, for very subtle reasons. If <code>F x :: Nat</code> is a type family which gets &quot;stuck&quot; (say, <code>F Bool</code> is not defined) the compiler is not allowed to resolve, say, <code>Applicative (Vector (F Bool))</code> since it can not evaluate <code>F Bool</code> to a concrete <code>Nat</code>, so it can not choose an instance. It is weird to have type-expressions of kind <code>Nat</code> which do not evaluate to a concrete <code>Nat</code>, but that&#39;s how GHC works."}, {"owner": {"reputation": 113, "user_id": 11514944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d7af49ed3ab1f7184cde90d699269c?s=128&d=identicon&r=PG&f=1", "display_name": "John Poe", "link": "https://stackoverflow.com/users/11514944/john-poe"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1558111561, "post_id": 56184777, "comment_id": 99005900, "body": "@chi: Thank you very much for your explanation, but it might be beyond my current understanding of haskell. Do I understand correctly that the problem is the n in Vector n t, as the compiler has to be able to prove that it is either a Z or N x for a concrete Nat x, which it cannot, as someone might plug in a &quot;weird thing&quot; for n that only &quot;claims&quot; to be a Nat?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1558122092, "post_id": 56184777, "comment_id": 99009932, "body": "@JohnPoe Yes, that&#39;s a nice way to put it. Your instances will be used only when there is an explicit <code>Z</code> or <code>N x</code> in the type. If there is a type variable like <code>n</code> or a &quot;stuck&quot; type family <code>F Bool</code>, GHC does not know what instance to pick and will not resolve the constraint. There are some ways around that, e.g. exploiting suitable GADTs to prove &quot;<code>n</code> is indeed one of the two possible forms&quot; -- this is a bit advanced, however, so I&#39;d recommend to get familiar with GADTs first."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1558090807, "last_edit_date": 1558090807, "creation_date": 1558090322, "answer_id": 56184946, "question_id": 56184777, "link": "https://stackoverflow.com/questions/56184777/how-to-define-a-usable-applicative-instance-for-a-vector-type-enforcing-length-2/56184946#56184946", "title": "How to define a usable Applicative instance for a vector type enforcing length 2^n", "body": "<p>You should add a type constraint in your <code>Num (Vector n t)</code> instance declaration, that specifies that <code>Vector n a</code> is an instance of <code>Applicative</code>, otherwise you can not use <code>(&lt;*&gt;)</code> here.</p>\n\n<p>You thus can fix the problems with:</p>\n\n<pre><code>instance (Num t, <b>Applicative (Vector n)</b>) =&gt; Num (Vector n t) where\n  v + v' = (+) &lt;$&gt; v <b>&lt;*&gt;</b> v'\n  -- ...</code></pre>\n\n<p>We here thus say that <code>Vector n t</code> is an instance of <code>Num</code> given <code>t</code> is an instance of <code>Num</code>, and <code>Vector n</code> is an instance of <code>Applicative</code>.</p>\n\n<p>Since you defined your <code>instance Applicative</code> for your <code>Vector n</code> in such way that it holds for all <code>n</code>s, all <code>Vector n t</code>s are members of <code>Num</code> given <code>Num t</code>, regardless of the value for <code>n</code>, but it needs to be part of the signature of the <code>instance</code> declaration.</p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 11514944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d7af49ed3ab1f7184cde90d699269c?s=128&d=identicon&r=PG&f=1", "display_name": "John Poe", "link": "https://stackoverflow.com/users/11514944/john-poe"}, "edited": false, "score": 0, "creation_date": 1558370602, "post_id": 56190872, "comment_id": 99070718, "body": "Thanks for the answer. I don&#39;t quite see the advantage of the auxiliary class (yet), but I guess if the implementation of &lt;*&gt; or liftA2 was a bit more complex, then the balance would shift also for me."}, {"owner": {"reputation": 113, "user_id": 11514944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d7af49ed3ab1f7184cde90d699269c?s=128&d=identicon&r=PG&f=1", "display_name": "John Poe", "link": "https://stackoverflow.com/users/11514944/john-poe"}, "edited": false, "score": 0, "creation_date": 1558370687, "post_id": 56190872, "comment_id": 99070758, "body": "A question to function vs. method: What&#39;s the difference? Is a function simply something defined on the outer level and a method defined in a where let?"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1558113248, "creation_date": 1558113248, "answer_id": 56190872, "question_id": 56184777, "link": "https://stackoverflow.com/questions/56184777/how-to-define-a-usable-applicative-instance-for-a-vector-type-enforcing-length-2/56190872#56190872", "title": "How to define a usable Applicative instance for a vector type enforcing length 2^n", "body": "<p>I think it's a bit nicer to use an auxiliary class. I also tend to prefer <code>liftA2</code> to <code>&lt;*&gt;</code> for instances, so I'll use that; it's not essential. Note that you only need to differentiate between sizes for <code>pure</code>; the zipping operation doesn't need that. There's a trade-off: if you make the zipping operation a method, then it'll tend to inline, whereas if it's a function it generally won't. This could balance code size against speed when the vectors are small enough. Still, this is how I'd probably do it.</p>\n\n<pre><code>class App' n where\n  pure' :: a -&gt; Vector n a\n\ninstance App' 'Z where\n  pure' = S\n\ninstance App' n =&gt; App' ('N n) where\n  pure' a = let a' = pure' a in V a' a'\n\nliftA2'\n  :: (a -&gt; b -&gt; c)\n  -&gt; Vector n a\n  -&gt; Vector n b\n  -&gt; Vector n c\nliftA2' f = \\xs -&gt; go xs\n  where\n    go (S x) (S y) = S (f x y)\n    go (V l1 r1) (V l2 r2) =\n      V (go l1 l2) (go r1 r2)\n\ninstance App' n =&gt; Applicative (Vector n) where\n  pure = pure'\n  -- import Control.Applicative to get the liftA2 method\n  liftA2 = liftA2'\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 11514944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d7af49ed3ab1f7184cde90d699269c?s=128&d=identicon&r=PG&f=1", "display_name": "John Poe", "link": "https://stackoverflow.com/users/11514944/john-poe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "accepted_answer_id": 56184946, "answer_count": 2, "score": 11, "last_activity_date": 1558113248, "creation_date": 1558089691, "question_id": 56184777, "link": "https://stackoverflow.com/questions/56184777/how-to-define-a-usable-applicative-instance-for-a-vector-type-enforcing-length-2", "title": "How to define a usable Applicative instance for a vector type enforcing length 2^n", "body": "<p>For some application I need vectors of length $2^n$. To enforce that the lengths match for some operations, I defined my type with ist applicative instance as follows:</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds, FlexibleInstances, FlexibleContexts #-}\ndata Nat = Z | N Nat\ndata Vector n t where\n  S :: t -&gt; Vector Z t\n  V :: Vector n t -&gt; Vector n t -&gt; Vector (N n) t\n\ninstance Functor (Vector n) where\n  fmap f (S t ) = S (f t)\n  fmap f (V t t') = V (fmap f t) (fmap f t')\n\ninstance Applicative (Vector Z) where\n  pure = S\n  S f &lt;*&gt; S a = S (f a)\n\ninstance Applicative (Vector n) =&gt; Applicative (Vector (N n)) where\n  pure a = let a' = pure a in V a' a'\n  V f f' &lt;*&gt; V a a' = V (f &lt;*&gt; a) (f' &lt;*&gt; a')\n</code></pre>\n\n<p>The language extensions I chose as suggested by ghci to make the code compile. The whole structure is inspired by <a href=\"https://stackoverflow.com/questions/49206636/how-to-make-fixed-length-vectors-instance-of-applicative\">How to make fixed-length vectors instance of Applicative?</a>.</p>\n\n<p>Trouble starts when I try to use it:</p>\n\n<pre><code>instance Num t =&gt; Num (Vector n t) where\n  v + v' = (+) &lt;$&gt; v &lt;*&gt; v'\n  (*) = undefined\n  abs = undefined\n  signum = undefined\n  fromInteger = undefined\n  negate = undefined\n</code></pre>\n\n<p>Adding these lines Triggers following error:</p>\n\n<p>\u2022 Could not deduce (Applicative (Vector n))\n        arising from a use of \u2018&lt;*>\u2019\n      from the context: Num t\n        bound by the instance declaration at ...</p>\n\n<p>\u2022 In the expression: (+)  v &lt;<em>> v'\n      In an equation for \u2018+\u2019: v + v' = (+)  v &lt;</em>> v'\n      In the instance declaration for \u2018Num (Vector n t)\u2019</p>\n\n<p>I'm using Haskell Platform 8.0.2-a on Windows 7.</p>\n\n<p>Any idea what's going? In the linked question the same trick seems to work!? (Adding KindSignatures in the first line does not help, and without FlexibleInstances/Contexts I get a Compiler error.)</p>\n"}, {"tags": ["haskell", "state-monad"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1558079339, "post_id": 56181862, "comment_id": 98989315, "body": "But here the rsult of your comutation is a <code>String</code>: it is either <code>&quot;bigger than 3&quot;</code>, or <code>&quot;smaller than 3&quot;</code>. That result is already &quot;free&quot; in the sense that the bind function can change the result of each computation. So if you first &quot;return&quot; a string, then the second expression in the bind does not per se needs to be <code>String</code>."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1558079514, "post_id": 56181862, "comment_id": 98989403, "body": "Well i placed that as an example where i supplied a function with both variables fixed.Can i somehow let the result variable free? And define functions afterwards ? <code>Int-&gt;(Int, Bool)</code>, <code>Int-&gt;(Int,Char)</code> etc ? By free i mean a generic type , an <code>a</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1558079598, "post_id": 56181862, "comment_id": 98989458, "body": "given you can make the <code>f</code> free, yes. For example you could generate a function <code>f :: Num n =&gt; Int -&gt; (Int, n)</code> where the response is thus a <code>Num</code> instance, but the specific one is free. It is however a bit &quot;strange&quot; that this could come up with any type."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1558079648, "post_id": 56181862, "comment_id": 98989480, "body": "You are essentially asking to construct a function which can return a value for any possible type. You can only achieve that using infinite recursion or using an exceptional value like <code>undefined</code>. That does not look very useful -- what are you trying to achieve?"}, {"owner": {"reputation": 542, "user_id": 4440871, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/8gHuC.jpg?s=128&g=1", "display_name": "Fabian Schneider", "link": "https://stackoverflow.com/users/4440871/fabian-schneider"}, "edited": false, "score": 1, "creation_date": 1558079731, "post_id": 56181862, "comment_id": 98989512, "body": "Couldn&#39;t you make a new Algebraic DataType or GADT which will be returned by the function (thus fixing the functions return value) but having the possibility of constructing your result depending on the actual return value? (Just a wild thought...)"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1558079839, "post_id": 56181862, "comment_id": 98989572, "body": "I wanted the second variable free since i would want it to be a <code>String</code> or a <code>IO String</code> for example. <b>Scenario1</b> : run the current state get the new state and a log  <code>Int-&gt;(Int,String)</code> . <b>Scenario 2</b> :  get the current state, write something to a file and get the log <code>Int-&gt;(Int,IO String)</code>"}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 1, "creation_date": 1558080197, "post_id": 56181862, "comment_id": 98989737, "body": "How you intend to use <code>makeFree</code>?"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1558080259, "post_id": 56181862, "comment_id": 98989768, "body": "i would just supply it with the desired method.I would define specialized method :  <code>freeFunc::Int-&gt;(Int,IO String)</code> and then i would just call in my required scenario <code>makeFree freeFunc </code>"}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 2, "creation_date": 1558080485, "post_id": 56181862, "comment_id": 98989906, "body": "So <code>makeFree</code> is accepting function as parameter? Then it is easy, just define <code>makeFree = State</code>."}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 3, "last_activity_date": 1558085053, "creation_date": 1558085053, "answer_id": 56183403, "question_id": 56181862, "link": "https://stackoverflow.com/questions/56181862/how-to-supply-generic-type-for-the-state-monads-method/56183403#56183403", "title": "How to supply generic type for the state-monad&#39;s method", "body": "<p>It's not entirely clear what you have in mind, but based on the comments, here's a few suggestions.</p>\n\n<h1>Parametrise the function</h1>\n\n<p>As given, <code>f</code> returns <code>(Int, String)</code>, and you can't just change that. What you can do, however, is to parametrise it:</p>\n\n<pre><code>f' :: a -&gt; a -&gt; Int -&gt; (Int, a)\nf' bigger smaller x | x &gt; 3 = (x, bigger)\n                    | otherwise = (x, smaller)\n</code></pre>\n\n<p>This variation no longer returns <code>(Int, String)</code>, but rather <code>(Int, a)</code>. The price you pay, however, is that you must supply <code>bigger</code> and <code>smaller</code> as arguments. We'll return to that in a moment, but before we do that, we can turn any function with the general type <code>s -&gt; (s, a)</code> into a <code>State s a</code> value:</p>\n\n<pre><code>make' :: (s -&gt; (s, a)) -&gt; State s a\nmake' fn = State fn\n</code></pre>\n\n<p>You can now partially apply <code>f'</code> to vary the type:</p>\n\n<pre><code>*Q56181862&gt; :t make' $ f' \"bigger than 3\" \"smaller than 3\"\nmake' $ f' \"bigger than 3\" \"smaller than 3\" :: State Int [Char]\n*Q56181862&gt; :t make' $ f' True False\nmake' $ f' True False :: State Int Bool\n</code></pre>\n\n<p>In the first of the above GHCi examples, the type is <code>State Int String</code>, whereas the second example has the type <code>State Int Bool</code>.</p>\n\n<h1>Return</h1>\n\n<p>From other comments, it seems that you wish to vary between <code>State Int String</code> and <code>State Int (IO String)</code>. While you can achieve that with the above technique, you can also use <code>return</code> in the function itself:</p>\n\n<pre><code>f'' :: Monad m =&gt; Int -&gt; (Int, m String)\nf'' x | x &gt; 3 = (x, return \"bigger than 3\")\n      | otherwise = (x, return \"smaller than 3\")\n</code></pre>\n\n<p>This varies only the monad, but not the 'return type' <code>String</code>. You can provide enough hints to Haskell's type system to inform it that <code>m</code> should be <code>IO</code>:</p>\n\n<pre><code>*Q56181862&gt; :t make' $ f'' :: State Int (IO String)\nmake' $ f'' :: State Int (IO String) :: State Int (IO String)\n</code></pre>\n\n<p>If you don't want to run the computation in <code>IO</code>, you can instead run it in <code>Identity</code>, which is also a <code>Monad</code>:</p>\n\n<pre><code>*Q56181862 Control.Monad.Identity&gt; :t make' $ f'' :: State Int (Identity String)\nmake' $ f'' :: State Int (Identity String) :: State Int (Identity String)\n</code></pre>\n\n<p>You can now run the computation and pull the <code>String</code> out of <code>Identity</code> using <code>runIdentity</code>.</p>\n\n<h1>Functor</h1>\n\n<p>If you make <code>State s</code> a functor as well, you can pull the <code>String</code> out of <code>Identity</code>:</p>\n\n<pre><code>*Q56181862 Control.Monad.Identity&gt; :t fmap runIdentity $ make' $ f''\nfmap runIdentity $ make' $ f'' :: State Int String\n</code></pre>\n\n<p>The easiest way to do that is to use the <code>DeriveFunctor</code> GHC extension:</p>\n\n<pre><code>newtype State s a = State { runstate :: s -&gt; (s, a) } deriving Functor\n</code></pre>\n\n<p>...or, you could just use <code>Control.Monad.State.Lazy</code> from the <code>mtl</code> package...</p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56183403, "answer_count": 1, "score": 1, "last_activity_date": 1558085111, "creation_date": 1558079064, "last_edit_date": 1558085111, "question_id": 56181862, "link": "https://stackoverflow.com/questions/56181862/how-to-supply-generic-type-for-the-state-monads-method", "title": "How to supply generic type for the state-monad&#39;s method", "body": "<p>I am trying to create a <code>function</code> for the state monad that can receive a generic type in the <code>a</code> : <br> <code>newtype State s a=State { runstate::s-&gt;(s,a) }</code></p>\n\n<p>I want to bind only the first type of the <code>runstate::s-&gt;(s,a)</code> , and later decide what <code>a</code> should be :</p>\n\n<p>So instead of something like :</p>\n\n<pre><code>f::Int-&gt;(Int,String)\nf x | x&gt;3 = (x, \"bigger then 3\")\n    |otherwise =(x,\"smaller then 3\")\n\nmake::State Int String\nmake =State f\n</code></pre>\n\n<p>How can I accomplish :</p>\n\n<pre><code>makeFree::State Int a\nmakeFree=State ....\n</code></pre>\n\n<p>You might be wondering why would I need that. While I know the type of the <code>state</code> i want the result of the computation to vary.</p>\n"}, {"tags": ["haskell", "conduit", "network-conduit"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 11127765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71568a4586fd4c86cc3a92caf421a91d?s=128&d=identicon&r=PG&f=1", "display_name": "mennetorelli", "link": "https://stackoverflow.com/users/11127765/mennetorelli"}, "edited": false, "score": 0, "creation_date": 1558107965, "post_id": 56177584, "comment_id": 99004455, "body": "Thank you very much for the clarification. I have just one more question, what if instead of reading from a file I want to read from user&#39;s input? Shouldn&#39;t be enough to replace <code>runConduitRes $ sourceFile &quot;input.txt&quot;</code> with <code>runConduit $ stdinC</code>? I have the same issue as before..."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 117, "user_id": 11127765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71568a4586fd4c86cc3a92caf421a91d?s=128&d=identicon&r=PG&f=1", "display_name": "mennetorelli", "link": "https://stackoverflow.com/users/11127765/mennetorelli"}, "edited": false, "score": 1, "creation_date": 1558112506, "post_id": 56177584, "comment_id": 99006247, "body": "@mennetorelli Yes, just making that switch in your program is enough. Remember that with stdin, you need to hit Ctrl+D (or Ctrl+Z if on Windows) when you&#39;re done typing, or it will think you might have more to type still. (Alternatively, you could read only a certain number of lines instead of all of stdin and then not have to do that.)"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1560041445, "last_edit_date": 1560041445, "creation_date": 1558047443, "answer_id": 56177584, "question_id": 56177515, "link": "https://stackoverflow.com/questions/56177515/haskell-server-does-not-reply-to-client/56177584#56177584", "title": "Haskell server does not reply to client", "body": "<p>You have a deadlock: the client is waiting for the server to respond before it closes the connection, but the server is unaware that the client is done sending data and is waiting for more. This is basically the problem described at <a href=\"https://cr.yp.to/tcpip/twofd.html\" rel=\"nofollow noreferrer\">https://cr.yp.to/tcpip/twofd.html</a>:</p>\n\n<blockquote>\n  <p>When the <code>generate-data</code> program finishes, the same fd is still open in the <code>consume-data</code> program, so the kernel has no idea that it should send a FIN.</p>\n</blockquote>\n\n<p>In your case, the fix needs to go on the client side. You need to call <a href=\"https://hackage.haskell.org/package/network-3.1.0.0/docs/Network-Socket.html#v:shutdown\" rel=\"nofollow noreferrer\"><code>shutdown</code></a> with <a href=\"https://hackage.haskell.org/package/network-3.1.0.0/docs/Network-Socket.html#t:ShutdownCmd\" rel=\"nofollow noreferrer\"><code>ShutdownSend</code></a> on the socket once <code>conduit</code> is done sending the contents of input.txt over it.</p>\n\n<p>Here's one way to do so (I'm not sure if there's a nicer one):</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Control.Concurrent.Async (concurrently)\nimport Data.Functor (void)\nimport Data.Foldable (traverse_)\n\nimport Conduit\nimport Data.Conduit.Network\n\nimport Data.Streaming.Network (appRawSocket)\nimport Network.Socket (shutdown, ShutdownCmd(..))\n\nmain = runTCPClient (clientSettings 4000 \"localhost\") $ \\server -&gt;\n    void $ concurrently\n        ((runConduitRes $ sourceFile \"input.txt\" .| appSink server) &gt;&gt; doneWriting server)\n        (runConduit $ appSource server .| stdoutC)\n\ndoneWriting = traverse_ (`shutdown` ShutdownSend) . appRawSocket\n</code></pre>\n\n<p>Side note: you don't really need concurrency in the client in this case, since there will never be anything to read from the server until you're done writing to the server. You could just do the reading after the writing and shutdown.</p>\n"}], "owner": {"reputation": 117, "user_id": 11127765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71568a4586fd4c86cc3a92caf421a91d?s=128&d=identicon&r=PG&f=1", "display_name": "mennetorelli", "link": "https://stackoverflow.com/users/11127765/mennetorelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 1, "accepted_answer_id": 56177584, "answer_count": 1, "score": 3, "last_activity_date": 1560041445, "creation_date": 1558046890, "last_edit_date": 1558061544, "question_id": 56177515, "link": "https://stackoverflow.com/questions/56177515/haskell-server-does-not-reply-to-client", "title": "Haskell server does not reply to client", "body": "<p>I tried building a simple client-server program following <a href=\"https://www.yesodweb.com/blog/2014/03/network-conduit-async\" rel=\"nofollow noreferrer\">this tutorial</a> about Haskell's network-conduit library.</p>\n\n<p>This is the client, which concurrently sends a file to the server and receives the answer:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Control.Concurrent.Async (concurrently)\nimport Data.Functor (void)\n\nimport Conduit\nimport Data.Conduit.Network\n\nmain = runTCPClient (clientSettings 4000 \"localhost\") $ \\server -&gt;\n    void $ concurrently\n        (runConduitRes $ sourceFile \"input.txt\" .| appSink server)\n        (runConduit $ appSource server .| stdoutC)\n</code></pre>\n\n<p>And this is the server, which counts the occurrences of each word and sends the result back to the client:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Data.ByteString.Char8 (pack)\nimport Data.Foldable (toList)\nimport Data.HashMap.Lazy (empty, insertWith)\nimport Data.Word8 (isAlphaNum)\n\nimport Conduit\nimport Data.Conduit.Network\nimport qualified Data.Conduit.Combinators as CC\n\nmain = runTCPServer (serverSettings 4000 \"*\") $ \\appData -&gt; do\n    hashMap &lt;- runConduit $ appSource appData \n        .| CC.splitOnUnboundedE (not . isAlphaNum)\n        .| foldMC insertInHashMap empty\n    runConduit $ yield (pack $ show $ toList hashMap)\n        .| iterMC print\n        .| appSink appData\n\ninsertInHashMap x v = do\n    return (insertWith (+) v 1 x)\n</code></pre>\n\n<p>The problem is that the server doesn't reach the yield phase until I manually shut down the client and therefore never answers to it. I noticed that removing the concurrency from the client and keeping only the part in which it sends data to the server, everything works fine.</p>\n\n<p>So, how can I preserve the receiving part of the client without breaking the flow?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 11441910, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280162792027047/picture?type=large", "display_name": "Adrian Kozie\u0144", "link": "https://stackoverflow.com/users/11441910/adrian-kozie%c5%84"}, "edited": false, "score": 0, "creation_date": 1558633983, "post_id": 56175687, "comment_id": 99175115, "body": "Thanks for your&#39;s response. I understand everything but i still have got problem with priting function in my menu;/  When I add &quot;print updatedStudents program stops..&quot; Can you write whole statement?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 39, "user_id": 11441910, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280162792027047/picture?type=large", "display_name": "Adrian Kozie\u0144", "link": "https://stackoverflow.com/users/11441910/adrian-kozie%c5%84"}, "edited": false, "score": 0, "creation_date": 1558634981, "post_id": 56175687, "comment_id": 99175520, "body": "@AdrianKozie\u0144: did you by any chance removed the <code>menu updatedStudents</code>?"}, {"owner": {"reputation": 39, "user_id": 11441910, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280162792027047/picture?type=large", "display_name": "Adrian Kozie\u0144", "link": "https://stackoverflow.com/users/11441910/adrian-kozie%c5%84"}, "edited": false, "score": 0, "creation_date": 1558636942, "post_id": 56175687, "comment_id": 99176324, "body": "I edited my post, now there is my last version, but still doesn&#39;t work properly"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 39, "user_id": 11441910, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280162792027047/picture?type=large", "display_name": "Adrian Kozie\u0144", "link": "https://stackoverflow.com/users/11441910/adrian-kozie%c5%84"}, "edited": false, "score": 0, "creation_date": 1558637041, "post_id": 56175687, "comment_id": 99176366, "body": "@AdrianKozie\u0144: shouldn&#39;t the <code>do</code> block of your <code>showStudent</code> be <i>indented</i>?"}, {"owner": {"reputation": 39, "user_id": 11441910, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280162792027047/picture?type=large", "display_name": "Adrian Kozie\u0144", "link": "https://stackoverflow.com/users/11441910/adrian-kozie%c5%84"}, "edited": false, "score": 0, "creation_date": 1558637218, "post_id": 56175687, "comment_id": 99176437, "body": "Yes, of course. I forgot about it while i was writing post."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 39, "user_id": 11441910, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280162792027047/picture?type=large", "display_name": "Adrian Kozie\u0144", "link": "https://stackoverflow.com/users/11441910/adrian-kozie%c5%84"}, "edited": false, "score": 0, "creation_date": 1558637668, "post_id": 56175687, "comment_id": 99176644, "body": "@AdrianKozie\u0144: When I run your program, it works properly, I get responses for <code>showstudent</code> like <code>fromList []</code>, <code>fromList [(&quot;1234&quot;,Student {name = &quot;Adrian&quot;, age = 21, id = &quot;1234&quot;})]</code>, etc."}, {"owner": {"reputation": 39, "user_id": 11441910, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280162792027047/picture?type=large", "display_name": "Adrian Kozie\u0144", "link": "https://stackoverflow.com/users/11441910/adrian-kozie%c5%84"}, "edited": false, "score": 0, "creation_date": 1558637910, "post_id": 56175687, "comment_id": 99176757, "body": "<a href=\"http://uploadfile.pl/pokaz/1754075---jtxt.html\" rel=\"nofollow noreferrer\">uploadfile.pl/pokaz/1754075---jtxt.html</a>   here is my program and screenshot with error"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 39, "user_id": 11441910, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280162792027047/picture?type=large", "display_name": "Adrian Kozie\u0144", "link": "https://stackoverflow.com/users/11441910/adrian-kozie%c5%84"}, "edited": false, "score": 0, "creation_date": 1558638609, "post_id": 56175687, "comment_id": 99177046, "body": "@AdrianKozie\u0144: you used a tab for the <code>return</code>, but four spaces for the <code>print students</code>, hence the compiler got confused."}, {"owner": {"reputation": 39, "user_id": 11441910, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280162792027047/picture?type=large", "display_name": "Adrian Kozie\u0144", "link": "https://stackoverflow.com/users/11441910/adrian-kozie%c5%84"}, "edited": false, "score": 0, "creation_date": 1558639000, "post_id": 56175687, "comment_id": 99177209, "body": "Thanks for response, now there is no errors but program doesn&#39;t work corretly. The situation is: first of all i start program by writing &quot;main&quot;, then i choose option 1 (addstudent) - this is correct and then program is going back to the menu . now i&#39;m trying to choose option 2 (show student) and it stucks"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 39, "user_id": 11441910, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280162792027047/picture?type=large", "display_name": "Adrian Kozie\u0144", "link": "https://stackoverflow.com/users/11441910/adrian-kozie%c5%84"}, "edited": false, "score": 0, "creation_date": 1558639280, "post_id": 56175687, "comment_id": 99177342, "body": "@AdrianKozie\u0144: are you sure it did not print the dictionary and rendered the menu again? It is printed on a single line, just above the menu, and after one student, it looks almost exactly as the <code>Student {...}</code> record, except for the <code>fromList [ ... ]</code>. Here it simply returns to the menu, and thus one can print again, or add an extra student."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 39, "user_id": 11441910, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280162792027047/picture?type=large", "display_name": "Adrian Kozie\u0144", "link": "https://stackoverflow.com/users/11441910/adrian-kozie%c5%84"}, "edited": false, "score": 0, "creation_date": 1558641514, "post_id": 56175687, "comment_id": 99178214, "body": "@AdrianKozie\u0144: what if you hit enter after that, looks like a buffering problem in the Windows command line :s."}, {"owner": {"reputation": 39, "user_id": 11441910, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280162792027047/picture?type=large", "display_name": "Adrian Kozie\u0144", "link": "https://stackoverflow.com/users/11441910/adrian-kozie%c5%84"}, "edited": false, "score": 0, "creation_date": 1558641789, "post_id": 56175687, "comment_id": 99178325, "body": "no reaction, additionally ctrl+z, ctrl+d, ctrl+c don&#39;t work too and the only solution is to close window by &#39;X&#39; button..."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 39, "user_id": 11441910, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280162792027047/picture?type=large", "display_name": "Adrian Kozie\u0144", "link": "https://stackoverflow.com/users/11441910/adrian-kozie%c5%84"}, "edited": false, "score": 0, "creation_date": 1558642012, "post_id": 56175687, "comment_id": 99178414, "body": "@AdrianKozie\u0144: the trouble is that I can not reproduce your problem. I&#39;ve used the code file in the zip file (well fixed the spacing issue), and then I manage to run it properly."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1558038499, "last_edit_date": 1558038499, "creation_date": 1558036232, "answer_id": 56175687, "question_id": 56175621, "link": "https://stackoverflow.com/questions/56175621/how-to-display-hashmap-in-haskell/56175687#56175687", "title": "How to display hashmap in Haskell", "body": "<p>Given that the keys <code>k</code> and the values <code>v</code> are instances of <code>Show</code>, then a <code>HashMap</code> is an instance of <code>Show</code> as well. Indeed in the <a href=\"https://hackage.haskell.org/package/unordered-containers-0.2.10.0/docs/src/Data.HashMap.Base.html#line-264\" rel=\"nofollow noreferrer\">source code, we see</a>:</p>\n\n<blockquote><pre><code><b>instance (Show k, Show v) =&gt; Show (HashMap k v)</b> where\n    showsPrec d m = showParen (d &gt; 10) $\n      showString &quot;fromList &quot; . shows (toList m)</code></pre></blockquote>\n\n<p>So we can use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:print\" rel=\"nofollow noreferrer\"><strong><code>print :: Show a =&gt; a -&gt; IO ()</code></strong></a> here to print the content of the <code>HashMap</code>. Like:</p>\n\n<pre><code>Prelude Data.HashMap.Strict&gt; print (fromList [(\"id001\", Student \"Foo\" 21 \"id001\"), (\"id003\", Student \"Bar\" 19 \"id003\")])\nfromList [(\"id003\",Student {name = \"Bar\", age = 19, id = \"id003\"}),(\"id001\",Student {name = \"Foo\", age = 21, id = \"id001\"})]\n</code></pre>\n\n<p>So here <code>print</code> contains as argument a <code>HashMap String Student</code> we constructed, and this will print the content of the dictionary.</p>\n\n<p>You can make use of <a href=\"https://hackage.haskell.org/package/unordered-containers-0.2.10.0/docs/Data-HashMap-Strict.html#v:toList\" rel=\"nofollow noreferrer\"><strong><code>ToList :: HashMap k v -&gt; [(k, v)]</code></strong></a> as well to convert your <code>HashMap k v</code> into a list of key-value tuples, and then thus show the values with some extra functions.</p>\n\n<p>For example we can print every value (here <code>Student</code>) on a separate line with:</p>\n\n<pre><code>mapM_ (print . snd) (toList myhashmap)\n</code></pre>\n\n<p>In your menu you can thus write:</p>\n\n<pre><code>menu :: Students -&gt; IO ()\nmenu students = do\n    putStrLn &quot;1. Add new student&quot;\n    putStrLn &quot;2. Show all students&quot;\n    putStrLn &quot;3. Delete Student by ID&quot;\n    putStrLn &quot;4. Exit program&quot;\n    choice &lt;- getLine\n    updatedStudents &lt;- case choice of\n        &quot;1&quot; -&gt; addStudent students\n        --&quot;2&quot; -&gt; showstudent\n        &quot;3&quot; -&gt; deleteStudent students\n        &quot;4&quot; -&gt; exitSuccess --System.Exit.exitSuccess (zwraca typ IO students)\n    <b>print updatedStudents</b>\n    menu updatedStudents</code></pre>\n\n<blockquote>\n  <p><strong>Advise</strong>: In your current program, you constantly use <code>do</code> blocks. Typically in a Haskell program, you write the logic that does not require <code>IO</code>, a <code>State</code>, etc. separately in functions that do a small number of things.</p>\n</blockquote>\n"}], "owner": {"reputation": 39, "user_id": 11441910, "user_type": "registered", "profile_image": "https://graph.facebook.com/2280162792027047/picture?type=large", "display_name": "Adrian Kozie\u0144", "link": "https://stackoverflow.com/users/11441910/adrian-kozie%c5%84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558637190, "creation_date": 1558035869, "last_edit_date": 1558637190, "question_id": 56175621, "link": "https://stackoverflow.com/questions/56175621/how-to-display-hashmap-in-haskell", "title": "How to display hashmap in Haskell", "body": "<p>my task is to create menu with four choices:\n-add new students\n-show all students,\n-delete students by ID\n-close program.\nI used Hashmap for this problem, but the problem is that i have no idea how to display a current list of created students.</p>\n\n<p>My code is presented below:</p>\n\n<pre><code>{module StudentApp where\nimport Data.HashMap.Strict\nimport System.Exit (exitSuccess)\ndata Student = Student {name::String, age::Int, id::String}\n  deriving (Show, Eq, Read)\n\ntype Students = HashMap String Student\n\naddStudent:: Students -&gt; IO(Students)\naddStudent students = do\n    putStrLn (\"Student Name\")\n    name&lt;-getLine\n    putStrLn(\"Student Age\")\n    age&lt;-readLn :: IO Int\n    putStrLn(\"Student ID\")\n    id&lt;-getLine\n    let s = Student name age id\n    let updatedStudents = insert id s students\n    return updatedStudents\n\nshowStudent:: Students -&gt; IO (Students)\nshowStudent students = do\n    print students  \n    return students\n\n\ndeleteStudent:: Students -&gt; IO (Students)\ndeleteStudent students = do\n    putStrLn (\"Give student ID to remove\")\n    id&lt;-getLine\n    let updatedStudents = delete id students\n    return updatedStudents\n\n\nmenu :: Students -&gt; IO ()\nmenu students = do\n    putStrLn (\"1. Add new student\")\n    putStrLn (\"2. Show all students\")\n    putStrLn (\"3. Delete Student by ID\")\n    putStrLn (\"4. Exit program\")\n    choice&lt;-getLine\n    updatedStudents &lt;- case choice of\n        \"1\" -&gt; addStudent students\n        \"2\" -&gt; showStudent students\n        \"3\" -&gt; deleteStudent students\n        \"4\" -&gt; exitSuccess --System.Exit.exitSuccess (zwraca typ IO students)    \n    menu updatedStudents\nmain :: IO ()\nmain = do\n    let students = empty :: Students\n    menu students\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["haskell", "haskell-prelude"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1558015881, "post_id": 56170462, "comment_id": 98967638, "body": "Well... what&#39;s in your puzzle input file?"}, {"owner": {"reputation": 11, "user_id": 11431941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rXfNfxXxbr8/AAAAAAAAAAI/AAAAAAAAEIg/en-olfRljyA/photo.jpg?sz=128", "display_name": "\u0141ukasz Niewi\u0144ski", "link": "https://stackoverflow.com/users/11431941/%c5%81ukasz-niewi%c5%84ski"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1558015955, "post_id": 56170462, "comment_id": 98967680, "body": "Thank you for reminding me about this! In my input files I have two long lists that covers Board edge data type: [[(Field, Int)]].   it goes something like: [[[(Black,2),(Yellow,2),(Black,1)],[(Black,2),(Yellow,1),(Bl&zwnj;&#8203;ack,3)]] [[[(Black,2),(Yellow,2),(Black,1)],[(Black,2),(Yellow,1),(Bl&zwnj;&#8203;ack,3)]]"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1558016455, "post_id": 56170462, "comment_id": 98967990, "body": "Here&#39;s a hint: open GHCi and try to <code>show</code> some of your data structure. What you see is the format that the automatically derived <code>read</code> will expect."}, {"owner": {"reputation": 11, "user_id": 11431941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rXfNfxXxbr8/AAAAAAAAAAI/AAAAAAAAEIg/en-olfRljyA/photo.jpg?sz=128", "display_name": "\u0141ukasz Niewi\u0144ski", "link": "https://stackoverflow.com/users/11431941/%c5%81ukasz-niewi%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1558017623, "post_id": 56170462, "comment_id": 98968748, "body": "So I tried to do it now, for &#39;show Field&#39; it says &quot;data constructor not in scope: Field :: ()&quot; and for &#39;show B.BoardEdge&#39; it says that &quot;No instance for (Show ([[(B.Field, Int)]] -&gt; B.BoardEdge))&quot;. Making an Instance could solve my problem?"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1558021316, "post_id": 56170462, "comment_id": 98970945, "body": "@\u0141ukaszNiewi\u0144ski You can only <code>show</code> a &quot;complete&quot; value of your data type. A <code>BoardEdge</code> needs a <code>colRow</code> for instance."}, {"owner": {"reputation": 11, "user_id": 11431941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rXfNfxXxbr8/AAAAAAAAAAI/AAAAAAAAEIg/en-olfRljyA/photo.jpg?sz=128", "display_name": "\u0141ukasz Niewi\u0144ski", "link": "https://stackoverflow.com/users/11431941/%c5%81ukasz-niewi%c5%84ski"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1558028008, "post_id": 56170462, "comment_id": 98974226, "body": "@Cubic thank you for your response. So I did something like &quot;let edge1 = BoardEdge [[(Black,2),(Yellow,2),(Black,1)],[(Black,2),(Yellow,1),(Bla&zwnj;&#8203;ck,3)]]&quot; and than I did &quot;show edge1&quot;. Is it what you had in your mind? If not I&#39;m sorry, Im quite new to Haskell."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11431941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rXfNfxXxbr8/AAAAAAAAAAI/AAAAAAAAEIg/en-olfRljyA/photo.jpg?sz=128", "display_name": "\u0141ukasz Niewi\u0144ski", "link": "https://stackoverflow.com/users/11431941/%c5%81ukasz-niewi%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1558032237, "post_id": 56174481, "comment_id": 98976198, "body": "Man, thank you so much!! You exactly showed me what I was missing. I didn&#39;t think of using &quot;BoardEdge {colRow = [.....]}&quot;. Your comparison was brilliant, thank you! :)"}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 1, "last_activity_date": 1558032912, "last_edit_date": 1558032912, "creation_date": 1558030773, "answer_id": 56174481, "question_id": 56170462, "link": "https://stackoverflow.com/questions/56170462/prelude-read-no-parse-own-data-type/56174481#56174481", "title": "&quot;Prelude.read: no parse&quot;, own data type", "body": "<p>Gluing together your own code snippets and Fyodor's comment:</p>\n\n<pre><code>Prelude&gt; data Field = Empty | Black | Yellow deriving (Eq, Ord, Enum, Show, Read)\nPrelude&gt; data BoardEdge = BoardEdge { colRow :: [[(Field, Int)]]} deriving (Read, Eq, Ord, Show)\nPrelude&gt; let edge1 = BoardEdge [[(Black,2),(Yellow,2),(Black,1)],[(Black,2),(Yellow,1),(Black,3)]]\nPrelude&gt; show edge1\n\"BoardEdge {colRow = [[(Black,2),(Yellow,2),(Black,1)],[(Black,2),(Yellow,1),(Black,3)]]}\"\nPrelude&gt; let correctInput = it -- ^^ the above\n</code></pre>\n\n<p>So now we know what <code>read</code> expects, which is what <code>show</code> produced.  How does this compare with what you used as the input?</p>\n\n<pre><code>Prelude&gt; let myInput =     \"[[(Black,2),(Yellow,2),(Black,1)],[(Black,2),(Yellow,1),(Black,3)]]\"\nPrelude&gt; correctInput == myInput\nFalse\n</code></pre>\n\n<p>Or less snarky: If you want default <code>read</code> instances to parse your input then your input must be correct Haskell code with data constructors and all.  In this case using <code>BoardEdge</code> was needed.</p>\n"}], "owner": {"reputation": 11, "user_id": 11431941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rXfNfxXxbr8/AAAAAAAAAAI/AAAAAAAAEIg/en-olfRljyA/photo.jpg?sz=128", "display_name": "\u0141ukasz Niewi\u0144ski", "link": "https://stackoverflow.com/users/11431941/%c5%81ukasz-niewi%c5%84ski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 56174481, "answer_count": 1, "score": 0, "last_activity_date": 1558032912, "creation_date": 1558015487, "last_edit_date": 1558016138, "question_id": 56170462, "link": "https://stackoverflow.com/questions/56170462/prelude-read-no-parse-own-data-type", "title": "&quot;Prelude.read: no parse&quot;, own data type", "body": "<p>I'm trying to read from file two lists of own data type 'BoardEdge'. When I try to run code I get exception: </p>\n\n<blockquote>\n  <p>\"Main.hs: Prelude.read: no parse\"</p>\n</blockquote>\n\n<p>As I suspect I get this on function responsible for validatation of input (validateInput). When I try this function in ghci inserting two BoardEdge 'objects' it works well and gives True. </p>\n\n<p>Can anyone provide me with advice what am I doing wrong and how can I solve the problem?  </p>\n\n<p>Data types:</p>\n\n<pre><code>data Field = Empty | Black | Yellow deriving (Eq, Ord, Enum, Show, Read)\n\ndata BoardEdge = BoardEdge { colRow :: [[(Field, Int)]]} deriving (Read, Eq, Ord, Show) \n</code></pre>\n\n<p>Main.hs</p>\n\n<pre><code>    main :: IO()\n    main = do\n      args &lt;- getArgs\n      input &lt;- loadInput args\n      putStrLn \"Puzzle input loaded:\"\n      putStrLn input\n      let parsedInput = parseInput input\n      if (validateInput parsedInput)\n        then putStrLn \"Input is valid.\"\n        else error \"Input invalid!\"\n\n    -- asks for path and reads input file\n    loadInput :: [String] -&gt; IO String\n    loadInput [] =  getPath &gt;&gt;= readFile where\n      getPath = do\n        putStrLn \"Provide path to puzzle input file:\"\n        getLine\n    loadDefinition (a:_) = readFile a\n\n\n    -- get valid data from input file\n    parseInput :: String -&gt; (B.BoardEdge,B.BoardEdge)\n    parseInput d = parseInput' $ lines d where\n      parseInput' (columns: rows :_) =\n        (read columns, read rows)\n</code></pre>\n\n<p>Valdiation function in Board.hs imported qualified as B:</p>\n\n<pre><code>    validateInput :: (B.BoardEdge,B.BoardEdge) -&gt; Bool\n    validateInput (columns, rows) = rowColEq where\n      rowColEq = countBlocks columns == countBlocks rows\n\n\n    -- function that counts total quantity of colored blocks\n    countBlocks :: (B.BoardEdge)-&gt; Int\n    countBlocks (B.BoardEdge colRow) = countBlocks' $ concat colRow where\n      countBlocks' [] = 0\n      countBlocks' (x:xs) = snd x + countBlocks' xs\n</code></pre>\n\n<p>And my input files are like this:</p>\n\n<pre><code>    [[(Black,2),(Yellow,2),(Black,1)],[(Black,2),(Yellow,1),(Black,3)]]\n    [[(Black,5)],[(Black,2),(Black,1)],[(Black,2),(Black,2)],[(Black,1),(Black,2)]]\n</code></pre>\n"}, {"tags": ["list", "haskell", "monads"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1558007675, "post_id": 56167585, "comment_id": 98962434, "body": "Yes, <code>[1,2,3] &gt;&gt;= (\\x -&gt; return x)</code> is correct in your edit."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1558009577, "post_id": 56167585, "comment_id": 98963535, "body": "Or simply <code>[1,2,3] &gt;&gt;= return</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1558011143, "post_id": 56167585, "comment_id": 98964557, "body": "Which is simply <code>[1,2,3]</code>, by the Monad laws."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1558006857, "last_edit_date": 1558006857, "creation_date": 1558006540, "answer_id": 56167661, "question_id": 56167585, "link": "https://stackoverflow.com/questions/56167585/why-does-the-list-monad-work-when-no-function-is-provided/56167661#56167661", "title": "Why does the list monad work when no function is provided", "body": "<pre><code>do\na &lt;- [1,2,3]\nb &lt;- [\"a\",\"b\"]\nreturn (a,b)\n</code></pre>\n\n<p>is translated to</p>\n\n<pre><code>[1,2,3] &gt;&gt;= (\\a -&gt; do\n  b &lt;- [\"a\",\"b\"]\n  return (a,b) )\n</code></pre>\n\n<p>which is translated to</p>\n\n<pre><code>[1,2,3] &gt;&gt;= (\\a -&gt;\n  [\"a\",\"b\"] &gt;&gt;= (\\b -&gt;\n     return (a,b) ))\n</code></pre>\n\n<p>Essentially the <code>f</code> function in <code>ml &gt;&gt;= f</code> is \"the rest of the <code>do</code> block\". There is no standalone translation for <code>a &lt;- [1,2,3]</code>, only one within its <code>do</code> block.</p>\n\n<p>You can try to simplify the expression above until you get</p>\n\n<pre><code>[1,2,3] &gt;&gt;= (\\a -&gt;\n  [\"a\",\"b\"] &gt;&gt;= (\\b -&gt;\n     [(a,b)] ))\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>[1,2,3] &gt;&gt;= (\\a -&gt;\n  [(a, \"a\"), (a, \"b\")])\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>[(1, \"a\"), (1, \"b\"), (2, \"a\"), (2, \"b\"), (3, \"a\"), (3, \"b\")]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 7, "last_activity_date": 1558007884, "last_edit_date": 1558007884, "creation_date": 1558006718, "answer_id": 56167712, "question_id": 56167585, "link": "https://stackoverflow.com/questions/56167585/why-does-the-list-monad-work-when-no-function-is-provided/56167712#56167712", "title": "Why does the list monad work when no function is provided", "body": "<p>You <em>do</em> provide a function to the bind function. If we <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-470003.14\" rel=\"nofollow noreferrer\"><em>desugar</em> the <code>do</code> notation [Haskell'10 report]</a>, we get:</p>\n\n<pre><code>[1,2,3] &gt;&gt;= (\\a -&gt; [&quot;a&quot;, &quot;b&quot;] >>= (\\b -&gt; return (a, b)))</code></pre>\n\n<p>So that means that we here basically get:</p>\n\n<pre><code>concatMap (\\a -&gt; [&quot;a&quot;, &quot;b&quot;] >>= (\\b -&gt; return (a, b))) [1,2,3]</code></pre>\n\n<p>a\nand thus:</p>\n\n<pre><code>concatMap (\\a -&gt; concatMap (\\b -&gt; [(a, b)]) [&quot;a&quot;, &quot;b&quot;]) [1,2,3]</code></pre>\n\n<p>So we <code>map</code> the <code>[1,2,3]</code> with the given function, and for each element <code>a</code>, we then perform a second <code>concatMap</code> with <code>\\b -&gt; [(a, b)]</code>. A <code>concatMap</code> where each element maps to a singleton element, is equivalent to a <code>map</code>, so:</p>\n\n<pre><code>concatMap (\\a -&gt; map (\\b -&gt; (a, b)) [&quot;a&quot;, &quot;b&quot;]) [1,2,3]</code></pre>\n\n<p>which is equivalent to:</p>\n\n<pre><code>concatMap (\\a -&gt; [(a, &quot;a&quot;), (a, &quot;b&quot;)]) [1,2,3]</code></pre>\n\n<p>and thus:</p>\n\n<pre><code>[(1, &quot;a&quot;), (1, &quot;b&quot;), (2, &quot;a&quot;), (2, &quot;b&quot;), (3, &quot;a&quot;), (3, &quot;b&quot;)]</code></pre>\n\n<p>So the <code>do</code> block behind the curtains results in an expression.</p>\n\n<p><strong>EDIT</strong>: the equivalent of <code>[1,2,3] &gt;&gt;= (\\x -&gt; return x)</code> is:</p>\n\n<pre><code>concatMap (\\x -&gt; [x]) [1,2,3]\n</code></pre>\n\n<p>since <code>(&gt;&gt;=)</code> with the list monad is just <code>flip concatMap</code>, and <code>return</code> is <code>\\x -&gt; [x]</code>. We here thus wrap an element in a list, and then concatenate these lists. This is thus equivalent to:</p>\n\n<pre><code>map id [1,2,3]\n</code></pre>\n\n<p>and thus equivalent to:</p>\n\n<pre><code>[1,2,3]\n</code></pre>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "closed_date": 1558015984, "accepted_answer_id": 56167712, "answer_count": 2, "score": 0, "last_activity_date": 1558007884, "creation_date": 1558006308, "last_edit_date": 1558007068, "question_id": 56167585, "link": "https://stackoverflow.com/questions/56167585/why-does-the-list-monad-work-when-no-function-is-provided", "closed_reason": "Duplicate", "title": "Why does the list monad work when no function is provided", "body": "<p>I am trying to get my head around the list monad when there is no function specified:</p>\n\n<pre><code>func::[(Int,String)]\nfunc =do\n    a &lt;- [1,2,3]\n    b &lt;- [\"a\",\"b\"]\n    return (a,b)\n</code></pre>\n\n<p>I understood that <code>(&gt;&gt;=) ml f=concat (map f ml)</code>.Well in our case what is the value of <code>f</code> ?<br>\nWhen i say :\n<code>a&lt;-[1,2,3]</code> does this get translated to <code>[1,2,3]&gt;&gt;=(\\x-&gt;return x)</code>.\n<br>If not why does it not crash since i am not providing any function for the bind operator?</p>\n\n<p><strong>Later Edit</strong></p>\n\n<p>Thanks for your responses , and while i understood what happens with multiple <code>&gt;&gt;=</code> i am more concerned in this simple scenario:</p>\n\n<pre><code>    mym =do\n     a&lt;-[1,2,3]\n     return a\n</code></pre>\n\n<p>What is the equivalent ?  <code>[1,2,3] &gt;&gt;= (\\x -&gt; return x)</code></p>\n"}, {"tags": ["dictionary", "haskell", "monad-transformers", "state-monad", "st-monad"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 2, "creation_date": 1557994403, "post_id": 56163331, "comment_id": 98954973, "body": "If you want to do lookups that cannot possibly fail how is that different from just having the values you were going to look up?"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 1, "creation_date": 1557994570, "post_id": 56163331, "comment_id": 98955055, "body": "Am I missing something obvious in asking why lookup values that you&#39;ve just inserted, when you must still have access to the value?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1557996200, "post_id": 56163331, "comment_id": 98955936, "body": "The problem here might be that typically one constructs a map to lookup keys for which it is unknown whether these exist. Sure you can lookup <code>one</code> and <code>two</code>, but typically later on you use it with a stream of <code>Int</code>s, and thus the dictionary might fail."}, {"owner": {"reputation": 520, "user_id": 1871467, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8dd0a983cef2c8c9a905a7f42af0ec46?s=128&d=identicon&r=PG", "display_name": "aplainzetakind", "link": "https://stackoverflow.com/users/1871467/aplainzetakind"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1558001456, "post_id": 56163331, "comment_id": 98959009, "body": "How is holding on to <code>Receipt</code>s any different from holding on to the actual values? If you are somehow going to keep track of which <code>Receipt</code>s you will look up, that&#39;s equivalent to keeping track of what the looked-up value would be anyway (as @Cubic observed), so the lookup won&#39;t actually be a lookup in any meaningful sense of the word. I think a straightforward way to remove the unease of using <code>!</code> would be to use <code>ExceptT YourErrorType</code> with a <code>StateT (Map k v)</code> and throw and handle exceptions as you see fit."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 3, "creation_date": 1558017314, "post_id": 56163331, "comment_id": 98968551, "body": "@Cubic It is different because some other chunk of code which I don&#39;t know about could <i>also</i> insert that key later. Now when I go to look up using my receipt, I get their value, not the one I inserted."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1558025034, "post_id": 56163331, "comment_id": 98972793, "body": "Then a simpler solution would be a <code>lookupWithDefault</code> with default being the inserted value you kept track of, though admittedly then you might use more memory than strictly necessary."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1558026321, "post_id": 56163331, "comment_id": 98973378, "body": "One possible motivation for this technique is avoiding ugly <code>Map.!</code> when traversing a graph defined as a map of adjacency lists (<code>Map nodeid [nodeid]</code>)."}, {"owner": {"reputation": 1555, "user_id": 11228628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c463de7cfe16792a210e3531fef5ccb5?s=128&d=identicon&r=PG&f=1", "display_name": "user11228628", "link": "https://stackoverflow.com/users/11228628/user11228628"}, "edited": false, "score": 0, "creation_date": 1558027640, "post_id": 56163331, "comment_id": 98974031, "body": "I&#39;ve edited the question to clarify why a <code>Receipt</code> is better than holding the actual values. There is definitely some wiggle room in this solution space though, so thanks for the suggestions!"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1558062335, "post_id": 56163331, "comment_id": 98984168, "body": "I don&#39;t think there&#39;s any existing implementation that <i>really</i> matches your use case. It just seems rather niche. There&#39;s nothing particularly wrong with your code, is there? All I can suggest is <code>StateT (Map k (STRef s v)) (ST s)</code> as another monad that supports similar operations. You don&#39;t have to do a <code>Map</code> lookup if you already have the <code>STRef</code> for a key, but you lose the ability to fork execution with e.g. <code>ListT</code>, because <code>ST</code> doesn&#39;t generate a well-behaved transformer."}], "answers": [{"comments": [{"owner": {"reputation": 1555, "user_id": 11228628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c463de7cfe16792a210e3531fef5ccb5?s=128&d=identicon&r=PG&f=1", "display_name": "user11228628", "link": "https://stackoverflow.com/users/11228628/user11228628"}, "edited": false, "score": 0, "creation_date": 1558028001, "post_id": 56173231, "comment_id": 98974223, "body": "I like the design; I&#39;m a little concerned about the usability of the continuations (relative to a monad transformer approach). If you have experience with this package, can you speak to how much of a burden it is to work with?"}, {"owner": {"reputation": 1555, "user_id": 11228628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c463de7cfe16792a210e3531fef5ccb5?s=128&d=identicon&r=PG&f=1", "display_name": "user11228628", "link": "https://stackoverflow.com/users/11228628/user11228628"}, "edited": false, "score": 0, "creation_date": 1558028817, "post_id": 56173231, "comment_id": 98974580, "body": "Actually, yeah, the recycling of the keys and the changing of the map&#39;s phantom type does present some difficulties for my use case. I&#39;m repeatedly traversing a data structure until everything settles out, and inserting and looking up keys in the process, and I&#39;m not sure how I&#39;d do that loop if the types of the map and the keys keep changing. Maybe it&#39;s possible though."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 1555, "user_id": 11228628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c463de7cfe16792a210e3531fef5ccb5?s=128&d=identicon&r=PG&f=1", "display_name": "user11228628", "link": "https://stackoverflow.com/users/11228628/user11228628"}, "edited": false, "score": 0, "creation_date": 1558029186, "post_id": 56173231, "comment_id": 98974747, "body": "@user11228628 I haven&#39;t used the library myself."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 3, "last_activity_date": 1558027988, "last_edit_date": 1558027988, "creation_date": 1558025394, "answer_id": 56173231, "question_id": 56163331, "link": "https://stackoverflow.com/questions/56163331/monad-transformer-for-inserts-and-total-lookups-on-a-map/56173231#56173231", "title": "Monad transformer for inserts and total lookups on a Map?", "body": "<p>Your solution resembles the technique used by <a href=\"http://hackage.haskell.org/package/justified-containers\" rel=\"nofollow noreferrer\">justified-containers</a> to guarantee that keys are present in a map. But there are some differences:</p>\n\n<ul>\n<li><p><a href=\"http://hackage.haskell.org/package/justified-containers\" rel=\"nofollow noreferrer\">justified-containers</a> uses continuation-passing-style.</p></li>\n<li><p><a href=\"http://hackage.haskell.org/package/justified-containers-0.3.0.0/docs/Data-Map-Justified.html#v:inserting\" rel=\"nofollow noreferrer\">inserting</a> a new key in <a href=\"http://hackage.haskell.org/package/justified-containers\" rel=\"nofollow noreferrer\">justified-containers</a> requires \"recycling\" existing receipts to work in the updated map. It seems that you don't need to \"recyle\" receipts because you never have multiple versions of the map around at the same time. </p></li>\n<li><a href=\"http://hackage.haskell.org/package/justified-containers\" rel=\"nofollow noreferrer\">justified-containers</a> supports <a href=\"http://hackage.haskell.org/package/justified-containers-0.3.0.0/docs/Data-Map-Justified.html#v:deleting\" rel=\"nofollow noreferrer\">key deletion</a>. I'm not sure if your solution could be expanded to allow the same.</li>\n</ul>\n\n<p>An expanded description of the technique used by <a href=\"http://hackage.haskell.org/package/justified-containers\" rel=\"nofollow noreferrer\">justified-containers</a> can be found in the functional pearl <a href=\"http://kataskeue.com/gdp.pdf\" rel=\"nofollow noreferrer\">\"Ghosts of departed proofs\"</a>.</p>\n"}], "owner": {"reputation": 1555, "user_id": 11228628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c463de7cfe16792a210e3531fef5ccb5?s=128&d=identicon&r=PG&f=1", "display_name": "user11228628", "link": "https://stackoverflow.com/users/11228628/user11228628"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1558027988, "creation_date": 1557992524, "last_edit_date": 1558027578, "question_id": 56163331, "link": "https://stackoverflow.com/questions/56163331/monad-transformer-for-inserts-and-total-lookups-on-a-map", "title": "Monad transformer for inserts and total lookups on a Map?", "body": "<p>I have a computation where I'm inserting values into a <code>Map</code> and then looking them up again. I know that I never use a key before inserting it, but using <code>(!)</code> freely makes me nervous anyway. I'm looking for a way to get a total lookup function that doesn't return a <code>Maybe</code>, and which the type system prevents me from accidentally abusing.</p>\n\n<p>My first thought was to make a monad transformer similar to <code>StateT</code>, where the state is a <code>Map</code> and there are special functions for inserts and lookup in the monad. The insert function returns a <code>Receipt s k</code> newtype, where <code>s</code> is a phantom index type in the style of the <code>ST</code> monad and <code>k</code> is the type of the key, and the lookup function takes a <code>Receipt</code> instead of a bare key. By hiding the <code>Receipt</code> constructor and using a quantified run function similar to <code>runST</code>, this should ensure that lookups only happen after inserts in the same map. (Full code is below.)</p>\n\n<p>But I fear that I've reinvented a wheel, or that that there's an alternate way to get safe, total map lookups that's already in use. Is there any prior art for this problem in a public package somewhere?</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor, LambdaCase, RankNTypes #-}\n\nmodule KeyedStateT (KeyedStateT, Receipt, insert, lookup, receiptToKey, runKeyedStateT)\nwhere\n\nimport Prelude hiding (lookup)\nimport Control.Arrow ((&amp;&amp;&amp;))\nimport Control.Monad (ap, (&gt;=&gt;))\nimport Data.Map (Map)\nimport qualified Data.Map as Map\nimport Data.Maybe (fromJust)\n\nnewtype KeyedStateT s k v m a = KeyedStateT (Map k v -&gt; m (a, Map k v)) deriving Functor\n\nkeyedState :: Applicative m =&gt; (Map k v -&gt; (a, Map k v)) -&gt; KeyedStateT s k v m a\nkeyedState f = KeyedStateT (pure . f)\n\ninstance Monad m =&gt; Applicative (KeyedStateT s k v m) where\n  pure = keyedState . (,)\n  (&lt;*&gt;) = ap\n\ninstance Monad m =&gt; Monad (KeyedStateT s k v m) where\n  KeyedStateT m &gt;&gt;= f = KeyedStateT $ m &gt;=&gt; uncurry ((\\(KeyedStateT m') -&gt; m') . f)\n\nnewtype Receipt s k = Receipt { receiptToKey :: k }\n\ninsert :: (Applicative m, Ord k) =&gt; k -&gt; v -&gt; KeyedStateT s k v m (Receipt s k)\ninsert k v = keyedState $ const (Receipt k) &amp;&amp;&amp; Map.insert k v\n\nlookup :: (Applicative m, Ord k) =&gt; Receipt s k -&gt; KeyedStateT s k v m v\nlookup (Receipt k) = keyedState $ (Map.! k) &amp;&amp;&amp; id\n\nrunKeyedStateT :: (forall s. KeyedStateT s k v m a) -&gt; m (a, Map k v)\nrunKeyedStateT (KeyedStateT m) = m Map.empty\n</code></pre>\n\n<pre><code>module Main where\n\nimport Data.Functor.Identity (runIdentity)\nimport qualified KeyedStateT as KS\n\nmain = putStrLn . fst . runIdentity $ KS.runKeyedStateT $ do\n  one &lt;- KS.insert 1 \"hello\"\n  two &lt;- KS.insert 2 \" world\"\n  h &lt;- KS.lookup one\n  w &lt;- KS.lookup two\n  pure $ h ++ w\n</code></pre>\n\n<hr>\n\n<p><strong>Edit:</strong> Several commenters have asked why I want to hold on to a <code>Receipt</code> instead of the actual value. I want to be able to use the <code>Receipt</code> in <code>Set</code>s and <code>Map</code>s (I didn't add the <code>Eq</code> and <code>Ord</code> instances for <code>Receipt</code> in my MVCE, but I have them in my project), but the values in my <code>Map</code> are not equatable. If I replaced <code>Receipt</code> with a key-value pair newtype, I'd have to implement a dishonest <code>Eq</code> instance for that pair that disregarded the value, and then I'd be nervous about that. The <code>Map</code> is there to ensure that there's only one value under consideration for any of my equatable \"proxy\" keys at any given time.</p>\n\n<p>I suppose an alternate solution that would work just fine for me would be a monad transformer that provides a supply of <code>Ref</code>s, where <code>data Ref v = Ref Int v</code>, with the monad ensuring that <code>Ref</code>s are given out with unique <code>Int</code> IDs, and <code>Eq Ref</code> etc. only looking at the <code>Int</code> (and now honesty is guaranteed by the uniqueness of the <code>Int</code>s). I would accept pointers to such a transformer in the wild as well.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 5661, "user_id": 2541276, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100001587714573/picture?type=large", "display_name": "Rajkumar Natarajan", "link": "https://stackoverflow.com/users/2541276/rajkumar-natarajan"}, "edited": false, "score": 1, "creation_date": 1558012699, "post_id": 56166118, "comment_id": 98965628, "body": "I&#39;m not directly using cabal. The error is from <code>stack install intero QuickCheck stack-run</code>. Do you mean I have to downgrade my cabal version? If so, I can&#39;t because that is packaged with ghcup itself. Is there any workaround?"}, {"owner": {"reputation": 1058, "user_id": 514723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda2cf2c56094de269a607dd0b3e1662?s=128&d=identicon&r=PG", "display_name": "Zouppen", "link": "https://stackoverflow.com/users/514723/zouppen"}, "reply_to_user": {"reputation": 5661, "user_id": 2541276, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100001587714573/picture?type=large", "display_name": "Rajkumar Natarajan", "link": "https://stackoverflow.com/users/2541276/rajkumar-natarajan"}, "edited": false, "score": 0, "creation_date": 1558033804, "post_id": 56166118, "comment_id": 98976908, "body": "Not very familiar with stack and your project, but generally I&#39;d recommend fixing the code you are compiling than downgrading its dependencies."}, {"owner": {"reputation": 5661, "user_id": 2541276, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100001587714573/picture?type=large", "display_name": "Rajkumar Natarajan", "link": "https://stackoverflow.com/users/2541276/rajkumar-natarajan"}, "edited": false, "score": 0, "creation_date": 1558036379, "post_id": 56166118, "comment_id": 98978017, "body": "The error is not in my code at all. Please see here <a href=\"https://github.com/haskelly-dev/Haskelly#installation\" rel=\"nofollow noreferrer\">github.com/haskelly-dev/Haskelly#installation</a>"}], "tags": [], "owner": {"reputation": 1058, "user_id": 514723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda2cf2c56094de269a607dd0b3e1662?s=128&d=identicon&r=PG", "display_name": "Zouppen", "link": "https://stackoverflow.com/users/514723/zouppen"}, "is_accepted": false, "score": 0, "last_activity_date": 1558001503, "creation_date": 1558001503, "answer_id": 56166118, "question_id": 56160068, "link": "https://stackoverflow.com/questions/56160068/could-not-find-module-distribution-packagedescription-parse-error-while-ins/56166118#56166118", "title": "&quot;Could not find module \u2018Distribution.PackageDescription.Parse\u2019 Error &quot; while installing Haskelly extension dependencies using haskell stack", "body": "<p>You are running Cabal version 2.4 and package <code>Distribution.PackageDescription.Parse</code> was removed in Cabal 2.2. <a href=\"https://github.com/haskell/cabal/issues/5025\" rel=\"nofollow noreferrer\">See Cabal issue tracker</a>.</p>\n\n<p>Consider using <code>Distribution.PackageDescription.Parsec</code> instead. <a href=\"https://github.com/obsidiansystems/obelisk/issues/106\" rel=\"nofollow noreferrer\">They are using that in obelisk project</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11834251, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MW0ETxanDoQ/AAAAAAAAAAI/AAAAAAAATb0/-G5-HsPxAlA/photo.jpg?sz=128", "display_name": "Ash van der Spuy", "link": "https://stackoverflow.com/users/11834251/ash-van-der-spuy"}, "is_accepted": false, "score": 0, "last_activity_date": 1564036386, "creation_date": 1564036386, "answer_id": 57195683, "question_id": 56160068, "link": "https://stackoverflow.com/questions/56160068/could-not-find-module-distribution-packagedescription-parse-error-while-ins/57195683#57195683", "title": "&quot;Could not find module \u2018Distribution.PackageDescription.Parse\u2019 Error &quot; while installing Haskelly extension dependencies using haskell stack", "body": "<p>As per the doco for Haskelly, if you run into issues, refer to \n<a href=\"https://github.com/yamadapc/stack-run/issues/17#issuecomment-427545735\" rel=\"nofollow noreferrer\">https://github.com/yamadapc/stack-run/issues/17#issuecomment-427545735</a></p>\n\n<p>Essentially, modify your stack.yml, then run individually:</p>\n\n<pre><code>stack build\nstack build intero\nstack install QuickCheck\nstack --stack-yaml ~/.stack/global-project/stack-cabal-1.24.yaml install stack-run\n</code></pre>\n"}], "owner": {"reputation": 5661, "user_id": 2541276, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/100001587714573/picture?type=large", "display_name": "Rajkumar Natarajan", "link": "https://stackoverflow.com/users/2541276/rajkumar-natarajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 623, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1564036386, "creation_date": 1557974632, "last_edit_date": 1558114260, "question_id": 56160068, "link": "https://stackoverflow.com/questions/56160068/could-not-find-module-distribution-packagedescription-parse-error-while-ins", "title": "&quot;Could not find module \u2018Distribution.PackageDescription.Parse\u2019 Error &quot; while installing Haskelly extension dependencies using haskell stack", "body": "<p>I'm trying to install Haskelly extension for vs studio code by following the steps <a href=\"https://github.com/haskelly-dev/Haskelly#installation\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>    rajkumar@linux-2278:~&gt; stack install intero QuickCheck stack-run\n    stack-run-0.1.1.4: configure\n    stack-run-0.1.1.4: build\n\n    --  While building package stack-run-0.1.1.4 using:\n        /home/rajkumar/.stack/setup-exe-cache/x86_64-linux-tinfo6/Cabal-simple_mPHDZzAJ_2.4.0.1_ghc-8.6.5 --builddir=.stack-work/dist/x86_64-linux-tinfo6/Cabal-2.4.0.1 build --ghc-options \" -ddump-hi -ddump-to-file -fdiagnostics-color=always\"\n        Process exited with code: ExitFailure 1\n        Logs have been written to: /home/rajkumar/.stack/global-project/.stack-work/logs/stack-run-0.1.1.4.log\n\n        Configuring stack-run-0.1.1.4...\n        Preprocessing executable 'stack-run' for stack-run-0.1.1.4..\n        Building executable 'stack-run' for stack-run-0.1.1.4..\n\n        /tmp/stack30563/stack-run-0.1.1.4/unix/System/Console/Questioner.hs:4:14: warning:\n            -XOverlappingInstances is deprecated: instead use per-instance pragmas OVERLAPPING/OVERLAPPABLE/OVERLAPS\n        |\n        4 | {-# LANGUAGE OverlappingInstances  #-}\n        |              ^^^^^^^^^^^^^^^^^^^^\n        [1 of 5] Compiling System.Console.Questioner.Autocomplete ( unix/System/Console/Questioner/Autocomplete.hs, .stack-work/dist/x86_64-linux-tinfo6/Cabal-2.4.0.1/build/stack-run/stack-run-tmp/System/Console/Questioner/Autocomplete.o )\n        [2 of 5] Compiling System.Console.Questioner.Util ( unix/System/Console/Questioner/Util.hs, .stack-work/dist/x86_64-linux-tinfo6/Cabal-2.4.0.1/build/stack-run/stack-run-tmp/System/Console/Questioner/Util.o )\n        [3 of 5] Compiling System.Console.Questioner.ProgressIndicators ( unix/System/Console/Questioner/ProgressIndicators.hs, .stack-work/dist/x86_64-linux-tinfo6/Cabal-2.4.0.1/build/stack-run/stack-run-tmp/System/Console/Questioner/ProgressIndicators.o )\n        [4 of 5] Compiling System.Console.Questioner ( unix/System/Console/Questioner.hs, .stack-work/dist/x86_64-linux-tinfo6/Cabal-2.4.0.1/build/stack-run/stack-run-tmp/System/Console/Questioner.o )\n        [5 of 5] Compiling Main             ( src/Main.hs, .stack-work/dist/x86_64-linux-tinfo6/Cabal-2.4.0.1/build/stack-run/stack-run-tmp/Main.o )\n\n        /tmp/stack30563/stack-run-0.1.1.4/src/Main.hs:18:1: error:\n            Could not find module \u2018Distribution.PackageDescription.Parse\u2019\n            Perhaps you meant\n            Distribution.PackageDescription.Parsec (needs flag -package-key Cabal-2.4.0.1)\n            Distribution.PackageDescription.Parsec (from Cabal-2.4.1.0)\n            Distribution.PackageDescription.Check (needs flag -package-key Cabal-2.4.0.1)\n            Use -v to see a list of the files searched for.\n        |\n        18 | import           Distribution.PackageDescription.Parse\n</code></pre>\n\n<p>Below is the contents of <code>/home/rajkumar/.stack/global-project/stack.yaml</code> - </p>\n\n<pre><code>    packages: []\n    resolver: lts-13.21\n    allow-newer: true\n    extra-deps:\n    - conduit-1.2.13.1\n    - conduit-extra-1.1.17\n    - resourcet-1.1.11\n    - streaming-commons-0.1.19\n</code></pre>\n\n<p>cabal version - </p>\n\n<pre><code>    $ cabal --version\n    cabal-install version 2.4.1.0\n    compiled using version 2.4.1.0 of the Cabal library \n</code></pre>\n\n<p>stack version -</p>\n\n<pre><code>    $ stack --version\n    Version 1.9.3, Git revision 40cf7b37526b86d1676da82167ea8758a854953b (6211 commits) x86_64 hpack-0.31.1\n</code></pre>\n\n<p>Below are the OpenSuse OS details -</p>\n\n<pre><code>    rajkumar@linux-2278:~&gt; lsb_release -a\n    LSB Version:    core-2.0-noarch:core-3.2-noarch:core-4.0-noarch:core-2.0-x86_64:core-3.2-x86_64:core-4.0-x86_64:desktop-4.0-amd64:desktop-4.0-noarch:graphics-2.0-amd64:graphics-2.0-noarch:graphics-3.2-amd64:graphics-3.2-noarch:graphics-4.0-amd64:graphics-4.0-noarch\n    Distributor ID: openSUSE\n    Description:    openSUSE Leap 15.0\n    Release:        15.0\n    Codename:       n/a\n</code></pre>\n\n<p>This also happens in Fedora 30 OS -</p>\n\n<pre><code>    $ lsb_release -a\n    LSB Version:    :core-4.1-amd64:core-4.1-noarch\n    Distributor ID: Fedora\n    Description:    Fedora release 30 (Thirty)\n    Release:        30\n    Codename:       Thirty \n</code></pre>\n\n<p>I don't know how to resolve this issue. Any idea would be helpful.</p>\n"}]