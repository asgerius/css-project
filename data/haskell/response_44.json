[{"tags": ["haskell", "ghc", "stm"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1447318802, "post_id": 33661929, "comment_id": 55108227, "body": "That would have been my approach as well."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1447364784, "post_id": 33661929, "comment_id": 55136968, "body": "What results did you get from this approach?"}, {"owner": {"reputation": 2373, "user_id": 563187, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb8e4fe63202b73ee017e1a7a09e318a?s=128&d=identicon&r=PG", "display_name": "luisgabriel", "link": "https://stackoverflow.com/users/563187/luisgabriel"}, "edited": false, "score": 0, "creation_date": 1447369107, "post_id": 33661929, "comment_id": 55139004, "body": "There are no traces. If this approach is correct, no transaction is aborting."}], "answers": [{"comments": [{"owner": {"reputation": 2373, "user_id": 563187, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb8e4fe63202b73ee017e1a7a09e318a?s=128&d=identicon&r=PG", "display_name": "luisgabriel", "link": "https://stackoverflow.com/users/563187/luisgabriel"}, "edited": false, "score": 0, "creation_date": 1466530723, "post_id": 36842241, "comment_id": 63350733, "body": "Sorry for the long delay to respond. It seems that this package is not updated for a long time. I&#39;ll take a look how they check for retries. Thanks!"}, {"owner": {"reputation": 750, "user_id": 2350060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cf94c7218b74a36b40b1241e5c6649f?s=128&d=identicon&r=PG", "display_name": "Alexander Batischev", "link": "https://stackoverflow.com/users/2350060/alexander-batischev"}, "reply_to_user": {"reputation": 2373, "user_id": 563187, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb8e4fe63202b73ee017e1a7a09e318a?s=128&d=identicon&r=PG", "display_name": "luisgabriel", "link": "https://stackoverflow.com/users/563187/luisgabriel"}, "edited": false, "score": 0, "creation_date": 1466601824, "post_id": 36842241, "comment_id": 63384527, "body": "I wouldn&#39;t be concerned about lack of updates: 1) Joachim, the maintainer, is well-known in the community; 2) the package is in Stackage LTS, which means it at least builds."}, {"owner": {"reputation": 2373, "user_id": 563187, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb8e4fe63202b73ee017e1a7a09e318a?s=128&d=identicon&r=PG", "display_name": "luisgabriel", "link": "https://stackoverflow.com/users/563187/luisgabriel"}, "edited": false, "score": 0, "creation_date": 1469040602, "post_id": 36842241, "comment_id": 64378834, "body": "Just had some time to test <code>stm-stats</code> and it worked perfectly! The problem was indeed a transaction frequently aborting. Thank you!"}], "tags": [], "owner": {"reputation": 750, "user_id": 2350060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cf94c7218b74a36b40b1241e5c6649f?s=128&d=identicon&r=PG", "display_name": "Alexander Batischev", "link": "https://stackoverflow.com/users/2350060/alexander-batischev"}, "is_accepted": true, "score": 3, "last_activity_date": 1461591474, "creation_date": 1461591474, "answer_id": 36842241, "question_id": 33661929, "link": "https://stackoverflow.com/questions/33661929/how-to-discover-if-a-transaction-is-frequently-aborting/36842241#36842241", "title": "How to discover if a transaction is frequently aborting?", "body": "<p>Use <a href=\"https://hackage.haskell.org/package/stm-stats\" rel=\"nofollow\">stm-stats</a> package. It provides <code>trackSTM</code> that you should use instead of <code>atomically</code>, and <code>dumpSTMStats :: IO ()</code> that will provide something like this:</p>\n\n<pre><code>STM transaction statistics (2011-10-09 12:28:37.188951 UTC):\nTransaction     Commits    Retries      Ratio\n_anonymous_           1          0       0.00\nreader                1         23      23.00\nwriter               23          0       0.00\n</code></pre>\n\n<p>(Transaction names will be generated automatically, but there's helpers to set your own.)</p>\n"}], "owner": {"reputation": 2373, "user_id": 563187, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb8e4fe63202b73ee017e1a7a09e318a?s=128&d=identicon&r=PG", "display_name": "luisgabriel", "link": "https://stackoverflow.com/users/563187/luisgabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 1, "accepted_answer_id": 36842241, "answer_count": 1, "score": 14, "last_activity_date": 1461591474, "creation_date": 1447285207, "question_id": 33661929, "link": "https://stackoverflow.com/questions/33661929/how-to-discover-if-a-transaction-is-frequently-aborting", "title": "How to discover if a transaction is frequently aborting?", "body": "<p>I'm trying to debug a program that uses STM. The ThreadScope readings is pointing out a very high CPU activity as you can see here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ICGXp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ICGXp.png\" alt=\"enter image description here\"></a></p>\n\n<p>So I'm trying to find out if this is happening due to a transaction that frequently aborts. The first thing that I thought was using something like this to test:</p>\n\n<pre><code>atomically $ do\n  someWork \n  ...\n`orElse` do\n  unsafeIOToSTM $ traceEventIO \"transaction aborted!\"\n  retry\n</code></pre>\n\n<p>But I'm not sure if this is correct or if this is the best approach to debugging in an STM scenario. Any ideas?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1447282439, "post_id": 33661358, "comment_id": 55096410, "body": "What do you mean by &quot;define (x:xs&#39;,xs&#39;&#39;) as another function&quot;?"}, {"owner": {"reputation": 71, "user_id": 5552580, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0f0e2ac971a359c92fafad3b826359fd?s=128&d=identicon&r=PG&f=1", "display_name": "AinJalut", "link": "https://stackoverflow.com/users/5552580/ainjalut"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1447282548, "post_id": 33661358, "comment_id": 55096453, "body": "@sepp2k I mean this  where     (xs\u2019, xs\u2019\u2019) = splitAt (n - 1) xs"}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1447282719, "post_id": 33661358, "comment_id": 55096511, "body": "That&#39;s not another function.  That&#39;s equivalent to <code>case splitAt (n-1) xs of (xs&#39;, xs&#39;&#39;) -&gt; if n == 0 then ...</code>  It&#39;s just running <code>splitAt (n-1) xs</code> and calling the first part of the result <code>xs&#39;</code> and the second part <code>xs&#39;&#39;</code>."}, {"owner": {"reputation": 71, "user_id": 5552580, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0f0e2ac971a359c92fafad3b826359fd?s=128&d=identicon&r=PG&f=1", "display_name": "AinJalut", "link": "https://stackoverflow.com/users/5552580/ainjalut"}, "edited": false, "score": 0, "creation_date": 1447282811, "post_id": 33661358, "comment_id": 55096547, "body": "I can&#39;t really visualize what is happening to the string (x:xs). What is x actually apprehended onto in (x : xs&#39;, xs&#39;&#39;)?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1447287258, "post_id": 33661358, "comment_id": 55098039, "body": "@AinJalut <code>x</code> is prepended to <code>xs&#39;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 71, "user_id": 5552580, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0f0e2ac971a359c92fafad3b826359fd?s=128&d=identicon&r=PG&f=1", "display_name": "AinJalut", "link": "https://stackoverflow.com/users/5552580/ainjalut"}, "edited": false, "score": 0, "creation_date": 1447329024, "post_id": 33661615, "comment_id": 55114375, "body": "@AinJalut <code>xs&#39;</code> is never treated as <code>x</code> - <code>x</code> is an element and <code>xs&#39;</code> is a list, so one could never be treated as the other. The only repetition here is in the fact that the function is recursive (so in that sense the code repeats for each recursive call)."}, {"owner": {"reputation": 71, "user_id": 5552580, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0f0e2ac971a359c92fafad3b826359fd?s=128&d=identicon&r=PG&f=1", "display_name": "AinJalut", "link": "https://stackoverflow.com/users/5552580/ainjalut"}, "edited": false, "score": 0, "creation_date": 1447343215, "post_id": 33661615, "comment_id": 55123893, "body": "sorry, I still have difficulty understanding. Let&#39;s take splitAt 3 &quot;Programming&quot; as an example. So when we arrive at splitAt n (x:xs), you are saying it will do something like (p:r, o)? What&#39;s next? And also, why would we put the third element into the space after the comma? This is splitting the wrong things, surely?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 71, "user_id": 5552580, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0f0e2ac971a359c92fafad3b826359fd?s=128&d=identicon&r=PG&f=1", "display_name": "AinJalut", "link": "https://stackoverflow.com/users/5552580/ainjalut"}, "edited": false, "score": 0, "creation_date": 1447349389, "post_id": 33661615, "comment_id": 55128252, "body": "@AinJalut If we do <code>splitAt 3 &quot;Programming&quot;</code>, this matches the case <code>splitAt n (x : xs)</code> with <code>n = 3</code>, <code>x = &#39;P&#39;</code> and <code>xs = &quot;rogramming&quot;</code>. So the line <code>(xs&#39;, xs&#39;&#39;) = splitAt (n-1) xs</code> becomes <code>(xs&#39;, xs&#39;&#39;) = splitAt 2 &quot;rogramming&quot;</code>. So <code>xs&#39;</code> becomes <code>&quot;ro&quot;</code> and <code>xs&#39;&#39;</code> becomes <code>&quot;gramming&quot;</code>. So the result, <code>(x:xs&#39;, xs&#39;&#39;)</code>, will be <code>(&#39;P&#39; : &quot;ro&quot;, &quot;gramming&quot;)</code>, which is <code>(&quot;Pro&quot;, &quot;gramming&quot;)</code>."}, {"owner": {"reputation": 71, "user_id": 5552580, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0f0e2ac971a359c92fafad3b826359fd?s=128&d=identicon&r=PG&f=1", "display_name": "AinJalut", "link": "https://stackoverflow.com/users/5552580/ainjalut"}, "edited": false, "score": 0, "creation_date": 1447352487, "post_id": 33661615, "comment_id": 55130143, "body": "sepp2k, where is the recursion here then? Does it not reach n=0 after splitAt 2 &quot;rogramming&quot;?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 71, "user_id": 5552580, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0f0e2ac971a359c92fafad3b826359fd?s=128&d=identicon&r=PG&f=1", "display_name": "AinJalut", "link": "https://stackoverflow.com/users/5552580/ainjalut"}, "edited": false, "score": 0, "creation_date": 1447353460, "post_id": 33661615, "comment_id": 55130650, "body": "@AinJalut The recursion is in the fact that <code>xs&#39;</code> and <code>xs&#39;&#39;</code> depend on the result of <code>splitAt 2 &quot;rogramming&quot;</code>, which here I simply stated to be <code>(&quot;ro&quot;, &quot;gramming&quot;)</code> because I didn&#39;t want to go through the whole thing for <code>splitAt 2 &quot;rogramming&quot;</code> again."}, {"owner": {"reputation": 71, "user_id": 5552580, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0f0e2ac971a359c92fafad3b826359fd?s=128&d=identicon&r=PG&f=1", "display_name": "AinJalut", "link": "https://stackoverflow.com/users/5552580/ainjalut"}, "edited": false, "score": 0, "creation_date": 1447356002, "post_id": 33661615, "comment_id": 55132186, "body": "well I understand everything apart from the very last part anyway. Hence, when we get to splitAt 2 &quot;rogramming&quot; then this repeats (x:xs&#39;,xs&#39;&#39;) again with r as x?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 71, "user_id": 5552580, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0f0e2ac971a359c92fafad3b826359fd?s=128&d=identicon&r=PG&f=1", "display_name": "AinJalut", "link": "https://stackoverflow.com/users/5552580/ainjalut"}, "edited": false, "score": 0, "creation_date": 1447357313, "post_id": 33661615, "comment_id": 55132933, "body": "@AinJalut When we get to the recursion, the whole function gets executed again with <code>x = &#39;r&#39;</code> and <code>xs = &quot;ogramming&quot;</code>, yes."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 71, "user_id": 5552580, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0f0e2ac971a359c92fafad3b826359fd?s=128&d=identicon&r=PG&f=1", "display_name": "AinJalut", "link": "https://stackoverflow.com/users/5552580/ainjalut"}, "edited": false, "score": 0, "creation_date": 1447415884, "post_id": 33661615, "comment_id": 55155988, "body": "@AinJalut <code>splitAt 3 &quot;Programming&quot;</code> uses <code>splitAt 2 &quot;rogramming&quot;</code>, which uses <code>splitAt 1 &quot;ogramming&quot;</code>, which uses <code>splitAt 0 &quot;gramming&quot;</code>, which produces <code>(&quot;&quot;, &quot;gramming&quot;)</code> as its result (because it goes into the <code>then</code> of the <code>if</code>). So in <code>splitAt 1 &quot;ogramming&quot;</code> <code>xs&#39;</code> is <code>&quot;&quot;</code> and <code>xs&#39;&#39;</code> is &quot;gramming&quot;, meaning that its result, <code>(x:xs&#39;, xs&#39;&#39;)</code> is <code>(&#39;o&#39;:&quot;&quot;, &quot;gramming&quot;) = (&quot;o&quot;, &quot;gramming&quot;)</code>. So in <code>splitAt 2 &quot;rogramming&quot;</code> <code>xs&#39;</code> is &quot;o&quot; and <code>xs&#39;&#39;</code> is &quot;gramming&quot;, meaning that its result, <code>(x:xs&#39;, xs&#39;&#39;)</code> is <code>(&#39;r&#39;:&quot;o&quot;, &quot;gramming&quot;) = (&quot;ro&quot;, &quot;gramming&quot;)</code>..."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 71, "user_id": 5552580, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0f0e2ac971a359c92fafad3b826359fd?s=128&d=identicon&r=PG&f=1", "display_name": "AinJalut", "link": "https://stackoverflow.com/users/5552580/ainjalut"}, "edited": false, "score": 0, "creation_date": 1447415936, "post_id": 33661615, "comment_id": 55156014, "body": "... So in splitAt 3 &quot;Programming&quot; xs&#39; is &quot;ro&quot; and xs&#39;&#39; is &quot;gramming&quot;, meaning that its result, <code>(x:xs&#39;, xs&#39;&#39;)</code> is <code>(&#39;P&#39;:&quot;ro&quot;, &quot;gramming&quot;) = (&quot;Pro&quot;, &quot;gramming&quot;)</code>."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 5, "last_activity_date": 1447283598, "creation_date": 1447283598, "answer_id": 33661615, "question_id": 33661358, "link": "https://stackoverflow.com/questions/33661358/problems-with-understanding-splitat-in-haskell/33661615#33661615", "title": "Problems with understanding splitAt in Haskell?", "body": "<pre><code>(xs', xs'') = splitAt (n - 1) xs\n</code></pre>\n\n<p>This takes the result of <code>splitAt (n - 1) xs</code>, which is a pair, and assigns the name <code>xs'</code> to the first element of that pair (i.e. the first <code>n - 1</code> elements of <code>xs</code>) and <code>xs''</code> to the second element (i.e. the remaining elements).</p>\n\n<pre><code>(x:xs', xs'')\n</code></pre>\n\n<p>This produces a pair. The first element of that pair is a list that's the result of prepending <code>x</code> to <code>xs'</code> (i.e. to the first <code>n-1</code> elements of <code>xs</code>). The second element is <code>xs''</code> (i.e. the remaining elements of <code>xs</code>).</p>\n"}], "owner": {"reputation": 71, "user_id": 5552580, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0f0e2ac971a359c92fafad3b826359fd?s=128&d=identicon&r=PG&f=1", "display_name": "AinJalut", "link": "https://stackoverflow.com/users/5552580/ainjalut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1995, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1447283598, "creation_date": 1447282303, "last_edit_date": 1447282494, "question_id": 33661358, "link": "https://stackoverflow.com/questions/33661358/problems-with-understanding-splitat-in-haskell", "title": "Problems with understanding splitAt in Haskell?", "body": "<p>So I have found that the built-in splitAt function in Haskell can be defined as follows:</p>\n\n<pre><code>splitAt :: Int -&gt; [a] -&gt; ([a], [a])\n-- Pre: n &gt;= 0\nsplitAt n []\n    = ([], [])\nsplitAt n (x : xs)\n    = if n == 0\n      then ([], x : xs)\n      else (x : xs', xs'')\n  where\n    (xs', xs'') = splitAt (n - 1) xs\n</code></pre>\n\n<p>What I don't understand here/can't get my head around is the where part.</p>\n\n<p>As an example,</p>\n\n<p><code>splitAt 2 \"Haskell\"</code> should return <code>([\"Ha\"],[\"skell\"])</code>, but I don't really understand how it works here to define <code>(x:xs',xs'')</code> as another function? How would this look like visually?</p>\n\n<p>With the example:</p>\n\n<pre><code>splitAt 2 \"Haskell\"\n  = (('H':xs',xs'')) \n</code></pre>\n\n<p>^ so this then does <code>splitAt 1 \"askell\"</code>, but I'm very confused as to what happens to the <code>xs',xs''</code> in the tuple above...</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1447277757, "post_id": 33659884, "comment_id": 55094136, "body": "Can you give an example of how you are calling quickCheck so that it displays that other output? When I run <a href=\"http://lpaste.net/145061\" rel=\"nofollow noreferrer\">lpaste.net/145061</a> I only see the summary line."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1447278331, "post_id": 33659884, "comment_id": 55094430, "body": "Can you give more details? What&#39;s you Arbitrary instance for MyType?"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1447278507, "post_id": 33659884, "comment_id": 55094507, "body": "@ErikR: Sorry, I was wrong. I see this no matter what I do (or what my type is)."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1447279203, "post_id": 33659884, "comment_id": 55094855, "body": "@ErikR: You see only the summary line, because QuickCheck is too fast and your terminal understands <code>\\b</code> or similar measurements taken by QuickCheck to overwrite the previous count of tests. Test a property that takes some time, or use something like <code>sleep n x = unsafePerformIO (threadDelay (n * 10^6) &gt;&gt; return x)</code> to see the counter."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1447279206, "post_id": 33659884, "comment_id": 55094856, "body": "@ErikR: Interestingly, I don&#39;t see this in all consoles. So perhaps it&#39;s just something to do with stdout and stderr being combined somehow by my IDE&#39;s console."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447279570, "post_id": 33659884, "comment_id": 55095025, "body": "@raxacoricofallapatorius: Some IDEs don&#39;t support overwriting previous text. QuickCheck flushes all text that&#39;s still in buffers, and then tries to move the cursor back via <code>\\b</code>. However, that needs the terminal&#39;s support for moving the cursor back which simple file streamers usually lack. Instead, you end up with a stray <code>0x08</code> byte in your output (which often gets filtered by viewers or shown as strange symbol/space)."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1447280153, "post_id": 33659884, "comment_id": 55095294, "body": "run <code>runhaskell tests.hs &gt; out 2&gt; err</code> and <code>ls -l err</code> will show you that a lot has been written to stderr. To actually see the contents of <code>err</code> use <code>od err</code> or <code>hexdump err</code>."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447283026, "post_id": 33659884, "comment_id": 55096619, "body": "@Zeta: That could be it. I&#39;ll try it out in some other settings to see what happens."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447283134, "post_id": 33659884, "comment_id": 55096670, "body": "@Zeta: Sure enough: in Apple Terminal it all gets overwritten and all I see in the end is the summary output. I think that&#39;s going to be the answer."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 4, "last_activity_date": 1447327025, "last_edit_date": 1447327025, "creation_date": 1447278961, "answer_id": 33660582, "question_id": 33659884, "link": "https://stackoverflow.com/questions/33659884/how-to-i-suppress-reporting-of-each-test-in-quickcheck-without-suppressing-summ/33660582#33660582", "title": "How to I suppress reporting of each test in QuickCheck, without suppressing summary output?", "body": "<p>Since you're only interested in the summary output, you could use <code>quickCheckWithResult</code> together with <code>chatty = False</code>:</p>\n\n<pre><code>silentQuickCheck :: Testable prop =&gt; prop -&gt; IO () \nsilentQuickCheck p = quickCheckWithResult stdArgs { chatty = False } p &gt;&gt;= putStr . output\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>main = do\n   putStrLn \"Even: \"\n   silentQuickCheck even\n   putStrLn \"Odd: \"\n   silentQuickCheck odd\n   putStrLn \"ID Eq: \"\n   silentQuickCheck $ \\n -&gt; n == n\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Even:\n*** Failed! Falsifiable (after 6 tests):\n3\nOdd: \n*** Failed! Falsifiable (after 1 test):\n0\nID Eq:\n+++ OK, passed 100 tests.\n</code></pre>\n\n<p>However, on terminals/outputs that move the cursor backwards on<code>\\b</code> (ASCII backspace), the test count (<code>(xx tests)</code>) gets rewritten over and over again, so this is only necessary if your output/terminal doesn't acknowledge <code>\\b</code> in this sense.</p>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1447327025, "creation_date": 1447276135, "question_id": 33659884, "link": "https://stackoverflow.com/questions/33659884/how-to-i-suppress-reporting-of-each-test-in-quickcheck-without-suppressing-summ", "title": "How to I suppress reporting of each test in QuickCheck, without suppressing summary output?", "body": "<p>In QuickCheck, is there a way to suppress the </p>\n\n<pre><code>(0 tests)         (1 test)        (2 tests)         (3 tests)         (4 tests)  ...\n</code></pre>\n\n<p>output without suppressing the summary</p>\n\n<pre><code>+++ OK, passed 500 tests.\n</code></pre>\n\n<p>output?</p>\n\n<p>I've tried setting <a href=\"http://hackage.haskell.org/package/QuickCheck-2.8.1/docs/Test-QuickCheck-Test.html#g:1\" rel=\"nofollow\"><code>chatty = False</code></a>, but that suppresses both.</p>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1447276504, "post_id": 33659816, "comment_id": 55093515, "body": "in order to generate <code>[w1, ..., w4]</code>, you may use <a href=\"https://hackage.haskell.org/package/QuickCheck-2.8.1/docs/Test-QuickCheck.html#v:vectorOf\" rel=\"nofollow noreferrer\"><code>vectorOf  4 (elements [&#39;A&#39;..&#39;Z&#39;])</code></a> instead of <code>w1 &lt;- ...</code>"}, {"owner": {"reputation": 1617, "user_id": 2239956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5132d21c85f66d0d10ab0c8069c59?s=128&d=identicon&r=PG", "display_name": "drquicksilver", "link": "https://stackoverflow.com/users/2239956/drquicksilver"}, "edited": false, "score": 0, "creation_date": 1447277106, "post_id": 33659816, "comment_id": 55093825, "body": "<code>vectorOf</code> is a synonym for <code>replicateM</code> which is the more general combinator. Not sure how it snuck in (does it date from a time before QC had a <code>Monad</code> instance?)"}], "answers": [{"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447276950, "post_id": 33660017, "comment_id": 55093734, "body": "Doh! \u2014 I forgot all about <code>replicateM</code>!"}], "tags": [], "owner": {"reputation": 1617, "user_id": 2239956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5132d21c85f66d0d10ab0c8069c59?s=128&d=identicon&r=PG", "display_name": "drquicksilver", "link": "https://stackoverflow.com/users/2239956/drquicksilver"}, "is_accepted": true, "score": 4, "last_activity_date": 1447276585, "creation_date": 1447276585, "answer_id": 33660017, "question_id": 33659816, "link": "https://stackoverflow.com/questions/33659816/can-i-generate-arbitrary-strings-and-avoid-repeating-specifications-in-quickche/33660017#33660017", "title": "Can I generate arbitrary strings, and avoid repeating specifications in QuickCheck?", "body": "<p>Yes. Haskell is great at being able to factor things out! You can certainly name and share subexpressions like <code>elements ['A'..'Z']</code></p>\n\n<pre><code>capitals = elements ['A'..'Z']\n\ninstance Arbitrary StringThing where\n        arbitrary = do\n          l &lt;- choose (1,50) -- this is your string length\n          replicateM l capitals\n</code></pre>\n\n<p>And for your MyType, you can also use replicateM quite a lot:</p>\n\n<pre><code>instance Arbitrary MyType where\n        arbitrary = do\n                ws &lt;- replicateM 4 capitals\n                cs &lt;- replicateM 4 (elements someListOfCustomStuff)\n                rs &lt;- replicateM 4 (choose (1,26))\n                return $ makeMyType (intercalate \"-\" cs)\n                                    ws\n                                    (intercalate \".\" $ (printf \"%02d\") &lt;$&gt; (rs :: [Int]))\n</code></pre>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 673, "favorite_count": 0, "accepted_answer_id": 33660017, "answer_count": 1, "score": 1, "last_activity_date": 1447276585, "creation_date": 1447275874, "question_id": 33659816, "link": "https://stackoverflow.com/questions/33659816/can-i-generate-arbitrary-strings-and-avoid-repeating-specifications-in-quickche", "title": "Can I generate arbitrary strings, and avoid repeating specifications in QuickCheck?", "body": "<p>Given </p>\n\n<pre><code>data MyType = MyType ...\n\nmakeMyType :: String -&gt; String -&gt; String -&gt; MyType\n-- ...\n\ntype StringThing = String\n</code></pre>\n\n<p>where the strings that <code>makeMyType</code> expects are (respectively):</p>\n\n<ul>\n<li>a <code>-</code> delimited string of some custom strings (e.g., <code>\"Hilary-Jeb-David-Charles\"</code>),</li>\n<li>a string of 4 capital letters, and</li>\n<li>a <code>.</code> delimited string of integers between 1 and 26, each padded with a zero to two characters (e.g., <code>\"04.23.11.09\"</code>)</li>\n</ul>\n\n<p>I can use <a href=\"https://hackage.haskell.org/package/QuickCheck\" rel=\"nofollow\">QuickCheck</a> to generate adequate test cases with something like</p>\n\n<pre><code>{-# LANGUAGE TypeSynonymInstances, FlexibleInstances #-}\nimport Test.QuickCheck\nimport Data.List (intercalate)\nimport Text.Printf (printf)\n\n-- This really should be an arbitrary string of random length in some range\ninstance Arbitrary StringThing where\n        arbitrary = elements [\"FUSHFJSHF\",\"KLSJDHFLSKJDHFLSKJDFHLSKJDHFLSKJOIWURURW\",\"GHSHDHUUUHHHA\"]\n\ninstance Arbitrary MyType where\n        arbitrary = do\n                -- This repetition feels unnecessary\n                w1 &lt;- elements ['A'..'Z']\n                w2 &lt;- elements ['A'..'Z']\n                w3 &lt;- elements ['A'..'Z']\n                w4 &lt;- elements ['A'..'Z']\n                c1 &lt;- elements someListOfCustomStuff\n                c2 &lt;- elements someListOfCustomStuff\n                c3 &lt;- elements someListOfCustomStuff\n                c4 &lt;- elements someListOfCustomStuff\n                r1 &lt;- choose (1,26)\n                r2 &lt;- choose (1,26)\n                r3 &lt;- choose (1,26)\n                r4 &lt;- choose (1,26)\n                return $ makeMyType (intercalate \"-\" [c4,c3,c2,c1])\n                                    [w1,w2,w3,w4]\n                                    (intercalate \".\" $ (printf \"%02d\") &lt;$&gt; ([r1,r2,r3,r4] :: [Int]))\n\nprop_SomeProp :: MyType -&gt; StringThing -&gt; Bool\nprop_SomeProp mt st = ...\n</code></pre>\n\n<p>But <code>StringThing</code> really should take on arbitrary strings of capital letters of random length within some range, and the repetition of the same specification for all the <code>w...</code>s, <code>c..</code>s, and <code>r....</code>s seems unnecessary.</p>\n\n<p>Is there a way in QuickCheck to:</p>\n\n<ol>\n<li>generate random strings with length within some bounds, restricted to certain characters, and</li>\n<li>\"share\" a specification using <code>elements</code> or <code>choose</code> among multiple values?</li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 2, "creation_date": 1447273520, "post_id": 33659146, "comment_id": 55091958, "body": "Did you <code>import Data.Type.Equality</code>?"}, {"owner": {"reputation": 878, "user_id": 1655480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39c0e81573717c00f8f89f3525f00e46?s=128&d=identicon&r=PG", "display_name": "Lykos", "link": "https://stackoverflow.com/users/1655480/lykos"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1447273556, "post_id": 33659146, "comment_id": 55091976, "body": "Yes I did. And anyway, even if I didn&#39;t, it should have worked after I copied the source code to the same file where I wanted to use it."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 8, "creation_date": 1447273809, "post_id": 33659146, "comment_id": 55092118, "body": "<code>:~:</code> is a type operator - it operates on types, so <code>case a :~: b of ...</code> doesn&#39;t make any sense since <code>case ... of ...</code> works on terms."}, {"owner": {"reputation": 878, "user_id": 1655480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39c0e81573717c00f8f89f3525f00e46?s=128&d=identicon&r=PG", "display_name": "Lykos", "link": "https://stackoverflow.com/users/1655480/lykos"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1447274036, "post_id": 33659146, "comment_id": 55092242, "body": "Oh, ok. Then I completely misunderstood what :~: does. Ok. So I need to rethink a bit."}, {"owner": {"reputation": 1617, "user_id": 2239956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5132d21c85f66d0d10ab0c8069c59?s=128&d=identicon&r=PG", "display_name": "drquicksilver", "link": "https://stackoverflow.com/users/2239956/drquicksilver"}, "edited": false, "score": 1, "creation_date": 1447274054, "post_id": 33659146, "comment_id": 55092252, "body": "the syntax would be <code>case Refl :: (Int :~: Int) of Refl -&gt; True</code> but this is not very useful since you can see here that <code>Int</code> and <code>Int</code> are the same! I very much doubt that you need <code>Data.Type.Equality</code> to do what you&#39;re trying to do; I think you should step back and ask a question about what you actually want to do (that problem that you believe <code>Data.Type.Equality</code> is the solution to)"}, {"owner": {"reputation": 1617, "user_id": 2239956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5132d21c85f66d0d10ab0c8069c59?s=128&d=identicon&r=PG", "display_name": "drquicksilver", "link": "https://stackoverflow.com/users/2239956/drquicksilver"}, "edited": false, "score": 0, "creation_date": 1447274250, "post_id": 33659146, "comment_id": 55092346, "body": "This blog post appears to be a fairly good example of what <code>Data.Type.Equality</code> is for, although it was written before that module was incorporated and it has its own version called <code>PropEq</code> instead of <code>:~:</code> - <a href=\"https://typesandkinds.wordpress.com/2012/12/01/decidable-propositional-equality-in-haskell/\" rel=\"nofollow noreferrer\">typesandkinds.wordpress.com/2012/12/01/&hellip;</a>"}, {"owner": {"reputation": 878, "user_id": 1655480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39c0e81573717c00f8f89f3525f00e46?s=128&d=identicon&r=PG", "display_name": "Lykos", "link": "https://stackoverflow.com/users/1655480/lykos"}, "edited": false, "score": 0, "creation_date": 1447275311, "post_id": 33659146, "comment_id": 55092890, "body": "Thanks for the link. I completely rephrased my question now."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447313567, "post_id": 33659146, "comment_id": 55105705, "body": "The correct type for <code>subst</code> is probably <code>M.Map a (Ast a b d) -&gt; Ast a b d -&gt; Ast a b d</code>. This way Haskell will &quot;know&quot; that the type variables are the same: you declare them as such."}, {"owner": {"reputation": 878, "user_id": 1655480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39c0e81573717c00f8f89f3525f00e46?s=128&d=identicon&r=PG", "display_name": "Lykos", "link": "https://stackoverflow.com/users/1655480/lykos"}, "edited": false, "score": 0, "creation_date": 1447316474, "post_id": 33659146, "comment_id": 55107039, "body": "No, that won&#39;t work. What you are proposing works for normal trees, but I am using GADTs here. The problem is that different subtrees have different types. For example, if I have two integer trees, I can use an equality binary operation to construct a boolean tree. The point is, the Haskell compiler cannot &quot;know&quot; in general that all variables have the same type since they can appear im different subtrees with different types."}], "answers": [{"tags": [], "owner": {"reputation": 878, "user_id": 1655480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39c0e81573717c00f8f89f3525f00e46?s=128&d=identicon&r=PG", "display_name": "Lykos", "link": "https://stackoverflow.com/users/1655480/lykos"}, "is_accepted": true, "score": 3, "last_activity_date": 1489751954, "last_edit_date": 1489751954, "creation_date": 1447350237, "answer_id": 33677877, "question_id": 33659146, "link": "https://stackoverflow.com/questions/33659146/haskell-data-type-equality-not-in-scope-data-constructor/33677877#33677877", "title": "Haskell Data.Type.Equality &quot;Not in scope: data constructor \u2018:~:\u2019&quot;", "body": "<p>Ok, this is by far my most stupid question on Stackoverflow. I would like to delete it, but maybe some day someone googles the same issue and is happy to see an answer, therefore I will answer it.</p>\n\n<h1>Answer to my original question</h1>\n\n<p>I completely misunderstood the :~: operator. It works on types and not on terms, therefore my example makes no sense.</p>\n\n<h1>About my second question</h1>\n\n<p>I don't have an answer, but I don't need it anymore. I like the idea of GADTs, but I was trying to apply it to something where they were just extremely hard to use. Possibly a more experienced Haskell programmer would have been able to use them properly in my context, but I am by no means a good Haskell programmer. So I will just use normal ADTs and give up some type safety, i.e. the compiler will not disallow a product of booleans etc. But in exchange, I can actually make it work.</p>\n\n<p>Besides, it was a very bad style to completely change my question. Small adaptions are ok, but if the direction completely changes, I should have created a separate question with an appropriate title. The current state is just confusing for everyone who lands on this page. Besides, as a separate question with an appropriate title, I would have gad better chances to get a good answer.</p>\n"}], "owner": {"reputation": 878, "user_id": 1655480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39c0e81573717c00f8f89f3525f00e46?s=128&d=identicon&r=PG", "display_name": "Lykos", "link": "https://stackoverflow.com/users/1655480/lykos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "accepted_answer_id": 33677877, "answer_count": 1, "score": 0, "last_activity_date": 1489751954, "creation_date": 1447273390, "last_edit_date": 1447275288, "question_id": 33659146, "link": "https://stackoverflow.com/questions/33659146/haskell-data-type-equality-not-in-scope-data-constructor", "title": "Haskell Data.Type.Equality &quot;Not in scope: data constructor \u2018:~:\u2019&quot;", "body": "<p>I am trying to use GADTs for the first time, and I wanted to implement variable substitution. Of course, I can only do the substitution if the types are equal. As I understand it, this should be possible using :~: from Data.Type.Equality. But somehow, the compiler doesn't want me to use :~: at all. To try it out, I wrote the following stupid function.</p>\n\n<pre><code>lol :: Int -&gt; Int -&gt; Bool\nlol a b = case a :~: b of\n  Refl -&gt; True\n  _    -&gt; False\n</code></pre>\n\n<p>The compiler tells me:</p>\n\n<pre><code>Not in scope: data constructor \u2018:~:\u2019\n</code></pre>\n\n<p>I tried the following things:</p>\n\n<ul>\n<li>First, I thought, this is somehow an issue of having the wrong version installed. I saw that :=: is used in older versions. But :=: didn't work either.</li>\n<li>I changed the version for base in my cabal file explicitly to 4.8.1.0, still no luck.</li>\n<li>I copied the whole source code of Data.Type.Equality to a separate file called TypeEquality and imported it. Still the same error message.</li>\n<li>I thought it might be related to some extensions that I need to enable. I enabled all the extensions that Data.Type.Equality uses except for NoImplicitPrelude. Still no luck.</li>\n<li>I copied everything to the same file where I was using it. Still the same error message.</li>\n<li>I tried googling for other people using this module. I was unable to find anything useful. This would have been nice anyway since I don't really understand how to use it yet.</li>\n<li>I looked for other StackOverflow qustions with \"not in scope\". I didn't look through all of them, but it seemed like it was always related to uppercase/lowercase problems which doesn't seem to be a problem in my case.</li>\n</ul>\n\n<p>After having tried out everything I thought of and being shortly before an emotional breakdown, I decided to ask the question here. Does anybody know what my problem could be? Probably you will need additional information to diagnose it, so please tell me anything I can provide. Since it is quite a big project, I didn't think providing the whole source code is useful...</p>\n\n<h1>edit</h1>\n\n<p>Ok, it seems that I completely misunderstood the way :~: works. So I completely rephrase the question to what I actually need:</p>\n\n<pre><code>-- a is a variable symbol used for variable substitution.\n-- b is a function symbol used for function substitution.\n-- c represents a type of value that is contained.\ndata Ast a b c where\n  BoolConst :: Bool -&gt; Ast a b Bool\n  IntConst :: Int -&gt; Ast a b Int\n  Var :: Eq a =&gt; a -&gt; c -&gt; Ast a b c\n  -- Function application for a function with symbol b.\n  App :: (Eq b, Eq c) =&gt; b -&gt; Ast a b c -&gt; Ast a b Int\n  UnOp :: UnaryOperator c d -&gt; Ast a b c -&gt; Ast a b d\n  BinOp :: BinaryOperator c d e -&gt; Ast a b c -&gt; Ast a b d -&gt; Ast a b e\n  NaryOp :: NaryOperator c -&gt; [Ast a b c] -&gt; Ast a b c\n  Ite :: Ast a b Bool -&gt; Ast a b c -&gt; Ast a b c -&gt; Ast a b c\n</code></pre>\n\n<p>I omitted the definitions of the operators, but you can imagine. First of all: As I understood it, it is impossible to implement functions with more  than one argument. So I implemented App as taking only one argument instead of a list and emulate multiple arguments by repeatedly applying it somehow. I still need to make some changes to make this work, but that is not the issue here.</p>\n\n<p>Now I want to write two <code>substituteVar</code> and <code>substituteFunc</code> functions that substitute variables and functions. For simplicity, let's focus on <code>substituteVar</code> for now. I imagine to use the following signature:</p>\n\n<pre><code>substituteVar :: Eq a =&gt; M.Map a (Ast a b c) -&gt; Ast a b d -&gt; Ast a b d\n</code></pre>\n\n<p>The type parameters <code>c</code> and <code>d</code> are basically used as the return type. But I don't know how to handle the problem that Haskell doesn't \"know\" whether the type of the substitution <code>c</code> is the same as the type of a variable <code>d</code> that is encountered. So I thought I could somehow use <code>:~:</code> for that, but I guess I was wrong. Btw, I currently only need the types Bool and Int, but I want it to be extendible for more than that (but still a small number).</p>\n\n<p>I am aware of the possiblity to use two constructurs for variables called <code>BoolVar</code> and <code>IntVar</code>. But while this is a bit ugly, but kind of works for variables, even if I extend it to 5 types, it would get really messy for the functions. I would basically need one type constructor every combination of argument and return type. Therefore, I thought that this solution doesn't scale and somehow it feels like there should be an easier possibility.</p>\n"}, {"tags": ["haskell", "math", "comparison"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447274502, "post_id": 33659006, "comment_id": 55092473, "body": "Phew, <code>((compare e x) == EQ)</code> is an awfully complicated way to spell <code>e == x</code>! You might also like <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html#v:findIndex\" rel=\"nofollow noreferrer\"><code>findIndex</code></a> in the future, though see answer below for some discussion about alternative approaches."}], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 1, "last_activity_date": 1447273313, "creation_date": 1447273313, "answer_id": 33659125, "question_id": 33659006, "link": "https://stackoverflow.com/questions/33659006/haskell-arithmetic-operations-on-data-types/33659125#33659125", "title": "Haskell: arithmetic operations on data types", "body": "<p>If you also derive an <code>Enum</code> instance, you can use <code>fromEnum :: Enum a =&gt; a -&gt; Int</code> and <code>toEnum :: Enum a =&gt; Int -&gt; a</code> to convert between your data types and integers corresponding to their position in the data definition. Since you have <code>Zero</code> in the 0th position, and so on, this will be exactly what you want for going to and from integers.</p>\n\n<p>But you should also consider: what will be the result of <code>addNumber Three Two</code>? There's no correct value there, because your definition of numbers doesn't go up to Five. Whatever upper bound you set, you will have a \"partial\" function, which is undefined for some values in its domain. Perhaps this is fine for you, if you're just doing an exercise on data types, but generally in Haskell programs we try to avoid partial functions, because they can cause runtime errors in cases that \"should\" have been caught at compile time. You could, for example, return <code>Maybe Number</code> instead of <code>Number</code>, and then return <code>Nothing</code> if there's no valid answer. Then the caller can explicitly cope with the possibility of failure, instead of implicitly accepting it and suffering an exception.</p>\n"}, {"tags": [], "owner": {"reputation": 1617, "user_id": 2239956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5132d21c85f66d0d10ab0c8069c59?s=128&d=identicon&r=PG", "display_name": "drquicksilver", "link": "https://stackoverflow.com/users/2239956/drquicksilver"}, "is_accepted": false, "score": 1, "last_activity_date": 1447274616, "creation_date": 1447274616, "answer_id": 33659474, "question_id": 33659006, "link": "https://stackoverflow.com/questions/33659006/haskell-arithmetic-operations-on-data-types/33659474#33659474", "title": "Haskell: arithmetic operations on data types", "body": "<p>Your numbers are extremely unstructured. As such, if you want to define addition directly (rather than via a detour with the standard type <code>Int</code> and using the standard <code>+</code>), you will have to do this:</p>\n\n<pre><code>addNumber Zero n = n -- Zero added to anything is n\naddNumber One One = Two\naddNumber One Two = Three\naddNumber Two One = Three\naddNumber _ _ = error \"overflow, we only go up to Three\"\n</code></pre>\n\n<p>exhaustively listing every case (which, fortunately, is not very many since you only went up to <code>Three</code>!).</p>\n\n<p>You can imagine other slightly more structure numbers where you can use the structure to define addition more economically. The famous example is</p>\n\n<pre><code>data N = Z | S N\n</code></pre>\n\n<p>... a recursive data type for 'Peano' numbers.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1447275010, "creation_date": 1447275010, "answer_id": 33659587, "question_id": 33659006, "link": "https://stackoverflow.com/questions/33659006/haskell-arithmetic-operations-on-data-types/33659587#33659587", "title": "Haskell: arithmetic operations on data types", "body": "<p>I will assume you wish to avoid using the built-in arithmetic -- if not, as you observe one could convert to built-in numbers, do arithmetic, and convert back out, but that's not very satisfying from a \"learning Haskell\" perspective.</p>\n\n<p>The standard way to define new functions on new data types is with pattern matching. For example, one naive approach to your problem would be to list all pairs of input <code>Number</code>s together with their sum:</p>\n\n<pre><code>add :: Number -&gt; Number -&gt; Number\nadd Zero  Zero  = Zero\nadd Zero  One   = One\nadd Zero  Two   = Two\nadd Zero  Three = Three\nadd One   Zero  = One\nadd One   One   = Two\n-- ...\n</code></pre>\n\n<p>Of course, from a programmer's perspective that looks a bit daunting and boiler-plate-y. On the other hand, splitting out a few functions could make it less so; for example, you might write a function to add one and iterate it:</p>\n\n<pre><code>addOne :: Number -&gt; Number\naddOne Zero  = One\naddOne One   = Two\naddOne Two   = Three\naddOne Three = Zero\n\nadd :: Number -&gt; Number -&gt; Number\nadd Zero  = id\nadd One   = addOne\nadd Two   = addOne . addOne\nadd Three = addOne . addOne . addOne\n</code></pre>\n\n<p>Of course, this will be slightly less efficient; and you wouldn't want to do this for larger number types. But it requires a lot less finger typing. (Anyway for larger number types you would probably want a different implementation than a big enumeration -- e.g. a stream of bits -- but that's beside the point here I think.)</p>\n"}], "owner": {"reputation": 477, "user_id": 4254033, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/bf1ada35cd0755b213121663b1140f91?s=128&d=identicon&r=PG&f=1", "display_name": "skulpt", "link": "https://stackoverflow.com/users/4254033/skulpt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 977, "favorite_count": 0, "accepted_answer_id": 33659125, "answer_count": 3, "score": 1, "last_activity_date": 1447275010, "creation_date": 1447272730, "question_id": 33659006, "link": "https://stackoverflow.com/questions/33659006/haskell-arithmetic-operations-on-data-types", "title": "Haskell: arithmetic operations on data types", "body": "<p>I'm trying to understand data types and to do that, I want to try to emulate integer values. I defined it in the following way:</p>\n\n<pre><code>data Number = Zero | One | Two | Three deriving (Eq,Ord,Show)\n</code></pre>\n\n<p>So basically, I want to do be able to do basic arithmetic operations with elements of this type. Something akin to</p>\n\n<pre><code>addNumber :: Number -&gt; Number -&gt; Number\n</code></pre>\n\n<p>called like addNumber One Two would give Three as a result. However, I'm really not sure how to do this properly. I'd assume it would be in a way possible to do this by comparing Number's to each other, but to get anything from that, I would need to be able to access the next number in a this particular ordering, but I don't know how you'd do that with the given data type. So far, I'm doing something like this:</p>\n\n<pre><code>getIntDex :: Number -&gt; Int\ngetIntDex n = intDex n 0 nList\n\nnList :: [Number]\nnList = [Zero, One, Two, Three]\n\nintDex :: Number -&gt; Int -&gt; [Number] -&gt; Int\nintDex e i (x:xs) = if((compare e x) == EQ)\n            then i\n            else intDex e (i+1) xs\n</code></pre>\n\n<p>Which at least \"converts\" it into an integer so I can actually do something arithmetic with it. However, this feels kinda static and overall wrong (and I could probably do this faster with a switch or guards or something similar. Is there a better way?</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"tags": [], "owner": {"reputation": 154069, "user_id": 260127, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74758c702067a3490094451e475e28c5?s=128&d=identicon&r=PG", "display_name": "prosseek", "link": "https://stackoverflow.com/users/260127/prosseek"}, "is_accepted": true, "score": 1, "last_activity_date": 1447273202, "creation_date": 1447273202, "answer_id": 33659103, "question_id": 33658641, "link": "https://stackoverflow.com/questions/33658641/change-yesod-port-number/33659103#33659103", "title": "Change Yesod port number", "body": "<p>It looks like that the setting file should be in the same directory as the executable. </p>\n\n<p>I copied config/settings.yml in current directory, then run the <code>./my_project settings.yml</code>, now it uses the 3002 port correctly. </p>\n\n<p>I have some hints from <a href=\"https://github.com/yesodweb/yesod/issues/474\" rel=\"nofollow\">https://github.com/yesodweb/yesod/issues/474</a></p>\n"}], "owner": {"reputation": 154069, "user_id": 260127, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74758c702067a3490094451e475e28c5?s=128&d=identicon&r=PG", "display_name": "prosseek", "link": "https://stackoverflow.com/users/260127/prosseek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "accepted_answer_id": 33659103, "answer_count": 1, "score": 2, "last_activity_date": 1447273202, "creation_date": 1447271191, "last_edit_date": 1495539874, "question_id": 33658641, "link": "https://stackoverflow.com/questions/33658641/change-yesod-port-number", "title": "Change Yesod port number", "body": "<p>From <a href=\"https://stackoverflow.com/questions/33657566/deploying-yesod-web-app/33658396#33658396\">Deploying Yesod web app</a>, I could copy the executable, static, and config file to run Yesod as a standalone web server. This is the directory structure. </p>\n\n<pre><code>\u251c\u2500\u2500 config\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 client_session_key.aes\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 favicon.ico\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 keter.yml\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 models\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 robots.txt\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 routes\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 settings.yml\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 sqlite.yml\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 test-settings.yml\n\u251c\u2500\u2500 my-project\n\u251c\u2500\u2500 my-project.sqlite3\n\u2514\u2500\u2500 static\n</code></pre>\n\n<p>I tried to use different port by changing config/settings.yml </p>\n\n<pre><code>port:           \"_env:PORT:3002\"\napproot:        \"_env:APPROOT:http://localhost:3002\"\n</code></pre>\n\n<p>However, the app is still accessible with port 3000. Even I removed the settings.yml, but there was no error message. </p>\n\n<p>The way to change the port was from changing the environment variables <code>export PORT=3002</code> from <a href=\"https://github.com/yesodweb/yesod/wiki/Configuration#overriding-configuration-values-with-environment-variables\" rel=\"nofollow noreferrer\">https://github.com/yesodweb/yesod/wiki/Configuration#overriding-configuration-values-with-environment-variables</a>, but I it's not what I can use. </p>\n\n<p>For development I can use <code>stack exec -- yesod devel -p 3003</code> (<a href=\"https://stackoverflow.com/questions/24485158/how-can-i-change-the-settings-e-g-port-used-by-yesod-devel\">how can I change the settings (e.g., port) used by &quot;yesod devel&quot;?</a>), but I don't seem to use the <code>-p</code> option with the Yesod executable (my-project). </p>\n\n<p>Why the executable does not (seem to) load <code>config/settings</code>? How to setup to use different port in Yesod web app? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 4, "creation_date": 1447268615, "post_id": 33657899, "comment_id": 55089307, "body": "Add <code>import Data.Ord (comparing)</code> to your import list."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1447268621, "post_id": 33657899, "comment_id": 55089313, "body": "<code>comparing</code> is part of the <code>Data.Ord</code> module, which is not imported as part of the Prelude. You should <code>import Data.Ord</code>."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1447272393, "post_id": 33657899, "comment_id": 55091383, "body": "If you&#39;re familiar with the &quot;good old&quot; not in scope error messages then you should also be familiar with fixing them by importing things."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447275790, "post_id": 33657899, "comment_id": 55093123, "body": "You can use <a href=\"https://www.haskell.org/hoogle/?hoogle=comparing\" rel=\"nofollow noreferrer\">Hoogle</a> to learn which module to import."}], "answers": [{"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 4, "last_activity_date": 1447271319, "creation_date": 1447271319, "answer_id": 33658675, "question_id": 33657899, "link": "https://stackoverflow.com/questions/33657899/getting-sortby-in-haskell-to-compare-the-first-element/33658675#33658675", "title": "Getting sortBy in haskell to compare the first element", "body": "<p>As mentioned in the comments, <code>comparing</code> is exported by <code>Data.Ord</code>, so:</p>\n\n<pre><code>import Data.List (sortBy)\nimport Data.Ord (comparing)\n\na = [(2,\"foo\"),(1,\"bar\")]\n\nmain = print $ sortBy (comparing fst) a\n</code></pre>\n"}], "owner": {"reputation": 505, "user_id": 5449377, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/5c1b0852a7e9e7a953ae50583dcd09e1?s=128&d=identicon&r=PG&f=1", "display_name": "Neo Streets", "link": "https://stackoverflow.com/users/5449377/neo-streets"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1391, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1447271319, "creation_date": 1447268454, "last_edit_date": 1447268570, "question_id": 33657899, "link": "https://stackoverflow.com/questions/33657899/getting-sortby-in-haskell-to-compare-the-first-element", "title": "Getting sortBy in haskell to compare the first element", "body": "<p>Hi so I have this pretty ugly list which looks like <code>[(Int,(String,Char))...]</code> and I want to use the <code>sortBy</code> function in Haskell to sort by the <code>Int</code>.</p>\n\n<p>So far I have, <code>a</code> is the list</p>\n\n<pre><code>sorted = sortBy(comparing fst) a\n</code></pre>\n\n<p>but this gives the good old 'comparing' not in scope error message.\nIs there a way to do what I want?</p>\n"}, {"tags": ["ubuntu", "haskell", "deployment", "yesod"], "comments": [{"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 3, "creation_date": 1447288388, "post_id": 33657566, "comment_id": 55098364, "body": "As a side note, you can just add swap memory to use during compilation <a href=\"https://www.digitalocean.com/community/tutorials/how-to-add-swap-on-ubuntu-14-04\" rel=\"nofollow noreferrer\">digitalocean.com/community/tutorials/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 163, "user_id": 3416793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hSVtV.jpg?s=128&g=1", "display_name": "blazej", "link": "https://stackoverflow.com/users/3416793/blazej"}, "is_accepted": false, "score": 1, "last_activity_date": 1447269410, "creation_date": 1447269410, "answer_id": 33658167, "question_id": 33657566, "link": "https://stackoverflow.com/questions/33657566/deploying-yesod-web-app/33658167#33658167", "title": "Deploying Yesod web app", "body": "<p>As far as I know, the executable should be in the build subdirectory of your project directory.  I think it's a hidden directory (name starting with a dot) so you may need to run \"ls -a\" to see it.</p>\n\n<p>To run - simply execute the executable  :)  (Append '&amp;' to make it run in the background).</p>\n\n<p>Once you have the final version you wish to go into production with, you'll probably configure the executable to start automatically when the VM boots, to detect if the executable crashed, etc.</p>\n\n<p>Good luck,\nMicha\u0142</p>\n"}, {"tags": [], "owner": {"reputation": 154069, "user_id": 260127, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74758c702067a3490094451e475e28c5?s=128&d=identicon&r=PG", "display_name": "prosseek", "link": "https://stackoverflow.com/users/260127/prosseek"}, "is_accepted": true, "score": 1, "last_activity_date": 1447270282, "creation_date": 1447270282, "answer_id": 33658396, "question_id": 33657566, "link": "https://stackoverflow.com/questions/33657566/deploying-yesod-web-app/33658396#33658396", "title": "Deploying Yesod web app", "body": "<p>The <code>stack build</code> command gives me the hints:</p>\n\n<pre><code>my-project-0.0.0: install\nInstalling library in\n/home/a/my-project/.stack-work/install/x86_64-linux/lts-3.13/7.10.2/lib/x86_64-linux-ghc-7.10.2/my-project-0.0.0-Khn8lQEgR1HARzYGStlvPe\nInstalling executable(s) in\n/home/a/my-project/.stack-work/install/x86_64-linux/lts-3.13/7.10.2/bin\nRegistering my-project-0.0.0...\n</code></pre>\n\n<p>The executable is located in <code>/home/a/my-project/.stack-work/install/x86_64-linux/lts-3.13/7.10.2/bin</code>. I could copy the files (executable, static, and config) in ~/deployment directory to check the Yesod works fine. </p>\n"}], "owner": {"reputation": 154069, "user_id": 260127, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74758c702067a3490094451e475e28c5?s=128&d=identicon&r=PG", "display_name": "prosseek", "link": "https://stackoverflow.com/users/260127/prosseek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 2, "accepted_answer_id": 33658396, "answer_count": 2, "score": 6, "last_activity_date": 1447289988, "creation_date": 1447267224, "last_edit_date": 1447289988, "question_id": 33657566, "link": "https://stackoverflow.com/questions/33657566/deploying-yesod-web-app", "title": "Deploying Yesod web app", "body": "<p>I have a simple Yesod web app. \nI could follow the instruction in <a href=\"http://www.yesodweb.com/page/quickstart\" rel=\"noreferrer\">http://www.yesodweb.com/page/quickstart</a>, and checked <code>stack exec -- Yesod devel</code> is working fine. </p>\n\n<p>The server that I use (Amazon EC2) has only one gigabyte of memory, so I can't compile the Yesod web. I used my local machine to build. Both of them use Ubuntu 14.04.</p>\n\n<p>From <a href=\"http://www.yesodweb.com/book/deploying-your-webapp\" rel=\"noreferrer\">http://www.yesodweb.com/book/deploying-your-webapp</a>, I need three components to deploy to other machine. </p>\n\n<ol>\n<li>Your executable.</li>\n<li>The config folder.</li>\n<li>The static folder.</li>\n</ol>\n\n<p>I find easily the config/static folder, but I'm not exactly sure where to find the executable(s). Other than that, how to run the exeuctable without using <code>stack exec -- Yesod devel</code>?</p>\n"}, {"tags": ["haskell", "functional-programming", "polymorphism", "lambda-calculus", "church-encoding"], "comments": [{"owner": {"reputation": 2184, "user_id": 336563, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8a313d0510dd29f947c270146be859?s=128&d=identicon&r=PG", "display_name": "ziggurism", "link": "https://stackoverflow.com/users/336563/ziggurism"}, "edited": false, "score": 0, "creation_date": 1447265272, "post_id": 33656979, "comment_id": 55087200, "body": "Do the $$ dollar sign delimited sentences not invoke the latex renderer on Stackoverflow?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1447266648, "post_id": 33656979, "comment_id": 55088065, "body": "Unfortunately, they don&#39;t :-( I guess there&#39;s not enough math around SO (except on the Haskell tag ;-))"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1447268476, "post_id": 33656979, "comment_id": 55089221, "body": "The type of a pair of <code>a</code> and <code>b</code> in Haskell syntax is <code>forall c . (a-&gt;b-&gt;c) -&gt; c</code>. So the types of fst and snd are <code>(forall c . (a-&gt;b-&gt;c) -&gt; c) -&gt; a</code> and <code>(forall c . (a-&gt;b-&gt;c) -&gt; c) -&gt; b</code>. From their type signatures, their definitions are quite trivial."}, {"owner": {"reputation": 2184, "user_id": 336563, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8a313d0510dd29f947c270146be859?s=128&d=identicon&r=PG", "display_name": "ziggurism", "link": "https://stackoverflow.com/users/336563/ziggurism"}, "edited": false, "score": 0, "creation_date": 1447599898, "post_id": 33656979, "comment_id": 55212065, "body": "<a href=\"http://www.jonmsterling.com/posts/2011-12-28-expressing-church-pairs-with-types.html\" rel=\"nofollow noreferrer\">This blog post</a> by Jonathon Sterling seems to be doing something like a church encoding in Haskell, and notice that he does use <code>Rank2Types</code>. But I couldn&#39;t follow all the Haskell bits. Antal&#39;s answer below keeps it to the bare minimum."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1447269731, "creation_date": 1447269731, "answer_id": 33658262, "question_id": 33656979, "link": "https://stackoverflow.com/questions/33656979/implement-in-haskell-the-church-encoding-of-the-pair-for-polymorphic-%ce%bb-calculus/33658262#33658262", "title": "Implement in Haskell the Church encoding of the pair for polymorphic \u03bb-calculus/System F", "body": "<p>You wrote</p>\n\n<pre><code>\u039b\u03b1.\u039b\u03b2.\u03bbp:\u03b1\u00d7\u03b2.p \u03b1 (\u03bbx:\u03b1.\u03bby:\u03b2.x)\n</code></pre>\n\n<p>Just remove all the type arguments, both in application and abstraction:</p>\n\n<pre><code>\u03bbp:\u03b1\u00d7\u03b2.p (\u03bbx:\u03b1.\u03bby:\u03b2.x)\n</code></pre>\n\n<p>In Haskell, without type annotations:</p>\n\n<pre><code>\\p -&gt; p (\\x y -&gt; x)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2184, "user_id": 336563, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8a313d0510dd29f947c270146be859?s=128&d=identicon&r=PG", "display_name": "ziggurism", "link": "https://stackoverflow.com/users/336563/ziggurism"}, "edited": false, "score": 0, "creation_date": 1447597050, "post_id": 33658834, "comment_id": 55211184, "body": "Thank you, this answer is fantastic."}, {"owner": {"reputation": 2184, "user_id": 336563, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8a313d0510dd29f947c270146be859?s=128&d=identicon&r=PG", "display_name": "ziggurism", "link": "https://stackoverflow.com/users/336563/ziggurism"}, "edited": false, "score": 0, "creation_date": 1447597135, "post_id": 33658834, "comment_id": 55211208, "body": "I will note for the record that I also found <a href=\"https://ocharles.org.uk/blog/guest-posts/2014-12-18-rank-n-types.html\" rel=\"nofollow noreferrer\">ocharles.org.uk/blog/guest-posts/2014-12-18-rank-n-types.htm&zwnj;&#8203;l</a> and <a href=\"http://sleepomeno.github.io/blog/2014/02/12/Explaining-Haskell-RankNTypes-for-all/\" rel=\"nofollow noreferrer\">sleepomeno.github.io/blog/2014/02/12/&hellip;</a> useful for understanding RankNType polymorphism"}, {"owner": {"reputation": 2184, "user_id": 336563, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8a313d0510dd29f947c270146be859?s=128&d=identicon&r=PG", "display_name": "ziggurism", "link": "https://stackoverflow.com/users/336563/ziggurism"}, "edited": false, "score": 0, "creation_date": 1447597581, "post_id": 33658834, "comment_id": 55211328, "body": "I also found <a href=\"https://wiki.haskell.org/Rank-N_types\" rel=\"nofollow noreferrer\">wiki.haskell.org/Rank-N_types</a> and the linked stackoverflow answer <a href=\"http://stackoverflow.com/questions/15589556/why-are-difference-lists-not-an-instance-of-foldable/15593349#15593349\" title=\"why are difference lists not an instance of foldable\">stackoverflow.com/questions/15589556/&hellip;</a>. They  have useful reference code, but were not very useful for learning the topic."}, {"owner": {"reputation": 2184, "user_id": 336563, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8a313d0510dd29f947c270146be859?s=128&d=identicon&r=PG", "display_name": "ziggurism", "link": "https://stackoverflow.com/users/336563/ziggurism"}, "edited": false, "score": 0, "creation_date": 1447597829, "post_id": 33658834, "comment_id": 55211393, "body": "One question, what did you need the <code>TypeOperators</code> directive for? Does it allow <code>**</code> to be a type constructor?"}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 2184, "user_id": 336563, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8a313d0510dd29f947c270146be859?s=128&d=identicon&r=PG", "display_name": "ziggurism", "link": "https://stackoverflow.com/users/336563/ziggurism"}, "edited": false, "score": 0, "creation_date": 1447687225, "post_id": 33658834, "comment_id": 55245775, "body": "@ziggurism: I&#39;m glad you found this helpful!  Yes, <code>TypeOperators</code> is just to allow the use of <code>**</code> as a type \u2013 I could have called it <code>Pair</code> instead and skipped that.  (The <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/data-type-extensions.html#type-operators\" rel=\"nofollow noreferrer\">GHC manual</a> has more details.)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447712061, "post_id": 33658834, "comment_id": 55259685, "body": "Nicely done. About &quot;there&#39;s not even an extension to make [type arguments] explicit&quot;: we might get it in the future :-) <a href=\"https://ghc.haskell.org/trac/ghc/wiki/TypeApplication\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/wiki/TypeApplication</a>"}], "tags": [], "owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "is_accepted": true, "score": 8, "last_activity_date": 1447271954, "creation_date": 1447271954, "answer_id": 33658834, "question_id": 33656979, "link": "https://stackoverflow.com/questions/33656979/implement-in-haskell-the-church-encoding-of-the-pair-for-polymorphic-%ce%bb-calculus/33658834#33658834", "title": "Implement in Haskell the Church encoding of the pair for polymorphic \u03bb-calculus/System F", "body": "<p>First of all, you're indeed correct that Selinger and R\u00e9my are saying the same thing; the difference is that R\u00e9my is defining the <em>pair constructor function</em> \u27e8\u2013,\u2013\u27e9, which takes as arguments M and N (his x\u2081 and x\u2082) along with their types (\u03b1\u2081 and \u03b1\u2082); the remainder of his definition is just the definition of \u27e8M,N\u27e9 with \u03b2 and y where Selinger has \u03b1 and f.</p>\n\n<p>Alright, with that taken care of, let's start moving towrads projections.  The first thing to note is the relation between \u2200, \u039b, \u2192, and \u03bb, and their equivalents in Haskell.  Recall that \u2200 and its inhabitants \u039b operate on <em>types</em>, where \u2192 and its inhabitants \u03bb operate on <em>values</em>.  Over in Haskell-land, most of these correspondences are easy, and we get the following table</p>\n\n<pre><code>          System F                             Haskell\nTerms (e)     :  Types (t)        Terms (e)       ::  Types (t)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u03bbx:t\u2081.(e:t\u2082)  :  t\u2081 \u2192 t\u2082          \\x::t\u2081.(e::t\u2082)  :: t\u2081 -&gt; t\u2082\n\u039b\u03b1.(e:t)      :  \u2200\u03b1.t             (e::t)          :: forall \u03b1. t\n</code></pre>\n\n<p>The term-level entries are easy: \u2192 becomes <code>-&gt;</code> and \u03bb becomes <code>\\</code>.  But what about \u2200 and \u039b?</p>\n\n<p>By default, in Haskell, all the \u2200s are implicit.  Every time we refer to a type variable (a lower-case identifier in a type), it's implicitly universally quantified.  So a type signature like</p>\n\n<pre><code>id :: a -&gt; a\n</code></pre>\n\n<p>corresponds to</p>\n\n<p>id : \u2200\u03b1.\u03b1\u2192\u03b1</p>\n\n<p>in System F.  We can turn on the language extension <code>ExplicitForAll</code> and gain the ability to write those explicitly:</p>\n\n<pre><code>{-# LANGUAGE ExplicitForAll #-}\nid :: forall a. a -&gt; a\n</code></pre>\n\n<p>By default, however, Haskell only lets us put those quantifiers at the start of our definitions; we want the System F-style ability to put <code>forall</code>s anywhere in our types.  For this, we turn on <code>RankNTypes</code>.  In fact, all Haskell code from now on will use</p>\n\n<pre><code>{-# LANGUAGE RankNTypes, TypeOperators #-}\n</code></pre>\n\n<p>(The other extension allows type names to be operators.)</p>\n\n<p>Now that we know all that, we can try to write down the definition of \u00d7.  I'll call its Haskell version <code>**</code> to keep things distinct (although we could use <code>\u00d7</code> if we wanted).  Selinger's definition is</p>\n\n<p>A\u00d7B = \u2200\u03b1.(A\u2192B\u2192\u03b1)\u2192\u03b1</p>\n\n<p>so the Haskell is</p>\n\n<pre><code>type a ** b = forall \u03b1. (a -&gt; b -&gt; \u03b1) -&gt; \u03b1\n</code></pre>\n\n<p>And as you said, the creation function is</p>\n\n<pre><code>pair :: a -&gt; b -&gt; a ** b\npair x y f = f x y\n</code></pre>\n\n<p>But what happened to our \u039bs?  They're there in the System F definition of \u27e8M,N\u27e9, but <code>pair</code> doesn't have any!</p>\n\n<p>So this is the last cell in our table: in Haskell, <em>all \u039bs are implicit</em>, and there's not even an extension to make them explicit.\u00b9  Anywhere they would show up, we just ignore them, and <em>type inference</em> fills them in automatically.  So, to answer one of your explicit questions directly, you use the Haskell <code>forall</code> to represent the System F \u2200, and <em>nothing</em> to represent the System F type lambda \u039b.</p>\n\n<p>So you give the definition of the first projection as (reformatted)</p>\n\n<p>proj\u2081 = \u039b\u03b1.\u039b\u03b2.\u03bbp:\u03b1\u00d7\u03b2.p \u03b1 (\u03bbx:\u03b1.\u03bby:\u03b2.x)</p>\n\n<p>We translate this to Haskell by ignoring all \u039bs <em>and their applications</em> (and eliding type annotations\u00b2), and we get</p>\n\n<pre><code>proj\u2081 = \\p. p (\\x y -&gt; x)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>proj\u2081 p = p (\\x _ -&gt; x)\n</code></pre>\n\n<p>Our System F version has the type</p>\n\n<p>proj\u2081 : \u2200\u03b1.\u2200\u03b2. \u03b1\u00d7\u03b2 \u2192 \u03b1</p>\n\n<p>or, expanded</p>\n\n<p>proj\u2081 : \u2200\u03b1.\u2200\u03b2. (\u2200\u03b3. \u03b1 \u2192 \u03b2 \u2192 \u03b3) \u2192 \u03b1</p>\n\n<p>and indeed, our Haskell version has the type</p>\n\n<pre><code>proj\u2081 :: \u03b1 ** \u03b2 -&gt; \u03b1\n</code></pre>\n\n<p>which again expands to</p>\n\n<pre><code>proj\u2081 :: (forall \u03b3. \u03b1 -&gt; \u03b2 -&gt; \u03b3) -&gt; \u03b1\n</code></pre>\n\n<p>or, to make the binding of <code>\u03b1</code> and <code>\u03b2</code> explicit,</p>\n\n<pre><code>proj\u2081 :: forall \u03b1 \u03b2. (forall \u03b3. \u03b1 -&gt; \u03b2 -&gt; \u03b3) -&gt; \u03b1\n</code></pre>\n\n<p>And for completeness, we also have</p>\n\n<p>proj\u2082 : \u2200\u03b1.\u2200\u03b2. \u03b1\u00d7\u03b2 \u2192 \u03b2<br>\nproj\u2082 = \u039b\u03b1.\u039b\u03b2.\u03bbp:\u03b1\u00d7\u03b2.p \u03b2 (\u03bbx:\u03b1.\u03bby:\u03b2.y)</p>\n\n<p>which becomes</p>\n\n<pre><code>proj\u2082 :: \u03b1 ** \u03b2 -&gt; \u03b2\nproj\u2082 p = p (\\_ y -&gt; y)\n</code></pre>\n\n<p>which is probably unsurprising at this point :-)</p>\n\n<hr/>\n\n<p>\u00b9 Relatedly, all \u039bs can be <em>erased</em> at compile time \u2013 type information is not present in compiled Haskell code!</p>\n\n<p>\u00b2 The fact that we elide \u039bs means that type variables <em>aren't bound</em> in the terms.  The following is an error:</p>\n\n<pre><code>id :: a -&gt; a\nid x = x :: a\n</code></pre>\n\n<p>because it's treated as though we'd written</p>\n\n<pre><code>id :: forall a. a -&gt; a\nid x = x :: forall b. b\n</code></pre>\n\n<p>which of course doesn't work.  To get around this, we can turn on the language extension <code>ScopedTypeVariables</code>; then, any type variables bound in an explicit <code>forall</code> are in scope in the term.  So the first example still breaks, but</p>\n\n<pre><code>id :: forall a. a -&gt; a\nid x = x :: a\n</code></pre>\n\n<p>works fine.</p>\n"}], "owner": {"reputation": 2184, "user_id": 336563, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8a313d0510dd29f947c270146be859?s=128&d=identicon&r=PG", "display_name": "ziggurism", "link": "https://stackoverflow.com/users/336563/ziggurism"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 1, "accepted_answer_id": 33658834, "answer_count": 2, "score": 5, "last_activity_date": 1447551695, "creation_date": 1447265230, "last_edit_date": 1495541748, "question_id": 33656979, "link": "https://stackoverflow.com/questions/33656979/implement-in-haskell-the-church-encoding-of-the-pair-for-polymorphic-%ce%bb-calculus", "title": "Implement in Haskell the Church encoding of the pair for polymorphic \u03bb-calculus/System F", "body": "<p>I want to implement the <a href=\"https://en.wikipedia.org/wiki/Church_encoding#Church_pairs\" rel=\"nofollow noreferrer\">Church encoding of the pair</a> in polymorphic lambda calculus in Haskell.</p>\n\n<p>On page 77, section 8.3.3 of <a href=\"http://www.mathstat.dal.ca/~selinger/papers/lambdanotes.pdf\" rel=\"nofollow noreferrer\">Peter Selinger's notes on lambda calculus</a>, he gives a construction of the cartesian product of two types as </p>\n\n<p>A\u00d7B = \u2200\u03b1.(A\u2192B\u2192\u03b1)\u2192\u03b1<br/>\n\u27e8M,N\u27e9 = \u039b\u03b1.\u03bbf<sup>A\u2192B\u2192\u03b1</sup>.fMN</p>\n\n<p>For another source, on page 54, section 4.2.3 of <a href=\"http://gallium.inria.fr/~remy/mpri/cours2.pdf\" rel=\"nofollow noreferrer\">Dider R\u00e9my's notes on lambda calculus</a>, he defines the Church encoding of the pair in polymorphic \u03bb-calculus/System F as </p>\n\n<p>\u039b\u03b1\u2081.\u039b\u03b1\u2082.\u03bbx\u2081\u2236\u03b1\u2081.\u03bbx\u2082\u2236\u03b1\u2082.\u039b\u03b2.\u03bby\u2236\u03b1\u2081\u2192\u03b1\u2082\u2192\u03b2. y x\u2081 x\u2082</p>\n\n<p>I think R\u00e9my is saying the same thing, just more verbosely, as Selinger.</p>\n\n<p>Anyway, according to Wikipedia, the type system for Haskell is based on <a href=\"https://en.wikipedia.org/wiki/System_F\" rel=\"nofollow noreferrer\">System F</a>, so I am hoping it is possible to implement this Church encoding directly in Haskell. I've got:</p>\n\n<pre><code>pair :: a-&gt;b-&gt;(a-&gt;b-&gt;c)-&gt;c\npair x y f = f x y\n</code></pre>\n\n<p>but I wasn't sure how to do the projections. </p>\n\n<p>\u039b\u03b1.\u039b\u03b2.\u03bbp<sup>\u03b1\u00d7\u03b2</sup>.p\u03b1(\u03bbx<sup>\u03b1</sup>.\u03bby<sup>\u03b2</sup>.x)</p>\n\n<p>Do I use the Haskell <code>forall</code> for the capital lambda type quantifier?</p>\n\n<p>This is basically the same as <a href=\"https://stackoverflow.com/questions/33597144/swift-higher-order-function-church-pair-aka-cons-with-generic-parameter-types\">my previous question</a>, but in Haskell instead of Swift. I thought the additional context and the change of venue might make it more sensible.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 178, "user_id": 4556658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176748782a450651ab1ef750943e5f35?s=128&d=identicon&r=PG&f=1", "display_name": "sdx23", "link": "https://stackoverflow.com/users/4556658/sdx23"}, "edited": false, "score": 6, "creation_date": 1447264904, "post_id": 33656612, "comment_id": 55086982, "body": "you are likely not in the correct directory. check with <code>dir</code> whether the file is really there..."}], "owner": {"reputation": 29, "user_id": 5551673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c9560beb2d9908ac16f0f4e9ad91e7b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael A", "link": "https://stackoverflow.com/users/5551673/michael-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 872, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1447268365, "creation_date": 1447263988, "last_edit_date": 1447268365, "question_id": 33656612, "link": "https://stackoverflow.com/questions/33656612/haskell-cant-find-file-test-hs", "title": "Haskell - Can&#39;t find file test.hs", "body": "<p>I just started with haskell. Now im trying to set things up at home. So I write my code in <strong>sublimetext 3</strong> and try and load it from <strong>cmd</strong>. Then I get the message, </p>\n\n<pre><code>&lt;no location info&gt;: can't find file: test.hs\nFailed, modules loaded: none.\n</code></pre>\n\n<p>My file is named test.hs and this is all the code it contains:</p>\n\n<pre><code>double :: Int -&gt; Int\n\ndouble x = x + xb\n</code></pre>\n\n<p>Thanks in advance \n/Michael</p>\n"}, {"tags": ["haskell", "caching", "yesod"], "comments": [{"owner": {"reputation": 1378, "user_id": 2195721, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37ff0c10acb6603393e11b44132b23cb?s=128&d=identicon&r=PG", "display_name": "Cthulhu", "link": "https://stackoverflow.com/users/2195721/cthulhu"}, "edited": false, "score": 0, "creation_date": 1472083997, "post_id": 33655589, "comment_id": 65614902, "body": "Didn&#39;t really read code inside the question (since I had a problem with <code>cached</code> too). Someone is going to get really easy 200 points."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 3, "last_activity_date": 1472196190, "creation_date": 1472196190, "answer_id": 39160599, "question_id": 33655589, "link": "https://stackoverflow.com/questions/33655589/how-to-use-yesod-per-request-caching/39160599#39160599", "title": "How to use yesod per-request caching?", "body": "<p>I'm pretty new to Yesod, but I think you just need to tweak <code>getBob</code></p>\n\n<pre><code>getBob :: Handler BobId\ngetBob = unCachedBobId &lt;$&gt; cached (CachedBobId &lt;$&gt; getBob')\n</code></pre>\n\n<p>The problem is that your current <code>getBob</code> function starts its <code>do</code> block with <code>a &lt;- getBob'</code>. Remember that a <code>do</code> block sequences monadic actions, so you actually end up calling <code>getBob'</code> first thing every time <code>getBob</code> is called. In an ironic twist, after you've done this, you create a cached version of a handler which returns what you just got from <code>getBob'</code>, but end up querying that cached version exactly once (right afterwards with <code>c &lt;- cached b</code>), then it just falls out of scope and the garbage collector gets it.</p>\n\n<p>In the solution I present above, you wrap whatever <code>getBob'</code> gives you in <code>CachedBobId</code>. Then, you pass that handler <code>CachedBobId &lt;$&gt; getBob' :: Handler (CachedBobId BobId)</code>, to <code>cached</code>, which gives you back another handler <code>cached (CachedBobId &lt;$&gt; getBob')</code> of the same type, but with caching. Finally, you extract whatever the cached handler gives you to get back a <code>Handler BobId</code>.</p>\n"}], "owner": {"reputation": 226, "user_id": 2936306, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/907ac0b7e1ec4827e6725dcbd2be9703?s=128&d=identicon&r=PG&f=1", "display_name": "user2936306", "link": "https://stackoverflow.com/users/2936306/user2936306"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 2, "answer_count": 1, "score": 7, "last_activity_date": 1472196190, "creation_date": 1447260686, "last_edit_date": 1447667887, "question_id": 33655589, "link": "https://stackoverflow.com/questions/33655589/how-to-use-yesod-per-request-caching", "title": "How to use yesod per-request caching?", "body": "<p>I'm trying to use the <code>cached</code> function to prevent multiple db queries in different widgets and handlers:</p>\n\n<pre><code>newtype CachedBobId key\n    = CachedBobId { unCachedBobId :: key }\n    deriving Typeable\n\ngetBob' :: Handler BobId\ngetBob' = do\n    uncle &lt;- runInputGet $ ireq textField \"bobsuncle\"\n    (Entity bob _) &lt;- runDB $ getBy404 $ UniqueBob uncle\n    return bob\n\ngetBob :: Handler BobId\ngetBob = do\n    a &lt;- getBob'\n    let b = return $ CachedBobId a\n    c &lt;- cached b\n    return $ unCachedBobId c\n</code></pre>\n\n<p>And in a widget somewhere:</p>\n\n<pre><code>renderDerp :: Widget\nrenderDerp = do\n    --these are used in the shakespeare files\n    lolBob &lt;- handlerToWidget $ getBob\n    nutherBob &lt;- handlerToWidget $ getBob\n    $(widgetFile \"test\")\n</code></pre>\n\n<p>This compiles but the query to get the ID still runs multiple times.</p>\n\n<p>What am I doing wrong? Or is there a better way to only get bob once and use him in every handler and widget?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447259358, "post_id": 33654926, "comment_id": 55083568, "body": "If you have no constraint - on a, b, c this is not possible but you should have a look at <code>groupBy</code>"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 2, "creation_date": 1447259413, "post_id": 33654926, "comment_id": 55083618, "body": "Can you write or do you have available a simpler group-by function, i.e. <code>[(a,b)] -&gt; [ (a, [b]) ]</code>?"}, {"owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447261759, "post_id": 33654926, "comment_id": 55085091, "body": "@epsilonhalbe I added the constraints. I don&#39;t think I need a constraint on c though."}], "answers": [{"tags": [], "owner": {"reputation": 1617, "user_id": 2239956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5132d21c85f66d0d10ab0c8069c59?s=128&d=identicon&r=PG", "display_name": "drquicksilver", "link": "https://stackoverflow.com/users/2239956/drquicksilver"}, "is_accepted": false, "score": 5, "last_activity_date": 1447313163, "last_edit_date": 1447313163, "creation_date": 1447263064, "answer_id": 33656332, "question_id": 33654926, "link": "https://stackoverflow.com/questions/33654926/how-to-un-flatten-a-list/33656332#33656332", "title": "How to un-flatten a list", "body": "<p>Personally I'd put that data into a nested map. You can always pull it out again into nested association lists afterwards.</p>\n\n<p>First convert each item into a (small) nested map with 1 element in the list <code>[c]</code>:</p>\n\n<pre><code>import qualified Data.Map as M\nimport Data.List\n\ntriplesToMaps :: [(a,b,c)] -&gt; [M.Map a (M.Map b [c])]\ntriplesToMaps = map (\\(a,b,c) -&gt; M.singleton a (M.singleton b [c]))\n</code></pre>\n\n<p>then combine them all using <code>unionWith</code></p>\n\n<pre><code>combineMaps :: (Ord a, Ord b) =&gt; [M.Map a (M.Map b [c])] -&gt; M.Map a (M.Map b [c])\ncombineMaps = foldl' (M.unionWith (M.unionWith (++))) M.empty\n</code></pre>\n\n<p>and then, if you want, bring it back to lists:</p>\n\n<pre><code>flattenToLists :: M.Map a (M.Map b [c]) -&gt; [(a,[(b,[c])])]\nflattenToLists = M.assocs . (M.map M.assocs)\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>&gt; flattenToLists . combineMaps . triplesToMaps $ [(1,2,3),(1,2,4),(1,3,5),(2,6,8)]\n[(1,[(2,[3,4]),(3,[5])]),(2,[(6,[8])])]\n</code></pre>\n\n<p>In practice you probably wouldn't <code>flattenToLists</code> because the nested map is the more useful structure.</p>\n\n<p>Incidentally, if <code>Map</code> had the \"right\" Monoid structure then <code>M.unionWith (M.unionWith (++))</code> would just be <code>mappend</code>, and the whole thing could be <code>foldMap (\\(a,b,c) -&gt; M.singleton a (M.singleton b [c]))</code>.</p>\n\n<p>[edited : added the dual as in the question]</p>\n\n<p>Oh, and to go back to <code>[(a,b,c)]</code> two approaches spring to mind. The list comprehension just like yours, but using <code>assocs</code>:</p>\n\n<pre><code>flatten :: M.Map a (M.Map b [c]) -&gt; [(a,b,c)]\nflatten m = [(a,b,c) | (a,bcs) &lt;- M.assocs m, (b,cs) &lt;- M.assocs bcs, c &lt;- cs]\n</code></pre>\n\n<p>or the version using foldMap:</p>\n\n<pre><code>flatten' :: M.Map a (M.Map b [c]) -&gt; [(a,b,c)]\nflatten' = M.foldMapWithKey (\\a -&gt; M.foldMapWithKey (\\b -&gt; foldMap (\\c -&gt; [(a,b,c)])))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "is_accepted": true, "score": 0, "last_activity_date": 1447573477, "creation_date": 1447573477, "answer_id": 33717502, "question_id": 33654926, "link": "https://stackoverflow.com/questions/33654926/how-to-un-flatten-a-list/33717502#33717502", "title": "How to un-flatten a list", "body": "<p>Following ErikR's advice, a pattern emerged how to extend it to longer and longer tuples.</p>\n\n<pre><code>-- construct some raw material\nl a i = map ((a ++) . show) [1..i]\nl4 = [(a,b,c,d) | d&lt;-l \"d\" 3, c &lt;- l \"c\" 3, b&lt;-l \"b\" 3, a&lt;-l \"a\" 2 ]\n\ngrp2 :: Ord a =&gt; [(a,b)] -&gt; [(a,[b])]\ngrp2 xs = do\n    a &lt;- (nub . sort . map fst) xs \n    let bs = [b' | (a',b') &lt;- xs, a'==a]\n    return (a,bs)\n\ngrp3 :: (Ord a, Ord b) =&gt; [(a,b,c)] -&gt; [(a,[(b,[c])])]\ngrp3 ys = do\n    (a, bcs) &lt;- grp2 (map split3 ys)\n    return (a, grp2 bcs)\n          where\n              split3 (a,b,c) = (a,(b,c))\n\ngrp4 :: (Ord a, Ord b, Ord c) =&gt; [(a,b,c,d)] -&gt; [(a,[(b,[(c,[d])])])]\ngrp4 zs = do\n    (a, bcds) &lt;- grp2 (map split4 zs)\n    return (a, grp3 bcds)\n          where\n              split4 (a,b,c,d) = (a,(b,c,d))\n</code></pre>\n\n<p>Now</p>\n\n<pre><code>*Main&gt; pp $ grp4 l4\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>[ ( \"a1\"\n  , [ ( \"b1\"\n      , [ ( \"c1\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        , ( \"c2\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        , ( \"c3\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        ]\n      )\n    , ( \"b2\"\n      , [ ( \"c1\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        , ( \"c2\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        , ( \"c3\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        ]\n      )\n    , ( \"b3\"\n      , [ ( \"c1\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        , ( \"c2\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        , ( \"c3\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        ]\n      )\n    ]\n  )\n, ( \"a2\"\n  , [ ( \"b1\"\n      , [ ( \"c1\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        , ( \"c2\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        , ( \"c3\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        ]\n      )\n    , ( \"b2\"\n      , [ ( \"c1\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        , ( \"c2\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        , ( \"c3\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        ]\n      )\n    , ( \"b3\"\n      , [ ( \"c1\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        , ( \"c2\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        , ( \"c3\" , [ \"d1\" , \"d2\" , \"d3\" ] )\n        ]\n      )\n    ]\n  )\n]\n</code></pre>\n"}], "owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "accepted_answer_id": 33717502, "answer_count": 2, "score": 0, "last_activity_date": 1447573477, "creation_date": 1447258649, "last_edit_date": 1447322694, "question_id": 33654926, "link": "https://stackoverflow.com/questions/33654926/how-to-un-flatten-a-list", "title": "How to un-flatten a list", "body": "<p>I can flatten a nested data structure with ease, but the dual operation seems awfully difficult (at least for me).</p>\n\n<p>Given a List of type <code>[(a,b,c)]</code>, how can I create a nested structure, i.e.</p>\n\n<pre><code>unflatten :: (Ord a, Ord b) =&gt; [(a,b,c)] -&gt; [(a, [(b, [c])])]\n</code></pre>\n\n<p>such that each <code>a</code> only occurs only once and likewise each combination of <code>(a,b)</code> </p>\n\n<p>I don't quite know why I am struggling with this, because the dual operation is really simple</p>\n\n<pre><code>flatten :: [(a, [(b, [c])])] -&gt; [(a,b,c)]\nflatten xs = [(a,b,c) | (a,bcs) &lt;- xs, (b,cs) &lt;- bcs, c&lt;-cs]\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>Following EricR's suggestion I wrote a function which does one level of un-flattening, but I am still struggling to extend it</p>\n\n<pre><code>grp :: Ord b =&gt; [(b,c)] -&gt; [(b,[c])]\ngrp xs = do\n    b &lt;- (nub . sort . map fst) xs \n    let cs = [c' | (b',c') &lt;- xs, b'==b]\n    return (b,cs)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1447257175, "post_id": 33654362, "comment_id": 55082045, "body": "Just change <code>[a]</code> to <code>[]</code>."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1447257229, "post_id": 33654362, "comment_id": 55082074, "body": "As the error message points out, <code>PrependableList</code> expects a unary type constructor (<code>* -&gt; *</code>), not a nullary one (<code>*</code>). Therefore, you should write <code>instance PrependableList []</code> and instance <code>PrependableList Seq.Seq</code>. Also, your code snippet won&#39;t compile unless you use the qualified name of the <code>&lt;|</code> operator, i.e. <code>Seq.&lt;|</code>."}, {"owner": {"reputation": 221, "user_id": 450824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb4303f7cae7188d29a3bf1bd3959e6?s=128&d=identicon&r=PG", "display_name": "Albert Cardona", "link": "https://stackoverflow.com/users/450824/albert-cardona"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1447257396, "post_id": 33654362, "comment_id": 55082188, "body": "Thanks @MathematicalOrchid, indeed that overcomes the compilation error. The next issue is then how to use PrependableList in a type definition of a function. When I add &quot;PrependableList a&quot;, the compiler points out another kind mismatch: &quot;Kind mis-match     The first argument of <code>PrependableList&#39; should have kind </code>* -&gt; <i>&#39;,     but <code>a&#39; has kind </code></i>&#39;&quot;   (Can&#39;t make asterisks show properly)"}, {"owner": {"reputation": 221, "user_id": 450824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb4303f7cae7188d29a3bf1bd3959e6?s=128&d=identicon&r=PG", "display_name": "Albert Cardona", "link": "https://stackoverflow.com/users/450824/albert-cardona"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1447257603, "post_id": 33654362, "comment_id": 55082338, "body": "Thanks @Jubobs -- fixed the Seq.&lt;| issue."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1447257896, "post_id": 33654362, "comment_id": 55082551, "body": "@AlbertCardona You want something like <code>PrependableList pl =&gt; pl a</code>."}, {"owner": {"reputation": 221, "user_id": 450824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb4303f7cae7188d29a3bf1bd3959e6?s=128&d=identicon&r=PG", "display_name": "Albert Cardona", "link": "https://stackoverflow.com/users/450824/albert-cardona"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1447258130, "post_id": 33654362, "comment_id": 55082689, "body": "Thank you @MathematicalOrchid that was the last conceptual leap to go through."}, {"owner": {"reputation": 1617, "user_id": 2239956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5132d21c85f66d0d10ab0c8069c59?s=128&d=identicon&r=PG", "display_name": "drquicksilver", "link": "https://stackoverflow.com/users/2239956/drquicksilver"}, "edited": false, "score": 0, "creation_date": 1447258143, "post_id": 33654362, "comment_id": 55082696, "body": "Incidentally - <a href=\"https://hackage.haskell.org/package/lens-4.13/docs/Control-Lens-Cons.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/lens-4.13/docs/&hellip;</a> - but maybe that won&#39;t suit you."}], "answers": [{"tags": [], "owner": {"reputation": 221, "user_id": 450824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb4303f7cae7188d29a3bf1bd3959e6?s=128&d=identicon&r=PG", "display_name": "Albert Cardona", "link": "https://stackoverflow.com/users/450824/albert-cardona"}, "is_accepted": false, "score": 2, "last_activity_date": 1447258964, "creation_date": 1447258964, "answer_id": 33655027, "question_id": 33654362, "link": "https://stackoverflow.com/questions/33654362/minimal-interface-over-data-list-and-data-sequence-in-haskell-for-prependable-li/33655027#33655027", "title": "Minimal interface over Data.List and Data.Sequence in Haskell for prependable lists", "body": "<p>Thanks to you all, this is the correct code with a minimal example of usage:</p>\n\n<pre><code>    import qualified Data.Sequence as Seq\n\n    class PrependableList pl where\n        empty :: pl a\n        first ::  pl a -&gt; a\n        prepend :: a -&gt; pl a -&gt; pl a\n        len :: pl a -&gt; Int\n\n    instance PrependableList [] where\n        empty = []\n        first = head\n        prepend = (:)\n        len = length\n\n    instance PrependableList Seq.Seq where\n        empty = Seq.empty\n        first seq = Seq.index seq 0\n        prepend = (Seq.&lt;|)\n        len = Seq.length\n\n    -- Example usage\n    prependAll :: (PrependableList pl) =&gt; pl a -&gt; [a] -&gt; pl a\n    prependAll plist xs = foldr prepend plist xs\n\n    main = do\n        print $ prependAll Seq.empty [1..5]\n        print $ prependAll [] [1..5]\n</code></pre>\n\n<p>Which prints:</p>\n\n<pre><code>$ ./pl \nfromList [1,2,3,4,5]\n[1,2,3,4,5]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": false, "score": 2, "last_activity_date": 1447282469, "creation_date": 1447282469, "answer_id": 33661388, "question_id": 33654362, "link": "https://stackoverflow.com/questions/33654362/minimal-interface-over-data-list-and-data-sequence-in-haskell-for-prependable-li/33661388#33661388", "title": "Minimal interface over Data.List and Data.Sequence in Haskell for prependable lists", "body": "<p>\nI know you've already answered this for yourself, but I wanted to point out Haskell has been evolving in recent years to try to encapsulate these ideas much more broadly, and your class is already a combination of two other existing classes:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Control.Monad (MonadPlus, mzero, mplus);\nimport Data.Foldable (Foldable, length, toList);\nimport Data.Sequence (Seq)\nimport qualified Data.Sequence as S\n\n-- same as your PrependableList\nclass Prependable p where\n    empty :: p a\n    first ::  p a -&gt; a\n    prepend :: a -&gt; p a -&gt; p a\n    len :: p a -&gt; Int\n\n-- generic newtype wrapper\nnewtype WrapP p x = WrapP { unwrapP :: p x } deriving (Show, Eq, Ord)\n\n-- any foldable monadplus is prependable.\ninstance (MonadPlus m, Foldable m) =&gt; Prependable (WrapP m) where\n    empty = WrapP mzero\n    prepend = (WrapP .) . (. unwrapP) . mplus . return\n    first = head . toList . unwrapP\n    len = length . unwrapP \n\n-- specific cases\ntype SeqP x = WrapP Seq x\ntype ListP x = WrapP [] x\n</code></pre>\n\n<p>Furthermore since <code>WrapP</code> is a <code>newtype</code> you can usually replace <code>WrapP</code> and <code>unwrapP</code> with <code>id</code> as long as you also adjust the type signature; in particular we can write your four functions directly as:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>empty   :: (Foldable m, MonadPlus m) =&gt; m x\nempty = mzero\nfirst   :: (Foldable m, MonadPlus m) =&gt; m x -&gt; x\nfirst = head . toList\nprepend :: (Foldable m, MonadPlus m) =&gt; x -&gt; m x -&gt; m x\nprepend = mplus . return\nlen     :: (Foldable m, MonadPlus m) =&gt; m x -&gt; Int\nlen = length\n</code></pre>\n\n<p>and these now natively will work on both lists and Data.Sequence. (You may need a newer-ish version of GHC if <code>Prelude.length</code> is not the same as <code>Data.Foldable.length</code>, or else you have to import the Prelude  hiding <code>length</code> which you then explicitly import from Data.Foldable.</p>\n\n<p>As <code>Data.Sequence</code> already defines both <code>MonadPlus</code> and <code>Foldable</code> for <code>Seq</code>, you're good to go in 8 lines of code with no new classes or instance declarations; moreover two of them are direct substitutions (<code>len</code> for <code>length</code>, <code>empty</code> for <code>mzero</code>), saving 4 more lines of code if you simply use the versions that were already defined for you.</p>\n\n<p>(As a slight detour, <code>first</code> is also <code>extract</code> from <code>Control.Comonad</code>, with a (non-empty!) list's <code>extract</code> being <code>head</code> and its <code>duplicate</code> being <code>takeWhile (not . null) . tails</code> (using <code>Data.List.tails</code> but neglecting the last element <code>[]</code>). I don't think you can define <code>len</code> based purely on a <code>Comonad</code> infrastructure though; for that you would really need a <code>Foldable</code> type. A non-empty list can be put in a manifestly comonad form by writing it as <code>newtype NEList = NEList x (Maybe (NEList x))</code>, where we can then replace <code>NEList</code> with <code>Cofree Maybe</code> to see that it's a comonad.)</p>\n"}], "owner": {"reputation": 221, "user_id": 450824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb4303f7cae7188d29a3bf1bd3959e6?s=128&d=identicon&r=PG", "display_name": "Albert Cardona", "link": "https://stackoverflow.com/users/450824/albert-cardona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1447282469, "creation_date": 1447256915, "last_edit_date": 1447257530, "question_id": 33654362, "link": "https://stackoverflow.com/questions/33654362/minimal-interface-over-data-list-and-data-sequence-in-haskell-for-prependable-li", "title": "Minimal interface over Data.List and Data.Sequence in Haskell for prependable lists", "body": "<p>I find that I am writing duplicate functions to handle Data.List and Data.Sequence, and in an attempt to generalize over them, I wrote:</p>\n\n<pre><code>import qualified Data.Sequence as Seq\n\nclass PrependableList pl where\n  empty :: pl a\n  first ::  pl a -&gt; a\n  prepend :: a -&gt; pl a -&gt; pl a\n  len :: pl a -&gt; Int\n\ninstance PrependableList [a] where\n  empty = []\n  first = head\n  prepend = (:)\n  len = length\n\ninstance PrependableList (Seq.Seq a) where\n  empty = Seq.empty\n  first seq = Seq.index seq 0\n  prepend = (Seq.&lt;|)\n  len = Seq.length\n</code></pre>\n\n<p>The implementation above does not compile, indicating a kind mismatch:</p>\n\n<pre><code>Kind mis-match\nThe first argument of `PrependableList' should have kind `* -&gt; *',\nbut `[a]' has kind `*'\nIn the instance declaration for `PrependableList [a]'\n\nKind mis-match\nThe first argument of `PrependableList' should have kind `* -&gt; *',\nbut `Seq.Seq a' has kind `*'\nIn the instance declaration for `PrependableList (Seq.Seq a)'\n</code></pre>\n\n<p>From what I have seen in other entries (e.g. <a href=\"https://stackoverflow.com/questions/3623612/in-haskell-why-isnt-there-a-typeclass-for-things-that-can-act-like-lists\">In Haskell, why isn&#39;t there a TypeClass for things that can act like lists?</a>), it might not be possible to generalize completely over multiple list-like data structures.</p>\n\n<p>But could the above 4 functions be generalized at least for Data.List and Data.Sequence?</p>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "edited": false, "score": 1, "creation_date": 1447249038, "post_id": 33651618, "comment_id": 55076640, "body": "Spot on. I thought I could do this but wasn&#39;t sure how I&#39;d achieve it with my limited knowledge. Thanks!"}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 4, "last_activity_date": 1447264597, "last_edit_date": 1447264597, "creation_date": 1447248676, "answer_id": 33651618, "question_id": 33651399, "link": "https://stackoverflow.com/questions/33651399/haskell-typeclass-and-duplicate-behaviour/33651618#33651618", "title": "Haskell typeclass and duplicate behaviour", "body": "<p>You can provide a default implementation for <code>next</code> in the type-class as in:</p>\n\n<pre><code>import Data.Char (chr)\n\nclass (Ord a, Enum a) =&gt; Cyclic a where\n    min', max' :: a\n    next :: a -&gt; a\n    next a = if max' &lt; a' then min' else  a'\n        where a' = succ a\n\ninstance Cyclic Char where\n    min' = chr 65\n    max' = chr 90\n\ninstance Cyclic Int where\n    min' = 0\n    max' = 9\n</code></pre>\n\n<hr>\n\n<p>Alternatively you can use a helper function which implements <code>next</code> within a closure as in:</p>\n\n<pre><code>class Cyclic a where\n    next :: a -&gt; a\n\n-- a helper function to implement next within a closure\ncycl :: (Ord a, Enum a) =&gt; a -&gt; a -&gt; (a -&gt; a)\ncycl min' max' a = if max' &lt; a' then min' else a'\n    where a' = succ a\n\ninstance Cyclic Char where\n    next = cycl (chr 65) (chr 90)\n\ninstance Cyclic Int where\n    next = cycl 0 9\n</code></pre>\n"}], "owner": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 1, "accepted_answer_id": 33651618, "answer_count": 1, "score": 3, "last_activity_date": 1447336659, "creation_date": 1447247982, "last_edit_date": 1447336659, "question_id": 33651399, "link": "https://stackoverflow.com/questions/33651399/haskell-typeclass-and-duplicate-behaviour", "title": "Haskell typeclass and duplicate behaviour", "body": "<p>I'm new to Haskell &amp; trying to generalise some behaviour in a program so as to reduce the amount of code and have a simpler solution overall.</p>\n\n<p>Say I have this type which represents a post code e.g. 'ABC 123':</p>\n\n<pre><code>type PostCode = ((Char, Char, Char), (Int, Int, Int))\n</code></pre>\n\n<p>and the behaviour of a <code>PostCode</code> should be cylic; i.e. <code>AAA 000</code> comes before <code>AAA 001</code>; 'A' to 'Z' for <code>Char</code> should rap-round, as should 0-9 for <code>Int</code>.</p>\n\n<p>I've therefore extraced this type class:</p>\n\n<pre><code>class Cyclic a where\n    next :: a -&gt; a\n</code></pre>\n\n<p>which is simple enough.</p>\n\n<p>So I then have an <code>instance</code> for each:</p>\n\n<pre><code>-- import Data.Char\ninstance Cyclic Char where\n    next c = chr n\n      where nxt = (ord c) + 1\n            min  = 65\n            max  = 90\n            n    = if (nxt &gt; max) then min else nxt\n\ninstance Cyclic Int where\n    next i = n\n      where nxt = i + 1\n            min  = 0\n            max  = 9\n            n    = if (nxt &gt; max) then min else nxt\n</code></pre>\n\n<p>which leaves me with several obvious points:</p>\n\n<ul>\n<li><p>the concept of <code>min</code> and <code>max</code> is duplicated</p></li>\n<li><p>next is reimplemented for <code>Int</code> when the only real difference is the values of its min and max, as well as the type</p></li>\n</ul>\n\n<p>How can I abstract this behaviour correctly? Is there a way to have the cyclic behaviour for both <code>Int</code> and <code>Char</code> without having two differing implementations? What other Haskell features might I use instead?</p>\n"}, {"tags": ["haskell", "io", "applicative"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447246265, "post_id": 33650797, "comment_id": 55075150, "body": "there is a shortcut <code>putStrLn . show == print</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5550532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e55cdc7f141a0633d99dad31e91e2?s=128&d=identicon&r=PG&f=1", "display_name": "George Ni", "link": "https://stackoverflow.com/users/5550532/george-ni"}, "edited": false, "score": 0, "creation_date": 1447247583, "post_id": 33650882, "comment_id": 55075845, "body": "Is there some more concise or &#39;Haskelish&#39; form to write this (possibly as a whole and not just the sequencing assuming the list of results is actually a return value of some <code>foo</code>)?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 13, "user_id": 5550532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e55cdc7f141a0633d99dad31e91e2?s=128&d=identicon&r=PG&f=1", "display_name": "George Ni", "link": "https://stackoverflow.com/users/5550532/george-ni"}, "edited": false, "score": 0, "creation_date": 1447247933, "post_id": 33650882, "comment_id": 55076022, "body": "I think <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:sequence\" rel=\"nofollow noreferrer\"><code>sequence</code></a> <b>is</b> just this (if you have your list  <code>actions :: [IO foo]</code>s then <code>sequence actions :: IO [foo]</code> so you will get a list with your <code>foo</code>s - of course you would want to use it like <code>foos &lt;- sequence actions</code> inside <code>main</code>s do block then)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 13, "user_id": 5550532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e55cdc7f141a0633d99dad31e91e2?s=128&d=identicon&r=PG&f=1", "display_name": "George Ni", "link": "https://stackoverflow.com/users/5550532/george-ni"}, "edited": false, "score": 0, "creation_date": 1447248731, "post_id": 33650882, "comment_id": 55076457, "body": "@GeorgeNi I have added another version are you talking about this?"}, {"owner": {"reputation": 13, "user_id": 5550532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e55cdc7f141a0633d99dad31e91e2?s=128&d=identicon&r=PG&f=1", "display_name": "George Ni", "link": "https://stackoverflow.com/users/5550532/george-ni"}, "edited": false, "score": 0, "creation_date": 1447250713, "post_id": 33650882, "comment_id": 55077650, "body": "Yes that was exactly what I was hoping for!"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 4, "last_activity_date": 1447249130, "last_edit_date": 1447249130, "creation_date": 1447246129, "answer_id": 33650882, "question_id": 33650797, "link": "https://stackoverflow.com/questions/33650797/call-multiple-io-functions-on-the-same-input/33650882#33650882", "title": "Call multiple IO functions on the same input", "body": "<p>If you look closely <code>res</code> has type <code>[IO ()]</code> and you never use it.</p>\n\n<p>So just <code>sequence</code> it:</p>\n\n<pre><code>main = do\n  let a = [1..5]\n  let fs = [(\\k-&gt; putStrLn $ show $ k*2), (\\k-&gt; putStrLn $ show $ k-2), (\\k-&gt; putStrLn $ show $ k*10)]\n  let res = fs &lt;*&gt; a\n  sequence res\n  putStrLn $ \"Yo\"\n</code></pre>\n\n<hr>\n\n<p>in case you want to know how you could right the complete block more concise than you could refactor the list of mappings (using <em>sections</em>), go with <code>print</code> (which is basically your <code>putStrLn . show</code>) and <code>mapM_</code>:</p>\n\n<pre><code>main = do\n  mapM_ print $ [(* 2), (+ (-2)), (* 10)] &lt;*&gt; [1..5]\n  putStrLn $ \"Yo\"\n</code></pre>\n\n<p>which will give</p>\n\n<pre><code>\u03bb&gt; :main\n2\n4\n6\n8\n10\n-1\n0\n1\n2\n3\n10\n20\n30\n40\n50\nYo\n</code></pre>\n\n<p>as well ;)</p>\n\n<hr>\n\n<p>note that you probably should not mix all the <code>IO</code> stuff with the purer computations - instead I would refactor the list of integers out:</p>\n\n<pre><code>myCombinations :: [Int] -&gt; [Int]\nmyCombinations ns = [(* 2), (+ (-2)), (* 10)] &lt;*&gt; ns\n\nmain = do\n  mapM_ print $ myCombinations [1..5]\n  putStrLn $ \"Yo\"\n</code></pre>\n\n<p>(of course introducing functions as you go along, but I cannot guess what you are trying to achieve here)</p>\n\n<p>from this you gain the ability to just check your pure functions/values:</p>\n\n<pre><code>\u03bb&gt; myCombinations [1..5]\n[2,4,6,8,10,-1,0,1,2,3,10,20,30,40,50]\n</code></pre>\n\n<p>and gain probably a lot of readability ;)</p>\n"}, {"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1447246138, "creation_date": 1447246138, "answer_id": 33650886, "question_id": 33650797, "link": "https://stackoverflow.com/questions/33650797/call-multiple-io-functions-on-the-same-input/33650886#33650886", "title": "Call multiple IO functions on the same input", "body": "<p>If you have a list of <code>ios :: [a -&gt; IO b]</code> you could use <code>mapM ($ aValue) ios</code> to get <code>IO [b]</code> or <code>mapM_</code> to get <code>IO ()</code></p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 0, "last_activity_date": 1447246183, "creation_date": 1447246183, "answer_id": 33650898, "question_id": 33650797, "link": "https://stackoverflow.com/questions/33650797/call-multiple-io-functions-on-the-same-input/33650898#33650898", "title": "Call multiple IO functions on the same input", "body": "<p><code>let</code> doesn't bind anything into the monad. So <code>IO</code> doesn't care what you do with <code>&lt;*&gt;</code> to apply functions in a list, as long as you don't use the result in any way in a monad action.</p>\n\n<p>To simply execute a list of actions in... well, <em>sequence</em>, you can use <code>sequence</code>:</p>\n\n<pre><code>    let res = fs &lt;*&gt; a\n    sequence res\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5550532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5e55cdc7f141a0633d99dad31e91e2?s=128&d=identicon&r=PG&f=1", "display_name": "George Ni", "link": "https://stackoverflow.com/users/5550532/george-ni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 1, "accepted_answer_id": 33650882, "answer_count": 3, "score": 1, "last_activity_date": 1447249130, "creation_date": 1447245785, "question_id": 33650797, "link": "https://stackoverflow.com/questions/33650797/call-multiple-io-functions-on-the-same-input", "title": "Call multiple IO functions on the same input", "body": "<p>Suppose I have a list of tuples (e.g. <code>[(a,b)]</code>) each a result of some previous computation.</p>\n\n<p>And I want several functions to be applied on each of these elements (e.g one function might print it another send it over the network etc.)</p>\n\n<p>What I've tried:</p>\n\n<pre><code>import Control.Applicative\nmain = do\n          let a = [1..5]\n          let fs = [(\\k-&gt; putStrLn $ show $ k*2), (\\k-&gt; putStrLn $ show $ k-2), (\\k-&gt; putStrLn $ show $ k*10)]\n          let res = fs &lt;*&gt; a \n          putStrLn $ \"Yo\"\n</code></pre>\n\n<p>prints just <code>\"Yo\"</code>.</p>\n"}, {"tags": ["regex", "haskell", "pattern-matching"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4668263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3d75c623a8a78aafd7aff7f36cfa99?s=128&d=identicon&r=PG&f=1", "display_name": "abhinav mehta", "link": "https://stackoverflow.com/users/4668263/abhinav-mehta"}, "edited": false, "score": 0, "creation_date": 1447244901, "post_id": 33650454, "comment_id": 55074473, "body": "Thank you for your answer. What do you mean by parser construction library?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 43, "user_id": 4668263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3d75c623a8a78aafd7aff7f36cfa99?s=128&d=identicon&r=PG&f=1", "display_name": "abhinav mehta", "link": "https://stackoverflow.com/users/4668263/abhinav-mehta"}, "edited": false, "score": 0, "creation_date": 1447245391, "post_id": 33650454, "comment_id": 55074716, "body": "There are libraries like <code>tagsoup</code> which already parse HTML for you. Or there are other libraries like <code>Parsec</code> that let you build new parsers for just about anything (e.g., if you designed your own custom language that you wanted to parse). Or you can write the entire thing yourself from scratch. It depends what you&#39;re trying to achieve."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 2, "last_activity_date": 1447244538, "last_edit_date": 1495540742, "creation_date": 1447244538, "answer_id": 33650454, "question_id": 33650077, "link": "https://stackoverflow.com/questions/33650077/string-search-in-html-for-largest-match-pair/33650454#33650454", "title": "String search in HTML for largest match pair", "body": "<p>The code you wrote matches <em>only</em> a 1-character tag name enclosing a 1-character body.</p>\n\n<pre><code>&lt;p&gt;x&lt;/p&gt;          Matches\n&lt;ul&gt;y&lt;/ul&gt;        Does not match\n&lt;p&gt;xyz&lt;/p&gt;        Does not match\n&lt;body&gt;x&lt;/body&gt;    Does not match\n</code></pre>\n\n<p>I'm guessing that isn't what you want at all.</p>\n\n<p>You can't use pattern-matching to match arbitrary regular expressions; you'll need to use a regex library for that. As I see it, your options are:</p>\n\n<ul>\n<li>Use a real HTML or XML parsing library.</li>\n<li>Use a parser construction library to build a custom parser.</li>\n<li>Use a real regex library. (See <a href=\"https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454\">this</a>.)</li>\n<li>Start writing a simple state-machine by hand.</li>\n</ul>\n\n<p>Which option you choose depends on what you're trying to do. Do you actually want to \"solve\" the problem, or are you just trying to learn how to do stuff in Haskell?</p>\n"}], "owner": {"reputation": 43, "user_id": 4668263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3d75c623a8a78aafd7aff7f36cfa99?s=128&d=identicon&r=PG&f=1", "display_name": "abhinav mehta", "link": "https://stackoverflow.com/users/4668263/abhinav-mehta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 1, "accepted_answer_id": 33650454, "answer_count": 1, "score": 0, "last_activity_date": 1447244538, "creation_date": 1447243050, "question_id": 33650077, "link": "https://stackoverflow.com/questions/33650077/string-search-in-html-for-largest-match-pair", "title": "String search in HTML for largest match pair", "body": "<p>I am interested in parsing a HTML file using Haskell to search for the strings in the tags, for example, I want to get the string between <code>&lt;body&gt;</code>...<code>&lt;/body&gt;</code>. I tried</p>\n\n<pre><code>  getValue :: String -&gt; [String]\n  getValue [] = []\n  getValue '&lt;':x:'&gt;':y:'&lt;':'/':x:'&gt;':z = y:[]:getValue z\n</code></pre>\n\n<p>It will enumerate all the cases if at all. But I am interested in the largest ones which are not subsets of any other output element. How do I do that?</p>\n"}, {"tags": ["haskell", "io"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447240320, "post_id": 33649211, "comment_id": 55072032, "body": "Could you add a well-formulated question with some evidence? Like &quot;Why does file concatenation with ByteStrings is so slow?&quot;"}, {"owner": {"reputation": 328, "user_id": 5325238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c140c79bfe5f68581c03c23be8faa0b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5325238/daniel"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447241552, "post_id": 33649211, "comment_id": 55072713, "body": "@Zeta I updated the text with some time measurements and questions."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1447241872, "post_id": 33649211, "comment_id": 55072874, "body": "What does the program do with the lines <i>after</i> it concatenates them?"}, {"owner": {"reputation": 328, "user_id": 5325238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c140c79bfe5f68581c03c23be8faa0b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5325238/daniel"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1447242206, "post_id": 33649211, "comment_id": 55073069, "body": "@MathematicalOrchid Some trivial string processing like splitting the string and extracting several fields. This processing takes little time, as indicated by <code>0.25 sys</code> in the <code>time</code> output above."}, {"owner": {"reputation": 328, "user_id": 5325238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c140c79bfe5f68581c03c23be8faa0b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5325238/daniel"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1447242497, "post_id": 33649211, "comment_id": 55073237, "body": "@MathematicalOrchid Sure, I&#39;ve tried to remove any string processing steps and just parse those files using the code above, and the problem is still here."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1447243161, "post_id": 33649211, "comment_id": 55073594, "body": "Have a go at running the program with the RTS <code>-s</code> option and tell us what you see."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1447243980, "post_id": 33649211, "comment_id": 55073989, "body": "Nothing obviously wrong. See <a href=\"http://book.realworldhaskell.org/read/profiling-and-optimization.html\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 328, "user_id": 5325238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c140c79bfe5f68581c03c23be8faa0b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5325238/daniel"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1447244536, "post_id": 33649211, "comment_id": 55074290, "body": "@MathematicalOrchid I have updated my question."}, {"owner": {"reputation": 328, "user_id": 5325238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c140c79bfe5f68581c03c23be8faa0b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5325238/daniel"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1447244663, "post_id": 33649211, "comment_id": 55074348, "body": "@PyRulez Could you elaborate and/or provide a solution?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1447244854, "post_id": 33649211, "comment_id": 55074459, "body": "@Daniel Thanks. OK, so you stats say that your program is using a sane amount of RAM, and GC time isn&#39;t what&#39;s killing you. This is good. At this point, I don&#39;t think the bytestring concatenation is what&#39;s taking so long. But without seeing the rest of your program, I can&#39;t really say for sure... The next step is probably to read the GHC manual and turn on some profiling options to see which function(s) are taking too long."}, {"owner": {"reputation": 169, "user_id": 711316, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fa662528f2f8ecddad27a568d037d80f?s=128&d=identicon&r=PG", "display_name": "dfordivam", "link": "https://stackoverflow.com/users/711316/dfordivam"}, "edited": false, "score": 0, "creation_date": 1447248800, "post_id": 33649211, "comment_id": 55076497, "body": "I think the issue lies in &#39;B.concat&#39;. If you can avoid this and instead work on list of ByteString or use Data.ByteString.Builder."}, {"owner": {"reputation": 328, "user_id": 5325238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c140c79bfe5f68581c03c23be8faa0b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5325238/daniel"}, "reply_to_user": {"reputation": 169, "user_id": 711316, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fa662528f2f8ecddad27a568d037d80f?s=128&d=identicon&r=PG", "display_name": "dfordivam", "link": "https://stackoverflow.com/users/711316/dfordivam"}, "edited": false, "score": 0, "creation_date": 1447255353, "post_id": 33649211, "comment_id": 55080754, "body": "@dfordivam Thanks for a nice idea. Removing <code>B.concat</code> resulted in a small speed-up but didn&#39;t help much."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447259072, "post_id": 33649211, "comment_id": 55083355, "body": "Just to make sure are you compiling this with optimizations on?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447260679, "post_id": 33649211, "comment_id": 55084431, "body": "Please include precisely how you compiled and executed your code, and a minimum working example. This really isn&#39;t reproducible."}, {"owner": {"reputation": 328, "user_id": 5325238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c140c79bfe5f68581c03c23be8faa0b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5325238/daniel"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447261922, "post_id": 33649211, "comment_id": 55085184, "body": "@epsilonhalbe Thanks for your comment. The optimizations are on (<code>-O2</code>)."}, {"owner": {"reputation": 328, "user_id": 5325238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c140c79bfe5f68581c03c23be8faa0b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5325238/daniel"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447263518, "post_id": 33649211, "comment_id": 55086158, "body": "@user2407038 Thank you for commenting. You&#39;re right, I should have provided these details. It seems though I&#39;ve managed to find what&#39;s causing the slowness in my case. (It was <code>Data.List.nub</code>.)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1447264073, "post_id": 33649211, "comment_id": 55086482, "body": "@Daniel Indeed, the process of breaking down your bug into a minimum working example will not only help other people with your bug, but in probably 90% of cases it will lead you to discover what the bug is yourself."}], "answers": [{"comments": [{"owner": {"reputation": 328, "user_id": 5325238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c140c79bfe5f68581c03c23be8faa0b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5325238/daniel"}, "edited": false, "score": 0, "creation_date": 1447263591, "post_id": 33654876, "comment_id": 55086199, "body": "Thanks a lot! Your answer helped me to find the place in my processing steps that result in slow execution. Actually, it was <code>nub</code> that worked really slow on the lines of input files. The rest is indeed very fast."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 3, "last_activity_date": 1447258503, "creation_date": 1447258503, "answer_id": 33654876, "question_id": 33649211, "link": "https://stackoverflow.com/questions/33649211/reading-and-processing-multiple-files-in-haskell/33654876#33654876", "title": "Reading and processing multiple files in Haskell", "body": "<p>You should show us exactly what your processing steps are.</p>\n\n<p>This program is very performant even when run on multiple input files of the kind you are using (1.2 MB, 30k lines each):</p>\n\n<pre><code>import Control.Monad\nimport Data.List\nimport System.Environment\nimport qualified Data.ByteString.Char8 as B\n\nreadFiles :: [FilePath] -&gt; IO B.ByteString\nreadFiles = fmap B.concat . mapM B.readFile\n\nmain = do\n    files &lt;- getArgs\n    allLines &lt;- readFiles files\n    print $ foldl' (\\s _ -&gt; s+1) 0 (B.words allLines)\n</code></pre>\n\n<p>Here is how I created the input file:</p>\n\n<pre><code>import Control.Monad\n\nmain = do\n  forM_ [1..30000] $ \\i -&gt; do\n    putStrLn $ unwords [\"line\", show i, \"this is a test of the emergency\"]\n</code></pre>\n\n<p>Run times:</p>\n\n<pre><code>time ./program input               -- 27 milliseconds\ntime ./program input input         -- 49 milliseconds\ntime ./program input input input   -- 69 milliseconds\n</code></pre>\n"}], "owner": {"reputation": 328, "user_id": 5325238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c140c79bfe5f68581c03c23be8faa0b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5325238/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1121, "favorite_count": 1, "accepted_answer_id": 33654876, "answer_count": 1, "score": 3, "last_activity_date": 1447258503, "creation_date": 1447239866, "last_edit_date": 1495540316, "question_id": 33649211, "link": "https://stackoverflow.com/questions/33649211/reading-and-processing-multiple-files-in-haskell", "title": "Reading and processing multiple files in Haskell", "body": "<p><strong>Idea.</strong> Read several files line by line, concatenate them, process the list of lines in all files.</p>\n\n<p><strong>Implementation.</strong> This <a href=\"https://stackoverflow.com/questions/12674709/can-i-read-n-files-lazily-as-a-single-io-operation-in-haskell\">can</a> be implemented this way:</p>\n\n<pre><code>import qualified Data.ByteString.Char8 as B\n\nreadFiles :: [FilePath] -&gt; IO B.ByteString\nreadFiles = fmap B.concat . mapM B.readFile\n\n...\n\nmain = do\n    files &lt;- getArgs\n    allLines &lt;- readFiles files\n</code></pre>\n\n<p><strong>Problem.</strong> This works unbearably slow. What's notable, the real or user time is several orders higher than system time (measured using UNIX <code>time</code>), so I suppose the problem is in spending too much time in IO.\nI didn't manage to find a simple and effective way to solve this problem in Haskell.</p>\n\n<p>For instance, processing two files (30.000 lines and 1.2M each) takes</p>\n\n<pre><code>   20.98 real        18.52 user         0.25 sys\n</code></pre>\n\n<p>This is the output when running <code>+RTS -s</code>:</p>\n\n<pre><code>     157,972,000 bytes allocated in the heap\n       6,153,848 bytes copied during GC\n       5,716,824 bytes maximum residency (4 sample(s))\n       1,740,768 bytes maximum slop\n              10 MB total memory in use (0 MB lost due to fragmentation)\n\n                                    Tot time (elapsed)  Avg pause  Max pause\n  Gen  0       295 colls,     0 par    0.01s    0.01s     0.0000s    0.0006s\n  Gen  1         4 colls,     0 par    0.00s    0.00s     0.0010s    0.0019s\n\n  INIT    time    0.00s  (  0.01s elapsed)\n  MUT     time   16.09s  ( 16.38s elapsed)\n  GC      time    0.01s  (  0.02s elapsed)\n  EXIT    time    0.00s  (  0.00s elapsed)\n  Total   time   16.11s  ( 16.41s elapsed)\n\n  %GC     time       0.1%  (0.1% elapsed)\n\n  Alloc rate    9,815,312 bytes per MUT second\n\n  Productivity  99.9% of total user, 98.1% of total elapsed\n\n       16.41 real        16.10 user         0.12 sys\n</code></pre>\n\n<p>Why is concatenating files using the code above is so slow? \nHow should I write <code>readFiles</code> function in Haskell to make it faster?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447240725, "post_id": 33648969, "comment_id": 55072233, "body": "you can try to make all combination of <code>fromInteger</code> and <code>quot</code>, <code>div</code> and <code>&#47;</code> and see how far you come, and see what results you expect or not - especially negative numbers will give you some insight in how <code>quot</code> and <code>div</code> differ. you can also add your own division algorithms if you have not enough combinations at your hand."}], "answers": [{"tags": [], "owner": {"reputation": 4190, "user_id": 2110623, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a5f1b5f95d5b3bb75901fb546cd1c52d?s=128&d=identicon&r=PG", "display_name": "aochagavia", "link": "https://stackoverflow.com/users/2110623/aochagavia"}, "is_accepted": false, "score": 1, "last_activity_date": 1447241052, "creation_date": 1447241052, "answer_id": 33649513, "question_id": 33648969, "link": "https://stackoverflow.com/questions/33648969/haskell-different-ways-to-convert-division-of-integers-to-double/33649513#33649513", "title": "Haskell: Different ways to convert division of Integers to Double", "body": "<p>The type signature of <code>/</code> is:</p>\n\n<pre><code>(/) :: Fractional a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>This means that, if you want to get a <code>Double</code> from <code>/</code> you will need to provide doubles, not integers. Therefore, I would suggest using a function such as <code>fromIntegral</code>, as shown below:</p>\n\n<pre><code>fromIntegral (5 :: Integer) / fromIntegral (2 :: Integer) == 2.5\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "is_accepted": true, "score": 3, "last_activity_date": 1447241238, "creation_date": 1447241238, "answer_id": 33649564, "question_id": 33648969, "link": "https://stackoverflow.com/questions/33648969/haskell-different-ways-to-convert-division-of-integers-to-double/33649564#33649564", "title": "Haskell: Different ways to convert division of Integers to Double", "body": "<p>The most common approaches involve converting the <code>Integer</code>s to <code>Double</code>s and then dividing them. You can do this through <code>fromIntegral :: (Integral a, Num b) =&gt; a -&gt; b</code>, which takes any value of an integer-like type (e.g. <code>Integer</code>) and turns it into any number-like type (e.g. <code>Double</code>).</p>\n\n<pre><code>let five, three :: Double\n    five = fromIntegral (5 :: Integer)\n    three = fromIntegral (3 :: Integer)\nin five / three\n</code></pre>\n\n<p>Note that <code>fromIntegral = fromInteger . toInteger</code>, where <code>toInteger</code> is part of the <code>Integral</code> class (<code>toInteger</code> turns a value of an integer-like type into the corresponding <code>Integer</code> value), and <code>fromInteger</code> is part of the <code>Num</code> class (<code>fromInteger</code> turns an <code>Integer</code> value into a value of any desired number-like type). In this case, because you already have an <code>Integer</code> value, you could use <code>fromInteger</code> instead of <code>fromIntegral</code>.</p>\n\n<p>A much less common approach would be to somehow create a <code>Rational</code> number and converting it:</p>\n\n<pre><code>let five, three, fiveThirds :: Rational\n    five = toRational (5 :: Integer)\n    three = toRational (3 :: Integer)\n    fiveThirds = five / three\nin fromRational fiveThirds\n</code></pre>\n\n<p>The other way to do create <code>Rational</code>s (somehow) depends on which standard you're using. If you've imported <code>Ratio</code> (Haskell 98) or <code>Data.Ratio</code> (Haskell 2010), you can also use the <code>(%) :: (Integral a) =&gt; a -&gt; a -&gt; Ratio a</code> operator:</p>\n\n<pre><code>let five, three :: Integer\n    fiveThirds :: Rational\n    five = 5\n    three = 3\n    fiveThirds = five % three\nin (fromRational fiveThirds :: Double)\n</code></pre>\n"}], "owner": {"reputation": 3111, "user_id": 2846781, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/66799fb2211ee2618b679c10e96629f6?s=128&d=identicon&r=PG&f=1", "display_name": "TheLeonKing", "link": "https://stackoverflow.com/users/2846781/theleonking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 1, "accepted_answer_id": 33649564, "answer_count": 2, "score": 1, "last_activity_date": 1447241238, "creation_date": 1447238964, "question_id": 33648969, "link": "https://stackoverflow.com/questions/33648969/haskell-different-ways-to-convert-division-of-integers-to-double", "title": "Haskell: Different ways to convert division of Integers to Double", "body": "<p>Say I want to divide 5 (Integer) by 3 (Integer), and I want my answer to be a Double. What different ways are there to do this in Haskell?</p>\n"}, {"tags": ["haskell", "conduit"], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 4, "last_activity_date": 1447255991, "creation_date": 1447255991, "answer_id": 33654021, "question_id": 33648942, "link": "https://stackoverflow.com/questions/33648942/haskell-conduit-from-process-capturing-both-stdout-and-stderr/33654021#33654021", "title": "Haskell Conduit from process capturing both stdout and stderr", "body": "<p>Here is an example derived from the School of Haskell article <a href=\"https://www.fpcomplete.com/user/snoyberg/library-documentation/data-conduit-process\" rel=\"nofollow\"><em>Data.Conduit.Process</em></a>:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport           Control.Applicative      ((*&gt;))\nimport           Control.Concurrent.Async (Concurrently (..))\nimport           Data.Conduit             (await, yield, ($$), (=$))\nimport qualified Data.Conduit.Binary      as CB\nimport qualified Data.Conduit.List        as CL\nimport           Data.Conduit.Process     (ClosedStream (..), streamingProcess,\n                                           proc, waitForStreamingProcess)\nimport           System.IO                (stdin)\n\nmain :: IO ()\nmain = do\n    putStrLn \"Enter lines of data. I'll run ./base64-perl on it.\"\n    putStrLn \"Enter \\\"quit\\\" to exit.\"\n\n    ((toProcess, close), fromProcess, fromStderr, cph) &lt;-\n        streamingProcess (proc \"./base64-perl\" [])\n\n    let input = CB.sourceHandle stdin\n             $$ CB.lines\n             =$ inputLoop\n             =$ toProcess\n\n        inputLoop = do\n            mbs &lt;- await\n            case mbs of\n                Nothing -&gt; close\n                Just \"quit\" -&gt; close\n                Just bs -&gt; do\n                    yield bs\n                    inputLoop\n\n        output = fromProcess $$ CL.mapM_\n            (\\bs -&gt; putStrLn $ \"from process: \" ++ show bs)\n\n        errout = fromStderr $$ CL.mapM_\n            (\\bs -&gt; putStrLn $ \"from stderr: \" ++ show bs)\n\n    ec &lt;- runConcurrently $\n        Concurrently input *&gt;\n        Concurrently output *&gt;\n        Concurrently errout *&gt;\n        Concurrently (waitForStreamingProcess cph)\n\n    putStrLn $ \"Process exit code: \" ++ show ec\n</code></pre>\n\n<p>It's basically the example in the article with a thread for processing stderr added.</p>\n\n<p>It calls this perl program which emits output to both stdout and stderr:</p>\n\n<pre><code>#!/usr/bin/env perl\n\nuse strict;\nuse warnings;\nuse MIME::Base64;\n\n$| = 1;\n\nmy $timeout = 3;\nmy $buf = \"\";\nwhile (1) {\n  my $rin = '';\n  vec($rin, fileno(STDIN), 1) = 1;\n  my ($nfound) = select($rin, undef, undef, $timeout);\n  if ($nfound) {\n    my $nread = sysread(STDIN, $buf, 4096, length($buf));\n    last if $nread &lt;= 0;\n    print encode_base64($buf);\n    $buf = \"\";\n  } else {\n    print STDERR \"this is from stderr\\n\";\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 6659, "user_id": 248279, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9cf2d31c7d0354a055a19c15a94ca73c?s=128&d=identicon&r=PG", "display_name": "luispedro", "link": "https://stackoverflow.com/users/248279/luispedro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1447255991, "creation_date": 1447238845, "question_id": 33648942, "link": "https://stackoverflow.com/questions/33648942/haskell-conduit-from-process-capturing-both-stdout-and-stderr", "title": "Haskell Conduit from process capturing both stdout and stderr", "body": "<p>Is there a Haskell conduit that can execute a process and capture both its <code>stderr</code> and <code>stdout</code> streams (separately)? The ability to pass in a <code>stdin</code> to the process would be perfect as a conduit too would be perfect, but not a requirement (I can use a file for that).</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "fold"], "comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 3, "creation_date": 1447231613, "post_id": 33646375, "comment_id": 55067313, "body": "Where does chapter 4.1 say that your second example is not primitive recursive? It starts with your second example and then just generalizes it somewhat (by adding the extra <code>y</code> parameter) to get your first version. But I see no claim that only your first one uses primitive recursion."}, {"owner": {"reputation": 85, "user_id": 5446180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1150101628338077/picture?type=large", "display_name": "Sid", "link": "https://stackoverflow.com/users/5446180/sid"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1447232030, "post_id": 33646375, "comment_id": 55067527, "body": "@Cactus This pattern of recursion on lists is called primitive recursion (Kleene, 1952). I think I misunderstand what it means. Thanks!"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 3, "creation_date": 1447232104, "post_id": 33646375, "comment_id": 55067560, "body": "Yes, but that is <b>not</b> to be taken to mean that <b>only</b> your first example is called primitive recursion, <b>in contrast to</b> your second example (also, it&#39;s confusing to refer to your examples because you flipped their order compared to the tutorial...)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1447232524, "post_id": 33646375, "comment_id": 55067774, "body": "@Cactus The tutorial says &quot;We will generalise this pattern of recursion to primitive recursion&quot;. This kind of implies that the original pattern is not primitive recursion."}, {"owner": {"reputation": 85, "user_id": 5446180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1150101628338077/picture?type=large", "display_name": "Sid", "link": "https://stackoverflow.com/users/5446180/sid"}, "edited": false, "score": 0, "creation_date": 1447232841, "post_id": 33646375, "comment_id": 55067920, "body": "Another question is why is that a generalise form ?"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 85, "user_id": 5446180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1150101628338077/picture?type=large", "display_name": "Sid", "link": "https://stackoverflow.com/users/5446180/sid"}, "edited": false, "score": 1, "creation_date": 1447251423, "post_id": 33647997, "comment_id": 55078114, "body": "Well, you compare the general scheme and the desired goal and try to instantiate the parameters so that they match. A bit of trial and error may be needed."}, {"owner": {"reputation": 85, "user_id": 5446180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1150101628338077/picture?type=large", "display_name": "Sid", "link": "https://stackoverflow.com/users/5446180/sid"}, "edited": false, "score": 0, "creation_date": 1447254160, "post_id": 33647997, "comment_id": 55079930, "body": "According to <a href=\"http://www.cs.umd.edu/~gasarch/COURSES/452/S14/dec.pdf\" rel=\"nofollow noreferrer\">primitive recursive definition</a>, I think the general scheme should be <code>h y (x:xs) = g y xs (h y xs)</code> , but why in <a href=\"http://www.cs.nott.ac.uk/~pszgmh/fold.pdf\" rel=\"nofollow noreferrer\">A tutorial on the universality and expressiveness of fold</a> defines it as <code>h y (x:xs) = g y x xs (h y xs)</code> ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 85, "user_id": 5446180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1150101628338077/picture?type=large", "display_name": "Sid", "link": "https://stackoverflow.com/users/5446180/sid"}, "edited": false, "score": 2, "creation_date": 1447266536, "post_id": 33647997, "comment_id": 55087990, "body": "@Sid The first definition of primitive recursion only considers natural numbers as arguments. When dealing with lists, it has to be extended. If we extend it as you propose, then <code>h y (x:xs)</code> can not depend on <code>x</code>, which is very restrictive: we can&#39;t access any of the list elements!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1447235499, "creation_date": 1447235499, "answer_id": 33647997, "question_id": 33646375, "link": "https://stackoverflow.com/questions/33646375/primitive-recursive-function/33647997#33647997", "title": "Primitive Recursive function", "body": "<p>The primitive recursion scheme is <em>parametric</em> on the choice of <code>f,g</code></p>\n\n<pre><code>h y [] = f y\nh y (x:xs) = g y x xs (h y xs)\n</code></pre>\n\n<p>That is, we are free to choose <code>f,g</code> as we want, and <code>h</code> will be defined through primitive recursion.</p>\n\n<p>In particular, we can choose </p>\n\n<pre><code>f = \\y -&gt; v\ng = \\y x xs -&gt; g' x z\n</code></pre>\n\n<p>where <code>g'</code> is any other function picked by us. We then get</p>\n\n<pre><code>h y [] = v\nh y (x:xs) = g' x (h y xs)\n</code></pre>\n\n<p>Now, if we let</p>\n\n<pre><code>h' xs = h () xs\n</code></pre>\n\n<p>we fix the <code>y</code> argument to an immaterial value so to recover the function in the question. Pedantically, <code>h'</code> is not obtained directly as an instance of the general form, so <code>h'</code> is technically not defined through the primitive recursion scheme seen above (i.e., it is not an instance of that). Sometimes, instead of <code>y</code> we find there many variables <code>y1 .. yn</code> allowing us to pick <code>n=0</code> and remove the <code>y</code> as we want in this case.</p>\n"}], "owner": {"reputation": 85, "user_id": 5446180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1150101628338077/picture?type=large", "display_name": "Sid", "link": "https://stackoverflow.com/users/5446180/sid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 707, "favorite_count": 0, "accepted_answer_id": 33647997, "answer_count": 1, "score": 2, "last_activity_date": 1447235499, "creation_date": 1447228933, "last_edit_date": 1447231442, "question_id": 33646375, "link": "https://stackoverflow.com/questions/33646375/primitive-recursive-function", "title": "Primitive Recursive function", "body": "<p>In <a href=\"http://www.cs.nott.ac.uk/~pszgmh/fold.pdf\" rel=\"nofollow\">A tutorial on universality and expressiveness of fold</a> chapter 4.1, it states that this pattern of recursion  </p>\n\n<pre><code>h y [] = f y\nh y (x:xs) = g y x xs (h y xs)\n</code></pre>\n\n<p>is primitive recursion, but I don't understand why the pattern  </p>\n\n<pre><code>h [] = v\nh (x:xs) = g x (h xs)\n</code></pre>\n\n<p>is not primitive recursion according to the <a href=\"https://en.wikipedia.org/wiki/Primitive_recursive_function#Definition\" rel=\"nofollow\">definition of primitive recursive</a>.<br>\nThe value of <code>h y'</code> is still based on <code>h y</code> in the <code>h (x:xs) = g x (h xs)</code> if we let <code>y = xs</code> and <code>y' = x:xs</code>.</p>\n"}, {"tags": ["haskell", "nlp", "corpus"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1447232459, "post_id": 33646178, "comment_id": 55067744, "body": "Style tip: It&#39;s a <i>function</i>, not a <i>procedure</i>. ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 0, "last_activity_date": 1447233075, "creation_date": 1447233075, "answer_id": 33647313, "question_id": 33646178, "link": "https://stackoverflow.com/questions/33646178/haskell-finding-bigrams-from-an-input-list-of-words/33647313#33647313", "title": "Haskell - finding bigrams from an input list of words", "body": "<p>Most of your code looks sane, except for the final <code>colloctions</code> function.</p>\n\n<p>I'm not sure why there's a stray pipe in there after the equals sign. You're not trying to write any kind of pattern guard, so I don't think that should be there.</p>\n\n<p><code>Map.lookup</code> returns a <code>Maybe</code> key, so trying to do division or multiplication isn't going to work. Maybe what you want is some kind of function that takes a key and a map, and returns the associated count <em>or zero</em> if the key doesn't exist?</p>\n\n<p>Other than that, it looks like you're not too far off having this work.</p>\n"}, {"tags": [], "owner": {"reputation": 178, "user_id": 4556658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176748782a450651ab1ef750943e5f35?s=128&d=identicon&r=PG&f=1", "display_name": "sdx23", "link": "https://stackoverflow.com/users/4556658/sdx23"}, "is_accepted": false, "score": 1, "last_activity_date": 1447233319, "creation_date": 1447233319, "answer_id": 33647383, "question_id": 33646178, "link": "https://stackoverflow.com/questions/33646178/haskell-finding-bigrams-from-an-input-list-of-words/33647383#33647383", "title": "Haskell - finding bigrams from an input list of words", "body": "<p>As I read it, your confusion stems from mistaking types, more or less. General advice: Use type signatures on all your top level functions and make sure they are sensible and what you expect of the function (I often do this even before implementing the function).</p>\n\n<p>Let's take a look at your </p>\n\n<pre><code>-- | Function for creating a list of bigrams\n-- | e.g. [(\"Colorless\", \"green\"), (\"green\", \"ideas\")]\nbigram :: [a] -&gt; [[a]]\n</code></pre>\n\n<p>If you're giving in a list of Strings, you'll be getting a list of lists of Strings, so your bigram is a list.\nYou could decide to be more explicit (only allow Strings instead of sometype a - for the beginning at least). So, actually we get a list of Words an make a list of Bigrams from it:</p>\n\n<pre><code>type Word = String\ntype Bigram = (Word, Word)\nbigram :: [Word] -&gt; [Bigram]\n</code></pre>\n\n<p>For the implementation you can try to use readily available functions from Data.List, for example zipWith and tail.</p>\n\n<p>Now your freqList and freqBigram look like</p>\n\n<pre><code>freqList :: [Word] -&gt; Map Word Int\nfreqBigram :: [Word] -&gt; Map Bigram Int\n</code></pre>\n\n<p>With this error messages of the compiler will be clearer to you. To point at it: Take care what you're doing in the lookups for the word frequencies. You're searching for the frequency of word1 and word2, and the bigram is (word1,word2).</p>\n\n<p>Now you should be able to figure the solution out on your own, I guess.</p>\n"}, {"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1447235013, "creation_date": 1447235013, "answer_id": 33647873, "question_id": 33646178, "link": "https://stackoverflow.com/questions/33646178/haskell-finding-bigrams-from-an-input-list-of-words/33647873#33647873", "title": "Haskell - finding bigrams from an input list of words", "body": "<p>First of all I advise you to have a look at the function</p>\n\n<pre><code>insertWith :: Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a\n</code></pre>\n\n<p>maybe you'll recognize the pattern if used</p>\n\n<pre><code>f freqs bg = insertWith (+) bg 1 freqs\n</code></pre>\n\n<p>Next as @MathematicalOrchid already pointed out your solution is not too far from being correct.</p>\n\n<pre><code>lookup :: Ord k =&gt; k -&gt; Map k a -&gt; Maybe a\n</code></pre>\n\n<p>You already took care of that in your <code>countElems</code> function.</p>\n\n<p>what I'd like to note that there is this neat abstraction called <code>Applicative</code>, which works really well for problems like yours.</p>\n\n<p>First of all you have to <code>import Control.Applicative</code> if you're using GHC prior to 7.10 for newer versions it is already at your fingertips.</p>\n\n<p>So what does this abstraction provide, similar to <code>Functor</code> it gives you a way to handle \"side effects\" in your case the possibility of the failing lookup resulting in <code>Nothing</code>.</p>\n\n<p>We have two operators provided by <code>Applicative</code>: <code>pure</code> and <code>&lt;*&gt;</code>, and in addition as every <code>Applicative</code> is required to be a <code>Functor</code> we also get <code>fmap</code> or <code>&lt;$&gt;</code> which are the latter is just an infix alias for convenience.</p>\n\n<h2>So how does this apply to your situation?</h2>\n\n<pre><code>&lt;*&gt; :: Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b\n&lt;$&gt; :: Functor f =&gt; a -&gt; b -&gt; f a -&gt; f b\n</code></pre>\n\n<p>First of all you see that those two look darn similar but with <code>&lt;*&gt;</code> being slightly less familiar.</p>\n\n<p>Now having a function</p>\n\n<pre><code>f :: Int -&gt; Int\nf x = x + 3\n</code></pre>\n\n<p>and \n    x1 :: Maybe Int\n    x1 = Just 4\n    x2 :: Maybe Int\n    x2 = Nothing</p>\n\n<p>one couldn't simply just <code>f y</code> because that wouldn't typecheck - but and that is the first idea to keep in mind. <code>Maybe</code> is a <code>Functor</code> (it is also an <code>Applicative</code> - it is even more an <code>M-thing</code>, but let's not go there).</p>\n\n<pre><code>f &lt;$&gt; x1 = Just 7\nf &lt;$&gt; x2 = Nothing\n</code></pre>\n\n<p>so you can imagine the <code>f</code> looking up the value and performing the calculation inside the <code>Just</code> and if there is no value - a.k.a. we have the <code>Nothing</code> situation, we'll do what every lazy student does - be lazy and do nothing ;-).</p>\n\n<p>Now we get to the next part <code>&lt;*&gt;</code></p>\n\n<pre><code>g1 :: Maybe (Int -&gt; Int)\ng1 = Just (x + 3)\ng2 :: Maybe (Int -&gt; Int)\ng2 = Nothing\n</code></pre>\n\n<p>Still <code>g1 x1</code> wouldn't work, but</p>\n\n<pre><code>g1 &lt;*&gt; x1 = Just 7\ng1 &lt;*&gt; x2 = Nothing\ng2 &lt;*&gt; x1 = Nothing -- remember g2 is Nothing\ng2 &lt;*&gt; x2 = Nothing\n</code></pre>\n\n<h2>NEAT! - but still how does this solve your problem?</h2>\n\n<p>The 'magic' is using both operators ... for multi-argument functions</p>\n\n<pre><code>h :: Int -&gt; Int -&gt; Int\nh x y = x + y + 2\n</code></pre>\n\n<p>and partial function application, which just means put in one value get back a function that waits for the next value.</p>\n\n<pre><code>GHCi&gt; :type h 1\nh 1 :: Int -&gt; Int\n</code></pre>\n\n<p>Now the strange thing happens we can use  with a function like <code>h</code>.</p>\n\n<pre><code>GHCi&gt; :type h1 &lt;$&gt; x1\nh1 &lt;$&gt; x1 :: Maybe (Int -&gt; Int)\n</code></pre>\n\n<p>well that's good because then we can use our <code>&lt;*&gt;</code> with it</p>\n\n<pre><code>y1 :: Maybe Int\ny1 = Just 7\nh1 &lt;$&gt; x1 &lt;*&gt; y1 = Just (4 + 7 + 2)\n                 = Just 13\n</code></pre>\n\n<p>and this even works with an arbitrary number of arguments</p>\n\n<pre><code>k :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int\nk x y z w = ...\nk &lt;$&gt; x1 &lt;*&gt; y1 &lt;*&gt; z1 &lt;*&gt; w1 = ...\n</code></pre>\n\n<p>So design a pure function that works with <code>Int</code>, <code>Float</code>, <code>Double</code> or whatever you like and then use the <code>Functor</code>/<code>Applicative</code> abstraction to make your <code>lookup</code> and frequency calculation work with each other.</p>\n"}], "owner": {"reputation": 137, "user_id": 3344578, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e460e4ceea4029d7e437ae212fd01910?s=128&d=identicon&r=PG&f=1", "display_name": "ntomlin1996", "link": "https://stackoverflow.com/users/3344578/ntomlin1996"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 1, "answer_count": 3, "score": 3, "last_activity_date": 1447235013, "creation_date": 1447228044, "question_id": 33646178, "link": "https://stackoverflow.com/questions/33646178/haskell-finding-bigrams-from-an-input-list-of-words", "title": "Haskell - finding bigrams from an input list of words", "body": "<p>I'm following the NLPWP Computational Linguistics site and trying to create a Haskell procedure to find collocations (most common groupings of two words, like \"United States\" or \"to find\") in a list of words. I've got the following working code to find bigram frequency:</p>\n\n<pre><code>import Data.Map (Map)\nimport qualified Data.Map as Map\n\n-- | Function for creating a list of bigrams\n-- | e.g. [(\"Colorless\", \"green\"), (\"green\", \"ideas\")]\nbigram :: [a] -&gt; [[a]]\nbigram []  = []\nbigram [_] = []\nbigram xs = take 2 xs : bigram (tail xs)\n\n-- | Helper for freqList and freqBigram\ncountElem base alow = case (Map.lookup alow base) of\n                       Just v -&gt; Map.insert alow (v + 1) base\n                       Nothing -&gt; Map.insert alow 1 base\n\n-- | Maps each word to its frequency.\nfreqList alow = foldl countElem Map.empty alow\n\n-- | Maps each bigram to its frequency.\nfreqBigram alow = foldl countElem Map.empty (bigram alow)\n</code></pre>\n\n<p>I'm trying to write a function that outputs a Map from each bigram to [freq of bigram]/[(freq word 1)*(freq word 2)]. Could you possibly provide advice on how to approach it?</p>\n\n<p>None of the following code is working, but it gives a vague outline for what I was trying to do.</p>\n\n<pre><code>collocations alow = \n  | let f key = (Map.lookup key freqBi) / ((Map.lookup (first alow) freqs)*(Map.lookup (last alow) freqs))\n    in Map.mapWithKey f = freqBi\n  where freqs = (freqList alow)\n  where freqBi = (freqBigram alow)\n</code></pre>\n\n<p>I'm very new to Haskell, so let me know if you've got any idea how to fix the collocations procedure. Style tips are also welcome.</p>\n"}, {"tags": ["haskell", "cabal", "vagrantfile", "cabal-install", "cabal-dev"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447227567, "post_id": 33645957, "comment_id": 55065600, "body": "Why don&#39;t you install <code>ghc-7.10.2</code> and <code>cabal-1.22</code> from <a href=\"https://launchpad.net/~hvr/+archive/ubuntu/ghc\" rel=\"nofollow noreferrer\"><code>hvr&#47;ghc</code></a>? Unless you really want GHC 7.6, I wouldn&#39;t use <code>haskell-platform</code> on Trusty."}, {"owner": {"reputation": 1774, "user_id": 4021611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Zack", "link": "https://stackoverflow.com/users/4021611/zack"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447227951, "post_id": 33645957, "comment_id": 55065765, "body": "@Zeta : It works when I do the same steps manually in the VM. It is just that it is installing in the root directory when I do the same with Vagrantfile. If I am able to solve this issue, I am fine."}, {"owner": {"reputation": 309, "user_id": 3320256, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/NZCl4.png?s=128&g=1", "display_name": "daniel.kahlenberg", "link": "https://stackoverflow.com/users/3320256/daniel-kahlenberg"}, "edited": false, "score": 0, "creation_date": 1447237000, "post_id": 33645957, "comment_id": 55070181, "body": "Did you try adding <code>su - vagrant</code> prior cabal install step?"}, {"owner": {"reputation": 1774, "user_id": 4021611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Zack", "link": "https://stackoverflow.com/users/4021611/zack"}, "edited": false, "score": 0, "creation_date": 1447256874, "post_id": 33645957, "comment_id": 55081830, "body": "yes. I have tried that"}], "answers": [{"comments": [{"owner": {"reputation": 1774, "user_id": 4021611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Zack", "link": "https://stackoverflow.com/users/4021611/zack"}, "edited": false, "score": 0, "creation_date": 1447272198, "post_id": 33658765, "comment_id": 55091267, "body": "I have not tried this. I tried to do su vagrant but it did not work. I will try what you said now."}], "tags": [], "owner": {"reputation": 2369, "user_id": 1500583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71020354a2fefbdadf424bd48c912515?s=128&d=identicon&r=PG", "display_name": "David McHealy", "link": "https://stackoverflow.com/users/1500583/david-mchealy"}, "is_accepted": false, "score": 1, "last_activity_date": 1447271676, "creation_date": 1447271676, "answer_id": 33658765, "question_id": 33645957, "link": "https://stackoverflow.com/questions/33645957/cabal-getting-installed-in-root-directory-instead-of-home-vagrant-directory-usi/33658765#33658765", "title": "Cabal getting installed in root directory instead of /home/vagrant directory using Vagrantfile", "body": "<p>I've personally had more luck configuring vagrant with ansible, but if you wish to do it this way, have you tried:</p>\n\n<pre><code>sudo -u vagrant cabal install cabal-install\n</code></pre>\n"}], "owner": {"reputation": 1774, "user_id": 4021611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Zack", "link": "https://stackoverflow.com/users/4021611/zack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1447271676, "creation_date": 1447226887, "question_id": 33645957, "link": "https://stackoverflow.com/questions/33645957/cabal-getting-installed-in-root-directory-instead-of-home-vagrant-directory-usi", "title": "Cabal getting installed in root directory instead of /home/vagrant directory using Vagrantfile", "body": "<p>THe below is the content of the vagrant file. When I run <code>vagrant up</code> command, it installs cabal as required but it is in the root directory. Hence, it becomes unusable. I want to update the cabal version to latest version using <code>cabal update</code>. But it is not happening.</p>\n\n<p>Finally, in my VM, I have old version of cabal which comes with <code>haskell-platform</code> which is of no use to me. However, when I execute these commands separately by explicitly logging into VM, and not putting anything in Vagrantfile, it works and I get cabal version 1.22.6.0 which is what I need, but by using Vagrantfile.\nHow do I make sure that cabal is not getting installed in the root directory ? Instead I think it should get installed in the /home/vagrant directory like this: /home/vagrant/.cabal/bin</p>\n\n<pre><code>==&gt; default: Setting up haskell-platform (2013.2.0.0.debian3) ...\n==&gt; default: Processing triggers for libc-bin (2.19-0ubuntu6.6) ...\n==&gt; default:  ********************************\n\n    ==&gt; default: Config file path source is default config file.\n    ==&gt; default: Config file /root/.cabal/config not found.\n    ==&gt; default: Writing default configuration to /root/.cabal/config\n    ==&gt; default: Downloading the latest package list from hackage.haskell.org\n    ==&gt; default:  ********************************\n    ==&gt; default: Resolving dependencies...\n    ==&gt; default: Downloading binary-0.7.6.1...\n    ==&gt; default: Configuring binary-0.7.6.1...\n    ==&gt; default: Building binary-0.7.6.1...\n    ==&gt; default: Preprocessing library binary-0.7.6.1...\n</code></pre>\n\n<p>CONTENTS OF VAGRANT FILE BELOW:</p>\n\n<pre><code>Vagrant.configure(2) do |config| \n      config.vm.box = \"ubuntu/trusty32\"\n      config.vm.box_check_update = false \n      config.vm.provider \"virtualbox\" do |vb| \n        vb.gui = true  \n        vb.memory = \"2048\"\n      end\n\n      config.vm.provision \"shell\", inline: &lt;&lt;-SHELL\n      cd /home/vagrant      \n      sudo apt-get update \n      echo \"-----------------------------\" \n      echo \"-----------------------------\" \n      sudo apt-get -y install zip\n      sudo apt-get -y install git\n      sudo apt-get -y install build-essential\n      sudo apt-get -y install libmakefile-parser-perl\n      sudo apt-get -y install libreoffice-dev\n      sudo apt-get -y install haskell-platform\n\n      echo \" ********************************\" \n      cabal update\n\n      echo \" ********************************\" \n\n      cabal install cabal-install\n      echo \"+++++++++++==========++++=====\"\n\n      # echo \"PATH=/home/vagrant/.cabal/bin:$PATH\" &gt;&gt; /home/vagrant/.bashrc \n\n      SHELL\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "cabal-install"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1447210388, "post_id": 33643453, "comment_id": 55060908, "body": "<code>cabal sandbox</code> is only available with cabal-install 1.18 and above. What does <code>cabal --version</code> tell you?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1447211028, "post_id": 33643453, "comment_id": 55061088, "body": "I believe Ubuntu&#39;s package system has an outdated haskell-platform (outdated by at least a couple years it looks like, which is very outdated). I would suggest installing it from a different source."}, {"owner": {"reputation": 1774, "user_id": 4021611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Zack", "link": "https://stackoverflow.com/users/4021611/zack"}, "edited": false, "score": 0, "creation_date": 1447211235, "post_id": 33643453, "comment_id": 55061139, "body": "vagrant@vagrant-ubuntu-trusty-32:/usr/lib/haskell-packages$ cabal --version cabal-install version 1.16.0.2 using version 1.16.0 of the Cabal library vagrant@vagrant-ubuntu-trusty-32:/usr/lib/haskell-packages$ which cabal /home/vagrant/.cabal/bin/cabal"}, {"owner": {"reputation": 1774, "user_id": 4021611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Zack", "link": "https://stackoverflow.com/users/4021611/zack"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1447211408, "post_id": 33643453, "comment_id": 55061178, "body": "@DavidYoung : I added more details. Check"}, {"owner": {"reputation": 1774, "user_id": 4021611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Zack", "link": "https://stackoverflow.com/users/4021611/zack"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1447211421, "post_id": 33643453, "comment_id": 55061181, "body": "@duplode: Added more details"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1447214668, "post_id": 33643453, "comment_id": 55061987, "body": "@Zack Well, like I said, I&#39;d suggest getting haskell-platform/ghc from a more up-to-date source. That installation probably has, at best, GHC 7.6.3 which is two (soon to be three) major releases behind the latest stable release (and there is a large difference in the number of features. You will likely run into quite a few incompatibilities with Haskell libraries). You can probably fix this specific problem, though, by just upgrading cabal (this won&#39;t upgrade the GHC compiler though). This can be done with <code>cabal update &amp;&amp; cabal install cabal-install</code>."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1447220156, "post_id": 33643453, "comment_id": 55063301, "body": "I don&#39;t specifically know what you are doing, but an alternative these days is to just use <a href=\"https://github.com/commercialhaskell/stack\" rel=\"nofollow noreferrer\">stack</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1774, "user_id": 4021611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Zack", "link": "https://stackoverflow.com/users/4021611/zack"}, "edited": false, "score": 0, "creation_date": 1447211488, "post_id": 33643602, "comment_id": 55061206, "body": "Your answer is not helping me in any form. Could you please elaborate how to fix the error? Cabal is already in my path as mentioned in my post."}, {"owner": {"reputation": 899, "user_id": 1443521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e6faa5089ddab124272468f00d3bf3d?s=128&d=identicon&r=PG", "display_name": "Will Hogan", "link": "https://stackoverflow.com/users/1443521/will-hogan"}, "reply_to_user": {"reputation": 1774, "user_id": 4021611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Zack", "link": "https://stackoverflow.com/users/4021611/zack"}, "edited": false, "score": 0, "creation_date": 1447216983, "post_id": 33643602, "comment_id": 55062549, "body": "I know it&#39;s in your <code>PATH</code>, my point is that the system-level install is first in your <code>PATH</code> and this one differs from the user-level install in <code>~&#47;.cabal&#47;bin</code>. To fix this, as I said, you modify your path to put the user-level one first using <code>export PATH=&quot;$HOME&#47;.cabal&#47;bin:$PATH&quot;</code>. This is also referenced in the blog post where they state &quot;That\u2019s all! Now you have the latest version of the cabal tool installed under ~/.cabal/bin&quot;. What is the output of <code>which cabal</code>? If it isn&#39;t <code>~&#47;.cabal&#47;bin</code> then you need to fix your path."}, {"owner": {"reputation": 1774, "user_id": 4021611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Zack", "link": "https://stackoverflow.com/users/4021611/zack"}, "edited": false, "score": 0, "creation_date": 1447217640, "post_id": 33643602, "comment_id": 55062715, "body": "Okay. Will try this. May be I missed this step. Thanks."}, {"owner": {"reputation": 899, "user_id": 1443521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e6faa5089ddab124272468f00d3bf3d?s=128&d=identicon&r=PG", "display_name": "Will Hogan", "link": "https://stackoverflow.com/users/1443521/will-hogan"}, "reply_to_user": {"reputation": 1774, "user_id": 4021611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Zack", "link": "https://stackoverflow.com/users/4021611/zack"}, "edited": false, "score": 0, "creation_date": 1447217714, "post_id": 33643602, "comment_id": 55062728, "body": "I see  you&#39;ve noted the path in the other thread above and you&#39;ve somehow got 1.16 in <code>~&#47;.cabal&#47;bin</code>. Though I don&#39;t understand how that can happen with an install from git sources, you should probably go with David Young&#39;s suggestion."}, {"owner": {"reputation": 1774, "user_id": 4021611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Zack", "link": "https://stackoverflow.com/users/4021611/zack"}, "edited": false, "score": 0, "creation_date": 1447227027, "post_id": 33643602, "comment_id": 55065382, "body": "Thanks. I was able to do it interactively by logging into VM. However I am facing problems when doing the same through vagrantfile. Can you check this post: <a href=\"http://stackoverflow.com/questions/33645957/cabal-getting-installed-in-root-directory-instead-of-home-vagrant-directory-usi\" title=\"cabal getting installed in root directory instead of home vagrant directory usi\">stackoverflow.com/questions/33645957/&hellip;</a>"}], "tags": [], "owner": {"reputation": 899, "user_id": 1443521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e6faa5089ddab124272468f00d3bf3d?s=128&d=identicon&r=PG", "display_name": "Will Hogan", "link": "https://stackoverflow.com/users/1443521/will-hogan"}, "is_accepted": true, "score": 4, "last_activity_date": 1447219696, "last_edit_date": 1447219696, "creation_date": 1447211077, "answer_id": 33643602, "question_id": 33643453, "link": "https://stackoverflow.com/questions/33643453/not-able-to-initialize-sandbox-using-cabal-on-haskell-platform/33643602#33643602", "title": "Not able to initialize sandbox using cabal on haskell platform", "body": "<p>The Cabal installed by <code>apt</code> is a little older and this is likely the one in your <code>PATH</code>. It gets installed to <code>/usr/bin</code>. You can check with: </p>\n\n<pre><code>which cabal\n</code></pre>\n\n<p>And to see the version: </p>\n\n<pre><code>cabal -v\n</code></pre>\n\n<p>You should put the one in <code>~/.cabal/bin</code> in your <code>PATH</code> first with: </p>\n\n<pre><code>export PATH=\"$HOME/.cabal/bin:$PATH\n</code></pre>\n\n<p>(Probably best to put this in your <code>~/.bash_profile</code> or similar)</p>\n\n<p>On my system:</p>\n\n<pre><code>.whogan:~$ which cabal\n/home/whogan/.cabal/bin/cabal\n\n.whogan:~$ cabal -V\ncabal-install version 1.22.6.0\nusing version 1.22.4.0 of the Cabal library \n\n.whogan:~$ /usr/bin/cabal -V\ncabal-install version 1.16.0.2\nusing version 1.16.0 of the Cabal library \n</code></pre>\n\n<p><strong>Edit:</strong> Tried with a new Vagrant box, ran <code>apt-get install haskell-platform</code> and install from git: </p>\n\n<pre><code>[vagrant@vagrantbox:~] $ git clone git://github.com/haskell/cabal.git cabal-wip\nCloning into 'cabal-wip'...\nremote: Counting objects: 48926, done.\nremote: Compressing objects: 100% (47/47), done.\nremote: Total 48926 (delta 16), reused 0 (delta 0), pack-reused 48876\nReceiving objects: 100% (48926/48926), 26.39 MiB | 10.37 MiB/s, done.\nResolving deltas: 100% (29033/29033), done.\nChecking connectivity... done.\n\n[vagrant@vagrantbox:~] $ cd cabal-wip\n[vagrant@vagrantbox:~/cabal-wip][master] $ cabal install Cabal/ cabal-install/\nConfig file path source is default config file.\nConfig file /home/vagrant/.cabal/config not found.\nWriting default configuration to /home/vagrant/.cabal/config\nWarning: The package list for 'hackage.haskell.org' does not exist. Run 'cabal\nupdate' to download it.\nResolving dependencies...\nConfiguring Cabal-1.23.0.0...\nBuilding Cabal-1.23.0.0...\nPreprocessing library Cabal-1.23.0.0...\n[ 1 of 85] Compiling Distribution.Lex ( Distribution/Lex.hs, dist/build/Distribution/Lex.o )\n..\n[85 of 85] Compiling Distribution.Simple ( Distribution/Simple.hs, dist/build/Distribution/Simple.o )\nIn-place registering Cabal-1.23.0.0...\nInstalling library in /home/vagrant/.cabal/lib/Cabal-1.23.0.0/ghc-7.6.3\nRegistering Cabal-1.23.0.0...\nInstalled Cabal-1.23.0.0\n[1 of 1] Compiling Main             ( cabal-install/Setup.hs, cabal-install/dist/setup/Main.o )\nLinking cabal-install/dist/setup/setup ...\nConfiguring cabal-install-1.23.0.0...\nBuilding cabal-install-1.23.0.0...\nPreprocessing executable 'cabal' for cabal-install-1.23.0.0...\n[ 1 of 81] Compiling Distribution.Client.Utils.LabeledGraph ( Distribution/Client/Utils/LabeledGraph.hs, dist/build/cabal/cabal-tmp/Distribution/Client/Utils/LabeledGraph.o )\n...\n[81 of 81] Compiling Main             ( Main.hs, dist/build/cabal/cabal-tmp/Main.o )\nLinking dist/build/cabal/cabal ...\nGenerating manual page dist/build/cabal/cabal.1 ...\nInstalling executable(s) in /home/vagrant/.cabal/bin\nInstalled cabal-install-1.23.0.0\n</code></pre>\n\n<p>It's installed 1.23.0.0 to <code>~/.cabal/bin</code>, but after this the <code>PATH</code> is still pointing to the system one: </p>\n\n<pre><code>[vagrant@vagrantbox:~/cabal-wip][master] $ which cabal\n/usr/bin/cabal\n[vagrant@vagrantbox:~/cabal-wip][master] $ cabal -V\ncabal-install version 1.16.0.2\nusing version 1.16.0 of the Cabal library\n</code></pre>\n\n<p>So I modify to put the user/git version first:</p>\n\n<pre><code>[vagrant@vagrantbox:~/cabal-wip][master] $ export PATH=\"~/.cabal/bin:$PATH\"\n[vagrant@vagrantbox:~/cabal-wip][master] $ which cabal\n/home/vagrant/.cabal/bin/cabal\n[vagrant@vagrantbox:~/cabal-wip][master] $ cabal -V\ncabal-install version 1.23.0.0\ncompiled using version 1.23.0.0 of the Cabal library \n</code></pre>\n\n<p>It seems OK after that: </p>\n\n<pre><code>[vagrant@vagrantbox:~/cabal-wip][master] $ mkdir ~/tmp &amp;&amp; cd ~/tmp\n[vagrant@vagrantbox:~/tmp] $ cabal sandbox init\nWriting a default package environment file to\n/home/vagrant/tmp/cabal.sandbox.config\nCreating a new sandbox at /home/vagrant/tmp/.cabal-sandbox\n</code></pre>\n\n<p>I used trusty64 rather than trusty32 but I would hope that's not significant in this case.</p>\n"}], "owner": {"reputation": 1774, "user_id": 4021611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Zack", "link": "https://stackoverflow.com/users/4021611/zack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 33643602, "answer_count": 1, "score": 2, "last_activity_date": 1447219696, "creation_date": 1447210053, "last_edit_date": 1447211372, "question_id": 33643453, "link": "https://stackoverflow.com/questions/33643453/not-able-to-initialize-sandbox-using-cabal-on-haskell-platform", "title": "Not able to initialize sandbox using cabal on haskell platform", "body": "<p>I have done the below steps to install cabal . I have already installed haskell platform using <code>sudo apt-get install haskell-platform</code></p>\n\n<p><a href=\"http://coldwa.st/e/blog/2013-08-20-Cabal-sandbox.html\" rel=\"nofollow\">http://coldwa.st/e/blog/2013-08-20-Cabal-sandbox.html</a></p>\n\n<pre><code>Building Cabal from git\nAssuming you already have a previous version of cabal installed:\n\n$ git clone git://github.com/haskell/cabal.git /path/to/cabal\n$ cd /path/to/cabal\n$ cabal install Cabal/ cabal-install/\n</code></pre>\n\n<p>However when I try to initialize a sandbox, it throws error as below.</p>\n\n<pre><code>vagrant@vagrant-ubuntu-trusty-32:/usr/lib/haskell-packages$ cabal sandbox --help\ncabal: unrecognised command: sandbox (try --help)\n</code></pre>\n\n<p>Adding more details:</p>\n\n<pre><code>vagrant@vagrant-ubuntu-trusty-32:/usr/lib/haskell-packages$ cabal --version\ncabal-install version 1.16.0.2\nusing version 1.16.0 of the Cabal library\nvagrant@vagrant-ubuntu-trusty-32:/usr/lib/haskell-packages$ which cabal\n/home/vagrant/.cabal/bin/cabal\n\n\n\nvagrant@vagrant-ubuntu-trusty-32:/usr/lib/haskell-packages$ cabal --help\nThis program is the command line interface to the Haskell Cabal infrastructure.\nSee http://www.haskell.org/cabal/ for more information.\n\nUsage: cabal COMMAND [FLAGS]\n   or: cabal [GLOBAL FLAGS]\n\nGlobal flags:\n -h --help            Show this help text\n -V --version         Print version information\n    --numeric-version Print just the version number\n\nCommands:\n  install      Installs a list of packages.\n  update       Updates list of known packages\n  list         List packages matching a search string.\n  info         Display detailed information about a particular package.\n  fetch        Downloads packages for later installation.\n  unpack       Unpacks packages for user inspection.\n  check        Check the package for common mistakes\n  sdist        Generate a source distribution file (.tar.gz).\n  upload       Uploads source packages to Hackage\n  report       Upload build reports to a remote server.\n  init         Interactively create a .cabal file.\n  configure    Prepare to build the package.\n  build        Make this package ready for installation.\n  copy         Copy the files into the install locations.\n  haddock      Generate Haddock HTML documentation.\n  clean        Clean up after a build.\n  hscolour     Generate HsColour colourised code, in HTML format.\n  register     Register this package with the compiler.\n  test         Run the test suite, if any (configure with UserHooks).\n  bench        Run the benchmark, if any (configure with UserHooks).\n  upgrade      (command disabled, use install instead)\n  help         Help about commands\n\nFor more information about a command use:\n  cabal COMMAND --help\n\nTo install Cabal packages from hackage use:\n  cabal install foo [--dry-run]\n\nOccasionally you need to update the list of available packages:\n  cabal update\n\nYou can edit the cabal configuration file to set defaults:\n  /home/vagrant/.cabal/config\nvagrant@vagrant-ubuntu-trusty-32:/usr/lib/haskell-packages$ cabal COMMAND --help\ncabal: unrecognised command: COMMAND (try --help)\nvagrant@vagrant-ubuntu-trusty-32:/usr/lib/haskell-packages$ cabal sandbox --help\ncabal: unrecognised command: sandbox (try --help)\n</code></pre>\n"}, {"tags": ["haskell", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 1953, "user_id": 899723, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f68bcc2d6f5196fa090d578eb8356b9c?s=128&d=identicon&r=PG", "display_name": "mac10688", "link": "https://stackoverflow.com/users/899723/mac10688"}, "edited": false, "score": 0, "creation_date": 1447210142, "post_id": 33642878, "comment_id": 55060851, "body": "This looks like what I want. I&#39;m new to haskell and trying to figure out how to add those dependencies to my single file, using stack. Without a yaml or cabal file. When I figure this out I will mark your answer and upvote when I prove it works. Thank you for the detailed answer."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 1953, "user_id": 899723, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f68bcc2d6f5196fa090d578eb8356b9c?s=128&d=identicon&r=PG", "display_name": "mac10688", "link": "https://stackoverflow.com/users/899723/mac10688"}, "edited": false, "score": 0, "creation_date": 1447210844, "post_id": 33642878, "comment_id": 55061043, "body": "@mac10688 If you&#39;re not using a stack file or cabal file, you will need to install the package with <code>cabal install</code>. You need to use a stack file or cabal file to have explicit dependencies."}, {"owner": {"reputation": 1953, "user_id": 899723, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f68bcc2d6f5196fa090d578eb8356b9c?s=128&d=identicon&r=PG", "display_name": "mac10688", "link": "https://stackoverflow.com/users/899723/mac10688"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1447211206, "post_id": 33642878, "comment_id": 55061133, "body": "@DavidYoung I was able to use stack ghci --resolver nightly-2015-11-10 --package universe QuickCheck. Now, I am working through some compiling errors."}, {"owner": {"reputation": 1953, "user_id": 899723, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f68bcc2d6f5196fa090d578eb8356b9c?s=128&d=identicon&r=PG", "display_name": "mac10688", "link": "https://stackoverflow.com/users/899723/mac10688"}, "edited": false, "score": 0, "creation_date": 1447216532, "post_id": 33642878, "comment_id": 55062437, "body": "It took a while but I was finally able to prove you right. I did have to make an instance of Arbitrary for Sum and my Combine newtype needed to derive Eq and Show."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1447206403, "last_edit_date": 1447206403, "creation_date": 1447206018, "answer_id": 33642878, "question_id": 33642741, "link": "https://stackoverflow.com/questions/33642741/haskell-arbitrary-instance-of-higher-order-type/33642878#33642878", "title": "Haskell Arbitrary Instance of Higher Order type", "body": "<p>The minimal fix is to turn on <code>FlexibleInstances</code> and write:</p>\n\n<pre><code>instance (Q.Arbitrary a, Num a) =&gt; Q.Arbitrary (Combine a (Sum a)) where\n  arbitrary = do\n    a &lt;- Q.arbitrary :: Q.Gen ()\n    return $ Combine (\\n -&gt; Sum(n+1))\n</code></pre>\n\n<p>However, this is a bit unsatisfactory: I observe that <code>a</code> is completely unused (hence has to be manually given a type signature!), and the distribution over functions is kind of boring, since it returns the function <code>(+1)</code> (up to newtype wrapping) with probability 1. (Perhaps you wanted <code>return $ Combine (\\n -&gt; Sum (n+a))</code>? But even then the class of functions you can produce this way is a little bit boring. I'm not sure what you really meant, and I won't spend long speculating.)</p>\n\n<p>If you want to do it right, you should produce a random output for each input. This is pretty convenient with the <a href=\"http://hackage.haskell.org/package/universe\" rel=\"nofollow\"><code>universe</code></a> package:</p>\n\n<pre><code>import Data.Universe\nimport Data.Universe.Instances.Reverse\ninstance (Ord a, Finite a, Q.Arbitrary b) =&gt; Q.Arbitrary (Combine a b) where\n  arbitrary = Combine &lt;$&gt; sequenceA (const Q.arbitrary)\n</code></pre>\n\n<p>As a side benefit, this does not require any extensions. However, you should be careful to choose input types with small domains -- <code>Combine Bool (Sum Int)</code> should be fine, or even <code>Combine Word8 (Sum Word8)</code>, but if you try to test a property on a type like <code>Combine Int (Sum Int)</code> you will be sorry!</p>\n"}], "owner": {"reputation": 1953, "user_id": 899723, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f68bcc2d6f5196fa090d578eb8356b9c?s=128&d=identicon&r=PG", "display_name": "mac10688", "link": "https://stackoverflow.com/users/899723/mac10688"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 3, "accepted_answer_id": 33642878, "answer_count": 1, "score": 3, "last_activity_date": 1447206403, "creation_date": 1447204954, "question_id": 33642741, "link": "https://stackoverflow.com/questions/33642741/haskell-arbitrary-instance-of-higher-order-type", "title": "Haskell Arbitrary Instance of Higher Order type", "body": "<p>I have the type and it is an instance of SemiGroup.\nI want to write a quickCheck method to ensure that it is correct.\nHow do I create an Arbitrary instance of this type?</p>\n\n<pre><code>newtype Combine a b =\n  Combine { unCombine :: a -&gt; b }\n\ninstance Semigroup b =&gt; Semigroup (Combine a b) where\n  x &lt;&gt; y = Combine $ \\n -&gt; unCombine x n &lt;&gt; unCombine y n\n\ninstance (Q.Arbitrary a, Num a) =&gt; Q.Arbitrary (Combine a b) where\n  arbitrary = do\n    a &lt;- Q.arbitrary\n    return $ Combine (\\n -&gt; Sum(n+1)) a\n</code></pre>\n"}, {"tags": ["haskell", "template-haskell"], "answers": [{"tags": [], "owner": {"reputation": 6262, "user_id": 691032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04fa8b0cca5a7dfef2d281be67a2b7a2?s=128&d=identicon&r=PG", "display_name": "sinan", "link": "https://stackoverflow.com/users/691032/sinan"}, "is_accepted": true, "score": 3, "last_activity_date": 1447203630, "last_edit_date": 1447203630, "creation_date": 1447202133, "answer_id": 33642280, "question_id": 33640171, "link": "https://stackoverflow.com/questions/33640171/in-templatehaskell-how-do-i-figure-out-that-an-imported-module-has-been-renamed/33642280#33642280", "title": "In TemplateHaskell, how do I figure out that an imported module has been renamed?", "body": "<p>I don't think there's a way to do that. This seems to be a limitation of TemplateHaskell.</p>\n\n<p>It kinda makes sense to have only fully qualified names in <code>ModuleInfo</code>s list of imported modules, but the fact that we can't use those fully qualified names in <code>lookupValueName</code> is bad. I think we need a variant of <code>lookupValueName</code> or <code>lookupName</code> that takes a <code>Module</code> as argument.</p>\n\n<p>I suggest openning an issue at GHC issue tracker: <a href=\"https://ghc.haskell.org/trac/ghc/newticket\" rel=\"nofollow\">https://ghc.haskell.org/trac/ghc/newticket</a> We have ongoing work to improve TH in the next major release. Part of the work is about improving the package documentation, exported functions etc. This can be one of the improvements.</p>\n"}], "owner": {"reputation": 555, "user_id": 1505475, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bc72887d0b9f71cdbc2eeb5f9899d8f?s=128&d=identicon&r=PG", "display_name": "simon1505475", "link": "https://stackoverflow.com/users/1505475/simon1505475"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 33642280, "answer_count": 1, "score": 4, "last_activity_date": 1447203630, "creation_date": 1447191821, "question_id": 33640171, "link": "https://stackoverflow.com/questions/33640171/in-templatehaskell-how-do-i-figure-out-that-an-imported-module-has-been-renamed", "title": "In TemplateHaskell, how do I figure out that an imported module has been renamed?", "body": "<p>I am writing a bit of TemplateHaskell for stringing together QuickCheck style specifications. I require every module containing properties to export a symbol called ''axiom_set''. Then, my checkAxioms function finds all the ''axiom_set'' symbols from modules imported where I call checkAxioms.</p>\n\n<pre><code>checkAxioms :: DecsQ\ncheckAxioms = do\n    ModuleInfo ms &lt;- reifyModule =&lt;&lt; thisModule\n    forM_ ms $ \\mi@(Module _ m) -&gt; do\n        runIO . print =&lt;&lt; lookupValueName (modString m ++ \".axiom_set\")\n</code></pre>\n\n<p>The above code should find all the imported \"axiom_set\" symbols. However, if Module.Axioms defines axiom_set but that I imported as follows</p>\n\n<pre><code>import Module.Axioms as MA\n</code></pre>\n\n<p>my code can't find MA.axiom_set. Any advice?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 7, "creation_date": 1447174526, "post_id": 33635051, "comment_id": 55044499, "body": "Why do you think it should be <code>([a] -&gt; a -&gt; c) -&gt; a -&gt; c</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 8, "last_activity_date": 1447174282, "creation_date": 1447174282, "answer_id": 33635268, "question_id": 33635051, "link": "https://stackoverflow.com/questions/33635051/why-is-the-type-of-head-a-c-a-c/33635268#33635268", "title": "Why is the type of (.) head ((a -&gt; [c]) -&gt; a -&gt; c)?", "body": "<p><strong>hint</strong>: </p>\n\n<pre><code>(.) head \n= \\f   -&gt; (.) head f\n= \\f   -&gt; head . f \n= \\f a -&gt; head (f a)\n</code></pre>\n\n<p>once you have this the rest follows as this:</p>\n\n<ul>\n<li><code>head :: [c] -&gt; c</code></li>\n<li><code>f :: a -&gt; b</code> - so as we do <code>head . f</code> we must have <code>b = [c]</code></li>\n</ul>\n\n<p>now the complete expression has</p>\n\n<pre><code>\\     f              a        -&gt; head (f a)\n:: (a -&gt; [c])     -&gt; a        -&gt; c\n      ^ type of f    ^ the a     ^ result of head (f a)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 5504456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5355bf3cf4680d91482b590ac3765acd?s=128&d=identicon&r=PG&f=1", "display_name": "Nostaglia", "link": "https://stackoverflow.com/users/5504456/nostaglia"}, "edited": false, "score": 0, "creation_date": 1447175576, "post_id": 33635461, "comment_id": 55045234, "body": "Thank you ,I&#39;m newer of Haskell, further question is why head designated to ( b -&gt; c ) ,but ( a -&gt; b) ?"}, {"owner": {"reputation": 43, "user_id": 5504456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5355bf3cf4680d91482b590ac3765acd?s=128&d=identicon&r=PG&f=1", "display_name": "Nostaglia", "link": "https://stackoverflow.com/users/5504456/nostaglia"}, "edited": false, "score": 0, "creation_date": 1447175655, "post_id": 33635461, "comment_id": 55045290, "body": "and if the question is succ . head , how do I improve it has type or error? Thank you"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 43, "user_id": 5504456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5355bf3cf4680d91482b590ac3765acd?s=128&d=identicon&r=PG&f=1", "display_name": "Nostaglia", "link": "https://stackoverflow.com/users/5504456/nostaglia"}, "edited": false, "score": 0, "creation_date": 1447199402, "post_id": 33635461, "comment_id": 55057806, "body": "@Nostaglia Because that&#39;s the first argument to <code>(.)</code>."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 2, "last_activity_date": 1447174834, "creation_date": 1447174834, "answer_id": 33635461, "question_id": 33635051, "link": "https://stackoverflow.com/questions/33635051/why-is-the-type-of-head-a-c-a-c/33635461#33635461", "title": "Why is the type of (.) head ((a -&gt; [c]) -&gt; a -&gt; c)?", "body": "<pre><code>head     ::  [n] -&gt; n\n--   b ~ [n]  |     | c ~ n\n--            |     |\n(.)      ::  (b  -&gt; c) -&gt; (a -&gt;  b ) -&gt; a -&gt; c\n\n(.) head ::               (a -&gt; [n]) -&gt; a -&gt; n\n\n-- rename n to c:         (a -&gt; [c]) -&gt; a -&gt; c\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5504456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5355bf3cf4680d91482b590ac3765acd?s=128&d=identicon&r=PG&f=1", "display_name": "Nostaglia", "link": "https://stackoverflow.com/users/5504456/nostaglia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1447174948, "creation_date": 1447173598, "last_edit_date": 1447174948, "question_id": 33635051, "link": "https://stackoverflow.com/questions/33635051/why-is-the-type-of-head-a-c-a-c", "title": "Why is the type of (.) head ((a -&gt; [c]) -&gt; a -&gt; c)?", "body": "<p>I have tried <code>:t (.) head</code> on GHCi and get result <code>(a -&gt; [c]) -&gt; a -&gt; c</code>\nI get very confuse about this. Could someone give me a hint to help me comprehend this?</p>\n\n<p>For my own thinking, the result should be <code>([a] -&gt; a -&gt; c)-&gt; a -&gt; c</code></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 9, "creation_date": 1447162846, "post_id": 33631304, "comment_id": 55035900, "body": "The first function has type <code>(Ord a, Num a) =&gt; a -&gt; Bool</code> while the second has type <code>(Ord a, Floating a) =&gt; a -&gt; Bool</code>. This is because you can square any number (integer or real) but you can only compute the square root of a real. It isn&#39;t clear what the &quot;problem&quot; is - these are two valid, different functions, defined on different domains."}, {"owner": {"reputation": 79, "user_id": 4664868, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HHivQ.jpg?s=128&g=1", "display_name": "Alice", "link": "https://stackoverflow.com/users/4664868/alice"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447162968, "post_id": 33631304, "comment_id": 55035983, "body": "yes, but I wrote a function which generate primes and it works like it primes = 2 : [i | i &lt;- [3..],                 and [mod i p &gt; 0 | p &lt;- takeWhile (\\p-&gt;p^2&lt;=i) primes]] but I have a requirement to use sqrt and I don&#39;t know how to replace it in this context"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1447163337, "post_id": 33631304, "comment_id": 55036229, "body": "Your numbers are integers, so you have to convert them to reals: <code>\\p -&gt; fromIntegral p &lt;= sqrt (fromIntegral i)</code>."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447163741, "post_id": 33631304, "comment_id": 55036495, "body": "Same reason as <a href=\"http://stackoverflow.com/questions/33619011/problems-with-trivial-number-conversions-in-haskell\">yesterdays question</a>."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 3, "creation_date": 1447183200, "post_id": 33631304, "comment_id": 55049643, "body": "&quot;It doesn&#39;t work&quot; is not a useful problem description. If you are getting an error, include the error."}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1447264398, "post_id": 33631304, "comment_id": 55086688, "body": "@Alice, an equivalent way to write it that works for integers is <code>\\p -&gt; p * p &lt; i</code>."}], "owner": {"reputation": 79, "user_id": 4664868, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HHivQ.jpg?s=128&g=1", "display_name": "Alice", "link": "https://stackoverflow.com/users/4664868/alice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447163712, "creation_date": 1447162638, "last_edit_date": 1447163712, "question_id": 33631304, "link": "https://stackoverflow.com/questions/33631304/why-cant-i-replace-2-with-sqrt-in-an-inequality-for-takewhile", "title": "Why can&#39;t I replace ^2 with sqrt in an inequality for takeWhile?", "body": "<p>The following predicate correctly returns all numbers whose square is less than <code>i</code>:</p>\n\n<pre><code>takeWhile (\\p -&gt; p^2 &lt;= i) [1..10]\n</code></pre>\n\n<p>However, if I use <code>sqrt</code> on both sides, it doesn't work anymore:</p>\n\n<pre><code>takeWhile (\\p -&gt; p &lt;= sqrt i) [1..10]\n</code></pre>\n\n<p>Why does this happen? And how can I fix this?</p>\n"}, {"tags": ["xml", "haskell", "stream-processing", "xml-conduit"], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447240294, "post_id": 33637282, "comment_id": 55072011, "body": "An idea like this has occurred - but as I have 8 children - the sheer number of writing all the combined parsers would kill me."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1447249484, "last_edit_date": 1447249484, "creation_date": 1447181262, "answer_id": 33637282, "question_id": 33630702, "link": "https://stackoverflow.com/questions/33630702/stream-parsing-xml-without-knowing-the-ordering-of-child-tags/33637282#33637282", "title": "stream parsing xml without knowing the ordering of child tags", "body": "<p>Here's my idea...</p>\n\n<p>First some definitions:</p>\n\n<pre><code> {-# LANGUAGE OverloadedStrings, MultiWayIf #-}\n\n import Control.Monad.Trans.Resource\n import Data.Conduit\n import Data.Text (Text, unpack)\n import Data.XML.Types\n import Text.XML.Stream.Parse\n\n data SumType = A Text | B Text | C Text\n</code></pre>\n\n<p>We start with a conduit which accepts either an A or B tag, ignores\nthe attributes and returns the name and content:</p>\n\n<pre><code> parseAorB :: MonadThrow m =&gt; ConduitM Event o m (Maybe (Name, Text))\n parseAorB =\n   tag (\\n -&gt; if (n == \"A\" || n == \"B\") then Just n else Nothing) -- accept either A or B\n       (\\n -&gt; return n)                                           -- ignore attributes\n       (\\n -&gt; do c &lt;- content; return (n,c))                      -- extract content\n</code></pre>\n\n<p>Then we use that to write a conduit which parses two tags, makes sure\nthat one is an A and the other is a B:</p>\n\n<pre><code> parseAB :: MonadThrow m =&gt; ConduitM Event o m (Maybe (SumType, SumType))\n parseAB = do\n   t1 &lt;- parseAorB\n   case t1 of\n     Nothing      -&gt; return Nothing\n     Just (n1,c1) -&gt; do\n       t2 &lt;- parseAorB\n       case t2 of\n         Nothing -&gt; return Nothing\n         Just (n2,c2) -&gt; do\n           if | \"A\" == n1 &amp;&amp; \"B\" == n2 -&gt; return $ Just (A c1, B c2)\n              | \"A\" == n2 &amp;&amp; \"B\" == n1 -&gt; return $ Just (A c2, B c1)\n              | otherwise              -&gt; return Nothing\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>You can reduce the boilerplate in <code>parseAB</code> by using the <code>MaybeT</code> transformer:</p>\n\n<pre><code>import Control.Monad.Trans.Maybe\nimport Control.Monad.Trans\n\nparseAB' :: MonadThrow m =&gt; MaybeT (ConduitM Event o m) (SumType, SumType)\nparseAB' = do\n (n1, c1) &lt;- MaybeT parseAorB\n (n2, c2) &lt;- MaybeT parseAorB\n if | \"A\" == n1 &amp;&amp; \"B\" == n2 -&gt; return (A c1, B c2)\n    | \"A\" == n2 &amp;&amp; \"B\" == n1 -&gt; return (A c2, B c1)\n    | otherwise              -&gt; MaybeT $ return Nothing\n</code></pre>\n\n<p>And if you have several constructors, I'd consider doing something like this:</p>\n\n<pre><code>allkids = do\n  kids &lt;- many parseAorB\n  let sorted = sort kids -- automatically sorts by name\n  if map fst kids == [ \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\"]\n    then let [ca, cb, cc, cd, ce, cf, cg, ch] = map snd kids\n         in return (A ca, B cb, C cc, D cd, E ce, F cf, G cg, H ch)\n    else ...error...\n</code></pre>\n\n<p>The <code>many</code> combinator comes from <a href=\"https://hackage.haskell.org/package/xml-conduit-0.6.1/docs/Text-XML-Stream-Parse.html#v:many\" rel=\"nofollow\">Tet.XML.Stream.Parse</a>.</p>\n"}], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 33637282, "answer_count": 1, "score": 3, "last_activity_date": 1447249484, "creation_date": 1447160737, "question_id": 33630702, "link": "https://stackoverflow.com/questions/33630702/stream-parsing-xml-without-knowing-the-ordering-of-child-tags", "title": "stream parsing xml without knowing the ordering of child tags", "body": "<p>I have to parse some xml, i decided to use xml-conduit for that task and use the streaming part of it.</p>\n\n<p>The structure of the xml is given by an xsd-file that contains elements and how often they may occur. But <em>not</em> in which order they are expected.</p>\n\n<h1>How do I parse all possible reorderings of children of an xml-structure using <code>Text.XML.Stream.Parse</code> ?</h1>\n\n<h2>The problem</h2>\n\n<p>Say we have an xml description like </p>\n\n<pre><code>    Root \n    /  \\\n   A    B\n</code></pre>\n\n<p>then both <code>&lt;Root&gt;&lt;A&gt;atext&lt;/A&gt;&lt;B&gt;btext&lt;/B&gt;&lt;/Root&gt;</code> and  <code>&lt;Root&gt;&lt;B&gt;btext&lt;/B&gt;&lt;A&gt;atext&lt;/A&gt;&lt;/Root&gt;</code> are valid instances of this xml-structure.\nBut parsing in the streaming setup needs an ordering to succeed.</p>\n\n<p>I thought of using something like <code>parseRoot1 &lt;|&gt; parseRoot2</code> but then I have to implement the <code>Alternative</code> instance and write all the possibilities by hand, which I really don't want to.</p>\n\n<p>Here is a minimal sample haskell program.</p>\n\n<p><code>Example.hs</code></p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE Rank2Types #-}\n\nmodule Main where\n\nimport           Control.Exception\nimport           Control.Monad.Trans.Resource (MonadThrow)\nimport           Text.XML.Stream.Parse\nimport           Data.Monoid ((&lt;&gt;))\nimport           Data.Maybe\nimport           Data.Text (Text)\nimport           Data.XML.Types (Event)\nimport           Data.Conduit (ConduitM, Consumer, yield, ($=), ($$))\n\ndata Root = Root {a :: A, b :: B} deriving (Show, Eq)\ndata A = A Text deriving (Show, Eq)\ndata B = B Text deriving (Show, Eq)\n\nex1, ex2 :: Text\nex1 = \"&lt;Root&gt;\"&lt;&gt;\n        \"&lt;A&gt;Atest&lt;/A&gt;\"&lt;&gt;\n        \"&lt;B&gt;Btest&lt;/B&gt;\"&lt;&gt;\n      \"&lt;/Root&gt;\"\nex2 = \"&lt;Root&gt;\"&lt;&gt;\n        \"&lt;B&gt;Btest&lt;/B&gt;\"&lt;&gt;\n        \"&lt;A&gt;Atest&lt;/A&gt;\"&lt;&gt;\n      \"&lt;/Root&gt;\"\n\nex :: Root\nex = Root {a = A \"Atest\", b = B \"Btest\"}\n\nparseA :: MonadThrow m =&gt; ConduitM Event o m (Maybe A)\nparseA = tagIgnoreAttrs \"A\"\n            $ do result &lt;- content\n                 return (A $ result)\n\nparseB :: MonadThrow m =&gt; ConduitM Event o m (Maybe B)\nparseB = tagIgnoreAttrs \"B\"\n            $ do result &lt;- content\n                 return (B result)\n\nparseRoot1 :: MonadThrow m =&gt; ConduitM Event o m (Maybe Root)\nparseRoot1 = tagIgnoreAttrs \"Root\" $ do\n                 a' &lt;- fromMaybe (error \"error parsing A\") &lt;$&gt; parseA\n                 b' &lt;- fromMaybe (error \"error parsing B\") &lt;$&gt; parseB\n                 return $ Root{a = a', b = b'}\n\nparseRoot2 :: MonadThrow m =&gt; ConduitM Event o m (Maybe Root)\nparseRoot2 = tagIgnoreAttrs \"Root\" $ do\n                 b' &lt;- fromMaybe (error \"error parsing B\") &lt;$&gt; parseB\n                 a' &lt;- fromMaybe (error \"error parsing A\") &lt;$&gt; parseA\n                 return $ Root{a = a', b = b'}\n\nparseTxt :: Consumer Event (Either SomeException) (Maybe a)\n                          -&gt; Text \n                          -&gt; Either SomeException (Maybe a)\nparseTxt p inTxt = yield inTxt\n                  $= parseText' def\n                  $$ p\n\nmain :: IO ()\nmain = do putStrLn \"Poor Mans Test Suite\"\n          putStrLn \"====================\"\n          putStrLn \"test1 Root -&gt; A - B \" -- works\n          print $ parseTxt parseRoot1 ex1\n          putStrLn \"test1 Root -&gt; B - A \" -- fails\n          print $ parseTxt parseRoot1 ex2\n          putStrLn \"test2 Root -&gt; A - B \" -- fails\n          print $ parseTxt parseRoot2 ex1\n          putStrLn \"test2 Root -&gt; B - A \" -- works again\n          print $ parseTxt parseRoot2 ex2\n</code></pre>\n\n<p>note</p>\n\n<p><code>example.cabal</code></p>\n\n<pre><code>[...]\n  build-depends: base &gt;=4.8 &amp;&amp; &lt;4.9\n               , conduit\n               , resourcet\n               , text\n               , xml-conduit\n               , xml-types\n[...]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 6, "creation_date": 1447149382, "post_id": 33627227, "comment_id": 55028101, "body": "Use pattern matching, avoid partial functions."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1447149534, "post_id": 33627227, "comment_id": 55028197, "body": "also <code>map</code>, <code>fromMaybe</code> or <code>maybe</code> might be what you want here ;)"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 4900963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf5ff5469abea2ab3f5fc7e72ff514fe?s=128&d=identicon&r=PG&f=1", "display_name": "Noli", "link": "https://stackoverflow.com/users/4900963/noli"}, "edited": false, "score": 0, "creation_date": 1447150692, "post_id": 33627366, "comment_id": 55028949, "body": "Thank you, that was very helpful. Yea I was just looking at the otherwise-guard and somehow oversaw, that the fromJust-call was also in the first guard. Also thank you for your further tips!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "is_accepted": true, "score": 3, "last_activity_date": 1447149739, "creation_date": 1447149739, "answer_id": 33627366, "question_id": 33627227, "link": "https://stackoverflow.com/questions/33627227/haskell-exception-with-fromjust-function/33627366#33627366", "title": "Haskell: Exception with fromJust function", "body": "<p>The problem is that that <code>Nothing</code> check comes <em>after</em> the call to <code>fromJust</code>. In your way of solving it, it should be this:</p>\n\n<pre><code>payment ::  [(Integer , Integer)] -&gt; Integer -&gt;  [(Integer , Integer)] -&gt; Maybe  [(Integer , Integer)]\npayment portemonnaie amount cashier | pay portemonnaie amount == Nothing = Nothing\n                                    | content (fromJust (pay portemonnaie amount)) - amount == 0 = Just []\n                                    | otherwise = payExact cashier (content (fromJust (pay portemonnaie amount)) - amount)\n</code></pre>\n\n<p>However, it could still be better. First off, since Haskell 2010 (or in Haskell 98 with the <code>PatternGuards</code> extension), it's easier to write this:</p>\n\n<pre><code>payment ::  [(Integer , Integer)] -&gt; Integer -&gt;  [(Integer , Integer)] -&gt; Maybe  [(Integer , Integer)]\npayment portemonnaie amount cashier | Nothing &lt;- pay portemonnaie amount = Nothing\n                                    | Just paid &lt;- pay portemonnaie amount, content paid - amount == 0 = Just []\n                                    | otherwise = payExact cashier (content paid - amount)\n</code></pre>\n\n<p>Furthermore, you could shorten some things by using a <code>where</code> clause:</p>\n\n<pre><code>payment ::  [(Integer , Integer)] -&gt; Integer -&gt;  [(Integer , Integer)] -&gt; Maybe  [(Integer , Integer)]\npayment portemonnaie amount cashier | Nothing &lt;- mayHavePaid = Nothing\n                                    | Just paid &lt;- mayHavePaid, content paid - amount == 0 = Just []\n                                    | otherwise = payExact cashier (content paid - amount)\n  where\n    mayHavePaid = pay portemonnaie amount\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 0, "last_activity_date": 1447208457, "creation_date": 1447208457, "answer_id": 33643222, "question_id": 33627227, "link": "https://stackoverflow.com/questions/33627227/haskell-exception-with-fromjust-function/33643222#33643222", "title": "Haskell: Exception with fromJust function", "body": "<p>Without any extensions it is still possible to write this quite readably (indeed, I would argue, more readably than the answer using pattern guards). First, notice that the one thing you do in all cases is <code>pay portemonnaie amount</code>, and that you must do different things depending on the result of that function: so, put it first, and pattern-match on it:</p>\n\n<pre><code>case pay portemonnaie amount of\n  -- ...\n</code></pre>\n\n<p>The Nothing case is easy, so you can trivially add it in, and leave a blank for the Just: </p>\n\n<pre><code>case pay portemonnaie amount of\n  Nothing -&gt; Nothing\n  (Just receipt) -&gt; -- ...\n</code></pre>\n\n<p>Now, if there was a Just (which I'm calling receipt here, since I'm not sure what it is in your domain), then you always need to compute the leftover amount, so let's put that in a where clause:</p>\n\n<pre><code>case pay portemonnaie amount of\n  Nothing -&gt; Nothing\n  (Just receipt) -&gt; -- ...\n    where outstanding = content receipt - amount\n</code></pre>\n\n<p>Now all that's left is to fill in the different guard clauses for the Just pattern, which is very easy now that the relevant values are already bound:</p>\n\n<pre><code>case pay portemonnaie amount of\n  Nothing -&gt; Nothing\n  (Just receipt) | outstanding == 0 -&gt; Just []\n                 | otherwise -&gt; payExact cashier outstanding\n    where outstanding = content receipt - amount\n</code></pre>\n\n<p>And of course slot that expression back into the body of the actual function:</p>\n\n<pre><code>payment :: [(Integer, Integer)] -&gt; Integer -&gt; [(Integer, Integer)] -&gt; Maybe [(Integer, Integer)]\npayment portemonnaie amount cashier =\n  case pay portemonnaie amount of\n    Nothing -&gt; Nothing\n    (Just receipt) | outstanding == 0 -&gt; Just []\n                   | otherwise -&gt; payExact cashier outstanding\n      where outstanding = content receipt - amount\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 4900963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf5ff5469abea2ab3f5fc7e72ff514fe?s=128&d=identicon&r=PG&f=1", "display_name": "Noli", "link": "https://stackoverflow.com/users/4900963/noli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 1, "accepted_answer_id": 33627366, "answer_count": 2, "score": 0, "last_activity_date": 1447208457, "creation_date": 1447149294, "question_id": 33627227, "link": "https://stackoverflow.com/questions/33627227/haskell-exception-with-fromjust-function", "title": "Haskell: Exception with fromJust function", "body": "<p>I wrote the following function in haskell</p>\n\n<pre><code>payment ::  [(Integer , Integer)] -&gt; Integer -&gt;  [(Integer , Integer)] -&gt; Maybe  [(Integer , Integer)]\npayment portemonnaie amount cashier | content (fromJust (pay portemonnaie amount)) - amount == 0 = Just []\n                                    | pay portemonnaie amount == Nothing = Nothing\n                                    | otherwise = payExact cashier (content (fromJust (pay portemonnaie amount)) - amount)\n</code></pre>\n\n<p>The problem here is: The function pay returns a Maybe type. So when the function 'pay' returns Nothing I get the following exception:</p>\n\n<pre><code>*** Exception: Maybe.fromJust: Nothing\n</code></pre>\n\n<p>I tried to prevent that by asking:</p>\n\n<pre><code>| pay portemonnaie amount == Nothing = Nothing\n</code></pre>\n\n<p>But apparently this is not possible. Does anybody have a more smarter way to build around this? Thank you</p>\n"}, {"tags": ["list", "haskell", "iteration"], "comments": [{"owner": {"reputation": 1420, "user_id": 693416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b40373fe8f75f5eed0609e695042d528?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/693416/greg"}, "edited": false, "score": 0, "creation_date": 1447184358, "post_id": 33621855, "comment_id": 55050277, "body": "Operations that would use iteration in an imperative language like C/Java is most often done using recursion in Haskell, either by explicitly in a function or else using existing capabilities like fold, map, or reduce"}], "answers": [{"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1447183795, "post_id": 33621961, "comment_id": 55049961, "body": "As an aside that is a bit beyond the scope of the question, I like to represent positions using <a href=\"https://hackage.haskell.org/package/linear-1.20.2/docs/Linear-Affine.html\" rel=\"nofollow noreferrer\"><code>Point</code></a> from the linear package. Then you can compare <code>player^.position == object^.position</code> and supply an <code>R2</code> instance for each that &quot;delegates&quot; so you can also say <code>player^._x</code> and <code>object^._y</code>."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1447193923, "post_id": 33621961, "comment_id": 55055481, "body": "It might be worth, pointing that Haskell is lazzy, therefore <code>any</code> <i>breaks</i> at the first collision."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 1, "creation_date": 1447194056, "post_id": 33621961, "comment_id": 55055541, "body": "@mb14 Edited to include that note"}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 7, "last_activity_date": 1447194016, "last_edit_date": 1447194016, "creation_date": 1447123123, "answer_id": 33621961, "question_id": 33621855, "link": "https://stackoverflow.com/questions/33621855/haskell-how-do-i-iterate-and-compare/33621961#33621961", "title": "Haskell - How do I iterate and compare?", "body": "<p>Even if this were Java/C, I would recommend that you write a function that detects if a player and a single object would collide, so let's do that here:</p>\n\n<pre><code>collidesWith :: Player -&gt; Object -&gt; Bool\ncollidesWith player object =\n    playerX player == objectX object &amp;&amp; playerY player == objectY object\n</code></pre>\n\n<p>This is a little wordy, you can shorten this using the <code>lens</code> library to actually make it look like</p>\n\n<pre><code>collidesWith player object\n    = player^.x == object^.x &amp;&amp; player^.y == object^.y\n</code></pre>\n\n<p>But this is outside the scope of this question, just know that it's fully possible in Haskell.</p>\n\n<p>For \"looping\" over a list in Haskell you can use recursion</p>\n\n<pre><code>detectCollision player [] = False  -- No objects, no collisions\ndetectCollision player (o:objects)\n    = player `collidesWith` o || detectCollision player objects\n</code></pre>\n\n<p>Since Haskell is lazy, the first time <code>player `collidesWith` o</code> evaluates to <code>True</code> it will stop checking.  But this actually already exists as a standard built in function named <code>any</code>:</p>\n\n<pre><code>any :: (a -&gt; Bool) -&gt; [a] -&gt; Bool\n</code></pre>\n\n<p>And can be used as</p>\n\n<pre><code>detectCollision player objects = any (collidesWith player) objects\n</code></pre>\n\n<p>Haskell even lets you drop the <code>objects</code> argument through eta reduction, so it can be written simply as</p>\n\n<pre><code>detectCollision :: Player -&gt; [Object] -&gt; Bool\ndetectCollision player = any (collidesWith player)\n</code></pre>\n\n<p>And that's it!</p>\n\n<p>Note: This is assuming that <code>Player</code> and <code>Object</code> are defined as</p>\n\n<pre><code>data Player = Player\n    { playerX :: Int\n    , playerY :: Int\n    } deriving (Eq, Show)\n\ndata Object = Object\n    { objectX :: Int\n    , objectY :: Int\n    } deriving (Eq, Show)\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 4227771, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1132754165/picture?type=large", "display_name": "Hassan Ali", "link": "https://stackoverflow.com/users/4227771/hassan-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1447194016, "creation_date": 1447122475, "last_edit_date": 1447130370, "question_id": 33621855, "link": "https://stackoverflow.com/questions/33621855/haskell-how-do-i-iterate-and-compare", "title": "Haskell - How do I iterate and compare?", "body": "<p>I have an issue. I am currently learning Haskell, and trying to build a dungeon game. </p>\n\n<p>Currently I am trying to implement a movement function for the player. Before moving to a new position,I must check if the player's new position will collide with the position of an object on the map of the game.</p>\n\n<p>The code I have in my head (in Java/C) is fairly simple, yet I cannot think how it would cross over to Haskell. I'm pretty sure there's an alternative approach using Haskell code but this is the rough idea (Java/C):-</p>\n\n<p>Let's assume the player object has x and y coordinates.\nLet's also assume we store a list of other objects that the player may collide with in an array (this would be stored in a list for Haskell, I assume). Also, lets assume each object has an x and y co-ordinate.\nThe Boolean function returns <code>true</code> if a collision will occur, or <code>false</code> if not. </p>\n\n<pre><code>   Boolean detectCollision(Player p, Object[] o)\n   {\n       for(int i=0; i &lt; o.length; i++){\n           if(p.x==o[i].x &amp;&amp; p.y==o[i].y){\n               return true;\n           }\n       } return false; \n   }\n</code></pre>\n\n<p>If someone could help me figure this out I'd be very grateful.</p>\n"}, {"tags": ["haskell", "llvm", "gmp", "integer-arithmetic"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1447158389, "post_id": 33621832, "comment_id": 55033266, "body": "You could try to implement your function as a primop. Newer versions of ghc support the <a href=\"https://wiki.haskell.org/Foreign_Function_Interface#Foreign_PrimOps\" rel=\"nofollow noreferrer\"><code>foreign import prim</code></a> syntax. From C-- you can call whichever assembly instructions you need to hyper-optimize your code, and you get the benefit of your foreign function being a first class haskell function. Of course, the downside is this requires knowing a significant amount about the GHC RTS."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1447164838, "post_id": 33621832, "comment_id": 55037236, "body": "@user2407038: the issue with current foreign primops is that they&#39;re never inlined."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1447178621, "post_id": 33621832, "comment_id": 55047086, "body": "See if you can get clang to generate a series of ADCs with <code>__builtin_addc</code> and if so have it output the intermediate LLVM code. Then see if you can get GHC to generate sufficiently similar LLVM code. (The NCG is just not smart enough about using the condition register for this.)"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1447180024, "post_id": 33621832, "comment_id": 55047904, "body": "I gather that the GMP has been carefully optimised; I would be very wary of thinking you can do better, even if you save a JSR and RTN."}, {"owner": {"reputation": 361, "user_id": 4237232, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9O5kKSPEl6Y/AAAAAAAAAAI/AAAAAAAAAB0/ht9QINTIVnQ/photo.jpg?sz=128", "display_name": "Demur Rumed", "link": "https://stackoverflow.com/users/4237232/demur-rumed"}, "edited": false, "score": 0, "creation_date": 1461521787, "post_id": 33621832, "comment_id": 61225050, "body": "GMP implements the math with SSE &amp; will implement individual code for different CPUs of the same assembly language. See <a href=\"https://github.com/SaberMod/gnu-gmp/tree/6.0.0/mpn/x86_64\" rel=\"nofollow noreferrer\">github.com/SaberMod/gnu-gmp/tree/6.0.0/mpn/x86_64</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2562, "user_id": 552038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb008c9f490e3faed32ef45d18090124?s=128&d=identicon&r=PG", "display_name": "Chandler Carruth", "link": "https://stackoverflow.com/users/552038/chandler-carruth"}, "is_accepted": false, "score": 1, "last_activity_date": 1464680724, "creation_date": 1464680724, "answer_id": 37539800, "question_id": 33621832, "link": "https://stackoverflow.com/questions/33621832/big-number-arithmetic-using-llvm-from-haskell/37539800#37539800", "title": "Big number arithmetic using LLVM (from Haskell)", "body": "<p>The correct thing to do here is to make sure that your Haskell frontend represents your carrying arithmetic in LLVM's IR using the same patterns formed by Clang when using its __builtin_addc.</p>\n\n<p>However, don't expect this to produce good code with LLVM today. See <a href=\"http://llvm.org/PR20748\" rel=\"nofollow\">http://llvm.org/PR20748</a> which documents the absolutely horrible code we currently generate on x86 for trivial patterns like this. But once that bug is fixed, you should get the generated code you desire.</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 2, "answer_count": 1, "score": 8, "last_activity_date": 1464680724, "creation_date": 1447122323, "last_edit_date": 1495535625, "question_id": 33621832, "link": "https://stackoverflow.com/questions/33621832/big-number-arithmetic-using-llvm-from-haskell", "title": "Big number arithmetic using LLVM (from Haskell)", "body": "<p>An answer to my previous <a href=\"https://stackoverflow.com/questions/33595312/getting-ghc-to-produce-add-with-carry-adc-instructions\">question</a> indicated that Haskell represents <a href=\"https://hackage.haskell.org/package/ghc-prim-0.4.0.0/docs/GHC-Prim.html#v:plusWord2-35-\" rel=\"nofollow noreferrer\"><code>plusWord2#</code></a> as <a href=\"http://llvm.org/docs/LangRef.html#llvm-uadd-with-overflow-intrinsics\" rel=\"nofollow noreferrer\"><code>llvm.uadd.with.overflow</code></a>. I'm looking to do long addition with carry, like how the x86 ADC instruction works. This instruction not only adds it's two arguments, but also adds the contents of the carry bit.</p>\n\n<p>One can then add long numbers like the following:</p>\n\n<pre><code>ADD x1 y1\nADC x2 y2\nADC x3 y3\n...\n</code></pre>\n\n<p>Resulting in one instruction per word (disregarding any surrounding moves etc required).</p>\n\n<p>I looked at the GMP library, and how it did long addition itself, in its generic C code. Here's an excerpt from <code>mpn/generic/add_n.c</code></p>\n\n<pre><code>sl = ul + vl;\ncy1 = sl &lt; ul;\nrl = sl + cy;\ncy2 = rl &lt; sl;\ncy = cy1 | cy2;\n</code></pre>\n\n<p>Note it saves the carry bits from both the original addition and the addition of the carry bit. Only one of these operations can carry, so or'ing the carries afterwards is sufficient.</p>\n\n<p>Obviously GMP has specific assembly code for particular platforms, but I thought the generic code would be a good basis, as it would presumably be written to compile to reasonable code. The <code>plusWord2#</code> primitive operation means I don't need to do silly comparisons to get the carry bit, so I implemented the GMP generic code like the following in Haskell:</p>\n\n<pre><code>addWithCarry :: Word# -&gt; Word# -&gt; Word# -&gt; (# Word#, Word# #)\naddWithCarry x y c =\n  let \n    (# c1, r1 #) = plusWord2# x y\n    (# c2, r2 #) = plusWord2# r1 c\n  in\n    (# or# c1 c2, r2 #)\n</code></pre>\n\n<p>Unfortunately this results in x86 code that saves the carry bit into a register before then adding the carry bit on it's own, as well as adding the two numbers, resulting in three or four instructions per word instead of one. </p>\n\n<p>So what I'm wondering is how I can combine <code>llvm.uadd.with.overflow</code> to create a chain of ADC instructions on x86 to implement multi-precision arithmetic. If I got LLVM code that produced efficient long addition I was hoping I could then convert it back into Haskell primitive ops to produce the efficient addition directly from Haskell code.</p>\n\n<p><strong>Notes:</strong></p>\n\n<p>I could of course use Haskell's FFI to call inline assembly or GMP, but that would stop inlining and I suspect be relatively slow as compared to inlined code for small (i.e. &lt;=256 bit) operands. </p>\n\n<p>I've found that 'clang' has <a href=\"http://clang.llvm.org/docs/LanguageExtensions.html#multiprecision-arithmetic-builtins\" rel=\"nofollow noreferrer\"><code>__builtin_addc</code></a>, a form of three argument addition that takes not only two numbers but a carry bit, but GHC doesn't compile via clang, so I don't see how this is useful.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1447114040, "post_id": 33620178, "comment_id": 55015740, "body": "If you don&#39;t want to expose a module, you still need to include it in the <code>other-modules</code> section. Besides that, yes, you are stuck listing every module in the cabal file. Relevant line from the user guide: <a href=\"https://downloads.haskell.org/~ghc/7.0.4/docs/html/Cabal/authors.html#buildinfo\" rel=\"nofollow noreferrer\">&quot;Every module in the package must be listed in one of other-modules, exposed-modules or main-is fields.&quot;</a>"}, {"owner": {"reputation": 372, "user_id": 2722784, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/17935d19c83cba797a7c8e1470dc20bb?s=128&d=identicon&r=PG", "display_name": "Feenaboccles", "link": "https://stackoverflow.com/users/2722784/feenaboccles"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447169389, "post_id": 33620178, "comment_id": 55040679, "body": "That seems really clunky. Am I right in thinking that my project layout follows Haskell best practice? Will I really just be listing every source file in Cabal."}], "answers": [{"tags": [], "owner": {"reputation": 372, "user_id": 2722784, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/17935d19c83cba797a7c8e1470dc20bb?s=128&d=identicon&r=PG", "display_name": "Feenaboccles", "link": "https://stackoverflow.com/users/2722784/feenaboccles"}, "is_accepted": false, "score": 2, "last_activity_date": 1447514725, "creation_date": 1447514725, "answer_id": 33709957, "question_id": 33620178, "link": "https://stackoverflow.com/questions/33620178/unit-testing-can-module-re-exports-avoid-having-to-expose-all-testable-module/33709957#33709957", "title": "Unit-Testing: Can module re-exports avoid having to &quot;expose&quot; all testable modules", "body": "<p>So in the end this is unavoidable. However, on reflection, it is also good behaviour. Since I'm creating a library, and the Haskell language can't control module visibility, I have to specify which modules are to be exported in Cabal.</p>\n\n<p>In order to function as tests, my tests should not have any additional access to an application that my library client does. Therefore it's acceptable that my tests can't access any modules that are also inaccessible to clients of my library.</p>\n\n<p>In practice however, there are some internal elements I will want to test which are not exposed. Therefore, I've split my test-suite in two, one internal, and the other external, which test these different aspects. </p>\n\n<pre><code>test-suite ventureforth-test-external\n  type:                exitcode-stdio-1.0\n  hs-source-dirs:      test\n  main-is:             Spec.hs\n  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5,\n                       ventureforth -any,\n                       hspec -any\n  ghc-options:         -Wall -Werror -threaded -rtsopts -with-rtsopts=-N\n  default-language:    Haskell2010\n\ntest-suite ventureforth-test-internal\n  type:                exitcode-stdio-1.0\n  hs-source-dirs:      test,src\n  main-is:             Spec.hs\n  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5,\n                       hspec -any\n  ghc-options:         -Wall -Werror -threaded -rtsopts -with-rtsopts=-N\n  default-language:    Haskell2010\n</code></pre>\n\n<p>The internal test has access to the source-code directly, and so doesn't import the library.</p>\n\n<p>Lastly as a second source of \"internal\" testing, I'm also using doctests, as described in the <a href=\"http://taylor.fausak.me/2014/03/04/haskeleton-a-haskell-project-skeleton/\" rel=\"nofollow\">Haskeleton project setup guide</a> </p>\n\n<p>Finally, for anyone else structuring a Haskell project, note that you can use the <a href=\"https://github.com/fujimura/hi\" rel=\"nofollow\">Haskell Init tool</a> to create a skeleton project called <code>my-project-name</code> in a directory of the same name with all the testing bits and bobs set up and ready to go</p>\n\n<pre><code>hi my-project-name \\\n    --repository git://github.com/tfausak/haskeleton.git \\\n    --package-name my-project-name \\\n    --module-name MyProjectName \\\n    --author Bryan Feeney \\\n    --email bryan.feeney@mailserver.com\n</code></pre>\n\n<p>The repository flag gives a path to a template project. The Haskeleton template features unit-tests, documentation tests and benchmarks. Other project tempaltes, such as web-apps, can be found on the <a href=\"https://github.com/fujimura/hi/wiki#available-templates\" rel=\"nofollow\">HI templates page</a>. To install the Haskell Init tool, just type</p>\n\n<pre><code>cabal install hi\n</code></pre>\n"}], "owner": {"reputation": 372, "user_id": 2722784, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/17935d19c83cba797a7c8e1470dc20bb?s=128&d=identicon&r=PG", "display_name": "Feenaboccles", "link": "https://stackoverflow.com/users/2722784/feenaboccles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1447514725, "creation_date": 1447111175, "question_id": 33620178, "link": "https://stackoverflow.com/questions/33620178/unit-testing-can-module-re-exports-avoid-having-to-expose-all-testable-module", "title": "Unit-Testing: Can module re-exports avoid having to &quot;expose&quot; all testable modules", "body": "<p>TLDR: Is it possible to use module re-exports to avoid having \"expose\" all testable modules?</p>\n\n<p>I've used something similar to the Chris Done template for my Haskell project. My <code>ventureforth.cabal</code> file has the following sections:</p>\n\n<pre><code>library\n  hs-source-dirs:      src\n  exposed-modules:     VForth,\n                       VForth.Location\n  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5\n  ghc-options:         -Wall -Werror\n  default-language:    Haskell2010\n\nexecutable ventureforth\n  hs-source-dirs:      app\n  main-is:             Main.hs\n  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5,\n                       ventureforth -any\n  ghc-options:         -Wall -Werror -threaded -rtsopts -with-rtsopts=-N\n  default-language:    Haskell2010\n\ntest-suite ventureforth-test\n  type:                exitcode-stdio-1.0\n  hs-source-dirs:      test\n  main-is:             Spec.hs\n  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5,\n                       ventureforth -any,\n                       doctest &gt;= 0.9 &amp;&amp; &lt; 0.11,\n                       hspec -any\n  ghc-options:         -Wall -Werror -threaded -rtsopts -with-rtsopts=-N\n  default-language:    Haskell2010\n</code></pre>\n\n<p>My code is laid out as</p>\n\n<pre><code>ventureforth/\n |\n +- ventureforth.cabal\n +- app/\n |   |\n |   +- Main.hs\n |\n +- src/\n |   |\n |   +- VForth.hs\n |   +- VForth/\n |       |\n |       +- Location.hs\n |\n +- test/\n |   |\n |   +- Spec.hs\n |   +- VForth\n |       |\n |       +- LocationSpec.hs\n</code></pre>\n\n<p>I've set up <code>VForth.hs</code> to re-export <code>VForth.Location</code></p>\n\n<pre><code>module VForth (\n    module VForth.Location\n) where\n\nimport VForth.Location\n</code></pre>\n\n<p>And in the <code>VForth.LocationSpec</code> unit-test I need only <code>import VForth</code> to test the <code>Location</code> type.</p>\n\n<p>However unless I add add <code>VForth.Location</code> to the list of \"exposed modules\" I encounter linker errors when trying to run <code>cabal test</code>.</p>\n\n<p>I had thought exposing a single module, <code>VForth</code>, which re-exported all other modules, would have sufficed. Am I really stuck in the situation of having to list every single source file in cabal?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1447109575, "post_id": 33619802, "comment_id": 55014134, "body": "So... What&#39;s your question?"}, {"owner": {"reputation": 79, "user_id": 4664868, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HHivQ.jpg?s=128&g=1", "display_name": "Alice", "link": "https://stackoverflow.com/users/4664868/alice"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447109736, "post_id": 33619802, "comment_id": 55014199, "body": "I actually don&#39;t know how to take 2 elements at a time and check if they differ by no more than epsilon. If I write something like check x y e = abs(x-y)&lt;=e I don&#39;t really know how to use it in writing within function"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1447109989, "post_id": 33619802, "comment_id": 55014301, "body": "I&#39;m not at my PC, but I&#39;ve written an answer about taking two elements of a list earlier today. It might be helpful. Basically use <code>within eps (x:y:xs) = ...</code>. However, you should think about the function&#39;s behaviour if the list isn&#39;t infinite and/or doesn&#39;t contain a fitting pair."}, {"owner": {"reputation": 6415, "user_id": 1416525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6f23f148b7241e345a61d193ed205685?s=128&d=identicon&r=PG", "display_name": "cdk", "link": "https://stackoverflow.com/users/1416525/cdk"}, "edited": false, "score": 0, "creation_date": 1447110151, "post_id": 33619802, "comment_id": 55014382, "body": "Here is some inspiration: this function takes a list and returns a list of pairs of consecutive elements <code>ap zip tail :: [a] -&gt; [(a,a)]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 4664868, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HHivQ.jpg?s=128&g=1", "display_name": "Alice", "link": "https://stackoverflow.com/users/4664868/alice"}, "edited": false, "score": 0, "creation_date": 1447111838, "post_id": 33620127, "comment_id": 55015041, "body": "Thank you! It was very helpful! :D"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "is_accepted": true, "score": 5, "last_activity_date": 1447110921, "creation_date": 1447110921, "answer_id": 33620127, "question_id": 33619802, "link": "https://stackoverflow.com/questions/33619802/how-to-implement-within-function-in-haskell/33620127#33620127", "title": "how to implement Within function in Haskell?", "body": "<p>In Haskell, a list is just another data structure, perhaps with some (in my opinion) confusing notation. With any data structure, you can use pattern matching. When you're only working with lists, you have three possible things in a pattern:</p>\n\n<ul>\n<li>A variable, like <code>x</code>.</li>\n<li>A constructor applied to zero or more patterns,\n\n<ul>\n<li>like with <code>(:) x xs</code> (or perhaps more familiarily: <code>x:xs</code>),</li>\n<li>or <code>[]</code></li>\n</ul></li>\n</ul>\n\n<p>Note that, in patterns, you apply constructors to <em>patterns</em>. It's perfectly allowable to write <code>(:) x ((:) y ys)</code> (more commonly written as <code>x:y:ys</code>), which matches any list of at least two elements, and assigns the first element to <code>x</code>, the second to <code>y</code>, and the remainder of the list to <code>ys</code>.</p>\n\n<p>The skeleton of your <code>within</code> function would look something like this:</p>\n\n<pre><code>theFunction theList = case theList of\n                          x:y:ys -&gt; if canGiveAnswer x y\n                                        then buildAnswer x y\n                                        else theFunction (y:ys)\n</code></pre>\n\n<p>Here, <code>theFunction</code> tries to match its input with the pattern <code>x:y:ys</code>, checks whether <code>x</code> and <code>y</code> are sufficient to give an answer, and do so when it can, or restart itself (<code>theFunction (y:ys)</code>) with the first element of the list removed.</p>\n\n<p>You can write this more tersely like</p>\n\n<pre><code>theFunction (x:y:ys) = if canGiveAnswer x y then buildAnswer x y else theFunction (y:ys)\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>theFunction (x:y:ys) | canGiveAnswer x y = buildAnswer x y\n                     | True = theFunction (y:ys)\n</code></pre>\n\n<p>Of course, in your case, you need an extra argument:</p>\n\n<pre><code>within :: (Ord a, Num a) =&gt; a -&gt; [a] -&gt; a\nwithin epsilon (x:y:ys) | canGiveAnswer x y epsilon = buildAnswer x y epsilon\n                        | True = within epsilon (y:ys)\n</code></pre>\n\n<p>I'll leave it up to you to figure out what <code>canGiveAnswer</code> and <code>buildAnswer</code> are supposed to be.</p>\n"}], "owner": {"reputation": 79, "user_id": 4664868, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HHivQ.jpg?s=128&g=1", "display_name": "Alice", "link": "https://stackoverflow.com/users/4664868/alice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "accepted_answer_id": 33620127, "answer_count": 1, "score": 1, "last_activity_date": 1447110921, "creation_date": 1447109371, "last_edit_date": 1447109658, "question_id": 33619802, "link": "https://stackoverflow.com/questions/33619802/how-to-implement-within-function-in-haskell", "title": "how to implement Within function in Haskell?", "body": "<pre><code>within :: (Ord a, Num a) =&gt; a -&gt; [a] -&gt; a\n</code></pre>\n\n<p>that takes a tolerance, that is, a number\nepsilon and an infinite list of numbers, and\nlooks down the list to find two consecutive numbers in the list that differ by no more than epsilon it returns the second of these. (It might never return if there is no such pair of\nconsecutive elements.) For example,</p>\n\n<pre><code>within 1.0 [1.0 ..] = 2.0\nwithin 0.5 ([1.0, 32.5, 17.2346, 10.474, 8.29219, 8.00515]\n++ [8.0, 8.0 ..])\n= 8.00515\n</code></pre>\n"}, {"tags": ["haskell", "numbers", "type-conversion", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "edited": false, "score": 0, "creation_date": 1447218212, "post_id": 33619064, "comment_id": 55062845, "body": "Thank you for the clear response. Really helps remind me to think through my typeclasses. Upvoted. Zeta beat you to it, so he gets the accept."}], "tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": false, "score": 4, "last_activity_date": 1447106460, "creation_date": 1447106460, "answer_id": 33619064, "question_id": 33619011, "link": "https://stackoverflow.com/questions/33619011/problems-with-trivial-number-conversions-in-haskell/33619064#33619064", "title": "problems with trivial number conversions in Haskell", "body": "<p>Change your function to</p>\n\n<pre><code>dropLastDigit :: (Integral b) =&gt; b -&gt; b\ndropLastDigit x = (quot x 10) * (floor $ logBase 10 (fromIntegral x))\n</code></pre>\n\n<p>The code you're running in GHCi is not identical. You've replaced <code>x</code> by <code>101</code>. The <code>x</code> in your function was annotated (by type signature) to be of type <code>b</code> for any type <code>b</code> in the <code>Integral</code> class, but <code>logBase</code> needs something in the <code>Floating</code> class.</p>\n\n<p>On the other hand, the literal <code>101</code> is of type <code>Num a =&gt; a</code>, i.e., it is overloaded and can be used at any numeric type. So GHCi can use it at type <code>Integer</code> on the first occurrence, as an argument of <code>quot</code>, and as a <code>Double</code> on the second occurrence, as an argument to <code>logBase</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 3, "last_activity_date": 1447106859, "creation_date": 1447106859, "answer_id": 33619187, "question_id": 33619011, "link": "https://stackoverflow.com/questions/33619011/problems-with-trivial-number-conversions-in-haskell/33619187#33619187", "title": "problems with trivial number conversions in Haskell", "body": "<p>It's not identical. You can check this easily:</p>\n\n<pre><code>ghci&gt; let value101 = 101 :: Integral b =&gt; b\nghci&gt; let value10  = 10  :: Integral b =&gt; b\nghci&gt; (quot value101 value10) * (floor $ logBase value10 value101)\n\n&lt;interactive&gt;:7:28:\n    Could not deduce (RealFrac s0) arising from a use of `floor'\n    from the context (Integral a)\n      bound by the inferred type of it :: Integral a =&gt; a\n      at &lt;interactive&gt;:7:1-60\n    The type variable `s0' is ambiguous\n    Note: there are several potential instances:\n      instance RealFrac Double -- Defined in `GHC.Float'\n      instance RealFrac Float -- Defined in `GHC.Float'\n      instance Integral a =&gt; RealFrac (GHC.Real.Ratio a)\n        -- Defined in `GHC.Real'\n    In the expression: floor\n    In the second argument of `(*)', namely\n      `(floor $ logBase value10 value101)'\n    In the expression:\n      (quot value101 value10) * (floor $ logBase value10 value101)\n\n-- even more...\n</code></pre>\n\n<p>The problem is that both <code>10</code> and <code>101</code> have type <code>Num a =&gt; a</code>, regardless of where you use them. So <code>logBase 10 101</code> used them with the default <code>Fractional</code> instance (<code>Double</code>), whereas <code>quot</code> used them with the default <code>Integral</code> instance.</p>\n\n<p>That being said, your function doesn't \"drop\" the last digit. If you just want to transform <code>12345</code> to <code>1234</code>, you can simplify <code>dropLastDigit</code> to</p>\n\n<pre><code>dropLastDigit x = x `div` 10\n</code></pre>\n\n<p>If you, however, want to transform <code>12345</code> to <code>12340</code>, you just have to multiply by ten afterwards:</p>\n\n<pre><code>dropLastDigit x = 10 * (x `div` 10)\n</code></pre>\n"}], "owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 33619187, "answer_count": 2, "score": 1, "last_activity_date": 1447106859, "creation_date": 1447106203, "question_id": 33619011, "link": "https://stackoverflow.com/questions/33619011/problems-with-trivial-number-conversions-in-haskell", "title": "problems with trivial number conversions in Haskell", "body": "<p>I am attempting to write a trivial function to drop the last digit of a number and return the rest of the number.</p>\n\n<pre><code>dropLastDigit :: (Integral b) =&gt; b -&gt; b\ndropLastDigit x = (quot x 10) * (floor $ logBase 10 x)\n</code></pre>\n\n<p>however, when I try to load this into ghci, I get:</p>\n\n<pre><code>Could not deduce (Floating b) arising from a use of \u2018logBase\u2019\n    from the context (Integral b)\n      bound by the type signature for\n                 dropLastDigit :: Integral b =&gt; b -&gt; b\n      at haskelljokes.hs:6:18-39\n    Possible fix:\n      add (Floating b) to the context of\n        the type signature for dropLastDigit :: Integral b =&gt; b -&gt; b\n    In the second argument of \u2018($)\u2019, namely \u2018logBase 10 x\u2019\n    In the expression: floor $ logBase 10 x\n    In an equation for \u2018dropLastDigit\u2019:\n        dropLastDigit x = floor $ logBase 10 x\n</code></pre>\n\n<p>However, running this code in ghci:</p>\n\n<p><code>:t (quot 101 10) * (floor $ logBase 10 101)</code></p>\n\n<p>produces: <code>(quot 101 10) * (floor $ logBase 10 101) :: Integral a =&gt; a</code></p>\n\n<p>My question is, what am I doing wrong? And why is (the identical code?) working in ghci?</p>\n"}, {"tags": ["haskell", "tree", "traversal"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1447099085, "post_id": 33616817, "comment_id": 55008763, "body": "... that&#39;s not the point of functional languages. Also, the data structure you have defined isn&#39;t terribly useful since it only keeps track of the shape of the tree, not the data in it."}, {"owner": {"reputation": 327, "user_id": 3705854, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/5c43b9964018d1f3e2f65c35ab0b0c54?s=128&d=identicon&r=PG&f=1", "display_name": "JKS", "link": "https://stackoverflow.com/users/3705854/jks"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1447102212, "post_id": 33616817, "comment_id": 55010426, "body": "Well you can imagine that there is also big data contained within, that&#39;s just simplification."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 4, "creation_date": 1447102929, "post_id": 33616817, "comment_id": 55010837, "body": "I disagree with the close votes. There&#39;s a sizable body of knowledge regarding tree annotations in Haskell, which an answer could meaningfully cover."}], "answers": [{"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1447105288, "post_id": 33618795, "comment_id": 55012050, "body": "Nice solution. Do you want <code>Node !Int ...</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1447105414, "post_id": 33618795, "comment_id": 55012127, "body": "@ReinHenrichs That&#39;s probably a good idea. Consider it stolen!"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1447105426, "post_id": 33618795, "comment_id": 55012139, "body": "You can&#39;t steal something that is freely given. :)"}, {"owner": {"reputation": 327, "user_id": 3705854, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/5c43b9964018d1f3e2f65c35ab0b0c54?s=128&d=identicon&r=PG&f=1", "display_name": "JKS", "link": "https://stackoverflow.com/users/3705854/jks"}, "edited": false, "score": 0, "creation_date": 1447106896, "post_id": 33618795, "comment_id": 55012905, "body": "Unless I don&#39;t understand something, I don&#39;t see how this is relevant for the answer. It doesn&#39;t really provide a way to extract/morph data from existing structure."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 327, "user_id": 3705854, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/5c43b9964018d1f3e2f65c35ab0b0c54?s=128&d=identicon&r=PG&f=1", "display_name": "JKS", "link": "https://stackoverflow.com/users/3705854/jks"}, "edited": false, "score": 1, "creation_date": 1447109472, "post_id": 33618795, "comment_id": 55014083, "body": "@JKS It is easy to convert from your existing structure to this structure. <code>convert :: Tree -&gt; SizedTree; convert Leaf = leaf; convert (Node l r) = node l r</code>."}, {"owner": {"reputation": 327, "user_id": 3705854, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/5c43b9964018d1f3e2f65c35ab0b0c54?s=128&d=identicon&r=PG&f=1", "display_name": "JKS", "link": "https://stackoverflow.com/users/3705854/jks"}, "edited": false, "score": 0, "creation_date": 1447116984, "post_id": 33618795, "comment_id": 55016673, "body": "Well, the problem is that parallel structures aren&#39;t quite maintainable. If source changes, then all source code needs refactoring. Also, I can&#39;t use functions already written for traversals of old structure. What I&#39;m looking for is just making attachment to existing thing. I&#39;m not sure if this is asking for impossible, but it&#39;s like I need mapping all nodes to new attribute."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1447105334, "last_edit_date": 1447105334, "creation_date": 1447105186, "answer_id": 33618795, "question_id": 33616817, "link": "https://stackoverflow.com/questions/33616817/gather-data-about-existing-tree-like-data/33618795#33618795", "title": "Gather data about existing tree-like data", "body": "<p>The standard trick, which I learned from Chris Okasaki's wonderful <a href=\"https://rads.stackoverflow.com/amzn/click/com/0521663504\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Purely Functional Data Structures</a> is to cache the results of expensive operations at each node. (Perhaps this trick was known before Okasaki's thesis; I don't know.) You can provide smart constructors to manage this information for you so that constructing the tree need not be painful. For example, when the expensive operation is depth, you might write:</p>\n\n<pre><code>module SizedTree (SizedTree, sizedTree, node, leaf, depth) where\n\ndata SizedTree = Node !Int SizedTree SizedTree | Leaf\n\nnode l r = Node (max (depth l) (depth r) + 1) l r\nleaf = Leaf\n\ndepth (Node d _ _) = d\ndepth Leaf = 0\n\n-- since we don't expose the constructors, we should\n-- provide a replacement for pattern matching\nsizedTree f v (Node _ l r) = f l r\nsizedTree f v Leaf = v\n</code></pre>\n\n<p>Constructing <code>SizedTree</code>s costs O(1) extra work at each node (hence it is O(n) work to convert an n-node <code>Tree</code> to a <code>SizedTree</code>), but the payoff is that checking the depth of a <code>SizedTree</code> -- or of any subtree -- is an O(1) operation.</p>\n"}, {"tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 2, "last_activity_date": 1447142374, "last_edit_date": 1495542597, "creation_date": 1447140286, "answer_id": 33624789, "question_id": 33616817, "link": "https://stackoverflow.com/questions/33616817/gather-data-about-existing-tree-like-data/33624789#33624789", "title": "Gather data about existing tree-like data", "body": "<p>You do need some another data where you can store these <code>Int</code>s. Define <code>Tree</code> as</p>\n\n<pre><code>data Tree a = Node Tree a Tree | Leaf a\n</code></pre>\n\n<p>and then write a function</p>\n\n<pre><code>annDepth :: Tree a -&gt; Tree (Int, a)\n</code></pre>\n\n<p>Your original <code>Tree</code> is <code>Tree ()</code> and with pattern synonyms you can recover nice constructors.</p>\n\n<hr>\n\n<p>If you want to preserve the original tree for some reason, you can define a view:</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds #-}\n\ndata Shape = SNode Shape Shape | SLeaf\n\ndata Tree a sh where\n    Leaf :: a -&gt; Tree a SLeaf\n    Node :: Tree a lsh -&gt; a -&gt; Tree a rsh -&gt; Tree a (SNode lsh rsh)\n</code></pre>\n\n<p>With this you have a guarantee that an annotated tree has the same shape as the unannotated. But this doesn't work good without proper dependent types.</p>\n\n<hr>\n\n<p>Also, have a look at the question <a href=\"https://stackoverflow.com/questions/27157717/boilerplate-free-annotation-of-asts-in-haskell\">Boilerplate-free annotation of ASTs in Haskell?</a></p>\n"}, {"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 0, "last_activity_date": 1447275419, "last_edit_date": 1495535235, "creation_date": 1447275419, "answer_id": 33659674, "question_id": 33616817, "link": "https://stackoverflow.com/questions/33616817/gather-data-about-existing-tree-like-data/33659674#33659674", "title": "Gather data about existing tree-like data", "body": "<p>The standard solution is what @DanielWagner suggested, just extend the data structure. This can be somewhat inconvenient, but can be solved: Smart constructors for creating instances and using <a href=\"https://stackoverflow.com/a/9066087/1333025\">records for pattern matching</a>.</p>\n\n<p>Perhaps <a href=\"http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.101.4131&amp;rep=rep1&amp;type=pdf\" rel=\"nofollow noreferrer\">Data types a la carte</a> could help, although I haven't used this approach myself. There is a library <a href=\"https://hackage.haskell.org/package/compdata\" rel=\"nofollow noreferrer\">compdata</a> based on that.</p>\n\n<p>A completely different approach would be to efficiently memoize the values you need. I was trying to solve a <a href=\"https://stackoverflow.com/q/13098448/1333025\">similar problem</a> and one of the solutions is provided by the library <a href=\"https://hackage.haskell.org/package/stable-memo\" rel=\"nofollow noreferrer\">stable-memo</a>. Note that this isn't a purely functional approach, as the library is internally based on object identity, but the interface is pure and works perfectly for the purpose. </p>\n"}], "owner": {"reputation": 327, "user_id": 3705854, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/5c43b9964018d1f3e2f65c35ab0b0c54?s=128&d=identicon&r=PG&f=1", "display_name": "JKS", "link": "https://stackoverflow.com/users/3705854/jks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1447275419, "creation_date": 1447097792, "last_edit_date": 1447098221, "question_id": 33616817, "link": "https://stackoverflow.com/questions/33616817/gather-data-about-existing-tree-like-data", "title": "Gather data about existing tree-like data", "body": "<p>Let's say we have existing tree-like data and we would like to add information about depth of each node. How can we easily achieve that?</p>\n\n<pre><code>Data Tree = Node Tree Tree | Leaf\n</code></pre>\n\n<p>For each node we would like to know in constant complexity how deep it is. We have the data from external module, so we have information as it is shown above. Real-life example would be external HTML parser which just provides the XML tree and we would like to gather data e.g. how many hyperlinks every node contains.</p>\n\n<p>Functional languages are created for traversing trees and gathering data, there should be an easy solution.</p>\n\n<p>Obvious solution would be creating parallel structure. Can we do better?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1638, "user_id": 1542957, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21947a7967845f6b37128794589b8692?s=128&d=identicon&r=PG", "display_name": "southpaw93", "link": "https://stackoverflow.com/users/1542957/southpaw93"}, "edited": false, "score": 0, "creation_date": 1447094707, "post_id": 33615982, "comment_id": 55006281, "body": "I have to respect the given function definition : <code>f :: [Int] -&gt; Int</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1638, "user_id": 1542957, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21947a7967845f6b37128794589b8692?s=128&d=identicon&r=PG", "display_name": "southpaw93", "link": "https://stackoverflow.com/users/1542957/southpaw93"}, "edited": false, "score": 1, "creation_date": 1447094833, "post_id": 33615982, "comment_id": 55006336, "body": "@southpaw93: that&#39;s no problem, you can simply downcast it. This <code>f</code> is more generic."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1447094813, "last_edit_date": 1447094813, "creation_date": 1447094645, "answer_id": 33615982, "question_id": 33615938, "link": "https://stackoverflow.com/questions/33615938/how-do-i-calculate-the-product-of-the-difference-of-consecutive-pairs/33615982#33615982", "title": "How do I calculate the product of the difference of consecutive pairs?", "body": "<p>What about:</p>\n\n<pre><code>import Data.List\n\nf l = product [a-b | (a:b:_) &lt;- tails l ]\n</code></pre>\n\n<p>The function works as follows: <code>tails</code> generates - as the name suggests - all tails of the given list <code>l</code>, so for <code>[3, 1, 4, 2, 5]</code>, that's <code>[[3,1,4,2,5],[1,4,2,5],[4,2,5],[2,5],[5],[]]</code>. Now we do pattern matching with <code>(a:b:_)</code> which means that only lists that contains at least two items will be considered, and furthermore the first two elements unify with <code>a</code> and <code>b</code>. Now we generate a new list with <code>a-b</code>. Thus the list for <code>[3,1,4,2,5]</code> is <code>[2,-3,2,-3]</code>. Now you simply take the product.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The signature of <code>f</code> is <code>Num a =&gt; [a] -&gt; a</code> which is more generic than <code>[Int] -&gt; Int</code>. You can thus simply downcast it by:</p>\n\n<pre><code>import Data.List\n\nf :: [Int] -&gt; Int\nf l = product [a-b | (a:b:_) &lt;- tails l ]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1638, "user_id": 1542957, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21947a7967845f6b37128794589b8692?s=128&d=identicon&r=PG", "display_name": "southpaw93", "link": "https://stackoverflow.com/users/1542957/southpaw93"}, "edited": false, "score": 0, "creation_date": 1447095495, "post_id": 33616047, "comment_id": 55006684, "body": "Yeah, that&#39;s what I&#39;m aiming for, my own recursive solution, I am currently trying to wrap my head around how it could be, I just don&#39;t understand how I can consume two by two elements from the array..."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 5, "last_activity_date": 1447095742, "last_edit_date": 1447095742, "creation_date": 1447094924, "answer_id": 33616047, "question_id": 33615938, "link": "https://stackoverflow.com/questions/33615938/how-do-i-calculate-the-product-of-the-difference-of-consecutive-pairs/33616047#33616047", "title": "How do I calculate the product of the difference of consecutive pairs?", "body": "<p>Create an intermediate structure with pairs </p>\n\n<pre><code>a = [3, 1, 4, 2, 5]\nzip a (tail a)\n</code></pre>\n\n<p>or better use</p>\n\n<pre><code>zipWith (-) a (tail a)\n</code></pre>\n\n<p>which will give you the diffs and continue with the product.</p>\n\n<p>If you need to implement your own recursive solution you need to consume input elements two by two.  Base case should be easy you have to consider the null case and single element case (might be the same!)</p>\n\n<p>Additional hint, write your function for this base case</p>\n\n<pre><code>f (x:y:xs) = (x-y) * f ???\n</code></pre>\n\n<p>and this terminal cases (might be combined if same behavior).</p>\n\n<pre><code>f [] = ???\nf [x] = ???\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52258, "user_id": 375232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h3OwD.png?s=128&g=1", "display_name": "Landei", "link": "https://stackoverflow.com/users/375232/landei"}, "is_accepted": false, "score": 0, "last_activity_date": 1447095912, "creation_date": 1447095912, "answer_id": 33616311, "question_id": 33615938, "link": "https://stackoverflow.com/questions/33615938/how-do-i-calculate-the-product-of-the-difference-of-consecutive-pairs/33616311#33616311", "title": "How do I calculate the product of the difference of consecutive pairs?", "body": "<p>While zipping is often easier for this kind of problem, folding works, too:</p>\n\n<pre><code>f (x:xs) = fst $ foldl (\\(p,n) m -&gt; (p*(n-m),m)) (1,x) xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1638, "user_id": 1542957, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21947a7967845f6b37128794589b8692?s=128&d=identicon&r=PG", "display_name": "southpaw93", "link": "https://stackoverflow.com/users/1542957/southpaw93"}, "edited": false, "score": 0, "creation_date": 1447097174, "post_id": 33616588, "comment_id": 55007644, "body": "amazing, I understand now, brilliantly explained, thank you."}, {"owner": {"reputation": 1638, "user_id": 1542957, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21947a7967845f6b37128794589b8692?s=128&d=identicon&r=PG", "display_name": "southpaw93", "link": "https://stackoverflow.com/users/1542957/southpaw93"}, "edited": false, "score": 0, "creation_date": 1447097363, "post_id": 33616588, "comment_id": 55007753, "body": "one question tho, <code>f _ = 1</code> means that &quot;a list exactly with one number&quot; ?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 1638, "user_id": 1542957, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21947a7967845f6b37128794589b8692?s=128&d=identicon&r=PG", "display_name": "southpaw93", "link": "https://stackoverflow.com/users/1542957/southpaw93"}, "edited": false, "score": 2, "creation_date": 1447097547, "post_id": 33616588, "comment_id": 55007854, "body": "@southpaw93: It&#39;s a wild card. You don&#39;t actually care whether it has one or multiple entries. But since pattern gets matched from top to bottom, there&#39;s only one case left. Edited my answer."}, {"owner": {"reputation": 1638, "user_id": 1542957, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21947a7967845f6b37128794589b8692?s=128&d=identicon&r=PG", "display_name": "southpaw93", "link": "https://stackoverflow.com/users/1542957/southpaw93"}, "edited": false, "score": 0, "creation_date": 1447098612, "post_id": 33616588, "comment_id": 55008500, "body": "and when we call <code>f  (y : xs)</code> we get a tail of the previous array ?"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 2, "last_activity_date": 1447097427, "last_edit_date": 1447097427, "creation_date": 1447096988, "answer_id": 33616588, "question_id": 33615938, "link": "https://stackoverflow.com/questions/33615938/how-do-i-calculate-the-product-of-the-difference-of-consecutive-pairs/33616588#33616588", "title": "How do I calculate the product of the difference of consecutive pairs?", "body": "<p><sub>Note: This post is written in <a href=\"https://wiki.haskell.org/Literate_programming\" rel=\"nofollow\">literate Haskell</a>. You can save it as ListProduct.lhs and try it in your GHCi.</sub></p>\n\n<hr>\n\n<p>In order to fix your function, we have to consider some cases. First of all, what should happen if the list is empty? We return <code>1</code>:</p>\n\n<pre><code>&gt; f :: [Int] -&gt; Int\n&gt; f [] = 1\n</code></pre>\n\n<p>Now, we have to think about lists with more elements. For example the list could have at least one element:</p>\n\n<pre><code>f (x:xs) = ...\n</code></pre>\n\n<p>However, this isn't really helpful. We need <em>two</em> consecutive elements in order to subtract them from each other. However, we can do so by pattern match the remaining list again:</p>\n\n<pre><code>f (x : (y : xs))\n</code></pre>\n\n<p>which is the same as <code>f (x : y : xs)</code> since <code>(:)</code> is right associative. We end up with:</p>\n\n<pre><code>&gt; f (x : y : xs) = (x - y) * f rest\n</code></pre>\n\n<p>What's the rest? It cannot be <code>xs</code>. If we would use <code>xs</code>, we wouldn't get the correct result in the following case:</p>\n\n<pre><code>f [1,2,3,4] = (1 - 2) * f [3,4]\n            = (1 - 2) * (3 - 4) * f []\n            --      ^^^^^^ \n            --      (2 - 3) is missing!\n</code></pre>\n\n<p>So <code>rest</code> needs to have both <code>y</code> <em>and</em> <code>xs</code>:</p>\n\n<pre><code>&gt;      where rest = y : xs\n</code></pre>\n\n<p>We can confirm that this works as intended:</p>\n\n<pre><code>f [1,2,3,4] = (1 - 2) * f [2,3,4]\n            = (1 - 2) * (2 - 3) * f [3,4]\n            = (1 - 2) * (2 - 3) * (3 - 4) * f [4]\n</code></pre>\n\n<p>Therefore, the case where we have at least two elements is handled correctly.</p>\n\n<p>What about lists where we have only one element? Well, with one element, you cannot subtract another. And as you can see above, we will always end up with <code>f [x]</code> for some <code>x</code> at one point. Therefore a sensible choice is <code>f [x] = 1</code>:</p>\n\n<pre><code>f [a] = 1\n</code></pre>\n\n<p>However, since we don't actually about that element, we can use <code>_</code> as a <em>wildcard</em>:</p>\n\n<pre><code>&gt; f _ = 1\n</code></pre>\n\n<p>Note that this is the same result as for <code>f []</code>. So we could have written <code>f</code> as</p>\n\n<pre><code>f :: [Int] -&gt; Int\nf (x : y : xs) = (x - y) * f (y : xs)\nf _            = 1\n</code></pre>\n\n<p>but that's up to you.</p>\n\n<h3>Exercises</h3>\n\n<ul>\n<li>Write a function that returns <code>True</code> for a list with exactly two elements. Don't use <code>length</code>, use pattern matching only.</li>\n<li><p>Write a function that returns <code>True</code> for a list with at least four elements and <code>False</code> otherwise. Use pattern matching only, no other functions.</p></li>\n<li><p>Write a function that returns the sum of triple consecutive products, e.g.</p>\n\n<pre><code>f [1,2,3,4,5] = (1 * 2 * 3) + (2 * 3 * 4) + (3 * 4 * 5)\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 1638, "user_id": 1542957, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/21947a7967845f6b37128794589b8692?s=128&d=identicon&r=PG", "display_name": "southpaw93", "link": "https://stackoverflow.com/users/1542957/southpaw93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 33616588, "answer_count": 4, "score": 1, "last_activity_date": 1447097427, "creation_date": 1447094476, "last_edit_date": 1447096058, "question_id": 33615938, "link": "https://stackoverflow.com/questions/33615938/how-do-i-calculate-the-product-of-the-difference-of-consecutive-pairs", "title": "How do I calculate the product of the difference of consecutive pairs?", "body": "<p>I have to calculate the product between the difference of each consecutive pair from a list with this function definition <code>f :: [Int] -&gt; Int</code>, for example:</p>\n\n<pre><code>f [3, 1, 4, 2, 5] = (3 - 1) * (1 - 4) * (4 - 2) * (2 - 5) \n                  = 36\n</code></pre>\n\n<p>I have to do this recursively, I know how to do the product of the elements in the array, but how do I select tuples from the list and multiply the difference of them with the next tuple's difference, any tips would be appreciated. So far I have this: </p>\n\n<pre><code>f :: [Int] -&gt; Int\nf [] = 1\nf (x:xs) = x * f xs\n</code></pre>\n\n<p>but this only gives me the product of the elements.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447092864, "post_id": 33615027, "comment_id": 55005256, "body": "Your own link points to hackage, which <i>is</i> the most comprehensive repository of Haskell libs. <a href=\"http://hackage.haskell.org/\" rel=\"nofollow noreferrer\">hackage.haskell.org</a> Also try <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">haskell.org/hoogle</a> to search for functions/packages."}], "answers": [{"tags": [], "owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "is_accepted": true, "score": 2, "last_activity_date": 1447094198, "creation_date": 1447094198, "answer_id": 33615860, "question_id": 33615027, "link": "https://stackoverflow.com/questions/33615027/haskell-ghc-complete-hierarchical-libraries-overview/33615860#33615860", "title": "haskell ghc complete hierarchical libraries overview", "body": "<p>The list you link actually contains the documentation for all the packages that are bundled with GHC. Notably GHC does not bundle <code>regex-compat</code> as you suggest.</p>\n\n<p>The GHC Commentary contains a historic view of bundled packages: <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Libraries/VersionHistory\" rel=\"nofollow\">https://ghc.haskell.org/trac/ghc/wiki/Commentary/Libraries/VersionHistory</a></p>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 2, "last_activity_date": 1447094617, "creation_date": 1447094617, "answer_id": 33615974, "question_id": 33615027, "link": "https://stackoverflow.com/questions/33615027/haskell-ghc-complete-hierarchical-libraries-overview/33615974#33615974", "title": "haskell ghc complete hierarchical libraries overview", "body": "<p>The overview page you link to refers to the \"GHC bindist\" which is just the compiler and a set of assorted packages. For instance, the bindist for 7.10.2 is located here:</p>\n\n<p><a href=\"https://www.haskell.org/ghc/download_ghc_7_10_2\" rel=\"nofollow\">https://www.haskell.org/ghc/download_ghc_7_10_2</a></p>\n\n<p>The \"Haskell Platform\" is a bindist + some more packages. On OS X you can find the docs for all of the Haskell Platform modules plus modules you have installed at a location like:</p>\n\n<p>~/Library/Haskell/share/doc/x86_64-osx-ghc-7.10.2/index.html</p>\n\n<p>If a module is not listed it just means that it hasn't been installed.</p>\n"}], "owner": {"reputation": 1795, "user_id": 1839343, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b26d97dd045ce61904e7c6d1a9775e0c?s=128&d=identicon&r=PG", "display_name": "jules", "link": "https://stackoverflow.com/users/1839343/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "closed_date": 1448910426, "accepted_answer_id": 33615860, "answer_count": 2, "score": 1, "last_activity_date": 1447094617, "creation_date": 1447091203, "question_id": 33615027, "link": "https://stackoverflow.com/questions/33615027/haskell-ghc-complete-hierarchical-libraries-overview", "closed_reason": "Not suitable for this site", "title": "haskell ghc complete hierarchical libraries overview", "body": "<p>Is there a complete overview of the libraries that come bundled with GHC?<br>\n<a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/\" rel=\"nofollow\">This overview</a> is incomplete. For example the <a href=\"https://hackage.haskell.org/package/regex-compat-0.95.1/docs/Text-Regex.html\" rel=\"nofollow\">Text.Regex</a> module is not listed.</p>\n\n<p>If a module is not listed here does that mean that it's deprecated?\nIf not is there a reason why some modules are listed and others are not?</p>\n\n<p>Many thanks in advance!</p>\n"}, {"tags": ["string", "haskell"], "comments": [{"owner": {"reputation": 2841, "user_id": 1974671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Un4Se.jpg?s=128&g=1", "display_name": "d0nut", "link": "https://stackoverflow.com/users/1974671/d0nut"}, "edited": false, "score": 0, "creation_date": 1447096872, "post_id": 33614730, "comment_id": 55007465, "body": "try to relax a little. I was only making a lighthearted comment."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1447108193, "post_id": 33614730, "comment_id": 55013521, "body": "In case anyone else is wondering, the <code>$$</code> in the interpreter demo aren&#39;t syntax errors but <a href=\"https://www.haskell.org/hugs/pages/hugsman/started.html\" rel=\"nofollow noreferrer\">a Hugs trick to recover the last result</a>."}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 3, "last_activity_date": 1447094430, "creation_date": 1447094430, "answer_id": 33615928, "question_id": 33614730, "link": "https://stackoverflow.com/questions/33614730/how-to-wrap-characters-around-a-string/33615928#33615928", "title": "How to wrap characters around a string?", "body": "<p>I suggest you solve a simpler more generic problem and think how you can use it in your case</p>\n\n<pre><code>wrap :: a -&gt; [a] -&gt; [a]\nwrap x xs = x:xs++[x]\n</code></pre>\n\n<p>now you can apply this to your problem first for each row where xs is a row and x = <code>*</code>.  Second you can think your xs is the rows and x = \"*****\" (use correct length).  If you know and allowed to use <code>map</code> you use the wrap for each row, and second wrap once to the result.  It will be a one liner.</p>\n"}], "owner": {"reputation": 11, "user_id": 5507741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29195172a564e334f14072ed955ef0cc?s=128&d=identicon&r=PG&f=1", "display_name": "iAmNotAComputerScientistYet", "link": "https://stackoverflow.com/users/5507741/iamnotacomputerscientistyet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1447108068, "creation_date": 1447090216, "last_edit_date": 1447108068, "question_id": 33614730, "link": "https://stackoverflow.com/questions/33614730/how-to-wrap-characters-around-a-string", "title": "How to wrap characters around a string?", "body": "<p>We have been given an exercise where we have to 'frame' a string with a character input by the user. For instance:</p>\n\n<pre><code>*******\n* AAA *\n*A   A*\n*AAAAA*\n*A   A*\n*A   A*\n*******\n</code></pre>\n\n<p>I have previously defined strings to represent letters from a charecter into string, and also a function to manipulate the size of it, simply put as 'stretch'. I have tried to firstly surround these strings with asterisk and to try get the output, as the example above shows, but I keep receiving type errors. I am currently able to do it line by line (shown below) in terminal as I will show before but have had no luck implementing it into a function (also below)... any suggestions?</p>\n\n<p>Line by line code at the interpreter:</p>\n\n<pre><code>EX01&gt; map(\\x-&gt; \"*\" ++ x ++ \"*\")(letter 'a')\n[\"* AAA *\",\"*A   A*\",\"*AAAAA*\",\"*A   A*\",\"*A   A*\"]\nEX01&gt; top_and_bottom $$\n[\"*******\",\"* AAA *\",\"*A   A*\",\"*AAAAA*\",\"*A   A*\",\"*A   \nA*\",\"*******\"]\nEX01&gt; map(\\x-&gt; x ++ \"\\n\") $$\n[\"*******\\n\",\"* AAA *\\n\",\"*A   A*\\n\",\"*AAAAA*\\n\",\"*A   A*\\n\",\"*A   &gt;A*\\n\",\"*******\\n\"]\nEX01&gt; concat $$\n\"*******\\n* AAA *\\n*A   A*\\n*AAAAA*\\n*A   A*\\n*A   A*\\n*******\\n\"\nEX01&gt; putStr$$\n*******\n* AAA *\n*A   A*\n*AAAAA*\n*A   A*\n*A   A*\n*******\n</code></pre>\n\n<p>My attempt at implementing it into a function:</p>\n\n<pre><code>stars :: Int -&gt; String\nstars 0 = \"\"               \nstars n = '*':(stars (n-1))\n\ntop_and_bottom :: [String] -&gt; [String]\ntop_and_bottom x =  (fringe : x) ++ [fringe]\n  where\n  fringe = (stars (length (head x)))\n\nframestar :: [String] -&gt; [String]\nframestar x = putStr(concat(top_and_bottom(map(\\x -&gt; \"*\" ++ x ++ \"*\")[x])))\n</code></pre>\n\n<p>(P.S.: How could I also do this so it could take any character?)</p>\n"}, {"tags": ["unit-testing", "haskell", "reactive-banana"], "answers": [{"tags": [], "owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "is_accepted": true, "score": 1, "last_activity_date": 1447889457, "last_edit_date": 1495542196, "creation_date": 1447889457, "answer_id": 33792548, "question_id": 33613120, "link": "https://stackoverflow.com/questions/33613120/reactive-banana-1-0-0-unit-testing-in-the-momentio-monad/33792548#33792548", "title": "Reactive Banana 1.0.0 - Unit testing in the MomentIO() Monad", "body": "<p>Source of answer came from this previous answer.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/27216295/testing-in-reactive-banana\">Testing in reactive-banana</a></p>\n\n<p><code>interpretFramwork</code> needs a new signature.</p>\n\n<pre><code>interpretFrameWorks'' :: (Event a -&gt; MomentIO (Behavior b)) -&gt; [a] -&gt;  IO (b,[[b]])\ninterpretFrameWorks'' f xs = do\n  output                      &lt;- newIORef []\n  init                        &lt;- newIORef undefined\n  (addHandler, runHandlers)   &lt;- newAddHandler\n  network                     &lt;- compile $ do\n    e &lt;- fromAddHandler addHandler\n    f' &lt;- f e\n    o &lt;- changes $ f'\n    i &lt;- valueB $ f'\n    liftIO $ writeIORef init i\n    reactimate' $ (fmap . fmap) (\\b -&gt; modifyIORef output (++[b])) o\n\n  actuate network\n  bs &lt;- forM xs $ \\x -&gt; do\n      runHandlers x\n      bs &lt;- readIORef output\n      writeIORef output []\n      return bs\n  i &lt;- readIORef init\n  return (i, bs)\n</code></pre>\n"}], "owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 4, "accepted_answer_id": 33792548, "answer_count": 1, "score": 8, "last_activity_date": 1447889457, "creation_date": 1447084787, "last_edit_date": 1447433249, "question_id": 33613120, "link": "https://stackoverflow.com/questions/33613120/reactive-banana-1-0-0-unit-testing-in-the-momentio-monad", "title": "Reactive Banana 1.0.0 - Unit testing in the MomentIO() Monad", "body": "<p>Here's an event network sample that I've been using to investigate the behavior of particular monadic actions. I'm wanting a principled approach, rather than this ad-hoc way of testing my code. I know how to test my functions, but I'm looking for best practices for testing Behaviors and Events, given the new design choices in <code>reactive-banana 1.0.0</code></p>\n\n<p>I'm leaving out a lot, in the hopes I've included only what is necessary to illustrate my problem. Please let me know if there's something missing that should be included to make the problem clearer.</p>\n\n<pre><code>makeNetworkDescription ::  Parameters -&gt; MomentIO ()\nmakeNetworkDescription params = mdo\n  eInput &lt;- fromAddHandler (input params)\n  eTick &lt;- fromAddHandler (tick params)\n  let   \n   eValidated :: Event VAC\n   eValidated = toVAC &lt;$&gt; eInput\n\n   eClearBuffer = Clear &lt;$ eBuffer\n\n   eBuffer ::Event BufferMap\n   eBuffer = bBuffer &lt;@ eTick\n\n  bBuffer &lt;- accumB (BufferMap (M.empty :: M.Map AID VAC))  $\n             manageBuffer &lt;$&gt; unionWith (clearBuffer) eValidated eClearBuffer    \n reactimate $ writeOut_Debug &lt;$&gt; eBuffer\n</code></pre>\n\n<p>What the buffer is supposed to do, is accumulated player commands (which would then be processed elsewhere), and then be emptied once a particular batch of player commands were processed. Upon the next tick, it happens all over again.</p>\n\n<p>I'm looking to make sure the buffer gets cleared when it supposed to be, and accumulates commands like it is supposed to. Right now, the code works, and I want to write tests to assure it keeps working as I build this game out.</p>\n\n<p>I could make the buffer <code>Behavior</code> separated from the <code>Event</code> network in the above example, but what then? What's the best way to get accurate results from the test? </p>\n\n<p>Edit: Update - I believe <a href=\"https://github.com/HeinrichApfelmus/reactive-banana/blob/master/reactive-banana/src/Reactive/Banana/Test.hs\" rel=\"nofollow\">this link</a> will provide sufficient hints. I'll take a stab at it and report with more details tomorrow.</p>\n\n<p>Edit: Update - I have a unit test written. I will upload to github when it's purty, and then post. The above link was very helpful in sorting out what to do. </p>\n\n<p>Edit: Update - Turns out, if you run stack test and there are type errors, and then you run it again you get output that says your tests have passed. The upshot is, I'm no closer that I was yesterday. I have code and a clearer problem. I may start a different post for that.ct</p>\n\n<p>Edit: Update - I have a test that breaks in a way that is helpful, but I don't what to do about it exactly. I've posted the entire <a href=\"https://github.com/mlitchard/emporos/tree/banana-1.0.0\" rel=\"nofollow\">project</a> for context. Below I include just the test code, errors and some discussion.</p>\n\n<pre><code>main :: IO ()\nmain = defaultMain\n  [ testGroup \"EventNetwork Input\"\n    [testBuffer \"bBuffer\" Populated]\n  ]\n\ntestBuffer :: String -&gt; BufferState -&gt; Test\ntestBuffer name Populated =\ntestCase name $ assert $ bufferPopulated (UAC (PlayerCommand (Move   (ToPlanetName Mongo)) (AID (Data.Text.pack \"100\"))))\ntestBuffer name Empty =\ntestCase name $ assert $ bufferEmptied (UAC (PlayerCommand (Move    (ToPlanetName Mongo)) (AID (Data.Text.pack \"100\"))))\n\nbufferPopulated :: UAC -&gt; MomentIO Bool\nbufferPopulated ev = do\n  let eInput = ev &lt;$ never\n      eValidated = toVAC &lt;$&gt; eInput\n  bBufferMap &lt;- (buffer eValidated eClear) :: MomentIO (Behavior BufferMap)\n  let r2 = [(Just $ BufferMap $ M.insert (AID (Data.Text.pack \"100\")) (toVAC ev) (M.empty :: M.Map AID VAC))]\nr1 &lt;- liftIO $ ((interpret (eBuffer bBufferMap) []) :: IO [Maybe BufferMap])\nreturn $ r1 == r2\n\nbufferEmptied :: UAC -&gt; MomentIO Bool\nbufferEmptied ev = undefined\n\neBuffer :: Behavior BufferMap -&gt; Event a -&gt; Event BufferMap\neBuffer bBufferMap nvr =\n  bBufferMap &lt;@ (() &lt;$ nvr)\n\neClear = Clear &lt;$ (() &lt;$ never)\n\n\ntests/Spec.hs:26:19:\n    No instance for (Test.HUnit.Base.Assertable (MomentIO Bool))\n      arising from a use of \u2018assert\u2019\nIn the expression: assert\nIn the second argument of \u2018($)\u2019, namely\n  \u2018assert\n   $ bufferPopulated\n       (UAC\n          (PlayerCommand (Move (ToPlanetName Mongo)) (AID (pack \"100\"))))\u2019\nIn the expression:\n  testCase name\n  $ assert\n    $ bufferPopulated\n        (UAC\n           (PlayerCommand (Move (ToPlanetName Mongo)) (AID (pack \"100\"))))\n</code></pre>\n\n<p>The problem comes down to <code>accumB</code> creating a <code>Behavior</code> in a <code>MomemtIO</code>. If I have <code>bufferPopulated</code> return an <code>IO Bool</code> how can I reconcile that?</p>\n\n<p>Edit: The obvious thing is to write the instance it wants. I think this is probably a red-herring. What do you think. Is this as simple as just writing the <code>MomentIO Bool</code> instance?</p>\n\n<p>Edit: Update\nI think I'm on the right track. I have commented out all test harness code and have changed the signature for <code>bufferPopulated</code></p>\n\n<pre><code>bufferPopulated :: UAC -&gt; IO Bool\nbufferPopulated ev = do\n  let eInput = ev &lt;$ never\n      eValidated = toVAC &lt;$&gt; eInput\n  bBufferMap &lt;- liftMoment ((buffer eValidated eClear) :: Moment    (Behavior BufferMap)) \n  let r2 = [(Just $ BufferMap $ M.insert (AID (Data.Text.pack \"100\")) (toVAC ev) (M.empty :: M.Map AID VAC))]\n  r1 &lt;- (interpret (eBuffer bBufferMap) []) :: IO [Maybe BufferMap])          \n  return $ r1 == r2\n</code></pre>\n\n<p>I believe this should work, but here's the error</p>\n\n<pre><code>tests/Spec.hs:35:17:\n    No instance for (MonadMoment IO) arising from a use of \u2018liftMoment\u2019\n    In a stmt of a 'do' block:\n      bBufferMap &lt;- liftMoment\n                      ((buffer eValidated eClear) :: Moment (Behavior   BufferMap))\n</code></pre>\n\n<p>Let's take a look at <code>MonadMoment</code> from <code>Reactive.Banana.Combinators</code></p>\n\n<pre><code>class Monad m =&gt; MonadMoment m where\n\nAn instance of the MonadMoment class denotes a computation that happens at one particular moment in time.\n\nUnlike the Moment monad, it need not be pure anymore.\n\nMethods\n\nliftMoment :: Moment a -&gt; m a\n\nInstances\nMonadMoment MomentIO\nMonadMoment Moment  \n</code></pre>\n\n<p><code>m</code> can be any <code>Monad</code>, <code>IO</code> is a <code>Monad</code>. so <code>liftMoment</code> should lift the <code>Moment Behavior (BufferMap)</code> to <code>IO Behavior (BufferMap)</code> , why doesn't it. What's wrong with my reasoning?</p>\n"}, {"tags": ["haskell", "concurrency", "ghcjs"], "comments": [{"owner": {"reputation": 866, "user_id": 2872507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49ebde219395d677c399d8e950f5a48c?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Vieth", "link": "https://stackoverflow.com/users/2872507/alexander-vieth"}, "edited": false, "score": 2, "creation_date": 1447086215, "post_id": 33611149, "comment_id": 55001346, "body": "If you only target the browser then I think it&#39;s just a matter of taste. A solution using <code>threadDelay</code> <i>will</i> work when compiled with GHCJS."}], "answers": [{"tags": [], "owner": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "is_accepted": false, "score": 8, "last_activity_date": 1447090225, "last_edit_date": 1495542728, "creation_date": 1447089740, "answer_id": 33614603, "question_id": 33611149, "link": "https://stackoverflow.com/questions/33611149/how-to-execute-an-action-periodically-in-a-ghcjs-program/33614603#33614603", "title": "How to execute an action periodically in a GHCJS program?", "body": "<p>Using <code>setInterval</code> posed <a href=\"https://stackoverflow.com/questions/33576618/how-to-convert-an-io-to-jsval-in-ghcjs\">some challenges</a> and comments from Alexander, Erik and Luite himself led me to try threads. This worked seamlessly, with very clean code similar to the following:</p>\n\n<pre><code>import Control.Concurrent( forkIO, threadDelay )\nimport Control.Monad( forever )\n\n... within an IO block\nthreadId &lt;- forkIO $ forever $ do\n  threadDelay (60 * 1000 * 1000) -- one minute in microseconds, not milliseconds like in Javascript!\n  doWhateverYouLikeHere\n</code></pre>\n\n<p>Haskell has the concept of lightweight threads so this is the idiomatic Haskell way to run an action in an asynchronous way as you would do with a Javascript <code>setInterval</code> or <code>setTimeout</code>.</p>\n\n<ul>\n<li><a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Concurrent.html\" rel=\"nofollow noreferrer\">Hackage</a></li>\n<li><a href=\"http://book.realworldhaskell.org/read/concurrent-and-multicore-programming.html\" rel=\"nofollow noreferrer\">Real world Haskell</a></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "edited": false, "score": 0, "creation_date": 1532092492, "post_id": 47172257, "comment_id": 89856617, "body": "aheam given the amount of research and experiments you put in, i marked your answer as the best solution ... but to be honest i don&#39;t have the time going through all the motivations and the whole thread. I reckon that just setting a thread delay is not precise ... there has to be a simpler way to launch a thread at a given interval, even thought this might cause more of such threads to be running at the same time. Otherwise i think that i prefer the solution where the execution of the next thread is delayed a bit"}, {"owner": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "edited": false, "score": 0, "creation_date": 1532092606, "post_id": 47172257, "comment_id": 89856703, "body": "also, it would be way more readable if you proposed your solution at the beginning of your text, adding the motivations &amp; research after for who&#39;s interested ... but as far as i see your final solution involves a lot of complexity, many readers will still be more likely to prefer the one that drifts in time"}, {"owner": {"reputation": 9504, "user_id": 470844, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8354544a22bb5a0ac8005ca008f94ad1?s=128&d=identicon&r=PG", "display_name": "ntc2", "link": "https://stackoverflow.com/users/470844/ntc2"}, "reply_to_user": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "edited": false, "score": 3, "creation_date": 1532105748, "post_id": 47172257, "comment_id": 89864657, "body": "@danza regarding the final solution being complex, did you look at the <code>runPeriodicallySmallDrift</code> version? That version is very simple, but also keeps the drift relatively small."}, {"owner": {"reputation": 9504, "user_id": 470844, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8354544a22bb5a0ac8005ca008f94ad1?s=128&d=identicon&r=PG", "display_name": "ntc2", "link": "https://stackoverflow.com/users/470844/ntc2"}, "reply_to_user": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "edited": false, "score": 3, "creation_date": 1532107473, "post_id": 47172257, "comment_id": 89865529, "body": "@danza I put the note about jumping to the final solution if you don&#39;t care about the motivations first, and added more comments and prose to the final solution. See if it makes sense now."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "edited": false, "score": 2, "creation_date": 1532200335, "post_id": 47172257, "comment_id": 89887961, "body": "@danza, I am confident that it took much longer to research and construct this answer than it would take for you to read it carefully. The comments you make above are the sort that will make people think twice about taking the time to answer your questions."}, {"owner": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1533458705, "post_id": 47172257, "comment_id": 90347015, "body": "@dfeuer i accept your criticism. not everyone has equal time availability in different moments. i am not interested in this answer at the moment. i am discussing with ntc2 in order to give more visibility to their research, which is here not only for me but for anyone interested in performing this rather common action using this technology. this is also the reason why i wrote the question, by the way, not just for myself"}, {"owner": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "edited": false, "score": 0, "creation_date": 1533459064, "post_id": 47172257, "comment_id": 90347089, "body": "@ntc2 i believe that the second strawman solution you propose will fit most use cases, and many programmers will easily adapt the code in order to support concurrent executions cleanly. that is what i had in mind, it&#39;s very essential and simple. all at all an excellent answer, thanks!"}, {"owner": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "edited": false, "score": 0, "creation_date": 1533459271, "post_id": 47172257, "comment_id": 90347128, "body": "i&#39;m considering whether to edit the question in order to generalise it to haskell ... but in that case probably we could move your answer to some official haskell documentation page? on a side note, i would present the second solution as &quot;concurrent actions&quot; or &quot;overlapping executions&quot;, it can be fine for some uses"}], "tags": [], "owner": {"reputation": 9504, "user_id": 470844, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8354544a22bb5a0ac8005ca008f94ad1?s=128&d=identicon&r=PG", "display_name": "ntc2", "link": "https://stackoverflow.com/users/470844/ntc2"}, "is_accepted": true, "score": 4, "last_activity_date": 1532107370, "last_edit_date": 1532107370, "creation_date": 1510119342, "answer_id": 47172257, "question_id": 33611149, "link": "https://stackoverflow.com/questions/33611149/how-to-execute-an-action-periodically-in-a-ghcjs-program/47172257#47172257", "title": "How to execute an action periodically in a GHCJS program?", "body": "<p><strong>If you don't care about the motivation, just scroll to my best solution <code>runPeriodicallyConstantDrift</code> below.</strong> If you prefer a simpler solution with worse results, then see <code>runPeriodicallySmallDrift</code>.</p>\n\n<p>My answer is not GHCJS specific, and has not been tested on GHCJS, only GHC, but it illustrates problems with <a href=\"https://stackoverflow.com/a/33614603/470844\">the OP's naive solution</a>.</p>\n\n<h3>First Strawman Solution: <code>runPeriodicallyBigDrift</code></h3>\n\n<p>Here's my version of the OP's solution, for comparison below:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import           Control.Concurrent ( threadDelay )\nimport           Control.Monad ( forever )\n\n-- | Run @action@ every @period@ seconds.\nrunPeriodicallyBigDrift :: Double -&gt; IO () -&gt; IO ()\nrunPeriodicallyBigDrift period action = forever $ do\n  action\n  threadDelay (round $ period * 10 ** 6)\n</code></pre>\n\n<p>Assuming \"execute an action periodically\" means the action <em>starts</em> every period many seconds, <strong>the OP's solution is problematic because the <code>threadDelay</code> doesn't take into account the time the action itself takes. After n iterations, the start time of the action will have drifted by at least the time it takes to run the action n times!</strong></p>\n\n<h3>Second Strawman Solution: <code>runPeriodicallySmallDrift</code></h3>\n\n<p>So, we if we actually want to start a new action every period, we need to take into account the time it takes the action to run. If the period is relatively large compared to the time it takes to spawn a thread, then this simple solution may work for you:</p>\n\n<pre><code>import           Control.Concurrent ( threadDelay )\nimport           Control.Concurrent.Async ( async, link )\nimport           Control.Monad ( forever )\n\n-- | Run @action@ every @period@ seconds.\nrunPeriodicallySmallDrift :: Double -&gt; IO () -&gt; IO ()\nrunPeriodicallySmallDrift period action = forever $ do\n  -- We reraise any errors raised by the action, but\n  -- we don't check that the action actually finished within one\n  -- period. If the action takes longer than one period, then\n  -- multiple actions will run concurrently.\n  link =&lt;&lt; async action\n  threadDelay (round $ period * 10 ** 6)\n</code></pre>\n\n<p>In my experiments (more details below), it takes about 0.001 seconds to spawn a thread on my system, so the drift for <code>runPeriodicallySmallDrift</code> after n iterations is about n thousandths of a second, which may be negligible in some use cases.</p>\n\n<h3>Final Solution: <code>runPeriodicallyConstantDrift</code></h3>\n\n<p>Finally, suppose we require only constant drift, meaning the drift is always less than some constant, and does not grow with the number of iterations of the periodic action. We can achieve constant drift by keeping track of the total time since we started, and starting the <code>n</code>th iteration when the total time is <code>n</code> times the period:</p>\n\n<pre><code>import           Control.Concurrent ( threadDelay )\nimport           Data.Time.Clock.POSIX ( getPOSIXTime )\nimport           Text.Printf ( printf )\n\n-- | Run @action@ every @period@ seconds.\nrunPeriodicallyConstantDrift :: Double -&gt; IO () -&gt; IO ()\nrunPeriodicallyConstantDrift period action = do\n  start &lt;- getPOSIXTime\n  go start 1\n  where\n    go start iteration = do\n      action\n      now &lt;- getPOSIXTime\n      -- Current time.\n      let elapsed = realToFrac $ now - start\n      -- Time at which to run action again.\n      let target = iteration * period\n      -- How long until target time.\n      let delay = target - elapsed\n      -- Fail loudly if the action takes longer than one period.  For\n      -- some use cases it may be OK for the action to take longer\n      -- than one period, in which case remove this check.\n      when (delay &lt; 0 ) $ do\n        let msg = printf \"runPeriodically: action took longer than one period: delay = %f, target = %f, elapsed = %f\"\n                  delay target elapsed\n        error msg\n      threadDelay (round $ delay * microsecondsInSecond)\n      go start (iteration + 1)\n    microsecondsInSecond = 10 ** 6\n</code></pre>\n\n<p>Based on experiments below, the drift is always about 1/1000th of a second, independent of the number of iterations of the action.</p>\n\n<h3>Comparison Of Solutions By Testing</h3>\n\n<p>To compare these solutions, we create an action that keeps track of its own drift and tells us, and run it in each of the <code>runPeriodically*</code> implementations above:</p>\n\n<pre><code>import           Control.Concurrent ( threadDelay )\nimport           Data.IORef ( newIORef, readIORef, writeIORef )\nimport           Data.Time.Clock.POSIX ( getPOSIXTime )\nimport           Text.Printf ( printf )\n\n-- | Use a @runPeriodically@ implementation to run an action\n-- periodically with period @period@. The action takes\n-- (approximately) @runtime@ seconds to run.\ntestRunPeriodically :: (Double -&gt; IO () -&gt; IO ()) -&gt; Double -&gt; Double -&gt; IO ()\ntestRunPeriodically runPeriodically runtime period = do\n  iterationRef &lt;- newIORef 0\n  start &lt;- getPOSIXTime\n  startRef &lt;- newIORef start\n  runPeriodically period $ action startRef iterationRef\n  where\n    action startRef iterationRef = do\n      now &lt;- getPOSIXTime\n      start &lt;- readIORef startRef\n      iteration &lt;- readIORef iterationRef\n      writeIORef iterationRef (iteration + 1)\n      let drift = (iteration * period) - (realToFrac $ now - start)\n      printf \"test: iteration = %.0f, drift = %f\\n\" iteration drift\n      threadDelay (round $ runtime * 10**6)\n</code></pre>\n\n<p>Here are the test results. In each case test an action that runs for 0.05 seconds, and use a period of twice that, i.e. 0.1 seconds.</p>\n\n<p>For <code>runPeriodicallyBigDrift</code>, the drift after n iterations is about n times the runtime of a single iteration, as expected. After 100 iterations the drift is -5.15, and the predicted drift just from runtime of the action is -5.00:</p>\n\n<pre><code>ghci&gt; testRunPeriodically runPeriodicallyBigDrift 0.05 0.1\n...\ntest: iteration = 98, drift = -5.045410253\ntest: iteration = 99, drift = -5.096661091\ntest: iteration = 100, drift = -5.148137684\ntest: iteration = 101, drift = -5.199764033999999\ntest: iteration = 102, drift = -5.250980596\n...\n</code></pre>\n\n<p>For <code>runPeriodicallySmallDrift</code>, the drift after n iterations is about 0.001 seconds, presumably the time it takes to spawn a thread on my system:</p>\n\n<pre><code>ghci&gt; testRunPeriodically runPeriodicallySmallDrift 0.05 0.1\n...\ntest: iteration = 98, drift = -0.08820333399999924\ntest: iteration = 99, drift = -0.08908210599999933\ntest: iteration = 100, drift = -0.09006684400000076\ntest: iteration = 101, drift = -0.09110764399999915\ntest: iteration = 102, drift = -0.09227584299999947\n...\n</code></pre>\n\n<p>For <code>runPeriodicallyConstantDrift</code>, the drift remains constant (plus noise) at about 0.001 seconds:</p>\n\n<pre><code>ghci&gt; testRunPeriodically runPeriodicallyConstantDrift 0.05 0.1\n...\ntest: iteration = 98, drift = -0.0009586619999986112\ntest: iteration = 99, drift = -0.0011010979999994674\ntest: iteration = 100, drift = -0.0011610369999992542\ntest: iteration = 101, drift = -0.0004908619999977049\ntest: iteration = 102, drift = -0.0009897379999994627\n...\n</code></pre>\n\n<p>If we cared about that level of constant drift, then a more sophisticiated solution could track the average constant drift and adjust for it.</p>\n\n<h3>Generalization To Stateful Periodic Loops</h3>\n\n<p>In practice I realized that some of my loops have state that passes from one iteration to the next. Here's a slight generalization of <code>runPeriodicallyConstantDrift</code> to support that:</p>\n\n<pre><code>import           Control.Concurrent ( threadDelay )\nimport           Data.IORef ( newIORef, readIORef, writeIORef )\nimport           Data.Time.Clock.POSIX ( getPOSIXTime )\nimport           Text.Printf ( printf )\n\n-- | Run a stateful @action@ every @period@ seconds.\n--\n-- Achieves uniformly bounded drift (i.e. independent of the number of\n-- iterations of the action) of about 0.001 seconds,\nrunPeriodicallyWithState :: Double -&gt; st -&gt; (st -&gt; IO st) -&gt; IO ()\nrunPeriodicallyWithState period st0 action = do\n  start &lt;- getPOSIXTime\n  go start 1 st0\n  where\n    go start iteration st = do\n      st' &lt;- action st\n      now &lt;- getPOSIXTime\n      let elapsed = realToFrac $ now - start\n      let target = iteration * period\n      let delay = target - elapsed\n      -- Warn if the action takes longer than one period. Originally I\n      -- was failing in this case, but in my use case we sometimes,\n      -- but very infrequently, take longer than the period, and I\n      -- don't actually want to crash in that case.\n      when (delay &lt; 0 ) $ do\n        printf \"WARNING: runPeriodically: action took longer than one period: delay = %f, target = %f, elapsed = %f\"\n          delay target elapsed\n      threadDelay (round $ delay * microsecondsInSecond)\n      go start (iteration + 1) st'\n    microsecondsInSecond = 10 ** 6\n\n-- | Run a stateless @action@ every @period@ seconds.\n--\n-- Achieves uniformly bounded drift (i.e. independent of the number of\n-- iterations of the action) of about 0.001 seconds,\nrunPeriodically :: Double -&gt; IO () -&gt; IO ()\nrunPeriodically period action =\n  runPeriodicallyWithState period () (const action)\n</code></pre>\n"}], "owner": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 606, "favorite_count": 0, "accepted_answer_id": 47172257, "answer_count": 2, "score": 6, "last_activity_date": 1532107370, "creation_date": 1447078705, "question_id": 33611149, "link": "https://stackoverflow.com/questions/33611149/how-to-execute-an-action-periodically-in-a-ghcjs-program", "title": "How to execute an action periodically in a GHCJS program?", "body": "<p>Should one use <code>setInterval</code> via Javascript, or use some more idiomatic solution based on threads?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 6, "creation_date": 1447066642, "post_id": 33607508, "comment_id": 54989735, "body": "You shouldn&#39;t write separate type signatures for the function arguments. All you need is <code>carPark :: Int -&gt; Int -&gt; String</code>, which is the type signature for <code>carPark</code>."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1447067904, "post_id": 33607508, "comment_id": 54990455, "body": "watch out - you need the &quot;toString&quot; method <code>show</code> to convert <code>Int</code> to <code>String</code> and the concatenation operator <code>++</code> to combine these strings"}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 10, "last_activity_date": 1447077856, "last_edit_date": 1447077856, "creation_date": 1447073239, "answer_id": 33609450, "question_id": 33607508, "link": "https://stackoverflow.com/questions/33607508/the-type-signature-lacks-an-accompanying-binding/33609450#33609450", "title": "The type signature [\u2026] lacks an accompanying binding", "body": "<h1>What are missing bindings?</h1>\n\n<p>There are many problems with your program, but lets focus on the \"binding\" one first. You're probably accustomed to Pascal or C, where you have to specify the type of the argument at the argument:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>string carpark(int wheels, int cars);\n</code></pre>\n\n<p>However, Haskell doesn't work like this. If you write </p>\n\n<pre><code>wheels :: Int\n</code></pre>\n\n<p>in your document, you're telling the compiler that the value <code>wheels</code> will have the type <code>Int</code>. The compiler now expects a definition somewhere. This definition\u2014it's binding\u2014is missing. The <strong>type</strong> of <code>wheels</code> is known, but it's not known what <strong>value</strong> <code>wheels</code> should be <strong>bound</strong> to.</p>\n\n<p>If you were to add</p>\n\n<pre><code>wheels = 1 * 2 + 12312\n</code></pre>\n\n<p>the compiler wouldn't complain about that particular binding anymore.</p>\n\n<h1>What's the actual problem?</h1>\n\n<p>As I've conclused above, you want to specify the arguments' types of <code>carpark</code>, right? However, this concludes that you specify <strong><code>carpark</code>'s</strong> type:</p>\n\n<pre><code>carpark :: Int -&gt; Int -&gt; String\ncarpark wheels cars \n   | -- omitted\n</code></pre>\n\n<p>This will get rid of the \"missing bindings\" errors.</p>\n\n<h1>What's missing?</h1>\n\n<p>Well, after this, you will still have a non-compiling piece of software, for example <code>error wheels \"is not even\"</code> isn't valid. Have a look at <code>error</code>'s type:</p>\n\n<pre><code>error :: String -&gt; a\n</code></pre>\n\n<p>Since <code>wheels</code> isn't a <code>String</code>, this won't compile. Instead, you have to <code>show</code> <code>wheels</code>:</p>\n\n<pre><code>error (show wheels ++ \" is not even\")\n</code></pre>\n\n<p>Note that <code>error (show wheels) \" is not even\"</code> will happily compile, but won't give you the error message you're actually looking for, so beware of parenthesis and string concatenation.</p>\n\n<h1>Exercises</h1>\n\n<ul>\n<li><p>Write a function <code>whatNumber</code> that returns \"Is Odd\" if the number is odd and \"Is Even\" if the number is even, e.g.</p>\n\n<pre><code>whatNumber 2 == \"Is Even\"\n</code></pre></li>\n<li><p>Write a function <code>whatNumberId</code>, that returns <code>\"&lt;x&gt; is odd\"</code> if the number is odd and <code>\"&lt;x&gt; is even\"</code> if the number is even, where <code>&lt;x&gt;</code> should be the number, e.g.</p>\n\n<pre><code>whatNumberId 123 == \"123 is odd\"\n</code></pre></li>\n</ul>\n\n<p>Both exercises should help you to accomplish your original task.</p>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447094311, "post_id": 33614263, "comment_id": 55006079, "body": "I&#39;m pretty sure that I&#39;ve seen a language where you would write the arguments and their types first, and then the actual function. But I can&#39;t recall its name."}], "tags": [], "owner": {"reputation": 2134, "user_id": 2623659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1bd33f70a971bf89c7719005d477e2b?s=128&d=identicon&r=PG", "display_name": "ach", "link": "https://stackoverflow.com/users/2623659/ach"}, "is_accepted": false, "score": 1, "last_activity_date": 1447088502, "creation_date": 1447088502, "answer_id": 33614263, "question_id": 33607508, "link": "https://stackoverflow.com/questions/33607508/the-type-signature-lacks-an-accompanying-binding/33614263#33614263", "title": "The type signature [\u2026] lacks an accompanying binding", "body": "<p>Zeta's answer is complete, but I would like to make just another point, which unfortunately doesn't fit in a comment.</p>\n\n<pre><code>wheels :: Int\ncars :: Int\ncarpark wheels cars...\n</code></pre>\n\n<p>This attempt at code in Haskell is somewhat analogous to the following code snippet in C:</p>\n\n<pre><code>int wheels;\nint cars;\nchar* carpark(wheels, cars) { ... }\n</code></pre>\n\n<p>Where does the analogy lie? In both cases, the first and the second occurrences of <code>wheels</code> (or <code>cars</code>) are referring to different objects. The first one refers to a global variable, and the second one refers to the function's formal parameter.</p>\n\n<p>Inside <code>carpark</code>, <code>wheels</code> denotes the function's formal parameter; the global <code>wheels</code> is not available due to name hiding. Note that in C99 and later, this code would be illegal because formal parameters of <code>carpark</code> are not given types. The fact that a global <code>wheels</code> was given the type <code>int</code> means nothing, because that <code>wheels</code> has nothing to do with <code>wheels</code> in <code>carpark</code>.</p>\n\n<p>These general ideas of <strong>scopes of identifiers</strong> apply in Haskell, too. The declaration <code>wheels :: Int</code> declares a value at its scope (presumably, module scope), and <code>carpark wheels cars</code> uses the same name for another value in a nested scope. You cannot access the outer <code>wheels</code> in the body of <code>carpark</code> because it is hidden; had you written <code>carpark w c...</code> instead, you would have access to both outer <code>wheels</code> and local <code>w</code>.</p>\n\n<p>Finally, while in the C snippet above the lack of types for <code>wheels</code> and <code>cars</code> constitutes an error, in Haskell we usually leave it to the compiler to deduce the types of formal parameters. <code>carpark</code> itself is a value, so it has a type. If we declare the type as <code>carpark :: Int -&gt; Int -&gt; String</code>, the compiler deduces that, in a definition that starts with <code>carpark wheels cars...</code>, <code>wheels</code> here cannot be but of type <code>Int</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 5542033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c013d08ff4905ddb0aacda6feb8dc90?s=128&d=identicon&r=PG&f=1", "display_name": "Soeren Hornfeld", "link": "https://stackoverflow.com/users/5542033/soeren-hornfeld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7484, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1447088502, "creation_date": 1447066207, "last_edit_date": 1447072617, "question_id": 33607508, "link": "https://stackoverflow.com/questions/33607508/the-type-signature-lacks-an-accompanying-binding", "title": "The type signature [\u2026] lacks an accompanying binding", "body": "<p>Why do I end up with \"binding\" errors in the following program?</p>\n\n<pre><code>wheels :: Int\n\ncars :: Int\n\ncarpark wheels cars   \n  | wheels   == odd      = error wheels \"is not even\"\n  | cars     &lt;= 0        = error cars \"is an invalid number\"\n  | (2*cars) &gt;= wheels   = error \"the number of wheels is invalid\"\n  | wheels   &gt;= (4*cars) = error \"the number of wheels is invalid\"\n  | otherwise            = \"There are \" (wheels-(2 * cars)) `div` 2 \"cars and \" (cars - ((wheels - (2 * cars)) div 2)) \"motorcycles on the parking lot\"\n</code></pre>\n\n<p>This is the error:</p>\n\n<pre> aufgabe1.lhs:6:3:\nThe type signature for \u2018wheels\u2019 lacks an accompanying binding\n\naufgabe1.lhs:7:3:\nThe type signature for \u2018cars\u2019 lacks an accompanying binding\n</pre>\n\n<p>How can I get rid of it?</p>\n"}, {"tags": ["haskell", "xml-conduit"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1447077337, "post_id": 33606038, "comment_id": 54995621, "body": "It would help out a lot if you list your imports."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447079648, "post_id": 33606038, "comment_id": 54997004, "body": "The choose function has an impredictive type. Actually using impredictive types requires type signatures everywhere (where <i>exactly</i>? who knows...) because type inference cannot assign a polymorphic type. Since impredictive types are so difficult to use, I think this is just a design error on the parts of the library authors. The average user can&#39;t reasonably be expected to know all this if they just want to parse xml. A random guess is that putting a type signature on the function <code>f :: ... -&gt; Consumer ....</code> and on the resultant list from map <code>(map ff [..] :: [Consumer ...])</code> might help."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447079777, "post_id": 33606038, "comment_id": 54997092, "body": "Oh, and you may have to turn on <code>-XImpredictiveTypes</code> in your module."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1447080399, "post_id": 33606038, "comment_id": 54997518, "body": "@ErikR - did add a minimal failing example"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447081414, "post_id": 33606038, "comment_id": 54998171, "body": "@user2407038 I think I have to read some info about <code>ImpredictiveTypes</code> would you like to explain  a bit why the inference is not possible?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447083390, "post_id": 33606038, "comment_id": 54999487, "body": "@epsilonhalbe If you would really like to know <i>why</i>, you probably need to read <a href=\"http://research.microsoft.com/en-us/um/people/simonpj/papers/boxy/boxy-icfp.pdf\" rel=\"nofollow noreferrer\">this</a> paper, which details the part of the typechecker algorithm that ghc for <code>ImpredictiveTypes</code>."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447083646, "post_id": 33606038, "comment_id": 54999650, "body": "@user2407038 then I&#39;ll have to first get into type theory - at least the notation is a bit strange for me, as I have not studied cs but math. So many unknown, but terribly interesting things. But thanks for the link."}], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447081157, "post_id": 33611689, "comment_id": 54997992, "body": "you see my mouth gaping in awe - ahem - why does your example work, and the map not ? how did you see this from the error message?"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1447080423, "creation_date": 1447080423, "answer_id": 33611689, "question_id": 33606038, "link": "https://stackoverflow.com/questions/33606038/xml-conduit-combining-tagparsers/33611689#33611689", "title": "xml-conduit - combining tagParsers", "body": "<p>You can't use <code>map</code>, but you can do this:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Control.Monad.Trans.Resource\nimport Data.Conduit\nimport Data.Text (Text, unpack)\nimport Data.XML.Types\nimport Text.XML.Stream.Parse\n\ndata SumType = A Text | B Text | C Text\n\nparseList :: MonadThrow m =&gt; ConduitM Event o m (Maybe SumType)\nparseList = choose [ mkCond \"A\" A , mkCond \"B\" B , mkCond \"C\" C ]\n  where\n    mkCond x xc = tagIgnoreAttrs x (content &gt;&gt;= (return . xc))\n</code></pre>\n"}], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 33611689, "answer_count": 1, "score": 0, "last_activity_date": 1447080423, "creation_date": 1447061430, "last_edit_date": 1447080370, "question_id": 33606038, "link": "https://stackoverflow.com/questions/33606038/xml-conduit-combining-tagparsers", "title": "xml-conduit - combining tagParsers", "body": "<p>I have been trying to parse an XML-datastructure with xml-conduit, which seems to work after a bit of learning. But what I am now stuck on is the following.</p>\n\n<p>Given a list of tag-parsers how do I use <code>choose</code> to combine them</p>\n\n<pre><code>data SumType = A Text | B Text | C Text\n\nparseSumTypeList :: MonadThrow m =&gt; ConduitM Event o m (Maybe SumType)\nparseSumTypeList = choose $ \n                   [ (tagIgnoreAttrs \"A\"\n                     $ do result &lt;- content\n                          return (A $ result))\n                   , (tagIgnoreAttrs \"B\"\n                     $ do result &lt;- content\n                          return (A $ result))\n                   , (tagIgnoreAttrs \"C\"\n                     $ do result &lt;- content\n                          return (A $ result))]\n</code></pre>\n\n<p>While the above works fine - if I refactor the common pattern to</p>\n\n<pre><code>parseSumTypeList :: MonadThrow m =&gt; ConduitM Event o m (Maybe SumType)\nparseSumTypeList = choose $ map f [(\"A\",A),(\"B\",B),(\"C\",C)]\n                 where f (str,constr) = tagIgnoreAttrs str\n                                      $ do result &lt;- content\n                                           return (constr $ result)\n</code></pre>\n\n<p>I get the following error</p>\n\n<pre><code>Couldn't match type \u2018ConduitM Event o0 m0 (Maybe SumType)\u2019\n               with \u2018forall o1. ConduitM Event o1 m (Maybe SumType)\u2019\nExpected type: (Name, Text -&gt; SumType)\n               -&gt; Consumer Event m (Maybe SumType)\n  Actual type: (Name, Text -&gt; SumType)\n               -&gt; ConduitM Event o0 m0 (Maybe SumType)\nRelevant bindings include\n  parseSumType :: Consumer Event m (Maybe SumType)\n    (bound at ...)\nIn the first argument of \u2018map\u2019, namely \u2018f\u2019\nIn the first argument of \u2018choose\u2019, namely\n  \u2018(map f [(\"A\", A), (\"B\", B), (\"C\", C)])\u2019\n</code></pre>\n\n<p>It seems to me that the <code>forall o</code> part gets specialized - and therefore it is not a <code>forall</code> anymore, but that is just a guess.</p>\n\n<p>from the documentation of <code>xml-conduit</code></p>\n\n<pre><code>choose :: Monad m    \n        =&gt; [Consumer Event m (Maybe a)] -- List of parsers that will be tried in order.\n        -&gt; Consumer Event m (Maybe a) -- Result of the first parser to succeed, or Nothing if no parser succeeded\n</code></pre>\n\n<p>and knowing that Consumer is just a type synonym</p>\n\n<pre><code>type Consumer i m r = forall o. ConduitM i o m r\n</code></pre>\n\n<h2>EDIT:</h2>\n\n<p>I tried with <code>f</code> as a lambda function - which also did not work.</p>\n\n<pre><code>parseSumTypeList = choose $ flip map [(\"A\",A),(\"B\",B),(\"C\",C)]\n                                     $\\(str,constr) -&gt; tagIgnoreAttrs str\n                                        $ do result &lt;- content\n                                             return (constr $ result)\n</code></pre>\n\n<h2>EDIT2:</h2>\n\n<p><code>ConduitErr.hs</code></p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE Rank2Types #-}\n\nmodule ConduitErr where\n\nimport           Control.Monad.Trans.Resource (MonadThrow)\nimport           Text.XML.Stream.Parse\nimport           Data.Text (Text)\nimport           Data.XML.Types (Event)\nimport           Data.Conduit (ConduitM)\n-- import           Control.Lens ((&amp;),(.~))\n\ndata SumType = A Text | B Text | C Text\n\nparseSumTypeList :: MonadThrow m =&gt; ConduitM Event o m (Maybe SumType)\nparseSumTypeList = choose $\n                   [ (tagIgnoreAttrs \"A\"\n                        $ do result &lt;- content\n                             return (A $ result))\n                   , (tagIgnoreAttrs \"B\"\n                        $ do result &lt;- content\n                             return (B $ result))\n                   , (tagIgnoreAttrs \"C\"\n                        $ do result &lt;- content\n                             return (C $ result))]\n\nparseSumTypeList' :: MonadThrow m =&gt; ConduitM Event o m (Maybe SumType)\nparseSumTypeList' = choose $ map f [(\"A\",A),(\"B\",B),(\"C\",C)]\n                 where f (str,constr) = tagIgnoreAttrs str\n                                      $ do result &lt;- content\n                                           return (constr $ result)\n</code></pre>\n\n<p><code>foo.cabal</code></p>\n\n<pre><code>[...]\n  build-depends:       base &gt;=4.8 &amp;&amp; &lt;4.9\n               ,       conduit\n               ,       resourcet\n               ,       text\n               ,       xml-conduit\n               ,       xml-types\n[...]\n</code></pre>\n"}, {"tags": ["haskell", "hyperlink", "cabal", "haddock"], "answers": [{"tags": [], "owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "is_accepted": true, "score": 7, "last_activity_date": 1447052950, "creation_date": 1447052950, "answer_id": 33604055, "question_id": 33604016, "link": "https://stackoverflow.com/questions/33604016/why-does-cabal-haddock-hyperlink-source-not-generate-the-source-htmls/33604055#33604055", "title": "Why does cabal haddock --hyperlink-source not generate the source HTMLs?", "body": "<p>Turns out it was because <em>hscolour</em> was not installed.  Installing it via:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>cabal install hscolour\n</code></pre>\n\n<p>fixed the problem.</p>\n\n<p>Interestingly, there <em>was</em> a warning for it that said </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Warning: The program 'hscolour' version &gt;=1.8 is required but it could not be found.\n</code></pre>\n\n<p>but it was buried inside the usual haddock output so I didn't notice it until now.</p>\n"}], "owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 33604055, "answer_count": 1, "score": 4, "last_activity_date": 1447174516, "creation_date": 1447052735, "last_edit_date": 1447174516, "question_id": 33604016, "link": "https://stackoverflow.com/questions/33604016/why-does-cabal-haddock-hyperlink-source-not-generate-the-source-htmls", "title": "Why does cabal haddock --hyperlink-source not generate the source HTMLs?", "body": "<p>For a cabal project, I wanted to generate haddock documentation with hyperlinks to the source code, so I did the usual:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>cabal haddock --hyperlink-source\n</code></pre>\n\n<p>The links were generated, but upon clicking the links I find that the actual source code is not included even though the links are.  The source code is supposed to be rendered via HTML.  How do I generate those as well?</p>\n\n<hr>\n\n<p>Currently using:</p>\n\n<ul>\n<li>Cabal 1.22.4.0</li>\n<li>cabal-install 1.22.6.0</li>\n<li>haddock 2.16.1</li>\n</ul>\n"}, {"tags": ["haskell", "twos-complement"], "comments": [{"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 1, "creation_date": 1447035958, "post_id": 33601554, "comment_id": 54978601, "body": "Show what you&#39;ve tried for your <code>twoComplement</code> function and others will be more likely to help you out. You can&#39;t expect others to just write up the code for you."}, {"owner": {"reputation": 320, "user_id": 4595114, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MCIUH.jpg?s=128&g=1", "display_name": "vkuo", "link": "https://stackoverflow.com/users/4595114/vkuo"}, "edited": false, "score": 1, "creation_date": 1447036160, "post_id": 33601554, "comment_id": 54978644, "body": "Anther way to think of twos complement is to scan your bit string right to left until hitting the first one, then invert all the bits following that one."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 3, "creation_date": 1447037259, "post_id": 33601554, "comment_id": 54978911, "body": "<code>last</code> and <code>init</code> are not <a href=\"https://en.wikipedia.org/wiki/Higher-order_function\" rel=\"nofollow noreferrer\">higher-order functions</a>..."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 1, "creation_date": 1447037341, "post_id": 33601554, "comment_id": 54978932, "body": "I&#39;d change <code>twoComplement</code> to operate on <code>[Bool]</code> instead of (presumably) <code>[Int]</code> so that the type is tighter. Then you can rewrite <code>flipBits</code> without an error case."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 1, "creation_date": 1447037434, "post_id": 33601554, "comment_id": 54978961, "body": "&quot;I want to learn to write beautiful code.&quot; that usually means you use <b>more</b>, not less, of library functions, especially including pre-built recursion schemes."}, {"owner": {"reputation": 331, "user_id": 5231990, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/563abcb48f1195c34619244e9b662bc3?s=128&d=identicon&r=PG&f=1", "display_name": "Swift", "link": "https://stackoverflow.com/users/5231990/swift"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1447038426, "post_id": 33601554, "comment_id": 54979170, "body": "@Cactus good Idea. But the task says that we need to accept a list of Integers"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 1, "creation_date": 1447038502, "post_id": 33601554, "comment_id": 54979187, "body": "@Swift I&#39;d still push out the garbage to the periphery as far as possible, i.e. convert it from <code>[Integer]</code> to <code>[Bool]</code> as the first step, do everything in terms of <code>Bool</code>s, then convert back at the end."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 1, "creation_date": 1447049599, "post_id": 33601554, "comment_id": 54981754, "body": "@Cactus, one should arguably use <code>data Bit = Zero | One deriving (Eq, Ord, Enum, Show)</code> rather than <code>Bool</code>."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447059477, "post_id": 33601554, "comment_id": 54985698, "body": "@dfeuer: Absolutely."}, {"owner": {"reputation": 538, "user_id": 500511, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/99duf.png?s=128&g=1", "display_name": "helpwithhaskell", "link": "https://stackoverflow.com/users/500511/helpwithhaskell"}, "edited": false, "score": 0, "creation_date": 1447203180, "post_id": 33601554, "comment_id": 55059032, "body": "Have you understood the problem description correctly? You say it specified accepting a list of integers, are you sure these integers are supposed to represent the bits that you operate on or should they be arbitrary integer values on which you each perform a twos compliment operation returning a list of twos complimented values. I&#39;d suspect the latter since the former seems superfluous and ugly."}], "answers": [{"tags": [], "owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "is_accepted": true, "score": 1, "last_activity_date": 1447277230, "last_edit_date": 1447277230, "creation_date": 1447272316, "answer_id": 33658910, "question_id": 33601554, "link": "https://stackoverflow.com/questions/33601554/twos-complement-as-simple-as-possible-without-higher-order-functions/33658910#33658910", "title": "Two&#39;s Complement as simple as possible without higher order functions", "body": "<p>If you dont't want to reverse, then at any time you see an orignal digit and the result from the remainder of the list. The result from the remainder is a two's complement plus a carry digit. You have to return a result of the same type, i.e a carry digit plus a two's complement, albeit with one more digit taken into account.</p>\n\n<p>Something like this:</p>\n\n<pre><code>invAdd :: Int -&gt; (Int,[Int]) -&gt; (Int,[Int])\ninvAdd 0 (0,ds) = (0,1:ds)\ninvAdd 0 (1,ds) = (1,0:ds)\ninvAdd 1 (0,ds) = (0,0:ds)\ninvAdd 1 (1,ds) = (0,1:ds)\n</code></pre>\n\n<p>Now if you had just one digit, then the whole operation would be:</p>\n\n<pre><code>twos :: [Int] -&gt; (Int,[Int])\ntwos (d:[]) = invAdd d (1,[])\n</code></pre>\n\n<p>The <code>(1,[])</code> caters for the <code>1</code> you have to add in addtion to flipping the bits.</p>\n\n<p>If you have more than one digit you need to recurse down</p>\n\n<pre><code>twos (d:ds) = invAdd d (twos ds)\n</code></pre>\n\n<p>This gives you the two's complement plus the final carry bit. If you don't want to see the carry, use <code>snd</code>:</p>\n\n<pre><code>*Main&gt; snd (twos [0,0,0,1,1,0,1,0])\n[1,1,1,0,0,1,1,0]\n</code></pre>\n\n<p>You can easily do this with Bools as well, because no math functions are used and in <code>invAdd</code> all cases are explicitly spelled out.</p>\n"}], "owner": {"reputation": 331, "user_id": 5231990, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/563abcb48f1195c34619244e9b662bc3?s=128&d=identicon&r=PG&f=1", "display_name": "Swift", "link": "https://stackoverflow.com/users/5231990/swift"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 33658910, "answer_count": 1, "score": -1, "last_activity_date": 1447277230, "creation_date": 1447035740, "last_edit_date": 1447038347, "question_id": 33601554, "link": "https://stackoverflow.com/questions/33601554/twos-complement-as-simple-as-possible-without-higher-order-functions", "title": "Two&#39;s Complement as simple as possible without higher order functions", "body": "<p>For a homework I am asked to implement the two's complement method in Haskell, which when given a list of numbers in Binary returns the two's complement list of that list.</p>\n\n<pre><code>&gt;&gt;&gt;twoComplement [0,0,0,1,1,0,1,0]\n[1,1,1,0,0,1,1,0]\n</code></pre>\n\n<p>Therefore I am not allowed to use higher order functions, such as <code>last</code>, <code>init</code>, etc. This has to be as simple as possible. I want to learn to write beautiful code.</p>\n\n<p>I would like to do this without the use of reverse functions, but I am allowed to, if necessary.</p>\n\n<p>I already tried a lot of things. I understand that I need to flip all the bits, which is not to complicated.</p>\n\n<pre><code>flipBits [] = []\nflipBits (x:xs)\n         |x == 0 = 1:flipBits xs\n         |x == 1 = 0:flipBits xs\n         |otherwise: error \"Only 0 and 1 are allowed.\"\n</code></pre>\n\n<p>But the adding one part feels really complicated to me. Especially with the carry over if I add a 1 to an already existing 1. Also list generators are not allowed. This is all about understanding lists and the concatenator <code>:</code>. </p>\n\n<p><strong>Edit:</strong> With the help of vkuo I wrote the following, which seems to be doing the job pretty well so far.</p>\n\n<pre><code>twoComplement:: [Integer] -&gt; [Integer]\ntwoComplement [] = []\ntwoComplement lst = turn(tC(turn(lst)))\n                where\n                    tC (x:xs)\n                        |x == 1 = 1:flipp xs\n                        |x == 0 = x:tC xs\n                    flipp [] = []\n                    flipp(x:xs)\n                        |x == 0 = 1:flipp xs\n                        |x == 1 = 0:flipp xs\n                    turn [] = []\n                    turn (x:xs) = turn xs ++ [x]\n</code></pre>\n\n<p>If we want to use <code>reverse</code>, we have to make it ourselves. So I did that. Is there a way without reverse I wonder ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1447031505, "post_id": 33601026, "comment_id": 54977485, "body": "<code>main2 =</code> on its own is a problem\u2026 you have to implement <code>main2</code>."}, {"owner": {"reputation": 49, "user_id": 5540673, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b13a2f2244972806167de44bbfea026d?s=128&d=identicon&r=PG&f=1", "display_name": "Jane Doe", "link": "https://stackoverflow.com/users/5540673/jane-doe"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1447031556, "post_id": 33601026, "comment_id": 54977496, "body": "@minitech sorry I should probably edit the question. there is going to be more funtions. so if xs = 3 then go to this function if xs = something else go to that function"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 5540673, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b13a2f2244972806167de44bbfea026d?s=128&d=identicon&r=PG&f=1", "display_name": "Jane Doe", "link": "https://stackoverflow.com/users/5540673/jane-doe"}, "edited": false, "score": 0, "creation_date": 1447034153, "post_id": 33601094, "comment_id": 54978170, "body": "this is exacthly what was needed apart from I need to define main2 to work with pricePizza now and im not too familiar with how to do that."}, {"owner": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "reply_to_user": {"reputation": 49, "user_id": 5540673, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b13a2f2244972806167de44bbfea026d?s=128&d=identicon&r=PG&f=1", "display_name": "Jane Doe", "link": "https://stackoverflow.com/users/5540673/jane-doe"}, "edited": false, "score": 1, "creation_date": 1447037033, "post_id": 33601094, "comment_id": 54978871, "body": "If you have some problems implementing that part, maybe ask a separate question."}], "tags": [], "owner": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "is_accepted": false, "score": 3, "last_activity_date": 1447032747, "last_edit_date": 1447032747, "creation_date": 1447031950, "answer_id": 33601094, "question_id": 33601026, "link": "https://stackoverflow.com/questions/33601026/haskell-parse-error-on-input/33601094#33601094", "title": "Haskell - Parse error on input &#39;=&#39;", "body": "<p>You can't have a line like:</p>\n\n<pre><code> main2 =\n</code></pre>\n\n<p>on its own. It's a syntax error.</p>\n\n<p>If you want to have keep some partially defined functions that you are still working on, you can use <code>undefined</code>:</p>\n\n<pre><code>main2 = undefined\n</code></pre>\n\n<p>or else put in some dummy code:</p>\n\n<pre><code>main2 = \n</code></pre>\n\n<p>Once that is fixed, you have two more problems:</p>\n\n<ol>\n<li><p>You have a type for <code>getFloat</code>, but no definition. If you plan to define it later then you can give it an <code>undefined</code> value, otherwise you should remove it.</p></li>\n<li><p>The type of <code>xs</code> is <code>String</code> so you can't compare it to <code>3</code>, which is and <code>Int</code>. You can just use a string literal instead.</p></li>\n</ol>\n\n<p>I think this is what you were trying to do, and compiles:</p>\n\n<pre><code>main :: IO ()\nmain = do\n putStr \"Enter question number: \"\n xs &lt;- getLine\n if (xs == \"3\")\n     then do\n      main2\n     else\n      main2\n\nmain2 = putStrLn \"main 2\"\n\npricePizza ::  Double -&gt; Double -&gt; Double\npricePizza x y  = priceBase x  +  priceTopping x y * 1.6\n\npriceBase x = (3.14 * (x * 0.5) * x) * 0.001\npriceTopping x y  = ((3.14 * (x * 0.5) * x) * 0.0002) * y\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5540673, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b13a2f2244972806167de44bbfea026d?s=128&d=identicon&r=PG&f=1", "display_name": "Jane Doe", "link": "https://stackoverflow.com/users/5540673/jane-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447032747, "creation_date": 1447031469, "last_edit_date": 1447031887, "question_id": 33601026, "link": "https://stackoverflow.com/questions/33601026/haskell-parse-error-on-input", "title": "Haskell - Parse error on input &#39;=&#39;", "body": "<pre><code>getFloat :: IO Float\n\nmain = do\n putStr \"Enter question number: \"\n xs &lt;- getLine\n if (xs == 3)\n     then do\n      main2\n     else \n      main2\n\nmain2 = \npricePizza ::  Double -&gt; Double -&gt; Double\npricePizza x y  = priceBase x  +  priceTopping x y * 1.6 \n\npriceBase x = (3.14 * (x * 0.5) * x) * 0.001\npriceTopping x y  = ((3.14 * (x * 0.5) * x) * 0.0002) * y\n</code></pre>\n\n<p>Why doesn't this work?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 1, "creation_date": 1447028501, "post_id": 33600648, "comment_id": 54976749, "body": "Obliously it&#39;s <code>(*2) . length</code>, because every element is a 2-tuple. (Hint: Haskell is very unlike Python or JS with regard to data structures.)"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1447028849, "post_id": 33600648, "comment_id": 54976832, "body": "Obviously length is 3 and every element is a tuple - if you look for a function &#39;concatMap&#39; and convert the tuples into lists (note: that then these tuples need to be homogeneous) with a helper function you might get the answer 6"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 3, "creation_date": 1447070922, "post_id": 33600648, "comment_id": 54992096, "body": "Does not work is <b>not</b> a problem description. If you get an error please post 1) a minimal code that we can use to reproduce the error and 2) the full error message. If the result you obtain isn&#39;t what you intended you have to provide 1) the result you&#39;ve got and 2) the result you expected along with the input you used."}], "answers": [{"comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1447062748, "post_id": 33600715, "comment_id": 54987487, "body": "I&#39;m nit-picking here, but <code>pairListLength</code> would be a better name; the term &quot;tuple&quot; is too general."}], "tags": [], "owner": {"reputation": 20193, "user_id": 1779113, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fbd338a5ff4a8feb86507a4dacddc05b?s=128&d=identicon&r=PG", "display_name": "nburk", "link": "https://stackoverflow.com/users/1779113/nburk"}, "is_accepted": false, "score": 4, "last_activity_date": 1447028818, "creation_date": 1447028818, "answer_id": 33600715, "question_id": 33600648, "link": "https://stackoverflow.com/questions/33600648/how-to-count-how-many-elements-are-in-a-list/33600715#33600715", "title": "How to count how many elements are in a list?", "body": "<p><code>length [(1,2),(2,3),(3,4)]</code> gives you <code>3</code> because there are precisely three elements in the list where the elements are tuples, each consisting of two integers. use this function to get all the \"elements\" </p>\n\n<pre><code>tupleLength :: [(Int, Int)] -&gt; Int\ntupleLength = (*2) . length\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 1, "creation_date": 1447118696, "post_id": 33600789, "comment_id": 55017149, "body": "I would insist that the <code>length . concatMap pairToList </code> solution is strictly inferior to the <code>(*2) . length</code> solution, and should be rejected in favor of the latter. The thing is that with <code>[(a, a)]</code>, just knowing the <i>type</i> guarantees that each element of the list is a pair that has two elements.  The <code>(*2) . length</code> solution exploits this guarantee, whereas <code>length . concatMap pairToList </code> doesn&#39;t."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1447207589, "post_id": 33600789, "comment_id": 55060248, "body": "@LuisCasillas I rephrased the opening sentence to make that clearer (the rest of the answer is more of a digression to clarify the confusion implicit in the question)."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 6, "last_activity_date": 1489825602, "last_edit_date": 1495539993, "creation_date": 1447029450, "answer_id": 33600789, "question_id": 33600648, "link": "https://stackoverflow.com/questions/33600648/how-to-count-how-many-elements-are-in-a-list/33600789#33600789", "title": "How to count how many elements are in a list?", "body": "<p>While the sensible solution to your immediate problem is <code>(2 *) . length</code>, as 9000 pointed out, it is worth dwelling a bit on why <code>length [(1,2),(2,3),(3,4)]</code> doesn't do what you expect. A Haskell list contains an arbitrary number of elements of the same type. A Haskell pair, however, has exactly two elements of possibly different types, which is something quite different and which is not implicitly converted into a list (see <a href=\"https://stackoverflow.com/q/31497468/2751851\">this question</a> for further discussion of that point). However, nothing stops us from writing a conversion function ourselves:</p>\n\n<pre><code>pairToList :: (a, a) -&gt; [a]\npairToList (x, y) = [x, y]\n</code></pre>\n\n<p>Note that the argument of <code>pairToList</code> is of type <code>(a, a)</code>; that is, the function only accepts pairs with both elements having the same type.</p>\n\n<p>Given <code>pairToList</code>, we can convert the pairs in your list...</p>\n\n<pre><code>GHCi&gt; map pairToList [(1,2),(2,3),(3,4)]\n[[1,2],[2,3],[3,4]]\n</code></pre>\n\n<p>... and then proceed as you planned originally:</p>\n\n<pre><code>GHCi&gt; (length . concat . map pairToList) [(1,2),(2,3),(3,4)]\n6\n</code></pre>\n\n<p>The <code>concatMap</code> function combines <code>map</code> and <code>concat</code> into a single pass...</p>\n\n<pre><code>GHCi&gt; :t concatMap\nconcatMap :: Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]\n</code></pre>\n\n<p>... and so your function becomes simply:</p>\n\n<pre><code>GHCi&gt; (length . concatMap pairToList) [(1,2),(2,3),(3,4)]\n6\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 4440962, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/53b6eff54dcdd5594b05b9c650b3efab?s=128&d=identicon&r=PG&f=1", "display_name": "F.A", "link": "https://stackoverflow.com/users/4440962/f-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2599, "favorite_count": 0, "accepted_answer_id": 33600789, "answer_count": 2, "score": 2, "last_activity_date": 1489825602, "creation_date": 1447028237, "last_edit_date": 1447029658, "question_id": 33600648, "link": "https://stackoverflow.com/questions/33600648/how-to-count-how-many-elements-are-in-a-list", "title": "How to count how many elements are in a list?", "body": "<p>I know about the <code>length</code> function, but if I have a list such as <code>[(1,2),(2,3),(3,4)]</code> and try to use <code>length</code> it does not work. I tried to concatenate but that doesn't help. Any idea how? </p>\n"}, {"tags": ["haskell", "inheritance"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 8, "creation_date": 1447027080, "post_id": 33600433, "comment_id": 54976436, "body": "Object-oriented programming and functional programming are very different. You can&#39;t expect what makes sense in one paradigm to translate smoothly to the other; while it is possible to encode objects with inheritance into Haskell it&#39;s not pretty. If you can give a more concrete example of what you&#39;re trying to achieve in reality - beyond &quot;hello world&quot; - we might be able to give more help on how to achieve that in a functional style."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1447027768, "post_id": 33600433, "comment_id": 54976584, "body": "Haskell lacks nominal subtyping which makes this impossible to translate directly. In Haskell, you could model a similar system by writing <code>data B = B A</code> and <code>instance Something B where something (B a) = something a + 5</code>. Of course, there are other ways - what you would actually do depends on your particular use case, which is impossible to discern from this toy example."}, {"owner": {"reputation": 117, "user_id": 2679546, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d78ea8cc8c787cb3a98c93de0eabfd5d?s=128&d=identicon&r=PG&f=1", "display_name": "Artem", "link": "https://stackoverflow.com/users/2679546/artem"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1447028035, "post_id": 33600433, "comment_id": 54976639, "body": "@Benjamin Hodgson thank you for yout answer, I would like to implement a  simple simulation of life. In this simulation have to be objects/creatures with different behavior but they have to inherit some kind of parent creature. In imperative languages with OOP it can be easily achieved with super calls, but I don&#39;t understand how to do it in haskell."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1447028173, "post_id": 33600433, "comment_id": 54976673, "body": "@Artem Sounds like your different &quot;creatures&quot; might fit naturally into the cases of a datatype: <code>data Creature = Cat | Horse | Unicorn | ...</code>"}, {"owner": {"reputation": 117, "user_id": 2679546, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d78ea8cc8c787cb3a98c93de0eabfd5d?s=128&d=identicon&r=PG&f=1", "display_name": "Artem", "link": "https://stackoverflow.com/users/2679546/artem"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1447028977, "post_id": 33600433, "comment_id": 54976859, "body": "@Benjamin Hodgson I may be very wrong, but to me it doesn&#39;t seem to be a good idea to hardcode everything to one level of inheritance. I don&#39;t understand how to implement the following: a creature has a method to change its state based on the current state of the world, as I understand, in haskell it has to be <code>tick :: Creature -&gt; World -&gt; Creature</code>, and again, how do I implement &quot;inheritance&quot; of such a function for different kinds of creatures?"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1447037575, "post_id": 33600433, "comment_id": 54978984, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/27005419/object-oriented-polymorphism-in-haskell\">Object Oriented Polymorphism in Haskell</a>"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1447045085, "post_id": 33600433, "comment_id": 54980735, "body": "@Artem You could do something along these lines: <code>data Creature = Creature { name :: String, age :: Int, tick :: Creature -&gt; World -&gt; Creature, ...}; ancestor :: Creature; ancestor = Creature { name = ..., age = ..., tick = ... }</code>. Haskell can be pretty decent at prototype-based OO"}, {"owner": {"reputation": 117, "user_id": 2679546, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d78ea8cc8c787cb3a98c93de0eabfd5d?s=128&d=identicon&r=PG&f=1", "display_name": "Artem", "link": "https://stackoverflow.com/users/2679546/artem"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1447082039, "post_id": 33600433, "comment_id": 54998644, "body": "@David Young I suppose I&#39;ll do it like that and there would be only inheritance of constructor functions to create &#39;creatures&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 2679546, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d78ea8cc8c787cb3a98c93de0eabfd5d?s=128&d=identicon&r=PG&f=1", "display_name": "Artem", "link": "https://stackoverflow.com/users/2679546/artem"}, "edited": false, "score": 0, "creation_date": 1448130226, "post_id": 33824439, "comment_id": 55458467, "body": "Thank you, that&#39;s exactly what I wanted, and I have already done it like you suggested."}], "tags": [], "owner": {"reputation": 1178, "user_id": 3967945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d671333d111810416ba4952f1da75c1?s=128&d=identicon&r=PG", "display_name": "mroman", "link": "https://stackoverflow.com/users/3967945/mroman"}, "is_accepted": true, "score": 1, "last_activity_date": 1448015658, "creation_date": 1448015658, "answer_id": 33824439, "question_id": 33600433, "link": "https://stackoverflow.com/questions/33600433/haskell-alternative-to-virtual-methods-and-method-inheritance/33824439#33824439", "title": "Haskell alternative to virtual methods and method inheritance", "body": "<p>There's kind of a \"pattern\" that works like this:</p>\n\n<pre><code>data Animal m = Animal {\n  makeSound :: m ()\n}\n\ncat = Animal {\n  makeSound = print \"Meow!\"\n}\n\ndog = Animal {\n  makeSound = print \"Woof!\"\n}\n\ncow = Animal {\n  makeSound = print \"Moo!\"\n}\n\n\nanimals = [cat, cat, dog, cow]\n\nmain = mapM_ makeSound animals\n</code></pre>\n\n<p>Using this pattern you can do some more-or-less crazy things such as:</p>\n\n<pre><code>import Data.Maybe\n\ndata I a = I {\n  f :: a,\n  sup :: Maybe (I a)\n}\n\nmkA = I { f = 10,  sup = Nothing }\n\nmkB = let a = mkA in I { \n   f = 5 + f a,\n   sup = Just a\n }\n\nls = [mkA, mkB, fromJust $ sup mkB]\n\nmain = mapM_ (print . f) ls\n</code></pre>\n\n<p>This pattern can also be used to achieve \"factory\"-like functionality like:</p>\n\n<pre><code>import Data.IORef\n\ndata Storage m a = Storage {\n  putData :: String -&gt; m (),\n  readData :: m String\n}\n\nfileStorage path = Storage {\n  putData = \\s -&gt; writeFile path s,\n  readData = readFile path\n}\n\ninMemStorage ref = Storage {\n  putData = \\s -&gt; writeIORef ref s,\n  readData = readIORef ref\n}\n\nreadStorage storage = readData storage\n\nchooseStorage \"file\" = return $ fileStorage \"tmp.txt\"\nchooseStorage \"mem\" = do\n  r &lt;- newIORef \"\"\n  return $ inMemStorage r\n\nmain = do\n  storage &lt;- chooseStorage \"mem\"\n  putData storage \"hi there\"\n  txt &lt;- readData storage\n  print txt\n</code></pre>\n\n<p>Basically you define a data type that has functions as its members and then define \"constructors\" (which are just regular functions) that return an instance of that data type. </p>\n"}], "owner": {"reputation": 117, "user_id": 2679546, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d78ea8cc8c787cb3a98c93de0eabfd5d?s=128&d=identicon&r=PG&f=1", "display_name": "Artem", "link": "https://stackoverflow.com/users/2679546/artem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 2, "accepted_answer_id": 33824439, "answer_count": 1, "score": 0, "last_activity_date": 1448015658, "creation_date": 1447026493, "last_edit_date": 1447027287, "question_id": 33600433, "link": "https://stackoverflow.com/questions/33600433/haskell-alternative-to-virtual-methods-and-method-inheritance", "title": "Haskell alternative to virtual methods and method inheritance", "body": "<p>Let's say I have something like this in Java:</p>\n\n<pre><code>class A {\n    int v;\n    public A(int v) {\n        this.v = v;\n    }\n    public int a() {\n        return v;\n    }\n}\n\nclass B extends A {\n    public B(int v) { \n        super(v);\n    }\n    @Override\n    public int a() {\n        return super.a() + 5;\n    }\n}\n</code></pre>\n\n<p>How could I do something similar in Haskell? I have a very basic understanding what typeclasses are. I would like to have something like <code>ArrayList&lt;A&gt;</code> of objects (or just <code>[A]</code> in Haskell) with virtual methods, which would be inherited from the superclass.</p>\n"}, {"tags": ["string", "haskell", "list-comprehension"], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1447027192, "creation_date": 1447027192, "answer_id": 33600523, "question_id": 33600402, "link": "https://stackoverflow.com/questions/33600402/creating-an-array-of-possible-string-variations/33600523#33600523", "title": "Creating an array of possible string variations", "body": "<p>Recursively you can define <code>getVariations replacements input</code> </p>\n\n<ul>\n<li>if <code>input</code> is empty, the result is ...</li>\n<li>if <code>input</code> is <code>(a:as)</code>, combine the results of:\n\n<ol>\n<li>replacing <code>a</code> with a character from <code>replacements</code></li>\n<li>keeping <code>a</code> the same and performing <code>getVariations</code> on <code>as</code></li>\n</ol></li>\n</ul>\n\n<p>This means the definition of <code>getVariations</code> could look ike:</p>\n\n<pre><code>getVariations replacements []  = ...\ngetVariations replacements (a:as) = ...#1... ++ ...#2...\n</code></pre>\n\n<p>It might also help to decide what the type of <code>getVariations</code> is:</p>\n\n<pre><code>getVariations :: String -&gt; String -&gt; ???\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5540376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95527ea84436041456e2158cd8abbeca?s=128&d=identicon&r=PG&f=1", "display_name": "Yopper", "link": "https://stackoverflow.com/users/5540376/yopper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 1, "accepted_answer_id": 33600523, "answer_count": 1, "score": 0, "last_activity_date": 1447027192, "creation_date": 1447026229, "last_edit_date": 1592644375, "question_id": 33600402, "link": "https://stackoverflow.com/questions/33600402/creating-an-array-of-possible-string-variations", "title": "Creating an array of possible string variations", "body": "<p>I'm trying to figure out how I would create variations of a string, by replacing one character at a time in the string with a different character from another array.</p>\n<p>For example:</p>\n<blockquote>\n<p>variations = &quot;abc&quot;</p>\n<p>getVariations &quot;xyz&quot; variations</p>\n</blockquote>\n<p>Should return:</p>\n<blockquote>\n<p>[&quot;xbc&quot;, &quot;ybc&quot;, &quot;zbc&quot;, &quot;axc&quot;, &quot;ayc&quot;, &quot;azc&quot;, &quot;abx&quot;, &quot;aby&quot;, &quot;abz&quot;]</p>\n</blockquote>\n<p>I'm not quite sure how to go about this. I tried iterating through the string, and then using list comprehension to add the possible characters but I end up losing characters.</p>\n<pre><code>[c ++ xs | c &lt;- splitOn &quot;&quot; variations]\n</code></pre>\n<p>Where xs is the tail of the string.</p>\n<p>Would someone be able to point me in the right direction please?</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1447025262, "post_id": 33600266, "comment_id": 54975984, "body": "You&#39;d need to turn on <code>OverlappingInstances</code>, I think. On the other hand, I think putting <code>sign</code> in a class may be a mistake in this case - just define a top-level function <code>sign :: Integral a =&gt; a -&gt; Sign</code>."}, {"owner": {"reputation": 831, "user_id": 3371760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09370cd5d499c9f0f75b54aa1b4daa17?s=128&d=identicon&r=PG", "display_name": "Fried Brice", "link": "https://stackoverflow.com/users/3371760/fried-brice"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1447025386, "post_id": 33600266, "comment_id": 54976025, "body": "Just tried it. Doesn&#39;t seem to change. <code>instance Signed Integer</code> still compiles, but <code>instance (Integral a) =&gt; ...</code> still fails."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1447025503, "post_id": 33600266, "comment_id": 54976055, "body": "OK, I put your code into a file and GHC told me I needed to turn on <code>FlexibleInstances</code> too. With that, it compiles right away. (GHC&#39;s error messages are usually quite specific about which extensions you need to turn on.)"}, {"owner": {"reputation": 831, "user_id": 3371760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09370cd5d499c9f0f75b54aa1b4daa17?s=128&d=identicon&r=PG", "display_name": "Fried Brice", "link": "https://stackoverflow.com/users/3371760/fried-brice"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1447025616, "post_id": 33600266, "comment_id": 54976085, "body": "You&#39;re right. It does tell me... Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 831, "user_id": 3371760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09370cd5d499c9f0f75b54aa1b4daa17?s=128&d=identicon&r=PG", "display_name": "Fried Brice", "link": "https://stackoverflow.com/users/3371760/fried-brice"}, "edited": false, "score": 0, "creation_date": 1447026178, "post_id": 33600361, "comment_id": 54976220, "body": "Thank you for giving such a helpful answer. Glad I can get rid of the typeclass and pragmas."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 2, "last_activity_date": 1447862472, "last_edit_date": 1447862472, "creation_date": 1447025832, "answer_id": 33600361, "question_id": 33600266, "link": "https://stackoverflow.com/questions/33600266/haskell-instance-with-constraint/33600361#33600361", "title": "Haskell instance with constraint", "body": "<p>Attempting to compile your code produces the following error message:</p>\n\n<pre><code>sign.hs:9:26:\n    Illegal instance declaration for \u2018Signed a\u2019\n      (All instance types must be of the form (T a1 ... an)\n       where a1 ... an are *distinct type variables*,\n       and each type variable appears at most once in the instance head.\n       Use FlexibleInstances if you want to disable this.)\n    In the instance declaration for \u2018Signed a\u2019\nFailed, modules loaded: none.\n</code></pre>\n\n<p>As the compiler points out, you need to turn on <code>FlexibleInstances</code> as well as <code>UndecidableInstances</code>. GHC's error messages are usually quite specific, especially when you've forgotten to turn on a language extension. The following compiles right away:</p>\n\n<pre><code>{-# LANGUAGE UndecidableInstances, FlexibleInstances #-}\n\ndata Sign = Negative | Zero | Positive\n  deriving (Eq, Ord, Read, Show)\n\nclass Signed a where\n  sign :: a -&gt; Sign\n\ninstance (Integral a) =&gt; Signed a where\n  sign = undefined\n</code></pre>\n\n<p>However, I think the <code>Signed</code> class may be a mistake in this example. Defining a (non-overloaded) top-level function is much simpler, doesn't require <code>UndecidableInstances</code> (the need for which is often a design smell), and is more expressive of the <em>meaning</em> of your code: the \"things you can get the sign of\" are precisely the real numbers.</p>\n\n<pre><code>sign :: Real a =&gt; a -&gt; Sign\nsign x\n    | x == 0 = Zero\n    | x &lt; 0 = Negative\n    | otherwise = Positive\n</code></pre>\n"}], "owner": {"reputation": 831, "user_id": 3371760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09370cd5d499c9f0f75b54aa1b4daa17?s=128&d=identicon&r=PG", "display_name": "Fried Brice", "link": "https://stackoverflow.com/users/3371760/fried-brice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 1, "accepted_answer_id": 33600361, "answer_count": 1, "score": 3, "last_activity_date": 1447862472, "creation_date": 1447025145, "last_edit_date": 1495542656, "question_id": 33600266, "link": "https://stackoverflow.com/questions/33600266/haskell-instance-with-constraint", "title": "Haskell instance with constraint", "body": "<p>I'm trying to make a typeclass for signed numerical types. Here's my code:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies, FlexibleContexts, UndecidableInstances #-}\n\ndata Sign = Negative | Zero | Positive\n  deriving (Eq, Ord, Read, Show)\n\nclass Signed a where\n  sign :: a -&gt; Sign\n\ninstance Signed Integer where\n  sign = undefined\n</code></pre>\n\n<p>This compiles, but I'd like to adapt this code to work on any <code>Integral a</code>.</p>\n\n<pre><code>instance (Integral a) =&gt; Signed a where\n  sign = undefined\n</code></pre>\n\n<p>At which point it fails to compile.</p>\n\n<p>I've checked <a href=\"https://stackoverflow.com/questions/32983019/haskell-type-family-instance-with-type-constraints\">Haskell type family instance with type constraints</a>, but that seems to be addressing a different problem from mine. I don't think\nthere's a syntax error, in my code.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1447021927, "post_id": 33599799, "comment_id": 54974956, "body": "was answering the same stuff, +1"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 10, "last_activity_date": 1567623524, "last_edit_date": 1567623524, "creation_date": 1447021887, "answer_id": 33599799, "question_id": 33599757, "link": "https://stackoverflow.com/questions/33599757/check-length-of-xxs/33599799#33599799", "title": "Check length of (x:xs)", "body": "<p><code>x:xs</code> is never empty: it always has element <code>x</code>. The canonical pattern for matching empty lists is <code>[]</code> (though it may be spelled <code>\"\"</code> if it specifically has type <code>[Char]</code>). So, instead, you might write</p>\n\n<pre><code>checkSomething [] counter = {- the empty case -}\ncheckSomething (x:xs) counter = {- lists with at least one element -}\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 5523735, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0cd51b33a60dbf810b491c9bf0cb064?s=128&d=identicon&r=PG&f=1", "display_name": "craaaft", "link": "https://stackoverflow.com/users/5523735/craaaft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "accepted_answer_id": 33599799, "answer_count": 1, "score": 1, "last_activity_date": 1567623524, "creation_date": 1447021684, "question_id": 33599757, "link": "https://stackoverflow.com/questions/33599757/check-length-of-xxs", "title": "Check length of (x:xs)", "body": "<p>I have a function something like this</p>\n\n<pre><code>checkSomething (x:xs) counter\n| (length of x:xs)         = ...\n| ...                      = ...  \n</code></pre>\n\n<p>I want to check if the list (x:xs) is empty. I somehow didnt manage to do it with the (x:xs) notation.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 178, "user_id": 4556658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176748782a450651ab1ef750943e5f35?s=128&d=identicon&r=PG&f=1", "display_name": "sdx23", "link": "https://stackoverflow.com/users/4556658/sdx23"}, "edited": false, "score": 3, "creation_date": 1447021504, "post_id": 33599683, "comment_id": 54974821, "body": "What is your question? Have you actually tried an approach yet?"}, {"owner": {"reputation": 3, "user_id": 3311562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67ee3a92f6040efa2e5d66397c7989c0?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Lovering", "link": "https://stackoverflow.com/users/3311562/chris-lovering"}, "reply_to_user": {"reputation": 178, "user_id": 4556658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176748782a450651ab1ef750943e5f35?s=128&d=identicon&r=PG&f=1", "display_name": "sdx23", "link": "https://stackoverflow.com/users/4556658/sdx23"}, "edited": false, "score": 0, "creation_date": 1447021656, "post_id": 33599683, "comment_id": 54974865, "body": "im trying to implement a similar function to partition but uses recursion instead. The question is to slits two lists according to a function parsed int he command line eg partition&#39; even [1,2,3,4,5] would return ([2,4],[1,3,5])"}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1447021783, "post_id": 33599683, "comment_id": 54974912, "body": "recursion is not the key for everything, partition with just 2 filtering operations is much easier to understand"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 2, "creation_date": 1447022195, "post_id": 33599683, "comment_id": 54975035, "body": "@DanielSanchez The OP is likely studying recursion through this exercise. Also, filtering twice means going through the list a second time unnecessarily. (A single-pass partition can be done via <code>foldr</code>, but I digress.)"}, {"owner": {"reputation": 3, "user_id": 3311562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67ee3a92f6040efa2e5d66397c7989c0?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Lovering", "link": "https://stackoverflow.com/users/3311562/chris-lovering"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1447022313, "post_id": 33599683, "comment_id": 54975079, "body": "@duplode yes that&#39;s right so far i&#39;ve got a basic recursive format but having trouble adding the elements from down the recursive train into the list that would be printed out at the end"}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1447023105, "post_id": 33599683, "comment_id": 54975358, "body": "@duplode, I know that a single pass with a foldr would be enough, but recursively achive this is stil ineficient, so its better to understand what it is doing and how, I was just pointing this."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1447023815, "post_id": 33599683, "comment_id": 54975544, "body": "@DanielSanchez If we expand the <code>foldr</code> solution by substituting the definition of <code>foldr</code> we get a no less efficient recursive definition along the lines of zerkms&#39; suggestion above."}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1447069095, "post_id": 33599683, "comment_id": 54991120, "body": "@duplode are you sure about it? Not same performance  within fold and recursive, anyway doing it recursively is still a good exercise :)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1447070955, "post_id": 33599683, "comment_id": 54992113, "body": "@DanielSanchez I&#39;m not sure about which difference you are refering to. Substituting the definition of <code>foldr</code> in <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/src/Data-OldList.html#partition\" rel=\"nofollow noreferrer\"><code>Data.List.partition</code></a> reveals the same algorithm Oded used in their answer -- the only differences are minutiae such as the lazy pattern match in the fold-operation."}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1447073964, "post_id": 33599683, "comment_id": 54993669, "body": "@duplode, im not saying you are not right, in fact is a pretty interesting topic, i&#39;ve test that using fold vs solve problems doing recursion manually tend to speed the execution times (Some compiler magic?), may we talk privately so you can explain it properly?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 1, "creation_date": 1447107455, "post_id": 33599683, "comment_id": 55013201, "body": "@DanielSanchez There are a few tricks (<code>INLINE</code> pragmas, <a href=\"http://downloads.haskell.org/~ghc/7.10.2/docs/html/users_guide/rewrite-rules.html\" rel=\"nofollow noreferrer\">rewrite rules</a>, etc.) that can make the <code>foldr</code> solution faster when used in a broader context, as you describe. And it is indeed a good idea to avoid writing recursion explicitly in real code, not just due to performance gains but also as a matter of style. I only insisted a little further in that point so that the OP wouldn&#39;t end up think that, given just what we had written here up to that point, the explicitly recursive algorithm was less efficient."}], "answers": [{"tags": [], "owner": {"reputation": 72, "user_id": 1204162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b87a9bb999fde4adc2a35417967090c9?s=128&d=identicon&r=PG", "display_name": "Oded", "link": "https://stackoverflow.com/users/1204162/oded"}, "is_accepted": false, "score": 3, "last_activity_date": 1447024832, "creation_date": 1447024832, "answer_id": 33600213, "question_id": 33599683, "link": "https://stackoverflow.com/questions/33599683/partition-using-recursion/33600213#33600213", "title": "Partition using recursion", "body": "<p>Here's one recursive definition:</p>\n\n<pre><code>partition':: (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])\npartition' _ [] = ([],[])\npartition' f (x:xs) | f x = (x:matched,notMatched)\n                    | otherwise = (matched,x:notMatched)\n                    where (matched,notMatched) = partition' f xs\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3311562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67ee3a92f6040efa2e5d66397c7989c0?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Lovering", "link": "https://stackoverflow.com/users/3311562/chris-lovering"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1447024832, "creation_date": 1447021210, "question_id": 33599683, "link": "https://stackoverflow.com/questions/33599683/partition-using-recursion", "title": "Partition using recursion", "body": "<p>Trying to learn myself some haskell, I know about the function </p>\n\n<pre><code>partition :: (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])\n</code></pre>\n\n<p>would I be able to this using recursion rather than using the function. eg id have my own defined function</p>\n\n<pre><code>partition':: (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])\n</code></pre>\n\n<p>which would use recursion</p>\n"}, {"tags": ["parsing", "haskell", "recursion", "parser-combinators"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1447022495, "post_id": 33599675, "comment_id": 54975135, "body": "After a cursory look, it looks fine to me. Keep on expanding <code>string [&#39;e&#39;]</code> and <code>&gt;&gt;&gt;</code> so to reduce it to something involving <code>string []</code>. This is analogous to what you have already done."}, {"owner": {"reputation": 41, "user_id": 4616835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dae793aa2d61356dbfec039dcbe6d32?s=128&d=identicon&r=PG", "display_name": "sinyagin", "link": "https://stackoverflow.com/users/4616835/sinyagin"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447024289, "post_id": 33599675, "comment_id": 54975667, "body": "OK, I guess I&#39;ve managed to get the result via substitution skipping the recursive step, which will produce <code>string [] &quot;ll&quot;</code> call which will result in <code>[(&quot;&quot;,&quot;ll&quot;)]</code>. So, then is returning a failure from <code>char x</code> the only case when we we hit <code>[] -&gt; []</code> case in <code>&gt;&gt;=</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1447024900, "post_id": 33599675, "comment_id": 54975874, "body": "Minor typos aside (e.g. <code>[&#39;he&#39;]</code> should be <code>[&#39;h&#39;,&#39;e&#39;]</code> or <code>&quot;he&quot;</code>), the new version looks OK. The possible failures are indeed generated by <code>char</code>: either because the string is empty, or because the char found in the string differs from the <code>char</code> argument."}, {"owner": {"reputation": 41, "user_id": 4616835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dae793aa2d61356dbfec039dcbe6d32?s=128&d=identicon&r=PG", "display_name": "sinyagin", "link": "https://stackoverflow.com/users/4616835/sinyagin"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447027269, "post_id": 33599675, "comment_id": 54976480, "body": "Thanks, this has been the most complex recursion definition in the book so far, took me a while to comprehend it. Will continue with the exercises."}], "owner": {"reputation": 41, "user_id": 4616835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dae793aa2d61356dbfec039dcbe6d32?s=128&d=identicon&r=PG", "display_name": "sinyagin", "link": "https://stackoverflow.com/users/4616835/sinyagin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1447037724, "creation_date": 1447021151, "last_edit_date": 1447037724, "question_id": 33599675, "link": "https://stackoverflow.com/questions/33599675/recursive-parser-combinator-string", "title": "recursive parser combinator (string)", "body": "<p>I'm reading Programming in Haskell by G. Hutton and got confused in chapter 8 (Parsers). I can't understand how string parser works recursively. Here's the code (I've rewritten it explicitly using >>= because do notation abstracts even more stuff).</p>\n\n<pre><code>type Parser a = String -&gt; [(a, String)]\n\nfailure :: Parser a\nfailure = \\ inp -&gt; []\n\nreturn :: a -&gt; Parser a\nreturn v = \\ inp -&gt; [(v, inp)]\n\nitem :: Parser Char\nitem = \\ inp -&gt; case inp of\n                [] -&gt; []\n                (x : xs) -&gt; [(x, xs)]\n\n(&gt;&gt;=) :: Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b\np &gt;&gt;= f = \\ inp -&gt; case parse p inp of\n                   [] -&gt; []\n                   [(v, out)] -&gt; parse (f v) out\n\nparse :: Parser a -&gt; String -&gt; [(a, String)]\nparse p inp = p inp\n\nchar :: Char -&gt; Parser Char\nchar x = sat (== x)\n\nsat :: (Char -&gt; Bool) -&gt; Parser Char\nsat p = item &gt;&gt;= \\ ch -&gt; if p ch then return ch else failure\n</code></pre>\n\n<p>Clear so far to me, but now I don't see how recursively string would work.    </p>\n\n<pre><code>string :: String -&gt; Parser String\nstring [] = return []\nstring (x:xs) = (char x) &gt;&gt;= \\ _ -&gt;\n                string xs &gt;&gt;= \\ _ -&gt;\n                return (x:xs)\n</code></pre>\n\n<p>Can someone rewrite every step of recursion on a simple input: e.g. <code>string \"he\" \"hell\"</code> which should return <code>[(\"he\",\"ll\")]</code>. Here's how I start. </p>\n\n<pre><code>string ('h':['e']) \"hell\"\n\n((char 'h') &gt;&gt;= \\ _ -&gt; string ['e'] &gt;&gt;= \\ _ -&gt; return('h':['e'])) \"hell\"\n\n(\\ inp -&gt; case parse (char 'h') inp of\n         [] -&gt; []\n         [(v, out)] -&gt; parse ((\\ _ -&gt; string ['e'] &gt;&gt;= \\ _ -&gt; return('h':['e']) v) out) \"hell\"\n\nparse ((\\ _ -&gt; string ['e'] &gt;&gt;= \\ _ -&gt; return('h':['e']) 'h') \"ell\"\n\n(string ['e'] &gt;&gt;= \\ _ -&gt; return('h':['e'])) \"ell\"\n\n(\\ inp -&gt; case parse (string ['e']) \"ell\" of\n          [] -&gt; []\n          [('e', \"ll\")] -&gt; parse ((\\ _ return(['h','e']) 'e')) \"ll\"\n\n((\\ _ return \"he\") 'e') \"ll\"\n\nreturn \"he\" \"ll\"\n\n[(\"he\", \"ll\")]\n</code></pre>\n"}, {"tags": ["string", "haskell", "recursion", "ghci"], "comments": [{"owner": {"reputation": 1494, "user_id": 1188670, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/HEXZx.png?s=128&g=1", "display_name": "Vektorweg", "link": "https://stackoverflow.com/users/1188670/vektorweg"}, "edited": false, "score": 0, "creation_date": 1447011475, "post_id": 33598073, "comment_id": 54971453, "body": "Tip: use <code>foldl</code> to iterate over the chars about to remove."}, {"owner": {"reputation": 231, "user_id": 786466, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ccf67551965e4dc3a795c1b9bd54089?s=128&d=identicon&r=PG", "display_name": "roshkattu", "link": "https://stackoverflow.com/users/786466/roshkattu"}, "reply_to_user": {"reputation": 1494, "user_id": 1188670, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/HEXZx.png?s=128&g=1", "display_name": "Vektorweg", "link": "https://stackoverflow.com/users/1188670/vektorweg"}, "edited": false, "score": 2, "creation_date": 1447011524, "post_id": 33598073, "comment_id": 54971466, "body": "I will use foldl in the next exercise I will do. I want to see the difference by implementing recursion myself and using foldl or foldr :) Thanks for the tip"}], "answers": [{"comments": [{"owner": {"reputation": 231, "user_id": 786466, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ccf67551965e4dc3a795c1b9bd54089?s=128&d=identicon&r=PG", "display_name": "roshkattu", "link": "https://stackoverflow.com/users/786466/roshkattu"}, "edited": false, "score": 0, "creation_date": 1447011335, "post_id": 33598118, "comment_id": 54971415, "body": "Indeed. I just saw that I have forgot that <code>(c:chars)</code>. You are right. It seems that also I have more bugs than this one."}, {"owner": {"reputation": 231, "user_id": 786466, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ccf67551965e4dc3a795c1b9bd54089?s=128&d=identicon&r=PG", "display_name": "roshkattu", "link": "https://stackoverflow.com/users/786466/roshkattu"}, "edited": false, "score": 0, "creation_date": 1447011548, "post_id": 33598118, "comment_id": 54971476, "body": "I will mark your answer as being the correct one since you provided me the  with answer to my error. Thanks again"}], "tags": [], "owner": {"reputation": 2614, "user_id": 763560, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6c05805cff09c54d9704f8a9b24c56ed?s=128&d=identicon&r=PG", "display_name": "circular-ruin", "link": "https://stackoverflow.com/users/763560/circular-ruin"}, "is_accepted": true, "score": 4, "last_activity_date": 1447011241, "creation_date": 1447011241, "answer_id": 33598118, "question_id": 33598073, "link": "https://stackoverflow.com/questions/33598073/haskell-recursively-removing-chars-using-helper-function/33598118#33598118", "title": "Haskell recursively removing chars using helper function", "body": "<p>If you want to write a pattern like <code>c:chars</code> you need to put in it brackets like so:</p>\n\n<pre><code>rmCharsRec (c:chars) str = ...\n</code></pre>\n\n<p>That will resolve the error message you mention, although I think that that's not the only issue you'll need to deal with.</p>\n"}, {"tags": [], "owner": {"reputation": 1494, "user_id": 1188670, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/HEXZx.png?s=128&g=1", "display_name": "Vektorweg", "link": "https://stackoverflow.com/users/1188670/vektorweg"}, "is_accepted": false, "score": 0, "last_activity_date": 1447011252, "creation_date": 1447011252, "answer_id": 33598121, "question_id": 33598073, "link": "https://stackoverflow.com/questions/33598073/haskell-recursively-removing-chars-using-helper-function/33598121#33598121", "title": "Haskell recursively removing chars using helper function", "body": "<p>You forgot to set parentheses around <code>c:chars</code> in the pattern match. </p>\n"}], "owner": {"reputation": 231, "user_id": 786466, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0ccf67551965e4dc3a795c1b9bd54089?s=128&d=identicon&r=PG", "display_name": "roshkattu", "link": "https://stackoverflow.com/users/786466/roshkattu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 33598118, "answer_count": 2, "score": 1, "last_activity_date": 1447011252, "creation_date": 1447010975, "question_id": 33598073, "link": "https://stackoverflow.com/questions/33598073/haskell-recursively-removing-chars-using-helper-function", "title": "Haskell recursively removing chars using helper function", "body": "<p>I have a function defined as follows:</p>\n\n<pre><code>rmCharsRec :: String -&gt; String -&gt; String\n</code></pre>\n\n<p>I have a helper function rmChar defined as follows that removes all occurrences of a character in a string:</p>\n\n<pre><code>rmChar :: Char -&gt; String -&gt; String\n</code></pre>\n\n<p><code>rmCharsRec</code> should remove all the occurrences of each char in the first string, in the second string and return the response.</p>\n\n<p>I have tried the following:</p>\n\n<pre><code>rmCharsRec :: String -&gt; String -&gt; String\nrmCharsRec _ \"\" = \"\"\nrmCharsRec c:chars str = rmChar ( c str ) ++ rmCharsRec chars\n</code></pre>\n\n<p>But it seems is not working. I always get the following error:</p>\n\n<pre><code>file.hs:140:1: Parse error in pattern: rmCharsRec\n</code></pre>\n\n<p>**This is not a homework problem*. I just want to learn Haskell from a set of exercises, and I got stuck to this as I don't get why I get an error.</p>\n\n<p>Can somebody please notify me about what's the problem with my code?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 6, "creation_date": 1447006883, "post_id": 33597357, "comment_id": 54969795, "body": "&quot;it is not working&quot; is not a problem description."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1447006922, "post_id": 33597357, "comment_id": 54969814, "body": "check the signature of your <code>funct</code> and what you&#39;re providing as input."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447008328, "post_id": 33597357, "comment_id": 54970357, "body": "@shury is my answer doing what you expected/wanted? If not can you please give an example of what behavior you are expecting?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1447010085, "post_id": 33597357, "comment_id": 54970959, "body": "By &quot;it is not working&quot;, I think you mean that you&#39;re getting a type error. That&#39;s because <code>filter (funct xs)</code> should be <code>filter funct</code>; at least, if that&#39;s the solution."}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1447008176, "post_id": 33597576, "comment_id": 54970295, "body": "it does what he describes in the first line of his/her question - I think it&#39;s ok to assume that the problem he has with his/her code is exactly that it does not what is stated in this very line - can I be wrong? <b>yes</b> - but is this worse then randomly downvoting instead of trying to help? ... Can we please keep the haskell part of SO friendly?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1447008544, "post_id": 33597576, "comment_id": 54970432, "body": "The description is ambiguous. The problem with the code is several type errors that OP neglected to mention in the question, but the intent is clear in the second version of OP&#39;s code. Why did you ignore that and answer a completely different question?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1447010128, "post_id": 33597576, "comment_id": 54970975, "body": "I think you misunderstood my comment but I can&#39;t really explain myself well in a comment. - I&#39;m not much happier because I think you&#39;re rewarding bad behavior: OP was rude and you&#39;re spoonfeeding them code, under the guise of &quot;being friendly&quot;."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1447010896, "post_id": 33597576, "comment_id": 54971233, "body": "not under the guise - for a very long time the Haskell subtag has been extremely friendly to newcommers - we don&#39;t have the problem of constant &quot;write your code for me&quot;-spam here - the <i>worst</i> thing is having people asking for homework - so as someone who wants to see Haskell more popular I try to be helpful and friendly - you see: I don&#39;t care about SO - I care about Haskell and FP"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1447011021, "post_id": 33597576, "comment_id": 54971287, "body": "you might see this as a problem as many people here try to <i>police</i> this site to the point where it&#39;s dead for new people (see C# where I have a look from time to time) - personally I don&#39;t like this at all. And while I can do nothing about C# I can try to do quite a bit about Haskell still (as I said: the majority of people here is rather helpful... still)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1447011146, "post_id": 33597576, "comment_id": 54971340, "body": "btw: what is rude about not beeing able to express yourself clearly? Not everybodys first language is english (no - mines not too) and very often you can correctly guess - if not the OP will comment on your wrong assumption and in time you can help out if you are really interested in helping"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1447052548, "post_id": 33597576, "comment_id": 54982608, "body": "What&#39;s rude is posting a question on a site with no effort to find out what constitutes a good question on the site, what the conventions are. It makes it seem like instead of taking the time to ask a good question, you&#39;d rather just post whatever and waste the time of a million others who read the question and then have to figure out what it means, ask for clarification, repeat things already found in the Help section, etc. Asking the question, then going away for 12 hours, not responding to comments/requests for clarifications/etc, also fits in this pattern."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1447053457, "post_id": 33597576, "comment_id": 54982946, "body": "&quot;waste the time&quot; - as in discussing this with me here? Look I&#39;m fine with you disagreeing (or with your downvote) - I just ask you keep Haskell friendly - comment on bad questions if you must or better: use your time and answer questions ;) (btw: there will not be millions reading the question - not when it&#39;s in the negative and accepted ... heck I doubt that there will be millions reading haskell questions even if they have 100+ votes)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1447010092, "last_edit_date": 1447010092, "creation_date": 1447007954, "answer_id": 33597576, "question_id": 33597357, "link": "https://stackoverflow.com/questions/33597357/map-and-filter-in-a-haskell-function/33597576#33597576", "title": "Map and Filter in a haskell function", "body": "<p>To begin with I would advice you to write type-signatures first as those make the compiler-complains often easier to understand (and so your errors easier to see)</p>\n\n<hr>\n\n<p>What about breaking out the part that causes trouble and using <code>map</code> afterwards:</p>\n\n<pre><code>doubleIfOdd :: Int -&gt; Int\ndoubleIfOdd n\n  | n `mod` 2 == 0 = n\n  | otherwise     = 2*n\n\ndoubleOdds :: [Int] -&gt; [Int]\ndoubleOdds = map doubleIfOdd\n</code></pre>\n\n<p>this should work and is reasonable readable IMO</p>\n\n<p>here is an example:</p>\n\n<pre><code>\u03bb&gt; doubleOdds [1..10]\n[2,2,6,4,10,6,14,8,18,10]\n</code></pre>\n\n<p>so it double every number that was <em>odd</em> in the input-list - I think this is what you wanted</p>\n\n<hr>\n\n<p>for the other part of your question: if you just use filter you cannot change the elements of the list - you can only make the list smaller (you can get a sublist of it)</p>\n\n<hr>\n\n<p>as I was asked the predicate <em>is even</em> can be written pointfree as <code>(== 0) . (`mod` 2)</code> </p>\n\n<p>(first take the remainder <em>mod 2</em> and then check if it's equal to <code>0</code> - remember: you have to read this from right to left because of how the composition is defined in math/Haskell)</p>\n\n<pre><code>isEven :: Int -&gt; Bool\nisEven = (== 0) . (`mod` 2)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>doubleOdds = map (2 * ) . filter ((== 0) . (`mod` 2))\n</code></pre>\n\n<p>but is this readable? ... I think not so probably this is somewhat better:</p>\n\n<pre><code>doubleOdds = map (2 * ) . filter (\\n -&gt; n `mod` 2 == 0)\n</code></pre>\n\n<p>also note that in this case the <code>xs</code> should not be on the left side as this would add an additional (unused) parameter and you would get a signature like this:</p>\n\n<pre><code>doubleOdds :: Integral a =&gt; t -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>instead of the wanted <code>[Int] -&gt; [Int]</code> (note the <code>t</code>)</p>\n\n<p>of course <code>isEven</code> already exists in the prelude - it's named <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:even\" rel=\"nofollow\"><code>even</code></a> so you could do</p>\n\n<pre><code>doubleOdds = map (2*) . filter even\n</code></pre>\n\n<p>or if you want the <code>xs</code></p>\n\n<pre><code>doubleOdds = map (2*) $ filter even xs\n</code></pre>\n\n<p>etc. (there are <em>lots</em> of ways to write this)</p>\n\n<p>note that this <em>interpretation</em> of your question would give you</p>\n\n<pre><code>\u03bb&gt; doubleOdds' [1..10]\n[4,8,12,16,20]\n</code></pre>\n"}], "owner": {"reputation": 274, "user_id": 4016912, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/hyrSL.jpg?s=128&g=1", "display_name": "Shury", "link": "https://stackoverflow.com/users/4016912/shury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1076, "favorite_count": 0, "accepted_answer_id": 33597576, "answer_count": 1, "score": -1, "last_activity_date": 1447010092, "creation_date": 1447006724, "last_edit_date": 1447007825, "question_id": 33597357, "link": "https://stackoverflow.com/questions/33597357/map-and-filter-in-a-haskell-function", "title": "Map and Filter in a haskell function", "body": "<p>I want to define the function doubleOdds :: [Int] -> [Int] that doubles every odd number in a list.</p>\n\n<p>I've tried to write it like this</p>\n\n<pre><code>doubleOdds xs = map (2 *) . filter (funct xs)\n        where funct x = x `mod` 2 == 0\n</code></pre>\n\n<p>but it is not working. Also how can I write it as an abreviattion in filter?</p>\n\n<pre><code>doubleOdds xs = map (2 * ) . filter (`mod` 2 == 0??)\n</code></pre>\n"}, {"tags": ["haskell", "list-comprehension"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447005297, "post_id": 33596835, "comment_id": 54969222, "body": "As a style note, I&#39;d avoid <code>p x = if x&lt;5 then True else False</code>, and simply use the simpler equivalent <code>p x = x&lt;5</code>. Similarly, <code>p x == True</code> is equivalent to <code>p x</code>, and <code>p y == False</code> is equivalent to <code>not (p y)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 6262, "user_id": 691032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04fa8b0cca5a7dfef2d281be67a2b7a2?s=128&d=identicon&r=PG", "display_name": "sinan", "link": "https://stackoverflow.com/users/691032/sinan"}, "is_accepted": true, "score": 2, "last_activity_date": 1447004521, "creation_date": 1447004521, "answer_id": 33596958, "question_id": 33596835, "link": "https://stackoverflow.com/questions/33596835/non-exhaustive-pattern-matching-haskell/33596958#33596958", "title": "Non Exhaustive Pattern Matching? (Haskell)", "body": "<p>When you say:</p>\n\n<pre><code>split1 [xs] = ...\n</code></pre>\n\n<p>You're essentially doing a pattern matching on first argument. <code>[xs]</code> is pattern for a list with only one element. What you need instead is this:</p>\n\n<pre><code>split1 xs = [([x,y]) | x &lt;- xs, y &lt;- xs, p x == True, p y == False]\n</code></pre>\n\n<p>Note that I removed list brackets around xs in the definition too.</p>\n\n<p>I don't know what you're trying to do, but you may want to get rid of list brackets in <code>([x,y])</code> too.</p>\n\n<pre><code>split1 xs = [(x,y) | x &lt;- xs, y &lt;- xs, p x == True, p y == False]\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 4440962, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/53b6eff54dcdd5594b05b9c650b3efab?s=128&d=identicon&r=PG&f=1", "display_name": "F.A", "link": "https://stackoverflow.com/users/4440962/f-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 33596958, "answer_count": 1, "score": 0, "last_activity_date": 1447004521, "creation_date": 1447003805, "question_id": 33596835, "link": "https://stackoverflow.com/questions/33596835/non-exhaustive-pattern-matching-haskell", "title": "Non Exhaustive Pattern Matching? (Haskell)", "body": "<p>For some reason, when I run the code with for exmaple let's say split1 [1,2,3,4,5,6,7,8,9,10] I get an error</p>\n\n<pre><code>p :: Int -&gt; Bool\np x  = if x &lt; 5 then True else False\n\nsplit1 [xs] = [([x,y]) | x &lt;- [xs], y &lt;- [xs], p x == True, p y == False]\n</code></pre>\n\n<p>Even if I run it with split1 [1] I get an empty set. Can someone tell me where i'm wrong? Thanks. </p>\n"}, {"tags": ["haskell", "casting"], "comments": [{"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 2, "creation_date": 1447006635, "post_id": 33596643, "comment_id": 54969679, "body": "You aren&#39;t casting an <code>Int</code> here (in fact, no <code>Int</code>s are involved); unlike in other languages, where normally a literal like <code>1</code> has a specific type, in Haskell it has the polymorphic type <code>Num a =&gt; a</code>, meaning it can be used with any numeric type. It&#39;s also defined to mean the same as <code>fromInteger (1 :: Integer)</code>, so it&#39;s a function call, not a cast. (Though the compiler will be able to optimize it down to a cast in the end.)"}], "answers": [{"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 11, "last_activity_date": 1447004843, "creation_date": 1447004843, "answer_id": 33597020, "question_id": 33596643, "link": "https://stackoverflow.com/questions/33596643/cast-int-to-word8/33597020#33597020", "title": "Cast [Int] to [Word8]", "body": "<p>Try <code>fromIntegral</code>, the Swiss-army tool of converting between integer types: <code>Data.ByteString.pack (map fromIntegral [97..97 + 25])</code> should yield <code>\"abcdefghijklmnopqrstuvwxyz\" :: Data.ByteString</code>.</p>\n\n<p>As for the question of whether this is the best way: once you have a list of <code>Int</code>s, there's not much you can do besides paying the cost of conversion. <code>Int</code>s are 32-bit machine integers with three bits reserved for tagging (I think), whereas <code>Word8</code> are 8-bit machine integers. If performance is an issue, perhaps only use <code>Word8</code>s in the first place.</p>\n"}, {"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1447029555, "post_id": 33597027, "comment_id": 54976994, "body": "<code>Data.ByteString.Char8</code> is probably a bad idea here - <code>Char</code> is far less efficient than <code>Word8</code> unless you <i>need</i> to go via it."}], "tags": [], "owner": {"reputation": 6262, "user_id": 691032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04fa8b0cca5a7dfef2d281be67a2b7a2?s=128&d=identicon&r=PG", "display_name": "sinan", "link": "https://stackoverflow.com/users/691032/sinan"}, "is_accepted": false, "score": 7, "last_activity_date": 1447032414, "last_edit_date": 1447032414, "creation_date": 1447004899, "answer_id": 33597027, "question_id": 33596643, "link": "https://stackoverflow.com/questions/33596643/cast-int-to-word8/33597027#33597027", "title": "Cast [Int] to [Word8]", "body": "<p>For converting between different numeric types, use <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:fromIntegral\" rel=\"nofollow\"><code>fromIntegral</code></a>. In your case you need <code>map fromIntegral</code>. Note that you may need to specify some types if from your program it's not possible to infer return type of <code>fromIntegral</code>.</p>\n\n<p>For generating <code>ByteString</code>, try: <code>Data.ByteString.pack . map fromIntegral</code>.</p>\n"}], "owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3958, "favorite_count": 1, "accepted_answer_id": 33597020, "answer_count": 2, "score": 8, "last_activity_date": 1447032414, "creation_date": 1447002693, "question_id": 33596643, "link": "https://stackoverflow.com/questions/33596643/cast-int-to-word8", "title": "Cast [Int] to [Word8]", "body": "<p>How can I cast an int list, <code>[Int]</code> into a Word8 list, <code>[Word8]</code>. I can cast a single int using <code>let a = 1 :: Word8</code>. How can I do the same for a list of integers values? When I try I get an error.</p>\n\n<p>(Aside, my main goal is to convert from <code>[Int] -&gt; ByteString</code>, I'm using <code>[Word8]</code> as an intermediate, is there a better way to do this?)</p>\n"}, {"tags": ["haskell", "optimization", "numeric", "numerical-integration"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447002126, "post_id": 33596474, "comment_id": 54968156, "body": "can you put the C counterpart somewhere?"}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447002361, "post_id": 33596474, "comment_id": 54968238, "body": "Yes and no. The C code is compiled with mex so that it can be accessible in Matlab. Yes, I think it should not be a problem. No, it was written not by me, it is not very readable and I cannot put the matlab code using it."}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447002995, "post_id": 33596474, "comment_id": 54968473, "body": "So here is the C code <a href=\"http://pastebin.com/TgHbqaRs\" rel=\"nofollow noreferrer\">pastebin.com/TgHbqaRs</a>. It is different in that sense it uses external input and rk4 routine (but then it must be even slower)."}, {"owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "edited": false, "score": 5, "creation_date": 1447003163, "post_id": 33596474, "comment_id": 54968530, "body": "Replacing <code>Sample</code> with <code>data Sample = Sample {-# UNPACK #-} !F {-# UNPACK #-} !F</code> makes it 2-3x faster for me. Code at <a href=\"http://lpaste.net/144896\" rel=\"nofollow noreferrer\">lpaste.net/144896</a>"}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "edited": false, "score": 0, "creation_date": 1447004247, "post_id": 33596474, "comment_id": 54968876, "body": "For me too. Thank you!"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 3, "creation_date": 1447021698, "post_id": 33596474, "comment_id": 54974883, "body": "The general pattern for optimizing numeric code is to make numeric fields strict then compile with <code>-funbox-strict</code> (or add annotations as cchalmers suggests), make sure code can be inlined (possibly marking as INLINE), then dump core and make sure you&#39;re seeing all primitive unboxed functions and values (with a <code>#</code> in their name). If you&#39;re seeing some boxed types go back and add more <code>!</code> and moar INLINE, repeat"}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "edited": false, "score": 0, "creation_date": 1447028178, "post_id": 33596474, "comment_id": 54976674, "body": "Here is for example dump for the most &quot;heavy&quot; function <code>integrator</code> <a href=\"http://pastebin.com/YZAFKsPc\" rel=\"nofollow noreferrer\">pastebin.com/YZAFKsPc</a>. I am not sure about the optimization information it can provide."}, {"owner": {"reputation": 1969, "user_id": 3041008, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cqLI9.png?s=128&g=1", "display_name": "mucaho", "link": "https://stackoverflow.com/users/3041008/mucaho"}, "edited": false, "score": 1, "creation_date": 1447030860, "post_id": 33596474, "comment_id": 54977337, "body": "Is the <a href=\"https://wiki.haskell.org/Foreign_Function_Interface\" rel=\"nofollow noreferrer\">FFI</a> not applicable in your case?"}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "edited": false, "score": 0, "creation_date": 1447060486, "post_id": 33596474, "comment_id": 54986247, "body": "FFI is not not applicable. But using FFI is almost the same as to say &#39;it is impossible to have fast code in Haskell&#39;. Or to say &#39;it is much faster to write code in C than optimize Haskell code&#39;."}, {"owner": {"reputation": 1969, "user_id": 3041008, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cqLI9.png?s=128&g=1", "display_name": "mucaho", "link": "https://stackoverflow.com/users/3041008/mucaho"}, "edited": false, "score": 0, "creation_date": 1447107156, "post_id": 33596474, "comment_id": 55013038, "body": "@penkovsky There is no shame in doing performance-critical stuff in a language that is designed for performance-critical stuff. If you are writing a numerical integration library for haskell or just for fun / learning, then I understand your point. If you need numerical integration as a part of a bigger application in production, which does not provide that strict performance guarantees - so that you may use haskell as the uppermost abstraction layer, why would you bother not using FFI (since you already have C code)? Does that make sense? :)"}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "reply_to_user": {"reputation": 1969, "user_id": 3041008, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cqLI9.png?s=128&g=1", "display_name": "mucaho", "link": "https://stackoverflow.com/users/3041008/mucaho"}, "edited": false, "score": 0, "creation_date": 1447178641, "post_id": 33596474, "comment_id": 55047102, "body": "@mucaho That C code works only for 1D systems while I&#39;d like to have both 1D and 2D and spend less time for debugging."}], "owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1447064964, "creation_date": 1447001771, "last_edit_date": 1495542190, "question_id": 33596474, "link": "https://stackoverflow.com/questions/33596474/how-do-i-optimize-numerical-integration-performance-in-haskell-with-example", "title": "How do I optimize numerical integration performance in Haskell (with example)", "body": "<p>How do I optimize numerical integration routine (comparing to C)?</p>\n\n<p>What has been done to the moment:</p>\n\n<ol>\n<li>I replaced lists with unboxed vectors (obvious).</li>\n<li>I applied profiling techniques described in the book \"Read World Haskell\" <a href=\"http://book.realworldhaskell.org/read/profiling-and-optimization.html\" rel=\"nofollow noreferrer\">http://book.realworldhaskell.org/read/profiling-and-optimization.html</a>.\nI have inlined some trivial functions and inserted a lot of bangs everywhere.\nThat gave about 10x speedup.</li>\n<li>I refactored the code (i.e. extracted <code>iterator</code> function). That gave 3x speedup.</li>\n<li>I tried to replace polymorphic signatures with Floats\nas in the answer to this question\n<a href=\"https://stackoverflow.com/questions/5707250/optimizing-numerical-array-performance-in-haskell\">Optimizing numerical array performance in Haskell</a>.\nThat gave almost 2x speedup.</li>\n<li>I compile like this\n<code>cabal exec ghc -- Simul.hs -O2 -fforce-recomp -fllvm -Wall</code></li>\n<li><strong>UPDATE</strong> As suggested by cchalmers, <code>type Sample = (F, F)</code> was replaced  with\n<code>data Sample = Sample {-# UNPACK #-} !F {-# UNPACK #-} !F</code></li>\n</ol>\n\n<p>The performance now is almost as good as C code. Can we do better?</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\n\nmodule Main\n  where\n\nimport qualified Data.Vector.Unboxed as U\nimport qualified Data.Vector.Unboxed.Mutable as UM\nimport qualified Control.Monad.Primitive as PrimitiveM\n\nimport Dynamics.Nonlin ( birefrP )\n\ntype F = Float\ntype Delay = U.Vector F\ntype Input = U.Vector F\n-- Sample can be a vector of any length (x, y, z, ...)\ndata Sample = Sample {-# UNPACK #-} !F {-# UNPACK #-} !F\n-- Pair is used to define exactly a pair of values\ndata Pair = Pair {-# UNPACK #-} !F {-# UNPACK #-} !F\n\ntype ParametrizedDelayFunction = (Sample, F) -&gt; Sample\n\ngetX :: Sample -&gt; F\ngetX (Sample a _) = a\n{-# INLINE getX #-}\n\ntoDelay :: [F] -&gt; Delay\ntoDelay = U.fromList\n\nstepsPerNode :: Int\nstepsPerNode = 40  -- Number of integration steps per node\n\ninfixl 6 ..+..\n(..+..) :: Sample -&gt; Sample -&gt; Sample\n(..+..) (Sample x1 y1) (Sample x2 y2) = Sample (x1 + x2) (y1 + y2)\n{-# INLINE (..+..) #-}\n\ninfixl 7 .*..\n(.*..) :: F -&gt; Sample -&gt; Sample\n(.*..) c (Sample x2 y2) = Sample (c * x2) (c * y2)\n{-# INLINE (.*..) #-}\n\n-- | Ikeda model (dynamical system, DDE)\nikeda_model2\n  :: (F -&gt; F) -&gt; (Sample, F) -&gt; Sample\nikeda_model2 f (!(Sample x y), !x_h) = Sample x' y'\n  where\n    ! x' = recip_epsilon * (-x + (f x_h))\n    y' = 0\n    recip_epsilon = 2^(6 :: Int)\n\n-- | Integrate using improved Euler's method (fixed step).\n--\n-- hOver2 is already half of step size h\n-- f is the function to integrate\n-- x_i is current argument (x and y)\n-- x_h is historical (delayed) value\n-- x_h2 it the value after x_h\nheun2 :: F -&gt; ParametrizedDelayFunction\n  -&gt; Sample -&gt; Pair -&gt; Sample\nheun2 hOver2 f !x !(Pair x_h x_h2) = x_1\n  where\n    ! f1 = f (x, x_h)\n    ! x_1' = x ..+.. 2 * hOver2 .*.. f1\n    ! f2 = f (x_1', x_h2)\n    ! x_1 = x ..+.. hOver2 .*.. (f1 ..+.. f2)\n\n\ninitialCond :: Int -&gt; (Sample, Delay, Int)\ninitialCond nodesN = (initialSampleXY, initialInterval, samplesPerDelay)\n  where cdi = 1.1247695e-4 :: F  -- A fixed point for birefrP\n        initialInterval = U.replicate samplesPerDelay cdi\n        samplesPerDelay = nodesN * stepsPerNode\n        initialSampleXY = Sample 0.0 0.0\n\nintegrator\n  :: PrimitiveM.PrimMonad m =&gt;\n    (Sample -&gt; Pair -&gt; Sample)\n    -&gt; Int\n    -&gt; Int\n    -&gt; (Sample, (Delay, Input))\n    -&gt; m (Sample, U.Vector F)\nintegrator iterate1 len total (xy0, (history0, input)) = do\n    ! v &lt;- UM.new total\n    go v 0 xy0\n    history &lt;- U.unsafeFreeze v\n    -- Zero y value, currently not used\n    let xy = Sample (history `U.unsafeIndex` (total - 1)) 0.0\n    return (xy, history)\n  where\n    h i = history0 `U.unsafeIndex` i\n    go !v !i !xy\n      -- The first iteration\n      | i == 0 = do\n        let !r = iterate1 xy (Pair (h 0) (h 1))\n        UM.unsafeWrite v i (getX r)\n        go v 1 r\n      | i &lt; len - 1 = do\n        let !r = iterate1 xy (Pair (h i) (h $ i + 1))\n        UM.unsafeWrite v i (getX r)\n        go v (i + 1) r\n      | i == total = do\n        return ()\n      -- Iterations after the initial history has been exhausted\n      | otherwise = do\n        ! newX0 &lt;- if i == len - 1\n                      then return (getX xy0)\n                      else UM.unsafeRead v (i - len - 1)\n        ! newX &lt;- UM.unsafeRead v (i - len)\n        let !r = iterate1 xy (Pair newX0 newX)\n        UM.unsafeWrite v i (getX r)\n        go v (i + 1) r\n\n-- Not used in this version\nzero :: Input\nzero = U.fromList []\n\nnodes :: Int\nnodes = 306\n\nmain :: IO ()\nmain = do\n  let delays = 4000\n      (sample0, hist0, delayLength) = initialCond nodes\n      -- Iterator implements Heun's schema\n      iterator = heun2 (recip 2^(7::Int) :: F) (ikeda_model2 birefrP)\n      totalComputedIterations = delayLength * delays\n\n  -- Calculates all the time trace\n  (xy1, history1) &lt;- integrator iterator delayLength totalComputedIterations (sample0, (hist0, zero))\n  putStrLn $ show $ getX xy1\n\n  return ()\n</code></pre>\n\n<p>The nonlinear function (imported) can look like this:</p>\n\n<pre><code>data Parameters = Parameters { beta :: Float\n                             , alpha :: Float\n                             , phi :: Float } deriving Show\nparamA :: Parameters\nparamA = Parameters { beta = 1.1\n                    , alpha = 1.0\n                    , phi = 0.01 }\n\nbirefr :: Parameters -&gt; Float -&gt; Float\nbirefr par !x = 0.5 * beta' * (1 - alpha' * (cos $ 2.0 * (x + phi')))\n  where\n    ! beta' = beta par\n    ! alpha' = alpha par\n    ! phi' = phi par\n\nbirefrP :: Float -&gt; Float\nbirefrP = birefr paramA\n</code></pre>\n"}, {"tags": ["haskell", "optimization"], "comments": [{"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 1, "creation_date": 1446999468, "post_id": 33595312, "comment_id": 54967198, "body": "192 bit words (and many others) are available in <a href=\"https://hackage.haskell.org/package/data-dword-0.3/docs/Data-DoubleWord.html\" rel=\"nofollow noreferrer\"><code>Data.DoubleWord</code></a>. I wonder if it&#39;s optimized to generate efficient code, so it could be either a source of knowledge how to do it, or a place where to contribute, once you find the answer."}], "answers": [{"tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": false, "score": 8, "last_activity_date": 1447000801, "last_edit_date": 1447000801, "creation_date": 1447000250, "answer_id": 33596193, "question_id": 33595312, "link": "https://stackoverflow.com/questions/33595312/getting-ghc-to-produce-add-with-carry-adc-instructions/33596193#33596193", "title": "Getting GHC to produce &quot;Add With Carry (ADC)&quot; instructions", "body": "<p>I'm not familiar with low-level programming, but after question round on Freenode's #ghc channel, I got a pointer to <a href=\"http://hackage.haskell.org/package/ghc-prim-0.4.0.0/docs/GHC-PrimopWrappers.html#v:addIntC-35-\"><code>addIntC#</code></a> primop, which is related to LLVM's <a href=\"http://llvm.org/docs/LangRef.html#llvm-uadd-with-overflow-intrinsics\"><code>llvm.sadd.with.overflow.</code></a>. I'm not sure what llvm compiles that into.</p>\n\n<hr>\n\n<p>The native code gen of GHC seems to know about <code>adc</code> instruction: <a href=\"https://github.com/ghc/ghc/blob/master/compiler/nativeGen/X86/CodeGen.hs#L391\"><code>X86/CodeGen.hs</code></a>. But as comment says: </p>\n\n<blockquote>\n  <p>we handle addition, but rather badly</p>\n</blockquote>\n\n<hr>\n\n<p>Edit: you work with words. Seems that LLVM backend does compile <code>MO_Add2</code> (which is another name for <code>plusWord2</code>) to <code>llvm.uadd.with.overflow</code> in <a href=\"https://github.com/ghc/ghc/blob/2b7d9c2b96eb9da3cce7826df4a91c3426095528/compiler/llvmGen/LlvmCodeGen/CodeGen.hs#L737\">https://github.com/ghc/ghc/blob/2b7d9c2b96eb9da3cce7826df4a91c3426095528/compiler/llvmGen/LlvmCodeGen/CodeGen.hs#L737</a> , related ticket: <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9430\">https://ghc.haskell.org/trac/ghc/ticket/9430</a> </p>\n"}, {"tags": [], "owner": {"reputation": 6262, "user_id": 691032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04fa8b0cca5a7dfef2d281be67a2b7a2?s=128&d=identicon&r=PG", "display_name": "sinan", "link": "https://stackoverflow.com/users/691032/sinan"}, "is_accepted": false, "score": 11, "last_activity_date": 1447000564, "creation_date": 1447000564, "answer_id": 33596255, "question_id": 33595312, "link": "https://stackoverflow.com/questions/33595312/getting-ghc-to-produce-add-with-carry-adc-instructions/33596255#33596255", "title": "Getting GHC to produce &quot;Add With Carry (ADC)&quot; instructions", "body": "<p>Most realiable and efficient way would be calling a primop directly in your program.</p>\n\n<p>Using a FFI call is the easiest way but as you also noted it won't be the most efficient way, because of the FFI overheads.</p>\n\n<p>Even if the compiler would support the instruction you want and use it in some programs, it would be fragile. Some seemingly innocent changes in your program may end up with different generated assembly that doesn't use the instruction you want.</p>\n\n<p>So my proposal is:</p>\n\n<ol>\n<li>Add the instruction you need to X86 code generator backend, if it isn't there already.</li>\n<li>Add a primop that translates directly to the instruction you want to run. First make sure no such primop exists. Then follow these steps: <a href=\"https://ghc.haskell.org/trac/ghc/wiki/AddingNewPrimitiveOperations\">https://ghc.haskell.org/trac/ghc/wiki/AddingNewPrimitiveOperations</a></li>\n<li>You primop should be visible in GHC.Prim (<a href=\"http://hackage.haskell.org/package/ghc-prim/docs/GHC-Prim.html\">http://hackage.haskell.org/package/ghc-prim/docs/GHC-Prim.html</a>), use it in your programs.</li>\n<li>Add tests, submit your patch :)</li>\n</ol>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "answer_count": 2, "score": 17, "last_activity_date": 1447167778, "creation_date": 1446994643, "last_edit_date": 1446995177, "question_id": 33595312, "link": "https://stackoverflow.com/questions/33595312/getting-ghc-to-produce-add-with-carry-adc-instructions", "title": "Getting GHC to produce &quot;Add With Carry (ADC)&quot; instructions", "body": "<p>Here is code that adds two triples of unboxed Words representing a 192 bit number into a new triple of unboxed Words, and also returns any overflow:</p>\n\n<pre><code>{-# LANGUAGE MagicHash #-}\n{-# LANGUAGE UnboxedTuples #-}\n\nimport GHC.Prim(plusWord2#, Word#, or#)\n\nlongAdd :: \n  (# Word#, Word#, Word# #) -&gt; \n  (# Word#, Word#, Word# #) -&gt; \n  (# Word#, (# Word#, Word#, Word# #) #)\n\nlongAdd (# xl, xm, xh #) (# yl, ym, yh #) =     \n  let\n    plusWord3 x y c = \n      let \n        (# c1, r1 #) = plusWord2# x y\n        (# c2, r2 #) = plusWord2# r1 c\n      in\n        (# plusWord# c1 c2, r2 #)\n    (# cl, rl #) = plusWord2# xl yl\n    (# cm, rm #) = plusWord3 xm ym cl\n    (# ch, rh #) = plusWord3 xh yh cm     \n  in\n    (# ch, (# rl, rm, rh #) #)\n</code></pre>\n\n<p>The issue is the \"plusWord3\" definition. Ideally, this is just like an \"adc\" function, which takes two words and the carry bit and returns the result and a new carry, so the resulting assembly is like the following:</p>\n\n<pre><code>add x1 y1\nadc x2 y2\nadc x3 y3\n</code></pre>\n\n<p>Unfortunately GHC, whether native or via LLVM, produce ugly assembly code that involves saving the carry bit to a register and then reading it via a separate extra add, instead of just using <code>adc</code>. I don't want to call an external C function to achieve this, as once you add the call overhead it's probably not worth it, I'd like to stay in Haskell so the code can be inlined where possible. But I also want to be able to coax the compiler into producing the <code>adc</code> instruction appropriately. Is there anyway I can achieve that?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "edited": false, "score": 1, "creation_date": 1446991038, "post_id": 33594688, "comment_id": 54964347, "body": "if should be <code>penceToPounds = map ((&#47; 100) . fromIntegral)</code>, because <code>div</code> is division for Integral values. Also, <code>fmap</code> should be used since it is more general than <code>map</code>"}, {"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "edited": false, "score": 0, "creation_date": 1446991759, "post_id": 33594688, "comment_id": 54964602, "body": "<code>&lt;$&gt;</code> is even more general"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "edited": false, "score": 0, "creation_date": 1446999762, "post_id": 33594688, "comment_id": 54967306, "body": "@zigazou More general doesn&#39;t mean better in all cases. I would use <code>map</code> since this function is restricted to work on just lists anyway and when I see <code>map</code> I immediately know I only need to worry about lists. Generalization can be good, but if you always make everything as general as possible, things can become very hard to read."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "edited": false, "score": 0, "creation_date": 1446999834, "post_id": 33594688, "comment_id": 54967334, "body": "@VansonSamuel That&#39;s exactly as general as <code>fmap</code>. It&#39;s just a synonym for <code>fmap</code> actually."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 3, "last_activity_date": 1446991347, "last_edit_date": 1446991347, "creation_date": 1446990714, "answer_id": 33594688, "question_id": 33594616, "link": "https://stackoverflow.com/questions/33594616/short-map-in-haskell/33594688#33594688", "title": "Short map in Haskell", "body": "<p>To write the function in point-free style:</p>\n\n<pre><code>penceToPounds = map ( (/ 100) . fromIntegral )\n</code></pre>\n\n<p>or</p>\n\n<pre><code>penceToPounds = map $ (/ 100) . fromIntegral\n</code></pre>\n"}], "owner": {"reputation": 274, "user_id": 4016912, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/hyrSL.jpg?s=128&g=1", "display_name": "Shury", "link": "https://stackoverflow.com/users/4016912/shury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 33594688, "answer_count": 1, "score": 0, "last_activity_date": 1446991505, "creation_date": 1446990302, "last_edit_date": 1446991505, "question_id": 33594616, "link": "https://stackoverflow.com/questions/33594616/short-map-in-haskell", "title": "Short map in Haskell", "body": "<p>I have a function <code>penceToPounds :: [Int] -&gt; [Float]</code> that transforms pences to pounds. I have to solve this using <code>map</code></p>\n\n<p>One long way to do it is:</p>\n\n<pre><code>penceToPounds xs = map ptp xs\n                   where ptp x = fromIntegral x / 100\n</code></pre>\n\n<p>How do I include fromIntegral if I want to write a shorter version of the function, such as:</p>\n\n<pre><code>penceToPounds = map (`div` 100)\n</code></pre>\n"}, {"tags": ["scala", "haskell", "function-composition"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1446988069, "post_id": 33593496, "comment_id": 54963566, "body": "Note that <code>putStrLn . show = print</code>. Also, you could use <code>mapM</code> or <code>forM</code>: <code>forM [x | x &lt;- [1..10], x &lt; 3] $ print . (**2)</code> or something like this."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1447006352, "post_id": 33593496, "comment_id": 54969590, "body": "Once you get used to it, left to right is easier to reason about : it gives you  the type of the expression. In your case <code>putStrnLn ...</code> I know it&#39;s an IO."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1447021124, "post_id": 33593496, "comment_id": 54974702, "body": "Unhelpful observation: the &#39;flow&#39; of ordinary chained function application (without using function composition) is right to left: <code>f . g . h $ x = f (g (h (x)))</code>. This is a very old convention (and holds even in C-like syntax, so it&#39;s not just a Haskellism). It&#39;s the dot-method syntax that is &quot;backwards&quot;, not the function composition operator. Note that in your Scala example the &#39;flow&#39; is much harder to trace; it actually starts in the middle at <code>(1 to 10)</code>, then moves to the right, then suddenly jumps back to the left to <code>println</code>."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 2, "last_activity_date": 1446989407, "last_edit_date": 1446989407, "creation_date": 1446983068, "answer_id": 33593552, "question_id": 33593496, "link": "https://stackoverflow.com/questions/33593496/chaining-methods-left-to-right-in-haskell-as-opposed-to-right-to-left/33593552#33593552", "title": "Chaining methods left to right in Haskell (as opposed to right to left)", "body": "<p>Why not make a new operator?</p>\n\n<pre><code>(#) :: a -&gt; (a -&gt; b) -&gt; b\n(#) = flip id\n</code></pre>\n\n<p>Now you can just write</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>[1..10] # filter (&lt; 3) # map (**2) # show # putStrLn\n</code></pre>\n\n<p>This is the equivalent of the <code>(&amp;)</code> operator from <code>Data.Function</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1446989614, "post_id": 33593570, "comment_id": 54963958, "body": "Too bad <code>x &amp; f &gt;&gt;&gt; g</code> fails because of the wrong precedence... it would closely match <code>g . f $ x</code>."}], "tags": [], "owner": {"reputation": 869, "user_id": 2029548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f44dcf3e58fcd22cd857cd563402178?s=128&d=identicon&r=PG", "display_name": "obadz", "link": "https://stackoverflow.com/users/2029548/obadz"}, "is_accepted": true, "score": 18, "last_activity_date": 1464030286, "last_edit_date": 1464030286, "creation_date": 1446983182, "answer_id": 33593570, "question_id": 33593496, "link": "https://stackoverflow.com/questions/33593496/chaining-methods-left-to-right-in-haskell-as-opposed-to-right-to-left/33593570#33593570", "title": "Chaining methods left to right in Haskell (as opposed to right to left)", "body": "<p>Unfortunately, it's the Haskell idiomatic way. But the <code>&amp;</code> operator might do what you want.</p>\n\n<pre><code>import Data.Function ((&amp;))\n\n[1..10] &amp; filter (&lt; 3) &amp; map (**2) &amp; show &amp; putStrLn\n</code></pre>\n\n<p>Essentially, <code>(&amp;) = flip ($)</code>. Likewise, <code>Control.Arrow.(&gt;&gt;&gt;) = flip (.)</code></p>\n\n<p><strong>UPDATE (6+ months later):</strong> I have to admit, this issue is a big source of frustration for me and I have been toying with this potential solution:</p>\n\n<p><a href=\"https://gist.github.com/obadz/9f322df8ba6c8a9767683d2f86af8589#file-directionalops-hs-L81\" rel=\"nofollow\">https://gist.github.com/obadz/9f322df8ba6c8a9767683d2f86af8589#file-directionalops-hs-L81</a></p>\n"}, {"comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1446984499, "post_id": 33593593, "comment_id": 54962557, "body": "The only time I&#39;ve personally missed a left-to-right chaining operator was <a href=\"http://stackoverflow.com/q/20203056/1048572\"><code>fmap</code> in a monad</a> however"}], "tags": [], "owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "is_accepted": false, "score": 5, "last_activity_date": 1446983973, "last_edit_date": 1495541767, "creation_date": 1446983323, "answer_id": 33593593, "question_id": 33593496, "link": "https://stackoverflow.com/questions/33593496/chaining-methods-left-to-right-in-haskell-as-opposed-to-right-to-left/33593593#33593593", "title": "Chaining methods left to right in Haskell (as opposed to right to left)", "body": "<p>Yes, it is idiomatic Haskell. Not Arabic, but rather Mathematic, derived from the syntax for composition. See also <a href=\"https://stackoverflow.com/q/1457140/1048572\">Haskell composition (.) vs F#&#39;s pipe forward operator (|&gt;)</a>.</p>\n\n<p>Still, even in Haskell you sometimes prefer to write your calls in the other direction, and you'll find a few libraries (e.g. <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Function.html\" rel=\"nofollow noreferrer\"><code>Data.Function</code></a> since base 4.8.0) who have defined</p>\n\n<pre><code>(&amp;) = flip ($)\n</code></pre>\n\n<p>so that you can express your call as</p>\n\n<pre><code>[1..10] &amp; filter (&lt; 3) &amp; map (**2) &amp; show &amp; putStrLn\n</code></pre>\n"}], "owner": {"reputation": 5241, "user_id": 1094616, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7537497c81e9459b087828c5c27a8668?s=128&d=identicon&r=PG", "display_name": "sscarduzio", "link": "https://stackoverflow.com/users/1094616/sscarduzio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 946, "favorite_count": 1, "accepted_answer_id": 33593570, "answer_count": 3, "score": 11, "last_activity_date": 1464030286, "creation_date": 1446982675, "question_id": 33593496, "link": "https://stackoverflow.com/questions/33593496/chaining-methods-left-to-right-in-haskell-as-opposed-to-right-to-left", "title": "Chaining methods left to right in Haskell (as opposed to right to left)", "body": "<p>I come from Scala. So I frequently do stuff like:</p>\n\n<pre><code>println((1 to 10).filter(_ &lt; 3).map(x =&gt; x*x))\n</code></pre>\n\n<p>In Haskell, after I discovered I can get rid of all the nested parenthesis using <code>$</code> and <code>.</code>, I recently found myself writing:</p>\n\n<pre><code>putStrLn . show . map (**2) . filter (&lt; 3) $ [1..10] \n</code></pre>\n\n<p>Now, this works, but the code reads right-to-left, and unless I shift to Arabic, this is difficult for me to reason about.</p>\n\n<p>Is there any other trick that makes me chain the functions from left to right? Or this is just the Haskell idiomatic way?</p>\n"}, {"tags": ["function", "haskell", "types", "functional-programming"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 6, "creation_date": 1446982861, "post_id": 33593420, "comment_id": 54962106, "body": "you cannot - maybe you want <code>type State = Map Var Z</code> instead then you can get to the contained keys"}, {"owner": {"reputation": 354, "user_id": 4856526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98e9b00d02d7d17a78b6c6a69f1ac05?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogr", "link": "https://stackoverflow.com/users/4856526/eduardogr"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446983088, "post_id": 33593420, "comment_id": 54962172, "body": "is posible with a show instance ??"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446983184, "post_id": 33593420, "comment_id": 54962196, "body": "you cannot write a (sensible) instance for functions - look at what you have - you have no chance of finding out if <code>&quot;z&quot;</code> is a value if you don&#39;t stick it in and test if it&#39;s <code>== 0</code> or something - and as there are infintely many strings ... well you get the idea"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1446983213, "post_id": 33593420, "comment_id": 54962203, "body": "with maps your keys are part of the structure, so you <i>know</i> exactly what you put in - so of course you can show it easily"}, {"owner": {"reputation": 354, "user_id": 4856526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98e9b00d02d7d17a78b6c6a69f1ac05?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogr", "link": "https://stackoverflow.com/users/4856526/eduardogr"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446983486, "post_id": 33593420, "comment_id": 54962286, "body": "Thank you! I think that&#39;s the best way to do it!"}, {"owner": {"reputation": 1494, "user_id": 1188670, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/HEXZx.png?s=128&g=1", "display_name": "Vektorweg", "link": "https://stackoverflow.com/users/1188670/vektorweg"}, "edited": false, "score": 4, "creation_date": 1447009966, "post_id": 33593420, "comment_id": 54970919, "body": "Using <code>type</code> lets you define an alias. Its not a new type. To get a real new type use <code>newtype</code> or <code>data</code>. Then you can define instances for show for your new type, including types that consist of functions."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1454511199, "post_id": 33593420, "comment_id": 58077504, "body": "Why push this again with a strange <i>tag edit</i>? (There is no <code>algebraic-data-type</code> in this question)"}, {"owner": {"reputation": 354, "user_id": 4856526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98e9b00d02d7d17a78b6c6a69f1ac05?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogr", "link": "https://stackoverflow.com/users/4856526/eduardogr"}, "edited": false, "score": 0, "creation_date": 1454511300, "post_id": 33593420, "comment_id": 58077577, "body": "You&#39;re right, i made a mistake... It wast for another post."}], "owner": {"reputation": 354, "user_id": 4856526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98e9b00d02d7d17a78b6c6a69f1ac05?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogr", "link": "https://stackoverflow.com/users/4856526/eduardogr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1454511341, "creation_date": 1446982107, "last_edit_date": 1454511341, "question_id": 33593420, "link": "https://stackoverflow.com/questions/33593420/how-can-use-the-show-function-in-haskell-with-a-custom-type", "title": "How can use the &#39;show&#39; function in Haskell with a custom type?", "body": "<h2>How can i use 'show' function  with a type that i created?</h2>\n\n<p>I have these types:</p>\n\n<pre><code>type  Z      =  Integer\ntype  Var    =  String\ntype  State  =  Var -&gt; Z  \n</code></pre>\n\n<p>That represent a function Var -> Z,  this state help me to implement the while language. </p>\n\n<p>An example of state (relation between variables and it value):</p>\n\n<pre><code>initState :: State\ninitState \"x\" = 3\ninitState \"y\" = 4\ninitState _ = 0\n</code></pre>\n\n<p>Right now i can show just the value of one of those variables (i.e. initState \"x\"  return the value of the variable \"x\", 3)</p>\n\n<p>How can i show the state of each variable without knowledge about what variables are included in this state?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 6093, "user_id": 4293020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/352ea26cb808b26c421ab55184231322?s=128&d=identicon&r=PG", "display_name": "Simon Gibbons", "link": "https://stackoverflow.com/users/4293020/simon-gibbons"}, "edited": false, "score": 0, "creation_date": 1446981605, "post_id": 33593308, "comment_id": 54961815, "body": "You need to add a type signature for <code>primes</code>.  This would be ` `primes :: Integral a =&gt; [a] ``"}], "answers": [{"tags": [], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "is_accepted": true, "score": 0, "last_activity_date": 1446992772, "creation_date": 1446992772, "answer_id": 33595016, "question_id": 33593308, "link": "https://stackoverflow.com/questions/33593308/haskell-cannot-get-next-biggest-prime-couldnt-match-type/33595016#33595016", "title": "Haskell - cannot get next biggest prime (Couldn&#39;t match type)", "body": "<p>As Simon pointed out, you need a type signature on <code>primes</code>. The following code</p>\n\n<pre><code>primes :: (Integral a) =&gt; [a]\nprimes = filter isPrime [2..]\n</code></pre>\n\n<p>compiles. GHC tries to make types without an explicit polymorphic signature (i.e., <code>(Integral a) =&gt; ...</code>) into a signature with an monomorphic type. In your case, GHC decided to \"monomorphize\" <code>[2..]</code> to <code>[Integer]</code>. This is known as the \"<a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow\">dreaded</a> <a href=\"https://downloads.haskell.org/~ghc/6.12.2/docs/html/users_guide/monomorphism.html\" rel=\"nofollow\">monomorphism</a> <a href=\"http://lambda.jstolarek.com/2012/05/towards-understanding-haskells-monomorphism-restriction/\" rel=\"nofollow\">restriction</a>\", for which there are myriad posts by confused SOers. So another way to make your code compile is to add the language pragma <code>-XNoMonomorphismRestriction</code>, though I strongly do not recommend this for someone learning Haskell. Adding type signatures is the way to go here.</p>\n"}], "owner": {"reputation": 871, "user_id": 2319172, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e0a56d3a8d90edadf259953ca6299a24?s=128&d=identicon&r=PG", "display_name": "kotrfa", "link": "https://stackoverflow.com/users/2319172/kotrfa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 33595016, "answer_count": 1, "score": 0, "last_activity_date": 1446992772, "creation_date": 1446981238, "question_id": 33593308, "link": "https://stackoverflow.com/questions/33593308/haskell-cannot-get-next-biggest-prime-couldnt-match-type", "title": "Haskell - cannot get next biggest prime (Couldn&#39;t match type)", "body": "<p>I have function for finding primes and then I want to write a function which takes a number and returns first bigger prime number. Here is my approach:</p>\n\n<pre><code>isPrime :: (Integral a) =&gt; a -&gt; Bool\nisPrime x = and $ foldl (\\acc y -&gt; (x `mod` y /= 0):acc) [] [2..round . sqrt . fromIntegral $ (x-1)]\n\nprimes = filter isPrime [2..]\n\ngetNextPrime :: (Integral a) =&gt; a -&gt; a\ngetNextPrime n = head (dropWhile (&lt;n) primes)\n</code></pre>\n\n<p>But when I try to import it to GHCI, I get this error:</p>\n\n<pre><code>[1 of 1] Compiling Main             ( a.hs, interpreted )\n\na.hs:35:39:\n    Couldn't match type \u2018a\u2019 with \u2018Integer\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n          the type signature for getNextPrime :: Integral a =&gt; a -&gt; a\n          at a.hs:34:17\n    Expected type: [a]\n      Actual type: [Integer]\n    Relevant bindings include\n      n :: a (bound at a.hs:35:14)\n      getNextPrime :: a -&gt; a (bound at a.hs:35:1)\n    In the second argument of \u2018dropWhile\u2019, namely \u2018primes\u2019\n    In the first argument of \u2018head\u2019, namely \u2018(dropWhile (&lt; n) primes)\u2019\nFailed, modules loaded: none.\n</code></pre>\n\n<p>but when I try just inserting:</p>\n\n<pre><code>head (dropWhile (&lt;30) primes)\n</code></pre>\n\n<p>it returns 31 as expected and its type is <code>Integral</code>.</p>\n\n<p>I tried to edit types of functions or explicitly stating e.g. <code>n :: Integer</code> but it didn't help. I am sure it will be some triviality.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446981866, "post_id": 33593007, "comment_id": 54961888, "body": "but even in python you should refactor those ;)"}, {"owner": {"reputation": 3492, "user_id": 118958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/NwFFJ.jpg?s=128&g=1", "display_name": "ynimous", "link": "https://stackoverflow.com/users/118958/ynimous"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446982082, "post_id": 33593007, "comment_id": 54961928, "body": "OK, I&#39;ll bite, How? :)"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1446982108, "post_id": 33593007, "comment_id": 54961935, "body": "Well, you could do something like build a list of actions and use stuff like <code>foldM</code> or <code>forM</code> etc. to obtain the result you want. This would generalize to any number of <code>elif</code>s although it would be cumbersome for only 3 cases. The same would be true in python: <code>for test, action in tests_and_actions: if test(input): action(input)</code>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446982598, "post_id": 33593007, "comment_id": 54962043, "body": "@ynimous for example into 3 functions/actions each <code>guard</code>ing ;) then you could just sequence them ;) (of course <code>when</code> will also do)"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1446992846, "post_id": 33593007, "comment_id": 54964955, "body": "You can make the <code>ifM</code> version <a href=\"http://ideone.com/tBj6M3\" rel=\"nofollow noreferrer\">slightly nicer</a>."}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1467349692, "post_id": 33593007, "comment_id": 63705375, "body": "@user3237465 That link no longer works. If you remember what it contained, could you please post it here as an answer?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1467350328, "post_id": 33593007, "comment_id": 63705578, "body": "@Chris Martin, <code>ideone</code> was down, but it works now. It&#39;s nothing interesting, just an infixl alias for <code>ifM</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3492, "user_id": 118958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/NwFFJ.jpg?s=128&g=1", "display_name": "ynimous", "link": "https://stackoverflow.com/users/118958/ynimous"}, "edited": false, "score": 0, "creation_date": 1446988459, "post_id": 33594159, "comment_id": 54963679, "body": "I like the <code>ifM</code> better, I think. How would you do it with monadic transformers?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3492, "user_id": 118958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/NwFFJ.jpg?s=128&g=1", "display_name": "ynimous", "link": "https://stackoverflow.com/users/118958/ynimous"}, "edited": false, "score": 0, "creation_date": 1446989326, "post_id": 33594159, "comment_id": 54963885, "body": "@ynimous I tried monad transformers (<code>MaybeT</code>), but I didn&#39;t like the result: too many <code>lift</code>s and boilerplate code. Maybe someone else can post some code which is actually readable."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1446987929, "last_edit_date": 1446987929, "creation_date": 1446987019, "answer_id": 33594159, "question_id": 33593007, "link": "https://stackoverflow.com/questions/33593007/chained-if-else-statements-in-the-io-monad/33594159#33594159", "title": "Chained if/else statements in the IO Monad", "body": "<p>If we don't want to involve monad transformers, a basic option is rolling our own monadic <code>if</code>:</p>\n\n<pre><code>ifM :: Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a\nifM act t e = do\n  b &lt;- act\n  if b then t else e\n</code></pre>\n\n<p>Then the code structure is similar to the one in imperative languages:</p>\n\n<pre><code>test :: IO String\ntest = ifM anAction (do\n          putStrLn \"branch a\"\n          return \"a\")\n       $ ifM otherAction (do\n          putStrLn \"branch b\"\n          return \"b\")\n       $ return \"none\"\n</code></pre>\n\n<p>where <code>anAction, otherAction :: IO Bool</code>.</p>\n\n<p>Alternatively, use something like</p>\n\n<pre><code>ifChain :: [(IO Bool, IO a)] -&gt; IO a -&gt; IO a\nifChain [] e = e\nifChain ((g, a) : acts) e = do\n   b &lt;- g\n   if b then a else ifChain acts e\n</code></pre>\n"}], "owner": {"reputation": 3492, "user_id": 118958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/NwFFJ.jpg?s=128&g=1", "display_name": "ynimous", "link": "https://stackoverflow.com/users/118958/ynimous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 713, "favorite_count": 1, "accepted_answer_id": 33594159, "answer_count": 1, "score": 6, "last_activity_date": 1544178340, "creation_date": 1446978891, "last_edit_date": 1544178340, "question_id": 33593007, "link": "https://stackoverflow.com/questions/33593007/chained-if-else-statements-in-the-io-monad", "title": "Chained if/else statements in the IO Monad", "body": "<p>I'm wondering if there is an idiomatic way to write control code similar to chained if/else statements in an imperative language in the IO Monad.</p>\n\n<p>So in a language like Python, I would typically right something like this:</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>if \u03bfs.path.isdir(fname):\n    # do whatever\nelif os.path.isfile(fname):\n    # ...\nelse:\n    # ...\n</code></pre>\n\n<p>The best I could come up in Haskell is the following:</p>\n\n<pre><code>isf &lt;- doesFileExist path\nisd &lt;- if isf then return False else doesDirectoryExist path\ncase (isf, isd) of\n    (True,  _)      -&gt; return ...\n    (_,     True)   -&gt; return ...\n    _               -&gt; return ...\n</code></pre>\n\n<p>Which is not as good, and I am wondering if there is a better way to write this sort of thing.</p>\n\n<p>Also, to validate my understanding: the <code>if isf</code> part in <code>isd &lt;- ...</code> is required in the case of the IO Monad, if you don't  want to always do both operations. My guess would be that in other Monads (lazy Monads?), this would not be needed because <code>isd</code> would be evaluated lazily.</p>\n\n<p><strong>Edit</strong> </p>\n\n<p>Based on the first comments, I ended up with the following:</p>\n\n<pre><code>firstMatchM :: (Monad m) =&gt; a -&gt; [(a -&gt; m Bool, b)] -&gt; b -&gt; m b\nfirstMatchM arg [] def   = return def\nfirstMatchM arg ((check,x):xs) def = do\n    t &lt;- check arg\n    if t then return x else firstMatchM arg xs def\n\ndoFirstM :: (Monad m) =&gt; a -&gt; [(a -&gt; m Bool, a -&gt; m b)] -&gt; (a -&gt; m b) -&gt; m b\ndoFirstM arg acts def = do\n    fm &lt;- firstMatchM arg acts def\n    fm arg\n\nhandlePath2 path = doFirstM path\n   [( \\p -&gt; doesFileExist p,\n         \\p -&gt;  return \"file\"\n   ),(\\p -&gt; doesDirectoryExist p,\n         \\p -&gt; return \"dir\"\n   )] $ \\p -&gt; return \"Error\"\n</code></pre>\n\n<p>Which is similar to @chi's second suggestion, bit I prefer <code>ifM</code>, because it's closer to the imperative version.</p>\n"}, {"tags": ["haskell", "theory", "typeclass", "category-theory"], "comments": [{"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 4, "creation_date": 1447004814, "post_id": 33592967, "comment_id": 54969076, "body": "&quot;I understand that inequality can be expressed as an equality with a free variable, i.e. <code>a &gt; b = a + k = b</code>&quot; Generally it can&#39;t. Even in this case it only works if your domain is specifically positive numbers."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1447051784, "post_id": 33592967, "comment_id": 54982360, "body": "how about <code>|a + k| = |b|</code> then or <code>a + k = b || a - k = b</code>. but in any case, does that aspect significantly affect the point in my question? (sincere question)"}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 1, "creation_date": 1447052922, "post_id": 33592967, "comment_id": 54982744, "body": "Still doesn&#39;t work, as <code>k</code> may be 0. For the question itself, I can just say that I haven&#39;t seen any examples of it."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1447054657, "post_id": 33592967, "comment_id": 54983443, "body": "Ah good point. Also, appreciate the &quot;proto&quot; answer. Still curious though, from a theoretical point of view, but I guess cs or cstheory then later on possibly..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447092924, "post_id": 33592967, "comment_id": 55005295, "body": "If it ain&#39;t category theory, the tag seems inappropriate."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447093164, "post_id": 33592967, "comment_id": 55005431, "body": "It sounds like you probably mean &quot;inequations&quot; rather than &quot;inequalities&quot;. There are definitely cases where type class laws involving <i>inequalities</i> are useful, where a class method is required to be at least as defined as the given default."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1447108002, "post_id": 33592967, "comment_id": 55013429, "body": "A category theory expert is quite likely to be able to answer this or prove it&#39;s nonsensical. I&#39;ve removed the remark."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 1, "last_activity_date": 1456990830, "creation_date": 1456990830, "answer_id": 35765969, "question_id": 33592967, "link": "https://stackoverflow.com/questions/33592967/type-classes-with-laws-that-contain-not-equalities-symmetries-but-inequalities-a/35765969#35765969", "title": "Type classes with laws that contain not equalities/symmetries but inequalities/asymmetries", "body": "<p>Algebraic laws in general typically are only specified in terms of equational identities, and not not disequalities. The standpoint to think about this is model theory. A <em>theory</em> can be thought of as 1) a collection of symbols, of different arities, so that sentences can be constructed from them (i.e. of arity 0 we might have sequences of numerals, of arity 1 we have negation, and of arity two we have addition) and 2) a set of equations that provide relations between sentences constructed from such signatures.</p>\n\n<p>This lets us describe things like various arithmetic theories, groups, rings, modules, etc.</p>\n\n<p>Now a <em>model</em> of a theory is a set of concrete assignments of mathematical objects (numbers, functions, etc) to the elements of the signature, such that the translation of sentences into the elements of the model respects these equations.</p>\n\n<p>Categorically, we often think of a theory as a special sort of category of all possible sentences generated by the signature. The arrows in this category are implication -- sentences which may be generated from others by application of the equational identities. This in turn induces equivalences between all sentences which are the same under the application of the equational identities (this yields the \"generators and relations\" approach). And in turn, a model is simply a functor from this theory to any other category, though typically <code>Set</code>.</p>\n\n<p>This yields a very nice adjunction between syntax and semantics. The greater the collection of sentences you want to model, the fewer the models you can get, and the more models you have, the smaller the set of sentences that will be satisfied by all of them. (Here I am only sketching the idea rather than filling in lots of important details).</p>\n\n<p>In any case, one consequence of this that people tend to ignore, but that really pays off, is that in such a setting you want a \"terminal model\" that is the least among all models, just as you want an \"initial theory\" that admits all models. The terminal (aka trivial) model is the functor that sends everything in the theory to the empty set and maps on the empty set. Lots of very nice properties emerge when you have such things. But note -- to have such things, you must only have equational identities and not \"disidentities.\" Such theories are called <a href=\"https://en.wikipedia.org/wiki/Algebraic_theory\" rel=\"nofollow\">Algebraic Theories.</a></p>\n\n<p>What does this all have to do with Haskell? Well, we can think of the signatures of typeclasses exactly as signatures of algebraic theories, and the laws of them as the equations of such theories. And that's generally how typeclasses are used in Haskell and why they were introduced -- to suit these sorts of situations.</p>\n\n<p>But of course we don't <em>have</em> to do this -- we can have whatever laws we want. But we lose all sorts of nice properties along the way -- and often in fact find that disequalities mean our theory will have very few models, and with weird structure relating them. Since typeclasses are intended to capture <em>common</em> structure between various things, and since non-algebraic theories tend to fix unique(ish) models, then it turns out it is rarely the case that we would want to use disequality relations in typeclass laws. And indeed I can't think of any examples where I've seen it come up.</p>\n\n<p>Here's another way to think of it -- consider a theory with equalities and disequalities both, and then eliminate the disequalities. What remains still admits all the prior models, but also may have a bunch of \"unintended\" ones. So we don't gain additional reasoning in terms of rewrites -- we just have certain models that are a priori excluded. Furthermore, when one wishes to rule out \"unintended\" models this is usually because we want to fix a particular \"intended\" one. And if we want to fix a particular intended model, the question immediately arises -- why not just use that concrete structure, instead of the more general typeclass?</p>\n"}], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1456990830, "creation_date": 1446978567, "last_edit_date": 1447107970, "question_id": 33592967, "link": "https://stackoverflow.com/questions/33592967/type-classes-with-laws-that-contain-not-equalities-symmetries-but-inequalities-a", "title": "Type classes with laws that contain not equalities/symmetries but inequalities/asymmetries", "body": "<p>All of the type classes that I've come across, I think have had laws that establish symmetries by specifying equations. I was wondering though if there are any prominent theoretical or even practical examples of type classes that establish asymmetries, i.e. ones that demand the lack of symmetry? By e.g. specifying <code>&lt;expr1&gt; /= &lt;expr2&gt;</code> or <code>&lt;</code>,  or <code>not somePredicate(a, b)</code>.</p>\n\n<p>I understand that inequality can be expressed as an equality with a free variable, i.e. <code>a &gt; b</code> = <code>a + k = b</code> etc, but I'm thinking the introduction of free variables itself might align with my idea of enforced asymmetry. </p>\n\n<p>What would be the (theoretical) applications of such law? And are there any (runnable) examples of this?</p>\n\n<p>Alternatively: if this can't be considered Haskell enough to be on SO, should this go on <a href=\"http://cs.stackexchange.com\">CS</a> or <a href=\"http://cstheory.stackexchange.com\">CSTheory</a>?</p>\n"}, {"tags": ["haskell", "binary"], "answers": [{"comments": [{"owner": {"reputation": 3422, "user_id": 1091208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/507510b4df35587c853d93c2d2cdda22?s=128&d=identicon&r=PG", "display_name": "amnn", "link": "https://stackoverflow.com/users/1091208/amnn"}, "edited": false, "score": 0, "creation_date": 1446980644, "post_id": 33592879, "comment_id": 54961591, "body": "Pattern matching over <code>(:)</code> is unnecessary, every instance of <code>(x:xs)</code> can be replaced with just <code>xs</code>. (But then converting to little endian you notice that <code>twoComplement = map invertBit</code> too)."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1446977813, "creation_date": 1446977813, "answer_id": 33592879, "question_id": 33592801, "link": "https://stackoverflow.com/questions/33592801/converting-binary-to-negative-binary/33592879#33592879", "title": "Converting binary to negative binary", "body": "<p><code>(x:xs) == []</code> is always false: the first is a list having at least one element (<code>x</code>) and the second is empty.</p>\n\n<p>Maybe you wanted to write something like</p>\n\n<pre><code>twoComplement [x] = [x]\ntwoComplement (x:xs)| last (x:xs) == 0 = (twoComplement (init (x:xs))) ++ [1]\n                    | last (x:xs) == 1 = (twoComplement (init (x:xs))) ++ [0]\n</code></pre>\n\n<p>but this still looks wrong. </p>\n\n<p>I would define a function to invert a bit first</p>\n\n<pre><code>invertBit :: Int -&gt; Int\ninvertBit 0 = 1\ninvertBit 1 = 0\n</code></pre>\n\n<p>then, <code>twoComplement</code> can be done by 1) applying <code>inverBit</code> on all the list elements, and 2) invrementing the binary number just obtained. I'd write a separate function for the last.</p>\n\n<p>It might also be convenient to use a little endian notation, with the least significant bit first -- that simplifies the last increment.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1447560062, "post_id": 33593355, "comment_id": 55203195, "body": "I suggest you rename <code>fix</code> to <code>fixup</code> or similar. Most Haskell programmers will assume at first that you mean <code>Data.Function.fix</code>. That is, <code>fix f = let g = f g in g</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1447560235, "post_id": 33593355, "comment_id": 55203228, "body": "Also, it&#39;s probably more efficient to use <code>invert x = 1 - x</code>."}, {"owner": {"reputation": 3422, "user_id": 1091208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/507510b4df35587c853d93c2d2cdda22?s=128&d=identicon&r=PG", "display_name": "amnn", "link": "https://stackoverflow.com/users/1091208/amnn"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447580253, "post_id": 33593355, "comment_id": 55206787, "body": "Ah thanks ;) I initially named <code>fix</code>, <code>flip</code>... lots of shadowing going on over here."}], "tags": [], "owner": {"reputation": 3422, "user_id": 1091208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/507510b4df35587c853d93c2d2cdda22?s=128&d=identicon&r=PG", "display_name": "amnn", "link": "https://stackoverflow.com/users/1091208/amnn"}, "is_accepted": true, "score": 2, "last_activity_date": 1447580321, "last_edit_date": 1447580321, "creation_date": 1446981581, "answer_id": 33593355, "question_id": 33592801, "link": "https://stackoverflow.com/questions/33592801/converting-binary-to-negative-binary/33593355#33593355", "title": "Converting binary to negative binary", "body": "<p>Looking on <a href=\"https://en.wikipedia.org/wiki/Two%27s_complement#Converting_to_two.27s_complement_representation\" rel=\"nofollow\">Wikipedia</a>, there's an explanation of how to perform the two's complement conversion \"From LSB to MSB\":</p>\n\n<blockquote>\n  <h2>Working from LSB towards MSB:</h2>\n  \n  <p>A shortcut to manually convert a binary number into its two's complement is to start at the least significant bit (LSB), and copy all the zeros (working from LSB toward the most significant bit) until the first 1 is reached; then copy that 1, and flip all the remaining bits.</p>\n</blockquote>\n\n<p>This algorithm translates quite neatly to Haskell:</p>\n\n<pre><code>twosComplement :: [Int] -&gt; [Int]\ntwosComplement bs = zs ++ fixup rest\n  where\n    (zs, rest) = span (== 0) bs\n\n    fixup [] = []\n    fixup (x:xs) = x : map (1-) xs\n</code></pre>\n\n<p>This implementation is using the little-endian format that @chi suggested in his answer: In general that is the one you want to use when processing binary numbers. If you <em>really really</em> want to keep it in big-endian format, then you will have to reverse the number before and after applying <code>twosComplement</code> as defined above.</p>\n\n<h2>Implementation Notes</h2>\n\n<ul>\n<li><code>span</code> is used to get all the consecutive least significant zeros (<code>zs</code>) as well as the <code>rest</code> of the number.</li>\n<li><code>fixup</code> copies the first <code>1</code> encountered (it will be at the head of <code>rest</code> if it exists at all), before inverting the rest of the number.</li>\n</ul>\n"}], "owner": {"reputation": 53, "user_id": 5536215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34b3d920e62ece3a722bbd9fdb908d25?s=128&d=identicon&r=PG&f=1", "display_name": "04k", "link": "https://stackoverflow.com/users/5536215/04k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1158, "favorite_count": 0, "accepted_answer_id": 33593355, "answer_count": 2, "score": 0, "last_activity_date": 1447580321, "creation_date": 1446977184, "question_id": 33592801, "link": "https://stackoverflow.com/questions/33592801/converting-binary-to-negative-binary", "title": "Converting binary to negative binary", "body": "<p>I need to convert a positive binary to a negative binary.\nMy approach seems somehow wrong. Adding an element to the end of a list does not work too. Please help me!</p>\n\n<pre><code>twoComplement :: [Int] -&gt; [Int]\ntwoComplement (x:xs)    | (x:xs) == [] = [x]\n                    | last (x:xs) == 0 = (twoComplement (init (x:xs))) ++ [1]\n                    | last (x:xs) == 1 = (twoComplement (init (x:xs))) ++ [0]\n</code></pre>\n\n<p>as u see I'm new to haskell.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1446970809, "post_id": 33591456, "comment_id": 54959404, "body": "Is <code>hFlush</code> needed? AFAIK the <code>hClose</code> call should also flush any pending i/o on the file."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1447004888, "post_id": 33591456, "comment_id": 54969100, "body": "Oops, that&#39;s my bad. I took it out."}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 1, "last_activity_date": 1447004881, "last_edit_date": 1447004881, "creation_date": 1446965062, "answer_id": 33591456, "question_id": 33591346, "link": "https://stackoverflow.com/questions/33591346/write-to-text-file-in-ide-haskell/33591456#33591456", "title": "Write to text file in IDE Haskell", "body": "<p>FP Complete's Haskell IDE doesn't let you browse the files you've created from code. But your program still worked!</p>\n\n<pre><code>import System.IO\n\nmain = do\n    h &lt;- openFile \"message.txt\" WriteMode\n    hPutStrLn h \"Greetings earthlings\"\n    hClose h\n\n    r &lt;- readFile \"message.txt\"\n    print r\n</code></pre>\n\n<p>You should see <code>\"Greetings earthlings\\n\"</code> in the console, as expected.</p>\n"}], "owner": {"reputation": 3, "user_id": 5538593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/252cfbb5d31c2dbbe2449a2f99916dda?s=128&d=identicon&r=PG&f=1", "display_name": "Ladyhawk Bird", "link": "https://stackoverflow.com/users/5538593/ladyhawk-bird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 1, "accepted_answer_id": 33591456, "answer_count": 1, "score": 0, "last_activity_date": 1447004881, "creation_date": 1446963913, "question_id": 33591346, "link": "https://stackoverflow.com/questions/33591346/write-to-text-file-in-ide-haskell", "title": "Write to text file in IDE Haskell", "body": "<p>I have the following code and am using an online IDE from School of Haskell: </p>\n\n<pre><code>import System.IO\n\nmain = do\n    h &lt;- openFile \"message.txt\" WriteMode\n    hPutStrLn h \"Greetings earthlings\"\n    hClose h\n</code></pre>\n\n<p>But it doesn't seem to be working. Where is message.txt saved?</p>\n"}, {"tags": ["haskell", "time", "io"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1446962900, "post_id": 33591214, "comment_id": 54958041, "body": "The error is because <code>runNtimes numbuyers groupsize i-1</code> is itself invalid, parentheses are required: <code>runNtimes numbuyers groupsize (i-1)</code> and that expr has type <code>IO X</code>, so you must run that computation first: <code>rs &lt;- runNtimes ...; return ((..,..,..) : rs)</code>. Also, you have misunderstood the semantics of Haskell - <code>let prices = simulate numbuyers groupsize</code> will not force that expression to be evaluated at that point, instead it will be evaluated lazily (as all things in Haskell) - you can evaluate the expression with <code>print prices</code> or <code>Control.Exception.evaluate (sum prices)</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1447004439, "post_id": 33591214, "comment_id": 54968956, "body": "Yes, it does work. You must adhere strictly to haskell syntax - function application binds stronger than operator application, so <code>return (a,b,c):rs</code> means <code>(return (a,b,c)):rs</code>, which is obviously wrong. You want <code>return ((a,b,c):rs)</code> - exactly as I write in my original comment."}, {"owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "edited": false, "score": 0, "creation_date": 1447273126, "post_id": 33591214, "comment_id": 55091750, "body": "You may want to try System.TimeIt.  Then you can do mapM_ (timeIt . putStrLn . show) [1..5] where putStrLn.show would be the function to test and [1..5] is a list of parameters"}], "owner": {"reputation": 11, "user_id": 5537345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0887c5b69514e1179c857af33a9f42?s=128&d=identicon&r=PG&f=1", "display_name": "strangeintp", "link": "https://stackoverflow.com/users/5537345/strangeintp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1446962451, "creation_date": 1446962451, "question_id": 33591214, "link": "https://stackoverflow.com/questions/33591214/haskell-types-time-io-general-issues", "title": "Haskell: types, time, IO... general issues", "body": "<p>sigh...  Haskell's type system is really kicking my butt...  Especially when throwing in the IO issues on top.</p>\n\n<p>I'm trying to measure performance speedups on some parallelized code.  I need to run it multiple times (e.g. i=30) with different parameters, then calculate averages etc.</p>\n\n<p>So, I start and end the timer before and after the parallelized code (\"simulate\" in the code below).</p>\n\n<pre><code>simulate :: Int -&gt; Int -&gt; [Double]\nsimulate numbuyers groupsize =\n    let buyers = initTraders numbuyers minimum_price maximum_price\n        sellers = initTraders numbuyers minimum_price maximum_price\n        prices = doParallelTrades sellers buyers groupsize\n    in prices\n\n\nrunNtimes :: Int -&gt; Int -&gt; Int -&gt; IO [(Double, Int, Double)]\nrunNtimes numbuyers groupsize i\n    | i==0 = []\n    | otherwise = do\n        start &lt;- getCurrentTime\n        let prices = simulate numbuyers groupsize\n        end &lt;- getCurrentTime\n        let dtime = realToFrac( diffUTCTime end start)\n        return (average prices, length prices, dtime):(runNtimes numbuyers groupsize i-1)\n</code></pre>\n\n<p>The runNtimes function is giving me a slew of errors (I've already verified the simulate function works):</p>\n\n<pre><code>Couldn't match expected type \u2018IO [(Double, Int, Double)]\u2019\n                with actual type \u2018[t0]\u2019\n    In the expression: []\n\nzitraders-threaded.hs:162:21:\n    No instance for (Fractional t1) arising from a use of \u2018realToFrac\u2019\n    The type variable \u2018t1\u2019 is ambiguous\n    Relevant bindings include\n      dtime :: t1 (bound at zitraders-threaded.hs:162:13)\n\nzitraders-threaded.hs:163:9:\n    Couldn't match expected type \u2018IO [(Double, Int, Double)]\u2019\n                with actual type \u2018[m0 (Double, Int, t1)]\u2019\n    Relevant bindings include\n      dtime :: t1 (bound at zitraders-threaded.hs:162:13)\n\nzitraders-threaded.hs:163:56:\n    Couldn't match expected type \u2018[m0 (Double, Int, t1)]\u2019\n                with actual type \u2018IO [(Double, Int, Double)]\u2019\n    Relevant bindings include\n      dtime :: t1 (bound at zitraders-threaded.hs:162:13)\n</code></pre>\n\n<p>I don't even know how to parse these errors, except that I'm pretty sure it's my lack of understanding types and IO...  t0? t1? m0?  what?  I read somewhere else on stack exchange to use realToFrac to get some computationally usable type out of UTCtime but given the errors above I'm not sure that's working either -- those errors aren't giving much information how it's not working.  Frustrating.</p>\n\n<p>I haven't even got to the part yet where I do something with the result from the \"runNtimes\" function -- basically just calculate average and standard deviation over the elements of the list (then print those out) -- but I'm expecting that returning an IO type will give me trouble there, too.</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": false, "score": 2, "last_activity_date": 1446955041, "creation_date": 1446955041, "answer_id": 33590558, "question_id": 33590172, "link": "https://stackoverflow.com/questions/33590172/defining-custom-pragmas-in-haskell/33590558#33590558", "title": "Defining custom pragmas in haskell", "body": "<p>You'll have to add <a href=\"https://github.com/ghc/ghc/blob/2b7d9c2b96eb9da3cce7826df4a91c3426095528/compiler/parser/Parser.y#L779\" rel=\"nofollow\">additional alternations to the <code>topdecl</code> production in Parser.y</a>. There's no separate lexer modifications required. Following the examples of the DEPRECATED/WARNING/RULES pragmas, whose definitions also begin there, you'll have to define some additional datatypes and case-handling paperwork in modules such as <code>HsDecls</code> and <code>RnSource</code>, but if you follow the pattern of prior similar work it should be easy going. (I also believe the GHC developers are notoriously helpful on IRC and mailing lists.)</p>\n"}], "owner": {"reputation": 187, "user_id": 2302260, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8f97ff66bdfe5674beb4b843bdea852d?s=128&d=identicon&r=PG", "display_name": "EdZhavoronkov", "link": "https://stackoverflow.com/users/2302260/edzhavoronkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1446955041, "creation_date": 1446950617, "question_id": 33590172, "link": "https://stackoverflow.com/questions/33590172/defining-custom-pragmas-in-haskell", "title": "Defining custom pragmas in haskell", "body": "<p>I am interested in possibility to define my own pragma in GHC. </p>\n\n<p>I suppose, that i should add it to lexer and parser. But what should i write into parser, to tell GHC how to handle my pragma?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1446930111, "post_id": 33587698, "comment_id": 54951512, "body": "<code>x</code> and <code>y</code> in <code>x :+: y</code> are <code>Expr a</code>s. You\u2019re going to have to actually implement the whole simplification thing, e.g. <code>Const a :+: Const b = Const (a + b)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 1, "creation_date": 1446930239, "post_id": 33587698, "comment_id": 54951556, "body": "You might want to start by implementing a function <code>evaluate :: Fractional a =&gt; Expr a -&gt; a</code>. (You&#39;re going to need <code>Fractional</code> for division, everything else is in <code>Num</code>.)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446930432, "post_id": 33587698, "comment_id": 54951625, "body": "You probably have to implement simplification using pattern matching <code>simp (x :*: (y :&#47;: x&#39;)) | x == x&#39; = y; simp ...</code> Simplifying this expression &quot;fully&quot; is fairly non-trivial so I don&#39;t know which simplifications exactly you are expected to perform."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1446939717, "post_id": 33587698, "comment_id": 54954310, "body": "Really, a full symbolic manipulation engine is very much not a simple thing to write. For a school project, I&#39;d suggest simplifying the type to only <code>:+:</code> and <code>:*:</code>. Then it&#39;s only polynomials (albethey of multiple variables) that you&#39;re dealing with, and polynomials can nicely be transformed to some standard form."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 3, "last_activity_date": 1446945511, "creation_date": 1446945511, "answer_id": 33589696, "question_id": 33587698, "link": "https://stackoverflow.com/questions/33587698/implementing-custom-operators/33589696#33589696", "title": "Implementing custom operators", "body": "<p>You are confusing two very different topics (if you pasted the error messages this might have surfaced sooner and gotten you better feedback).  Lets look at what was provided to you - the <code>Expr</code> data type and the classes.</p>\n\n<h1>A Classy Confusion</h1>\n\n<p>You were provided with:</p>\n\n<pre><code>data Expr a = Var Char\n         | Const a \n         | (Expr a) :+: (Expr a) \n         | (Expr a) :*: (Expr a)\n         | (Expr a) :^: (Expr a)\n         | (Expr a) :/: (Expr a)\n         deriving (Show, Eq)\n</code></pre>\n\n<p>Here we can see the constructors are basic arithmetic operations.  Stated another way, <code>:+:</code> is a constructor of type <code>Expr a -&gt; Expr a -&gt; Expr a</code> and similarly for the others.</p>\n\n<p>Now you go on to try and define a function, namely <code>:+:</code>:</p>\n\n<pre><code>class (Num a) =&gt; Expr a where\n    (:+:) :: a -&gt; a -&gt; a\n\ninstance Expr a where\n    x :+: y = x + y\n</code></pre>\n\n<p>There are a few problems here.</p>\n\n<ul>\n<li>You class <code>Expr</code> is merely named the same as the above type, it has no relation to the data defined above.</li>\n<li>Your method <code>:+:</code> is not a legal function name.  Functions, unlike data constructors, must be valid variables and thus can not start with upper case or colon characters.</li>\n<li>The instance is for all types - <code>a</code> is a variable and can match any type.  So you have yet to say the <code>x</code> and <code>y</code> values are of type <code>Expr a</code>.</li>\n</ul>\n\n<p>I think you were trying to make a class for each operator and make an instance for each constructor (<code>:+:</code>, :*:<code>, etc).  This is a broken, or at least overly verbose, solution. The only reason to use classes are if there are multiple type that require instances - you only have the one</code>Expr` type.</p>\n\n<h1>Classless</h1>\n\n<p>There is no need for type classes to solve this problem, instead you can evaluate an expression with a traditional function, much like in the deleted answer.</p>\n\n<p>The previously deleted answer appears to be deleted with the notion that and an environment of bindings for each variable is necessary.  My reading of the problem is different and I would simply evaluate the expression into a simple string.</p>\n\n<pre><code>evaluate :: Show a =&gt; Expr a -&gt; String\nevaluate (Var c) =  [c]\nevaluate (a :+: b) = undefined\nevaluate (a :*: b) ... so on and so forth ...\n</code></pre>\n\n<p>In the above you pattern match your <code>Expr a</code> to determine the operation then, on a case by case basis, evalute the sub-expressions as necessary before combining them in a manner dependent on the constructor (<code>+</code> with <code>:+:</code> etc).</p>\n"}, {"tags": [], "owner": {"reputation": 700, "user_id": 5175494, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152935585841389/picture?type=large", "display_name": "Miles P", "link": "https://stackoverflow.com/users/5175494/miles-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1447062376, "creation_date": 1447062376, "answer_id": 33606316, "question_id": 33587698, "link": "https://stackoverflow.com/questions/33587698/implementing-custom-operators/33606316#33606316", "title": "Implementing custom operators", "body": "<p>I was able to implement this project, I appreciate the help for getting me started in the right direction. I'll post my solution here in case anyone is interested. It may not be pretty but it works! </p>\n\n<p><code>completeCleanUp</code> with the help of <code>cleanUp</code> simplify an Expr. \n<code>plugIn</code> takes some <code>Char 'x'</code>, and replaces all <code>Var 'x'</code> with a number provided. Finally <code>evalExpr</code> returns a solution to the Expr.</p>\n\n<p>Note that variable simplification did not need to be implemented, thus <code>Const 9 :*: Var 'x' :+: Const 10 :*: Var 'x'</code> would not be further reduced.</p>\n\n<pre><code>cleanUp :: (Eq a, Floating a) =&gt; Expr a -&gt; Expr a\n\ncleanUp (Const a) = Const a\ncleanUp (Var a) = Var a\ncleanUp (Const a :*: (Const b :*: c)) = Const (a * b) :*: cleanUp c\ncleanUp (Const a :*: c :*: Const b) = Const (a*b) :*: cleanUp c\ncleanUp (c :*: Const a :*: Const b) = Const (a*b) :*: cleanUp c\ncleanUp (Const a :*: (b :+: c)) = (Const a :*: cleanUp b) :+: (Const a :*: cleanUp c)\ncleanUp (Const 0 :/: a) = Const 0\ncleanUp (a :/: Const 0) = error \"Error: Division by 0 not allowed.\"\ncleanUp (a :/: b) | a == b = Const 1.0\ncleanUp (a :^: Const 1) = cleanUp a\ncleanUp (Const 1 :^: a) = cleanUp a\ncleanUp (a :^: Const 0) = Const 1.0\ncleanUp (Const 0 :^: a) = Const 1.0\ncleanUp ((c :^: Const b) :^: Const a) =  cleanUp c :^: Const (a*b)\ncleanUp (Const a :^: Const b) = Const (a ** b)\ncleanUp (Const a :/: Const b) = Const (a / b)\ncleanUp (a :*: Const 1) = cleanUp a\ncleanUp (Const 1 :*: a) = cleanUp a\ncleanUp (a :*: Const 0) = Const 0\ncleanUp (Const 0 :*: a) = Const 0\ncleanUp (Const a :*: Const b) = Const (a * b)\ncleanUp (a :+: Const 0) = cleanUp a\ncleanUp (Const 0 :+: a) = cleanUp a\ncleanUp (Const a :+: Const b) = Const (a + b)\ncleanUp (Var a :^: b) = Var a :^: cleanUp b\ncleanUp (a :^: Var b) = cleanUp a :^: Var b\ncleanUp (Var a :+: b) = Var a :+: cleanUp b\ncleanUp (a :+: Var b) = cleanUp a :+: Var b\ncleanUp (Var a :*: b) = Var a :*: cleanUp b\ncleanUp (a :*: Var b) = cleanUp a :*: Var b\ncleanUp (Var a :/: b) = Var a :/: cleanUp b\ncleanUp (a :/: Var b) = cleanUp a :/: Var b\ncleanUp (a :^: b) = cleanUp a :^: cleanUp b\ncleanUp (a :/: b) = cleanUp a :/: cleanUp b\ncleanUp (a :*: b) = cleanUp a :*: cleanUp b\ncleanUp (a :+: b) = cleanUp a :+: cleanUp b\n\ncompleteCleanUp :: (Eq a, Floating a) =&gt; Expr a -&gt; Expr a\n\ncompleteCleanUp exp \n    | exp == cleanUp exp = exp\n    | otherwise = completeCleanUp (cleanUp exp)\n\n\nplugIn :: Char -&gt; a -&gt; Expr a -&gt; Expr a\n\nplugIn char num (Var c) | char == c = Const num\nplugIn char num (a :^: b) = plugIn char num a :^: plugIn char num b\nplugIn char num (a :/: b) = plugIn char num a :/: plugIn char num b\nplugIn char num (a :*: b) = plugIn char num a :*: plugIn char num b\nplugIn char num (a :+: b) = plugIn char num a :+: plugIn char num b\nplugIn char num a = a\n\n\nevalExpr :: (Eq a, Floating a) =&gt; Char -&gt; a -&gt; Expr a -&gt; a\n\nevalExpr char num exp = case (completeCleanUp . plugIn char num $ exp) of\n    (Const x) -&gt; x\n    _ -&gt; error \"Cannot further simplify solution.\"\n</code></pre>\n"}], "owner": {"reputation": 700, "user_id": 5175494, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152935585841389/picture?type=large", "display_name": "Miles P", "link": "https://stackoverflow.com/users/5175494/miles-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 33589696, "answer_count": 2, "score": 1, "last_activity_date": 1447062376, "creation_date": 1446929879, "last_edit_date": 1447038390, "question_id": 33587698, "link": "https://stackoverflow.com/questions/33587698/implementing-custom-operators", "title": "Implementing custom operators", "body": "<p>I have a school project where I need to simplify user generated mathematical expressions. We also need to define our own basic operators (<code>:+:</code> is addition, <code>:*:</code> is multiplication etc.).</p>\n\n<p>For example:</p>\n\n<pre><code>Prelude&gt; Const 9 :+: Const 3 :+: Const 2\nConst 14\nPrelude&gt; Const 14 :*: Var 'x' :+: Const 10 :*: Var 'x'    \nConst 24 :*: Var 'x'\n</code></pre>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>infixl 4 :+:\ninfixl 5 :*:, :/:\ninfixr 6 :^:\n\ndata Expr a = Var Char\n         | Const a \n         | (Expr a) :+: (Expr a) \n         | (Expr a) :*: (Expr a)\n         | (Expr a) :^: (Expr a)\n         | (Expr a) :/: (Expr a)\n         deriving (Show, Eq)\n</code></pre>\n\n<p>I have tried something like this for my addition operator without success:</p>\n\n<pre><code>class (Num a) =&gt; Expr a where\n    (:+:) :: a -&gt; a -&gt; a\n\ninstance Expr a where\n    x :+: y = x + y\n</code></pre>\n\n<p>All that I'm looking for is some guidance on how to get this started. I'm comfortable with creating my own functions, and using common functions (<code>map</code>, <code>zip</code>, <code>foldr</code> etc.). We recently started learning type classes, functors, and a brief intro on monads. </p>\n"}, {"tags": ["haskell", "notifications", "dbus"], "comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1446938566, "post_id": 33587693, "comment_id": 54954048, "body": "Could you provide links to the libraries in question."}], "owner": {"reputation": 401, "user_id": 4868124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86dc340359160250de50ea4860cb9931?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Chav", "link": "https://stackoverflow.com/users/4868124/michael-chav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1446944382, "creation_date": 1446929841, "last_edit_date": 1592644375, "question_id": 33587693, "link": "https://stackoverflow.com/questions/33587693/run-a-function-as-the-action-for-a-dbus-notification-in-haskell", "title": "Run a function as the Action for a DBus notification in Haskell", "body": "<p>I'm trying to make an application that scrapes news headlines from the BBC News site, send a notification out to the users desktop when the files have been retrieved and then gives the user the option to open a window showing the titles of articles and their links. Everything is fine except the last part - I can't get fdo-notify to run an action. I'm not really sure what the syntax would be but this is what I have:</p>\n<pre><code>broadCastHeadlines = do\n         client &lt;- connectSession\n         let startNote = Note { appName = &quot;BBC News Headlines&quot; , appImage = Nothing ,\n                                summary=&quot;BBC News Headlines&quot;, actions = [], hints = [],\n                                body=(Just $ Text &quot;Latest Headlines&quot;),\n                                expiry = Never}\n         notification &lt;- notify client startNote\n         headlines &lt;- readHeadlinesFromFile\n         --let headlines' = unlines $ map show headlines\n         let endNote = Note { appName = &quot;BBC News Headlines&quot; , appImage = Nothing ,\n                                summary=&quot;BBC News Headlines&quot;, actions = [(Action {actionName = &quot;UI.main&quot;}, &quot;Open&quot;)], hints = [],\n                                body=(Just $ Text ((getTitle $ head headlines) ++ &quot; and &quot; ++ (show $ length headlines) ++ &quot; more stories.&quot;)), expiry = Never}\n         headlines `seq` replace client notification endNote\n</code></pre>\n<p>How do I get the Action to run UI.main?</p>\n<h2>Update</h2>\n<p>This is the link to the library repository: <a href=\"http://bitbucket.org/taejo/fdo-notify/\" rel=\"nofollow noreferrer\">http://bitbucket.org/taejo/fdo-notify/</a></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "edited": false, "score": 1, "creation_date": 1446929843, "post_id": 33587614, "comment_id": 54951430, "body": "also, take a look at <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html#v:zip\" rel=\"nofollow noreferrer\"><code>zip</code></a> - you can do: <code>areTwoApart (x,y) = x - y == 2</code> and something like <code>filter areTwoApart (zip allprimes (tail allprimes))</code> to get a bit closer to what you want."}, {"owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "edited": false, "score": 0, "creation_date": 1446930207, "post_id": 33587614, "comment_id": 54951545, "body": "Sorry, in my last comment it should be <code>y - x</code> not the other way around."}], "answers": [{"tags": [], "owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "is_accepted": false, "score": 2, "last_activity_date": 1446930441, "creation_date": 1446930441, "answer_id": 33587791, "question_id": 33587614, "link": "https://stackoverflow.com/questions/33587614/how-to-compute-prime-twins-between-two-bounds/33587791#33587791", "title": "How to compute prime twins between two bounds?", "body": "<p>To organize what I wrote in the comment:</p>\n\n<pre><code>areTwoApart (x,y) = y - x == 2\nfilter areTwoApart (zip allprimes (tail allprimes))\n</code></pre>\n\n<p>...will give you the list of prime pairs, without duplicates:</p>\n\n<pre><code>Prelude&gt; take 10 $ filter areTwoApart (zip allprimes (tail allprimes))\n[(3,5),(5,7),(11,13),(17,19),(29,31),(41,43),(59,61),(71,73),(101,103),(107,109)]\n</code></pre>\n\n<p>As for your final question \"how many twin primes there are between a certain number without duplicates\", I'm not sure what you mean by \"between\". But you can probably use the function above to get to it.</p>\n"}], "owner": {"reputation": 21, "user_id": 5537607, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/eea7ca52677961cbbcaf696e0eb339a8?s=128&d=identicon&r=PG&f=1", "display_name": "Jane Doe", "link": "https://stackoverflow.com/users/5537607/jane-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 942, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1446930553, "creation_date": 1446929284, "last_edit_date": 1446929499, "question_id": 33587614, "link": "https://stackoverflow.com/questions/33587614/how-to-compute-prime-twins-between-two-bounds", "title": "How to compute prime twins between two bounds?", "body": "<p>I'm trying to compute the first 20 primes that have a 2 number gap between them - E.G 3 and 5.</p>\n\n<pre><code>divides :: Integer -&gt; Integer -&gt; Bool \ndivides x y = y `mod` x == 0\n\nprime :: Integer -&gt; Bool\nprime n = n &gt; 1 &amp;&amp; and [not(divides x n) | x &lt;- [2..(n-1)]]\n\nallprimes :: [Integer]\nallprimes = [x | x&lt;- [2..], prime x]\n\nprimeTest3 :: Integer -&gt; [Integer] \nprimeTest3 n = [ if y - x == 2 then y  else x | x &lt;- [3..n], y &lt;- [2..n],  prime x]\n</code></pre>\n\n<p>This works to a certain point, the if <code>n = 20</code>, then the output is <code>3, 5, ,5, 5, 5, 5, 7, 7, 7, 7, 7, 9, 7, 7, 7, 7, 9, 9, 9..</code> Etc. This is obviously due to the if else statement. How can I get it to print out how many twin primes there are between a certain number without duplicates?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 20, "creation_date": 1446924315, "post_id": 33586720, "comment_id": 54949670, "body": "There is a key difference between Java and Haskell that you are missing. In Java, the type information is <i>not lost</i> when upcasting, so you can downcast again and do other useful non-<code>String</code>y things later (conditioned on choosing the right type to downcast to). In Haskell, once you&#39;ve upcast, the type information is <i>lost</i> and you cannot downcast again. So you might as well just have a list of <code>String</code>s. See also <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Dynamic.html\" rel=\"nofollow noreferrer\"><code>Dynamic</code></a>, which offers a richer interface than &quot;just <code>String</code>&quot;."}, {"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1446924633, "post_id": 33586720, "comment_id": 54949775, "body": "@DanielWagner not really sure how downcasting is connected with the topic. I need only upcast. Yes I can turn this into list of <code>String</code>s as mentioned in the answer by @ErikR but the question more about readability: repetetive <code>show</code>s doesn&#39;t look good for me."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1446925090, "post_id": 33586720, "comment_id": 54949913, "body": "It is not always easy to tell whether downcasting is connected to the topic at hand or not -- people often include it in their assumptions so hard they forget to mention it. (This is not the first time this topic has come up, neither here nor on IRC. ;-) As for &quot;it doesn&#39;t look good to me&quot;, well, there&#39;s no accounting for taste. If you can give an objective, technical complaint we may be able to talk about the extent to which it can be addressed."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 30, "creation_date": 1446925606, "post_id": 33586720, "comment_id": 54950065, "body": "I don&#39;t like the title of this question very much. It purports a conflict between languages/paradigms, possibly calling people on one side to fight in a language war."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 9, "creation_date": 1446925753, "post_id": 33586720, "comment_id": 54950107, "body": "This is a known antipattern, also discussed in <a href=\"https://lukepalmer.wordpress.com/2010/01/24/haskell-antipattern-existential-typeclass/\" rel=\"nofollow noreferrer\">Luke Palmer&#39;s blog</a>. While I do not completely agree with the whole blog post, I believe the basic point he makes is solid."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1446928947, "post_id": 33586720, "comment_id": 54951162, "body": "@ArtemPelenitsyn You say that the real problem is more about how to store things which share the same type class which can have more than one method. Give us an example. We can&#39;t give you an accurate answer until you give us an accurate question."}, {"owner": {"reputation": 12054, "user_id": 3614835, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/xzZDV.png?s=128&g=1", "display_name": "Jeffrey Bosboom", "link": "https://stackoverflow.com/users/3614835/jeffrey-bosboom"}, "edited": false, "score": 11, "creation_date": 1446931453, "post_id": 33586720, "comment_id": 54951969, "body": "From the Hot Network Questions-optimized title, I arrived ready to vote to close as opinion-based.  I was pleasantly surprised by the question&#39;s quality, but once your 15 minutes of HNQ are over, try changing the title to something less likely to attract bad answers."}, {"owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "edited": false, "score": 1, "creation_date": 1446933067, "post_id": 33586720, "comment_id": 54952434, "body": "Can this generally work? E.g. for the <code>Eq</code> instance, wouldn&#39;t you have to enable comparison of different types - which should be type-wise impossible?"}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 1, "creation_date": 1503091413, "post_id": 33586720, "comment_id": 78489026, "body": "For what it&#39;s worth, your second attempt (with impredicative types) is not the same as the first and is definitely not what you want.  A <code>[forall a. Show a =&gt; a]</code> is a list of inhabitants of <code>forall a. Show a =&gt; a</code>.  There is only one inhabitant of this type -- bottom.  There is no other possible value that can become <i>any</i> <code>Show</code> that the caller asks for.  No Int can inhabit that type, no String...nothing.  It&#39;s literally the opposite of what you originally wanted.  You probably wanted <code>[exists a. Show a =&gt; a]</code>, or, skolemized, <code>[(forall a. Show a =&gt; a -&gt; r) -&gt; r]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 0, "creation_date": 1446924389, "post_id": 33586782, "comment_id": 54949698, "body": "This is an option, thank&#39;s! Still this resembles the problem mentioned in first approach: weird repetition which looks like (up)casting. Examples in my post are hugely simplified: in real application I get showable things from different algorithms and I prefer not to mix them with show."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1446925024, "post_id": 33586782, "comment_id": 54949889, "body": "You&#39;d need to gather them into list anyway and then you can <code>map show</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 12, "creation_date": 1446925134, "post_id": 33586782, "comment_id": 54949933, "body": "@arrowd That&#39;s not well-typed: you can&#39;t gather them into a list before applying <code>show</code>, which is essentially what the body of the question as asked is complaining about."}, {"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 1, "creation_date": 1446925535, "post_id": 33586782, "comment_id": 54950047, "body": "I see I chose bad example for the post. Consider the case of type class which (unlike <code>Show</code>) have more than one method. This solution besides its unpleasant form (hand-written map is not cool) will not work for this."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 6, "creation_date": 1446926205, "post_id": 33586782, "comment_id": 54950248, "body": "How about coming up with a concrete example in Java that you want translated into Haskell. That would help direct this discussion."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 3, "creation_date": 1446928169, "post_id": 33586782, "comment_id": 54950892, "body": "@ArtemPelenitsyn When there are several methods, one may represent those methods in a custom data type with one field per method."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1446928347, "post_id": 33586782, "comment_id": 54950939, "body": "@arrowd you can handle multiple methods by wrapping each value in a record containing a field per method. This way, you just need one wrapper by type <code>a -&gt; WrappedRecord</code>."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1446928357, "post_id": 33586782, "comment_id": 54950944, "body": "Why didn&#39;t anyone think of <a href=\"http://stackoverflow.com/a/7828634/783743\">variadic argument functions</a> for this problem? It&#39;s the perfect solution. See my answer for more details: <a href=\"http://stackoverflow.com/a/33587266/783743\">stackoverflow.com/a/33587266/783743</a>"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1458442741, "post_id": 33586782, "comment_id": 59861437, "body": "@DanielWagner one thing to add to that (you probably already know this but for someone less familiar with Haskell that is reading) is that doing so does NOT cause any performance decrease even if you choose to only use some of the methods, or some on certain parts of the list and other on other parts of the list, due to really powerful lazy evaluation."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 38, "last_activity_date": 1446923991, "creation_date": 1446923991, "answer_id": 33586782, "question_id": 33586720, "link": "https://stackoverflow.com/questions/33586720/list-of-showables-oop-style-in-haskell/33586782#33586782", "title": "List of showables OOP-style in Haskell?", "body": "<p>Since evaluation is lazy in Haskell, how about just creating a list of the actual strings?</p>\n\n<pre><code>showables = [ show 1, show \"blah\", show 3.14 ]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446928932, "post_id": 33587266, "comment_id": 54951155, "body": "Would it be possible to rearrange things to avoid the runtime <code>reverse</code>? Maybe some type indexing trick?"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1446929218, "post_id": 33587266, "comment_id": 54951240, "body": "@dfeuer You can use a difference list instead of a string. Hence, <code>showList&#39; :: ShowList a =&gt; DiffList String -&gt; a</code>. I&#39;ll update my answer."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1446931526, "post_id": 33587266, "comment_id": 54951996, "body": "@dfeuer Awww. Thanks for the edit. Now my code has a smiley. :)"}], "tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": false, "score": 8, "last_activity_date": 1446931304, "last_edit_date": 1495541899, "creation_date": 1446927157, "answer_id": 33587266, "question_id": 33586720, "link": "https://stackoverflow.com/questions/33586720/list-of-showables-oop-style-in-haskell/33587266#33587266", "title": "List of showables OOP-style in Haskell?", "body": "<p>I would do something like this:</p>\n\n<pre><code>newtype Strings = Strings { getStrings :: [String] }\n\nnewtype DiffList a = DiffList { getDiffList :: [a] -&gt; [a] }\n\ninstance Monoid (DiffList a) where\n    mempty                          = DiffList id\n    DiffList f `mappend` DiffList g = DiffList (f . g)\n\nclass ShowList a where\n    showList' :: DiffList String -&gt; a\n\ninstance ShowList Strings where\n    showList' (DiffList xs) = Strings (xs [])\n\ninstance (Show a, ShowList b) =&gt; ShowList (a -&gt; b) where\n    showList' xs x = showList' $ xs `mappend` DiffList (show x :)\n\nshowList = showList' mempty\n</code></pre>\n\n<p>Now, you can create a <code>ShowList</code> as follows:</p>\n\n<pre><code>myShowList = showList 1 \"blah\" 3.14\n</code></pre>\n\n<p>You can get back a list of strings using <code>getStrings</code> as follows:</p>\n\n<pre><code>myStrings = getStrings myShowList\n</code></pre>\n\n<p>Here's what's happening:</p>\n\n<ol>\n<li><p>A value of the type <code>ShowList a =&gt; a</code> could be:</p>\n\n<ol>\n<li>Either a list of strings wrapped in a <code>Strings</code> newtype wrapper.</li>\n<li>Or a function from an instance of <code>Show</code> to an instance of <code>ShowList</code>.</li>\n</ol></li>\n<li><p>This means that the function <code>showList</code> is a variadic argument function which takes an arbitrary number of printable values and eventually returns a list of strings wrapped in a <code>Strings</code> newtype wrapper.</p></li>\n<li><p>You can eventually call <code>getStrings</code> on a value of the type <code>ShowList a =&gt; a</code> to get the final result. In addition, you don't need to do any explicit type coercion yourself.</p></li>\n</ol>\n\n<p>Advantages:</p>\n\n<ol>\n<li>You can add new elements to your list whenever you want.</li>\n<li>The syntax is succinct. You don't have to manually add <code>show</code> in front of every element.</li>\n<li>It doesn't make use of any language extensions. Hence, it works in Haskell 98 too.</li>\n<li>You get the best of both worlds, type safety and a great syntax.</li>\n<li>Using difference lists, you can construct the result in linear time.</li>\n</ol>\n\n<p>For more information on functions with variadic arguments, read the answer to the following question:</p>\n\n<p><a href=\"https://stackoverflow.com/q/7828072/783743\">How does Haskell printf work?</a></p>\n"}, {"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 11, "last_activity_date": 1446929502, "creation_date": 1446929502, "answer_id": 33587644, "question_id": 33586720, "link": "https://stackoverflow.com/questions/33586720/list-of-showables-oop-style-in-haskell/33587644#33587644", "title": "List of showables OOP-style in Haskell?", "body": "<p>If you really, really want, you can use a heterogeneous list. This approach really isn't useful for Show, because it has a single method and all you can do is apply it, but if your class has multiple methods this could be useful.</p>\n\n<pre><code>{-# LANGUAGE PolyKinds, KindSignatures, GADTs, TypeFamilies\n   , TypeOperators, DataKinds, ConstraintKinds, RankNTypes, PatternSynonyms  #-} \n\nimport Data.List (intercalate)\nimport GHC.Prim (Constraint)\n\ninfixr 5 :&amp;\ndata HList xs where \n  None :: HList '[] \n  (:&amp;) :: a -&gt; HList bs -&gt; HList (a ': bs) \n\n-- | Constraint All c xs holds if c holds for all x in xs\ntype family All (c :: k -&gt; Constraint) xs :: Constraint where \n  All c '[] = () \n  All c (x ': xs) = (c x, All c xs) \n\n-- | The list whose element types are unknown, but known to satisfy\n--   a class predicate. \ndata CList c where CL :: All c xs =&gt; HList xs -&gt; CList c  \n\ncons :: c a =&gt; a -&gt; CList c -&gt; CList c\ncons a (CL xs) = CL (a :&amp; xs) \n\nempty :: CList c \nempty = CL None \n\nuncons :: (forall a . c a =&gt; a -&gt; CList c -&gt; r) -&gt; r -&gt; CList c -&gt; r \nuncons _ n (CL None) = n \nuncons c n (CL (x :&amp; xs)) = c x (CL xs) \n\nfoldrC :: (forall a . c a =&gt; a -&gt; r -&gt; r) -&gt; r -&gt; CList c -&gt; r \nfoldrC f z = go where go = uncons (\\x -&gt; f x . go) z \n\nshowAll :: CList Show -&gt; String \nshowAll l = \"[\" ++ intercalate \",\" (foldrC (\\x xs -&gt; show x : xs) [] l) ++ \"]\" \n\ntest = putStrLn $ showAll $ CL $ \n  1 :&amp; \n  'a' :&amp; \n  \"foo\" :&amp; \n  [2.3, 2.5 .. 3] :&amp; \n  None \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 1, "creation_date": 1447002442, "post_id": 33587837, "comment_id": 54968262, "body": "Nice! I like your answer best of all, but would you explain, how to generalize this solution to list of functions like [Int -&gt; Showable]?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 1, "creation_date": 1447033756, "post_id": 33587837, "comment_id": 54978085, "body": "@ArtemPelenitsyn I added a way to do that to my answer"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 1, "creation_date": 1447034328, "post_id": 33587837, "comment_id": 54978213, "body": "@ArtemPelenitsyn I have to say, I&#39;m a bit curious what your particular application of this is. Even though I&#39;ve spent some time getting this kinda stuff to work in the past, I&#39;ve never really used it for anything and I&#39;ve always wondered if there are practical applications for it."}, {"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 0, "creation_date": 1447057082, "post_id": 33587837, "comment_id": 54984471, "body": "initial purpose was to develop a small demonstration framework to show students how various auto-deriving mechanisms work in Haskell. Take e.g. <code>DerivingFoldable</code> and <code>DerivingFunctor</code>. I want to make a list of simple algorithms that we get for free from these, like <code>sum</code> and <code>fmap</code>. But the problem is that the algorithms return values of different types. For the purpose of demonstration I need those values to be showable. If I add GUI to this app, I probably would like them to share some other GUI-awared class."}], "tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": true, "score": 18, "last_activity_date": 1447042092, "last_edit_date": 1447042092, "creation_date": 1446930800, "answer_id": 33587837, "question_id": 33586720, "link": "https://stackoverflow.com/questions/33586720/list-of-showables-oop-style-in-haskell/33587837#33587837", "title": "List of showables OOP-style in Haskell?", "body": "<p>The <code>HList</code>-style solutions would work, but it is possible to reduce the complexity if you only need to work with lists of constrained existentials and you don't need the other <code>HList</code> machinery.</p>\n\n<p>Here's how I handle this in my <a href=\"https://github.com/roboguy13/existentialist/\" rel=\"noreferrer\"><code>existentialist</code> package</a>:</p>\n\n<pre><code>{-# LANGUAGE ConstraintKinds, ExistentialQuantification, RankNTypes #-}\n\ndata ConstrList c = forall a. c a =&gt; a :&gt; ConstrList c\n                  | Nil\ninfixr :&gt;\n\nconstrMap :: (forall a. c a =&gt; a -&gt; b) -&gt; ConstrList c -&gt; [b]\nconstrMap f (x :&gt; xs) = f x : constrMap f xs\nconstrMap f Nil       = []\n</code></pre>\n\n<p>This can then be used like this:</p>\n\n<pre><code>example :: [String]\nexample\n  = constrMap show\n              (( 'a'\n              :&gt; True\n              :&gt; ()\n              :&gt; Nil) :: ConstrList Show)\n</code></pre>\n\n<p>It could be useful if you have a large list or possibly if you have to do lots of manipulations to a list of constrained existentials.</p>\n\n<p>Using this approach, you also don't need to encode the length of the list in the type (or the original types of the elements). This could be a good thing or a bad thing depending on the situation. If you want to preserve the all of original type information, an <code>HList</code> is probably the way to go.</p>\n\n<p>Also, if (as is the case of <code>Show</code>) there is only one class method, the approach I would recommend would be applying that method to each item in the list directly as in ErikR's answer or the first technique in phadej's answer.</p>\n\n<p>It sounds like the actual problem is more complex than just a list of <code>Show</code>-able values, so it is hard to give a definite recommendation of which of these specifically is the most appropriate without more concrete information.</p>\n\n<p>One of these methods would probably work out well though (unless the architecture of the code itself could be simplified so that it doesn't run into the problem in the first place).</p>\n\n<h2>Generalizing to existentials contained in higher-kinded types</h2>\n\n<p>This can be generalized to higher kinds like this:</p>\n\n<pre><code>data AnyList c f = forall a. c a =&gt; f a :| (AnyList c f)\n                 | Nil\ninfixr :|\n\nanyMap :: (forall a. c a =&gt; f a -&gt; b) -&gt; AnyList c f -&gt; [b]\nanyMap g (x :| xs) = g x : anyMap g xs\nanyMap g Nil       = []\n</code></pre>\n\n<p>Using this, we can (for example) create a list of functions that have <code>Show</code>-able result types.</p>\n\n<pre><code>example2 :: Int -&gt; [String]\nexample2 x = anyMap (\\m -&gt; show (m x))\n                    (( f\n                    :| g\n                    :| h\n                    :| Nil) :: AnyList Show ((-&gt;) Int))\n  where\n    f :: Int -&gt; String\n    f = show\n\n    g :: Int -&gt; Bool\n    g = (&lt; 3)\n\n    h :: Int -&gt; ()\n    h _ = ()\n</code></pre>\n\n<p>We can see that this is a true generalization by defining:</p>\n\n<pre><code>type ConstrList c = AnyList c Identity\n\n(&gt;:) :: forall c a. c a =&gt; a -&gt; AnyList c Identity -&gt; AnyList c Identity\nx &gt;: xs  = Identity x :| xs\ninfixr &gt;:\n\nconstrMap :: (forall a. c a =&gt; a -&gt; b) -&gt; AnyList c Identity -&gt; [b]\nconstrMap f (Identity x :| xs) = f x : constrMap f xs\nconstrMap f Nil                = []\n</code></pre>\n\n<p>This allows the original <code>example</code> from the first part of this to work using this new, more general, formulation with no changes to the existing <code>example</code> code except changing <code>:&gt;</code> to <code>&gt;:</code> (even this small change might be able to be avoided with pattern synonyms. I'm not totally sure though since I haven't tried and sometimes pattern synonyms interact with existential quantification in ways that I don't fully understand).</p>\n"}, {"tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": false, "score": 9, "last_activity_date": 1446931475, "last_edit_date": 1446931475, "creation_date": 1446931067, "answer_id": 33587879, "question_id": 33586720, "link": "https://stackoverflow.com/questions/33586720/list-of-showables-oop-style-in-haskell/33587879#33587879", "title": "List of showables OOP-style in Haskell?", "body": "<p>You can create your own operator to reduce syntax noise:</p>\n\n<pre><code>infixr 5 &lt;:\n\n(&lt;:) :: Show a =&gt; a -&gt; [String] -&gt; [String]\nx &lt;: l = show x : l\n</code></pre>\n\n<p>So you can do:</p>\n\n<pre><code>\u03bb &gt; (1 :: Int) &lt;: True &lt;: \"abs\" &lt;: []\n[\"1\",\"True\",\"\\\"abs\\\"\"]\n</code></pre>\n\n<p>This is not <code>[1 :: Int, True, \"abs\"]</code> but not much longer. </p>\n\n<p>Unfortunately you cannot rebind <code>[...]</code> syntax with <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/syntax-extns.html#rebindable-syntax\" rel=\"noreferrer\"><code>RebindableSyntax</code></a>.</p>\n\n<hr>\n\n<p>Another approach is to use <code>HList</code> and preserve <strong>all</strong> type information, i.e. no downcasts, no upcasts:</p>\n\n<pre><code>{-# LANGUAGE ConstraintKinds       #-}\n{-# LANGUAGE DataKinds             #-}\n{-# LANGUAGE GADTs                 #-}\n{-# LANGUAGE PolyKinds             #-}\n{-# LANGUAGE TypeFamilies          #-}\n{-# LANGUAGE TypeOperators         #-}\n{-# LANGUAGE UndecidableInstances  #-}\n\nimport GHC.Exts (Constraint)\n\ninfixr 5 :::\n\ntype family All (c :: k -&gt; Constraint) (xs :: [k]) :: Constraint where\n  All c '[]       = ()\n  All c (x ': xs) = (c x, All c xs)\n\ndata HList as where\n  HNil :: HList '[]\n  (:::) :: a -&gt; HList as -&gt; HList (a ': as)\n\ninstance All Show as =&gt; Show (HList as) where\n  showsPrec d HNil       = showString \"HNil\"\n  showsPrec d (x ::: xs) = showParen (d &gt; 5) (showsPrec 5 x)\n                         . showString \" ::: \"\n                         . showParen (d &gt; 5) (showsPrec 5 xs)\n</code></pre>\n\n<p>And after all that:</p>\n\n<pre><code>\u03bb *Main &gt; (1 :: Int) ::: True ::: \"foo\" ::: HNil\n1 ::: True ::: \"foo\" ::: HNil\n\n\u03bb *Main &gt; :t (1 :: Int) ::: True ::: \"foo\" ::: HNil\n(1 :: Int) ::: True ::: \"foo\" ::: HNil\n  :: HList '[Int, Bool, [Char]]\n</code></pre>\n\n<p>There are various ways to encode <em>heterogenous list</em>, in <a href=\"http://hackage.haskell.org/package/HList\" rel=\"noreferrer\"><code>HList</code></a> is one, there is also <a href=\"http://hackage.haskell.org/package/generics-sop\" rel=\"noreferrer\"><code>generics-sop</code></a> with <code>NP I xs</code>. It depends on what you are trying to achieve in the larger context, if this is this preserve-all-the-types approach is what you need.</p>\n"}, {"comments": [{"owner": {"reputation": 160, "user_id": 5539934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f988622fe10024b8d52cc99a3bab343a?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaum", "link": "https://stackoverflow.com/users/5539934/guillaum"}, "edited": false, "score": 1, "creation_date": 1447007872, "post_id": 33597476, "comment_id": 54970166, "body": "This approach is still convoluted for list creation. From my point of view it is only a problem with toy examples, where your list is short and hand written, but I don&#39;t think it is a problem in production code where you list comes from different function call."}], "tags": [], "owner": {"reputation": 160, "user_id": 5539934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f988622fe10024b8d52cc99a3bab343a?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaum", "link": "https://stackoverflow.com/users/5539934/guillaum"}, "is_accepted": false, "score": 3, "last_activity_date": 1447007430, "creation_date": 1447007430, "answer_id": 33597476, "question_id": 33586720, "link": "https://stackoverflow.com/questions/33586720/list-of-showables-oop-style-in-haskell/33597476#33597476", "title": "List of showables OOP-style in Haskell?", "body": "<p>You can store partially applied functions in the list.</p>\n\n<p>Suppose we are building a ray-tracer with different shape that you can intersect.</p>\n\n<pre><code>data Sphere = ...\ndata Triangle = ...\n\ndata Ray = ...\ndata IntersectionResult = ...\n\nclass Intersect t where\n      intersect :: t -&gt; Ray -&gt; Maybe IntersectionResult\n\ninstance Intersect Sphere where ...\ninstance Intersect Triangle where ...\n</code></pre>\n\n<p>Now, we can partially apply the <code>intersect</code> to get a list of <code>Ray -&gt; Maybe IntersectionResult</code> such as:</p>\n\n<pre><code>myList :: [(Ray -&gt; Maybe IntersectionResult)]\nmyList = [intersect sphere, intersect triangle, ...]\n</code></pre>\n\n<p>Now, if you want to get all the intersections, you can write:</p>\n\n<pre><code>map ($ ray) myList -- or map (\\f -&gt; f ray) myList\n</code></pre>\n\n<p>This can be extended a bit to handle an interface with multiples functions, for example, if you want to be able to get something of a shape :</p>\n\n<pre><code>class ShapeWithSomething t where\n        getSomething :: t -&gt; OtherParam -&gt; Float\n\ndata ShapeIntersectAndSomething = ShapeIntersectAndSomething {\n          intersect :: Ray -&gt; Maybe IntersectionResult,\n          getSomething :: OtherParam -&gt; Float}\n</code></pre>\n\n<p>Something I don't know is the overhead of this approach. We need to store the pointer to the function and the pointer to the shape and this for each function of the interface, which is a lot compared to the shared vtable usually used in OO language. I don't have any idea if GHC is able to optimize this.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 6, "last_activity_date": 1447897262, "last_edit_date": 1447897262, "creation_date": 1447120536, "answer_id": 33621574, "question_id": 33586720, "link": "https://stackoverflow.com/questions/33586720/list-of-showables-oop-style-in-haskell/33621574#33621574", "title": "List of showables OOP-style in Haskell?", "body": "<p>My answer is fundamentally the same as ErikR's: the type that best embodies your requirements is <code>[String]</code>.  But I'll go a bit more into the logic that I believe justifies this answer.  The key is in this quote from the question:</p>\n\n<blockquote>\n  <p>[...] things which have one property in common, namely, they could be turned into string.</p>\n</blockquote>\n\n<p>Let's call this type <code>Stringable</code>.  But now the key observation is this:</p>\n\n<ul>\n<li><code>Stringable</code> is <a href=\"https://en.wikipedia.org/wiki/Isomorphism\" rel=\"nofollow\"><strong>isomorphic</strong></a> to <code>String</code>!</li>\n</ul>\n\n<p>That is, if your statement above is the <em>whole</em> specification of the <code>Stringable</code> type, then there is a pair functions with these signatures:</p>\n\n<pre><code>toString :: Stringable -&gt; String\ntoStringable :: String -&gt; Stringable\n</code></pre>\n\n<p>...such that the two functions are inverses.  When two types are isomorphic, any program that uses either of the types can be rewritten in terms of the other without any change to its semantics.  So <code>Stringable</code> doesn't let you do anything that <code>String</code> doesn't let you do already!</p>\n\n<p>In more concrete terms, the point is that this refactoring is guaranteed to work no matter what: </p>\n\n<ol>\n<li>At every point in your program where you turn an object into a <code>Stringable</code> and stick that into a <code>[Stringable]</code>, turn the object into a <code>String</code> and stick that into a <code>[String]</code>.</li>\n<li>At every point in your program that you consume a <code>Stringable</code> by applying <code>toString</code> to it, you can now eliminate the call to <code>toString</code>. </li>\n</ol>\n\n<p>Note that this argument generalizes to types more complex than <code>Stringable</code>, with many \"methods\".  So for example, the type of \"things that you can turn into either a <code>String</code> or an <code>Int</code>\" is isomorphic to <code>(String, Int)</code>.  The type of \"things that you can either turn into a <code>String</code> or combine them with a <code>Foo</code> to produce a <code>Bar</code>\" is isomorphic to <code>(String, Foo -&gt; Bar)</code>.  And so on.  Basically, this logic leads to the \"record of methods\" encoding that other answers have brought up.</p>\n\n<p>I think the lesson to draw from this is the following: <strong>you need a specification <em>richer</em> than just \"can be turned into a string\" in order to justify using any of the mechanisms you brought up.</strong>  So for example, if we add the requirement that <code>Stringable</code> values can be <strong>downcast</strong> to the original type, an existential type now perhaps becomes justifiable:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\nimport Data.Typeable\n\ndata Showable = Showable\n    Showable :: (Show a, Typeable a) =&gt; a -&gt; Stringable\n\ndowncast :: Typeable a =&gt; Showable -&gt; Maybe a\ndowncast (Showable a) = cast a\n</code></pre>\n\n<p>This <code>Showable</code> type is not isomorphic to <code>String</code>, because the <code>Typeable</code> constraint allows us to implement the <code>downcast</code> function that allows us to distinguish between different <code>Showable</code>s that produce the same string.  <a href=\"https://gist.github.com/sacundim/8511f98d6173d8d46533\" rel=\"nofollow\">A richer version of this idea can be seen in this \"shape example\" Gist.</a></p>\n"}, {"tags": [], "owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "is_accepted": false, "score": 3, "last_activity_date": 1458618800, "last_edit_date": 1458618800, "creation_date": 1458617824, "answer_id": 36145682, "question_id": 33586720, "link": "https://stackoverflow.com/questions/33586720/list-of-showables-oop-style-in-haskell/36145682#36145682", "title": "List of showables OOP-style in Haskell?", "body": "<p>The core of the problem is : you want to dispatch (read select which function to call) at runtime, depending on what the \"type\" of the object is. In Haskell this can be achieved by wrapping the data into a sum data type (which is called here <code>ShowableInterface</code>):</p>\n\n<pre><code>data ShowableInterface = ShowInt Int | ShowApple Apple | ShowBusiness Business\n\ninstance Show ShowableInterface where\n   show (ShowInt i)      = show i\n   show (ShowApple a)    = show a\n   show (ShowBusiness b) = show b  \n\nlist=[ShowInt 2, ShowApple CrunchyGold, ShowBusiness MoulinRouge]\n\nshow list\n</code></pre>\n\n<p>would correspond to something like this in Java :</p>\n\n<pre><code>class Int implements ShowableInterface\n{\n   public show {return Integer.asString(i)};\n}\nclass Apple implements ShowableInterface\n{\n   public show {return this.name};\n}\nclass ShowBusiness implements ShowableInterface\n{\n   public show {return this.fancyName};\n}\n\nList list = new ArrayList (new Apple(\"CrunchyGold\"), \n                           new ShowBusiness(\"MoulingRouge\"), new Integer(2));\n</code></pre>\n\n<p>so in Haskell you need to explicitly wrap stuff into the <code>ShowableInterface</code>, in Java this wrapping is done implicitly on object creation.</p>\n\n<p>credit goes to #haskell IRC for explaining this to me a year ago, or so.</p>\n"}], "owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3374, "favorite_count": 10, "accepted_answer_id": 33587837, "answer_count": 8, "score": 41, "last_activity_date": 1612296930, "creation_date": 1446923586, "last_edit_date": 1612296930, "question_id": 33586720, "link": "https://stackoverflow.com/questions/33586720/list-of-showables-oop-style-in-haskell", "title": "List of showables OOP-style in Haskell?", "body": "<p>I want to build a list of different things which have one property in common, namely, they could be turned into string. The object-oriented approach is straightforward: define interface <code>Showable</code> and make classes of interest implement it. Second point can in principle be a problem when you can't alter the classes, but let's pretend this is not the case. Then you create a list of <code>Showable</code>s and fill it with objects of these classes without any additional noise (e.g. upcasting is usually done implicitly). Proof of concept in Java <a href=\"https://ideone.com/ogyJVe\" rel=\"nofollow noreferrer\">is given here</a>.</p>\n\n<p>My question is what options for this do I have in Haskell? Below I discuss approaches that I've tried and which don't really satisfy me.</p>\n\n<p><strong>Approach 1</strong>: existensials. Works but ugly.</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\ndata Showable = forall a. Show a =&gt; Sh a\n\naList :: [Showable]\naList = [Sh (1 :: Int), Sh \"abc\"]\n</code></pre>\n\n<p>The main drawback for me here is the necessity for <code>Sh</code> when filling the list. This closely resembles upcast operations which are implicitly done in OO-languages.</p>\n\n<p>More generally, the dummy wrapper <code>Showable</code> for the thing which is already in the language \u2014 <code>Show</code> type class \u2014 adds extra noise in my code. No good.</p>\n\n<p><strong>Approach 2</strong>: impredicatives. Desired but does not work.</p>\n\n<p>The most straightforward type for such a list for me and what I really desire would be:</p>\n\n<pre><code>{-# LANGUAGE ImpredicativeTypes #-}\naList :: [forall a. Show a =&gt; a]\naList = [(1 :: Int), \"abc\"]\n</code></pre>\n\n<p>Besides that (<a href=\"https://jozefg.bitbucket.io/posts/2014-12-23-impredicative.html\" rel=\"nofollow noreferrer\">as I heard</a>)<code>ImpredicativeTypes</code> is \u201cfragile at best and broken at worst\u201d\nit does not compile:</p>\n\n<pre><code>Couldn't match expected type \u2018a\u2019 with actual type \u2018Int\u2019\n  \u2018a\u2019 is a rigid type variable bound by\n      a type expected by the context: Show a =&gt; a\n</code></pre>\n\n<p>and the same error for <code>\"abc\"</code>. (Note type signature for 1: without it I receive even more weird message: <code>Could not deduce (Num a) arising from the literal \u20181\u2019</code>).</p>\n\n<p><strong>Approach 3</strong>: Rank-N types together with some sort of functional lists (difference lists?).</p>\n\n<p>Instead of problematic <code>ImpredicativeTypes</code> one would probably prefer more stable and wide-accepted <code>RankNTypes</code>. This basically means: move \ndesired <code>forall a. Show a =&gt; a</code> out of type constructor (i.e. <code>[]</code>) to plain function types. Consequently we need some representation of lists as plain functions. As I barely heard there are such representations. The one I heard of is difference lists. But in <a href=\"http://hackage.haskell.org/package/dlist-0.7.1.2/docs/Data-DList.html\" rel=\"nofollow noreferrer\"><code>Dlist</code> package</a> the main type is good old <code>data</code> so we return to impredicatives. I didn't investigate this line any further as I suspect that it could yield more verbose code than in approach 1. But if you think it won't, please give me an example.</p>\n\n<p><strong>Bottom line</strong>: how would you attack such a task in Haskell? Could you give more succinct solution than in OO-language (especially in place of filling a list \u2014 see comment for code in approach 1)? Can you comment on how relevant are the approaches listed above?</p>\n\n<p><strong>UPD</strong> (based on first comments): the question is of course simplified for the purpose of readability. The real problem is more about how to store things which share the same type class, i.e. can be processed later on in a number of ways (<code>Show</code> has only one method, but other classes can have more than one). This factors out solutions which suggest apply <code>show</code> method right when filling a list.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1446922483, "post_id": 33586484, "comment_id": 54949076, "body": "Look at the type of <code>getLine</code>. Is it <code>String</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 2, "last_activity_date": 1446923830, "last_edit_date": 1446923830, "creation_date": 1446922807, "answer_id": 33586596, "question_id": 33586484, "link": "https://stackoverflow.com/questions/33586484/read-strings-from-command-line-util-one-can-be-read-as-a-float/33586596#33586596", "title": "Read Strings from command line util one can be &#39;read&#39; as a Float", "body": "<p>For the Just case, use <code>-&gt; return f</code> instead of <code>-&gt; f</code>.</p>\n\n<p>And then just remove the type signature for <code>getFloat</code>. After it compiles, have ghci tell you what the type signature for <code>getFloat</code> is.</p>\n\n<p>Complete code:</p>\n\n<pre><code>getFloat = do\n    input &lt;- getLine\n    case (readMaybe input :: Maybe Float) of Just f -&gt; return f\n                                             Nothing -&gt; do getFloat\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>You might be interested in this highly-polymorphic version of the loop:</p>\n\n<pre><code>{-# LANGUAGE NoMonomorphismRestriction #-}\nimport Text.Read\n\ngetItem = do\n  input &lt;- getLine\n  case readMaybe input of\n    Nothing -&gt; getItem\n    Just x  -&gt; return x\n</code></pre>\n\n<p>I have purposely written <code>getItem</code> without a type signature - this is something that GHC can infer and fill in for you. I've also used the NoMonomorphismRestriction pragma so that <code>getItem</code> remains polymorphic.</p>\n\n<p>The idea is that <code>getItem</code> can be used for any type that can be read - Floats, Doubles, Strings, etc. The type used by <code>readMaybe</code> can be controlled by the caller in various ways. Here are some examples:</p>\n\n<pre><code>main = do\n  f1 &lt;- getItem\n  f2 &lt;- getItem\n  let r = f1 + f2 :: Float\n  print r\n</code></pre>\n\n<p>By forcing <code>r</code> to be type Float, <code>f1</code> and <code>f2</code> must also be Floats, and therefore <code>getItem</code> will try to parse a Float.</p>\n\n<p>Here is another way to influence the type that <code>readMaybe</code> uses:</p>\n\n<pre><code>main = do\n  f &lt;- getItem :: IO Float\n  i &lt;- getItem :: IO Int\n  print $ f^i  -- compute f raised to the i-th power\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5537497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/074d143d848c98d8ef3ba2716d95df69?s=128&d=identicon&r=PG&f=1", "display_name": "Harry M", "link": "https://stackoverflow.com/users/5537497/harry-m"}, "edited": false, "score": 0, "creation_date": 1446923445, "post_id": 33586645, "comment_id": 54949382, "body": "So there&#39;s no way to produce a <code>Float</code> from a function that does IO ? And I will always be forced to drag that IO Float with me until I use a <code>&lt;-</code> ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3, "user_id": 5537497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/074d143d848c98d8ef3ba2716d95df69?s=128&d=identicon&r=PG&f=1", "display_name": "Harry M", "link": "https://stackoverflow.com/users/5537497/harry-m"}, "edited": false, "score": 0, "creation_date": 1446923882, "post_id": 33586645, "comment_id": 54949538, "body": "@HarryM Briefly put, yes. The main idea is that if a function does some IO, this <i>has</i> to be reflected on its type. There are some helpers to adapt standard functions to work on IO, for convenience. E.g. <code>cos getFloat</code> is a type error, <code>do f &lt;- getFloat ; return (cos f)</code> is OK but verbose, <code>cos &lt;$&gt; getFloat</code> is equivalent and much more concise. Try reading a monad/applicative tutorial for these shortcuts."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1446923135, "creation_date": 1446923135, "answer_id": 33586645, "question_id": 33586484, "link": "https://stackoverflow.com/questions/33586484/read-strings-from-command-line-util-one-can-be-read-as-a-float/33586645#33586645", "title": "Read Strings from command line util one can be &#39;read&#39; as a Float", "body": "<pre><code>getFloat :: Float\n</code></pre>\n\n<p>This states that <code>getFloat</code> is a constant of type <code>Float</code>, which is not what you want.</p>\n\n<pre><code>getFloat :: IO Float\n</code></pre>\n\n<p>This instead states that <code>getFloat</code> is an IO action producing a <code>Float</code>.</p>\n\n<p>Once this is fixed, then you need to add <code>return</code> in front of your <code>f</code>, as @ErikR already explained. The return turns the pure float value <code>f</code> into an IO action which produces it, without actually performing any IO.</p>\n\n<p>Finally, you do not need the <code>do</code> in the last <code>do getFLoat</code>. The <code>do</code> syntax is useful to sequence IO actions: if you only have one, it is redundant.</p>\n"}], "owner": {"reputation": 3, "user_id": 5537497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/074d143d848c98d8ef3ba2716d95df69?s=128&d=identicon&r=PG&f=1", "display_name": "Harry M", "link": "https://stackoverflow.com/users/5537497/harry-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 33586645, "answer_count": 2, "score": 0, "last_activity_date": 1446923830, "creation_date": 1446922108, "last_edit_date": 1446922921, "question_id": 33586484, "link": "https://stackoverflow.com/questions/33586484/read-strings-from-command-line-util-one-can-be-read-as-a-float", "title": "Read Strings from command line util one can be &#39;read&#39; as a Float", "body": "<p>I'm trying to write code that will prompt the user to enter a Float and will continue to do so until a valid float is entered. </p>\n\n<p>I've tried the following approach:</p>\n\n<pre><code>getFloat :: Float\ngetFloat = do \n    input &lt;- getLine\n    case (readMaybe input :: Maybe Float) of Just f -&gt; f\n                                             Nothing -&gt; do getFloat\n</code></pre>\n\n<p>But I'm getting the following error: </p>\n\n<pre><code>Main.hs:41:5:\n    Couldn't match type `IO b0' with `Float'\n    Expected type: IO String -&gt; (String -&gt; IO b0) -&gt; Float\n      Actual type: IO String -&gt; (String -&gt; IO b0) -&gt; IO b0\n    In a stmt of a 'do' block: input &lt;- getLine\n    In the expression:\n      do { input &lt;- getLine;\n           case (readMaybe input :: Maybe Float) of {\n             Just f -&gt; f\n             Nothing -&gt; do { ... } } }\n    In an equation for `getFloat':\n        getFloat\n          = do { input &lt;- getLine;\n                 case (readMaybe input :: Maybe Float) of {\n                   Just f -&gt; f\n                   Nothing -&gt; ... } }\n\nMain.hs:42:56:\n    Couldn't match expected type `IO b0' with actual type `Float'\n    In the expression: f\n    In a case alternative: Just f -&gt; f\n\nMain.hs:43:60:\n    Couldn't match expected type `IO b0' with actual type `Float'\n    In a stmt of a 'do' block: getFloat\n    In the expression: do { getFloat }\n</code></pre>\n\n<p>I'm a beginner a would very much appreciate if someone could explain what am I missing here.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5537510"}, "edited": false, "score": 0, "creation_date": 1446922079, "post_id": 33586407, "comment_id": 54948948, "body": "so take x out of what to include instead of that is confusing me."}], "tags": [], "owner": {"reputation": 117024, "user_id": 200291, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/399cacf55045372a29f1f844d12ee777?s=128&d=identicon&r=PG", "display_name": "icktoofay", "link": "https://stackoverflow.com/users/200291/icktoofay"}, "is_accepted": false, "score": 2, "last_activity_date": 1446921669, "creation_date": 1446921669, "answer_id": 33586407, "question_id": 33586356, "link": "https://stackoverflow.com/questions/33586356/creating-a-function-that-outputs-true-or-false-if-a-number-is-a-prime-number/33586407#33586407", "title": "creating a function that outputs true or false if a number is a prime number?", "body": "<p>The definition of your <code>primeTest</code> function is identical to that of your <code>allprimes</code> function; both definitions have type <code>[Integer]</code>, so of course that\u2019s going to conflict since you just told it you would provide a <code>[Bool]</code>.</p>\n\n<p>Probably, what you meant to do was rather than generating <em>the list of elements such that that element is prime</em>, you mean to generate <em>for each element, whether that element is prime</em>. Think about it:</p>\n\n<pre><code>[             | x &lt;- [2..],            ]\n  ^                          ^ condition on whether to include it in the list\n  what to include in the final list\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 0, "last_activity_date": 1446922294, "creation_date": 1446922294, "answer_id": 33586510, "question_id": 33586356, "link": "https://stackoverflow.com/questions/33586356/creating-a-function-that-outputs-true-or-false-if-a-number-is-a-prime-number/33586510#33586510", "title": "creating a function that outputs true or false if a number is a prime number?", "body": "<p>Your definitions for <code>allPrimes</code> and <code>primeTest</code> are exactly the same, so if <code>allPrimes</code> is a list of Integers, you shouldn't be surprised that <code>primeTest</code> is also a list of Integers and not a list of Bools that your type signature asserts.</p>\n\n<p>The simplest definition for <code>primeTest</code> that makes sense is:</p>\n\n<pre><code>primeTest :: [Bool]\nprimeTest = [ prime x | x&lt;- [2..] ]\n</code></pre>\n\n<p>This is the same as:</p>\n\n<pre><code>primeTest = map prime [2..]\n</code></pre>\n\n<p>Is this what you were looking for?</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5537510"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1446922294, "creation_date": 1446921357, "question_id": 33586356, "link": "https://stackoverflow.com/questions/33586356/creating-a-function-that-outputs-true-or-false-if-a-number-is-a-prime-number", "title": "creating a function that outputs true or false if a number is a prime number?", "body": "<p>I have a function called primeTest that should output True or false for every n element to infinity whether its a prime or not.</p>\n\n<pre><code>divides :: Integer -&gt; Integer -&gt; Bool \ndivides x y = y `mod` x == 0\n\nprime :: Integer -&gt; Bool\nprime n = n &gt; 1 &amp;&amp; and [not(divides x n) | x &lt;- [2..(n-1)]]\n\nallprimes :: [Integer]\nallprimes = [x | x&lt;- [2..], prime x]\n\n\nprimeTest :: [Bool]\nprimeTest = [x | x&lt;- [2..], prime x]\n</code></pre>\n\n<p>I tried calling the all primes function but get the error that it cannot match type Integer to Bool, any advice? Thank you.</p>\n"}, {"tags": ["haskell", "io"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1446918811, "post_id": 33585764, "comment_id": 54947896, "body": "Change <code>p &lt;- prices n</code> to <code>let p = prices n</code>. The <code>&lt;-</code> syntax is for monadic operations - in this case, the monad is IO, so anything appearing to the right of <code>&lt;-</code> must have type <code>IO something</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1446923606, "post_id": 33585764, "comment_id": 54949441, "body": "By the way, you probably want <code>putStrLn &quot;average price = &quot;</code> since <code>print</code> adds extra quotes."}, {"owner": {"reputation": 11, "user_id": 5537345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0887c5b69514e1179c857af33a9f42?s=128&d=identicon&r=PG&f=1", "display_name": "strangeintp", "link": "https://stackoverflow.com/users/5537345/strangeintp"}, "edited": false, "score": 0, "creation_date": 1446934968, "post_id": 33585764, "comment_id": 54952948, "body": "Thanks for explanation"}], "answers": [{"tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 4, "last_activity_date": 1446920283, "creation_date": 1446920283, "answer_id": 33586149, "question_id": 33585764, "link": "https://stackoverflow.com/questions/33585764/haskell-how-to-print-multiple-metrics-of-pure-function-results/33586149#33586149", "title": "Haskell: How to print multiple metrics of pure function results", "body": "<p>You can not bind p with prices n with the '&lt;-' operator, use a let instead:</p>\n\n<p>This should do the trick:</p>\n\n<pre><code>main = do\n  ...\n  start &lt;- getCurrentTime\n  let p = prices n  -- ***********New Code*********\n  print \"average price = \"\n  ...\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5537345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0887c5b69514e1179c857af33a9f42?s=128&d=identicon&r=PG&f=1", "display_name": "strangeintp", "link": "https://stackoverflow.com/users/5537345/strangeintp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1446920283, "creation_date": 1446918111, "question_id": 33585764, "link": "https://stackoverflow.com/questions/33585764/haskell-how-to-print-multiple-metrics-of-pure-function-results", "title": "Haskell: How to print multiple metrics of pure function results", "body": "<p>I want to print out the average and length of a list of values resulting from a \"pure\" function call.  I've done a fair bit of research on this and just about to put my head through a wall.  The following code works:</p>\n\n<pre><code>[... a bunch of other stuff like \"doParallelTrades\" ...]\n\nsimulate :: Int -&gt; Int -&gt; [Double]\nsimulate numbuyers groupsize =\n    let buyers = initTraders numbuyers minimum_price maximum_price\n        sellers = initTraders numbuyers minimum_price maximum_price\n    in doParallelTrades sellers buyers groupsize\n\n\n{--\nMAIN\n--}\n\ngetNum :: IO Int\ngetNum = readLn\n\nmain :: IO ()\nmain = do\n  let prices n = simulate n 0\n  putStr \"How many buyers?\"\n  n &lt;- getNum\n  start &lt;- getCurrentTime\n  print \"average price = \"\n  print $ average $ prices n\n  end &lt;- getCurrentTime\n  print \"number of trades:\"\n  print $ length $ prices n\n  print \"Wall Time:\"\n  print (diffUTCTime end start)\n</code></pre>\n\n<p>However, this evaluates \"prices n\" twice, which obviously I don't want to do for large n.  I'd like to evaluate it just once, then compute and print the average, then print the length.  I tried changing the main function to:</p>\n\n<pre><code>main = do\n  let prices n = simulate n 0\n  putStr \"How many buyers?\"\n  n &lt;- getNum\n  start &lt;- getCurrentTime\n  p &lt;- prices n  -- ***********New Code*********\n  print \"average price = \"\n  print $ average $ p   -- ***********New Code**********\n  end &lt;- getCurrentTime\n  print \"number of trades:\"\n  print $ length $ p  -- **********New Code***********\n  print \"Wall Time:\"\n  print (diffUTCTime end start)\n</code></pre>\n\n<p>I.e., bind \"prices n\" to \"p\" and then do stuff with p.  But the interpreter gives me the error</p>\n\n<pre><code>zitraders-threaded.hs:162:8:\n    Couldn't match expected type \u2018IO [Integer]\u2019\n                with actual type \u2018[Double]\u2019\n    In a stmt of a 'do' block: p &lt;- prices n\n</code></pre>\n\n<p>I've researched various online resources but they are either too simple (working only within the IO monad) or too complex.  So how do I:</p>\n\n<ol>\n<li>Get some input from the user.</li>\n<li>Run some \"pure\" calculations on that input (just once) and store the result.</li>\n<li>Tell the user multiple properties of that result.</li>\n</ol>\n"}, {"tags": ["haskell", "repa"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446918683, "post_id": 33585077, "comment_id": 54947859, "body": "<code>mmultP</code> does <i>parallel</i> work, so it runs in the IO monad. Either change it to <code>mmultS</code> - which does the same, but sequentially, or change the type of <code>powerIteration</code> to <code>R.Array ... -&gt; IO (R.Array ...)</code>"}, {"owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446919120, "post_id": 33585077, "comment_id": 54948007, "body": "Wow, I did not notice the different function signature between the parallel and sequential. I will accept it as an answer if you write it as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "is_accepted": true, "score": 0, "last_activity_date": 1453631170, "creation_date": 1453631170, "answer_id": 34974638, "question_id": 33585077, "link": "https://stackoverflow.com/questions/33585077/why-do-i-get-a-type-error-in-this-case-with-data-array-repa-algorithms-matrix-mm/34974638#34974638", "title": "why do I get a type error in this case with Data.Array.Repa.Algorithms.Matrix.mmultP?", "body": "<p>Yes, comments where correct, <code>IO</code> monad should be there:</p>\n\n<pre><code>{-# LANGUAGE TypeOperators #-}\n\nimport Data.Array.Repa\nimport System.Random\nimport Data.List\nimport Data.Function \nimport Data.Array.Repa.Algorithms.Matrix\n\nweights :: (Int, Int) -&gt; (Double, Double) -&gt; Array U (Z :. Int :. Int) Double\nweights (nodes, features) range = fromListUnboxed (Z :. nodes :. features) values\n  where \n    values = take (nodes * features) $ randomRs range gen\n    gen = mkStdGen 1\n\npowerIteration :: Array U (Z :. Int :. Int) Double -&gt; IO (Array U (Z :. Int :. Int) Double)\npowerIteration m = mmultP m rb \n  where \n    rb = weights (rows,1) (0,1)\n    (Z :. _ :. rows) = extent m\n\n\nmain = do \n  let matrix = weights (10,3) (0,1)\n  iter &lt;- powerIteration matrix\n  print iter\n</code></pre>\n"}], "owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 34974638, "answer_count": 1, "score": 3, "last_activity_date": 1453631170, "creation_date": 1446914193, "question_id": 33585077, "link": "https://stackoverflow.com/questions/33585077/why-do-i-get-a-type-error-in-this-case-with-data-array-repa-algorithms-matrix-mm", "title": "why do I get a type error in this case with Data.Array.Repa.Algorithms.Matrix.mmultP?", "body": "<p>I believe this boils down to a foolish type mistake, but I can't figure it out. I have the following code:</p>\n\n<pre><code>{-# LANGUAGE TypeOperators #-}\n\nimport qualified Data.Array.Repa as R\nimport System.Random\nimport Data.Random.Normal\nimport Data.List\nimport Data.Function \nimport qualified Data.Array.Repa.Algorithms.Matrix as M\n\nweights:: (Int,Int)-&gt;(Double,Double) -&gt; R.Array R.U (R.Z R.:. Int R.:. Int) Double\n\nweights (nodes,features) range = R.fromListUnboxed (R.Z R.:. nodes R.:. features) values\nwhere \n    values = take (nodes * features) $ randomRs range gen\n    gen = mkStdGen 1\n\npowerIteration :: R.Array R.U (R.Z R.:. Int R.:. Int) Double -&gt; R.Array R.U (R.Z R.:. Int R.:. Int) Double\n\npowerIteration m = M.mmultP m rb \n    where \n        rb = weights (rows,1) (0,1)\n        (R.Z R.:. _ R.:. rows) = R.extent m\n\n\n main = do \n    let matrix = weights (10,3) (0,1)\n    print $ powerIteration matrix \n</code></pre>\n\n<p>This will create a Repa representation of an 2D array with 10 rows and 3 columns, which I would like to take the dot product of (using M.mmultP) with a 1D array of random numbers (between 0,1) with column length equal to the row number of the 2D array. I get something similar to work in ghci, but this could will create this error;</p>\n\n<pre><code>Couldn't match type \u2018R.Array R.U R.DIM2 Double\u2019 with \u2018Double\u2019\nExpected type: R.Array R.U ((R.Z R.:. Int) R.:. Int) Double\n  Actual type: R.Array\n                 R.U ((R.Z R.:. Int) R.:. Int) (R.Array R.U R.DIM2 Double)\nIn the expression: M.mmultP m rb\nIn an equation for \u2018powerIteration\u2019:\n    powerIteration m\n      = M.mmultP m rb\n      where\n          rb = weights (rows, 1) (0, 1)\n          (R.Z R.:. _ R.:. rows) = R.extent m  \n</code></pre>\n\n<p>This is a type error, but I can't seem to figure it out. Could someone please help me?</p>\n"}, {"tags": ["haskell", "haskell-lens"], "answers": [{"tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": false, "score": 4, "last_activity_date": 1446917230, "creation_date": 1446917230, "answer_id": 33585618, "question_id": 33585029, "link": "https://stackoverflow.com/questions/33585029/how-to-manipulate-lists-with-lens-in-haskell/33585618#33585618", "title": "How to manipulate lists with lens in Haskell", "body": "<p>I would go for</p>\n\n<pre><code>(\"a\",[(0,'a'),(1,'b'),(2,'c')]) ^.. _2 . traverse . _1\n</code></pre>\n\n<p>(Note the <code>^..</code> instead of <code>^.</code> because this is a traversal.) </p>\n"}], "owner": {"reputation": 31, "user_id": 5537183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5aa8784422685fa620f7ef949ddb64?s=128&d=identicon&r=PG&f=1", "display_name": "autotaker", "link": "https://stackoverflow.com/users/5537183/autotaker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1446917230, "creation_date": 1446913885, "question_id": 33585029, "link": "https://stackoverflow.com/questions/33585029/how-to-manipulate-lists-with-lens-in-haskell", "title": "How to manipulate lists with lens in Haskell", "body": "<p>I'm a beginner of the lens library.\nI'm trying to extract a list from some data structure.</p>\n\n<p>I wonder how to implement <code>f</code> that satisfies:</p>\n\n<pre><code>(\"a\",[(0,'a'),(1,'b'),(2,'c')]) ^. _2 . f === [0,1,2]\n</code></pre>\n\n<p>With a struggle, I found an answer.</p>\n\n<pre><code>g :: Functor f =&gt; Getting a s a -&gt; (forall b. Getting (f b) (f s) (f a))\ng = to . fmap . view\nf = g _1 \n</code></pre>\n\n<p>Is there any library function that corresponds to <code>g</code>? \nOtherwise, Is there any more elegant way to implement such <code>f</code>? </p>\n"}, {"tags": ["function", "haskell", "if-statement", "compiler-errors"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4195250, "user_type": "registered", "profile_image": "https://graph.facebook.com/784920178/picture?type=large", "display_name": "Tom Phelps", "link": "https://stackoverflow.com/users/4195250/tom-phelps"}, "edited": false, "score": 0, "creation_date": 1446909890, "post_id": 33584353, "comment_id": 54944963, "body": "I&#39;m getting the same error when adding the do to each clause."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 2, "last_activity_date": 1446911630, "last_edit_date": 1446911630, "creation_date": 1446909720, "answer_id": 33584353, "question_id": 33584328, "link": "https://stackoverflow.com/questions/33584328/haskell-main-function-for-calling-all-other-functions-using-user-input/33584353#33584353", "title": "Haskell - Main function for calling all other functions using user input", "body": "<p>You need to add a <code>do</code> to the then and else clauses:</p>\n\n<pre><code>if ...\n  then do\n    putStr ...\n    ...\n  else do\n    putStr ...\n    ...\n</code></pre>\n\n<p>Also, make sure the <code>if</code> statement is indented the same amount as the <code>xs &lt;- ...</code> statement -- and don't use tabs.</p>\n\n<p>E.g.:</p>\n\n<pre><code>main = do \n    putStr \"Enter question number: \"\n    xs &lt;- getLine\n    if (xs == \"3\")\n        then do\n          putStr \"number of toppings: \"\n          top &lt;- getLine\n          putStr \"diameter of pizza in cm2: \"\n          size &lt;- getLine\n          return ()\n        else do\n          putStr \"Enter 3 numbers: \"\n          args &lt;- getLine\n          return()\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4195250, "user_type": "registered", "profile_image": "https://graph.facebook.com/784920178/picture?type=large", "display_name": "Tom Phelps", "link": "https://stackoverflow.com/users/4195250/tom-phelps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446911630, "creation_date": 1446909566, "question_id": 33584328, "link": "https://stackoverflow.com/questions/33584328/haskell-main-function-for-calling-all-other-functions-using-user-input", "title": "Haskell - Main function for calling all other functions using user input", "body": "<p>I'm new to Haskell and finding it all a bit confusing since coming from Java.</p>\n\n<p>I am trying to implement a function that prompts the user in command line for a number input and then execute the function correlating to the input, or default to the first function if no input is entered.</p>\n\n<p>I'm having a problem with the if function, the compiler keeps giving me errors and I'm not sure why.</p>\n\n<pre><code>main = do \n    putStr \"Enter question number: \"\n    xs &lt;- getLine\n        if (xs == \"3\")\n            then\n                putStr \"number of toppings: \"\n                top &lt;- getLine\n                putStr \"diameter of pizza in cm2: \"\n                size &lt;- getLine\n                (pizzaPrice (top size))\n            else \n                putStr \"Enter 3 numbers: \"\n                args &lt;- getLine\n                (numAbove1 (args))\n</code></pre>\n\n<p>I'm getting the compiler error \"parse error on input \u2018if\u2019\".</p>\n\n<p>Can someone please explain to me what I am doing wrong.</p>\n"}, {"tags": ["performance", "parsing", "haskell", "memory", "attoparsec"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1446906767, "post_id": 33583774, "comment_id": 54943992, "body": "You should include your imports so we know what <code>SIO</code> and <code>T</code> refer to and which parser combinator library you are using."}, {"owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1446909860, "post_id": 33583774, "comment_id": 54944951, "body": "@ErikR Done mate. Sorry."}], "answers": [{"comments": [{"owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "edited": false, "score": 0, "creation_date": 1446920875, "post_id": 33584123, "comment_id": 54948545, "body": "One last question. When I try to store the results in a list, for example, it uses a lot of memory (more than ever): stringList &lt;- forM allNonEmptyLines $ \\x -&gt; do case parseOnly parseLogLine x of                                                    Left e  -&gt; return $ show e                                                    Right a -&gt; return $ show a. How can I store the parse results without using too much memory?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "edited": false, "score": 0, "creation_date": 1446921930, "post_id": 33584123, "comment_id": 54948896, "body": "Why do you want to store the results? I estimate you are generating at least 100 million entries - of course it is going to require a lot of memory. What do you actually want to <i>do</i> with the parse results?"}, {"owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "edited": false, "score": 0, "creation_date": 1446922275, "post_id": 33584123, "comment_id": 54949002, "body": "I want to classify them, for example delete the repeated ones (which only differ in its timestamp) and other actions like this."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "edited": false, "score": 0, "creation_date": 1446922435, "post_id": 33584123, "comment_id": 54949058, "body": "That is complicated enough that you should ask that in new question."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1446911348, "last_edit_date": 1446911348, "creation_date": 1446908167, "answer_id": 33584123, "question_id": 33583774, "link": "https://stackoverflow.com/questions/33583774/attoparsec-high-memory-usage-reading-huge-file/33584123#33584123", "title": "attoparsec high memory usage reading huge file", "body": "<p>There are at least two issues - <code>writeFile</code> and <code>customUnlines</code>.</p>\n\n<p><code>writeFile</code> needs to collect all of the output before writing it, so I would first see if this produces output:</p>\n\n<pre><code>h &lt;- openFile \"summary.txt\" WriteMode\nforM_ listOfStrings (hPutStrLn h)\nhClose h\n</code></pre>\n\n<p>This should process the log file in a streaming fashion if <code>listOfStrings</code> is a lazy list.</p>\n\n<p>Assuming this works, to implement your <code>customUnlines</code> logic I would do this:</p>\n\n<pre><code>h &lt;- openFile \"summary.txt\" WriteMode\nforM_ listOfStrings $ \\x -&gt; do\n  if x == \"\\n\"\n    then hPutStr h \"\\n\"\n    else hPutStrLn h \"\\n\"\nhClose h\n</code></pre>\n\n<p>If <code>listOfStrings</code> is not a lazy list then I need your imports to further debug the problem.</p>\n\n<p><strong>Update</strong></p>\n\n<p>It turns out that <code>listOfStrings</code> is not a lazy list due to <code>parseLogFile</code>.</p>\n\n<p>Note that <code>listaEithers</code> has type <code>Either String [LineType]</code>. This means that you have to parse all of the lines before it returns. Instead, you should parse each line individually:</p>\n\n<pre><code>forM_ allNonEmptyLines $ \\x -&gt; do\n  case parseOnly parseLogLine x of\n    Left e -&gt; error \"oops\"\n    Right a -&gt; print a       -- a is a LineType\n</code></pre>\n\n<p>Here <code>parseLogLine</code> is:</p>\n\n<pre><code>parseLogLine =\n  try parseError\n  &lt;|&gt; try parseDirectoryInfo\n  &lt;|&gt; try parseBacktraceLine\n  &lt;|&gt; try parseBackTraceString\n  &lt;|&gt; parseErrorInfo\n</code></pre>\n"}], "owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 33584123, "answer_count": 1, "score": 1, "last_activity_date": 1446911348, "creation_date": 1446906047, "last_edit_date": 1446909838, "question_id": 33583774, "link": "https://stackoverflow.com/questions/33583774/attoparsec-high-memory-usage-reading-huge-file", "title": "attoparsec high memory usage reading huge file", "body": "<p>I've tried many approachs for parsing a file content line by line, but at the present time is not working and when it runs, uses a lot of memory (more than 16GB).</p>\n\n<p>This is a subset of the file I want to parse <a href=\"http://lpaste.net/144719\" rel=\"nofollow\">http://lpaste.net/144719</a></p>\n\n<p>I want three kinds of errors:</p>\n\n<p>1) error with backtrace (multiple lines, the first of them is like 3))<br>\n2) single error with one more line<br>\n3) single line error</p>\n\n<p>Here is my current code:</p>\n\n<pre><code>import qualified Data.ByteString as B\nimport Data.ByteString.Char8 as B8 hiding (lines, filter, unlines, head, readFile, take, length,\n                                           putStrLn, tail, map, concat, or, writeFile, intersperse,\n                                           groupBy, hGetContents)\nimport qualified Data.Text as T\nimport qualified Data.Text.IO as TIO\nimport Data.Attoparsec.Text hiding (take)\nimport Control.Applicative\nimport Control.Monad (replicateM, mapM)\nimport Data.Either (either)\nimport Data.List (intersperse, groupBy)\nimport System.Environment\nimport qualified System.IO as SIO\n\ndata TimeStamp = MkTimeStamp T.Text\n               deriving Show\n\ndata LogFileInfo = BackTraceLineInfo T.Text\n                 | BackTraceInfo TimeStamp T.Text T.Text [LogFileInfo]\n                 | Error TimeStamp T.Text\n                 | LargeError TimeStamp T.Text T.Text\n                 deriving Show\n\ndata LineType = SingleLineError TimeStamp T.Text\n              | DirectoryInfo T.Text\n              | ErrorInfo T.Text\n              | LineBackTraceInfo T.Text\n              | BackTraceString T.Text\n              | BackTraceLine T.Text\n              deriving Show\n\nparseTimeStamp :: Parser TimeStamp\nparseTimeStamp = do\n  year &lt;- many digit\n  char '-'\n  month &lt;- many digit\n  char '-'\n  day &lt;- many digit\n  char ' '\n  hour &lt;- many digit\n  char ':'\n  minute &lt;- many digit\n  char ':'\n  second &lt;- many digit\n  char ' '\n  (return . MkTimeStamp) $ T.pack $ year ++ \"-\" ++ month ++ \"-\" ++ day ++ \" \" ++ hour ++ \":\" ++ minute ++ \":\" ++ second\n\nparseError :: Parser LineType\nparseError = do\n  string $ T.pack \"ERROR - \"\n  timeStamp &lt;- parseTimeStamp\n  errorInfo &lt;- parseAnyLine\n  return $ SingleLineError timeStamp errorInfo\n\nparseDirectoryInfo :: Parser LineType\nparseDirectoryInfo = do\n  char '/'\n  directoryInfo &lt;- parseAnyLine\n  (return . DirectoryInfo) $ T.append (T.pack \"/\") directoryInfo\n\nparseErrorInfo :: Parser LineType\nparseErrorInfo = do\n  errorInfo &lt;- parseAnyLine\n  (return . ErrorInfo) errorInfo\n\nparseBackTraceString :: Parser LineType\nparseBackTraceString = do\n  let backTraceStr = T.pack \" Backtrace: \"\n  string backTraceStr\n  return $ BackTraceString backTraceStr\n\nparseBacktraceLine :: Parser LineType\nparseBacktraceLine = do\n  char '#'\n  number &lt;- many1 digit\n  backTraceInfo &lt;- parseAnyLine\n  let numberPart = T.pack $ '#' : number\n  return $ LineBackTraceInfo $ T.append numberPart backTraceInfo\n\nparseAnyLine :: Parser T.Text\nparseAnyLine = fmap T.pack $ many anyChar\n\n-- Skips n lines for allowing other parsers to succeed\nskipNLines n = replicateM n $ manyTill anyChar endOfLine\n\n-- performParser :: Parser a -&gt; T.Text -&gt; BackTraceInfo\nperformParser = parseOnly\n\ngetEitherRight :: Either a b -&gt; b\ngetEitherRight (Right b) = b\n\nparseLogFile :: [T.Text] -&gt; [LineType]\nparseLogFile textxs = \n  let listaEithers = mapM (parseOnly $\n                           try parseError\n                       &lt;|&gt; try parseDirectoryInfo\n                       &lt;|&gt; try parseBacktraceLine\n                       &lt;|&gt; try parseBackTraceString\n                       &lt;|&gt; parseErrorInfo) textxs\n  in getEitherRight listaEithers\n\ncustomUnlines :: [String] -&gt; String\ncustomUnlines []     = []\ncustomUnlines (x:xs) = if x == \"\\n\"\n                         then '\\n':customUnlines xs\n                         else x ++ \"\\n\" ++ customUnlines xs\n\nmain = do\n  (fileName : _) &lt;- getArgs\n  h &lt;- SIO.openFile fileName SIO.ReadMode\n  SIO.hSetEncoding h SIO.latin1\n  fileContents &lt;- SIO.hGetContents h\n  let titleLength           = length fileName\n      titleWithoutExtension = take (titleLength - 4) fileName\n      allNonEmptyLines      = map T.pack $ intersperse \"\\n\" $ tail $ filter (/= \"\") $ lines fileContents -- [T.Text]\n      listParseResults      = parseLogFile allNonEmptyLines -- [LineType]\n      -- onlyModelErrors       = filter isModelError parseResult -- [LogFileInfo]\n      -- onlyOneRepresentative = map head $ groupBy equalErrors onlyModelErrors\n      listOfStrings         = map show listParseResults\n  writeFile (titleWithoutExtension ++ \".logsummary\") $ customUnlines listOfStrings\n</code></pre>\n\n<p>The first problem is that the parser isn't parsing anything. And the second problem is that is using 16GB of RAM. How can improve my approach?</p>\n"}, {"tags": ["haskell", "hugs"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1446905701, "post_id": 33583332, "comment_id": 54943654, "body": "Indent the <code>z =...</code> line so that the z lines up under the x. Use spaces, tabs can cause problems in Haskell."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1446905740, "post_id": 33583332, "comment_id": 54943667, "body": "doesn&#39;t ` let x = 1 in let z = x+y in z + 1` or <code>let x=1; z=x+y in z + 1</code> work? (I can only test in ghci and basically have no clue about hugs - sorry)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1446908359, "post_id": 33583332, "comment_id": 54944494, "body": "Hugs hasn&#39;t been maintained in years. Only a handful of people still use it. Why do you?"}, {"owner": {"reputation": 1387, "user_id": 2561898, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/BZDcM.png?s=128&g=1", "display_name": "eightShirt", "link": "https://stackoverflow.com/users/2561898/eightshirt"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446945523, "post_id": 33583332, "comment_id": 54955402, "body": "@Carsten booth works. Thanks!"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446968535, "post_id": 33583332, "comment_id": 54959027, "body": "@eightShirt I added it as an answer -  I hope you don&#39;t mind"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446968616, "post_id": 33583332, "comment_id": 54959045, "body": "@dfeuer it&#39;s probably the FP101x<i>Gate</i> thing ;)"}], "answers": [{"comments": [{"owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "edited": false, "score": 1, "creation_date": 1446910337, "post_id": 33583828, "comment_id": 54945101, "body": "Why is it sad for hugs to declare <code>let</code>s? (<code>:{</code>)"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 4, "last_activity_date": 1446909869, "last_edit_date": 1446909869, "creation_date": 1446906374, "answer_id": 33583828, "question_id": 33583332, "link": "https://stackoverflow.com/questions/33583332/how-to-use-two-lets-on-the-same-line/33583828#33583828", "title": "How to use two let&#39;s on the same line?", "body": "<p>(Sorry - didn't realize your question was about hugs not ghci.)</p>\n\n<p>You can use <code>:{</code> in ghci to enter a multiline expression:</p>\n\n<pre><code>shell$ ghci\nGHCi, version 7.10.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :{\nPrelude|   let z = 1\nPrelude|       w = 3\nPrelude|   in z + w\nPrelude| :}\n4\nPrelude&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 3, "last_activity_date": 1446968483, "creation_date": 1446968483, "answer_id": 33591796, "question_id": 33583332, "link": "https://stackoverflow.com/questions/33583332/how-to-use-two-lets-on-the-same-line/33591796#33591796", "title": "How to use two let&#39;s on the same line?", "body": "<p>Even if you cannot enter multi-line statements into hugs in this case it is possible to do it all in one line.</p>\n\n<p>You can use two <code>let ... in ...</code> like this:</p>\n\n<pre><code>let x = 1 in let z = x+y in z + 1\n</code></pre>\n\n<p>or you can use <code>;</code> for multiple definitions like this:</p>\n\n<pre><code>let x=1; z=x+y in z + 1\n</code></pre>\n"}], "owner": {"reputation": 1387, "user_id": 2561898, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/BZDcM.png?s=128&g=1", "display_name": "eightShirt", "link": "https://stackoverflow.com/users/2561898/eightshirt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 966, "favorite_count": 0, "accepted_answer_id": 33591796, "answer_count": 2, "score": 5, "last_activity_date": 1549842239, "creation_date": 1446903324, "last_edit_date": 1549842239, "question_id": 33583332, "link": "https://stackoverflow.com/questions/33583332/how-to-use-two-lets-on-the-same-line", "title": "How to use two let&#39;s on the same line?", "body": "<p>I'm using Hugs interpreter and I want to execute the following code (by Haskell 2010 language report):</p>\n\n<pre><code>let x = 1\nz = x+y\nin z+1\n</code></pre>\n\n<p>Is it possible only creating a <code>.hs</code> file and loading? Can I do it by command line directly?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1446901827, "post_id": 33582957, "comment_id": 54942443, "body": "in this case, it means &quot;take each element of the list <code>xs</code> and substitute <code>x</code> for each such element in sequence&quot;. More generally, in a monadic context (a do block), it means name binding to the return value of the monadic action."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1446902425, "post_id": 33582957, "comment_id": 54942601, "body": "Read about <a href=\"https://wiki.haskell.org/List_comprehension\" rel=\"nofollow noreferrer\">list comprehension</a>."}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 6, "last_activity_date": 1446902709, "creation_date": 1446902709, "answer_id": 33583248, "question_id": 33582957, "link": "https://stackoverflow.com/questions/33582957/what-does-x-xs-in-haskell-mean/33583248#33583248", "title": "What does x&lt;-xs in Haskell mean?", "body": "<p>This is a <a href=\"https://en.wikipedia.org/wiki/List_comprehension\" rel=\"noreferrer\">list comprehension</a> where the notation is designed to be similar to <a href=\"https://en.wikipedia.org/wiki/Set-builder_notation#Convention_of_annotating_the_variable_domain_on_the_left_of_the_.27such_that.27\" rel=\"noreferrer\">set builder notation</a> with the token <code>&lt;-</code> corresponding to the stylized lower case Greek epsilon which is the standard symbol for set membership. When I read list comprehensions I tend to read <code>&lt;-</code> as \"drawn from\", so I would parse <code>[x | x&lt;\u2212xs , even x]</code> as \"the list of all x  such that x is drawn from xs and x is even\" (<code>,</code> corresponds to <code>and</code> and is used to add conditions beyond mere membership in the list which is being drawn from).</p>\n"}, {"tags": [], "owner": {"reputation": 10220, "user_id": 2720372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/olQxk.jpg?s=128&g=1", "display_name": "w.b", "link": "https://stackoverflow.com/users/2720372/w-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1446926819, "last_edit_date": 1446926819, "creation_date": 1446908522, "answer_id": 33584179, "question_id": 33582957, "link": "https://stackoverflow.com/questions/33582957/what-does-x-xs-in-haskell-mean/33584179#33584179", "title": "What does x&lt;-xs in Haskell mean?", "body": "<p>As the other answers stated this a list comprehension notation, which means a way of defining a list in terms of another list. If you specify some predicates in the part after a <code>|</code>, only elements satisfying these predicates will be taken, for example <code>[x | x &lt;- xs, even x]</code> is a list of all those elements <code>x</code> taken from the list <code>xs</code> that are even (meet the condition <code>even x</code>). There can be more than one predicate:</p>\n\n<pre><code>[x | x &lt;- xs, even x, x &gt; 10]\n</code></pre>\n\n<p>You can also apply transformations to the drawn elements, including changing the list type:</p>\n\n<pre><code>\u03bb&gt; [x*2 | x &lt;- [1 .. 20], even x, x &gt; 10]\n[24,28,32,36,40]\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>\u03bb&gt; [show x | x &lt;- [1 .. 20], even x, x &gt; 10]\n[\"12\",\"14\",\"16\",\"18\",\"20\"]\n</code></pre>\n"}], "owner": {"reputation": 274, "user_id": 4016912, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/hyrSL.jpg?s=128&g=1", "display_name": "Shury", "link": "https://stackoverflow.com/users/4016912/shury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1865, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1446926819, "creation_date": 1446900605, "question_id": 33582957, "link": "https://stackoverflow.com/questions/33582957/what-does-x-xs-in-haskell-mean", "title": "What does x&lt;-xs in Haskell mean?", "body": "<p>In one of my courses I came across this:</p>\n\n<pre><code>numbers xs = [x | x&lt;\u2212xs , even x] \n</code></pre>\n\n<p>I understand that it takes a list of numbers and creates another list formed only with the even numbers from the original list. How exactly is it doing this? What does <code>x&lt;-xs</code> mean?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 8419, "user_id": 2702781, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e6776aa6608f9af0115c241d84a05a6a?s=128&d=identicon&r=PG&f=1", "display_name": "Nyavro", "link": "https://stackoverflow.com/users/2702781/nyavro"}, "is_accepted": false, "score": 0, "last_activity_date": 1446886318, "creation_date": 1446886318, "answer_id": 33580920, "question_id": 33580818, "link": "https://stackoverflow.com/questions/33580818/parse-error-in-pattern-n/33580920#33580920", "title": "Parse error in pattern n", "body": "<p>You have several issues in your code. Here is what you want to achieve:</p>\n\n<pre><code>fromDecTo :: Int -&gt; Int -&gt; [Int]\nfromDecTo n x | (n &lt; x)   = [n]\n              | otherwise = fromDecTo (n `div` x) x ++ [n `mod` x]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1446888046, "creation_date": 1446888046, "answer_id": 33581134, "question_id": 33580818, "link": "https://stackoverflow.com/questions/33580818/parse-error-in-pattern-n/33581134#33581134", "title": "Parse error in pattern n", "body": "<pre><code>fromDecTo :: (Int -&gt; Int) -&gt; [Int]\n</code></pre>\n\n<p>This is a function having <em>one</em> argument, a function from integers to integers. This is not what you want: you want a function having two arguments, i.e.</p>\n\n<pre><code>fromDecTo :: Int -&gt; Int -&gt; [Int]\n</code></pre>\n\n<p>Similarly, the pattern</p>\n\n<pre><code>fromDecTo (n x)\n</code></pre>\n\n<p>expresses the result of applying a function <code>n</code> to <code>x</code> and then applying <code>fromDecTo</code>to the result. This is not what you want, taking two arguments is done with</p>\n\n<pre><code>fromDecTo n x\n</code></pre>\n\n<p>As a final note, even if it not customary to do so, it is possible to add parentheses, but with the opposite association. The same type shown above could be written</p>\n\n<pre><code>fromDecTo :: Int -&gt; (Int -&gt; Int)\n</code></pre>\n\n<p>which stresses the fact that functions are curried in Haskell: a binary function is actually a function taking only <em>one</em> argument, the first, and returning a function taking <em>one</em> other argument, the second, and finally returning the result.</p>\n\n<p>Similarly, instead of</p>\n\n<pre><code>fromDecTo n x\n</code></pre>\n\n<p>we could write</p>\n\n<pre><code>(fromDecTo n) x\n</code></pre>\n\n<p>since <code>n</code> is applied to <code>fromDecTo</code> first, and then <code>x</code> after that.</p>\n"}], "owner": {"reputation": 53, "user_id": 5536215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34b3d920e62ece3a722bbd9fdb908d25?s=128&d=identicon&r=PG&f=1", "display_name": "04k", "link": "https://stackoverflow.com/users/5536215/04k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 33581134, "answer_count": 2, "score": 0, "last_activity_date": 1446888046, "creation_date": 1446885450, "question_id": 33580818, "link": "https://stackoverflow.com/questions/33580818/parse-error-in-pattern-n", "title": "Parse error in pattern n", "body": "<p>I'm new to haskell.\nGot a parse error and dont know what is wrong.</p>\n\n<pre><code>fromDecTo :: (Int -&gt; Int) -&gt; [Int]\nfromDecTo (n x) | (n &lt; x)   = [n]\n                | otherwise = fromDecTo (n `div` x) ++ [n `mod` x]\n</code></pre>\n\n<p>This should convert a decimal number into a number with base x (a.e. hexadecimal).</p>\n\n<p>Please help me.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1446883643, "post_id": 33580535, "comment_id": 54937981, "body": "Since Haskell is sort-of white-space sensitive, please edit your question to display the indentation your code has."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1446883937, "post_id": 33580535, "comment_id": 54938027, "body": "even more importantly, Haskell is newline/semicolon sensitive even!"}], "answers": [{"comments": [{"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 2, "creation_date": 1446889501, "post_id": 33580648, "comment_id": 54939312, "body": "Also, of course, you can then replace howmanyoftwoequal with just &quot;==&quot;. Incidentally standard Haskell style is to use camelCase: howManyOfTwoEqual"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 83, "user_id": 3274335, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bac8ee2a6bf10438449a38f7ecdfaf64?s=128&d=identicon&r=PG&f=1", "display_name": "user3274335", "link": "https://stackoverflow.com/users/3274335/user3274335"}, "edited": false, "score": 0, "creation_date": 1447740715, "post_id": 33580648, "comment_id": 55268413, "body": "@user3274335 please accept this answer then - I noticed that you did not accept any of your questions so far so please read: <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a> too"}], "tags": [], "owner": {"reputation": 8419, "user_id": 2702781, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e6776aa6608f9af0115c241d84a05a6a?s=128&d=identicon&r=PG&f=1", "display_name": "Nyavro", "link": "https://stackoverflow.com/users/2702781/nyavro"}, "is_accepted": true, "score": 4, "last_activity_date": 1446883850, "creation_date": 1446883850, "answer_id": 33580648, "question_id": 33580535, "link": "https://stackoverflow.com/questions/33580535/trying-to-learn-while-solving-some-basic-haskell-problems/33580648#33580648", "title": "trying to learn while solving some basic haskell problems", "body": "<p>You have several issues in your code:</p>\n\n<ol>\n<li>Typo in howmanyoftwoequal type definition: you have 'howmayoftwoequal' instead of 'howmanyoftwoequal'</li>\n<li><p>To use howmanyoftwoequal in boolean operations &amp;&amp; and || its type should be Bool:</p>\n\n<pre><code>howmanyoftwoequal :: Int-&gt;Int-&gt;Bool\nhowmanyoftwoequal m n = m==n\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 3422, "user_id": 1091208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/507510b4df35587c853d93c2d2cdda22?s=128&d=identicon&r=PG", "display_name": "amnn", "link": "https://stackoverflow.com/users/1091208/amnn"}, "is_accepted": false, "score": 1, "last_activity_date": 1446896462, "creation_date": 1446896462, "answer_id": 33582347, "question_id": 33580535, "link": "https://stackoverflow.com/questions/33580535/trying-to-learn-while-solving-some-basic-haskell-problems/33582347#33582347", "title": "trying to learn while solving some basic haskell problems", "body": "<p>Your definition of <code>howManyEqual</code> misses the case where <code>m == o</code> but <code>m == n || n == o</code> does not hold, which it seems should also be a valid case for it returning <code>2</code>.</p>\n\n<p>If you are trying to return the size of the largest equivalence class between <code>m</code>, <code>n</code>, and <code>o</code>, this can be achieved as follows:</p>\n\n<pre><code>largestEquivSize :: [Int] -&gt; Int\nlargestEquivSize = maximum . map length . group . sort\n\nhowManyEqual :: Int -&gt; Int -&gt; Int -&gt; Int\nhowManyEqual m n o = largestEquivSize [m, n, o]\n</code></pre>\n\n<p>With the added bonus that <code>largestEquivSize</code> is a lot more general (in fact its type is unnecessarily constrained here, and could be <code>Ord a =&gt; [a] -&gt; Int</code>).</p>\n"}], "owner": {"reputation": 83, "user_id": 3274335, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bac8ee2a6bf10438449a38f7ecdfaf64?s=128&d=identicon&r=PG&f=1", "display_name": "user3274335", "link": "https://stackoverflow.com/users/3274335/user3274335"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 33580648, "answer_count": 2, "score": 0, "last_activity_date": 1446896462, "creation_date": 1446882874, "last_edit_date": 1446884678, "question_id": 33580535, "link": "https://stackoverflow.com/questions/33580535/trying-to-learn-while-solving-some-basic-haskell-problems", "title": "trying to learn while solving some basic haskell problems", "body": "<p>I am new to haskell and trying out some exercise.While trying to load the below code i am getting a binding error  howmanytwoequal function.Can anyone please tell me as to what mistake i had done.</p>\n\n<pre><code>howmayoftwoequal :: Int-&gt;Int-&gt;Int\nhowmanyoftwoequal m n\n        |m==n =1\n        |otherwise =0\n\nhowmanyequal::Int-&gt;Int-&gt;Int-&gt;Int\nhowmanyequal m n o\n        | howmanyoftwoequal m n &amp;&amp; howmanyoftwoequal n o  =3\n        | howmanyoftwoequal m n || howmanyoftwoequal n o =2\n        |otherwise =1\n</code></pre>\n"}, {"tags": ["haskell", "monad-transformers"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1446861973, "post_id": 33578055, "comment_id": 54934274, "body": "<code>ConduitM m</code> is an instance of <code>MonadIO</code> if <code>MonadIO m</code>, so so you have <code>liftIO :: MonadIO m =&gt; IO a -&gt; ConduitM i o m a</code>. <code>ConduitM</code> also has instances for all of the MTL classes (MonadReader/Writer, etc) since <code>ConduitM</code> is a monad transformer, so you dont have to write <code>lift ask :: ConduitM i o (Reader r) r</code> (for example), you can just do <code>ask :: ConduitM i o (Reader r) r</code>."}, {"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446888525, "post_id": 33578055, "comment_id": 54939098, "body": "@user2407038: Thanks for the answer, but I wasn&#39;t quite sure what should I do with <code>yield</code>s and <code>await</code>s."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446918420, "post_id": 33578055, "comment_id": 54947760, "body": "What you should do with yield and await doesn&#39;t seem to have anything to do with lifting IO actions in conduits? Perhaps you should include a concrete example of what you wish to achieve. If you mean something like a <code>MonadConduit</code> (analogous to MonadReader/Writer/etc) class, this doesn&#39;t exist, however <code>pipes</code> solves this problem and essentially does the same thing as <code>Conduit</code> (see <a href=\"http://hackage.haskell.org/package/pipes-3.2.0/docs/Control-Proxy-Trans.html\" rel=\"nofollow noreferrer\">Control.Proxy.Trans</a>)"}, {"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446935598, "post_id": 33578055, "comment_id": 54953124, "body": "@user2407038: I added a concrete example showing what I have in mind."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446936902, "post_id": 33578055, "comment_id": 54953550, "body": "The reason that you can&#39;t place ConduitM at the top of the stack is that doesn&#39;t have a <code>MonadPlus</code> instance. I would expect something like <code>MonadPlus m =&gt; MonadPlus (ConduitM i o m)</code> to exist, but that doesn&#39;t seem to be the case - I&#39;m not sure why."}], "answers": [{"comments": [{"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1446888028, "post_id": 33578361, "comment_id": 54938988, "body": "Thanks for the answer. Unfortunately I wasn&#39;t able to see a way to put <code>ConduitM</code> at the top in my application. The conduit I&#39;m writing awaits and yields unpredictable number of items in each iteration, and the <code>await</code>s and <code>yield</code>s are deeply buried at complicatedly nested <code>if</code>s and <code>case</code>s."}, {"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1446888974, "post_id": 33578361, "comment_id": 54939185, "body": "As for <code>liftBase</code>, I notice that <code>conduitM</code> is <i>not</i> a base itself: <code>MonadBase base m =&gt; MonadBase base (ConduitM i o m)</code>. This means that the base would be <code>IO</code> -- and <i>not</i> <code>conduitM ...</code> -- if my <code>conduitM</code> is based on <code>IO</code>-monad."}, {"owner": {"reputation": 715, "user_id": 4883127, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/428914dd1ba6786d9242170f4bbce2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Hardy", "link": "https://stackoverflow.com/users/4883127/bradley-hardy"}, "reply_to_user": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1446901484, "post_id": 33578361, "comment_id": 54942341, "body": "@trVoldemort What layers do you have in your stack? Are there things like <code>ListT</code> or <code>LogicT</code> that might have different behaviour if swapped around? If so, I think you might do well to rethink your program&#39;s structure.  As for the <code>MonadBase</code> thing, yes, you&#39;re right but that&#39;s not what I meant. I&#39;ll edit my answer for clarity."}], "tags": [], "owner": {"reputation": 715, "user_id": 4883127, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/428914dd1ba6786d9242170f4bbce2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Hardy", "link": "https://stackoverflow.com/users/4883127/bradley-hardy"}, "is_accepted": false, "score": 4, "last_activity_date": 1446901762, "last_edit_date": 1446901762, "creation_date": 1446861837, "answer_id": 33578361, "question_id": 33578055, "link": "https://stackoverflow.com/questions/33578055/is-there-a-liftio-equivalence-for-conduits/33578361#33578361", "title": "Is there a `liftIO` equivalence for conduits?", "body": "<p><code>ConduitM</code> is <em>itself</em> a monad transformer, and, looking at the <a href=\"https://hackage.haskell.org/package/conduit-1.2.5.1/docs/Data-Conduit.html#t:ConduitM\" rel=\"nofollow\">Haddock page</a> for it, we see that it defines instances for <code>MonadState</code>, <code>MonadReader</code>, etc. This should suggest that in fact the pattern intended is to have <code>ConduitM</code> at the top of the transformer stack, in which case you don't need to lift any operations into it.</p>\n\n<p>In fact, it even defines an instance for <a href=\"https://hackage.haskell.org/package/transformers-base-0.4.4/docs/Control-Monad-Base.html#t:MonadBase\" rel=\"nofollow\">MonadBase</a>, the class which lets you lift operations from the monad which sits at the very base of the stack (using the <code>liftBase</code> function), so that if reordering your stack means it's hard to access the <em>new</em> thing at the bottom, <code>MonadBase</code> solves this for you. If you have <code>IO</code> at the bottom anyway though, this probably isn't very helpful.</p>\n\n<p><strong>I would suggest that you try to reorder your transformer stack to put <code>ConduitM</code> on top if possible.</strong></p>\n\n<p><strong>EDIT:</strong> Another option would be to create your own class, <code>MonadConduit</code>, which defines generalised <code>yield</code> and <code>await</code> functions, and add instances for <code>ConduitM</code> and every other transformer you use on top of it. I think that this is less elegant than reordering your stack if possible though.</p>\n"}, {"tags": [], "owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "is_accepted": true, "score": 0, "last_activity_date": 1447371255, "creation_date": 1447371255, "answer_id": 33683434, "question_id": 33578055, "link": "https://stackoverflow.com/questions/33578055/is-there-a-liftio-equivalence-for-conduits/33683434#33683434", "title": "Is there a `liftIO` equivalence for conduits?", "body": "<p>I think a better way is to use the included <a href=\"https://hackage.haskell.org/package/conduit-1.2.5.1/docs/Data-Conduit-Lift.html\" rel=\"nofollow\"><code>Data.Conduit.Lift</code></a> module. It is as simple as replacing all your <code>runMaybeT</code>, <code>runStateT</code>, etc. into <code>runMaybeC</code> and <code>runStateC</code>. And voila, the <code>ConduitM</code> is pushed to the top of the transformer stack.</p>\n"}], "owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 2, "accepted_answer_id": 33683434, "answer_count": 2, "score": 3, "last_activity_date": 1447371255, "creation_date": 1446859132, "last_edit_date": 1446935492, "question_id": 33578055, "link": "https://stackoverflow.com/questions/33578055/is-there-a-liftio-equivalence-for-conduits", "title": "Is there a `liftIO` equivalence for conduits?", "body": "<p>I'm writing a conduit that is growing quite big, with nested monad transforms. It's a tedious work to <code>lift</code> each and every <code>yield</code> or <code>await</code> call into the base <code>conduitM</code>. Not to mention every time I add or withdraw a layer of transformation, I need to change the number of <code>lift</code>'s at every possible location.</p>\n\n<p>I was looking for a similar function as <code>liftIO</code>, but instead of lifting an IO operation it should lift <code>yield</code> or <code>await</code> into an arbitrarily transformed monad based on <code>ConduitM</code>, but I can't seem to find one. Is there a way to achieve something like this?</p>\n\n<hr>\n\n<p><strong>Edit:</strong> in response to @BradleyHardy's answer, here I provide a concrete example:</p>\n\n<pre><code>{-# LANGUAGE LambdaCase #-}\n\nimport Control.Monad                    as MON \nimport Control.Monad.IO.Class           as MIO \nimport Control.Monad.Trans.Class        as MTC \nimport Control.Monad.Trans.Maybe        as MTM \nimport Data.Conduit                     as CDT \nimport System.IO                        as IO\n\nstdinS :: Source IO String\nstdinS = void . runMaybeT . forever $ do\n    (liftIO isEOF) &gt;&gt;= \\case\n        True  -&gt; mzero\n        False -&gt; (lift . yield) =&lt;&lt; (liftIO getLine)\n\nmyK :: Sink String IO ()\nmyK = void . runMaybeT . forever . runMaybeT $ do\n    a &lt;- maybe (lift mzero) return =&lt;&lt; (lift . lift $ await)\n    b &lt;- if a == \"listen\"\n      then maybe (lift mzero) return =&lt;&lt; (lift . lift $ await)\n      else mzero\n    liftIO . putStrLn $ \"I heard: \" ++ b\n\nmain :: IO ()\nmain = do\n    stdinS $$ myK \n</code></pre>\n\n<p>How would you change <code>myK</code> to put <code>ConduitM</code> on top of the stack? Admittedly in this particular example using <code>MaybeT</code> is over-complication, but in my actual (much larger) conduit <code>MaybeT</code> structure is much cleaner than e.g. recursions.</p>\n"}, {"tags": ["haskell", "shared-libraries", "cabal", "cabal-install"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1446868473, "post_id": 33577118, "comment_id": 54935329, "body": "What is your value of your <code>PKG_CONFIG_PATH</code> environment variable?"}, {"owner": {"reputation": 1091, "user_id": 385881, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8efbecf0936eecea60da339fe33d3308?s=128&d=identicon&r=PG", "display_name": "reyman64", "link": "https://stackoverflow.com/users/385881/reyman64"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1446885381, "post_id": 33577118, "comment_id": 54938361, "body": "Value is not set, perhaps it&#39;s that ?"}, {"owner": {"reputation": 1091, "user_id": 385881, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8efbecf0936eecea60da339fe33d3308?s=128&d=identicon&r=PG", "display_name": "reyman64", "link": "https://stackoverflow.com/users/385881/reyman64"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1446886732, "post_id": 33577118, "comment_id": 54938685, "body": "It&#39;s that, thanks @erikR. Perhaps you want to create an answer with this ?"}], "answers": [{"comments": [{"owner": {"reputation": 1091, "user_id": 385881, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8efbecf0936eecea60da339fe33d3308?s=128&d=identicon&r=PG", "display_name": "reyman64", "link": "https://stackoverflow.com/users/385881/reyman64"}, "edited": false, "score": 0, "creation_date": 1453483723, "post_id": 33584142, "comment_id": 57636781, "body": "I try to make a complete tutorial for haskell on webfaction here now : <a href=\"https://community.webfaction.com/questions/19167/install-haskell-ghc-and-cabal-from-source-on-webfaction\" rel=\"nofollow noreferrer\" title=\"install haskell ghc and cabal from source on webfaction\">community.webfaction.com/questions/19167/&hellip;</a>"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1446908299, "creation_date": 1446908299, "answer_id": 33584142, "question_id": 33577118, "link": "https://stackoverflow.com/questions/33577118/cabal-dont-find-relative-library-for-compilation-of-gsasl-package/33584142#33584142", "title": "Cabal don&#39;t find relative library for compilation of gsasl package", "body": "<p>Make sure your <code>PKG_CONFIG_PATH</code> environment variable is set to include <code>$HOME/lib/pkgconfig</code>, i.e. the directory where you've placed <code>libgsasl.pc</code>.</p>\n"}], "owner": {"reputation": 1091, "user_id": 385881, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8efbecf0936eecea60da339fe33d3308?s=128&d=identicon&r=PG", "display_name": "reyman64", "link": "https://stackoverflow.com/users/385881/reyman64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 33584142, "answer_count": 1, "score": 0, "last_activity_date": 1446908299, "creation_date": 1446852220, "question_id": 33577118, "link": "https://stackoverflow.com/questions/33577118/cabal-dont-find-relative-library-for-compilation-of-gsasl-package", "title": "Cabal don&#39;t find relative library for compilation of gsasl package", "body": "<p>I'm using Haskell on webfaction server, with non root access, on a CentOS 6 system.</p>\n\n<p>I have a <code>/lib/</code> folder which contain libraries.</p>\n\n<p>Actually, i have a problem with some libraries needed for an installation of package using <code>cabal install</code>.</p>\n\n<p>I need the <code>libgsasl</code> library installed, so i download and compile the <a href=\"http://www.gnu.org/software/gsasl/#downloading\" rel=\"nofollow\">gsasl</a> package from sources :</p>\n\n<ul>\n<li>I wget the latest tar.gz <a href=\"http://www.gnu.org/software/gsasl/#downloading\" rel=\"nofollow\">here</a></li>\n<li>I run <code>./configure --prefix=$HOME</code> to install compiled libraries into <code>$HOME/lib</code></li>\n<li>i <code>make</code> and <code>make install</code></li>\n</ul>\n\n<p>Next, i try two way with <code>cabal install gsasl</code> command, which actually fails :</p>\n\n<ul>\n<li><code>export LD_LIBRARY_PATH=$HOME/lib:$LD_LIBRARY_PATH</code> </li>\n<li><code>cabal install gsasl --bindir=$HOME/bin --extra-include-dirs=/home/reyman64/lib/ --extra-lib-dirs=/home/reyman64/lib</code></li>\n</ul>\n\n<p>Any of the command found the good libraries ... </p>\n\n<pre><code>The pkg-config package 'libgsasl' version superior to 1.1 is required but it could not be found.\n</code></pre>\n\n<p>So i verify, my version is 1.8, and i have the libgsasl.sa .la .so .so.7 .so.7.9.6 in <code>$HOME/lib</code> and i have a <code>libgsasl.pc</code> into <code>$home/lib/pkgconfig</code></p>\n\n<p>Any idea of the problem  ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1446849042, "post_id": 33576722, "comment_id": 54931438, "body": "I&#39;m under the same impression as you. If the paper is math heavy, they might be just using explicit notation for the sake of being explicit."}, {"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1446849519, "post_id": 33576722, "comment_id": 54931584, "body": "@Carcigenicate Actually, no, there is a difference if you try to compile. With <code>ScopedTypeVariables</code>, it works with <code>forall</code> and errors without. Code in case you&#39;re interested: <a href=\"https://gist.github.com/anonymous/b288970d38595be68229\" rel=\"nofollow noreferrer\">gist.github.com/anonymous/b288970d38595be68229</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 1, "creation_date": 1446854296, "post_id": 33576869, "comment_id": 54932655, "body": "The second paragraph is it. Thanks very much for the explanation."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 10, "last_activity_date": 1446849696, "creation_date": 1446849696, "answer_id": 33576869, "question_id": 33576722, "link": "https://stackoverflow.com/questions/33576722/understanding-the-difference-between-two-haskell-signatures-one-using-forall/33576869#33576869", "title": "Understanding the difference between two Haskell signatures, one using forall", "body": "<p>There are two important cases where including a <code>forall</code> makes a difference. The first is that the location of a <code>forall</code> can change the meaning of a type -- if it comes to the left of an arrow, that means an argument to the function is \"more polymorphic\" than otherwise. This difference is a fundamental one; however, it does not seem to apply here.</p>\n\n<p>The second difference is a syntactic (rather than fundamental) one, namely: in the presence of <code>ScopedTypeVariables</code>, variables bound by a <code>forall</code> open a typing scope, whereas variables implicitly bound without a <code>forall</code> do not. Thus, in the body of <code>vreplicate</code>, one can use the type variables <code>a</code> and <code>n</code> and be certain that they refer to the same types as mentioned in the signature of <code>vreplicate</code>. Without the <code>forall</code> (or without <code>ScopedTypeVariables</code>), uses of <code>a</code> and <code>n</code> in the body of <code>vreplicate</code> would introduce <em>fresh</em> universally quantified variables, and it would be the programmer's responsibility to ensure they were unified with the types in the signature of <code>vreplicate</code> if that were a desired. Further details are available in <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/other-type-extensions.html#scoped-type-variables\">the documentation</a>.</p>\n\n<p>Without reading the paper carefully I can't be sure, but I would strongly bet the latter is happening here.</p>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 33576869, "answer_count": 1, "score": 6, "last_activity_date": 1446849696, "creation_date": 1446848908, "question_id": 33576722, "link": "https://stackoverflow.com/questions/33576722/understanding-the-difference-between-two-haskell-signatures-one-using-forall", "title": "Understanding the difference between two Haskell signatures, one using forall", "body": "<p>In this <a href=\"https://github.com/kosmikus/SSGEP/blob/master/LectureNotes.pdf\">paper</a> there is a function with the following signature:</p>\n\n<pre><code>vreplicate :: forall a n . SNatI n =&gt; a -&gt; Vec a n \n</code></pre>\n\n<p>What is the difference between this signature and the one that doesn't have <code>forall</code>:</p>\n\n<pre><code>vreplicate :: SNatI n =&gt; a -&gt; Vec a n \n</code></pre>\n\n<p>? I was under the impression that with no <code>forall</code>, it implicitly means the same as having <code>forall</code> in front that names all the type variables.</p>\n"}, {"tags": ["haskell", "ffi", "ghcjs"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 2, "creation_date": 1446859434, "post_id": 33576618, "comment_id": 54933811, "body": "you <i>could</i> just use threads and have GHCJS take care of the plumbing."}, {"owner": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1447078739, "post_id": 33576618, "comment_id": 54996481, "body": "this is an answer to a slightly different question, that i created for you here <a href=\"http://stackoverflow.com/questions/33611149/how-to-execute-an-action-periodically-in-a-ghcjs-program\" title=\"how to execute an action periodically in a ghcjs program\">stackoverflow.com/questions/33611149/&hellip;</a> :)"}], "owner": {"reputation": 9281, "user_id": 393758, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3ee15f717c343aabe3e14db32c22130b?s=128&d=identicon&r=PG", "display_name": "danza", "link": "https://stackoverflow.com/users/393758/danza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1447089850, "creation_date": 1446848362, "last_edit_date": 1592644375, "question_id": 33576618, "link": "https://stackoverflow.com/questions/33576618/how-to-convert-an-io-to-jsval-in-ghcjs", "title": "How to convert an `IO ()` to `JSVal` in GHCJS", "body": "<p>i want to execute some effectful computation on a regular basis in a program compiled with GHCJS, but <code>GHCJS.DOM.WindowTimers.setInterval</code> wants a <code>JSVal</code> as parameter. Could anybody give me some pointers for turning my <code>IO ()</code> into a <code>JSVal</code>?</p>\n<h3>Edit:</h3>\n<p>I was able to match the types using <code>GHCJS.Foreign.Callback.asyncCallback</code> and <code>GHCJS.Types.jsval</code>, but i have eventually got a runtime error. Luite in the GHCJS channel suggested to use threads for this task, as Erik suggested in a comment here. This is explained in <a href=\"https://stackoverflow.com/questions/33611149/how-to-execute-an-action-periodically-in-a-ghcjs-program\">the corresponding question</a></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1446848464, "post_id": 33576274, "comment_id": 54931223, "body": "I&#39;m afraid this is just not possible, because <code>Array</code> has no explicit class for unboxable types. <a href=\"http://hackage.haskell.org/package/vector-0.11.0.0/docs/Data-Vector-Unboxed.html\" rel=\"nofollow noreferrer\"><code>Vector</code> has</a>."}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1446849015, "post_id": 33576274, "comment_id": 54931433, "body": "@leftaroundabout my use-case involves 2-dimensional indexing, which is clumsy with vectors"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 7, "last_activity_date": 1446849062, "last_edit_date": 1446849062, "creation_date": 1446848731, "answer_id": 33576690, "question_id": 33576274, "link": "https://stackoverflow.com/questions/33576274/how-to-create-a-polymorphic-unboxed-array-within-st-monad/33576690#33576690", "title": "How to create a polymorphic unboxed array within ST monad?", "body": "<p>The following seems to work. I don't know if it can be minimized. One downside is that you will need to add an instance of <code>Unboxable</code> for each <code>MArray</code> instance that you'll want to be able to use -- but at least thanks to <code>DefaultSignatures</code> you don't have to write any actual code. I've included an instance for <code>Int</code> to show what I mean.</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE DefaultSignatures #-}\n{-# LANGUAGE FlexibleContexts #-}\nimport Control.Monad.ST\nimport Data.Constraint\nimport Data.Array.Unboxed\nimport Data.Array.ST\n\nclass Unboxable e where\n    unboxable :: Dict (MArray (STUArray s) e (ST s))\n    default unboxable :: MArray (STUArray s) e (ST s) =&gt; Dict (MArray (STUArray s) e (ST s))\n    unboxable = Dict\n\nnew :: forall e. Unboxable e =&gt; e -&gt; UArray Int e\nnew e = runSTUArray build where\n    build :: forall s. ST s (STUArray s Int e)\n    build = case unboxable :: Dict (MArray (STUArray s) e (ST s)) of\n        Dict -&gt; newArray (0, 9) e\n\ninstance Unboxable Int\n</code></pre>\n\n<p>The <code>Dict</code> type comes from Edward Kmett's <a href=\"http://hackage.haskell.org/package/constraints\" rel=\"noreferrer\">constraints</a> package.</p>\n"}, {"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 3, "creation_date": 1446860472, "post_id": 33576918, "comment_id": 54933975, "body": "I guess I&#39;m obligated to point out that <a href=\"https://github.com/ekmett/constraints/issues/11\" rel=\"nofollow noreferrer\"><code>Forall</code> is unsound</a> and will be restricted greatly in the next version of <code>constraints</code>, probably to the point where it can no longer be used to avoid the individual instances."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446865433, "post_id": 33576918, "comment_id": 54934921, "body": "@&#216;rjanJohansen, is <code>Forall</code> unsound with neither of the dubious features of overlapping instances and closed type families?"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1446867171, "post_id": 33576918, "comment_id": 54935139, "body": "@dfeuer <a href=\"http://oerjan.nvg.org/haskell/Forall/UC3.hs\" rel=\"nofollow noreferrer\">Open type families are enough</a>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446875705, "post_id": 33576918, "comment_id": 54936443, "body": "@&#216;rjanJohansen, I sure wish I could understand how that all works. Brilliant and horrifying. Thanks."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1446890028, "post_id": 33576918, "comment_id": 54939429, "body": "@dfeuer As far as I can see, <code>Forall</code> is implemented by checking that a constraint is satisfied by two non-exported types <code>A,B</code>, the idea being that the only way you can make your class to be instantiated on those non-accessible types is to use a universal instance, so <code>unsafeCoerce</code> should be OK. Alas, type families can be used to write <code>F x y z = Bool</code> when any two of <code>x,y,z</code> are equal and <code>= Int</code> otherwise. However, from the <code>Forall</code> implementation, <code>F</code> is always <code>Bool</code> (it should have checked with <code>A,B,C</code> instead of <code>A,B</code>). From this, you can reach unsoundness."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1446890359, "post_id": 33576918, "comment_id": 54939504, "body": "@dfeuer So, in short, you can&#39;t safely use a bounded set of skolem constants. Orjan made even a worse example, you can write (paraphrased) <code>data C; type family F where F t C = Int ; F t x = Bool</code> which, no matter how many skolem constants you use, you can&#39;t detect it is not constantly <code>Bool</code>. I fear that having if-then-else on equality at the type level breaks a kind of parametricitly which <code>Forall</code> conveniently relied upon."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1446895276, "post_id": 33576918, "comment_id": 54940667, "body": "Thanks guys for pointing out this issue! It seems that we would need a true skolem variable (such that it&#39;s not equal or inequal to any monotype) for this to work... I&#39;m wondering though whether we can emulate a true skolem, after all, true skolems often clog up closed type family reduction during type checking - maybe we can introduce &quot;clogging up&quot; artificially?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446901395, "post_id": 33576918, "comment_id": 54942309, "body": "@&#216;rjanJohansen, I looked at your code and ... I don&#39;t understand why that compiles without <code>OverlappingInstances</code>. The type family cases overlap, no?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446903270, "post_id": 33576918, "comment_id": 54942884, "body": "@dfeuer: the implicit equalities between the params differentiate the instance heads. It&#39;s arguably a dodgy feature, and probably it&#39;d be better to banish equalities to instance constraints."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446908246, "post_id": 33576918, "comment_id": 54944454, "body": "@Andr&#225;sKov&#225;cs, the dodgy bit is that they overlap. <code>Blah x x y</code> obviously overlaps <code>Blah x y y</code>. I would therefore hope and expect that GHC would require <code>OverlappingInstances</code> to allow that."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1446909133, "post_id": 33576918, "comment_id": 54944731, "body": "@dfeuer: open type family instances <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/type-families.html#type-family-overlap\" rel=\"nofollow noreferrer\">can overlap</a> if they have the same result type under their unifying substitution."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1446910737, "post_id": 33576918, "comment_id": 54945218, "body": "BTW I conjured up an <a href=\"https://github.com/ekmett/constraints/issues/11\" rel=\"nofollow noreferrer\">alternative <code>Forall</code></a> definition that prevents &#216;rjan&#39;s unsound programs from checking and is still usable in this case. I&#39;m not sure if it&#39;s waterproof, so you might want to give it a look."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1446911555, "post_id": 33576918, "comment_id": 54945470, "body": "@Andr&#225;sKov&#225;cs Darn, would you believe I got essentially <i>just</i> the same idea yesterday... BTW my version of it also rejects my unsound programs, but for two of them it rejects them with a spurious &quot;superclass cycle&quot; message, which could be annoying when using it otherwise. I should test if yours does..."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446911752, "post_id": 33576918, "comment_id": 54945541, "body": "@&#216;rjanJohansen: yep, my version also does the &quot;superclass cycle&quot; thing... The question is whether it ever comes up with code that doesn&#39;t actively tries to subvert the system."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446912358, "post_id": 33576918, "comment_id": 54945736, "body": "<a href=\"http://oerjan.nvg.org/haskell/Forall/NewForall.hs\" rel=\"nofollow noreferrer\">My version</a>, also I made some <a href=\"http://oerjan.nvg.org/haskell/Forall/TestNewForall.hs\" rel=\"nofollow noreferrer\">test cases</a>, look in particular at the commented out <code>H1</code> declaration, which fails for this reason and which I imagine is similar to something people might want to use in practice. It seems to require a type equality somewhere, note how the otherwise similar <code>Monoid2</code> just works."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446915893, "post_id": 33576918, "comment_id": 54946969, "body": "And I&#39;ve continued this on the <a href=\"https://github.com/ekmett/constraints/issues/11\" rel=\"nofollow noreferrer\">GitHub issue page</a>, as well as filed a <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11067\" rel=\"nofollow noreferrer\">GHC bug</a>."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1446920851, "post_id": 33576918, "comment_id": 54948537, "body": "@dfeuer Perhaps you&#39;d like to know that Andr&#225;sKov&#225;cs managed to work around that remaining bug. So with any luck <code>Data.Constraint.Forall</code> might be repaired without limiting the API (even generalizing it to become polykinded!)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446922585, "post_id": 33576918, "comment_id": 54949101, "body": "@&#216;rjanJohansen, yes, I&#39;m following the GitHub issue. I just hope the new version doesn&#39;t fall to some other clever trick. What makes you two think it&#39;s safer, exactly?"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1446924200, "post_id": 33576918, "comment_id": 54949639, "body": "@dfeuer (1) When I started university, one of the first math library books I got hold of was Bourbaki&#39;s Set Theory. I remember only <i>one</i> particular thing from that book, namely the weird way it defined quantification. It was essentially like this. (2) With open type families, when an instance isn&#39;t defined, GHC can make no assumptions about the resulting type, because it could be defined any way whatsoever in another module. So everything it <i>does</i> deduce must hold for all the types. (Now handwave that GHC won&#39;t care if it&#39;s actually non-exported or closed.) (3) You can never be sure."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446924473, "post_id": 33576918, "comment_id": 54949724, "body": "@&#216;rjanJohansen, the only potentially scary bit is that I believe it does know that <code>F a ~ F a</code> even when <code>F a</code> gets stuck; I don&#39;t see a way to exploit that, but that doesn&#39;t mean there isn&#39;t one. If it works, though, it&#39;s an excellent fix."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446924865, "post_id": 33576918, "comment_id": 54949841, "body": "@dfeuer Yes it does know that, and I think it would be bad if it <i>didn&#39;t</i>. I even made a test case for it (<code>funEq2</code>) because I was unsure about it."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 5, "last_activity_date": 1446850057, "creation_date": 1446850057, "answer_id": 33576918, "question_id": 33576274, "link": "https://stackoverflow.com/questions/33576274/how-to-create-a-polymorphic-unboxed-array-within-st-monad/33576918#33576918", "title": "How to create a polymorphic unboxed array within ST monad?", "body": "<p>As a refinement to Daniel Wagner's answer, given that we're already using <a href=\"https://hackage.haskell.org/package/constraints\"><code>constraints</code></a> we can make use of <code>Data.Constraint.Forall</code> to get all the <code>Unboxable</code> instances in one fell swoop:</p>\n\n<pre><code>{-# LANGUAGE\n  ScopedTypeVariables, TypeOperators,\n  MultiParamTypeClasses, FlexibleContexts,\n  FlexibleInstances, UndecidableInstances #-}\n\nimport Control.Monad.ST (ST)\nimport Data.Array.MArray (MArray)\nimport Data.Array.Unboxed (UArray)\nimport Data.Array.ST (runSTUArray, newArray, STUArray)\n\nimport Data.Constraint\nimport Data.Constraint.Forall\n\nclass MArray (STUArray s) e (ST s) =&gt; Unboxable e s\ninstance MArray (STUArray s) e (ST s) =&gt; Unboxable e s\n\nnew :: forall e. Forall (Unboxable e) =&gt; e -&gt; UArray Int e\nnew a = runSTUArray build where\n  build :: forall s. ST s (STUArray s Int e)\n  build = case inst :: Forall (Unboxable e) :- Unboxable e s of\n    Sub Dict -&gt; newArray (0, 9) a\n\n-- can be specialized to Double\nnew' :: Double -&gt; UArray Int Double\nnew' = new\n</code></pre>\n"}], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 2, "accepted_answer_id": 33576690, "answer_count": 2, "score": 3, "last_activity_date": 1446914299, "creation_date": 1446846677, "last_edit_date": 1446914299, "question_id": 33576274, "link": "https://stackoverflow.com/questions/33576274/how-to-create-a-polymorphic-unboxed-array-within-st-monad", "title": "How to create a polymorphic unboxed array within ST monad?", "body": "<p>This code compiles with no problem:</p>\n\n<pre><code>import Control.Monad.ST (ST)\nimport Data.Array.MArray (MArray)\nimport Data.Array.Unboxed (UArray)\nimport Data.Array.ST (runSTUArray, newArray, STUArray)\n\nnew :: Double -&gt; UArray Int Double\nnew a = runSTUArray (newArray (0, 9) a)\n</code></pre>\n\n<p>But, this:</p>\n\n<pre><code>new :: e -&gt; UArray Int e\nnew a = runSTUArray (newArray (0, 9) a)\n</code></pre>\n\n<p>fails as one would expect, with error:</p>\n\n<pre><code>No instance for (MArray (STUArray s) e (ST s))\n  arising from a use of \u2018newArray\u2019\nIn the first argument of \u2018runSTUArray\u2019, namely\n  \u2018(newArray (0, 9) a)\u2019\nIn the expression: runSTUArray (newArray (0, 9) a)\nIn an equation for \u2018new\u2019: new a = runSTUArray (newArray (0, 9) a)\n</code></pre>\n\n<p>However, adding the type-class constraint would not help, as changing the type signature to</p>\n\n<pre><code>new :: (MArray (STUArray s) e (ST s)) =&gt; e -&gt; UArray Int e\n</code></pre>\n\n<p>would still fail with </p>\n\n<pre><code>Could not deduce (MArray (STUArray s0) e (ST s0))\nfrom the context (MArray (STUArray s) e (ST s))\n  bound by the type signature for\n             new :: MArray (STUArray s) e (ST s) =&gt; e -&gt; UArray Int e\n  at pilot.hs:7:8-58\nThe type variable \u2018s0\u2019 is ambiguous\nIn the ambiguity check for the type signature for \u2018new\u2019:\n  new :: forall e s.\n         MArray (STUArray s) e (ST s) =&gt;\n         e -&gt; UArray Int e\nTo defer the ambiguity check to use sites, enable AllowAmbiguousTypes\nIn the type signature for \u2018new\u2019:\n  new :: (MArray (STUArray s) e (ST s)) =&gt; e -&gt; UArray Int e\n</code></pre>\n\n<p>any way to make this work?</p>\n\n<hr>\n\n<p>EDIT: Found out this has already been discussed on <a href=\"https://mail.haskell.org/pipermail/haskell/2005-August/016338.html\" rel=\"nofollow\">Haskell</a> and <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2004-July/006400.html\" rel=\"nofollow\">Haskell-Cafe</a> mailing list, with this minimal solution taken from <a href=\"https://mail.haskell.org/pipermail/haskell/2005-August/016354.html\" rel=\"nofollow\">here</a>:</p>\n\n<pre><code>-- https://mail.haskell.org/pipermail/haskell/2005-August/016354.html\n{-# LANGUAGE Rank2Types, FlexibleContexts #-}\n\nimport Control.Monad.ST (ST)\nimport Data.Array.MArray (MArray)\nimport Data.Array.Unboxed (UArray, Ix)\nimport Data.Array.ST (runSTUArray, newArray, STUArray)\n\nnew :: UArrayElement e =&gt; e -&gt; UArray Int e\nnew a = case freezer of\n    Freezer runSTUArray' -&gt; runSTUArray' $ (newArray (0, 9) a)\n\ndata Freezer i e = Freezer\n    ((forall s. MArray (STUArray s) e (ST s) =&gt; ST s (STUArray s i e))\n    -&gt; UArray i e)\n\nclass UArrayElement e where\n    freezer :: Ix i =&gt; Freezer i e\n\ninstance UArrayElement Bool    where freezer = Freezer runSTUArray\ninstance UArrayElement Char    where freezer = Freezer runSTUArray\ninstance UArrayElement Double  where freezer = Freezer runSTUArray\n</code></pre>\n"}, {"tags": ["haskell", "haskell-pipes", "haskell-pipes-safe"], "answers": [{"comments": [{"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446848734, "post_id": 33576364, "comment_id": 54931331, "body": "I don&#39;t think the <code>runEffect</code> is required, because <code>toListM</code> already returns a list, but thanks for pointing me in the right direction! Somehow I had overlooked <code>toListM</code> from the Prelude. And yes, I had to change the type signature of <code>shouldReturnP</code> to <code>shouldReturnP :: IO (Producer FilePath (SafeT IO) ()) -&gt; [FilePath] -&gt; Expectation</code> because the constraint <code>(MonadIO m, MonadSafe m)</code> wasn&#39;t enough. Nice trick with the wildcard there."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446849121, "post_id": 33576364, "comment_id": 54931460, "body": "You&#39;re right - the runEffect isn&#39;t necessary - answer updated."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446849430, "post_id": 33576364, "comment_id": 54931555, "body": "Btw - I&#39;m thinking it would be cleaner if <code>allfiles</code> did the existence test within the pipe so that <code>allfiles path</code> was a Producer instead of an IO (Producer ...)."}, {"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446852198, "post_id": 33576364, "comment_id": 54932069, "body": "That would indeed be neater, but I couldn&#39;t figure out how to do it. It would mean to fork the pipeline. I&#39;ll think about it."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446855610, "post_id": 33576364, "comment_id": 54932999, "body": "I&#39;ve appended to the answer."}, {"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446886019, "post_id": 33576364, "comment_id": 54938514, "body": "Ah I keep forgetting about <code>liftiO</code> which really makes things simpler and easier to read. Thanks a lot."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1446855432, "last_edit_date": 1446855432, "creation_date": 1446847071, "answer_id": 33576364, "question_id": 33575290, "link": "https://stackoverflow.com/questions/33575290/haskell-pipes-how-to-use-drawall-to-test-a-producer-with-a-monadsafe-constraint/33576364#33576364", "title": "Haskell-pipes: how to use drawAll to test a producer with a MonadSafe constraint?", "body": "<p>How about using <code>toListM</code> from Pipes.Prelude:</p>\n\n<pre><code>...\nimport qualified Pipes.Prelude as P\n...\n\nfiles1 :: (MonadIO m, MonadSafe m) =&gt; Producer FilePath m ()\nfiles1 = find \".\" (glob \"*.hs\" &lt;&gt; regular)\n\ntest1 = do\n  got &lt;- runSafeT $ runEffect $ P.toListM files1\n  shouldBe got [\"a.hs\", \"b.hs\", \"c.hs\"]\n\n-- using `allFiles`:\n\ntest2 = do\n  prod &lt;- allFiles \".\"\n  got &lt;- runSafeT $ runEffect $ P.toListM prod\n  shouldBe got [\"a.hs\", \"b.hs\"]\n</code></pre>\n\n<p>To write your <code>shouldReturnP</code> function, start with this:</p>\n\n<pre><code>shouldReturnP1 prod expected = do\n  let _ = expected :: [FilePath]\n  got &lt;- runSafeT $ P.toListM prod\n  shouldBe got expected\n</code></pre>\n\n<p>and have ghc tell you what the type is, which is:</p>\n\n<pre><code>shouldReturnP1\n  :: (Eq a, Show a) =&gt; Producer a (SafeT IO) () -&gt; [a] -&gt; IO ()\n</code></pre>\n\n<p>You can test it with:</p>\n\n<pre><code>testP1 = shouldReturnP1 files1 [\"a.hs\", \"b.hs\", \"c.hs\"]\n</code></pre>\n\n<p>For the IO-action version, write:</p>\n\n<pre><code>shouldReturnP2 action expected = do\n  let _ = expected :: [FilePath]\n  prod &lt;- action\n  paths &lt;- runSafeT $ runEffect $ P.toListM prod\n  paths `shouldBe` expected\n</code></pre>\n\n<p>and ghc tells you the type is:</p>\n\n<pre><code>shouldReturnP2\n  :: IO (Producer FilePath (SafeT IO) ()) -&gt; [FilePath] -&gt; IO ()\n</code></pre>\n\n<p>and a test:</p>\n\n<pre><code>testP2 = shouldReturnP2 (allfiles \".\") [\"a1.hs\"]\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>Per the discussion in the comments about putting the <code>doesFileExist</code> check in the pipe:</p>\n\n<pre><code>allfiles2 :: MonadSafe m =&gt; FilePath -&gt; Producer FilePath m ()\nallfiles2 path = do\n  exists &lt;- liftIO $ doesFileExist path\n  if exists\n    then each [path] &gt;-&gt; P.filter (\".hs\" `isSuffixOf`)\n    else find path (glob \"*.hs\" &lt;&gt; regular)\n</code></pre>\n"}], "owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 33576364, "answer_count": 1, "score": 1, "last_activity_date": 1446855432, "creation_date": 1446842096, "last_edit_date": 1446842788, "question_id": 33575290, "link": "https://stackoverflow.com/questions/33575290/haskell-pipes-how-to-use-drawall-to-test-a-producer-with-a-monadsafe-constraint", "title": "Haskell-pipes: how to use drawAll to test a producer with a MonadSafe constraint?", "body": "<p>I have a producer which, given a path, traverses the filesystem yielding Haskell files' paths. It's built on top of pipes-files:</p>\n\n<pre><code>import Pipes\nimport Pipes.Files\nimport Pipes.Safe\nimport qualified Pipes.Prelude as P\nimport Data.Monoid ((&lt;&gt;))\nimport Data.List (isSuffixOf)\nimport System.Directory (doesFileExist)\n\n\n-- | Starting from a path, generate a sequence of paths corresponding\n--   to Haskell files. The fileystem is traversed depth-first.\nallFiles :: (MonadIO m, MonadSafe m) =&gt; FilePath -&gt; IO (Producer FilePath m ())\nallFiles path = do\n    isFile &lt;- doesFileExist path\n    if isFile then return $ each [path] &gt;-&gt; P.filter (\".hs\" `isSuffixOf`)\n              else return $ find path (glob \"*.hs\" &lt;&gt; regular)\n</code></pre>\n\n<p>Now I'd like to test it with Hspec, but I'm finding it hard to transform the producer into a list. It would be simpler, were it not for that <code>MonadSafe m</code> constraint which causes a lot of type errors. Here is what I wrote:</p>\n\n<pre><code>import Pipes\nimport Pipes.Safe\nimport Pipes.Parse\nimport Test.Hspec\n\n\nshouldReturnP :: (MonadIO m, MonadSafe m)\n              =&gt; IO (Producer FilePath m ()) -&gt; [FilePath] -&gt; Expectation\nshouldReturnP action res = do\n    prod &lt;- action\n    let paths = runSafeT $ evalStateT drawAll prod\n    paths `shouldBe` res\n</code></pre>\n\n<p>This is how it should be used:</p>\n\n<pre><code>spec :: Spec\nspec = do\n    describe \"allFiles\" $\n        it \"traverses the filesystem depth-first returning only hs files\" $\n            allFiles (\"test\" &lt;/&gt; \"tree\") `shouldReturnP`\n                [ \"test\" &lt;/&gt; \"tree\" &lt;/&gt; \"a.hs\"\n                , \"test\" &lt;/&gt; \"tree\" &lt;/&gt; \"sub\"  &lt;/&gt; \"b.hs\"\n                , \"test\" &lt;/&gt; \"tree\" &lt;/&gt; \"sub\"  &lt;/&gt; \"c.hs\"\n                , \"test\" &lt;/&gt; \"tree\" &lt;/&gt; \"sub2\" &lt;/&gt; \"a.hs\"\n                , \"test\" &lt;/&gt; \"tree\" &lt;/&gt; \"sub2\" &lt;/&gt; \"e.hs\"\n                ]\n</code></pre>\n\n<p>Compiling the tests gives the following errors:</p>\n\n<pre><code>test/Spec.hs:57:47:\n    Couldn't match type \u2018m\u2019 with \u2018Pipes.Safe.SafeT []\u2019\n      \u2018m\u2019 is a rigid type variable bound by\n          the type signature for\n            shouldReturnP :: (MonadIO m, MonadSafe m) =&gt;\n                             IO (Producer FilePath m ()) -&gt; [FilePath] -&gt; Expectation\n          at test/Spec.hs:53:18\n    Expected type: Producer FilePath (Pipes.Safe.SafeT []) ()\n      Actual type: Producer FilePath m ()\n    Relevant bindings include\n      prod :: Producer FilePath m () (bound at test/Spec.hs:56:5)\n      action :: IO (Producer FilePath m ())\n        (bound at test/Spec.hs:55:15)\n      shouldReturnP :: IO (Producer FilePath m ())\n                       -&gt; [FilePath] -&gt; Expectation\n        (bound at test/Spec.hs:55:1)\n    In the second argument of \u2018evalStateT\u2019, namely \u2018prod\u2019\n    In the second argument of \u2018($)\u2019, namely \u2018evalStateT drawAll prod\u2019\n\ntest/Spec.hs:58:22:\n    Couldn't match type \u2018Char\u2019 with \u2018[Char]\u2019\n    Expected type: [[FilePath]]\n      Actual type: [FilePath]\n    In the second argument of \u2018shouldBe\u2019, namely \u2018res\u2019\n    In a stmt of a 'do' block: paths  res\n</code></pre>\n"}, {"tags": ["file", "haskell", "encoding", "io"], "answers": [{"comments": [{"owner": {"reputation": 1189, "user_id": 348201, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b5c1cb1e1615645078717836ffc3eaf?s=128&d=identicon&r=PG", "display_name": "somesoaccount", "link": "https://stackoverflow.com/users/348201/somesoaccount"}, "edited": false, "score": 0, "creation_date": 1446855438, "post_id": 33575661, "comment_id": 54932959, "body": "Just curious: Why is there no need to close the handle? Just this week I used <code>withFile</code> since I thought that would save me from manually closing the handle."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 1189, "user_id": 348201, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b5c1cb1e1615645078717836ffc3eaf?s=128&d=identicon&r=PG", "display_name": "somesoaccount", "link": "https://stackoverflow.com/users/348201/somesoaccount"}, "edited": false, "score": 1, "creation_date": 1446855681, "post_id": 33575661, "comment_id": 54933018, "body": "Because <code>hGetContents</code> will close it once you have consumed all of the input."}, {"owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "edited": false, "score": 0, "creation_date": 1446884402, "post_id": 33575661, "comment_id": 54938122, "body": "@ErikR now my program works! thanks. Please can you tell me the other possibilities?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1446905960, "post_id": 33575661, "comment_id": 54943726, "body": "if your file really consists of just <i>bytes</i>, then perhaps you should read it as a ByteString. OTOH, if the file contains <i>text</i> you should use the encoding that was used when the contents were written. See the <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/System-IO.html#g:24\" rel=\"nofollow noreferrer\">Unicode Encodings</a> section for a list of available encodings."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 6, "last_activity_date": 1446843732, "creation_date": 1446843732, "answer_id": 33575661, "question_id": 33574967, "link": "https://stackoverflow.com/questions/33574967/reading-file-with-us-ascii-encoding-in-haskell-hgetcontents-invalid-argument/33575661#33575661", "title": "Reading file with &quot;US-ASCII&quot; encoding in Haskell: hGetContents: invalid argument (invalid byte sequence)", "body": "<p>You should <code>hSetEncoding</code> to configure the file handle for a specific text encoding, e.g.:</p>\n\n<pre><code>import System.Environment\nimport System.IO\n\nmain = do\n  (path : _) &lt;- getArgs\n  h &lt;- openFile path ReadMode\n  hSetEncoding h latin1\n  contents &lt;- hGetContents h\n  -- no need to close h\n  putStrLn $ show $ length contents\n</code></pre>\n\n<p>If your file contains non-ASCII characters and it's not UTF8 encoded, then latin1 is a good bet although it's not the only possibility.</p>\n"}], "owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1707, "favorite_count": 0, "accepted_answer_id": 33575661, "answer_count": 1, "score": 5, "last_activity_date": 1446884440, "creation_date": 1446840742, "last_edit_date": 1446884440, "question_id": 33574967, "link": "https://stackoverflow.com/questions/33574967/reading-file-with-us-ascii-encoding-in-haskell-hgetcontents-invalid-argument", "title": "Reading file with &quot;US-ASCII&quot; encoding in Haskell: hGetContents: invalid argument (invalid byte sequence)", "body": "<p>I'm using Haskell for programming a parser, but this error is a wall I can't pass. Here is my code:</p>\n\n<pre><code>main = do\n  arguments    &lt;- getArgs\n  let fileName = head arguments\n  fileContents &lt;- readFile fileName\n  converter    &lt;- open \"UTF-8\" Nothing\n  let titleLength           = length fileName\n      titleWithoutExtension = take (titleLength - 4) fileName\n      allNonEmptyLines      = unlines $ tail $ filter (/= \"\") $ lines fileContents\n</code></pre>\n\n<p>When I try to read a file with \"US-ASCII\" encoding I get the famous error hGetContents: invalid argument (invalid byte sequence). I've tried to change the \"UTF-8\" in my code by \"US-ASCII\", but the error persist. Is there a way for reading this files, or any kind of file handling encoding problems?</p>\n"}, {"tags": ["haskell", "bytestring", "haskell-lens", "lenses"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1446850209, "post_id": 33575924, "comment_id": 54931801, "body": "You can avoid the 32 by using <code>fromEnum &#39; &#39;</code> or (with <code>Data.Char</code>) <code>ord &#39; &#39;</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446857541, "post_id": 33575924, "comment_id": 54933432, "body": "That is, <code>fromIntegral . fromEnum</code>, which really should have a name."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1446844926, "creation_date": 1446844926, "answer_id": 33575924, "question_id": 33573937, "link": "https://stackoverflow.com/questions/33573937/haskell-changing-an-element-at-a-given-index-in-a-bytestring/33575924#33575924", "title": "Haskell: Changing an element at a given index in a ByteString", "body": "<p>This works for ByteStrings:</p>\n\n<pre><code>import qualified Data.ByteString.Char8 as BS\nimport Control.Lens\n\n-- change character at position 2 to a space (ASCII code 32)\n\ntest = (BS.pack \"abcdef\") &amp; ix 2 .~ 32\n</code></pre>\n\n<p>Note that ByteStrings are really containers of Word8 values, so that's we need to use the ASCII code here.</p>\n\n<p>The <code>ix</code> operator works for a lot of other data structures like Text, lists, Sets, Maps, etc -- see <a href=\"https://hackage.haskell.org/package/lens-4.13/docs/Control-Lens-At.html#t:Ixed\" rel=\"nofollow\">here</a> for more details.</p>\n"}], "owner": {"reputation": 330, "user_id": 5021764, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dc1f8d5f08ef935d1f2a51db7cf02144?s=128&d=identicon&r=PG&f=1", "display_name": "the spectre", "link": "https://stackoverflow.com/users/5021764/the-spectre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 33575924, "answer_count": 1, "score": 0, "last_activity_date": 1446844926, "creation_date": 1446836937, "question_id": 33573937, "link": "https://stackoverflow.com/questions/33573937/haskell-changing-an-element-at-a-given-index-in-a-bytestring", "title": "Haskell: Changing an element at a given index in a ByteString", "body": "<p>I'm trying to change a character at indices x and y in a matrix made of <code>ByteString</code>s to a different character. Initially, I used <code>[[Char]]</code> to represent the matrix, so I was able to use <code>.~</code> from <code>Control.Lens.Setter</code> to change the value, but this doesn't seem to work for <code>[ByteString]</code>. </p>\n\n<p>Is there any way to use the lens or to modify the element without <code>unpack</code>ing the <code>ByteString</code> like I'm doing right now?</p>\n\n<p>The code, right now, is:</p>\n\n<pre><code>render :: [[Char]] -&gt; [Loc Int] -&gt; [[Char]]\nrender maze []               = maze\nrender maze (Loc (x,y):locs) = render mutate locs\n    where mutate = element y . element x .~ '*' $ maze\n</code></pre>\n\n<p>Where <code>Loc</code> is just:</p>\n\n<pre><code>newtype Loc a = Loc (a,a) deriving (Show,Eq,Ord)\n</code></pre>\n"}, {"tags": ["performance", "list", "haskell", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1446835382, "post_id": 33573389, "comment_id": 54924880, "body": "Interesting. I can&#39;t help but think that a <code>Foldable</code> that is also an <code>Alternative</code> is equivalent to a <code>Monad</code>...."}, {"owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1446839017, "post_id": 33573389, "comment_id": 54926894, "body": "@AJFarmar why would you think that? I don&#39;t know how that makes any sense"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "edited": false, "score": 0, "creation_date": 1446843790, "post_id": 33573389, "comment_id": 54929230, "body": "@user3217013 <code>bind&#39; fa f = foldr (&lt;|&gt;) empty $ foldr (:) [] (fmap f fa)</code> where <code>bind&#39; :: (Foldable f, Applicative f) =&gt; f a -&gt; (a -&gt; f b) -&gt; f b</code>. QED."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1446845029, "post_id": 33573389, "comment_id": 54929801, "body": "@AJFarmar Probably that <code>foldr (:) []</code> throws away all the structure of the thing being folded, so that <code>bind&#39; m return === m</code> fails for many otherwise law-abiding <code>Foldable</code>+<code>Alternative</code>s. Even if you skip that and define <code>bind&#39; fa f = foldr (&lt;|&gt;) empty (fmap f fa)</code> I&#39;d have the same concern -- that <code>foldr (&lt;|&gt;) empty v</code> may not have the same &quot;shape&quot; as <code>v</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1446845076, "post_id": 33573389, "comment_id": 54929831, "body": "@erdeszt Why isn&#39;t <code>concatMap</code> specialized to the more efficient version when <code>t</code> is known to be <code>[]</code>? (Perhaps just oversight by the library authors?)"}, {"owner": {"reputation": 807, "user_id": 1278218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc600c707e4f698ad2e6d0a1b9d9f119?s=128&d=identicon&r=PG", "display_name": "erdeszt", "link": "https://stackoverflow.com/users/1278218/erdeszt"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1446852724, "post_id": 33573389, "comment_id": 54932212, "body": "@DanielWagner I don&#39;t actually know, might worth asking on irc(or opening a pr)."}], "tags": [], "owner": {"reputation": 807, "user_id": 1278218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc600c707e4f698ad2e6d0a1b9d9f119?s=128&d=identicon&r=PG", "display_name": "erdeszt", "link": "https://stackoverflow.com/users/1278218/erdeszt"}, "is_accepted": true, "score": 8, "last_activity_date": 1446839847, "last_edit_date": 1446839847, "creation_date": 1446834845, "answer_id": 33573389, "question_id": 33573059, "link": "https://stackoverflow.com/questions/33573059/why-is-faster-than-concatmap-when-they-ought-to-be-the-same-thing/33573389#33573389", "title": "Why is &gt;&gt;= faster than concatMap when they ought to be the same thing?", "body": "<p>In base 4.8 <code>(&gt;&gt;=)</code> is implemented (see <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/src/GHC.Base.html#line-726\" rel=\"nofollow noreferrer\">here</a>) as:</p>\n\n<pre><code>xs &gt;&gt;= f = [y | x &lt;- xs, y &lt;- f x]\n</code></pre>\n\n<p>and <code>concatMap</code> is using a more complicated builder(source <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/src/Data.Foldable.html#concatMap\" rel=\"nofollow noreferrer\">here</a>)</p>\n\n<pre><code>concatMap :: Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]\nconcatMap f xs = build (\\c n -&gt; foldr (\\x b -&gt; foldr c b (f x)) n xs)\n</code></pre>\n"}], "owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 1, "accepted_answer_id": 33573389, "answer_count": 1, "score": 11, "last_activity_date": 1446839980, "creation_date": 1446833545, "last_edit_date": 1446839980, "question_id": 33573059, "link": "https://stackoverflow.com/questions/33573059/why-is-faster-than-concatmap-when-they-ought-to-be-the-same-thing", "title": "Why is &gt;&gt;= faster than concatMap when they ought to be the same thing?", "body": "<p>Last night, I was writing some recreational code, and at some point I replaced a <code>concatMap</code> with <code>&gt;&gt;=</code> and saw a ~10% speedup in my code. </p>\n\n<p>I was under the impression the definition of <code>&gt;&gt;=</code> for <code>[]</code> was exactly <code>concatMap</code>, so I am a little confused.</p>\n"}, {"tags": ["string", "function", "haskell", "char"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5524099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b222b4e40769b8445d9a6ef26e42ea89?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hirst", "link": "https://stackoverflow.com/users/5524099/j-hirst"}, "edited": false, "score": 0, "creation_date": 1446833121, "post_id": 33572793, "comment_id": 54923732, "body": "When trying to implement this into my code, I receive the error message &quot;Missing binding for variable &quot;.&quot; in type signature&quot;. I understand where you are coming from using the <code>.</code> operator, though, yet I&#39;m fairly new to Haskell and I&#39;m trying to get grips with the whole concept of it."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 5, "user_id": 5524099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b222b4e40769b8445d9a6ef26e42ea89?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hirst", "link": "https://stackoverflow.com/users/5524099/j-hirst"}, "edited": false, "score": 0, "creation_date": 1446833256, "post_id": 33572793, "comment_id": 54923793, "body": "@J.Hirst You don&#39;t have to copy the <code>(.) :: ...</code> line, that&#39;s already defined by Haskell. Just use the <code>.</code> operator as shown above. If you do copy the type annotation, Haskell assumes you are redefining the standard operator, and will complain if you do not so later on."}, {"owner": {"reputation": 5, "user_id": 5524099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b222b4e40769b8445d9a6ef26e42ea89?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hirst", "link": "https://stackoverflow.com/users/5524099/j-hirst"}, "edited": false, "score": 0, "creation_date": 1446833679, "post_id": 33572793, "comment_id": 54923994, "body": "Ah, thank you, I understand. The program seems to be working again without any issues, however when I input <code>letter &#39;a&#39;</code> the program can&#39;t seem to recognise what I am entering into it. I can&#39;t say I&#39;ve seen the error which it is giving me, either. &quot;pattern match failure: letter &#39;a&#39;&quot;."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 5, "user_id": 5524099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b222b4e40769b8445d9a6ef26e42ea89?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hirst", "link": "https://stackoverflow.com/users/5524099/j-hirst"}, "edited": false, "score": 0, "creation_date": 1446835827, "post_id": 33572793, "comment_id": 54925106, "body": "@J.Hirst You&#39;re only testing for the letter &#39;A&#39;. Make a back-up case. But this is <i>not</i> the place to ask this, try <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">LYAH</a>."}], "tags": [], "owner": {"reputation": 874, "user_id": 3842022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d9729ff4035657e7d6366611c28614?s=128&d=identicon&r=PG&f=1", "display_name": "C. Quilley", "link": "https://stackoverflow.com/users/3842022/c-quilley"}, "is_accepted": false, "score": 3, "last_activity_date": 1446832534, "creation_date": 1446832534, "answer_id": 33572793, "question_id": 33572725, "link": "https://stackoverflow.com/questions/33572725/haskell-getting-the-output-of-a-function-to-be-used-as-an-input-to-another/33572793#33572793", "title": "Haskell: Getting the output of a function to be used as an input to another?", "body": "<p>When you want to feed the output of one function into another, this is exactly function composition, using the operator <code>.</code>:</p>\n\n<pre><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)\n</code></pre>\n\n<p>So, you would want:</p>\n\n<pre><code>anyLetter :: Char -&gt; String\nanyLetter = letter . capital\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5524099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b222b4e40769b8445d9a6ef26e42ea89?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hirst", "link": "https://stackoverflow.com/users/5524099/j-hirst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1446832844, "creation_date": 1446832286, "last_edit_date": 1446832844, "question_id": 33572725, "link": "https://stackoverflow.com/questions/33572725/haskell-getting-the-output-of-a-function-to-be-used-as-an-input-to-another", "title": "Haskell: Getting the output of a function to be used as an input to another?", "body": "<p>I have created the alphabet using the following code;</p>\n\n<pre><code>letter :: Char -&gt; [String]\n\nletter 'A' = [\" AAA \",\"A   A\",\"AAAAA\",\"A   A\",\"A   A\"]\n</code></pre>\n\n<p>and so on for each letter. Along with another function which capitalises a lowercase letter which is inputted by the user using the following code:</p>\n\n<pre><code>capital :: Char -&gt; Char\n\ncapital letter\n    | ord letter &gt;= ord 'a' &amp;&amp; ord letter &lt;= ord 'z' = chr (ord letter + (ord 'A' - ord 'a'))\n    | otherwise                                      = letter\n</code></pre>\n\n<p>All I am trying to do is to input <code>letter 'a'</code> in lowercase so the program can capitalise the letter and print out the capitalised 'A' used in the <code>letter 'A'</code>.</p>\n"}, {"tags": ["haskell", "yaml"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1446820090, "post_id": 33568787, "comment_id": 54915934, "body": "maybe it&#39;s one of this stupid line-ending thing - how does the YAML file look like? Can you try copy&amp;pasting it to a new file (on linux) and retry?"}, {"owner": {"reputation": 28845, "user_id": 238232, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ccda2293fc93c7a871956102004ac19d?s=128&d=identicon&r=PG", "display_name": "cnd", "link": "https://stackoverflow.com/users/238232/cnd"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446820655, "post_id": 33568787, "comment_id": 54916329, "body": "@Carsten copy&amp;pasting doesn&#39;t work even if I copy config from windows, but sure <code>[]</code> config works / btw not sure currently but looks like windows is using <code>LF</code> and linux is using <code>CRLF</code> there :S"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446820824, "post_id": 33568787, "comment_id": 54916421, "body": "<code>[]</code> as in empty file? ... It&#39;s really hard to tell if you don&#39;t give us more details on the file and on the type you finally decode into"}, {"owner": {"reputation": 28845, "user_id": 238232, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ccda2293fc93c7a871956102004ac19d?s=128&d=identicon&r=PG", "display_name": "cnd", "link": "https://stackoverflow.com/users/238232/cnd"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446821015, "post_id": 33568787, "comment_id": 54916524, "body": "@Carsten [] is empty yaml config. here is paste of file <a href=\"https://bpaste.net/show/31c112c04879\" rel=\"nofollow noreferrer\">bpaste.net/show/31c112c04879</a> and config <a href=\"https://gist.github.com/Heather/5231925d6c123c92d576\" rel=\"nofollow noreferrer\">gist.github.com/Heather/5231925d6c123c92d576</a>"}], "answers": [{"comments": [{"owner": {"reputation": 28845, "user_id": 238232, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ccda2293fc93c7a871956102004ac19d?s=128&d=identicon&r=PG", "display_name": "cnd", "link": "https://stackoverflow.com/users/238232/cnd"}, "edited": false, "score": 0, "creation_date": 1447073831, "post_id": 33570941, "comment_id": 54993609, "body": "my actual error there is <code>failed to parse field enabled: expected Bool, encountered Null</code>"}, {"owner": {"reputation": 28845, "user_id": 238232, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ccda2293fc93c7a871956102004ac19d?s=128&d=identicon&r=PG", "display_name": "cnd", "link": "https://stackoverflow.com/users/238232/cnd"}, "edited": false, "score": 0, "creation_date": 1447074040, "post_id": 33570941, "comment_id": 54993709, "body": "and I&#39;m still being not sure what is the reason for it :/ bug with maybies?"}, {"owner": {"reputation": 28845, "user_id": 238232, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ccda2293fc93c7a871956102004ac19d?s=128&d=identicon&r=PG", "display_name": "cnd", "link": "https://stackoverflow.com/users/238232/cnd"}, "edited": false, "score": 0, "creation_date": 1447074760, "post_id": 33570941, "comment_id": 54994106, "body": "<a href=\"https://hackage.haskell.org/package/aeson-0.10.0.0/docs/src/Data-Aeson-Types-Instances.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/aeson-0.10.0.0/docs/src/&hellip;</a> - should be related but can&#39;t dig into actual problem for now"}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 3, "last_activity_date": 1446826205, "creation_date": 1446826205, "answer_id": 33570941, "question_id": 33568787, "link": "https://stackoverflow.com/questions/33568787/yaml-library-on-linux-doesnt-decode-what-its-encoded/33570941#33570941", "title": "yaml library on linux doesn&#39;t decode what it&#39;s encoded", "body": "<p>In cases of <code>Nothing</code>, it's best to grab more information by using <code>decodeEither</code>/<code>decodeEither'</code>. The left side of the either value will contain an error message telling you where the failure occurs. If you switch over, you'll see that the parsing is failing due to the <code>error \"Can't parse Repository from YAML\"</code> line (see <code>attempt1</code> below). It's encountering something besides an Object!</p>\n\n<p>It's best then to see what the heck the YAML package is decoding to then, by decoding to the type we know that has to succeed \u2014 Value. Decoding, we get this (see <code>attempt2</code> below):</p>\n\n<pre><code>Right (Array (fromList [Object (fromList [(\"group\",Null),(\"branches\",Array (fromList [String \"master\"])),(\"hash\",Null),(\"clean\",Null),(\"location\",String \"/home/gentoo-haskell\"),(\"enabled\",Null),(\"root\",Null),(\"postRebuild\",Null),(\"upstream\",String \"upstream master\"),(\"task\",String \"rebase\"),(\"positive\",Null)])]))\n</code></pre>\n\n<p>It appears the root data structure is an Array and not an Object. There are lots of ways to fix this, and I chose a hacky one.</p>\n\n<pre><code>parseJSON (Array array) = parseJSON (array ! 0)\n</code></pre>\n\n<p>This makes the program work! I pasted my code below. (Apologies for the use of lens; I use it to convert between strings and bytestrings for quick scripts like these. Your program will of course work perfectly fine without it.)</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule Lib where\n\nimport Control.Lens\nimport Data.ByteString\nimport Data.ByteString.Lens\nimport Data.Vector\nimport Data.Yaml\n\ndata Repository = Repository\n    { location      :: String\n    , task          :: String\n    , branches      :: [String]\n    , upstream      :: String\n    , enabled       :: Maybe Bool\n    , root          :: Maybe Bool\n    , positive      :: Maybe Bool\n    , clean         :: Maybe Bool\n    , postRebuild   :: Maybe [String]\n    , syncGroup     :: Maybe String\n    , hash          :: Maybe String\n    } deriving (Show, Eq)\n\n\ninstance FromJSON Repository where\n    parseJSON (Object v) = Repository &lt;$&gt;\n                           v .:  \"location\"     &lt;*&gt;\n                           v .:  \"task\"         &lt;*&gt;\n                           v .:  \"branches\"     &lt;*&gt;\n                           v .:  \"upstream\"     &lt;*&gt;\n                           v .:? \"enabled\"      &lt;*&gt;\n                           v .:? \"root\"         &lt;*&gt;\n                           v .:? \"positive\"     &lt;*&gt;\n                           v .:? \"clean\"        &lt;*&gt;\n                           v .:? \"postRebuild\"  &lt;*&gt;\n                           v .:? \"group\"        &lt;*&gt;\n                           v .:? \"hash\"\n    parseJSON (Array array) = parseJSON (array ! 0)\n\nraw :: String\nraw = unlines [\n    \"- group: null\",\n    \"  branches:\",\n    \"  - master\",\n    \"  hash: null\",\n    \"  clean: null\",\n    \"  location: /home/gentoo-haskell\",\n    \"  enabled: null\",\n    \"  root: null\",\n    \"  postRebuild: null\",\n    \"  upstream: upstream master\",\n    \"  task: rebase\",\n    \"  positive: null\"]\n\nattempt1 :: Either ParseException Repository\nattempt1 = decodeEither' (raw ^. packedChars)\n\nattempt2 :: Either ParseException Value\nattempt2 = decodeEither' (raw ^. packedChars)\n</code></pre>\n"}], "owner": {"reputation": 28845, "user_id": 238232, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ccda2293fc93c7a871956102004ac19d?s=128&d=identicon&r=PG", "display_name": "cnd", "link": "https://stackoverflow.com/users/238232/cnd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 33570941, "answer_count": 1, "score": 1, "last_activity_date": 1446826205, "creation_date": 1446819262, "question_id": 33568787, "link": "https://stackoverflow.com/questions/33568787/yaml-library-on-linux-doesnt-decode-what-its-encoded", "title": "yaml library on linux doesn&#39;t decode what it&#39;s encoded", "body": "<p>decode / encode:</p>\n\n<pre><code>yDecode :: FromJSON iFromJSONable \u21d2 FilePath \u2192 IO iFromJSONable\nyDecode fnm = do\n  ymlData \u2190 BS.readFile fnm\n  return $ fromMaybe (error \"Can't parse from YAML\") (decode ymlData)\n\nyEncode :: ToJSON iToJSONable \u21d2 FilePath \u2192 iToJSONable \u2192 IO()\nyEncode fnm dat = BS.writeFile fnm $ encode dat\n</code></pre>\n\n<p>I create config with this encode and it creates just fine but when I'm reading it - I'm getting this error: <code>Can't parse from YAML</code> - on windows same code works fine and there I just can't understand what is possibly wrong?</p>\n"}, {"tags": ["haskell", "types", "declaration", "division"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3476725"}, "edited": false, "score": 1, "creation_date": 1446816396, "post_id": 33567644, "comment_id": 54913614, "body": "Thank you! Turns out that I was indeed being an idiot, but your excellent, concise answer just spared me a lot of shouting at the compiler even though it&#39;s my own fault. Of course <code>m * (m + 1)</code> will always be even as long as <code>m</code> is even and of course <code>m</code> will always be even, as long I use <code>div</code> and whole numbers to compute it."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 2, "creation_date": 1446822755, "post_id": 33567644, "comment_id": 54917651, "body": "@odiumediae <code>m * (m + 1)</code> will also be even whenever <code>m</code> is odd because <code>m + 1</code> will then be even."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 5, "last_activity_date": 1446816403, "last_edit_date": 1446816403, "creation_date": 1446815639, "answer_id": 33567644, "question_id": 33567543, "link": "https://stackoverflow.com/questions/33567543/how-do-i-write-a-type-declaration-for-this-function/33567644#33567644", "title": "How do I write a type declaration for this function?", "body": "<p><sub>Note: This post is written in <a href=\"https://wiki.haskell.org/Literate_programming\" rel=\"nofollow\">literate Haskell</a>. You can save it as Max.lhs and try it in your GHCi.</sub></p>\n\n<hr>\n\n<h2>A quick solution</h2>\n\n<p>First of all, lets reason your use of <code>(/2)</code>. Is the number <code>n * m * (m + 1)</code> odd or even? Well, either <code>m</code> is odd, and <code>m + 1</code> is even, and therefore the whole product is even, or <code>m</code> is even and the same arguments hold.</p>\n\n<p>So instead of <code>n * m * (m + 1) / 2</code>, we can use <code>n * m * (m + 1) `div` 2</code>:</p>\n\n<pre><code>&gt; maxFor l n = n * m * (m + 1) `div` 2 \n&gt;    where m = l `div` n\n</code></pre>\n\n<p>Now, all we have to to is to check the types of the functions we use:</p>\n\n<pre><code>(+)  :: Num a =&gt; a -&gt; a -&gt; a\n(*)  :: Num a =&gt; a -&gt; a -&gt; a\ndiv  :: Integral n =&gt; n -&gt; n -&gt; n\n</code></pre>\n\n<p>And that leads directly to your type:</p>\n\n<pre><code>&gt; maxFor :: Integral n =&gt; n -&gt; n -&gt; n\n</code></pre>\n\n<p>Alternatively, you can use some specific type to get errors out:</p>\n\n<pre><code>maxFor :: Integer -&gt; Integer -&gt; Integer\n-- Now GHC yells at you since Integer doesn't have a Fractional instance\n-- and you try to use (/).\n</code></pre>\n\n<h2>Background information</h2>\n\n<p>You've already recognized the problem. <code>div</code> indicates that <code>l</code> and <code>n</code> are some integral types, but <code>(/)</code> indicates that they're fractional. In your usual <code>Prelude</code>, there is no data type that's an instance of both typeclasses. You can check this in GHCi:</p>\n\n<pre><code>Prelude&gt; :info Fractional\nclass Num a =&gt; Fractional a where\n  (/) :: a -&gt; a -&gt; a\n  recip :: a -&gt; a\n  fromRational :: Rational -&gt; a\n    -- Defined in \u2018GHC.Real\u2019\n\ninstance Fractional Float -- Defined in \u2018GHC.Float\u2019\ninstance Fractional Double -- Defined in \u2018GHC.Float\u2019\n\nPrelude&gt; :info Integral\nclass (Real a, Enum a) =&gt; Integral a where\n  quot :: a -&gt; a -&gt; a\n  rem :: a -&gt; a -&gt; a\n  div :: a -&gt; a -&gt; a\n  mod :: a -&gt; a -&gt; a\n  quotRem :: a -&gt; a -&gt; (a, a)\n  divMod :: a -&gt; a -&gt; (a, a)\n  toInteger :: a -&gt; Integer\n    -- Defined in \u2018GHC.Real\u2019\ninstance Integral Word -- Defined in \u2018GHC.Real\u2019\ninstance Integral Integer -- Defined in \u2018GHC.Real\u2019\ninstance Integral Int -- Defined in \u2018GHC.Real\u2019\n</code></pre>\n\n<p>This is the first part.</p>\n\n<p>The second part stems from literals. <code>999</code> or <code>5</code> has type <code>Num a =&gt; a</code>. Now GHC is between a rock and a hard place: it has to find a <code>Num</code> instance, that's both <code>Integral</code> and <code>Fractional</code>. Since there's no such type (see above), GHC gives up due to ambiguity. You can check this too in GHCi:</p>\n\n<pre><code>Prelude&gt; 5 :: Num a =&gt; a\n5\n\nPrelude&gt; 5 :: (Fractional a, Integral a) =&gt; a\n&lt;interactive&gt;:7:1:\n    No instance for (Fractional a0) arising from a use of \u2018it\u2019\n    The type variable \u2018a0\u2019 is ambiguous\n    Note: there are several potential instances:\n      instance Integral a =&gt; Fractional (GHC.Real.Ratio a)\n        -- Defined in \u2018GHC.Real\u2019\n      instance Fractional Double -- Defined in \u2018GHC.Float\u2019\n      instance Fractional Float -- Defined in \u2018GHC.Float\u2019\n    In the first argument of \u2018print\u2019, namely \u2018it\u2019\n    In a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>So this is mainly the reason why you end up with the error.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3476725"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 33567644, "answer_count": 1, "score": 2, "last_activity_date": 1446816641, "creation_date": 1446815270, "last_edit_date": 1495539870, "question_id": 33567543, "link": "https://stackoverflow.com/questions/33567543/how-do-i-write-a-type-declaration-for-this-function", "title": "How do I write a type declaration for this function?", "body": "<p>I'm still rather new to Haskell and I've encountered a problem that probably shouldn't be too hard to solve but totally stumped me.</p>\n\n<p>I've written a function:</p>\n\n<pre><code>maxFor l n = n * m * (m + 1) / 2 where m = l `div` n\n</code></pre>\n\n<p>The function belongs to a small module which loads without problems, but throws two errors that are embarrassingly cryptic to me, whenever I try to use the function after loading the module:</p>\n\n<pre><code>&lt;interactive&gt;:182:1:\n    No instance for (Integral a0) arising from a use of `maxFor'\n    The type variable `a0' is ambiguous\n    Possible fix: add a type signature that fixes these type variable(s)\n    Note: there are several potential instances:\n      instance Integral Int -- Defined in `GHC.Real'\n      instance Integral Integer -- Defined in `GHC.Real'\n      instance Integral GHC.Types.Word -- Defined in `GHC.Real'\n    In the expression: maxFor 999 5\n    In an equation for `it': it = maxFor 999 5\n\n&lt;interactive&gt;:182:8:\n    No instance for (Num a0) arising from the literal `999'\n    The type variable `a0' is ambiguous\n    Possible fix: add a type signature that fixes these type variable(s)\n    Note: there are several potential instances:\n      instance Num Double -- Defined in `GHC.Float'\n      instance Num Float -- Defined in `GHC.Float'\n      instance Integral a =&gt; Num (GHC.Real.Ratio a)\n        -- Defined in `GHC.Real'\n      ...plus three others\n    In the first argument of `maxFor', namely `999'\n    In the expression: maxFor 999 5\n    In an equation for `it': it = maxFor 999 5\n</code></pre>\n\n<p>I understand it's telling me my function is missing  a proper type declaration, but I don't understand how to write it without the compiler nagging again. I've tried countless variants and that I don't understand the actual problem doesn't help me to solve the problem.</p>\n\n<p>Part of the problem might be that I'm using <code>(/)</code> and <code>div</code> in one function, so the needed type declaration will probably contain <code>Fractional</code> and/or <code>Integral</code>, since:</p>\n\n<pre><code>(/) :: Fractional a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>div :: Integral a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>But that's as far as I've got and I'm stuck. How would I write the type declaration for <code>maxFor</code>? What am I doing wrong? Am I missing or overlooking something that should be obvious?</p>\n\n<p>Any help and constructive feedback is greatly appreciated.</p>\n\n<p>EDIT: I've found <a href=\"https://stackoverflow.com/questions/2376981/haskell-types-frustrating-a-simple-average-function?rq=1\">this</a> answer on stack overflow, which already helps a little. I'd still appreciate help, but I will of course delete the question, if it turns out I'm being an idiot and end up being downvoted.</p>\n"}, {"tags": ["haskell", "repa"], "answers": [{"comments": [{"owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "edited": false, "score": 0, "creation_date": 1446817418, "post_id": 33567918, "comment_id": 54914254, "body": "thanks. I worked just adding the language pragma. Got some ideas about literature to read to understand why this is necessary to add?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "edited": false, "score": 0, "creation_date": 1446818052, "post_id": 33567918, "comment_id": 54914684, "body": "Here&#39;s a good place to start: <a href=\"https://ocharles.org.uk/blog/posts/2014-12-08-type-operators.html\" rel=\"nofollow noreferrer\">24 Days of GHC Extensions - Type Operators</a>"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1446816842, "last_edit_date": 1446816842, "creation_date": 1446816467, "answer_id": 33567918, "question_id": 33566889, "link": "https://stackoverflow.com/questions/33566889/how-to-resolve-use-of-operators-in-type-declaration-repa/33567918#33567918", "title": "how to resolve use of operators in type declaration (Repa) ?", "body": "<p>You can use the command line option <code>-XTypeOperators</code> to either ghc or ghci, e.g.:</p>\n\n<pre><code>ghci -XTypeOperators ...\n</code></pre>\n\n<p>Or you can use the OPTIONS_GHC pragma in your source file:</p>\n\n<pre><code>{-# OPTIONS_GHC -XTypeOperators #-}\n</code></pre>\n\n<p><strike>I'm not sure why <code>LANGUAGE TypeOperators</code> is not recognized.</strike></p>\n\n<p>or the LANGUAGE pragma:</p>\n\n<pre><code>{-# LANGUAGE TypeOperators #-}\n</code></pre>\n\n<p>(make sure to spell it correctly.)</p>\n\n<p>In this case the type of <code>t</code> is inferable, so you can use <code>:t</code> in ghci:</p>\n\n<pre><code>$ ghci\nPrelude&gt; import qualified Data.Array.Repa as R\nPrelude R&gt; let t =  R.fromListUnboxed (R.Z R.:. (10::Int)) ([1.0..10]::[Float])\nPrelude R&gt; :t t\nt :: R.Array R.U (R.Z R.:. Int) Float\n</code></pre>\n\n<p>Note: I'm using GHC 7.10.2.</p>\n"}], "owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1280, "favorite_count": 0, "accepted_answer_id": 33567918, "answer_count": 1, "score": 0, "last_activity_date": 1446816842, "creation_date": 1446813168, "question_id": 33566889, "link": "https://stackoverflow.com/questions/33566889/how-to-resolve-use-of-operators-in-type-declaration-repa", "title": "how to resolve use of operators in type declaration (Repa) ?", "body": "<p>I am playing around with Repa, and the code below can compile and run. </p>\n\n<pre><code>import qualified Data.Array.Repa as R\n--t:: R.Array R.U (R.Z R.:. Int) Float \n--t =  R.fromListUnboxed (R.Z R.:. (10::Int)) ([1.0..10]::[Float])\n\nmain = do \n   let x = R.fromListUnboxed (R.Z R.:. (10::Int)) ([1.0..10]::[Float])\n   print x\n</code></pre>\n\n<p>I believe (from check in ghci) that x has the type signature that I have declared t to have, but I get this error if I uncomment everything associated with t:</p>\n\n<pre><code>Illegal operator \u2018R.:.\u2019 in type \u2018R.Z R.:. Int\u2019\n  Use TypeOperators to allow operators in types\n</code></pre>\n\n<p>what is the correct way to resolve the use of an type operator/constructor in type declarations? (I will google some more, but would like to ask anyway too learn more) </p>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1446807781, "creation_date": 1446807781, "answer_id": 33565357, "question_id": 33565246, "link": "https://stackoverflow.com/questions/33565246/unpacking-io-bytestring-in-ghci/33565357#33565357", "title": "Unpacking IO ByteString in ghci", "body": "<p><code>fmap</code> teaches pure functions how to muck about with impure inputs:</p>\n\n<pre><code>fmap :: (a -&gt; b) -&gt; IO a -&gt; IO b\n</code></pre>\n\n<p>and <code>(=&lt;&lt;)</code> teaches impure functions how to muck about with impure inputs:</p>\n\n<pre><code>(=&lt;&lt;) :: (a -&gt; IO b) -&gt; IO a -&gt; IO b\n</code></pre>\n\n<p>And, of course, in ghci, there is the handy <code>do</code>-notation available as a shorthand for uses of <code>(=&lt;&lt;)</code>, so that if you write</p>\n\n<pre><code>&gt; x &lt;- Data.ByteString.readFile \"/path/to/image.jpg\"\n</code></pre>\n\n<p>then you will have <code>x :: ByteString</code> bound in the remainder of your session, even though <code>Data.ByteString.readFile \"/path/to/image.jpg\" :: IO ByteString</code>.</p>\n"}], "owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 1, "accepted_answer_id": 33565357, "answer_count": 1, "score": 1, "last_activity_date": 1446807781, "creation_date": 1446807441, "question_id": 33565246, "link": "https://stackoverflow.com/questions/33565246/unpacking-io-bytestring-in-ghci", "title": "Unpacking IO ByteString in ghci", "body": "<p>I am trying to do some image manipulation in Haskell with an image library. Opening the image with the library requires a <code>ByteString</code> type. I want to test the library in ghci but when I load a file it has the type <code>IO ByteString</code> and cannot be used.</p>\n\n<p>How can I unpack the <code>ByteString</code> data from the <code>IO ByteString</code> type in ghci?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 11, "creation_date": 1446805163, "post_id": 33564368, "comment_id": 54906931, "body": "Just because the only <code>RealFloat</code> instances that come with GHC obey IEEE754, it doesn&#39;t mean you can&#39;t define your own instances which don&#39;t."}, {"owner": {"reputation": 14317, "user_id": 182402, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/de96aa2f424a48b2510a7d29c65a8ace?s=128&d=identicon&r=PG", "display_name": "Wander Nauta", "link": "https://stackoverflow.com/users/182402/wander-nauta"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1446805552, "post_id": 33564368, "comment_id": 54907193, "body": "@leftaroundabout Wait, you can actually define your own floating point type?"}, {"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 7, "creation_date": 1446805676, "post_id": 33564368, "comment_id": 54907281, "body": "@WanderNauta That&#39;s the point of typeclasses, as long as you can provide the functions you can have your type as an instance of it."}, {"owner": {"reputation": 14317, "user_id": 182402, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/de96aa2f424a48b2510a7d29c65a8ace?s=128&d=identicon&r=PG", "display_name": "Wander Nauta", "link": "https://stackoverflow.com/users/182402/wander-nauta"}, "reply_to_user": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 0, "creation_date": 1446806034, "post_id": 33564368, "comment_id": 54907514, "body": "@Koterpillar Neat! That actually makes a lot of sense."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1446811239, "post_id": 33564368, "comment_id": 54910533, "body": "Additionally, you could theoretically be running Haskell on some bizarre platform that doesn&#39;t have IEEE754-compliant floating point hardware. (Although I think this is pretty unlikely...)"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446828134, "post_id": 33564368, "comment_id": 54921063, "body": "BTW, this method uses the ancient habit of passing an argument that is purely by convention never looked at, just to dispatch on its type. These days it is considered cleaner practice to use <code>Proxy</code>, which ensures the actual value of a type <i>cannot</i> matter (because none is passed)."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1446831073, "post_id": 33564368, "comment_id": 54922672, "body": "Once upon a time IEEE-754 non-compliance was a real possibility. So it made sense to have this flag. These days of course its largely (entirely?) redundant, as I doubt you could buy non-compliant hardware if you tried. But there may be software out there that won&#39;t compile without it."}], "answers": [{"tags": [], "owner": {"reputation": 14317, "user_id": 182402, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/de96aa2f424a48b2510a7d29c65a8ace?s=128&d=identicon&r=PG", "display_name": "Wander Nauta", "link": "https://stackoverflow.com/users/182402/wander-nauta"}, "is_accepted": true, "score": 7, "last_activity_date": 1446812759, "last_edit_date": 1446812759, "creation_date": 1446811125, "answer_id": 33566330, "question_id": 33564368, "link": "https://stackoverflow.com/questions/33564368/why-does-haskell-have-isieee-if-it-always-evaluates-to-true/33566330#33566330", "title": "Why does Haskell have isIEEE if it always evaluates to True?", "body": "<p>As <a href=\"https://stackoverflow.com/users/745903/leftaroundabout\">leftaroundabout</a> and <a href=\"https://stackoverflow.com/users/288201/koterpillar\">Koterpillar</a> mentioned in the comments, it is possible to define your own instances of RealFloat. These custom-made float types do not necessarily have to follow the IEEE standards.</p>\n\n<pre><code>instance RealFloat MyFloat where\n  isIEEE _ = False\n  ...\n</code></pre>\n\n<p>Additionally, if your floating-point type isn't IEEE, you are allowed to have all RealFloat predicates return False:</p>\n\n<blockquote>\n  <p>(...) The functions isNaN, isInfinite, isDenormalized, isNegativeZero, and\n  isIEEE all support numbers represented using the IEEE standard. For\n  non-IEEE floating point numbers, these may all return false.</p>\n  \n  <p><a href=\"https://www.haskell.org/onlinereport/basic.html\" rel=\"nofollow\">Haskell 98 Report, 6.4.6</a></p>\n</blockquote>\n"}], "owner": {"reputation": 14317, "user_id": 182402, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/de96aa2f424a48b2510a7d29c65a8ace?s=128&d=identicon&r=PG", "display_name": "Wander Nauta", "link": "https://stackoverflow.com/users/182402/wander-nauta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 33566330, "answer_count": 1, "score": 9, "last_activity_date": 1446812759, "creation_date": 1446804850, "question_id": 33564368, "link": "https://stackoverflow.com/questions/33564368/why-does-haskell-have-isieee-if-it-always-evaluates-to-true", "title": "Why does Haskell have isIEEE if it always evaluates to True?", "body": "<p>The Haskell <code>RealFloat</code> typeclass has a function called <code>isIEEE</code> which, according to the <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:isIEEE\">documentation</a>, gives 'True if the argument is an IEEE floating point number' (and, one would imagine, False otherwise).</p>\n\n<p>But here's the implementation of <code>isIEEE</code> for <code>Float</code>:</p>\n\n<pre><code>instance RealFloat Float where\n  ...\n  isIEEE _ = True\n</code></pre>\n\n<p>And here's the implementation for <code>Double</code>:</p>\n\n<pre><code>instance RealFloat Double where\n  ...\n  isIEEE _ = True\n</code></pre>\n\n<p>If <code>isIEEE</code> is always unconditionally <code>True</code>, why use it? Why have it in the Prelude at all?</p>\n"}, {"tags": ["haskell", "emacs"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1446800713, "post_id": 33562783, "comment_id": 54904202, "body": "just <code>:r</code> right in the <code>REPL</code> buffer should work"}, {"owner": {"reputation": 3832, "user_id": 2553416, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3cb1756924bd03cc01d107852dd81acf?s=128&d=identicon&r=PG", "display_name": "LogicChains", "link": "https://stackoverflow.com/users/2553416/logicchains"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446801395, "post_id": 33562783, "comment_id": 54904584, "body": "Ah, great, that works fine. If you want to submit that as an answer I&#39;ll accept it. Surprised there&#39;s not an Emacs-Mode hotkey for it though."}, {"owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 2, "creation_date": 1446801870, "post_id": 33562783, "comment_id": 54904889, "body": "@LogicChains: it&#39;s on the list: <a href=\"https://github.com/haskell/haskell-mode/issues/807\" rel=\"nofollow noreferrer\">github.com/haskell/haskell-mode/issues/807</a>"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1446808524, "post_id": 33562783, "comment_id": 54909028, "body": "Emacs hot key is <code>C-c-l</code>."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 3, "last_activity_date": 1446801866, "creation_date": 1446801866, "answer_id": 33563378, "question_id": 33562783, "link": "https://stackoverflow.com/questions/33562783/how-to-only-reload-current-file-in-emacs-haskell-mode/33563378#33563378", "title": "How to only reload current file in Emacs Haskell Mode", "body": "<p>If you switch to the <em>REPL</em>-Buffer and just reload (<code>:r</code>) it should work as expected.</p>\n"}, {"tags": [], "owner": {"reputation": 568, "user_id": 1867082, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/582ce4225fd51413e5758c795263759b?s=128&d=identicon&r=PG&f=1", "display_name": "Gracjan Polak", "link": "https://stackoverflow.com/users/1867082/gracjan-polak"}, "is_accepted": false, "score": 2, "last_activity_date": 1453022645, "creation_date": 1453022645, "answer_id": 34836862, "question_id": 33562783, "link": "https://stackoverflow.com/questions/33562783/how-to-only-reload-current-file-in-emacs-haskell-mode/34836862#34836862", "title": "How to only reload current file in Emacs Haskell Mode", "body": "<p>Recently <code>:reload</code> got its own keybinding: <code>C-c C-r</code>.</p>\n"}], "owner": {"reputation": 3832, "user_id": 2553416, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3cb1756924bd03cc01d107852dd81acf?s=128&d=identicon&r=PG", "display_name": "LogicChains", "link": "https://stackoverflow.com/users/2553416/logicchains"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 33563378, "answer_count": 2, "score": 2, "last_activity_date": 1453022645, "creation_date": 1446799751, "question_id": 33562783, "link": "https://stackoverflow.com/questions/33562783/how-to-only-reload-current-file-in-emacs-haskell-mode", "title": "How to only reload current file in Emacs Haskell Mode", "body": "<p>In Emacs' Haskell-Mode, I can push <code>ctrl-c ctrl-l</code> to reload the current file in the REPL. Each time I do this, however, it compiles all the file's local dependencies (modules in the same folder), which takes a bit of time. Is there a simple way to reload only the current file/module and skip recompiling the others? It must be possible somehow, as my external dependencies don't need to be recompiled each time.</p>\n"}]