[{"tags": ["haskell", "functional-programming", "monads"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1542843194, "post_id": 53421838, "comment_id": 93718289, "body": "As a hint, try writing an auxiliary function <code>[m (MyTree a)] -&gt; m [MyTree a]</code> first (or use <code>sequence</code> from the libraries). Then think about how you can exploit that for <code>xs</code>. You will probably realize that you don&#39;t even need to handle the first element <code>x</code> in a special way, but you can directly use <code>check (MyTree v xs) =...</code>."}, {"owner": {"reputation": 45, "user_id": 10688321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75a2a7fb83cbaaeba152b869095b7641?s=128&d=identicon&r=PG&f=1", "display_name": "ykdojo", "link": "https://stackoverflow.com/users/10688321/ykdojo"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1542852476, "post_id": 53421838, "comment_id": 93720312, "body": "Thanks @chi. One more question! <code>xs</code> has a type <code>[MyTree (m a)]</code> and how do you feed that in an auxiliary function, <code>[m (MyTree a)] -&gt; m [MyTree a]</code>? I&#39;m getting it to the right way but bridging between these two is quite confusing."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1542878105, "post_id": 53421838, "comment_id": 93728965, "body": "That&#39;s correct, we need to turn <code>[MyTree (m a)]</code> into <code>[m (MyTree a)]</code>. We could use <code>map f</code> for that, for some <code>f :: MyTree (m a) -&gt; m (MyTree a)</code>. Do we have such a function?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542900930, "post_id": 53421838, "comment_id": 93742153, "body": "By &quot;Nothing&quot;, do you mean the value <code>Nothing :: Maybe a</code>? Your function type should be <code>MyTree (Maybe a) -&gt; Maybe (MyTree a)</code>; no general constraint <code>Monad m =&gt;</code> is needed."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10688321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75a2a7fb83cbaaeba152b869095b7641?s=128&d=identicon&r=PG&f=1", "display_name": "ykdojo", "link": "https://stackoverflow.com/users/10688321/ykdojo"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1542854204, "post_id": 53422345, "comment_id": 93720688, "body": "Thanks for the quick and useful answer. I really appreciate it! @DanielWagner"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 6, "last_activity_date": 1542850322, "last_edit_date": 1542850322, "creation_date": 1542846843, "answer_id": 53422345, "question_id": 53421838, "link": "https://stackoverflow.com/questions/53421838/struggling-with-implementing-a-monad-function/53422345#53422345", "title": "Struggling with implementing a Monad function", "body": "<p>Your <code>check</code> function is better known as a method of the <code>Traversable</code> class.</p>\n\n<pre><code>class (Functor t, Foldable t) =&gt; Traversable t where\n  -- The main method\n  traverse\n    :: Applicative f\n    =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)\n  traverse f = sequenceA . fmap f\n\n  -- An alternative\n  sequenceA\n    :: Applicative f\n    =&gt; t (f a) -&gt; f (t a)\n  sequenceA = traverse id\n\n  -- (Mostly) legacy methods\n  mapM\n    :: Monad m\n    =&gt; (a -&gt; m b) -&gt; t a -&gt; m (t b)\n  mapM = traverse\n\n  sequence\n    :: Monad m\n    =&gt; t (m a) -&gt; m (t a)\n  sequence = sequenceA\n</code></pre>\n\n<p>Specifically, <code>check</code> is <code>sequence</code> for <code>MyTree</code>. So we will get it if we write a <code>Traversable MyTree</code> instance. But let's first take a step back in two directions. <code>Traversable</code> is a subclass of both <code>Functor</code> and <code>Foldable</code>, and that is no coincidence. It's possible to implement both <code>fmap</code> and <code>foldMap</code> using <code>traverse</code>. But more to the point, the structures of <code>fmap</code>, <code>foldMap</code> and <code>traverse</code> tend to look almost identical! So let's start with those easier ones.</p>\n\n<pre><code>instance Functor MyTree where\n  fmap f (MyTree a ts) = MyTree (f a) _\n</code></pre>\n\n<p>What goes in that blank? We have a list of subtrees and we need to generate a new one, so a good bet is</p>\n\n<pre><code>  fmap f (MyTree a ts) = MyTree (f a) (fmap _ ts)\n</code></pre>\n\n<p>Now the blank has type <code>MyTree a -&gt; MyTree b</code>, so we just call <code>fmap</code> recursively:</p>\n\n<pre><code>  fmap f (MyTree a ts) = MyTree (f a) (fmap (fmap f) ts)\n</code></pre>\n\n<p>And we're done. Now let's turn to <code>Foldable</code>.</p>\n\n<pre><code>foldMap f (MyTree a ts) = _\n</code></pre>\n\n<p>Well, we're going to need to apply <code>f</code> to <code>a</code> to get a value in the monoid, then fold up the subtrees and combine the results. This ends up looking quite a bit like <code>fmap</code>, as promised.</p>\n\n<pre><code>foldMap f (MyTree a ts) = f a &lt;&gt; foldMap (foldMap f) ts\n</code></pre>\n\n<p>So now we get to <code>Traversable</code>. It's going to be pretty similar to <code>fmap</code>, but we need to combine results using <code>Applicative</code> operations <em>somewhat</em> like we combined <code>foldMap</code> results using <code>Monoid</code> operations.</p>\n\n<pre><code>instance Traversable MyTree where\n   traverse f (MyTree a ts) = _\n</code></pre>\n\n<p>We have</p>\n\n<pre><code>a :: a\nts :: [MyTree a]\nf :: a -&gt; f b\n</code></pre>\n\n<p>Obviously, we're going to want to apply <code>f</code> to <code>a</code>. Following the pattern for <code>fmap</code> and <code>foldMap</code>, we're going to calculate <code>traverse (traverse f) ts</code>. So let's see where that gets us:</p>\n\n<pre><code>traverse f (MyTree a ts) = _ (f a) (traverse (traverse f) ts)\n</code></pre>\n\n<p>Now GHC will tell us that</p>\n\n<pre><code>_ :: f b -&gt; f [MyTree b] -&gt; f (MyTree b)\n</code></pre>\n\n<p>We need to take the <code>b</code> result from the first action and the <code>[MyTree b]</code> result from the second action and apply the <code>MyTree</code> constructor to put them together. We can do this using <code>liftA2</code>:</p>\n\n<pre><code>traverse f (MyTree a ts) = liftA2 MyTree (f a) (traverse (traverse f) ts)\n</code></pre>\n\n<hr>\n\n<p>Once you've gotten the hang of writing <code>Functor</code>, <code>Foldable</code>, and <code>Traversable</code> instances, doing so tends to get pretty dull. So GHC has an extension that lets the compiler write them for you.</p>\n\n<pre><code>{-# language DeriveTraversable #-}\n\nmodule MyModule where\n\ndata MyTree a = MyTree a [MyTree a]\n  deriving (Functor, Foldable, Traversable)\n</code></pre>\n\n<p>And you're done.</p>\n"}], "owner": {"reputation": 45, "user_id": 10688321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75a2a7fb83cbaaeba152b869095b7641?s=128&d=identicon&r=PG&f=1", "display_name": "ykdojo", "link": "https://stackoverflow.com/users/10688321/ykdojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 1, "accepted_answer_id": 53422345, "answer_count": 1, "score": 4, "last_activity_date": 1542850322, "creation_date": 1542842586, "last_edit_date": 1542850001, "question_id": 53421838, "link": "https://stackoverflow.com/questions/53421838/struggling-with-implementing-a-monad-function", "title": "Struggling with implementing a Monad function", "body": "<p>Recently, I'm playing around with Haskell monad and trying to learn about this concept.</p>\n\n<p>Let's say there is a tree data type declared which can have multiple sub-trees.</p>\n\n<pre><code>data MyTree a = MyTree a [MyTree a]\n</code></pre>\n\n<p>And I'm trying to implement a function that returns \"Nothing\" if the tree contains any \"Nothing\" value in the tree. Else, extract all m value and returns a wrapped tree.</p>\n\n<p>So the function type signature has the following.</p>\n\n<pre><code>check :: Monad m =&gt; MyTree (m a) -&gt; m (MyTree a)\n</code></pre>\n\n<p>And here is my current implementation.</p>\n\n<pre><code>check (MyTree v []) = v &gt;&gt;= (\\v' -&gt; return (MyTree v' []))\ncheck (MyTree v (x:xs)) =\n  v &gt;&gt;= (\\v' -&gt; check x &gt;&gt;= (\\t' -&gt; return (MyTree v' [t'])))\n</code></pre>\n\n<p>I use a bind operator on v so that I can get a pure value of it. Then I call the \"check\" function recursively with the head value from the list. Finally, I wrap the final results.</p>\n\n<p>I tested with some samples and got the following results.</p>\n\n<pre><code>&gt; test1 = MyTree (Just 1) [MyTree (Just 2) [MyTree (Just 3) []]]\n&gt; check test1\nJust (MyTree 1 [MyTree 2 [MyTree 3 []]])\n\n&gt; test2 = MyTree (Just 1) [MyTree (Just 2) [], MyTree (Just 3) []]\n&gt; check test2\n-- expected: Just (MyTree 1 [MyTree 2 [], MyTree 3 []]\n-- actual:   Just (MyTree 1 [MyTree 2 []])\n</code></pre>\n\n<p>So, the current implementation has a problem when the input tree has multiple sub-trees. And I have realized that the problem is that I'm only using <code>x</code> but not <code>xs</code>. I wrapped my head around to think of the right approach and still figuring out. It will be very helpful if anyone has an idea for this.</p>\n"}, {"tags": ["haskell", "signature", "currying", "partial-application"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 3, "creation_date": 1542843402, "post_id": 53421792, "comment_id": 93718352, "body": "&quot;parentheses signify that it is a function?&quot; No, the <code>-&gt;</code> signifies that it&#39;s a function."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1542844457, "post_id": 53421792, "comment_id": 93718629, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/38362348/example-of-deep-understanding-of-currying\">Example of deep understanding of currying</a>"}], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 4, "last_activity_date": 1542842656, "creation_date": 1542842656, "answer_id": 53421846, "question_id": 53421792, "link": "https://stackoverflow.com/questions/53421792/how-does-haskell-evaluate-this-signature/53421846#53421846", "title": "How does Haskell evaluate this signature?", "body": "<p>You have understood the type signature correctly: it takes one argument and returns a function. That's how \"multi-argument\" functions in Haskell work: through currying. You can see this in action by trying this equivalent implementation:</p>\n\n<pre><code>ggt_euklid :: Nat1 -&gt; (Nat1 -&gt; Nat1)\nggt_euklid x = \\y -&gt; result\n  where result | x == y = x\n               | x &gt; y = ggt_euklid (x-y) y \n               | x &lt; y = ggt_euklid x (y-x)\n</code></pre>\n\n<p>Here I've introduced this fairly pointless <code>result</code> variable as a thing to use your pattern guards on, but the idea is the same.</p>\n"}, {"tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": true, "score": 2, "last_activity_date": 1543073375, "last_edit_date": 1543073375, "creation_date": 1542882396, "answer_id": 53428827, "question_id": 53421792, "link": "https://stackoverflow.com/questions/53421792/how-does-haskell-evaluate-this-signature/53428827#53428827", "title": "How does Haskell evaluate this signature?", "body": "<blockquote>\n  <p>Would that <strong>not</strong> imply that ggt_euklid takes a value Nat1 and returns a\n  function?</p>\n</blockquote>\n\n<p><strong>No</strong>, it still imply that <code>ggt_euklid</code> takes one argument of type <code>Nat1</code> and return a function of type <code>Nat1-&gt;Nat1</code>, even though, <strong>the parentheses be left out</strong>.</p>\n\n<p>The Arrow <code>-&gt;</code> always be right-associativity (when no parentheses), i.e.:</p>\n\n<pre><code>Nat1 -&gt; Nat1 -&gt; Nat1 \n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>Nat1 -&gt; (Nat1 -&gt; Nat1)\n</code></pre>\n\n<p>which is corresponding to the function application always be left-associativity. (when no parentheses) for example:</p>\n\n<pre><code>ggt_euklid 1 2\n</code></pre>\n\n<p>is equivalent to </p>\n\n<pre><code>(ggt_euklid 1) 2\n</code></pre>\n\n<p>Here </p>\n\n<pre><code>(ggt_euklid 1) ~ Nat1 -&gt; Nat1\n</code></pre>\n\n<p>and </p>\n\n<pre><code>(ggt_euklid 1) 2 ~ Nat1\n</code></pre>\n\n<p>So, no matter whether one or two arguments apply to <code>ggt_euklid</code>, it always return a function of type <code>Nat1 -&gt; Nat1</code> firstly, if second argument is provided, it applies second argument to the returned function.  </p>\n"}], "owner": {"reputation": 111, "user_id": 2804705, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a18fdb95e5db202604e6051db8f6d8f4?s=128&d=identicon&r=PG&f=1", "display_name": "Minimax", "link": "https://stackoverflow.com/users/2804705/minimax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 53428827, "answer_count": 2, "score": 0, "last_activity_date": 1543073375, "creation_date": 1542842247, "question_id": 53421792, "link": "https://stackoverflow.com/questions/53421792/how-does-haskell-evaluate-this-signature", "title": "How does Haskell evaluate this signature?", "body": "<p><code>ggt_euklid :: Nat1 -&gt; (Nat1 -&gt; Nat1)</code></p>\n\n<p>I am trying to learn partial application, I know that in this case, if the parentheses would be left out, I would get the same result, but I do not know how this signature should be evaluated.</p>\n\n<p>As far as I have understood, parentheses signify that it is a function? Would that not imply that ggt_euklid takes a value Nat1 and returns a function?</p>\n\n<p>Below is the complete function:</p>\n\n<pre><code>ggt_euklid x y\n| x == y = x\n|x&gt;y =ggt_euklid(x-y) y \n|x&lt;y =ggt_euklid x (y-x)\n</code></pre>\n"}, {"tags": ["parsing", "haskell", "parsec", "parser-combinators", "peg"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1542841766, "post_id": 53419694, "comment_id": 93717823, "body": "The implementation you linked to mixes tabs and spaces, and uses a different tab width than Stack Overflow does, so your copy/paste looks mis-indented. Obviously fixing this will not answer your question, but it will make it easier to read."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1542852360, "post_id": 53419694, "comment_id": 93720281, "body": "&quot;Parser generators vs. parser combinators vs. hand-written parsers&quot; and &quot;packrat vs. predictive parsing vs. recursive descent with backtracking vs. bottom-up algorithms&quot; are two completely separate classifications. One&#39;s about the tools you use to write the parser, the other&#39;s about the algorithm the parser uses. Your linked implementation is a parser combinator implementing packrat parsing. That&#39;s not a contradiction."}, {"owner": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1548424773, "post_id": 53419694, "comment_id": 95547324, "body": "@sepp2k you&#39;re right that his question should have said &quot;what&#39;s the difference between the packrat library implementation and recursive descent or predictive parser combinator libraries?&quot;. However, the implementation he links to does not actually implement packrat parsing: you can use it, but you have to apply the packrat trick yourself in your own code. See my answer below."}], "answers": [{"comments": [{"owner": {"reputation": 1204, "user_id": 1599054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d4a721253898db1ee42eb770cf3d752a?s=128&d=identicon&r=PG", "display_name": "GlinesMome", "link": "https://stackoverflow.com/users/1599054/glinesmome"}, "edited": false, "score": 0, "creation_date": 1543182829, "post_id": 53425746, "comment_id": 93815289, "body": "Thanks for your answer, but I&#39;m not sure to understand how this co-recursion make the memoization work. I have done some tests with <code>fix</code> (on a fibonacci sequence) for example and it have to impact on performances. If you can add some link/insights about it, thanks."}, {"owner": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "reply_to_user": {"reputation": 1204, "user_id": 1599054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d4a721253898db1ee42eb770cf3d752a?s=128&d=identicon&r=PG", "display_name": "GlinesMome", "link": "https://stackoverflow.com/users/1599054/glinesmome"}, "edited": false, "score": 0, "creation_date": 1543270848, "post_id": 53425746, "comment_id": 93849937, "body": "Sorry, but it&#39;s not clear to me what you&#39;re asking. The memoization is the core trick of the packrat algorithm. Essentially, the only values of type Derivs that will ever be generated for a given input, is the initial result of <code>parse &quot;input&quot;</code>, as well as the ones generated in the chr case of parse above.  For those latter ones, only one value of type Derivs is generated for every character consumed.  So there will be as many Derivs values as inputs in the string."}, {"owner": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "reply_to_user": {"reputation": 1204, "user_id": 1599054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d4a721253898db1ee42eb770cf3d752a?s=128&d=identicon&r=PG", "display_name": "GlinesMome", "link": "https://stackoverflow.com/users/1599054/glinesmome"}, "edited": false, "score": 0, "creation_date": 1543271087, "post_id": 53425746, "comment_id": 93850035, "body": "Those Derivs values have one field for every non-terminal (plus the chr primitive), so in summary, there is one Result ArithDerivs x for every non-terminal (plus the chr primitive) at every input position.  All other non-terminals only ever return one of these pre-existing Derivs values, because they just project a field of one of those pre-generated Derivs values."}, {"owner": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "reply_to_user": {"reputation": 1204, "user_id": 1599054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d4a721253898db1ee42eb770cf3d752a?s=128&d=identicon&r=PG", "display_name": "GlinesMome", "link": "https://stackoverflow.com/users/1599054/glinesmome"}, "edited": false, "score": 0, "creation_date": 1543271127, "post_id": 53425746, "comment_id": 93850047, "body": "Any field of those Derivs values will only be evaluated once, by virtue of Haskell&#39;s lazyness, so this means you get the desired memoization."}, {"owner": {"reputation": 1204, "user_id": 1599054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d4a721253898db1ee42eb770cf3d752a?s=128&d=identicon&r=PG", "display_name": "GlinesMome", "link": "https://stackoverflow.com/users/1599054/glinesmome"}, "edited": false, "score": 0, "creation_date": 1543442928, "post_id": 53425746, "comment_id": 93926420, "body": "In fact I have hard time to figure out how memoization works here. Let&#39;s take a parser based on <code>ArithMonad.hs</code> <code>(Parser advDigit &gt;&gt; symbol &#39;+&#39; &gt;&gt; Parser advDigit) &lt;&#47;&gt; (Parser advDigit &gt;&gt; symbol &#39;-&#39; &gt;&gt; Parser advDigit)</code>, given that expression, how/why the first <code>Parser advDigit</code> is memoized in <code>58-16</code> for example?"}, {"owner": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "reply_to_user": {"reputation": 1204, "user_id": 1599054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d4a721253898db1ee42eb770cf3d752a?s=128&d=identicon&r=PG", "display_name": "GlinesMome", "link": "https://stackoverflow.com/users/1599054/glinesmome"}, "edited": false, "score": 0, "creation_date": 1543565020, "post_id": 53425746, "comment_id": 93972490, "body": "Well you would invoke it by evaluating <code>advDigit (parse someInput)</code>. By definition of <code>parse</code>, that evaluates to <code>advDigit d</code> for the d in the definition of <code>parse</code>. That evaluates to <code>pAdditive d</code>."}, {"owner": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "reply_to_user": {"reputation": 1204, "user_id": 1599054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d4a721253898db1ee42eb770cf3d752a?s=128&d=identicon&r=PG", "display_name": "GlinesMome", "link": "https://stackoverflow.com/users/1599054/glinesmome"}, "edited": false, "score": 1, "creation_date": 1543565551, "post_id": 53425746, "comment_id": 93972710, "body": "Evaluating <code>pAdditive d</code> will then first evaluate <code>advMultitive d</code>. It&#39;s important that it&#39;s <code>advMultitive d</code> that&#39;s being evaluated (a field of the record d), not <code>pMultitive d</code> (the actual parse of a multiplicative expression a this position)."}, {"owner": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "reply_to_user": {"reputation": 1204, "user_id": 1599054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d4a721253898db1ee42eb770cf3d752a?s=128&d=identicon&r=PG", "display_name": "GlinesMome", "link": "https://stackoverflow.com/users/1599054/glinesmome"}, "edited": false, "score": 0, "creation_date": 1543565679, "post_id": 53425746, "comment_id": 93972754, "body": "The reason this is important is that if the field <code>advMultitive d</code> has already been evaluated earlier (for example in another attempted but failed branch of the grammar), then it will not be evaluated again, per Haskell&#39;s lazy evaluation."}, {"owner": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "reply_to_user": {"reputation": 1204, "user_id": 1599054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d4a721253898db1ee42eb770cf3d752a?s=128&d=identicon&r=PG", "display_name": "GlinesMome", "link": "https://stackoverflow.com/users/1599054/glinesmome"}, "edited": false, "score": 0, "creation_date": 1543565798, "post_id": 53425746, "comment_id": 93972799, "body": "In other words, it&#39;s important that recursive references in parsers project out the appropriate fields of <code>d</code> rather than call the corresponding parsers directly. Concretely, it&#39;s important that ArithMonad.hs:75 says <code>Parser advMultitive</code> rather than <code>Parser pMultitive</code>.  The former would be memoized but the latter wouldn&#39;t."}, {"owner": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "reply_to_user": {"reputation": 1204, "user_id": 1599054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d4a721253898db1ee42eb770cf3d752a?s=128&d=identicon&r=PG", "display_name": "GlinesMome", "link": "https://stackoverflow.com/users/1599054/glinesmome"}, "edited": false, "score": 0, "creation_date": 1548424391, "post_id": 53425746, "comment_id": 95547073, "body": "I&#39;ve added a note that my point about observing the recursive structure of the grammar only applies to pure languages like Haskell."}], "tags": [], "owner": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "is_accepted": true, "score": 2, "last_activity_date": 1548424364, "last_edit_date": 1548424364, "creation_date": 1542871349, "answer_id": 53425746, "question_id": 53419694, "link": "https://stackoverflow.com/questions/53419694/implementation-differences-between-parser-combinators-and-packrat-algorithm/53425746#53425746", "title": "Implementation differences between parser combinators and packrat algorithm", "body": "<p>The point here is really that this Packrat parser combinator library is not a full implementation of the Packrat algorithm, but more like a set of definitions that can be reused between different packrat parsers.</p>\n\n<p>The real trick of the packrat algorithm (namely the memoization of parse results) happens elsewhere.\nLook at the following code (taken from Ford's thesis):</p>\n\n<pre><code>data Derivs = Derivs {\n                   dvAdditive :: Result Int,\n                   dvMultitive :: Result Int,\n                   dvPrimary :: Result Int,\n                   dvDecimal :: Result Int,\n                   dvChar :: Result Char}\n\n\npExpression :: Derivs -&gt; Result ArithDerivs Int\nParser pExpression = (do char \u2019(\u2019\n                         l &lt;- Parser dvExpression\n                         char \u2019+\u2019\n                         r &lt;- Parser dvExpression\n                         char \u2019)\u2019\n                         return (l + r))\n                     &lt;/&gt; (do Parser dvDecimal)\n</code></pre>\n\n<p>Here, it's important to notice that the recursive call of the expression parser to itself is broken (in a kind of open-recursion fashion) by simply projecting the appropriate component of the Derivs structure.</p>\n\n<p>This recursive knot is then tied in the \"recursive tie-up function\" (again taken from Ford's thesis):</p>\n\n<pre><code>parse :: String -&gt; Derivs\nparse s = d where\n  d = Derivs add mult prim dec chr\n  add = pAdditive d\n  mult = pMultitive d\n  prim = pPrimary d\n  dec = pDecimal d\n  chr = case s of\n          (c:s\u2019) -&gt; Parsed c (parse s\u2019)\n          [] -&gt; NoParse\n</code></pre>\n\n<p>These snippets are really where the packrat trick happens.\nIt's important to understand that this trick cannot be implemented in a standard way in a traditional parser combinator library (at least in a pure programming language like Haskell), because it needs to know the recursive structure of the grammar.\nThere are experimental approaches to parser combinator libraries that use a particular representation of the recursive structure of the grammar, and there it is possible to provide a standard implementation of Packrat.\nFor example, my own <a href=\"https://people.cs.kuleuven.be/~dominique.devriese/grammar-combinators/index.html\" rel=\"nofollow noreferrer\">grammar-combinators</a> library (not maintained atm, sorry) offers an implementation of <a href=\"http://hackage.haskell.org/package/grammar-combinators-0.2.7/docs/Text-GrammarCombinators-Parser-Packrat.html\" rel=\"nofollow noreferrer\">Packrat</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 55852, "user_id": 165216, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U7Xse.jpg?s=128&g=1", "display_name": "PaulMcG", "link": "https://stackoverflow.com/users/165216/paulmcg"}, "is_accepted": false, "score": 0, "last_activity_date": 1546103275, "last_edit_date": 1546103275, "creation_date": 1546102456, "answer_id": 53971492, "question_id": 53419694, "link": "https://stackoverflow.com/questions/53419694/implementation-differences-between-parser-combinators-and-packrat-algorithm/53971492#53971492", "title": "Implementation differences between parser combinators and packrat algorithm", "body": "<p>As stated elsewhere, packrat is not an alternative to combinators, but is an implementation option in those parsers. Pyparsing is a combinator that offers an optional packrat optimization by calling <code>ParserElement.enablePackrat()</code>. Its implementation is almost a drop-in replacement for pyparsing's <code>_parse</code> method (renamed to <code>_parseNoCache</code>), with a <code>_parseCache</code> method.</p>\n\n<p>Pyparsing uses a fixed-length FIFO queue for its cache, since packrat cache entries get stale once the combinator fully matches the cached expression and moves on through the input stream. A custom cache size can be passed as an integer argument to <code>enablePackrat()</code>, or if None is passed, the cache is unbounded. A packrat cache with the default value of 128 was only 2% less efficient than an unbounded cache against the supplied Verilog parser, with significant savings in memory.</p>\n"}], "owner": {"reputation": 1204, "user_id": 1599054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d4a721253898db1ee42eb770cf3d752a?s=128&d=identicon&r=PG", "display_name": "GlinesMome", "link": "https://stackoverflow.com/users/1599054/glinesmome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 53425746, "answer_count": 2, "score": 4, "last_activity_date": 1548424364, "creation_date": 1542830550, "last_edit_date": 1542869066, "question_id": 53419694, "link": "https://stackoverflow.com/questions/53419694/implementation-differences-between-parser-combinators-and-packrat-algorithm", "title": "Implementation differences between parser combinators and packrat algorithm", "body": "<p>In order to have a better understanding of packrat I've tried to have a look at <a href=\"https://pdos.csail.mit.edu/~baford/packrat/thesis/pappy/Parse.hs\" rel=\"nofollow noreferrer\">the provided implementation</a> coming with <a href=\"https://pdos.csail.mit.edu/~baford/packrat/thesis/\" rel=\"nofollow noreferrer\">the paper</a> (I'm focusing on the <code>bind</code>):</p>\n\n<pre><code>instance Derivs d =&gt; Monad (Parser d) where \n\n  -- Sequencing combinator\n  (Parser p1) &gt;&gt;= f = Parser parse\n\n    where parse dvs = first (p1 dvs)\n\n          first (Parsed val rem err) = \n            let Parser p2 = f val\n            in second err (p2 rem)\n          first (NoParse err) = NoParse err\n\n          second err1 (Parsed val rem err) =\n            Parsed val rem (joinErrors err1 err)\n          second err1 (NoParse err) =\n            NoParse (joinErrors err1 err)\n\n-- Result-producing combinator\nreturn x = Parser (\\dvs -&gt; Parsed x dvs (nullError dvs))\n\n-- Failure combinator\nfail [] = Parser (\\dvs -&gt; NoParse (nullError dvs))\nfail msg = Parser (\\dvs -&gt; NoParse (msgError (dvPos dvs) msg))\n</code></pre>\n\n<p>For me it looks like (errors handling aside) to parser combinators (such as <a href=\"http://dev.stephendiehl.com/fun/002_parsers.html\" rel=\"nofollow noreferrer\">this simplified version of Parsec</a>):</p>\n\n<pre><code>bind :: Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b\nbind p f = Parser $ \\s -&gt; concatMap (\\(a, s') -&gt; parse (f a) s') $ parse p s\n</code></pre>\n\n<p>I'm quite confused because before that I thought that the big difference was that packrat was a parser generator with a memoization part.\nSadly it seems that this concept is not used in this implementation.</p>\n\n<p>What is the big difference between parser combinators and packrat at implementation level?</p>\n\n<p>PS: I also have had a look at <a href=\"https://hackage.haskell.org/package/papillon\" rel=\"nofollow noreferrer\">Papillon</a> but it seems to be very different from the implementation coming with the paper.</p>\n"}, {"tags": ["haskell", "refinement-type", "liquid-haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1542828902, "post_id": 53418969, "comment_id": 93712882, "body": "I guess you can&#39;t inline recursive functions. How would that work?"}, {"owner": {"reputation": 1702, "user_id": 1684606, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a21fb1ca51672dfc93b938221e849aaf?s=128&d=identicon&r=PG", "display_name": "Alex Varga", "link": "https://stackoverflow.com/users/1684606/alex-varga"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1542834470, "post_id": 53418969, "comment_id": 93715272, "body": "I guess I&#39;m not exactly sure what &quot;inline&quot; (or the other pragmas) do. Maybe there is a different one I should be using?"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1542837163, "post_id": 53418969, "comment_id": 93716334, "body": "The README seems to document this, suggests you might need to use <code>reflect</code> , but I&#39;m afraid I haven&#39;t used LH much yet <a href=\"https://github.com/ucsd-progsys/liquidhaskell/blob/develop/README.md\" rel=\"nofollow noreferrer\">github.com/ucsd-progsys/liquidhaskell/blob/develop/README.md</a>"}, {"owner": {"reputation": 1702, "user_id": 1684606, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a21fb1ca51672dfc93b938221e849aaf?s=128&d=identicon&r=PG", "display_name": "Alex Varga", "link": "https://stackoverflow.com/users/1684606/alex-varga"}, "edited": false, "score": 0, "creation_date": 1543599623, "post_id": 53418969, "comment_id": 93990369, "body": "This is the best resource I&#39;ve found on this: <a href=\"https://arxiv.org/pdf/1806.03541.pdf\" rel=\"nofollow noreferrer\">arxiv.org/pdf/1806.03541.pdf</a>. Just make sure to use <code>NewProofCombinators</code> rather than <code>ProofCombinators</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1702, "user_id": 1684606, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a21fb1ca51672dfc93b938221e849aaf?s=128&d=identicon&r=PG", "display_name": "Alex Varga", "link": "https://stackoverflow.com/users/1684606/alex-varga"}, "edited": false, "score": 0, "creation_date": 1542972122, "post_id": 53436693, "comment_id": 93764255, "body": "Thanks for you thorough answer Peter! I had figured out the need to use <code>reflect</code> but was still struggling to get LH to &quot;understand&quot; the function, and I believe those resources will help."}, {"owner": {"reputation": 1702, "user_id": 1684606, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a21fb1ca51672dfc93b938221e849aaf?s=128&d=identicon&r=PG", "display_name": "Alex Varga", "link": "https://stackoverflow.com/users/1684606/alex-varga"}, "edited": false, "score": 0, "creation_date": 1543000021, "post_id": 53436693, "comment_id": 93776153, "body": "Follow up: if I declare <code>type LT5 = {v:Ordinal | ordLT v (Ord Zero 5 Zero) }</code>, how can I actually declare something like <code>one :: LT5</code> without an error? Even if I prove <code>ordLT one (Ord Zero 5 Zero)</code>, LH still doesn&#39;t allow this."}, {"owner": {"reputation": 1435, "user_id": 6676199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21f60cb3880bf43a7c74ffeecbf996e1?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Amidon", "link": "https://stackoverflow.com/users/6676199/peter-amidon"}, "reply_to_user": {"reputation": 1702, "user_id": 1684606, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a21fb1ca51672dfc93b938221e849aaf?s=128&d=identicon&r=PG", "display_name": "Alex Varga", "link": "https://stackoverflow.com/users/1684606/alex-varga"}, "edited": false, "score": 1, "creation_date": 1543007591, "post_id": 53436693, "comment_id": 93778485, "body": "@AlexVarga You need to ensure that the proof of this fact is in scope when Liquid is typechecking the definition. You might want to look at some of the combinators in the <code>Language.Haskell.Liquid.ProofCombinators</code> module, which are designed for dealing with this kind of thing. e.g. something like <code>one = let one&#39; = Ord Zero 1 Zero in castWithTheorem (ordLT one&#39; $ Ord Zero 5 Zero) one&#39;</code> should work in this case."}], "tags": [], "owner": {"reputation": 1435, "user_id": 6676199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21f60cb3880bf43a7c74ffeecbf996e1?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Amidon", "link": "https://stackoverflow.com/users/6676199/peter-amidon"}, "is_accepted": true, "score": 2, "last_activity_date": 1542912545, "creation_date": 1542912545, "answer_id": 53436693, "question_id": 53418969, "link": "https://stackoverflow.com/questions/53418969/liquid-haskell-cyclic-type-alias-definition-error-from-an-inlined-recursive-f/53436693#53436693", "title": "Liquid Haskell: &quot;Cyclic type alias definition&quot; error from an inlined recursive function", "body": "<p>It's a little difficult to be sure what you want to be doing without more context, but <code>inline</code> does indeed not work on recursive functions: <code>inline</code> lets you use a function in a type <em>by expanding it at compile time</em> (before creating the verification condition sent to the solver), so it needs to be possible to replace every occurrence of <code>ordLT a b</code> by some specific logic formula (which is impossible, since it's recursive).</p>\n\n<p>If you need to be able to use arbitrary Haskell functions in the logic, you can look into using Refinement Reflection. Your example compiles with <code>{-@ reflect ordLT @-}</code> and <code>{-@ LIQUID \"--exact-data-cons\" @-}</code>. However, the function symbols created by refinement reflection are not automatically fully interpreted in the logic. The nitty-gritty details are discussed in <a href=\"http://goto.ucsd.edu/~nvazou/refinement-reflection/refinement-reflection.pdf\" rel=\"nofollow noreferrer\">this paper</a>, and more approachable examples/explanation are present in <a href=\"http://goto.ucsd.edu/~nvazou/UoA16/05-refinement-reflection.html\" rel=\"nofollow noreferrer\">these slides</a> and <a href=\"https://ucsd-progsys.github.io/liquidhaskell-blog/2016/09/18/refinement-reflection.lhs/\" rel=\"nofollow noreferrer\">this blog post</a>.  The main point to remember is that the <code>ordLT</code> symbol created by reflection will initially be treated as a completely uninterpreted function in the logic: the only thing that LH knows about it is something like <code>a0 == a1 ==&gt; b0 == b1 ==&gt; ordLT a0 b0 == ordLT a1 b1</code> (if you call it on identical inputs, the results are identical).</p>\n\n<p>In order to do something useful with <code>ordLT</code> in the logic, you will need to call <code>ordLT</code> at the value-level somewhere in scope, which will reveal the value of that particular call, since the return type of <code>ordLT</code> (the value-level function) asserts something about the output of <code>ordLT</code> (the logic-level uninterpreted function) on those inputs. Examples are given in the slides linked above &amp; the paper. I hope that's enough to get you started!</p>\n"}], "owner": {"reputation": 1702, "user_id": 1684606, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a21fb1ca51672dfc93b938221e849aaf?s=128&d=identicon&r=PG", "display_name": "Alex Varga", "link": "https://stackoverflow.com/users/1684606/alex-varga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 2, "accepted_answer_id": 53436693, "answer_count": 1, "score": 4, "last_activity_date": 1542912545, "creation_date": 1542827206, "question_id": 53418969, "link": "https://stackoverflow.com/questions/53418969/liquid-haskell-cyclic-type-alias-definition-error-from-an-inlined-recursive-f", "title": "Liquid Haskell: &quot;Cyclic type alias definition&quot; error from an inlined recursive function", "body": "<p>I wrote some code to do <a href=\"https://en.wikipedia.org/wiki/Ordinal_arithmetic\" rel=\"nofollow noreferrer\">ordinal arithmetic</a> in Haskell and am now trying to use Liquid Haskell to verify certain properties. However, I'm having trouble \"reflecting\" recursive functions. I've isolated a problem in the \"less than\" function below:</p>\n\n<pre><code>-- (Ord a n b) = a^n + b\n{-@ data Ordinal [size] = Ord { a :: Ordinal, n :: Nat,  b :: Ordinal }\n                        | Zero {} @-}\ndata Ordinal = Ord Ordinal Integer Ordinal\n             | Zero\n             deriving (Eq, Show)\n\n{-@ measure size @-}\n{-@ size :: Ordinal -&gt; Nat @-}\nsize :: Ordinal -&gt; Integer\nsize Zero = 1\nsize (Ord a n b) = (size a) + 1 + (size b)\n\n{-@ inline ordLT @-}\nordLT :: Ordinal -&gt; Ordinal -&gt; Bool\nordLT _ Zero = False\nordLT Zero _ = True\nordLT (Ord a0 n0 b0) (Ord a1 n1 b1) =\n    (ordLT a0 a1) || \n    (a0 == a1 &amp;&amp; n0 &lt; n1) || \n    (a0 == a1 &amp;&amp; n0 == n1 &amp;&amp; ordLT b0 b1)\n\none = (Ord Zero 1 Zero)     -- 1\nw   = (Ord one 1 Zero)      -- omega\nmain = print w              -- Ord (Ord Zero 1 Zero) 1 Zero\n</code></pre>\n\n<p>Executing <code>liquid ordinals.hs</code> with just the above gives the following error:</p>\n\n<pre><code>Error: Cyclic type alias definition for `Main.ordLT`\n14 |     {-@ inline ordLT @-}\n                     ^^^^^\nThe following alias definitions form a cycle:\n* `Main.ordLT`\n</code></pre>\n\n<p>So what is the proper way to reflect recursive functions? I've read the <a href=\"http://ucsd-progsys.github.io/liquidhaskell-tutorial/\" rel=\"nofollow noreferrer\">liquid haskell tutorial</a> but I can't figure out what its examples are doing differently.</p>\n"}, {"tags": ["haskell", "types", "error-handling", "type-systems", "maybe"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1542791763, "post_id": 53407890, "comment_id": 93692235, "body": "I don&#39;t think that would be fine either. We can&#39;t bind a Maybe x with a function that wants a Maybe x as input - we should just call the function on the Maybe: <code>parsedExtractor uri . URI.parseURI . toS $ uri</code>"}, {"owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "edited": false, "score": 0, "creation_date": 1542791830, "post_id": 53407890, "comment_id": 93692268, "body": "apologies that&#39;s a syntax error I introduced in my experimentation. I&#39;ve edited to the correct actual state (Which still errors)"}, {"owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1542792610, "post_id": 53407890, "comment_id": 93692735, "body": "@amalloy your suggestion worked! If you write it up as an answer (And maybe explain the issue!), I&#39;ll be very happy to accept it as an answer"}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1542795588, "post_id": 53409794, "comment_id": 93694496, "body": "Note that the typical notation for type equality uses <code>~</code>, not <code>=</code>. So I would write, for example, <code>(URI.parseURI . toS) uri :: Maybe URI.URI ~ m a</code>."}], "tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": true, "score": 5, "last_activity_date": 1542807409, "last_edit_date": 1542807409, "creation_date": 1542795385, "answer_id": 53409794, "question_id": 53407890, "link": "https://stackoverflow.com/questions/53407890/cant-match-type-maybe-vs-not-maybe-on-network-uri/53409794#53409794", "title": "Can&#39;t match type Maybe vs not Maybe on Network.URI", "body": "<blockquote>\n  <p>And for the life of me I can't figure out why. If the initial\n  implementation returns a Maybe, why is it converting to an unwrapper\n  URI.URI which I can't then pass?</p>\n</blockquote>\n\n<p>To refer the definition of <code>&gt;&gt;=</code> from <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Monad.html#v:-62--62--61-\" rel=\"nofollow noreferrer\">Control.Monad</a>, it has type signture:</p>\n\n<pre><code>(&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>Now, compare to the expression:</p>\n\n<pre><code>(URI.parseURI . toS) uri &gt;&gt;= parsedExtractor uri\n</code></pre>\n\n<p>We have:</p>\n\n<pre><code>m a        ~ (URI.parseURI . toS) uri\n(a -&gt; m b) ~ parsedExtractor uri\n</code></pre>\n\n<p>Since <code>(URI.parseURI . toS) uri</code> return type <code>Maybe URI.URI</code> and <code>Maybe</code> is an instance of <code>Monad</code>, so </p>\n\n<pre><code>m a ~ Maybe URI.URI \n</code></pre>\n\n<p>and </p>\n\n<pre><code>(a -&gt; m b) ~ (URI.URI -&gt; m b) \n</code></pre>\n\n<p>and <code>m b</code> can be infered to <code>m (URI.URI)</code>, so the function (i.e. <code>parsedExtractor uri</code>) after <code>&gt;&gt;=</code> expected to has type as:</p>\n\n<pre><code>(URI.URI -&gt; m (URI.URI))\n</code></pre>\n\n<p>But actual is not.</p>\n"}], "owner": {"reputation": 13393, "user_id": 1772334, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/36bbc437a85c7654d1841ad508c78acb?s=128&d=identicon&r=PG", "display_name": "Abraham P", "link": "https://stackoverflow.com/users/1772334/abraham-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 53409794, "answer_count": 1, "score": 1, "last_activity_date": 1542807409, "creation_date": 1542788796, "last_edit_date": 1542791863, "question_id": 53407890, "link": "https://stackoverflow.com/questions/53407890/cant-match-type-maybe-vs-not-maybe-on-network-uri", "title": "Can&#39;t match type Maybe vs not Maybe on Network.URI", "body": "<p>Say I want to parse an environment variable, and default to localhost in its absence, using <a href=\"https://hackage.haskell.org/package/network-2.3/docs/Network-URI.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/network-2.3/docs/Network-URI.html</a></p>\n\n<p>I can write a function like so:</p>\n\n<pre><code>parseRabbitURI :: Text -&gt; Maybe URI.URI\nparseRabbitURI \"\" = URI.parseURI \"amqp://guest:guest@127.0.0.1/\"\nparseRabbitURI uri = (URI.parseURI . toS) uri\n</code></pre>\n\n<p>This works fine. Now let's say I want to handle errors. I note that parseURI returns a <code>Maybe</code> so ostensibly I just need to pattern match on that. So I create a custom Error:</p>\n\n<pre><code>data CustomError = MyCustomError Text deriving(Show)\n</code></pre>\n\n<p>I create a helper function:</p>\n\n<pre><code>parsedExtractor\n  :: MonadError CustomError.MyCustomError m\n  =&gt; Text\n  -&gt; Maybe URI.URI\n  -&gt; m(URI.URI)\nparsedExtractor originalString Nothing = throwError $ FlockErrors.FailedToParseURI originalString\nparsedExtractor _ (Just uri) = do\n  pure uri\n</code></pre>\n\n<p>Finally, I modify my initial function:</p>\n\n<pre><code>parseRabbitURI :: MonadError CustomError.MyCustomError m =&gt; Text -&gt; m(URI.URI)\nparseRabbitURI \"\" = URI.parseURI \"amqp://guest:guest@127.0.0.1/\" &gt;&gt;= parsedExtractor \"amqp://guest:guest@127.0.0.1/\"\nparseRabbitURI uri = (URI.parseURI . toS) uri &gt;&gt;= parsedExtractor uri\n</code></pre>\n\n<p>This fails to compile with:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018URI.URI\u2019 with \u2018Maybe URI.URI\u2019\n  Expected type: URI.URI -&gt; Maybe URI.URI\n    Actual type: Maybe URI.URI -&gt; Maybe URI.URI\n\u2022 In the second argument of \u2018(&gt;&gt;=)\u2019, namely \u2018parsedExtractor uri\u2019\n  In the expression: (URI.parseURI . toS) uri &gt;&gt;= parsedExtractor uri\n  In an equation for \u2018parseRabbitURI\u2019:\n      parseRabbitURI uri\n        = (URI.parseURI . toS) uri &gt;&gt;= parsedExtractor uri\n</code></pre>\n\n<p>|\n23 | parseRabbitURI uri = (URI.parseURI . toS) uri >>= parsedExtractor uri\n   |                                              </p>\n\n<p>And for the life of me I can't figure out why. If the initial implementation returns a Maybe, why is it converting to an unwrapper URI.URI which I can't then pass?</p>\n\n<p>Crucially, when I change the pattern on <code>parsedExtractor</code> to expect a string, it <em>also</em> fails to compile with the inverse message (</p>\n\n<pre><code>Couldn't match expected type \u2018URI.URI\u2019\n                      with actual type \u2018Maybe URI.URI\u2019\n</code></pre>\n\n<p>I feel like I must be missing something completely fundamental. What is going on here?</p>\n"}, {"tags": ["haskell", "runhaskell"], "comments": [{"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 1, "creation_date": 1542787194, "post_id": 53407469, "comment_id": 93689736, "body": "It is configuration problem. I just tried it and it works."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1542798913, "post_id": 53407469, "comment_id": 93696447, "body": "I am also unable to reproduce this problem. Could you post your version and any relevant config information?"}, {"owner": {"reputation": 3321, "user_id": 468820, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d53b228cd79135e41556fdf16b98729a?s=128&d=identicon&r=PG", "display_name": "Andrei Bozantan", "link": "https://stackoverflow.com/users/468820/andrei-bozantan"}, "edited": false, "score": 0, "creation_date": 1542803341, "post_id": 53407469, "comment_id": 93698750, "body": "OK, most probably I will just reinstall the Haskell Platform."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1542818258, "post_id": 53407469, "comment_id": 93707756, "body": "@AndreiBozantan feel free to answer your own question if this works."}], "owner": {"reputation": 3321, "user_id": 468820, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d53b228cd79135e41556fdf16b98729a?s=128&d=identicon&r=PG", "display_name": "Andrei Bozantan", "link": "https://stackoverflow.com/users/468820/andrei-bozantan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 443, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542786936, "creation_date": 1542786936, "question_id": 53407469, "link": "https://stackoverflow.com/questions/53407469/runhaskell-error-attempting-to-use-module-mainprelude-prelude-hs-which-is", "title": "runhaskell error attempting to use module `main:Prelude&#39; (.\\Prelude.hs) which is not loaded", "body": "<p>I am attempting to run a simple Haskell program using <code>runhaskell file.hs</code>. The source code looks like this:</p>\n\n<pre><code>main = putStrLn \"hello world\"\n</code></pre>\n\n<p>The output of <code>runhaskell</code> is an error, which I do not know how to fix:</p>\n\n<pre><code>&lt;interactive&gt;:1:1: error:\nattempting to use module `main:Prelude' (.\\Prelude.hs) which is not loaded\n</code></pre>\n"}, {"tags": ["haskell", "amazon-s3", "conduit"], "answers": [{"comments": [{"owner": {"reputation": 2885, "user_id": 1360368, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7997d33ca6f47d0e48080d6f58a72443?s=128&d=identicon&r=PG", "display_name": "Ashesh", "link": "https://stackoverflow.com/users/1360368/ashesh"}, "edited": false, "score": 0, "creation_date": 1546010846, "post_id": 53405714, "comment_id": 94758948, "body": "Have you tried using this hash? I&#39;m running into the same bug even with the hash you mentioned."}, {"owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "reply_to_user": {"reputation": 2885, "user_id": 1360368, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7997d33ca6f47d0e48080d6f58a72443?s=128&d=identicon&r=PG", "display_name": "Ashesh", "link": "https://stackoverflow.com/users/1360368/ashesh"}, "edited": false, "score": 0, "creation_date": 1546028788, "post_id": 53405714, "comment_id": 94765593, "body": "@Ashesh 248f7b2a7248222cc21cef6194cd1872ba99ac5d is indeed the commit hash that works for me."}, {"owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "reply_to_user": {"reputation": 2885, "user_id": 1360368, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7997d33ca6f47d0e48080d6f58a72443?s=128&d=identicon&r=PG", "display_name": "Ashesh", "link": "https://stackoverflow.com/users/1360368/ashesh"}, "edited": false, "score": 0, "creation_date": 1546028912, "post_id": 53405714, "comment_id": 94765631, "body": "Stupid suggestion, but have you tried a <code>stack clean &amp;&amp; rm -rf .stack-work&#47; &amp;&amp; stack build</code>?"}, {"owner": {"reputation": 2885, "user_id": 1360368, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7997d33ca6f47d0e48080d6f58a72443?s=128&d=identicon&r=PG", "display_name": "Ashesh", "link": "https://stackoverflow.com/users/1360368/ashesh"}, "edited": false, "score": 0, "creation_date": 1546160872, "post_id": 53405714, "comment_id": 94790389, "body": "Yeah, it works for me. It was my bad: I was doing <code>runResourceT</code> before consuming the response body."}], "tags": [], "owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "is_accepted": true, "score": 1, "last_activity_date": 1546010683, "last_edit_date": 1546010683, "creation_date": 1542777909, "answer_id": 53405714, "question_id": 53405263, "link": "https://stackoverflow.com/questions/53405263/connectionclosed-when-using-getobject-from-amazonka-s3/53405714#53405714", "title": "`ConnectionClosed` when using `getObject` from amazonka-s3", "body": "<p>As it turns out, this is a <a href=\"https://github.com/brendanhay/amazonka/issues/466\" rel=\"nofollow noreferrer\">known issue</a> with the Stackage release of <code>amazonka-s3</code>, which hasn't been fixed yet.  The workaround is to upgrade the amazonka/core/s3 dependencies to point to a fixed version of master:</p>\n\n<pre><code># stack.yaml\nextra-deps:\n- git: git@github.com:brendanhay/amazonka\n  commit: 248f7b2a7248222cc21cef6194cd1872ba99ac5d\n  subdirs:\n    - amazonka\n    - core\n    - amazonka-s3\n</code></pre>\n"}], "owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 53405714, "answer_count": 1, "score": 1, "last_activity_date": 1546010683, "creation_date": 1542774475, "last_edit_date": 1542776001, "question_id": 53405263, "link": "https://stackoverflow.com/questions/53405263/connectionclosed-when-using-getobject-from-amazonka-s3", "title": "`ConnectionClosed` when using `getObject` from amazonka-s3", "body": "<p>I have a function</p>\n\n<pre><code>import Control.Lens ((^.))\nimport Data.Conduit (sinkLazy)\nimport Network.AWS (MonadAWS, send, sinkBody)\nimport Network.AWS.S3 (BucketName (..), ObjectKey (..), gorsBody, getObject)\nimport qualified Data.ByteString.Lazy as LBS\n\n\ngetObjectData :: MonadAWS m =&gt; Text -&gt; Text -&gt; m LBS.ByteString\ngetObjectData b k = do\n  resp &lt;- send $ getObject (BucketName b) (ObjectKey k)\n  (resp ^. gorsBody) `sinkBody` sinkLazy\n</code></pre>\n\n<p>whose purpose is to get the data from some object on s3 into a lazy bytestring.</p>\n\n<p>Sending the request is successful, and I can see the response.  Of course, the <code>gorsBody</code> field is shown as <code>RsBody { ConduitM () ByteString (ResourceT IO) () }</code> because that is what it is.</p>\n\n<p>When I try the last line of the function, I get something like this:</p>\n\n<pre><code>*** Exception: HttpExceptionRequest Request {\n  host                 = \"s3.amazonaws.com\"\n  port                 = 443\n  secure               = True\n  requestHeaders       = [(\"Host\",\"s3.amazonaws.com\"),(\"X-Amz-Date\",\"20181121T001938Z\"),(\"X-Amz-Content-SHA256\",\"blah\"),(\"X-Amz-Security-Token\",\"blah\"),(\"Authorization\",\"&lt;REDACTED&gt;\")]\n  path                 = \"/path/to/my/file.txt\"\n  queryString          = \"\"\n  method               = \"GET\"\n  proxy                = Nothing\n  rawBody              = False\n  redirectCount        = 0\n  responseTimeout      = ResponseTimeoutMicro 70000000\n  requestVersion       = HTTP/1.1\n}\n ConnectionClosed\n</code></pre>\n\n<p>It sort of seems like this might have something to do with laziness; maybe that the response body was never evaluated before the connection was closed.  But that's pure speculation, and in any case, I am not sure how to address it.  Does anyone have an idea of what is happening here?  It seems like what I'm doing is the right use of amazonka-s3+conduit.</p>\n\n<p>I'm using <code>lts-11.14</code> and <code>amazonka-s3-1.6.0</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 3, "creation_date": 1542760315, "post_id": 53403393, "comment_id": 93682355, "body": "Could you show what you&#39;ve tried? That should give us a better idea of exactly what part you&#39;re having trouble with."}, {"owner": {"reputation": 886, "user_id": 2184449, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a8fc41244d47a3aa594fdeea90983863?s=128&d=identicon&r=PG", "display_name": "Jere", "link": "https://stackoverflow.com/users/2184449/jere"}, "edited": false, "score": 1, "creation_date": 1542765214, "post_id": 53403393, "comment_id": 93683490, "body": "please narrow down your problem. How far do you get on your own and where exactly do you need help? We are not starting to just randomly solve everyones homework..."}, {"owner": {"reputation": 1, "user_id": 4179783, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0HsXlm2aiT0/AAAAAAAAAAI/AAAAAAAAAI0/4LwBedw_we4/photo.jpg?sz=128", "display_name": "Kryzek", "link": "https://stackoverflow.com/users/4179783/kryzek"}, "reply_to_user": {"reputation": 886, "user_id": 2184449, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/a8fc41244d47a3aa594fdeea90983863?s=128&d=identicon&r=PG", "display_name": "Jere", "link": "https://stackoverflow.com/users/2184449/jere"}, "edited": false, "score": 0, "creation_date": 1542802972, "post_id": 53403393, "comment_id": 93698566, "body": "@Jere I got the hint I needed! The only thing missing was joining first and second input to the beginning and ending respectively. Thanks for the interest!"}], "answers": [{"comments": [{"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1542761431, "post_id": 53403736, "comment_id": 93682619, "body": "That base case doesn&#39;t look quite right. I don&#39;t think you should be ignoring <code>x</code>."}, {"owner": {"reputation": 1, "user_id": 4179783, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0HsXlm2aiT0/AAAAAAAAAAI/AAAAAAAAAI0/4LwBedw_we4/photo.jpg?sz=128", "display_name": "Kryzek", "link": "https://stackoverflow.com/users/4179783/kryzek"}, "edited": false, "score": 0, "creation_date": 1542802629, "post_id": 53403736, "comment_id": 93698408, "body": "I forgot to include, the Point is: type Point = (Float, Float)  I am trying now your solutions and thank you for a quick  reply!!"}], "tags": [], "owner": {"reputation": 1141, "user_id": 1367497, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c1ab83696683e53a9940cd2a8c480894?s=128&d=identicon&r=PG", "display_name": "peeyush singh", "link": "https://stackoverflow.com/users/1367497/peeyush-singh"}, "is_accepted": true, "score": -1, "last_activity_date": 1542762389, "last_edit_date": 1542762389, "creation_date": 1542760958, "answer_id": 53403736, "question_id": 53403393, "link": "https://stackoverflow.com/questions/53403393/haskell-join-function-inputs-in-list-in-specific-order/53403736#53403736", "title": "Haskell join function inputs in list in specific order", "body": "<p>Well since you got it working without the starting/ending point. An easy way to complete would be use your function but add the starting/ending point in the list in an inner function. So your interface is still same. </p>\n\n<p>Another way using recursion, pattern matching and guards is:</p>\n\n<pre><code>-- assuming the inputs to be int as definition of point not given\nsolve x z [] = [(x,z)]\n\nsolve x z (y:ys)\n            | x == 0 = solve y z ys     -- x ==0 to be replaced by null/empty condition on x\n            | null ys &amp;&amp; z == 0 = []    -- z ==0 to be replaced by null/empty condition on z\n            | null ys = [(y, z)]\n            | otherwise = (x,y) : solve y z ys\n</code></pre>\n\n<p>Added a base case when the list is empty or start/end points not valid based on darthfennec comment.</p>\n"}], "owner": {"reputation": 1, "user_id": 4179783, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0HsXlm2aiT0/AAAAAAAAAAI/AAAAAAAAAI0/4LwBedw_we4/photo.jpg?sz=128", "display_name": "Kryzek", "link": "https://stackoverflow.com/users/4179783/kryzek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 53403736, "answer_count": 1, "score": -6, "last_activity_date": 1542803830, "creation_date": 1542758290, "last_edit_date": 1542803830, "question_id": 53403393, "link": "https://stackoverflow.com/questions/53403393/haskell-join-function-inputs-in-list-in-specific-order", "title": "Haskell join function inputs in list in specific order", "body": "<p><a href=\"https://i.stack.imgur.com/5xjnK.png\" rel=\"nofollow noreferrer\">Exercise</a></p>\n\n<p>Hello every one!</p>\n\n<p>I have been struggling to get this function working in the specific way they want.</p>\n\n<p>I tried everything and the only output I could make was without the starting and ending point, eg: [((a,b),(b,c))]</p>\n\n<p>Could someone please give me some help? I am stucked...</p>\n\n<p>Update: type Point = (Float, Float)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1542762781, "post_id": 53403390, "comment_id": 93682939, "body": "GC is a good guess - as more and more heap is allocatec the copying collector has more work.  I had a similar, though less pronounced, benchmark issue due (I believe) to intel cpu frequency scaling and thermal profiles.  Ultimately, it seems unlikely anyone here can tell you with certainty what is going on since you didn&#39;t share the full system.  Best I&#39;d hope for in your position is educated guessing and people telling you to do it correctly via a benchmarking library."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 2, "creation_date": 1542779177, "post_id": 53403390, "comment_id": 93686659, "body": "You&#39;re almost certainly seeing the cost of the garbage collector traversing something that is still alive repeatedly, until it&#39;s finally freed and the GC doesn&#39;t have to traverse it to reclaim the memory.  Given that the key difference is <code>mapM</code> vs <code>mapM_</code>, it has to be the list <code>mapM</code> produces.  All other details depend on things like runtime options, ghc version, and compile flags."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1542821799, "post_id": 53403390, "comment_id": 93709618, "body": "If you really just need the mean, don&#39;t capture the times; just calculate the sum as you go. If you need more statistics (standard deviation, median, interquartile range, etc.), then you should consider recording the times in an (unboxed) array or vector instead of a list."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1542970228, "post_id": 53403390, "comment_id": 93763316, "body": "Nobody mentioned Criterion yet?"}], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1542758273, "creation_date": 1542758273, "question_id": 53403390, "link": "https://stackoverflow.com/questions/53403390/ghc-simple-performance-test-yields-batcrazy-sawtooth-graph", "title": "GHC, Simple Performance Test yields batcrazy sawtooth graph", "body": "<p>I am trying to do some very simple performance testing in Haskell using the <code>clock</code> library and code that looks like this</p>\n\n<pre><code>timeBefore &lt;- getTime Monotonic\n--do something\ntimeAfter &lt;- getTime Monotonic\n\nputStrLn $ show $ toNanoSecs (timeAfter `diffTimeSpec` timeBefore)\n</code></pre>\n\n<p>This works, but the times are a bit noisy, so I repeat multiple times to get an average, like this</p>\n\n<pre><code>replicateM_ 10000 $ do\n  timeBefore &lt;- getTime Monotonic\n  --something\n  timeAfter &lt;- getTime Monotonic\n\n  putStrLn $ show $ toNanoSecs (timeAfter `diffTimeSpec` timeBefore)\n</code></pre>\n\n<p>This also works, until I remove the underscore from <code>replicateM_</code> (in an attempt to return all the times to calculate an average....  but the problem happens even when I don't return numerical values).  As soon as I replace <code>replicateM_</code> with <code>replicateM</code>, the values scrolling by started to look pretty erratic, and often very large.  Confused, I graphed the result and was pretty surprised at what I saw</p>\n\n<p><a href=\"https://i.stack.imgur.com/kvcbC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kvcbC.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is completely bizarre....  It looks like the overall program is constantly slowing down and speeding up in a sawtooth fashion.  I can't imagine what would cause this to happen (something to do with garbage collection?  Something to do with memory allocation for a bunch of returned <code>()</code>s?).  Note that the baseline timing values I get with the underscore 'replicateM_' is about 100nm, so all of the sawtooth behavior is <em>adding</em> to the overall time, by two orders of magnitude.</p>\n\n<p>The weird behavior remains when I remove literally everything from my source code but this</p>\n\n<pre><code>module Main where\n\nimport           Control.Monad\nimport           System.Clock\n\nmain :: IO ()\nmain = do\n  replicateM_ 10000 $ do\n    timeBefore &lt;- getTime Monotonic\n    --I don't even need to put anything here for the problem to exist\n    timeAfter &lt;- getTime Monotonic\n    putStrLn $ show $ toNanoSecs (timeAfter `diffTimeSpec` timeBefore)\n\n  return ()\n</code></pre>\n\n<p>All you need to do is add or remove that underscore, and the times go from an expected 100nm flat line to the batcrazy sawtooth that jumps from 100nm to 8000nm over and over again.</p>\n\n<p>What am I missing here? </p>\n"}, {"tags": ["haskell", "deriving"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1542829822, "post_id": 53403102, "comment_id": 93713286, "body": "For what it is worth, I prefer your syntax with <code>via ...</code> at the end to the one actually accepted by GHC, where <code>via</code> comes earlier."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1553134929, "post_id": 53404233, "comment_id": 97276760, "body": "Is this anywhere in the users&#39; guide? I haven&#39;t been able to find it!"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1553146237, "post_id": 53404233, "comment_id": 97279113, "body": "<a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#deriving-strategies\" rel=\"nofollow noreferrer\">It is here</a>. It says, in general, <i>all</i> strategies look like <code>deriving strat instance head</code>, and <code>via _</code> is one example of a strategy."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1553146999, "post_id": 53404233, "comment_id": 97279289, "body": "Hmmm. That takes a lot more reading between the lines than it should. Maybe I&#39;ll remember to submit a PR to improve the docs."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 17, "last_activity_date": 1542765026, "creation_date": 1542765026, "answer_id": 53404233, "question_id": 53403102, "link": "https://stackoverflow.com/questions/53403102/deriving-via-with-standalone-deriving/53404233#53404233", "title": "Deriving Via With Standalone Deriving", "body": "<p>It's</p>\n\n<pre><code>deriving via (Vector2D a) instance (Additive a) =&gt; Additive (Square a)\n</code></pre>\n\n<p>The way you wrote it, <code>via</code> looks like a type variable</p>\n\n<pre><code>deriving instance (Additive a) =&gt; Additive (Square a) via (Vector2D a)\n-- &lt;==&gt;\nderiving instance forall a via. (Additive a) =&gt; Additive (Square a) (via) (Vector2D a)\n</code></pre>\n\n<p>and this produces a kind-mismatch error, as <code>Additive (Square a) :: Constraint</code> is already saturated, but you have applied it to two more arguments.</p>\n\n<p>This is backwards from the shorthand form:</p>\n\n<pre><code>data T' = ...\n  deriving Class via T \n</code></pre>\n"}], "owner": {"reputation": 2244, "user_id": 29408, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7af9c8034d5070fb2e8565c79c604b7?s=128&d=identicon&r=PG", "display_name": "Julian Birch", "link": "https://stackoverflow.com/users/29408/julian-birch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1447, "favorite_count": 2, "accepted_answer_id": 53404233, "answer_count": 1, "score": 6, "last_activity_date": 1542795059, "creation_date": 1542756103, "last_edit_date": 1542795059, "question_id": 53403102, "link": "https://stackoverflow.com/questions/53403102/deriving-via-with-standalone-deriving", "title": "Deriving Via With Standalone Deriving", "body": "<p>I'm not really sure what I'm doing wrong here:</p>\n\n<pre><code>data Vector2D u = Vector2D { \n    _x :: u, \n    _y :: u \n} deriving stock (Show, Eq, Functor, Foldable, Traversable)\n\n{-# INLINE addVector2 #-}\naddVector2 :: (Additive a) => Vector2D a -> Vector2D a -> Vector2D a \naddVector2 (Vector2D { _x = x1, _y = y1 }) (Vector2D { _x = x2, _y = y2 }) = \n    Vector2D { _x = x1 + x2, _y = y1 + y2 }\n\ninstance (Additive a) => Additive (Vector2D a) where\n    (+) = addVector2\n\nnewtype Square a = Square {\n    unpackSquare :: Vector2D a\n} deriving stock (Show, Eq)\n</code></pre>\n\n<p>So far, so normal (Additive is defined in the algebra package but is pretty self-explanatory).</p>\n\n<p>However, now I want to be clever using DerivingVia and StandaloneDeriving and I can't even get the next line to compile</p>\n\n<pre><code>deriving instance (Additive a) => Additive (Square a) via (Vector2D a)\n</code></pre>\n\n<p>But that gets me</p>\n\n<pre>\n    * Expected kind `k0 -> * -> Constraint',\n        but `Additive (Square a)' has kind `Constraint'\n    * In the stand-alone deriving instance for\n        `(Additive a) => Additive (Square a) via (Vector2D a)'\n</pre>\n\n<p>Can anyone tell me what I'm doing wrong? I'm running GHC 8.6.2</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers", "continuations"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1542830472, "post_id": 53403001, "comment_id": 93713575, "body": "A few random comments: the order in which you &quot;stack&quot; the monad transformers sometimes (often) matters. I can&#39;t see if you got it right or not. Anyway, <code>ContT Pause</code> is <code>ContT Bool</code> and it looks a bit weird since it&#39;s <code>(a -&gt; m Bool) -&gt; m Bool</code>, which might or might not be what you want."}, {"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1542836699, "post_id": 53403001, "comment_id": 93716176, "body": "@chi In terms of stack ordering, I want to &quot;read&quot; an Integer, if the integer is odd then no state update occurs, if even then add it to the state (an accumulator). That is why I stacked them how they are, <code>ReaderT (ContT (StateT)))</code>. May be incorrect, been reading docs to confirm. Concerning <code>ContT Bool</code>, I think this is the stem of my confusion. I originally looked at it like <code>ReaderT</code> or <code>StateT</code> which use <code>In</code> and <code>StateType</code> respectively. What is <code>(a -&gt; m Bool) -&gt; m Bool</code>?  Seems more abstract than <code>StateType</code> or the Reader environment type. How does the <code>ContT</code> use the function in <code>runM</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 0, "creation_date": 1542829269, "post_id": 53405106, "comment_id": 93713045, "body": "Much thanks! Could you explain what the parameters to <code>ContT</code> mean? Namely in the line <code>M r = {... Reader In (ContT (???) (StateT StateType Identity)) r }</code>."}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 1, "creation_date": 1543853559, "post_id": 53405106, "comment_id": 94057769, "body": "ContT <a href=\"https://hackage.haskell.org/package/transformers-0.5.5.0/docs/src/Control.Monad.Trans.Cont.html#ContT\" rel=\"nofollow noreferrer\">is defined</a> as <code>newtype ContT r m a = ContT { runContT :: (a -&gt; m r) -&gt; m r }</code>.  <code>m</code> is the underlying Monad - <code>(StateT StateType Identity)</code>) in your example.  <code>a</code> is the value at the current stage of computation.  These <code>m</code> and <code>a</code> are the same for every Monad Transformer.  <code>r</code> is the type at which <code>ContT</code> will eventually be run / eliminated, with <code>evalContT</code>"}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 6, "last_activity_date": 1543253015, "last_edit_date": 1543253015, "creation_date": 1542773041, "answer_id": 53405106, "question_id": 53403001, "link": "https://stackoverflow.com/questions/53403001/how-to-create-a-monad-using-statet-contt-and-readert/53405106#53405106", "title": "How to create a monad using StateT, ContT, and ReaderT?", "body": "<p>Unlike <code>MonadReader</code> and <code>MonadState</code>, the <code>MonadCont</code> type class <a href=\"https://hackage.haskell.org/package/mtl-2.2.2/docs/Control-Monad-Cont.html#t:MonadCont\" rel=\"nofollow noreferrer\">takes only one parameter</a>.  Since that parameter <code>m</code> must be a <code>Monad</code>, it must have kind <code>* -&gt; *</code>.</p>\n\n<p>In your deriving clause, you want <code>MonadCont,</code> not <code>MonadCont Pause</code>.</p>\n\n<p>added in response to followup question:</p>\n\n<p><code>ContT</code> <a href=\"https://hackage.haskell.org/package/transformers-0.5.5.0/docs/src/Control.Monad.Trans.Cont.html#ContT\" rel=\"nofollow noreferrer\">is defined as:</a></p>\n\n<pre><code>newtype ContT r m a = ContT { runContT :: (a -&gt; m r) -&gt; m r }\n</code></pre>\n\n<p>Note that the <code>r</code> in your definition of <code>newtype M r</code> is passed as the final (<code>a</code>) parameter to <code>ContT</code>.  Plugging in the variables, you have</p>\n\n<pre><code>ContT Bool (State StateType) a = ContT { \n    runContT :: (a -&gt; State StateType Bool) -&gt; (State StateType Bool)\n  }\n</code></pre>\n\n<p>This provides a computational context in which you can manipulate the <code>StateType</code>, and use delimited continuations.  Eventually, you will construct a <code>ContT Bool (State StateType) Bool</code>.  Then you can run the continuation (with <a href=\"https://hackage.haskell.org/package/transformers-0.5.5.0/docs/Control-Monad-Trans-Cont.html#v:evalContT\" rel=\"nofollow noreferrer\"><code>evalContT</code></a>), and return to the simpler <code>State StateType</code> context.  (In practice, you may unwrap all 3 of your monad transformers in the same part of your program.)</p>\n"}], "owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 1, "accepted_answer_id": 53405106, "answer_count": 1, "score": 2, "last_activity_date": 1543253015, "creation_date": 1542755486, "last_edit_date": 1542884986, "question_id": 53403001, "link": "https://stackoverflow.com/questions/53403001/how-to-create-a-monad-using-statet-contt-and-readert", "title": "How to create a monad using StateT, ContT, and ReaderT?", "body": "<p>How do I create a monad which uses State, Cont, and Reader transformers? I would like to read an environment, and update/use state. However, I would also like to pause/interrupt the action. For example, if a condition is met, the state remains unchanged.</p>\n\n<p>So far I have a monad using ReaderT and StateT, but I cannot work out how to include ContT:</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\nmodule Test where\n-- monads\nimport   Data.Functor.Identity (Identity, runIdentity)\nimport   Control.Monad.State\nimport   Control.Monad.Reader\nimport   Control.Monad.Cont\n\n-- reader environment\ntype In = Integer\n\n-- cont: if true then pause, else continue \ntype Pause = Bool\n\n-- state environment:\nnewtype StateType = StateType { s :: Integer }\n\nnewtype M r = M {_unM :: ReaderT In (ContT Pause (StateT StateType Identity)) r}\n  deriving ( Functor, Applicative, Monad\n           , MonadReader In\n           , MonadCont   Pause\n           , MonadState  StateType\n           )\n\n-- run monadic action\nrunM :: In -&gt; Pause -&gt; StateType -&gt; M r -&gt; StateType\nrunM inp pause initial act\n  = runIdentity             -- unwrap identity\n  $ flip execStateT initial -- unwrap state\n  $ flip runContT   pause   -- unwrap cont\n  $ flip runReaderT inp     -- unwrap reader\n  $ _unM act                -- unwrap action\n</code></pre>\n\n<p>This gives the error:</p>\n\n<pre><code>* Expected kind `* -&gt; *', but `Pause' has kind `*'\n* In the first argument of `MonadCont', namely `Pause'\n  In the newtype declaration for `M'\n  |\n24|         , MonadCont  Pause\n  |\n</code></pre>\n\n<p>Ok, but why does <code>Pause</code> need kind <code>* -&gt; *</code>?... I'm drowning in types, in need of explanation. What form does <code>Pause</code> have to take, a function? How does ContT integrate? Ultimately, I plan to use Cont for a control structure.</p>\n"}, {"tags": ["haskell", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 2501, "user_id": 598892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a22954b638ce69b9994c9e3623953a5?s=128&d=identicon&r=PG", "display_name": "Chris Smith", "link": "https://stackoverflow.com/users/598892/chris-smith"}, "edited": false, "score": 2, "creation_date": 1542753488, "post_id": 53402432, "comment_id": 93680588, "body": "There&#39;s no need to install from a download.  If you&#39;re using cabal-install, just run <code>cabal install QuickCheck</code> and let the resolver do its thing."}], "tags": [], "owner": {"reputation": 1377, "user_id": 8314628, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0eefa2c64f533d21e1d8f58e4252a1e9?s=128&d=identicon&r=PG&f=1", "display_name": "user8314628", "link": "https://stackoverflow.com/users/8314628/user8314628"}, "is_accepted": true, "score": -2, "last_activity_date": 1604171039, "last_edit_date": 1604171039, "creation_date": 1542752247, "answer_id": 53402432, "question_id": 53402263, "link": "https://stackoverflow.com/questions/53402263/could-not-find-module-test-quickcheck-on-windows/53402432#53402432", "title": "Could not find module \u2018Test.QuickCheck\u2019 on Windows", "body": "<p><code>cabal install QuickCheck-2.12.6.1.tar.gz</code></p>\n"}, {"tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": false, "score": 8, "last_activity_date": 1542752898, "creation_date": 1542752898, "answer_id": 53402537, "question_id": 53402263, "link": "https://stackoverflow.com/questions/53402263/could-not-find-module-test-quickcheck-on-windows/53402537#53402537", "title": "Could not find module \u2018Test.QuickCheck\u2019 on Windows", "body": "<p>Firstly, <a href=\"https://lexi-lambda.github.io/blog/2018/02/10/an-opinionated-guide-to-haskell-in-2018/#understanding-stacks-model-and-avoiding-its-biggest-gotcha\" rel=\"noreferrer\"><code>stack install</code> is not recommended</a> for installing executables or libraries. Instead, there's a couple of things you can do to use the <code>QuickCheck</code> library:</p>\n\n<ul>\n<li>If you want to use <code>QuickCheck</code> in a command such as <code>stack ghci</code> or <code>stack ghc</code>, you can add it as a <code>--package</code> option e.g. to run a REPL to play around with <code>QuickCheck</code> you can use <code>stack ghci --package QuickCheck</code> and then write <code>import Test.QuickCheck</code>.</li>\n<li>If you want to write a small one-file program using <code>QuickCheck</code>, then you can run <code>stack ghc --package QuickCheck -- MyProgram.hs</code> (using the <code>--package</code> option from the last bullet point). Alternately, you can use <code>stack</code>'s <a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#script-interpreter\" rel=\"noreferrer\">scripting functionality</a> and include a line such as this at the top of your program:\n<code>\n-- stack --resolver lts-12.18 script --package QuickCheck\n</code></li>\n<li>If you want to use <code>QuickCheck</code> in a large project, then add it as a dependency in your <code>my-program.cabal</code> or <code>project.yaml</code> file.</li>\n</ul>\n\n<p>The same guidance applies to any package you may want to use.</p>\n"}], "owner": {"reputation": 1377, "user_id": 8314628, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0eefa2c64f533d21e1d8f58e4252a1e9?s=128&d=identicon&r=PG&f=1", "display_name": "user8314628", "link": "https://stackoverflow.com/users/8314628/user8314628"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4945, "favorite_count": 3, "accepted_answer_id": 53402432, "answer_count": 2, "score": 1, "last_activity_date": 1604171039, "creation_date": 1542751395, "question_id": 53402263, "link": "https://stackoverflow.com/questions/53402263/could-not-find-module-test-quickcheck-on-windows", "title": "Could not find module \u2018Test.QuickCheck\u2019 on Windows", "body": "<p>My ghci version is 8.4.3</p>\n\n<p>I tried</p>\n\n<pre><code>stack install QuickCheck\n</code></pre>\n\n<p>Something was installed. But when I input <code>import Test.QuickCheck</code>, it tells <code>Could not find module \u2018Test.QuickCheck\u2019</code> again. How can I fix it?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 4, "creation_date": 1542743980, "post_id": 53400522, "comment_id": 93676440, "body": "Use pattern matching, and functions provided in <code>Data.Map</code>."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1542753049, "post_id": 53400522, "comment_id": 93680429, "body": "Pattern matching requires parentheses - try using <code>walk (TVar substitution) = ...</code>. Also you might find <a href=\"https://www.stackage.org/haddock/lts-12.19/containers-0.5.11.0/Data-Map-Strict.html#v:lookup\" rel=\"nofollow noreferrer\"><code>Map.lookup</code></a> useful."}], "answers": [{"comments": [{"owner": {"reputation": 1377, "user_id": 8314628, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0eefa2c64f533d21e1d8f58e4252a1e9?s=128&d=identicon&r=PG&f=1", "display_name": "user8314628", "link": "https://stackoverflow.com/users/8314628/user8314628"}, "edited": false, "score": 0, "creation_date": 1542755290, "post_id": 53401221, "comment_id": 93681227, "body": "I think you give a nice solution. But it fails in a test. <code>walk true Map.empty</code>. It suppose to return <code>True</code>. I can&#39;t figure it out. <code>? Variable not in scope: true :: Term     ? Perhaps you meant data constructor \u2018True\u2019 (imported from Prelude)</code>"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 1377, "user_id": 8314628, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0eefa2c64f533d21e1d8f58e4252a1e9?s=128&d=identicon&r=PG&f=1", "display_name": "user8314628", "link": "https://stackoverflow.com/users/8314628/user8314628"}, "edited": false, "score": 0, "creation_date": 1542755492, "post_id": 53401221, "comment_id": 93681280, "body": "<code>true</code> is not a value of type <code>Term</code>. Only the data constructors used in your <code>data Term</code> declaration can be used to create values of type <code>Term</code>. You would need to use <code>walk (TBool True) Map.empty</code>"}], "tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": true, "score": 2, "last_activity_date": 1542748345, "last_edit_date": 1542748345, "creation_date": 1542746686, "answer_id": 53401221, "question_id": 53400522, "link": "https://stackoverflow.com/questions/53400522/how-to-check-if-the-input-is-a-specific-type/53401221#53401221", "title": "How to check if the input is a specific type?", "body": "<p>Use pattern matching:</p>\n\n<pre><code>walk :: Term -&gt; Substitution -&gt; Term\nwalk term@(TVar lvar) sub = Map.findWithDefault term lvar sub\nwalk (TPair term1 term2) sub = TPair (walk term1 sub) (walk term2 sub)\nwalk term _ = term\n</code></pre>\n"}], "owner": {"reputation": 1377, "user_id": 8314628, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0eefa2c64f533d21e1d8f58e4252a1e9?s=128&d=identicon&r=PG&f=1", "display_name": "user8314628", "link": "https://stackoverflow.com/users/8314628/user8314628"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 53401221, "answer_count": 1, "score": -3, "last_activity_date": 1542748345, "creation_date": 1542743349, "last_edit_date": 1542746210, "question_id": 53400522, "link": "https://stackoverflow.com/questions/53400522/how-to-check-if-the-input-is-a-specific-type", "title": "How to check if the input is a specific type?", "body": "<pre><code>data Term = TNull            -- null term\n          | TBool Bool       -- boolean data\n          | TInt Int         -- integer data\n          | TSymbol String   -- symbolic data\n          | TPair Term Term  -- pairs\n          | TVar LVar        -- logic variable\n          deriving (Show, Eq, Ord)\n\nwalk :: Term -&gt; Substitution -&gt; Term\nwalk term substitution = undefined\n\ntype Substitution = Map.Map LVar Term\n</code></pre>\n\n<p>I want to check if  <code>term</code> is a logic variable.</p>\n\n<p>If it is not a logic variable or not in Substitution mapping, then return it. Otherwise, call walk recursively to see if the Substitution mapping another logic variable. How can I implement it?</p>\n\n<hr>\n\n<p>As  AJFarmar mentioned, I tried pattern matching on it.</p>\n\n<pre><code>walk TVar substitution = if substitution Tvar\n    walk (substitution Tvar) substitution\nwalk _ substitution = TVar\n</code></pre>\n\n<p>But it seems doesn't work.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1542739027, "post_id": 53399391, "comment_id": 93674005, "body": "Indeed you cannot concatenate an Int to a String. You will need to convert it to a Char, and then prepend it (with <code>(:)</code>). Once you&#39;ve done that, you&#39;ll discover you&#39;re building your result backwards!"}, {"owner": {"reputation": 13, "user_id": 7080903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b65b24517b676f2884b505a674c17d?s=128&d=identicon&r=PG&f=1", "display_name": "alex Brock", "link": "https://stackoverflow.com/users/7080903/alex-brock"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1542739493, "post_id": 53399391, "comment_id": 93674219, "body": "How should I convert it to char? I&#39;ve tried fromEnum but that doesn&#39;t seem to work"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1542739768, "post_id": 53399391, "comment_id": 93674341, "body": "When you say &quot;any base&quot;, do you really mean <code>b &lt;= 10</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1542739863, "post_id": 53399492, "comment_id": 93674381, "body": "This is going to produce silly results for <code>b &gt; 10</code>, though."}], "tags": [], "owner": {"reputation": 86, "user_id": 1566094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42217ea28fd57827f27b3f9ab632c4df?s=128&d=identicon&r=PG", "display_name": "rda", "link": "https://stackoverflow.com/users/1566094/rda"}, "is_accepted": false, "score": 3, "last_activity_date": 1542739322, "creation_date": 1542739322, "answer_id": 53399492, "question_id": 53399391, "link": "https://stackoverflow.com/questions/53399391/couldnt-match-expected-type-char-with-actual-type-int/53399492#53399492", "title": "Couldn&#39;t match expected type \u2018[Char]\u2019 with actual type \u2018Int\u2019", "body": "<p>The problem is here:</p>\n\n<pre><code>(mod n b) ++ int2Base (div n b) b\n</code></pre>\n\n<p>\"(mod n b)\" produces an Int, not a String.</p>\n\n<p>This should fix it:</p>\n\n<pre><code>int2Base :: Int -&gt; Int -&gt; String\nint2Base n b\n    |n == 0 = \"0\"\n    |otherwise = show(mod n b) ++ int2Base (div n b) b\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 9282443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec27afd669197cacddfe1852f7684bd5?s=128&d=identicon&r=PG&f=1", "display_name": "MyLifeisPi", "link": "https://stackoverflow.com/users/9282443/mylifeispi"}, "is_accepted": false, "score": 1, "last_activity_date": 1542743034, "creation_date": 1542743034, "answer_id": 53400448, "question_id": 53399391, "link": "https://stackoverflow.com/questions/53399391/couldnt-match-expected-type-char-with-actual-type-int/53400448#53400448", "title": "Couldn&#39;t match expected type \u2018[Char]\u2019 with actual type \u2018Int\u2019", "body": "<p>if you look at ++ in GHCI <br/></p>\n\n<pre><code>Prelude&gt; :t (++)\n(++) :: [a] -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>So ++ can only be applied to lists and [char] is a list of chars.</p>\n\n<p>Mean while if you want to convert this Int value to String/[Char] you may use show</p>\n\n<pre><code>Prelude&gt; :t show\nshow :: Show a =&gt; a -&gt; String\n</code></pre>\n\n<p>This mean show is capable of taking certain types as denoted by 'a' and returning String.</p>\n\n<p>So to fix the error you may use <code>otherwise = show(mod n b) ++ int2Base (div n b) b</code></p>\n\n<p>This will make sure you match the function type with a list of strings </p>\n\n<pre><code>int2Base :: Int -&gt; Int -&gt; String\nint2Base n b\n  |n == 0 = ['0']\n  |otherwise = show(mod n b) ++ int2Base (div n b) b\n</code></pre>\n\n<p>(I've used ['0'] just to show how String in double quotes maintains [chars] type</p>\n"}], "owner": {"reputation": 13, "user_id": 7080903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b65b24517b676f2884b505a674c17d?s=128&d=identicon&r=PG&f=1", "display_name": "alex Brock", "link": "https://stackoverflow.com/users/7080903/alex-brock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1407, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1542743034, "creation_date": 1542738887, "question_id": 53399391, "link": "https://stackoverflow.com/questions/53399391/couldnt-match-expected-type-char-with-actual-type-int", "title": "Couldn&#39;t match expected type \u2018[Char]\u2019 with actual type \u2018Int\u2019", "body": "<p>Working on a method to convert a number n into any base b and having some trouble.</p>\n\n<p>Code:</p>\n\n<pre><code>int2Base :: Int -&gt; Int -&gt; String\nint2Base n b\n    |n == 0 = \"0\"\n    |otherwise = (mod n b) ++ int2Base (div n b) b\n</code></pre>\n\n<p>and my error:</p>\n\n<pre><code>Couldn't match expected type \u2018[Char]\u2019 with actual type \u2018Int\u2019\nIn the second argument of \u2018mod\u2019, namely \u2018b\u2019\nIn the first argument of \u2018(++)\u2019, namely \u2018(mod n b)\u2019\n</code></pre>\n\n<p>It seems like a simply error but even when I cast it to a char it still expects '[Char]' not [Char]</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 893, "user_id": 6248287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tPegr.jpg?s=128&g=1", "display_name": "\u019b\u019b\u019b", "link": "https://stackoverflow.com/users/6248287/%c6%9b%c6%9b%c6%9b"}, "edited": false, "score": 0, "creation_date": 1542738902, "post_id": 53399049, "comment_id": 93673938, "body": "wouldn&#39;t it make sense modelling the CpuStateRow using Map?"}, {"owner": {"reputation": 2966, "user_id": 315302, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1d57a52c98eee46fb4bc92e0b4ffe163?s=128&d=identicon&r=PG", "display_name": "Javran", "link": "https://stackoverflow.com/users/315302/javran"}, "reply_to_user": {"reputation": 893, "user_id": 6248287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tPegr.jpg?s=128&g=1", "display_name": "\u019b\u019b\u019b", "link": "https://stackoverflow.com/users/6248287/%c6%9b%c6%9b%c6%9b"}, "edited": false, "score": 0, "creation_date": 1542741342, "post_id": 53399049, "comment_id": 93675106, "body": "@\u019b\u019b\u019b but that&#39;ll impose an extra lookup overhead that I don&#39;t necessarily need - I already know all fields and there&#39;s no adding / removing of them."}], "answers": [{"comments": [{"owner": {"reputation": 2966, "user_id": 315302, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1d57a52c98eee46fb4bc92e0b4ffe163?s=128&d=identicon&r=PG", "display_name": "Javran", "link": "https://stackoverflow.com/users/315302/javran"}, "edited": false, "score": 0, "creation_date": 1542757604, "post_id": 53399299, "comment_id": 93681782, "body": "thanks for the answer! perhaps a bit off topic but I&#39;m wondering if I can write Applicative instances with template haskell?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 2966, "user_id": 315302, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1d57a52c98eee46fb4bc92e0b4ffe163?s=128&d=identicon&r=PG", "display_name": "Javran", "link": "https://stackoverflow.com/users/315302/javran"}, "edited": false, "score": 0, "creation_date": 1542779224, "post_id": 53399299, "comment_id": 93686675, "body": "I&#39;m sure it is possible for a type as regular as this, but I don&#39;t think enough people are writing a ton of types equivalent to <code>(a,a,a,a,a,a,a,a)</code> that this would be built into any library without having to do some work yourself."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 4, "last_activity_date": 1542738519, "creation_date": 1542738519, "answer_id": 53399299, "question_id": 53399049, "link": "https://stackoverflow.com/questions/53399049/what-are-the-best-ways-to-do-field-wise-datatype-operations/53399299#53399299", "title": "What are the best ways to do field-wise datatype operations?", "body": "<p>If you want to generalize to functions of any arity and any argument type, I think Applicative is the best you will find. Indeed you won't be able to derive it, but at least you can implement <code>pure</code> and <code>(&lt;*&gt;)</code> once and then reuse it for all of your functions rather than having to do the tedium for each of them. And you can ask GHC to derive the Functor instance for you, if nothing else.</p>\n\n<p>If you want to work with \"accumulative values\" instead of general functions, you could consider adding a Monoid (or just Semigroup) instance, of the form</p>\n\n<pre><code>instance Semigroup a =&gt; Semigroup (CpuStatRow a) where\n  (CpuStatRow x y z ...) &lt;&gt; (CpuStatRow x' y' z') = CpuStatRow (x &lt;&gt; x') (y &lt;&gt; y') (z &lt;&gt; z') ...\n</code></pre>\n\n<p>As you can imagine that would get tiring quickly, but fortunately you can implement it in terms of Applicative - we're already saving time!</p>\n\n<pre><code>instance Semigroup a =&gt; Semigroup (CpuStatRow a) where\n  (&lt;&gt;) = liftA2 (&lt;&gt;)\n\ninstance Monoid a =&gt; Monoid (CpuStatRow a) where\n  mempty = pure mempty\n</code></pre>\n"}], "owner": {"reputation": 2966, "user_id": 315302, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1d57a52c98eee46fb4bc92e0b4ffe163?s=128&d=identicon&r=PG", "display_name": "Javran", "link": "https://stackoverflow.com/users/315302/javran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 53399299, "answer_count": 1, "score": 2, "last_activity_date": 1542738519, "creation_date": 1542737515, "question_id": 53399049, "link": "https://stackoverflow.com/questions/53399049/what-are-the-best-ways-to-do-field-wise-datatype-operations", "title": "What are the best ways to do field-wise datatype operations?", "body": "<p>Say I have a datatype like:</p>\n\n<pre><code>data CpuStatRow a = CpuStatRow\n  { user :: a\n  , nice :: a\n  , system :: a\n  , idle :: a\n  , ioWait :: a\n  , irq :: a\n  , softIrq :: a\n  , steal :: a\n  }\n</code></pre>\n\n<p>which comes from parsing CPU info from <a href=\"http://man7.org/linux/man-pages/man5/proc.5.html\" rel=\"nofollow noreferrer\">/proc/stat</a> of a linux OS, in which every numeric field is an accumulative value since boot time. So if I want to figure out values during certain period, I need to grab <code>before :: CpuStatRow Int</code> and <code>after :: CpuStatRow Int</code> and do the field-wise difference (assuming proper language extensions):</p>\n\n<pre><code>-- let's not worry about distinction between a raw value and a difference for now ...\ntype Diff = Int\ngetDiff :: CpuStatRow Int -&gt; CpuStatRow Int -&gt; CpuStatRow Diff\ngetDiff after before = CpuStatRow {..}\n  where\n    diffOn prj = prj after - prj before\n    user = diffOn user\n    nice = diffOn nice\n    ... -- basically same for each field\n</code></pre>\n\n<p>I'm wondering is there something better to do that:</p>\n\n<ul>\n<li>generalize to function of other aritieis (e.g. lift a function <code>f :: a -&gt; b -&gt; c -&gt; d</code> to some <code>f' :: F a -&gt; F b -&gt; F c -&gt; F d</code></li>\n<li>can easily work on any datatype, as there are many accumulative values in <code>/proc</code>, applying the same method above is not fun. I have <code>Applicative</code> in mind but that doesn't seems to be \"deriving-able\" by ghc</li>\n</ul>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1542736351, "post_id": 53398679, "comment_id": 93672713, "body": "Use alex+happy, or one of the many excellent parser combinator libraries. See e.g. <a href=\"https://stackoverflow.com/q/52556531/791604\">this question</a> for some discussion of why this is a superior approach to basic recursion or basic <code>String</code>-processing functions. I&#39;m tempted to mark this as a duplicate, since my answer is basically the same to both questions, differing only in the exact language being parsed."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1542754168, "post_id": 53400099, "comment_id": 93680818, "body": "I think we also need <code>hour1:hour2:...</code>, given the OP&#39;s sample data."}], "tags": [], "owner": {"reputation": 224, "user_id": 10668680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c4996037684a7b9e963c7c3d19c260?s=128&d=identicon&r=PG&f=1", "display_name": "Erick Gonzalez", "link": "https://stackoverflow.com/users/10668680/erick-gonzalez"}, "is_accepted": true, "score": 3, "last_activity_date": 1542741701, "creation_date": 1542741701, "answer_id": 53400099, "question_id": 53398679, "link": "https://stackoverflow.com/questions/53398679/pattern-matching-timestamp-string/53400099#53400099", "title": "Pattern Matching timestamp string", "body": "<p>Well, in general it is true that using a parser combinator library is something you can't go wrong with. However, I don't think there is anything wrong in doing this with a simple manually rolled approach if, for example, you know for sure that the timestamps have to follow a very strict specification (and otherwise they wouldn't be valid). So in the interest of answering your actual question, there are actually a few things wrong with your code, but specifically your pattern matching:</p>\n\n<p><code>isTimeStamp (hour:':':min:':':sec:',':mil:_)\n</code></p>\n\n<p>Doesn't match what you think it does, cause the <code>min</code> , <code>sec</code> and <code>mil</code> match <em>one</em> character.. if you changed this to:</p>\n\n<p><code>isTimeStamp (hour:':':min1:min2:':':sec1:sec2:',':mil1:mil2:mil3:_)\n</code></p>\n\n<p>You'd get that pattern matching working for your timestamps.. </p>\n\n<p>Your second problem is with that your pattern matches are not exhaustive.. you probably want to change that match on \"\" and match <code>_</code> and change their order of course, thus:</p>\n\n<pre><code>isTimeStamp :: String -&gt; Bool\nisTimeStamp (hour:':':min1:min2:':':sec1:sec2:',':mil1:mil2:mil3:\"\") =   \nisTimeStamp _ = False\n</code></pre>\n\n<p>After this I would suggest using a <code>Maybe</code> monad for your checks.. something like:</p>\n\n<pre><code>data TimeStamp = TimeStamp Int Int Int Int deriving Show\n\ngetTimeStamp :: String -&gt; Maybe TimeStamp\ngetTimeStamp (hour:':':min1:min2:':':sec1:sec2:',':mil1:mil2:mil3:_) = do\n    h   &lt;- readMaybe $ hour:\"\"\n    m   &lt;- readMaybe $ min1:min2:\"\"\n    s   &lt;- readMaybe $ sec1:sec2:\"\"\n    mil &lt;- readMaybe $ mil1:mil2:mil3:\"\"\n    return $ TimeStamp h m s mil\nisTimeStamp _ = Nothing\n</code></pre>\n\n<p>But then after this you probably would realize that what you really want is making <code>TimeStamp</code> an instance of the <code>Read</code> and <code>Show</code> classes, so you can <code>show</code>it or <code>read</code>it .. (or yes.. <code>readMaybe</code>it) :-)</p>\n"}], "owner": {"reputation": 18, "user_id": 6864411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc093d2e7dad0ac6ad4f9f76af9a443?s=128&d=identicon&r=PG&f=1", "display_name": "Lory", "link": "https://stackoverflow.com/users/6864411/lory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 53400099, "answer_count": 1, "score": 0, "last_activity_date": 1542741701, "creation_date": 1542735996, "question_id": 53398679, "link": "https://stackoverflow.com/questions/53398679/pattern-matching-timestamp-string", "title": "Pattern Matching timestamp string", "body": "<p>So, I have a .srt file, which is a subtitles file of the form:</p>\n\n<pre><code>1\n00:00:01,230 --&gt; 00:00:02,360\nThis is a subtitle\n\n2\n00:00:03,124 --&gt; 00:00:04,400\nThis is another subtitle\n</code></pre>\n\n<p>And I need to modify it a little bit. One of the things I need to do is check the integrity of the timestamps, so I was trying to write a function in haskell to check if a string is a valid timestamp</p>\n\n<pre><code>data TimeStamp = TimeStamp Int Int Int Int deriving (Eq, Show, Read)\n\ngetTimeStamp :: String -&gt; TimeStamp\ngetTimeStamp a = read a\n\nisNum :: Maybe Int -&gt; Bool\nisNum x = isJust x\n\nisTimeStamp :: String -&gt; Bool\nisTimeStamp \"\" = False\nisTimeStamp (hour:':':min:':':sec:',':mil:_) = if (isNum numH) &amp;&amp; (isNum numM) &amp;&amp; (isNum numS) &amp;&amp; (isNum numMil) then True else False\n            where numH   = readMaybe [hour] :: Maybe Int\n                  numM   = readMaybe [min] ::  Maybe Int\n                  numS   = readMaybe [sec] ::  Maybe Int\n                  numMil = readMaybe [mil] ::  Maybe Int\n</code></pre>\n\n<p>The problem is, my pattern matching doesn't work. I'm not really sure how I should pattern match substrings... Any help?</p>\n"}, {"tags": ["list", "haskell", "sum", "expand"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1542733264, "post_id": 53397811, "comment_id": 93671095, "body": "What precisely is your algorithm supposed to do? What are you having trouble with?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542734256, "post_id": 53397811, "comment_id": 93671608, "body": "You want to insert the sum of each adjacent pair between the pair? <code>[a, b, c] =&gt; [a, a+b, b, b + c, c]</code>?"}, {"owner": {"reputation": 75, "user_id": 2535251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3poq3.jpg?s=128&g=1", "display_name": "Marco_O", "link": "https://stackoverflow.com/users/2535251/marco-o"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542735027, "post_id": 53397811, "comment_id": 93672003, "body": "What I want to do is the following: <code>[a, b, c] =&gt; [a, a+b, b+c, c]</code>. It&#39;s basically the same as what @chepner suggested, but without b repeating itself."}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 1, "creation_date": 1542735875, "post_id": 53397811, "comment_id": 93672473, "body": "How about more than 3 elements in list? say, [a, b, c, d] =&gt; [a, a+b, b+c, c+d, d]?"}, {"owner": {"reputation": 75, "user_id": 2535251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3poq3.jpg?s=128&g=1", "display_name": "Marco_O", "link": "https://stackoverflow.com/users/2535251/marco-o"}, "edited": false, "score": 0, "creation_date": 1542737271, "post_id": 53397811, "comment_id": 93673135, "body": "I have the solution, but could you give me any pointers on how to improve my research or problem solving skills, for when stuff like this happens? I just got down voted and I want to improve. Thanks in advance."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1606761852, "post_id": 53398705, "comment_id": 115054060, "body": "If performance is a concern, this should be written <code>\\x -&gt; zipWith (+) (x++[0]) (0:x)</code>. It&#39;s not a big deal, but it&#39;s nice to let <code>zipWith</code> fuse with <code>(++)</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 6, "last_activity_date": 1606761870, "last_edit_date": 1606761870, "creation_date": 1542736094, "answer_id": 53398705, "question_id": 53397811, "link": "https://stackoverflow.com/questions/53397811/how-can-i-sum-the-middle-elements-of-an-expanding-list-in-haskell/53398705#53398705", "title": "How can I sum the middle elements of an expanding list in Haskell?", "body": "<p>Basically, all you want to compute component-wise sums between your input list and  a shifted version of it:</p>\n<pre><code>a   b   c   d   e\n    a   b   c   d   e\n---------------------------\na  a+b b+c c+d d+e  e\n</code></pre>\n<p>Fill each empty slot with a 0 (<code>0:x</code> and <code>x++[0]</code>), and you just need <code>zipWith</code></p>\n<pre><code>&gt; (\\x -&gt; zipWith (+) (0:x) (x++[0])) [1,2,3]\n[1,3,5,3]\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 2535251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3poq3.jpg?s=128&g=1", "display_name": "Marco_O", "link": "https://stackoverflow.com/users/2535251/marco-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 53398705, "answer_count": 1, "score": -1, "last_activity_date": 1606761870, "creation_date": 1542732742, "last_edit_date": 1542735277, "question_id": 53397811, "link": "https://stackoverflow.com/questions/53397811/how-can-i-sum-the-middle-elements-of-an-expanding-list-in-haskell", "title": "How can I sum the middle elements of an expanding list in Haskell?", "body": "<p>So far I know how to expand a list from its ends, but they end up getting doubled because of the first condition, which is to double a singleton. Would it make sense for the code to be like this:</p>\n\n<pre><code>sumExpand :: [Integer] -&gt; [Integer]\n\nsumExpand l = expand l []\n  where\n    expand [] a     = a\n    expand (x:[]) a = x: expand [] (x:a)\n    expand (x:xs) a = expand (x:a) (expand xs a)\n</code></pre>\n\n<p>And for me to work on its output:</p>\n\n<pre><code>[1,1,2,2,3,3] from [1,2,3]\ninstead of [1,3,5,3]\n</code></pre>\n\n<p>The latter being my desire? Here's how I got to a temporary solution for a list of two elements:</p>\n\n<pre><code>expand (x:xs) a = x: tail (expand (map (x+) xs) (last xs:a))\n</code></pre>\n\n<hr>\n\n<p>Output:</p>\n\n<pre><code>*Main&gt; sumExpand [1,2]\n[1,3,2]\n*Main&gt; sumExpand [1,2,3]\n[1,7,4,3]\n</code></pre>\n\n<hr>\n\n<p>EDIT: basically, I want the algorithm to work like this: <code>[a, b, c] =&gt; [a, a+b, b+c, c]</code></p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "is_accepted": false, "score": 1, "last_activity_date": 1542731651, "creation_date": 1542731651, "answer_id": 53397490, "question_id": 53397200, "link": "https://stackoverflow.com/questions/53397200/haskell-wikibook-generalized-algebraic-data-types-exercise-maybe-and-either/53397490#53397490", "title": "Haskell Wikibook - Generalized Algebraic Data Types Exercise - Maybe and Either", "body": "<blockquote>\n  <p>eval (Add e1 e2) = ...</p>\n</blockquote>\n\n<p>You will want to evaluate <code>e1</code> and <code>e2</code> then pattern match on those results. There's various ways of doing that. For instance you can use <code>let</code> bindings. </p>\n\n<pre><code>let ev1 = eval e1\n    ev2 = eval e2 \nin  \n</code></pre>\n\n<p>And then pattern match using the <code>case</code> construction. Or with no <code>let</code> bindings if you prefer, you can just do</p>\n\n<pre><code>case (eval e1, eval e2) of \n</code></pre>\n\n<p>and pattern match on that pair. </p>\n"}, {"comments": [{"owner": {"reputation": 2501, "user_id": 598892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a22954b638ce69b9994c9e3623953a5?s=128&d=identicon&r=PG", "display_name": "Chris Smith", "link": "https://stackoverflow.com/users/598892/chris-smith"}, "edited": false, "score": 1, "creation_date": 1542733939, "post_id": 53397503, "comment_id": 93671442, "body": "Pairs are great for reducing the complexity of pattern matching.  The first block above could be rewritten as <code>case (eval e1, eval e2) of { (Just (Left i1), Just (Left i2)) -&gt; Just (Left (i1 + i2)); _ -&gt; Nothing }</code>"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 2501, "user_id": 598892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a22954b638ce69b9994c9e3623953a5?s=128&d=identicon&r=PG", "display_name": "Chris Smith", "link": "https://stackoverflow.com/users/598892/chris-smith"}, "edited": false, "score": 0, "creation_date": 1542736614, "post_id": 53397503, "comment_id": 93672821, "body": "@ChrisSmith Nice! I added that"}], "tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": true, "score": 4, "last_activity_date": 1542736440, "last_edit_date": 1542736440, "creation_date": 1542731698, "answer_id": 53397503, "question_id": 53397200, "link": "https://stackoverflow.com/questions/53397200/haskell-wikibook-generalized-algebraic-data-types-exercise-maybe-and-either/53397503#53397503", "title": "Haskell Wikibook - Generalized Algebraic Data Types Exercise - Maybe and Either", "body": "<p>Yes, with pattern matching and perhaps even the <code>Maybe</code> monad.</p>\n\n<p>You could implement the <code>eval (Add e1 e2)</code> branch using just pattern matching:</p>\n\n<pre><code>eval (Add e1 e2) = case eval e1 of\n    Just (Left i1) -&gt; case eval e2 of\n        Just (Left i2) -&gt; Just (Left (i1 + i2))\n        _ -&gt; Nothing\n    _ -&gt; Nothing\n</code></pre>\n\n<p>Pattern matching on a pair is one good way of reducing the amount of nested <code>case</code> statements:</p>\n\n<pre><code>eval (Add e1 e2) = case (eval e1, eval e2) of\n    (Just (Left i1), Just (Left i2)) -&gt; Just (Left (i1 + i2))\n    _ -&gt; Nothing\n</code></pre>\n\n<p>Or, you could use the <code>Maybe</code> monad as an abstraction over those <code>case</code> statements. It will automatically return <code>Nothing</code> if any of the pattern matching fails in the <code>do</code> block bindings (due to how the <code>Maybe</code> monad implements <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Monad.html#v:fail\" rel=\"nofollow noreferrer\"><code>fail</code></a>).</p>\n\n<pre><code>eval (Add e1 e2) = do\n    Left i1 &lt;- eval e1\n    Left i2 &lt;- eval e2\n    return (Left (i1 + i2))\n</code></pre>\n"}], "owner": {"reputation": 965, "user_id": 3052692, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/abxME.jpg?s=128&g=1", "display_name": "rjmurt", "link": "https://stackoverflow.com/users/3052692/rjmurt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 1, "accepted_answer_id": 53397503, "answer_count": 2, "score": 2, "last_activity_date": 1542736440, "creation_date": 1542730676, "last_edit_date": 1542730851, "question_id": 53397200, "link": "https://stackoverflow.com/questions/53397200/haskell-wikibook-generalized-algebraic-data-types-exercise-maybe-and-either", "title": "Haskell Wikibook - Generalized Algebraic Data Types Exercise - Maybe and Either", "body": "<p>There's an exercise on <a href=\"https://en.wikibooks.org/wiki/Haskell/GADT#Extending_the_language\" rel=\"nofollow noreferrer\">this page of the Haskell Wikibook</a> which gets you to work through a scenario using Maybe and Either (presumably to show that it is quite painful for the use case).</p>\n\n<p>The exercise is:</p>\n\n<pre><code>data Expr = I Int\n        | B Bool           -- boolean constants\n        | Add Expr Expr\n        | Mul Expr Expr\n        | Eq  Expr Expr    -- equality test\n\neval :: Expr -&gt; Maybe (Either Int Bool)\n-- Your implementation here.\n</code></pre>\n\n<p>The first lines of the solution are - I think - straightforward:</p>\n\n<pre><code>data Expr = I Int         -- integer constants\n          | B Bool        -- boolean constants\n          | Add Expr Expr -- add two expressions\n          | Mul Expr Expr -- multiply two expressions\n          | Eq  Expr Expr -- equality test\n          deriving (Show)\n\neval :: Expr -&gt; Maybe (Either Int Bool)\neval (I n) = Just $ Left n\neval (B b) = Just $ Right b\neval (Add e1 e2) = ...\neval (Mul e1 e2) = ...\neval (Eq e1 e2) = ...\n</code></pre>\n\n<p>But I'm not exactly sure how to define the rest. As an example I guess for <code>add</code> I need to unpack the <code>fromLeft</code>, <code>fromJust</code> of each expression, but I'm not sure how to do this properly (with pattern matching?)</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["haskell", "opengl", "functional-programming"], "comments": [{"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1542836797, "post_id": 53397141, "comment_id": 93716213, "body": "So is your <code>keyboardMouse</code> called? Put there <code>print something</code> and see if it prints when you press the button"}, {"owner": {"reputation": 589, "user_id": 5773084, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10208437935529920/picture?type=large", "display_name": "Chris Wohlert", "link": "https://stackoverflow.com/users/5773084/chris-wohlert"}, "reply_to_user": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1542876973, "post_id": 53397141, "comment_id": 93728328, "body": "I actually managed to get something working, by further reading and understanding the tutorial. I hoped for at stateless solution, but that doesn&#39;t seem to be possible."}], "owner": {"reputation": 589, "user_id": 5773084, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10208437935529920/picture?type=large", "display_name": "Chris Wohlert", "link": "https://stackoverflow.com/users/5773084/chris-wohlert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542730450, "creation_date": 1542730450, "question_id": 53397141, "link": "https://stackoverflow.com/questions/53397141/check-for-key-down-in-opengl-haskell", "title": "Check for key down in OpenGL Haskell", "body": "<p>I am fairly new at Haskell and I am trying to create a small game in my free time.</p>\n\n<p><a href=\"https://wiki.haskell.org/OpenGLTutorial2\" rel=\"nofollow noreferrer\">This tutorial</a> does a great job of explaining how it works, and I can get the entire thing running smoothly. However, whenever they make things move in the example, they manipulate the entire viewport.</p>\n\n<p>What I want for my game, is to change the data it displays when pressing a key.</p>\n\n<p>Instead of this:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  (_progName, _args) &lt;- getArgsAndInitialize\n  _window &lt;- createWindow \"Hello World\"\n  displayCallback $= display\n  reshapeCallback $= Just reshape\n  keyboardMouseCallback $= Just keyboardMouse\n  mainLoop\n</code></pre>\n\n<p>I tried:</p>\n\n<pre><code>import Graphics.UI.GLUT\n\nmain :: IO ()\nmain = do\n  (_progName, _args) &lt;- getArgsAndInitialize\n  _window &lt;- createWindow \"Hello World\"\n  go [(1,1,1),(0.5,0.5,0.5)] -- Initial state\n  mainLoop\n\ngo points = do\n  displayCallback $= (display points) -- Parse points to draw lines between\n  keyboardMouseCallback $= Just keyboardMouse\n  return ()\n    where\n        keyboardMouse _key _state _modifiers _position = go ((0,0,0):points) \n        -- Defined here so I can reference 'go'\n\ndisplay :: [(GLfloat,GLfloat,GLfloat)] -&gt; DisplayCallback\ndisplay points = do \n  clear [ColorBuffer]\n  renderPrimitive Lines $\n     mapM_ (\\(x, y, z) -&gt; vertex $ Vertex3 x y z) points\n  flush\n</code></pre>\n\n<p>However, it only draws the first line. It doesn't redraw when I press a key.\nSo imagine that I match on the key pressed, and from there I determine which point to add to the list of points. Can I get that working here, I should be able to implement it in my game.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "edited": false, "score": 0, "creation_date": 1542731425, "post_id": 53396657, "comment_id": 93670042, "body": "I see. The idea is to wrap the getEnv function and handle the exception there. I think can still be done without using ExceptT tho."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "edited": false, "score": 0, "creation_date": 1542736874, "post_id": 53396657, "comment_id": 93672933, "body": "It can.  I&#39;d say the idea is to catch and wrap exceptions at the granularity of the error messages you desire. For example, you could derive <code>Exception</code> for <code>ReadError</code>, catch/discard the old exception and throw a more informative one from there and all in IO.  I went a step further and avoided re-throwing with exceptions since that is rarely what I personally desire."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1542728823, "creation_date": 1542728823, "answer_id": 53396657, "question_id": 53395955, "link": "https://stackoverflow.com/questions/53395955/how-to-handle-an-error-in-the-middle-of-a-chained-io/53396657#53396657", "title": "How to handle an error in the middle of a chained IO?", "body": "<p>Considered using an ExceptT monad and adding the right abstraction to <code>getEnv</code>.</p>\n\n<p>For example:</p>\n\n<p>First let's get past the boilerplate:</p>\n\n<pre><code>module Main where\n\nimport Control.Exception (SomeException(..), handle, throw)\n       -- N.B. Should use Control.Exception.Safe\nimport qualified Control.Exception as X\nimport Data.Typeable (typeOf)\nimport qualified System.Environment as Env\nimport Control.Monad.Trans.Except\n</code></pre>\n\n<p>We want to define something like IO but specialized to handling exceptions in a more composable manner and at least allow <code>getEnv</code>.  The monad is ExceptT IO:</p>\n\n<pre><code>type MyIO a = ExceptT ReadError IO a\nrunMyIO :: MyIO a -&gt; IO (Either ReadError a)\nrunMyIO = runExceptT\n</code></pre>\n\n<p>And the operations we can perform in the monad should be lifted - remember, if the rest of your code is typing <code>lift</code> a lot then you might not have your monad properly abstracted.</p>\n\n<pre><code>getEnv :: String -&gt; MyIO String\ngetEnv s = ExceptT ((Right &lt;$&gt; Env.getEnv s) `X.catch` hdl)\n where hdl :: X.SomeException -&gt; IO (Either ReadError String)\n       hdl _ = pure $ Left (Missing s)\n</code></pre>\n\n<p>Now we can use this version of <code>getEnv</code> in main:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  eitherEnvs &lt;- runMyIO ( (,) &lt;$&gt; getEnv \"HOST\" &lt;*&gt; getEnv \"PORT\" )\n  case eitherEnvs of\n    Left err -&gt; print err\n    Right (port, host) -&gt; print (port, host)\n</code></pre>\n\n<p>And yes, we did redefine the Error type:</p>\n\n<pre><code>data ReadError\n  = Missing String\n  -- N.B an enum strategy such as MissingPort is doable but often has a\n  -- data-dependency at the call site such as @getEnv \"host\" MissingHost@\n  --\n  -- That would be a lot like your 'missingEnv' function which forms a mapping\n  -- from user strings to the ADT enum 'ReadError'.\n  deriving (Show)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "edited": false, "score": 0, "creation_date": 1542750855, "post_id": 53397595, "comment_id": 93679575, "body": "I agree <code>lookupEnv</code> is better. I just used <code>getEnv</code> as an example to learn how to catch exceptions."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1542751113, "last_edit_date": 1542751113, "creation_date": 1542732034, "answer_id": 53397595, "question_id": 53395955, "link": "https://stackoverflow.com/questions/53395955/how-to-handle-an-error-in-the-middle-of-a-chained-io/53397595#53397595", "title": "How to handle an error in the middle of a chained IO?", "body": "<p>Using <code>lookupEnv</code> really isn't that bad. The following provides the same locality of error handling as Thomas M. DuBuisson's answer.</p>\n\n<pre><code>module Main where\n\nimport System.Environment (lookupEnv)\n\ndata ReadError  = MissingHost | MissingPort deriving (Show)\n\ntype EnvReadResult a = IO (Either ReadError a)\n\nmain :: IO ()\nmain = readEnv &gt;&gt;= either print print\n\nparseEnv :: String -&gt; ReadError -&gt; EnvReadResult String\nparseEnv name err = lookupEnv name &gt;&gt;= return . maybe (Left err) Right\n\nreadEnv :: EnvReadResult (String, String)\nreadEnv = do \n             host &lt;- parseEnv \"HOST\" MissingHost -- host :: Either ReadError String\n             port &lt;- parseEnv \"PORT\" MissingPort -- port :: ditto\n             return $ (,) &lt;$&gt; host &lt;*&gt; port  -- Combine and lift back into IO\n</code></pre>\n\n<p><code>parseEnv</code> takes a variable name and the error to report if the variable is undefined, and returns an <code>IO</code>-wrapped <code>Either</code> value. The <code>maybe</code> function acts as the \"exception handler\", rewrapping a <code>Just</code> value with <code>Right</code> or converting <code>Nothing</code> to an appropriate <code>Left</code> value.</p>\n\n<p>The <code>Applicative</code> instance for <code>Either</code> effectively returns the first error found, or combines all <code>Right</code> values into a single <code>Right</code> value. For example:</p>\n\n<pre><code> (,) &lt;$&gt; Right \"example.com\" &lt;*&gt; Right \"23456\" == Right (\"example.com\", \"23456\")\n (,) &lt;$&gt; Left MissingHost &lt;*&gt; Right \"23456\" == Left MissingHost\n (,) &lt;$&gt; Right \"example.com\" &lt;*&gt; Left MissingPort == Left MissingPort\n</code></pre>\n\n<hr>\n\n<p>You can also take advantage of the fact that applicative functors compose.</p>\n\n<pre><code>readEnv = let host = parseEnv \"HOST\" MissingHost\n              port = parseEnv \"PORT\" MissingPort\n          in getCompose $ (,) &lt;$&gt; Compose host &lt;*&gt; Compose port\n</code></pre>\n\n<p>In particular, since <code>IO</code> and <code>Either ReadError</code> are both applicative functors, so is <code>Compose IO (Either ReadError)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "is_accepted": false, "score": 0, "last_activity_date": 1542751063, "creation_date": 1542751063, "answer_id": 53402218, "question_id": 53395955, "link": "https://stackoverflow.com/questions/53395955/how-to-handle-an-error-in-the-middle-of-a-chained-io/53402218#53402218", "title": "How to handle an error in the middle of a chained IO?", "body": "<p>With the above two answers, I come up with a solution that</p>\n\n<p>1) Doesn't require additional complexity (ExceptT)</p>\n\n<p>2) Doesn't need to parse the error message to distinguish which action failed.</p>\n\n<p>3) readEnv is kept flat.</p>\n\n<pre><code>module Main where\n\nimport Control.Exception (IOException, handle)\nimport System.Environment (getEnv)\n\ndata ReadError\n  = MissingHost\n  | MissingPort\n  deriving (Show)\n\nmain :: IO ()\nmain = do\n  eitherEnvs &lt;- readEnv\n  either print print eitherEnvs\n\ngetEnv' :: String -&gt; ReadError -&gt; IO (Either ReadError String)\ngetEnv' env err = handle (missingEnv err) $ Right &lt;$&gt; (getEnv env)\n\nreadEnv :: IO (Either ReadError (String, String))\nreadEnv = do\n  eitherHost &lt;- getEnv' \"HOST\" MissingHost\n  eitherPort &lt;- getEnv' \"PORT\" MissingPort\n  return $ (,) &lt;$&gt; eitherHost &lt;*&gt; eitherPort\n\nmissingEnv :: ReadError -&gt; IOException -&gt; IO (Either ReadError String)\nmissingEnv err _ = return $ Left err\n</code></pre>\n"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 2, "answer_count": 3, "score": 3, "last_activity_date": 1542751113, "creation_date": 1542726550, "question_id": 53395955, "link": "https://stackoverflow.com/questions/53395955/how-to-handle-an-error-in-the-middle-of-a-chained-io", "title": "How to handle an error in the middle of a chained IO?", "body": "<p>Let's say I have a <code>readEnv</code> function that reads two env vars and returns an Either value, with a <code>ReadError</code> type as the Left value:</p>\n\n<pre><code>module Main where\n\nimport Control.Exception (SomeException(..), handle, throw)\nimport Data.Typeable (typeOf)\nimport System.Environment (getEnv)\n\ndata ReadError\n  = MissingHost\n  | MissingPort\n  deriving (Show)\n\nmain :: IO ()\nmain = do\n  eitherEnvs &lt;- readEnv'\n  case eitherEnvs of\n    Left err -&gt; print err\n    Right (port, host) -&gt; print (port, host)\n\nreadEnv :: IO (Either ReadError (String, String))\nreadEnv = do\n  port &lt;- getEnv \"HOST\"\n  host &lt;- getEnv \"PORT\"\n  return $ Right (port, host)\n\nreadEnv' :: IO (Either ReadError (String, String))\nreadEnv' = handle missingEnv readEnv\n\nmissingEnv :: SomeException -&gt; IO (Either ReadError (String, String))\nmissingEnv (SomeException e)\n  | isMissingHost e = do\n    print e\n    return $ Left $ MissingHost\n  | isMissingPort e = do\n    print e\n    return $ Left $ MissingPort\n  | otherwise = throw e\n  where\n    isMissingHost e = take 4 (show e) == \"HOST\"\n    isMissingPort e = take 4 (show e) == \"PORT\"\n</code></pre>\n\n<p>Since I know <code>getEnv</code> is an IO that will throw if the env var is missing, (i know there is lookupEnv, but my question is about how to handle error, not how to avoid error), I made a <code>readEnv'</code> function that will catch the IO Exception and converts it to the <code>ReadError</code> type. </p>\n\n<p>The above code works, however, I don't like this pattern/style to handle exception, because in order to handle the exception from <code>getEnv \"HOST\"</code>, I have to put the handler outside of the entire <code>readEnv</code>, and parse the error message in order to distinguish if the error is <code>MissingHost</code> or <code>MissingPort</code>. If the error message doesn't contain \"HOST\" or \"PORT\", then the <code>missingEnv</code> can't distinguish which <code>getEnv</code> call is the exception from.</p>\n\n<p>Ideally, there is a way to handle the exception at where it happened and short circuits to return with the Left value. Since I know the only IOException in <code>getEnv \"HOST\"</code> is <code>MissingHost</code> error, then I don't need to parse the error message.</p>\n\n<p>How to do that?</p>\n"}, {"tags": ["parsing", "haskell", "parsec"], "comments": [{"owner": {"reputation": 1306, "user_id": 5664775, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/QqQGd.jpg?s=128&g=1", "display_name": "Luke Collins", "link": "https://stackoverflow.com/users/5664775/luke-collins"}, "reply_to_user": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 0, "creation_date": 1542718992, "post_id": 53393220, "comment_id": 93662480, "body": "@mschmidt Thanks, I&#39;ll fix that."}, {"owner": {"reputation": 1306, "user_id": 5664775, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/QqQGd.jpg?s=128&g=1", "display_name": "Luke Collins", "link": "https://stackoverflow.com/users/5664775/luke-collins"}, "reply_to_user": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 0, "creation_date": 1542719819, "post_id": 53393220, "comment_id": 93662978, "body": "When I try to parse, I get no output at all (I think it hangs/goes into an infinite loop). But if I remove <code>conformula</code> from the parser <code>formula</code> (i.e. if I do <code>formula =  formulaTerm &lt;|&gt; varFormula &lt;|&gt; forallFormula</code>), the parser works as desired."}, {"owner": {"reputation": 1306, "user_id": 5664775, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/QqQGd.jpg?s=128&g=1", "display_name": "Luke Collins", "link": "https://stackoverflow.com/users/5664775/luke-collins"}, "reply_to_user": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 0, "creation_date": 1542720414, "post_id": 53393220, "comment_id": 93663380, "body": "Ok, I don&#39;t think, I <i>know</i> it goes into an infinite loop (it slowed down my computer after a while). Here&#39;s the <a href=\"https://i.imgur.com/vUtUBVb.png\" rel=\"nofollow noreferrer\">output</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1306, "user_id": 5664775, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/QqQGd.jpg?s=128&g=1", "display_name": "Luke Collins", "link": "https://stackoverflow.com/users/5664775/luke-collins"}, "edited": false, "score": 0, "creation_date": 1542752011, "post_id": 53402155, "comment_id": 93680059, "body": "I like this solution, although I&#39;m not sure why we need a <code>try</code> for the <code>formulaCon</code>. I think I managed to fix it by rephrasing the grammar, preserving left-associativity. Could you take a look at it and check whether it&#39;s correct? I posted it as an answer."}], "tags": [], "owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "is_accepted": false, "score": 0, "last_activity_date": 1542750809, "creation_date": 1542750809, "answer_id": 53402155, "question_id": 53393220, "link": "https://stackoverflow.com/questions/53393220/parsing-a-formal-logic-in-haskell/53402155#53402155", "title": "Parsing a Formal Logic in Haskell", "body": "<p>The problem in your code is, that you try to parse a <code>formula</code> for which the first attempt is to parse a <code>formulaCon</code>. This then first tries to parse a <code>formula</code>, i.e. you create an infinite recursion <strong>without consuming any input</strong>.</p>\n\n<p>To resolve this, you have to structure your grammar. Define your terms like this (note that all these terms consume some input before doing a recursion back to <code>formula</code>):</p>\n\n<pre><code>formulaTerm = ttFormula\n          &lt;|&gt; ffFormula\n          &lt;|&gt; varFormula\n          &lt;|&gt; forallFormula\n          &lt;|&gt; roundBrackets formula\n\nforallFormula = do\n  keyword \"forall\"\n  x &lt;- identifier\n  op \".\"\n  phi &lt;- formula\n  return $ Forall x phi\n</code></pre>\n\n<p>A formula is then either a single term or a conjunction consisting of term, an operator, and another formula. To ensure that all input is parsed, first try to parse a conjunction and - if that fails - parse a single term:</p>\n\n<pre><code>formula = (try formulaCon) &lt;|&gt; formulaTerm\n</code></pre>\n\n<p>Finally a <code>formulaCon</code> can be parsed like this:</p>\n\n<pre><code>formulaCon = do\n  f1 &lt;- formulaTerm\n  op \"&amp;\"\n  f2 &lt;- formula\n  return $ Con f1 f2\n</code></pre>\n\n<p>The drawback with this solution is that conjunctions are now right associative.</p>\n"}, {"comments": [{"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 0, "creation_date": 1542755268, "post_id": 53402376, "comment_id": 93681217, "body": "Looks OK for me, since it successfully parsed the <code>tt &amp; ff &amp; tt</code>. I never tried to use <code>buildExpressionParser</code>, but the trick is to parse for terms within the conjunction, not for formulas."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1542757824, "post_id": 53402376, "comment_id": 93681827, "body": "Since <code>conFormula</code> can already match a single <code>formulaTern</code>, you don&#39;t need <code>formulaTerm</code> as an alternative in <code>term</code>."}], "tags": [], "owner": {"reputation": 1306, "user_id": 5664775, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/QqQGd.jpg?s=128&g=1", "display_name": "Luke Collins", "link": "https://stackoverflow.com/users/5664775/luke-collins"}, "is_accepted": true, "score": 1, "last_activity_date": 1542751896, "creation_date": 1542751896, "answer_id": 53402376, "question_id": 53393220, "link": "https://stackoverflow.com/questions/53393220/parsing-a-formal-logic-in-haskell/53402376#53402376", "title": "Parsing a Formal Logic in Haskell", "body": "<p>I think I managed to fix the problem by rephrasing the grammar, and conjunction is still left-associative:</p>\n\n<pre><code>formula :: Parser Formula\nformula = conFormula\n        &lt;|&gt; formulaTerm\n\nformulaTerm :: Parser Formula\nformulaTerm = roundBrackets formula\n            &lt;|&gt; ttFormula\n            &lt;|&gt; ffFormula\n            &lt;|&gt; varFormula\n            &lt;|&gt; forallFormula\n\nconFormula :: Parser Formula\nconFormula = \n    buildExpressionParser [[Infix (op \"&amp;\" &gt;&gt; return Con) AssocLeft]] formulaTerm\n</code></pre>\n\n<p>This parsed the following successfully.\n<a href=\"https://i.stack.imgur.com/Xi1Aj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xi1Aj.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1306, "user_id": 5664775, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/QqQGd.jpg?s=128&g=1", "display_name": "Luke Collins", "link": "https://stackoverflow.com/users/5664775/luke-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 2, "accepted_answer_id": 53402376, "answer_count": 2, "score": 3, "last_activity_date": 1542751896, "creation_date": 1542717661, "last_edit_date": 1542718918, "question_id": 53393220, "link": "https://stackoverflow.com/questions/53393220/parsing-a-formal-logic-in-haskell", "title": "Parsing a Formal Logic in Haskell", "body": "<p>I have the following language I am trying to parse.</p>\n\n<pre><code>formula ::=  true  \n         |  false  \n         |  var  \n         |  formula &amp; formula  \n         |  \u2200 var . formula\n         |  (formula)\n\n    var ::=  letter { letter | digit }*\n</code></pre>\n\n<p>I have been following <a href=\"https://wiki.haskell.org/Parsing_a_simple_imperative_language\" rel=\"nofollow noreferrer\">this article</a> on the Haskell wiki and have used Parsec combinators to create the following parser.</p>\n\n<pre><code>module LogicParser where\n\nimport System.IO\nimport Control.Monad\nimport Text.ParserCombinators.Parsec\nimport Text.ParserCombinators.Parsec.Expr\nimport Text.ParserCombinators.Parsec.Language\nimport qualified Text.ParserCombinators.Parsec.Token as Token\n\n-- Data Structures\ndata Formula = Var String\n             | TT\n             | FF\n             | Con Formula Formula\n             | Forall String Formula\n               deriving (Show)\n\n-- Language Definition\nlang :: LanguageDef st\nlang =\n    emptyDef{ Token.identStart      = letter\n            , Token.identLetter     = alphaNum\n            , Token.opStart         = oneOf \"&amp;.\"\n            , Token.opLetter        = oneOf \"&amp;.\"\n            , Token.reservedOpNames = [\"&amp;\", \".\"]\n            , Token.reservedNames   = [\"tt\", \"ff\", \"forall\"]\n            }\n\n\n-- Lexer for langauge\nlexer = \n    Token.makeTokenParser lang\n\n\n-- Trivial Parsers\nidentifier     = Token.identifier lexer\nkeyword        = Token.reserved lexer\nop             = Token.reservedOp lexer\nroundBrackets  = Token.parens lexer\nwhiteSpace     = Token.whiteSpace lexer\n\n-- Main Parser, takes care of trailing whitespaces\nformulaParser :: Parser Formula\nformulaParser = whiteSpace &gt;&gt; formula\n\n-- Parsing Formulas\nformula :: Parser Formula\nformula = conFormula\n        &lt;|&gt; formulaTerm\n        &lt;|&gt; forallFormula\n\n-- Term in a Formula\nformulaTerm :: Parser Formula\nformulaTerm = roundBrackets formula\n            &lt;|&gt; ttFormula\n            &lt;|&gt; ffFormula\n            &lt;|&gt; varFormula\n\n-- Conjunction\nconFormula :: Parser Formula\nconFormula = \n    buildExpressionParser [[Infix (op \"&amp;\" &gt;&gt; return Con) AssocLeft]] formula\n\n-- Truth\nttFormula :: Parser Formula\nttFormula = keyword \"tt\" &gt;&gt; return TT\n\n-- Falsehood\nffFormula :: Parser Formula\nffFormula = keyword \"ff\" &gt;&gt; return FF\n\n-- Variable\nvarFormula :: Parser Formula\nvarFormula =\n    do  var &lt;- identifier\n        return $ Var var\n\n-- Universal Statement \nforallFormula :: Parser Formula\nforallFormula = \n    do  keyword \"forall\"\n        x &lt;- identifier\n        op \".\"\n        phi &lt;- formulaTerm\n        return $ Forall x phi\n\n-- For running runghc\ncalculate :: String -&gt; String\ncalculate s = \n    case ret of\n        Left e -&gt;  \"Error: \" ++ (show e)\n        Right n -&gt; \"Interpreted as: \" ++ (show n)\n    where \n        ret = parse formulaParser \"\" s\n\nmain :: IO ()\nmain = interact (unlines . (map calculate) . lines)\n</code></pre>\n\n<p>The problem is the <code>&amp;</code> operator, I am trying to model it on <a href=\"https://wiki.haskell.org/Parsing_a_simple_imperative_language#Expressions\" rel=\"nofollow noreferrer\">how the article parses expressions</a>, using the <code>Infix</code> function and passing it a list of operators and a parser to parse terms. However, the parser is not behaving as desired and I can't work out why. Here are some examples of desired behaviour:</p>\n\n<pre><code>true                         -- parsing --&gt;      TT\ntrue &amp; false                 -- parsing --&gt;      Con TT FF\ntrue &amp; (true &amp; false)        -- parsing --&gt;      Con TT (Con TT FF)\nforall x . false &amp; true      -- parsing --&gt;      Con (Forall \"x\" FF) TT\n</code></pre>\n\n<p>However currently the parser is producing no output. I appreciate any assistance.</p>\n"}, {"tags": ["haskell", "functional-programming", "pointfree", "tacit-programming"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 5, "creation_date": 1542712798, "post_id": 53391699, "comment_id": 93658983, "body": "is this an assignment? what have <i>you</i> tried? BTW calling your values by names of built-in functions is confusing. Better use <code>minval</code> and <code>maxval</code>."}, {"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 2, "creation_date": 1542714994, "post_id": 53391699, "comment_id": 93660227, "body": "You might want to look at the documentation for <code>liftA2</code> in module <code>Control.Applicative</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1542722725, "post_id": 53391699, "comment_id": 93664839, "body": "There&#39;s no compelling reason to write this particular function in point-free style. This version is quite readable as-is."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542796349, "post_id": 53391699, "comment_id": 93694962, "body": "You mean the reason for closure? Questions are supposed to show at least some traces of the asker&#39;s personal effort. that&#39;s what &quot;what have you tried?&quot; referred to. A simple &quot;I tried this or that&quot; with a piece of code, however nonsensical, would do to show the effort. I would normally leave it be even then but &quot;You can rearrange parameters as you want.&quot; looked like a straight copy-paste from an assignment sheet. So I voted to close. I gather four others felt the same way. Moreover, the answers are probably not really helpful to you, and seem designed to prevent you handing them in as is."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542798673, "post_id": 53391699, "comment_id": 93696319, "body": "But if you were to indicate where specifically were you having a difficulty, I&#39;m sure you&#39;d receive help here that would be much more to the point, and helpful. Otherwise, we don&#39;t know what is your difficulty here, do we. :)  the specific rule is: <i>&quot;questions ... must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself&quot;</i>. (btw, I didn&#39;t down vote)"}, {"owner": {"reputation": 236, "user_id": 2304996, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/82ce2661ddaabff9cb824f9e5b193e3a?s=128&d=identicon&r=PG", "display_name": "user2304996", "link": "https://stackoverflow.com/users/2304996/user2304996"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1542799456, "post_id": 53391699, "comment_id": 93696737, "body": "@WillNess <i>questions ... must include the desired behavior</i> isn&#39;t it clear what I want to achieve? <i>and the shortest code necessary to reproduce it in the question itself</i> I wrote the code of the simple function with understandable name and logic. Could you please refer to the rule, where written that I must mention what I have tried?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542799902, "post_id": 53391699, "comment_id": 93696973, "body": "@user2304996 &quot;isn&#39;t it clear what I want to achieve? &quot; yes, you want a ready-made answer to your problem. &quot;I wrote the code of the simple function&quot; no, you haven&#39;t included <i>your code</i> aimed at solving your problem, not one bit of it. Let me give you an example: it is as if you asked: &quot;what is the definite integral of <code>x^1.5</code> on the interval <code>[1..10]</code> (you may give me an answer as a number with two decimal places precision).&quot;. And I&#39;m asking, &quot;what have you tried&quot;? Of course your question is clear, the clarity is not the problem, the lack of any trace of your effort is."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542799946, "post_id": 53391699, "comment_id": 93696996, "body": "the rule is: <i>&quot; a specific problem</i> [with your attempt at solving your problem] <i>or error and the shortest code necessary to reproduce it &quot;</i>. otherwise, I&#39;m not a lawyer. please take it to the <a href=\"https://meta.stackoverflow.com/\">meta</a>. Ask there, whether this question was closed properly or not. :)"}, {"owner": {"reputation": 22634, "user_id": 1426539, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/rHdZU.png?s=128&g=1", "display_name": "yivi", "link": "https://stackoverflow.com/users/1426539/yivi"}, "edited": false, "score": 4, "creation_date": 1542801292, "post_id": 53391699, "comment_id": 93697735, "body": "<a href=\"https://meta.stackoverflow.com/questions/376889/was-my-question-closed-properly\">This question is being discussed in Meta</a>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 3, "creation_date": 1542813478, "post_id": 53391699, "comment_id": 93704761, "body": "OK, so after the edit, and while the new 3rd vote for deletion is not cast, what have you tried? Where exactly is your difficulty? Have you yourself tried  to find a solution? What code snippets have you written? Do you know about &quot;operator sections&quot;? Do you know about &quot;combinators&quot;? (these are googlable terms). Do you know e.g. about transforming <code>sin (cos x)</code> to <code>(sin . cos) x</code>? Do you know about &quot;eta reduction&quot;?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542814795, "post_id": 53391699, "comment_id": 93705552, "body": "sorry, I don&#39;t understand. I&#39;m trying to help here. I&#39;ve cast an undelete vote. there&#39;s 2 new votes for deletion now (3rd will delete it once more). (there&#39;s also 2 votes to reopen; 3 more are needed for that to happen) ---- meantime, <code>\\x. (minVal &lt; x) &amp;&amp; (x &lt; maxVal)</code> is not valid Haskell, right?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542818194, "post_id": 53391699, "comment_id": 93707705, "body": "As I said, I was trying to help. Thanks for your feedback."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1542828172, "post_id": 53391699, "comment_id": 93712529, "body": "@user2304996 &quot;but you just can&#39;t stop&quot; -- Will Ness didn&#39;t do anything wrong here. While we do strive to preserve as much of the meaning and intent of a question as reasonable when editing it, keep in mind that posting a question here is contributing to a community repository of questions and answers. You should think of it as something like creating a page in a public wiki."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1542878048, "post_id": 53391699, "comment_id": 93728933, "body": "@duplode as I see it, the question looked like a hopeless dump of an assignment, with that &quot;you can ...&quot; language, containing nothing except the problem statement itself. the OP didn&#39;t respond to clarification request, didn&#39;t edit. It went through some meta drama, closure, deletion and undeletion (for which I voted), so finally I had to edit to make it passable so I could vote to reopen (it was one vote away from being deleted again, and all the posters&#39; efforts would&#39;ve gone to waste)."}, {"owner": {"reputation": 236, "user_id": 2304996, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/82ce2661ddaabff9cb824f9e5b193e3a?s=128&d=identicon&r=PG", "display_name": "user2304996", "link": "https://stackoverflow.com/users/2304996/user2304996"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542889480, "post_id": 53391699, "comment_id": 93735766, "body": "@WillNess, Honestly, it is not an assignment. I just wanted to know (just curiosity) what are the options to make this function&#39;s definition in point-free style. I don&#39;t care how it look like. I wouldn&#39;t argue with you at all and wouldn&#39;t create question to meta if you would give reference to the rule I broke in the first place. Instead you gave me something not related. For me it was like you just putt it on hold, because you can (have permissions)."}], "answers": [{"tags": [], "owner": {"reputation": 725, "user_id": 496426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d66dddc305fb73168919883b985ab794?s=128&d=identicon&r=PG", "display_name": "Kris", "link": "https://stackoverflow.com/users/496426/kris"}, "is_accepted": false, "score": 8, "last_activity_date": 1542713241, "creation_date": 1542713241, "answer_id": 53392009, "question_id": 53391699, "link": "https://stackoverflow.com/questions/53391699/how-to-write-this-function-in-point-free-style/53392009#53392009", "title": "How to write this function in point-free style?", "body": "<p>It can be done using the <code>Reader</code> applicative:</p>\n\n<pre><code>between min max = \\x. (min &lt; x) &amp;&amp; (x &lt; max)\n              { Convert infix comparisons to sections }\n                = \\x. ((min &lt;) x) &amp;&amp; ((&lt; max) x)\n              { Move infix (&amp;&amp;) to applicative style }\n                = \\x. (&amp;&amp;) ((min &lt;) x) ((&lt; max) x)\n              { Lift to applicative style using the applicative instance of `(-&gt;) a` }\n                = \\x. (pure (&amp;&amp;) &lt;*&gt; (min &lt;) &lt;*&gt; (&lt; max)) x\n              { Eta-reduce }\n                = pure (&amp;&amp;) &lt;*&gt; (min &lt;) &lt;*&gt; (&lt; max)\n              { Optionally simplify for idiomatic style }\n                = (&amp;&amp;) &lt;$&gt; (min &lt;) &lt;*&gt; (&lt; max)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542722687, "post_id": 53394362, "comment_id": 93664819, "body": "It almost seems like you&#39;re trying to discourage point-free style here :)"}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1542736575, "post_id": 53394362, "comment_id": 93672802, "body": "well, <code>flip (&lt;)</code> is the same as <code>(&gt;)</code>, so you can save a few characters there ;)"}, {"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 0, "creation_date": 1542738648, "post_id": 53394362, "comment_id": 93673820, "body": "Alternatively and even shorter: <code>liftA2 (&amp;&amp;) (min &lt;) (max &gt;)</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542741250, "post_id": 53394362, "comment_id": 93675052, "body": "@chepner I&#39;m trying my best :) Actually, I&#39;m in favor of point-free but against point-less. The main issue is that the difference between those can be quite subtle."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1542813817, "post_id": 53394362, "comment_id": 93704970, "body": "also, <code>and . sequence [(min &lt;), (max &gt;)]</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1542722168, "last_edit_date": 1542722168, "creation_date": 1542721332, "answer_id": 53394362, "question_id": 53391699, "link": "https://stackoverflow.com/questions/53391699/how-to-write-this-function-in-point-free-style/53394362#53394362", "title": "How to write this function in point-free style?", "body": "<p>Using <code>Control.Arrow</code> we can reach this nearly obfuscated code:</p>\n\n<pre><code>(min &lt;) &amp;&amp;&amp; (&lt; max) &gt;&gt;&gt; uncurry (&amp;&amp;)\n</code></pre>\n\n<p>This relies on the predefined <code>&gt;&gt;&gt;</code> for left-to-right composition, <code>f &amp;&amp;&amp; g = \\x -&gt; (f x, g x)</code>, and uncurrying.</p>\n\n<hr>\n\n<p><a href=\"http://pointfree.io/\" rel=\"nofollow noreferrer\">pointfree.io</a> also suggests the following unreadable code:</p>\n\n<pre><code>between = (. flip (&lt;)) . ap . ((&amp;&amp;) .) . (&lt;)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1542799096, "post_id": 53399392, "comment_id": 93696559, "body": "and with <code>(&lt;&amp;&amp;&gt;) = liftA2 (&amp;&amp;)</code> it becomes the almost readable <code>(min &lt;) &lt;&amp;&amp;&gt; (max &gt;)</code>. BTW there are these definitions somewhere, <code>(&lt;^) = flip fmap</code> and <code>(^&gt;) = (&lt;*&gt;)</code>, such that it becomes the nearly identical-looking <code>(min &lt;) &lt;^(&amp;&amp;)^&gt; (max &gt;)</code>."}], "tags": [], "owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "is_accepted": true, "score": 5, "last_activity_date": 1542747494, "last_edit_date": 1542747494, "creation_date": 1542738889, "answer_id": 53399392, "question_id": 53391699, "link": "https://stackoverflow.com/questions/53391699/how-to-write-this-function-in-point-free-style/53399392#53399392", "title": "How to write this function in point-free style?", "body": "<p>Another solution (needs import of <code>Control.Applicative</code>):</p>\n\n<pre><code>between min max = liftA2 (&amp;&amp;) (min &lt;) (max &gt;)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1542968183, "creation_date": 1542968183, "answer_id": 53444731, "question_id": 53391699, "link": "https://stackoverflow.com/questions/53391699/how-to-write-this-function-in-point-free-style/53444731#53444731", "title": "How to write this function in point-free style?", "body": "<p>By operator sections transformation,</p>\n\n<pre><code>between min max x = (min &lt; x) &amp;&amp; (x &lt; max)\n                  = ((&amp;&amp;) . (min &lt;)) x ((&lt; max) x)\n</code></pre>\n\n<p>Now <em>this</em> fits a pattern for <strong>S</strong>-combinator, <code><b>S</b> f g x = (f x) (g x)</code>. There are many ways of encoding it in Haskell, but the main two are via Applicative and via Arrows:</p>\n\n<pre><code>    _S f g x = (f x) (g x)\n             = (f &lt;*&gt; g) x\n             = uncurry id . (f &amp;&amp;&amp; g) $ x\n</code></pre>\n\n<p>The second gives us</p>\n\n<pre><code>between a z = uncurry (&amp;&amp;) . ((a &lt;) &amp;&amp;&amp; (&lt; z))\n</code></pre>\n\n<p>And the first, even more fitting</p>\n\n<pre><code>between a z = (&amp;&amp;) &lt;$&gt; (a &lt;) &lt;*&gt; (&lt; z)\n            = liftA2 (&amp;&amp;) (a &lt;) (&lt; z)\n            = (a &lt;) &lt;^(&amp;&amp;)^&gt; (&lt; z)     -- nice and visual\n\n(&lt;^) = flip (&lt;$&gt;) \n(^&gt;) = (&lt;*&gt;)\n</code></pre>\n\n<p>But we could also fiddle with other combinators, with much less satisfactory results though,</p>\n\n<pre><code>    _S f g x = f x (g x)\n             = flip f (g x) x\n             = (flip f . g) x x\n             = join (flip f &lt;$&gt; g) x\n             = (flip f =&lt;&lt; g) x \n</code></pre>\n\n<p>or</p>\n\n<pre><code>             = (f x . g) x\n             = (. g) (f x) x\n             = ((. g) =&lt;&lt; f) x\n</code></pre>\n\n<p>which illustrates nicely the dangers of pointlessness in the pursuit of the pointfree. </p>\n\n<p>There's one more possibility that makes sense (syntactically), which is</p>\n\n<pre><code>    _S f g x = (f x) (g x)\n        --   = foldr1 ($) . sequence [f,g] $ x  -- not valid Haskell\n\n        -- sequence [f,g] x = [f x,g x]\n</code></pre>\n\n<p>This is not a valid Haskell in general because of the typing issues, but in our specific case it does give rise to one more  valid definition, which also does seem to follow the inner logic of it nicely,</p>\n\n<pre><code>between a z = -- foldr1 ($) . sequence [(&amp;&amp;).(a &lt;), (&lt; z)] -- not OK\n            = foldr1 (&amp;&amp;) . sequence [(a &lt;), (&lt; z)]        -- OK\n            = and . sequence [(a &lt;), (&gt; z)]\n</code></pre>\n\n<p>because <code>(a &lt;)</code> and <code>(&gt; z)</code> have the same type.</p>\n"}], "owner": {"reputation": 236, "user_id": 2304996, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/82ce2661ddaabff9cb824f9e5b193e3a?s=128&d=identicon&r=PG", "display_name": "user2304996", "link": "https://stackoverflow.com/users/2304996/user2304996"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 53399392, "answer_count": 4, "score": -12, "last_activity_date": 1542968183, "creation_date": 1542712185, "last_edit_date": 1542817358, "question_id": 53391699, "link": "https://stackoverflow.com/questions/53391699/how-to-write-this-function-in-point-free-style", "title": "How to write this function in point-free style?", "body": "<p>How to rewrite the following function in point-free style, removing the parameter <code>x</code> from the definition completely (the other two may stay):</p>\n\n<pre><code>between min max x = (min &lt; x) &amp;&amp; (x &lt; max)\n</code></pre>\n\n<p>This is not an assignment, just a question. I don't know how to proceed. I can turn it into a lambda function</p>\n\n<pre><code>between min max = \\x -&gt; (min &lt; x) &amp;&amp; (x &lt; max)\n</code></pre>\n\n<p>but this is not point-free, as <code>x</code> is still there. Please help.</p>\n"}, {"tags": ["haskell", "lazy-evaluation", "newtype"], "answers": [{"comments": [{"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 0, "creation_date": 1542724095, "post_id": 53391467, "comment_id": 93665703, "body": "So if no such pattern matching is done, there&#39;s absolutely no difference between the two?"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 4, "creation_date": 1542735200, "post_id": 53391467, "comment_id": 93672100, "body": "There should be a slight memory overhead with the strict data that isn&#39;t there with the newtype, but I don&#39;t remember if GHC can optimize that out."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 1, "creation_date": 1542742392, "post_id": 53391467, "comment_id": 93675605, "body": "@yairchu I think so. There&#39;s a small memory overhead with strict data, as DarthFennec points out. Note that &quot;if no such pattern matching&quot; can be a big &quot;if&quot; -- pattern matching is everything for data types. E.g. <code>case expensiveFunction 23 of D d -&gt; ...</code> performs the expensive computation immediately for big data, potentially keeping in memory a long list <code>d</code> for a long time depending on the <code>...</code>. With a newtype, that list would be bound lazily, and only generated afterwards, when (and if) demanded by the <code>...</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1542711370, "creation_date": 1542711370, "answer_id": 53391467, "question_id": 53391237, "link": "https://stackoverflow.com/questions/53391237/difference-between-newtype-and-data-with-a-strictness-annotation/53391467#53391467", "title": "Difference between `newtype` and `data` with a strictness annotation", "body": "<p>For instance,</p>\n\n<pre><code>case undefined of\n   D d -&gt; \"hello\"\n</code></pre>\n\n<p>will error out for <code>data</code> types (strict or not strict), but will evaluate to <code>\"hello\"</code> for newtypes.</p>\n\n<p>This is because, at runtime, applying a <code>newtype</code> constructor, or pattern matching on it corresponds to no operation. Not even forcing the value we <code>case</code> upon.</p>\n\n<p>By contrast, pattern matching on a <code>data</code> constructor always forces the value we <code>case</code> upon.</p>\n\n<p>I think this is the only runtime difference between strict <code>data</code> and <code>newtype</code>.\nThere are some static differences, such as some GHC extensions which only affect <code>newtype</code>, <code>Coercible</code>, etc., but at runtime the two types are isomorphic (but pattern matching operates differently, as shown above).</p>\n"}], "owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 1, "accepted_answer_id": 53391467, "answer_count": 1, "score": 4, "last_activity_date": 1542711370, "creation_date": 1542710568, "question_id": 53391237, "link": "https://stackoverflow.com/questions/53391237/difference-between-newtype-and-data-with-a-strictness-annotation", "title": "Difference between `newtype` and `data` with a strictness annotation", "body": "<p>How does this code</p>\n\n<pre><code>data D = D { _d :: ![P] } -- Note the strictness annotation!\n</code></pre>\n\n<p>Compare to this</p>\n\n<pre><code>newtype D = D { _d :: [P] }\n</code></pre>\n\n<p>An <a href=\"https://stackoverflow.com/a/13567709/40916\">answer to a related question</a> says:</p>\n\n<blockquote>\n  <p>the main difference between data and newtype is that with data is that data constructors are lazy while newtype is strict</p>\n</blockquote>\n\n<p>How does this difference work when the <code>data</code> version has a strictness annotation?</p>\n\n<p>(the question is based on real code the I've stumbled on)</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1542695369, "post_id": 53387280, "comment_id": 93650261, "body": "It will run whichever comes first in your <code>$PATH</code>. Adjust your <code>$PATH</code>, so that /opt/ghc/bin comes first or uninstall the other GHC."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1542695521, "post_id": 53387280, "comment_id": 93650307, "body": "Do you have <code>&#47;opt&#47;ghc&#47;bin&#47;:</code> directory listed in the <code>$PATH</code> variable..? If not you have an earlier version of GHC already installed in one of the directories listed under <code>$PATH</code> variable."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542722930, "post_id": 53387280, "comment_id": 93664975, "body": "Run <code>which -a ghc</code>; you should get back multiple paths."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 4, "last_activity_date": 1542696374, "creation_date": 1542696374, "answer_id": 53387610, "question_id": 53387280, "link": "https://stackoverflow.com/questions/53387280/why-does-ghc-run-version-7-10-3-instead-of-8-6-2/53387610#53387610", "title": "Why does GHC run version 7.10.3 instead of 8.6.2?", "body": "<p>You seem to have a misunderstanding about ghc, system administration, or both.</p>\n\n<p>GHC ships as individual versions of the compiler - just as gcc or any other compiler I can think of.  If you run the ghc 8.6.2 binary then it will report version 8.6.2.  If you run some unknown ghc and ask it for the version, as you did with just <code>$ ghc --version</code>, then you'll see the results from the first ghc binary in the path.  You can even find out which binary using <code>which ghc</code> and <code>ls -l $(which ghc)</code>.</p>\n\n<p>So you seem to have multiple GHC binaries installed.  Again, this is something to do with your administration of this system.  I suggest you:</p>\n\n<ol>\n<li>Go through and remove any previously installed GHC binaries from apt etc</li>\n<li>Set a path to include the HVR PPA ghc you just installed.  For example, edit <code>$HOME/.bashrc</code> if you use bash and add <code>PATH=/opt/ghc/bin:$PATH</code> to the end of the file.</li>\n</ol>\n"}], "owner": {"reputation": 13, "user_id": 9393466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pkrlj.png?s=128&g=1", "display_name": "addie", "link": "https://stackoverflow.com/users/9393466/addie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 53387610, "answer_count": 1, "score": -1, "last_activity_date": 1542696374, "creation_date": 1542694642, "question_id": 53387280, "link": "https://stackoverflow.com/questions/53387280/why-does-ghc-run-version-7-10-3-instead-of-8-6-2", "title": "Why does GHC run version 7.10.3 instead of 8.6.2?", "body": "<p>I am new to Haskell (as in, have yet to write a single line of Haskell code). I recently downloaded GHC version 8.6.2 on Ubuntu 16.04 via the ppa:hvr/ghc.  However, when I run</p>\n\n<p><code>$ ghc --version</code></p>\n\n<p>I get</p>\n\n<p><code>The Glorious Glasgow Haskell Compilation System, version 7.10.3</code></p>\n\n<p>I can run version 8.6.2 using the command</p>\n\n<p><code>$ /opt/ghc/bin/ghc-8.6.2 --version</code></p>\n\n<p>so I assume this is normal behaviour. However, I don't understand why it automatically runs version 7.10.3. Additionally, is there a way I can change it so that the <code>ghc</code> command will automatically run the latest version installed?</p>\n\n<p>I did try searching for answers previously, but was unable to find any. Any explanations / help would be appreciated.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 1, "creation_date": 1542710720, "post_id": 53386121, "comment_id": 93657924, "body": "See <a href=\"https://stackoverflow.com/questions/43359289/architecture-x86-64-while-running-haskell-code-haskell-osx-iconv\" title=\"architecture x86 64 while running haskell code haskell osx iconv\">stackoverflow.com/questions/43359289/&hellip;</a>"}, {"owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "reply_to_user": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 1, "creation_date": 1542777998, "post_id": 53386121, "comment_id": 93686362, "body": "Hi, @yairchu I&#39;ve tried every method this answer provides, none works for me. I also find all paths contain <code>libiconv</code> and tried one by one. It does not work, either."}], "owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 455, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542687255, "creation_date": 1542687255, "question_id": 53386121, "link": "https://stackoverflow.com/questions/53386121/stack-build-failed-due-to-undefined-symbols-for-architecture-x86-64-on-mac-o", "title": "`stack build` failed due to `Undefined symbols for architecture x86_64` on Mac OS X using nix", "body": "<p>First the error messages:</p>\n\n<pre><code>$ stack build\nLinking /Users/yuzhao/.stack/setup-exe-cache/x86_64-osx/tmp-Cabal-simple_mPHDZzAJ_2.2.0.1_ghc-8.4.4 ...\nclang-5.0: warning: argument unused during compilation: '-nopie' [-Wunused-command-line-argument]\nclang-5.0: warning: argument unused during compilation: '-nopie' [-Wunused-command-line-argument]\nUndefined symbols for architecture x86_64:\n  \"_iconv\", referenced from:\n      _hs_iconv in libHSbase-4.11.1.0.a(iconv.o)\n     (maybe you meant: _base_GHCziIOziEncodingziIconv_iconvEncoding13_info, _base_GHCziIOziEncodingziIconv_iconvEncoding1_info , _base_GHCziIOziEncodingziIconv_iconvEncoding3_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding4_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding7_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding4_info , _base_GHCziIOziEncodingziIconv_iconvEncoding7_info , _base_GHCziIOziEncodingziIconv_iconvEncoding6_info , _base_GHCziIOziEncodingziIconv_iconvEncoding5_closure , _hs_iconv_open , _base_GHCziIOziEncodingziIconv_iconvEncoding9_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding15_info , _base_GHCziIOziEncodingziIconv_iconvEncoding_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding14_bytes , _hs_iconv_close , _base_GHCziIOziEncodingziIconv_iconvEncoding12_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding12_info , _base_GHCziIOziEncodingziIconv_iconvEncoding2_info , _base_GHCziIOziEncodingziIconv_iconvEncoding11_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding2_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding6_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding9_info , _base_GHCziIOziEncodingziIconv_iconvEncoding15_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding_info , _base_GHCziIOziEncodingziIconv_iconvEncoding8_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding8_info , _base_GHCziIOziEncodingziIconv_iconvEncoding13_closure , _base_GHCziIOziEncodingziIconv_iconvEncoding10_bytes , _base_GHCziIOziEncodingziIconv_iconvEncoding1_closure , _hs_iconv , _base_GHCziIOziEncodingziIconv_iconvEncoding11_info )\n  \"_iconv_open\", referenced from:\n      _hs_iconv_open in libHSbase-4.11.1.0.a(iconv.o)\n     (maybe you meant: _hs_iconv_open)\n  \"_iconv_close\", referenced from:\n      _hs_iconv_close in libHSbase-4.11.1.0.a(iconv.o)\n     (maybe you meant: _hs_iconv_close)\n  \"_locale_charset\", referenced from:\n      _localeEncoding in libHSbase-4.11.1.0.a(PrelIOUtils.o)\nld: symbol(s) not found for architecture x86_64\nclang-5.0: error: linker command failed with exit code 1 (use -v to see invocation)\n`cc' failed in phase `Linker'. (Exit code: 1)\n\n--  While building simple Setup.hs using:\n      /Users/yuzhao/.nix-profile/bin/ghc -rtsopts -threaded -clear-package-db -global-package-db -hide-all-packages -package base -main-is StackSetupShim.mainOverride -package Cabal-2.2.0.1 /Users/yuzhao/.stack/setup-exe-src/setup-mPHDZzAJ.hs /Users/yuzhao/.stack/setup-exe-src/setup-shim-mPHDZzAJ.hs -o /Users/yuzhao/.stack/setup-exe-cache/x86_64-osx/tmp-Cabal-simple_mPHDZzAJ_2.2.0.1_ghc-8.4.4\n    Process exited with code: ExitFailure 1\n</code></pre>\n\n<p>I am using <code>nix</code> and I've found many other solutions to this error messages using <code>Homebrew</code>, not <code>nix</code>. </p>\n\n<p>Also, according to <a href=\"https://docs.haskellstack.org/en/stable/nix_integration/#use-stack-as-normal\" rel=\"nofollow noreferrer\">stack docs</a>, <code>stack setup</code> give me the same error messages.</p>\n\n<p>Any ideas how to fix this?</p>\n"}, {"tags": ["javascript", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 72053, "user_id": 2138752, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/j4UWy.jpg?s=128&g=1", "display_name": "Bhojendra Rauniyar", "link": "https://stackoverflow.com/users/2138752/bhojendra-rauniyar"}, "edited": false, "score": 0, "creation_date": 1542686097, "post_id": 53385968, "comment_id": 93647637, "body": "If you go to new teacher then don&#39;t remind of old teacher."}, {"owner": {"reputation": 1855, "user_id": 6587634, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209643793277415/picture?type=large", "display_name": "Wong Jia Hau", "link": "https://stackoverflow.com/users/6587634/wong-jia-hau"}, "reply_to_user": {"reputation": 72053, "user_id": 2138752, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/j4UWy.jpg?s=128&g=1", "display_name": "Bhojendra Rauniyar", "link": "https://stackoverflow.com/users/2138752/bhojendra-rauniyar"}, "edited": false, "score": 0, "creation_date": 1542686356, "post_id": 53385968, "comment_id": 93647710, "body": "@BhojendraRauniyar What is wrong with this question? Does it violates any StackOverflow question asking guideline?"}, {"owner": {"reputation": 72053, "user_id": 2138752, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/j4UWy.jpg?s=128&g=1", "display_name": "Bhojendra Rauniyar", "link": "https://stackoverflow.com/users/2138752/bhojendra-rauniyar"}, "edited": false, "score": 0, "creation_date": 1542686568, "post_id": 53385968, "comment_id": 93647759, "body": "I&#39;m not sure how this violates but pretty sure this doesn&#39;t fit for SO. But I was just  suggesting you that you should not compare one language with another. Otherwise, you&#39;ll get much difficult in your learning curve."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1542688893, "post_id": 53385968, "comment_id": 93648306, "body": "Yes, this is the case. Note that <code>.then</code> is overloaded, so it ends up playing the role of both <code>fmap</code> and <code>&gt;&gt;=</code> (promises form a monad - see <code>Async</code> for a Haskell analogue)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1542689267, "post_id": 53385968, "comment_id": 93648393, "body": "<a href=\"http://www.vex.net/~trebla/humour/tautologies.html\" rel=\"nofollow noreferrer\">Wise tautology #0</a>: &quot;X is like Y&quot; can always be argued to be true. Furthermore, when X\u2260Y, &quot;X is unlike Y&quot; can also be argued to be true."}, {"owner": {"reputation": 1855, "user_id": 6587634, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209643793277415/picture?type=large", "display_name": "Wong Jia Hau", "link": "https://stackoverflow.com/users/6587634/wong-jia-hau"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1542690082, "post_id": 53385968, "comment_id": 93648593, "body": "@DanielWagner So, should your wise tautology be applied to <a href=\"https://en.wikipedia.org/wiki/Curry%E2%80%93Howard_correspondence\" rel=\"nofollow noreferrer\">Curry-Howard correspondance</a> as well?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1542691168, "post_id": 53385968, "comment_id": 93648908, "body": "@WongJiaHau If you can define your use of &quot;equivalent&quot; as carefully as Curry and Howard defined their use of &quot;equivalent&quot; I&#39;ll be happy to take a stab at answering your question."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1542696233, "post_id": 53385968, "comment_id": 93650543, "body": "The Bluebird documentation touches on the subject: <a href=\"http://bluebirdjs.com/docs/coming-from-other-languages.html#haskell\" rel=\"nofollow noreferrer\">bluebirdjs.com/docs/coming-from-other-languages.html#haskell</a>"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1542699279, "post_id": 53385968, "comment_id": 93651808, "body": "Your Haskell code looks wrong - I&#39;m certain it should be <code>fetch &quot;google.com&quot; &gt;&gt;= putStrLn</code>"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1542699706, "post_id": 53385968, "comment_id": 93651985, "body": "possible duplicate of <a href=\"https://stackoverflow.com/q/45712106/1048572\">Why are Promises Monads?</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1542723985, "post_id": 53385968, "comment_id": 93665632, "body": "No, they are not equivalent in the Curry-Howard sense: in fact, neither of them appear to even be well-formed terms in either combinatory types nor intuitionistic implicational logic."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1542721007, "post_id": 53387715, "comment_id": 93663777, "body": "I&#39;m not familiar with JS <code>then</code>. Would it be fair to say that <code>then</code> performs <code>fmap</code>, and then performs <code>join</code> if the result is still a <code>Promise</code>? In such way, we can&#39;t really construct a value of type <code>Promise (Promise a)</code>, right? (Albeit I think we might obtain <code>Promise (Identity (Promise a))</code> to fool <code>then</code> into not <code>join</code>ing the two <code>Promise</code>s.)"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1542738156, "post_id": 53387715, "comment_id": 93673578, "body": "@chi Yes, that&#39;s how it works <a href=\"https://promisesaplus.com/#point-45\" rel=\"nofollow noreferrer\">promisesaplus.com/#point-45</a> There was some debate back in the day about how much to &quot;overload&quot; <code>then</code>: <a href=\"https://github.com/promises-aplus/promises-spec/issues/75#issuecomment-14057356\" rel=\"nofollow noreferrer\">github.com/promises-aplus/promises-spec/issues/&hellip;</a> <a href=\"https://github.com/promises-aplus/promises-spec/issues/94#issuecomment-16184572\" rel=\"nofollow noreferrer\">github.com/promises-aplus/promises-spec/issues/&hellip;</a>"}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 6, "last_activity_date": 1542738243, "last_edit_date": 1542738243, "creation_date": 1542696898, "answer_id": 53387715, "question_id": 53385968, "link": "https://stackoverflow.com/questions/53385968/is-the-javascript-then-the-same-as-haskell-fmap/53387715#53387715", "title": "Is the JavaScript `then` the same as Haskell `fmap`?", "body": "<p>They are related, yes. But <code>then</code> for <code>Promise</code>s does several different things that in Haskell would be separate functions, not all from the <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Functor.html#t:Functor\" rel=\"nofollow noreferrer\"><code>Functor</code></a> class (the one that provides <code>fmap</code>).</p>\n\n<p>In Haskell, <code>Promise</code> would be a type constructor parameterized by the type of what it eventually returns, like <code>Promise Int</code> or <code>Promise String</code>.</p>\n\n<p>We could make that type an instance of <code>Functor</code>, giving us <code>fmap :: (a -&gt; b) -&gt; Promise a -&gt; Promise b</code>. This would let us map a <em>pure</em> computation over the result eventually returned by the promise. But it wouldn't let us chain promises! If we try fmapping with a function that returns a promise, say of type <code>Int -&gt; Promise String</code>, we would end up with a <code>Promise</code> that returned another <code>Promise</code> at the end but did not execute it, which is not what we usually want.</p>\n\n<p>We could also make <code>Promise</code> an instance of <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Monad.html#t:Monad\" rel=\"nofollow noreferrer\"><code>Monad</code></a>. <code>Monad</code> is a subclass of <code>Functor</code>. All <code>Monad</code>s are <code>Functor</code>s, but not all <code>Functor</code>s are <code>Monad</code>s. <code>Monad</code> would give us the function <code>&gt;&gt;=</code> (usually called \"bind\") that would have type <code>(&gt;&gt;=) :: Promise a -&gt; (a -&gt; Promise b) -&gt; Promise b</code>. This would be analogous to a <code>then</code> in which the callback returns another <code>Promise</code> that is sequenced after the original one.</p>\n"}, {"tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": false, "score": 0, "last_activity_date": 1546449350, "last_edit_date": 1546449350, "creation_date": 1542708889, "answer_id": 53390728, "question_id": 53385968, "link": "https://stackoverflow.com/questions/53385968/is-the-javascript-then-the-same-as-haskell-fmap/53390728#53390728", "title": "Is the JavaScript `then` the same as Haskell `fmap`?", "body": "<p>Ignoring typeclasses, we have the following types in Haskell (we will say having the right Haskell typeclasses corresponds to having a suitable <code>.then</code> method in JavaScript):</p>\n\n<pre><code>fmap :: (a -&gt; b) -&gt; f a -&gt; f b\nbind :: (a -&gt; f b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>And in JavaScript we have (made up syntax):</p>\n\n<pre><code>.then :: (this :: f a) -&gt; (a -&gt; (b || f b)) -&gt; f b\n</code></pre>\n\n<p>So in one sense they are equivalent, but in another not. For example, suppose some kind of promise type called <code>P</code> in Haskell and we want to read a URL from a file and then give a promise of fetching that URL:</p>\n\n<pre><code>read :: String -&gt; P String\nfetch :: String -&gt; P String\nreadFetch :: String -&gt; P (P String)\nreadFetch file = fmap fetch (read file)\n</code></pre>\n\n<p>And then later you might <code>do</code>:</p>\n\n<pre><code>fetched &lt;- readFetch someFile\n...\nfoo &lt;- fetched\n</code></pre>\n\n<p>While in JavaScript if you did <code>read(file).then(fetch)</code> this would be equivalent to the following Haskell:</p>\n\n<pre><code>readFetch :: String -&gt; P String\nreadFetch file = bind fetch (read file)\n</code></pre>\n\n<p>So the first only becomes fulfilled once the file is read but the second once the fetch is complete (i.e. later).</p>\n\n<p>We conclude that <code>then</code> is similar but not exactly the same as <code>fmap</code>.</p>\n"}], "owner": {"reputation": 1855, "user_id": 6587634, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209643793277415/picture?type=large", "display_name": "Wong Jia Hau", "link": "https://stackoverflow.com/users/6587634/wong-jia-hau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 53387715, "answer_count": 2, "score": 0, "last_activity_date": 1546449350, "creation_date": 1542685931, "last_edit_date": 1546449129, "question_id": 53385968, "link": "https://stackoverflow.com/questions/53385968/is-the-javascript-then-the-same-as-haskell-fmap", "title": "Is the JavaScript `then` the same as Haskell `fmap`?", "body": "<p>In JavaScript, Promises have a method called <code>then</code>, which is used to unpack the result in case of success, for example,</p>\n\n<pre><code>fetch(\"google.com\").then(console.log)\n</code></pre>\n\n<p>From <a href=\"http://learnyouahaskell.com/functors-applicative-functors-and-monoids\" rel=\"nofollow noreferrer\">this Haskell's tutorial</a>, I also found a similar thing which is called <code>fmap</code>, for example,</p>\n\n<pre><code>fmap putStrLn (fetch \"google.com\")\n</code></pre>\n\n<p>They look pretty similar, but I am not sure if they are <strong>equivalent</strong>. That's why I wanted to ask if they are the same thing. </p>\n\n<p>PS: The term <strong>equivalent</strong> shall be that of the Curry-Howard Correspondence kind of equivalent.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 3190, "user_id": 303795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d4527273eaa0e045a245b71e0a004d?s=128&d=identicon&r=PG", "display_name": "Joe the Person", "link": "https://stackoverflow.com/users/303795/joe-the-person"}, "edited": false, "score": 1, "creation_date": 1588283735, "post_id": 53385739, "comment_id": 108847965, "body": "Looks like things have changed, this now goes in ~/.stack/config.yaml. You will also need to change <code>resolver</code> in your project&#39;s <code>stack.yaml</code> to be <code>resolver: ghc-8.8.2</code> or whatever matches <code>ghc --version</code>"}], "tags": [], "owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "is_accepted": false, "score": 1, "last_activity_date": 1542684076, "creation_date": 1542684076, "answer_id": 53385739, "question_id": 53385640, "link": "https://stackoverflow.com/questions/53385640/how-to-prevent-stack-from-downloading-ghc-for-every-new-project/53385739#53385739", "title": "How to prevent stack from downloading GHC for every new project?", "body": "<p>Just find <code>$HOME/.stack.yaml</code> and add:</p>\n\n<pre><code># Turn on system GHC\nsystem-ghc: true\n</code></pre>\n\n<p>and run the same command again.</p>\n"}, {"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1542686238, "post_id": 53385922, "comment_id": 93647670, "body": "It might be worth it mentioning the <code>--resolver</code> option explicitly,"}], "tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": true, "score": 10, "last_activity_date": 1542685598, "creation_date": 1542685598, "answer_id": 53385922, "question_id": 53385640, "link": "https://stackoverflow.com/questions/53385640/how-to-prevent-stack-from-downloading-ghc-for-every-new-project/53385922#53385922", "title": "How to prevent stack from downloading GHC for every new project?", "body": "<p>Stack only installs a new ghc if the stack.yaml you are using requires some ghc version that you do not yet have installed via stack. Once stack has installed ghc-8.4.4, for example, it will not reinstall this version of ghc.</p>\n\n<p>I would presume the solution, then, is to make sure you are using the same resolver for all of your projects, so that stack only installs the one ghc version.</p>\n"}], "owner": {"reputation": 1528, "user_id": 1516794, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/0aa31034e2c59f34d63141791746ec35?s=128&d=identicon&r=PG", "display_name": "cmal", "link": "https://stackoverflow.com/users/1516794/cmal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1125, "favorite_count": 0, "accepted_answer_id": 53385922, "answer_count": 2, "score": 8, "last_activity_date": 1542685598, "creation_date": 1542683245, "question_id": 53385640, "link": "https://stackoverflow.com/questions/53385640/how-to-prevent-stack-from-downloading-ghc-for-every-new-project", "title": "How to prevent stack from downloading GHC for every new project?", "body": "<p>How to prevent stack from downloading GHC for every new project?</p>\n\n<p>Every time I create a new project using stack and then build or exec the codes, stack will install a new GHC for me. This is not only boring for waiting such a long time for a huge image to be downloaded (behind the GFW, xKib/s), but also a space disaster for my pity 128G SSD Macbook Pro. How can I fix this?</p>\n\n<pre><code>$ stack exec blah\nPreparing to install GHC to an isolated location.\nThis will not interfere with any system-level installation.\nghc-8.4.4:   15.98 KiB / 220.05 MiB (  0.01%) downloaded...^C\n</code></pre>\n"}, {"tags": ["haskell", "typeclass", "parametric-polymorphism"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1542654092, "post_id": 53380845, "comment_id": 93637758, "body": "Many ways; pass it to a function that only works on <code>User</code>s, e.g., or pattern match on it. I think this will be much less of a problem in real-world usage than it is in toy examples like this one where the only consumer is also polymorphic."}, {"owner": {"reputation": 125, "user_id": 9854808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SOLEI.jpg?s=128&g=1", "display_name": "Thomas Mahler", "link": "https://stackoverflow.com/users/9854808/thomas-mahler"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1542661431, "post_id": 53380845, "comment_id": 93641078, "body": "Thanks Daniel for your quick response. I agree that there are many cases where the consumer may know about the actual data type. But I I want to be able to chain polymorphic actions. In this case the consumer also is polymorphic. Any ideas?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542662501, "post_id": 53380845, "comment_id": 93641545, "body": "@ThomasMahler Would you consider something like <code>retrieveEntity 1 &gt;&gt;= publishEntity @User</code> better (using the <code>TypeApplications</code> extension)? You cannot get around the fact that you need to specify the required type <i>somewhere</i>. In this example, the compiler can infer that <code>retrieveEntity</code> has to return <code>IO User</code> if the monomorphic function <code>publishEntity @User</code> is to receive an appropriate argument."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1542664735, "last_edit_date": 1542664735, "creation_date": 1542664430, "answer_id": 53383178, "question_id": 53380845, "link": "https://stackoverflow.com/questions/53380845/how-to-elegantly-avoid-ambiguous-type-variable-when-using-haskell-type-classes/53383178#53383178", "title": "How to elegantly avoid &quot;Ambiguous type variable&quot; when using Haskell type classes", "body": "<p>You can tie the types of <code>storeEntity</code> and <code>retrieveEntity</code> together by adding a type-level tag to your entity's identifier <code>Integer</code>. I think your API design also has a small infelicity that isn't critical, but I'll fix it along the way anyway. Namely: <code>User</code>s shouldn't store their identifier. Instead have a single top-level type wrapper for identified things. This lets you write code once and for all that munges identifiers -- e.g. a function that takes an entity that doesn't yet have an ID (how would you even represent this with your definition of <code>User</code>?) and allocates a fresh ID for it -- without going back and modifying your <code>Entity</code> class and all its implementations. Also storing first and last names separately is <a href=\"https://shinesolutions.com/2018/01/08/falsehoods-programmers-believe-about-names-with-examples/\" rel=\"nofollow noreferrer\">wrong</a>. So:</p>\n\n<pre><code>import Data.Tagged\n\ndata User = User\n    { name :: String\n    , email :: String\n    } deriving (Eq, Ord, Read, Show)\n\ntype Identifier a = Tagged a Integer\ndata Identified a = Identified\n    { ident :: Identifier a\n    , val :: a\n    } deriving (Eq, Ord, Read, Show)\n</code></pre>\n\n<p>Here my <code>Identified User</code> corresponds to your <code>User</code>, and my <code>User</code> doesn't have an analog in your version. The <code>Entity</code> class might look like this:</p>\n\n<pre><code>class Entity a where\n    store :: Identified a -&gt; IO ()\n    retrieve :: Identifier a -&gt; IO a\n    publish :: a -&gt; IO () -- or maybe Identified a -&gt; IO ()?\n\ninstance Entity User -- stub\n</code></pre>\n\n<p>As an example of the \"write it once and for all\" principle above, you may find it convenient for <code>retrieve</code> to actually associate the entity it returns with its identifier. This can be done uniformly for all entities now:</p>\n\n<pre><code>retrieveIDd :: Entity a =&gt; Identifier a -&gt; IO (Identified a)\nretrieveIDd id = Identified id &lt;$&gt; retrieve id\n</code></pre>\n\n<p>Now we can write an action that ties together the types of its store and retrieve actions:</p>\n\n<pre><code>storeRetrievePublish :: Entity a =&gt; Identified a -&gt; IO ()\nstoreRetrievePublish e = do\n    store e\n    e' &lt;- retrieve (ident e)\n    publish e'\n</code></pre>\n\n<p>Here <code>ident e</code> has rich enough type information that we know that <code>e'</code> must be an <code>a</code>, even though we don't have an explicit type signature for it. (The signature on <code>storeRetrievePublish</code> is also optional; the one given here is the one inferred by GHC.) Finishing touches:</p>\n\n<pre><code>main :: IO ()\nmain = storeRetrievePublish (Identified 1 (User \"Thomas Meier\" \"tm@meier.com\"))\n</code></pre>\n\n<p>If you don't want to define <code>storeRetrievePublish</code> explicitly, you can get away with this:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    let user = Identified 1 (User \"Thomas Meier\" \"tm@meier.com\")\n    store user\n    user' &lt;- retrieve (ident user)\n    publish user'\n</code></pre>\n\n<p>...but you can't unfold definitions much further: if you reduce <code>ident user</code> to just <code>1</code>, you will have lost the tie between the type tag on the identifier used for <code>store</code> and for <code>retrieve</code>, and be back to your ambiguous type situation.</p>\n"}], "owner": {"reputation": 125, "user_id": 9854808, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SOLEI.jpg?s=128&g=1", "display_name": "Thomas Mahler", "link": "https://stackoverflow.com/users/9854808/thomas-mahler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 53383178, "answer_count": 1, "score": 0, "last_activity_date": 1542664735, "creation_date": 1542653067, "last_edit_date": 1542661269, "question_id": 53380845, "link": "https://stackoverflow.com/questions/53380845/how-to-elegantly-avoid-ambiguous-type-variable-when-using-haskell-type-classes", "title": "How to elegantly avoid &quot;Ambiguous type variable&quot; when using Haskell type classes", "body": "<p>I want to write a simple framework that deals with persisting entities.\nThe idea is to have an Entity type class and to provide generic persistence operations like</p>\n\n<pre><code>storeEntity    :: (Entity a) =&gt; a -&gt; IO () \nretrieveEntity :: (Entity a) =&gt; Integer -&gt; IO a\npublishEntity  :: (Entity a) =&gt; a -&gt; IO () \n</code></pre>\n\n<p>Actual data types are instance of that Entity type class.</p>\n\n<p>Even though the persistence operations are generic and don't need any information about the concrete data types You have to provide a type annotation at the call site to make GHC happy, like in:</p>\n\n<pre><code>main = do\n    let user1 = User 1 \"Thomas\" \"Meier\" \"tm@meier.com\"\n    storeEntity user1\n    user2 &lt;- retrieveEntity 1 :: IO User -- how to avoid this type annotation?\n    publishEntity user2\n</code></pre>\n\n<p>Is there any way to avoid this kind of call site annotations?</p>\n\n<p>I know that I don't need these annotations if the compiler can deduce the actual type from the context of the usage. So for example the following code works fine:</p>\n\n<pre><code>main = do\n    let user1 = User 1 \"Thomas\" \"Meier\" \"tm@meier.com\"\n    storeEntity user1\n    user2 &lt;- retrieveEntity 1\n    if user1 == user2\n        then publishEntity user2\n        else fail \"retrieve of data failed\"\n</code></pre>\n\n<p>But I would like to be able to chain the polymorphic actions like so:</p>\n\n<pre><code>main = do\n    let user1 = User 1 \"Heinz\" \"Meier\" \"hm@meier.com\"\n    storeEntity user1\n    -- unfortunately the next line does not compile\n    retrieveEntity 1 &gt;&gt;= publishEntity\n\n    -- but with a type annotation it works:\n    (retrieveEntity 1 :: IO User) &gt;&gt;= publishEntity\n</code></pre>\n\n<p>But having a type annotation here breaks the elegance of the polymorphism...</p>\n\n<p>For completeness sake I've included the full source code:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric, DeriveAnyClass #-}\nmodule Example where\nimport GHC.Generics\nimport Data.Aeson\n\n-- | Entity type class\nclass (ToJSON e, FromJSON e, Eq e, Show e) =&gt; Entity e where \n    getId :: e -&gt; Integer\n\n-- | a user entity    \ndata User = User {\n      userId    :: Integer\n    , firstName :: String\n    , lastName  :: String\n    , email     :: String\n} deriving (Show, Eq, Generic, ToJSON, FromJSON)\n\ninstance Entity User where\n    getId = userId \n\n\n-- | load persistent entity of type a and identified by id\nretrieveEntity :: (Entity a) =&gt; Integer -&gt; IO a\nretrieveEntity id = do\n    -- compute file path based on id\n    let jsonFileName = getPath id\n    -- parse entity from JSON file\n    eitherEntity &lt;- eitherDecodeFileStrict jsonFileName\n    case eitherEntity of\n        Left msg -&gt; fail msg\n        Right e  -&gt; return e\n\n-- | store persistent entity of type a to a json file\nstoreEntity :: (Entity a) =&gt; a -&gt; IO ()\nstoreEntity entity = do\n    -- compute file path based on entity id\n    let jsonFileName = getPath (getId entity)\n    -- serialize entity as JSON and write to file\n    encodeFile jsonFileName entity\n\n-- | compute path of data file based on id\ngetPath :: Integer -&gt; String\ngetPath id = \".stack-work/\" ++ show id ++ \".json\"\n\npublishEntity :: (Entity a) =&gt; a -&gt; IO ()   \npublishEntity = print\n\nmain = do\n    let user1 = User 1 \"Thomas\" \"Meier\" \"tm@meier.com\"\n    storeEntity user1\n    user2 &lt;- retrieveEntity 1 :: IO User\n    print user2\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1542658490, "post_id": 53380083, "comment_id": 93639772, "body": "I searched 4 it and what i found i didn&#39;t understand so yeah"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1542662413, "post_id": 53380083, "comment_id": 93641511, "body": "You&#39;ll find in the book that you appear to have taken this example from, that this is pseudocode and not in the least valid Haskell."}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 0, "creation_date": 1542662938, "post_id": 53380083, "comment_id": 93641710, "body": "How do i make a function that is like (|+|) x y = (i don&#39;t know what to write in here, what do i put here?) which type is Novo -&gt; Novo -&gt; Novo"}, {"owner": {"reputation": 23007, "user_id": 7943564, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b6f0ad4cd865587a782bf697d3b18d18?s=128&d=identicon&r=PG&f=1", "display_name": "glennsl", "link": "https://stackoverflow.com/users/7943564/glennsl"}, "edited": false, "score": 4, "creation_date": 1542665922, "post_id": 53380083, "comment_id": 93642858, "body": "@RuiFernando SO isn&#39;t a mentoring service. Not that there&#39;s anything wrong with asking for mentoring or beginner&#39;s help, but it really doesn&#39;t fit well with the format of SO and if you read through <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and the rest of the <a href=\"https://stackoverflow.com/help\">help center</a> I think they explain pretty clearly why that&#39;s the case. Try <a href=\"https://www.haskell.org/community\" rel=\"nofollow noreferrer\">a forum or chat</a> instead perhaps."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 0, "creation_date": 1542650096, "post_id": 53380149, "comment_id": 93636002, "body": "I&#39;m not understanding can you explain better?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 1, "creation_date": 1542653814, "post_id": 53380149, "comment_id": 93637624, "body": "@RuiFernando Perhaps chepner&#39;s answer below is more detailed (please also read that). Is there any specific part of our answers where you need more explanation?"}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 0, "creation_date": 1542654891, "post_id": 53380149, "comment_id": 93638102, "body": "I&#39;m not really getting it at all so the how do u specify that <code>NovoMult</code> is my <code>|*|</code>? and how do i specify all the numbers like let&#39;s make it from 20 to 20?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 0, "creation_date": 1542655296, "post_id": 53380149, "comment_id": 93638280, "body": "@RuiFernando You can&#39;t use <code>|*|</code> as a name, you need to use something like <code>Mult</code> or some infix symbol starting with <code>:</code> like <code>:*:</code> (but only if you also have two arguments to such constructor). There is no way to specify &quot;a number from -20 to 20&quot; in types. You could add 41 constructors like <code>M20 | M19 | ... | Z | P1 | P2 | ... | P20</code> explicitly writing all of them (without the ellipsis), but that&#39;s inconvenient."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 0, "creation_date": 1542655434, "post_id": 53380149, "comment_id": 93638339, "body": "@RuiFernando The type that I defined above has all the values <code>Int</code> has (wrapped in the <code>PlainInt</code> constructor), plus two more values (named <code>Additional1</code>, <code>Additional2</code>). Isn&#39;t that what you wanted, except for the naming?"}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 0, "creation_date": 1542658087, "post_id": 53380149, "comment_id": 93639572, "body": "Yeah that&#39;s what i wanted but then how do i put that Additional1 corresponds to |+|?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 1, "creation_date": 1542661025, "post_id": 53380149, "comment_id": 93640895, "body": "@RuiFernando |+| is only a name, you can call it differently, but let it represent the same thing. You could use <code>data Novo = PlainInt Int | Plus | Times</code>, if you want better names."}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 0, "creation_date": 1542662614, "post_id": 53380149, "comment_id": 93641578, "body": "and now how do i make a function that is like  <code>(|+|)  x y = (i don&#39;t know what to write in here, what do i put here?)</code> which type is <code>Novo  -&gt; Novo -&gt; Novo</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1542663244, "post_id": 53380149, "comment_id": 93641826, "body": "If <code>|+|</code> is intended to be a data constructor, there&#39;s nothing more to do, just like <code>(:) x []</code> doesn&#39;t simplify to any other list (and <code>[x]</code> is just syntactic sugar, not a &quot;simpler&quot; value)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 3, "creation_date": 1542672858, "post_id": 53380149, "comment_id": 93644869, "body": "@RuiFernando I now have lost you. First you wanted some extra elements. Then you wanted to constrain integers. Now the extra elements are actually a function. This is very confusing. I can&#39;t understand what you want -- maybe you also don&#39;t understand what you really want. Anyway, I think I can&#39;t answer this question properly because it is too vague. :-/"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1542649876, "creation_date": 1542649876, "answer_id": 53380149, "question_id": 53380083, "link": "https://stackoverflow.com/questions/53380083/problem-creating-a-new-data-type-in-haskell/53380149#53380149", "title": "Problem creating a new data Type in Haskell", "body": "<p>Constructor names must start with a capital letter or <code>:</code>. Digits or other symbols are not allowed. Some numeric predefined types like <code>Int</code> behave \"as if\" they were defined as you show above, but that's pseudo-syntax, not actual valid Haskell.</p>\n\n<p>Try instead some variant of</p>\n\n<pre><code>data Novo = PlainInt Int | Additional1 | Additional2 deriving Show\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 4, "last_activity_date": 1542652305, "creation_date": 1542652305, "answer_id": 53380677, "question_id": 53380083, "link": "https://stackoverflow.com/questions/53380083/problem-creating-a-new-data-type-in-haskell/53380677#53380677", "title": "Problem creating a new data Type in Haskell", "body": "<p>A data constructor must be either a valid identifier starting with a capital letter, or a sequence of symbols starting with a <code>:</code> .</p>\n\n<p>Your attempt has the following problems:</p>\n\n<ol>\n<li>Numeric literals like <code>-2147483648</code> are not valid constructors.</li>\n<li><p>You cannot specify a range of constructors with <code>...</code>. An example like <code>data Fourbit = -16 | ... | -1 | 0 | 1 | ... 15</code>, is  pseudocode for an explicit listing of every intended literal:</p>\n\n<pre><code>data Fourbit = -16 | -15 | -14 | -13 | -12 | -11 | -10 | -9 |\n                -8 | -7 | -6 | -5 | -4 | -3 | -2 | -1 |\n                 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 |\n                 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15\n</code></pre>\n\n<p>which is <em>also</em> pseudocode, because the literals are not valid data constructors.</p></li>\n<li>Your strings <code>(|+|)</code> and <code>(|*|)</code> are <em>also</em> invalid names for data constructors. They don't begin with a <code>:</code>, and they contain parentheses.</li>\n</ol>\n\n<p>If you <em>really</em> wanted to pursue this route, you need to be prepared to list ~4 billion constructors, using names like <code>NovoNeg2147483648</code>, <code>Novo2147483648</code>, <code>NovoPlus</code>, and <code>NovoMult</code>, for example.</p>\n"}], "owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "closed_date": 1542820131, "answer_count": 2, "score": -12, "last_activity_date": 1542662967, "creation_date": 1542649626, "last_edit_date": 1542662967, "question_id": 53380083, "link": "https://stackoverflow.com/questions/53380083/problem-creating-a-new-data-type-in-haskell", "closed_reason": "Needs details or clarity", "title": "Problem creating a new data Type in Haskell", "body": "<p>I'm trying to create a new data type in Haskell that has basically the same elements has the Int type with some more. I made it like this:</p>\n\n<pre><code>data Novo = -2147483648|-2147483647|...|-1|0|1|2|...|2147483647|(|+|)|(|*|) deriving (Show) \n</code></pre>\n\n<p>I know this is pseudocode but how do i write it then?</p>\n\n<p>And when I try to compilate this the gchi gives me this error:</p>\n\n<pre><code>parse error on input \u2018-\u2019\n</code></pre>\n\n<p>refering to the 13 character in this line which is the first <code>-</code> can you help me here? Why is it giving me this error? How do i solve this?</p>\n"}, {"tags": ["haskell", "dsl", "free-monad"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1542657258, "post_id": 53378681, "comment_id": 93639169, "body": "What do you mean by <i>&quot;not twice as I&#39;m doing now?&quot;</i> Where are you using <code>UpdateSnapshot</code>?"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1542659196, "post_id": 53378681, "comment_id": 93640112, "body": "I put en example of dsl to show what I meant by using twice UpdateSnapshot"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1542659598, "post_id": 53378681, "comment_id": 93640310, "body": "How about taking <code>UpdateSnapshot</code> out of <code>Action</code> and make it a <code>FreeT</code> that you can use to contain the (amputated) <code>CommandTransaction</code>? Most of the functions (<code>persistEvent</code>, <code>getNewEventID</code>, etc.) would return <code>UpdateSnapshotT CommandTransaction a</code>, but <code>updateSnapshot</code> would only return <code>CommandTransaction</code>. I haven&#39;t tried, so it may be a stupid idea..."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1542662969, "post_id": 53378681, "comment_id": 93641718, "body": "It&#39;s a stupid idea."}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1542882322, "post_id": 53378681, "comment_id": 93731644, "body": "Don&#39;t be to hard on yourself :-)"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1542707273, "creation_date": 1542644016, "last_edit_date": 1542707273, "question_id": 53378681, "link": "https://stackoverflow.com/questions/53378681/edsl-implement-an-action-that-could-be-used-only-once-in-the-sequence", "title": "eDSL - implement an action that could be used only once in the sequence", "body": "<p>I'm developing the following eDSL : </p>\n\n<pre><code>import Control.Monad.Free\n\ntype CommandHandler\n      = PersistedCommand -&gt; Maybe AggregateSnapshot -&gt; CommandDirective\n\ndata CommandDirective = Reject RejectionReason\n                      | SkipBecauseAlreadyProcessed\n                      | Transact (CommandTransaction ())\n\ntype RejectionReason = String\n\ndata Action a = PersistEvent Event a\n              | UpdateSnapshot AggregateSnapshot a\n              | GetCurrentTime (UTCTime -&gt; a )\n              | GetNewEventId (EventId -&gt; a) deriving (Functor)\n\ntype CommandTransaction a = Free Action a\n\npersistEvent :: Event -&gt; CommandTransaction ()\npersistEvent event = Free . PersistEvent event $ Pure ()\n\nupdateSnapshot :: AggregateSnapshot -&gt; CommandTransaction ()\nupdateSnapshot aggregateSnapshot\n        = Free . UpdateSnapshot aggregateSnapshot $ Pure ()\n\ngetNewEventID :: CommandTransaction EventId\ngetNewEventID = Free $ GetNewEventId Pure\n\ngetCurrentTime :: CommandTransaction UTCTime\ngetCurrentTime = Free $ GetCurrentTime Pure\n</code></pre>\n\n<p>I would like UpdateSnapshot to be used only once in a sequence not twice as I'm doing now. I could do it with phantom types and then UpdateSnapshot will be the last element of the action chain. But It's kind of semantically wrong and it does not work for 2 actions with the same nature then....</p>\n\n<p>e.g : 2 last updateSnapshot should not be valid :</p>\n\n<pre><code>do\n now &lt;- getCurrentTime\n eventId &lt;- getNewEventID\n persistEvent $ WorkspaceCreated\n                 { eventId = eventId\n                 , createdOn = now\n                 , workspaceId = workspaceId }\n updateSnapshot $ AggregateSnapshot\n          { lastOffsetConsumed = 0\n          , commandsProcessed = Set.fromList [commandId]\n          , state = AggregateState { aggregateId = workspaceId } }\n updateSnapshot $ AggregateSnapshot\n          { lastOffsetConsumed = 0\n          , commandsProcessed = Set.fromList [commandId]\n          , state = AggregateState { aggregateId = workspaceId } }\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1542644489, "post_id": 53378431, "comment_id": 93633168, "body": "Is <code>fromException :: SomeException -&gt; Maybe e</code> enough for your purposes?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 2, "creation_date": 1542654524, "post_id": 53378431, "comment_id": 93637955, "body": "A good portion (but not all) of exceptions that one might encounter and might want to catch are <code>IOException</code>s. It is good to remember that there are <code>IOException</code>-specific fucntions in <code>System.IO.Error</code> that can be used to further classify those exceptions <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/System-IO-Error.html#g:2\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/&hellip;</a> and extract information from them <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/System-IO-Error.html#g:3\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "edited": false, "score": 0, "creation_date": 1542659953, "post_id": 53379346, "comment_id": 93640451, "body": "Thanks for the answer. This solves my problem. Just to check is it possible that an exception is not a <code>SomeExcpetion</code>, which will cause the pattern matching fail?"}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "edited": false, "score": 0, "creation_date": 1542660448, "post_id": 53379346, "comment_id": 93640658, "body": "I had to look it up.  <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Exception.html#g:3\" rel=\"nofollow noreferrer\">The docs</a> say &quot;It is possible to catch all exceptions, by using the type SomeException&quot;.  The next section, on when &amp; when not to do this, is also good."}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": false, "score": 2, "last_activity_date": 1542646573, "creation_date": 1542646573, "answer_id": 53379346, "question_id": 53378431, "link": "https://stackoverflow.com/questions/53378431/how-to-catch-exception-from-io-and-print-its-error/53379346#53379346", "title": "How to catch Exception from IO and print its error.", "body": "<p>Yes, you can inspect the type of the exception:</p>\n\n<pre><code>logSomeException :: SomeException -&gt; IO ()\nlogSomeException (SomeException e) = print (typeOf e)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "edited": false, "score": 0, "creation_date": 1542659613, "post_id": 53381100, "comment_id": 93640318, "body": "Thanks Daniel. However, the problem was not how to handle IOException, but how to know what was the exception. If i know the exception that getEnv would throw is IOException, then i would also know how to handle it. IO can throw different kind of exceptions, the document of getEnv isn&#39;t clear what kind would throw, so I need a way to be able to inspect."}, {"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "edited": false, "score": 0, "creation_date": 1542659657, "post_id": 53381100, "comment_id": 93640341, "body": "Another question: since both getEnv and readFile throws IOException, how to distinguish them?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "edited": false, "score": 1, "creation_date": 1542662527, "post_id": 53381100, "comment_id": 93641552, "body": "@LeoZhang Really? <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/System-Environment.html#v:getEnv\" rel=\"nofollow noreferrer\">My copy of the documentation</a> is very clear about which exception it can throw (and is what I used to write my example code above). To distinguish exceptions from different actions, just make the scope of your handler smaller; compare <code>handle f (getEnv &quot;foo&quot; &gt;&gt; readFile &quot;foo&quot;)</code> with <code>handle f (getEnv &quot;foo&quot;) &gt;&gt; handle g (readFile &quot;foo&quot;)</code> -- in the former <code>f</code> doesn&#39;t know whether its exception came from <code>getEnv</code> or <code>readFile</code>, but in the latter it does."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1542654434, "creation_date": 1542654434, "answer_id": 53381100, "question_id": 53378431, "link": "https://stackoverflow.com/questions/53378431/how-to-catch-exception-from-io-and-print-its-error/53381100#53381100", "title": "How to catch Exception from IO and print its error.", "body": "<p>You've subverted the entire exception-type-matching mechanism by using <code>SomeException</code>. If you want to handle a specific kind of exception, just do that, don't convert into and out of <code>SomeException</code> along the way. For example:</p>\n\n<pre><code>import Control.Exception (IOException, handle, throwIO)\nimport System.Environment (getEnv)\nimport System.IO.Error (isDoesNotExistError)\n\nmain :: IO ()\nmain = handle missingEnv exe\n  where\n    exe = do\n      env &lt;- getEnv \"MISSING_ENV\"\n      print env\n      file &lt;- readFile \"/file-does-not-exist\"\n      print file\n\nmissingEnv :: IOException -&gt; IO ()\nmissingEnv e | isDoesNotExistError = print e\n             | otherwise = throwIO e\n</code></pre>\n"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1542654434, "creation_date": 1542643217, "question_id": 53378431, "link": "https://stackoverflow.com/questions/53378431/how-to-catch-exception-from-io-and-print-its-error", "title": "How to catch Exception from IO and print its error.", "body": "<p>I'd like to catch exceptions from the IO and inspect what kind of exception was raised with <code>typeOf</code> and then use the specific exception to pattern match in order to handle the exception specifically. But the following code doesn't work as I expected.</p>\n\n<pre><code>import Control.Exception (SomeException, handle)\nimport Data.Typeable (typeOf)\nimport System.Environment (getEnv)\n\nmain :: IO ()\nmain = handle missingEnv exe\n  where\n    exe = do\n      env &lt;- getEnv \"MISSING_ENV\"\n      print env\n      file &lt;- readFile \"/file-does-not-exist\"\n      print file\n\nmissingEnv :: SomeException -&gt; IO ()\nmissingEnv e = do\n  print e\n  print $ typeOf e\n  return ()\n</code></pre>\n\n<p>The above code will print the following error, but it only shows \"SomeException\", which doesn't have the specific name for the type of the Exception. </p>\n\n<pre><code>MISSING_ENV: getEnv: does not exist (no environment variable)\nSomeException\n</code></pre>\n\n<p>You might suggest me to use <code>lookupEnv</code>, but that's not my point, because I'd like to learn how to catch an exception, rather than how to avoid an exception.</p>\n\n<p>Is it possible to inspect the specific \"type\" of a raised exception from <code>IO</code>?</p>\n\n<p>Also is it possible to inspect the specific \"type\" of a raised exception from <code>MonadError</code>?</p>\n"}, {"tags": ["haskell", "ghc"], "owner": {"reputation": 1354, "user_id": 589192, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8f99f185a95f016a4a8ac4eaa708167?s=128&d=identicon&r=PG", "display_name": "Guillaume Ch&#233;rel", "link": "https://stackoverflow.com/users/589192/guillaume-ch%c3%a9rel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 1, "answer_count": 0, "score": 6, "last_activity_date": 1542809462, "creation_date": 1542641445, "last_edit_date": 1542809462, "question_id": 53377872, "link": "https://stackoverflow.com/questions/53377872/what-do-ghcs-garbage-collector-options-a-and-h-mean", "title": "What do GHC&#39;s garbage collector options -A and -H mean?", "body": "<p>I've read on the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/runtime_control.html#rts-options-to-control-the-garbage-collector\" rel=\"nofollow noreferrer\">GHC's documentation</a> and in <a href=\"https://stackoverflow.com/questions/3171922/ghcs-rts-options-for-garbage-collection\">this answer</a> about the <code>-A</code>\nand <code>-H</code> options. The first one sets a fixed size for the \"allocation area\" (or the generation 0 of the garbage collector). The second sets a lower bound on the heap size. If I understand well how generational garbage collection works, objects are allocated on generation 0, and when this one is full, those that are still needed are copied to generation 1 and the others are deallocated. My question is how are \"allocation area\", generation 0, generation 1, and heap size related? Is it like this: </p>\n\n<ul>\n<li>allocation area = generation 0,</li>\n<li>generation 0\u00a0+ generation 1 (+ eventually more generations) = heap size?</li>\n</ul>\n\n<p>Then, does -A controls the size of the first one whereas -H sets a lower bound on the size of the whole?</p>\n"}, {"tags": ["haskell", "grouping"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542641265, "post_id": 53377577, "comment_id": 93631176, "body": "I would move the sorting into <code>toListOfMonomials</code> itself. An addition function that can combine like terms immediately might be preferable to a separate <code>:+:</code> constructor."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542641495, "post_id": 53377577, "comment_id": 93631313, "body": "@chepner I agree. Good point. Thanks!"}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 1, "creation_date": 1542642131, "post_id": 53377577, "comment_id": 93631746, "body": "I generally do this sort of thing by going through Data.Map.  It&#39;s about equally verbose, but sometimes it&#39;s useful that <code>(cantorPairing&#39; . getPowers)</code> get called n times instead of O(n log n) times."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 2, "creation_date": 1542656843, "post_id": 53377577, "comment_id": 93638947, "body": "This type of question seems to come up regularly. Like @bergey I usually use <code>Data.Map</code> for the grouping step. Here&#39;s an example: <a href=\"https://stackoverflow.com/a/52535999/126014\">stackoverflow.com/a/52535999/126014</a>"}], "answers": [{"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1542802592, "post_id": 53403093, "comment_id": 93698395, "body": "Thanks. I have generalized <a href=\"https://github.com/stla/multipol\" rel=\"nofollow noreferrer\">my code</a> to deal with polynomials having an arbitrary number of variables, and now the powers are lists, not triplets. But lists with the same length also have an Ord instance (I didn&#39;t know), therefore there&#39;s no need of using a Cantor pairing. Haskell is very fun to program such things."}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1542828702, "post_id": 53403093, "comment_id": 93712783, "body": "Lists&#39; Ord instance does not care about length. If elements match, the longer is greater."}], "tags": [], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "is_accepted": true, "score": 1, "last_activity_date": 1542756487, "last_edit_date": 1542756487, "creation_date": 1542756030, "answer_id": 53403093, "question_id": 53377577, "link": "https://stackoverflow.com/questions/53377577/groupby-function-which-groups-non-adjacent-elements/53403093#53403093", "title": "groupBy function which groups non-adjacent elements", "body": "<p>For now I cannot imagine general <code>groupBy</code> function that would work faster than O(n^2) time, but you may use something like this</p>\n\n<pre><code>groupBy2 :: (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]\ngroupBy2 = go [] where\n  go acc comp [] = acc\n  go acc comp (h:t) =\n    let (hs, nohs) = partition (comp h) t\n    in go ((h:hs):acc) comp nohs\n</code></pre>\n\n<p>It works exactly like regular <code>groupBy</code>, but it joins non-adjacent element classes.</p>\n\n<p>However, if you are going to use <code>on</code> function the problem becomes a bit simplier, as we may use it's result as key for a map:</p>\n\n<pre><code>import qualified Data.Map as M\n\ngroupOn :: (Ord b) =&gt; (a -&gt; b) -&gt; [a] -&gt; [[a]]\ngroupOn f =\n  let unpack = fmap snd . M.toList\n      fld m a = case M.lookup (f a) m of\n        Nothing -&gt; M.insert (f a) [a] m\n        Just as -&gt; M.insert (f a) (a:as) m\n  in unpack . foldl fld M.empty\n</code></pre>\n\n<p>This is more efficient equivalent of</p>\n\n<pre><code>groupOn' f = groupBy2 ((==) `on` f)\n</code></pre>\n\n<p>(modulo ordering)</p>\n\n<p>And btw \u2013 triplets and pairs already have defined Ord instance, you may compare them just like <code>Int</code>s</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 53403093, "answer_count": 1, "score": 3, "last_activity_date": 1542756487, "creation_date": 1542640438, "question_id": 53377577, "link": "https://stackoverflow.com/questions/53377577/groupby-function-which-groups-non-adjacent-elements", "title": "groupBy function which groups non-adjacent elements", "body": "<p>The <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:groupBy\" rel=\"nofollow noreferrer\">groupBy</a> function groups the elements of a list when they are equal according to a user-defined predicate and when they are adjacent in the list. Is there a function for grouping elements without taking care of the adjacency?</p>\n\n<p>I deal with polynomials of three variables. Here is an example of such a polynomial written as a sum of monomials:</p>\n\n<pre><code>p = (M (Monomial {coefficient = 1.0, powers = (1,0,0)}) :+: M (Monomial {coefficient = 1.0, powers = (0,1,0)})) :+: M (Monomial {coefficient = 1.0, powers = (1,0,0)})\n</code></pre>\n\n<p>That means that <code>p = 1.0 * x^1y^0z^0 + 1.0 * x^0y^1z^0 + 1.0 * x^1y^0z^0</code>. The first term and the third term are summable: they have the same <code>powers</code> and then we can add them and get <code>2.0 * x^1y^0z^0</code>. My goal is to do this addition, in order to simplify <code>p</code>.</p>\n\n<p>I have a function which converts such a <code>p</code> to the list of the summed monomials:</p>\n\n<pre><code>&gt;&gt; toListOfMonomials p\n[M (Monomial {coefficient = 1.0, powers = (1,0,0)}),M (Monomial {coefficient = 1.0, powers = (0,1,0)}),M (Monomial {coefficient = 1.0, powers = (1,0,0)})]\n</code></pre>\n\n<p>I want to group the monomials which have the same <code>powers</code>. If I do </p>\n\n<pre><code>groupBy ((==) `on` getPowers)\n        (toListOfMonomials p)\n</code></pre>\n\n<p>then the two <code>M (Monomial {coefficient = 1.0, powers = (1,0,0)})</code> are not grouped because they are not adjacent.</p>\n\n<p>A solution consists in sorting the list according to the powers before using <code>groupBy</code>. In this way, two (or more) monomials having the same <code>powers</code> are adjacent in the sorted list. To define an order on the powers (<code>powers</code> is a triplet of integers), I firstly define a Cantor pairing function:</p>\n\n<pre><code>cantorPairing :: (Int, Int) -&gt; Int\ncantorPairing (k1,k2) = (k1+k2)*(k1+k2+1) + 2*k2\n\ncantorPairing' :: (Int, Int, Int) -&gt; Int\ncantorPairing' (k1,k2,k3) = cantorPairing(cantorPairing(k1,k2),k3)\n</code></pre>\n\n<p>then I can compare two <code>powers</code> by comparing their values under the Cantor pairing function:</p>\n\n<pre><code>groupBy ((==) `on` getPowers)\n        (sortBy (compare `on` (cantorPairing' . getPowers)) (toListOfMonomials p))\n</code></pre>\n\n<p>This gives the desired result: with this result I can easily sum the two monomials having the same <code>powers</code>.</p>\n\n<p>But that looks heavy, doesn't it? Isn't there a <code>groupBy</code> function which groups also non-adjacent elements? Otherwise, is there a more rapid way to achieve the desired result? </p>\n"}, {"tags": ["haskell", "dynamic", "custom-data-type"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1542640372, "post_id": 53377182, "comment_id": 93630622, "body": "Why would you want such a record? How would you use it?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 8, "creation_date": 1542640388, "post_id": 53377182, "comment_id": 93630630, "body": "Types don&#39;t <i>exist</i> at runtime."}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 4, "creation_date": 1542640652, "post_id": 53377182, "comment_id": 93630805, "body": "This is not possible, because types definitions are used at compile time, and removed as part of compilation.  There is probably a way to approach your actual problem, but it&#39;s not clear from your question what that problem is."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 7, "creation_date": 1542643390, "post_id": 53377182, "comment_id": 93632502, "body": "This looks like an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1542643695, "post_id": 53377182, "comment_id": 93632699, "body": "Even if you could create a type at runtime, you couldn&#39;t write a function that uses that type. It looks more like you want a sum type <code>T</code>  and <code>Record [T]</code>."}, {"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1542649239, "post_id": 53377182, "comment_id": 93635562, "body": "There are several projects for creating dynamic projections. You will need to be creative in your searches though, since Youtube searches are really, really, really bad. The one video I saw on Youtube was attempting to address the types of projections you get from SQL queries."}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1542720174, "post_id": 53377182, "comment_id": 93663205, "body": "There are some ways something which may match your description. It would however be much more clear it you outline how are you gong to utilize such unknown at compilation type."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1542725314, "post_id": 53377182, "comment_id": 93666469, "body": "<i>However, I want more control over data type, such as a day as a Day type, and id number as a Int type.</i> - That requires a heterogenous list, or a simulation of thereof. An alternate solution is to make specific Field constructors that hold specific typed values."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1542725516, "post_id": 53377182, "comment_id": 93666592, "body": "Can you come up with a much smaller version of your problem (fewer types) that you can explain in much more detail? The sample text file you&#39;ve presented looks like gibberish to me; it&#39;s not at all clear how it corresponds to the problem description. Please also explain in some detail a few of the operations you wish to support."}, {"owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "edited": false, "score": 0, "creation_date": 1542893891, "post_id": 53377182, "comment_id": 93738112, "body": "Thanks for all the helps! Using different fields to construct a <code>sum type</code> just solves my problem."}], "answers": [{"tags": [], "owner": {"reputation": 224, "user_id": 10668680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c4996037684a7b9e963c7c3d19c260?s=128&d=identicon&r=PG&f=1", "display_name": "Erick Gonzalez", "link": "https://stackoverflow.com/users/10668680/erick-gonzalez"}, "is_accepted": true, "score": 1, "last_activity_date": 1542805211, "creation_date": 1542805211, "answer_id": 53412603, "question_id": 53377182, "link": "https://stackoverflow.com/questions/53377182/how-to-create-data-types-dynamically-depending-on-the-input/53412603#53412603", "title": "How to create data types dynamically depending on the input", "body": "<p>Well, if I got your question right, no you can't write a single function which returns different data types depending on the input. However what you <em>can</em> do is write a function that returns a single data type that can be constructed in different ways depending on input.. i.e. like:</p>\n\n<pre><code>data PatentRecord = PN String Day String\n                  | AN String\n                  | PD day\n</code></pre>\n\n<p>so now you can write a function <code>parseRecord :: String -&gt; Maybe PatentRecord</code> for example which parses your input and depending on what it matches returns a <code>PatentRecord</code> built using the <code>PN</code> constructor, or the <code>AN</code> constructor, etc... </p>\n\n<p>PS: Implementation Tip: use rather an <code>Either SomeErrorType</code> instead of <code>Maybe</code> to provide richer information upon parsing errors ;-)</p>\n"}], "owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 1, "accepted_answer_id": 53412603, "answer_count": 1, "score": 0, "last_activity_date": 1542805211, "creation_date": 1542639206, "last_edit_date": 1542724706, "question_id": 53377182, "link": "https://stackoverflow.com/questions/53377182/how-to-create-data-types-dynamically-depending-on-the-input", "title": "How to create data types dynamically depending on the input", "body": "<hr>\n\n<h2>Update for my original problems</h2>\n\n<p>Well, maybe I didn't describe my problem completely before. Sorry for all! The following is the real problem:</p>\n\n<p>I have a txt file containing patent data, such as:</p>\n\n<blockquote>\n  <p>1/1523    DWPI </p>\n  \n  <p>AP      - JP29446999A 19991015 </p>\n  \n  <p>PN      - JP2000188399  A       20000704    DW200044\n            JP4568930B2   B2      20101027    DW201071 </p>\n  \n  <p>AN      - 2000495116 </p>\n  \n  <p>PA      - (NPDE  ) DENSO CORP </p>\n  \n  <p>PR      - JP1998000295406   19981016 </p>\n  \n  <p>MC      - U11-C18A3,U12-D02A </p>\n  \n  <p>OPD     - 1998.10.16 </p>\n  \n  <p>ICAI    - H01L29/12,H01L29/78,H01L21/265,H01L21/336 </p>\n  \n  <p>TI      - Planar type metal oxide semiconductor field effect transistor  </p>\n  \n  <p>AB      - &lt;-contents eliminated for simplicity-> </p>\n  \n  <p>CPY     - NPDE </p>\n  \n  <p>FN      - JP2000188399</p>\n</blockquote>\n\n<p>There are 1523 items with the similar format. I want to analyze the patent data, so I have to parse the data. I have defined the data type for every field, such as:</p>\n\n<p>data AP = AP String Day String</p>\n\n<pre><code>data PN = PN String Day String\n\ndata AN = AN String\n\ndata PD = PD day\n\n....  -- many other data types are not shown just for simplicity.\n</code></pre>\n\n<p>Now I have written the parser for every field with <code>megaparsec</code>, such as <code>apField</code>, <code>pnField</code>, <code>anField</code>, etc. </p>\n\n<p>However, not every record has the same field, for example, the 2nd item may only contain fields of AP, PN, PA, PR, OPD, TI, AB, CPY and FN, with AN, MC, and ICAI missing. Besides, someone may be interested in different fields, and \nhe just exports the txt file containing records only with fields of AP, PN, PA, OPD and CPY. </p>\n\n<p>Now I want to write a generic code, which can parse the records with fields people are interested in, and write the parsing result into a <code>SQLite</code> database. </p>\n\n<p>For example, if I want to parse records with fields of AP, PN, PA, OPD and CPY, I can construct a record parser according to the input, such as <code>toParser \"ap,pn,pa,opd,cpy\"</code>, or <code>toParser \"ap,pa,cpy\"</code>, which I have figured out. The parsed result should be <code>Record AP PN PA OPD CPY</code> or <code>Record AP PA CPY</code> respectively. Then I'd like to write the parsed results into a database. Since every record in the data corresponds to a <code>Record</code> data type, and the record to be parsed may be different, <strong>I have to construct a <code>Record</code> data type with different fields depending on the user's input</strong>. This is the problem that I have met.</p>\n\n<p>I can work around it by defining all the field data types as <code>data Field = Field [String]</code> and the record as <code>data Record = Record [Field]</code>. However, I want more control over data type, such as a day as a <code>Day</code> type, and id number as a <code>Int</code> type.</p>\n\n<p>If constructing <code>Record</code> data type with different fields depending on the input is impossible, maybe there are other ways to solve my problem. I appreciate any advices! And sorry for the long description of my problem and my ambiguous descriptions for my problem before!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 2, "creation_date": 1542636106, "post_id": 53376111, "comment_id": 93628120, "body": "Your function takes a single argument (a function <code>Either a b -&gt; c</code>) and needs to return a pair of functions so it need to look like <code>f5 f = (\\a -&gt; ..., \\b -&gt; ...)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": true, "score": 7, "last_activity_date": 1542636613, "last_edit_date": 1542636613, "creation_date": 1542636271, "answer_id": 53376347, "question_id": 53376111, "link": "https://stackoverflow.com/questions/53376111/how-to-implement-this-haskell-function/53376347#53376347", "title": "How to Implement this Haskell Function?", "body": "<p>You implemented</p>\n\n<pre><code>f5 :: (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c\n</code></pre>\n\n<p>You need to do the opposite operation.</p>\n\n<pre><code>f5 :: (Either a b -&gt; c) -&gt; (a -&gt; c, b -&gt; c)\nf5 f = (f . Left, f . Right)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 3, "last_activity_date": 1542645712, "creation_date": 1542645712, "answer_id": 53379128, "question_id": 53376111, "link": "https://stackoverflow.com/questions/53376111/how-to-implement-this-haskell-function/53379128#53379128", "title": "How to Implement this Haskell Function?", "body": "<p>Let the types be your guide.</p>\n\n<p>Your function should take one argument, a function of type <code>Either a b -&gt; c</code>, and produce a pair of functions, <code>(a -&gt; c, b -&gt; c)</code>.</p>\n\n<p>(The function you wrote takes three arguments and doesn't produce a pair.)</p>\n\n<p>That is, you want</p>\n\n<pre><code>f5 f = (a_to_c, b_to_c)\n</code></pre>\n\n<p>where <code>f :: Either a b -&gt; c</code>, <code>a_to_c :: a -&gt; c</code> and <code>b_to_c :: b -&gt; c</code>.</p>\n\n<p>In order to create <code>a_to_c</code>, assume that you have an <code>a</code> and a function <code>Either a b -&gt; c</code>.<br>\nNow, there's (only) one way you can make a function of type <code>a -&gt; c</code> from those two things \u2013 create an <code>Either</code> from the <code>a</code> with <code>Left</code>, and then pass it to the \"<code>Either</code> function\".  </p>\n\n<p>Informally,</p>\n\n<pre><code>a_to_c x = f (Left x)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>a_to_c = f . Left\n</code></pre>\n\n<p>The same reasoning for <code>b</code> leads to a similar situation with <code>b</code>.</p>\n\n<pre><code>b_to_c x = f (Right x)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>b_to_c = f . Right\n</code></pre>\n\n<p>Putting them together</p>\n\n<pre><code>f5 f = (f . Left, f . Right)\n</code></pre>\n\n<p>or, more verbosely</p>\n\n<pre><code>f5 f = (\\x -&gt; f (Left x), \\x -&gt; f (Right x))\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 8851389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9480107dd96a80ed52f47eddfe8d77a?s=128&d=identicon&r=PG&f=1", "display_name": "DanyJ", "link": "https://stackoverflow.com/users/8851389/danyj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 53376347, "answer_count": 2, "score": 1, "last_activity_date": 1542645712, "creation_date": 1542635553, "last_edit_date": 1542635769, "question_id": 53376111, "link": "https://stackoverflow.com/questions/53376111/how-to-implement-this-haskell-function", "title": "How to Implement this Haskell Function?", "body": "<p>Unfortunately I am unable to implement this function I have tried a lot.</p>\n\n<blockquote>\n  <p>f5 :: (Either a b -> c) -> (a -> c, b -> c)</p>\n</blockquote>\n\n<p>I tried this </p>\n\n<pre><code>f5 k _ (Left x)     =  k x\nf5 _ u (Right y)    =  u y\n</code></pre>\n\n<p>Thanks the help in advance .</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 4, "creation_date": 1542634333, "post_id": 53375057, "comment_id": 93627054, "body": "Ctx need parameter like: data Ctx m = Ctx {...}"}, {"owner": {"reputation": 349, "user_id": 5006014, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/437a8a23959c7c7150c242c9a3efab0e?s=128&d=identicon&r=PG&f=1", "display_name": "stefa ng", "link": "https://stackoverflow.com/users/5006014/stefa-ng"}, "reply_to_user": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1542641717, "post_id": 53375057, "comment_id": 93631456, "body": "ok, so you mean:      data Ctx m =         Ctx {             token :: String,             httpLBSFunc :: m         }  ? but then i have to specify the Ctx type everywhere with &quot;Ctx MonadIO (Response ByteString)&quot; ... right? i wouldn&#39;t like that. can&#39;t i put that &quot;MonadIO (Response ByteString)&quot; constraint somewhere inside the type?"}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 1, "creation_date": 1542643288, "post_id": 53375057, "comment_id": 93632442, "body": "If you want put the constraint in Constructor, considers to use GADTs instead. Or, put constraint on data type like: data MonadIO m =&gt; Ctx m = {...} with enable -XDatatypeContexts language extension,it has been deprecated, but you can still use it."}], "answers": [{"tags": [], "owner": {"reputation": 349, "user_id": 5006014, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/437a8a23959c7c7150c242c9a3efab0e?s=128&d=identicon&r=PG&f=1", "display_name": "stefa ng", "link": "https://stackoverflow.com/users/5006014/stefa-ng"}, "is_accepted": false, "score": 0, "last_activity_date": 1542648876, "creation_date": 1542648876, "answer_id": 53379911, "question_id": 53375057, "link": "https://stackoverflow.com/questions/53375057/haskell-mocking-define-func-in-datatype-with-class-constraint/53379911#53379911", "title": "haskell mocking: define func in datatype with class-constraint", "body": "<p>i don't what the drawbacks are by replacing the constraint <strong>MonadIO</strong> with the actual Monad <strong>IO</strong> but for me it was sufficient to get it running:</p>\n\n<pre><code>data Ctx =\n    Ctx {\n        token :: String,\n        httpLBSFunc :: Request -&gt; IO (Response ByteString)\n    } deriving (Show)\n</code></pre>\n\n<p>i dont even get the exact difference between them</p>\n"}], "owner": {"reputation": 349, "user_id": 5006014, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/437a8a23959c7c7150c242c9a3efab0e?s=128&d=identicon&r=PG&f=1", "display_name": "stefa ng", "link": "https://stackoverflow.com/users/5006014/stefa-ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1542648876, "creation_date": 1542631916, "question_id": 53375057, "link": "https://stackoverflow.com/questions/53375057/haskell-mocking-define-func-in-datatype-with-class-constraint", "title": "haskell mocking: define func in datatype with class-constraint", "body": "<p>there is the function </p>\n\n<pre><code>httpLBS :: MonadIO m =&gt; Request -&gt; m (Response ByteString) \n</code></pre>\n\n<p>in the <strong>Network.HTTP.Simple</strong> module (<a href=\"https://hackage.haskell.org/package/http-conduit-2.2.3/docs/Network-HTTP-Simple.html\" rel=\"nofollow noreferrer\">doc</a>), which i want to pass around (for mocking later in integration-testing) with my <strong>Ctx</strong> data-object</p>\n\n<pre><code>data Ctx =\n    Ctx {\n        token :: String,\n        httpLBSFunc :: MonadIO m =&gt; Request -&gt; m (Response ByteString)\n    } deriving (Show)\n</code></pre>\n\n<p>but I'm getting this error:</p>\n\n<pre><code>Prelude&gt; :l Context.hs\n[1 of 1] Compiling Context          ( Context.hs, interpreted )\n\nContext.hs:19:32: error: Not in scope: type variable \u2018m\u2019\n   |\n19 |         httpLBSFunc :: MonadIO m =&gt; Request -&gt; m (Response B.ByteString)\n   |                                ^\n\nContext.hs:19:48: error: Not in scope: type variable \u2018m\u2019\n   |\n19 |         httpLBSFunc :: MonadIO m =&gt; Request -&gt; m (Response B.ByteString)\n   |                                                ^\nFailed, no modules loaded.\n</code></pre>\n\n<p>how is it possible to define this method in my <strong>Ctx</strong> data-type correctly??</p>\n"}, {"tags": ["haskell", "alex"], "owner": {"reputation": 98, "user_id": 9224699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ayZoN.png?s=128&g=1", "display_name": "Commodore64", "link": "https://stackoverflow.com/users/9224699/commodore64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542619760, "creation_date": 1542619760, "question_id": 53371675, "link": "https://stackoverflow.com/questions/53371675/alex-monad-wrapper-difference-between-and-skip", "title": "Alex monad wrapper difference between ; and skip", "body": "<p>Using the monadwrapper in alex, it seems you can skip using either <code>;</code> or the <code>{skip}</code> action. They generate different code, but I can't seem to find the difference. Why is this obvious question not addressed in the documentation?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 17989, "user_id": 365102, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e3139989e6548e7deac2cd45253d60df?s=128&d=identicon&r=PG", "display_name": "Mateen Ulhaq", "link": "https://stackoverflow.com/users/365102/mateen-ulhaq"}, "edited": false, "score": 0, "creation_date": 1542619341, "post_id": 53371480, "comment_id": 93618932, "body": "I mean, you could just write the whole thing in one line <code>think n x = (a * a - 1) &#47; n - n where a = x + 1</code>"}, {"owner": {"reputation": 9345, "user_id": 1021920, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/VukgG.jpg?s=128&g=1", "display_name": "hellow", "link": "https://stackoverflow.com/users/1021920/hellow"}, "edited": false, "score": 2, "creation_date": 1542621083, "post_id": 53371480, "comment_id": 93619926, "body": "I think this is more appropriate for <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 3, "creation_date": 1542624864, "post_id": 53371480, "comment_id": 93622073, "body": "The F# pipe operator is available as <a href=\"https://www.stackage.org/haddock/lts-12.19/base-4.11.1.0/Control-Arrow.html#v:-62--62--62-\" rel=\"nofollow noreferrer\"><code>(&gt;&gt;&gt;)</code></a> in the <code>Control.Arrow</code> module. You could also try using <a href=\"https://wiki.haskell.org/Section_of_an_infix_operator\" rel=\"nofollow noreferrer\">operator sections</a>."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1542660293, "post_id": 53371480, "comment_id": 93640596, "body": "@bradrn the <code>&gt;&gt;&gt;</code> operator from <code>Control.Arrow</code> is actually composition, whereas F# pipe is reverse application."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1542672208, "post_id": 53371480, "comment_id": 93644742, "body": "Thank you for clarifying @Fyodor Soikin - I&#39;m not too familiar with F#. In that case <code>(&amp;)</code> would indeed be the correct choice as you said below."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10673670, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lTLVbR4ip6w/AAAAAAAAAAI/AAAAAAAACeA/Ctl4rCnzL34/photo.jpg?sz=128", "display_name": "Ivan Saracino", "link": "https://stackoverflow.com/users/10673670/ivan-saracino"}, "edited": false, "score": 0, "creation_date": 1542652603, "post_id": 53377669, "comment_id": 93637122, "body": "Thank you. Really nice."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 2, "last_activity_date": 1542660186, "last_edit_date": 1542660186, "creation_date": 1542640732, "answer_id": 53377669, "question_id": 53371480, "link": "https://stackoverflow.com/questions/53371480/scott-wlaschin-thinkofnumber-example/53377669#53377669", "title": "Scott Wlaschin ThinkOfNumber example", "body": "<p><a href=\"https://www.stackage.org/haddock/lts-12.19/base-4.11.1.0/Data-Function.html#v:-38-\" rel=\"nofollow noreferrer\">Operator <code>&amp;</code></a> from <code>Data.Function</code> is the exact analog of the F# pipe:</p>\n\n<pre><code>thinkOfANumber numberYonThoughOf = \n    let addOne x = x + 1\n        squareIt x = x * x\n        subtractOne x = x - 1\n        divideByTheNumberYouThoughtOf x = x / numberYonThoughOf\n    in  numberYonThoughOf \n        &amp; addOne\n        &amp; squareIt\n        &amp; subtractOne\n        &amp; divideByTheNumberYouThoughtOf\n</code></pre>\n\n<p>Of course, if you like the pipe (I personally do), you can always define it in Haskell:</p>\n\n<pre><code>infixl 5 |&gt;\nx |&gt; f = f x\n\nthinkOfANumber numberYonThoughOf = \n    let addOne x = x + 1\n        squareIt x = x * x\n        subtractOne x = x - 1\n        divideByTheNumberYouThoughtOf x = x / numberYonThoughOf\n    in  numberYonThoughOf \n        |&gt; addOne\n        |&gt; squareIt\n        |&gt; subtractOne\n        |&gt; divideByTheNumberYouThoughtOf\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 1, "last_activity_date": 1542655837, "creation_date": 1542655837, "answer_id": 53381406, "question_id": 53371480, "link": "https://stackoverflow.com/questions/53371480/scott-wlaschin-thinkofnumber-example/53381406#53381406", "title": "Scott Wlaschin ThinkOfNumber example", "body": "<p>Fyodor Soikin is correct that <code>&amp;</code> corresponds to F#'s <code>|&gt;</code>, but my impression from reading Haskell code is that it's considered more idiomatic to use the <code>$</code> operator and compose from right to left, like in mathematics:</p>\n\n<pre><code>thinkOfANumber numberYouThoughOf = \n  let addOne x = x + 1\n      squareIt x = x * x\n      subtractOne x = x - 1\n      divideByTheNumberYouThoughtOf x = x / numberYouThoughOf\n  in divideByTheNumberYouThoughtOf $ subtractOne $ squareIt $ addOne numberYouThoughOf\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10673670, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lTLVbR4ip6w/AAAAAAAAAAI/AAAAAAAACeA/Ctl4rCnzL34/photo.jpg?sz=128", "display_name": "Ivan Saracino", "link": "https://stackoverflow.com/users/10673670/ivan-saracino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1542798452, "creation_date": 1542619021, "last_edit_date": 1542798452, "question_id": 53371480, "link": "https://stackoverflow.com/questions/53371480/scott-wlaschin-thinkofnumber-example", "title": "Scott Wlaschin ThinkOfNumber example", "body": "<p>I'm trying to find my way in functional programming with haskell.\nI saw this nice video <a href=\"https://www.youtube.com/watch?v=vDe-4o8Uwl8\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=vDe-4o8Uwl8</a> by Scott Wlaschin.\nI'm tryng to implement his ThinkOfNumber example using haskell.</p>\n\n<p><a href=\"https://i.stack.imgur.com/vidul.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vidul.png\" alt=\"Think of a number, F#\"></a></p>\n\n<p>The only solution I found is this one:</p>\n\n<pre><code>thinkOfANumber  numberYouThoughtOf =  (\\x -&gt; x - numberYouThoughtOf) \n                                      . (\\x -&gt; x / numberYouThoughtOf) \n                                      . (\\x -&gt; x - 1) \n                                      . (\\x -&gt; x * x) \n                                      . (\\x -&gt; x + 1)\n</code></pre>\n\n<p>So I have to invoke the function in this way, using 2 parameters</p>\n\n<pre><code>thinkOfANumber 13 13\n</code></pre>\n\n<p>in order to memorize the numberYouThoughtOf in the call chain.</p>\n\n<p>I there a way to simplify the code, using a pipe like operator such as the \"|>\" operator in F# ?</p>\n\n<p>Maybe I'm surely missing something :)\nRegards.\nIvan</p>\n\n<p>edited after the nice Fyodor Soikin response:</p>\n\n<p>In case someone is interested in the Scott Wlaschin presentation, here is a possible haskell solution to the toRomanNumerals example:</p>\n\n<pre><code>import Data.List.Utils\n\n  infixl 5 |&gt;\n  x |&gt; f = f x\n\n  toRomanNumerals number = \n      let replicate_I     = ['I' | _ &lt;- [1 .. number]]\n          replace_IIIII_V = replace \"IIIII\" \"V\"\n          replace_VV_X    = replace \"VV\" \"X\"\n          replace_XXXXX_L = replace \"XXXXX\" \"L\"\n          replace_LL_C    = replace \"LL\" \"C\"\n          replace_CCCCC_D = replace \"CCCCC\" \"D\"\n          replace_DD_M    = replace \"DD\" \"M\"\n      in replicate_I\n         |&gt; replace_IIIII_V\n         |&gt; replace_VV_X\n         |&gt; replace_XXXXX_L\n         |&gt; replace_LL_C\n         |&gt; replace_CCCCC_D \n         |&gt; replace_DD_M\n</code></pre>\n\n<p>Thanks again fyodor soikin!</p>\n"}, {"tags": ["haskell", "category-theory"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1542594220, "post_id": 53367418, "comment_id": 93611635, "body": "(1) &quot;However, the <code>bind</code>-style monad admits a generalization that the <code>join</code>-style monad doesn&#39;t&quot; -- Or does it? What about <code>fdom id :: f (m a) -&gt; m a</code>? (I have no idea if that actually leads somewhere; I&#39;m just speculating about type signatures.) (2) Related: <a href=\"https://stackoverflow.com/q/40716239/2751851\"><i>What is this thing similar to KleisliFunctor?</i></a> -- but note that my answer there is not particularly useful."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1542595717, "post_id": 53367418, "comment_id": 93611932, "body": "This sounds related to Kan extensions but my knowledge of it stops right here <a href=\"https://hackage.haskell.org/package/kan-extensions-5.2/docs/Data-Functor-Kan-Ran.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/kan-extensions-5.2/docs/&hellip;</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 7, "creation_date": 1542601260, "post_id": 53367418, "comment_id": 93612987, "body": "What laws do you propose for this structure?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542634334, "post_id": 53367418, "comment_id": 93627055, "body": "Given <code>fdom g as</code>, I can see you&#39;d map <code>g</code> over the <code>as</code>, but then what? What does <code>fdom</code> do to reduce the resulting <code>f (m b)</code> value to a <code>m b</code> value? Seems like you need a functor/algebra/monad triple, rather than just a functor/monad pair."}], "owner": {"reputation": 8864, "user_id": 83435, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/41b56228b2143ab0929e01c258399f99?s=128&d=identicon&r=PG", "display_name": "So8res", "link": "https://stackoverflow.com/users/83435/so8res"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1542593440, "creation_date": 1542593440, "question_id": 53367418, "link": "https://stackoverflow.com/questions/53367418/is-there-a-common-name-for-this-generalization-of-monads", "title": "Is there a common name for this generalization of monads?", "body": "<p>In Haskell, we think of a monad <code>m</code> as being a (Hask endo-)functor equipped with the following structure:</p>\n\n<pre><code>pure : a -&gt; m a\nbind : (a -&gt; m b) -&gt; (m a -&gt; m b)\n</code></pre>\n\n<p>This is by contrast to the more categorical approach, where we tend to think in terms of <code>join</code> rather than <code>bind</code>. However, the <code>bind</code>-style monad admits a generalization that the <code>join</code>-style monad doesn't. In particular, we can consider pairs of functors <code>f</code> and <code>m</code> equipped with the following structure:</p>\n\n<pre><code>pure : a -&gt; m a\nfdom : (a -&gt; m b) -&gt; (f a -&gt; m b)\n</code></pre>\n\n<p>Is there a name for these sorts of functor-pairs in category theory?</p>\n\n<p>NB: I'm not entirely sure how to make the details of this construction work in category theory in general, b/c if I let <code>m</code> and <code>f</code> be arbitrary functors as opposed to just endofunctors on Hask then I think I might need to start working in 2-categories in order to even be able to name <code>pure</code> and <code>fdom</code>. I was hoping to find some papers on related concepts and start reading, but the popularity of monads has made this concept exceptionally difficult to google.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 6, "creation_date": 1542594953, "post_id": 53367056, "comment_id": 93611762, "body": "(1) Closely related: <a href=\"https://stackoverflow.com/q/35785176/2751851\"><i>Check whether a type is an instance of Show in Haskell?</i></a>; <a href=\"https://stackoverflow.com/q/44250854/2751851\"><i>Use specialized implementation if a class instance is available</i></a>. I&#39;m not closing against those now because I&#39;m not sure about which kind of answer would best fit here. (2) In the context of those two questions, <a href=\"http://hackage.haskell.org/package/constraints-emerge\" rel=\"nofollow noreferrer\">the <i>constraints-emerge</i> package</a> is also worth a shout. (3) In any case, as those discussions suggest, this isn&#39;t something to be undertaken lightly."}, {"owner": {"reputation": 131, "user_id": 3749167, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056fa9bbc5f8f7a35be7fa3c353a023e?s=128&d=identicon&r=PG&f=1", "display_name": "user3749167", "link": "https://stackoverflow.com/users/3749167/user3749167"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1542619650, "post_id": 53367056, "comment_id": 93619097, "body": "It helps me. Thanks a lot!"}], "answers": [{"tags": [], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "is_accepted": false, "score": 1, "last_activity_date": 1542617764, "creation_date": 1542617764, "answer_id": 53371172, "question_id": 53367056, "link": "https://stackoverflow.com/questions/53367056/function-that-behaves-differently-depending-on-which-type-classes-the-argument-b/53371172#53371172", "title": "Function that behaves differently depending on which type classes the argument belong to", "body": "<p>No.</p>\n\n<p>The closest you can get is to use Overlapping instances, with a catch-all instance for anything not having a more specific <code>Show</code> instance.</p>\n\n<pre><code>instance {-# OVERLAPPABLE #-} Show a  where\n  show _ = \"(Cannot be shown)\"\n</code></pre>\n\n<p>Overlapping instances come with lots of caveats: see topics like 'orphan instances', 'Incoherent instances'. That's particularly awkward with <code>Prelude</code> classes like <code>Show</code>, because there's likely to be lots of instances hidden away in libraries.</p>\n\n<p>As @duplode says, there are many dangers. Almost certainly there's a better way to achieve whatever it is you think you want.</p>\n"}], "owner": {"reputation": 131, "user_id": 3749167, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/056fa9bbc5f8f7a35be7fa3c353a023e?s=128&d=identicon&r=PG&f=1", "display_name": "user3749167", "link": "https://stackoverflow.com/users/3749167/user3749167"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542617764, "creation_date": 1542589260, "question_id": 53367056, "link": "https://stackoverflow.com/questions/53367056/function-that-behaves-differently-depending-on-which-type-classes-the-argument-b", "title": "Function that behaves differently depending on which type classes the argument belong to", "body": "<p>In Haskell, is there any way to declare function it behaves differently depending on whether the type of a argument is an instance of specific type class?\nFor example, can I define <code>genericShow</code> in the following example?</p>\n\n<pre><code>-- If type `a` is an instance of `Show`.\ngenericShow :: Show a =&gt; a -&gt; String\ngenericShow = show\n-- If type `a` is not an instance of `Show`.\ngenericShow :: a -&gt; String\ngenericShow _ = \"(Cannot be shown)\"\n\n&gt; genericShow 3\n\"3\"\n&gt; genericShow const\n\"(Cannot be shown)\"\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "edited": false, "score": 0, "creation_date": 1542598921, "post_id": 53366439, "comment_id": 93612547, "body": "Creating a tree with back pointers is easy in the static case, but might be painful when you want to dynamically do so (this is called tying the knot). Since you&#39;ve specified this tree statically, the test case works, but I think it will be much harder to implement a <code>mkBST :: Ord a =&gt; [a] -&gt; BST a</code>, compared to a tree without back pointers. Moreover, you cannot have sharing between two trees this way, you will need to duplicate entire trees for the tiniest of modifications."}, {"owner": {"reputation": 2714, "user_id": 435124, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/869caf84d3e2f1963345501b2e420df9?s=128&d=identicon&r=PG", "display_name": "bcherny", "link": "https://stackoverflow.com/users/435124/bcherny"}, "reply_to_user": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "edited": false, "score": 0, "creation_date": 1542599955, "post_id": 53366439, "comment_id": 93612752, "body": "Here it is without back pointers. I wish there was a way to generalize it more, though -- it still feels inelegant. <a href=\"https://github.com/bcherny/bst-next/blob/master/src/v2-noparent.hs\" rel=\"nofollow noreferrer\">github.com/bcherny/bst-next/blob/master/src/v2-noparent.hs</a>"}], "owner": {"reputation": 2714, "user_id": 435124, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/869caf84d3e2f1963345501b2e420df9?s=128&d=identicon&r=PG", "display_name": "bcherny", "link": "https://stackoverflow.com/users/435124/bcherny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542583331, "creation_date": 1542583331, "question_id": 53366439, "link": "https://stackoverflow.com/questions/53366439/finding-the-next-node-in-a-bst", "title": "Finding the next node in a BST", "body": "<p>Is there a more elegant way to do this? My solution doesn't feel particularly Haskell-y.</p>\n\n<p>I also wrote a version where nodes don't have a parent pointer, but it's a bit less efficient.</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\nmodule BST (next) where\n\n-- Define BST datatype\n\ndata BST a where\n  Nil :: BST a\n  Node :: (Eq a, Ord a) =&gt; (BST a) -&gt; a -&gt; (BST a) -&gt; (BST a) -&gt; (BST a)\n\ninstance Eq (BST a) where\n  Nil == Nil = True\n  Nil == _ = False\n  _ == Nil = False\n  (Node _ a _ _) == (Node _ b _ _) = a == b\n\ninstance (Show a) =&gt; Show (BST a) where\n  show Nil = \"\"\n  show (Node l v r _) = \"(\" ++ show v ++ \")\"\n\n-- Accessors\n\nleft :: BST a -&gt; BST a\nleft Nil = Nil\nleft (Node Nil _ _ _) = Nil\nleft (Node l _ _ _) = l\n\n-- Utility functions\nmin :: BST a -&gt; BST a\nmin Nil = Nil\nmin n@(Node Nil _ _ _) = n\nmin (Node l _ _ _) = BST.min l\n\n-- Traverse up, until we find a parent node that has a value larger than a.\nbigParent :: a -&gt; BST a -&gt; BST a\nbigParent _ Nil = Nil\nbigParent a p@(Node _ pa _ pp)\n  | pa &gt; a = p\n  | otherwise = bigParent a pp\n\n-- Next node\nnext :: BST a -&gt; BST a\nnext Nil = Nil\nnext (Node _ _ r@Node{} _) = BST.min r\nnext n@(Node _ a _ p)\n  | n == left p = p\n  | otherwise = bigParent a p\n\n-- Tests\n\n--              8\n--           /    \\\n--         3       10\n--       /  \\       \\\n--     1     6       14\n--         /  \\     /\n--       4     7  13\n\nn1 = Node Nil 1 Nil n3\nn4 = Node Nil 4 Nil n6\nn7 = Node Nil 7 Nil n6\nn6 = Node n4 6 n7 n3\nn3 = Node n1 3 n6 n8\nn13 = Node Nil 13 Nil n14\nn14 = Node n13 14 Nil n10\nn10 = Node Nil 10 n14 n8\nn8 = Node n3 8 n10 Nil\n\nmain = do\n  expect \"n1\" (next n1) n3\n  expect \"n3\" (next n3) n4\n  expect \"n4\" (next n4) n6\n  expect \"n6\" (next n6) n7\n  expect \"n7\" (next n7) n8\n  expect \"n8\" (next n8) n10\n  expect \"n10\" (next n10) n13\n  expect \"n13\" (next n13) n14\n\nexpect :: Eq a =&gt; String -&gt; a -&gt; a -&gt; IO ()\nexpect name actual expected = case actual == expected of\n  True -&gt; putStrLn $ \"[\" ++ name ++ \"] OK\"\n  False -&gt; putStrLn $ \"[\" ++ name ++ \"] FAIL\"\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 286, "user_id": 4677628, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/640b058a420fc856868361392ce02949?s=128&d=identicon&r=PG&f=1", "display_name": "tomh1012", "link": "https://stackoverflow.com/users/4677628/tomh1012"}, "edited": false, "score": 0, "creation_date": 1542578421, "post_id": 53365842, "comment_id": 93608306, "body": "Would length LISTNAME do what you&#39;re looking for? You could use this with an IF to check if you&#39;re dealing with a 2 item list or not?"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1542578446, "post_id": 53365842, "comment_id": 93608314, "body": "You are already checking that by the type signature at the compile time."}, {"owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "reply_to_user": {"reputation": 286, "user_id": 4677628, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/640b058a420fc856868361392ce02949?s=128&d=identicon&r=PG&f=1", "display_name": "tomh1012", "link": "https://stackoverflow.com/users/4677628/tomh1012"}, "edited": false, "score": 0, "creation_date": 1542578563, "post_id": 53365842, "comment_id": 93608350, "body": "@tomh1012 No, I wan&#39;t to do this with tuples, triples, quadruples and so on"}, {"owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1542578656, "post_id": 53365842, "comment_id": 93608382, "body": "@Redu I want to check if a argument I give to another function that I wrote is a tuple. If it is a tuple then the Program should continue and if not then I get &quot;not Tuple&quot; or something similar"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1542578837, "post_id": 53365842, "comment_id": 93608428, "body": "No, all the various tuples are distinct and unrelated types."}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 1, "creation_date": 1542578939, "post_id": 53365842, "comment_id": 93608459, "body": "Shouldn&#39;t you just be using lists instead?"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1542578975, "post_id": 53365842, "comment_id": 93608466, "body": "Strictly typed languages such as Haskell don&#39;t work like that. You can not invoke a function with a parameter that doesn&#39;t fit the type signature. It won&#39;t compile. For such possible to fail cases you are expected to use <code>Maybe</code> or <code>Either</code> type."}, {"owner": {"reputation": 23007, "user_id": 7943564, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b6f0ad4cd865587a782bf697d3b18d18?s=128&d=identicon&r=PG&f=1", "display_name": "glennsl", "link": "https://stackoverflow.com/users/7943564/glennsl"}, "edited": false, "score": 5, "creation_date": 1542579034, "post_id": 53365842, "comment_id": 93608481, "body": "This seems like a prime example of <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">the XY problem</a>. @cheshire: What are you actually trying to accomplish?"}, {"owner": {"reputation": 286, "user_id": 4677628, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/640b058a420fc856868361392ce02949?s=128&d=identicon&r=PG&f=1", "display_name": "tomh1012", "link": "https://stackoverflow.com/users/4677628/tomh1012"}, "edited": false, "score": 0, "creation_date": 1542579165, "post_id": 53365842, "comment_id": 93608510, "body": "If you checked the type of the variable would that help? <a href=\"https://stackoverflow.com/q/4131552/4677628\">stackoverflow.com/q/4131552/4677628</a>"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 3, "creation_date": 1542580811, "post_id": 53365842, "comment_id": 93608915, "body": "@cheshire First a terminology note: Both <code>(x,y)</code> and <code>(x,y,z)</code> are tuples. The word for a 2-element tuple is &quot;pair&quot;. Now if you have a function that takes a pair as an argument and you try to call it with an argument other than a pair, you will get an error - at compile time. Type checking is already a built-in feature. So the runtime check you are trying to write would be pointless. In the cases where your hypothetical function would return false, the code wouldn&#39;t compile in the first place."}], "answers": [{"tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": true, "score": 7, "last_activity_date": 1542587428, "creation_date": 1542587428, "answer_id": 53366877, "question_id": 53365842, "link": "https://stackoverflow.com/questions/53365842/check-if-tuple-or-triple-in-haskell/53366877#53366877", "title": "Check if tuple or triple in haskell", "body": "<blockquote>\n  <p>Is there a way to check how many elements <code>(,)</code> has?</p>\n</blockquote>\n\n<p>No, because the answer is always 2.</p>\n\n<p>The type <code>(,)</code> is the type constructor for a tuple of two values, or a 2-tuple. It is a distinct type from <code>(,,)</code>, the constructor for 3-tuples. Likewise, both those types are distinct from <code>(,,,)</code>, the constructor for 4-tuples, and so on.</p>\n\n<p>When you write a function with type <code>(Foo, Bar) -&gt; Baz</code>, the typechecker will reject any attempts to call the function with a tuple of a different number of values (or something that isn\u2019t a tuple at all). Therefore, your <code>isTuple</code> function only has one logical implementation,</p>\n\n<pre><code>isTuple :: (a, b) -&gt; Bool\nisTuple _ = True\n</code></pre>\n\n<p>\u2026since it is impossible to ever actually call <code>isTuple</code> with a value that is not a 2-tuple.</p>\n\n<p>Without using typeclasses, it is impossible in Haskell to write a function that accepts a tuple of arbitrary size; that is, you cannot be polymorphic over the size of a tuple. This is because, unlike lists, tuples are <em>heterogenous</em>\u2014they can contain values of different types. A function that accepts a tuple of varying length would have no way to predict which elements of the tuple are of which type, and therefore it wouldn\u2019t be able to actually do anything useful.</p>\n\n<p>Very rarely, when doing advanced, type-level trickery, it can be useful to have a type that represents a tuple of varying length, which in Haskell is frequently known as an <code>HList</code> (for <em>heterogenous list</em>). These can be implemented as a library using fancy typeclass machinery and type-level programming. However, if you are a beginner, this is definitely <strong>not</strong> what you want.</p>\n\n<p>It is difficult to actually give advice on what you <em>should</em> do because, as a commenter points out, your question reads like <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">an XY problem</a>. Consider asking a different question that gives a little more context about the problem you were actually trying to solve that made you want to find the list of a tuple in the first place, and you\u2019ll most likely get more helpful answers.</p>\n"}], "owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 701, "favorite_count": 1, "accepted_answer_id": 53366877, "answer_count": 1, "score": 0, "last_activity_date": 1542587428, "creation_date": 1542578054, "question_id": 53365842, "link": "https://stackoverflow.com/questions/53365842/check-if-tuple-or-triple-in-haskell", "title": "Check if tuple or triple in haskell", "body": "<p>Is there a way to check how many elements <code>(,)</code> has? I know I can access first and second element of a tuple with <code>fst</code> and <code>snd</code> but and thought I could somehow sum elements and then compare it with fst tuple snd tuple and check like this: </p>\n\n<pre><code>tuple = (1,2)\n\nsum tuple == fst tuple + snd tuple\n</code></pre>\n\n<p>and then I get True for this case and get False for <code>triple = (1,2,3)</code>. Eitherway I cant ask <code>fst (1,2,3)</code> nor I can do <code>sum tuple</code> </p>\n\n<p>Is there a way to check if I have a tuple or not? </p>\n\n<p>Something like this: </p>\n\n<pre><code>is_tuple :: (a,b) -&gt; a\nis_tuple (a,_) = a\n</code></pre>\n\n<p>but to get True when I input tuple  and False when I give (1,2,3) or (1,2,3,4) and so on... as a input. </p>\n\n<p>i.e: </p>\n\n<pre><code>is_tuple :: Tuple -&gt; Bool\nis_tuple x = if x is Tuple \n                then True\n                else False\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["list", "haskell", "scope", "list-comprehension", "monads"], "answers": [{"tags": [], "owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "is_accepted": true, "score": 12, "last_activity_date": 1542569508, "creation_date": 1542569508, "answer_id": 53364688, "question_id": 53364657, "link": "https://stackoverflow.com/questions/53364657/why-does-haskell-not-allow-pattern-matching-in-comprehensions/53364688#53364688", "title": "Why does Haskell not allow pattern matching in comprehensions?", "body": "<p>Your bindings are in the wrong order. </p>\n\n<pre><code>h c = [f x | (a,b) &lt;- c, f &lt;- b, x &lt;- a]\n</code></pre>\n"}], "owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 53364688, "answer_count": 1, "score": 3, "last_activity_date": 1542569654, "creation_date": 1542569321, "last_edit_date": 1542569654, "question_id": 53364657, "link": "https://stackoverflow.com/questions/53364657/why-does-haskell-not-allow-pattern-matching-in-comprehensions", "title": "Why does Haskell not allow pattern matching in comprehensions?", "body": "<p>I've written the following (trivial) function:</p>\n\n<pre><code>h c = [f x | x &lt;- a, f &lt;- b, (a, b) &lt;- c]\n</code></pre>\n\n<p>I'd've expected this to be desugared as:</p>\n\n<pre><code>h c = do (a, b) &lt;- c\n         f &lt;- b\n         x &lt;- a\n         return (f x)\n</code></pre>\n\n<p>In turn, desugared (ignoring the <code>fail</code> stuff) as:</p>\n\n<pre><code>h c = c &gt;&gt;= \\(a, b) -&gt; b &gt;&gt;= \\f -&gt; a &gt;&gt;= \\x -&gt; return (f x)\n</code></pre>\n\n<p>However, GHCi returns the error:</p>\n\n<pre><code>&lt;interactive&gt;:24:17: error: Variable not in scope: a :: [a1]\n&lt;interactive&gt;:20:27: error:\n    Variable not in scope: b :: [t0 -&gt; b1]\n</code></pre>\n\n<p>This seems nonsensical, as <code>a</code> and <code>b</code> are indeed in scope.</p>\n"}, {"tags": ["haskell", "command-line-interface", "cabal", "bash-completion"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1542569598, "post_id": 53364299, "comment_id": 93605894, "body": "I might be wrong, but I don&#39;t think that Cabal can install files under <code>&#47;etc</code>. To write there, one would need root permissions, and Cabal is usually run by non-root users. Also, adding system-wide configuration files should be done using the OS package manager like <code>apt</code>, installing a package, so that they can be tracked. Cabal can however specify that the distribution should carry <code>data-files</code>, so that those files should also be installed along the program in some directory. The user then has to copy/link to them."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1542570071, "post_id": 53364299, "comment_id": 93606021, "body": "@chi So best practice is to just instruct the user to do 2 themselves. What&#39;s the best way to accomplish 1?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1542572832, "post_id": 53364299, "comment_id": 93606754, "body": "I am not experienced enough to provide a real suggestion about Cabal best practices. I&#39;d try to use <code>data-files:</code> for 1, even though there might be better ways."}, {"owner": {"reputation": 677, "user_id": 3536806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5321e2babfa1c70186599163a3c188?s=128&d=identicon&r=PG&f=1", "display_name": "Dominik Schrempf", "link": "https://stackoverflow.com/users/3536806/dominik-schrempf"}, "edited": false, "score": 0, "creation_date": 1587819553, "post_id": 53364299, "comment_id": 108661737, "body": "Cabal is installing stuff into <code>~&#47;.local&#47;</code>. It is possible to include bash completion instruction into <code>~&#47;.local&#47;share</code>, and cabal could do that. Any ideas about how this could be done?"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1542566622, "creation_date": 1542566622, "question_id": 53364299, "link": "https://stackoverflow.com/questions/53364299/how-do-i-install-bash-completions-for-my-haskell-packages-executable", "title": "How do I install Bash completions for my Haskell package&#39;s executable?", "body": "<p>The Haskell package <code>optparse-applicative</code> <a href=\"https://github.com/pcapriotti/optparse-applicative/wiki/Bash-Completion\" rel=\"nofollow noreferrer\">provides instructions</a> for creating a bash completion script for an executable, and then suggests that this</p>\n\n<blockquote>\n  <p>should be shipped with the program and copied to the appropriate directory usually (<code>/etc/bash_completion.d/</code>) during installation.</p>\n</blockquote>\n\n<p>I wold like to ship and install this script with my package, along wit the executable. How do I instruct Cabal (in my .cabal) to </p>\n\n<ol>\n<li>include the bash completion script along with my package, and</li>\n<li>copy the script to <code>/etc/bash_completion.d/</code>?</li>\n</ol>\n"}, {"tags": ["haskell", "emacs", "autocomplete", "haskell-mode"], "comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1542557905, "post_id": 53362894, "comment_id": 93602489, "body": "You may like to install <a href=\"https://github.com/haskell/haskell-ide-engine#user-content-using-hie-with-emacs\" rel=\"nofollow noreferrer\">haskell-ide-engine and integrate it with emacs</a>. Autocompletion is a part of HIE among some other useful Haskell thingies."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1542560589, "post_id": 53362894, "comment_id": 93603348, "body": "Intero also does autocompletion with emacs. No integrated docs, AFAIK."}, {"owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1542568687, "post_id": 53362894, "comment_id": 93605655, "body": "@Redu Would you mind giving some general direction on how to go about installing it and making it work? I&#39;ve installed hie from my package manager <code>arch&#39;s aur</code> and also generated hoogle db. <code>(add-to-list &#39;load-path &quot;&#47;home&#47;path&#47;to&#47;lsp-mode&#47;&quot;) (require &#39;lsp-mode) (require &#39;lsp-ui) (require &#39;lsp-haskell) (add-hook &#39;lsp-mode-hook &#39;lsp-ui-mode) (add-hook &#39;haskell-mode-hook #&#39;lsp-haskell-enable) (add-hook &#39;haskell-mode-hook &#39;flycheck-mode) (add-hook &#39;lsp-mode-hook &#39;lsp-ui-mode) (add-hook &#39;haskell-mode-hook &#39;flycheck-mode)</code> are the hooks I added. But autocomplete doesn&#39;t seem to work at all."}, {"owner": {"reputation": 9567, "user_id": 1900722, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nGsJr.jpg?s=128&g=1", "display_name": "anquegi", "link": "https://stackoverflow.com/users/1900722/anquegi"}, "edited": false, "score": 0, "creation_date": 1542724991, "post_id": 53362894, "comment_id": 93666283, "body": "Please try to use intero, whit this configuration: <a href=\"https://commercialhaskell.github.io/intero/\" rel=\"nofollow noreferrer\">commercialhaskell.github.io/intero</a>"}], "owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542557426, "creation_date": 1542557426, "question_id": 53362894, "link": "https://stackoverflow.com/questions/53362894/haskell-autocompletion-with-general-info-and-documentation-in-emacs", "title": "Haskell autocompletion with general info and documentation in Emacs", "body": "<p>I recently started learning Haskell and switched over to Emacs as well.</p>\n\n<p>I've installed <code>haskell-mode</code>.</p>\n\n<p>This is what my <code>haskell</code> section in my <code>.emacs</code> file looks like</p>\n\n<pre><code>  79   (add-hook 'haskell-mode-hook 'font-lock-mode)                                                    \n  80   (add-hook 'haskell-mode-hook 'interactive-haskell-mode)                                          \n  81   (add-to-list 'company-backends 'company-ghc)                                                     \n  82   (custom-set-variables                                                                            \n  83    '(haskell-stylish-on-save t))\n</code></pre>\n\n<p>What I want to know is: if it's possible to get an IDE like autocomplete feature in emacs, where partially typing a function (user defined/from imported packages/from base) shows you its type and general info like you can get from <code>hoogle</code> search?</p>\n\n<p>A brief search got me to <a href=\"https://stackoverflow.com/questions/3424697/haskell-autocompletion-in-emacs-using-haskell-mode/3432226\">This question</a> which has a latest answer from 2014. I'm not sure if things have changed since.</p>\n\n<p>I also found out about <code>tags</code> with <code>hasktags</code> or <code>fast-tags</code> but I'm not sure how to apply those methods to get autocomplete suggestions from imported packages or getting doc about written functions.                                                                                                </p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "edited": false, "score": 0, "creation_date": 1542556191, "post_id": 53362640, "comment_id": 93601974, "body": "If you are adding multiple items to a list, it is more efficient to append all of the times at once, rather than looping through, adding one at a time."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1542556226, "post_id": 53362640, "comment_id": 93601990, "body": "You have to find a way to change your appending order from left associative to right associative. In another words you shouldn&#39;t do like <code>((numbers ++ new1) ++ new2) ++ new3)</code> but <code>(numbers ++ (new1 ++ (new2 ++ new3)))</code>. I would also advise you to have a look at <a href=\"http://learnyouahaskell.com/for-a-few-monads-more\" rel=\"nofollow noreferrer\">difference lists</a> towards the end of the chapter."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542573087, "post_id": 53362640, "comment_id": 93606818, "body": "check out <a href=\"https://stackoverflow.com/a/13879693/849891\">this canonical answer</a> by <a href=\"https://stackoverflow.com/users/1011995/daniel-fischer\">Daniel Fischer</a> (also maybe <a href=\"https://stackoverflow.com/a/14942678/849891\">this one</a> (disclaimer: it&#39;s by me)) which talk about this stuff."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542574021, "post_id": 53362640, "comment_id": 93607098, "body": "incidentally that <a href=\"https://stackoverflow.com/questions/14938584/haskell-foldl-poor-performance-with\">second question</a> <i>answers</i> your question here, with the example code it uses."}], "answers": [{"tags": [], "owner": {"reputation": 2043, "user_id": 2676937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d42ec82c3feefc3c7e13b37dae77f21?s=128&d=identicon&r=PG", "display_name": "merlyn", "link": "https://stackoverflow.com/users/2676937/merlyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1542558123, "last_edit_date": 1542558123, "creation_date": 1542556467, "answer_id": 53362757, "question_id": 53362640, "link": "https://stackoverflow.com/questions/53362640/trying-to-understand-how-not-to-add-elements-to-a-list/53362757#53362757", "title": "Trying to understand how not to add elements to a list", "body": "<p>Try these two functions with a large list (like [1..10000]) and see if you notice any difference:</p>\n\n<pre><code>func1 a [] = a\nfunc1 a (x:rest) = func (a ++ [x]) rest\n\n\nfunc2 a b = a ++ b\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542573614, "post_id": 53363030, "comment_id": 93606959, "body": "if <code>xs++ys</code> is <i>O(m)</i> where <code>m = length xs</code>, how come <code>head ([1..]++[0])</code> doesn&#39;t take infinite time?"}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542574292, "post_id": 53363030, "comment_id": 93607186, "body": "@WillNess Because of laziness. The time complexities from my answer where under the assumption you need to do a full evaluation and <code>xs</code> is finite."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542574543, "post_id": 53363030, "comment_id": 93607260, "body": "perhaps this assumption is important and should be included explicitly then. :)"}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542574605, "post_id": 53363030, "comment_id": 93607284, "body": "@WillNess Well I could do <code>(xs ++ ys) !! (m - 1)</code> which would indeed need <i>m</i> steps. But it is under the assumption of a full evaluation of the expression of course."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542574856, "post_id": 53363030, "comment_id": 93607354, "body": "this is too vague. what if we have <code>ys = xs++[y]; zs = ys++[z]</code>. if <code>ys</code> is O(m) only after full access, this seems to leave <code>zs</code> with only one more step to be done, so <i>it</i> would now seem to become O(1) all of a sudden. the precise <a href=\"https://stackoverflow.com/a/13879693/849891\">canonical answer</a> already exists BTW. :)"}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542574870, "post_id": 53363030, "comment_id": 93607358, "body": "@WillNess I honestly wonder if it is important, especially because I rarely come across this assumption when reading reflections by other people on time/space complexity of Haskell expressions (apart from papers which I do not read). But let me add it to the answer."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542575196, "post_id": 53363030, "comment_id": 93607439, "body": "@WillNess But full access of <code>zs</code> is still <i>O(m)</i> after all."}], "tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": true, "score": 1, "last_activity_date": 1542574956, "last_edit_date": 1542574956, "creation_date": 1542558315, "answer_id": 53363030, "question_id": 53362640, "link": "https://stackoverflow.com/questions/53362640/trying-to-understand-how-not-to-add-elements-to-a-list/53363030#53363030", "title": "Trying to understand how not to add elements to a list", "body": "<p>The answer talks about a bad time complexity when it comes to appending elements to the <em>end</em> of the list. When you concat a list <code>xs</code> of length <em>m</em> and a list <code>ys</code> of length <em>n</em> together using <code>(++)</code> then <code>xs ++ ys</code> will have time complexity <em>O(m)</em> (under the assumption you evaluate <code>xs ++ ys</code> for a number of steps in proportion to <em>m</em>). </p>\n\n<p>So if your list <code>ys</code> consists of a single element <code>y</code> (that is <code>ys == [y]</code>) then <code>[y] ++ xs</code> will be <em>O(1)</em> because you add it to the beginning but <code>xs ++ [y]</code> will be <em>O(m)</em> because you add it to the end of another list. So when you repeatedly add elements to the end of another list you will end up with <em>O(m^2)</em>. So better do it within one go so you will have <em>O(m)</em>.  </p>\n\n<p>Note that lists in Haskell are actually stacks which could have an infinite number of elements. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10641593"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 53363030, "answer_count": 2, "score": 3, "last_activity_date": 1542574956, "creation_date": 1542555806, "question_id": 53362640, "link": "https://stackoverflow.com/questions/53362640/trying-to-understand-how-not-to-add-elements-to-a-list", "title": "Trying to understand how not to add elements to a list", "body": "<p>As a followup to <a href=\"https://stackoverflow.com/q/53352740/10641593\">this question</a>, I'm attempting to understand how <strong>not</strong> to add element<strong>s</strong> to a <code>list</code> using <code>++</code>.</p>\n\n<p>From <a href=\"https://stackoverflow.com/a/53352985/10641593\">this</a> answer:</p>\n\n<blockquote>\n  <p>Again if you only want to append a single element to the list, that is\n  not a problem. <strong>This is a problem if you want to append n elements that\n  way to a list, so if you each time append a single element to the\n  list, and you do that n times, then the algorithm will be O(n2)</strong>.</p>\n</blockquote>\n\n<p>So from my understanding, this means you <strong>shouldn't</strong> do this:</p>\n\n<pre><code>let numbers = [1,3,5,10,15]\nnewNumbers = numbers ++ [27]\nlistofnumbers = newNumbers ++ [39]\n</code></pre>\n\n<p>Is this what the bold text in the quoted answer telling you not to do? If not, using code, what is the bold text warning you not to do? </p>\n"}, {"tags": ["haskell", "cabal", "liquid-haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1542549684, "post_id": 53361532, "comment_id": 93599946, "body": "Try <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">stack</a> (no guarantee it will help)."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1542551281, "post_id": 53361532, "comment_id": 93600467, "body": "You may try to <a href=\"https://github.com/ucsd-progsys/liquidhaskell/blob/develop/INSTALL.md#user-content-build-with-stack-recommended\" rel=\"nofollow noreferrer\">build the liquidhaskell package with Stack</a>"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1542556577, "post_id": 53361532, "comment_id": 93602098, "body": "It also looks like you may try rephrasing <code>import Language.Fixpoint.Misc</code> as <code>import Language.Fixpoint.Misc hiding ((=&gt;&gt;))</code> in the <code>src&#47;Language&#47;Haskell&#47;Liquid&#47;Misc.hs</code> file to see what happens."}], "owner": {"reputation": 181, "user_id": 3879300, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/036ab4e24d4109007a06bf11b8301112?s=128&d=identicon&r=PG&f=1", "display_name": "Baber", "link": "https://stackoverflow.com/users/3879300/baber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 500, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542548570, "creation_date": 1542548570, "question_id": 53361532, "link": "https://stackoverflow.com/questions/53361532/how-to-install-liquid-haskell-in-ubuntu-18-04", "title": "How to install liquid haskell in ubuntu 18.04?", "body": "<p>I am struggling to install liquid Haskell in Ubuntu 18.04. I have tried few commands to install the dependencies and now getting the error in the final compilation of liquid Haskell.</p>\n\n<p>I am using following command for the installation:</p>\n\n<p>cabal install liquidhaskell</p>\n\n<p>The error that I am getting is:</p>\n\n<pre><code>cabal install liquidhaskell\nResolving dependencies...\nConfiguring liquidhaskell-0.8.0.5...\nBuilding liquidhaskell-0.8.0.5...\nFailed to install liquidhaskell-0.8.0.5\nBuild log ( /home/baber/.cabal/logs/liquidhaskell-0.8.0.5.log ):\ncabal: Entering directory '/tmp/cabal-tmp-1752/liquidhaskell-0.8.0.5'\nConfiguring liquidhaskell-0.8.0.5...\nBuilding liquidhaskell-0.8.0.5...\nPreprocessing library liquidhaskell-0.8.0.5...\n[  1 of 106] Compiling Test.Target.Expr ( src/Test/Target/Expr.hs, dist/build/Test/Target/Expr.o )\n[  2 of 106] Compiling Paths_liquidhaskell ( dist/build/autogen/Paths_liquidhaskell.hs, dist/build/Paths_liquidhaskell.o )\n[  3 of 106] Compiling Language.Haskell.Liquid.UX.Config ( src/Language/Haskell/Liquid/UX/Config.hs, dist/build/Language/Haskell/Liquid/UX/Config.o )\n[  4 of 106] Compiling Language.Haskell.Liquid.Types.Variance ( src/Language/Haskell/Liquid/Types/Variance.hs, dist/build/Language/Haskell/Liquid/Types/Variance.o )\n[  5 of 106] Compiling Language.Haskell.Liquid.Types.Specifications ( src/Language/Haskell/Liquid/Types/Specifications.hs, dist/build/Language/Haskell/Liquid/Types/Specifications.o )\n[  6 of 106] Compiling Language.Haskell.Liquid.Types.Names ( src/Language/Haskell/Liquid/Types/Names.hs, dist/build/Language/Haskell/Liquid/Types/Names.o )\n[  7 of 106] Compiling Language.Haskell.Liquid.ProofCombinators ( include/Language/Haskell/Liquid/ProofCombinators.hs, dist/build/Language/Haskell/Liquid/ProofCombinators.o )\n[  8 of 106] Compiling Language.Haskell.Liquid.Prelude ( include/Language/Haskell/Liquid/Prelude.hs, dist/build/Language/Haskell/Liquid/Prelude.o )\n[  9 of 106] Compiling Language.Haskell.Liquid.Misc ( src/Language/Haskell/Liquid/Misc.hs, dist/build/Language/Haskell/Liquid/Misc.o )\n\nsrc/Language/Haskell/Liquid/Misc.hs:224:14: error:\n    Ambiguous occurrence \u2018=&gt;&gt;\u2019\n    It could refer to either \u2018Language.Fixpoint.Misc.=&gt;&gt;\u2019,\n                             imported from \u2018Language.Fixpoint.Misc\u2019 at src/Language/Haskell/Liquid/Misc.hs:24:1-39\n                          or \u2018Language.Haskell.Liquid.Misc.=&gt;&gt;\u2019,\n                             defined at src/Language/Haskell/Liquid/Misc.hs:221:1\ncabal: Leaving directory '/tmp/cabal-tmp-1752/liquidhaskell-0.8.0.5'\ncabal: Error: some packages failed to install:\nliquidhaskell-0.8.0.5 failed during the building phase. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>I tried by downgrading the liquidhaskell version to 7 and 6 as well but no luck. Can someone please help me in the installation?</p>\n\n<p>I appreciate your help and time in advance.</p>\n\n<p>Thanks. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1542548384, "post_id": 53361478, "comment_id": 93599511, "body": "I don&#39;t think your class makes sense. <code>const id</code> and <code>id const</code> are both valid code, so what would <code>const &lt;^&gt; id</code> do?"}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1542625879, "post_id": 53361478, "comment_id": 93622599, "body": "wrt your &quot;reasons that are not important&quot;, there&#39;s a serious use case here: some people want to use <code>(.)</code> operator for postfix function apply, as in most OOP. But there&#39;s too much legacy code using it as compose. Can we do both, by looking at the types of the arguments to <code>(.)</code>? There&#39;s still the <code>const.id</code> problem."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1542553567, "post_id": 53361793, "comment_id": 93601169, "body": "Reliably excluding infinite types turns out to be rather tricky in the presence of type families. <code>type family Oops where Oops = () &#39;: Oops</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1542553924, "post_id": 53361793, "comment_id": 93601255, "body": "@dfeuer True, but in the unification problem above I think we have <code>a&#39;-&gt;b&#39;  ~ a , b&#39;~a -&gt; b</code> which involves no type families. I guess it was simpler to simply turn off the occurs check in all the cases, rather than only when type families are still involved."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1542554792, "post_id": 53361793, "comment_id": 93601558, "body": "@chi Is <code>b&#39; ~ a&#39;; b ~ a&#39;</code> not a valid solution?"}, {"owner": {"reputation": 77, "user_id": 10670383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/735dee423a3e7cc73b81975f789f7c6d?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad B", "link": "https://stackoverflow.com/users/10670383/ahmad-b"}, "edited": false, "score": 0, "creation_date": 1542558314, "post_id": 53361793, "comment_id": 93602631, "body": "Thank you for your quick reply, chi! My application doesn&#39;t involve polymorphic functions so this problem won&#39;t arise, although I recognize that this is anissue in the long run. I tried type families as well and run in the same problem you describe. I could solve it by adding a constraint like <code>(Output (a-&gt;b) a ~ b)</code>, but this leads to some unwanted code duplication and, I suspect, more problems down the road."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1542559382, "post_id": 53361793, "comment_id": 93602953, "body": "@HTNW No, since with your substitution the first constraint becomes <code>(a&#39;-&gt;a&#39;) ~ a</code> which is not generally true."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1542588658, "post_id": 53361793, "comment_id": 93610705, "body": "@chi, I believe the occurs check is still around. But GHC doesn&#39;t want to reduce things any more than necessary."}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1542620356, "post_id": 53361793, "comment_id": 93619497, "body": "&quot;My application doesn&#39;t involve polymorphic functions&quot;. GHC doesn&#39;t know that, and certainly can&#39;t tell if your class/method might get exported to somewhere else that is polymorphic. If you&#39;re going to use fancy generic instances like that, always expect the worst."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1542550198, "creation_date": 1542550198, "answer_id": 53361793, "question_id": 53361478, "link": "https://stackoverflow.com/questions/53361478/overlapping-instances-how-to-circumvent-them/53361793#53361793", "title": "Overlapping instances - how to circumvent them", "body": "<p>This is a bad idea, in my view, but I'll play along.</p>\n\n<p>A possible solution is to switch to functional dependencies. Usually I tend to avoid fundeps in favor of type families, but here they make the instances compile in a simple way.</p>\n\n<pre><code>class Combine t1 t2 r | t1 t2 -&gt; r where\n    (&lt;^&gt;) :: t1 -&gt; t2 -&gt; r\n\ninstance Combine (a-&gt;b) a b where\n    f &lt;^&gt; x = f x\n\ninstance Combine a (a-&gt;b) b where\n    x &lt;^&gt; f = f x\n</code></pre>\n\n<p>Note that this class will likely cause problems during type inference if we use polymorphic functions. This is because, with polymorphic functions, the code can easily become ambiguous.</p>\n\n<p>For instance <code>id &lt;^&gt; id</code> could pick any of the two instances. Above, melpomene already reported <code>const &lt;^&gt; id</code> being ambiguous as well.</p>\n\n<hr>\n\n<p>The following is weakly related, but I want to share it anyway:</p>\n\n<p>What about type families instead? I tried to experiment a bit, and I just discovered a limitation which I did not know. Consider the closed type family</p>\n\n<pre><code>type family Output a b where\n   Output (a-&gt;b) a = b\n   Output a (a-&gt;b) = b\n</code></pre>\n\n<p>The code above compiles, but then the type <code>Output a (a-&gt;b)</code> is stuck. The second equation does not get applied, as if the first one could potentially match.</p>\n\n<p>Usually, I can understand this in some other scenarios, but here unifying</p>\n\n<pre><code>Output (a' -&gt; b') b' ~ Output a (a -&gt; b)\n</code></pre>\n\n<p>seems to fail since we would need <code>a ~ (a' -&gt; b') ~ (a' -&gt; a -&gt; b)</code> which is impossible,  with finite types. For some reason, GHC does not use this argument (does it pretend infinite types exist in this check? why?)</p>\n\n<p>Anyway, this makes replacing fundeps with type families harder than it could be, it seems. I have no idea about why GHC accepts the fundeps code I posted, yet refuses the OP's code which is essentially the same thing, except using type families.</p>\n"}, {"tags": [], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "is_accepted": false, "score": 1, "last_activity_date": 1542619981, "creation_date": 1542619981, "answer_id": 53371733, "question_id": 53361478, "link": "https://stackoverflow.com/questions/53361478/overlapping-instances-how-to-circumvent-them/53371733#53371733", "title": "Overlapping instances - how to circumvent them", "body": "<p>@chi is close; an approach using either FunDeps or Closed Type Families is possible. But the <code>Combine</code> instances are potentially ambiguous/unifiable just as much as the CTF <code>Output</code> equations.</p>\n\n<p>When chi says the FunDep code is accepted, that's only half-true: GHC plain leads you down the garden path. It will accept the instances but then you find you can't use them/you get weird error messages. See the Users Guide at \"potential for overlap\".</p>\n\n<p>If you're looking to resolve a potentially ambiguous <code>Combine</code> constraint, you might get an error suggesting you try <code>IncoherentInstances</code> (or <code>INCOHERENT</code> pragma). Don't do that. You have a genuinely incoherent problem; all that will do is defer the problem to somewhere else. It's always possible to avoid <code>Incoherent</code> -- providing you can rejig your instances (as follows) and they're not locked away in libraries.</p>\n\n<p>Notice that because of the potential ambiguity, another Haskell compiler (Hugs) doesn't let you write <code>Combine</code> like that. It has a more correct implementation of Haskell's (not-well-stated) rules.</p>\n\n<p>The answer is to use a sort of overlap where one instance is strictly more specific. You must first decide which you way you want to prefer in case of ambiguity. I'll choose function prefixed to argument:</p>\n\n<pre><code>{-# LANGUAGE UndecidableInstances, TypeFamilies #-}\n\ninstance {-# OVERLAPPING #-} (r ~ b)\n         =&gt; Combine (a-&gt;b) a r  where ...\n\ninstance {-# OVERLAPPABLE #-} (Combine2 t1 t2 r)\n         =&gt; Combine t1 t2 r  where\n  (&lt;^&gt;) = revApp\n\nclass Combine2 t1 t2 r  | t1 t2 -&gt; r  where\n  revApp :: t1 -&gt; t2 -&gt; r\n\ninstance (b ~ r) =&gt; Combine2 a (a-&gt;b) r  where\n  revApp x f = f x\n</code></pre>\n\n<p>Notice that the <code>OVERLAPPABLE</code> instance for <code>Combine</code> has bare tyvars, it's a catch-all so it's always matchable. All the compiler has to do is decide whether some wanted constraint is of the form of the <code>OVERLAPPING</code> instance.</p>\n\n<p>The <code>Combine2</code> constraint on the <code>OVERLAPPABLE</code> instance is no smaller than the head, so you need <code>UndecidableInstances</code>. Also beware that deferring to <code>Combine2</code> will mean that if the compiler still can't resolve, you're likely to get puzzling error messages.</p>\n\n<p>Talking of bare tyvars/\"always matchable\", I've used an additional trick to make the compiler work really hard to improve the types: There's bare <code>r</code> in the head of the instance, with an Equality type improvement constraint <code>(b ~ r) =&gt;</code>. To use the <code>~</code>, you need to switch on <code>TypeFamilies</code> even though you're not writing any type families.</p>\n\n<p>A CTF approach would be similar. You need a catch-all equation on <code>Output</code> that calls an auxiliary type function. Again you need <code>UndecidableInstances</code>.</p>\n"}], "owner": {"reputation": 77, "user_id": 10670383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/735dee423a3e7cc73b81975f789f7c6d?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmad B", "link": "https://stackoverflow.com/users/10670383/ahmad-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 1, "accepted_answer_id": 53361793, "answer_count": 2, "score": 2, "last_activity_date": 1542619981, "creation_date": 1542548264, "question_id": 53361478, "link": "https://stackoverflow.com/questions/53361478/overlapping-instances-how-to-circumvent-them", "title": "Overlapping instances - how to circumvent them", "body": "<p>I am a beginner at Haskell, so please be indulgent. For reasons that are not important here, I am trying to define a operator <code>&lt;^&gt;</code> that takes a function and an argument and returns the value of the function by the argument, <em>irrespective of which of the function and the argument came first</em>. In short, I would like to be able to write the following:</p>\n\n<pre><code>foo :: Int -&gt; Int\nfoo x = x * x\n\narg :: Int\narg = 2\n\nfoo &lt;^&gt; arg -- valid, returns 4\narg &lt;^&gt; foo -- valid, returns 4\n</code></pre>\n\n<p>I have tried to accomplish that through type families, as follows:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, MultiParamTypeClasses, TypeFamilies, TypeOperators #-}\n\nclass Combine t1 t2 where\n    type Output t1 t2 :: *\n    (&lt;^&gt;) :: t1 -&gt; t2 -&gt; Output t1 t2\n\ninstance Combine (a-&gt;b) a where\n    type Output (a-&gt;b) a = b\n    f &lt;^&gt; x = f x\n\ninstance Combine a (a-&gt;b) where\n    type Output a a-&gt;b = b\n    x &lt;^&gt; f = f x\n</code></pre>\n\n<p>On this code, GHC throws a <code>Conflicting family instance declarations</code>. My guess is that the overlap GHC complains about occurs when type <code>a-&gt;b</code> and type <code>a</code> are the same. I don't know Haskell well enough, but I suspect that with recursive type definitions, one may be able to construct such a situation. I have a couple of questions:</p>\n\n<ul>\n<li>Since this is a rather remote scenario that will never occur in my application (in particular not with <em>foo</em> and <em>arg</em> above), I was wondering if there was a way of specifying a dummy default instance to use in case of overlap? I have tried the different <code>OVERLAPS</code> and <code>OVERLAPPING</code> flags, but they didn't have any effect.</li>\n<li>If not, is there a better way of achieving what I want?</li>\n</ul>\n\n<p>Thanks!</p>\n"}, {"tags": ["string", "haskell", "functional-programming", "character"], "comments": [{"owner": {"reputation": 21, "user_id": 4734423, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H2i6p9Vm_kI/AAAAAAAAAAI/AAAAAAAACeU/zQ2Pe6mg2bM/photo.jpg?sz=128", "display_name": "Attila Fodor", "link": "https://stackoverflow.com/users/4734423/attila-fodor"}, "reply_to_user": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1542542276, "post_id": 53360550, "comment_id": 93597876, "body": "Would you make an example please?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4734423, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H2i6p9Vm_kI/AAAAAAAAAAI/AAAAAAAACeU/zQ2Pe6mg2bM/photo.jpg?sz=128", "display_name": "Attila Fodor", "link": "https://stackoverflow.com/users/4734423/attila-fodor"}, "edited": false, "score": 0, "creation_date": 1542542376, "post_id": 53360601, "comment_id": 93597901, "body": "I know String is a List of a character, but my function makes list of a character list, which is not fine for me."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 21, "user_id": 4734423, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H2i6p9Vm_kI/AAAAAAAAAAI/AAAAAAAACeU/zQ2Pe6mg2bM/photo.jpg?sz=128", "display_name": "Attila Fodor", "link": "https://stackoverflow.com/users/4734423/attila-fodor"}, "edited": false, "score": 0, "creation_date": 1542542424, "post_id": 53360601, "comment_id": 93597919, "body": "@AttilaFodor The point is that <i>you don&#39;t need a function</i>. A <code>String</code> by definition is such a list of characters."}, {"owner": {"reputation": 21, "user_id": 4734423, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H2i6p9Vm_kI/AAAAAAAAAAI/AAAAAAAACeU/zQ2Pe6mg2bM/photo.jpg?sz=128", "display_name": "Attila Fodor", "link": "https://stackoverflow.com/users/4734423/attila-fodor"}, "edited": false, "score": 0, "creation_date": 1542542597, "post_id": 53360601, "comment_id": 93597975, "body": "Maybe i have written it wrong.  I need to make a function which comes with these : [&#39;a&#39;,&#39;p&#39;,&#39;p&#39;,&#39;l&#39;,&#39;e&#39;], because i have to zip it with an other list. I know that &quot;apple&quot; = [&#39;a&#39;,&#39;p&#39;,&#39;p&#39;,&#39;l&#39;,&#39;e&#39;]"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 21, "user_id": 4734423, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H2i6p9Vm_kI/AAAAAAAAAAI/AAAAAAAACeU/zQ2Pe6mg2bM/photo.jpg?sz=128", "display_name": "Attila Fodor", "link": "https://stackoverflow.com/users/4734423/attila-fodor"}, "edited": false, "score": 1, "creation_date": 1542553778, "post_id": 53360601, "comment_id": 93601218, "body": "@AttilaFodor Curious. What notion of equality do you have in your head for which admitting <code>&quot;apple&quot; = [&#39;a&#39;,&#39;p&#39;,&#39;p&#39;,&#39;l&#39;,&#39;e&#39;]</code> does not immediately resolve the question you have? You have the former, you want the latter, and you agree they are equal. So you should be happy, right? Because they are equal, you have the latter, which is what you wanted. You&#39;re <i>already</i> done."}], "tags": [], "owner": {"reputation": 19532, "user_id": 570689, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4eed5285039322bafbeee9102367b0a4?s=128&d=identicon&r=PG", "display_name": "\u0414\u041c\u0418\u0422\u0420\u0418\u0419 \u041c\u0410\u041b\u0418\u041a\u041e\u0412", "link": "https://stackoverflow.com/users/570689/%d0%94%d0%9c%d0%98%d0%a2%d0%a0%d0%98%d0%99-%d0%9c%d0%90%d0%9b%d0%98%d0%9a%d0%9e%d0%92"}, "is_accepted": false, "score": 1, "last_activity_date": 1542542245, "creation_date": 1542542245, "answer_id": 53360601, "question_id": 53360550, "link": "https://stackoverflow.com/questions/53360550/making-a-character-list-from-a-string-in-haskell/53360601#53360601", "title": "Making a character list from a string in Haskell", "body": "<p>Since <code>String</code> is type synonym for <code>[Char]</code>, <code>\"apple\"</code> is already the same as <code>['a','p','p','l','e']</code>.</p>\n\n<p>Not sure what function are you looking for, but <code>id :: String -&gt; [Char]</code> might suffice.</p>\n"}], "owner": {"reputation": 21, "user_id": 4734423, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-H2i6p9Vm_kI/AAAAAAAAAAI/AAAAAAAACeU/zQ2Pe6mg2bM/photo.jpg?sz=128", "display_name": "Attila Fodor", "link": "https://stackoverflow.com/users/4734423/attila-fodor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2043, "favorite_count": 0, "closed_date": 1542542919, "answer_count": 1, "score": -1, "last_activity_date": 1542542245, "creation_date": 1542541944, "question_id": 53360550, "link": "https://stackoverflow.com/questions/53360550/making-a-character-list-from-a-string-in-haskell", "closed_reason": "Duplicate", "title": "Making a character list from a string in Haskell", "body": "<p>I am trying to make from a String to a character list. But i have come up with something but I am stuck. </p>\n\n<pre><code>compress :: String -&gt; [Char]\ncompress x = [map head (group x) !! a : []| a &lt;- [0..length x]]\n</code></pre>\n\n<p>The problem is that this makes almost fine, but when i write \"apple\", it comes with <code>[\"a\",\"p\",\"p\",\"l\",\"e\"]</code> not <code>['a','p','p','l','e']</code> \nand we all know \n<code>\"apple\" /= [\"a\",\"p\",\"p\",\"l\",\"e\"]</code>.</p>\n\n<p>But when i try it at the GHCI, but without making a list, it works fine, like:</p>\n\n<p><code>map head (group \"apple\") !! 0</code> -> <code>'a'</code></p>\n\n<p>But when i try to make a list of these elements, like put every element after each other, it does like this [\"a\",\"p\",\"p\",...]. \nMy question is: Is there a way to make from a String to a list of a character without putting them into \" \"? </p>\n\n<p>Thanks for your help</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1542663159, "post_id": 53360298, "comment_id": 93641797, "body": "FYI: <code>sf=sequence [(1+),(2*),(3-),(4+),(5*)]</code> so <code>sf 2</code> yields <code>[3,4,1,6,10]</code> `sequence is built in, that is, in Prelude."}], "answers": [{"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1542542251, "last_edit_date": 1542542251, "creation_date": 1542541937, "answer_id": 53360549, "question_id": 53360298, "link": "https://stackoverflow.com/questions/53360298/haskell-eta-reduction-using-map-and-for-function-application/53360549#53360549", "title": "Haskell eta reduction using map and $ for function application", "body": "<p>Since you have an applicative list at hand you may simply apply it with the applicative operator <code>&lt;*&gt;</code> as <code>[(+3), (*4), (+1)] &lt;*&gt; [2]</code> to obtain the list of results such as <code>[5,8,3]</code>. Now it's the <code>any :: Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool</code> function that comes handy. So all together</p>\n\n<pre><code>checker x = any (&gt;5) $ [(+3), (*4), (+1)] &lt;*&gt; [x]\n</code></pre>\n\n<p>should do the job. If you need the pointfree version than it would be like</p>\n\n<pre><code>checker = any (&gt;5) . ([(+3), (*4), (+1)] &lt;*&gt;) . pure\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19532, "user_id": 570689, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4eed5285039322bafbeee9102367b0a4?s=128&d=identicon&r=PG", "display_name": "\u0414\u041c\u0418\u0422\u0420\u0418\u0419 \u041c\u0410\u041b\u0418\u041a\u041e\u0412", "link": "https://stackoverflow.com/users/570689/%d0%94%d0%9c%d0%98%d0%a2%d0%a0%d0%98%d0%99-%d0%9c%d0%90%d0%9b%d0%98%d0%9a%d0%9e%d0%92"}, "is_accepted": false, "score": 1, "last_activity_date": 1542546994, "last_edit_date": 1542546994, "creation_date": 1542542035, "answer_id": 53360566, "question_id": 53360298, "link": "https://stackoverflow.com/questions/53360298/haskell-eta-reduction-using-map-and-for-function-application/53360566#53360566", "title": "Haskell eta reduction using map and $ for function application", "body": "<p>Starting with a fully non-reduced definition:</p>\n\n<pre><code>foo ls v = any (&gt;5) (map (\\f -&gt; f v) ls)\n</code></pre>\n\n<p>We can use lambdabot to have a fully eta-reduced solution:</p>\n\n<pre><code>foo = (any (&gt; 5) .) . flip (map . flip id)\n</code></pre>\n\n<p>However, this looks awful, and should not be recommended to do.</p>\n"}, {"comments": [{"owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "edited": false, "score": 1, "creation_date": 1542555651, "post_id": 53360618, "comment_id": 93601804, "body": "&quot;<i>Don&#39;t do it. Exercise restraint. Write code that&#39;s easy to read and modify.</i>&quot; This is an amazing lesson."}], "tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 3, "last_activity_date": 1542542341, "creation_date": 1542542341, "answer_id": 53360618, "question_id": 53360298, "link": "https://stackoverflow.com/questions/53360298/haskell-eta-reduction-using-map-and-for-function-application/53360618#53360618", "title": "Haskell eta reduction using map and $ for function application", "body": "<p>Is there a way?  Sure.  Is it readable?  No.  Haskell's design pushes you away from some common mistakes, like unnecessary mutability or hidden use of (necessary) mutable state.  But it makes it exciting to follow the path of other mistakes, like making code point-free in a manner harmful to readability and maintainability.</p>\n\n<p>The thing about point-free definitions is that converting to them is a completely mechanical process (so long as pattern matching isn't involved in the starting definition).  There are tools to do it automatically.</p>\n\n<p>Start by writing the definition fully eta-expanded:</p>\n\n<pre><code>foo ls x = any (&gt;5) (map ($ x) ls)\n</code></pre>\n\n<p>Then throw it into your favorite tool for doing the conversion.  <a href=\"http://pointfree.io/\" rel=\"nofollow noreferrer\">http://pointfree.io/</a> is an online service that will do it.</p>\n\n<p>And it spits out the totally unreadable:</p>\n\n<pre><code>foo = (any (&gt; 5) .) . flip (map . flip id)\n</code></pre>\n\n<p>Don't use that.  It's not worth it.</p>\n\n<p>But maybe you only wanted to eta-contract away one argument, and this is too much?  Well, you can do that by cheating a little bit, and pretending the first argument is a value in scope, not an argument, and throwing the following definition in:</p>\n\n<pre><code>foo x = any (&gt;5) (map ($ x) ls)\n</code></pre>\n\n<p>It returns <code>foo = any (&gt; 5) . flip map ls . flip id</code>, which you then insert the argument back into:</p>\n\n<pre><code>foo ls = any (&gt; 5) . flip map ls . flip id\n</code></pre>\n\n<p>This is mildly better, thanks to lacking sections of the <code>(.)</code> operator.  But it still has <code>flip id</code> in it, which is obfuscation at its simplest.</p>\n\n<p>Don't do it.  Exercise restraint.  Write code that's easy to read and modify.</p>\n"}, {"tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": true, "score": 1, "last_activity_date": 1542548157, "creation_date": 1542548157, "answer_id": 53361457, "question_id": 53360298, "link": "https://stackoverflow.com/questions/53360298/haskell-eta-reduction-using-map-and-for-function-application/53361457#53361457", "title": "Haskell eta reduction using map and $ for function application", "body": "<p>Actually, your last trial in the question</p>\n\n<pre><code>foo ls = any (&gt;5) . flip map ls ($)\n</code></pre>\n\n<p>is already very close to solution. </p>\n\n<p>The only one problem is, considers the definition of <code>($)</code>:</p>\n\n<pre><code>($)::(a -&gt; b) -&gt; a -&gt; b\n</code></pre>\n\n<p>the first argument of <code>($)</code> is a function <code>(a-&gt;b)</code>, but in your case, need be a value <code>a</code>, so just <code>flip ($)</code> swap the order of the arguments of <code>($)</code> and put it back as:</p>\n\n<pre><code>foo ls = any (&gt;5) . flip map ls . flip ($)\n</code></pre>\n\n<p>is the function that you want.</p>\n"}], "owner": {"reputation": 47, "user_id": 10670081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Bfw5eoJHVvI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hsTerW1A1RCkK9f3bGBGsnQhqtAw/mo/photo.jpg?sz=128", "display_name": "maro", "link": "https://stackoverflow.com/users/10670081/maro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 53361457, "answer_count": 4, "score": 0, "last_activity_date": 1542548157, "creation_date": 1542540248, "question_id": 53360298, "link": "https://stackoverflow.com/questions/53360298/haskell-eta-reduction-using-map-and-for-function-application", "title": "Haskell eta reduction using map and $ for function application", "body": "<p>Hi I have task for writing a function that takes a list of functions from <code>Int -&gt; Int</code> and a single <code>Int</code> and checks if any function when applied to that <code>Int</code> gives a result which is greater than 5.</p>\n\n<p>This is my solution :</p>\n\n<pre><code>foo :: [Int -&gt; Int] -&gt; Int -&gt; Bool\nfoo ls = any (&gt;5) . f ls\n     where f ls v = map ($ v) ls\n</code></pre>\n\n<p>I would like to know is there a way to write this in single line (without using where or let) with eta reducing last argument (now it is eta reduced but it is not in single line). I tried something like this :</p>\n\n<pre><code>foo ls = any (&gt;5) . flip map ls\n</code></pre>\n\n<p>But now the problem is call of function that looks like this for it to work</p>\n\n<pre><code>foo [(+3), (*4), (+1)] ($2)\n</code></pre>\n\n<p>I would like to avoid writin $ for last argument. I tried something like this (and similar to this) : </p>\n\n<pre><code>foo ls = any (&gt;5) . flip map ls ($)\n</code></pre>\n\n<p>But I always get some kind of error. Be aware that I must not change the type signature, thus the flip.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 6, "creation_date": 1542502344, "post_id": 53356886, "comment_id": 93591521, "body": "This is simply wrong. <code>fmap</code> is not defined in the applicative typeclass."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 3, "creation_date": 1542531874, "post_id": 53356886, "comment_id": 93595486, "body": "the second signature you&#39;re showing is for the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-60--42--62-\" rel=\"nofollow noreferrer\"><code>(&lt;*&gt;)</code> method</a> from the Applicative typeclass. not for <code>fmap</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1603, "user_id": 225292, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/139dd92ae95a2075a124e552c1299d54?s=128&d=identicon&r=PG", "display_name": "paul", "link": "https://stackoverflow.com/users/225292/paul"}, "is_accepted": false, "score": 3, "last_activity_date": 1542502771, "creation_date": 1542502771, "answer_id": 53356980, "question_id": 53356886, "link": "https://stackoverflow.com/questions/53356886/try-to-understand-applicative-in-haskell/53356980#53356980", "title": "Try to understand Applicative in Haskell", "body": "<p>I think the definitions you're working with are a little off (maybe the source is wrong, or maybe you misinterpreted them) and that's the source of your confusion.</p>\n\n<p>As @AJFarmar mentions in the comments, <code>fmap</code> is part of the <code>Functor</code> typeclass (or Interface in Java terms); the definition of <code>Applicative</code> says that whenever you try to make an <code>Applicative</code> instance (i.e. implement the <code>Applicative</code> interface) then the type you're trying to make the instance for <em>also</em> has to be an instance of <code>Functor</code> (it also has to implement the <code>Functor</code> interface). So the signature of <code>fmap</code> will always be:</p>\n\n<pre><code>fmap :: (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": false, "score": 4, "last_activity_date": 1542533592, "last_edit_date": 1542533592, "creation_date": 1542533270, "answer_id": 53359443, "question_id": 53356886, "link": "https://stackoverflow.com/questions/53356886/try-to-understand-applicative-in-haskell/53359443#53359443", "title": "Try to understand Applicative in Haskell", "body": "<p>Please refers the document of <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Applicative.html#t:Applicative\" rel=\"nofollow noreferrer\">Control.Applicative</a>. The type signature of</p>\n\n<pre><code>(&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>is sequential application operator <code>&lt;*&gt;</code> not <code>fmap</code>.</p>\n\n<blockquote>\n  <p>I assume fmap is like an interface for Functor (in Java world) If\n  Applicative subclasses from Functor then it needs implement fmap from\n  Functor</p>\n</blockquote>\n\n<p>Actually, <code>Applicative</code> is also like an interface in Java world, more exact, like an interface with <a href=\"https://docs.oracle.com/javase/tutorial/java/IandI/defaultmethods.html\" rel=\"nofollow noreferrer\">default methods</a> introduced since Java 8. In Java syntax like:</p>\n\n<pre><code>public interface Applicative extends Functor {..}\n</code></pre>\n\n<p>Notes that the definition of <code>Applicative</code> in Java here is not a concrete class, it need <strong>not</strong> to implement <code>fmap</code> from <code>Functor</code> interface.</p>\n"}, {"tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": false, "score": 5, "last_activity_date": 1542534885, "creation_date": 1542534885, "answer_id": 53359639, "question_id": 53356886, "link": "https://stackoverflow.com/questions/53356886/try-to-understand-applicative-in-haskell/53359639#53359639", "title": "Try to understand Applicative in Haskell", "body": "<p>Firstly, as @paul mentioned, the definitions you're working from are a bit off. The correct definitions would be the following:</p>\n\n<pre><code>class Functor f where\n    fmap :: (a -&gt; b) -&gt; f a -&gt; f b\n\nclass Functor f =&gt; Applicative f where\n    pure :: a -&gt; f a\n    (&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>So how should these definitions be decoded? The main thing to realise here is that Haskell typeclasses have more in common with Java interfaces than Java classes - so the <code>Applicative</code> definition here is not defining a subclass in the Java sense, but specifying that a type can only be an instance of <code>Applicative</code> if it is already an instance of <code>Functor</code> (i.e. all <code>Applicative</code>s must also implement <code>fmap</code>, even though it is not part of the <code>Applicative</code> typeclass). For more info on <code>Functor</code> and <code>Applicative</code>, I can highly recommend the online book <a href=\"http://learnyouahaskell.com/\" rel=\"noreferrer\">Learn You a Haskell for Great Good</a>, particularly the <a href=\"http://learnyouahaskell.com/functors-applicative-functors-and-monoids\" rel=\"noreferrer\">section on 'Functors, Applicative and Monoid'</a>.</p>\n"}], "owner": {"reputation": 483, "user_id": 8953741, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/118643528911159/picture?type=large", "display_name": "Aron Lee", "link": "https://stackoverflow.com/users/8953741/aron-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1542589974, "creation_date": 1542501495, "last_edit_date": 1542589974, "question_id": 53356886, "link": "https://stackoverflow.com/questions/53356886/try-to-understand-applicative-in-haskell", "title": "Try to understand Applicative in Haskell", "body": "<pre><code>class Functor f where\n    fmap :: (a -&gt; b) -&gt; f a -&gt; f b\n\nclass (Functor f) =&gt; Applicative f where\n    pure a = f a\n    &lt;*&gt; :: f (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>I try to understand <strong>Applicative</strong> in Haskell\nFrom the definition of <strong>Applicative</strong>, it looks like the subclass of <strong>Functor</strong></p>\n\n<p>I assume fmap is like an interface for Functor (in Java world)\nIf <strong>Applicative</strong> subclasses from Functor then it needs implement fmap from Functor, but fmap in <strong>Functor</strong> and <strong>Applicative</strong> are different in signature</p>\n\n<pre><code>(a -&gt; b) -&gt; f a -&gt; f b\nf (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>Can anyone explain why?</p>\n"}, {"tags": ["haskell", "newtype"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1542495474, "post_id": 53356324, "comment_id": 93590271, "body": "Related: <a href=\"https://stackoverflow.com/q/53188123/67579\">stackoverflow.com/q/53188123/67579</a>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1542496180, "post_id": 53356324, "comment_id": 93590443, "body": "Yes, a type has to have both <code>Real</code> and <code>Enum</code> instances before you can declare an instance for <code>Integral</code>. That&#39;s what <code>(Real a, Enum a) =&gt; Integral a</code> means in the class definition."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1542498099, "post_id": 53356324, "comment_id": 93590852, "body": "If you only need <code>div</code>, you probably shouldn&#39;t declare any instance at all. Just define a custom div-like function and use that."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1542506974, "post_id": 53356324, "comment_id": 93592096, "body": "In cases like this, there is no need to edit a &quot;solved&quot; note into your question. Instead, leave a comment saying the suggested question solves the problem, so that the rest of us know it is okay to close it as a duplicate. (Also, if someone casts a duplicate vote and it doesn&#39;t close the question immediately, an option will show up for you to confirm the duplicate.)"}], "owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "closed_date": 1542506728, "answer_count": 0, "score": 0, "last_activity_date": 1542506750, "creation_date": 1542495288, "last_edit_date": 1542506750, "question_id": 53356324, "link": "https://stackoverflow.com/questions/53356324/making-newtype-instance-of-integral-class-in-haskell", "closed_reason": "Duplicate", "title": "Making newtype instance of Integral class in haskell", "body": "<p>I want to make my newtype instance of Integral class. \nMy newtype: </p>\n\n<pre><code>newtype NT = NT Integer deriving (Eq,Ord,Show)\n</code></pre>\n\n<p>I want to be able to do <code>div</code> with my <code>newtype NT</code>:</p>\n\n<pre><code>Prelude&gt; (NT 5) `div` (NT 2)\n2\n</code></pre>\n\n<p>Since:</p>\n\n<pre><code>Prelude&gt; :t div\ndiv :: Integral a =&gt; a -&gt; a -&gt; a \n</code></pre>\n\n<p>I should make my <code>NT</code> instance of <code>Integral</code> class.</p>\n\n<p>This is how is <code>Integral</code> class defined:</p>\n\n<pre><code>class  (Real a, Enum a) =&gt; Integral a  where\n    quot, rem        :: a -&gt; a -&gt; a   \n    div, mod         :: a -&gt; a -&gt; a\n    quotRem, divMod  :: a -&gt; a -&gt; (a,a)\n    toInteger        :: a -&gt; Integer\n</code></pre>\n\n<p>and Since I need only <code>div</code> I tried: </p>\n\n<pre><code>instance Integral NT where\n  (NT x) `div` (NT y) =  (NT q)  where (q,r) = divMod x y\n</code></pre>\n\n<p>or can I do this? </p>\n\n<pre><code>instance Integral NT where\n  div (NT x)  (NT y) =  NT (div x y )\n</code></pre>\n\n<p>but either way I get the error:</p>\n\n<pre><code>\u2022 No instance for (Real NT)\n  arising from the superclasses of an instance declaration\n\u2022 In the instance declaration for \u2018Integral NT\u2019\n</code></pre>\n\n<p>Should I make <code>NT</code> instance of <code>Real</code> class First and how?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1542482962, "post_id": 53354668, "comment_id": 93587037, "body": "Are you really using plain GHC or are you building a project with cabal? Double check you&#39;ve installed http-conduit. Can you also import modules for http-client (<code>Network.HTTP.Client</code>)?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1542483137, "post_id": 53354668, "comment_id": 93587097, "body": "Using hoogle <a href=\"https://www.stackage.org/lts-12.18/hoogle?q=simpleHTTP\" rel=\"nofollow noreferrer\">stackage.org/lts-12.18/hoogle?q=simpleHTTP</a> you can see that <code>simpleHTTP</code> comes from the HTTP library, whereas http-conduit exports <code>simpleHttp</code>, which has a different case."}, {"owner": {"reputation": 61, "user_id": 6875866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00b6f992dedfbcf4357dccbed08c52a2?s=128&d=identicon&r=PG&f=1", "display_name": "Dick Chany", "link": "https://stackoverflow.com/users/6875866/dick-chany"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1542485838, "post_id": 53354668, "comment_id": 93587908, "body": "It won&#39;t import Network.HTTP.Client either.  I want to use the simpleHttp which conduit exports"}, {"owner": {"reputation": 61, "user_id": 6875866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00b6f992dedfbcf4357dccbed08c52a2?s=128&d=identicon&r=PG&f=1", "display_name": "Dick Chany", "link": "https://stackoverflow.com/users/6875866/dick-chany"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1542485856, "post_id": 53354668, "comment_id": 93587915, "body": "I am using plain ghc."}, {"owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "edited": false, "score": 0, "creation_date": 1542502946, "post_id": 53354668, "comment_id": 93591591, "body": "Try <code>ghc -v -package HTTP SOURCE.hs</code>. Your package paths should be listed."}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1542534082, "post_id": 53354668, "comment_id": 93595960, "body": "Actually, <a href=\"http://hackage.haskell.org/package/http-conduit-2.3.2/docs/src/Network.HTTP.Conduit.html#simpleHttp\" rel=\"nofollow noreferrer\">simpleHttp</a> is defined in Network.HTTP.Conduit. It seems the conduit package has not yet installed properly or GHC cannot find it."}], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 1, "last_activity_date": 1542555399, "creation_date": 1542555399, "answer_id": 53362574, "question_id": 53354668, "link": "https://stackoverflow.com/questions/53354668/which-library-is-the-simplehttp-function-in/53362574#53362574", "title": "Which library is the simpleHTTP function in?", "body": "<p>It's using a different approach (Stack as a script interpreter), but most likely the following command will run the script with the necessary libraries available:</p>\n\n<pre><code>stack --resolver lts-12.9 script testRun.hs\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6875866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00b6f992dedfbcf4357dccbed08c52a2?s=128&d=identicon&r=PG&f=1", "display_name": "Dick Chany", "link": "https://stackoverflow.com/users/6875866/dick-chany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 53362574, "answer_count": 1, "score": -1, "last_activity_date": 1570863014, "creation_date": 1542482314, "last_edit_date": 1570863014, "question_id": 53354668, "link": "https://stackoverflow.com/questions/53354668/which-library-is-the-simplehttp-function-in", "title": "Which library is the simpleHTTP function in?", "body": "<p>I have installed using cabal install network, HTTP, http-conduit, and http-client.  When I run ghc it still throws this error:</p>\n\n<pre><code>testRun.hs:1:1: error:\n    Could not find module `Network.HTTP.Simple'\n    Perhaps you meant\n      Network.HTTP.Base (from HTTP-4000.3.12)\n      Network.HTTP.Cookie (from HTTP-4000.3.12)\n      Network.HTTP.Stream (from HTTP-4000.3.12)\n    Use -v to see a list of the files searched for.\n  |\n1 | import Network.HTTP.Simple\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>or this error if I use Conduit:</p>\n\n<pre><code>testRun.hs:1:1: error:\n    Could not find module `Network.HTTP.Conduit'\n    Perhaps you meant Network.HTTP.Cookie (from HTTP-4000.3.12)\n    Use -v to see a list of the files searched for.\n  |\n1 | import Network.HTTP.Conduit (simpleHttp)\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>What do in need to install?</p>\n"}, {"tags": ["haskell", "recursion", "pushdown-automaton"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 5991230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1008629592543534/picture?type=large", "display_name": "Roman Proch&#225;zka Jr.", "link": "https://stackoverflow.com/users/5991230/roman-proch%c3%a1zka-jr"}, "edited": false, "score": 0, "creation_date": 1542482183, "post_id": 53354565, "comment_id": 93586804, "body": "Thanks a lot Willem, you don&#39;t even know for how long I was stuck. Can I just check with you if this logic will work if I properly work with the stack?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 121, "user_id": 5991230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1008629592543534/picture?type=large", "display_name": "Roman Proch&#225;zka Jr.", "link": "https://stackoverflow.com/users/5991230/roman-proch%c3%a1zka-jr"}, "edited": false, "score": 0, "creation_date": 1542482569, "post_id": 53354565, "comment_id": 93586906, "body": "@RomanProch&#225;zkaJr.: well given you generate the list of <code>runs</code> correctly (which is here a bit cryptical), it should work. But it is possible there is still something not working in <code>runs</code>. For example the <code>a == cs</code>, etc. is a bit &quot;cryptical&quot;."}, {"owner": {"reputation": 121, "user_id": 5991230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1008629592543534/picture?type=large", "display_name": "Roman Proch&#225;zka Jr.", "link": "https://stackoverflow.com/users/5991230/roman-proch%c3%a1zka-jr"}, "edited": false, "score": 0, "creation_date": 1542484175, "post_id": 53354565, "comment_id": 93587405, "body": "Would there be a better way of doing this you can recommend?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 121, "user_id": 5991230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1008629592543534/picture?type=large", "display_name": "Roman Proch&#225;zka Jr.", "link": "https://stackoverflow.com/users/5991230/roman-proch%c3%a1zka-jr"}, "edited": false, "score": 0, "creation_date": 1542484307, "post_id": 53354565, "comment_id": 93587439, "body": "@RomanProch&#225;zkaJr.: it might be worth using record syntax, such that it is more explicit what attributes you use and how. <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#record-syntax\" rel=\"nofollow noreferrer\">learnyouahaskell.com/&hellip;</a>"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1542481644, "creation_date": 1542481644, "answer_id": 53354565, "question_id": 53354433, "link": "https://stackoverflow.com/questions/53354433/accepting-rejecting-pushdown-automata-in-haskell/53354565#53354565", "title": "accepting/rejecting Pushdown automata in haskell", "body": "<p>The problem is that in the recursive clause:</p>\n\n<pre><code>runs :: PDA -&gt; Configuration -&gt; [Result]\n-- ...\nruns z@(ss,fs,tt) (cs,(x:xs),st) = [<b>runs z (d,xs,e)</b> | ... ]</code></pre>\n\n<p>You violate a type contract. Indeed <code>runs</code> is supposed to return a list of <code>Result</code>s. But here in your expression you construct a list of outcomes of <code>runs</code> (well a list of <code>runs z (d, xs, e)</code>, this thus means that this list comprehension is constructing a list of list of <code>Results</code>, not a list of results.</p>\n\n<p>We thus need to \"concatenate\" these sublists into one flat list, for example with <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:concat\" rel=\"nofollow noreferrer\"><strong><code>concat :: [[a]] -&gt; [a]</code></strong></a>, with:</p>\n\n<pre><code>runs :: PDA -&gt; Configuration -&gt; [Result]\n-- When string and stack empty accept\nruns _ (_,[],[]) = [Accept]\n-- If string empty and stack not empty, reject\nruns _ (_,[],_) = [Reject]\nruns z@(ss,fs,tt) (cs,(x:xs),st) = <b>concat</b> [runs z (d,xs,e) | m@((a,b,c),(d,e)) &lt;- [xf | xf@((a,b,c),(d,e)) &lt;- tt, a == cs, b == [x]]]</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 5991230, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1008629592543534/picture?type=large", "display_name": "Roman Proch&#225;zka Jr.", "link": "https://stackoverflow.com/users/5991230/roman-proch%c3%a1zka-jr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "accepted_answer_id": 53354565, "answer_count": 1, "score": 2, "last_activity_date": 1542494094, "creation_date": 1542480603, "last_edit_date": 1542494094, "question_id": 53354433, "link": "https://stackoverflow.com/questions/53354433/accepting-rejecting-pushdown-automata-in-haskell", "title": "accepting/rejecting Pushdown automata in haskell", "body": "<p>I am trying to create a Pushdown Automata checking in Haskell. Basically, a function which takes <code>(start_state, final_state, set_of_rules) and a string</code>. It should return <code>Accepted</code> if the string is accepted by this PDA and <code>Rejected</code> otherwise.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>type Transition = ((Int,String,String),(Int,String))\n\ntype Configuration = (Int,String,String)\n\ntype PDA = (Int,[Int],[Transition])\n\ndata Result = Accept | Reject | Jj deriving Show\n\nrun :: PDA -&gt; String -&gt; [Result]\nrun (ss,fs,tr) xs = runs (ss,fs,tr) (ss,xs,\"\")\n\nruns :: PDA -&gt; Configuration -&gt; [Result]\n-- When string and stack empty accept\nruns _ (_,[],[]) = [Accept]\n-- If string empty and stack not empty, reject\nruns _ (_,[],_) = [Reject]\nruns z@(ss,fs,tt) (cs,(x:xs),st) = [runs z (d,xs,e) | m@((a,b,c),(d,e)) &lt;- [xf | xf@((a,b,c),(d,e)) &lt;- tt, a == cs, b == [x]]]\n</code></pre>\n\n<p>The very last line is where my logic breaks I'd like to explain it a bit:</p>\n\n<pre><code>[xf | xf@((a,b,c),(d,e)) &lt;- tt, a == cs, b == [x]]\n</code></pre>\n\n<p>This takes a set of rules (tt) and lists all rules I could possibly use where the current state (cs) and head of my string match. This works perfectly and lists all possible moves. I'd like to take every element of this list and run it through this function again. When I reach my base case I return Accept or Reject based on the stack state.</p>\n\n<p>What I am expecting to see is a list full of <code>Reject</code> because I am not actually working with the stack yet.</p>\n\n<p>I keep getting <code>Couldn't match type \u2018[Result]\u2019 with \u2018Result\u2019</code> compile error all the time and I just can't fix it. Any help is really appreciated</p>\n"}, {"tags": ["haskell", "overloading", "typeclass"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1542470815, "post_id": 53352899, "comment_id": 93583516, "body": "<code>| else = n * f (n-1) where else = True</code> looks like a syntax error to me."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1542470981, "post_id": 53352899, "comment_id": 93583558, "body": "Why is there a type class here?  That makes no sense."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542471007, "post_id": 53352899, "comment_id": 93583563, "body": "please run <code>:set +t</code> command in your GHCi, then repeat all commands and show us the types it reports together with the values it produces."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542471066, "post_id": 53352899, "comment_id": 93583577, "body": "@WillNess I&#39;m pretty sure this isn&#39;t in ghci.  &quot;unresolved overloading&quot; isn&#39;t a ghc error message."}, {"owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1542471089, "post_id": 53352899, "comment_id": 93583585, "body": "@melpomene edited"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1542471175, "post_id": 53352899, "comment_id": 93583608, "body": "@Carl ah, thanks. I thought maybe they edited the responses. if so, could the OP please specify the environment they are running this in? Maybe include a link to live code at tio.run or something?"}, {"owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542471534, "post_id": 53352899, "comment_id": 93583702, "body": "@WillNess thanks for the hint. I was testing this in GHCi and my university uses Hugs. I tested it now on hugs and it indeed gives  Unresolved overloading error, should I delete my question now or just post an answer?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1542471569, "post_id": 53352899, "comment_id": 93583714, "body": "@Carl the assignment doesn&#39;t seem to specify exact error messages as produced by ghci. Why would it? &quot;Non regular termination&quot; isn&#39;t an exact ghci error message either and it&#39;s OK. The objective seems to be to produce a message that would indicate unresolved overloading."}, {"owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1542471687, "post_id": 53352899, "comment_id": 93583753, "body": "@n.m. my University uses Hugs to compile our code so my code should work as intended"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542472704, "post_id": 53352899, "comment_id": 93584026, "body": "so do you have a question? I have a question: what version GHCi were you using? :) it seems mighty polymorphic, <a href=\"https://tio.run/##VY0xD4IwEIX3/oo3OICRRAYXkrIYBxcc5A9c8AzEUrGFNCT@99oSQ/SWl3v3vXct2Qcr5X2jyFokpxdoh4u5Rbm2Txe1mnpQClmiYlfPAx8XmOBaNiyAO4oirFkJEqLTdiTd8D981uOKx4BeFHhDQ0rsIZGvFivLjmYbTI1toBOd5Sm@9zhL1S9Xm4mF6KkLdRhMF95tQvDg/Qc\" rel=\"nofollow noreferrer\">tio</a> can&#39;t run your code."}, {"owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542472858, "post_id": 53352899, "comment_id": 93584080, "body": "@Will Ness I don&#39;t have a question I think it is clear to me now, thanks! I am using version 8.4.3"}], "answers": [{"tags": [], "owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "is_accepted": true, "score": 0, "last_activity_date": 1542472933, "last_edit_date": 1542472933, "creation_date": 1542472617, "answer_id": 53353242, "question_id": 53352899, "link": "https://stackoverflow.com/questions/53352899/functions-overloading/53353242#53353242", "title": "Functions Overloading", "body": "<p>Calling <code>f 5</code> does give <strong>Uresloved Overloading ERROR</strong> in Hugs but in GHCi it doesn't.We can see</p>\n\n<pre><code>*Main&gt; :set +t\n*Main&gt; f 5 \n120\nit :: NewTypeClass a =&gt; a\n</code></pre>\n\n<p>here that it is indeed overloaded</p>\n"}], "owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 53353242, "answer_count": 1, "score": 1, "last_activity_date": 1542472933, "creation_date": 1542470336, "last_edit_date": 1542472482, "question_id": 53352899, "link": "https://stackoverflow.com/questions/53352899/functions-overloading", "title": "Functions Overloading", "body": "<p>I am working on my assignment for Funtional Programming. </p>\n\n<p>Task:</p>\n\n<blockquote>\n  <p>We introduce the typeclass  <strong>NewTypeClass</strong> \u200b\u200bin order to change the\n  behavior of the function <strong>f</strong> by overloading function f for different\n  types.</p>\n</blockquote>\n\n<p>Given are:</p>\n\n<pre><code>class (Eq a, Ord a, Show a, Num a) =&gt; NewTypeClass a where\n  f :: a -&gt; a\n</code></pre>\n\n<p>where <code>f</code> is a factorial function: </p>\n\n<pre><code>f n\n  | n == 0 = 1\n  | elseways = n * f (n-1) \nwhere elseways = True\n</code></pre>\n\n<p>One of the types is Int. I have to make type Int Instance of the Typeclass NewTypeClass so that if I give argument the function f returns result like this:</p>\n\n<pre><code>f   5         -&gt;&gt;             Error: Unresolved overloading\nf ( 5 :: Int) -&gt;&gt;             120\nf (-5 :: Int) -&gt;&gt; ... -&gt;&gt; ... Non regular termination.\n</code></pre>\n\n<p>What I have done:</p>\n\n<pre><code>instance NewTypeClass Int where\n    f n\n      | n == 0 = 1\n      | elseways = n * f (n-1) \n    where elseways = True\n</code></pre>\n\n<p>My outputs: </p>\n\n<pre><code>*Main&gt; f 5\n120\n\n*Main&gt; f (5::Int)\n120\n\n*Main&gt; f (-5 :: Int)\n*** Exception: stack overflow\n</code></pre>\n\n<p>Since when I call <code>f 5</code> get back the result <code>120</code> that means that I did not overload the function <code>f</code> properly. Did I not understand something properly or am I making a mistake somewhere in my code?</p>\n\n<p>Edit:</p>\n\n<pre><code>*Main&gt; :set +t\n*Main&gt; f 5 \n120\nit :: NewTypeClass a =&gt; a\n*Main&gt; f (5::Int)\n120\nit :: Int\n*Main&gt; f (-5 :: Int)\n*** Exception: stack overflow\n</code></pre>\n"}, {"tags": ["list", "haskell", "merge", "compiler-errors"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1542469338, "post_id": 53352740, "comment_id": 93583085, "body": "<code>(++)</code> is not inefficient in the sense that it works in linear time. The idea is that <code>(++)</code> however is sometimes &quot;misused&quot; to append a single element to a list turning the algorithm in <i>O(n^2)</i> instead of <i>O(n)</i>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1542469628, "post_id": 53352740, "comment_id": 93583170, "body": "correctness first, efficiency later. really. -- so are you merging two sorted lists, and the merged list must be sorted as well? if not, there&#39;s absolutely nothing wrong with one-time <code>++</code>. the answer you cite talks about <i>repeated</i> appending of <i>one-element</i> lists with <code>++ [x]</code> being &quot;bad&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10641593"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542470115, "post_id": 53352740, "comment_id": 93583313, "body": "@WillNess - The merged list doesn&#39;t have to be sorted. I&#39;m taking small steps, so for now the mission is to merge the two lists. I&#39;ll <code>sort</code> them later when I understand <code>List</code> in Haskell better."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542470146, "post_id": 53352740, "comment_id": 93583322, "body": "then <code>++</code> does the job. do you want to re-implement it, as an exercise? is your question about that ,or about the error you got?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10641593"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542470310, "post_id": 53352740, "comment_id": 93583371, "body": "@WillNess - No, not right now. I was just wondering about the answer I cited, it said using <code>++</code> was inefficient, so it made me wonder what I sould do instead, the answer also stated to add it to the head of the list and reverse it, which I attempted, but received an error. But as you pointed out, <code>++</code> is fine here."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1542470494, "post_id": 53352740, "comment_id": 93583425, "body": "Hey, that&#39;s my answer. I never said <code>++</code> was inefficient."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10641593"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1542470769, "post_id": 53352740, "comment_id": 93583499, "body": "@melpomene - I probably misinterpreted what you stated. I way I read it was using <code>++</code> to merge one and only one element was fine, but when the lists are huge using <code>++</code> would be inefficient because of the copying."}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 4, "last_activity_date": 1542470495, "creation_date": 1542470495, "answer_id": 53352926, "question_id": 53352740, "link": "https://stackoverflow.com/questions/53352740/efficiently-merge-two-lists/53352926#53352926", "title": "Efficiently merge two lists", "body": "<p>There's absolutely nothing wrong with appending two lists with <em>one-time</em> <code>++</code>, however long they are. </p>\n\n<p>The answer you cite, (rightfully) talks about <em>repeated</em> appending of <em>one-element</em> lists with <code>++ [x]</code> being \"bad\".</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542471959, "post_id": 53352985, "comment_id": 93583829, "body": "where does it say in the Report that lists are &quot;singly linked&quot;? I couldn&#39;t find anything like that there. The complexity of <code>++</code> seems not to be specified either."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542472230, "post_id": 53352985, "comment_id": 93583905, "body": "@WillNess: conceptually it is a sinly linked list, since there is no direct link in the data definition to the &quot;parent&quot;. Furthermore that would also be strange, since one can reuse the tail, so there is no &quot;previous&quot;. The time complexity follows from the implementation in the Haskell report on the standard prelude:  <a href=\"https://www.haskell.org/onlinereport/standard-prelude.html\" rel=\"nofollow noreferrer\">haskell.org/onlinereport/standard-prelude.html</a>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542472403, "post_id": 53352985, "comment_id": 93583948, "body": "conceptually it could just as well be implemented on arrays with O(1) append. the implementation gives value semantics for the types / functions, not operational semantics / performance."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542472493, "post_id": 53352985, "comment_id": 93583970, "body": "@WillNess: indeed, and then it is still <i>O(n)</i>, <i>O(n!)</i>,... Somehow this discussions feels a bit like the one I had with some friends about the first chapter of &quot;<i>Computational Complexity</i>&quot;: &quot;Why the computational model does not matter&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10641593"}, "edited": false, "score": 0, "creation_date": 1542496862, "post_id": 53352985, "comment_id": 93590611, "body": "I really like this answer, but could you provide example code of <i>append n elements that way to a list</i>? It will help understand better of what <b>not</b> to do."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1542497502, "last_edit_date": 1542497502, "creation_date": 1542470900, "answer_id": 53352985, "question_id": 53352740, "link": "https://stackoverflow.com/questions/53352740/efficiently-merge-two-lists/53352985#53352985", "title": "Efficiently merge two lists", "body": "<blockquote>\n  <p>According to the <a href=\"https://wiki.haskell.org/How_to_work_on_lists\" rel=\"nofollow noreferrer\">HaskellWiki</a>, if I wanted to merge two lists together,\n  I would write:</p>\n\n<pre><code>list1 ++ list2 \n</code></pre>\n  \n  <p>However, according to <a href=\"https://stackoverflow.com/questions/53123008/correct-way-to-add-an-element-to-the-end-of-a-list/53123141#53123141\">this answer</a>, using <code>++</code> on a large list would be\n  inefficient.</p>\n</blockquote>\n\n<p>I think you need to take the context into account in this answer. If we append two lists <code>a</code> and <code>b</code> with <code>(++)</code> then it appends the two lists in <em>O(m)</em> (with <em>m</em> the length of the list). So this is, in terms of time complexity efficient. One can not construct such singly linked list more efficient than that.</p>\n\n<p><a href=\"https://stackoverflow.com/a/53123141/67579\">@melpomene</a> actually points to a popular mistake people new to Haskell make: they append a <em>single</em> element at the end of the list. Again if you only want to append a <em>single</em> element to the list, that is not a problem. This is a problem if you want to append <em>n</em> elements that way to a list, so if you each time append a single element to the list, and you do that <em>n</em> times, then the algorithm will be <em>O(n<sup>2</sup>)</em>.</p>\n\n<p>So in short, from a time complexity point of view, <code>(++)</code> is not slow when you append two lists together, nor is it slow when you append a singleton list to it. There are however, in terms of asymptotic behavior, usually better ways than repeatedly appending a list with one element to a list, since then the first operand will typically become larger, and each iteration it takes <em>O(n)</em> time only to append a single element to a list. Typically one can use recursion on the tail element of a list in that case, or for example build the list in reverse.</p>\n\n<p><code>(++)</code> is thus not \"intrinsically\" inefficient, by by using it in ways for which it was not design, you can obtain inefficient behavior.</p>\n\n<p>An example where <code>++</code> will be quite slow is the following function that performs a \"mapping\":</p>\n\n<pre><code>badmap :: (a -&gt; b) -&gt; [a] -&gt; [b]\nbadmap f = go []\n    where go temp [] = temp\n          go temp (x:xs) = go (temp ++ [f x]) xs\n</code></pre>\n\n<p>There are two problems here:</p>\n\n<ol>\n<li>it is not lazy, it requires to evaluate the entire list before this can emit the first element; and</li>\n<li>it will run in quadratic time, since for each element in the input list, it will take more and more time to append this element.</li>\n</ol>\n\n<p>A more effective way to implement a map is:</p>\n\n<pre><code>goodmap :: (a -&gt; b) -&gt; [a] -&gt; [b]\ngoodmap f = go\n    where go (x:xs) = f x : go xs\n          go [] = []\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": false, "score": 0, "last_activity_date": 1542984547, "creation_date": 1542984547, "answer_id": 53448801, "question_id": 53352740, "link": "https://stackoverflow.com/questions/53352740/efficiently-merge-two-lists/53448801#53448801", "title": "Efficiently merge two lists", "body": "<p>If you would like to efficiently append arbitrary lists, use a different data structure! Data.Seq is optimized for efficient appends, for example.</p>\n\n<p><a href=\"https://www.stackage.org/haddock/lts-12.19/containers-0.5.11.0/Data-Sequence.html#v:-62--60-\" rel=\"nofollow noreferrer\">https://www.stackage.org/haddock/lts-12.19/containers-0.5.11.0/Data-Sequence.html#v:-62--60-</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10641593"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "accepted_answer_id": 53352985, "answer_count": 3, "score": 2, "last_activity_date": 1542984547, "creation_date": 1542469231, "last_edit_date": 1542981812, "question_id": 53352740, "link": "https://stackoverflow.com/questions/53352740/efficiently-merge-two-lists", "title": "Efficiently merge two lists", "body": "<p>I'm currently learning Haskell, and working with <code>List</code>.</p>\n\n<p>According to the <a href=\"https://wiki.haskell.org/How_to_work_on_lists\" rel=\"nofollow noreferrer\">HaskellWiki</a>, if I wanted to merge two lists together, I would write:</p>\n\n<pre><code>list1 ++ list2 \n</code></pre>\n\n<p>However, according to <a href=\"https://stackoverflow.com/a/53123141/10641593\">this</a> answer, using ++ on a large list would be inefficient. </p>\n\n<p>From researching, I came across <a href=\"https://stackoverflow.com/questions/3938438/merging-two-lists-in-haskell\">this SO page</a>, but that question requires a specific requirement for the output of the <code>List</code>.</p>\n\n<p><strong>What I tried</strong>:</p>\n\n<p>Suppose if I had two lists of  numbers (for this example, assume that both lists are large enough that using <code>++</code> would be inefficient as described in the SO answer):</p>\n\n<pre><code> oldNumbers = [1,5,14,22,37]\n newNumbers = [3,10,17,27,34,69]\n allNumbers = oldNumbers:newNumbers\n</code></pre>\n\n<p>As you can see I attempted to add <code>oldNumbers</code> to the head of <code>newNumbers</code> with the intention of reversing it afterward (disregard that <code>allNumbers</code> would be unorder for now, that's an exercise for another day).</p>\n\n<p>As you probably guessed, it produced an error</p>\n\n<pre><code>error:\n    * Non type-variable argument in the constraint: Num [a]\n      (Use FlexibleContexts to permit this)\n    * When checking the inferred type\n        allNumbers :: forall a. (Num a, Num [a]) =&gt; [[a]]\n</code></pre>\n\n<p>So, as stated in the title, how would I efficiently merge two lists?</p>\n"}, {"tags": ["json", "haskell", "aeson"], "answers": [{"tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 2, "last_activity_date": 1543190949, "last_edit_date": 1543190949, "creation_date": 1542491534, "answer_id": 53355892, "question_id": 53352563, "link": "https://stackoverflow.com/questions/53352563/haskell-aeson-is-there-a-better-way-of-parsing-historical-data/53355892#53355892", "title": "Haskell, Aeson - Is there a better way of parsing historical data?", "body": "<p>Put a <code>Map</code> in your data type. Aeson translates <code>Map k v</code>s to/from objects, where the <code>v</code>s are en-/de-coded via their own <code>To</code>-/<code>From</code>-<code>JSON</code> instances and the <code>k</code>s by <code>To</code>-/<code>From</code>-<code>JSONKey</code>s. It turns out that <code>Day</code> (from the <code>time</code> package) has perfectly suitable <code>To</code>-/<code>From</code>-<code>JSONKey</code> instances.</p>\n\n<pre><code>data EarthquakeData = EarthquakeData {\n    metaData :: MetaData,\n    earthquakes :: Map Day Earthquake\n} deriving (Eq, Show, Generic)\n\ninstance FromJSON EarthquakeData where\n    parseJSON = withObject \"EarthquakeData $ \\v -&gt;\n        EarthquakeData &lt;$&gt; v .: \"Meta Data\"\n        -- Map k v has a FromJSON instance that just does the right thing\n        -- so just get the payloads with (.:)\n        -- all this code is actually just because your field names are really !#$@~??\n        -- not an Aeson expert, maybe there's a better way\n                       &lt;*&gt; v .: \"EarthQuakes\"\ninstance ToJSON EarthquakeData where\n    toJSON EarthquakeData{..} = object [ \"Meta Data\"   .= metaData\n                                       , \"EarthQuakes\" .= earthquakes\n                                       ]\n\ndata MetaData = MetaData { country :: String, region :: String, latestRec :: Day } deriving (Eq, Show)\ninstance FromJSON MetaData where\n    parseJSON = withObject \"MetaData\" $ \\v -&gt;\n        -- if you haven't noticed, applicative style is much neater than do\n        -- using OverloadedStrings avoids all the pack-ing static\n        MetaData &lt;$&gt; v .: \"1: Country\"\n                 &lt;*&gt; v .: \"2: Region\"\n                 &lt;*&gt; v .: \"3: Latest Recording\"\ninstance ToJSON MetaData where\n    toJSON MetaData{..} = object [ \"1: Country\"          .= country\n                                 , \"2: Region\"           .= region\n                                 , \"3: Latest Recording\" .= latestRec\n                                 ]\n    toEncoding MetaData{..} = pairs $ \"1: Country\"          .= country\n                                   &lt;&gt; \"2: Region\"           .= region\n                                   &lt;&gt; \"3: Latest Recording\" .= latestRec\n\ndata Earthquake = Earthquake { richter :: Double } deriving (Eq, Show)\n-- Earthquake is a bit funky because your JSON apparently has\n-- numbers inside strings?\n-- only here do you actually need monadic operations\ninstance FromJSON Earthquake where\n    parseJSON = withObject \"Earthquake\" $ \\v -&gt;\n        do string &lt;- v .: \"Richter\"\n           stringNum &lt;- parseJSON string\n           case readMaybe stringNum of\n             Just num -&gt; return $ Earthquake num\n             Nothing -&gt; typeMismatch \"Double inside a String\" string\ninstance ToJSON Earthquake where\n    toJSON = object . return . (\"Richter\" .=) . show . richter\n    toEncoding = pairs . (\"Richter\" .=) . show . richter\n</code></pre>\n\n<p>I've tested this against your example JSON, and it appears to roundtrip <code>encode</code> and <code>decode</code> successfully.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 3, "accepted_answer_id": 53355892, "answer_count": 1, "score": 3, "last_activity_date": 1543190949, "creation_date": 1542467891, "last_edit_date": 1542471451, "question_id": 53352563, "link": "https://stackoverflow.com/questions/53352563/haskell-aeson-is-there-a-better-way-of-parsing-historical-data", "title": "Haskell, Aeson - Is there a better way of parsing historical data?", "body": "<p>By 'historical data' I just mean dates as key, and value on that day as value.</p>\n\n<p>For example, often govt institutes or uni's research division compile date about earthquakes, rainfalls, market movement, etc. in this format</p>\n\n<hr>\n\n<pre><code> {\n        \"Meta Data\": {\n            \"1: Country\": \"SomeCountry\",\n            \"2: Region\": \"SomeRegion\",\n            \"3: Latest Recording\": \"2018-11-16\"\n        },\n        \"EarthQuakes\": {\n            \"2018-11-16\": {\n                \"Richter\": \"5.2508\"\n            },\n            \"2018-11-09\": {\n                \"Richter\": \"4.8684\"\n            },\n            \"2018-11-02\": {\n                \"Richter\": \"1.8399\"\n            },\n    ...\n    ...\n    ...\n            \"1918-11-02\": {\n                \"Richter\": \"1.8399\"\n            }\n}\n</code></pre>\n\n<hr>\n\n<p>Usually it'll have a \"Meta Data\" section and other one would contain the values/data.</p>\n\n<hr>\n\n<p>I as a beginner know of two ways to parse these type of documents.</p>\n\n<p>Either you go with general parsing shown in Aeson's documentation where you define data types like this</p>\n\n<pre><code>Data MetaData = MetaData { country :: String, region :: String, latestRec :: String } deriving (Show, Eq, Generic)\n</code></pre>\n\n<p>Make it an instance of <code>FromJSON</code></p>\n\n<pre><code>instance FromJSON MetaData where\n  parseJSON = withObject \"MetaData\" $\n    \\v -&gt; do\n       metaData  &lt;- v        .: pack \"Meta Data\"\n       country   &lt;- metaData .: pack \"1: Country\"\n       region    &lt;- metaData .: pack \"2: Region\"\n       latestRec &lt;- metaData .: pack \"3: Latest Recording\"\n       return MetaData{..}\n</code></pre>\n\n<p>With of course <code>RecordWildCard</code> and <code>DeriveGenerics</code> extensions enabled.</p>\n\n<hr>\n\n<p>The problem I see with this approach is that it can't be easily implemented for the \"EarthQuakes\" section.</p>\n\n<p>I'll have to define each and every single date </p>\n\n<pre><code>earthQuakes &lt;- v .: \"EarthQuakes\"\ndate1 &lt;- earthQuakes .: \"2018-11-16\"\ndate2 &lt;- earthQuakes .: \"2018-11-06\"\ndate3 &lt;- earthQuakes .: \"2018-11-02\"\n...\n...\ndateInfinity &lt;- earthQuakes .: \"1918-11-16\"\n</code></pre>\n\n<hr>\n\n<p>A better approach would be just parsing all the data as default JSON values by decoding the link into <code>Object</code> type</p>\n\n<pre><code>thisFunction = do\n    linksContents &lt;- simpleHttp \"somelink\"\n    let y = fromJust (decode linksContents :: Object)\n        z = aLotOfFunctionCompositions y\n    return z\n</code></pre>\n\n<p>where the <code>aLotOfFunctionCompositions</code> would first convert <code>Object</code> to maybe <code>HashMap</code> having <code>[(k, v)]</code> pairs. Then I would map an <code>unConstruct</code> function to get the value out of default constructors like</p>\n\n<pre><code>unConstruct (DefaultType value) = case (DefaultType value) of\n             DefaultType x -&gt; x\n</code></pre>\n\n<p>and finally you would get a nice list!</p>\n\n<p>The problem with this approach is the <code>aLotOfFunctionComposition</code>.</p>\n\n<p>That is just an example! But in reality it can look as ugly and unreadable as this </p>\n\n<pre><code>let y = Prelude.map (\\(a, b) -&gt; (decode (encode a) :: Maybe String, decode (encode (snd (Prelude.head b))) :: Maybe String)) x\n      z = Prelude.map (\\(a, b) -&gt; (fromJust a, fromJust b)) y\n      a = Prelude.map (\\(a, b) -&gt; (a, read b :: Double)) z\n      b = Prelude.map (\\(a, b) -&gt; (Prelude.filter (/= '-') a, b)) a\n      c = Prelude.map (\\(a, b) -&gt; (read a :: Int, b)) b\n</code></pre>\n\n<p>This is snippet from a working code I made.</p>\n\n<hr>\n\n<p>So my question is this: Is there a better/cleaner way of decoding these sorts of JSON files where you have a lot of \"dates\" keys and you need to parse them into workable datatypes? </p>\n"}, {"tags": ["haskell", "free-theorem"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1542465587, "post_id": 53351894, "comment_id": 93582126, "body": "Free theorems are usually associated to polymorphic function types. Otherwise, IIRC, you get a trivial theorem, e.g. <code>fmap f = fmap f</code> where <code>fmap :: (a-&gt;b)-&gt; F a -&gt; F b</code> is the functor instance."}], "answers": [{"tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": true, "score": 6, "last_activity_date": 1542465608, "creation_date": 1542465608, "answer_id": 53352246, "question_id": 53351894, "link": "https://stackoverflow.com/questions/53351894/finding-a-free-theorem/53352246#53352246", "title": "Finding a &quot;free theorem&quot;", "body": "<p>There is <a href=\"http://www-ps.informatik.uni-kiel.de/~sad/FreeTheorems/cgi-bin/free-theorems-webui.cgi\" rel=\"noreferrer\">an online generator for free theorems at</a>, and when it was down a little while ago I <a href=\"http://free-theorems.nomeata.de/\" rel=\"noreferrer\">created an alternative UI</a> that runs completely in the browser (using <code>reflex-dom</code>).</p>\n\n<p>But the deeper problem is that free theorems, in the sense of these packages, are properties of <em>polymorphic functions</em>, so in order to answer your question, you have to give a function (like <code>map</code>) whose free theorem you are interested in.</p>\n"}], "owner": {"reputation": 878, "user_id": 1366423, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ab21a7fe07af4e3a153d65c420e87e85?s=128&d=identicon&r=PG", "display_name": "NietzscheanAI", "link": "https://stackoverflow.com/users/1366423/nietzscheanai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 1, "accepted_answer_id": 53352246, "answer_count": 1, "score": 2, "last_activity_date": 1542465608, "creation_date": 1542463099, "question_id": 53351894, "link": "https://stackoverflow.com/questions/53351894/finding-a-free-theorem", "title": "Finding a &quot;free theorem&quot;", "body": "<p>How do I derive the free theorem for the type:</p>\n\n<pre><code>data F a = C1 Nat | C2 Bool Nat a\n</code></pre>\n\n<p>where <code>Nat</code> is simply <code>data Nat = Z | S Nat</code>?</p>\n\n<p>In principle, this can be answered by the Haskell 'free-theorems' package, but it's too elderly to compile under any GHC version I can reasonably install.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 2, "creation_date": 1542463193, "post_id": 53351881, "comment_id": 93581563, "body": "I don&#39;t think you need a guard, just <code>fmap</code>: <code>fmap secondFunction (firstFunction x)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1542469442, "last_edit_date": 1542469442, "creation_date": 1542463288, "answer_id": 53351931, "question_id": 53351881, "link": "https://stackoverflow.com/questions/53351881/haskell-replace-case-with-guards/53351931#53351931", "title": "Haskell - replace case with guards", "body": "<p>You could use a <a href=\"https://wiki.haskell.org/Pattern_guard\" rel=\"nofollow noreferrer\"><em>pattern guard</em> [Haskell-wiki]</a>, like:</p>\n\n<pre><code>myFunction :: String -&gt; Maybe Integer\nmyFunction xs | Just x &lt;- firstFunction xs = Just (secondFunction x)\n              | otherwise = Nothing</code></pre>\n\n<p>But what you here do is basically \"<code>fmap</code>\" the result of <code>firstFunction</code>, like:</p>\n\n<pre><code>myFunction :: String -&gt; Maybe Integer\nmyFunction xs = <b>fmap secondFunction</b> (firstFunction xs)</code></pre>\n\n<p><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code> is used to \"map\" over a functor. Now <code>Maybe</code> is a functor, <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Base.html#line-836\" rel=\"nofollow noreferrer\">defined as</a>:</p>\n\n<blockquote>\n<pre><code>instance Functor Maybe  where\n    fmap _ Nothing = Nothing\n    fmap f (Just a) = Just (f a)\n</code></pre>\n</blockquote>\n\n<p>which is basically the logic you wrote here.</p>\n"}], "owner": {"reputation": 43, "user_id": 10667189, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OfIjxTrGijc/AAAAAAAAAAI/AAAAAAAAvWU/TUXVIZ8l1ds/photo.jpg?sz=128", "display_name": "Tommaso Sgarbanti", "link": "https://stackoverflow.com/users/10667189/tommaso-sgarbanti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 1, "accepted_answer_id": 53351931, "answer_count": 1, "score": 3, "last_activity_date": 1542469442, "creation_date": 1542462999, "question_id": 53351881, "link": "https://stackoverflow.com/questions/53351881/haskell-replace-case-with-guards", "title": "Haskell - replace case with guards", "body": "<p>i'd like to know if in this portion of code is possible to replace the case statement with guards:</p>\n\n<pre><code>firstFunction  :: String -&gt; Maybe MyType\nsecondFunction :: MyType -&gt; Integer\nmyFunction     :: String -&gt; Maybe Integer\nmyFunction xs = case firstFunction xs of\n    Nothing -&gt; Nothing\n    Just x  -&gt; Just( secondFunction x )\n</code></pre>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["haskell", "ocaml", "lambda-calculus", "combinatory-logic"], "comments": [{"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1542447099, "post_id": 53349684, "comment_id": 93577798, "body": "Actually, the type not match. Consider: <code>tvar == tvar&#39; = Snd</code> indicates that find has type <code>find :: TVar -&gt; Context -&gt; THom (a, b) b</code>, hence <code>(find tvar ctx)</code> has same type. so the type of arguments of <code>Compose Fst (find tvar ctx)</code>  as <code>compose (Thom (a, b) a) (Thom (a, b) b)</code>, Note that in the definition of compose need: <code>a == (a, b)</code>, but it is impossible."}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "reply_to_user": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1542447332, "post_id": 53349684, "comment_id": 93577845, "body": "Yes that&#39;s precisely the problem. And infinite type error."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1542447982, "post_id": 53349684, "comment_id": 93577961, "body": "We need to be able to write a type for <code>find :: TVar -&gt; Context -&gt; ???</code>. The easy but inelegant solution is to avoid GADTs for <code>THom</code> (and introduce partiality everywhere around). Another solution is to try going fully dependent, introducing more indices: something like <code>find :: TVar v -&gt; Context c -&gt; THom (F v c)</code> with some type family <code>F</code>. In Agda/Coq I&#39;m confident we could write this, given enough time. In Haskell, we probably need more &quot;proof&quot; parameters, singleton types, assuming it&#39;s doable at all (I&#39;m not entirely confident)."}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1542452436, "post_id": 53349684, "comment_id": 93578896, "body": "But what is the intention of <code>find</code> function?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 1, "creation_date": 1542456844, "post_id": 53349684, "comment_id": 93579995, "body": "@assembly.jc Roughly it compiles the access to a variable into a sequence of pair projections. A context is a nested pair similar to a list like <code>(((),x),y)</code> and to access <code>x</code> you want to use something like <code>fst;snd</code> AKA &quot;discard the last variable, take the next&quot;. In general, in longer contexts you generate <code>fst;fst;....;fst;snd</code> to discard many variables and take the one you want at the end. The whole point of doing this is so that we expose more information in the type, unlike e.g. using a plain list. This approach however requires a lot of dependent functions."}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1542456854, "post_id": 53349684, "comment_id": 93580000, "body": "To translate system T lambda variables to projection expressions in system T combinator calculus."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1542493974, "post_id": 53349684, "comment_id": 93589902, "body": "According to a note in the linked post, you should disallow infinitely recursive <code>THom</code>s. You should make all the recursive occurrences strict. This neither worsens nor improves the problem you&#39;re having, just makes the translation closer. (At least, I think adding strictness solves the problem. The author says that laziness causes partiality, but doesn&#39;t offer a solution)."}, {"owner": {"reputation": 6152, "user_id": 53974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a676c96a88feb813010e67af012ca0?s=128&d=identicon&r=PG", "display_name": "Blaisorblade", "link": "https://stackoverflow.com/users/53974/blaisorblade"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1542494493, "post_id": 53349684, "comment_id": 93590029, "body": "@chi Partiality is unavoidable <i>for what the original article does</i>, since it\u2019s parsing and typechecking potentially ill-typed expressions. The dependently-typed variant will probably be possible (with increasing effort), in Agda/Idris, in Haskell (with lots of pain), in Coq with Equations (a plugin for GADT-like functionality), or in plain Coq (where it\u2019s suicide, since pure Coq does <i>not</i> support dependent pattern matching conveniently)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 6152, "user_id": 53974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a676c96a88feb813010e67af012ca0?s=128&d=identicon&r=PG", "display_name": "Blaisorblade", "link": "https://stackoverflow.com/users/53974/blaisorblade"}, "edited": false, "score": 0, "creation_date": 1542496266, "post_id": 53349684, "comment_id": 93590471, "body": "@Blaisorblade Are you saying that dependent pattern matching is more convenient in Agda than it is in (plain) Coq? If so, why? (Related to axiom K?) I&#39;m not a real expert, but in my own experience I understood the Coq matching better, so now I&#39;m curious."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 6152, "user_id": 53974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a676c96a88feb813010e67af012ca0?s=128&d=identicon&r=PG", "display_name": "Blaisorblade", "link": "https://stackoverflow.com/users/53974/blaisorblade"}, "edited": false, "score": 1, "creation_date": 1542498315, "post_id": 53349684, "comment_id": 93590893, "body": "@Blaisorblade I don&#39;t understand what you&#39;re saying. I was just commenting on the fact that the author of the linked post noted that things like <code>let bad = Compose bad SuccH in bad</code> should be disallowed. I think that liberal application of <code>!</code> annotations should eliminate things like that, such that if <code>fun :: THom a b</code>, then either <code>fun = _|_</code> or <code>fun</code> is a real, complete, total, 100% functional, no partiality of any kind, anywhere representation of a function from <code>a</code> to <code>b</code>."}, {"owner": {"reputation": 6152, "user_id": 53974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a676c96a88feb813010e67af012ca0?s=128&d=identicon&r=PG", "display_name": "Blaisorblade", "link": "https://stackoverflow.com/users/53974/blaisorblade"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1542498616, "post_id": 53349684, "comment_id": 93590958, "body": "@HTNW Sorry, you already wrote &quot;This neither worsens nor improves the problem you&#39;re having&quot;, I had missed that. Deleted my earlier comment."}, {"owner": {"reputation": 6152, "user_id": 53974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a676c96a88feb813010e67af012ca0?s=128&d=identicon&r=PG", "display_name": "Blaisorblade", "link": "https://stackoverflow.com/users/53974/blaisorblade"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1542499246, "post_id": 53349684, "comment_id": 93591074, "body": "@chi Yes. Some define &quot;dependent pattern matching&quot; to mean the analogue of what GHC does for GADTs (tho I expect GADTs came later), so that plain Coq does not have that, and that&#39;s why Equations was written. I&#39;m not saying it&#39;s trivial to use, but much more convenient once you learn it.  One historical reason was axiom K, but after the advent of homotopy type theory, people have done research into supporting dependent pattern matching <i>without</i> necessarily relying on axiom K (with restrictions), or by proving restrictions of that axiom for specific datatypes where it does hold."}, {"owner": {"reputation": 6152, "user_id": 53974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a676c96a88feb813010e67af012ca0?s=128&d=identicon&r=PG", "display_name": "Blaisorblade", "link": "https://stackoverflow.com/users/53974/blaisorblade"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1542499511, "post_id": 53349684, "comment_id": 93591121, "body": "@chi One annoyance with Agda dependent pattern matching is that its behavior is entirely predictable according to relatively simple rules, but next to nobody explained them (when I learned Agda), so some failures seem puzzling."}], "answers": [{"comments": [{"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 1, "creation_date": 1542503439, "post_id": 53356604, "comment_id": 93591654, "body": "The reason why I&#39;m not using Template Haskell is because I don&#39;t want an embedded DSL, I&#39;m intending to use this for an external language. In this situation, do you recommend your third solution? Surely Haskell can be used to write this simple compiler."}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1542627100, "post_id": 53356604, "comment_id": 93623173, "body": "So you recommend the third solution, but it is not simple?"}, {"owner": {"reputation": 6152, "user_id": 53974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a676c96a88feb813010e67af012ca0?s=128&d=identicon&r=PG", "display_name": "Blaisorblade", "link": "https://stackoverflow.com/users/53974/blaisorblade"}, "reply_to_user": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1542627959, "post_id": 53356604, "comment_id": 93623629, "body": "Ah; then I\u2019d usually recommend avoiding GADTs altogether, as most compilers for external languages do (GHC included), especially if you actually want to use the resulting code (as opposed to playing with it). The third one might work but it is not the most immediate: some operations on well-typed terms (such as substitution) might end up being much harder to implement; you might be lucky."}, {"owner": {"reputation": 6152, "user_id": 53974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a676c96a88feb813010e67af012ca0?s=128&d=identicon&r=PG", "display_name": "Blaisorblade", "link": "https://stackoverflow.com/users/53974/blaisorblade"}, "reply_to_user": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1542628014, "post_id": 53356604, "comment_id": 93623661, "body": "Please disregard the comment I now deleted \u2014 I had posted it by mistake while editing."}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1542629987, "post_id": 53356604, "comment_id": 93624679, "body": "Ok if not GADTs, what do you suggest as an alternative encoding of System T combinator calculus?"}, {"owner": {"reputation": 6152, "user_id": 53974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a676c96a88feb813010e67af012ca0?s=128&d=identicon&r=PG", "display_name": "Blaisorblade", "link": "https://stackoverflow.com/users/53974/blaisorblade"}, "reply_to_user": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1542918114, "post_id": 53356604, "comment_id": 93748877, "body": "@CMCDragonkai Whoops wasn&#39;t notified \u2014 I&#39;d use plain algebraic data types. Basically, just remove the type parameters from Expr/THom etc. A few more functions will become partial, and you&#39;ll need more tests. You can still store (object-language) types inside the AST, so that you can run a &quot;retypechecker&quot; that checks (at runtime) your AST can be typed in System T. That&#39;s the most common choice in compilers/interpreters."}], "tags": [], "owner": {"reputation": 6152, "user_id": 53974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a676c96a88feb813010e67af012ca0?s=128&d=identicon&r=PG", "display_name": "Blaisorblade", "link": "https://stackoverflow.com/users/53974/blaisorblade"}, "is_accepted": true, "score": 2, "last_activity_date": 1542498547, "last_edit_date": 1542498547, "creation_date": 1542497963, "answer_id": 53356604, "question_id": 53349684, "link": "https://stackoverflow.com/questions/53349684/systemt-compiler-and-dealing-with-infinite-types-in-haskell/53356604#53356604", "title": "SystemT Compiler and dealing with Infinite Types in Haskell", "body": "<p>This answer will have to be a bit high-level, because there are three entirely different <em>families</em> of possible designs to fix that problem. What you\u2019re doing seems closer to approach three, but the approaches are ordered by increasing complexity.</p>\n\n<h2>The approach in the original post</h2>\n\n<p>Translating the original post requires Template Haskell and partiality; <code>find</code> would return a <code>Q.Exp</code> representing some <code>Hom a b</code>, avoiding this problem just like the original post. Just like in the original post, a type error in the original code would be caught when typechecking the output of all the Template Haskell functions. So, type errors are still caught <em>before</em> runtime, but you will still need to write <em>tests</em> to find cases where your macros output ill-typed expressions. One can give stronger guarantees, at the cost of a significant increase in complexity.</p>\n\n<h2>Dependent typing/GADTs in input and output</h2>\n\n<p>If you want to diverge from the post, one alternative is to use \u201cdependent typing\u201d throughout and make the <em>input</em> dependently-typed. I use the term loosely to include both actually dependently-typed languages, actual Dependent Haskell (when it lands), and ways to fake dependent typing in Haskell today (via GADTs, singletons, and what not).\nHowever, you lose the ability to write your own typechecker and choose which type system to use; typically, you end up embedding a simply-typed lambda calculus, and can simulate polymorphism via polymorphic Haskell functions that can generate terms at a given type. This is easier in dependently-typed languages, but possible at all in Haskell.</p>\n\n<p>But honestly, in this road it\u2019s easier to use higher-order abstract syntax and Haskell functions, with something like:</p>\n\n<pre><code>data Exp a where\n  Abs :: (Exp a -&gt; Exp b) -&gt; Exp (a -&gt; b)\n  App :: Exp (a -&gt; b) -&gt; Exp a -&gt; Exp b\n  Var :: String -&gt; Exp a \u2014- only use for free variables\nexampleId :: Exp (a -&gt; a)\nexampleId = Abs (\\x -&gt; x)\n</code></pre>\n\n<p>If you can use this approach (details omitted here), you get high assurance from GADTs with limited complexity. However, this approach is too inflexible for many scenarios, for instance because the typing contexts are only visible to the Haskell compiler and not in your types or terms.</p>\n\n<h2>From untyped to typed terms</h2>\n\n<p>A third option is go dependently-typed <em>and</em> to still make your program turn weakly-typed input to strongly typed output. In this case, your typechecker overall transforms terms of some type <code>Expr</code> into terms of a GADT <code>TExp gamma t</code>, <code>Hom a b</code>, or such. Since you don\u2019t know statically what <code>gamma</code> and <code>t</code> (or <code>a</code> and <code>b</code>) are, you\u2019ll indeed need some sort of existential.</p>\n\n<p>But a plain existential is too weak: to build bigger well-typed expression, you\u2019ll need to check that the produced types allow it. For instance, to build a <code>TExpr</code> containing a <code>Compose</code> expression out of two smaller <code>TExpr</code>, you'll need to check (at runtime) that their types match. And with a plain existential, you can't. So you\u2019ll need to have a representation of types also at the value level.</p>\n\n<p>What's more existentials are annoying to deal with (as usual), since you can\u2019t ever expose the hidden type variables in your return type, or project those out (unlike dependent records/sigma-types).\nI am honestly not entirely sure this could eventually be made to work. Here is a possible partial sketch in Haskell, up to one case of <code>find</code>.</p>\n\n<pre><code>data Type t where\n  VNat :: Type Nat\n  VString :: Type String\n  VArrow :: Type a -&gt; Type b -&gt; Type (a -&gt; b)\n  VPair :: Type a -&gt; Type b -&gt; Type (a, b) \n  VUnit :: Type ()\ndata SomeType = forall t. SomeType (Type t)\ndata SomeHom = forall a b. SomeHom (Type a) (Type b) (THom a b)\n\ntype Context = [(TVar, SomeType)] \ngetType :: Context -&gt; SomeType\ngetType [] = SomeType VUnit \ngetType ((_, SomeType ttyp) :: gamma) =  \n   case getType gamma of\n       SomeType ctxT -&gt; SomeType (VPair ttyp\nfind :: TVar -&gt; Context -&gt; SomeHom \nfind tvar ((tvar\u2019, ttyp) :: gamma)\n   | tvar == tvar\u2019 =\n       case (ttyp, getType gamma) of\n         (SomeType t, SomeType ctxT) -&gt;\n          SomeHom (VPair t ctxT) t Fst\n</code></pre>\n"}], "owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 1, "accepted_answer_id": 53356604, "answer_count": 1, "score": 3, "last_activity_date": 1542498547, "creation_date": 1542444865, "last_edit_date": 1542493386, "question_id": 53349684, "link": "https://stackoverflow.com/questions/53349684/systemt-compiler-and-dealing-with-infinite-types-in-haskell", "title": "SystemT Compiler and dealing with Infinite Types in Haskell", "body": "<p>I'm following this blog post: <a href=\"http://semantic-domain.blogspot.com/2012/12/total-functional-programming-in-partial.html\" rel=\"nofollow noreferrer\">http://semantic-domain.blogspot.com/2012/12/total-functional-programming-in-partial.html</a></p>\n\n<p>It shows a small OCaml compiler program for <a href=\"http://www.lsv.fr/~dowek/Philo/godel.pdf\" rel=\"nofollow noreferrer\">System T (a simple total functional language)</a>.</p>\n\n<p>The entire pipeline takes OCaml syntax (via Camlp4 metaprogramming) transforms them to OCaml AST that is translated to SystemT Lambda Calculus (see: <code>module Term</code>) and then finally SystemT Combinator Calculus (see: \n<code>module Goedel</code>). The final step is also wrapped with OCaml metaprogramming <code>Ast.expr</code> type.</p>\n\n<p>I'm attempting to translate it to Haskell without the use of Template Haskell.</p>\n\n<p>For the SystemT Combinator form, I've written it as</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE GADTs #-}\n\ndata TNat = Zero | Succ TNat\n\ndata THom a b where\n  Id :: THom a a\n  Unit :: THom a ()\n  ZeroH :: THom () TNat\n  SuccH :: THom TNat TNat\n  Compose :: THom a b -&gt; THom b c -&gt; THom a c\n  Pair :: THom a b -&gt; THom a c -&gt; THom a (b, c)\n  Fst :: THom (a, b) a\n  Snd :: THom (a, b) b\n  Curry :: THom (a, b) c -&gt; THom a (b -&gt; c)\n  Eval :: THom ((a -&gt; b), a) b -- (A = B) * A -&gt; B\n  Iter :: THom a b -&gt; THom (a, b) b -&gt; THom (a, TNat) b\n</code></pre>\n\n<p>Note that <code>Compose</code> is forward composition, which differs from <code>(.)</code>.</p>\n\n<p>During the translation of SystemT Lambda Calculus to SystemT Combinator Calculus, the <code>Elaborate.synth</code> function tries to convert SystemT Lambda calculus variables into series of composed projection expressions (related to De Brujin Indices). This is because combinator calculus doesn't have variables/variable names. This is done with the <code>Elaborate.lookup</code> which uses the <code>Quote.find</code> function.</p>\n\n<p>The problem is that with my encoding of the combinator calculus as the GADT <code>THom a b</code>. Translating the <code>Quote.find</code> function:</p>\n\n<pre class=\"lang-ml prettyprint-override\"><code>  let rec find x  = function\n    | [] -&gt; raise Not_found\n    | (x', t) :: ctx' when x = x' -&gt; &lt;:expr&lt; Goedel.snd &gt;&gt; \n    | (x', t) :: ctx' -&gt; &lt;:expr&lt; Goedel.compose Goedel.fst $find x ctx'$ &gt;&gt;\n</code></pre>\n\n<p>Into Haskell:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>find :: TVar -&gt; Context -&gt; _\nfind tvar [] = error \"Not Found\"\nfind tvar ((tvar', ttype):ctx)\n  | tvar == tvar' = Snd\n  | otherwise     = Compose Fst (find tvar ctx)\n</code></pre>\n\n<p>Results in an infinite type error.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>\u2022 Occurs check: cannot construct the infinite type: a ~ (a, c)\n  Expected type: THom (a, c) c\n    Actual type: THom ((a, c), c) c\n</code></pre>\n\n<p>The problem stems from the fact that using <code>Compose</code> and <code>Fst</code> and <code>Snd</code> from the <code>THom a b</code> GADT can result in infinite variations of the type signature.</p>\n\n<p>The article doesn't have this problem because it appears to use the <code>Ast.expr</code> OCaml thing to wrap the underlying expressions.</p>\n\n<p>I'm not sure how to resolve in Haskell. Should I be using an existentially quantified type like</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data TExpr = forall a b. TExpr (THom a b)\n</code></pre>\n\n<p>Or some sort of type-level <code>Fix</code> to adapt the infinite type problem. However I'm unsure how this changes the <code>find</code> or <code>lookup</code> functions.</p>\n"}, {"tags": ["haskell", "installation", "ghc"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 4, "creation_date": 1542418243, "post_id": 53346669, "comment_id": 93573521, "body": "Those installation instructions are from 2003 (when GHC 6.0 was released). For something up-to-date, visit <a href=\"https://www.haskell.org/platform/windows.html\" rel=\"nofollow noreferrer\">haskell.org/platform/windows.html</a> and download the &quot;Core&quot; installer available there."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 5, "creation_date": 1542452392, "post_id": 53346669, "comment_id": 93578880, "body": "Instead of <i>installing</i> GHC globally on Windows, I recommend using <a href=\"https://docs.haskellstack.org\" rel=\"nofollow noreferrer\">Stack</a> to compile, run, and develop Haskell code. I&#39;ve done this on Windows 10 for years, and while not frictionless, it works better than installing the Haskell platform."}], "answers": [{"comments": [{"owner": {"reputation": 8757, "user_id": 9634, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6181812b2747dc091b4b7ec97fb67c2f?s=128&d=identicon&r=PG", "display_name": "Brent.Longborough", "link": "https://stackoverflow.com/users/9634/brent-longborough"}, "edited": false, "score": 1, "creation_date": 1593338884, "post_id": 53635141, "comment_id": 110740055, "body": "In my experience, Chocolatey is messy, doesn&#39;t provide start menu links, nor WinGHCI, and installs things in obscure places before even attempting to  use regular Windows conventions like C:\\Program Files"}, {"owner": {"reputation": 2667, "user_id": 325725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3db095f94749aaedfea12b927b13cf74?s=128&d=identicon&r=PG", "display_name": "Phyx", "link": "https://stackoverflow.com/users/325725/phyx"}, "reply_to_user": {"reputation": 8757, "user_id": 9634, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6181812b2747dc091b4b7ec97fb67c2f?s=128&d=identicon&r=PG", "display_name": "Brent.Longborough", "link": "https://stackoverflow.com/users/9634/brent-longborough"}, "edited": false, "score": 0, "creation_date": 1593356637, "post_id": 53635141, "comment_id": 110745666, "body": "Uhmm. Ghc doesn&#39;t have a gui. You want a start link to a console application? WinGHCI is also not part of ghc or maintained in the last 10 years. And it doesn&#39;t install to program files because the toolchain can&#39;t handle paths with spaces. Dos short names which was the workaround haskell platform uses isn&#39;t a portable workaround and has performance issues. Furthermore installing to program files will typically eat a large number of characters from the MAX_PATH issue that plagues the gnu toolchains it uses. So yes it doesn&#39;t install there for very good reasons."}], "tags": [], "owner": {"reputation": 2667, "user_id": 325725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3db095f94749aaedfea12b927b13cf74?s=128&d=identicon&r=PG", "display_name": "Phyx", "link": "https://stackoverflow.com/users/325725/phyx"}, "is_accepted": false, "score": -2, "last_activity_date": 1544022094, "creation_date": 1544022094, "answer_id": 53635141, "question_id": 53346669, "link": "https://stackoverflow.com/questions/53346669/installing-ghc-on-windows/53635141#53635141", "title": "Installing GHC on Windows", "body": "<p>You can use chocolatey [1] in which case it's just</p>\n\n<p><code>choco install ghc</code> which will install ghc and Cabal and give you a working environment. It has every version of ghc and Cabal released. </p>\n\n<p>More here <a href=\"https://chocolatey.org/packages/ghc/\" rel=\"nofollow noreferrer\">https://chocolatey.org/packages/ghc/</a></p>\n\n<p>[1] <a href=\"https://chocolatey.org\" rel=\"nofollow noreferrer\">https://chocolatey.org</a></p>\n"}], "owner": {"reputation": 167, "user_id": 7838597, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a1c0d8e22c9db4616d73ea8a41b6181c?s=128&d=identicon&r=PG&f=1", "display_name": "J.Ober", "link": "https://stackoverflow.com/users/7838597/j-ober"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1822, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1544022094, "creation_date": 1542410759, "question_id": 53346669, "link": "https://stackoverflow.com/questions/53346669/installing-ghc-on-windows", "title": "Installing GHC on Windows", "body": "<p>Using this guide's instructions to install GHC on my Windows 10 instance, I can't follow the first step:</p>\n\n<p><a href=\"https://downloads.haskell.org/~ghc/6.0/docs/html/users_guide/sec-install-windows.html\" rel=\"nofollow noreferrer\">https://downloads.haskell.org/~ghc/6.0/docs/html/users_guide/sec-install-windows.html</a></p>\n\n<pre><code>\"Download the Installshield setup.exe from the GHC download page haskell.org.\"\n</code></pre>\n\n<p>Having dowloaded this file from the site linked in that guide, there is no setup.exe. </p>\n\n<pre><code>Windows 64-bit (x86_64)\nghc-8.6.2-x86_64-unknown-mingw32.tar.xz (203.8 MB, sig)\nThis is compatible with Microsoft Windows Vista and later. It also includes \nsupport for compiling C++ files.\n</code></pre>\n\n<p>I unzip the file to folder \"ghc-8.6.2\" consisting of folders </p>\n\n<pre><code>\"bin, doc, lib, mingw, perl\"\n</code></pre>\n\n<p>(Yes, I searched for the setup.exe)</p>\n\n<p>Could anyone tell me how I could get to the setup.exe so it will take care of setting up PATH etc?</p>\n"}, {"tags": ["haskell", "homoiconicity"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1542410539, "post_id": 53346318, "comment_id": 93572169, "body": "<a href=\"https://meta.stackexchange.com/a/18879/188673\">Please don\u2019t add tags to your question that your question mentions, but is not about.</a> This question is about Haskell, not Lisp."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 4, "creation_date": 1542410728, "post_id": 53346318, "comment_id": 93572218, "body": "Spoilers: &quot;homoiconic&quot; doesn&#39;t actually mean anything."}], "answers": [{"comments": [{"owner": {"reputation": 877, "user_id": 2402383, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Q3QBc.jpg?s=128&g=1", "display_name": "zabeltech", "link": "https://stackoverflow.com/users/2402383/zabeltech"}, "edited": false, "score": 0, "creation_date": 1542416596, "post_id": 53346480, "comment_id": 93573272, "body": "your definition of homoiconicity does not address my point .. mk, more pressing is this: it might be that i have a limited understanding here: why does it not compile if i make the pattern binding strict?"}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 877, "user_id": 2402383, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Q3QBc.jpg?s=128&g=1", "display_name": "zabeltech", "link": "https://stackoverflow.com/users/2402383/zabeltech"}, "edited": false, "score": 0, "creation_date": 1542416851, "post_id": 53346480, "comment_id": 93573326, "body": "@zabeltech Perhaps because it simply wasn\u2019t implemented because it\u2019s a rather uncommon use case. You could certainly file an issue on the <a href=\"https://ghc.haskell.org/trac/ghc\" rel=\"nofollow noreferrer\">GHC trac</a> requesting it be implemented."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 877, "user_id": 2402383, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Q3QBc.jpg?s=128&g=1", "display_name": "zabeltech", "link": "https://stackoverflow.com/users/2402383/zabeltech"}, "edited": false, "score": 0, "creation_date": 1542417161, "post_id": 53346480, "comment_id": 93573370, "body": "@zabeltech In any case, \u201chomoiconicity\u201d <a href=\"https://twitter.com/ShriramKMurthi/status/1046944950531829760\" rel=\"nofollow noreferrer\">doesn\u2019t mean anything</a>, and even if it did, it <a href=\"http://calculist.org/blog/2012/04/17/homoiconicity-isnt-the-point/\" rel=\"nofollow noreferrer\">isn\u2019t the point</a>. Even in a Lisp, you wouldn\u2019t want errors involving <code>let</code> reported in terms of <code>case</code>. Two language features having similar but distinct semantics and being kept separate, rather than desugaring one into the other, is a choice completely orthogonal to homoiconicity, and many features in GHC <i>are</i> defined by desugaring (such as <code>do</code> notation and <code>LambdaCase</code>)."}, {"owner": {"reputation": 877, "user_id": 2402383, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Q3QBc.jpg?s=128&g=1", "display_name": "zabeltech", "link": "https://stackoverflow.com/users/2402383/zabeltech"}, "edited": false, "score": 0, "creation_date": 1542418749, "post_id": 53346480, "comment_id": 93573599, "body": "hmm, ja, might be that nobody bothered...again i&#39;am a big haskell fan. but it seems off that the evaluation strategy affects the type checker, although you have proven that it does ... do you see a common sensical reason for that?"}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 877, "user_id": 2402383, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Q3QBc.jpg?s=128&g=1", "display_name": "zabeltech", "link": "https://stackoverflow.com/users/2402383/zabeltech"}, "edited": false, "score": 4, "creation_date": 1542419035, "post_id": 53346480, "comment_id": 93573630, "body": "@zabeltech Evaluation strategy has to be relevant to the typechecker once you start allowing values to serve as witnesses for type-level truths (which is precisely what GADTs, and to a lesser extent, existentials, do), since Haskell\u2019s implementation of laziness makes every type inhabited. Indeed, I just watched <a href=\"https://www.youtube.com/watch?v=nDmNTRG1V_0\" rel=\"nofollow noreferrer\">a talk that demonstrates how important evaluation order is to static analysis</a> in the context of Haskell, which could be interesting to you if you want to have a better understanding of what can go wrong when you do not consider laziness."}, {"owner": {"reputation": 877, "user_id": 2402383, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Q3QBc.jpg?s=128&g=1", "display_name": "zabeltech", "link": "https://stackoverflow.com/users/2402383/zabeltech"}, "edited": false, "score": 0, "creation_date": 1542619092, "post_id": 53346480, "comment_id": 93618808, "body": "i believe that what you say reagarding lazy patterns is true, however i think in this case the bigger point about the problem of the code is about the hidden type variable a escaping it&#39;s scope. this gets reflected by the error i get with a different compiler version"}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 877, "user_id": 2402383, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Q3QBc.jpg?s=128&g=1", "display_name": "zabeltech", "link": "https://stackoverflow.com/users/2402383/zabeltech"}, "edited": false, "score": 0, "creation_date": 1542659270, "post_id": 53346480, "comment_id": 93640144, "body": "@zabeltech I don\u2019t think the answer you have accepted is correct, as I\u2019ve explained in <a href=\"https://stackoverflow.com/questions/53346318/pattern-bindings-for-existential-constructors/53356406#comment93631075_53356406\">my comment on that answer</a>."}], "tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": false, "score": 10, "last_activity_date": 1542409090, "creation_date": 1542409090, "answer_id": 53346480, "question_id": 53346318, "link": "https://stackoverflow.com/questions/53346318/pattern-bindings-for-existential-constructors/53346480#53346480", "title": "Pattern bindings for existential constructors", "body": "<blockquote>\n  <p>Do I miss something or stems this behaviour from the fact that haskell is not homoiconic?</p>\n</blockquote>\n\n<p>No. Homoiconicity is a red herring: every language is homoiconic with its source text and its AST<sup>1</sup>, and indeed, Haskell <em>is</em> implemented internally as a series of desugaring passes between various intermediate languages.</p>\n\n<p>The real problem is that <code>let...in</code> and <code>case...of</code> just have fundamentally different semantics, which is intentional. Pattern-matching with <code>case...of</code> is strict, in the sense that it forces the evaluation of the scrutinee in order to choose which RHS to evaluate, but pattern bindings in a <code>let...in</code> form are lazy. In that sense, <code>let p = e1 in e2</code> is actually most similar to <code>case e1 of ~p -&gt; e2</code> (note the lazy pattern match using <code>~</code>!), which produces a similar, albeit distinct, error message:</p>\n\n<pre><code>ghci&gt; case undefined of { ~Foo{getFoo} -&gt; show getFoo }\n\n&lt;interactive&gt;:5:22: error:\n    \u2022 An existential or GADT data constructor cannot be used\n        inside a lazy (~) pattern\n    \u2022 In the pattern: Foo {getFoo}\n      In the pattern: ~Foo {getFoo}\n      In a case alternative: ~Foo {getFoo} -&gt; show getFoo\n</code></pre>\n\n<p>This is explained in more detail in the answer to <a href=\"https://stackoverflow.com/questions/23531566/odd-ghc-error-message-my-brain-just-exploded\">Odd ghc error message, &quot;My brain just exploded&quot;?</a>.</p>\n\n<hr>\n\n<p><sup><sup>1</sup>If this doesn\u2019t satisfy you, note that Haskell <em>is</em> homoiconic in the sense that most Lispers use the word, since it supports an analog to Lisp\u2019s <code>quote</code> operator in the form of <code>[| ... |]</code> quotation brackets, which are part of Template Haskell.</sup></p>\n"}, {"comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1542641107, "post_id": 53356406, "comment_id": 93631075, "body": "I think this answer is incorrect, or at least the code example you included is wrong. When <a href=\"https://repl.it/repls/MountainousThreadbareDeprecatedsoftware\" rel=\"nofollow noreferrer\">I run your program</a>, I don\u2019t get the \u201ctype variable would escape its scope\u201d error, I get the \u201cmy brain just exploded\u201d error that occurs from an attempt to match on an existential in a pattern binding. Furthermore, I don\u2019t think your explanation makes sense\u2014why do you think <code>x</code> should have type <code>Int</code>? Constructing an existential \u201cseals away\u201d the type of its argument; opening it will not get that type back. <code>x</code> should be a fresh, rigid type."}, {"owner": {"reputation": 224, "user_id": 10668680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c4996037684a7b9e963c7c3d19c260?s=128&d=identicon&r=PG&f=1", "display_name": "Erick Gonzalez", "link": "https://stackoverflow.com/users/10668680/erick-gonzalez"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1542731552, "post_id": 53356406, "comment_id": 93670100, "body": "Well .. (edited for brevity) <code>$ cat app&#47;Main.hs  {-# LANGUAGE ExistentialQuantification, RecordWildCards #-} module Main where data Foo = forall a. Show a =&gt; Foo { getFoo :: a }  main::IO() main = do     let Foo x = Foo (5::Int)     putStrLn $ show x $ stack build  &#47;Users&#47;erick&#47;sandbox&#47;atest&#47;app&#47;Main.hs:8:13: error:    \u2022 Couldn&#39;t match expected type \u2018p\u2019 with actual type \u2018a\u2019            because type variable \u2018a\u2019 would escape its scope</code>"}, {"owner": {"reputation": 224, "user_id": 10668680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c4996037684a7b9e963c7c3d19c260?s=128&d=identicon&r=PG&f=1", "display_name": "Erick Gonzalez", "link": "https://stackoverflow.com/users/10668680/erick-gonzalez"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1542732052, "post_id": 53356406, "comment_id": 93670351, "body": "Sorry for the poor formatting above but it seems one can&#39;t use blocks in comments.. either way I think you get the point. You get one result, I get another... FWIW I am using GHC 8.2.2  Now, I believe you didn&#39;t understand my point. What I saying is that the following statement:  <code>let Foo x = Foo (5::Int)</code>  as you say <code>x</code> can not be (specifically) an Int... but the let statement above pretty much states that x would have to be an int, thus violating the existential constraint.."}, {"owner": {"reputation": 224, "user_id": 10668680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c4996037684a7b9e963c7c3d19c260?s=128&d=identicon&r=PG&f=1", "display_name": "Erick Gonzalez", "link": "https://stackoverflow.com/users/10668680/erick-gonzalez"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 1, "creation_date": 1542733132, "post_id": 53356406, "comment_id": 93671006, "body": "Upon reading your reply again I believe I understand what you meant with &quot;why do you think <code>x</code> should have type <code>Int</code>&quot;? ... well, because of referential transparency. If the thing on the left and the right side of the <code>=</code> can be used interchangeably anywhere in the program, it follows that if one matches <code>Foo x</code> to <code>Foo (5::Int)</code> then I should be able to replace any occurrence of x with 5 after this.. ergo they would be the same thing..and the same thing has (of course) the same type.. the compiler can&#39;t just &quot;look the other way&quot; and pretend it doesn&#39;t know in this case that x is an <code>Int</code>"}], "tags": [], "owner": {"reputation": 224, "user_id": 10668680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c4996037684a7b9e963c7c3d19c260?s=128&d=identicon&r=PG&f=1", "display_name": "Erick Gonzalez", "link": "https://stackoverflow.com/users/10668680/erick-gonzalez"}, "is_accepted": true, "score": 0, "last_activity_date": 1542497216, "last_edit_date": 1542497216, "creation_date": 1542496014, "answer_id": 53356406, "question_id": 53346318, "link": "https://stackoverflow.com/questions/53346318/pattern-bindings-for-existential-constructors/53356406#53356406", "title": "Pattern bindings for existential constructors", "body": "<p>I thought about this a bit and albeit the behaviour seems odd at first, after some thinking I guess one can justify it perhaps thus:</p>\n\n<p>Say I take your second (failing) example and after some massaging and value replacements I reduce it to this:</p>\n\n<pre><code>data Foo = forall a. Show a =&gt; Foo { getFoo :: a }\n\nmain::IO()\nmain = do\n    let Foo x = Foo (5::Int)\n    putStrLn $ show x\n</code></pre>\n\n<p>which produces the error:</p>\n\n<blockquote>\n  <p>Couldn't match expected type \u2018p\u2019 with actual type \u2018a\u2019 because type variable \u2018a\u2019 would escape its scope</p>\n</blockquote>\n\n<p>if the pattern matching would be allowed, what would be the type of x? well.. the type would be of course <code>Int</code>. However the definition of <code>Foo</code> says that the type of the <code>getFoo</code> field is <em>any type</em> that is an instance of <code>Show</code>. An <code>Int</code> is an instance of <code>Show</code>, but it is not any type.. it is a specific one.. in this regard, the actual specific type of the value wrapped in that <code>Foo</code> would become \"visible\" (i.e. escape) and thus violate our explicit guarantee that <code>forall a . Show a =&gt;...</code></p>\n\n<p>If we now look at a version of the code that works by using a pattern match in the function declaration:</p>\n\n<pre><code>data Foo = forall a . Show a =&gt; Foo { getFoo :: !a }\n\nunfoo :: Foo -&gt; String\nunfoo Foo{..} = show getFoo\n\nmain :: IO ()\nmain = do\n    putStrLn . unfoo $ Foo (5::Int)\n</code></pre>\n\n<p>Looking at the <code>unfoo</code> function we see that there is nothing there saying that the type inside of the <code>Foo</code> is any specific type.. (an <code>Int</code> or otherwise) .. in the scope of that function all we have is the original guarantee that <code>getFoo</code> can be of any type which is an instance of <code>Show</code>. The actual type of the wrapped value remains hidden and unknowable so there are no violations of any type guarantees and happiness ensues.</p>\n\n<p>PS: I forgot to mention that the <code>Int</code> bit was of course an example.. in your case, the type of the <code>getFoo</code> field inside of the <code>foo</code> value is of type <code>a</code> but this is a specific (non existential) type to which GHC's type inference is referring to (and not the existential <code>a</code> in the type declaration).. I just came up with an example with a specific <code>Int</code> type so that it would be easier and more intuitive to understand.</p>\n"}], "owner": {"reputation": 877, "user_id": 2402383, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Q3QBc.jpg?s=128&g=1", "display_name": "zabeltech", "link": "https://stackoverflow.com/users/2402383/zabeltech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 53356406, "answer_count": 2, "score": 2, "last_activity_date": 1542619607, "creation_date": 1542407759, "last_edit_date": 1542619607, "question_id": 53346318, "link": "https://stackoverflow.com/questions/53346318/pattern-bindings-for-existential-constructors", "title": "Pattern bindings for existential constructors", "body": "<p>While writing Haskell as a programmer that had exposure to Lisp before, something odd came to my attention, which I failed to understand.</p>\n\n<p>This compiles fine:</p>\n\n<pre><code>{-# LANGUAGE NamedFieldPuns #-}\n{-# LANGUAGE ExistentialQuantification #-}\ndata Foo = forall a. Show a =&gt; Foo { getFoo :: a }\n\nshowfoo :: Foo -&gt; String\nshowfoo Foo{getFoo} = do\n  show getFoo\n</code></pre>\n\n<p>whereas this fails:</p>\n\n<pre><code>{-# LANGUAGE NamedFieldPuns #-}\n{-# LANGUAGE ExistentialQuantification #-}\ndata Foo = forall a. Show a =&gt; Foo { getFoo :: a }\n\nshowfoo :: Foo -&gt; String\nshowfoo foo = do\n  let Foo{getFoo} = foo\n  show getFoo\n</code></pre>\n\n<p>To me it's not obvious why the second snippet fails.</p>\n\n<p>The question would be:</p>\n\n<p>Do I miss something or stems this behaviour from the fact that haskell is not homoiconic?</p>\n\n<p>My reasoning is, given that: </p>\n\n<ol>\n<li><p>Haskell needs to implement record pattern matching as a compiler extension, because of it's choice to use syntax rather than data.</p></li>\n<li><p>Matching in a function head or in a let clause are two special cases.</p></li>\n</ol>\n\n<p>It is difficult to understand those special cases, as they cannot be either implemented nor looked up directly in the language itself.</p>\n\n<p>As an effect of this, consistent behaviour throughout the language is not guaranteed. Especially together with additional compiler extensions, as per example.</p>\n\n<p>ps: compiler error:</p>\n\n<pre><code>error:\n    \u2022 My brain just exploded\n      I can't handle pattern bindings for existential or GADT data constructors.\n      Instead, use a case-expression, or do-notation, to unpack the constructor.\n    \u2022 In the pattern: Foo {getFoo}\n      In a pattern binding: Foo {getFoo} = foo\n      In the expression:\n        do { let Foo {getFoo} = foo;\n             show getFoo }\n</code></pre>\n\n<p>edit:\nA different compiler version gives this error for the same problem</p>\n\n<pre><code>* Couldn't match expected type `p' with actual type `a'\n    because type variable `a' would escape its scope\n  This (rigid, skolem) type variable is bound by\n    a pattern with constructor: Foo :: forall a. Show a =&gt; a -&gt; Foo\n</code></pre>\n"}, {"tags": ["haskell", "existential-type"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 7143065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09a627332a62de08fc1272570653119f?s=128&d=identicon&r=PG&f=1", "display_name": "Pier Bezuhoff", "link": "https://stackoverflow.com/users/7143065/pier-bezuhoff"}, "edited": false, "score": 0, "creation_date": 1542388094, "post_id": 53342370, "comment_id": 93563736, "body": "I want to have the same type inside <code>Proxy T</code> and in <code>T</code>, for example <code>p = Proxy :: Proxy (T (Proxy :: Proxy String))</code> and i want get <code>extractT p = T (Proxy :: Proxy String)</code>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 75, "user_id": 7143065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09a627332a62de08fc1272570653119f?s=128&d=identicon&r=PG&f=1", "display_name": "Pier Bezuhoff", "link": "https://stackoverflow.com/users/7143065/pier-bezuhoff"}, "edited": false, "score": 0, "creation_date": 1542388142, "post_id": 53342370, "comment_id": 93563760, "body": "@\u041f\u044c\u0435\u0440\u0411\u0435\u0437\u0443\u0445\u043e\u0432 There is no type inside <code>Proxy T</code>."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 3, "last_activity_date": 1542387856, "creation_date": 1542387856, "answer_id": 53342370, "question_id": 53342282, "link": "https://stackoverflow.com/questions/53342282/extracting-existential-from-proxy/53342370#53342370", "title": "Extracting existential from proxy", "body": "<pre><code>extractT :: Proxy T -&gt; T\nextractT _ = T (Proxy :: Proxy ())\n</code></pre>\n\n<p>I'm not sure how useful this is (or how it is \"extracting\" anything), but it has the required type signature.</p>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 7143065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09a627332a62de08fc1272570653119f?s=128&d=identicon&r=PG&f=1", "display_name": "Pier Bezuhoff", "link": "https://stackoverflow.com/users/7143065/pier-bezuhoff"}, "edited": false, "score": 0, "creation_date": 1542388465, "post_id": 53342481, "comment_id": 93563903, "body": "Thanks, now I understand it"}], "tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": true, "score": 8, "last_activity_date": 1542388278, "creation_date": 1542388278, "answer_id": 53342481, "question_id": 53342282, "link": "https://stackoverflow.com/questions/53342282/extracting-existential-from-proxy/53342481#53342481", "title": "Extracting existential from proxy", "body": "<p>No, it is not possible (aside from \u201ctrivial\u201d implementations like <a href=\"https://stackoverflow.com/a/53342370/465378\">this one by melpomene</a> that ignore the argument entirely).</p>\n\n<p>A value of type <code>Proxy a</code> carries no more information at runtime than <code>()</code> does, which is to say it doesn\u2019t carry any information at all. This is true no matter what <code>a</code> is.</p>\n\n<p>Your type <code>T</code> carries more information than just <code>()</code> at runtime: it carries a <code>Show</code> method dictionary for some type around with it. This dictionary isn\u2019t very useful, since by the time the existential is unpacked, you don\u2019t have any way to obtain a value of type <code>t</code> to use <code>show</code> on, but the information is technically there.</p>\n\n<p>Since constructing a <code>T</code> requires supplying a typeclass dictionary, but the dictionary (nor any means to obtain it) does not exist inside <code>Proxy T</code>, and there is not any static information about which type the dictionary should be for, it is impossible to obtain the dictionary necessary to construct a <code>T</code>. Put another way, constructing a value of type <code>Proxy T</code> does not pick a <code>t</code>\u2014there is no type \u201cinside\u201d the <code>T</code> in <code>Proxy T</code>\u2014since <code>Proxy</code> only carries around type-level information, but the <code>t</code> inside the <code>T</code> type only exists at the value level.</p>\n"}, {"tags": [], "owner": {"reputation": 2582, "user_id": 2602809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f4a2c4da5688bcce29b33437e2e0df?s=128&d=identicon&r=PG", "display_name": "abacabadabacaba", "link": "https://stackoverflow.com/users/2602809/abacabadabacaba"}, "is_accepted": false, "score": 1, "last_activity_date": 1542388381, "creation_date": 1542388381, "answer_id": 53342502, "question_id": 53342282, "link": "https://stackoverflow.com/questions/53342282/extracting-existential-from-proxy/53342502#53342502", "title": "Extracting existential from proxy", "body": "<p>This is not possible. From the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Proxy.html\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<blockquote>\n  <p><code>Proxy</code> is a type that holds no data</p>\n</blockquote>\n\n<p>There is nothing you can extract from a <code>Proxy</code> value besides its type. And the type <code>Proxy T</code> doesn't say anything about the type inside the <code>T</code> value, because there is <em>no</em> <code>T</code> value inside.</p>\n"}], "owner": {"reputation": 75, "user_id": 7143065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09a627332a62de08fc1272570653119f?s=128&d=identicon&r=PG&f=1", "display_name": "Pier Bezuhoff", "link": "https://stackoverflow.com/users/7143065/pier-bezuhoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 1, "accepted_answer_id": 53342481, "answer_count": 3, "score": 2, "last_activity_date": 1542388381, "creation_date": 1542387421, "question_id": 53342282, "link": "https://stackoverflow.com/questions/53342282/extracting-existential-from-proxy", "title": "Extracting existential from proxy", "body": "<p>Is it possible to write <code>extractT</code>?</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\nimport Data.Proxy\n\ndata T = forall t. Show t =&gt; T (Proxy t)\n\nextractT :: Proxy T -&gt; T\nextractT p = ...\n</code></pre>\n\n<p>I have tried</p>\n\n<pre><code>extractT p = T $ p &gt;&gt;= \\(T t) -&gt; t\n</code></pre>\n\n<p>but it does not work.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1519, "user_id": 1486848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KNtLf.jpg?s=128&g=1", "display_name": "ShamPooSham", "link": "https://stackoverflow.com/users/1486848/shampoosham"}, "edited": false, "score": 0, "creation_date": 1542383781, "post_id": 53341188, "comment_id": 93561493, "body": "What error are you getting? I suppose you simply need to put brackets around <code>Node n *</code>, ie <code>(Node n [])</code> and <code>(Node n xs)</code>"}, {"owner": {"reputation": 1025, "user_id": 2144360, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/767659db8e35cad4101b913878314098?s=128&d=identicon&r=PG", "display_name": "RajibTheKing", "link": "https://stackoverflow.com/users/2144360/rajibtheking"}, "reply_to_user": {"reputation": 1519, "user_id": 1486848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KNtLf.jpg?s=128&g=1", "display_name": "ShamPooSham", "link": "https://stackoverflow.com/users/1486848/shampoosham"}, "edited": false, "score": 0, "creation_date": 1542383933, "post_id": 53341188, "comment_id": 93561590, "body": "\u2022 The constructor \u2018Node\u2019 should have 2 arguments, but has been given none     \u2022 In the pattern: Node       In an equation for \u2018maxBranching\u2019: maxBranching Node n [] = 1       The equation(s) for \u2018maxBranching\u2019 have three arguments,       but its type \u2018Tree Int -&gt; Int\u2019 has only one    | 22 | maxBranching Node n [] = 1"}, {"owner": {"reputation": 1519, "user_id": 1486848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KNtLf.jpg?s=128&g=1", "display_name": "ShamPooSham", "link": "https://stackoverflow.com/users/1486848/shampoosham"}, "edited": false, "score": 0, "creation_date": 1542384156, "post_id": 53341188, "comment_id": 93561712, "body": "Sounds like my suggestion would fix that. Without parentheses around <code>Node n xs</code>, it thinks <code>n</code> and <code>xs</code> are second and third arguments to <code>maxBranching</code> instead of <code>Node</code>"}, {"owner": {"reputation": 1403, "user_id": 1748746, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/ZMrp9.png?s=128&g=1", "display_name": "Anthony Raimondo", "link": "https://stackoverflow.com/users/1748746/anthony-raimondo"}, "edited": false, "score": 0, "creation_date": 1542386080, "post_id": 53341188, "comment_id": 93562729, "body": "Sounds like a job for Foldable?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1403, "user_id": 1748746, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/ZMrp9.png?s=128&g=1", "display_name": "Anthony Raimondo", "link": "https://stackoverflow.com/users/1748746/anthony-raimondo"}, "edited": false, "score": 0, "creation_date": 1542387353, "post_id": 53341188, "comment_id": 93563364, "body": "@AnthonyRaimondo, <code>Foldable</code> isn&#39;t actually powerful enough for this job. <code>Foldable</code> effectively flattens out the very tree structure that needs to be examined."}], "answers": [{"comments": [{"owner": {"reputation": 1025, "user_id": 2144360, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/767659db8e35cad4101b913878314098?s=128&d=identicon&r=PG", "display_name": "RajibTheKing", "link": "https://stackoverflow.com/users/2144360/rajibtheking"}, "edited": false, "score": 0, "creation_date": 1542386466, "post_id": 53341571, "comment_id": 93562911, "body": "I tried your solution, but still I am getting error."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1542398415, "post_id": 53341571, "comment_id": 93568146, "body": "<code>xs</code> is of type <code>[Tree Int]</code> not a <code>Tree Int</code>"}], "tags": [], "owner": {"reputation": 1519, "user_id": 1486848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KNtLf.jpg?s=128&g=1", "display_name": "ShamPooSham", "link": "https://stackoverflow.com/users/1486848/shampoosham"}, "is_accepted": false, "score": 0, "last_activity_date": 1542447083, "last_edit_date": 1542447083, "creation_date": 1542384556, "answer_id": 53341571, "question_id": 53341188, "link": "https://stackoverflow.com/questions/53341188/traverse-a-tree-with-an-arbitrary-number-of-branches/53341571#53341571", "title": "Traverse a tree with an arbitrary number of branches", "body": "<p>First of all, you need to put parentheses around your argument, like this:</p>\n\n<pre><code>maxBranching (Node n xs) = ...\n</code></pre>\n\n<p>If you don't put parentheses around your arguments, the compiler can't know if <code>n</code> and <code>xs</code>/<code>[]</code> belongs to <code>Node</code> or <code>maxBranching</code>. </p>\n\n<p>Next issue you have is that your recursive call is done on a list of <code>Tree Int</code> instead of just a <code>Tree Int</code>. What you need to do is to get the maxBranching of each subtree and then compare the result to each other. So a first, naive approach, would be the following:</p>\n\n<pre><code>maxBranching (Node n xs) = max (length xs) (maximum (map maxBranching xs))\n</code></pre>\n\n<p><code>map</code> will run <code>maxBranching</code> on every element of the list <code>xs</code>, returning an array of <code>Int</code>. <code>maximum</code> will then take the max in the list. The difference between <code>max</code> and <code>maximum</code> is that <code>max</code> only takes two arguments and compare them, while <code>maximum</code> takes a list which is arbitrarily long. </p>\n\n<p>We could get rid of <code>max</code>by adding <code>length xs</code> into the list we created, and running <code>maximum</code> on everything, like this:</p>\n\n<pre><code>maxBranching (Node n xs) = maximum $ (length xs):(map maxBranching xs)\n</code></pre>\n\n<p>And if you don't know, <code>$</code> is equvivalent with putting parantheses around the rest of the line (more or less).</p>\n\n<p>You could also use smart methods as folding and the like, but I just wanted you to understand the errors you did and how to fix them without changing the core idea of your solution. </p>\n"}, {"tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": true, "score": 4, "last_activity_date": 1542385573, "creation_date": 1542385573, "answer_id": 53341825, "question_id": 53341188, "link": "https://stackoverflow.com/questions/53341188/traverse-a-tree-with-an-arbitrary-number-of-branches/53341825#53341825", "title": "Traverse a tree with an arbitrary number of branches", "body": "<p>Firstly, the type of parameter of <code>maxBranching</code> is <code>Tree Int</code> and not <code>[Tree Int]</code> and you want to map all Children Nodes to its maximum degrees, so it should be:</p>\n\n<pre><code>map maxBranching xs\n</code></pre>\n\n<p>Not </p>\n\n<pre><code>maxBranching xs\n</code></pre>\n\n<p>Secondly, parameter need in parentheses, otherwise, the function <code>maxBranching</code> become accept 3 parameters.</p>\n\n<p>put them all as:</p>\n\n<pre><code>maxBranching :: Tree Int -&gt; Int\nmaxBranching (Node _ []) = 1\nmaxBranching (Node _ xs) =  maximum $ (length xs) : (map maxBranching xs)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1542387170, "last_edit_date": 1542387170, "creation_date": 1542386797, "answer_id": 53342135, "question_id": 53341188, "link": "https://stackoverflow.com/questions/53341188/traverse-a-tree-with-an-arbitrary-number-of-branches/53342135#53342135", "title": "Traverse a tree with an arbitrary number of branches", "body": "<p>You want to traverse a tree generating a sort of \"summary value\". This is a classic example of a <em>catamorphism</em> or <em>fold</em>. The general fold for trees looks like this:</p>\n\n<pre><code>foldTree :: (a -&gt; [b] -&gt; b) -&gt; Tree a -&gt; b\nfoldTree f (Node a bs) = f a (map (foldTree f) bs)\n</code></pre>\n\n<p>The idea here is that at each tree node,</p>\n\n<pre><code>Node r [t1,t2,t3]\n</code></pre>\n\n<p>we first reduce each child recursively to a summary value, then apply the given function and the root value and the summaries of the children to produce a summary for the tree.</p>\n\n<p>Now</p>\n\n<pre><code>maxBranching :: Tree a -&gt; Int\nmaxBranching = foldTree $\n  \\_ bs -&gt; maximum (length bs : bs)\n</code></pre>\n\n<p>That is, at each node, we take the maximum of the number of branches of that node and each of its children.</p>\n"}], "owner": {"reputation": 1025, "user_id": 2144360, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/767659db8e35cad4101b913878314098?s=128&d=identicon&r=PG", "display_name": "RajibTheKing", "link": "https://stackoverflow.com/users/2144360/rajibtheking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 53341825, "answer_count": 3, "score": 2, "last_activity_date": 1542447083, "creation_date": 1542383273, "last_edit_date": 1542385845, "question_id": 53341188, "link": "https://stackoverflow.com/questions/53341188/traverse-a-tree-with-an-arbitrary-number-of-branches", "title": "Traverse a tree with an arbitrary number of branches", "body": "<p>I want to calculate the maximum degree in a <code>Tree</code> which has an arbitrary number of branches.</p>\n\n<pre><code>data Tree a = Node a [Tree a]\n  deriving (Eq, Show)\n\n{-\n\n       2\n    /  |  \\\n   7   3   1\n       |  / \\\n       0 3   2\n For this case: Answer will be 3. \n-}\ntree1 :: Tree Int\ntree1 = Node 2 [Node 7 [], Node 3 [Node 0 []], Node 1 [Node 3 [], Node 2 []]]\n\n--I am doing something like this:\n\nmaxBranching :: Tree Int -&gt; Int\nmaxBranching Node n [] = 1\nmaxBranching Node n xs = max (length xs) maxBranching xs\n</code></pre>\n\n<p>Now, I am getting an error. How can I write the correct pattern to solve this problem?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1542369929, "post_id": 53337362, "comment_id": 93553824, "body": "It is enough to check up to <code>sqrt n</code>. And use <code>rem</code> function rather than <code>mod</code>. <code>rem</code> is faster. <code>factors n = [x | x &lt;- [1.. sqrt n], n `rem` x == 0]</code>. Check if the list is has more than one elem."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1542369959, "post_id": 53337362, "comment_id": 93553840, "body": "Checking all possible factors is rather useless. You are interested in <i>prime</i> factors. If a number has no prime factors (smaller than itself), it has no other interesting factors."}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1542370048, "post_id": 53337362, "comment_id": 93553892, "body": "Consider <code>factor n</code>, you need to check each number &lt; n whether is factor of n, so it take n steps, and each factor of n need to check whether is prime (also use <code>factor</code> function), so if n have m factors, it need n <code>n * m</code> step, i.e. O(n * m). so why it is slow."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1542389100, "post_id": 53337362, "comment_id": 93564183, "body": "you don&#39;t need to compute all factors, if you find a non-trivial factor before sqrt(n) just exit early.  This should speed up dramatically for numbers small factors (e.g. 62451532000)."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542383769, "post_id": 53337672, "comment_id": 93561490, "body": "combined with the other answer&#39;s approach, there&#39;d be about 75 steps, for 62451532000."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1542389174, "post_id": 53337672, "comment_id": 93564208, "body": "if you change the logic and decide with the first non-trivial factor, it should only take 1 step, namely when testing for factor 2."}], "tags": [], "owner": {"reputation": 2043, "user_id": 2676937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d42ec82c3feefc3c7e13b37dae77f21?s=128&d=identicon&r=PG", "display_name": "merlyn", "link": "https://stackoverflow.com/users/2676937/merlyn"}, "is_accepted": true, "score": 6, "last_activity_date": 1542370300, "creation_date": 1542370300, "answer_id": 53337672, "question_id": 53337362, "link": "https://stackoverflow.com/questions/53337362/nth-prime-and-prime-factors/53337672#53337672", "title": "nth Prime, and Prime Factors", "body": "<p>The lag time is due to the factors function. It iterates from <code>1</code> to <code>n</code>. So, if <code>n</code> is <code>62451532000</code>, there will at least be <code>62451532000</code> steps. That's too many steps.</p>\n\n<p>There are plenty of ways to speed this up. There's actually so many that one could write a book on it. I suggest you lookup factorization.</p>\n\n<p>For now, try implementing this simple trick. Whenever <code>d</code> is a factor of <code>n</code>, so is <code>n/d</code>. If you look for all factors below <code>\u221an</code>, and utilize this trick, you would have found all the factors.</p>\n\n<p>This would decrease the number of steps required from <code>62451532000</code> to about <code>250000</code>. Much more manageable.</p>\n"}, {"tags": [], "owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "is_accepted": false, "score": 2, "last_activity_date": 1542375091, "last_edit_date": 1542375091, "creation_date": 1542372906, "answer_id": 53338348, "question_id": 53337362, "link": "https://stackoverflow.com/questions/53337362/nth-prime-and-prime-factors/53338348#53338348", "title": "nth Prime, and Prime Factors", "body": "<p>You can easily get rid of <code>prime</code>. A small change in your algorithm is enough for you to make sure than any new factor you find is guaranteed to be prime. </p>\n\n<p>Here is how you do it. Every time you find an <code>x</code> divides <code>n</code> you remove all <code>x</code> factors from <code>n</code> and then proceed with that new value. </p>\n\n<p>Consider the following example with number 40. Note that 40 = 2^3*5. So 40 is divisible by 1, 2, 4, 5, 8, 20 and 40. We begin testing for prime factors at 2. </p>\n\n<pre><code>40 `mod` 2 == 0 \n</code></pre>\n\n<p>So 2 is a factor (and prime). So let's remove all the 2's </p>\n\n<pre><code>40 `mod` 2 == 0\n40 `div` 2 == 20\n\n20 `mod` 2 == 0\n20 `div` 2 == 10\n\n10 `mod` 2 == 0\n10 `div` 2 == 5\n\n5 `mod` 2 == 1\n</code></pre>\n\n<p>So we removed all the 2's from 40, until we got 5. Now we proceed with 5 instead. You check division by 3, then 4, then 5 which works. And note how 5 is indeed prime. </p>\n\n<p>Now here is a question for you to think about. How does this method guarantee that each new factor you find is prime?</p>\n\n<p><strong>Note:</strong> Keep in mind however that while the method above should speed things up when dealing with big numbers composed of relatively small prime factors, it won't do much if you test it e.g. with a big prime number. </p>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1542486390, "last_edit_date": 1542486390, "creation_date": 1542410323, "answer_id": 53346616, "question_id": 53337362, "link": "https://stackoverflow.com/questions/53337362/nth-prime-and-prime-factors/53346616#53346616", "title": "nth Prime, and Prime Factors", "body": "<p>Yes, the consensus is the factor list [1..n]. It speeds things up when you minimize the factor list without losing effectiveness. I use a limited factor list that works. It assumes all primes are one-of-4 out of every 10, that is [11,13,17,19,21,23,27,29,31...]. The following starts at 11 (specified) because starting at 1 would include 1 and 9. All primes after 7 end in 1,3,7 or 9.\nThis list eliminates evens and 5s. The following eliminates 3s as well.</p>\n\n<pre><code>no2s3s5s = scanl (\\b a -&gt; a + b) 11 $ cycle [2,4,2,4,6,2,6,4]\n</code></pre>\n\n<p>The length of the factor list need not exceed <code>sqrt n</code>, so ...</p>\n\n<pre><code>fa n=[x|x&lt;-2:3:5:7:(take (floor.sqrt.fromIntegral$n+2) no2s3s5s),mod n x == 0]\n</code></pre>\n\n<p><code>fa</code> lists factors, a lot of which are prime</p>\n\n<pre><code>fa 909090 OR fa 121\n[2,3,5,7,13,37,91,259,481,3367] AND [11] recpectively\n</code></pre>\n\n<p>To remove the non-prime from the list</p>\n\n<pre><code>pr n = (null $ fa n) || (fa n == [n])\n</code></pre>\n\n<p>and</p>\n\n<pre><code>[ d | d&lt;-2:3:5:7:(take 200 no2s3s5s), pr d ]\n</code></pre>\n\n<p>Produces a prime list but is slow as are all such functions that use a factor list or divisors such. </p>\n"}], "owner": {"reputation": 173, "user_id": 10605246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683bda86a4ff9594ad6e38ea0bfabdef?s=128&d=identicon&r=PG&f=1", "display_name": "Stormy", "link": "https://stackoverflow.com/users/10605246/stormy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 53337672, "answer_count": 3, "score": 1, "last_activity_date": 1542486390, "creation_date": 1542369189, "last_edit_date": 1542369292, "question_id": 53337362, "link": "https://stackoverflow.com/questions/53337362/nth-prime-and-prime-factors", "title": "nth Prime, and Prime Factors", "body": "<p>Going through the Haskell tutorial, it said to write a function 'isPrime' to determine if a number is a prime number.</p>\n\n<p>I came up with:</p>\n\n<pre><code>isPrime :: Integer -&gt; Bool\nisPrime n = factors n == [1,n]\n    where factors n = [x | x &lt;- [1..n], n `mod` x == 0]\n</code></pre>\n\n<p>which works.</p>\n\n<p>But how would I go about asking for the nth prime number -- as in, the 100th prime number is 541?</p>\n\n<p>Playing around further with primes, I found a list of Prime Factors like this:</p>\n\n<pre><code>primeFactors :: Integer -&gt; [Integer]\nprimeFactors n = filter prime (factors n)\n    where factors n = [x | x &lt;- [1..n], n `mod` x == 0]\n          prime n = factors n == [1,n]\n</code></pre>\n\n<p>and that works, too.</p>\n\n<p>However, when you put in a very large number, you get significant lag time.</p>\n\n<p>As an example, it does these just fine:</p>\n\n<pre><code>ghci &gt; primeFactors 419\n[419]\n\nghci &gt; primeFactors 5698\n[2,7,11,37]                 -- did this one really fast...\n\nghci &gt; primeFactors 76586\n[2,149,257]                 -- and this one really fast... \n\nghci &gt; primeFactors 876350\n[2,5,17,1031]               -- it hung up just a hair with this one...\n\nghci &gt; primeFactors 4287635\n[5,11,19,373]               -- hung up a little bit longer here...\n\nghci &gt; primeFactors 34598274\n[2,3,5766379]               -- hung up for quite a while here...\n\nghci &gt; primeFactors 208346758\n[2,104173379]               -- and for a very long time with this one!\n</code></pre>\n\n<p>The tutorial suggested finding the prime factors of 62451532000, and on that one, I'm still waiting, after somewhere around 5 minutes.</p>\n\n<p>What is causing the lag time, and what would be the best way to speed this up?</p>\n"}, {"tags": ["haskell", "opengl", "marching-cubes"], "comments": [{"owner": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "edited": false, "score": 1, "creation_date": 1542364256, "post_id": 53333805, "comment_id": 93550861, "body": "Color-debug the normals"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "edited": false, "score": 0, "creation_date": 1542364638, "post_id": 53333805, "comment_id": 93551063, "body": "@Nadir What do you mean?"}, {"owner": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "edited": false, "score": 1, "creation_date": 1542366533, "post_id": 53333805, "comment_id": 93551982, "body": "Instead of drawing the shaded color of your implicit surface, set the color output as if the normal vector would be a color."}, {"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 1, "creation_date": 1542375986, "post_id": 53333805, "comment_id": 93557050, "body": "The thing is that the real normals of the surface are changing too quickly and the coarse triangulation cannot reproduce them. Therefore, one thing you can try is to increase the Marching Cubes resolution. Cusps like these are always problematic for per-vertex normals since you cannot reasonably interpolate them. A second option would be to leave them as corners and duplicate the vertices using separate normals (which you evaluate a bit off the vertex inside the face)."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1542376814, "post_id": 53333805, "comment_id": 93557494, "body": "@NicoSchertler Yes indeed, this is better when I increase the resolution. But I&#39;m wondering why this issue does not occur with <code>rgl</code> in R (I&#39;ve just edited my post to add the <code>rgl</code> rendering). I use the same resolution and the same normals, and the marching cubes algorithm is the same as well. The <code>rgl</code> package is also based on <code>OpenGL</code> (I think, I should check), so I&#39;m wondering whether there&#39;s a default option set in <code>rgl</code> and that I don&#39;t set in Haskell."}, {"owner": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1542378020, "post_id": 53333805, "comment_id": 93558198, "body": "Might rgl use flat shading? It is hard to see from the screenshot."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1542379351, "post_id": 53333805, "comment_id": 93558948, "body": "@NicoSchertler No, it uses smooth shading. I&#39;ve tried the flat shading and the result is ugly."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 1, "creation_date": 1542387925, "post_id": 53333805, "comment_id": 93563656, "body": "That&#39;s really weird. I observe a similar behavior when there&#39;s only one light, at (0,0,0), which is the center of the object."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1542398905, "post_id": 53333805, "comment_id": 93568351, "body": "I don&#39;t know if this is what is causing it, but it might be: You should set the position of the light to be a bit off-center; put it where the sun might be.  Try e.g. <code>Vertex4 500 500 (-1000)</code> and see how it looks."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 30659, "user_id": 1210053, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8cee821e7bf4acaa7f0de12d603b9f1d?s=128&d=identicon&r=PG", "display_name": "Nico Schertler", "link": "https://stackoverflow.com/users/1210053/nico-schertler"}, "edited": false, "score": 0, "creation_date": 1542450109, "post_id": 53333805, "comment_id": 93578387, "body": "@NicoSchertler Please take a look at my edit. Now the front view is nice, but the back view is too bright. Do you have an idea that would help to decrease this brightness ? I really don&#39;t understand why there is this difference. The front view and the back view (i.e. the 180&#176; rotated front view) are exposed to the light in the same way."}], "answers": [{"comments": [{"owner": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "edited": false, "score": 0, "creation_date": 1542531230, "post_id": 53355501, "comment_id": 93595351, "body": "There are two things that stand out to me here:  - <code>rescaleNormal $= Enabled</code>, which may be correctly &quot;fixing&quot; your normals. - The location of your light is in a much different position.  My hunch is that the likely cause of your original problem was due to incorrect normals."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "edited": false, "score": 0, "creation_date": 1542531653, "post_id": 53355501, "comment_id": 93595437, "body": "Thanks @Mokosha. I will try later to unset each option one by one, in order to find the smoking gun. I have also changed the order of the vertices of each triangle, I would not be surprised if this was the source of the problem."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "edited": false, "score": 0, "creation_date": 1542641393, "post_id": 53355501, "comment_id": 93631257, "body": "@Mokosha Nope. The <code>rescaleNormal</code> has no effect, and the issue was not due to the position of the light (see my edit). I&#39;m lost. I am sure I have reproduced the code which caused the issue, but now it causes no issue... Surely I forget a subtle point, or this was a bug."}], "tags": [], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "is_accepted": false, "score": 2, "last_activity_date": 1542641261, "last_edit_date": 1542641261, "creation_date": 1542488143, "answer_id": 53355501, "question_id": 53333805, "link": "https://stackoverflow.com/questions/53333805/undesirable-shadows-with-haskell-opengl/53355501#53355501", "title": "Undesirable shadows with Haskell OpenGL", "body": "<p>Now the rendering is nice :-)</p>\n\n<p><a href=\"https://i.stack.imgur.com/UnWWf.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UnWWf.gif\" alt=\"enter image description here\"></a></p>\n\n<p>I don't know what caused the problem because I have done numerous changes... Here are the relevant parts of the code:</p>\n\n<pre><code>resize :: Double -&gt; Size -&gt; IO ()\nresize zoom s@(Size w h) = do\n  viewport $= (Position 0 0, s)\n  matrixMode $= Projection\n  loadIdentity\n  perspective 45.0 (w'/h') 1.0 100.0\n  lookAt (Vertex3 0 0 (-6+zoom)) (Vertex3 0 0 0) (Vector3 0 1 0)\n  matrixMode $= Modelview 0\n  where\n    w' = realToFrac w\n    h' = realToFrac h\n</code></pre>\n\n<hr>\n\n<pre><code>main :: IO ()\nmain = do\n  _ &lt;- getArgsAndInitialize\n  _ &lt;- createWindow \"Barth Sextic\"\n  windowSize $= Size 500 500\n  initialDisplayMode $= [RGBMode, DoubleBuffered, WithDepthBuffer]\n  clearColor $= discord\n  clientState ColorArray $= Disabled -- this is a default option, I think\n  materialAmbient Front $= black\n  materialDiffuse Front $= white\n  materialEmission Front $= Color4 0 0 0 0\n  materialSpecular Front $= white\n  materialShininess Front $= 50\n  lighting $= Enabled\n  light (Light 0) $= Enabled\n  position (Light 0) $= Vertex4 500 500 (-1000) 1\n  diffuse (Light 0) $= white\n  specular (Light 0) $= white\n  lightModelAmbient $= Color4 0.35 0.35 0.35 1\n  depthMask $= Enabled -- this is default option\n  depthFunc $= Just Lequal\n  shadeModel $= Smooth\n  fog $= Disabled -- this is default option, I think\n  polygonMode $= (Fill, Fill) -- this is default option\n  polygonSmooth $= Enabled\n  cullFace $= Just Front\n  rescaleNormal $= Enabled\n  ......\n</code></pre>\n\n<p>I have also changed the order of the vertices of each triangle:</p>\n\n<pre><code>drawTriangle ((v1,v2,v3), (n1,n2,n3)) = do\n  materialDiffuse Front $= fuchsia\n  normal n1\n  vertex v1\n  normal n3\n  vertex v3\n  normal n2\n  vertex v2\n</code></pre>\n\n<p>This answer is a bit premature. I will investigate more later, and I'll edit to write my findings.</p>\n\n<h1>EDIT</h1>\n\n<p>Well, I have done further investigations and sadly, my conclusion is that I have no explanation: I have reverted all my changes, and no way to reproduce the issue !!</p>\n\n<p>Now I use this shorter code:</p>\n\n<pre><code>display :: ...... -&gt; displayCallback\n  ......\n  renderPrimitive Triangles $\n    mapM_ drawTriangle triangles\n  swapBuffers\n  where\n    drawTriangle ((v1,v2,v3), (n1,n2,n3)) = do\n      materialDiffuse Front $= fuchsia\n      normal n1\n      vertex v1\n      normal n2\n      vertex v2\n      normal n3\n      vertex v3\n</code></pre>\n\n<hr>\n\n<pre><code>resize :: Double -&gt; Size -&gt; IO ()\nresize zoom s@(Size w h) = do\n  viewport $= (Position 0 0, s)\n  matrixMode $= Projection\n  loadIdentity\n  perspective 45.0 (w'/h') 1.0 100.0\n  lookAt (Vertex3 0 0 (-6+zoom)) (Vertex3 0 0 0) (Vector3 0 1 0)\n  matrixMode $= Modelview 0\n  where\n    w' = realToFrac w\n    h' = realToFrac h\n</code></pre>\n\n<p>The two <code>MatrixMode</code> are important. </p>\n\n<pre><code>main :: IO ()\nmain = do\n  _ &lt;- getArgsAndInitialize\n  _ &lt;- createWindow \"Barth Sextic\"\n  windowSize $= Size 500 500\n  initialDisplayMode $= [RGBMode, DoubleBuffered, WithDepthBuffer]\n  clearColor $= discord\n  materialAmbient Front $= black\n  materialDiffuse Front $= white\n  materialEmission Front $= black\n  lighting $= Enabled\n  light (Light 0) $= Enabled\n  position (Light 0) $= Vertex4 500 500 (-1000) 1\n  ambient (Light 0) $= white\n  diffuse (Light 0) $= white\n  specular (Light 0) $= white\n  depthFunc $= Just Less\n  shadeModel $= Smooth\n  cullFace $= Just Back\n  ......\n</code></pre>\n\n<p><code>polygonSmooth</code> and <code>rescaleNormal</code> were useless. I have also changed the position of the light but this is not the point which caused the issue. The <code>cullFace</code> is not necessary but it is good because there's no visible back face.</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1542641261, "creation_date": 1542355876, "last_edit_date": 1542449869, "question_id": 53333805, "link": "https://stackoverflow.com/questions/53333805/undesirable-shadows-with-haskell-opengl", "title": "Undesirable shadows with Haskell OpenGL", "body": "<p>I have drawn the Barth sextic with Haskell OpenGL and there's a problem. I have also drawn it in R (with packages <code>rgl</code> and <code>misc3d</code>) and there's no problem. The two algorithms (in Haskell and R) are very similar. The Barth sextic is an implicit surface, and in Haskell I compute a triangulation of this surface with a marching cubes algorithm that I got by translating the one of <code>misc3d</code> to Haskell and C. I use the vertex normals, each defined by the gradient of the implicit equation.</p>\n\n<p>Here is the problem:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MEzsT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MEzsT.png\" alt=\"enter image description here\"></a></p>\n\n<p>I don't want these black shadows. When I look at the back of the sextic, by a 180\u00b0 rotation, there's no such shadow:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nrILw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nrILw.png\" alt=\"enter image description here\"></a></p>\n\n<p>The full code is available in <a href=\"https://github.com/stla/opengl-implicit4\" rel=\"nofollow noreferrer\">this Github repo</a>. Here are the parts of the code relevant to the colors:</p>\n\n<pre><code>fuchsia :: Color4 GLfloat\nfuchsia = Color4 1.00 0.00 1.00 1\ndiscord :: Color4 GLfloat\ndiscord = Color4 0.21 0.22 0.25 1\n\n  renderPrimitive Triangles $ mapM_ drawTriangle triangles\n  swapBuffers\n  where\n    drawTriangle ((v1,v2,v3), (n1,n2,n3)) = do\n      materialDiffuse FrontAndBack $= fuchsia\n      normal n1\n      vertex v1\n      normal n2\n      vertex v2\n      normal n3\n      vertex v3\n\n  clearColor $= discord\n  materialAmbient FrontAndBack $= black\n  materialDiffuse FrontAndBack $= white\n  materialEmission FrontAndBack $= black\n  lighting $= Enabled\n  lightModelTwoSide $= Enabled\n  light (Light 0) $= Enabled\n  position (Light 0) $= Vertex4 0 0 (-1000) 1\n  ambient (Light 0) $= white\n  diffuse (Light 0) $= white\n  specular (Light 0) $= white\n</code></pre>\n\n<p>I have tried to change the colors in this last piece of code, but no way to get rid of these shadows. Am I doing something bad with the colors? I am sure the normals are correct because this works in R. However the shadows appear where the surface is not smooth, so I'm wondering whether the issue is caused by the normals.</p>\n\n<p>The R rendering: </p>\n\n<p><img src=\"https://thumbs.gfycat.com/GraciousRevolvingFlatfish-size_restricted.gif\" alt=\"gfycat\"></p>\n\n<h1>Edit</h1>\n\n<p>I have managed to get rid of these shadows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xgkWI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xgkWI.png\" alt=\"enter image description here\"></a></p>\n\n<p>I don't really know how, I've done so many attempts... But anyway, now the problem is that the back of the sextic is too lighty:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jaX39.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jaX39.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1542377425, "post_id": 53333388, "comment_id": 93557842, "body": "<code>&quot;foo&quot;</code> and <code>[&quot;foo&quot;]</code> are completely different values. A double-quoted string of characters is just syntactic sugar for the list, i.e., <code>&quot;foo&quot;</code> and <code>[&#39;f&#39;, &#39;o&#39;, &#39;o&#39;]</code> are exactly the same thing. (At least, in standard Haskell; the <code>OverloadedStrings</code> extension, if you choose to use it, generalizes <code>&quot;...&quot;</code> from type <code>String</code> to type <code>IsString p =&gt; p</code>.)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1542381436, "post_id": 53333388, "comment_id": 93560168, "body": "A side exercise for you: suppose you leave off the base case of <code>countListComp</code> (that is, suppose you delete the line <code>countListComp [] find = 0</code>). What do you predict will go wrong? Does ghc agree with your prediction?"}], "answers": [{"tags": [], "owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "is_accepted": true, "score": 7, "last_activity_date": 1542354431, "creation_date": 1542354431, "answer_id": 53333494, "question_id": 53333388, "link": "https://stackoverflow.com/questions/53333388/haskell-counting-the-number-of-occurrences-of-a-value-in-a-list/53333494#53333494", "title": "Haskell - counting the number of occurrences of a value in a list", "body": "<p>Problem with <code>countListComp [\"she sells sea shells\"] \"s\"</code> is you have list of string.</p>\n\n<p>You probably mean <code>countListComp \"she sells sea shells\" 's'</code></p>\n\n<p>Sting is just alias to list of character.</p>\n\n<p>With <code>countListComp [[1,2,3],[3,2,1],[4,5,6]] []</code> is different problem. It doesn't count how many list you have. It count how many list equals to <code>[]</code> you have.</p>\n\n<p>If you try <code>countListComp [[1,2,3],[],[4,5,6]] []</code> or <code>countListComp [[1,2,3],[3,2,1],[4,5,6]] [3,2,1]</code> you get <code>1</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 3, "last_activity_date": 1542354480, "creation_date": 1542354480, "answer_id": 53333500, "question_id": 53333388, "link": "https://stackoverflow.com/questions/53333388/haskell-counting-the-number-of-occurrences-of-a-value-in-a-list/53333500#53333500", "title": "Haskell - counting the number of occurrences of a value in a list", "body": "<p>Try seeing what the first item in <code>\"she sells sea shells\"</code> is:</p>\n\n<pre><code>ghci&gt; head \"she sells sea shells\"\n=&gt; 's'\n</code></pre>\n\n<p>'s' is a Char, while \"s\" is a single-item [Char].</p>\n"}, {"tags": [], "owner": {"reputation": 521, "user_id": 6487607, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uxjSW.jpg?s=128&g=1", "display_name": "ozata", "link": "https://stackoverflow.com/users/6487607/ozata"}, "is_accepted": false, "score": 1, "last_activity_date": 1542355800, "creation_date": 1542355800, "answer_id": 53333792, "question_id": 53333388, "link": "https://stackoverflow.com/questions/53333388/haskell-counting-the-number-of-occurrences-of-a-value-in-a-list/53333792#53333792", "title": "Haskell - counting the number of occurrences of a value in a list", "body": "<p>In my opinion, you have two mistakes here. </p>\n\n<p>First, when you pass <code>[\"she sells sea shells\"]</code> to your function you actually pas a list of list of chars to your function. So function call should be as the following.</p>\n\n<pre><code>countListComp \"she sells sea shells\" &lt;second_parameter&gt;\n</code></pre>\n\n<p>Second problem in the function call is, String is a list of chars, and list in Haskell consists of a head and tail list. So when you pass <code>\"s\"</code> as string, instead of char, you actually pass <code>['s',[]]</code>. So the right function call should be:</p>\n\n<pre><code>countListComp \"she sells sea shells\" 's'\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 10605246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683bda86a4ff9594ad6e38ea0bfabdef?s=128&d=identicon&r=PG&f=1", "display_name": "Stormy", "link": "https://stackoverflow.com/users/10605246/stormy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4990, "favorite_count": 1, "accepted_answer_id": 53333494, "answer_count": 3, "score": 4, "last_activity_date": 1542355800, "creation_date": 1542353987, "question_id": 53333388, "link": "https://stackoverflow.com/questions/53333388/haskell-counting-the-number-of-occurrences-of-a-value-in-a-list", "title": "Haskell - counting the number of occurrences of a value in a list", "body": "<p>So still working through Haskell tutorial... </p>\n\n<p>One problem posed, is to write a function using:</p>\n\n<pre><code>count :: Eq a =&gt; [a] -&gt; a -&gt; Int\n</code></pre>\n\n<p>That can take a list of numbers &amp; a value, and tell you how many times the value you specify occurs in the list.</p>\n\n<p>It says to see if you can write it using List Comprehension, and again using Explicit Recursion... </p>\n\n<p>AND, to use it to not just count occurrences of numbers -- but of letters, for instance, how many times does 's' occur in 'she sells sea shells'.</p>\n\n<p>So I got:</p>\n\n<pre><code>countListComp :: Eq a =&gt; [a] -&gt; a -&gt; Int \ncountListComp [] find = 0\ncountListComp ys find = length xs\n    where xs = [xs | xs &lt;- ys, xs == find]\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>countRecursion :: Eq a =&gt; [a] -&gt; a -&gt; Int\ncountRecursion [] find = 0\ncountRecursion (x:xs) find \n    | find == x = 1 + (countRecursion xs find)\n    | otherwise = countRecursion xs find\n</code></pre>\n\n<p>So it's counting the occurrences of numbers in a list just fine, like so:</p>\n\n<pre><code>ghci &gt; countListComp [1,3,2,3,4,3] 3\n3\n\nghci &gt; countRecursion [6,9,7,9,8,9] 9\n3\n</code></pre>\n\n<p>but when i look for a specific letter, it does this:</p>\n\n<pre><code>ghci &gt; countListComp [\"she sells sea shells\"] \"s\"\n0\n\nghci &gt; countRecursion [\"she sells sea shells\"] \"s\"\n0\n</code></pre>\n\n<p>it also said to try to count something else 'countable', like how many lists are there... so I tried:</p>\n\n<pre><code>ghci &gt; countListComp [[1,2,3],[3,2,1],[4,5,6]] []\n0\n</code></pre>\n\n<p>is there something wrong with my code, or am I not specifying what to look for correctly?  I'm thinking it's the latter... because the following works:</p>\n\n<p>For example, looking for how many times 's' occurs in 'she sells sea shells'... do I <em>really</em> have to put each individual letter in quotes with a comma between??   Like:</p>\n\n<pre><code>ghci &gt; countRecursion ['s','h','e',' ','s','e','l','l','s',' ','s','e','a',' ','s','h','e','l','l','s'] 's'\n6\n</code></pre>\n\n<p>And do I have to look for a <em>specific</em> list?  Or is there a way to look for just a list with anything in it?</p>\n"}, {"tags": ["list", "haskell", "tuples", "replicate"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1542328683, "post_id": 53329755, "comment_id": 93539982, "body": "It&#39;s usually much clearer not to work with <code>fst</code> and <code>snd</code> (and definitely not with <code>head</code> or <code>!!</code>) but instead use <i>pattern matching</i> to get at the elements. And for doing stuff with elements of lists (be they tuples or something else), list comprehensions are syntactically very nice."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1542330354, "post_id": 53329755, "comment_id": 93540334, "body": "<code>f = (&gt;&gt;= uncurry replicate)</code> is the fancy-pants approach."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 1, "creation_date": 1542334828, "post_id": 53329755, "comment_id": 93541153, "body": "Your list is <code>ils</code> in <code>[s | (n,c) &lt;- ils, s &lt;- replicate n c]</code> produces the output you require."}, {"owner": {"reputation": 3063, "user_id": 439578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e032fbe640b2234c8dce244907b99eab?s=128&d=identicon&r=PG", "display_name": "Manoj R", "link": "https://stackoverflow.com/users/439578/manoj-r"}, "edited": false, "score": 0, "creation_date": 1542347051, "post_id": 53329755, "comment_id": 93543820, "body": "map returns the array of the same size. So in this example it will give you array on strings. To do it in one operation you need fold function, which gives the accumulated result."}], "answers": [{"tags": [], "owner": {"reputation": 2043, "user_id": 2676937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d42ec82c3feefc3c7e13b37dae77f21?s=128&d=identicon&r=PG", "display_name": "merlyn", "link": "https://stackoverflow.com/users/2676937/merlyn"}, "is_accepted": true, "score": 6, "last_activity_date": 1542330918, "creation_date": 1542330918, "answer_id": 53330097, "question_id": 53329755, "link": "https://stackoverflow.com/questions/53329755/get-the-first-elements-of-a-list-of-tuples/53330097#53330097", "title": "Get the first elements of a list of tuples", "body": "<p>Since you already know how to find the correct answer for a single element, all you need is a little recursion</p>\n\n<pre><code>func :: [(Int, a)] -&gt; [a]\nfunc [] = []\nfunc ((n, elem):rest) = (replicate n elem) ++ (func rest)\n</code></pre>\n\n<p>Mapping the values should also work. You just need to concatenate the resulting strings into one.</p>\n\n<pre><code>func :: [(Int, a)] -&gt; [a]\nfunc xs = concat $ map func2 xs where \n              func2 (n, elem) = replicate n elem\n</code></pre>\n\n<p>Or, if you are familiar with <a href=\"https://en.wikipedia.org/wiki/Currying\" rel=\"noreferrer\">currying</a>:</p>\n\n<pre><code>func :: [(Int, a)] -&gt; [a]\nfunc xs = concat $ map (uncurry replicate) xs\n</code></pre>\n\n<p>Finally, if you are comfortable using function composition, the definition becomes:</p>\n\n<pre><code>func :: [(Int, a)] -&gt; [a]\nfunc = concat . map (uncurry replicate)\n</code></pre>\n\n<p>Using <code>concat</code> and <code>map</code> is so common, there is a function to do just that. It's <code>concatMap</code>.</p>\n\n<pre><code>func :: [(Int, a)] -&gt; [a]\nfunc = concatMap (uncurry replicate)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1141, "user_id": 1367497, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c1ab83696683e53a9940cd2a8c480894?s=128&d=identicon&r=PG", "display_name": "peeyush singh", "link": "https://stackoverflow.com/users/1367497/peeyush-singh"}, "is_accepted": false, "score": 1, "last_activity_date": 1542331018, "creation_date": 1542331018, "answer_id": 53330107, "question_id": 53329755, "link": "https://stackoverflow.com/questions/53329755/get-the-first-elements-of-a-list-of-tuples/53330107#53330107", "title": "Get the first elements of a list of tuples", "body": "<p>You are correct about trying to use <code>map</code>. But first lets see why your code did not work</p>\n\n<pre><code>replicate  (fst ( head [(4,'a'), (1,'b')])) ( snd ( head [(4,'a'), (1,'b')]))\n</code></pre>\n\n<p>Your first parameter to replicate is the head of your list which is (4, 'a'). Then you are calling fst on this, thus the first parameter is 4. Same things happens with second parameter and you get 'a'. The result of which you see.</p>\n\n<p>Before using <code>map</code> lets try to do this with recursion. You want to take one element of list and apply replicate to it and then combine it with the result of applying replicate on the second element.</p>\n\n<pre><code>generate [] = []    \ngenerate (x:xs) = replicate (fst x) (snd x) ++ generate xs\n</code></pre>\n\n<p>Do note I am using pattern matching to get the first element of list. You can us the pattern matching to get the element inside the tuple as well, and then you would not need to use the fst/snd functions. Also note I am using pattern matching to define the base case of empty list.</p>\n\n<pre><code>generate [] = []\ngenerate ((x,y):xs) = replicate x y ++ generate xs\n</code></pre>\n\n<p>Now coming to map, so map will apply your function to every element of the list, here's the first try</p>\n\n<pre><code>generate (x,y) = replicate x y\nmap generate  xs\n</code></pre>\n\n<p>The result of the above will be slightly different from recursion. Think about it, map is going to apply generate to every element and store the result in a list. generate creates a list. So when you apply map you are creating a list of list. You can use concat to flatten it if you want, which will give you the same result as recursion.</p>\n\n<p>Last thing, if you can use recursion, then you can use fold as well. Fold will just apply a function to every element of the list and return the accumulated results (broadly speaking).</p>\n\n<pre><code>--first parameter is the function to apply, second is the accumulator, third is your list\nfoldr step [] xs\n   where step (x,y) acc = \n                   (replicate x y) ++ acc\n</code></pre>\n\n<p>Again here I have used pattern matching in the function step to extract the elements of the tuple out.</p>\n"}, {"tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": false, "score": 1, "last_activity_date": 1542377341, "last_edit_date": 1542377341, "creation_date": 1542376964, "answer_id": 53339360, "question_id": 53329755, "link": "https://stackoverflow.com/questions/53329755/get-the-first-elements-of-a-list-of-tuples/53339360#53339360", "title": "Get the first elements of a list of tuples", "body": "<p>Let</p>\n\n<pre><code>ls = [(4,'a'), (1,'b'), (2,'c'), (2,'a'), (1,'d'), (4,'e')] \n</code></pre>\n\n<p>in</p>\n\n<pre><code>concat [replicate i x | (i, x) &lt;- ls]\n</code></pre>\n\n<p>will give</p>\n\n<pre><code>\"aaaabccaadeeee\"\n</code></pre>\n\n<p>The point-free version</p>\n\n<pre><code>concat . map (uncurry replicate) \n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 10576445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81b94a92f173bb81e959362daf0424d3?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Joe", "link": "https://stackoverflow.com/users/10576445/tyler-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3580, "favorite_count": 0, "accepted_answer_id": 53330097, "answer_count": 3, "score": 1, "last_activity_date": 1542377341, "creation_date": 1542328147, "question_id": 53329755, "link": "https://stackoverflow.com/questions/53329755/get-the-first-elements-of-a-list-of-tuples", "title": "Get the first elements of a list of tuples", "body": "<p>I have this list of tuples</p>\n\n<pre><code>[(4,'a'), (1,'b'), (2,'c'), (2,'a'), (1,'d'), (4,'e')]\n</code></pre>\n\n<p>I want to get the first elements of every tuple then replicate it to make the following: \"aaaabccaadeeee\" </p>\n\n<p>I came up with this code, but it only gives me the replicate of the first tuple.</p>\n\n<pre><code>replicate  (fst ( head [(4,'a'), (1,'b')])) ( snd ( head [(4,'a'), (1,'b')]))\n--output is: \"aaaa\"\n</code></pre>\n\n<p>I was thinking to use map for to get the replicate of every tuple, but I didn't succeed.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1469, "user_id": 4876305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ymQ5f.jpg?s=128&g=1", "display_name": "Gabriel L.", "link": "https://stackoverflow.com/users/4876305/gabriel-l"}, "edited": false, "score": 4, "creation_date": 1542319208, "post_id": 53328448, "comment_id": 93537418, "body": "Point #1 is, as far as I know, a known bad aspect of Haskell records. At least some languages get around this by requiring you to use namespaces for record field accessor functions. I&#39;m sure there are other solutions too. As to point #2, I think this is where the Lens library starts becoming useful."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 5, "creation_date": 1542319209, "post_id": 53328448, "comment_id": 93537419, "body": "Regarding 1), I&#39;m not sure anyone has :) <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Records/OverloadedRecordFields\" rel=\"nofollow noreferrer\">This</a> might help, especially the <code>DuplicateRecordFields</code> extension. Regarding 2), <a href=\"https://hackage.haskell.org/package/lens-tutorial-1.0.3/docs/Control-Lens-Tutorial.html\" rel=\"nofollow noreferrer\">lenses</a> may help."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1542321714, "post_id": 53328448, "comment_id": 93538248, "body": "With respect to #1, both answers to <a href=\"https://stackoverflow.com/q/17478599/2751851\"><i>Name conflicts in Haskell records</i></a> are relevant."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 3, "creation_date": 1542322456, "post_id": 53328448, "comment_id": 93538465, "body": "I don&#39;t find I want to do nested record access very often; usually I will have pattern matched above. In addition to above suggestions I really like the <code>RecordWildCards</code> extension: it would let you do: <code>outerFunc Foo{..} =  ...  someFunction fooBar (2 * barBaz fooBar)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "is_accepted": false, "score": 2, "last_activity_date": 1542424765, "last_edit_date": 1542424765, "creation_date": 1542398963, "answer_id": 53344693, "question_id": 53328448, "link": "https://stackoverflow.com/questions/53328448/trouble-writing-readable-code-using-haskell-records/53344693#53344693", "title": "Trouble writing readable code using Haskell records", "body": "<p>One solution (as suggested in the comments) to the problem is to use lenses. Using the <code>microlens</code> and <code>microlens-th</code> packages (these might be simpler when you're getting started):</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FunctionalDependencies #-}\n{-# LANGUAGE FlexibleInstances #-}\n\nimport Data.List (nub)\nimport Lens.Micro ((^.), (^..))\nimport Lens.Micro.TH (makeFields)\n\nnewtype Name = Name String\n  deriving Eq\n\ndata Person = Person { _personName :: Name }\nmakeFields ''Person\n\ndata Species = Dog | Cat\n  deriving Eq\n\ndata Pet = Pet { _petName :: Name, _petSpecies :: Species }\nmakeFields ''Pet\n\n-- ^. is an infix operator for view\nuniquePersonNames :: [Person] -&gt; [Name]\nuniquePersonNames ps = nub (map (\\p -&gt; p ^. name) ps)\n\ndogs :: [Pet] -&gt; [Pet]\ndogs ps = filter (\\p -&gt; p ^. species == Dog) ps\n\ndata Concert = Concert\n  { _concertPerformers :: [Person]\n  , _concertAttendees :: [Person]\n  }\nmakeFields ''Concert\n\n-- ^.. is an infix operator for toListOf\nperformerNames :: Concert -&gt; [Name]\nperformerNames c = c ^.. performers . traverse . name\n\ndata House = House { _housePeople :: [Person], _housePet :: Pet}\nmakeFields ''House\n\nhouseSound :: House -&gt; String\nhouseSound h = case h ^. pet . species of\n    Dog -&gt; \"Woof!\"\n    Cat -&gt; \"Meow!\"\n</code></pre>\n\n<p>There are several resources out there to learn more about lenses and other kinds of optics. One particularly beginner friendly resource <a href=\"https://hackage.haskell.org/package/lens-tutorial-1.0.3/docs/Control-Lens-Tutorial.html\" rel=\"nofollow noreferrer\">Control.Lens.Tutorial</a>.</p>\n\n<p>Be warned that this approach can lead to type errors that are hard to understand (I believe the <code>generic-lens</code> library has better error messages, but I have not used it), especially if you start using things blindly. I suggest sticking to the basics (as presented in the linked tutorial) -- this will cover a large portion of your use cases.</p>\n"}], "owner": {"reputation": 61, "user_id": 10533467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d612c08d11ef4d2895329ab9adfa948a?s=128&d=identicon&r=PG&f=1", "display_name": "Nebuchadnezzar", "link": "https://stackoverflow.com/users/10533467/nebuchadnezzar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1542424765, "creation_date": 1542318958, "question_id": 53328448, "link": "https://stackoverflow.com/questions/53328448/trouble-writing-readable-code-using-haskell-records", "title": "Trouble writing readable code using Haskell records", "body": "<p>I'm fairly new to Haskell, and one thing I've been struggling with is writing readable code using records.  </p>\n\n<p>My specific problems are:</p>\n\n<ol>\n<li>I haven't found an effective strategy for dealing with name conflicts between fields in different record types.  I'm finding I want the same field in multiple different record types, and the name conflict issue is really annoying.  I end up choosing some prefix to put on all of my fields, which adds to verbosity and hinders readability.</li>\n<li>Using nested records results in really verbose code.  I find<br>\n<code>someFunction(foo.bar, 2 * foo.bar.baz)</code><br>\nin a language like Java or C++ to be pretty readable.  In Haskell I find myself writing this to accomplish the same thing<br>\n<code>someFunction (fooBar foo) (2 * barBaz (fooBar foo))</code><br>\nwhich is a lot harder to visually parse, and calls to functions with multiple arguments quickly become unreadable.  In order to make this more readable, I find myself defining intermediate values which are to extract fields from records, which is more readable, but adds more lines of code, so it hurts readability in a different way.  </li>\n</ol>\n\n<p>Is there a better way to use records that is more readable, or is there something I should be doing instead?  Just using tuples?  Writing functions with tons of parameters instead of grouping related values into records?  Something else?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 2, "creation_date": 1542303065, "post_id": 53324778, "comment_id": 93530332, "body": "I&#39;ll give you a hint. What is the type of the composition operator <code>(.)</code>?"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 2, "creation_date": 1542303834, "post_id": 53324778, "comment_id": 93530725, "body": "Remember that type of <code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code>. However <code>returnGreatest2</code> takes 4 parameters so it shall be applied with 3 parameters (until its type becomes <code>a -&gt; (a,a)</code> or as in the above type signature <code>(a -&gt; b)</code> and only then you can apply it to composition operator. Such as  <code>let x = sumOfSquares . returnGreatest 2 3 5</code> and then <code>x 7</code> will give you the result."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1542420704, "post_id": 53324778, "comment_id": 93573822, "body": "Here\u2019s a short derivation of how to convert compositions of multiple arguments like this to point-free form. <code>\\x y z -&gt; g ((f x y) z)</code> =(definition of composition)= <code>\\x y -&gt; g . f x y</code> =(rewrite in prefix)= <code>\\x y -&gt; ((.) g) ((f x) y)</code> =(definition of composition)= <code>\\ x -&gt; (.) g . f x</code> =(rewrite in prefix)= <code>\\x -&gt; ((.) ((.) g)) (f x)</code> =(definition of composition)= <code>(.) ((.) g) . f</code> =(<code>instance Functor ((-&gt;) a)</code>)= <code>fmap (fmap g) . f</code>. Here <code>g</code> = <code>sumOfSquares</code> and <code>f</code> = <code>returnGreatest2</code>. In general, to compose a 1-argument function with an <i>n</i>-argument function you need to <code>fmap</code> <i>n</i> \u2212 1 times."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1542415382, "post_id": 53324972, "comment_id": 93573073, "body": "I prefer to write the point-free version as <code>fmap (fmap sumOfSquares) . returnGreatest2</code>. The <code>fmap</code> is the same as <code>(.)</code> here (in the <code>(-&gt;) _</code> functor) but imo is clearer: each <code>fmap</code> \u201cmaps over\u201d one argument. Including extra parentheses for clarity, <code>fmap (fmap sumOfSquares)</code> is specialised to the type <code>(a -&gt; a -&gt; (a, a)) -&gt; (a -&gt; a -&gt; a)</code>, making it composable with <code>returnGreatest2 :: a -&gt; (a -&gt; a -&gt; (a, a))</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 5, "last_activity_date": 1542306423, "last_edit_date": 1542306423, "creation_date": 1542303103, "answer_id": 53324972, "question_id": 53324778, "link": "https://stackoverflow.com/questions/53324778/confusion-around-when-to-compose-and-when-to-use/53324972#53324972", "title": "Confusion around when to compose, and when to use $", "body": "<p>Composition and currying can be a little confusing. <code>sumOfSquares . returnGreatest2</code> is the same as <code>\\x -&gt; sumOfSquares (returnGreatest2 x)</code>, but the type of <code>returnGreatest2 x</code> is <code>(Ord a, Num a) =&gt; a -&gt; a -&gt; (a, a)</code>. You need to pass <em>all</em> expected arguments before you finally get a value of type <code>(Ord a, Num a) =&gt; (a, a)</code> that is acceptable by <code>sumOfSquares</code>.</p>\n\n<p>On the other hand, <code>sumOfSquares $ returnGreatest2 3 5 7</code> is parsed the same as <code>sumOfSquares $ (returnGreatest2 3 5 7)</code>; the <code>($)</code> operator has lower priority than function application (or any other operator, for that matter).</p>\n\n<p>To really compose the two functions, you need several layers of composition:</p>\n\n<pre><code>let f = ((sumOfSquares .) . ) . returnGreatest2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 841, "user_id": 4927711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98c32e7161133d8461c3d78fce3245ed?s=128&d=identicon&r=PG&f=1", "display_name": "DevNewb", "link": "https://stackoverflow.com/users/4927711/devnewb"}, "is_accepted": false, "score": 4, "last_activity_date": 1542303373, "creation_date": 1542303373, "answer_id": 53325056, "question_id": 53324778, "link": "https://stackoverflow.com/questions/53324778/confusion-around-when-to-compose-and-when-to-use/53325056#53325056", "title": "Confusion around when to compose, and when to use $", "body": "<p>Both sides of <code>(.)</code> function are expected to be a single argument functions so it treats <code>returnGreatest2</code> as a <code>a -&gt; (a -&gt; a -&gt; (a, a))</code>. But <code>sumOfSquares</code> does not accept <code>(a -&gt; a -&gt; (a, a))</code> as an argument. One way to do it is to use <code>$</code> like you did and apply all the arguments, but you can also state first two arguments explicitly:</p>\n\n<pre><code>let x a b = sumOfSquares . returnGreatest2 a b\nx :: (Num c, Ord c) =&gt; c -&gt; c -&gt; c -&gt; c\n</code></pre>\n\n<p>this way the types will match.</p>\n"}, {"tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": false, "score": 2, "last_activity_date": 1542307235, "creation_date": 1542307235, "answer_id": 53325979, "question_id": 53324778, "link": "https://stackoverflow.com/questions/53324778/confusion-around-when-to-compose-and-when-to-use/53325979#53325979", "title": "Confusion around when to compose, and when to use $", "body": "<p>You can try this</p>\n\n<pre><code>sumOfSquares . returnGreatest2 3 5 $ 7\n</code></pre>\n\n<p><code>$</code> has te lowest priority. <code>returnGreatest2 3 5</code> is the function <code>returnGreatest2</code> partially applied to <code>3</code> and <code>5</code> so still a function which accepts a single variable. So now you have two functions which accept a single variable: </p>\n\n<ul>\n<li><code>sumOfSquares</code></li>\n<li><code>returnGreatest2 3 5</code></li>\n</ul>\n\n<p>You can compose them with <code>.</code> which is what <code>.</code> is meant for: composing functions with a single variable in and a single variable out. </p>\n"}], "owner": {"reputation": 3135, "user_id": 4372759, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/6zzjk.jpg?s=128&g=1", "display_name": "flybonzai", "link": "https://stackoverflow.com/users/4372759/flybonzai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 53324972, "answer_count": 3, "score": 2, "last_activity_date": 1542307235, "creation_date": 1542302315, "last_edit_date": 1542303586, "question_id": 53324778, "link": "https://stackoverflow.com/questions/53324778/confusion-around-when-to-compose-and-when-to-use", "title": "Confusion around when to compose, and when to use $", "body": "<pre><code>returnGreater :: (Ord a) =&gt; a -&gt; a -&gt; a\nreturnGreater a b\n  | (a &gt; b) = a\n  | otherwise = b\n\nreturnGreatest2 :: (Ord a, Num a) =&gt; a -&gt; a -&gt; a -&gt; (a, a)\nreturnGreatest2 a b c\n  | (a &gt; b) = (a, returnGreater b c)\n  | otherwise = (b, returnGreater a c)\n\nsumOfSquares :: (Num a) =&gt; (a, a) -&gt; a\nsumOfSquares (a, b) = a^2 + b^2\n</code></pre>\n\n<p>Given the above functions, I'm confused why <code>let x = sumOfSquares . returnGreatest2</code> returns</p>\n\n<pre><code>&lt;interactive&gt;:13:24: error:\n    \u2022 Couldn't match type \u2018a -&gt; a -&gt; (a, a)\u2019 with \u2018(c, c)\u2019\n      Expected type: a -&gt; (c, c)\n        Actual type: a -&gt; a -&gt; a -&gt; (a, a)\n    \u2022 Probable cause: \u2018returnGreatest2\u2019 is applied to too few arguments\n      In the second argument of \u2018(.)\u2019, namely \u2018returnGreatest2\u2019\n      In the expression: sumOfSquares . returnGreatest2\n      In an equation for \u2018x\u2019: x = sumOfSquares . returnGreatest2\n    \u2022 Relevant bindings include\n        x :: a -&gt; c (bound at &lt;interactive&gt;:13:5)\n</code></pre>\n\n<p>but <code>sumOfSquares $ returnGreatest2 3 5 7</code> does the right thing.  Since the type coming out of <code>returnGreatest2</code> is the same as the type <code>sumOfSquares</code> expects, I would think I'd be able to compose them.</p>\n"}, {"tags": ["list", "haskell", "reverse"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542299264, "post_id": 53323747, "comment_id": 93528190, "body": "It doesn&#39;t mean &quot;call <code>reverse</code> after you prepend each itme&quot;; that&#39;s no better than using <code>++</code> to append the item. Instead, it means that if you want to build up a list by adding new items to the end, you should put them at the beginning instead, and call reverse once it is time to consume the entire list."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10641593"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542299457, "post_id": 53323747, "comment_id": 93528291, "body": "@chepner - So in this case, if I wanted to just add <code>69</code> to the list, have I done it correctly in accordance with the quote? Which also makes me wonder, how would you add more than one element to the beginning of the list? Guess that&#39;s another exercise to try out."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542300903, "post_id": 53323747, "comment_id": 93529119, "body": "It really depends on how you intend to use the list. See my answer for an example."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1542301591, "post_id": 53323747, "comment_id": 93529542, "body": "There are times you must definitelly append a list to another list and to make it worse you may need to append new lists to the resulting one several thousands of times. This will be a very costly operation. To overcome this cost difference list data structures are used. <a href=\"https://stackoverflow.com/q/13879260/4543207\">This question is all about that</a>"}, {"owner": {"reputation": 1155, "user_id": 962394, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/97268298c366b07e5556567639105ee1?s=128&d=identicon&r=PG", "display_name": "codeshot", "link": "https://stackoverflow.com/users/962394/codeshot"}, "edited": false, "score": 0, "creation_date": 1542358595, "post_id": 53323747, "comment_id": 93548003, "body": "This isn&#39;t really a question about haskell, it&#39;s a question about a stackoverflow question. Adding the tag makes it harder to find questions about haskell. It&#39;s also not a question about &quot;add&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10641593"}, "reply_to_user": {"reputation": 1155, "user_id": 962394, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/97268298c366b07e5556567639105ee1?s=128&d=identicon&r=PG", "display_name": "codeshot", "link": "https://stackoverflow.com/users/962394/codeshot"}, "edited": false, "score": 0, "creation_date": 1542390391, "post_id": 53323747, "comment_id": 93564715, "body": "@codeshot - The question is about <code>Haskell</code>. Before asking my question, I did my research, and came across that answer, and decided to try for myself. I did what was recommended by SO. I asked a question to make sure I was going in the right direction. I&#39;m new to <code>Haskell</code>, and languages change, so I wanted to make sure I&#39;m on the right track. One of the topics introduced in LHftGG is <code>List</code>. Coming from an OOP background, I asked myself how I can <code>add</code>/<code>remove</code> items from a list. Questions about other SO questions happen all time. It&#39;s about researching and learning."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542301584, "post_id": 53324315, "comment_id": 93529540, "body": "The sharp-eyed reader might notice I left out a <code>peek :: Queue a -&gt; a</code> function. Ensuring that a series of <code>peek</code> operations doesn&#39;t have to repeatedly scan through the incoming list when the outgoing list is empty complicates the other two functions in ways I didn&#39;t want to deal with for this answer. The solution is to ensure that neither <code>addToQueue</code> nor <code>removeFromQueue</code> can return a queue whose outgoing list is empty."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542311819, "post_id": 53324315, "comment_id": 93534433, "body": "(Unless the queue itself is empty, that is.)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1542317288, "post_id": 53324315, "comment_id": 93536641, "body": "The amortized analysis of <i>that</i> queue only holds up when the queue is used ephemerally. In a persistent application, the rotations need to be done somewhat differently."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1542301229, "last_edit_date": 1542301229, "creation_date": 1542300754, "answer_id": 53324315, "question_id": 53323747, "link": "https://stackoverflow.com/questions/53323747/adding-an-element-to-a-list-and-then-reverse-it/53324315#53324315", "title": "Adding an element to a list and then reverse it", "body": "<p>You need to distinguish between the linked list data structure and whatever list-like data type you are implementing with the linked list. You can do exactly two things to modify a linked list: prepend a new head to the list, and remove the current head (if the linked list isn't empty).</p>\n\n<p>The use case the quote talks about is common for a queue data type: you can add to one end and remove from the other end. You can implement this using <em>two</em> linked lists, by adding new elements to one list and removing elements from the other. The implementation of the queue takes care of reversing as necessary to ensure that you never remove an item before every other item inserted previously is removed.</p>\n\n<pre><code>data Queue a = Queue [a] [a]\n\n-- Put new elements on the incoming list.\naddToQueue :: a -&gt; Queue a -&gt; Queue a\naddToQueue x (Queue incoming outgoing) = Queue (x:incoming) outgoing\n\n-- Take elements from the outgoing list, whose elements are stored\n-- in the reverse order that they were added to the incoming list\n-- previously.\nremoveFromQueue :: Queue a -&gt; (a, Queue a)\nremoveFromQueue (Queue [] []) = error \"Cannot remove from empty queue\"\nremoveFromQueue (Queue incoming (x:xs)) = (x, Queue incoming xs)\nremoveFromQueue (Queue incoming []) = removeFromQueue (Queue [] (reverse incoming))\n</code></pre>\n\n<p>(We're not concerned with good ways to deal with removing from an empty queue here; just call it an error and leave it at that.)</p>\n\n<p>Adding to the incoming list and removing from the outgoing list is easy. The tricky part is how and when we transfer items from the incoming list to the outgoing list. We only do so when the outgoing list is empty, and when it is, we transfer the <em>entire</em> incoming list at once, reversing it in the process. In other words, we're building up the incoming list in reverse,\nbut only ever reverse it when necessary, not after each and every single item is added.</p>\n\n<p>Amortized analysis can be used to show that although <code>reverse</code> <em>could</em> be slow, it is balanced by the number of fast operations that precede and can follow it.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10641593"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 53324315, "answer_count": 1, "score": 1, "last_activity_date": 1542390581, "creation_date": 1542298903, "last_edit_date": 1542390581, "question_id": 53323747, "link": "https://stackoverflow.com/questions/53323747/adding-an-element-to-a-list-and-then-reverse-it", "title": "Adding an element to a list and then reverse it", "body": "<p>I'm <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">learning Haskell</a>, and attempting to understand lists.</p>\n\n<p>From researching, to add an element to a list, you would normally do:</p>\n\n<pre><code>let numbers = [4,8,15,16,23,42] \nnumbers ++ [56]\n</code></pre>\n\n<p>but to quote <a href=\"https://stackoverflow.com/a/53123141/10641593\">this answer</a>:</p>\n\n<blockquote>\n  <p>If you need to do this, there is usually a better way to structure\n  your algorithm. For example, you can build your <code>list</code> in reverse order\n  (adding elements at the beginning) and only call <code>reverse</code> at the end.</p>\n</blockquote>\n\n<p><strong>Code</strong>:</p>\n\n<pre><code>let numbers = [23,43,56]\nlet newNumbers = 69:numbers\nreverse newNumbers\n</code></pre>\n\n<p><strong>Output</strong>:</p>\n\n<pre><code>[56,43,23,69]\n</code></pre>\n\n<p><strong>Question</strong>:</p>\n\n<ol>\n<li>Is the code I've written correct according to the quoted answer?</li>\n<li>I want to understand the terminology a little better, can I say I'm adding elements to the <code>head</code> of the <code>list</code>? From my understanding,  every new element would be the first element, and the value returned when I write <code>head newNumbers</code>.</li>\n</ol>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1542288209, "post_id": 53320010, "comment_id": 93520892, "body": "<code>b</code> is not a list, but a polymorphic list: for each type, <code>b</code> produces a list. Potentially, the length of <code>b</code> could depend on the type (OK, not on this class, but that&#39;s immaterial). So, we need to use <code>length (b :: [SomeType])</code>."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 2, "creation_date": 1542289803, "post_id": 53320010, "comment_id": 93521829, "body": "&quot;<i>why it is possible to create list from values zer and one</i>&quot; - it isn&#39;t. You haven&#39;t actually created a concrete list yet, you defined <code>b</code> with a polymorphic type. You can&#39;t e.g. print it either. When you want to use <code>b</code>, you need to tell the program which type it should use - if it cannot infer it from something else, e..g in the expression <code>True : b</code> or <code>0 : b</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1542293437, "post_id": 53320010, "comment_id": 93524223, "body": "The type checker lets you &quot;pass the buck&quot; on the specific instance of <code>Bits</code> to use if the <code>Bits</code> constraint remains in the final value. Consider <code>map id b</code>, which has type <code>Bits a =&gt; [a]</code>. The use of <code>length</code>, though, forces a decision to be made, because the <code>Bits</code> constraint is not passed on; as far as the type checker is concerned, <code>length</code> might do something that requires a specific instance."}], "answers": [{"comments": [{"owner": {"reputation": 36366, "user_id": 371739, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6e42063400331743a848740f8827c90e?s=128&d=identicon&r=PG", "display_name": "Owen", "link": "https://stackoverflow.com/users/371739/owen"}, "edited": false, "score": 0, "creation_date": 1542301204, "post_id": 53322187, "comment_id": 93529306, "body": "The part I&#39;m confused about is why Haskell wants to infer a monomorphic type for <code>len</code> rather than the polymorphic type <code>(Bits a) =&gt; Integer</code>"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "reply_to_user": {"reputation": 36366, "user_id": 371739, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6e42063400331743a848740f8827c90e?s=128&d=identicon&r=PG", "display_name": "Owen", "link": "https://stackoverflow.com/users/371739/owen"}, "edited": false, "score": 1, "creation_date": 1542319626, "post_id": 53322187, "comment_id": 93537570, "body": "@Owen Because <code>Integer</code> is not a polymorphic type. The type variable needs to appear on the right hand side."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "reply_to_user": {"reputation": 36366, "user_id": 371739, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6e42063400331743a848740f8827c90e?s=128&d=identicon&r=PG", "display_name": "Owen", "link": "https://stackoverflow.com/users/371739/owen"}, "edited": false, "score": 0, "creation_date": 1542319742, "post_id": 53322187, "comment_id": 93537607, "body": "@Owen You could define <code>len :: Bits a =&gt; [a] -&gt; Integer; len = length</code>, but still when you would call <code>len b</code> the compiler has exactly the same problem as with <code>show</code> and <code>read</code>."}, {"owner": {"reputation": 36366, "user_id": 371739, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6e42063400331743a848740f8827c90e?s=128&d=identicon&r=PG", "display_name": "Owen", "link": "https://stackoverflow.com/users/371739/owen"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1542331896, "post_id": 53322187, "comment_id": 93540638, "body": "@Bergi Ah ok, I see, thank you. Though, I will add that with <code>(Bits a) =&gt; Integer</code> is not ill-defined, it&#39;s just unusable, and with <code>AllowAmbiguousTypes</code> Haskell does allow it."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 3, "last_activity_date": 1542296478, "last_edit_date": 1542296478, "creation_date": 1542293837, "answer_id": 53322187, "question_id": 53320010, "link": "https://stackoverflow.com/questions/53320010/haskell-ad-hoc-polymorphism-on-values-calculating-the-length-of-list-of-ad-hoc/53322187#53322187", "title": "Haskell ad-hoc polymorphism on values, calculating the length of list of ad-hoc polymorphism", "body": "<p>It's perhaps a little easier to understand the meaning of this error in the following example:</p>\n\n<pre><code>roundTrip :: String -&gt; String\nroundTrip = show . read\n</code></pre>\n\n<p>So <code>roundTrip</code> <code>read</code>s a <code>String</code>, and then <code>show</code>s it back into a (presumably identical) <code>String</code>.</p>\n\n<p>But <code>read</code> is a polymorphic function: it parses the input string in a manner that depends on the output type. Parsing an <code>Int</code> is a rather different ask than parsing a <code>Bool</code>!</p>\n\n<p>The elaborator decides which concrete implementation of <code>read</code> to use by looking at the inferred return type of <code>read</code>. But in the expression <code>show . read</code>, the intermediate type could be any type <code>a</code> which implements both <code>Show</code> and <code>Read</code>. How is the compiler supposed to choose an implementation?</p>\n\n<p>You might argue that in your example it doesn't matter because <code>length :: [a] -&gt; Int</code> treats its type argument uniformly. <code>length [zer]</code> is always <code>1</code>, no matter which instance of <code>Bits</code> you're going through. That sort of situation is difficult for a compiler to detect in general, though, so it's simpler and more predictable to just always reject ambiguous types.</p>\n\n<p>You can fix the issue by giving a concrete type annotation.</p>\n\n<pre><code>&gt; length ([zer] :: [Bool])\n1\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 4109398, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d164617fb1f1cbcbf31d57715fe8d5e3?s=128&d=identicon&r=PG&f=1", "display_name": "lukas kiss", "link": "https://stackoverflow.com/users/4109398/lukas-kiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 1, "accepted_answer_id": 53322187, "answer_count": 1, "score": 2, "last_activity_date": 1542320769, "creation_date": 1542286676, "last_edit_date": 1542320769, "question_id": 53320010, "link": "https://stackoverflow.com/questions/53320010/haskell-ad-hoc-polymorphism-on-values-calculating-the-length-of-list-of-ad-hoc", "title": "Haskell ad-hoc polymorphism on values, calculating the length of list of ad-hoc polymorphism", "body": "<p>I am trying to understand one phenomenon from my code below:</p>\n\n<pre><code>{-# LANGUAGE NoMonomorphismRestriction #-}\n\nimport Control.Arrow\nimport Control.Monad\nimport Data.List\nimport qualified Data.Map as M\nimport Data.Function\nimport Data.Ratio\n\nclass (Show a, Eq a) =&gt; Bits a where\n    zer :: a\n    one :: a\n\ninstance Bits Int where\n    zer = 0\n    one = 1\n\ninstance Bits Bool where\n    zer = False\n    one = True\n\ninstance Bits Char where\n    zer = '0'\n    one = '1'\n</code></pre>\n\n<p>When I try this:</p>\n\n<pre><code>b = zer:[]\n</code></pre>\n\n<p>It works perfectly, but when I try:</p>\n\n<pre><code>len = length b\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>&lt;interactive&gt;:78:8: error:\n    \u2022 Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018b\u2019\n      prevents the constraint \u2018(Bits a0)\u2019 from being solved.\n      Probable fix: use a type annotation to specify what \u2018a0\u2019 should be.\n      These potential instances exist:\n        instance [safe] Bits Bool -- Defined at main.hs:18:10\n        instance [safe] Bits Char -- Defined at main.hs:22:10\n        instance [safe] Bits Int -- Defined at main.hs:14:10\n    \u2022 In the first argument of \u2018length\u2019, namely \u2018b\u2019\n      In the expression: length b\n      In an equation for \u2018it\u2019: it = length b\n</code></pre>\n\n<p>Can someone explain to me why it is possible to create list from values <strong>zer</strong> and <strong>one</strong>, but if I want to calculate length of the list I get an error?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1542305746, "post_id": 53319462, "comment_id": 93531688, "body": "Doing what you ask requires rather more machinery than you might guess at first. See <a href=\"http://hackage.haskell.org/package/dependent-map-0.2.4.0/docs/Data-Dependent-Map.html\" rel=\"nofollow noreferrer\">dependent-map</a> for a complete, worked example. It is definitely not something you&#39;d want to embark on as a beginner still trying to learn the language."}], "answers": [{"comments": [{"owner": {"reputation": 11251, "user_id": 9558399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RFQOg.jpg?s=128&g=1", "display_name": "bugs", "link": "https://stackoverflow.com/users/9558399/bugs"}, "edited": false, "score": 0, "creation_date": 1542286115, "post_id": 53319673, "comment_id": 93519650, "body": "Ok that makes sense. So how would I go about creating a map which accepts a <code>Maybe</code> of any type for its keys?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 11251, "user_id": 9558399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RFQOg.jpg?s=128&g=1", "display_name": "bugs", "link": "https://stackoverflow.com/users/9558399/bugs"}, "edited": false, "score": 0, "creation_date": 1542286151, "post_id": 53319673, "comment_id": 93519677, "body": "@bugs What&#39;s your use case? I.e. if you had such a thing, what would you use it for?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 11251, "user_id": 9558399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RFQOg.jpg?s=128&g=1", "display_name": "bugs", "link": "https://stackoverflow.com/users/9558399/bugs"}, "edited": false, "score": 2, "creation_date": 1542286284, "post_id": 53319673, "comment_id": 93519755, "body": "@bugs You are essentially asking for an untyped map (or at least partially untyped). In Haskell, we like to avoid such things as much as possible (even if we might achieve something similar with <code>Dynamic</code>)."}, {"owner": {"reputation": 11251, "user_id": 9558399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RFQOg.jpg?s=128&g=1", "display_name": "bugs", "link": "https://stackoverflow.com/users/9558399/bugs"}, "edited": false, "score": 0, "creation_date": 1542289264, "post_id": 53319673, "comment_id": 93521468, "body": "@melpomene to be honest, it was just a learning exercise. I&#39;ll update the question with more details"}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 4, "last_activity_date": 1542285438, "creation_date": 1542285438, "answer_id": 53319673, "question_id": 53319462, "link": "https://stackoverflow.com/questions/53319462/how-to-create-a-generic-map/53319673#53319673", "title": "How to create a generic Map", "body": "<p>A type like <code>Map (Maybe a) [a]</code> means whoever uses this variable gets to decide what type to use for <code>a</code>. That doesn't work with your <code>genericMap</code> definition because it tries to put <code>Bool</code> values in there, and I might want to use it at some other type.</p>\n\n<p><code>genericMap2</code> is OK because it uses polymorphic constants: <code>1 :: (Num a) =&gt; a</code>, so it can be used at any (numeric) type, unlike <code>True :: Bool</code>, which has a fixed type.</p>\n"}], "owner": {"reputation": 11251, "user_id": 9558399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RFQOg.jpg?s=128&g=1", "display_name": "bugs", "link": "https://stackoverflow.com/users/9558399/bugs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 53319673, "answer_count": 1, "score": 0, "last_activity_date": 1542289566, "creation_date": 1542284656, "last_edit_date": 1542289566, "question_id": 53319462, "link": "https://stackoverflow.com/questions/53319462/how-to-create-a-generic-map", "title": "How to create a generic Map", "body": "<p>I can create a simple Map from <code>Int</code> to <code>[Bool]</code> like this</p>\n\n<pre><code>import Data.Map (Map)\nimport qualified Data.Map as Map\n\nsimpleMap :: Map Int [Bool]\nsimpleMap = \n  Map.insert 1 [True, False] .\n  Map.insert 1 [False, True] $ Map.empty\n</code></pre>\n\n<p>the compiler than tells me that the type of this map is</p>\n\n<pre><code>simpleMap :: Map Int [Bool]\n</code></pre>\n\n<p>and this is all very good.</p>\n\n<p>Now, I want to create a more generic Map from <code>Just a</code> to <code>[a]</code>, if I write something like </p>\n\n<pre><code>genericMap :: Map (Maybe a) [a]\n\ngenericMap = \n  Map.insert (Just True) [True, False] .\n  Map.insert (Just False) [False, True] $ Map.empty\n</code></pre>\n\n<p>I get the following compile error</p>\n\n<blockquote>\n<pre><code>* Couldn't match type `a' with `Bool'\n  `a' is a rigid type variable bound by\n    the type signature for:\n      genericMap :: forall a. Map (Maybe a) [a]\n    at test.hs:23:1-31\n  Expected type: Map (Maybe a) [a]\n    Actual type: Map (Maybe Bool) [Bool]\n</code></pre>\n</blockquote>\n\n<p>However, something like this compiles fine</p>\n\n<pre><code>genericMap2 :: (Ord a, Num a) =&gt; Map (Maybe a) [a]\n\ngenericMap2 = \n  Map.insert (Just 1) [1, 2] .\n  Map.insert (Just 2) [3, 4] $ Map.empty\n</code></pre>\n\n<p>What am I doing wrong here?</p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>The whole point of this was just a learning exercise. Ideally I'd like to create a <code>HigherMap</code> data type that looks like this (in pseudo code):</p>\n\n<pre><code>{\n  Just 1 -&gt; [1, 2, 3],\n  Just True -&gt; [True, False],\n  Just \"abc\" -&gt; [\"def\", \"ghi\"]\n}\n</code></pre>\n\n<p>where both the key and the value come from type constructors, and I capture the information that both type arguments are the same.</p>\n"}, {"tags": ["haskell", "io"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1542286097, "post_id": 53319338, "comment_id": 93519638, "body": "This is too vague. You want to replace <code>mapM_</code> with &quot;something I can work with&quot;, which could be anything at all. You should clarify your goal. Note that you already have a list: <code>resp</code>. You can work with that without <code>mapM_</code>, if you want. E.g. you can write <code>resp</code> to a file."}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1542290516, "post_id": 53319338, "comment_id": 93522325, "body": "If you need to work with mutable structure, e.g. <a href=\"http://hackage.haskell.org/package/array-0.5.2.0/docs/Data-Array-ST.html#t:STArray\" rel=\"nofollow noreferrer\">STArray</a>, you may find that the functions like mapM_, forM_ or etc are useful."}], "answers": [{"comments": [{"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1542297582, "post_id": 53319835, "comment_id": 93527061, "body": "@chi: it is vague. Sorry. [at]Arrowd understood. That was the answer I was looking for. Was trying to get it out of the Monad, but then realized that that is impossible."}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 0, "last_activity_date": 1542286075, "creation_date": 1542286075, "answer_id": 53319835, "question_id": 53319338, "link": "https://stackoverflow.com/questions/53319338/haskell-mapm-to-other-format/53319835#53319835", "title": "Haskell mapM_ to other format", "body": "<p>Well, you just pass a function you want instead of <code>print</code>. Either using lambda, for simple things:</p>\n\n<pre><code>mapM_ (\\tool -&gt; ...) resp\n</code></pre>\n\n<p>or as separate IO action:</p>\n\n<pre><code>doSomethingWithTool :: Tool -&gt; IO ()\ndoSomethingWithTool tool = do\n  ...\n  return ()\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>mapM_ doSomethingWithTool resp\n</code></pre>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 53319835, "answer_count": 1, "score": 0, "last_activity_date": 1542289152, "creation_date": 1542284224, "last_edit_date": 1542289152, "question_id": 53319338, "link": "https://stackoverflow.com/questions/53319338/haskell-mapm-to-other-format", "title": "Haskell mapM_ to other format", "body": "<p>Although I have the feeling I am progressing in Haskell I am still not a hundred percent comfortable with contexts. Take the code here:</p>\n\n<pre><code>extractData :: IO ()\nextractData = do\n  id &lt;- getLine\n  let userToolIDSelect = (read id) :: Int\n  connection &lt;- open \"tools.db\"\n  resp &lt;- query connection \"SELECT * FROM tools WHERE toolID = (?);\"\n    (Only userToolIDSelect) :: IO [Tool]\n  mapM_ print resp\n</code></pre>\n\n<p>Works fine, but how I can use <code>mapM_</code> to generate something I can work with? I can only get it to print to the console, but I would like to have eg. a list back so I can write it to a  file and import it in another file for processing... \nThe number of possibilities and libraries in Haskell dazzles me a bit and makes me loose focus sometimes. Think this is that time again..</p>\n"}, {"tags": ["database", "sqlite", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1542280191, "post_id": 53318102, "comment_id": 93516166, "body": "You sir, are brilliant! Thanks so much!"}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 0, "last_activity_date": 1542280037, "creation_date": 1542280037, "answer_id": 53318102, "question_id": 53317710, "link": "https://stackoverflow.com/questions/53317710/haskell-sqlite-simple-user-generated-query/53318102#53318102", "title": "Haskell SQLite-Simple user-generated query", "body": "<p><code>query_</code> function doesn't perform substitution. Replace it with the <code>query</code> function and it should work.</p>\n\n<p>Relevant docs: <a href=\"https://www.stackage.org/haddock/lts-12.18/sqlite-simple-0.4.16.0/Database-SQLite-Simple.html#v:query_\" rel=\"nofollow noreferrer\">https://www.stackage.org/haddock/lts-12.18/sqlite-simple-0.4.16.0/Database-SQLite-Simple.html#v:query_</a></p>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 53318102, "answer_count": 1, "score": 1, "last_activity_date": 1542280037, "creation_date": 1542278863, "question_id": 53317710, "link": "https://stackoverflow.com/questions/53317710/haskell-sqlite-simple-user-generated-query", "title": "Haskell SQLite-Simple user-generated query", "body": "<p>With the code below I get an error on the number of arguments, although the documentation says it should be exactly so:</p>\n\n<pre><code>extractData :: IO ()\nextractData = do\n  userToolIDSelect &lt;- getLine\n  connection &lt;- open \"tools.db\"\n  resp &lt;- query_ connection \"SELECT * FROM tools WHERE toolID = (?)\" (Only userToolIDSelect) :: IO [Tool]\n  mapM_ print resp\n</code></pre>\n\n<p>But if I modify the code to have a fixed ID parameter like so: \n<code>resp &lt;- query_ connection \"SELECT * FROM tools WHERE toolID = 1;\" :: IO [Tool]</code> it works fine.</p>\n\n<p>Any idea what I am doing wrong?</p>\n"}, {"tags": ["function", "haskell", "definition"], "comments": [{"owner": {"reputation": 3063, "user_id": 439578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e032fbe640b2234c8dce244907b99eab?s=128&d=identicon&r=PG", "display_name": "Manoj R", "link": "https://stackoverflow.com/users/439578/manoj-r"}, "edited": false, "score": 0, "creation_date": 1542281377, "post_id": 53317652, "comment_id": 93516860, "body": "what do you mean by can&#39;t do? is it giving error?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10455741, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-v7rxsU0kEFI/AAAAAAAAAAI/AAAAAAAAC0I/dFp9X1Ign_c/photo.jpg?sz=128", "display_name": "&#193;d&#225;m Fejes", "link": "https://stackoverflow.com/users/10455741/%c3%81d%c3%a1m-fejes"}, "edited": false, "score": 0, "creation_date": 1542296147, "post_id": 53318603, "comment_id": 93526109, "body": "Thank you for your help! I needed this kind of answer!"}], "tags": [], "owner": {"reputation": 3063, "user_id": 439578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e032fbe640b2234c8dce244907b99eab?s=128&d=identicon&r=PG", "display_name": "Manoj R", "link": "https://stackoverflow.com/users/439578/manoj-r"}, "is_accepted": true, "score": 2, "last_activity_date": 1542282420, "last_edit_date": 1542282420, "creation_date": 1542281787, "answer_id": 53318603, "question_id": 53317652, "link": "https://stackoverflow.com/questions/53317652/haskell-group-definition-with-span-function/53318603#53318603", "title": "Haskell group definition with span function", "body": "<p>Try this. </p>\n\n<pre><code> group' (x:xs) = a:(group' b) where (a,b) = span (==x) (x:xs)\n</code></pre>\n\n<p>Span simply returns two lists, which are separated using the given function.</p>\n"}, {"comments": [{"owner": {"reputation": 723, "user_id": 2304450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ce721084b7b5695199a865ba12afeb3?s=128&d=identicon&r=PG", "display_name": "GavinoGrifoni", "link": "https://stackoverflow.com/users/2304450/gavinogrifoni"}, "edited": false, "score": 0, "creation_date": 1542283528, "post_id": 53318952, "comment_id": 93518129, "body": "Of course my final expression could be further simplified by avoid using <code>fst</code> and <code>snd</code> as @manoj-r did, but I was more interested in showing you the steps I followed in my mind to get there."}, {"owner": {"reputation": 3, "user_id": 10455741, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-v7rxsU0kEFI/AAAAAAAAAAI/AAAAAAAAC0I/dFp9X1Ign_c/photo.jpg?sz=128", "display_name": "&#193;d&#225;m Fejes", "link": "https://stackoverflow.com/users/10455741/%c3%81d%c3%a1m-fejes"}, "edited": false, "score": 0, "creation_date": 1542296178, "post_id": 53318952, "comment_id": 93526136, "body": "Thanks you for your help, it was very useful to show the full method how to do it!"}], "tags": [], "owner": {"reputation": 723, "user_id": 2304450, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8ce721084b7b5695199a865ba12afeb3?s=128&d=identicon&r=PG", "display_name": "GavinoGrifoni", "link": "https://stackoverflow.com/users/2304450/gavinogrifoni"}, "is_accepted": false, "score": 2, "last_activity_date": 1542283213, "last_edit_date": 1542283213, "creation_date": 1542282909, "answer_id": 53318952, "question_id": 53317652, "link": "https://stackoverflow.com/questions/53317652/haskell-group-definition-with-span-function/53318952#53318952", "title": "Haskell group definition with span function", "body": "<p>Looking at the definition of <code>span</code> in <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-List.html#v:span\" rel=\"nofollow noreferrer\">hackage</a>, we find this useful hint: </p>\n\n<blockquote>\n  <p>span p xs is equivalent to (takeWhile p xs, dropWhile p xs)</p>\n</blockquote>\n\n<p>So, as you defined your function as </p>\n\n<pre><code>group' [] = []\ngroup' (x:xs) = (x : takeWhile (==  x) xs) : group' (dropWhile (== x) xs) \n</code></pre>\n\n<p>You can easily see that your <code>p</code> in this case is <code>(== x)</code>. So, replacing it in the span definition above</p>\n\n<pre><code>span p xs = (takeWhile p xs, dropWhile p xs)\nspan (== x) xs = (takeWhile (== x) xs, dropWhile (== x) xs)\n</code></pre>\n\n<p>span returns a pair of lists, so you can access them with <code>fst</code> and <code>snd</code>.\nSo we have that</p>\n\n<pre><code>takeWhile (== x) xs = fst (span (== x) xs) \n</code></pre>\n\n<p>and </p>\n\n<pre><code>dropWhile (== x) xs = snd (span (== x) xs) \n</code></pre>\n\n<p>Using this, we can then replace them in your original function like so:</p>\n\n<pre><code>group' [] = []    \ngroup' (x:xs) = (x : fst (span (== x) xs) ) : group' (snd (span (== x) xs) ) \n</code></pre>\n\n<p>Of course it's not nice to call the same function with the same arguments twice (<code>span (== x) xs</code>), so let's call it just once with a <code>let</code> binding:</p>\n\n<pre><code>group' [] = []\ngroup' (x:xs) = let s = span (== x) xs in (x : (fst s)) : group' (snd s)\n</code></pre>\n\n<p>I love how Haskell is just maths in the end, and you can replace some definition (like the one you used with takeWhile and dropWhile) with others (span) using just some algebraic equations!</p>\n"}], "owner": {"reputation": 3, "user_id": 10455741, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-v7rxsU0kEFI/AAAAAAAAAAI/AAAAAAAAC0I/dFp9X1Ign_c/photo.jpg?sz=128", "display_name": "&#193;d&#225;m Fejes", "link": "https://stackoverflow.com/users/10455741/%c3%81d%c3%a1m-fejes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 53318603, "answer_count": 2, "score": 0, "last_activity_date": 1542283213, "creation_date": 1542278702, "last_edit_date": 1542282743, "question_id": 53317652, "link": "https://stackoverflow.com/questions/53317652/haskell-group-definition-with-span-function", "title": "Haskell group definition with span function", "body": "<p>I need to define group function is Haskell, but i just can do it with takeWhile and dropWhile, but i cant do it with span.\nAnd i need to do it with span!\nCould you help me?\nHere my code with tW and dW:</p>\n\n<pre><code>group' :: (Eq a) =&gt; [a] -&gt; [[a]]\ngroup' [] = []\ngroup' (x:xs) = (x : takeWhile (== x) xs) : group' (dropWhile (== x) xs)\n</code></pre>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "edited": false, "score": 0, "creation_date": 1542275943, "post_id": 53316510, "comment_id": 93513714, "body": "Isn&#39;t this precisely the kind of thing that should be allowed under AllowAmbiguousTypes though? Perhaps I misunderstand the use case for this extension but I though it delayed the type error to the call site, so if you use TypeApplications there, all would be okay."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "edited": false, "score": 0, "creation_date": 1542278087, "post_id": 53316510, "comment_id": 93514949, "body": "@theindigamer No, it&#39;s not, even if it might appear to be related. Ambiguous types are enabled, ambiguous code is not. Often ambiguous code generate ambiguous types, in which case we can keep the type, but we still need to fix the code. Consider e.g. <code>f :: (Read a, Read b, Show a, Show b) =&gt; String -&gt; String ; f = show . read</code> How would GHC know whether we want to use <code>read :: String -&gt; a</code> or <code>read :: String -&gt; b</code>? Or even <code>read :: String -&gt; Bool</code>, which is a perfectly valid choice (!!) We have to be explicit in our code."}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1542280174, "post_id": 53316510, "comment_id": 93516153, "body": "How to specify the type of <code>a1</code> in when call <code>f</code>? if don&#39;t specify <code>a1</code>, the first coerce seem convert anything to <code>()</code>, and can&#39;t convert back to <code>c</code>. try it in GHCi, with <code>f @Int @Int 1</code>, gives follow error: Couldn&#39;t match representation of type \u2018()\u2019 with that of \u2018Int\u2019"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1542281032, "post_id": 53316510, "comment_id": 93516655, "body": "@assembly.jc If you are using the fixed code (with <code>forall a1 a2 c</code>) I think <code>f @Int @Int @Int 1</code> should work."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1542275057, "creation_date": 1542275057, "answer_id": 53316510, "question_id": 53314798, "link": "https://stackoverflow.com/questions/53314798/coercion-and-roles-cannot-compile-with-ghcis-type-signature/53316510#53316510", "title": "Coercion and roles - cannot compile with GHCi&#39;s type signature", "body": "<p>Here's what's happening, on a simpler example:</p>\n\n<pre><code>&gt; :set -XAllowAmbiguousTypes\n&gt; import Data.Coerce\n&gt; f = coerce . coerce\n&gt; :t f\nf :: (Coercible a1 c, Coercible a2 a1) =&gt; a2 -&gt; c\n</code></pre>\n\n<p>So far, so good. Everything looks reasonable. However, if the following code will fail to compile:</p>\n\n<pre><code>f :: (Coercible a1 c, Coercible a2 a1) =&gt; a2 -&gt; c\nf = coerce . coerce\n\n\u2022 Couldn't match representation of type \u2018a0\u2019 with that of \u2018c\u2019\n    arising from a use of \u2018coerce\u2019\n  \u2018c\u2019 is a rigid type variable bound by\n    the type signature for:\n      f :: forall a1 c a2. (Coercible a1 c, Coercible a2 a1) =&gt; a2 -&gt; c\n</code></pre>\n\n<p>Why is this happening? Where does <code>a0</code> come from?</p>\n\n<p>Simply put, in <code>coerce . coerce</code> GHC has to choose an intermediate type, the result of the first coercion. This in principle could be anything, so GHC generates a fresh type variable for it: above, <code>a0</code> is chosen for this.</p>\n\n<p>The code then is type checked, and will require the constraints <code>Coercible a0 c, Coercible a2 a0</code>. The ones provided by the signature are different. Here, GHC will NOT try to \"match\" them and choose <code>a0 = a1</code>. Indeed, in some type class contexts, that might be the wrong choice.</p>\n\n<p>For instance: (contrived example)</p>\n\n<pre><code>foo :: Read a =&gt; String -&gt; ...\nfoo s = let\n   x = read s &amp;&amp; True\n   in ...\n</code></pre>\n\n<p>It would be wrong to use the <code>Read a</code> constraint for resolving <code>read s</code>. Indeed, for that we need to use the global instance <code>Read Bool</code>, and ignore the constraint. Maybe later on in the code there is another <code>read s</code> call where we do need the constraint, but here we must not commit to it.</p>\n\n<p>To fix your code, you need to be explicit on your coercions, telling GHC you really want to use your constraints. For instance, the following type checks (<code>ScopedTypeVariables</code> on).</p>\n\n<pre><code>f :: forall a1 a2 c . (Coercible a1 c, Coercible a2 a1) =&gt; a2 -&gt; c\nf = coerce . (coerce :: a2 -&gt; a1)\n</code></pre>\n\n<p>Now we tell GHC that the intermediate type is indeed our <code>a1</code>.</p>\n\n<p>You can fix your code by adding similar type annotations.</p>\n"}], "owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 53316510, "answer_count": 1, "score": 0, "last_activity_date": 1542275057, "creation_date": 1542268862, "question_id": 53314798, "link": "https://stackoverflow.com/questions/53314798/coercion-and-roles-cannot-compile-with-ghcis-type-signature", "title": "Coercion and roles - cannot compile with GHCi&#39;s type signature", "body": "<p>Typing the following in GHCi</p>\n\n<pre><code>&gt;:set -XAllowAmbiguousTypes\n&gt;import Data.Coerce\n&gt;fcm f = coerce . foldMap (coerce . f)\n&gt;:t fcm\nfcm\n  :: (Foldable t, Monoid a1, Coercible a1 c, Coercible a2 a1) =&gt;\n     (a3 -&gt; a2) -&gt; t a3 -&gt; c\n</code></pre>\n\n<p>Ok, that is what I expect. Copy paste that into a file.</p>\n\n<pre><code>{-# LANGUAGE AllowAmbiguousTypes #-}\n\nimport Data.Coerce\n\nfcm :: (Foldable t, Monoid a1, Coercible a1 c, Coercible a2 a1) \n    =&gt; (a3 -&gt; a2) -&gt; t a3 -&gt; c\nfcm f = coerce . foldMap (coerce . f)\n</code></pre>\n\n<p>Now if you load this into GHCi, you get an error -</p>\n\n<pre><code>Weird.hs:7:9: error:\n    \u2022 Couldn't match representation of type \u2018a0\u2019 with that of \u2018c\u2019\n    arising from a use of \u2018coerce\u2019\n      \u2018c\u2019 is a rigid type variable bound by\n    the type signature for:\n      fcm :: forall (t :: * -&gt; *) a1 c a2 a3.\n             (Foldable t, Monoid a1, Coercible a1 c, Coercible a2 a1) =&gt;\n             (a3 -&gt; a2) -&gt; t a3 -&gt; c\n    at Weird.hs:(5,1)-(6,30)\n    \u2022 In the first argument of \u2018(.)\u2019, namely \u2018coerce\u2019\n      In the expression: coerce . foldMap (coerce . f)\n      In an equation for \u2018fcm\u2019: fcm f = coerce . foldMap (coerce . f)\n    \u2022 Relevant bindings include\n    fcm :: (a3 -&gt; a2) -&gt; t a3 -&gt; c (bound at Weird.hs:7:1)\n</code></pre>\n\n<p>Huh? Where did <code>a0</code> come from? If you delete the type signature, the code compiles fine again. Looks like we now have a function whose type we can't explain to the compiler and GHCi cannot tell us what that type is (it can only give us errors). GHC seems to be talking about internal type variables (in this case <code>a0</code>) which are not user facing.</p>\n\n<p>Does this have something to do with the black magic surrounding Coercible? From <a href=\"https://www.stackage.org/haddock/lts-12.18/ghc-prim-0.5.2.0/src/GHC-Types.html#Coercible\" rel=\"nofollow noreferrer\">GHC.Types</a>:</p>\n\n<pre><code>Note [Kind-changing of (~) and Coercible]\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n(~) and Coercible are tricky to define. To the user, they must appear as\nconstraints, but we cannot define them as such in Haskell. But we also cannot\njust define them only in GHC.Prim (like (-&gt;)), because we need a real module\nfor them, e.g. to compile the constructor's info table.\n\nFurthermore the type of MkCoercible cannot be written in Haskell\n(no syntax for ~#R).\n\nSo we define them as regular data types in GHC.Types, and do magic in TysWiredIn,\ninside GHC, to change the kind and type.\n</code></pre>\n\n<p>Am I understanding things correctly? Or is it possible to write a type signature for the function AND have the code compile successfully? For what it's worth, the thing I'm interested in being able to write is slightly simpler -</p>\n\n<pre><code>fcm :: (Monoid m, Coercible m b, Coercible b m, Foldable f) =&gt; (a -&gt; b) -&gt; f a -&gt; b\nfcm f = coerce . foldMap (coerce . f)\n\nsumBy = fcm @Sum \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 0, "creation_date": 1542267710, "post_id": 53314510, "comment_id": 93509167, "body": "Does <code>mapM</code> solve it (instead of <code>map</code>)?"}, {"owner": {"reputation": 328, "user_id": 9801788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c4d65bb8eb9216158702949a00454c?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/9801788/paul"}, "reply_to_user": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 0, "creation_date": 1542267853, "post_id": 53314510, "comment_id": 93509243, "body": "No, when changed to mapM, replies is expected to be [[IO Action]] but it is actually [[Action]]"}, {"owner": {"reputation": 328, "user_id": 9801788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c4d65bb8eb9216158702949a00454c?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/9801788/paul"}, "reply_to_user": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 0, "creation_date": 1542267899, "post_id": 53314510, "comment_id": 93509259, "body": "I have tried shuffling things around for awhile, and I always seem to end up with at least one type error. I assume there is some pathological mistake in my code."}, {"owner": {"reputation": 841, "user_id": 4927711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98c32e7161133d8461c3d78fce3245ed?s=128&d=identicon&r=PG&f=1", "display_name": "DevNewb", "link": "https://stackoverflow.com/users/4927711/devnewb"}, "edited": false, "score": 1, "creation_date": 1542268209, "post_id": 53314510, "comment_id": 93509404, "body": "just do <code>return $ map mostCommon replies</code>"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1542277975, "post_id": 53314510, "comment_id": 93514871, "body": "Side note: <code>return</code> is identical to <code>pure :: Applicative f =&gt; a -&gt; f a</code>, but with a more restrictive type signature (<code>Monad m =&gt; a -&gt; m a</code>), so <code>pure</code> can be used in more contexts. Plus it\u2019s slightly shorter, and I think its name better conveys its meaning: lift a pure value into a functor. <code>return x</code> doesn\u2019t return <code>x</code>, it constructs an action that \u201creturns\u201d <code>x</code> (in some manner specific to the given monad)."}], "answers": [{"tags": [], "owner": {"reputation": 841, "user_id": 4927711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98c32e7161133d8461c3d78fce3245ed?s=128&d=identicon&r=PG&f=1", "display_name": "DevNewb", "link": "https://stackoverflow.com/users/4927711/devnewb"}, "is_accepted": true, "score": 4, "last_activity_date": 1542276974, "last_edit_date": 1542276974, "creation_date": 1542268420, "answer_id": 53314681, "question_id": 53314510, "link": "https://stackoverflow.com/questions/53314510/losing-io-on-return-type/53314681#53314681", "title": "Losing IO on return type", "body": "<p>I think what you're looking for is</p>\n\n<pre><code>return $ map mostCommon replies\n</code></pre>\n\n<p><code>return</code> is a standard function that wraps values into monad. </p>\n\n<p>You can think of it this way:</p>\n\n<ul>\n<li>you're inside an IO monad, so GHC expects that your function will return <code>IO a</code></li>\n<li>you're returning <code>[] Action</code> (it's just another way of writing <code>[Action]</code>)</li>\n</ul>\n\n<p>so there are two errors here: </p>\n\n<ul>\n<li>your actual return type does not match your type annotation (<code>[Action]</code> vs <code>IO [Action]</code>)</li>\n<li>the types wrapping the Action (<code>[]</code> and expected <code>IO</code>) do not match</li>\n</ul>\n\n<p>When you use <code>return</code> function here you fix both errors.</p>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 5, "last_activity_date": 1542269103, "creation_date": 1542269103, "answer_id": 53314853, "question_id": 53314510, "link": "https://stackoverflow.com/questions/53314510/losing-io-on-return-type/53314853#53314853", "title": "Losing IO on return type", "body": "<p><code>consensus</code> is supposed to return a value of type <code>IO [Action]</code>. That's what <code>Expected type: IO [Action]</code> means.</p>\n\n<p>However, <code>map mostCommon replies</code> is an expression of type <code>[Action]</code> (because <code>map</code> returns a plain list, no <code>IO</code>).</p>\n\n<blockquote>\n  <p>I was under the impression that it was not possible remove the IO from a return value.</p>\n</blockquote>\n\n<p>Indeed, which is why you're getting a type error. The \"cannot remove IO\" thing is not a fundamental property, it just follows from the types of available operations in the standard library.</p>\n\n<p>So how do we solve this?</p>\n\n<p>You have a value of type <code>IO [[Action]]</code>, namely <code>mapM (uncurry $ consensus) (zip xs' actions')</code>. You want to apply <code>mostCommon</code> to each inner list (within the outer list within <code>IO</code>).</p>\n\n<p>By using <code>&lt;-</code> in a <code>do</code> block, you can locally \"extract\" values from <code>IO a</code>:</p>\n\n<pre><code>replies &lt;- mapM (uncurry $ consensus) (zip xs' actions')\n-- replies :: [[Action]]\n</code></pre>\n\n<p>By using <code>map</code>, you can apply <code>mostCommon</code> to each sublist:</p>\n\n<pre><code>map mostCommon replies :: [Action]\n</code></pre>\n\n<p>What's missing is that you need to \"rewrap\" your value in <code>IO</code> to make the <code>do</code> block pass type-checking (each individual statement in a <code>do</code> block must have the same base type, in this case <code>IO</code>):</p>\n\n<pre><code>return (map mostCommon replies)\n</code></pre>\n\n<p>Here <code>return :: [Action] -&gt; IO [Action]</code> (or in general: <code>return :: (Monad m) =&gt; a -&gt; m a</code>).</p>\n"}], "owner": {"reputation": 328, "user_id": 9801788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c4d65bb8eb9216158702949a00454c?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/9801788/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 53314681, "answer_count": 2, "score": 2, "last_activity_date": 1542276974, "creation_date": 1542267591, "last_edit_date": 1542268520, "question_id": 53314510, "link": "https://stackoverflow.com/questions/53314510/losing-io-on-return-type", "title": "Losing IO on return type", "body": "<p>I am having trouble with the function consensus in this block of code. The recursive definition of consensus is returning <strong>[Action]</strong> instead of <strong>IO [Action]</strong>.</p>\n\n<p>I am new to Haskell and do not understand why this is happening. I was under the impression that it was not possible remove the IO from a return value.</p>\n\n<pre><code>import System.Random (randomRIO)\nimport Data.Ord (comparing)\nimport Data.List (group, sort, maximumBy)\n\ndata Action = A | B deriving (Show, Eq, Ord)\n\n-- Sometimes returns a random action\nsemiRandomAction :: Bool -&gt; Action -&gt; IO (Action)\nsemiRandomAction True a = return a\nsemiRandomAction False _ = do\n  x &lt;- randomRIO (0, 1) :: IO Int\n  return $ if x == 0 then A else B\n\n-- Creates a sublist for each a_i in ls where sublist i does not contain a_i\noneOutSublists :: [a] -&gt; [[a]]\noneOutSublists [] = []\noneOutSublists (x:xs) = xs : map (x : ) (oneOutSublists xs)\n\n-- Returns the most common element in a list\nmostCommon :: (Ord a) =&gt; [a] -&gt; a\nmostCommon = head . maximumBy (comparing length) . group . sort\n\n-- The function in question\nconsensus :: [Bool] -&gt; [Action] -&gt; IO [Action]\nconsensus [x] [action] = sequence [semiRandomAction x action]\nconsensus xs actions = do\n  let xs' = oneOutSublists xs\n      actions' = map (replicate $ length xs') actions\n  replies &lt;- mapM (uncurry $ consensus) (zip xs' actions')\n  map mostCommon replies -- &lt; The problem line\n\nmain = do\n  let xs = [True, False, False]\n      actions = [A, A, A]\n  result &lt;- consensus xs actions\n  print result\n</code></pre>\n\n<p>ghc output</p>\n\n<pre><code>\u279c  ~ stack ghc example.hs \n[1 of 1] Compiling Main             ( example.hs, example.o )\n\nexample.hs:29:3: error:\n    \u2022 Couldn't match type \u2018[]\u2019 with \u2018IO\u2019\n      Expected type: IO [Action]\n        Actual type: [Action]\n    \u2022 In a stmt of a 'do' block: map mostCommon replies\n      In the expression:\n        do let xs' = oneOutSublists xs\n               actions' = map (replicate $ length xs') actions\n           replies &lt;- mapM (uncurry $ consensus) (zip xs' actions')\n           map mostCommon replies\n      In an equation for \u2018consensus\u2019:\n          consensus xs actions\n            = do let xs' = ...\n                     ....\n                 replies &lt;- mapM (uncurry $ consensus) (zip xs' actions')\n                 map mostCommon replies\n   |\n29 |   map mostCommon replies\n   |   \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1542263366, "post_id": 53313577, "comment_id": 93507510, "body": "<code>[(a,b)]</code> only matches a single-element list. In order to work through a list of any length, you need a different approach. Yes it is something with <code>map</code>."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1542278240, "post_id": 53313661, "comment_id": 93515053, "body": "You need parentheses around the lambda, or <code>$</code> between it and <code>map</code>, unless you enable the <code>BlockArguments</code> extension (as of GHC 8.6.1), which allows lambdas and <code>do</code> blocks directly as function arguments"}, {"owner": {"reputation": 173, "user_id": 10605246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683bda86a4ff9594ad6e38ea0bfabdef?s=128&d=identicon&r=PG&f=1", "display_name": "Stormy", "link": "https://stackoverflow.com/users/10605246/stormy"}, "edited": false, "score": 0, "creation_date": 1542327278, "post_id": 53313661, "comment_id": 93539708, "body": "Okay, so now I feel kinda like a dork.  That is so obvious now that I see it... I&#39;d even done something similar in another exercise!  I must have been up too late having fun.  Thank you @talex"}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "reply_to_user": {"reputation": 173, "user_id": 10605246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683bda86a4ff9594ad6e38ea0bfabdef?s=128&d=identicon&r=PG&f=1", "display_name": "Stormy", "link": "https://stackoverflow.com/users/10605246/stormy"}, "edited": false, "score": 0, "creation_date": 1542333465, "post_id": 53313661, "comment_id": 93540891, "body": "@Stormy don&#39;t worry about it. Every one who study new things have that felling from time to time."}], "tags": [], "owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "is_accepted": true, "score": 7, "last_activity_date": 1542278637, "last_edit_date": 1542278637, "creation_date": 1542263493, "answer_id": 53313661, "question_id": 53313577, "link": "https://stackoverflow.com/questions/53313577/haskell-error-taking-in-list-of-tuples-outputting-list-of-tuples/53313661#53313661", "title": "Haskell: error taking in list of tuples -&gt; outputting list of tuples", "body": "<p>Function you looking for is</p>\n\n<pre><code>pythagLambdaListTupleInOut = map (\\(a,b) -&gt; (a,b,(sqrt $ a^2 + b^2)))\n</code></pre>\n\n<p>your version fails because <code>[(a,b)]</code> pattern mean list with single element, and that element is tuple. When you pass list with two tuple haskell unable to pattern match.</p>\n"}], "owner": {"reputation": 173, "user_id": 10605246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683bda86a4ff9594ad6e38ea0bfabdef?s=128&d=identicon&r=PG&f=1", "display_name": "Stormy", "link": "https://stackoverflow.com/users/10605246/stormy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 53313661, "answer_count": 1, "score": 2, "last_activity_date": 1542278637, "creation_date": 1542263061, "question_id": 53313577, "link": "https://stackoverflow.com/questions/53313577/haskell-error-taking-in-list-of-tuples-outputting-list-of-tuples", "title": "Haskell: error taking in list of tuples -&gt; outputting list of tuples", "body": "<p>So I'm having a blast working through a Haskell tutorial... one challenge is to:</p>\n\n<p>\"Write a Lambda expression and map, to take a list of tuples and produce a list of tuples. The list contains the lengths of two sides of right triangles, a and b.  Produce a list that contains the length of all three sides, where the third side is c, found with the Pythagorean Theorem\" (of course).</p>\n\n<p>With example input/output like:</p>\n\n<pre><code>[(3,4),(5,16),(9.4,2)]\n== [(3.0,4.0,5.0),(5.0,16.0,16.76305461424021),(9.4,2,9.610411021387172)]\n</code></pre>\n\n<p>So I did some practice stuff first, like just getting the correct answer to the Pythagorean theorem, then taking in a tuple but outputting as usual, then taking in and putting out a tuple -- that all worked, eventually getting to this Lambda expression:</p>\n\n<pre><code>pythagLambdaTupleInOut = (\\(a,b) -&gt; (a,b,(sqrt $ a^2 + b^2)))\n</code></pre>\n\n<p>It compiled and produced this:</p>\n\n<pre><code>ghci &gt; pythagLambdaTupleInOut (3,4)\n(3.0,4.0,5.0)\n</code></pre>\n\n<p>So it works...\nSo then I tried: </p>\n\n<pre><code>pythagLambdaListTupleInOut = (\\[(a,b)] -&gt; [(a,b,(sqrt $ a^2 + b^2))])\n</code></pre>\n\n<p>It compiles, but this happens when I try to use it:</p>\n\n<pre><code>ghci &gt; pythagLambdaListTupleInOut [(3,4),(5,16)]\n*** Exception: six.hs:1376:31-68: Non-exhaustive patterns in lambda\n</code></pre>\n\n<p>Any clues what I'm missing?  Is it something with <code>map</code>?  I wasn't sure how to work <code>map</code> in there, based on the examples in the tutorial... </p>\n\n<p>Haskell, btw, is fascinating and so cool!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 5, "creation_date": 1542261487, "post_id": 53313144, "comment_id": 93506865, "body": "<a href=\"https://www.haskell.org/hoogle/?hoogle=%5BIO+x%5D+-%3E+IO+%5Bx%5D\" rel=\"nofollow noreferrer\">haskell.org/hoogle/?hoogle=%5BIO+x%5D+-%3E+IO+%5Bx%5D</a>"}, {"owner": {"reputation": 328, "user_id": 9801788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c4d65bb8eb9216158702949a00454c?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/9801788/paul"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1542262114, "post_id": 53313144, "comment_id": 93507076, "body": "I wasn&#39;t aware hoogle could be used like this."}], "answers": [{"comments": [{"owner": {"reputation": 1469, "user_id": 4876305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ymQ5f.jpg?s=128&g=1", "display_name": "Gabriel L.", "link": "https://stackoverflow.com/users/4876305/gabriel-l"}, "edited": false, "score": 5, "creation_date": 1542263699, "post_id": 53313254, "comment_id": 93507623, "body": "Yep, but also: better than <code>sequence</code> is <code>sequenceA</code> (more general, therefore a better habit to use it)."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1469, "user_id": 4876305, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ymQ5f.jpg?s=128&g=1", "display_name": "Gabriel L.", "link": "https://stackoverflow.com/users/4876305/gabriel-l"}, "edited": false, "score": 2, "creation_date": 1542296705, "post_id": 53313254, "comment_id": 93526491, "body": "@GabrielL. I&#39;d expect to see <code>sequence</code> be made a synonym of <code>sequenceA</code> at some point. Yeah, effectively there&#39;s no reason ever to use the <code>Monad</code>- instead of <code>Applicative</code>-constrained version, after the AMP."}], "tags": [], "owner": {"reputation": 1069, "user_id": 4299824, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LKWkrlvV9UE/AAAAAAAAAAI/AAAAAAAABYQ/OWKjHFpdGGs/photo.jpg?sz=128", "display_name": "YAMAMOTO Yuji", "link": "https://stackoverflow.com/users/4299824/yamamoto-yuji"}, "is_accepted": true, "score": 5, "last_activity_date": 1542261298, "creation_date": 1542261298, "answer_id": 53313254, "question_id": 53313144, "link": "https://stackoverflow.com/questions/53313144/how-do-i-transform-io-x-into-io-x/53313254#53313254", "title": "How do I transform [IO X] into IO [X]", "body": "<p>Use <a href=\"https://www.stackage.org/haddock/lts-12.18/base-4.11.1.0/Prelude.html#v:sequence\" rel=\"noreferrer\">sequence</a>.</p>\n\n<p>E.g.</p>\n\n<pre><code>&gt; sequence [return 1, return 2]\n[1,2]\n</code></pre>\n"}], "owner": {"reputation": 328, "user_id": 9801788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c4d65bb8eb9216158702949a00454c?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/9801788/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 53313254, "answer_count": 1, "score": 3, "last_activity_date": 1542261298, "creation_date": 1542260758, "question_id": 53313144, "link": "https://stackoverflow.com/questions/53313144/how-do-i-transform-io-x-into-io-x", "title": "How do I transform [IO X] into IO [X]", "body": "<p>I have some data type X and a function which returns IO [X] but my computation is currently returning [IO X]. \nWhat is a general method for transforming [IO X] into IO [X]?</p>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1542253267, "post_id": 53312081, "comment_id": 93504819, "body": "It is worth noting that if you don&#39;t want <code>foo</code> to be part of the public interface of your code, you can just leave it out of the export list of your module."}, {"owner": {"reputation": 13, "user_id": 10654560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3071cbb4654adc8577b350c259764414?s=128&d=identicon&r=PG&f=1", "display_name": "Lorem2979", "link": "https://stackoverflow.com/users/10654560/lorem2979"}, "edited": false, "score": 0, "creation_date": 1542254042, "post_id": 53312081, "comment_id": 93504985, "body": "Thank you for the answer, i hoped for a single command after <code>otherwise =</code> without having to change something else, but that will do."}], "tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": true, "score": 5, "last_activity_date": 1542254053, "last_edit_date": 1542254053, "creation_date": 1542253123, "answer_id": 53312081, "question_id": 53311894, "link": "https://stackoverflow.com/questions/53311894/is-it-possible-to-particularly-use-the-default-implementation-of-a-function/53312081#53312081", "title": "Is it possible to particularly use the default implementation of a function?", "body": "<p>Just put the common code to a helper function:</p>\n\n<pre><code>foo::(Eq a, Ord a, Show a, Num a) =&gt;a -&gt; a\nfoo n\n    | n == 0 = 0\n    | n == 1 = 1\n    | otherwise = foo (n-1) + foo (n-2)\n\nclass (Eq a, Ord a, Show a, Num a) =&gt; Fibo a where\n  fib :: a -&gt; a\n  fib = foo\n\ninstance Fibo Integer where\n  fib n\n    | n &lt; 0 = -1\n    | otherwise = foo n\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10654560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3071cbb4654adc8577b350c259764414?s=128&d=identicon&r=PG&f=1", "display_name": "Lorem2979", "link": "https://stackoverflow.com/users/10654560/lorem2979"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 53312081, "answer_count": 1, "score": 0, "last_activity_date": 1561803805, "creation_date": 1542251825, "last_edit_date": 1561803805, "question_id": 53311894, "link": "https://stackoverflow.com/questions/53311894/is-it-possible-to-particularly-use-the-default-implementation-of-a-function", "title": "Is it possible to particularly use the default implementation of a function?", "body": "<p>My code works. I just would like to know if it is possible to just add something in an instance declaration to be checked first before using the default implementation, instead of having to copy the code. An example:</p>\n\n<pre><code>class (Eq a, Ord a, Show a, Num a) =&gt; Fibo a where\n  fib :: a -&gt; a\n  fib n\n    | n == 0 = 0\n    | n == 1 = 1\n    | otherwise = fib (n-1) + fib (n-2)\n\ninstance Fibo Integer where\n  fib n\n    | n &lt; 0 = -1\n    | n == 0 = 0\n    | n == 1 = 1\n    | otherwise = fib (n-1) + fib (n-2)\n</code></pre>\n\n<p>But can it also be written in a way where I dont have to re-implement the whole function? Something like:</p>\n\n<pre><code>instance Fibo Integer where\n  fib n\n    | n &lt; 0 = -1\n    | otherwise = default\n</code></pre>\n\n<p>Or is there any other way to do without using the same code in two places?</p>\n\n<p>The Solution is NOT to change the default implementation!</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "edited": false, "score": 0, "creation_date": 1542247710, "post_id": 53311370, "comment_id": 93503673, "body": "Does this related to the curated/fixed-version packages in LTS?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1542248627, "post_id": 53311370, "comment_id": 93503854, "body": "&quot;Does this related to the curated/fixed-version packages in LTS?&quot; -- Likely so. Look for the <code>resolver</code> field in <code>stack.yaml</code>, then look for <code>easytest</code> in the Stackage page for the snapshot mentioned there (for instance, <a href=\"https://www.stackage.org/lts-12.18\" rel=\"nofollow noreferrer\">this is the page for LTS 12.18</a>)."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1542250599, "post_id": 53311370, "comment_id": 93504294, "body": "Thanks, yeah updating the resolver fixed it! Perhaps that should be one of the approaches listed for solving the issue in the error message?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1542251959, "post_id": 53311370, "comment_id": 93504546, "body": "Possibly. I believe the error message makes the conservative assumption that you (or upstream) have already decided which resolver to use and just want to adjust your configuration for a new dependency (as opposed to, say, wanting to update the dependencies of an old project)."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1542254472, "creation_date": 1542254472, "answer_id": 53312249, "question_id": 53311370, "link": "https://stackoverflow.com/questions/53311370/what-is-the-relationship-between-dependency-constraints-in-stack-configuration/53312249#53312249", "title": "What is the relationship between dependency constraints in &quot;stack configuration&quot;, xxx.cabal, and cabal.config?", "body": "<p>In...</p>\n\n<blockquote>\n  <p><code>easytest-0.2</code> from stack configuration does not match <code>==0.2.1</code></p>\n</blockquote>\n\n<p>... the \"stack configuration\" means the set of packages specified through the <code>resolver</code> (typically a Stackage snapshot -- you can find lists of packages and versions in a snapshot at the <a href=\"https://www.stackage.org/snapshots\" rel=\"nofollow noreferrer\">Stackage site</a>) and the <code>extra-deps</code> in <code>stack.yaml</code>, while the <code>==0.2.1</code> constraint is what your <code>.cabal</code> file is asking. The suggestions given by the error message (ignoring <code>.cabal</code> upper bounds with <code>allow-newer</code>, and adding packages to <code>extra-deps</code>) are appropriate in the cases in which you want, or need, to build with a specific resolver. If that is not the case (say, if you are trying to update an old project to a recent LTS snapshot), you can also change the resolver to something that includes the packages and versions you are looking for (if such a resolver is available).</p>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 53312249, "answer_count": 1, "score": 0, "last_activity_date": 1542254472, "creation_date": 1542247230, "question_id": 53311370, "link": "https://stackoverflow.com/questions/53311370/what-is-the-relationship-between-dependency-constraints-in-stack-configuration", "title": "What is the relationship between dependency constraints in &quot;stack configuration&quot;, xxx.cabal, and cabal.config?", "body": "<p>I haven't tried solving the issue yet; first I want to understand where the issue comes from:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>TextTerra $ stack --nix test\n\nError: While constructing the build plan, the following exceptions were encountered:\n\nIn the dependencies for TextTerra-0.1.0.0:\n    easytest-0.2 from stack configuration does not match ==0.2.1  (latest matching version is 0.2.1)\nneeded since TextTerra is a build target.\n\nSome different approaches to resolving this:\n\n  * Set 'allow-newer: true' to ignore all version constraints and build anyway.\n\n  * Consider trying 'stack solver', which uses the cabal-install solver to attempt to find some working build configuration. This can be convenient when dealing with many complicated constraint\n    errors, but results may be unpredictable.\n\n  * Recommended action: try adding the following to your extra-deps in /home/brandon/workspace/TextTerra/stack.yaml:\n\n- easytest-0.2.1\n\nPlan construction failed.\n</code></pre>\n\n<p>There is now no other reference to easytest, particularly easytest-0.2; the single reference is what I just added:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>TextTerra $ rg easytest\nTextTerra.cabal\n67:      , easytest == 0.2.1\n</code></pre>\n\n<p>However, there was a reference to easytest-0.2 in <code>cabal.config</code>. I'm not aware of the relevance of this file as a quick search doesn't turn up much and removing the file has no effect on the build (in particular, I get the same error message above).</p>\n"}, {"tags": ["haskell", "functional-programming", "constraints", "bit"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1542243661, "post_id": 53310800, "comment_id": 93502821, "body": "What <code>String</code> do you expect to get out of <code>show k</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 4109398, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d164617fb1f1cbcbf31d57715fe8d5e3?s=128&d=identicon&r=PG&f=1", "display_name": "lukas kiss", "link": "https://stackoverflow.com/users/4109398/lukas-kiss"}, "edited": false, "score": 0, "creation_date": 1542278646, "post_id": 53310927, "comment_id": 93515301, "body": "Thanks man,  now I am trying to calculate length [zer, one, zer], but I get Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018zer\u2019. I thought that it should work normally as calculating length of [undefined, undefined, undefined]."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "reply_to_user": {"reputation": 319, "user_id": 4109398, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d164617fb1f1cbcbf31d57715fe8d5e3?s=128&d=identicon&r=PG&f=1", "display_name": "lukas kiss", "link": "https://stackoverflow.com/users/4109398/lukas-kiss"}, "edited": false, "score": 0, "creation_date": 1542279243, "post_id": 53310927, "comment_id": 93515612, "body": "@lukaskiss Nope, any use of <code>zer</code> or <code>one</code> will need enough type constraints that the compiler can infer precisely what type is used: here you&#39;ll need eg. <code>[zer :: Int, one, zer]</code> or <code>[zer, one, zer] :: [Int]</code>. The type of <code>undefined</code> isn&#39;t ambiguous, it&#39;s well defined as <code>a</code>, which is why that example works: the type of <code>[zer, one, zer]</code> is <code>Bits a =&gt; [a]</code>, where <code>a</code> is ambiguous. New problems should be asked as new separate questions though."}], "tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": true, "score": 2, "last_activity_date": 1542243790, "last_edit_date": 1542243790, "creation_date": 1542242997, "answer_id": 53310927, "question_id": 53310800, "link": "https://stackoverflow.com/questions/53310800/show-constraint-type-in-haskell/53310927#53310927", "title": "Show Constraint type in haskell", "body": "<p>You're trying to make a <strong>class</strong> an instance of a class, rather than making a <strong>type</strong> an instance of a class. Compare:</p>\n\n<pre><code>Show a =&gt; Show (Bits a) -- Invalid\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Show a =&gt; Show (Maybe a) -- Valid\n</code></pre>\n\n<p>where <code>Maybe</code> is a datatype whereas <code>Bits</code> is a class name.</p>\n\n<hr>\n\n<p>I don't think it's possible to express \"anything that has a <code>Bits</code> instance has a <code>Show</code> instance\", because it can lead to <strong>overlapping instances</strong>: if you could define something like that, then when you use <code>show :: Int -&gt; String</code> the compiler wouldn't know whether to use the Prelude's instance of <code>Show Int</code> or the <code>show</code> that would be defined by <code>Int</code> being an instance of <code>Bits</code>.</p>\n\n<p>A messy workaround could be to enforce \"the other direction\": that every instance of <code>Bits</code> must be an instance of <code>Show</code>, which would allow you to use <code>a</code>'s <code>Show</code> instance rather than your own one:</p>\n\n<pre><code>class (Show a, Eq a) =&gt; Bits a where\n    zer :: a\n    one :: a\n\nmain = print (zer :: Int)\n</code></pre>\n\n<p>although this requires an explicit type signature to resolve the ambiguity in the type of <code>zer</code> at the call site.</p>\n"}], "owner": {"reputation": 319, "user_id": 4109398, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d164617fb1f1cbcbf31d57715fe8d5e3?s=128&d=identicon&r=PG&f=1", "display_name": "lukas kiss", "link": "https://stackoverflow.com/users/4109398/lukas-kiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 53310927, "answer_count": 1, "score": 0, "last_activity_date": 1542243790, "creation_date": 1542241878, "last_edit_date": 1542242381, "question_id": 53310800, "link": "https://stackoverflow.com/questions/53310800/show-constraint-type-in-haskell", "title": "Show Constraint type in haskell", "body": "<p>I am trying to use show function to print to the console value of <strong>zer</strong> or <strong>one</strong>, but I can not do it. Here is my code:</p>\n\n<pre><code>{-# LANGUAGE NoMonomorphismRestriction #-}\n\nimport Control.Arrow\nimport Data.List\nimport qualified Data.Map as M\nimport Data.Function\n\nclass Eq a =&gt; Bits a where\n    zer :: a\n    one :: a\n\ninstance Bits Int where\n    zer = 0\n    one = 1\n\ninstance Bits Bool where\n    zer = False\n    one = True\n\ninstance Bits Char where\n    zer = '0'\n    one = '1'\n</code></pre>\n\n<p>I am trying to use function <strong>show</strong> to convert zer or one to the string.\nSo I tried it:</p>\n\n<pre><code>k = zer\nshow k\n</code></pre>\n\n<p>but I got this error</p>\n\n<pre><code>&lt;interactive&gt;:10:1: error:\n    \u2022 Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018show\u2019\n      prevents the constraint \u2018(Show a0)\u2019 from being solved.\n      Probable fix: use a type annotation to specify what \u2018a0\u2019 should be.\n      These potential instances exist:\n        instance (Show k, Show a) =&gt; Show (M.Map k a)\n          -- Defined in \u2018containers-0.5.7.1:Data.Map.Base\u2019\n        instance Show Ordering -- Defined in \u2018GHC.Show\u2019\n        instance Show Integer -- Defined in \u2018GHC.Show\u2019\n        ...plus 24 others\n        ...plus 11 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    \u2022 In the expression: show zer\n      In an equation for \u2018it\u2019: it = show zer\n</code></pre>\n\n<p>so i tried to create instance for show. So I added this to my code:</p>\n\n<pre><code>instance (Show a) =&gt; Show (Bits a) where\n    show zer = \"0\"\n    show one = \"1\"\n</code></pre>\n\n<p>But I got another error</p>\n\n<pre><code>main.hs:25:28: error:\n    \u2022 Expected a type, but \u2018Bits a\u2019 has kind \u2018Constraint\u2019\n    \u2022 In the first argument of \u2018Show\u2019, namely \u2018Bits a\u2019\n      In the instance declaration for \u2018Show (Bits a)\u2019\n</code></pre>\n\n<p>Can you tell me what I am doing wrong?</p>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10654560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3071cbb4654adc8577b350c259764414?s=128&d=identicon&r=PG&f=1", "display_name": "Lorem2979", "link": "https://stackoverflow.com/users/10654560/lorem2979"}, "edited": false, "score": 0, "creation_date": 1542245337, "post_id": 53311018, "comment_id": 93503205, "body": "Thank you for your fast answer, I removed the <code>fac n  = fac n</code> line. But fac 3 was just a test, calling the function with the Value 3. When ever i wrote a function until now I could call it like that..."}, {"owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "reply_to_user": {"reputation": 13, "user_id": 10654560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3071cbb4654adc8577b350c259764414?s=128&d=identicon&r=PG&f=1", "display_name": "Lorem2979", "link": "https://stackoverflow.com/users/10654560/lorem2979"}, "edited": false, "score": 0, "creation_date": 1542245791, "post_id": 53311018, "comment_id": 93503297, "body": "Indeed I understand it is a test. Nonetheless my point was you should need write that call as <code>fac (3::Int)</code> instead to specify that the literal <code>3</code> is of type <code>Int</code>, rather than say an <code>Integer</code>."}, {"owner": {"reputation": 13, "user_id": 10654560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3071cbb4654adc8577b350c259764414?s=128&d=identicon&r=PG&f=1", "display_name": "Lorem2979", "link": "https://stackoverflow.com/users/10654560/lorem2979"}, "edited": false, "score": 0, "creation_date": 1542246088, "post_id": 53311018, "comment_id": 93503370, "body": "Thank you very much, I remember what (3::Int) means."}], "tags": [], "owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "is_accepted": true, "score": 0, "last_activity_date": 1542243939, "creation_date": 1542243939, "answer_id": 53311018, "question_id": 53310646, "link": "https://stackoverflow.com/questions/53310646/unresolved-overloading-trying-to-make-an-instance-for-int-for-own-class/53311018#53311018", "title": "Unresolved overloading - trying to make an instance for Int for own class", "body": "<p>As far as I can see there are two problems. </p>\n\n<p>Firstly you need to write <code>fac (3 :: Int)</code> in order to disambiguate the type of <code>3</code>. That will get you rid of the type error. </p>\n\n<p>Secondly you need to get rid of the line <code>fac n = fac n</code> in your instance definition. That results in an undefined method. Rather leaving the instance definition empty results in the default instance being used. </p>\n"}], "owner": {"reputation": 13, "user_id": 10654560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3071cbb4654adc8577b350c259764414?s=128&d=identicon&r=PG&f=1", "display_name": "Lorem2979", "link": "https://stackoverflow.com/users/10654560/lorem2979"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 53311018, "answer_count": 1, "score": 0, "last_activity_date": 1542252139, "creation_date": 1542240575, "last_edit_date": 1542252139, "question_id": 53310646, "link": "https://stackoverflow.com/questions/53310646/unresolved-overloading-trying-to-make-an-instance-for-int-for-own-class", "title": "Unresolved overloading - trying to make an instance for Int for own class", "body": "<p>I have a class which pre-implements one function (by now) and I want to use it via Instances, I started with Int, which didnt work.\nIt compiles, but when i try to call the function with fac 3,\nI get the following ERROR:</p>\n\n<p>Unresolved overloading\n<strong>* Type       : Fibo a => a\n*</strong> Expression : fac 3</p>\n\n<pre><code>class (Eq a, Ord a, Show a, Num a) =&gt; Fibo a where\n    fac :: a -&gt; a\n    fac n\n        | n == 0 = 1\n        | otherwise  = n * fac (n-1)\n\ninstance Fibo Int where\n    fac n = fac n\n</code></pre>\n\n<p>I cannot understand why it isnt working for my class with Int when its working for Show with a new type like:</p>\n\n<pre><code>newtype IN_0 = IN_0 Int\ninstance Show IN_0 where\n    show (IN_0 n) = show n\n</code></pre>\n\n<p>At least i think that the misstake is in the instance part, I thought that all i need to do is removing the constructor and replacing the name...\nIs something missing, can u tell me the difference of that what i did for show and why it didnt work for my own class?</p>\n"}]