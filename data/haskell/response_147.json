[{"tags": ["haskell", "amazon-s3"], "owner": {"reputation": 822, "user_id": 200916, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/68b75a235d71e5dacec3e2778a561775?s=128&d=identicon&r=PG", "display_name": "codygman", "link": "https://stackoverflow.com/users/200916/codygman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1509577405, "creation_date": 1509577405, "question_id": 47065007, "link": "https://stackoverflow.com/questions/47065007/amazonka-how-to-generate-s3-uri-from-network-aws-s3-types-object", "title": "Amazonka: How to generate S3:// uri from Network.AWS.S3.Types.Object?", "body": "<p>I've been using <a href=\"https://hackage.haskell.org/package/turtle\" rel=\"nofollow noreferrer\">turtle</a> to call \"aws s3 ls\" and I'm trying to figure out how to replace that with <a href=\"https://hackage.haskell.org/package/amazonka\" rel=\"nofollow noreferrer\">amazonka</a>. </p>\n\n<p>Absolute s3 urls were central to how my program worked. I now know how to get objects and filter them, but I don't know how to convert an object to an S3 url to integrate with my existing program.</p>\n\n<p>I came across the <a href=\"https://github.com/brendanhay/amazonka/blob/4fdd746346323aac7de6e82752b16609ef0bf212/examples/src/Example/S3.hs#L65\" rel=\"nofollow noreferrer\">getFile</a> function and tried downloading a file from s3.</p>\n\n<p>Perhaps I had something wrong, but it didn't seem like just the S3 Bucket and S3 Object key were enough to download a given file. If I'm wrong about that I need to double check my configuration.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 4, "creation_date": 1509577075, "post_id": 47064935, "comment_id": 81078103, "body": "Do you know that your list will always be in increasing order?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509577308, "post_id": 47064935, "comment_id": 81078184, "body": "In general you can not know if a list is infinite, since that would sove the <i>Halting problem</i>. In this case however you can know this, since the list strictuly increases."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509577341, "post_id": 47064935, "comment_id": 81078201, "body": "Furthermore <code>[prod | k &lt;- [1..], let prod = product [1..k]]</code> is equivalent to <code>[product [1..k] | k &lt;- [1..]]</code>"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1509577359, "post_id": 47064935, "comment_id": 81078207, "body": "\u2026 is equivalent to <code>scanl1 (*) [1..]</code>!"}, {"owner": {"reputation": 287, "user_id": 1068464, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/55c6e5523986ec8db92f2a0a8c474071?s=128&d=identicon&r=PG", "display_name": "user1068464", "link": "https://stackoverflow.com/users/1068464/user1068464"}, "edited": false, "score": 0, "creation_date": 1509577672, "post_id": 47064935, "comment_id": 81078294, "body": "Yes, the list will always be in increasing order. And the actual computation is more complex (multiplying primes)."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1509583068, "post_id": 47064935, "comment_id": 81079829, "body": "you could use <code>dropWhile (&lt; n)</code> and then inspect the resulting list to see whether it contains <code>n</code>. I think the answer you&#39;re looking for should mention that this is precisely what laziness is good for: you don&#39;t have to decide to limit the list when you&#39;re constructing it, instead you can compose useful functions in the most natural way"}], "answers": [{"tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 7, "last_activity_date": 1509577584, "creation_date": 1509577584, "answer_id": 47065035, "question_id": 47064935, "link": "https://stackoverflow.com/questions/47064935/check-if-item-is-in-infinite-list/47065035#47065035", "title": "Check if item is in infinite List", "body": "<p>If your list is in increasing order, you can <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Foldable.html#v:find\" rel=\"noreferrer\">find</a> an element that\u2019s at least what you\u2019re looking for and check separately whether it\u2019s the same:</p>\n\n<pre><code>&gt; let elemIncreasing x l = find (&gt;= x) l == Just x\n&gt; let factorials = scanl1 (*) [1..]\n&gt; 120 `elemIncreasing` factorials\nTrue\n&gt; 121 `elemIncreasing` factorials\nFalse\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1509579295, "post_id": 47065087, "comment_id": 81078781, "body": "I wouldn&#39;t use <code>(&lt;)</code> in your type signature, since it doesn&#39;t seem to <b><i>do</i></b> anything other than indicate if the haystack is ascending or descending. Consider instead <code>data ListOrder = Asc | Desc</code> and <code>sortedElem :: (Eq a, Ord a) =&gt; ListOrder -&gt; a -&gt; [a]</code>"}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1509579505, "post_id": 47065087, "comment_id": 81078850, "body": "This implementation does not require that the elements implement <code>Ord</code> or indeed that they are sorted by this ordering. The two examples work for lists of things that do implement <code>Ord</code> but the <code>sortedElem</code> function could be used for e.g. lists of complex numbers sorted by e.g. increasing magnitude, or lists of numbers sorted by their largest factor or any other bizarre ordering."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1509579664, "post_id": 47065087, "comment_id": 81078896, "body": "Are you sure? If that&#39;s the case, I&#39;m not sure how, since you use as a guard <code>x &lt; y</code> which operates on <code>Ord a</code>."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1509579757, "post_id": 47065087, "comment_id": 81078912, "body": "and of course if your list isn&#39;t sorted, this is actually an impossible task."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 2, "creation_date": 1509579761, "post_id": 47065087, "comment_id": 81078915, "body": "@AdamSmith That does not require <code>Ord</code> since <code>&lt;</code> is the name of the argument, shadowing the one in the <code>Ord</code> type class."}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 2, "creation_date": 1509579815, "post_id": 47065087, "comment_id": 81078928, "body": "<code>&lt;</code> operates on whatever you pass it. It is lexically bound as a function parameter. The following are equivalent: <code>satisfies (&lt;) a b = a &lt; b</code> and <code>satisfies f a b = f a b</code>"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1509579865, "post_id": 47065087, "comment_id": 81078944, "body": "@chi ah ha, interesting! I hadn&#39;t thought of using an infix variable name inside a pattern match. I don&#39;t particularly like it here (shadowing seems unnecessarily complex, subjectively!) but it&#39;s good to know!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1509579980, "post_id": 47065087, "comment_id": 81078977, "body": "@AdamSmith Yes, it is tricky. Personally, I always avoid it, if only to avoid the warning."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1509581620, "post_id": 47065087, "comment_id": 81079420, "body": "@AdamSmith I don&#39;t think &quot;if your list isn&#39;t sorted, this is actually an impossible task&quot; is so obvious as you claim. I bet I can invent other properties of a list than sortedness that would let me check whether an element is in it or not. As a trivial example: lists that are either sorted or have the first two elements switched. As a more complicated example: lists that are the flattening of an infinite <a href=\"https://en.wikipedia.org/wiki/Search_tree#Binary_Search_Tree\" rel=\"nofollow noreferrer\">search tree</a>."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509584231, "post_id": 47065087, "comment_id": 81080125, "body": "@DanielWagner true, I misspoke. I should have written &quot;If your list is in arbitrary order, this is actually an impossible take.&quot;"}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1509584338, "post_id": 47065087, "comment_id": 81080151, "body": "This is just the distinction between recursive and r.e. Sets"}], "tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": false, "score": 4, "last_activity_date": 1509577882, "creation_date": 1509577882, "answer_id": 47065087, "question_id": 47064935, "link": "https://stackoverflow.com/questions/47064935/check-if-item-is-in-infinite-list/47065087#47065087", "title": "Check if item is in infinite List", "body": "<p>Suppose that we have some order &lt; and we know that for the lists we are interested in we have a\n\n<pre><code>sortedElem _ _ [] = False\nsortedElem (&lt;) y (x:xs) | y == x = True\n                        | x &lt; y  = False\n                        | True   = sortedElem (&lt;) y xs\n</code></pre>\n\n<p>And you could define special cases e.g.</p>\n\n<pre><code>elemIncreasing = sortedElem (&lt;)\nelemDecreasing = sortedElem (&gt;)\n</code></pre>\n\n<p>I\u2019m on my phone so I\u2019ve not tested this. It should work in principle but the compiler may have a few issues. I\u2019m sure they can be fixed.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 8, "last_activity_date": 1509579868, "creation_date": 1509579868, "answer_id": 47065361, "question_id": 47064935, "link": "https://stackoverflow.com/questions/47064935/check-if-item-is-in-infinite-list/47065361#47065361", "title": "Check if item is in infinite List", "body": "<p>The <a href=\"https://hackage.haskell.org/package/data-ordlist-0.4.7.0/docs/Data-List-Ordered.html\" rel=\"noreferrer\">data-ordlist</a> package has many utility functions for dealing with sorted lists, including <code>member</code>:</p>\n\n<pre><code>Data.List.Ordered&gt; 25 `member` [n^2 | n &lt;- [1..]]\nTrue\nData.List.Ordered&gt; 26 `member` [n^2 | n &lt;- [1..]]\nFalse\nData.List.Ordered&gt; 24 `member` [product [1..k] | k &lt;- [1..]]\nTrue\nData.List.Ordered&gt; 25 `member` [product [1..k] | k &lt;- [1..]]\nFalse\n</code></pre>\n"}], "owner": {"reputation": 287, "user_id": 1068464, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/55c6e5523986ec8db92f2a0a8c474071?s=128&d=identicon&r=PG", "display_name": "user1068464", "link": "https://stackoverflow.com/users/1068464/user1068464"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 47065035, "answer_count": 3, "score": 1, "last_activity_date": 1509579868, "creation_date": 1509576946, "question_id": 47064935, "link": "https://stackoverflow.com/questions/47064935/check-if-item-is-in-infinite-list", "title": "Check if item is in infinite List", "body": "<p>I have a fairly basic question, about comparing with infinite lists. The problem is similar to this:</p>\n\n<pre><code>25 `elem` [x^2 | x &lt;- [1..]]\n</code></pre>\n\n<p>obviously this is <code>true</code>.\nHowever, how do I deal with values that are not int the list, like</p>\n\n<pre><code>26 `elem` [x^2 | x &lt;- [1..]]\n</code></pre>\n\n<p>Because it's an infinite list, Haskell doesn't have an answer for this, although it seems kinda obvious, that once we are past 6^2 we can't reach 26 anymore, so I want to stop there.</p>\n\n<p>Now I could limit the x like:</p>\n\n<pre><code>[x^2 | x &lt;- [1..6]]\n</code></pre>\n\n<p>Easy. </p>\n\n<p>But what I do in examples like that:</p>\n\n<pre><code>[prod | k &lt;- [1..], let prod = product [1..k]]\n</code></pre>\n\n<p>and I want to check if my number is in that list? Or what is an alternative way to get the result of this calculation?</p>\n"}, {"tags": ["haskell", "template-haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1509573476, "post_id": 47064216, "comment_id": 81076880, "body": "Interesting! For anyone else who didn&#39;t immediately get what is happening: I think GHC sees <code>forall k x. Proxy :: (x :: k) -&gt; *</code> compared to <code>forall x. Proxy :: (x :: *) -&gt; *</code> otherwise. In the first case, <code>reifyRoles</code> returns the role of the kind variable as well as the type variable."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1509574033, "post_id": 47064216, "comment_id": 81077090, "body": "Regarding 1, I think that you are correct. Kind variables come before type variables. Regarding 2, the note at <a href=\"https://github.com/ghc/ghc/blob/cca2d6b78f97bfb79bef4dc3f75d6c4d15b94680/compiler/types/TyCon.hs#L348-L349\" rel=\"nofollow noreferrer\"><code>[TyCon Role signatures]</code></a> says that all kind arguments have <code>nominal</code> role."}], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1509572789, "creation_date": 1509572789, "question_id": 47064216, "link": "https://stackoverflow.com/questions/47064216/using-template-haskell-s-reifyroles-with-poly-kinded-datatypes", "title": "Using Template Haskell\u2019s reifyRoles with poly-kinded datatypes?", "body": "<p>I would like to find out information about the roles of a type constructor\u2019s type parameters at compile-time. Fortunately, Template Haskell provides such a function, <a href=\"https://hackage.haskell.org/package/template-haskell-2.12.0.0/docs/Language-Haskell-TH.html#v:reifyRoles\" rel=\"nofollow noreferrer\"><code>reifyRoles</code></a>. However, it gives me odd results when I use it on poly-kinded types:</p>\n\n<pre><code>GHCi, version 8.2.1: http://www.haskell.org/ghc/  :? for help\nLoaded GHCi configuration from /Users/alexis/.ghci\nghci&gt; :set -XTemplateHaskell -XDeriveLift -XStandaloneDeriving\nghci&gt; import Data.Proxy\nghci&gt; import Language.Haskell.TH\nghci&gt; import Language.Haskell.TH.Syntax\nghci&gt; deriving instance Lift Role\nghci&gt; $(lift =&lt;&lt; reifyRoles ''Proxy)\n[NominalR,PhantomR]\n</code></pre>\n\n<p>Oddly, even though <code>Proxy</code> only has a single type parameter, <code>reifyRoles</code> produces a list with <em>two</em> elements. This makes it difficult to figure out which role corresponds to <code>Proxy</code>\u2019s single type parameter.</p>\n\n<p>This doesn\u2019t happen for mono-kinded types:</p>\n\n<pre><code>ghci&gt; data Foo a = Foo\nghci&gt; $(lift =&lt;&lt; reifyRoles ''Foo)\n[PhantomR]\n</code></pre>\n\n<p>It isn\u2019t clear from the documentation what <code>reifyRoles</code> actually does here. I have two related questions:</p>\n\n<ol>\n<li><p>If I only care about the roles for type parameters, and I don\u2019t care about the kinds, can I assume that the types\u2019 roles will be the <em>last</em> ones in the list? If not, how can I properly select the correct roles for an arbitrary type\u2019s type parameters?</p></li>\n<li><p>What does a role even mean in the context of kinds? Why is the kind of <code>Proxy</code>\u2019s type parameter given the <code>nominal</code> role?</p></li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509565671, "post_id": 47062514, "comment_id": 81073103, "body": "It is not really clear to me what you want to do. Your program has some semantical errors and furthermore what do you mean with <code>X</code> and <code>Z</code>?"}, {"owner": {"reputation": 79, "user_id": 7531770, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/23c7cd700565cc3bccc124baf4ef5ac5?s=128&d=identicon&r=PG&f=1", "display_name": "DevTanner", "link": "https://stackoverflow.com/users/7531770/devtanner"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509565741, "post_id": 47062514, "comment_id": 81073147, "body": "sorry i need to decide whether these functions represent Equality, Less than, Less than or equal, Greater than or Greater than or equal"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509565864, "post_id": 47062514, "comment_id": 81073238, "body": "Ok, but what do you mean with *I do not understand what it is referring to with the <code>(S n)</code>. If you mean <code>(S n)</code> in the head of the function: that is pattern matching. It checks if the value is an <code>S</code> constructor, with <code>n</code> as argument."}, {"owner": {"reputation": 79, "user_id": 7531770, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/23c7cd700565cc3bccc124baf4ef5ac5?s=128&d=identicon&r=PG&f=1", "display_name": "DevTanner", "link": "https://stackoverflow.com/users/7531770/devtanner"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509565941, "post_id": 47062514, "comment_id": 81073278, "body": "ok I recognize that. I dont really understand how we are using that constructor to determine the operation."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509566063, "post_id": 47062514, "comment_id": 81073353, "body": "well <code>(S n) ? (S m)</code> means you have two patterns with constructors <code>(S x)</code> the arguments can be different. Apparently for both that means we perform recursion by unpacking both constructors and perform recursion on the arguments. So based on these patterns, you have to look for clues what <code>?</code> can be. For instance the first has a line <code>Z ? Z = True</code>. So that means that <code>0 ? 0</code> is true. There are three relations for which that holds."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1509566119, "post_id": 47062514, "comment_id": 81073387, "body": "Hint: any <code>S n</code> will be always greater or equal to <code>S Z</code> which is always greater than <code>Z</code> based on natural number ordering."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509566340, "post_id": 47062514, "comment_id": 81073512, "body": "Presumably, the lowercase <code>z</code>s should be <code>Z</code>, although if not they aren&#39;t wrong, just misleadingly named patterns."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1509632988, "post_id": 47062514, "comment_id": 81103989, "body": "Could also just be a catch-all case."}], "answers": [{"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 7, "last_activity_date": 1509566291, "creation_date": 1509566291, "answer_id": 47062719, "question_id": 47062514, "link": "https://stackoverflow.com/questions/47062514/what-operation-do-these-definitions-implement-etc/47062719#47062719", "title": "What operation do these definitions implement? (==, &lt;, &gt;, etc.)", "body": "<p>Your constructors here are</p>\n\n<pre><code>-- zero\nZ\n</code></pre>\n\n<p>and</p>\n\n<pre><code>-- nonzero n\nS n\n</code></pre>\n\n<p>Your first example looks at:</p>\n\n<pre><code>(?) :: Nat -&gt; Nat -&gt; Bool\nZ ? Z = True\nZ ? (S n) = True\n(S n) ? (S m) = n &lt;?&gt; m\nx ? z = False\n</code></pre>\n\n<p>So let's go try something. We can start with <code>(==)</code> and see if it fails for any of those assertions.</p>\n\n<pre><code>Z == Z = True      -- makes sense\nZ == (S n) = True  -- FAIL\n</code></pre>\n\n<p>that shouldn't be true, since your zero isn't going to be equal to any non-zero value. In fact, it should be less than any nonzero value! Let's try <code>(&lt;)</code> and look at it again</p>\n\n<pre><code>Z &lt; Z = True       -- Whoops...\n</code></pre>\n\n<p>Hang on, zeroes aren't less than themselves, but they are less than <em>or equal to</em> themselves. Let's test <code>(&lt;=)</code>.</p>\n\n<pre><code>Z &lt;= Z = True            -- Uh huh\nZ &lt;= (S n) = True        -- Yup\n(S n) &lt;= (S m) = n &lt;= m  -- S n &lt;= S m when n &lt;= m, makes sense!\nx &lt;= z = False           -- Any other construction should be False, e.g.\n                         --   (S n) &lt;= Z\n</code></pre>\n\n<p>I'll go ahead and leave the second question to you, now that you hopefully understand what's being asked a bit better!</p>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 1, "last_activity_date": 1509572146, "creation_date": 1509572146, "answer_id": 47064071, "question_id": 47062514, "link": "https://stackoverflow.com/questions/47062514/what-operation-do-these-definitions-implement-etc/47064071#47064071", "title": "What operation do these definitions implement? (==, &lt;, &gt;, etc.)", "body": "<p>You can think of <code>S n</code> as 1 + <em>n</em> and <code>Z</code> as 0, so for the first operation, you have:</p>\n\n<ul>\n<li>0 ? 0 is true</li>\n<li>0 ? (1 + <em>n</em>) for any non-negative <em>n</em> is true</li>\n<li>(1 + <em>n</em>) ? (1 + <em>m</em>) for any non-negative <em>n</em> and <em>m</em> is the same as <em>n</em> ? <em>m</em></li>\n<li>For any other input, it\u2019s false</li>\n</ul>\n\n<p>So you can try each operation (=, &lt;, \u2264, >, \u2265) in place of ? and see which one produces the same results. E.g.: is 0 \u2265 0? Yes; is 0 \u2265 1 + <em>n</em> for non-negative <em>n</em>? No; so the function isn\u2019t \u2265.</p>\n\n<p>If you\u2019re more familiar with imperative languages, perhaps translating it to another notation would be enlightening. For example, here\u2019s a C version:</p>\n\n<pre><code>bool operation(unsigned int a, unsigned int b) {\n  if (a == 0 &amp;&amp; b == 0) {\n    return true;\n  } else if (a == 0 &amp;&amp; b != 0) {\n    unsigned int n = b - 1;  // Note: unused, as in original code\n    return true;\n  } else if (a != 0 &amp;&amp; b != 0) {\n    unsigned int n = a - 1;\n    unsigned int m = b - 1;\n    return operation(n, m);\n  } else {\n    return false;\n  }\n}\n</code></pre>\n\n<p>Your task is to determine whether this function returns the same results as <code>==</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, or <code>&gt;=</code> for all inputs. Note that while I used an integer type (<code>unsigned int</code>) here, in reality your <code>Nat</code> type is represented in Haskell as a linked list. So I wouldn\u2019t advise doing this \u201cmental translation\u201d too much, except as a learning exercise\u2014in order to faithfully represent what the Haskell code is actually doing, it would take considerably more code.</p>\n"}], "owner": {"reputation": 79, "user_id": 7531770, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/23c7cd700565cc3bccc124baf4ef5ac5?s=128&d=identicon&r=PG&f=1", "display_name": "DevTanner", "link": "https://stackoverflow.com/users/7531770/devtanner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 47062719, "answer_count": 2, "score": 1, "last_activity_date": 1509592612, "creation_date": 1509565418, "last_edit_date": 1509592612, "question_id": 47062514, "link": "https://stackoverflow.com/questions/47062514/what-operation-do-these-definitions-implement-etc", "title": "What operation do these definitions implement? (==, &lt;, &gt;, etc.)", "body": "<pre><code>data Nat = Z | S Nat\n</code></pre>\n\n<p>For example, we can use this data type to represent the first few numerals thusly:</p>\n\n<blockquote>\n  <p><code>Z</code> stands for <code>0</code>, <code>S Z</code> stands for <code>1</code>, <code>S (S Z)</code> stands for <code>2</code>, and so on.</p>\n  \n  <ol>\n  <li>Equality (i.e., <code>x == y</code>),</li>\n  <li>Less than (i.e., <code>x &lt; y</code>),</li>\n  <li>Less than or equal (i.e., <code>x \u2264 y</code>),</li>\n  <li>Greater than (i.e., <code>x &gt; y</code>),</li>\n  <li>Greater than or equal (i.e., <code>x \u2265 y</code>).</li>\n  </ol>\n</blockquote>\n\n<p>1.</p>\n\n<pre><code>(?) :: Nat -&gt; Nat -&gt; Bool\nZ ? Z = True\nZ ? (S n) = True\n(S n) ? (S m) = n &lt;?&gt; m\nx ? z = False\n</code></pre>\n\n<p>2.</p>\n\n<pre><code>? :: Nat -&gt; Nat -&gt; Bool\n(S n) ? Z = True\n(S n) ? (S m) = n &lt;?&gt; m\nx ? z = False\n</code></pre>\n\n<p>I do not understand what it is referring to with the (S n) nor how we are supposed to differentiate the last X and Z.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1509557272, "post_id": 47059813, "comment_id": 81068452, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8745597/defining-a-function-by-equations-with-different-number-of-arguments\">Defining a function by equations with different number of arguments</a>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1509557737, "post_id": 47059813, "comment_id": 81068699, "body": "@amalloy I don&#39;t think it&#39;s an exact dupe."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1509558516, "post_id": 47059813, "comment_id": 81069164, "body": "Don&#39;t vote to close it, then. That&#39;s why closing a question takes 5 votes."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1509561622, "post_id": 47059813, "comment_id": 81070967, "body": "@melpomene I agree, the <a href=\"https://stackoverflow.com/questions/8745597/defining-a-function-by-equations-with-different-number-of-arguments\">linked question</a> asks for a <i>reason</i> behind the decision. this one asks for the reference into the spec."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1509561697, "post_id": 47059813, "comment_id": 81071007, "body": "@amalloy Keep in mind, you are closing in on the gold <code>[haskell]</code> badge, which would allow you to close a question as a duplicate by yourself."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509561728, "post_id": 47059813, "comment_id": 81071022, "body": "@chepner or re-open. (I think) :)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509562203, "post_id": 47059813, "comment_id": 81071273, "body": "<a href=\"https://meta.stackexchange.com/a/231212/172601\">yes</a>, re-open too."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1509564656, "post_id": 47059813, "comment_id": 81072563, "body": "It&#39;s not relevant to the question, but... I&#39;m curious about why you use <code>fromJust</code> (which is partial, and should be avoided), but do not use <code>fromMaybe</code> (which is total) and instead redefine it."}, {"owner": {"reputation": 524, "user_id": 1494169, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/de56ad5c1aa6d83b60819752b9a44ad1?s=128&d=identicon&r=PG", "display_name": "Marc van Dongen", "link": "https://stackoverflow.com/users/1494169/marc-van-dongen"}, "edited": false, "score": 0, "creation_date": 1509570631, "post_id": 47059813, "comment_id": 81075615, "body": "Thanks to all. All I needed was a reference to the section in the language definition that posed the restriction."}], "answers": [{"comments": [{"owner": {"reputation": 524, "user_id": 1494169, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/de56ad5c1aa6d83b60819752b9a44ad1?s=128&d=identicon&r=PG", "display_name": "Marc van Dongen", "link": "https://stackoverflow.com/users/1494169/marc-van-dongen"}, "edited": false, "score": 0, "creation_date": 1509570404, "post_id": 47059913, "comment_id": 81075504, "body": "Thanks very much. That&#39;s all I was looking for."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 20, "last_activity_date": 1509555406, "last_edit_date": 1592644375, "creation_date": 1509555406, "answer_id": 47059913, "question_id": 47059813, "link": "https://stackoverflow.com/questions/47059813/number-of-parameters-of-a-haskell-function/47059913#47059913", "title": "Number of Parameters of a Haskell Function", "body": "<p>It's not legal. The restriction is described in the\n<a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-840004.4.3.1\" rel=\"noreferrer\">Haskell 2010 Report</a>:</p>\n<blockquote>\n<p><strong>4.4.3.1 Function bindings</strong></p>\n<p>[...]</p>\n<p>Note that all clauses defining a function must be contiguous, and the number of patterns in each clause must be the same.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1509576517, "post_id": 47064293, "comment_id": 81077924, "body": "&quot;<i>the compiler needs to know exactly how many parameters it needs before it evaluates them to choose among the patterns</i>&quot; - no, it doesn&#39;t. What problems are you thinking of?"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1509635206, "post_id": 47064293, "comment_id": 81105723, "body": "Case in point: Agda nowadays supports clauses with a different number of patterns which is super convenient when a pattern can cause the RHS to be a function type, and you want to pattern-match on that extra argument."}, {"owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "edited": false, "score": 0, "creation_date": 1509666673, "post_id": 47064293, "comment_id": 81122370, "body": "Agda&#39;s semantics are not lazy so the problem of evaluation order does not come up. Agda is a total language, i.e., each program in it must terminate and all possible patterns must be matched. Without this feature, the logic behind the language becomes inconsistent, and it becomes possible to prove arbitrary statements. Haskell is not total and so evaluation order is significant and function reduction must be consistent.  I stand by my answer."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1509718711, "post_id": 47064293, "comment_id": 81145452, "body": "I don&#39;t see how that makes a difference. Agda is also sensible to the order in which clauses are declared. And being too strict in a pattern will block some reductions that would happen otherwise. This variable number of arguments could very well be adapted as an extension to Haskell."}], "tags": [], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "is_accepted": false, "score": 0, "last_activity_date": 1509573172, "creation_date": 1509573172, "answer_id": 47064293, "question_id": 47059813, "link": "https://stackoverflow.com/questions/47059813/number-of-parameters-of-a-haskell-function/47064293#47064293", "title": "Number of Parameters of a Haskell Function", "body": "<p>The <a href=\"https://stackoverflow.com/a/47059913/163177\">answer</a> from <a href=\"https://stackoverflow.com/users/1848654/melpomene\">melpomene</a> is the summation of the syntax rules.  In this answer I want to try to describe why this has to be the case.</p>\n\n<p>From the point of view of the programmer, the syntax in the question seems quite reasonable.  There is a first specific case which is marked by a value in the second parameter. Then there is a general solution which reduces to an existing function.  Either pattern on its own is valid so why can they not co-exist?  </p>\n\n<p>The syntax rule that all patterns must capture exactly the same parameters is a necessary result of haskell being a lazy language.  Being lazy means that the values of parameters are not evaluated until they are needed.</p>\n\n<p>Let's look at what happens when we curry a function, that is provide it with less then the number of parameters in the declaration. When that happens haskell produces an anonymous function* that will complete the function and stores the first parameters in the scope of that function <em>without evaluating them</em>.</p>\n\n<p>That last part is important. For functions with different numbers of parameters, it would be necessary to evaluate some of them to choose which pattern to match, but then not evaluate them.</p>\n\n<p>In other words the compiler needs to know exactly how many parameters it needs before it evaluates them to choose among the patterns.  So while it seems like we should not need to put an extra <code>_</code> in, the compiler needs it to be there.</p>\n\n<p>As an aside, the order in which parameters occur can make a big difference in how easy a function is to implement and use.  See the answers to my question <a href=\"https://stackoverflow.com/questions/5863128/ordering-of-parameters-to-make-use-of-currying\">Ordering of parameters to make use of currying</a> for suggestions. If the order is reversed on the example function, it can be implemented with only the one named point.</p>\n\n<pre><code>from_maybe :: Maybe a -&gt; a -&gt; a\nfrom_maybe Nothing = id\nfrom_maybe (Just x) = const x\n</code></pre>\n\n<hr>\n\n<p>*: What an implementation like GHC actually does in this situation is subject to optimization and may not work exactly this way, but the end result must be the same as if it did.</p>\n"}], "owner": {"reputation": 524, "user_id": 1494169, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/de56ad5c1aa6d83b60819752b9a44ad1?s=128&d=identicon&r=PG", "display_name": "Marc van Dongen", "link": "https://stackoverflow.com/users/1494169/marc-van-dongen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 752, "favorite_count": 0, "accepted_answer_id": 47059913, "answer_count": 2, "score": 5, "last_activity_date": 1509573172, "creation_date": 1509555079, "question_id": 47059813, "link": "https://stackoverflow.com/questions/47059813/number-of-parameters-of-a-haskell-function", "title": "Number of Parameters of a Haskell Function", "body": "<p>When I try to compile this with <code>ghc</code> it complains the number of parameters in the left hand sides of the function definition are different.</p>\n\n<pre><code>module Example where\n\nimport Data.Maybe\n\nfrom_maybe :: a -&gt; Maybe a -&gt; a\nfrom_maybe a Nothing = a\nfrom_maybe _ = Data.Maybe.fromJust\n</code></pre>\n\n<p>I'm wondering whether this is a <code>ghc</code> restriction. I tried to see if I\ncould find anything about the number of parameters in the Haskell 2010\nReport but I wasn't successful.</p>\n\n<p>Is this legal Haskell or isn't it? If not, where is this parameter count\nrestriction listed?</p>\n"}, {"tags": ["algorithm", "haskell", "graph", "graph-theory", "digraphs"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1509554597, "post_id": 47059507, "comment_id": 81066788, "body": "Can nodes have edges to themselves? Can a node have 2 edges to the same other node?"}, {"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1509554753, "post_id": 47059507, "comment_id": 81066882, "body": "@Cirdec yes, perhaps my explanation was lacking, but a node can connect to itself or any other node twice."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1509555462, "post_id": 47059507, "comment_id": 81067300, "body": "Generating them by their out-degree sequence would remove a bunch of isomorhisms."}, {"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1509555629, "post_id": 47059507, "comment_id": 81067425, "body": "@Cirdec Could you clarify? If I understand, I am generating by in-degree, but there can be vastly more variability in the out-degrees (since in=2, and out=arbitrary), so I would guess out-degree would be more expensive."}, {"owner": {"reputation": 580, "user_id": 415384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad2350087df08ded7827f447f986ed2e?s=128&d=identicon&r=PG", "display_name": "gilleain", "link": "https://stackoverflow.com/users/415384/gilleain"}, "edited": false, "score": 0, "creation_date": 1509555639, "post_id": 47059507, "comment_id": 81067433, "body": "I can&#39;t read Haskell well enough to tell for sure, but your description of your canonical check suggests that it is only loosely related to nauty&#39;s algorithm. Essentially you are saying that <a href=\"https://en.wikipedia.org/wiki/Bogosort\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Bogosort</a> is related to quicksort :)"}, {"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "reply_to_user": {"reputation": 580, "user_id": 415384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad2350087df08ded7827f447f986ed2e?s=128&d=identicon&r=PG", "display_name": "gilleain", "link": "https://stackoverflow.com/users/415384/gilleain"}, "edited": false, "score": 0, "creation_date": 1509555738, "post_id": 47059507, "comment_id": 81067496, "body": "@gilleain you&#39;re probably right, I&#39;m no mathematician (yet?). Could there be another algo you&#39;d recommend? Or would implementing Nauty properly be a good solution?"}, {"owner": {"reputation": 580, "user_id": 415384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad2350087df08ded7827f447f986ed2e?s=128&d=identicon&r=PG", "display_name": "gilleain", "link": "https://stackoverflow.com/users/415384/gilleain"}, "edited": false, "score": 0, "creation_date": 1509555989, "post_id": 47059507, "comment_id": 81067655, "body": "Implementing a more nauty/bliss -like algorithm might be good, but there are other possibilities. This SO question is a quick introduction to partition refinement : <a href=\"https://stackoverflow.com/questions/26893304/rejecting-isomorphisms-from-collection-of-graphs\" title=\"rejecting isomorphisms from collection of graphs\">stackoverflow.com/questions/26893304/&hellip;</a>"}, {"owner": {"reputation": 580, "user_id": 415384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad2350087df08ded7827f447f986ed2e?s=128&d=identicon&r=PG", "display_name": "gilleain", "link": "https://stackoverflow.com/users/415384/gilleain"}, "edited": false, "score": 0, "creation_date": 1509555998, "post_id": 47059507, "comment_id": 81067657, "body": "Also see : <a href=\"http://pallini.di.uniroma1.it/Introduction.html\" rel=\"nofollow noreferrer\">pallini.di.uniroma1.it/Introduction.html</a>"}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1509556724, "post_id": 47059507, "comment_id": 81068131, "body": "What are the 6 graphs for 2 nodes? Perhaps I&#39;m misunderstanding or doing something stupid, but I can only come up with 5."}, {"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "reply_to_user": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1509556804, "post_id": 47059507, "comment_id": 81068187, "body": "@ryachza maybe you can plug this into a text editor and add spaces to clean it up? <code>[[2,0],[2,0]] [[2,0],[1,1]] [[2,0],[0,2]] [[1,1],[2,0]] [[1,1],[1,1]] [[0,2],[2,0]]</code>"}, {"owner": {"reputation": 580, "user_id": 415384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad2350087df08ded7827f447f986ed2e?s=128&d=identicon&r=PG", "display_name": "gilleain", "link": "https://stackoverflow.com/users/415384/gilleain"}, "edited": false, "score": 0, "creation_date": 1509557749, "post_id": 47059507, "comment_id": 81068706, "body": "Oh, one other comment is - do you really have to generate these? As in, can&#39;t you use an existing generator to make all digraphs, and filter out those that match your conditions? What do these graph represent, anyway (not important, just curious..)?"}, {"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "edited": false, "score": 0, "creation_date": 1509558799, "post_id": 47059507, "comment_id": 81069334, "body": "@gillean re: &quot;can&#39;t you use...&quot; I&#39;m new to this, what would you recommend? re: &quot;what do they represent&quot;, sort of like neural nets, but constrained by a binary transition function, eg 2-arity boolean logic gates. I&#39;m applying some ideas from Integrated Information Theory (and my own) to these constructs, just for fun really, trying to explore the space where I consider &quot;general&quot; AI probably lives."}], "answers": [{"tags": [], "owner": {"reputation": 580, "user_id": 415384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad2350087df08ded7827f447f986ed2e?s=128&d=identicon&r=PG", "display_name": "gilleain", "link": "https://stackoverflow.com/users/415384/gilleain"}, "is_accepted": true, "score": 1, "last_activity_date": 1509637052, "last_edit_date": 1509637052, "creation_date": 1509622879, "answer_id": 47074420, "question_id": 47059507, "link": "https://stackoverflow.com/questions/47059507/generate-all-unique-directed-graphs-with-2-inputs-to-each-node/47074420#47074420", "title": "Generate all unique directed graphs with 2 inputs to each node", "body": "<p>There are a number of approaches you could try. One thing that I do note is that having loops with multi-edges (colored loops?) is a little unusual, but is probably just needs a refinement of existing techniques.</p>\n\n<h2>Filter the output of another program</h2>\n\n<p>The obvious candidate here is of course nAUTy/traces (<a href=\"http://pallini.di.uniroma1.it/\" rel=\"nofollow noreferrer\">http://pallini.di.uniroma1.it/</a>) or similar (saucy, bliss, etc). Depending on how you want to do this, it could be as simple as run nauty (for example) and output to file, then read in the list filtering as you go.</p>\n\n<p>For larger values of <em>n</em> this could start to be a problem if you are generating huge files. I'm not sure whether you start to run out of space before you run out of time, but still. What might be better is to generate and test them as you go, throwing away candidates. For your purposes, there may be an existing library for generation - I found <a href=\"https://hackage.haskell.org/package/hgal-2.0.0.2\" rel=\"nofollow noreferrer\">this one</a> but I have no idea how good it is.</p>\n\n<h2>Use graph invariants</h2>\n\n<p>A very easy first step to more efficient listing of graphs is to filter using <a href=\"https://en.wikipedia.org/wiki/Graph_property\" rel=\"nofollow noreferrer\">graph invariants</a>. An obvious one would be <a href=\"https://math.stackexchange.com/questions/61361/what-condition-need-to-be-imposed-on-havel-hakimi-theorem-to-check-for-connected\">degree sequence</a> (the ordered list of degrees of the graph). Others include the number of cycles, the girth, and so on. For your purposes, there might be some indegree/outdegree sequence you could use.</p>\n\n<p>The basic idea is to use the invariant as a filter to avoid expensive checks for isomorphism. You can store the (list of ) invariants for already generated graphs, and check the new one against the list first. The canonical form of a structure is a kind of invariant.</p>\n\n<h2>Implement an algorithm</h2>\n\n<p>There are lost of GI algorithms, including the ones used by nauty and friends. However, they do tend to be quite hard! The description given in <a href=\"https://stackoverflow.com/a/27001051/415384\">this answer</a> is an excellent overview, but the devil is in the details of course.</p>\n\n<p>Also note that the description is for general graphs, while you have a specific subclass of graph that might be easier to generate. There may be papers out there for digraph listing (generating) but I have not checked.</p>\n"}], "owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 2, "accepted_answer_id": 47074420, "answer_count": 1, "score": 4, "last_activity_date": 1509637052, "creation_date": 1509553957, "last_edit_date": 1509557482, "question_id": 47059507, "link": "https://stackoverflow.com/questions/47059507/generate-all-unique-directed-graphs-with-2-inputs-to-each-node", "title": "Generate all unique directed graphs with 2 inputs to each node", "body": "<p>I'm trying to generate all unique digraphs that fit a spec:</p>\n\n<ul>\n<li>each node must have exactly 2 inputs</li>\n<li>and are allowed arbitrarily many outputs to other nodes in the graph</li>\n</ul>\n\n<p>My current solution is slow. Eg for 6 nodes, the algo has taken 1.5 days to get where I <em>think</em> it's complete, but it'll probably be checking for a few more days still.</p>\n\n<p>My algorithm for a graph with <code>n</code> nodes:</p>\n\n<ol>\n<li><p>generate all <code>n</code>-length strings of <code>0</code>, where one symbol is a <code>1</code>, eg, for n=3, <code>[[0,0,1], [0,1,0], [1,0,0]]</code>. These can be thought of as rows from an identity matrix.</p></li>\n<li><p>generate all possible <code>n * n</code> matrixes where each row is all possible combinations of <code>step 1. + step 1.</code></p></li>\n</ol>\n\n<p>This is the connectivity matrix where each cell represents a connection from <code>column-index</code> to <code>row-index</code></p>\n\n<p>So, for n=3, these are possible:</p>\n\n<ul>\n<li><code>[0,1,0] + [1,0,0] = [1,1,0]</code></li>\n<li><code>[1,0,0] + [1,0,0] = [2,0,0]</code></li>\n</ul>\n\n<p>These represent the inputs to a node, and by adding step 1 to itself, the result will always represent 2 inputs.</p>\n\n<p>For ex:</p>\n\n<pre><code>     A B C     \nA' [[0,1,1],\nB'  [0,2,0],\nC'  [1,1,0]]\n</code></pre>\n\n<p>So <code>B</code> and <code>C</code> connect to <code>A</code> once each: <code>B -&gt; A', C -&gt; A'</code>, </p>\n\n<p>And <code>B</code> connects to itself twice: <code>B =&gt; B'</code> </p>\n\n<ol start=\"3\">\n<li>I only want unique ones, so for each connectivity matrix generated, I can only keep it if it is not isomorphic to an already-seen graph.</li>\n</ol>\n\n<p>This step is expensive. I need to convert the graph to a \"canonical form\" by running through each permutation of isomorphic graphs, sorting them, and considering the first one as the \"canonical form\".</p>\n\n<p>If anyone dives into testing any of this out, here are the count of unique graphs for <code>n</code> nodes:</p>\n\n<pre><code>2 - 6\n3 - 44\n4 - 475\n5 - 6874\n6 - 109,934 (I think, it's not done running yet but I haven't found a new graph in &gt;24 hrs.)\n7 - I really wanna know! \n</code></pre>\n\n<p>Possible optimizations:</p>\n\n<ol>\n<li><p>since I get to generate the graphs to test, is there a way of ruling them out, without testing, as being isomorphic to already-seen ones?</p></li>\n<li><p>is there a faster graph-isomorphism algorithm? <strike>I think this one is related to \"Nauty\", and</strike> there are others I've read of in papers, but I haven't had the expertise (or bandwidth) to implement them yet.</p></li>\n</ol>\n\n<p>Here's a demonstrable connectivity matrix that can be plotted at graphonline.ru for fun, showing self connections, and 2 connections to t he same node:</p>\n\n<pre><code>1, 0, 0, 0, 0, 1, \n1, 0, 0, 0, 1, 0, \n0, 1, 0, 1, 0, 0, \n0, 1, 2, 0, 0, 0, \n0, 0, 0, 1, 0, 1, \n0, 0, 0, 0, 1, 0,\n</code></pre>\n\n<hr>\n\n<p>here's the code in haskell if you want to play with it, but I'm more concerned about getting the algorithm right (eg pruning down the search space), than the implementation:</p>\n\n<pre><code>-- | generate all permutations of length n given symbols from xs\nnpermutations :: [a] -&gt; Int -&gt; [[a]]\nnpermutations xs size = mapM (const xs) [1..size]\n\nidentity :: Int -&gt; [[Int]]\nidentity size = scanl\n                (\\xs _ -&gt; take size $ 0 : xs)      -- keep shifting right\n                (1 : (take (size - 1) (repeat 0))) -- initial, [1,0,0,...]\n                [1 .. size-1]                      -- correct size\n\n-- | return all possible pairings of [Column]\ncolumnPairs :: [[a]] -&gt; [([a], [a])]\ncolumnPairs xs = (map (\\x y -&gt; (x,y)) xs)\n                 &lt;*&gt; xs\n\n-- | remove duplicates\nrmdups :: Ord a =&gt; [a] -&gt; [a]\nrmdups = rmdups' Set.empty where\n  rmdups' _ [] = []\n  rmdups' a (b : c) = if Set.member b a\n    then rmdups' a c\n    else b : rmdups' (Set.insert b a) c\n\n\n-- | all possible patterns for inputting 2 things into one node.\n-- eg [0,1,1] means cells B, and C project into some node\n--    [0,2,0] means cell B projects twice into one node\nbinaryInputs :: Int -&gt; [[Int]]\nbinaryInputs size = rmdups $ map -- rmdups because [1,0]+[0,1] is same as flipped\n         (\\(x,y) -&gt; zipWith (+) x y)\n         (columnPairs $ identity size)\n\ntransposeAdjMat :: [[Int]] -&gt; [[Int]]\ntransposeAdjMat ([]:_) = []\ntransposeAdjMat m = (map head m) : transposeAdjMat (map tail m)\n\n-- | AdjMap [(name, inbounds)]\ndata AdjMap a = AdjMap [(a, [a])] deriving (Show, Eq)\n\naddAdjColToMap :: Int -- index\n               -&gt; [Int] -- inbound\n               -&gt; AdjMap Int\n               -&gt; AdjMap Int\naddAdjColToMap ix col (AdjMap xs) = \n  let conns = foldl (\\c (cnt, i) -&gt; case cnt of\n                        1 -&gt; i:c\n                        2 -&gt; i:i:c\n                        _ -&gt; c\n                    ) \n              [] \n              (zip col [0..])  in\n    AdjMap ((ix, conns) : xs)\n\nadjMatToMap :: [[Int]] -&gt; AdjMap Int\nadjMatToMap cols = foldl \n  (\\adjMap@(AdjMap nodes) col -&gt; addAdjColToMap (length nodes) col adjMap)\n  (AdjMap [])\n  cols\n\n-- | a graph's canonical form : http://mfukar.github.io/2015/09/30/haskellxiii.html\n-- very expensive algo, of course\ncanon :: (Ord a, Enum a, Show a) =&gt; AdjMap a -&gt; String\ncanon (AdjMap g) = minimum $ map f $ Data.List.permutations [1..(length g)]\n   where\n      -- Graph vertices:\n      vs = map fst g\n      -- Find, via brute force on all possible orderings (permutations) of vs,\n      -- a mapping of vs to [1..(length g)] which is minimal.\n      -- For example, map [1, 5, 6, 7] to [1, 2, 3, 4].\n      -- Minimal is defined lexicographically, since `f` returns strings:\n      f p = let n = zip vs p\n            in (show [(snd x, sort id $ map (\\x -&gt; snd $ head $ snd $ break ((==) x . fst) n)\n                                      $ snd $ take_edge g x)\n                     | x &lt;- sort snd n])\n      -- Sort elements of N in ascending order of (map f N):\n      sort f n = foldr (\\x xs -&gt; let (lt, gt) = break ((&lt;) (f x) . f) xs\n                                  in lt ++ [x] ++ gt) [] n\n      -- Get the first entry from the adjacency list G that starts from the given node X\n      -- (actually, the vertex is the first entry of the pair, hence `(fst x)`):\n      take_edge g x = head $ dropWhile ((/=) (fst x) . fst) g\n\n-- | all possible matrixes where each node has 2 inputs and arbitrary outs\nbinaryMatrixes :: Int -&gt; [[[Int]]]\nbinaryMatrixes size = let columns = binaryInputs size \n                          unfiltered = mapM (const columns) [1..size] in\n  fst $ foldl'\n  (\\(keep, seen) x -&gt; let can = canon . adjMatToMap $ x in\n                        (if Set.member can seen \n                         then keep\n                         else id $! x : keep\n                        , Set.insert can seen))\n  ([], Set.fromList [])\n  unfiltered\n</code></pre>\n"}, {"tags": ["string", "list", "function", "haskell", "recursion"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1509552797, "post_id": 47058923, "comment_id": 81065639, "body": "It doesn&#39;t work: <code>betweenAF &quot;all&quot;</code> returns <code>True</code> when it should be <code>False</code>."}, {"owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "edited": false, "score": 0, "creation_date": 1509552844, "post_id": 47058923, "comment_id": 81065663, "body": "<code>betweenAF &quot;lla&quot;</code> yields <code>false</code> as expected: <a href=\"https://ideone.com/E54So5\" rel=\"nofollow noreferrer\">ideone.com/E54So5</a> ."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509553583, "post_id": 47058923, "comment_id": 81066139, "body": "<code>(x:y:xs)</code> only matches strings of length 2 or more; your <code>_</code> case catches all singleton lists <i>and</i> the empty list, not all of which should have the same return value."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1509552910, "creation_date": 1509552910, "answer_id": 47059176, "question_id": 47058923, "link": "https://stackoverflow.com/questions/47058923/haskell-function-giving-wrong-output/47059176#47059176", "title": "Haskell Function Giving Wrong Output", "body": "<p>The function works. Just, what it does is this: it sees whether <em>there is</em> <strong>any</strong> even-indexed element which is in <code>'a'..'f'</code>. Whereas you apparently want it to see whether <strong>all</strong> elements are in the range.</p>\n\n<p>Apply simple logical inversion to fix this.</p>\n"}, {"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1509552981, "post_id": 47059180, "comment_id": 81065746, "body": "you missed the <code>| otherwise</code>, but <i>otherwise</i> (drum sting) perfect."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1509553066, "post_id": 47059180, "comment_id": 81065814, "body": "I left it out, since I am conflating &quot;<code>x</code> not in the list&quot; with &quot;<code>(x:y:xs)</code> didn&#39;t match&quot;. Of course, then I forgot to handle the empty list, which I then added separately, so I&#39;m going to take a moment to decide if this is better than an explicit <code>otherwise</code>..."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1509553247, "post_id": 47059180, "comment_id": 81065932, "body": "I think omitting the otherwise is incorrect anyway, isn&#39;t it? What does Haskell do if it pattern matches but no guards match?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1509553379, "post_id": 47059180, "comment_id": 81066010, "body": "Yeah, I&#39;m blanking on an elegant way to handle that."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1509553639, "post_id": 47059180, "comment_id": 81066180, "body": "maybe <a href=\"https://gist.github.com/NotTheEconomist/9a9688dc872a032866240a912a8eb6e7\" rel=\"nofollow noreferrer\">this</a>?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1509554155, "post_id": 47059180, "comment_id": 81066497, "body": "I don&#39;t really like the duplicated <code>elem</code> test, but it certainly isn&#39;t <i>worse</i> than what I have."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1509554670, "post_id": 47059180, "comment_id": 81066826, "body": "agreed I don&#39;t like it either, but the alternative is testing <code>length xs</code> every recursion which I felt was less performant."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1509554944, "post_id": 47059180, "comment_id": 81067005, "body": "how about <code>betweenAF [] = True; betweenAF (x:ys) = (x `elem` [&#39;a&#39;..&#39;f&#39;]) &amp;&amp; betweenAF (drop 1 ys)</code>."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1509555711, "post_id": 47059180, "comment_id": 81067476, "body": "I think my favorite is <a href=\"https://gist.github.com/NotTheEconomist/11ebc9630e6c01ec800513071d6ad421\" rel=\"nofollow noreferrer\">this</a> where you pull out every other character first, then use <code>all</code> with the predicate."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509556690, "post_id": 47059180, "comment_id": 81068112, "body": "@WillNess Ah, yes. I forgot about <code>drop 1</code>, which basically acts like <code>tail</code> in the ways we want."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 2, "last_activity_date": 1509556831, "last_edit_date": 1509556831, "creation_date": 1509552920, "answer_id": 47059180, "question_id": 47058923, "link": "https://stackoverflow.com/questions/47058923/haskell-function-giving-wrong-output/47059180#47059180", "title": "Haskell Function Giving Wrong Output", "body": "<p>You have the cases reversed. If <code>x</code> <em>is</em> in the range, you are only part way done and have to recurse. If <code>x</code> is <em>not</em> in the range, you can immediately return False because it doesn't matter if the other letters are in the range or not. The property is vacuously true for an empty list because there are no letters that <em>aren't</em> in the desired range.</p>\n\n<pre><code>betweenAF :: String -&gt; Bool\nbetweenAF [x] = betweenAF [x,x] -- hack to handle odd-length lists\nbetweenAF (x:y:ys) | x `elem` ['a'..'f'] = betweenAF ys\n                   | otherwise = False\nbetweenAF [] = True\n</code></pre>\n\n<hr>\n\n<p>Better version, thanks to Will Ness:</p>\n\n<pre><code>betweenAF (x:xs) = x `elem` ['a'..'f'] &amp;&amp; betweenAF (drop 1 xs)\nbetweenAF [] = True\n</code></pre>\n\n<p>since <code>drop 1 [x]</code> and <code>drop 1 []</code> both evaluate to <code>[]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1509560850, "post_id": 47060473, "comment_id": 81070562, "body": "for me, using <code>(`elem` [&#39;a&#39;..&#39;z&#39;])</code> would make the last variant more tolerable, borderline OK even."}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 1, "last_activity_date": 1509557254, "creation_date": 1509557254, "answer_id": 47060473, "question_id": 47058923, "link": "https://stackoverflow.com/questions/47058923/haskell-function-giving-wrong-output/47060473#47060473", "title": "Haskell Function Giving Wrong Output", "body": "<p>Just because I spent a few minutes on this, I wanted to point out another possible solution. Instead of pattern matching against the whole string, you can pull out every other character and use <code>all</code> to check them all against the predicate. This removes the need to do any explicit recursion or pattern matching.</p>\n\n<pre><code>betweenAF :: String -&gt; Bool\nbetweenAF = all (flip elem ['a'..'z']) . everyOther where\n  everyOther xs = [v | (k,v) &lt;- zip (cycle [True, False]) xs, k]\n</code></pre>\n\n<p><code>everyOther</code> is equivalent to <code>map snd . filter (fst) . zip (cycle [True, False])</code> and <code>flip elem ['a'..'z']</code> is equivalent to <code>\\x -&gt; elem x ['a'..'z']</code>. All told this can be re-written as:</p>\n\n<pre><code>betweenAF = all (flip elem ['a'..'z']) . map snd . filter fst . zip (cycle [True, False])\n</code></pre>\n\n<p>This, however, is rather uglier than sin!</p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1509569999, "creation_date": 1509569999, "answer_id": 47063593, "question_id": 47058923, "link": "https://stackoverflow.com/questions/47058923/haskell-function-giving-wrong-output/47063593#47063593", "title": "Haskell Function Giving Wrong Output", "body": "<p>Just for some practice i guess you may also do as follows;</p>\n\n<pre><code>everyOtherInAF :: String -&gt; Bool\neveryOtherInAF = all id . zipWith ($) (cycle [(`elem` ['A'..'F']), const True])\n\n*Main&gt; everyOtherInAF \"AsErCgHm\"\nFalse\n*Main&gt; everyOtherInAF \"AsErCgFm\"\nTrue\n*Main&gt; everyOtherInAF \"AsErjgFm\"\nFalse\n*Main&gt; everyOtherInAF \"AsErAgFm\"\nTrue\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8793788, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-1GF-TK3Z-hU/AAAAAAAAAAI/AAAAAAAAHjU/rg0JpaFThNo/photo.jpg?sz=128", "display_name": "lou tej", "link": "https://stackoverflow.com/users/8793788/lou-tej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 47059180, "answer_count": 4, "score": 0, "last_activity_date": 1509569999, "creation_date": 1509552023, "question_id": 47058923, "link": "https://stackoverflow.com/questions/47058923/haskell-function-giving-wrong-output", "title": "Haskell Function Giving Wrong Output", "body": "<p>I have this prompt: make a function that takes a string and sees if every other letter is an element of ['a' .. 'f']</p>\n\n<p>So I have this:</p>\n\n<pre><code>betweenAF :: String -&gt; Bool\nbetweenAF (x:y:xs)  \n    | x `elem` ['a' .. 'f'] = True\n    | otherwise = betweenAF xs\nbetweenAF _ = False\n</code></pre>\n\n<p>Now it works on the first letter of the string, like if I put betweenAF \"all\", but it doesn't work if I put betweenAF \"lla\". Can someone tell me what I am doing wrong and how to fix it?</p>\n"}, {"tags": ["json", "api", "haskell"], "comments": [{"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 2, "creation_date": 1509554342, "post_id": 47058726, "comment_id": 81066610, "body": "Because you specify the type of <code>IO (Response ())</code>, <code>httpJSON</code> will try to parse the response body using the <code>FromJSON</code> instance of <code>()</code>. You could try replacing <code>()</code> with <code>Value</code> - I think that will parse arbitrary JSON."}], "owner": {"reputation": 660, "user_id": 3056525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ca5b6203fc7b814d6c2559be8354a0d?s=128&d=identicon&r=PG", "display_name": "TomDane", "link": "https://stackoverflow.com/users/3056525/tomdane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1509551865, "creation_date": 1509551391, "last_edit_date": 1509551865, "question_id": 47058726, "link": "https://stackoverflow.com/questions/47058726/why-does-the-httpjson-method-in-network-http-simple-throw-an-exception", "title": "Why does the httpJSON method in Network.Http.Simple throw an exception?", "body": "<p>Here is the code I am running: </p>\n\n<pre><code>makeRequest = do\n    response &lt;- httpJSON \"GET http://httpbin.org/get\" :: IO (Response ())\n    putStrLn $ \"The status code was: \" ++ show (getResponseStatusCode response)\n</code></pre>\n\n<p>It uses the httpJSON method from <a href=\"https://hackage.haskell.org/package/http-conduit-2.2.3.2/docs/Network-HTTP-Simple.html\" rel=\"nofollow noreferrer\">Network.Http.Simple</a></p>\n\n<p>If I navigate to the URL <a href=\"http://httpbin.org/get\" rel=\"nofollow noreferrer\">http://httpbin.org/get</a> I can see that the JSON returned is valid. </p>\n\n<p>However, the code returns the following error: </p>\n\n<pre><code>Exception: JSONConversionException Request {\n  host                 = \"httpbin.org\"\n  port                 = 80\n  secure               = False\n  requestHeaders       = [(\"Accept\",\"application/json\")]\n  path                 = \"/get\"\n  queryString          = \"\"\n  method               = \"GET\"\n  proxy                = Nothing\n  rawBody              = False\n  redirectCount        = 10\n  responseTimeout      = ResponseTimeoutDefault\n  requestVersion       = HTTP/1.1\n}\n (Response {responseStatus = Status {statusCode = 200, statusMessage = \"OK\"}, responseVersion = HTTP/1.1, responseHeaders = [(\"Connection\",\"keep-alive\"),(\"Server\",\"meinheld/0.6.1\"),(\"Date\",\"Wed, 01 Nov 2017 15:41:54 GMT\"),(\"Content-Type\",\"application/json\"),(\"Access-Control-Allow-Origin\",\"*\"),(\"Access-Control-Allow-Credentials\",\"true\"),(\"X-Powered-By\",\"Flask\"),(\"X-Processed-Time\",\"0.000639915466309\"),(\"Content-Length\",\"226\"),(\"Via\",\"1.1 vegur\")], responseBody = Object (fromList [(\"origin\",String \"87.194.144.188\"),(\"args\",Object (fromList [])),(\"url\",String \"http://httpbin.org/get\"),(\"headers\",Object (fromList [(\"Accept\",String \"application/json\"),(\"Accept-Encoding\",String \"gzip\"),(\"Connection\",String \"close\"),(\"Host\",String \"httpbin.org\")]))]), responseCookieJar = CJ {expose = []}, responseClose' = ResponseClose}) \"expected (), encountered Object\"\n</code></pre>\n\n<p>Any idea what I am doing wrong? </p>\n\n<p>Thanks so much. </p>\n"}, {"tags": ["haskell", "aeson"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1509551122, "post_id": 47058601, "comment_id": 81064497, "body": "What is the problem with creating a <code>ToJSON</code> for <code>SumType</code>? You can use the definition in <code>Show SumType</code>."}, {"owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509551846, "post_id": 47058601, "comment_id": 81064998, "body": "@WillemVanOnsem I thought <code>ToJSON</code> only accepts <code>objects</code>. I did not realize I can just return a string.  If you put your response in the answer, I can accept it."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1512663847, "post_id": 47059009, "comment_id": 82358879, "body": "What does <code>&quot;SumType&quot;</code> passed to <code>withText</code> do? Change the failure message when parsing some other way? That might be good to demonstrate."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1509553556, "last_edit_date": 1509553556, "creation_date": 1509552323, "answer_id": 47059009, "question_id": 47058601, "link": "https://stackoverflow.com/questions/47058601/making-tojson-use-show-instance/47059009#47059009", "title": "Making ToJSON use Show Instance", "body": "<p>I do not see what the problem is with defining a <code>ToJSON</code> instance for the <code>SumType</code>. You can do this with:</p>\n\n<pre><code>import Data.Aeson(ToJSON(toJSON), Value(String))\nimport Data.Text(pack)\n\ninstance ToJSON SumType where\n    toJSON = String . pack . show\n</code></pre>\n\n<p>Or if you want to use other strings for the <code>ToJSON</code> than <code>Show</code>:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Data.Aeson(ToJSON(toJSON), Value(String))\n\ninstance ToJSON SumType where\n    toJSON ABC = String \"ABC for JSON\"\n    toJSON DEF = String \"DEF for JSON\"\n</code></pre>\n\n<p>Now Haskell will JSON-encode the <code>SumType</code> as a JSON string:</p>\n\n<pre><code>Prelude Data.Aeson&gt; encode ABC\n\"\\\"ABC for JSON\\\"\"\nPrelude Data.Aeson&gt; encode DEF\n\"\\\"DEF for JSON\\\"\"\n</code></pre>\n\n<p>You can do the same with <code>FromJSON</code> to parse the JSON string back into a <code>SumType</code> object:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Data.Aeson(FromJSON(parseJSON), withText)\n\ninstance FromJSON SumType where\n    parseJSON = withText \"SumType\" f\n        where f \"ABC for JSON\" = return ABC\n              f \"DEF for JSON\" = return DEF\n              f _ = fail \"Can not understand what you say!\"\n</code></pre>\n\n<p>If we then parse back the JSON string, we get:</p>\n\n<pre><code>Prelude Data.Aeson&gt; decode \"\\\"ABC for JSON\\\"\" :: Maybe SumType\nJust ABC\nPrelude Data.Aeson&gt; decode \"\\\"DEF for JSON\\\"\" :: Maybe SumType\nJust DEF\nPrelude Data.Aeson&gt; decode \"\\\"other JSON string\\\"\" :: Maybe SumType\nNothing\nPrelude Data.Aeson&gt; decode \"{}\" :: Maybe SumType\nNothing\n</code></pre>\n\n<p>So in case we do not decode a JSON string that follows one of the patterns we have defined, the parsing will fail. The same happens if we do not provide a JSON string, but for instance an empty JSON object.</p>\n\n<blockquote>\n  <p><strong>Additional notes</strong>:</p>\n  \n  <ol>\n  <li>Since <code>SumType</code> here has two values, you can also use a JSON boolean to encode the values.</li>\n  <li>you can also encode on different JSON objects. You can for instance use the JSON string for <code>ABC</code>, and an integer for <code>DEF</code>.\n  Although I would advice not to do this until there are good reasons\n  (if for instance <code>ABC</code> carries only a string, and <code>DEF</code> ony an\n  integer).</li>\n  <li>usually the more complex you make encoding, the more complex decoding will be.</li>\n  </ol>\n</blockquote>\n"}], "owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 47059009, "answer_count": 1, "score": 2, "last_activity_date": 1509553556, "creation_date": 1509551024, "last_edit_date": 1509551133, "question_id": 47058601, "link": "https://stackoverflow.com/questions/47058601/making-tojson-use-show-instance", "title": "Making ToJSON use Show Instance", "body": "<p>If I have a data type that looks like this: </p>\n\n<pre><code>data SumType = ABC | DEF deriving (Generic, ToJSON)\ndata MyType = MyType {field1 :: String, field2 :: SumType} deriving (Generic, ToJSON) \n</code></pre>\n\n<p>The above will generate a JSON that looks like: <code>{\"field1\": \"blah\", \"field2\":\"ABC\"}</code></p>\n\n<p>In practice, <code>MyType</code> is a fairly complex type and I would like to keep the <code>ToJSON</code> deriving but want to adjust just one field to use the show instance. </p>\n\n<pre><code> instance Show SumType where\n   show ABC = \"abc-blah\"\n   show DEF = \"def-xyz\" \n</code></pre>\n\n<p>Unfortunately, the above <code>Show</code> instance does not get picked up by <code>ToJSON</code> (I don't know if it is supposed to).  Hand rolling <code>ToJSON</code> for <code>SumType</code> does not <em>seem</em> to work because it expects a key-value pair (Maybe there is another of way doing it?). In other words, the JSON will be like: <code>{\"field1\": \"blah\", \"field2\":{\"field3\": \"ABC\"}}</code> -- I just want to change the way the value is stringified and not create a new object there. </p>\n\n<p>Any suggestions on how I can change the output string of <code>SumType</code> without manually creating <code>ToJSON</code> for <code>MyType</code>? So the output is  <code>{\"field1\": \"blah\", \"field2\":\"abc-blah\"}</code></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "reflex"], "answers": [{"tags": [], "owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1512059702, "creation_date": 1512059702, "answer_id": 47578251, "question_id": 47057131, "link": "https://stackoverflow.com/questions/47057131/reflex-delaying-events-based-on-a-behavior/47578251#47578251", "title": "Reflex: Delaying events based on a behavior", "body": "<p>Apparently, the delay will never fire because when the widget defined by <code>eDelsM</code> is active from event <code>e0</code>, it will be waiting until the next event, <code>e1</code> to create a delay. However, by the time the next instance of the event fires, <code>e1</code>, a new instance of the <code>eDelsM</code> widget will become active and start waiting for the next instance of the event, <code>e2</code>.  The solution is to trigger a new event as soon as <code>eDelsM</code> is recreated.</p>\n\n<pre><code>eDelsM = (\\t -&gt; getPostBuild &gt;&gt;= delay t) &lt;$&gt; b &lt;@ e   \n</code></pre>\n"}], "owner": {"reputation": 1392, "user_id": 5198575, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RAYCSjVZdnQ/AAAAAAAAAAI/AAAAAAAAClo/VQ8V_H3l8O8/photo.jpg?sz=128", "display_name": "trevor cook", "link": "https://stackoverflow.com/users/5198575/trevor-cook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 47578251, "answer_count": 1, "score": 1, "last_activity_date": 1512059702, "creation_date": 1509546299, "question_id": 47057131, "link": "https://stackoverflow.com/questions/47057131/reflex-delaying-events-based-on-a-behavior", "title": "Reflex: Delaying events based on a behavior", "body": "<p>Using reflex-frp and reflex-dom I need to delay events based on a behavior.\nI have:</p>\n\n<pre><code>delayEvent :: (MonadWidget t m, Reflex t) \n           =&gt; Event t () -&gt; Behavior t NominalDiffTime -&gt; m (Event t ())\ndelayEvent e b = switch . current &lt;$&gt; widgetHold (return never) eDelsM\n  where\n    eDelsM = (`delay` e) &lt;$&gt; b &lt;@ e -- Event t (m (Event t ()))\n</code></pre>\n\n<p>however the return event never fires. Is there a simple mistake I'm making here or does the whole approach need rethinking?</p>\n"}, {"tags": ["haskell", "process", "io", "ipc"], "answers": [{"comments": [{"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1509551053, "post_id": 47056973, "comment_id": 81064445, "body": "Won&#39;t this also cause and &quot;end of file&quot; error, as soon as <code>doStuff</code> tries to read from <code>outh</code> before the spawned process produces something?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1509554109, "post_id": 47056973, "comment_id": 81066472, "body": "@DamianNadales <code>doStuff</code> must never read from <code>outh</code> -- the point of the code above it is to read all from <code>outh</code> and discard it."}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1509613503, "post_id": 47056973, "comment_id": 81090592, "body": "That&#39;s the problem, that I need to read only one line, and then discard the rest :) Otherwise I could redirect it to a file."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1509620649, "post_id": 47056973, "comment_id": 81095549, "body": "@DamianNadales What&#39;s the issue, then? First read a line with <code>getLine</code>, and later use the code above to discard the rest."}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1509621583, "post_id": 47056973, "comment_id": 81096111, "body": "The problem is that if I try to read before the process has written something the parent process won&#39;t block but receive an end of file error."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1509545806, "creation_date": 1509545806, "answer_id": 47056973, "question_id": 47055929, "link": "https://stackoverflow.com/questions/47055929/reading-a-couple-of-lines-of-a-pipe-obtained-with-createprocess-and-then-closing/47056973#47056973", "title": "Reading a couple of lines of a pipe obtained with createProcess and then closing it", "body": "<p>The alternative to use depends on the behavior of the external command.</p>\n\n<p>If you simply want to interrupt that, you can <code>hClose outh</code>. This will close the pipe, and further writes to the pipe by the external command will fail with a \"broken pipe\" error. Most processes terminate upon receiving this.</p>\n\n<p>If you instead want to read and discard the output, you can do that as well. Perhaps the easiest way is</p>\n\n<pre><code>do c &lt;- hGetContents outh\n   evaluate (length c)  -- force this to fetch all data\n   doStuff              -- now we are sure that the remote end closed its output\n</code></pre>\n\n<p>which should run in constant space.</p>\n\n<p>If you don't want to wait for the process to end before performing <code>doStuff</code>, wrap everything in <code>forkIO</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 1, "last_activity_date": 1509556280, "last_edit_date": 1509556280, "creation_date": 1509555973, "answer_id": 47060096, "question_id": 47055929, "link": "https://stackoverflow.com/questions/47055929/reading-a-couple-of-lines-of-a-pipe-obtained-with-createprocess-and-then-closing/47060096#47060096", "title": "Reading a couple of lines of a pipe obtained with createProcess and then closing it", "body": "<blockquote>\n  <p>Now the problem is that if the pipe is not read, \"someproc\" will block as soon as it is full.  [...] Is there any way in Haskell in which I can automatically discard the\n  input to the pipe (or even redirect it to a file)?</p>\n</blockquote>\n\n<p>There is a helper library for <em>process</em> called <a href=\"http://hackage.haskell.org/package/process-streaming\" rel=\"nofollow noreferrer\"><em>process-streaming</em></a> (written by the author of this answer) that tries to do just that: even if the user passes a stream-consuming function that doesn't exhaust a standard stream, it drains the stream <em>automatically</em> under the hood to avoid potential deadlocks.</p>\n\n<p>The library doesn't work directly with handles, but accepts <a href=\"http://hackage.haskell.org/package/pipes\" rel=\"nofollow noreferrer\">pipe</a>-consuming functions and <a href=\"https://hackage.haskell.org/package/foldl\" rel=\"nofollow noreferrer\">foldl</a> folds through an <a href=\"https://hackage.haskell.org/package/pipes-transduce-0.4/docs/Pipes-Transduce.html\" rel=\"nofollow noreferrer\">adapter type</a>.</p>\n\n<p>An example of reading the first line:</p>\n\n<pre><code>import           Data.Text.Lazy\nimport qualified Pipes.Prelude\nimport           System.Process.Streaming      (CreateProcess,shell,\n                                                piped,execute,foldOut,transduce1,withCont)\nimport           System.Process.Streaming.Text (utf8x,foldedLines)\n\nprogram :: CreateProcess\nprogram = piped $ shell \"{ echo aaa ; echo bbbb ; }\"\n\nfirstLine :: IO (Maybe Text)\nfirstLine = execute program streams\n    where\n    streams = foldOut\n            . transduce1 utf8x\n            . transduce1 foldedLines\n            $ withCont Pipes.Prelude.head\n</code></pre>\n\n<p>The library has a much bigger dependency footprint than <em>process</em> though.</p>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 47060096, "answer_count": 2, "score": 1, "last_activity_date": 1509556280, "creation_date": 1509542722, "question_id": 47055929, "link": "https://stackoverflow.com/questions/47055929/reading-a-couple-of-lines-of-a-pipe-obtained-with-createprocess-and-then-closing", "title": "Reading a couple of lines of a pipe obtained with createProcess and then closing it", "body": "<p>I have a function that spawns a process as follows:</p>\n\n<pre><code>(_, Just outh, _, ph) &lt;- createProcess $\n    (proc \"someproc\" []) { std_out = CreatePipe }\nline &lt;- hGetLine outh\ndoSomeComputationOn line\n-- ... 'outh' is not read anymore from here onwards\n</code></pre>\n\n<p>So <code>\"someproc\"</code> is created, and then the parent reads a <code>line</code> from it to obtain some information, and then it forgets about the pipe whose handle is <code>outh</code>. </p>\n\n<p>Now the problem is that if the pipe is not read, <code>\"someproc\"</code> will block as soon as it is full. So this requires that the parent process reads <code>outh</code> even if it does not do anything with it. So my questions are:</p>\n\n<ol>\n<li>Is this this a good way to get the first line of a child process' output and then forget about additional output?</li>\n<li>Is there any way in Haskell in which I can automatically discard the input to the pipe (or even redirect it to a file)?. </li>\n</ol>\n\n<p>So far the only way I can see to woraround this problem is spawning a new thread that constantly tries to read from <code>outh</code> (and just discards the output), which indicates that I'm doing something wrong ...</p>\n\n<p>As additional background, this question is related to <a href=\"https://stackoverflow.com/questions/47053799/reading-from-a-handle-obtained-outside-createprocess\">this one</a>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509538389, "post_id": 47054266, "comment_id": 81055957, "body": "<code>nub</code> is usually not the preferred way to do a uniqueness filter, since it does not work very efficient. You can use a <i>hash set</i>."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1509547370, "post_id": 47054266, "comment_id": 81062051, "body": "if you&#39;re just interested in the length, you can have a smarter algorithm to detect collisions and reduce the length. Note that only powers of square numbers can be a duplicate of a double power of the base number, here 4^2 and 2^4.  However, processing is cheap, analysis is expensive."}], "answers": [{"comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 3, "creation_date": 1509545056, "post_id": 47054524, "comment_id": 81060430, "body": "I think for efficiency, instead of lists, it would be a better idea to use <a href=\"https://hackage.haskell.org/package/set-monad-0.2.0.0/docs/Data-Set-Monad.html\" rel=\"nofollow noreferrer\"><code>Data.Set.Monad</code></a> type with applicative to eliminate <code>nub</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1509548132, "post_id": 47054524, "comment_id": 81062544, "body": "True; I completely missed the request to make it faster. I was only suggesting how to reduce a set of three separate functions to a simple expression using standard abstractions."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1509538267, "creation_date": 1509538267, "answer_id": 47054524, "question_id": 47054266, "link": "https://stackoverflow.com/questions/47054266/get-the-number-of-distinct-powers/47054524#47054524", "title": "Get the number of distinct powers", "body": "<p>The <code>Applicative</code> instance for lists makes this trivial.</p>\n\n<pre><code>dist m n = length . nub $ (^) &lt;$&gt; [2..m] &lt;*&gt; [2..n]\n</code></pre>\n\n<p><code>(^) &lt;$&gt; [2..m]</code> results in a list of functions <code>fs = [(2^), (3^), ..., (m^)]</code>. <code>fs &lt;*&gt; [2..n]</code> then applies each of those functions to each value in <code>[2..n]</code>.</p>\n\n<p>There is also a trivial list comprehension, as</p>\n\n<pre><code>f &lt;$&gt; xs &lt;*&gt; ys == [f x y | x &lt;- xs, y &lt;- ys]\n</code></pre>\n\n<p>.</p>\n"}], "owner": {"reputation": 101, "user_id": 7219174, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/933696786762072/picture?type=large", "display_name": "Andrei M\u0103d\u0103lin Oanc\u0103", "link": "https://stackoverflow.com/users/7219174/andrei-m%c4%83d%c4%83lin-oanc%c4%83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509538267, "creation_date": 1509537448, "question_id": 47054266, "link": "https://stackoverflow.com/questions/47054266/get-the-number-of-distinct-powers", "title": "Get the number of distinct powers", "body": "<p>I have written a Haskell program that computes the number of different powers in a list. </p>\n\n<p>The function dist accepts 2 integers m n. The program computes the length of the list which contains all the numbers a^b  where 2&lt;=a&lt;=m and 2&lt;=b&lt;=n ; the number a^b is added only once in the list</p>\n\n<p>Example </p>\n\n<pre><code>dist 5 5\n\n-- 2^2,2^3,2^4,2^5,3^2,3^3 .....5^4,5^5 --\n</code></pre>\n\n<p>There are only 15 different values 4, 8, 9, 16, 25, 27, 32, 64, 81, 125, 243, 256, 625, 1024, 3125 so the answer will be 15.</p>\n\n<p>Are there any improvements to my code that can be made in order to make it faster?Or maybe another approach that someone could suggest?</p>\n\n<pre><code>import Data.List\n\ndist :: Int -&gt; Int -&gt; Int\ndist m n =  length (nub (concat [x | a&lt;-[2..m], let x = listpower a n] ))\n\n\nlistpower::Int-&gt;Int-&gt;[Int]\nlistpower a n = take (n-1) (powers a)\n\n\npowers::Int-&gt;[Int]\npowers a = [a^b| b&lt;-[2..]]\n</code></pre>\n"}, {"tags": ["haskell", "io", "ipc"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1509554623, "post_id": 47053799, "comment_id": 81066809, "body": "For clearing a pipe you don&#39;t intend to use again, you can use <code>forkIO (forever (hGetChar pipeHandle))</code>."}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509613669, "post_id": 47053799, "comment_id": 81090691, "body": "That&#39;s more or less what I ended up doing..."}], "answers": [{"comments": [{"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1509542027, "post_id": 47054550, "comment_id": 81058327, "body": "I should have read better :/ Anyways, I think I cannot use a file handle anyway, since I need to have &quot;blocking reads&quot; which wait for output of the spawned process, and this requires a pipe (instead of a file)..."}], "tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": true, "score": 2, "last_activity_date": 1509538348, "creation_date": 1509538348, "answer_id": 47054550, "question_id": 47053799, "link": "https://stackoverflow.com/questions/47053799/reading-from-a-handle-obtained-outside-createprocess/47054550#47054550", "title": "Reading from a handle obtained outside createProcess", "body": "<p>This behavior of <code>createProcess</code> is <a href=\"https://hackage.haskell.org/package/process-1.6.2.0/docs/System-Process.html#v:createProcess\" rel=\"nofollow noreferrer\">documented</a>:</p>\n\n<blockquote>\n  <p>Note that Handles provided for std_in, std_out, or std_err via the\n  UseHandle constructor will be closed by calling this function.</p>\n</blockquote>\n\n<p>Documentation suggests to use <code>createProcess_</code> function instead.</p>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 47054550, "answer_count": 1, "score": 3, "last_activity_date": 1509538348, "creation_date": 1509535734, "question_id": 47053799, "link": "https://stackoverflow.com/questions/47053799/reading-from-a-handle-obtained-outside-createprocess", "title": "Reading from a handle obtained outside createProcess", "body": "<p>I'm trying to create a process, and communicate with it via a handle that I provide outside the <code>createProcess</code> function:</p>\n\n<pre><code>stdOutH &lt;- openFile (logDir &lt;/&gt; \"stdout.log\") ReadWriteMode\nhSetBuffering stdOutH LineBuffering\n(_, _, _, ph) &lt;- createProcess $\n    (proc \"someproc\" []) { std_out = UseHandle stdOutH\n                         , std_err = UseHandle stdErrH\n                         }\nline &lt;- hGetLine stdOutH\nputStrLn $ \"Got \" ++ line\n</code></pre>\n\n<p>The <code>\"someproc\"</code> process spits a line out to the standard output, and I want to read it from the process that spawned it. However if I try to do this I get the following error:</p>\n\n<p>hGetLine: illegal operation (handle is closed)</p>\n\n<p>What I don't understand is why the handle is closed while the created process is running. This works if I use <code>CreatePipe</code> instead of <code>UseHandle</code>, the problem is that I only want to read the first line. But doing this requires to keep on reading from the pipe, otherwise it gets full after a certain amount of output by <code>\"someproc\"</code>.</p>\n\n<p>So, is there a way to use <code>system.process</code> to communicate two processes via <code>stdOutH</code> in the way described above?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 990, "user_id": 2936186, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EOPOx.jpg?s=128&g=1", "display_name": "H&#233;cate", "link": "https://stackoverflow.com/users/2936186/h%c3%a9cate"}, "edited": false, "score": 0, "creation_date": 1509523965, "post_id": 47050545, "comment_id": 81048188, "body": "Yeah we also have such a thing in the Elixir community (can&#39;t say we invented it, though :p). It&#39;s so convenient! There&#39;s also the whole <code>function!</code> versus <code>function</code>, where the former raises an exception when failing wheras the other returns a <code>{:ok, result}</code> or <code>{:error, error}</code> (which is easily done with Either."}, {"owner": {"reputation": 26881, "user_id": 432903, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/YCgsh.jpg?s=128&g=1", "display_name": "prayagupd", "link": "https://stackoverflow.com/users/432903/prayagupd"}, "reply_to_user": {"reputation": 990, "user_id": 2936186, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EOPOx.jpg?s=128&g=1", "display_name": "H&#233;cate", "link": "https://stackoverflow.com/users/2936186/h%c3%a9cate"}, "edited": false, "score": 0, "creation_date": 1509524219, "post_id": 47050545, "comment_id": 81048289, "body": "@Uniaika interesting. I don&#39;t think scala has it though."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1509525578, "post_id": 47050545, "comment_id": 81048876, "body": "This is standard closure naming policy afaik: <a href=\"http://toblux.com/2014/05/28/idiomatic-function-names-in-clojure/\" rel=\"nofollow noreferrer\">toblux.com/2014/05/28/idiomatic-function-names-in-clojure</a> An exclamation is used for non-pure functions, etc."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1509534624, "post_id": 47050545, "comment_id": 81053807, "body": "Ruby uses it as well (+ <code>!</code> for other cases)."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1509551582, "post_id": 47050545, "comment_id": 81064837, "body": "Feel free to make a proposal to haskell-prime."}], "answers": [{"comments": [{"owner": {"reputation": 302, "user_id": 4742633, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/b64bd428ea67772ed5eb5a1aa4d6108d?s=128&d=identicon&r=PG", "display_name": "Xlaech", "link": "https://stackoverflow.com/users/4742633/xlaech"}, "edited": false, "score": 0, "creation_date": 1509526210, "post_id": 47050718, "comment_id": 81049166, "body": "Thats what i thought. So basically the question would be, if there exists an extension to do this - or it could be written in theory (to much for such a small case)."}], "tags": [], "owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "is_accepted": false, "score": 3, "last_activity_date": 1509525170, "last_edit_date": 1509525170, "creation_date": 1509524205, "answer_id": 47050718, "question_id": 47050545, "link": "https://stackoverflow.com/questions/47050545/questionmark-in-function-name/47050718#47050718", "title": "Questionmark in function name", "body": "<p>From the Haskell 2010 Language Report (<a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch2.html#x7-180002.4\" rel=\"nofollow noreferrer\">https://www.haskell.org/onlinereport/haskell2010/haskellch2.html#x7-180002.4</a>):</p>\n\n<blockquote>\n  <p>varid \u2192   (small {small | large | digit | ' })\u27e8reservedid\u27e9</p>\n</blockquote>\n\n<p>and </p>\n\n<blockquote>\n  <p>Underscore, \u201c_\u201d, is treated as a lowercase letter, and can occur wherever a lowercase letter can. However, \u201c_\u201d all by itself is a reserved identifier, used as wild card in patterns.</p>\n</blockquote>\n\n<p>In other words, identifiers must start with a lowercase letter or <code>_</code>, and can only contain lowercase letters, <code>_</code>'s, uppercase letters, digits and <code>'</code>s.</p>\n\n<p>I'm not aware of any language extension that would allow this. Also it would force users of such a module to enable the extension as well so I'm not convinced it is a good idea. The convention in Haskell code is to call a function like this <code>isEven</code> which is what the users of your code will expect anyway. (<a href=\"https://en.wikipedia.org/wiki/Principle_of_least_astonishment\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Principle_of_least_astonishment</a>) </p>\n"}, {"comments": [{"owner": {"reputation": 302, "user_id": 4742633, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/b64bd428ea67772ed5eb5a1aa4d6108d?s=128&d=identicon&r=PG", "display_name": "Xlaech", "link": "https://stackoverflow.com/users/4742633/xlaech"}, "edited": false, "score": 0, "creation_date": 1509529519, "post_id": 47051400, "comment_id": 81050908, "body": "Interesting. This is not a feature i want, but it means, that is is possible to add characters to the list of available ones for function names."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1509534563, "post_id": 47051400, "comment_id": 81053773, "body": "The documentation says &quot;An implicit parameter occurs in an expression using the special form ?x, where x is any valid identifier (e.g. ord ?x is a valid expression)&quot;. So it seems <code>?</code> is not considered to be part of the name, strictly speaking."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 302, "user_id": 4742633, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/b64bd428ea67772ed5eb5a1aa4d6108d?s=128&d=identicon&r=PG", "display_name": "Xlaech", "link": "https://stackoverflow.com/users/4742633/xlaech"}, "edited": false, "score": 0, "creation_date": 1509543371, "post_id": 47051400, "comment_id": 81059235, "body": "@Xlaech Well, some extensions do extend the syntax, but this is not something that can be freely controlled by the programmer."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1509543537, "post_id": 47051400, "comment_id": 81059359, "body": "@AlexeyRomanov Ah, interesting. I never realized that, since from the point of view of the syntax there&#39;s not much difference."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1509527163, "creation_date": 1509527163, "answer_id": 47051400, "question_id": 47050545, "link": "https://stackoverflow.com/questions/47050545/questionmark-in-function-name/47051400#47051400", "title": "Questionmark in function name", "body": "<p>In Haskell we can't use <code>?</code> inside variable names, except when using a particular extension, <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html?highlight=implicit#ghc-flag--XImplicitParams\" rel=\"nofollow noreferrer\">Implicit Parameters</a> which however changes the scoping rules of the variable.</p>\n\n<p>With that extension, variable names can have a <em>leading</em> question mark, as in <code>?foo</code>. However, this marks <code>foo</code> as an implicit argument. For example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f :: (?x :: Int) =&gt; Int -&gt; Int\nf y = ?x + y   -- x is in scope here\n\nmain :: IO ()\nmain = do\n   let ?x :: Int\n       ?x = 23\n   print (f 10)   -- ?x is also passed, implicitly\n</code></pre>\n\n<p>Essentially, this makes <code>?x</code> to have dynamic instead of static/lexical scoping.</p>\n\n<p>It is a mostly unused extension, in practice. (I still find it nice to have it, though.)</p>\n\n<p>This is surely <em>not</em> what you want, but perhaps worth mentioning. If you ever see names with a leading <code>?</code> in Haskell, know that they are quite special.</p>\n"}, {"comments": [{"owner": {"reputation": 302, "user_id": 4742633, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/b64bd428ea67772ed5eb5a1aa4d6108d?s=128&d=identicon&r=PG", "display_name": "Xlaech", "link": "https://stackoverflow.com/users/4742633/xlaech"}, "edited": false, "score": 0, "creation_date": 1509651023, "post_id": 47057938, "comment_id": 81115662, "body": "Almost should count as a solution. But i think people will kill me if i do this in my code."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1509548939, "creation_date": 1509548939, "answer_id": 47057938, "question_id": 47050545, "link": "https://stackoverflow.com/questions/47050545/questionmark-in-function-name/47057938#47057938", "title": "Questionmark in function name", "body": "<p>Don't do this.</p>\n\n<p>Gross hack: <code>?</code> is not a valid identifier character, but <code>\u0294</code> is.</p>\n\n<p>Don't use the following.</p>\n\n<pre><code>even\u0294 :: Num a =&gt; a -&gt; Bool\neven\u0294 0 = True\neven\u0294 1 = False\neven\u0294 n = even\u0294 (n - 2)\n</code></pre>\n\n<p>(<code>\u0294</code>, of course, is U+0294 LATIN LETTER GLOTTAL STOP, which, appearances aside, is completely unrelated to U+003F QUESTION MARK.)</p>\n\n<p>Did I mention you shouldn't do this?</p>\n"}], "owner": {"reputation": 302, "user_id": 4742633, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/b64bd428ea67772ed5eb5a1aa4d6108d?s=128&d=identicon&r=PG", "display_name": "Xlaech", "link": "https://stackoverflow.com/users/4742633/xlaech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 0, "accepted_answer_id": 47057938, "answer_count": 3, "score": 1, "last_activity_date": 1509548939, "creation_date": 1509523362, "last_edit_date": 1509527624, "question_id": 47050545, "link": "https://stackoverflow.com/questions/47050545/questionmark-in-function-name", "title": "Questionmark in function name", "body": "<p>I was just taking a look into clojure and found the following line of code on an example page</p>\n\n<pre><code>(filter even? [1 2 3])\n</code></pre>\n\n<p>While this is fairly standard code i am amazed by the fact, that they use a '?' to make the predicate easier to read.</p>\n\n<p>Is it also possible to get haskell to accept this as a function name?\nSo far i found <a href=\"https://wiki.haskell.org/Unicode-symbols\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Unicode-symbols</a> which unfortunately does not contain '?'.</p>\n"}, {"tags": ["haskell", "bytestring"], "comments": [{"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1509521174, "post_id": 47050008, "comment_id": 81047060, "body": "Not an exact duplicate, but did you see <a href=\"https://stackoverflow.com/questions/2283119/how-to-convert-a-integer-to-a-bytestring-in-haskell\" title=\"how to convert a integer to a bytestring in haskell\">stackoverflow.com/questions/2283119/&hellip;</a>?"}, {"owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "reply_to_user": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1509521407, "post_id": 47050008, "comment_id": 81047148, "body": "@Thomas, I saw that, it&#39;s converting in the other direction and I had some trouble using <code>Data.Binary</code>. I can easily convert <code>Integer</code> types to bytestrings, but often converting from random bytestrings to <code>Integer</code> type causes an error. I don&#39;t know the internal representation of <code>Integer</code> but I assume generating random bytes can make invalid numbers."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1509526420, "post_id": 47050008, "comment_id": 81049260, "body": "@user668074 The <a href=\"https://hackage.haskell.org/package/binary-0.8.5.1/docs/src/Data.Binary.Class.html#line-311\" rel=\"nofollow noreferrer\"><code>Binary</code> instance for <code>Integer</code></a> writes a tag for whether it&#39;s a small integer that fits in a few bytes or a big one that is in many bytes, and for large integers writes a sign byte and a list of bytes preceded with a length; if the length doesn&#39;t match the number of bytes you&#39;d get an error."}, {"owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1509526981, "post_id": 47050008, "comment_id": 81049508, "body": "@Cirdec, thank you, I wasn&#39;t sure how Integers were represented. Do you know how the Natural integer type is represented?"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1509550470, "post_id": 47050008, "comment_id": 81064075, "body": "The <a href=\"https://hackage.haskell.org/package/binary-0.8.5.1/docs/src/Data.Binary.Class.html#line-368\" rel=\"nofollow noreferrer\"><code>Binary</code> instance for <code>Natural</code></a> is in the same file. Neither of these is how they&#39;re represented in memory. Both end up reading a list of bytes and folding it one byte at a time. Instead of mucking around in formatting your byte string into one of these formats, fold it yourself as shown in <a href=\"https://stackoverflow.com/a/47050983/414413\">my answer</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "edited": false, "score": 0, "creation_date": 1509605406, "post_id": 47050983, "comment_id": 81086208, "body": "This seems like the best way to do this in general. I also found the <code>monadcryptorandom</code> package. It allows one to bypass the bytestring part of the <code>Crypto.Random</code> module entirely and get integers."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 5, "last_activity_date": 1509550768, "last_edit_date": 1509550768, "creation_date": 1509525549, "answer_id": 47050983, "question_id": 47050008, "link": "https://stackoverflow.com/questions/47050008/how-can-i-convert-from-a-bytestring-to-a-positive-integer/47050983#47050983", "title": "How can I convert from a ByteString to a positive Integer", "body": "<p>Without poking around in the internals of <a href=\"https://hackage.haskell.org/package/integer-gmp-1.0.0.1/docs/GHC-Integer.html\" rel=\"nofollow noreferrer\"><code>GHC.Integer</code></a> you can fold the bytestring into an <code>Integer</code> one byte at a time.</p>\n\n<pre><code>import qualified Data.ByteString as BS\nimport Data.Bits\n\nfromBytes :: ByteString -&gt; Integer\nfromBytes = BS.foldl' f 0\n  where\n    f a b = a `shiftL` 8 .|. fromIntegral b\n</code></pre>\n\n<p>If you want to read <code>Natural</code> numbers instead of <code>Integer</code>s you can give this a more general type signature.</p>\n\n<pre><code>-- Read bytes in big-endian order (most significant byte first)\n-- Little-endian order is fromBytes . BS.reverse\nfromBytes :: (Bits a, Num a) =&gt; ByteString -&gt; a\nfromBytes = BS.foldl' f 0\n  where\n    f a b = a `shiftL` 8 .|. fromIntegral b\n</code></pre>\n"}], "owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 629, "favorite_count": 1, "accepted_answer_id": 47050983, "answer_count": 1, "score": 6, "last_activity_date": 1509550768, "creation_date": 1509520858, "last_edit_date": 1509535010, "question_id": 47050008, "link": "https://stackoverflow.com/questions/47050008/how-can-i-convert-from-a-bytestring-to-a-positive-integer", "title": "How can I convert from a ByteString to a positive Integer", "body": "<p>I am trying to generate large random prime numbers (1024 bit-ish) so I need a way to generate large positive random numbers.</p>\n\n<p>I began with <code>System.Random</code> but want to move to <code>Crypto.Random</code> from the <code>crypto-api</code> package.</p>\n\n<p>The <code>Crypto.Random</code> only produces bytestrings, so I need a way to convert to an <code>Integer</code> type. What is the best way to do this?</p>\n"}, {"tags": ["haskell", "typeclass", "type-families"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1509527500, "post_id": 47049178, "comment_id": 81049774, "body": "I can&#39;t see how this would work. I guess <code>M</code> is also visible from outside the class. When <code>M</code> is used, how could the compiler infer which instance it refers to, i.e. which <code>a</code> to use? If <code>M</code> was only visible inside the class (and possibly its instances?), perhaps it could work -- it would be better to use a different syntax for that, though, since we need to distinguish externally-visible type families from internal type synonyms."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509544249, "post_id": 47049178, "comment_id": 81059902, "body": "Type, type synonym, and type family declarations in Haskell are always global. I doubt it would be easy to change that; that would seem tantamount to first-class modules."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1509558059, "post_id": 47049178, "comment_id": 81068885, "body": "I don&#39;t know if this would help, since you&#39;d have to add it to every function you want to use it in, but if it is a very long type (especially if it&#39;s also used over and over in the type signature) it <i>could</i> help to do something like <code>anotherSillyFunction :: (item ~ ItemT a, m ~ MT a) =&gt; [item] -&gt; m a</code>."}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1509516656, "creation_date": 1509516656, "question_id": 47049178, "link": "https://stackoverflow.com/questions/47049178/type-synonyms-in-classes", "title": "Type synonyms in classes", "body": "<p>Lets say I've got a class like so:</p>\n\n<pre><code>class C a where\n  type T a\n</code></pre>\n\n<p>I want to add a synonym inside the class like so:</p>\n\n<pre><code>class C a where\n  type MT a\n  type M = MT a\n</code></pre>\n\n<p>So I can just refer to <code>M</code> instead of <code>MT a</code></p>\n\n<p>I know this sounds like not a big deal, but say if I have something like this:</p>\n\n<pre><code>class Monad (MT a) =&gt; C a where\n  type MT a\n  type ItemT a\n  new :: (MT a) a\n  anotherSillyFunction :: [ItemT a] -&gt; (MT a) a\n  -- etc\n</code></pre>\n\n<p>But this approach makes the function definitions cleaner:</p>\n\n<pre><code>class Monad (MT a) =&gt; C a where\n  type MT a\n  type ItemT a\n  type M = MT a\n  type Item = ItemT a\n  new :: M a\n  anotherSillyFunction :: [Item] -&gt; M a\n  -- etc\n</code></pre>\n\n<p>Except the above doesn't compile. Anyway to achieve the above?</p>\n"}, {"tags": ["loops", "haskell", "monads"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1509513972, "post_id": 47048646, "comment_id": 81044437, "body": "The use of <code>do</code> isn&#39;t discouraged. There&#39;s some discussion about whether or not to use <code>do</code> notation when introducing monads to beginners because it might give them even crazier ideas about what monads are, but in normal haskell use of do is fine. Also, if you know how to do it with <code>do</code>, you know  how to do it without. Your problem here has nothing to do with <code>do</code> notation."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1509514238, "post_id": 47048646, "comment_id": 81044521, "body": "Also, your last code segment you have there doesn&#39;t work because you wrote <code>getLine</code> instead of <code>getContents</code>"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1509515364, "post_id": 47048646, "comment_id": 81044879, "body": "<a href=\"https://hackage.haskell.org/package/monad-loops-0.4.3/docs/Control-Monad-Loops.html\" rel=\"nofollow noreferrer\">Here&#39;s</a> a library which defines a large number of looping combinators."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1509517928, "post_id": 47048646, "comment_id": 81045741, "body": "2 <i>Cubic</i>: discouraged for me only :) . To stay away from crazy ideas precisely."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1509519096, "post_id": 47048646, "comment_id": 81046202, "body": "2 <i>Cubic</i>: <code>getContents</code> helps. Unfortunately, I&#39;m still at a loss about how to insert prompt/response into the picture."}], "answers": [{"comments": [{"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1509520334, "post_id": 47049250, "comment_id": 81046704, "body": "Thanks! This is the exact answer. Is there a way to employ <code>if</code> instead of <code>when</code>, BTW?"}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1509522803, "post_id": 47049250, "comment_id": 81047708, "body": "About <code>if</code>: not here, I see. <code>when</code> exists precisely for this kind of job."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 1, "creation_date": 1509572085, "post_id": 47049250, "comment_id": 81076242, "body": "@AlexeyOrlov No, <code>if</code> works perfectly fine. <code>IO</code> actions are just values you can shuffle around: <code>main = _ &gt;&gt;= \\name -&gt; if name &#47;= &quot;q&quot; then main else return ()</code>. That&#39;s how <code>when</code> is implemented: <code>when cond act = if cond then act else pure ()</code> (<code>pure</code> = <code>return</code> for <code>IO</code> (and <code>Monad</code>s in general))."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1509611486, "post_id": 47049250, "comment_id": 81089398, "body": "Thanks! It makes one think... Why the trouble of defining <code>when</code> if is does not make your life any easier :) ?"}], "tags": [], "owner": {"reputation": 1055, "user_id": 593298, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51e634a7316f1a4101f65519d2110cce?s=128&d=identicon&r=PG", "display_name": "keep_learning", "link": "https://stackoverflow.com/users/593298/keep-learning"}, "is_accepted": true, "score": 1, "last_activity_date": 1509517093, "creation_date": 1509517093, "answer_id": 47049250, "question_id": 47048646, "link": "https://stackoverflow.com/questions/47048646/haskell-looping-over-user-input-gracefully/47049250#47049250", "title": "Haskell: looping over user input gracefully", "body": "<p>You can call main again and check if your string is \"q\" or not. </p>\n\n<pre><code>import Control.Monad\n\nmain :: IO ()\nmain =\n    putStrLn \"hello, what's your name?\" &gt;&gt;\n    getLine &gt;&gt;= \\name -&gt;\n                  when (name /= \"q\") $ (putStrLn $ \"Hey, \" ++ name ++ \", you rock!\") &gt;&gt; main\n\n\u03bb&gt; main\nhello, what's your name?\nMukesh Tiwari\nHey, Mukesh Tiwari, you rock!\nhello, what's your name?\nAlexey Orlov\nHey, Alexey Orlov, you rock!\nhello, what's your name?\nq\n\u03bb&gt; \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1509540017, "creation_date": 1509540017, "answer_id": 47055086, "question_id": 47048646, "link": "https://stackoverflow.com/questions/47048646/haskell-looping-over-user-input-gracefully/47055086#47055086", "title": "Haskell: looping over user input gracefully", "body": "<p>May be you can also use laziness on IO type by adapting the <a href=\"https://hackage.haskell.org/package/lazyio-0.1.0.4/docs/System-IO-Lazy.html\" rel=\"nofollow noreferrer\"><code>System.IO.Lazy</code></a> package. It basically includes only <code>run :: T a -&gt; IO a</code> and <code>interleave :: IO a -&gt; T a</code> functions to convert IO actions into lazy ones back and forth.</p>\n\n<pre><code>import qualified System.IO.Lazy as LIO\n\ngetLineUntil :: String -&gt; IO [String]\ngetLineUntil s = LIO.run ((sequence . repeat $ LIO.interleave getLine) &gt;&gt;= return . takeWhile (/=s))\n\nprintData :: IO [String] -&gt; IO ()\nprintData d = d &gt;&gt;= print . sum . map (read :: String -&gt; Int)\n\n*Main&gt; printData $ getLineUntil \"q\"\n1\n2\n3\n4\n5\n6\n7\n8\n9\nq\n45\n</code></pre>\n\n<p>In the above code we construct an infinite list of lazy <code>getLine</code>s by <code>repeat $ LIO.interleave getLine</code> of type <code>[T String]</code> and by <code>sequence</code> we turn it into <code>T [String]</code> type and proceed reading up until \"q\" is received. The <code>printData</code> utility function is summing up and printing the entered integers.</p>\n"}], "owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 0, "accepted_answer_id": 47049250, "answer_count": 2, "score": 0, "last_activity_date": 1509540017, "creation_date": 1509513440, "question_id": 47048646, "link": "https://stackoverflow.com/questions/47048646/haskell-looping-over-user-input-gracefully", "title": "Haskell: looping over user input gracefully", "body": "<p>This is an example from <code>Learn You a Haskell</code>:</p>\n\n<pre><code>main = do\n    putStrLn \"hello, what's your name?\"\n    name &lt;- getLine\n    putStrLn (\"Hey, \" ++ name ++ \", you rock!\")\n</code></pre>\n\n<p>The same redone without <code>do</code> for clarity:</p>\n\n<pre><code>main =\n    putStrLn \"hello, what's your name?\" &gt;&gt;\n    getLine &gt;&gt;= \\name -&gt;\n    putStrLn $ \"Hey, \" ++ name ++ \", you rock!\"\n</code></pre>\n\n<p>How am I supposed to loop it cleanly (until \"q\"), the Haskell way (use of <code>do</code> discouraged)?</p>\n\n<p>I borrowed this from <a href=\"https://stackoverflow.com/questions/18573924/haskell-loop-over-user-input\">Haskell - loop over user input</a></p>\n\n<pre><code>main = mapM_ process . takeWhile (/= \"q\") . lines =&lt;&lt; getLine\n    where process line = do\n                            putStrLn line\n</code></pre>\n\n<p>for starters, but it won't loop.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1509508558, "post_id": 47047937, "comment_id": 81043118, "body": "Have you tried using <code>hGetContents</code>? Otherwise I would use <code>fmap (&lt;&gt;&quot;\\n&quot;) hGetLine</code> to insert the newline character"}, {"owner": {"reputation": 517, "user_id": 7312355, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/57ce505140904fd60f4e0d002b9a842e?s=128&d=identicon&r=PG&f=1", "display_name": "599644", "link": "https://stackoverflow.com/users/7312355/599644"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1509508649, "post_id": 47047937, "comment_id": 81043137, "body": "Won\u2019t <code>hGetLine</code> also return in the case of <code>EOF</code>, in which case I will add a \\n when I shouldn\u2019t? Will look into <code>hGetContents</code>. Thanks."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1509526346, "post_id": 47047937, "comment_id": 81049233, "body": "<code>hGetContents</code> slurps all the input, in some cases you don&#39;t want that. Anyway, <code>hGetLine</code> will not return on EOF: it will throw an exception. From a  quick test, I found no way to detect the very last newline in a text file using only <code>hGetLine</code>."}, {"owner": {"reputation": 517, "user_id": 7312355, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/57ce505140904fd60f4e0d002b9a842e?s=128&d=identicon&r=PG&f=1", "display_name": "599644", "link": "https://stackoverflow.com/users/7312355/599644"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1509555001, "post_id": 47047937, "comment_id": 81067041, "body": "@chi AFAIK it will throw an exception only if EOF is the first character of the line. Otherwise it just returns normally."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1509555375, "post_id": 47047937, "comment_id": 81067243, "body": "@599644 Correct. That&#39;s why it seems there&#39;s no way to detect whether the last line has a newline."}], "answers": [{"tags": [], "owner": {"reputation": 1998, "user_id": 772992, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/f4Gy4.jpg?s=128&g=1", "display_name": "hradecek", "link": "https://stackoverflow.com/users/772992/hradecek"}, "is_accepted": true, "score": 0, "last_activity_date": 1509528923, "last_edit_date": 1509528923, "creation_date": 1509528042, "answer_id": 47051621, "question_id": 47047937, "link": "https://stackoverflow.com/questions/47047937/how-to-stop-hgetline-from-stripping-the-trailing-newline/47051621#47051621", "title": "How to stop hGetLine from stripping the trailing newline", "body": "<blockquote>\n  <p>Is there a way to stop hGetLine from stripping the trailing newline?</p>\n</blockquote>\n\n<p>No, there is not. It's simply part of <code>hGetLine</code> the source code [1].</p>\n\n<p><strong>Solution:</strong></p>\n\n<p>Depending on your use case you might choose alternative approach like appending the <code>\"\\n\"</code> back manually (imho not nice) or using <code>readFile</code> [2], <code>hGetContents</code> [3] or one of from similar functions or even using completely different solution.</p>\n\n<p>Note, that both mentioned functions are lazy.</p>\n\n<p>--</p>\n\n<p>[1] <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/src/GHC.IO.Handle.Text.html#hGetLine\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/base-4.10.0.0/docs/src/GHC.IO.Handle.Text.html#hGetLine</a></p>\n\n<p>[2] <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:readFile\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:readFile</a></p>\n\n<p>[3] <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/System-IO.html#v:hGetContents\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/base-4.10.0.0/docs/System-IO.html#v:hGetContents</a></p>\n"}], "owner": {"reputation": 517, "user_id": 7312355, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/57ce505140904fd60f4e0d002b9a842e?s=128&d=identicon&r=PG&f=1", "display_name": "599644", "link": "https://stackoverflow.com/users/7312355/599644"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 47051621, "answer_count": 1, "score": 0, "last_activity_date": 1509528923, "creation_date": 1509508140, "question_id": 47047937, "link": "https://stackoverflow.com/questions/47047937/how-to-stop-hgetline-from-stripping-the-trailing-newline", "title": "How to stop hGetLine from stripping the trailing newline", "body": "<p>When I use <code>hGetLine</code> the returned string is missing the trailing \u2018\\n\u2019. </p>\n\n<p>Is there a way to stop <code>hGetLine</code> from stripping the trailing newline?</p>\n"}, {"tags": ["haskell", "binary", "bytestring", "conduit", "cereal"], "comments": [{"owner": {"reputation": 2781, "user_id": 1540547, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4f07f7dc869bd71c0ba13719468daeab?s=128&d=identicon&r=PG", "display_name": "jorgen", "link": "https://stackoverflow.com/users/1540547/jorgen"}, "edited": false, "score": 0, "creation_date": 1509519985, "post_id": 47047880, "comment_id": 81046563, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11380470/serializing-a-string-with-data-cereal-or-data-binary\">Serializing a String with Data.Cereal or Data.Binary</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4565, "user_id": 1134885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c428466054762cf7d4b5fb5f4396fa2?s=128&d=identicon&r=PG", "display_name": "NovaDenizen", "link": "https://stackoverflow.com/users/1134885/novadenizen"}, "is_accepted": true, "score": 1, "last_activity_date": 1509722013, "creation_date": 1509722013, "answer_id": 47098983, "question_id": 47047880, "link": "https://stackoverflow.com/questions/47047880/binary-file-writer-adds-extra-byte/47098983#47098983", "title": "Binary file writer adds extra byte", "body": "<pre><code>putListOf :: Putter a -&gt; Putter [a]\nputListOf pa = \\l -&gt; do\n  putWord64be (fromIntegral (length l))\n  mapM_ pa l\n</code></pre>\n\n<p><code>putListOf</code> encodes the length of the list before encoding the individual list elements.  I think maybe you are dealing with fixed 2x2 matrices so you don't need that length, and you just want:</p>\n\n<pre><code>fromDoubleMatrix :: Matrix Double -&gt; ByteString\nfromDoubleMatrix matrix = runPut $\n   mapM_ putFloat64be (concat toLists matrix)\n</code></pre>\n"}], "owner": {"reputation": 2781, "user_id": 1540547, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4f07f7dc869bd71c0ba13719468daeab?s=128&d=identicon&r=PG", "display_name": "jorgen", "link": "https://stackoverflow.com/users/1540547/jorgen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 47098983, "answer_count": 1, "score": 1, "last_activity_date": 1509722013, "creation_date": 1509507653, "last_edit_date": 1509518338, "question_id": 47047880, "link": "https://stackoverflow.com/questions/47047880/binary-file-writer-adds-extra-byte", "title": "Binary file writer adds extra byte", "body": "<p>I'm building a <code>Conduit</code> that writes a binary file consisting of a header followed by a <code>Double</code> matrix as a row-ordered list. Here's the code:</p>\n\n<pre><code>import Conduit ((.|), ConduitM, mapC, sinkFileBS, yield) \nimport Control.Monad.Trans.Except (ExceptT) \nimport Control.Monad.Trans.Resource (ResourceT) \nimport Data.ByteString (ByteString) \nimport Data.ByteString.Conversion (toByteString') \nimport Data.Serialize.IEEE754 (putFloat64be) \nimport Data.Serialize.Put (putListOf, runPut) \nimport Data.Void (Void) \nimport Numeric.LinearAlgebra.Data ((&gt;&lt;), Matrix, toLists) \nimport System.FilePath (FilePath) \n\ntype FileWriter = ResourceT (ExceptT String IO) \n\nmatrixSink :: FilePath -&gt; ConduitM (Matrix Double) Void FileWriter ()\nmatrixSink path = byteBuilder .| sinkFileBS path where\n  byteBuilder = do\n    yield $ toByteString' \"header\" \n    mapC fromDoubleMatrix\n\nfromDoubleMatrix :: Matrix Double -&gt; ByteString\nfromDoubleMatrix matrix = runPut $\n   putListOf putFloat64be (concat toLists matrix)\n</code></pre>\n\n<p>This almost works. If I test it using</p>\n\n<pre><code>runExceptT . runConduitRes $ yield matrix .| matrixSink \"test.dat\"\n  where matrix = (2 &gt;&lt; 2) [1, 2, 3, 4]\n</code></pre>\n\n<p>I get the expected file but with an extra byte between the header and the list of doubles. When displayed using <code>show</code> the extra byte looks like this:</p>\n\n<pre><code>\"\\NUL\\NUL\\NUL\\NUL\\NUL\\NUL\\NUL\\t\"\n</code></pre>\n\n<p>Any idea how not to print this byte? Or if it's a canonical separator or something (so that I can ignore it in the reader)?</p>\n\n<p>EDIT: The problem seems to occur in the <code>putListOf</code> construction in <code>fromDoubleMatrix</code>. </p>\n"}, {"tags": ["algorithm", "haskell", "functional-programming", "fold"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1509494305, "post_id": 47045838, "comment_id": 81039746, "body": "Interesting question, but I think this is a case where a manual recursive definition is the most sensible solution."}], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 4, "last_activity_date": 1509500777, "creation_date": 1509500777, "answer_id": 47047031, "question_id": 47045838, "link": "https://stackoverflow.com/questions/47045838/haskell-groupby-depending-on-accumulator-value/47047031#47047031", "title": "Haskell groupBy depending on accumulator value", "body": "<p>I would start with a recursive definition like this:</p>\n\n<pre><code>groupViews :: Double -&gt; (a -&gt; Double) -&gt; [a] -&gt; [[a]]\ngroupViews maxWidth width = go (0, [[]])\n  where\n    go (current, acc : accs) (view : views)\n      | current + width view &lt;= maxWidth\n      = go (current + width view, (view : acc) : accs) views\n      | otherwise = go (width view, [view] : acc : accs) views\n    go (_, accs) []\n      = reverse $ map reverse accs\n</code></pre>\n\n<p>Invoked like <code>groupViews 250 snd (sortOn snd viewList)</code>. The first thing I notice is that it can be represented as a left fold:</p>\n\n<pre><code>groupViews' maxWidth width\n  = reverse . map reverse . snd . foldl' go (0, [[]])\n  where\n    go (current, acc : accs) view\n      | current + width view &lt;= maxWidth\n      = (current + width view, (view : acc) : accs)\n      | otherwise\n      = (width view, [view] : acc : accs)\n</code></pre>\n\n<p>I think this is fine, though you could factor it further if you like, into one scan to accumulate the widths modulo the max width, and another pass to group the elements into ascending runs. For example, here\u2019s a version that works on integer widths:</p>\n\n<pre><code>groupViews'' maxWidth width views\n  = map fst\n  $ groupBy ((&lt;) `on` snd)\n  $ zip views\n  $ drop 1\n  $ scanl (\\ current view -&gt; (current + width view) `mod` maxWidth) 0 views\n</code></pre>\n\n<p>And of course you can include the sort in these definitions instead of passing the sorted list from outside.</p>\n"}, {"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1509500922, "post_id": 47047032, "comment_id": 81041307, "body": "<code>sortBy (compare `on` snd)</code> = <code>sortBy (comparing snd)</code> = <code>sortOn snd</code>"}, {"owner": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1509501188, "post_id": 47047032, "comment_id": 81041382, "body": "<code>sortOn</code> is a step too far, it&#39;s not defined in base afaik, but <code>sortBy $ comparing snd</code> is nicer, yes."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1509501515, "post_id": 47047032, "comment_id": 81041451, "body": "It\u2019s in <code>Data.List</code>: <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-List.html#v:sortOn\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.10.0.0/docs/&hellip;</a>"}, {"owner": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1509501572, "post_id": 47047032, "comment_id": 81041471, "body": "Oh, interesting, hoogle failed to find it."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1509501680, "post_id": 47047032, "comment_id": 81041498, "body": "I usually check both <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">haskell.org/hoogle</a> and <a href=\"https://www.stackage.org/\" rel=\"nofollow noreferrer\">stackage.org</a> because the latter has more packages indexed, so it\u2019s more likely to find a match, but unfortunately also more likely to find spurious matches."}], "tags": [], "owner": {"reputation": 2204, "user_id": 1063961, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/s9gRK.png?s=128&g=1", "display_name": "Centril", "link": "https://stackoverflow.com/users/1063961/centril"}, "is_accepted": false, "score": 2, "last_activity_date": 1509502658, "last_edit_date": 1509502658, "creation_date": 1509500783, "answer_id": 47047032, "question_id": 47045838, "link": "https://stackoverflow.com/questions/47045838/haskell-groupby-depending-on-accumulator-value/47047032#47047032", "title": "Haskell groupBy depending on accumulator value", "body": "<p>Given that <code>groupBy</code> and <code>span</code> themselves are defined by manual recursive functions, our modified functions will use the same mechanism. </p>\n\n<p>Let us first define a general function <code>groupAcc</code> which takes an initial value for the accumulator, and then a function which takes an element in the list, the current accumulator state and potentially produces a new accumulated value (Nothing means the element is not accepted):</p>\n\n<pre><code>{-# LANGUAGE LambdaCase #-}\n\nimport Data.List (sortOn)\nimport Control.Arrow (first, second)\n\nspanAcc :: z -&gt; (a -&gt; z -&gt; Maybe z) -&gt; [a] -&gt; ((z, [a]), [a])\nspanAcc z0 p = \\case\n  xs@[]      -&gt; ((z0, xs), xs)\n  xs@(x:xs') -&gt; case p x z0 of\n    Nothing  -&gt; ((z0, []), xs)\n    Just z1  -&gt; first (\\(z2, xt) -&gt; (if null xt then z1 else z2, x : xt)) $\n                spanAcc z1 p xs'\n\ngroupAcc :: z -&gt; (a -&gt; z -&gt; Maybe z) -&gt; [a] -&gt; [(z, [a])]\ngroupAcc z p = \\case\n  [] -&gt; [] ;\n  xs -&gt; uncurry (:) $ second (groupAcc z p) $ spanAcc z p xs\n</code></pre>\n\n<p>For our specific problem, we define:</p>\n\n<pre><code>threshold :: (Num a, Ord a) =&gt; a -&gt; a -&gt; a -&gt; Maybe a\nthreshold max a z0 = let z1 = a + z0 in if z1 &lt; max then Just z1 else Nothing\n\ngroupViews :: (Ord z, Num z) =&gt; [(lab, z)] -&gt; [[(lab, z)]]\ngroupViews = fmap snd . groupAcc 0 (threshold 250 . snd)\n</code></pre>\n\n<p>Which finally gives us:</p>\n\n<pre><code>groupFinal :: (Num a, Ord a) =&gt; [(lab, a)] -&gt; [[(lab, a)]]\ngroupFinal = groupViews . sortOn snd\n</code></pre>\n\n<p>And ghci gives us:</p>\n\n<pre><code>&gt; groupFinal [(\"a\", 45), (\"b\", 223.5), (\"c\", 14), (\"d\", 42)]\n[[(\"c\",14.0),(\"d\",42.0),(\"a\",45.0)],[(\"b\",223.5)]]\n</code></pre>\n\n<p>If we want to, we can simplify <code>groupAcc</code> by assuming that <code>z</code> is a <code>Monoid</code> wherefore <code>mempty</code> may be used, such that:</p>\n\n<pre><code>groupAcc2 :: Monoid z =&gt; (a -&gt; z -&gt; Maybe z) -&gt; [a] -&gt; [(z, [a])]\ngroupAcc2 p = \\case\n  [] -&gt; [] ;\n  xs -&gt; let z = mempty in\n        uncurry (:) $ second (groupAcc z p) $ spanAcc z p xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 3, "last_activity_date": 1509503591, "last_edit_date": 1509503591, "creation_date": 1509502615, "answer_id": 47047229, "question_id": 47045838, "link": "https://stackoverflow.com/questions/47045838/haskell-groupby-depending-on-accumulator-value/47047229#47047229", "title": "Haskell groupBy depending on accumulator value", "body": "<p>I don't know a clever way to do this just by combining functions from the standard library, but I do think you can do better than just implementing it from scratch.</p>\n\n<p>This problem fits into a class of problems that I've seen before: \"batch up items from this list somehow, and combine its items into batches according to some combination rule and some rule for deciding when a batch is too big\". Years ago, when I was writing Clojure, I <a href=\"https://github.com/amalloy/useful/blob/0b06d12eaabd06c0f6c0e3c15f2bc678ad15d198/src/flatland/useful/seq.clj#L194\" rel=\"nofollow noreferrer\">built a function</a> that abstracted out this idea of batched combinations, just asking you to specify the rules for batching, and was able to use it in a surprising number of places.</p>\n\n<p>Here's how I think it might be reimagined in Haskell:</p>\n\n<pre><code>glue :: Monoid a =&gt; (a -&gt; Bool) -&gt; [a] -&gt; [a]\nglue tooBig = go mempty\n  where go current [] = [current]\n        go current (x:xs) | tooBig x' = current : go x xs\n                          | otherwise = go x' xs\n          where x' = current `mappend` x\n</code></pre>\n\n<p>If you had such a <code>glue</code> function already, you could build a simple data type with the appropriate <code>Monoid</code> instance (a list of objects and their cumulative sum), and then let <code>glue</code> do the heavy lifting:</p>\n\n<pre><code>import Data.Monoid (Sum(..))\n\ndata ViewGroup contents size = ViewGroup {totalSize :: size,\n                                          elements :: [(contents, size)]}\n\ninstance Monoid b =&gt; Monoid (ViewGroup a b) where\n  mempty = ViewGroup mempty []\n  mappend (ViewGroup lSize lElts) (ViewGroup rSize rElts) = \n    ViewGroup (lSize `mappend` rSize) \n              (lElts ++ rElts)\n\nviewGroups = let views = [(\"a\", 14), (\"b\", 42), (\"c\", 45), (\"d\", 223.5)]\n             in glue ((&gt; 250) . totalSize) [ViewGroup (Sum width) [(x, Sum width)] \n                                           | (x, width) &lt;- views]\n\nmain = print (viewGroups :: [ViewGroup String (Sum Double)])\n\n[ViewGroup {totalSize = Sum {getSum = 101.0}, \n            elements = [(\"a\",Sum {getSum = 14.0}),\n                        (\"b\",Sum {getSum = 42.0}),\n                        (\"c\",Sum {getSum = 45.0})]},\nViewGroup {totalSize = Sum {getSum = 223.5}, \n           elements = [(\"d\",Sum {getSum = 223.5})]}]\n</code></pre>\n\n<p>On the one hand this looks like quite a bit of work for a simple function, but on the other it's rather nice to have a type that describes the cumulative summing you're doing, and Monoid instances are nice to have anyway...and after defining the type and the Monoid instance there's almost no work left to do in the calling of <code>glue</code> itself.</p>\n\n<p>Well, I don't know, maybe it's still too much work, especially if you don't believe you can reuse that type. But I do think it's useful to recognize that this is a specific case of a more general problem, and try to solve the more general problem as well.</p>\n"}], "owner": {"reputation": 8046, "user_id": 1774391, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/96ec1a791090d470daa3338f3dfdf996?s=128&d=identicon&r=PG", "display_name": "MainstreamDeveloper00", "link": "https://stackoverflow.com/users/1774391/mainstreamdeveloper00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 47047031, "answer_count": 3, "score": 6, "last_activity_date": 1509503591, "creation_date": 1509491551, "last_edit_date": 1509493264, "question_id": 47045838, "link": "https://stackoverflow.com/questions/47045838/haskell-groupby-depending-on-accumulator-value", "title": "Haskell groupBy depending on accumulator value", "body": "<p>I have a list of pairs of views which represents list of content labels and their widths which I want to group in lines (if the next content label doesn't fit in line then put it into another line). So we have: <code>viewList = [(View1, 45), (View2, 223.5), (View3, 14) (View4, 42)]</code>.</p>\n\n<p>I want to write a function <code>groupViews :: [a] -&gt; [[a]]</code> to group this list into a list of sublists where each sublist will contain only views with sum of widths less than the maximum specified width (let's say <code>250</code>).\nSo for a sorted <code>viewList</code> this function will return : <code>[[(View3, 14), (View4, 42), (View1, 45)],[(View2, 223.5)]]</code></p>\n\n<p>It looks similar to <code>groupBy</code>. However, <code>groupBy</code> doesn't maintain an accumulator. I tried to use <code>scanl</code> + <code>takeWhile(&lt;250)</code> combination but in this case I was able to receive only first valid sublist. Maybe use <code>iterate</code> + <code>scanl</code> + <code>takeWhile</code> somehow? But this looks very cumbersome and not functional at all. Any help will be much appreciated.</p>\n"}, {"tags": ["list", "haskell", "pattern-matching"], "answers": [{"tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 2, "last_activity_date": 1509493247, "last_edit_date": 1509493247, "creation_date": 1509492643, "answer_id": 47046009, "question_id": 47045736, "link": "https://stackoverflow.com/questions/47045736/pattern-matching-a-singleton-list-equivalent-erroneous-statements/47046009#47046009", "title": "Pattern matching a singleton list, equivalent/erroneous statements", "body": "<p><code>[x] != x</code>. A list of one element is different from the element itself. You can replace the <code>x:[]</code> with <code>[x]</code>, but you can't replace <code>[x]</code> with <code>x</code>! Also, your third equation seems wrong. You say it compiles fine, so it might be a typo, but, to be sure, here's the full definition of <code>evens</code>:</p>\n\n<pre><code>evens :: [a] -&gt; [a]\nevens []  = []\nevens [x] = [x] -- x :: a; you can't use an a where you need a [a]!\nevens (x:y:xs) = x : evens xs\n-- x :: a; xs :: [a]; evens xs :: [a]; (:) :: a -&gt; [a] -&gt; [a]\n-- x : evens xs :: [a]\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5723164, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eDrEOqomCKU/AAAAAAAAAAI/AAAAAAAAAC4/h7u8i1zXNAU/photo.jpg?sz=128", "display_name": "samlu1999", "link": "https://stackoverflow.com/users/5723164/samlu1999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509493247, "creation_date": 1509490818, "question_id": 47045736, "link": "https://stackoverflow.com/questions/47045736/pattern-matching-a-singleton-list-equivalent-erroneous-statements", "title": "Pattern matching a singleton list, equivalent/erroneous statements", "body": "<p>For context I am trying to create a simple function that outputs the elements of a list at even numbered locations.</p>\n\n<pre><code>&gt;evens [] = []\n&gt;evens [x] = x\n&gt;evens (x, y, xs) = x : evens xs\n</code></pre>\n\n<p>Why does this throw a type error on compilation?</p>\n\n<p>I change the second line to:</p>\n\n<pre><code>&gt;evens [x] = x:[]\n</code></pre>\n\n<p>and everything then works absolutely fine.</p>\n\n<p>learnyouahaskell.com states that in pattern matching, (x:[]) can be rewritten as [x] but why does this fail in my function definition?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1509490410, "post_id": 47045171, "comment_id": 81038694, "body": "This question is not sufficiently self-contained; to have any hope of debugging your code, one would need to scour the entire git repo. Consider creating a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> to demonstrate the problem."}], "answers": [{"comments": [{"owner": {"reputation": 2638, "user_id": 7208029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QxbAJ.png?s=128&g=1", "display_name": "Chai T. Rex", "link": "https://stackoverflow.com/users/7208029/chai-t-rex"}, "edited": false, "score": 3, "creation_date": 1509502927, "post_id": 47045615, "comment_id": 81041763, "body": "It&#39;s not appropriate to include commentary on voting in your answer. The answers are purely for answers to the question. Also, when you edit an answer, you should edit it so that the result doesn&#39;t look edited, since people are looking for answers, not commentary on the history of writing those answers."}, {"owner": {"reputation": 47, "user_id": 3495510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d309dd1f3378082ba81c7f5a0a928d19?s=128&d=identicon&r=PG&f=1", "display_name": "lehoff", "link": "https://stackoverflow.com/users/3495510/lehoff"}, "edited": false, "score": 0, "creation_date": 1509531908, "post_id": 47045615, "comment_id": 81052237, "body": "This is the spot on answer. As soon as I added -fobject-code I could get ghci to produce a result in 8 minutes, which is close to the 6 minutes I get when running on the command line. I still cannot get Jupyter to play ball - I think I will just forget about that and use ghci instead."}], "tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": false, "score": 1, "last_activity_date": 1509496174, "last_edit_date": 1509496174, "creation_date": 1509490004, "answer_id": 47045615, "question_id": 47045171, "link": "https://stackoverflow.com/questions/47045171/executable-completes-but-ghci-just-prints-a/47045615#47045615", "title": "executable completes, but ghci just prints a &quot;", "body": "<p>Perhaps try it on inputs that don't take so long? By default Ghci is interpreted, so depending on the type of code you can anticipate the potential for massive slowdowns compared to compilation.  Something that takes 6 minutes could take 60 minutes instead.</p>\n\n<p>You can instead have ghci compile modules by using -fobject-code.  See <a href=\"https://downloads.haskell.org/~ghc/7.4.1/docs/html/users_guide/ghci-obj.html\" rel=\"nofollow noreferrer\">https://downloads.haskell.org/~ghc/7.4.1/docs/html/users_guide/ghci-obj.html</a></p>\n\n<p>EDIT: I don't know why this is being downvoted.  Someone is being a negative nancy.  Sure, the guy should have more detail and repro.  But this is answerable without the omitted details.</p>\n\n<p>Anyway, I forgot to mention one other thing which is that the reason <code>\"</code> gets printed is due to laziness.  It can get that part of the output before the rest of it is ready.  This is probably the root of the misunderstanding here.</p>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 3495510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d309dd1f3378082ba81c7f5a0a928d19?s=128&d=identicon&r=PG&f=1", "display_name": "lehoff", "link": "https://stackoverflow.com/users/3495510/lehoff"}, "is_accepted": false, "score": 0, "last_activity_date": 1509532611, "creation_date": 1509532611, "answer_id": 47052906, "question_id": 47045171, "link": "https://stackoverflow.com/questions/47045171/executable-completes-but-ghci-just-prints-a/47052906#47052906", "title": "executable completes, but ghci just prints a &quot;", "body": "<p>So mgsloan was totally correct.</p>\n\n<p>The problem was all about the shell being interpreted (it ran in about 1h15m) and as soon as I added the -fobject-code on the <code>stack ghci --ghci-options -fobject-code</code> call I got the computation down to 8 minutes which is close to the 6 minutes I get when running as a compiled program.</p>\n\n<p>Jupyter refuses to be fast, so I will only use that for other experiments - no clue on how to debug that or figure out how why it when from being almost as fast as the compiled program to being really slow.</p>\n\n<p>Extra info: I have now added a way to write the computed results to disk using Data.Binary -look in the League.hs file if you are interested.</p>\n\n<p>This approach allows me to read the results into a variable in ghci using</p>\n\n<pre><code>res &lt;- TrueValue.League.loadResults \"pl-201617.results\"\n</code></pre>\n\n<p>The results are around 500MB, so the first time I use the value it takes about 22s to compute anything. After that it takes less than a second, often way less.</p>\n\n<p>I'd like to apologise for not being clearer when I stated my question, but it was really all about why I was seeing a huge difference in execution time between the compiled program and running in ghci. mgsloan was so kind to see through that.</p>\n"}], "owner": {"reputation": 47, "user_id": 3495510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d309dd1f3378082ba81c7f5a0a928d19?s=128&d=identicon&r=PG&f=1", "display_name": "lehoff", "link": "https://stackoverflow.com/users/3495510/lehoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1509532611, "creation_date": 1509487357, "last_edit_date": 1509487763, "question_id": 47045171, "link": "https://stackoverflow.com/questions/47045171/executable-completes-but-ghci-just-prints-a", "title": "executable completes, but ghci just prints a &quot;", "body": "<p>I am new to Haskell and have some issues with how my code evaluates.</p>\n\n<p>When I write this:</p>\n\n<pre><code>main :: IO ()\nmain = print $ \"v1: \" ++ show v1 ++ \" v2: \" ++ show v2\n  where\n    v1 = Goal.value (0,0) Goal.Home 39\n    v2 = Goal.value (2,1) Goal.Away 50\n</code></pre>\n\n<p>and then run that program in a terminal it finishes in about 6 minutes.</p>\n\n<p>But when I do a <code>stack ghci</code> or <code>stack exec jupyter -- notebook</code> the code just hangs when doing </p>\n\n<pre><code>Goal.value (0,0) Goal.Home 39\n</code></pre>\n\n<p>In ghci it writes a \" and then nothing more.</p>\n\n<p>It used to work and since I had it working I have only worked on how the parser in <code>TrueValue.MatchReader</code>.</p>\n\n<p>Why am I seeing this difference? I am rather confused at this point.</p>\n\n<p>I really miss having that interactive environment to work with my data.\nEspecially because it takes 6 minutes to do the computation, so I'd like to develop and test my functions on the <code>League.results</code> without having to wait so long for each round.</p>\n\n<p>All my code is at <a href=\"https://github.com/lehoff/tvhs\" rel=\"nofollow noreferrer\">https://github.com/lehoff/tvhs</a></p>\n\n<p>Cheers,\nTorben</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1509486600, "post_id": 47044934, "comment_id": 81037437, "body": "How about <code>data Game = Game { ..., cards :: IO Card }</code>? Then something like <code>case newShuffle of KnuthShuffle -&gt; do { i &lt;- initDeckKnuth; cards .= drawKnuth i }</code>. I don&#39;t see the need for a type class at all."}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509487234, "post_id": 47044934, "comment_id": 81037670, "body": "@DanielWagner  Whilst it&#39;s not mandatory, due to me being the only user of the library, I wanted to be able to prevent someone calling initDeckRandomIndex, then calling drawKnuth. By having a class they can only call the correct function. Of course you could could make each function return a different newtype, but I&#39;m not sure if I&#39;d run into the same problem again. Now that I think about it, I don&#39;t think I would"}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509487400, "post_id": 47044934, "comment_id": 81037719, "body": "If you know that there will only be a finite number (two in your example) of implementations of <code>Drawable</code>, then @DanielWagner is right. You can write it the way he suggests and simply not export the <code>initDeckRandomIndex</code>, etc. functions. If you come from languages like Java, the idea that your module system provides access control can be weird, but in Haskell modules are one of the, if not the, best ways to control access to functions."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509487430, "post_id": 47044934, "comment_id": 81037728, "body": "@Zpalmtree That need is easily accommodated by fusing <code>initDeck</code> and <code>draw</code>. That is, instead of offering <code>initDeckKnuth :: IO [Card]</code> and <code>drawKnuth :: [Card] -&gt; IO Card</code>, instead offer only <code>initDrawKnuth :: IO (IO Card)</code>."}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1509488168, "post_id": 47044934, "comment_id": 81037960, "body": "@SilvioMayolo I was intending to use modules to hide implementations, and was just not exporting my data constructors. I&#39;m not sure how I&#39;d go about not exporting the init functions, as how else would you make an initial deck to draw from? You could do something really ugly like checking if a global mvar was set, and if not call the init function but I chose to just use a data type the user couldn&#39;t inspect."}, {"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509488237, "post_id": 47044934, "comment_id": 81037985, "body": "@DanielWagner I&#39;m not sure what that would look like - how would you maintain state of the deck? That type signature confuses me a bit - is that a function which would init the deck, then return an IO function which draws from that deck?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1509489591, "post_id": 47044934, "comment_id": 81038472, "body": "The <code>Drawable</code> class doesn&#39;t really make sense. <code>draw</code> produces a <code>ShuffleType</code>, even though the type of shuffle is already part of the input; what you really want is <code>draw :: forall (t :: ShuffleType) . Drawable t -&gt; IO Card</code> where <code>data Drawable t where KnuthShuffle :: Drawable &#39;KnuthShuffle; RandomIndex :: Drawable &#39;RandomIndex</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "edited": false, "score": 0, "creation_date": 1509489821, "post_id": 47045500, "comment_id": 81038526, "body": "This is nearly exactly what I just finished implementing. Thanks for the help, I&#39;m not sure why I got so hung up on the class idea."}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": true, "score": 4, "last_activity_date": 1509489397, "creation_date": 1509489397, "answer_id": 47045500, "question_id": 47044934, "link": "https://stackoverflow.com/questions/47044934/swap-between-implementations-of-haskell-class-dynamically/47045500#47045500", "title": "Swap between implementations of Haskell class dynamically", "body": "<p>I'm going to summarize what was discussed in the comments. You really don't need a typeclass for this. Let's say we want to have two different deck types: Knuth and random.</p>\n\n<pre><code>data KnuthShuffle = ...\ndata RandomIndex  = ...\n</code></pre>\n\n<p>Then let's define a type that can be either one of these, as you suggested doing yourself.</p>\n\n<pre><code>data ShuffleType = IsKnuthShuffle KnuthShuffle\n                 | IsRandomIndex  RandomIndex\n</code></pre>\n\n<p>Then we'll have all our operations act on <code>ShuffleType</code>.</p>\n\n<pre><code>initDeckKnuth :: IO KnuthShuffle\ninitDeckKnuth = ...\n\ninitDeckRandom :: IO RandomIndex\ninitDeckRandom = ...\n</code></pre>\n\n<p>If we have a <code>KnuthShuffle</code> or a <code>RandomIndex</code> and want to convert it to our unified <code>ShuffleType</code>, we apply the appropriate constructor.</p>\n\n<pre><code>nextRound :: Game -&gt; String -&gt; Game\nnextRound game newShuffle = do\n    case newShuffle of\n        \"knuth\" -&gt; do\n             deck &lt;- IsKnuthShuffle initDeckKnuth\n             cards .= deck\n        \"randomIndex\" -&gt; do\n             deck &lt;- IsRandomIndex initDeckRandom\n             cards .= deck\n</code></pre>\n\n<p>Then all we need to do is be able to draw cards out of it.</p>\n\n<pre><code>draw :: ShuffleType -&gt; IO (ShuffleType, Card)\ndraw (IsKnuthShuffle x) = ... -- The KnuthShuffle case here\ndraw (IsRandomIndex  x) = ... -- The RandomIndex  case here\n</code></pre>\n"}], "owner": {"reputation": 1287, "user_id": 8737306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3bb7d3a90fd41a59ba3e205cbbc5a3e?s=128&d=identicon&r=PG&f=1", "display_name": "Zpalmtree", "link": "https://stackoverflow.com/users/8737306/zpalmtree"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 1, "accepted_answer_id": 47045500, "answer_count": 1, "score": 4, "last_activity_date": 1509489675, "creation_date": 1509485990, "last_edit_date": 1509489675, "question_id": 47044934, "link": "https://stackoverflow.com/questions/47044934/swap-between-implementations-of-haskell-class-dynamically", "title": "Swap between implementations of Haskell class dynamically", "body": "<p>I've pretty much finished writing a poker game, and now I'm trying to demonstrate different implementations of card drawing algorithms, to be swapped potentially each round. I wrote up a class which defines the two functions instances of the class need, and a couple of instances for this class:</p>\n\n<pre><code>class Drawable a where\n    initDeck :: IO a\n    draw :: a -&gt; IO (ShuffleType, Card)\n\nnewtype Deck = Deck [Card]\nnewtype RandomIndex = RandomIndex Deck\nnewtype KnuthShuffle = KnuthShuffle Deck\n\ninstance Drawable RandomIndex where\n    initDeck = return $ coerce fullDeck\n\n    draw x = do\n        let cards = coerce x\n\n        randomNum &lt;- getStdRandom $ randomR (0, length cards- 1)\n\n        let (beginning, card:end) = splitAt randomNum cards\n\n        return (IsRandomIndex . coerce $ beginning ++ end, card)\n\ninstance Drawable KnuthShuffle where\n    initDeck = coerce $ shuffle (length fullDeck - 1) fullDeck\n        where shuffle 0 xs = return xs\n              shuffle i xs = do\n                j &lt;- getStdRandom $ randomR (0, i)\n                shuffle (i-1) (swap i j xs)\n\n    draw x = return (IsKnuthShuffle $ coerce deck, card)\n        where (card:deck) = coerce x\n\n\n-- adapted from https://stackoverflow.com/a/30551130/8737306\nswap :: Int -&gt; Int -&gt; [a] -&gt; [a]\nswap i j xs\n    | i == j = xs\n    | otherwise = let elemI = xs !! i\n                      elemJ = xs !! j\n                      left = take j xs\n                      middle = take (i - j - 1) (drop (j + 1) xs)\n                      right = drop (i + 1) xs\n                  in  left ++ [elemI] ++ middle ++ [elemJ] ++ right\n</code></pre>\n\n<p>Coerce is just used for convenience to unwrap multiple newtypes, I use those to prevent callers outside the module from messing around with the internal cards and insuring the deck state is the same since the previous call of draw.</p>\n\n<p>Now, I want to be able to swap to using them midgame. I have to in some way store the returned type from initDeck or draw in my game data type, to allow me to call draw again. It also has to be polymorphic, so it can store a RandomIndex or a KnuthShuffle.</p>\n\n<p>I initially tried just paramaterizing this data type, so I had something like</p>\n\n<pre><code>data Game a = Game {\n    players :: [Player],\n    pots :: [Pot],\n    cards :: a\n}\n</code></pre>\n\n<p>Then, I could have a function dealCard:</p>\n\n<pre><code>dealCard :: (Drawable a) =&gt; Game a -&gt; Game a\ndealCard game = do\n   deck &lt;- initDeck\n   (card, newDeck) &lt;- draw deck\n   putStrLn $ \"You drew the \" ++ show card\n   cards .= newDeck -- I'm using lenses and stateT\n</code></pre>\n\n<p>But now it doesn't know what instance to use. So lets tell it:</p>\n\n<pre><code>deck &lt;- initDeck :: IO KnuthShuffle\n</code></pre>\n\n<p>Unfortunately, now we have provided an explicit type for deck, it is no longer just a Drawable a, and so we have a type mismatch.</p>\n\n<p>My second thought was to make a compound data type:</p>\n\n<pre><code>data ShuffleType = IsKnuthShuffle KnuthShuffle\n                 | IsRandomIndex RandomIndex\n</code></pre>\n\n<p>Then we can return a ShuffleType from draw, as we know what type it is in each implementation. However, we can't then pass this returned type back to draw, as we can't unwrap it.</p>\n\n<p>Now I'm pretty stuck, eventually I want to be able to do something like this.</p>\n\n<pre><code>nextRound :: Game -&gt; String -&gt; Game\nnextRound game newShuffle = do\n    case newShuffle of\n        \"knuth\" -&gt; do\n             deck &lt;- initDeck :: IO KnuthShuffle\n             cards .= deck\n        \"randomIndex\" -&gt; do\n             deck &lt;- initDeck :: IO RandomIndex\n             cards .= deck\n</code></pre>\n\n<p>Then, in my deal cards function, just calling draw would automatically pick the right representation.</p>\n\n<p>I feel like I'm going around this the wrong way, I usually am able to do everything in Haskell pretty nicely but now I'm not sure how to implement this best. \nI'm not even sure if a class is the best way to do it, and it might even just be better to have a initKnuth, drawKnuth, initRandomIndex etc, but I was hoping to avoid this sort of thing.</p>\n\n<p>I've tried to simplify this a decent amount but I can provide more indepth actual code if needed.</p>\n\n<p>Edit: Thanks to @DanielWagner's suggestion, I ditched the class idea and just provided explicit instances. The code remains pretty much the same, and I can now implement my desired function:</p>\n\n<pre><code>drawCard :: GameStateT Card\ndrawCard = do\n    s &lt;- get\n    shuffle &lt;- lift $ readIORef (s^.shuffleType)\n\n    let oldDeck = s^.cardInfo.deck\n\n    case shuffle of\n        Knuth -&gt; do\n            let (card, newDeck) = drawKnuth oldDeck\n            cardInfo.deck .= IsKnuth newDeck\n            cardInfo.tableCards %= (++ [card])\n            return card\n\n        RandomIndex -&gt; do\n            (card, newDeck) &lt;- lift $ drawRandomIndex oldDeck\n            cardInfo.deck .= IsRandomIndex newDeck\n            cardInfo.tableCards %= (++ [card])\n            return card\n</code></pre>\n\n<p>The downside of this is it's a bit copy pasty if I intend to implement quite a few of these, however I imagine that can be fixed by assigning the card, newDeck as the result of an if statement.</p>\n"}, {"tags": ["haskell", "reduction"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1509476392, "post_id": 47042731, "comment_id": 81032549, "body": "You can&#39;t eta contract on the first argument, only on the last one, as you did for <code>mySum</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1509476510, "post_id": 47042731, "comment_id": 81032615, "body": "<a href=\"http://pointfree.io/\" rel=\"nofollow noreferrer\">pointfree.io</a> says <code>zipWith&#39; = (. zip) . (.) . map . uncurry</code>, by the way. Not too bad, but not exactly readable."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1509476904, "post_id": 47042731, "comment_id": 81032828, "body": "@chi thanks for the comment, I updated the answer, because I can&#39;t learn to do it myself again if I want to with just the right answer. But thanks!"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1509477262, "post_id": 47042731, "comment_id": 81032996, "body": "That&#39;s why it&#39;s better way to define the other around, implement <code>zipWith</code> by hand and then simply do <code>zip = zipWith (,)</code>..."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1509477476, "post_id": 47042731, "comment_id": 81033112, "body": "<a href=\"https://stackoverflow.com/questions/29596285/point-free-problems-in-haskell/29596461#29596461\">This answer</a> demonstrates some mechanical rules to follow when you want to do this"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509515650, "post_id": 47042731, "comment_id": 81044980, "body": "<a href=\"https://stackoverflow.com/a/11009242/849891\"><code>f (g x y) == ((f .) . g) x y</code></a> is a standard tool to apply, easy to remember. ( also, <code>f (g x y z) = (((f .) .) . g) x y z</code> etc. )."}], "answers": [{"comments": [{"owner": {"reputation": 3321, "user_id": 468820, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d53b228cd79135e41556fdf16b98729a?s=128&d=identicon&r=PG", "display_name": "Andrei Bozantan", "link": "https://stackoverflow.com/users/468820/andrei-bozantan"}, "edited": false, "score": 0, "creation_date": 1582281768, "post_id": 47042937, "comment_id": 106731816, "body": "Rhetorical question: do you have to work your way through all the unproductive stuff in order to realize what is important or simple?"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 3321, "user_id": 468820, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d53b228cd79135e41556fdf16b98729a?s=128&d=identicon&r=PG", "display_name": "Andrei Bozantan", "link": "https://stackoverflow.com/users/468820/andrei-bozantan"}, "edited": false, "score": 0, "creation_date": 1585425629, "post_id": 47042937, "comment_id": 107756334, "body": "@AndreiBozantan: If you do it once, you might develop a better sense of how and when to avoid doing it again :)"}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 19, "last_activity_date": 1509481615, "last_edit_date": 1509481615, "creation_date": 1509476994, "answer_id": 47042937, "question_id": 47042731, "link": "https://stackoverflow.com/questions/47042731/eta-reduction-in-haskell/47042937#47042937", "title": "Eta reduction in haskell", "body": "<pre><code>zipWith' f x y = map (uncurry f) (zip x y)\n</code></pre>\n\n<p>Rewrite application to composition and eta-reduce:</p>\n\n<pre><code>-- \\y -&gt; let g = map (uncurry f); h = zip x in (g . h) y\n-- let g = map (uncurry f); h = zip x in g . h\n\nzipWith' f x = map (uncurry f) . zip x\n</code></pre>\n\n<p>Rewrite infix to prefix:</p>\n\n<pre><code>-- g . h = (.) g h\n\nzipWith' f x = (.) (map (uncurry f)) (zip x)\n</code></pre>\n\n<p>Rewrite application to composition and eta-reduce:</p>\n\n<pre><code>-- \\x -&gt; let g = (.) (map (uncurry f)); h = zip in (g . h) x\n-- let g = (.) (map (uncurry f)); h = zip in g . h\n\nzipWith' f = (.) (map (uncurry f)) . zip\n</code></pre>\n\n<p>Rewrite infix to prefix:</p>\n\n<pre><code>-- g . h = (.) g h\n\nzipWith' f = (.) ((.) (map (uncurry f))) zip\n</code></pre>\n\n<p>Use <code>flip</code> to move <code>f</code> to the right-hand side:</p>\n\n<pre><code>-- flip f x y = f y x\n\nzipWith' f = flip (.) zip ((.) (map (uncurry f)))\n</code></pre>\n\n<p>Rewrite application to composition:</p>\n\n<pre><code>-- g (h (i x)) = (g . h . i) x\n\nzipWith' f = flip (.) zip (((.) . map . uncurry) f)\n</code></pre>\n\n<p>Rewrite application to composition and eta-reduce:</p>\n\n<pre><code>-- \\f -&gt; let g = flip (.) zip; h = (.) . map . uncurry in (g . h) f\n-- let g = flip (.) zip; h = (.) . map . uncurry in g . h\n\nzipWith' = (flip (.) zip) . ((.) . map . uncurry)\n</code></pre>\n\n<p>Remove redundant parentheses:</p>\n\n<pre><code>zipWith' = flip (.) zip . (.) . map . uncurry\n</code></pre>\n\n<p>And simplify to infix if you like:</p>\n\n<pre><code>zipWith' = (. zip) . (.) . map . uncurry\n</code></pre>\n\n<p>This result isn\u2019t very readable, though.</p>\n\n<hr>\n\n<p>Often when writing <em>fully</em> point-free code, you want to take advantage of the <code>-&gt;</code> applicative and arrow combinators from <code>Control.Arrow</code>. Rather than trying to write a function like <code>\\ f x y -&gt; ...</code>, you can start by grouping the arguments into tuples to make them easier to rearrange and pipe around. In this case I\u2019ll use <code>\\ (f, (x, y)) -&gt; ...</code></p>\n\n<pre><code>\\ (f, (x, y)) -&gt; map (uncurry f) (zip x y)\n</code></pre>\n\n<p>We can eliminate the unpacking of <code>(x, y)</code> by applying <code>uncurry</code> to <code>zip</code>:</p>\n\n<pre><code>\\ (f, (x, y)) -&gt; map (uncurry f) (uncurry zip (x, y))\n\\ (f, xy) -&gt; map (uncurry f) (uncurry zip xy)\n</code></pre>\n\n<p>Now we have a simple case: applying two functions (<code>uncurry</code> and <code>uncurry zip</code>) to two arguments (<code>f</code> and <code>xy</code>), then combining the results (with <code>map</code>). For this we can use the <code>***</code> combinator from <code>Control.Arrow</code>, of type:</p>\n\n<pre><code>(***) :: Arrow a =&gt; a b c -&gt; a b' c' -&gt; a (b, b') (c, c')\n</code></pre>\n\n<p>Specialised to functions, that\u2019s:</p>\n\n<pre><code>(***) @(-&gt;) :: (b -&gt; c) -&gt; (b' -&gt; c') -&gt; (b, b') -&gt; (c, c')\n</code></pre>\n\n<p>This just lets us apply a function to each element of a pair. Perfect!</p>\n\n<pre><code>uncurry *** uncurry zip\n  :: (a -&gt; b -&gt; c, ([x], [y])) -&gt; ((a, b) -&gt; c, [(x, y)])\n</code></pre>\n\n<p>You can think of <code>uncurry f</code> as combining the elements of a pair using the function <code>f</code>. So here we can combine the results using <code>uncurry map</code>:</p>\n\n<pre><code>uncurry map . (uncurry *** uncurry zip)\n  :: (a -&gt; b -&gt; c, ([a], [b])) -&gt; [c]\n</code></pre>\n\n<p>And you can think of <code>curry</code> as turning a function on tuples into a multi-argument function. Here we have two levels of tuples, the outer <code>(f, xy)</code> and the inner <code>(x, y)</code>. We can unpack the outer one with <code>curry</code>:</p>\n\n<pre><code>curry $ uncurry map . (uncurry *** uncurry zip)\n  :: (a -&gt; b -&gt; c) -&gt; ([a], [b]) -&gt; [c]\n</code></pre>\n\n<p>Now, you can think of <code>fmap f</code> in the <code>-&gt;</code> applicative as \u201cskipping over\u201d the first argument:</p>\n\n<pre><code>fmap @((-&gt;) _) :: (a -&gt; b) -&gt; (t -&gt; a) -&gt; t -&gt; b\n</code></pre>\n\n<p>So we can unpack the second tuple using <code>fmap curry</code>:</p>\n\n<pre><code>fmap curry $ curry $ uncurry map . (uncurry *** uncurry zip)\n  :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\n</code></pre>\n\n<p>And we\u2019re done! Or not quite. When writing point-free code, it pays to break things out into many small reusable functions with clearer names, for example:</p>\n\n<pre><code>zipWith' = untuple2 $ combineWith map apply zipped\n  where\n    untuple2 = fmap curry . curry\n    combineWith f g h = uncurry f . (g *** h)\n    apply = uncurry\n    zipped = uncurry zip\n</code></pre>\n\n<hr>\n\n<p>However, while knowing these techniques is useful, all this is just unproductive trickery that\u2019s easy to get lost in. Most of the time, you should only use point-free style in Haskell when it\u2019s a clear win for readability, and neither of these results is clearer than the simple original version:</p>\n\n<pre><code>zipWith' f x y = map (uncurry f) (zip x y)\n</code></pre>\n\n<p>Or a <em>partially</em> point-free version:</p>\n\n<pre><code>zipWith' f = map (uncurry f) .: zip\n  where (.:) = (.) . (.)\n</code></pre>\n"}], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1715, "favorite_count": 2, "accepted_answer_id": 47042937, "answer_count": 1, "score": 9, "last_activity_date": 1573574043, "creation_date": 1509476167, "last_edit_date": 1573574043, "question_id": 47042731, "link": "https://stackoverflow.com/questions/47042731/eta-reduction-in-haskell", "title": "Eta reduction in haskell", "body": "<p>I tried for a long time to reduct this function in haskell, I want to express for example:</p>\n\n<pre><code>mySum x y = x + y\nmySum x y = (+) x y\nmySum x = (+) x\nmySum = (+) -- it's Messi's goal! \n</code></pre>\n\n<p>My function it a little more complex, but I really can't do it, I was looking out here and there, and I know there are some techniques, like modify the right side, and use <code>flip</code>. I tried and I got stuck here:</p>\n\n<pre><code>zipWith' :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\nzipWith' f x y  = map  (uncurry f) (zip x y) \n</code></pre>\n\n<p>Steps:</p>\n\n<pre><code>zipWith' f x y  = map  (uncurry f) (zip x y) \nzipWith' f x y  = flip  map  (zip x y) (uncurry f)\nzipWith' f x y  = flip  map  (zip x y) $ uncurry f\n</code></pre>\n\n<p>and then I don't know how to continue...</p>\n\n<p><strong>I'm looking for an answer that could explain step by step how to achieve the \"Messi's goal\", I know is a lot to ask, so I will add as soon as I can a bounty to thank the effort</strong></p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4347249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b834b73861e5b0468279f002abc3ca6a?s=128&d=identicon&r=PG", "display_name": "Matheus Amazonas", "link": "https://stackoverflow.com/users/4347249/matheus-amazonas"}, "edited": false, "score": 0, "creation_date": 1509476122, "post_id": 47042508, "comment_id": 81032378, "body": "I forgot that inverting the order of evaluation of the &gt;=&gt; would have that impact. Your answer was short and clear. Thank you very much!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1509476126, "last_edit_date": 1509476126, "creation_date": 1509475421, "answer_id": 47042508, "question_id": 47042300, "link": "https://stackoverflow.com/questions/47042300/kleisli-composition-and-fold-over-an-infinite-list/47042508#47042508", "title": "Kleisli composition and fold over an infinite list", "body": "<p>You can't start visiting an infinite list from its end -- there is no end.</p>\n\n<p>You code builds</p>\n\n<pre><code>action0 &lt;=&lt; (action1 &lt;=&lt; (action2 ....))\n</code></pre>\n\n<p>which has the right associativity, <em>but</em> <code>x &lt;=&lt; y</code> (roughly speaking) runs <code>y</code> before <code>x</code>.</p>\n\n<p>Using <code>&gt;=&gt;</code> makes the computation start with <code>action0</code> as intended.</p>\n\n<p>Compare with this:</p>\n\n<pre><code>cons x xs = x : xs\nsnoc x xs = xs ++ [x]\n\nfoldr cons [] [1..] = [1..]\nfoldr snoc [] [1..] = _|_\n</code></pre>\n\n<p>This is no surprise, since <code>foldr snoc [] = reverse</code>, and we can't reverse an infinite list.</p>\n\n<p>The issue here is that <code>snoc</code> evaluates the tail <code>xs</code> before <code>x</code>, so <code>foldr</code> evaluates the \"recursive call\" to the tail list before considering the element at hand.</p>\n\n<p>In the monadic case things are more complex, but the general principle is similar in its spirit. Using <code>foldr (&lt;=&lt;) return (repeat action)</code> is similar to</p>\n\n<pre><code>loop x = do\n   x' &lt;- loop x\n   action x'\n</code></pre>\n\n<p>Instead, <code>foldr (&gt;=&gt;) return (repeat action)</code> is similar to</p>\n\n<pre><code>loop x = do\n   x' &lt;- action x\n   loop x'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 4347249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b834b73861e5b0468279f002abc3ca6a?s=128&d=identicon&r=PG", "display_name": "Matheus Amazonas", "link": "https://stackoverflow.com/users/4347249/matheus-amazonas"}, "edited": false, "score": 0, "creation_date": 1509476077, "post_id": 47042572, "comment_id": 81032355, "body": "You three submitted answers basically at the same time, so I marked the first one as the official answer. Although, all the answers were extremely helpful and did answer my question. Thank you very much."}, {"owner": {"reputation": 23, "user_id": 4347249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b834b73861e5b0468279f002abc3ca6a?s=128&d=identicon&r=PG", "display_name": "Matheus Amazonas", "link": "https://stackoverflow.com/users/4347249/matheus-amazonas"}, "edited": false, "score": 0, "creation_date": 1509523640, "post_id": 47042572, "comment_id": 81048048, "body": "I forgot to thank you for the fixpoint combinator tip, it was indeed a better solution than using foldr."}], "tags": [], "owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "is_accepted": false, "score": 3, "last_activity_date": 1509477222, "last_edit_date": 1509477222, "creation_date": 1509475638, "answer_id": 47042572, "question_id": 47042300, "link": "https://stackoverflow.com/questions/47042300/kleisli-composition-and-fold-over-an-infinite-list/47042572#47042572", "title": "Kleisli composition and fold over an infinite list", "body": "<p>Try to expand the <code>foldr</code>:</p>\n\n<pre><code>foldr (&lt;=&lt;) return (repeat process) s\n-- becomes\n(process &lt;=&lt; (process &lt;=&lt; (process \u2026 &lt;=&lt; return))) s\n</code></pre>\n\n<p>which has to evaluate the innermost function to apply <code>s</code> - failing of course. In contrast,</p>\n\n<pre><code>foldr (&gt;=&gt;) return (repeat process) s\n-- becomes\n(process &gt;=&gt; (process &gt;=&gt; (process \u2026 &gt;=&gt; return))) s\n</code></pre>\n\n<p>which when applying <code>s</code> will pass it to the first function in the chain, and only when passing the result of that to the next function the rest of the chain will be evaluated - lazily.</p>\n\n<p>I don't think there is a way to construct the sequence</p>\n\n<pre><code>(return &gt;=&gt; (process &gt;=&gt; (process &gt;=&gt; (process \u2026)))) s\n</code></pre>\n\n<p>using a fold, but you can use the fixpoint combinator:</p>\n\n<pre><code>fix (process &gt;=&gt;) s -- `return &gt;=&gt;` is a pointless `id` in front\n-- or\nfix (&lt;=&lt; process) s\n</code></pre>\n\n<p>Notice that the very similar <code>fix (&gt;=&gt; process)</code> and <code>fix (process &lt;=&lt;)</code> would have the same infinite recursion problem, trying forever to find the first function to apply.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 4347249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b834b73861e5b0468279f002abc3ca6a?s=128&d=identicon&r=PG", "display_name": "Matheus Amazonas", "link": "https://stackoverflow.com/users/4347249/matheus-amazonas"}, "edited": false, "score": 0, "creation_date": 1509476083, "post_id": 47042576, "comment_id": 81032357, "body": "You three submitted answers basically at the same time, so I marked the first one as the official answer. Although, all the answers were extremely helpful and did answer my question. Thank you very much."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 1, "last_activity_date": 1509475646, "creation_date": 1509475646, "answer_id": 47042576, "question_id": 47042300, "link": "https://stackoverflow.com/questions/47042300/kleisli-composition-and-fold-over-an-infinite-list/47042576#47042576", "title": "Kleisli composition and fold over an infinite list", "body": "<p><code>foldr</code> works like this:</p>\n\n<pre><code>xs =\n  a : (b : (c : ... (d : nil)...))\nfoldr kons knil xs =\n  a `kons` (b `kons` (c `kons` ... (d `kons` knil)...))\n</code></pre>\n\n<p>So, in your case:</p>\n\n<pre><code>repeat process =\n  process : (process : (process : ...))\nfoldr (&lt;=&lt;) return (repeat process) =\n  process &lt;=&lt; (process &lt;=&lt; (process &lt;=&lt; ...))\n</code></pre>\n\n<p>Now, when you do an application <code>(f &lt;=&lt; g) x</code>, you have to apply <code>g x</code> first. In your case, to apply <code>(process &lt;=&lt; (process &lt;=&lt; (process &lt;=&lt; ...))) x</code>, you must first apply <code>(process &lt;=&lt; (process &lt;=&lt; (process &lt;=&lt; ...))) x</code>, so you must first apply <code>(process &lt;=&lt; (process &lt;=&lt; (process &lt;=&lt; ...))) x</code>, ... .</p>\n\n<p>The solution (as you know) is to flip <code>(&lt;=&lt;)</code> to <code>(&gt;=&gt;)</code></p>\n\n<pre><code>foldr (&gt;=&gt;) return (repeat process) =\n  process &gt;=&gt; (process &gt;=&gt; (process &gt;=&gt; ...))\n</code></pre>\n\n<p>To apply <code>(f &gt;=&gt; g) x</code>, you have to apply <code>f x</code> first. In your case, to apply <code>(process &gt;=&gt; (process &gt;=&gt; (process &gt;=&gt; ...))) x</code>, you must first apply <code>process x</code>, which does work, and then you need to apply <code>(process &gt;=&gt; (process &gt;=&gt; (process &gt;=&gt; ...))) x'</code>, so you apply <code>process x'</code>, which does work, and then you need to apply <code>(process &gt;=&gt; (process &gt;=&gt; (process &gt;=&gt; ...))) x''</code>, so you need to apply <code>process x''</code>, ... .</p>\n\n<p>The runtime doesn't care that the result should be the same either way. Checking that property means solving the halting problem, which is impossible to solve for every possible case. It's better that Haskell will predictably fail than to try to do the impossible and become a thousand times more confusing.</p>\n"}], "owner": {"reputation": 23, "user_id": 4347249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b834b73861e5b0468279f002abc3ca6a?s=128&d=identicon&r=PG", "display_name": "Matheus Amazonas", "link": "https://stackoverflow.com/users/4347249/matheus-amazonas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 47042508, "answer_count": 3, "score": 2, "last_activity_date": 1509477222, "creation_date": 1509474609, "question_id": 47042300, "link": "https://stackoverflow.com/questions/47042300/kleisli-composition-and-fold-over-an-infinite-list", "title": "Kleisli composition and fold over an infinite list", "body": "<p>While trying to define an infinite loop that reads from a connection channel using Haskell, I came across the idea of folding over an infinite list of partially applied function using the Kleisli composition of monads. The idea seemed plausible and simple enough, but I came across a weird scenario where apparently the infinite list is being evaluated, instead of waiting for input.</p>\n\n<p>I created the following example that illustrates my problem:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>loop :: Int -&gt; IO Int\nloop s = (foldr (&lt;=&lt;) return (repeat process)) s\n\nprocess :: Int -&gt; IO Int\nprocess i = do\n    putStrLn $ show i\n    x &lt;- getLine\n    return $ i + 1\n\nmain = loop 0\n</code></pre>\n\n<p>When I run the code above, GHCi stops after overflowing the stack. It doesn't wait for the \"getLine\". When I replace the &lt;=&lt; with >=>, it works as expected: the list will only get evaluated elements by element, after each \"getLine\". </p>\n\n<p>Why does that happen? My foldr initial value is return, it shouldn't add any side effect to it and according to monad laws, the left and right identity with should guarantee equal behavior using both &lt;=&lt; and >=>.</p>\n"}, {"tags": ["haskell", "type-inference", "exponentiation", "monoids", "hindley-milner"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509466475, "post_id": 47039840, "comment_id": 81026474, "body": "If I run your program, I simply get <code>Ambiguous occurrence \u2018^\u2019</code>. You can not simply override a name in Haskell"}, {"owner": {"reputation": 747, "user_id": 1644720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56c78e4be01bb6d0fd2ad2c2f99a5f37?s=128&d=identicon&r=PG", "display_name": "Crazycolorz5", "link": "https://stackoverflow.com/users/1644720/crazycolorz5"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509466545, "post_id": 47039840, "comment_id": 81026523, "body": "In my code, I&#39;m using RebindableSyntax. Prelude&#39;s (^) is not in scope. Edit: Also, the Monoid typeclass I&#39;m using is also mine."}, {"owner": {"reputation": 747, "user_id": 1644720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56c78e4be01bb6d0fd2ad2c2f99a5f37?s=128&d=identicon&r=PG", "display_name": "Crazycolorz5", "link": "https://stackoverflow.com/users/1644720/crazycolorz5"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509466915, "post_id": 47039840, "comment_id": 81026734, "body": "If it helps, the code I&#39;m using is all in this GitHub repo: <a href=\"https://github.com/Crazycolorz5/AlgebraicPrelude/tree/c468d6cda1bc8abaca350c5b736f804dd489b6f3\" rel=\"nofollow noreferrer\">github.com/Crazycolorz5/AlgebraicPrelude/tree/&hellip;</a>"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1509467310, "post_id": 47039840, "comment_id": 81026954, "body": "I suspect this is due to the special-ness of <code>Num</code> in the defaulting rules, although a MVCE would be much appreciated (as in something standalone that I can run to replicate the problem)."}, {"owner": {"reputation": 747, "user_id": 1644720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56c78e4be01bb6d0fd2ad2c2f99a5f37?s=128&d=identicon&r=PG", "display_name": "Crazycolorz5", "link": "https://stackoverflow.com/users/1644720/crazycolorz5"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1509467895, "post_id": 47039840, "comment_id": 81027327, "body": "@Alec I think you&#39;re right; do you know where in the Prelude code the defaults are specified, and how I can define them myself? Also, apologies for lack of an MVCE, there&#39;s a lot of interconnected code; the Groups, Order, and Numbers modules in the repo I linked should be all that&#39;s necessary to recreate this though."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509468240, "post_id": 47039840, "comment_id": 81027542, "body": "What is your defaulting list? I bet it doesn&#39;t include an instance of <code>Numeric</code> or <code>Integral</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509469665, "post_id": 47039840, "comment_id": 81028451, "body": "To the best of my knowledge, there&#39;s no way to add arbitrary classes to the defaulting mechanism."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509469756, "post_id": 47039840, "comment_id": 81028527, "body": "Side note: your <code>Numeric</code> class seems very surprising to me. I can&#39;t see what it could possibly be for, and especially why you would name it as you did."}, {"owner": {"reputation": 747, "user_id": 1644720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56c78e4be01bb6d0fd2ad2c2f99a5f37?s=128&d=identicon&r=PG", "display_name": "Crazycolorz5", "link": "https://stackoverflow.com/users/1644720/crazycolorz5"}, "edited": false, "score": 0, "creation_date": 1509472654, "post_id": 47039840, "comment_id": 81030417, "body": "Thanks all for your responses. If I wanted to keep the behavior of defaulting, I should make Integral subclass from Num, and then specify that as a constraint in (^). (Interestingly, it still refuses to default if I don&#39;t explicitly state the Num command, despite Integral requiring Num)"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509473005, "post_id": 47041532, "comment_id": 81030613, "body": "Numbers mod some prime <code>p</code> can be on the scale even for very large exponents indeed, and are frequently useful."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509475717, "post_id": 47041532, "comment_id": 81032164, "body": "@DanielWagner right, but you wouldn&#39;t use <code>^</code> for that kind of stuff, would you?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509476380, "post_id": 47041532, "comment_id": 81032538, "body": "<a href=\"https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Encryption\" rel=\"nofollow noreferrer\">Yes, sure I would.</a>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509476541, "post_id": 47041532, "comment_id": 81032629, "body": "@DanielWagner I know about modular exponentiation, my point is that you <i>wouldn&#39;t calculate it with Haskell&#39;s <code>^</code> operator anyway</i>, but with a function that&#39;s designed around the modulo behaviour. Although \u2013 it should actually be doable, with something like <a href=\"https://hackage.haskell.org/package/modular-arithmetic-1.2.1.2/docs/Data-Modular.html\" rel=\"nofollow noreferrer\"><code>Data.Modular</code></a>..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509477165, "post_id": 47041532, "comment_id": 81032946, "body": "Why wouldn&#39;t I calculate it with Haskell&#39;s <code>^</code> operator? I can think of two objections: 1. You want a specialized operator that first reduces the exponent mod <code>p</code>. But I think the specialized one would probably call <code>^</code> once it had a small exponent -- and that &quot;small&quot; exponent might still be bigger than an <code>Int</code>. 2. It&#39;s hard to write a type which lets you choose the prime at runtime without running afoul of mismatches in operations like <code>+</code>. I outline an <code>ST</code>-like trick for avoiding this problem in <a href=\"https://stackoverflow.com/a/38926412/791604\">another answer</a>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509477714, "post_id": 47041532, "comment_id": 81033245, "body": "@DanielWagner you wouldn&#39;t use <code>^</code> because you don&#39;t want the giant numbers to actually ever turn up in memory, just to then mod them down in the end. It&#39;s <a href=\"https://en.wikipedia.org/wiki/Modular_exponentiation#Memory-efficient_method\" rel=\"nofollow noreferrer\">not necessary</a>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509484709, "post_id": 47041532, "comment_id": 81036684, "body": "A type which represents numbers mod <code>p</code> need not ever have the large numbers turn up in memory -- presumably the implementation of <code>*</code> for that type would include a call to <code>mod</code>, and <code>^</code> calls <code>*</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509500871, "post_id": 47041532, "comment_id": 81041293, "body": "So you oppose the whole <code>Foldable</code> class, I imagine? As well as <code>Integral</code>?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509527098, "post_id": 47041532, "comment_id": 81049569, "body": "@dfeuer \u201coppose\u201d is way too strong \u2013 of course these have their place. And <code>Integral</code> is perfectly sensible for stuff where you actually need the <i>result</i> to be big numbers that can&#39;t be stored in <code>Int</code>, or conversely a tight unboxed data structure where you don&#39;t want to afford 8 bytes for a single small number. My point is you shouldn&#39;t make function-arguments terminally-polymorphic\u2020 unless you have a good reason to. For instance, it&#39;s no good idea to write a function <code>IsString a =&gt; a -&gt; B</code>, better make it simply <code>Text -&gt; B</code>. \u2014 \u2020I&#39;m not sure this term makes sense, but you get what I mean..."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 1, "last_activity_date": 1509527197, "last_edit_date": 1509527197, "creation_date": 1509471865, "answer_id": 47041532, "question_id": 47039840, "link": "https://stackoverflow.com/questions/47039840/problems-with-type-inference-on/47041532#47041532", "title": "Problems With Type Inference on (^)", "body": "<p>A Hindley-Milner type system doesn't really like having to <em>default</em> anything. In such a system, you want types to be either <em>properly fixed</em> (rigid, skolem) or <em>properly polymorphic</em>, but the concept of \u201cthis is, like, an integer... but if you prefer, I can also cast it to something else\u201d as many other languages have doesn't really work out.</p>\n\n<p>Consequently, Haskell sucks at defaulting. It doesn't have first-class support for that, only a pretty hacky ad-hoc, hard-coded mechanism which mainly deals with built-in number types, but fails at anything more involved.</p>\n\n<p>You therefore should try to not rely on defaulting. My opinion is that the standard signature for <code>^</code> is unreasonable; a better signature would be</p>\n\n<pre><code>(^) :: Num a =&gt; a -&gt; Int -&gt; a\n</code></pre>\n\n<p>The <code>Int</code> is probably controversial \u2013 of course <code>Integer</code> would be safer in a sense; however, an <em>exponent</em> too big to fit in <code>Int</code> generally means the results will be totally off the scale anyway and couldn't feasibly be calculated by iterated multiplication; so this kind of expresses the intend pretty well. And it gives best performance for the extremely common situation where you just write <code>x^2</code> or similar, which is something where you very definitely don't want to have to put an extra signature in the exponent.</p>\n\n<p>In the rather fewer cases where you have a concrete e.g. <code>Integer</code> number and want to use it in the exponent, you can always shove in an explicit <code>fromIntegral</code>. That's not nice, but rather less of an inconvenience.</p>\n\n<p>As a general rule, I try to <em>avoid<sup>\u2020</sup> any function-arguments that are more polymorphic than the results</em>. Haskell's polymorphism works best \u201cbackwards\u201d, i.e. the opposite way as in dynamic language: the caller requests what type the result should be, and the compiler figures out from this what the arguments should be. This works pretty much always, because as soon as the result is somehow used in the main program, the types in the whole computation have to be linked to a tree structure.</p>\n\n<p>OTOH, inferring the type of the result is often problematic: arguments may be optional, may themselves be linked only to the result, or given as polymorphic constants like Haskell number literals. So, if <code>i</code> doesn't turn up in the result of <code>^</code>, avoid letting in occur in the arguments either.</p>\n\n<p><hr>\n<sup>\u2020</sup><sub>\u201cAvoid\u201d doesn't mean I don't ever write them, I just don't do so unless there's a good reason.</sub></p>\n"}], "owner": {"reputation": 747, "user_id": 1644720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56c78e4be01bb6d0fd2ad2c2f99a5f37?s=128&d=identicon&r=PG", "display_name": "Crazycolorz5", "link": "https://stackoverflow.com/users/1644720/crazycolorz5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 47041532, "answer_count": 1, "score": 2, "last_activity_date": 1509527197, "creation_date": 1509466130, "last_edit_date": 1509466787, "question_id": 47039840, "link": "https://stackoverflow.com/questions/47039840/problems-with-type-inference-on", "title": "Problems With Type Inference on (^)", "body": "<p>So, I'm trying to write my own replacement for Prelude, and I have (^) implemented as such:</p>\n\n<pre><code>{-# LANGUAGE RebindableSyntax #-}\n\nclass Semigroup s where\n    infixl 7 *\n    (*) :: s -&gt; s -&gt; s\n\nclass (Semigroup m) =&gt; Monoid m where\n    one :: m\n\nclass (Ring a) =&gt; Numeric a where\n    fromIntegral :: (Integral i) =&gt; i -&gt; a\n    fromFloating :: (Floating f) =&gt; f -&gt; a\n\nclass (EuclideanDomain i, Numeric i, Enum i, Ord i) =&gt; Integral i where\n    toInteger :: i -&gt; Integer\n    quot :: i -&gt; i -&gt; i\n    quot a b = let (q,r) = (quotRem a b) in q\n    rem :: i -&gt; i -&gt; i\n    rem a b = let (q,r) = (quotRem a b) in r\n    quotRem :: i -&gt; i -&gt; (i, i)\n    quotRem a b = let q = quot a b; r = rem a b in (q, r)\n\n-- . . .\n\ninfixr 8 ^\n(^) :: (Monoid m, Integral i) =&gt; m -&gt; i -&gt; m\n(^) x i\n    | i == 0 = one\n    | True   = let (d, m) = (divMod i 2)\n                   rec = (x*x) ^ d in\n               if m == one then x*rec else rec\n</code></pre>\n\n<p>(Note that the Integral used here is one I defined, not the one in Prelude, although it is similar. Also, <code>one</code> is a polymorphic constant that's the identity under the  monoidal operation.)</p>\n\n<p>Numeric types are monoids, so I can try to do, say 2^3, but then the typechecker gives me:</p>\n\n<pre><code>*AlgebraicPrelude&gt; 2^3\n\n&lt;interactive&gt;:16:1: error:\n    * Could not deduce (Integral i0) arising from a use of `^'\n      from the context: Numeric m\n        bound by the inferred type of it :: Numeric m =&gt; m\n        at &lt;interactive&gt;:16:1-3\n      The type variable `i0' is ambiguous\n      These potential instances exist:\n        instance Integral Integer -- Defined at Numbers.hs:190:10\n        instance Integral Int -- Defined at Numbers.hs:207:10\n    * In the expression: 2 ^ 3\n      In an equation for `it': it = 2 ^ 3\n\n&lt;interactive&gt;:16:3: error:\n    * Could not deduce (Numeric i0) arising from the literal `3'\n      from the context: Numeric m\n        bound by the inferred type of it :: Numeric m =&gt; m\n        at &lt;interactive&gt;:16:1-3\n      The type variable `i0' is ambiguous\n      These potential instances exist:\n        instance Numeric Integer -- Defined at Numbers.hs:294:10\n        instance Numeric Complex -- Defined at Numbers.hs:110:10\n        instance Numeric Rational -- Defined at Numbers.hs:306:10\n        ...plus four others\n        (use -fprint-potential-instances to see them all)\n    * In the second argument of `(^)', namely `3'\n      In the expression: 2 ^ 3\n      In an equation for `it': it = 2 ^ 3\n</code></pre>\n\n<p>I get that this arises because Int and Integer are both Integral types, but then why is it that in normal Prelude I can do this just fine? :</p>\n\n<pre><code>Prelude&gt; :t (2^)\n(2^) :: (Num a, Integral b) =&gt; b -&gt; a\nPrelude&gt; :t 3\n3 :: Num p =&gt; p\nPrelude&gt; 2^3\n8\n</code></pre>\n\n<p>Even though the signatures for partial application in mine look identical?</p>\n\n<pre><code>*AlgebraicPrelude&gt; :t (2^)\n(2^) :: (Numeric m, Integral i) =&gt; i -&gt; m\n*AlgebraicPrelude&gt; :t 3\n3 :: Numeric a =&gt; a\n</code></pre>\n\n<p>How would I make it so that 2^3 would in fact work, and thus give 8?</p>\n"}, {"tags": ["parsing", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 4, "creation_date": 1509464894, "post_id": 47039339, "comment_id": 81025402, "body": "Where is your <code>Monad</code> instance for <code>Parser</code>?"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 4, "creation_date": 1509467445, "post_id": 47039339, "comment_id": 81027035, "body": "Your <code>p</code> is making use of the <code>(-&gt;) String</code> monad, not any kind of <code>Parser</code> monad. You need to make <code>Parser</code> a <code>newtype</code>, and then write the <code>Monad</code> instance for it before you can use <code>do</code> as you want."}, {"owner": {"reputation": 475, "user_id": 3235560, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/d5mR4.jpg?s=128&g=1", "display_name": "exrezzo", "link": "https://stackoverflow.com/users/3235560/exrezzo"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1509467889, "post_id": 47039339, "comment_id": 81027324, "body": "@n.m. Sorry, I edited the question."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509470344, "post_id": 47039339, "comment_id": 81028922, "body": "Never paste images of text! Copy and paste, or type out. The image is useless for blind users and annoying for all other users."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1509470944, "post_id": 47039339, "comment_id": 81029272, "body": "I can&#39;t understand why this is being downvoted. Images should be replaced, I concur -- but at least this question shows some effort, unlike many others by people who are learning Haskell."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1509471498, "post_id": 47039339, "comment_id": 81029610, "body": "I think Erik Meijer is playing fast and loose in his talk. You cannot really make <code>Parser</code> an instance of <code>Monad</code> in a way that makes monadic parsing work. The problem is, <code>String -&gt;</code> <b>is</b> an instance of <code>Monad</code> (so the do notation works), but it&#39;s a wrong instance and produces all the wrong types.Try to rewrite this function using an explicit <code>bind</code> rather than <code>do</code>. Alternatively you can wrap <code>Parser</code> in a newtype like this <code>newtype Parser a = Parser { unparser :: String -&gt; [(a, String)] }</code> and define a Monad instance for that... but that&#39;s probably too much for the first Monad lesson..."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 4, "last_activity_date": 1509499444, "last_edit_date": 1509499444, "creation_date": 1509471503, "answer_id": 47041419, "question_id": 47039339, "link": "https://stackoverflow.com/questions/47039339/simple-parse-in-haskell-with-do-construct/47041419#47041419", "title": "Simple Parse in Haskell with do construct", "body": "<p>Your <code>Parser</code> is just a type synonym for a function. The friendly parsers you've seen in use are all proper types of their own, with <code>Functor</code> and <code>Applicative</code> instances, along with (in most cases) <code>Alternative</code>, <code>Monad</code>, and <code>MonadPlus</code> instances. You probably want something that looks like the following (untested, never compiled) version.</p>\n\n<pre><code>import Control.Monad (ap, liftM)\nimport Control.Applicative (Alternative (..))\n\nnewtype Parser a = Parser\n  { runParser :: String -&gt; [(a, String)] }\n\ninstance Functor Parser where\n  fmap = liftM\n\ninstance Applicative Parser where\n  pure v = Parser $ \\inp -&gt; [(v, inp)]\n  (&lt;*&gt;) = ap\n\ninstance Monad Parser where\n  -- The next line isn't required for\n  -- recent GHC versions\n  -- return = pure\n\n  Parser m &gt;&gt;= f = Parser $ \\s -&gt;\n    [(r, s'') | (x, s') &lt;- m s\n              , (r, s'') &lt;- runParser (f r) s']\n\n(+++) :: Parser a -&gt; Parser a -&gt; Parser a\np +++ q = Parser $ \\inp -&gt; case runParser p inp of\n  [] -&gt; runParser q inp\n  [(v, out)] -&gt; [(v, out)]\n\nfailure :: Parser a\nfailure = Parser $ \\inp -&gt; []\n\ninstance Alternative Parser where\n  (&lt;|&gt;) = (+++)\n  empty = failure\n\ninstance MonadPlus Parser\n</code></pre>\n"}], "owner": {"reputation": 475, "user_id": 3235560, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/d5mR4.jpg?s=128&g=1", "display_name": "exrezzo", "link": "https://stackoverflow.com/users/3235560/exrezzo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509499444, "creation_date": 1509464598, "last_edit_date": 1509467704, "question_id": 47039339, "link": "https://stackoverflow.com/questions/47039339/simple-parse-in-haskell-with-do-construct", "title": "Simple Parse in Haskell with do construct", "body": "<p>I'm trying to write a simple Parser, so all the declarations are listed in the image below, but when I try to compile this module it fails.\nI'm following the tutorial provided by this source ->\n<a href=\"https://channel9.msdn.com/Tags/haskell?page=2\" rel=\"nofollow noreferrer\">Haskell lessons suggested by official site</a> and specifically this video by Dr. Erik Meijer (<a href=\"https://channel9.msdn.com/Series/C9-Lectures-Erik-Meijer-Functional-Programming-Fundamentals/C9-Lectures-Dr-Erik-Meijer-Functional-Programming-Fundamentals-Chapter-8-of-13\" rel=\"nofollow noreferrer\">Lesson on Parser with \"do\" construct</a>).</p>\n\n<p>The problem is that I thought that the \"do\" construct was able to \"concatenate\" outputs from a previous function in a descending way, but the way that this p function should work seems to be magic to me. What's the right implementation?</p>\n\n<pre><code>-- Generic Parser.\ntype Parser a = String -&gt; [(a, String)]\n\n-- A simple Parser that captures the first char of the string, puts it in\n-- the first position of the couple and then puts the rest of the string into\n-- the second place of the couple inside the singleton list.\nitem :: Parser Char\nitem = \\inp -&gt; case inp of\n    [] -&gt; []\n(x:xs) -&gt; [(x, xs)]\n\n-- Simple parser that always fails.    \nfailure :: Parser a\nfailure = \\inp -&gt; []\n\n-- Returns the type of the parser without operating on the input.\nreturn1 :: a -&gt; Parser a\nreturn1 v = \\inp -&gt; [(v, inp)]\n\n-- Explicit call to parse.\nparse :: Parser a -&gt; String -&gt; [(a, String)]\nparse p inp = p inp\n\n-- Some kind of \"or\" operator that if the first parser fails (returning an empty list) it\n-- parses the second parser.\n(+++) :: Parser a -&gt; Parser a -&gt; Parser a\np +++ q = \\inp -&gt; case p inp of\n    [] -&gt; parse q inp\n    [(v, out)] -&gt; [(v, out)]\n\n-- The function within I'm having troubles.\np :: Parser (Char,Char)\np = do\n    x &lt;- item\n    item\n    y &lt;- item\n    return1 (x, y)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/y38SN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y38SN.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is how it's explained by Dr. Meijer:\n<a href=\"https://i.stack.imgur.com/QNQhT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QNQhT.png\" alt=\"\"></a></p>\n\n<p>And this is how it should work:\n<a href=\"https://i.stack.imgur.com/MP3w1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MP3w1.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["list", "haskell", "mod"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1509463206, "post_id": 47038791, "comment_id": 81024225, "body": "What is <code>(Char, Int)..(Char, Int)</code>? What about <code>[Int] [Int]</code>? Appreciate that you add signatures, but these don&#39;t make sense. Please write an actual Haskell module that typechecks. And don&#39;t add stuff that&#39;s not relevant to the questions."}, {"owner": {"reputation": 7, "user_id": 8863154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39b24133e7d9a55e060588a04518f6b?s=128&d=identicon&r=PG&f=1", "display_name": "Lillian Wangler", "link": "https://stackoverflow.com/users/8863154/lillian-wangler"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1509465515, "post_id": 47038791, "comment_id": 81025829, "body": "Sorry, I&#39;m new to this and self-taught. It was my best guess."}], "answers": [{"tags": [], "owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "is_accepted": false, "score": 2, "last_activity_date": 1509463598, "last_edit_date": 1509463598, "creation_date": 1509463269, "answer_id": 47038894, "question_id": 47038791, "link": "https://stackoverflow.com/questions/47038791/how-to-apply-mod-to-every-element-in-a-list-in-haskell/47038894#47038894", "title": "How to apply mod to every element in a list in Haskell", "body": "<p>Use list comprehension.</p>\n\n<pre><code>[x `mod` 26 | x &lt;- almostVig]\n</code></pre>\n\n<p>This will result in a new list in which all elements will be less than <code>26</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1509463989, "post_id": 47038959, "comment_id": 81024787, "body": "Worth explaining the operator-section."}, {"owner": {"reputation": 7, "user_id": 8863154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39b24133e7d9a55e060588a04518f6b?s=128&d=identicon&r=PG&f=1", "display_name": "Lillian Wangler", "link": "https://stackoverflow.com/users/8863154/lillian-wangler"}, "edited": false, "score": 0, "creation_date": 1509465171, "post_id": 47038959, "comment_id": 81025594, "body": "Thank you! I had tried using map, but as &#39;let adjust m = map mod (almostVig m) 26&#39;."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 7, "user_id": 8863154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39b24133e7d9a55e060588a04518f6b?s=128&d=identicon&r=PG&f=1", "display_name": "Lillian Wangler", "link": "https://stackoverflow.com/users/8863154/lillian-wangler"}, "edited": false, "score": 0, "creation_date": 1509467712, "post_id": 47038959, "comment_id": 81027220, "body": "@LillianWangler <code>map</code> only takes 2 parameters, not 3, so that&#39;s why it didn&#39;t work when you wrote it that way."}], "tags": [], "owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "is_accepted": true, "score": 5, "last_activity_date": 1509468455, "last_edit_date": 1509468455, "creation_date": 1509463470, "answer_id": 47038959, "question_id": 47038791, "link": "https://stackoverflow.com/questions/47038791/how-to-apply-mod-to-every-element-in-a-list-in-haskell/47038959#47038959", "title": "How to apply mod to every element in a list in Haskell", "body": "<p>You can use <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:map\" rel=\"nofollow noreferrer\"><code>map</code></a>:</p>\n\n<pre><code>let adjust m = map (`mod` 26) (almostVig m)\n</code></pre>\n\n<p><code>map</code> has type <code>(a -&gt; b) -&gt; [a] -&gt; [b]</code>: it takes a function and applies it to a list element-wise.</p>\n\n<p><code>`mod` 26</code> is partial function application: it turns the function <code>mod</code> to an operator <code>`mod`</code> so that it can be used inline, like <code>128 `mod` 26</code> instead of <code>mod 128 26</code>, and then partially applies the second argument.</p>\n"}], "owner": {"reputation": 7, "user_id": 8863154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b39b24133e7d9a55e060588a04518f6b?s=128&d=identicon&r=PG&f=1", "display_name": "Lillian Wangler", "link": "https://stackoverflow.com/users/8863154/lillian-wangler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1209, "favorite_count": 0, "accepted_answer_id": 47038959, "answer_count": 2, "score": -3, "last_activity_date": 1509501286, "creation_date": 1509462929, "last_edit_date": 1509501286, "question_id": 47038791, "link": "https://stackoverflow.com/questions/47038791/how-to-apply-mod-to-every-element-in-a-list-in-haskell", "title": "How to apply mod to every element in a list in Haskell", "body": "<p>I have a function that produces list of integers to which I would like to apply mod so that no element in the list is greater than 25. For example, the list [6,8,18,28,14,25] should return as [6,8,18,2,14,25]. The code so far is as follows. </p>\n\n<pre><code>let charIntList = zip ['a'..'z'] [0..25]\nlet getIntFromList (x:xs) a = if fst x == a then snd x else getIntFromList xs a\ncharToInt :: Char -&gt; Int\nlet charToInt a = getIntFromList charIntList a\nzipWithPosition :: [Char] -&gt; [(Char, Int)]\nlet zipWithPosition m = zip m [0..length m]\nposition :: [(Char, Int)] -&gt; [Int]\nlet position m = map snd (zipWithPosition m)\nmessToInt :: [Char] -&gt; [Int]\nlet messToInt m = map charToInt m\nalmostVig :: [Int] [Int] -&gt; [Int]\nlet almostVig m = zipWith (+) (messToInt m) (position m)\nadjust :: [Int] -&gt; [Int]\nlet adjust m = (mod (almostVig m) 26)\n</code></pre>\n\n<p>This code fails to apply mod to every element in the list generated by almostVig. I have tried using zipWith in <code>adjust</code> as <code>let adjust m = zipWith (mod (almostVig m) 26)</code>, but that also failed. How can I apply <code>mod</code> to every element in a list to produce a new list in which no element is greater than 25?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1509453267, "post_id": 47035499, "comment_id": 81017260, "body": "You use an <code>if</code>-<code>then</code> without using an <code>else</code>. You should write it as <code>check x = if isDigit x then &#39;a&#39; else x</code>. You use Haskell in an imperative way, but Haskell is a <i>functional</i> language."}], "answers": [{"tags": [], "owner": {"reputation": 1376, "user_id": 7213112, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/933ad5b40bde4c78aef7faa4cd136434?s=128&d=identicon&r=PG&f=1", "display_name": "sidoshi", "link": "https://stackoverflow.com/users/7213112/sidoshi"}, "is_accepted": false, "score": 2, "last_activity_date": 1509462522, "last_edit_date": 1509462522, "creation_date": 1509455879, "answer_id": 47036453, "question_id": 47035499, "link": "https://stackoverflow.com/questions/47035499/remove-digits-from-file/47036453#47036453", "title": "Remove digits from file", "body": "<p>In Haskell, <code>if</code> \u201cstatements\u201d are actually expressions and must return a value. So you need to have an else block.</p>\n\n<pre><code>import Data.Char (isDigit)\n\ncheck x = if isDigit x then 'a' else x\n\nprocess :: String -&gt; String\nprocess = map check\n\nmain :: IO ()\nmain = do\n    contents &lt;- readFile \"input1.txt\"\n    putStr (process contents)\n</code></pre>\n\n<p>Also, if you want to <em>remove</em> the digits, then <code>filter</code> is a better option than using <code>map check</code>. So you can refactor process to </p>\n\n<pre><code>process :: String -&gt; String\nprocess = filter (not . isDigit)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8638529"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1509462522, "creation_date": 1509453094, "last_edit_date": 1509453382, "question_id": 47035499, "link": "https://stackoverflow.com/questions/47035499/remove-digits-from-file", "title": "Remove digits from file", "body": "<p>I'm trying to create new file without digits in strings</p>\n\n<pre><code>main :: IO ()\nmain = do\n    contents &lt;- readFile \"input1.txt\"\n    putStr (process contents)\n\ncheck = if isDigit x\n            x = \"a\"\n\nprocess :: String -&gt; String         \nprocess = map check\n</code></pre>\n\n<p>but getting that error: \"Syntax error in expression (unexpected symbol \"process\")\". What am I doing wrong?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1509448516, "post_id": 47033937, "comment_id": 81014224, "body": "No, it always calls it on the <b>first</b> member of the group. So it compares <code>-3</code> with <code>5</code>."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1509448538, "post_id": 47033937, "comment_id": 81014238, "body": "I tried to fix up your formatting. You should indent to format longer code pieces. Backticks are only really good for very small chunks."}, {"owner": {"reputation": 1376, "user_id": 7213112, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/933ad5b40bde4c78aef7faa4cd136434?s=128&d=identicon&r=PG&f=1", "display_name": "sidoshi", "link": "https://stackoverflow.com/users/7213112/sidoshi"}, "edited": false, "score": 0, "creation_date": 1509448801, "post_id": 47033937, "comment_id": 81014375, "body": "Oh! okay. Thank you for explanation and for the tip about indention."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509451736, "post_id": 47033937, "comment_id": 81016275, "body": "What is the point of multiplying each number by 1 before comparing them?"}, {"owner": {"reputation": 1376, "user_id": 7213112, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/933ad5b40bde4c78aef7faa4cd136434?s=128&d=identicon&r=PG&f=1", "display_name": "sidoshi", "link": "https://stackoverflow.com/users/7213112/sidoshi"}, "edited": false, "score": 0, "creation_date": 1509451973, "post_id": 47033937, "comment_id": 81016406, "body": "I multiplied it by 1 while I was trying to understand how <code>on</code> works. I have edited the question to avoid confusion."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1509449290, "post_id": 47034144, "comment_id": 81014656, "body": "I wonder if that behavior is guaranteed by the libraries or is an incident of its implementation. The docs do not specify whether <code>eq</code> must be an equivalence relation. It just refers to an &quot;equality test&quot;. (Maybe one should be conservative and only use an equivalence for <code>eq</code>)"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1509449484, "post_id": 47034144, "comment_id": 81014776, "body": "@chi: I agree, it is probably an implementation detail. I added a note that <code>eq</code> should be an equivalence relation. Thanks for the feedback."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1509449446, "last_edit_date": 1509449446, "creation_date": 1509448889, "answer_id": 47034144, "question_id": 47033937, "link": "https://stackoverflow.com/questions/47033937/evaluation-of-groupby-in-haskell/47034144#47034144", "title": "Evaluation of `groupBy` in haskell", "body": "<p><code>groupBy :: (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]</code> uses the <strong>first member</strong> of the group as reference. So if you write:</p>\n\n<pre><code>groupBy eq (x:x2:x3)\n</code></pre>\n\n<p>it will - if <code>eq x x2</code> is satisfied, call <code>eq x x3</code> to check if <code>x3</code> also belongs to the same group. So the calls are:</p>\n\n<pre><code>arg1 | arg2 | (&gt;) `on` (*1)\n  -5 |   -4 | False\n  -4 |    5 | False\n   5 |    4 | True\n   <b>5</b> |   -2 | True\n   <b>5</b> |   -3 | True\n   <b>5</b> |    2 | True\n   <b>5</b> |    3 | True</code></pre>\n\n<p>We can see this in the <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/src/Data.OldList.html#groupBy\" rel=\"nofollow noreferrer\"><em>source code</em> of <code>groupBy</code></a>:</p>\n\n<blockquote><pre><code>groupBy                 :: (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]\ngroupBy _  []           =  []\ngroupBy eq (x:xs)       =  (x:ys) : groupBy eq zs\n                           where (ys,zs) = span <b>(eq x)</b> xs</code></pre></blockquote>\n\n<p>As you can see, the <code>span</code> takes <code>eq x</code> as predicate, and <code>x</code> is the first member of the group.</p>\n\n<p>The function probably expects <code>a -&gt; a -&gt; Bool</code> to be an <strong>equivalence relation</strong>: an equivalence relation is (1) <em>reflexive</em>; (2) <em>symmetric</em>; and (3) <em>transitive</em>. Your function is not an equivalence relation since it is not reflexive nor symmetric. So you can not (safely) use <code>groupBy</code> with an order relation.</p>\n\n<p>Note: <code>(&gt;) `on` (*1)</code> is equivalent to just <code>(&gt;)</code> because <code>(*1)</code> will return the same number, you only make the function more specific here to only work on <code>Num</code>s, but that is not necessary.</p>\n"}], "owner": {"reputation": 1376, "user_id": 7213112, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/933ad5b40bde4c78aef7faa4cd136434?s=128&d=identicon&r=PG&f=1", "display_name": "sidoshi", "link": "https://stackoverflow.com/users/7213112/sidoshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 47034144, "answer_count": 1, "score": 4, "last_activity_date": 1509451914, "creation_date": 1509448188, "last_edit_date": 1509451914, "question_id": 47033937, "link": "https://stackoverflow.com/questions/47033937/evaluation-of-groupby-in-haskell", "title": "Evaluation of `groupBy` in haskell", "body": "<p>Why does </p>\n\n<pre><code>groupBy (&gt;) [-5,-4,5,4,-2,-3,2,3]\n</code></pre>\n\n<p>evaluate to </p>\n\n<pre><code>[[-5],[-4],[5,4,-2,-3,2,3]]\n</code></pre>\n\n<p>As <code>-3</code> is not greater than <code>2</code> shouldn't it group them differently?\nI expected the result to be </p>\n\n<pre><code>[[-5],[-4],[5,4,-2,-3],[2,3]]\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1509446666, "post_id": 47033325, "comment_id": 81013141, "body": "I think this has nothing to do with the function you show. This works fine on my machine."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 2, "creation_date": 1509446773, "post_id": 47033325, "comment_id": 81013201, "body": "Haskell is indentation-sensitive. Check the code before <code>lucky</code> function."}, {"owner": {"reputation": 719, "user_id": 540718, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/64bb401eff530b423eae58217f2b1362?s=128&d=identicon&r=PG", "display_name": "nemron", "link": "https://stackoverflow.com/users/540718/nemron"}, "edited": false, "score": 1, "creation_date": 1509447132, "post_id": 47033325, "comment_id": 81013424, "body": "Don&#39;t think this is error is related to <code>lucky</code>. Instead I got &quot;Could not deduce (Eq a) arising from the literal \u20187\u2019&quot;. Adding the required constraint fixed it, though."}, {"owner": {"reputation": 719, "user_id": 540718, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/64bb401eff530b423eae58217f2b1362?s=128&d=identicon&r=PG", "display_name": "nemron", "link": "https://stackoverflow.com/users/540718/nemron"}, "edited": false, "score": 0, "creation_date": 1509447311, "post_id": 47033325, "comment_id": 81013523, "body": "Looks like <code>lucky</code>&#39;s definition is the very first in <code>Main.hs</code>. Have you forgotten the <code>module Mood where</code> declaration?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 719, "user_id": 540718, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/64bb401eff530b423eae58217f2b1362?s=128&d=identicon&r=PG", "display_name": "nemron", "link": "https://stackoverflow.com/users/540718/nemron"}, "edited": false, "score": 0, "creation_date": 1509447377, "post_id": 47033325, "comment_id": 81013561, "body": "@NormenM&#252;ller Using <code>module ...</code> is optional. It should work anyway."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1509447519, "post_id": 47033325, "comment_id": 81013636, "body": "The error looks very weird: there&#39;s no <code>=</code> in that line. Maybe your IDE is misconfigured somehow? E.g. it is trying to call <code>ghci</code> instead of <code>ghc</code> or is feeding the wrong code to the compiler? If you manually load your code in GHCi it should work just fine."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 0, "last_activity_date": 1509465708, "creation_date": 1509465708, "answer_id": 47039697, "question_id": 47033325, "link": "https://stackoverflow.com/questions/47033325/what-does-this-haskell-error-parse-error-on-input-mean/47039697#47039697", "title": "What does this Haskell error - parse error on input \u2018=\u2019 mean?", "body": "<p><a href=\"https://hackage.haskell.org/package/base-4.4.0.0/docs/Prelude.html#t:Num\" rel=\"nofollow noreferrer\"><code>Eq</code> used to be a constraint on <code>Num</code></a>:</p>\n\n<pre><code>class (Eq a, Show a) =&gt; Num a where\n</code></pre>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.7.0.0/docs/Prelude.html#t:Num\" rel=\"nofollow noreferrer\">This is no longer the case</a>:</p>\n\n<pre><code>class Num a where\n</code></pre>\n\n<p>As a result, use of equality (including pattern matching, which is implicitly equality) must carry an <code>Eq</code> constraint.</p>\n\n<p>As for your specific error message, I suspect this is a bad IDE integration more than anything, but the change-up of intended behaviors in GHC will cause confusion for other's trying to diagnose and answer your problem if it isn't explicitly taken into account.</p>\n"}, {"tags": [], "owner": {"reputation": 30852, "user_id": 15441, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f5fdef7fa815d59023c2eaa95f274c3f?s=128&d=identicon&r=PG&f=1", "display_name": "hawkeye", "link": "https://stackoverflow.com/users/15441/hawkeye"}, "is_accepted": false, "score": 0, "last_activity_date": 1509538066, "creation_date": 1509538066, "answer_id": 47054449, "question_id": 47033325, "link": "https://stackoverflow.com/questions/47033325/what-does-this-haskell-error-parse-error-on-input-mean/47054449#47054449", "title": "What does this Haskell error - parse error on input \u2018=\u2019 mean?", "body": "<p>The cause of the issue shown was garbage whitespace copied from the PDF that the IDE failed to filter out. \n(Thanks everyone for your assistance). </p>\n"}], "owner": {"reputation": 30852, "user_id": 15441, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f5fdef7fa815d59023c2eaa95f274c3f?s=128&d=identicon&r=PG&f=1", "display_name": "hawkeye", "link": "https://stackoverflow.com/users/15441/hawkeye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "accepted_answer_id": 47039697, "answer_count": 2, "score": 1, "last_activity_date": 1509538066, "creation_date": 1509446428, "last_edit_date": 1509447172, "question_id": 47033325, "link": "https://stackoverflow.com/questions/47033325/what-does-this-haskell-error-parse-error-on-input-mean", "title": "What does this Haskell error - parse error on input \u2018=\u2019 mean?", "body": "<p>I'm running the following code to demonstrate pattern matching from a book:</p>\n\n<pre><code>lucky :: (Num a) =&gt; a -&gt; String\nlucky 7 = \"LUCKY NUMBER SEVEN!\"\nlucky x = \"Sorry, you're out of luck, pal!\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/gI3mU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gI3mU.png\" alt=\"enter image description here\"></a></p>\n\n<p>This gives the following error:</p>\n\n<pre><code>parse error on input \u2018=\u2019\nPerhaps you need a 'let' in a 'do' block?\ne.g. 'let x = 5' instead of 'x = 5'\n</code></pre>\n\n<p>I can see in other similar situations errors like this are caused because the syntax of Haskell change to make older books invalid. </p>\n\n<p>Has the syntax of Haskell changed to make this code invalid since the book was written?</p>\n\n<p>My question is: <strong>What does this Haskell error - parse error on input \u2018=\u2019 mean?</strong></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1509439058, "post_id": 47030517, "comment_id": 81008423, "body": "<code>words</code> has type <code>String -&gt; [String]</code>, but you try apply it to <code>[String]</code>."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1509439402, "post_id": 47030517, "comment_id": 81008606, "body": "The second, your function <code>listStrings</code> has type <code>[String] -&gt; [(String, Int)]</code>, but from your question the type should be <code>[String] -&gt; [String]</code>. So what do you want to do exactly?"}], "answers": [{"comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1509447445, "post_id": 47032354, "comment_id": 81013599, "body": "You may want to use <code>Data.Function</code>&#39;s <code>on</code> instead of repeating <code>length . head . words</code> twice."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1509447677, "post_id": 47032354, "comment_id": 81013734, "body": "Or <code>sortF = comparing (length . head . words)</code>. Still, it is a bit inefficient to recompute that length at every comparison. Also, I&#39;d handle the empty string, which currently triggers a <code>head</code> crash."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 1, "creation_date": 1509451099, "post_id": 47032354, "comment_id": 81015808, "body": "More efficient and correct will be <code>listStrings = sortOn (maybe 0 length . listToMaybe . words)</code>."}], "tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 2, "last_activity_date": 1509449017, "last_edit_date": 1509449017, "creation_date": 1509443559, "answer_id": 47032354, "question_id": 47030517, "link": "https://stackoverflow.com/questions/47030517/sorting-a-list-of-strings-by-the-length-of-first-word/47032354#47032354", "title": "Sorting a list of strings by the length of first word", "body": "<p>Just make it compare the lenth of the first words on it</p>\n\n<pre><code>import Data.List\n\nlistStrings :: [String] -&gt; [String]\nlistStrings = reverse . sortBy sortF \n    where\n        sortF :: String -&gt; String -&gt; Ordering\n        sortF = comparing (length . head . words)\n</code></pre>\n\n<p>Here you have a <a href=\"https://repl.it/N48Z/2\" rel=\"nofollow noreferrer\">live example</a></p>\n"}], "owner": {"reputation": 21, "user_id": 8833329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b3f6a435272e0b4fc7a679d6ac6bd91?s=128&d=identicon&r=PG&f=1", "display_name": "CuriosCoder", "link": "https://stackoverflow.com/users/8833329/curioscoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 857, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1509449017, "creation_date": 1509437036, "last_edit_date": 1509437112, "question_id": 47030517, "link": "https://stackoverflow.com/questions/47030517/sorting-a-list-of-strings-by-the-length-of-first-word", "title": "Sorting a list of strings by the length of first word", "body": "<p>I am trying to Sort a list of Strings by the length of the first word in the strings (if the strings have more than one word) and return a list with the sorted strings. This is the code I have but is giving me errors. Can someone help me, please?</p>\n\n<pre><code>listStrings :: [String] -&gt; [(String, Int)]\nlistStrings  =  map (\\ws -&gt; (head ws , length ws)). group.sort.words\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": true, "score": 2, "last_activity_date": 1509431379, "creation_date": 1509431379, "answer_id": 47029152, "question_id": 47028928, "link": "https://stackoverflow.com/questions/47028928/define-a-value-of-type-tree-corresponding-to-the-diagram/47029152#47029152", "title": "Define a value of type Tree corresponding to the diagram", "body": "<p>You need <code>0</code> instead of <code>'0'</code> (because the type in the definition is <code>Int</code> and <code>'0'</code> doesn't denote an <code>Int</code>) and <code>Leaf</code> instead of <code>leaf</code>. Otherwise correct.</p>\n"}], "owner": {"reputation": 79, "user_id": 7531770, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/23c7cd700565cc3bccc124baf4ef5ac5?s=128&d=identicon&r=PG&f=1", "display_name": "DevTanner", "link": "https://stackoverflow.com/users/7531770/devtanner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 47029152, "answer_count": 1, "score": 0, "last_activity_date": 1509431379, "creation_date": 1509430280, "question_id": 47028928, "link": "https://stackoverflow.com/questions/47028928/define-a-value-of-type-tree-corresponding-to-the-diagram", "title": "Define a value of type Tree corresponding to the diagram", "body": "<p>following this definition of tree data type</p>\n\n<pre><code> data Tree = Leaf Int | Node Int Tree Tree\n</code></pre>\n\n<p>Define a value of type Tree that corresponds to the diagram</p>\n\n<pre><code>       0\n    1    2\n 3   4   5  6\n</code></pre>\n\n<p>t : tree</p>\n\n<p>t =</p>\n\n<p>I'm somewhat confused about the constructor leaf vs node. and The exact structure the question is asking. So there is a constructor Node that creates a node with 2 tree branches and one that just creates a single leaf node correct? does that mean in our definition that the only time 'leaf' is used is at the end and to call node at the beginning? </p>\n\n<pre><code>t = Node '0' \n    (Node '1'\n       (leaf '3')\n       (leaf '4')\n     )\n    (Node '2'\n       (leaf '5')\n       (leaf '6')\n     )\n</code></pre>\n\n<p>typing this out kind of helped me rationalize this ha. Is what I have correct? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1509422164, "post_id": 47027538, "comment_id": 81002342, "body": "Since <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/GHC-Conc.html#v:pseq\" rel=\"nofollow noreferrer\">there&#39;s no documentation for GHC.Conc.pseq</a>, would you mind explaining what it means?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1509422403, "post_id": 47027538, "comment_id": 81002404, "body": "Your code never executes <code>hClose h</code>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1509422564, "post_id": 47027538, "comment_id": 81002441, "body": "Your problem can be reduced to: <code>main :: IO (); main = do (putStrLn &quot;foo&quot;) `pseq` (putStrLn &quot;bar&quot;)</code>"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1509422694, "post_id": 47027538, "comment_id": 81002464, "body": "This isn&#39;t even an issue with <code>pseq</code>. You can try @melpomene&#39;s example with <code>seq</code> instead."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1509422723, "post_id": 47027538, "comment_id": 81002467, "body": "By the way, <code>hGetContents</code> already closes the handle."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 1, "creation_date": 1509422760, "post_id": 47027538, "comment_id": 81002475, "body": "@ChrisMartin <code>parallel</code> re-exports <a href=\"http://hackage.haskell.org/package/parallel-3.2.1.1/docs/Control-Parallel.html#v:pseq\" rel=\"nofollow noreferrer\"><code>pseq</code></a> with some extra docs. :)"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1509422861, "post_id": 47027538, "comment_id": 81002497, "body": "@Alec Ah, thank you. Though I suppose I ought to have known immediately from the type <code>a -&gt; b -&gt; b</code> that it discards its first argument."}], "answers": [{"tags": [], "owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "is_accepted": true, "score": 5, "last_activity_date": 1509422737, "creation_date": 1509422737, "answer_id": 47027721, "question_id": 47027538, "link": "https://stackoverflow.com/questions/47027538/haskell-handle-doesnt-close-properly/47027721#47027721", "title": "Haskell Handle doesn&#39;t close properly", "body": "<p>You should be using <code>Control.Parallel.pseq</code> instead of <code>GHC.Conc.pseq</code> for portability. However, it does not do what you think it does.</p>\n\n<p><code>pseq</code> only forces evaluation to <a href=\"https://wiki.haskell.org/Weak_head_normal_form\" rel=\"noreferrer\">WHNF</a>. For the expression <code>(hClose h) :: IO ()</code>, the WNHF is exactly that - the representation of an <code>IO</code> action. It does <em>not</em> perform the action.</p>\n\n<p>Just take out the <code>pseq</code>. Better yet, use methods like <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/System-IO.html#v:withFile\" rel=\"noreferrer\"><code>withFile</code></a> to avoid manually tracking file open and close.</p>\n\n<pre><code>main = do\n    let fp = \"handleCollision.txt\"\n    l &lt;- withFile fp ReadMode hGetLine\n    func fp\n\nfunc fp = do\n    cont &lt;- readFile fp\n    writeFile ('.':fp) $ unlines $ map (map succ) $ lines cont\n    renameFile ('.':fp) fp\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 2258289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798648dfbec39d2521e475e46a9be76f?s=128&d=identicon&r=PG", "display_name": "cuddlebugCuller", "link": "https://stackoverflow.com/users/2258289/cuddlebugculler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 47027721, "answer_count": 1, "score": 0, "last_activity_date": 1509422737, "creation_date": 1509421350, "last_edit_date": 1509421810, "question_id": 47027538, "link": "https://stackoverflow.com/questions/47027538/haskell-handle-doesnt-close-properly", "title": "Haskell Handle doesn&#39;t close properly", "body": "<pre><code>import GHC.Conc (pseq)\n\nimport System.Directory (removeFile, renameFile)\nimport System.IO\n\nmain :: IO ()\nmain = do\n    let fp = \"handleCollision.txt\"\n    h &lt;- openFile fp ReadMode\n    l &lt;- hGetLine h\n    (hClose h) `pseq` (func fp)\n\nfunc :: FilePath -&gt; IO ()\nfunc fp = do\n    h &lt;- openFile fp ReadMode\n    cont &lt;- hGetContents h\n    chk &lt;- openFile ('.':fp) WriteMode &gt;&gt;= (\\h -&gt; hPutStrLn h (unlines . map (map succ) $ lines cont) &gt;&gt; hClose h)\n    chk `pseq` (hClose h `pseq` removeFile fp)\n    renameFile ('.':fp) fp\n</code></pre>\n\n<p>In the code above, the result of calling main is an error in the attempt to remove the file referred to by fp.</p>\n\n<blockquote>\n  <p>*** Exception: DeleteFile \"handleCollision.txt\": permission denied (The process cannot access the file because it is being used by another process.)</p>\n</blockquote>\n\n<p>If I only call 'func \"handleCollision.txt\"', then no error occurs. Why does the Handle in main seem to collide with the deletion of fp in func despite the fact that 'hClose h' is treated as strict and 'func fp' is treated as lazy?</p>\n"}, {"tags": ["haskell", "haskell-lens", "category-theory", "traversable", "haskell-hedgehog"], "answers": [{"comments": [{"owner": {"reputation": 899, "user_id": 1686629, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/783eacdab4a800eab9d786d5f5911fac?s=128&d=identicon&r=PG", "display_name": "Echo Nolan", "link": "https://stackoverflow.com/users/1686629/echo-nolan"}, "edited": false, "score": 0, "creation_date": 1509485350, "post_id": 47024854, "comment_id": 81036953, "body": "Hmm, interesting. So there&#39;s a corresponding thing, but it doesn&#39;t really fit with the other optics. I wonder if there are a set of &quot;higher order optics&quot; that this does work with."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 899, "user_id": 1686629, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/783eacdab4a800eab9d786d5f5911fac?s=128&d=identicon&r=PG", "display_name": "Echo Nolan", "link": "https://stackoverflow.com/users/1686629/echo-nolan"}, "edited": false, "score": 0, "creation_date": 1509499487, "post_id": 47024854, "comment_id": 81040976, "body": "<code>HTraversable</code> is for objects in the category of functors from the functor category to Hask. You can work with the category of <i>endofunctors</i> on the functor category (such as monad transformers), for which <code>Traversable</code> would look like <code>itraverse :: Applicative f =&gt; (forall x. a x -&gt; f (b x)) -&gt; (forall x. s x -&gt; f (t x))</code>. Traversals of this type do compose with <code>(.)</code>, and you can build out prisms etc too. Neither <code>HTraversable</code> nor <code>ITraversable</code> would interoperate with <code>lens</code>, though, because they&#39;re built on a different category."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 1, "last_activity_date": 1509454178, "last_edit_date": 1509454178, "creation_date": 1509400757, "answer_id": 47024854, "question_id": 47024808, "link": "https://stackoverflow.com/questions/47024808/is-there-a-corresponding-optic-for-higher-order-traversable-functors/47024854#47024854", "title": "Is there a corresponding optic for higher-order traversable functors?", "body": "<p>Sure.</p>\n\n<pre><code>type HTraversal s t a b =\n    forall f. Applicative f =&gt; (forall x. a x -&gt; f (b x)) -&gt; s -&gt; f t\n\nhtraverse :: HTraversable t =&gt; HTraversal (t a) (t b) a b\n</code></pre>\n\n<p>Remember, <code>lens</code>'s <code>Traversal</code> comes about by taking the type of <code>traverse</code> and letting the <code>t a</code> and <code>t b</code> types vary, viewing the traversable not as a polymorphic container but as a monolithic blob.</p>\n\n<p>How useful <code>HTraversal</code> is, I dunno. You can't compose them nicely with <code>(.)</code>.</p>\n"}], "owner": {"reputation": 899, "user_id": 1686629, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/783eacdab4a800eab9d786d5f5911fac?s=128&d=identicon&r=PG", "display_name": "Echo Nolan", "link": "https://stackoverflow.com/users/1686629/echo-nolan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 1, "accepted_answer_id": 47024854, "answer_count": 1, "score": 3, "last_activity_date": 1515883262, "creation_date": 1509400528, "last_edit_date": 1515883262, "question_id": 47024808, "link": "https://stackoverflow.com/questions/47024808/is-there-a-corresponding-optic-for-higher-order-traversable-functors", "title": "Is there a corresponding optic for higher-order traversable functors?", "body": "<p><a href=\"https://github.com/hedgehogqa/haskell-hedgehog\" rel=\"nofollow noreferrer\">Hedgehog</a> has an <code>HTraversable</code> class defined like this:</p>\n\n<pre><code>-- | Higher-order traversable functors.\n--\nclass HTraversable t where\n  htraverse :: Applicative f =&gt; (forall a. g a -&gt; f (h a)) -&gt; t g -&gt; f (t h)\n</code></pre>\n\n<p>Which is used with their <a href=\"https://www.stackage.org/haddock/lts-9.2/hedgehog-0.5/Hedgehog.html#t:Var\" rel=\"nofollow noreferrer\"><code>Var</code></a> type for parameterizing a type over whether values are concrete or abstract. <code>t</code> has kind <code>(* -&gt; *) -&gt; *</code> and is a higher order functor although they don't actually have that class, <code>f</code>, <code>g</code> and <code>h</code> have kind <code>* -&gt; *</code>. I've seen the same thing defined in a few different libraries.</p>\n\n<p>Is there a way to get an optic out of this? I confess I don't know what that would even do, and I'm not super comfortable with lenses or regular <code>Traversable</code> either.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 5, "creation_date": 1509399919, "post_id": 47024544, "comment_id": 80996416, "body": "What are you trying to do exactly? The fact that you want to write a getter for an existentially quantified type suggests to me that you didn&#39;t really want an existential in the first place."}, {"owner": {"reputation": 693, "user_id": 7564554, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-h7KkTmgJty0/AAAAAAAAAAI/AAAAAAAAAAo/ZFEGeg_bQ6Y/photo.jpg?sz=128", "display_name": "Eben Kadile", "link": "https://stackoverflow.com/users/7564554/eben-kadile"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1509403781, "post_id": 47024544, "comment_id": 80997856, "body": "What I want is a single type that takes any integral data type for its fields"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509404247, "post_id": 47024544, "comment_id": 80998010, "body": "and you&#39;ve got it, but what type should your getters produce? a consumer (caller) expects a certain Integral type, not &quot;any Integral&quot; type."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1509404492, "post_id": 47024544, "comment_id": 80998097, "body": "@EbenCowley <a href=\"https://stackoverflow.com/questions/12770278/typeclass-constraints-on-data-declarations\">Don\u2019t try to put constraints on datatypes</a>"}, {"owner": {"reputation": 693, "user_id": 7564554, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-h7KkTmgJty0/AAAAAAAAAAI/AAAAAAAAAAo/ZFEGeg_bQ6Y/photo.jpg?sz=128", "display_name": "Eben Kadile", "link": "https://stackoverflow.com/users/7564554/eben-kadile"}, "edited": false, "score": 0, "creation_date": 1509404888, "post_id": 47024544, "comment_id": 80998208, "body": "Hm alright I see the issue now"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1509475306, "post_id": 47024544, "comment_id": 81031915, "body": "One thing you can do in a situation like this is use <code>RankNTypes</code> to write <code>withSimplices :: Chain -&gt; (forall a. Integral a =&gt; [[a]] -&gt; r) -&gt; r; withSimplices (Chain ss _ _ _) k = k ss</code>. That is, within the function <code>k</code> you have access to the hidden type <code>a</code>, as long as 1. you use it in a fully polymorphic way (only depending on the fact that it\u2019s <code>Integral</code>), and 2. the result type <code>r</code> doesn\u2019t mention <code>a</code> (or else <code>a</code> would be used outside the scope of the <code>forall</code>). An existential isn\u2019t what you want here, but this is a useful thing to know about when you do need an existential."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509404067, "post_id": 47024731, "comment_id": 80997954, "body": "it&#39;s common to expect, in other languages, an automatic conversion in such situations where the source and the target types are known (even if it weren&#39;t forgotten by <code>Chain</code>). But Haskell does no implicit conversions, ever. (IIRC)."}, {"owner": {"reputation": 693, "user_id": 7564554, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-h7KkTmgJty0/AAAAAAAAAAI/AAAAAAAAAAo/ZFEGeg_bQ6Y/photo.jpg?sz=128", "display_name": "Eben Kadile", "link": "https://stackoverflow.com/users/7564554/eben-kadile"}, "edited": false, "score": 0, "creation_date": 1509404423, "post_id": 47024731, "comment_id": 80998073, "body": "Realistically doing this would be fine because this is a personal project and I know that <code>Chain</code> will never act on a non-integral type. But The point of asking this question was because I wanted to know how to do this with the extra safety of the <code>Integral</code> typeclass."}, {"owner": {"reputation": 693, "user_id": 7564554, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-h7KkTmgJty0/AAAAAAAAAAI/AAAAAAAAAAo/ZFEGeg_bQ6Y/photo.jpg?sz=128", "display_name": "Eben Kadile", "link": "https://stackoverflow.com/users/7564554/eben-kadile"}, "edited": false, "score": 0, "creation_date": 1509404937, "post_id": 47024731, "comment_id": 80998220, "body": "Due to the comment by Benjamin Hodgson I&#39;m accepting this as the best solution"}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 7, "last_activity_date": 1509403935, "last_edit_date": 1509403935, "creation_date": 1509400156, "answer_id": 47024731, "question_id": 47024544, "link": "https://stackoverflow.com/questions/47024544/how-to-write-getters-for-existential-types-in-haskell/47024731#47024731", "title": "How to write getters for existential types in Haskell", "body": "<p>What type do you suppose <code>getSimplices</code> should have? The \"obvious\" choice is</p>\n\n<pre><code>getSimplices :: Integral a =&gt; Chain -&gt; [[a]]\n</code></pre>\n\n<p>But this doesn't work with your implementation, because the caller  of <code>getSimplices</code> gets to choose the <code>a</code>, and there's no guarantee that the values stored in the <code>Chain</code> are of the same type that the caller wants, since you threw that information away. Consider:</p>\n\n<pre><code>let c = Chain [[1 :: Int]] [2] 3 4\nin (getSimplices c) :: [[Integer]]\n</code></pre>\n\n<p>This is clearly allowed by your two type signatures which promise to work for any Integral type, but also clearly cannot work without some conversion: the <code>Int</code>s have to be turned into <code>Integer</code>s somehow.</p>\n\n<p>As the comments say, this is rather unusual. It would be much simpler to add a type parameter to Chain, so that it tracks the type you used to create it, and constrains its output to that type as well:</p>\n\n<pre><code>data Chain a = Chain [[a]] [a] a a\n\ngetSimplices :: Chain a -&gt; [[a]]\ngetSimplices (Chain xs _ _ _) = xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1509403300, "post_id": 47024781, "comment_id": 80997694, "body": "nice. also, if OP&#39;s <code>getSimplices</code> were possible, what about <code>map getSimplices</code> then? each <code>Chain</code> in that argument list could be built from <i>anything</i> as long as it&#39;s an <code>Integral</code>, but <code>map</code> must produce values of the <i>same</i> type for all of them."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 8, "last_activity_date": 1509400376, "creation_date": 1509400376, "answer_id": 47024781, "question_id": 47024544, "link": "https://stackoverflow.com/questions/47024544/how-to-write-getters-for-existential-types-in-haskell/47024781#47024781", "title": "How to write getters for existential types in Haskell", "body": "<p>The constructor of an existential type necessarily \"forgets\" about <code>a</code>:</p>\n\n<pre><code>Chain :: Integral a =&gt; [[a]] -&gt; [[a]] -&gt; a -&gt; a -&gt; Chain\n</code></pre>\n\n<p>Note how the resulting type no longer depends on <code>a</code>.</p>\n\n<p>A consequence of this is that, when we pattern match on <code>Chain</code>, we can not make any assumption about what <code>a</code> is. After all we could have chosen anything when constructing. The only knowledge we have on <code>a</code> is that it must be an integral type. Hence, we can only access using the methods of the <code>Integral</code> type class.</p>\n\n<p>The general rule is that, when we pattern match on <code>Chain</code>, we must return a value of a type which does <em>not</em> depend on <code>a</code>. A getter like</p>\n\n<pre><code>getter (Chain _ _ x _) = x\n</code></pre>\n\n<p>violate that rule. After all, what type would that have?</p>\n\n<pre><code>getter :: Chain -&gt; ???\n</code></pre>\n\n<p>Surely not</p>\n\n<pre><code>getter :: Chain -&gt; a\n</code></pre>\n\n<p>which would instead mean that we can extract any type we wish from <code>Chain</code>. This can not realistically work: we can't be free to choose what type to put in, and then be also free to choose what type to take out.</p>\n\n<p>What we can do, however, is to exploit <code>Integral</code>:</p>\n\n<pre><code>getter :: Chain -&gt; Integer\ngetter (Chain _ _ x _) = fromIntegral x\n</code></pre>\n\n<p><code>Integer</code> does not depend on <code>a</code>, so it is OK.</p>\n"}], "owner": {"reputation": 693, "user_id": 7564554, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-h7KkTmgJty0/AAAAAAAAAAI/AAAAAAAAAAo/ZFEGeg_bQ6Y/photo.jpg?sz=128", "display_name": "Eben Kadile", "link": "https://stackoverflow.com/users/7564554/eben-kadile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 47024731, "answer_count": 2, "score": 2, "last_activity_date": 1509403935, "creation_date": 1509399334, "question_id": 47024544, "link": "https://stackoverflow.com/questions/47024544/how-to-write-getters-for-existential-types-in-haskell", "title": "How to write getters for existential types in Haskell", "body": "<p>Thanks to the answer to <a href=\"https://stackoverflow.com/questions/39143379/functions-to-polymorphic-data-types\">this question</a> I've defined a type like so:</p>\n\n<pre><code>data Chain = forall a. Integral a =&gt; Chain [[a]] [a] a a\n</code></pre>\n\n<p>I need to write a getter function for each field, or argument if you like. Here's my first attempt:</p>\n\n<pre><code>getSimplices (Chain simplices _ _ _) = simplices\n</code></pre>\n\n<p>But when I try to compile ghc gives the following error:</p>\n\n<pre><code>Chain.hs:10:40: error:\n\u2022 Couldn't match expected type \u2018t\u2019 with actual type \u2018[[a]]\u2019\n    because type variable \u2018a\u2019 would escape its scope\n  This (rigid, skolem) type variable is bound by\n    a pattern with constructor:\n      Chain :: forall a. Integral a =&gt; [[a]] -&gt; [a] -&gt; a -&gt; a -&gt; Chain,\n    in an equation for \u2018getSimplices\u2019\n    at Chain.hs:10:15-35\n\u2022 In the expression: simplices\n  In an equation for \u2018getSimplices\u2019:\n      getSimplices (Chain simplices _ _ _) = simplices\n\u2022 Relevant bindings include\n    simplices :: [[a]] (bound at Chain.hs:10:21)\n    getSimplices :: Chain -&gt; t (bound at Chain.hs:10:1)\n</code></pre>\n\n<p>I fixed it like this:</p>\n\n<pre><code>getSimplices (Chain simplices _ _ _) = map (map fromIntegral) simplices\n</code></pre>\n\n<p>Even if some kind of ghc magic prevents this from being obscenely slow for a getter, I think fixing something this way is just atrocious. Is there a better way to define getters for types like this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509385523, "post_id": 47021286, "comment_id": 80989435, "body": "<code>x zip y</code>? <code>zip</code> is just an ordinary function."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1509399624, "post_id": 47021286, "comment_id": 80996305, "body": "n.b. that <code>(\\(a,b) -&gt; a + b)</code> is just <code>(uncurry (+))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5932985, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b5e649739640c02df1c12ef3069affbd?s=128&d=identicon&r=PG&f=1", "display_name": "STRAN", "link": "https://stackoverflow.com/users/5932985/stran"}, "edited": false, "score": 0, "creation_date": 1509385951, "post_id": 47021361, "comment_id": 80989673, "body": "I changed it to (zip x y) and it still gave me the error. I am using repl.it as my compiler since my school&#39;s computers don&#39;t have Haskell installed. Could that be the source of the error?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 71, "user_id": 5932985, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b5e649739640c02df1c12ef3069affbd?s=128&d=identicon&r=PG&f=1", "display_name": "STRAN", "link": "https://stackoverflow.com/users/5932985/stran"}, "edited": false, "score": 1, "creation_date": 1509386052, "post_id": 47021361, "comment_id": 80989725, "body": "@STRAN: probably not. I can not reproduce the error with the correct <code>zipmap</code> on repl.it. Can you share a link to your repl?"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1509385769, "creation_date": 1509385769, "answer_id": 47021361, "question_id": 47021286, "link": "https://stackoverflow.com/questions/47021286/problems-with-haskell-variable-scope-error-and-creating-a-proper-type-declaratio/47021361#47021361", "title": "Problems with Haskell variable scope error and creating a proper type declaration", "body": "<p>My guess is that there are already errors when you <em>define</em> the function. Since you fail to define the <code>zipmap</code> function, the interactive shell assumes nothing happened, and thus it does not know about a function <code>zipmap</code> later in the process. For example:</p>\n\n<pre><code>$ ghci\nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\nPrelude> zipmap :: [Int]->[Int]->[Int]; zipmap x y = map (\\(a,b) -> a + b) (x zip y)\n\n<b>&lt;interactive&gt;:1:68: error:\n    \u2022 Couldn't match expected type \u2018([a0] -&gt; [b0] -&gt; [(a0, b0)])\n                                    -&gt; [Int] -&gt; [(Int, Int)]\u2019\n                  with actual type \u2018[Int]\u2019\n    \u2022 The function \u2018x\u2019 is applied to two arguments,\n      but its type \u2018[Int]\u2019 has none\n      In the second argument of \u2018map\u2019, namely \u2018(x zip y)\u2019\n      In the expression: map (\\ (a, b) -&gt; a + b) (x zip y)</b>\nPrelude&gt; zipmap [1,2,3] [1,4,2,5]\n\n&lt;interactive&gt;:2:1: error:\n    Variable not in scope: zipmap :: [Integer] -&gt; [Integer] -&gt; t</code></pre>\n\n<p>Note the part in boldface: the interpreter says it does not understand what you say, so it can not proceed with that. Then later if we use <code>zipmap</code>, it raises the same error like the one you describe.</p>\n\n<p>Your <code>zipmap</code> function is wrong since you write:</p>\n\n<pre><code>x zip y\n</code></pre>\n\n<p><code>zip :: [a] -&gt; [b] -&gt; [(a,b)]</code> is a function, not an operator, so you should use it as:</p>\n\n<pre><code>zip x y\n</code></pre>\n\n<p>Or in full:</p>\n\n<pre><code>zipmap :: [Int] -&gt; [Int] -&gt; [Int]\nzipmap x y = map (\\(a,b) -&gt; a + b) (zip x y)\n</code></pre>\n\n<p>We can further improve this: there is a <code>zipWith :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]</code> function:</p>\n\n<pre><code>zipmap :: [Int] -&gt; [Int] -&gt; [Int]\nzipmap x y = zipWith (+) x y\n</code></pre>\n\n<p>or even shorter:</p>\n\n<pre><code>zipmap :: [Int] -&gt; [Int] -&gt; [Int]\nzipmap = zipWith (+)\n</code></pre>\n\n<p>and finally we can generalize our function:</p>\n\n<pre><code>zipmap :: Num a =&gt; [a] -&gt; [a] -&gt; [a]\nzipmap = zipWith (+)\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5932985, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b5e649739640c02df1c12ef3069affbd?s=128&d=identicon&r=PG&f=1", "display_name": "STRAN", "link": "https://stackoverflow.com/users/5932985/stran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 47021361, "answer_count": 1, "score": -2, "last_activity_date": 1509525708, "creation_date": 1509385488, "last_edit_date": 1509525708, "question_id": 47021286, "link": "https://stackoverflow.com/questions/47021286/problems-with-haskell-variable-scope-error-and-creating-a-proper-type-declaratio", "title": "Problems with Haskell variable scope error and creating a proper type declaration", "body": "<p>In most of my functions, I seem to get the common error of \"Variable not in scope\"\nFor example this function</p>\n\n<pre><code>zipmap :: [Int]-&gt;[Int]-&gt;[Int]\nzipmap x y = map (\\(a,b) -&gt; a + b) (x zip y)\n</code></pre>\n\n<p>would give me \"Variable not in scope: zipmap :: [Integer] -> [Integer] -> t\"</p>\n\n<p>Why is this happening, and for future reference what can I do to avoid these errors?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1509386158, "post_id": 47020908, "comment_id": 80989771, "body": "As the quote in your question clearly states, the desired semantics are implemented by the OS, so if you want to access it directly, you&#39;ll need to use the FFI (and re-write all the cross platform compatibility code yourself). &quot;We could run it and catch an exception but that&#39;s poor&quot; - there&#39;s nothing wrong with this approach, and it seems by far the simplest one. (If you want your program to be robust you should probably handle exceptions from external programs anyways)."}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 10, "creation_date": 1509386621, "post_id": 47020908, "comment_id": 80990012, "body": "If the intention is to run it anyway, I think that trying to run it and catching the exception is the <i>ideal</i> solution - you have to handle that case regardless as there&#39;s the risk of the state changing between the existence check and the execution."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1509390090, "post_id": 47020908, "comment_id": 80991861, "body": "Have you had a look at <a href=\"https://hackage.haskell.org/package/shake-0.16/docs/Development-Shake-Command.html\" rel=\"nofollow noreferrer\">shake: command</a>? I use it mostly as an alternative to shell scripts"}, {"owner": {"reputation": 2861, "user_id": 2847643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PmATO.jpg?s=128&g=1", "display_name": "user2847643", "link": "https://stackoverflow.com/users/2847643/user2847643"}, "reply_to_user": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 2, "creation_date": 1509471057, "post_id": 47020908, "comment_id": 81029349, "body": "@ryachza Exactly! Check if a file exists = you know it <i>existed</i> at a discrete point in time when the syscall was executed. 1us later your check is worthless in the sense you cannot take it as a given that it sill exits - your code needs to handle exceptions however you approach this."}, {"owner": {"reputation": 1946, "user_id": 1432740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a84709030a711eb919bec460051eac8?s=128&d=identicon&r=PG", "display_name": "Mateusz Kowalczyk", "link": "https://stackoverflow.com/users/1432740/mateusz-kowalczyk"}, "edited": false, "score": 0, "creation_date": 1509554867, "post_id": 47020908, "comment_id": 81066951, "body": "For my use-case, the binary was expected to be on read-only file system. I was writing some executable and it allowed the user to specify the path of the command to run. I also wanted to show the &quot;default&quot; chosen path if the user failed to provide an explicit choice. So you&#39;re right that the check may be worthless in many scenarios but not all. Think for example about <code>.&#47;configure</code>: it finds the paths of build dependencies and ensures they are there, before it runs. Running <code>shoot-missiles</code> to check that it exists is not really acceptable in all cases."}], "answers": [{"tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": true, "score": 5, "last_activity_date": 1509539170, "creation_date": 1509539170, "answer_id": 47054823, "question_id": 47020908, "link": "https://stackoverflow.com/questions/47020908/programmatically-check-if-executable-exists-without-running-it-or-using-which/47054823#47054823", "title": "Programmatically check if executable exists without running it or using `which`", "body": "<p>Looks like you want <code>findExecutable</code> function from <a href=\"https://hackage.haskell.org/package/directory-1.3.1.5/docs/System-Directory.html#v:findExecutable\" rel=\"noreferrer\">here</a>.</p>\n\n<pre><code>Prelude System.Directory&gt; findExecutable \"gcc\"\nJust \"/usr/bin/gcc\"\n</code></pre>\n"}], "owner": {"reputation": 1946, "user_id": 1432740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a84709030a711eb919bec460051eac8?s=128&d=identicon&r=PG", "display_name": "Mateusz Kowalczyk", "link": "https://stackoverflow.com/users/1432740/mateusz-kowalczyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 1, "accepted_answer_id": 47054823, "answer_count": 1, "score": 10, "last_activity_date": 1509539170, "creation_date": 1509384040, "last_edit_date": 1509384551, "question_id": 47020908, "link": "https://stackoverflow.com/questions/47020908/programmatically-check-if-executable-exists-without-running-it-or-using-which", "title": "Programmatically check if executable exists without running it or using `which`", "body": "<p>We can run a process <code>foo</code> with help of <code>System.Process.proc</code> as follows:</p>\n\n<pre><code>createProcess $ proc \"foo\" []\n</code></pre>\n\n<p>However we do not know ahead of time whether <code>foo</code> can be found. We could run it and catch an exception but that's poor. We could also first call out to <code>which</code> but that also sucks. In the <code>process</code> library we find <a href=\"https://hackage.haskell.org/package/process-1.6.1.0/docs/System-Process.html#v:RawCommand\" rel=\"noreferrer\"><code>RawCommand</code></a> which as of today says</p>\n\n<blockquote>\n  <p>The FilePath argument names the executable, and is interpreted\n  according to the platform's standard policy for searching for\n  executables. Specifically:</p>\n  \n  <ul>\n  <li><p>on Unix systems the execvp(3) semantics is used, where if the executable filename does not contain a slash (/) then the PATH\n  environment variable is searched for the executable.</p></li>\n  <li><p>on Windows systems\n  the Win32 CreateProcess semantics is used. Briefly: if the filename\n  does not contain a path, then the directory containing the parent\n  executable is searched, followed by the current directory, then some\n  standard locations, and finally the current PATH. An .exe extension is\n  added if the filename does not already have an extension. For full\n  details see the documentation for the Windows SearchPath API.</p></li>\n  </ul>\n</blockquote>\n\n<p>This is precisely what I would like to do but there doesn't seem to be any exposed functionality that does it. Am I just missing it, is there a more canonical/better way or do I have to dig through <code>process</code> internals? The solution should be portable (Windows/Linux).</p>\n"}, {"tags": ["haskell", "operand"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 5, "creation_date": 1509381129, "post_id": 47020067, "comment_id": 80986816, "body": "I think this is the monomorphism restriction biting you."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1509382558, "post_id": 47020067, "comment_id": 80987609, "body": "What does <code>max x</code> mean? <code>max</code> takes two arguments, not one. This code doesn&#39;t make sense."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 3, "last_activity_date": 1509383550, "last_edit_date": 1509383550, "creation_date": 1509383226, "answer_id": 47020685, "question_id": 47020067, "link": "https://stackoverflow.com/questions/47020067/no-instance-for-ord-a0-arising-from-a-use-of-max/47020685#47020685", "title": "No instance for (Ord a0) arising from a use of `max&#39;", "body": "<p>Your problem is that <code>max</code> takes two arguments, not one.</p>\n\n<p>Let's inspect the signature of <code>.</code>:</p>\n\n<pre><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)\n</code></pre>\n\n<p>We clearly see that these take functions that take one argument and 'chain' them together.</p>\n\n<p>Now let's have a look at <code>max</code>:</p>\n\n<pre><code>max :: (Ord a) =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>This is a function that takes two arguments, or in other words takes one argument, then returns <em>another function</em>. So, for instance, <code>max 1 :: Int -&gt; Int</code>.</p>\n\n<p>Now let's take a look at <code>g . h</code>, a part of the function you're trying to write:</p>\n\n<pre><code>  f . g\n= (^2) . max\n= \\a -&gt; (max a)^2\n</code></pre>\n\n<p>Then we have a problem: <code>max a</code> is a function, not a floating point value. Hence the compiler complains. This is equivalent to trying to compute <code>map^2</code> or <code>reverse^2</code>; it's completely nonsensical.</p>\n\n<hr>\n\n<p>Unfortunately you have not stated what <code>strangeMaths</code> should actually do, so I can't tell you how you should write it. However, there are a few ways to solve the issue:</p>\n\n<ul>\n<li>Rewrite <code>h</code> as <code>max 1</code> (instead of <code>max</code>), or some other similar value.</li>\n<li>Rewrite <code>strangeMaths</code> as <code>(.) (f . g) . h</code>.</li>\n<li>Write a <code>Floating</code> instance for functions of the form <code>a -&gt; a</code>. (I don't know how or why you would do this, but it's possible.)</li>\n</ul>\n\n<p>I suspect that the second case is true, as this would mean that <code>strangeMaths x y = logBase 2 ((max x y)^2)</code>, which makes a lot more sense.</p>\n"}], "owner": {"reputation": 41, "user_id": 7713315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/100ea143a1e1b050c3c5f1d5d42f8094?s=128&d=identicon&r=PG&f=1", "display_name": "\u0414\u0435\u043d\u0438\u0441 \u0413\u0440\u0430\u0447\u0435\u0432", "link": "https://stackoverflow.com/users/7713315/%d0%94%d0%b5%d0%bd%d0%b8%d1%81-%d0%93%d1%80%d0%b0%d1%87%d0%b5%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509383550, "creation_date": 1509381004, "last_edit_date": 1509383530, "question_id": 47020067, "link": "https://stackoverflow.com/questions/47020067/no-instance-for-ord-a0-arising-from-a-use-of-max", "title": "No instance for (Ord a0) arising from a use of `max&#39;", "body": "<p>I'm new to haskell, and i'm trying to use operand .</p>\n\n<p>function strangeMaths has to be smth like logBase 2 ((max x)^3) but using 3 functions and operand . \nso i did this code</p>\n\n<pre><code>strangeMaths = f . g . h\n\nf = logBase 2 \n\ng = (^3)\n\nh = max\n</code></pre>\n\n<p>but this gives me an error:</p>\n\n<pre><code>No instance for (Ord a0) arising from a use of `max'\n    The type variable `a0' is ambiguous\n    Relevant bindings include\n      h :: a0 -&gt; a0 -&gt; a0 (bound at 14)doItYourSelf.hs:7:1)\n    Note: there are several potential instances:\n      instance Integral a =&gt; Ord (GHC.Real.Ratio a)\n        -- Defined in `GHC.Real'\n      instance Ord () -- Defined in `GHC.Classes'\n      instance (Ord a, Ord b) =&gt; Ord (a, b) -- Defined in `GHC.Classes'\n      ...plus 23 others\n    In the expression: max\n    In an equation for `h': h = max\nFailed, modules loaded: none.\n</code></pre>\n\n<p>P.S. i know that log (a, b^c) = c*log (a, b) but this is an example. </p>\n"}, {"tags": ["list", "haskell", "tuples"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 7066862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d70972b971aef9aab1a5351bbeb7a75?s=128&d=identicon&r=PG&f=1", "display_name": "David Andvett", "link": "https://stackoverflow.com/users/7066862/david-andvett"}, "edited": false, "score": 0, "creation_date": 1509382309, "post_id": 47020093, "comment_id": 80987473, "body": "i like the list comprehension better, it looks easier to understand.  Thanks"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 123, "user_id": 7066862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d70972b971aef9aab1a5351bbeb7a75?s=128&d=identicon&r=PG&f=1", "display_name": "David Andvett", "link": "https://stackoverflow.com/users/7066862/david-andvett"}, "edited": false, "score": 0, "creation_date": 1509384841, "post_id": 47020093, "comment_id": 80989011, "body": "@DavidAndvett: like the French say: &quot;<i>des go&#251;ts et des couleurs, on ne discute pas</i>&quot;, so that is of course up to you :)"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1509384131, "last_edit_date": 1509384131, "creation_date": 1509381093, "answer_id": 47020093, "question_id": 47020057, "link": "https://stackoverflow.com/questions/47020057/how-to-convert-a-list-of-tuples-into-a-regular-list-in-haskell/47020093#47020093", "title": "How to convert a list of tuples into a regular list in haskell?", "body": "<p>The only extra step you need to take is to <strong><code>concat</code>enate the lists</strong>, with:</p>\n\n<pre><code>concat (map (\\(x,y) -&gt; [x,y]) [(1,4),(2,5)])\n</code></pre>\n\n<p>here <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:concat\" rel=\"nofollow noreferrer\"><strong><code>concat :: [[a]] -&gt; [a]</code></strong></a> thus concatenates the list of lists together into a single list.</p>\n\n<p>Since such constructions occur often, there is a function that makes it more convenient: <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:concatMap\" rel=\"nofollow noreferrer\"><strong><code>concatMap :: (a -&gt; [b]) -&gt; [a] -&gt; [b]</code></strong></a>:</p>\n\n<pre><code>concatMap (\\(x,y) -&gt; [x,y]) [(1,4),(2,5)]\n</code></pre>\n\n<p>You can also use <a href=\"https://wiki.haskell.org/List_comprehension\" rel=\"nofollow noreferrer\"><strong>list comprehension</strong></a>, and write it like:</p>\n\n<pre><code>[z | (x,y) &lt;- data, z &lt;- [x,y]]\n</code></pre>\n\n<p>where <code>data</code> is your list of initial data.</p>\n"}, {"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1509387056, "post_id": 47021316, "comment_id": 80990214, "body": "Out of curiosity: how do you pronounce <code>&gt;&gt;=</code>?"}, {"owner": {"reputation": 669, "user_id": 3406750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b1de70b0e9078f2a462eed59aff2159?s=128&d=identicon&r=PG&f=1", "display_name": "Teodor", "link": "https://stackoverflow.com/users/3406750/teodor"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 2, "creation_date": 1509387353, "post_id": 47021316, "comment_id": 80990352, "body": "<code>&gt;&gt;=</code> is usually pronounced <i>bind</i>, according to <a href=\"http://www.learnyouahaskell.com/a-fistful-of-monads\" rel=\"nofollow noreferrer\">Learn You a Haskell</a>. I tend to think of it as the <i>stuff into</i>-operator."}], "tags": [], "owner": {"reputation": 669, "user_id": 3406750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b1de70b0e9078f2a462eed59aff2159?s=128&d=identicon&r=PG&f=1", "display_name": "Teodor", "link": "https://stackoverflow.com/users/3406750/teodor"}, "is_accepted": false, "score": 5, "last_activity_date": 1509521255, "last_edit_date": 1509521255, "creation_date": 1509385590, "answer_id": 47021316, "question_id": 47020057, "link": "https://stackoverflow.com/questions/47020057/how-to-convert-a-list-of-tuples-into-a-regular-list-in-haskell/47021316#47021316", "title": "How to convert a list of tuples into a regular list in haskell?", "body": "<p>What you are describing is a common Haskell pattern!</p>\n\n<ol>\n<li>Take a list</li>\n<li>Use a function that generates lists for each element </li>\n<li>Join into a single list.</li>\n</ol>\n\n<p>It doesn't have to be a list,</p>\n\n<ol>\n<li>Take a container</li>\n<li>Use a function that generates a new container for each element</li>\n<li>Join the containers.</li>\n</ol>\n\n<p>For the list case, this function's type would be</p>\n\n<pre><code>[a] -&gt; (a -&gt; [a]) -&gt; [a]\n</code></pre>\n\n<p>Let's call a container of <code>a</code>'s <code>m a</code>, where <code>m</code> is the container type. In this case, we would have</p>\n\n<pre><code>m a -&gt; (a -&gt; m a) -&gt; m a\n</code></pre>\n\n<p>This function is <code>&gt;&gt;=</code>! We use it as an infix operator.</p>\n\n<pre><code>Prelude&gt; [(1,4),(2,5)] &gt;&gt;= \\(x,y) -&gt; [x,y]\n[1,4,2,5]\n</code></pre>\n\n<p>... where the container has to support \"collapsing\" two layers into one layer. This is a monad :)</p>\n\n<p><code>a &gt;&gt;= f</code> is the same as <code>concatMap f a</code>, as suggested by Willem Van Onsem.</p>\n"}], "owner": {"reputation": 123, "user_id": 7066862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d70972b971aef9aab1a5351bbeb7a75?s=128&d=identicon&r=PG&f=1", "display_name": "David Andvett", "link": "https://stackoverflow.com/users/7066862/david-andvett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1939, "favorite_count": 0, "accepted_answer_id": 47020093, "answer_count": 2, "score": 1, "last_activity_date": 1509521255, "creation_date": 1509380954, "last_edit_date": 1509452537, "question_id": 47020057, "link": "https://stackoverflow.com/questions/47020057/how-to-convert-a-list-of-tuples-into-a-regular-list-in-haskell", "title": "How to convert a list of tuples into a regular list in haskell?", "body": "<p>I'd like to convert a list of tuples <code>(a,a)</code> into just a list of <code>a</code>s. This is what i have so far</p>\n\n<pre><code>map (\\(x,y) -&gt; [x,y]) [(1,4),(2,5)] \n&gt; [[1,4],[2,5]]\n</code></pre>\n\n<p>but what i want is</p>\n\n<pre><code>&gt; [1,4,2,5]\n</code></pre>\n"}, {"tags": ["haskell", "io-monad"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1509380254, "post_id": 47019793, "comment_id": 80986344, "body": "An <code>IO String</code> value is <b>not</b> a string. It doesn&#39;t make sense to want to put an <code>IO String</code>, for the same reason you wouldn&#39;t want to eat a cookbook."}, {"owner": {"reputation": 1076, "user_id": 5775965, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/98506e548d87020608ab5264f3d57703?s=128&d=identicon&r=PG&f=1", "display_name": "genghiskhan", "link": "https://stackoverflow.com/users/5775965/genghiskhan"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1509380430, "post_id": 47019793, "comment_id": 80986444, "body": "I am aware than an IO String is not a string. I am asking how to write an IO String."}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1509380539, "post_id": 47019793, "comment_id": 80986493, "body": "what you want <code>forM_</code>. your problem raised because you don&#39;t understand monad. you&#39;d better try to understand what monad is in the first place."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1509380603, "post_id": 47019793, "comment_id": 80986528, "body": "@genghiskhan What would you expect to get when you &quot;write&quot; an <code>IO String</code>?  Machine code?  Assembly instructions?  What?"}, {"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1509380611, "post_id": 47019793, "comment_id": 80986531, "body": "I don&#39;t really think the duplication is right judging from OP&#39;s intention."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1509380729, "post_id": 47019793, "comment_id": 80986589, "body": "@HuStmpHrrr perhaps the question I&#39;ve linked to doesn&#39;t quite match; by all means edit the duplicate link. This question definitely is a duplicate though; this is a common subject of confusion. The only solution is properly learning how monads work."}, {"owner": {"reputation": 1076, "user_id": 5775965, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/98506e548d87020608ab5264f3d57703?s=128&d=identicon&r=PG&f=1", "display_name": "genghiskhan", "link": "https://stackoverflow.com/users/5775965/genghiskhan"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1509380778, "post_id": 47019793, "comment_id": 80986624, "body": "@ThomasM.DuBuisson Maybe I was unclear. I want to see what the value of mdList is for debugging purposes. Therefore, I through I would want to print each element in that list to stdout."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509380818, "post_id": 47019793, "comment_id": 80986649, "body": "I vote to reopen. The answer to the claimed duplicate is <code>(&lt;$&gt;)</code>, but the answer to this question is <code>(&gt;&gt;=)</code> or maybe even more complicated than that. That this question is common I believe; but that particular choice of alternate question isn&#39;t a good fit."}, {"owner": {"reputation": 1076, "user_id": 5775965, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/98506e548d87020608ab5264f3d57703?s=128&d=identicon&r=PG&f=1", "display_name": "genghiskhan", "link": "https://stackoverflow.com/users/5775965/genghiskhan"}, "edited": false, "score": 0, "creation_date": 1509380948, "post_id": 47019793, "comment_id": 80986720, "body": "I clearly don&#39;t have a great understanding of monads but isn&#39;t &gt;&gt;= equivalent to a do block?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1509381016, "post_id": 47019793, "comment_id": 80986764, "body": "@genghiskhan yes, it is equivalent to a <code>do</code> block. But if you shove a <code>do</code> block in a function argument, it&#39;ll always be a monadic action, not a pure value such as the function might accept."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1509382904, "post_id": 47019793, "comment_id": 80987813, "body": "The type of <code>map putStrLn</code> is <code>[String] -&gt; [IO ()]</code>, but every statement in your <code>do</code> block must have type <code>IO X</code> for some <code>X</code> (and clearly <code>[IO ()]</code> can&#39;t match <code>IO X</code> for any <code>X</code>). However, <code>mapM_ putStrLn :: [String] -&gt; IO ()</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509387792, "post_id": 47019793, "comment_id": 80990598, "body": "cf. <a href=\"https://stackoverflow.com/questions/11323300/using-return-vs-not-using-return-in-the-list-monad/11326549#11326549\" title=\"using return vs not using return in the list monad\">stackoverflow.com/questions/11323300/&hellip;</a>. disregard the question, just read that answer. it&#39;s got a nice picture. <i>blue</i> is for computation descriptions (i.e. &quot;monadic actions&quot;), <i>red</i> (and an accidental magenta) is for values."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509388304, "post_id": 47019793, "comment_id": 80990887, "body": "monad is <i>something</i> that lets you mix, under a certain discipline, the computation descriptions (with their own primitives like <code>putStrLn</code> etc.) and the pure calculations using values these computations <i>will</i> produce. that&#39;s all."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1509391416, "post_id": 47019793, "comment_id": 80992541, "body": "Good suggestion by Will Ness, though beware: that is discussing the <i>list monad</i> rather than IO."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509396624, "post_id": 47019793, "comment_id": 80994938, "body": "IO or [], the blue slots are treated as monadic action descriptions, and the red slots are treated as pure values, regardless. Of course IO and [] are different, but the schema for the mixing is the same."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1509398146, "creation_date": 1509398146, "answer_id": 47024280, "question_id": 47019793, "link": "https://stackoverflow.com/questions/47019793/haskell-put-io-string/47024280#47024280", "title": "Haskell Put IO String", "body": "<p>You are using</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>which specializes to</p>\n\n<pre><code>map :: (a -&gt; IO b) -&gt; [a] -&gt; [IO b]\n</code></pre>\n\n<p>The final result, <code>[IO b]</code> is not what we need. That is a list of <code>IO</code> actions, i.e. the equivalent of a list of non-executed no-arguments imperative functions.\nInstead, we want a <em>single</em> <code>IO</code> action, whose result is a list of <code>b</code>: that would be <code>IO [b]</code> instead of <code>[IO b]</code>.</p>\n\n<p>The library provides that as well:</p>\n\n<pre><code>mapM :: (a -&gt; IO b) -&gt; [a] -&gt; IO [b]\n</code></pre>\n\n<p>or, if we don't care about collecting the results</p>\n\n<pre><code>mapM_ :: (a -&gt; IO b) -&gt; [a] -&gt; IO ()\n</code></pre>\n\n<p>The library also provides variants with flipped arguments:</p>\n\n<pre><code>for  :: [a] -&gt; (a -&gt; IO b) -&gt; IO [b]\nfor_ :: [a] -&gt; (a -&gt; IO b) -&gt; IO ()\n</code></pre>\n\n<p>So, the original code can be fixed as follows:</p>\n\n<pre><code>import Data.Foldable\n\nfiles &lt;- readProcess \"ls\" [] []\nfor_ files $ \\file -&gt; do\n    md &lt;- readProcess \"mdls\" [file] []\n    putStrLn md\nputStrLn \"Complete\"\n</code></pre>\n"}], "owner": {"reputation": 1076, "user_id": 5775965, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/98506e548d87020608ab5264f3d57703?s=128&d=identicon&r=PG&f=1", "display_name": "genghiskhan", "link": "https://stackoverflow.com/users/5775965/genghiskhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1509398146, "creation_date": 1509380058, "question_id": 47019793, "link": "https://stackoverflow.com/questions/47019793/haskell-put-io-string", "title": "Haskell Put IO String", "body": "<p>I am trying to read and print the output from the \"readProcess\" command mapped onto a list of filenames:</p>\n\n<pre><code>files &lt;- readProcess \"ls\" [] []\nlet mdList = map ( \\file -&gt; do\n    md &lt;- readProcess \"mdls\" [file] []\n    return md ) $ splitOn \"\\n\" files in\n    map (\\md -&gt; putStrLn md) mdList\nputStrLn \"Complete\"\n</code></pre>\n\n<p>Each time I try to map putStrLn onto the mdList, I get this error:</p>\n\n<pre><code>Couldn't match type \u2018IO String\u2019 with \u2018[Char]\u2019\n</code></pre>\n\n<p>I have read many StackOverflow answers that seem to just use putStrLn on an IO String but I am unable to do so. Also, I am new to Haskell so any other tips are also appreciated.</p>\n"}, {"tags": ["haskell", "template-haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1509373556, "post_id": 47017516, "comment_id": 80981725, "body": "You can&#39;t define a TH operation and use it in the same file, you need to make a separate module."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1509382403, "post_id": 47017516, "comment_id": 80987523, "body": "The stage restriction here applies to the local binding <code>n</code>, not to a top-level function, so moving the function to a different file won&#39;t help. The best you can do is to have a nested splice - something like <code>pSizeOf n = [| pure $ LitT $ NumTyLit $ fromIntegral $ sizeOf (undefined :: $(conT n)) |]</code>. Then you can write e.g. <code>type T = $($(pSizeOf &#39;&#39;Int))</code>"}], "owner": {"reputation": 1117, "user_id": 1641035, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b63d948c23003346549369112f336519?s=128&d=identicon&r=PG", "display_name": "Alexey Vagarenko", "link": "https://stackoverflow.com/users/1641035/alexey-vagarenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 339, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509373107, "creation_date": 1509373107, "question_id": 47017516, "link": "https://stackoverflow.com/questions/47017516/template-haskell-how-to-rewrite-this", "title": "Template Haskell: how to rewrite this?", "body": "<p>I have this <code>pSizeOf</code> function which takes a type param and returns the size of that type as type-level literal:</p>\n\n<pre><code>import Foreign.Storable\nimport Language.Haskell.TH\nimport qualified Data.Kind as K\n\npSizeOf :: forall (t :: K.Type). (Storable t) =&gt; TypeQ\npSizeOf = pure $ LitT $ NumTyLit $ fromIntegral $ sizeOf (undefined :: t)\n</code></pre>\n\n<p>I wonder is it possible to rewrite it without using type param <code>t</code>, something of type</p>\n\n<pre><code>pSizeOf :: Name -&gt; TypeQ\n</code></pre>\n\n<p>How can I get <code>undefined</code> of that type from <code>Name</code>? The following code:</p>\n\n<pre><code>pSizeOf :: Name -&gt; TypeQ\npSizeOf n = pure $ LitT $ NumTyLit $ fromIntegral $ sizeOf $( SigE (VarE 'undefined) (ConT n))\n</code></pre>\n\n<p>fails with error:</p>\n\n<pre><code>    * GHC stage restriction:\n        `n' is used in a top-level splice, quasi-quote, or annotation,\n        and must be imported, not defined locally\n    * In the untyped splice: $(SigE (VarE 'undefined) (ConT n))\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1509373983, "creation_date": 1509373983, "answer_id": 47017834, "question_id": 47017078, "link": "https://stackoverflow.com/questions/47017078/anamorphism-in-banana-lenses-and-barbed-wires/47017834#47017834", "title": "Anamorphism in Banana, Lenses and Barbed wires", "body": "<p>No, <code>g a = (a, f a)</code> is the correct definition. I'm not sure I understand your objection about <code>zip</code>; the two functions <code>iterate</code> and <code>zip</code> are not really related. They are both implemented as anamorphisms in this paper, but the similarities basically end there -- and they don't share any code other than the definition of an anamorphism.</p>\n\n<p>You can verify that these definitions are correct yourself by transcribing his math to Haskell:</p>\n\n<pre><code>import Prelude hiding (iterate)\n\nanamorphism g p b | p b = []\n                  | otherwise = a : anamorphism g p b'\n    where (a, b') = g b\n\niterate f = anamorphism g (const False)\n    where g a = (a, f a)\n</code></pre>\n\n<p>Then, in ghci:</p>\n\n<pre><code>&gt; take 10 (iterate succ 0)\n[0,1,2,3,4,5,6,7,8,9]\n</code></pre>\n\n<p>This jives with the built-in:</p>\n\n<pre><code>&gt; take 10 (Prelude.iterate succ 0)\n[0,1,2,3,4,5,6,7,8,9]\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 6814824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8407496f0354245617266793ca535010?s=128&d=identicon&r=PG&f=1", "display_name": "Vinothkumar Raman", "link": "https://stackoverflow.com/users/6814824/vinothkumar-raman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 47017834, "answer_count": 1, "score": 1, "last_activity_date": 1509373983, "creation_date": 1509371841, "question_id": 47017078, "link": "https://stackoverflow.com/questions/47017078/anamorphism-in-banana-lenses-and-barbed-wires", "title": "Anamorphism in Banana, Lenses and Barbed wires", "body": "<p>Shouldn't </p>\n\n<p><code>g a = (a,a)</code> \nin the definition of anamorphism for <code>iterate</code> in here? I find that, <code>f</code> is not applied for the <code>zip</code> case. Or am I reading it wrong?</p>\n\n<p><a href=\"http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.41.125&amp;rep=rep1&amp;type=pdf\" rel=\"nofollow noreferrer\">http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.41.125&amp;rep=rep1&amp;type=pdf</a></p>\n"}, {"tags": ["json", "parsing", "haskell", "instance", "aeson"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1509366552, "post_id": 47014346, "comment_id": 80976835, "body": "I cannot reproduce any error - I tried in ghci (+overloadedstrings) <code>let x :: Maybe Conversion = decode &quot;{\\&quot;base\\&quot;:\\&quot;base\\&quot;,\\&quot;rates\\&quot;:{\\&quot;#USD\\&quot;:1,\\&quot;#EUR\\&quot;:2}}&quot;</code> with your instances."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1509372726, "post_id": 47014346, "comment_id": 80981111, "body": "if you have non-standard json - you&#39;ll have to write the <code>parseJSON</code> instance declaration yourself. If you are defining the json yourself - I would refrain from adding &quot;strange&quot; field accessors - like # @ and so on - and stick to the usual lower case with dash syntax."}, {"owner": {"reputation": 95, "user_id": 8843491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d545338c29b973eaa81ec89d93e57867?s=128&d=identicon&r=PG&f=1", "display_name": "Viletung", "link": "https://stackoverflow.com/users/8843491/viletung"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1509446293, "post_id": 47014346, "comment_id": 81012896, "body": "@epsilonhalbe absolutely true. Unfortunately the Dutch weather forecast site is using the &quot;strange&quot; field accessors. Using the answer given by <b>Mateusz Kowalczyk</b> solves my problem, thanks everyone :)"}], "answers": [{"tags": [], "owner": {"reputation": 1946, "user_id": 1432740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a84709030a711eb919bec460051eac8?s=128&d=identicon&r=PG", "display_name": "Mateusz Kowalczyk", "link": "https://stackoverflow.com/users/1432740/mateusz-kowalczyk"}, "is_accepted": true, "score": 1, "last_activity_date": 1509391762, "creation_date": 1509391762, "answer_id": 47022864, "question_id": 47014346, "link": "https://stackoverflow.com/questions/47014346/haskell-aeson-json-filter-out-illegal-characters/47022864#47022864", "title": "Haskell Aeson JSON, filter out illegal characters", "body": "<p>You can deal with this by using <code>fieldLabelModifier</code> and replacing the problematic fields with your own. This allows you to be selective about which names are modified which is very useful if you have large records with only a few weirdly named fields that you can't directly put in your type.</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric     #-}\n{-# LANGUAGE LambdaCase        #-}\n{-# LANGUAGE OverloadedStrings #-}\nmodule Main (main) where\n\nimport           Data.Aeson\nimport           Data.Aeson.Types\nimport qualified Data.ByteString.Lazy as BSL\nimport qualified Data.Map.Strict as M\nimport           GHC.Generics\nimport           System.Environment (getArgs)\n\ndata Conversion = Conversion\n  { base :: String\n  , rates  :: Rates\n  } deriving (Show, Generic)\n\nnewtype USD = USD Float\nnewtype EUR = EUR Float\n\ndata Rates = Rates\n  { eur :: Float\n  , usd :: Float\n  }\n  deriving (Show, Generic)\n\ninstance FromJSON Conversion\n\ninstance FromJSON Rates where\n  parseJSON = genericParseJSON opts\n    where\n      fields = M.fromList\n        [(\"usd\", \"#USD\"), (\"eur\", \"#EUR\")]\n      opts = defaultOptions\n        { fieldLabelModifier = \\s -&gt; M.findWithDefault s s fields }\n\nmain :: IO ()\nmain = do\n  [file] &lt;- getArgs\n  decode &lt;$&gt; BSL.readFile file &gt;&gt;= \\case\n    Nothing -&gt; putStrLn \"Parse failed!\"\n    Just conversion -&gt; print (conversion :: Conversion)\n</code></pre>\n\n<p>With this we get</p>\n\n<pre><code>[nix-shell:/tmp]$ ./T /tmp/rates.json\nConversion {base = \"GBP\", rates = Rates {eur = 1.1282, usd = 1.3093}}\n\n[nix-shell:/tmp]$ cat /tmp/rates.json\n{\n  \"base\": \"GBP\",\n  \"date\": \"2017-10-27\",\n  \"rates\": {\n    \"#USD\": 1.3093,\n    \"#EUR\": 1.1282\n  }\n}\n</code></pre>\n\n<p>Just remember to use the same Aeson options if you ever define <code>ToJSON</code> instance for your type!</p>\n"}], "owner": {"reputation": 95, "user_id": 8843491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d545338c29b973eaa81ec89d93e57867?s=128&d=identicon&r=PG&f=1", "display_name": "Viletung", "link": "https://stackoverflow.com/users/8843491/viletung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 47022864, "answer_count": 1, "score": 0, "last_activity_date": 1509391762, "creation_date": 1509363514, "question_id": 47014346, "link": "https://stackoverflow.com/questions/47014346/haskell-aeson-json-filter-out-illegal-characters", "title": "Haskell Aeson JSON, filter out illegal characters", "body": "<p>Using Haskell with the Aeson JSON Hackage, and given the following JSON:</p>\n\n<pre><code>{\n    \"base\": \"GBP\",\n    \"date\": \"2017-10-27\",\n    \"rates\": {\n        \"#USD\": 1.3093,\n        \"#EUR\": 1.1282\n    }\n}\n</code></pre>\n\n<p>What is the beste way to implement a <code>FromJson</code> instance?</p>\n\n<p>Currently I have this:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings, DeriveGeneric #-}\n\nimport GHC.Generics\nimport Data.Aeson\n\ndata Conversion = Conversion {\n  base :: String,\n  rates  :: Rates }\n  deriving (Show, Generic)\n\ndata Rates = Rates {\n  eur :: Float,\n  usd :: Float }\n  deriving (Show, Generic)\n\ninstance FromJSON Conversion\ninstance FromJSON Rates where\n  parseJSON (Object o) = trace ( show(o)) Rates &lt;$&gt; o .: \"#USD\" &lt;*&gt; o .: \"#EUR\"\n</code></pre>\n\n<p>I have defined both possibilities in the <code>instance FromJSON Rates</code>. I tried to do it with the more generic way, but the 'illegal' characters <code>#</code> are not allowed in the <code>data</code> part.</p>\n\n<p>So in this case I have only two annoying fields. But if I want to extend this and get multiple annoying characters (#, @, - etc.), do I have to define every field? Or is there a smarter and faster way to achieve the same?</p>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "edited": false, "score": 0, "creation_date": 1509361219, "post_id": 47013548, "comment_id": 80973543, "body": "ooh so if  i want like x==b if i do( x&gt;=b &amp;&amp; x&lt;=b ) its the same thing so the compiler acepts also x==b , nice"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "edited": false, "score": 0, "creation_date": 1509361332, "post_id": 47013548, "comment_id": 80973607, "body": "@JoaoParente hahaha nice one, it not what I tried to say, you made me laugh"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "edited": false, "score": 0, "creation_date": 1509361475, "post_id": 47013548, "comment_id": 80973703, "body": "Let me add something to the answer for you too"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1509361785, "post_id": 47013548, "comment_id": 80973873, "body": "This doesn&#39;t answer the question. The compiler doesn&#39;t know that <code>==</code> is supposed to represent equality and <code>&lt;=</code> / <code>&gt;=</code> are supposed to represent less-or-equal / greater-or-equal, respectively. In particular, the compiler won&#39;t rewrite <code>x1 == x</code> in terms of <code>&lt;=</code>, <code>&gt;=</code>, or <code>compare</code>."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1509361880, "post_id": 47013548, "comment_id": 80973935, "body": "@melpomene but in my answer says that implements Eq, and that answers the question... What did I say wrong?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1509361915, "post_id": 47013548, "comment_id": 80973955, "body": "The only relevant part of this answer is &quot;<i>also if you look at the type class definition you can see that Ord is subtype of Eq</i>&quot;, hidden in a subclause at the end. Everything else is irrelevant."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1509362128, "post_id": 47013548, "comment_id": 80974082, "body": "@DamianLattenero: did not dv, but in fact for Haskell whether it makes mathematically sense is not really an issue. For Haskell <code>&lt;=</code>, and <code>==</code>, etc. are just (blackbox) functions. It does not know much/anything about the meaning behind <code>==</code>, it treats it as a function that takes two <code>a</code>s and returns a <code>Bool</code>, simple as that."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509364557, "post_id": 47013548, "comment_id": 80975521, "body": "@WillemVanOnsem thanks for the comment, my idea wasn&#39;t that, now with your comment I edited and I think I could be claire, let me know please if now the answer is ok, please"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1509370423, "post_id": 47013548, "comment_id": 80979373, "body": "@DamianLattenero You are giving an argument for why <code>Ord</code> should <i>imply</i> <code>Eq</code>, but that simply isn&#39;t relevant to the question. I can define a correct instance of <code>Ord</code> for a type like <code>data Z3 = One | Two | Three</code>, but the compiler will reject the code if I don&#39;t provide an <code>Eq</code> instance for the class as well (whether explicitly or derived). As Haskell stands, you don&#39;t get <code>==</code> unless you implement <code>Eq</code>."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509370975, "post_id": 47013548, "comment_id": 80979779, "body": "@chepner thanks so much, now I see way it isn&#39;t claire and relevant, let me take your comment as example, and now please tell me if the updates  is ok for you"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509371014, "post_id": 47013548, "comment_id": 80979806, "body": "@WillemVanOnsem I updated again the answer, let me know what you think please"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1509371056, "post_id": 47013548, "comment_id": 80979841, "body": "@melpomene I will appreciate if you take another look at my answer, I&#39;m trying to provide better answers to the community"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509371543, "post_id": 47013548, "comment_id": 80980223, "body": "@WillemVanOnsem thanks it helps a lot to get better  :) you rules"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509372717, "post_id": 47013548, "comment_id": 80981100, "body": "Looking at this more, I&#39;m surprised the documentation for <code>Ord</code> isn&#39;t explicit in stating that the <code>Ord</code> instance should be consistent with the required <code>Eq</code> instance. It&#39;s perfectly legal, for example, to write instances such that (using my <code>Z3</code>  example) <code>One == Two</code> is false, yet <code>One &lt;= Two</code> and <code>Two &lt;= One</code> are both true. If they are allowed to diverge, then why have a class constraint in the first place?"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509372869, "post_id": 47013548, "comment_id": 80981233, "body": "@chepner it&#39;s a good question for stack overflow maybe ;), will you post it? If you don&#39;t you put the doubt on me and now I want that answer... Interesting"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509372953, "post_id": 47013548, "comment_id": 80981295, "body": "@DamianLattenero I plan to, but I need to do some digging to make sure it isn&#39;t a duplicate first. (There appear to be several questions that touch on the issue, but nothing that directly addresses it or the reasons for it.)"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509373057, "post_id": 47013548, "comment_id": 80981366, "body": "@chepner so we don&#39;t now if my answer now is technically correct... To sad, so many edits and effort haha.."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509377454, "post_id": 47013548, "comment_id": 80984457, "body": "Well, the question only asks why you can use <code>==</code> without an explicit <code>Eq</code> constraint if you use <code>Ord</code>. You don&#39;t need to get into <i>why</i> <code>Ord</code> itself requires <code>Eq</code>. That said, the answer appears to be 1) <code>Ord</code> is intended to model total orders, which imply a definition of equality, and 2) the default implementation of <code>compare</code> uses <code>==</code>."}], "tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 2, "last_activity_date": 1509370912, "last_edit_date": 1509370912, "creation_date": 1509361024, "answer_id": 47013548, "question_id": 47013492, "link": "https://stackoverflow.com/questions/47013492/does-ord-a-allow-me-to-use/47013548#47013548", "title": "Does Ord a allow me to use &quot;==&quot;?", "body": "<p>Look at the type class definition:</p>\n\n<pre><code>class Eq a =&gt; Ord a\n</code></pre>\n\n<p>Now suppose the data type:</p>\n\n<pre><code>data OTT = One | Two | Three\n</code></pre>\n\n<p>If I derive the type directly to Ord with <code>deriving Ord</code> or I give an implementation it will brake, because I didn't say how to implement <code>Eq</code>, so one posible way to do it will be:</p>\n\n<pre><code>data OTT = One | Two | Three deriving Eq, Ord\n</code></pre>\n\n<p>Then <code>Eq</code> is mandatory because of the constraint <code>class Eq a =&gt;</code></p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 11, "last_activity_date": 1509361774, "last_edit_date": 1509361774, "creation_date": 1509361165, "answer_id": 47013591, "question_id": 47013492, "link": "https://stackoverflow.com/questions/47013492/does-ord-a-allow-me-to-use/47013591#47013591", "title": "Does Ord a allow me to use &quot;==&quot;?", "body": "<p>If we look at the <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#t:Ord\" rel=\"noreferrer\">definition of the <code>Ord</code></a> class, we see:</p>\n\n<pre><code>class <b>Eq a =&gt;</b> Ord a where\n  compare :: a -&gt; a -&gt; Ordering\n  (&lt;) :: a -&gt; a -&gt; Bool\n  (&lt;=) :: a -&gt; a -&gt; Bool\n  (&gt;) :: a -&gt; a -&gt; Bool\n  (&gt;=) :: a -&gt; a -&gt; Bool\n  max :: a -&gt; a -&gt; a\n  min :: a -&gt; a -&gt; a</code></pre>\n\n<p>So this means that every type <code>a</code> where <code>Ord a</code>, also means <code>Eq a</code>. So an <code>a</code> that supports <code>Ord</code>, also supports <code>Eq</code> and thus <code>(==)</code> and <code>(/=)</code>.</p>\n"}], "owner": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 47013591, "answer_count": 2, "score": 4, "last_activity_date": 1509377905, "creation_date": 1509360806, "last_edit_date": 1509377905, "question_id": 47013492, "link": "https://stackoverflow.com/questions/47013492/does-ord-a-allow-me-to-use", "title": "Does Ord a allow me to use &quot;==&quot;?", "body": "<p>I  was doing some test functions to understand a little more about Haskell, and I did this:</p>\n\n<pre><code>constroiMSet :: Ord a =&gt; [a] -&gt; [(a,Int)] \nconstroiMSet( x:x1:xs) |x1==x =[(x,2)]\n</code></pre>\n\n<p>The thing I don't get is why this function works. This function has <code>Ord a</code> but it uses <code>==</code> to compare <code>a</code>. Isn't <code>Ord a</code> only for <code>&gt;=</code>, <code>&lt;=</code>, <code>&lt;</code>, <code>&gt;</code>?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": true, "score": 2, "last_activity_date": 1509408092, "creation_date": 1509408092, "answer_id": 47025985, "question_id": 47012909, "link": "https://stackoverflow.com/questions/47012909/building-the-latest-version-of-process-as-a-dependency/47025985#47025985", "title": "Building the latest version of process as a dependency", "body": "<p>Looks like the package's git repo does not include the \"configure\" script, which is needed to use the package directly.  The reason things work when downloading from hackage is that the source distribution does include the configure script.  Frustrating!  I think this is an atypical design decision for a package that uses configure.  I've opened this stack issue: <a href=\"https://github.com/commercialhaskell/stack/issues/3534\" rel=\"nofollow noreferrer\">https://github.com/commercialhaskell/stack/issues/3534</a></p>\n\n<p>Suggested workaround is to clone the repo as a submodule and run <code>autoreconf -i</code> manually.</p>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 47025985, "answer_count": 1, "score": 2, "last_activity_date": 1509408092, "creation_date": 1509358973, "question_id": 47012909, "link": "https://stackoverflow.com/questions/47012909/building-the-latest-version-of-process-as-a-dependency", "title": "Building the latest version of process as a dependency", "body": "<p>In order to be able to cancel a process on Windows, I need to make use of <a href=\"https://github.com/haskell/process/pull/101\" rel=\"nofollow noreferrer\">this fix</a> for <a href=\"https://github.com/haskell/process\" rel=\"nofollow noreferrer\"><code>process</code> package</a>, which is still not released. I've tried adding the latest version from github as a dependency in my <code>stack.yaml</code> file:</p>\n\n<pre><code>packages:\n- '.'\n- location:\n    git: https://github.com/haskell/process.git\n    commit: 2fb7e739771f4a899a12b45f8b392e4874616b89\n  extra-dep: true\n</code></pre>\n\n<p>But the <code>stack build</code> command fails:</p>\n\n<pre><code>Process exited with code: ExitFailure 1\nLogs have been written to: C:\\Users\\nadalesagutde\\Documents\\github\\capitanbatata\\sandbox\\racing-turtles\\.stack-work\\logs\\process-1.6.1.0.log\n\nConfiguring process-1.6.1.0...\nWarning: The 'build-type' is 'Configure' but there is no 'configure' script.\nYou probably need to run 'autoreconf -i' to generate it.\nsetup.exe: configure script not found.\n</code></pre>\n\n<p>In the README of <code>process</code> is stated that <code>autoreconf -i</code> must be run before, but I don't know how to tell this to <code>stack</code>. Do I need some extra configuration in my <code>stack.yaml</code> file?</p>\n"}, {"tags": ["performance", "haskell", "primes", "primality-test"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1509358989, "post_id": 47012718, "comment_id": 80972078, "body": "My guess would be that since <code>prime</code> is a constant, it gets memoised, whereas <code>isPrime2</code> is a function, so it doesn&#39;t. That&#39;s only a guess, however..."}, {"owner": {"reputation": 697, "user_id": 5821028, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f02b2f13bdf83954535307af466460a7?s=128&d=identicon&r=PG&f=1", "display_name": "eii0000", "link": "https://stackoverflow.com/users/5821028/eii0000"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1509361829, "post_id": 47012718, "comment_id": 80973897, "body": "Thanks! Your explanation gave me insights."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509438817, "post_id": 47012718, "comment_id": 81008307, "body": "@eii0000 are you testing it compiled or interpreted? how does it compare if you simplify your <code>isPrime2 n</code> as <code>all (\\p -&gt; n `mod` p &#47;= 0) . takeWhile ((&lt;=n) . (^2)) $ 2 : [3,5..]</code>?"}, {"owner": {"reputation": 697, "user_id": 5821028, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f02b2f13bdf83954535307af466460a7?s=128&d=identicon&r=PG&f=1", "display_name": "eii0000", "link": "https://stackoverflow.com/users/5821028/eii0000"}, "edited": false, "score": 0, "creation_date": 1509458179, "post_id": 47012718, "comment_id": 81020676, "body": "all (\\p -&gt; n <code>mod</code> p /= 0) . takeWhile ((&lt;=n) . (^2)) $ 2 : [3,5..] is very fast... in my machine it took 0.025 second. I also tried all (\\p -&gt; n <code>mod</code> p /= 0) . takeWhile ((&lt;=n) . (^2)) $ [2,3,5]++[6*x+y|x&lt;-[1..],y&lt;-[1,5]], which is slightly faster than 2:[3,5..]"}, {"owner": {"reputation": 697, "user_id": 5821028, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f02b2f13bdf83954535307af466460a7?s=128&d=identicon&r=PG&f=1", "display_name": "eii0000", "link": "https://stackoverflow.com/users/5821028/eii0000"}, "edited": false, "score": 0, "creation_date": 1509472185, "post_id": 47012718, "comment_id": 81030117, "body": "I compiled it. thanks!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509564589, "post_id": 47012718, "comment_id": 81072530, "body": "ok, thanks. now, what happens if you test the same number 10 times (or 100), with your 1st function vs with the function in the answer? (can you tell, without running it?) @eii0000 (when you respond, use @ sign so I get pinged :) )"}], "answers": [{"comments": [{"owner": {"reputation": 697, "user_id": 5821028, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f02b2f13bdf83954535307af466460a7?s=128&d=identicon&r=PG&f=1", "display_name": "eii0000", "link": "https://stackoverflow.com/users/5821028/eii0000"}, "edited": false, "score": 0, "creation_date": 1509361766, "post_id": 47012833, "comment_id": 80973861, "body": "great... your isPrime2 is 0.5 second too.. Thanks!"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1509364625, "post_id": 47012833, "comment_id": 80975579, "body": "Won&#39;t GHC usually float <code>prime</code> and <code>isPrime</code> out to the top level during optimisation?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1509365155, "post_id": 47012833, "comment_id": 80975912, "body": "@BenjaminHodgson No, GHC is conservative here since it is not always an optimization. I believe this transformation is called (or related to) the &quot;full laziness&quot; transformation, where <code>\\x -&gt; let y = ... in ....</code> becomes <code>let y= ... in \\x -&gt; ...</code> provided that <code>y</code> does not depend on <code>x</code>. The semantics is preserved, but it is hard to predict which one has the best performance (IIRC)."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1509359031, "last_edit_date": 1509359031, "creation_date": 1509358726, "answer_id": 47012833, "question_id": 47012718, "link": "https://stackoverflow.com/questions/47012718/consolidated-function-is-much-slower/47012833#47012833", "title": "consolidated function is much slower", "body": "<p>The first snippet will keep only one list of <code>prime</code>s in memory.</p>\n\n<p>The second snippet will compute its own <code>prime</code> until <code>n^2</code> <em>every single time</em> <code>isPrime2</code> is called. Previously discovered primes are discarded and recomputed from scratch at every call.\nSince <code>isPrime2</code> is recursive this leads to a blow-up.</p>\n\n<p>An intermediate approach can be this one:</p>\n\n<pre><code>isPrime2 :: Integer -&gt; Bool\nisPrime2 m = isPrime m\n   where\n   prime :: [Integer]\n   prime = 2 : filter isPrime [3..]\n   isPrime :: Integer -&gt; Bool\n   isPrime n | n &lt; 2 = False\n   isPrime n = all (\\p -&gt; n `mod` p /= 0) . takeWhile ((&lt;=n) . (^2)) $ prime\n</code></pre>\n\n<p>This will recompute <code>prime</code> at every call of <code>isPrime2</code>, but will not lead to a blow-up since each call of the inner <code>isPrime</code> will share the same list of <code>prime</code>s.</p>\n"}], "owner": {"reputation": 697, "user_id": 5821028, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f02b2f13bdf83954535307af466460a7?s=128&d=identicon&r=PG&f=1", "display_name": "eii0000", "link": "https://stackoverflow.com/users/5821028/eii0000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 47012833, "answer_count": 1, "score": 6, "last_activity_date": 1509564762, "creation_date": 1509358363, "last_edit_date": 1509564762, "question_id": 47012718, "link": "https://stackoverflow.com/questions/47012718/consolidated-function-is-much-slower", "title": "consolidated function is much slower", "body": "<p>I wrote isPrime function. It checks if a given number is prime or not.\nThe last \"prime\" list is given separately.</p>\n\n<pre><code>prime :: [Integer]\nprime = 2 : filter isPrime [3..]\nisPrime :: Integer -&gt; Bool\nisPrime n | n &lt; 2 = False\nisPrime n = all (\\p -&gt; n `mod` p /= 0) . takeWhile ((&lt;=n) . (^2)) $ prime\n</code></pre>\n\n<p>I thought it was always better to consolidate two functions into one if possible..so I consolidated isPrime and prime into one function isPrime2. But the isPrime2's performance is very bad.  </p>\n\n<pre><code>isPrime2 :: Integer -&gt; Bool\nisPrime2 n | n &lt; 2 = False\nisPrime2 n = all (\\p -&gt; n `mod` p /= 0) . takeWhile ((&lt;=n) . (^2)) $ 2 : filter isPrime2 [3..]\n</code></pre>\n\n<p>isPrime 40000000000000000001</p>\n\n<p>=> 0.5 second</p>\n\n<p>isPrime2 40000000000000000001</p>\n\n<p>=> 19.8 seconds</p>\n\n<p>My machine is Ubuntu 17.10 x86-64. I am using ghc 8.2.1. Does anyone know why?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509358226, "post_id": 47012646, "comment_id": 80971545, "body": "But here you have a type error: you return a list of <code>[Int]</code>s, but your first clause returns an <code>Int</code> (not a list of <code>Int</code>s)."}, {"owner": {"reputation": 13, "user_id": 8824488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d03503fe4434fdb010a11e06ee162a6?s=128&d=identicon&r=PG&f=1", "display_name": "DataValues", "link": "https://stackoverflow.com/users/8824488/datavalues"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509358357, "post_id": 47012646, "comment_id": 80971634, "body": "@WillemVanOnsem I have edited the code in the question, is this correct now?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509358420, "post_id": 47012646, "comment_id": 80971675, "body": "yes, now it will compile. Whether you have to return <code>[0]</code> and for instance not an empty list <code>[]</code> is of course up to you."}, {"owner": {"reputation": 13, "user_id": 8824488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d03503fe4434fdb010a11e06ee162a6?s=128&d=identicon&r=PG&f=1", "display_name": "DataValues", "link": "https://stackoverflow.com/users/8824488/datavalues"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509358578, "post_id": 47012646, "comment_id": 80971776, "body": "@WillemVanOnsem Thanks, however, do you have an idea of how I can solve my initial problem?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8824488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d03503fe4434fdb010a11e06ee162a6?s=128&d=identicon&r=PG&f=1", "display_name": "DataValues", "link": "https://stackoverflow.com/users/8824488/datavalues"}, "edited": false, "score": 0, "creation_date": 1509359026, "post_id": 47012771, "comment_id": 80972102, "body": "This is useful, however I may have worded my question poorly. I am not actually looking to throw an exception. I am trying to have the function return something that I can use in an if statement later on to determine where more code should be executed based on the &quot;findint&quot; function finding an item in the list of tuples or not."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 13, "user_id": 8824488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d03503fe4434fdb010a11e06ee162a6?s=128&d=identicon&r=PG&f=1", "display_name": "DataValues", "link": "https://stackoverflow.com/users/8824488/datavalues"}, "edited": false, "score": 0, "creation_date": 1509359185, "post_id": 47012771, "comment_id": 80972210, "body": "Well this is exactly what you can do with <code>Maybe</code> (last part). Here we thus return a <code>Nothing</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 1, "last_activity_date": 1509358546, "creation_date": 1509358546, "answer_id": 47012771, "question_id": 47012646, "link": "https://stackoverflow.com/questions/47012646/haskell-error-handling/47012771#47012771", "title": "Haskell Error Handling", "body": "<p>You can do this using <em>pattern matching</em>, for instance with a pattern guard:</p>\n\n<pre><code>findint :: String -> [(String,Int)] -&gt; [Int]\nfindint \"\" xs = [0]\nfindint a xs <b>| res@(_:_) &lt;-</b> [y | (x,y) &lt;- xs, x == a] = <b>res</b>\n             <b>| otherwise = error \"Empty result\"</b></code></pre>\n\n<p>So here we check if the list comprehension matches the <code>(_:_)</code> pattern. If it does, we return the list, otherwise, we <code>error</code>.</p>\n\n<p>We can also perform a <code>null :: [a] -&gt; Bool</code> check:</p>\n\n<pre><code>findint :: String -> [(String,Int)] -&gt; [Int]\nfindint \"\" xs = [0]\nfindint a xs | <b>null res</b> = error \"Empty result\"\n             | otherwise = res\n    where res = [y | (x,y) &lt;- xs, x == a]</code></pre>\n\n<p>That being said, usually errors are not the favorite tool of Haskell programmers, since one can not derive these from the signature. Usually a <code>Maybe</code> is used for non-total functions:</p>\n\n<pre><code>findint :: String -> [(String,Int)] -&gt; <b>Maybe </b>[Int]\nfindint \"\" xs = <b>Just </b>[0]\nfindint a xs | null res = <b>Nothing</b>\n             | otherwise = <b>Just</b> res\n    where res = [y | (x,y) &lt;- xs, x == a]</code></pre>\n\n<p>Now it is clear that if you use this function, there are two possible outcomes: the <code>Nothing</code> in case something goes wrong (and thus a caller of the function can handle this seperately), and a <code>Just x</code> in case of normal data flow where you unpack the <code>x</code> and process it further.</p>\n"}, {"tags": [], "owner": {"reputation": 669, "user_id": 3406750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b1de70b0e9078f2a462eed59aff2159?s=128&d=identicon&r=PG&f=1", "display_name": "Teodor", "link": "https://stackoverflow.com/users/3406750/teodor"}, "is_accepted": false, "score": 0, "last_activity_date": 1509394003, "creation_date": 1509394003, "answer_id": 47023366, "question_id": 47012646, "link": "https://stackoverflow.com/questions/47012646/haskell-error-handling/47023366#47023366", "title": "Haskell Error Handling", "body": "<p>Is this the behavior you want?</p>\n\n<pre><code>Prelude&gt; findInt s = map snd . filter ((== s) . fst)\nPrelude&gt; findInt \"ohai\" [(\"hello\", 0), (\"ohai\", 2), (\"ohai\", 3)]\n[2,3]\n</code></pre>\n\n<p>No match would return an empty list. I find this reasonable.</p>\n"}], "owner": {"reputation": 13, "user_id": 8824488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d03503fe4434fdb010a11e06ee162a6?s=128&d=identicon&r=PG&f=1", "display_name": "DataValues", "link": "https://stackoverflow.com/users/8824488/datavalues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 47012771, "answer_count": 2, "score": 1, "last_activity_date": 1509394003, "creation_date": 1509358103, "last_edit_date": 1509377939, "question_id": 47012646, "link": "https://stackoverflow.com/questions/47012646/haskell-error-handling", "title": "Haskell Error Handling", "body": "<p>I have a function that looks up a value from a list of tuples, i'm trying to adapt this function such that if the value isn't in the list of tuples the function identifies it, currently below block of code is throwing error.</p>\n\n<pre><code>findint :: String -&gt; [(String,Int)] -&gt; [Int]\nfindint \"\" xs = [0]\nfindint a xs = [y | (x,y) &lt;- xs, x == a]\n</code></pre>\n"}, {"tags": ["list", "haskell", "syntax", "syntax-error"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1509331260, "post_id": 47007407, "comment_id": 80961472, "body": "The backtick, <code>`</code>, is not a valid character for a variable name.  Also, why is <code>enter</code> there? Is that a typo or do you actually have the word <code>enter</code> in your source?  It doesn&#39;t belong."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1525273468, "post_id": 47007471, "comment_id": 87293958, "body": "For maximal inscrutability: <code>(&lt;$&gt; zip) &lt;$&gt; (&lt;$&gt;) &lt;$&gt; (&lt;$&gt;) &lt;$&gt; uncurry</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1525275422, "post_id": 47007471, "comment_id": 87295182, "body": "I don&#39;t know why you edited the question a couple hours ago, but it invalidated the answers (including your own!) so I rolled that back."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1525279862, "post_id": 47007471, "comment_id": 87297776, "body": "@dfeuer nice one, inscrutable at all but interesting as well! Thanks for the comments, and you&#39;re right also with the roll back"}, {"owner": {"reputation": 930, "user_id": 4387539, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xN2AM.png?s=128&g=1", "display_name": "hyiltiz", "link": "https://stackoverflow.com/users/4387539/hyiltiz"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1577785423, "post_id": 47007471, "comment_id": 105253704, "body": "@dfeuer care to explain? Would be amusing to learn. Might also be enlightening."}], "tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": true, "score": 9, "last_activity_date": 1530301102, "last_edit_date": 1530301102, "creation_date": 1509331590, "answer_id": 47007471, "question_id": 47007407, "link": "https://stackoverflow.com/questions/47007407/zipwith-function-implemented-using-map-and-zip-functions/47007471#47007471", "title": "zipWith Function Implemented Using Map and Zip Functions", "body": "<p>You have to use <code>'</code> symbol and not <code>`</code> ; then, to combine the function you need to use <code>uncurry</code>:</p>\n\n<pre><code>zipWith' :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\nzipWith' f xs ys  = map (uncurry f) (zip xs ys)\n</code></pre>\n\n<p>why is that, well the type of <code>zip</code> is:</p>\n\n<pre><code>zip :: [a] -&gt; [b] -&gt; [(a, b)]\n</code></pre>\n\n<p>but the function <code>f</code> is <code>f :: (a -&gt; b -&gt; c)</code>, so, with the help of <code>uncurry</code>,</p>\n\n<pre><code>uncurry :: (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c\n</code></pre>\n\n<p>you can map the function <code>f</code> into the <code>[(a, b)]</code>, transforming it into <code>[c]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 2, "last_activity_date": 1509338579, "creation_date": 1509338579, "answer_id": 47008249, "question_id": 47007407, "link": "https://stackoverflow.com/questions/47007407/zipwith-function-implemented-using-map-and-zip-functions/47008249#47008249", "title": "zipWith Function Implemented Using Map and Zip Functions", "body": "<p>As Damian points out, <code>zipWith`</code>  doesn't work with the trailing backtick -- the backtick has a special meaning in Haskell. Rename it to <code>zipWith'</code>.</p>\n\n<pre><code>zipWith' :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\n</code></pre>\n\n<p>Then of course you have to actually <em>write</em> the solution. With explicit recursion you've got</p>\n\n<pre><code>zipWith' _ _ []          = []\nzipWith' _ [] _          = []\nzipWith' f (x:xs) (y:ys) = f x y : zipWith' f xs ys\n</code></pre>\n\n<p>but using <code>map</code> and <code>zip</code> you could apply it like this:</p>\n\n<pre><code>zipWith' f xs ys = map (\\(x,y) -&gt; f x y) . zip xs $ ys\n</code></pre>\n\n<p>or more easily-read:</p>\n\n<pre><code>zipWith' f xs ys = map (\\(x,y) -&gt; f x y) zipped\n    where zipped = zip xs ys\n</code></pre>\n"}], "owner": {"reputation": 323, "user_id": 6576252, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d4bf1a52d627d15cf923fc884444a718?s=128&d=identicon&r=PG&f=1", "display_name": "Wallace Mogerty", "link": "https://stackoverflow.com/users/6576252/wallace-mogerty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2504, "favorite_count": 0, "accepted_answer_id": 47007471, "answer_count": 2, "score": -1, "last_activity_date": 1572882927, "creation_date": 1509330949, "last_edit_date": 1572882927, "question_id": 47007407, "link": "https://stackoverflow.com/questions/47007407/zipwith-function-implemented-using-map-and-zip-functions", "title": "zipWith Function Implemented Using Map and Zip Functions", "body": "<p>I am attempting to implement the <code>zipWith</code> function via the <code>zip</code> and <code>map</code> functions, but I am getting an error that reads: \"error: parse error on input '::' My code is below and and I am unsure of what I have done wrong</p>\n\n<pre><code>zipWith` :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\nzipWith` f x y = zip x $ map f y\n</code></pre>\n"}, {"tags": ["macos", "haskell", "atom-editor", "hlint"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1509325336, "post_id": 47006831, "comment_id": 80960282, "body": "Did you install hlint? Or did you only install the atom plugin? If not try <code>stack install hlint</code> assuming you have <code>stack</code> installed."}, {"owner": {"reputation": 404, "user_id": 8315879, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7c9fd6231001a4615cfb153d20e7917b?s=128&d=identicon&r=PG&f=1", "display_name": "Bn.F76", "link": "https://stackoverflow.com/users/8315879/bn-f76"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1509326534, "post_id": 47006831, "comment_id": 80960546, "body": "I just went into atom and under Preferences -&gt; Install -&gt; selected <code>linter-hlint</code>. I just tried running <code>stack install hlint</code> on my terminal and it downloaded some stuff but gave me : <code>No compiler found, expected minor version match with ghc-8.0.2 (x86_64) (based on resolver setting in &#47;Users&#47;benf76&#47;.stack&#47;global-project&#47;stack.yaml)</code>."}, {"owner": {"reputation": 404, "user_id": 8315879, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7c9fd6231001a4615cfb153d20e7917b?s=128&d=identicon&r=PG&f=1", "display_name": "Bn.F76", "link": "https://stackoverflow.com/users/8315879/bn-f76"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1509326704, "post_id": 47006831, "comment_id": 80960577, "body": "I guess I don&#39;t have <code>stack</code> installed, I just ran <code>stack setup</code> and it says : &quot;Preparing to install GHC to an isolated location&quot;. What I don&#39;t understand is why I need all this. Before I just used the command <code>ghci</code> and ran any Haskell code"}, {"owner": {"reputation": 404, "user_id": 8315879, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7c9fd6231001a4615cfb153d20e7917b?s=128&d=identicon&r=PG&f=1", "display_name": "Bn.F76", "link": "https://stackoverflow.com/users/8315879/bn-f76"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1509327541, "post_id": 47006831, "comment_id": 80960766, "body": "I installed <code>stack</code> then ran <code>stack install hlint</code> and at the end said : &quot;Installation path /Users/benf76/.local/bin not found on the PATH environment variable&quot;. typing <code>which hlint</code> still gives me nothing."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1509354163, "post_id": 47006831, "comment_id": 80968994, "body": "First install stack if you haven&#39;t done so far. Then remove every haskell related package from Atom. Then install the <a href=\"https://atom.io/packages/atom-haskell\" rel=\"nofollow noreferrer\">atom-haskell</a> package. It will simply install almost all needed tools including the linter."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1509356949, "post_id": 47006831, "comment_id": 80970726, "body": "the reason for those difficulties are: haskell-plattform is shipping with ghc-8.2.1 (a recent change), stack is not yet using ghc-8.2.1 in their main repository - thus you get an error about compiler mismatch. The problem with your $PATH I do not know - might be that you need to add /Users/benf76/.local/bin to your PATH because that is where stack installs the executables which it builds."}, {"owner": {"reputation": 404, "user_id": 8315879, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7c9fd6231001a4615cfb153d20e7917b?s=128&d=identicon&r=PG&f=1", "display_name": "Bn.F76", "link": "https://stackoverflow.com/users/8315879/bn-f76"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1509366306, "post_id": 47006831, "comment_id": 80976644, "body": "thank you Redu , and @epsilonhalbe !"}], "owner": {"reputation": 404, "user_id": 8315879, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7c9fd6231001a4615cfb153d20e7917b?s=128&d=identicon&r=PG&f=1", "display_name": "Bn.F76", "link": "https://stackoverflow.com/users/8315879/bn-f76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509325041, "creation_date": 1509325041, "question_id": 47006831, "link": "https://stackoverflow.com/questions/47006831/linter-error-running-hlint-hlint-doesnt-work-on-atom", "title": "&quot; [Linter] Error running HLint &quot; ? hlint doesn&#39;t work on Atom", "body": "<p>I installed 'linter 2.2.0' on Atom (this also installed: busy-signal 1.4.3, intentions 1.1.5, linter-ui-default 1.6.10). Then I installed 'linter-hlint 2.0.0' , however it doesn't work. I get an error saying: \"[Linter] Error running HLint , see console for more info.\"</p>\n\n<p>I know that I have to \"specify the path to hlint\" in settings but I can't even find the path. When I open my terminal (using a Mac) and type \"which hlint\" there is no output, just a new line. </p>\n\n<p>Can anybody tell me what's happening and what I can do?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "is_accepted": true, "score": 8, "last_activity_date": 1509300811, "creation_date": 1509300811, "answer_id": 47003590, "question_id": 47003565, "link": "https://stackoverflow.com/questions/47003565/multiply-lists-in-haskell/47003590#47003590", "title": "Multiply Lists in Haskell", "body": "<p>This is a classic use case for <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:zipWith\" rel=\"noreferrer\"><code>zipWith</code></a>:</p>\n\n<pre><code>calcArea = zipWith (*)\n</code></pre>\n\n<p>Or, which may be simpler to understand, but is equivalent:</p>\n\n<pre><code>calcArea length width = zipWith (*) length width\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1509311320, "post_id": 47003963, "comment_id": 80957016, "body": "you meant &quot;the product&quot;, not &quot;the sum&quot;. ---- Btw I like this expository (inductive?) programming sometimes, when we go from <code>calcArea [1,2,3] [4,5,6] = (1 * 4) : calcArea [2,3] [5,6]</code> to <code>calcArea (one:two_three) (four:five_six) = (one * four) : calcArea two_three five_six</code>."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 8, "last_activity_date": 1509312659, "last_edit_date": 1509312659, "creation_date": 1509303013, "answer_id": 47003963, "question_id": 47003565, "link": "https://stackoverflow.com/questions/47003565/multiply-lists-in-haskell/47003963#47003963", "title": "Multiply Lists in Haskell", "body": "<p>@ForceBru has already written a perfectly good answer, but I'd like to explore how to write this kind of function on your own.</p>\n\n<p>Firstly, we can write the type signature. You already have that:</p>\n\n<pre><code>calcArea :: [Int] -&gt; [Int] -&gt; [Int]\n</code></pre>\n\n<p>So now we can write out four different cases that the two arguments can take:</p>\n\n<pre><code>calcArea []     []     = -- TODO: case 1\ncalcArea (a:as) []     = -- TODO: case 2\ncalcArea []     (b:bs) = -- TODO: case 3\ncalcArea (a:as) (b:bs) = -- TODO: case 4\n</code></pre>\n\n<p>The first case is easy:</p>\n\n<pre><code>calcArea [] [] = []\n</code></pre>\n\n<p>But the second and third are harder. Here, I will make a decision to 'truncate' the list, so that <code>calcArea [1,2,3] [] = []</code>. Besides, this is meant to be used with lists of equal size. You may want to change this if this isn't how the function should behave. (Note that this is how <code>zipWith</code> behaves.) Also, since we don't refer to the elements of the list, we can write <code>_</code> instead of <code>(a:as)</code> and <code>(b:bs)</code> like previously.</p>\n\n<pre><code>calcArea _ [] = []\ncalcArea [] _ = []\n</code></pre>\n\n<p>(Note also that these cases overlap with the first, and so we can remove the first case entirely)</p>\n\n<p>Finally, we have case 4. Clearly we want <code>a * b</code> within some list, so let's start with that:</p>\n\n<pre><code>calcArea (a:as) (b:bs) = (a * b) : --???\n</code></pre>\n\n<p>At this point, we realise that <code>calcArea as bs</code> is the product of the first two elements of <code>as</code> and <code>bs</code>, then <code>calcArea</code> of the rest of the list! That is to say, <code>calcArea [1,2,3] [4,5,6] = (1 * 4) : calcArea [2,3] [5,6]</code>. So we can recur:</p>\n\n<pre><code>calcArea (a:as) (b:bs) = (a * b) : calcArea as bs\n</code></pre>\n\n<p>So, the complete function is:</p>\n\n<pre><code>calcArea :: [Int] -&gt; [Int] -&gt; [Int]\ncalcArea [] _ = []\ncalcArea _ [] = []\ncalcArea (a:as) (b:bs) = (a * b) : calcArea as bs\n</code></pre>\n\n<p>Note that this is equivalent to <code>calcArea = zipWith (*)</code></p>\n\n<p>I hope this helps you to write more complex functions in Haskell in the future.</p>\n"}, {"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1509318891, "post_id": 47004578, "comment_id": 80959010, "body": "As a curiosity, it can also be written pointfreely as <code>fmap getZipList . liftA2 (*) `on` ZipList</code>. Although I think that\u2019s a bit less clear in this case, it\u2019s often worth checking to see if a pointfree solution turns out to be nicer, as it is with <code>calcArea = zipWith (*)</code>."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 4, "last_activity_date": 1509311387, "last_edit_date": 1509311387, "creation_date": 1509306809, "answer_id": 47004578, "question_id": 47003565, "link": "https://stackoverflow.com/questions/47003565/multiply-lists-in-haskell/47004578#47004578", "title": "Multiply Lists in Haskell", "body": "<p>@ForceBru's answer is the simplest way to do this job. However there might be times with more complicated jobs to do functor and applicative operations on lists when you need \"one to one\" operation rather than combinatorial. So there's this <code>Control.Applicative.ZipList</code> type thought just for this job, and it may come handy.</p>\n\n<pre><code>import Control.Applicative\n\nmult121 :: Num a =&gt; [a] -&gt; [a] -&gt; [a]\nmult121 xs ys = getZipList $ (*) &lt;$&gt; ZipList xs &lt;*&gt; ZipList ys\n\n*Main&gt; mult121 [1,2,3] [4,5,6]\n[4,10,18]\n</code></pre>\n"}], "owner": {"reputation": 323, "user_id": 6576252, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d4bf1a52d627d15cf923fc884444a718?s=128&d=identicon&r=PG&f=1", "display_name": "Wallace Mogerty", "link": "https://stackoverflow.com/users/6576252/wallace-mogerty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2141, "favorite_count": 0, "accepted_answer_id": 47003590, "answer_count": 3, "score": 2, "last_activity_date": 1509312659, "creation_date": 1509300658, "last_edit_date": 1509302247, "question_id": 47003565, "link": "https://stackoverflow.com/questions/47003565/multiply-lists-in-haskell", "title": "Multiply Lists in Haskell", "body": "<p>How can I implement a function that multiplies each element of a list by its corresponding element in another list? For example, given the lists <code>[1, 2, 3]</code> and <code>[4, 5, 6]</code> returns <code>[4, 10, 18]</code>? My code is below:</p>\n\n<pre><code>calcArea :: [Int] -&gt; [Int] -&gt; [Int]\ncalcArea length width = length * width\n</code></pre>\n"}, {"tags": ["haskell", "module"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1509299923, "post_id": 47003392, "comment_id": 80953333, "body": "can you tell us more about your setup - do you use <code>stack</code> or <code>cabal</code> do you have a single file or a project? what <code>ghc</code>-version do you use, what version of <code>stack</code> and <code>cabal</code>? Can you show the output of <code>ghc-pkg list</code>?"}, {"owner": {"reputation": 271, "user_id": 8017324, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c93f40d3e08a83da755d6288efa5b493?s=128&d=identicon&r=PG&f=1", "display_name": "PythonRookie", "link": "https://stackoverflow.com/users/8017324/pythonrookie"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1509301411, "post_id": 47003392, "comment_id": 80953812, "body": "hello @epsilonhalbe I went to <a href=\"https://www.haskell.org/downloads\" rel=\"nofollow noreferrer\">haskell.org/downloads</a> and i downloaded the &quot;Haskell Platform: Installs GHC, Cabal, and some other tools, along with a starter set of libraries in a global location on your system&quot;. I also use stack version 1.5.1. Its a project, and i am using the Sublime Text IDE. I edited the post to show the output of ghc-pkg list"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1509301598, "post_id": 47003392, "comment_id": 80953868, "body": "if you use a project you have to add <code>the-library</code> to your <code>build-depends</code> section in your <code>.cabal</code>-file. Which library - I don&#39;t know but <code>stack build</code>should give you a good guess what to add."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1509301840, "post_id": 47003392, "comment_id": 80953950, "body": "please show me the contents of your <code>.cabal</code>-file then I can help you a little bit more. (also don&#39;t post pictures of your terminal output, but rather include the text, such that the question is self contained, if the pic is removed from whatever platform, nobody reading this in a few years will understand what this is about.)"}, {"owner": {"reputation": 271, "user_id": 8017324, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c93f40d3e08a83da755d6288efa5b493?s=128&d=identicon&r=PG&f=1", "display_name": "PythonRookie", "link": "https://stackoverflow.com/users/8017324/pythonrookie"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1509306141, "post_id": 47003392, "comment_id": 80955350, "body": "Hello @epsilonhalbe, I will be editing my posts in a few minutes. This is my first time trying out haskell, so i apologize for the little questions that i am asking that i should already have the answer to"}], "answers": [{"comments": [{"owner": {"reputation": 271, "user_id": 8017324, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c93f40d3e08a83da755d6288efa5b493?s=128&d=identicon&r=PG&f=1", "display_name": "PythonRookie", "link": "https://stackoverflow.com/users/8017324/pythonrookie"}, "edited": false, "score": 0, "creation_date": 1509316847, "post_id": 47004921, "comment_id": 80958567, "body": "hello @epsilonhalbe i am not at home right now, but once i get home, i will take your corrections and work on it. Just to be sure, i shouldn&#39;t change the .cabal file? just the stack.yaml file? I am definitely not using this for production, i will just like to see it run so i can understand what it is doing and step through each line of code. Thanks for the advice"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1509308976, "creation_date": 1509308976, "answer_id": 47004921, "question_id": 47003392, "link": "https://stackoverflow.com/questions/47003392/importing-crypto-modules-in-haskell/47004921#47004921", "title": "Importing Crypto Modules in Haskell", "body": "<p>I tried to build the package but it requires llvm-3.9 to work, which for some reason does not in my setup.</p>\n\n<p>Also the package <code>hecc</code> is deprecated - and the git repo is 4 years old, quite outdated. if you use this for production purposes I would strongly discourage you from doing that.</p>\n\n<p>Here is a <code>stack.yaml</code> which should probably work, but <code>hF2</code>+<code>llvm</code> keeps bugging me as I said before.</p>\n\n<h2><code>stack.yaml</code></h2>\n\n<pre><code>resolver: nightly-2017-10-28\npackages:\n- .\nextra-deps:\n- hF2-0.2\n- hecc-0.4.1.1\nflags: {}\nextra-package-dbs: []\n</code></pre>\n\n<p>try to build with <code>stack build</code></p>\n"}], "owner": {"reputation": 271, "user_id": 8017324, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c93f40d3e08a83da755d6288efa5b493?s=128&d=identicon&r=PG&f=1", "display_name": "PythonRookie", "link": "https://stackoverflow.com/users/8017324/pythonrookie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509308976, "creation_date": 1509299661, "last_edit_date": 1509306255, "question_id": 47003392, "link": "https://stackoverflow.com/questions/47003392/importing-crypto-modules-in-haskell", "title": "Importing Crypto Modules in Haskell", "body": "<p>I am trying to run some haskell files, I have never done haskell by the way before and i am running into an error. </p>\n\n<pre><code>import Crypto.Types.PubKey.ECDSA (Signature(..), PrivateKey(..), PublicKey(..))\nimport Crypto.Types.PubKey.ECC (Curve(CurveFP), CurvePrime(..), CurveCommon(..), Point(..))\n\nimport Codec.Crypto.ECC.Base (modinv)\n\nimport Crypto.Random (genBytes, GenError, CryptoRandomGen)\nimport Crypto.Util (bs2i, i2bs, i2bs_unsized)\n\nimport ECDSA.Util\n\nCould not find module \u2018Crypto.Types.PubKey.ECC\u2019\nUse -v to see a list of the files searched for.\n</code></pre>\n\n<p>How do i import/install these modules? Thanks. </p>\n\n<p>An output of ghc-pkg list</p>\n\n<pre><code> Cabal-2.0.0.2\n    GLURaw-2.0.0.3\n    GLUT-2.7.0.12\n    HTTP-4000.3.7\n    HUnit-1.6.0.0\n    ObjectName-1.1.0.1\n    OpenGL-3.0.2.0\n    OpenGLRaw-3.2.5.0\n    QuickCheck-2.10.0.1\n    StateVar-1.1.0.4\n    array-0.5.2.0\n    async-2.1.1.1\n    attoparsec-0.13.2.0\n    base-4.10.0.0\n    binary-0.8.5.1\n    bytestring-0.10.8.2\n    call-stack-0.1.0\n    case-insensitive-1.2.0.10\n    containers-0.5.10.2\n    deepseq-1.4.3.0\n    directory-1.3.0.2\n    fgl-5.6.0.0\n    filepath-1.4.1.2\n    fixed-0.2.1.1\n    ghc-8.2.1\n    ghc-boot-8.2.1\n    ghc-boot-th-8.2.1\n    ghc-compact-0.1.0.0\n    ghc-prim-0.5.1.0\n    ghci-8.2.1\n    half-0.2.2.3\n    hashable-1.2.6.1\n    haskeline-0.7.4.0\n    haskell-src-1.0.2.0\n    hoopl-3.10.2.2\n    hpc-0.6.0.3\n    hscolour-1.24.1\n    html-1.0.1.2\n    integer-gmp-1.0.1.0\n    integer-logarithms-1.0.2\n    mtl-2.2.1\n    network-2.6.3.2\n    network-uri-2.6.1.0\n    parallel-3.2.1.1\n    parsec-3.1.11\n    pretty-1.1.3.3\n    primitive-0.6.2.0\n    process-1.6.1.0\n    random-1.1\n    regex-base-0.93.2\n    regex-compat-0.95.1\n    regex-posix-0.95.2\n    rts-1.0\n    scientific-0.3.5.1\n    split-0.2.3.2\n    stm-2.4.4.1\n    syb-0.7\n    template-haskell-2.12.0.0\n    terminfo-0.4.1.0\n    text-1.2.2.2\n    tf-random-0.5\n    time-1.8.0.2\n    transformers-0.5.2.0\n    unix-2.7.2.2\n    unordered-containers-0.2.8.0\n    vector-0.12.0.1\n    xhtml-3000.2.2\n    zlib-0.6.1.2\n\n\nname:            ecdsa\nversion:         0.2\ncabal-version:   &gt;= 1.8\nlicense:         OtherLicense\nlicense-file:    COPYING\ncategory:        Crypto\ncopyright:       \u00a9 2014 Stephen Paul Weber\nauthor:          Stephen Paul Weber &lt;singpolyma@singpolyma.net&gt;\nmaintainer:      Stephen Paul Weber &lt;singpolyma@singpolyma.net&gt;\nstability:       experimental\ntested-with:     GHC == 7.4.1\nsynopsis:        Basic ECDSA signing implementation\nhomepage:        https://github.com/singpolyma/ecdsa-haskell\nbug-reports:     https://github.com/singpolyma/ecdsa-haskell/issues\nbuild-type:      Simple\ndescription:\n        Wraps the stuff in hecc to do ECDSA.\n\nextra-source-files:\n        README\n\nlibrary\n        exposed-modules:\n                ECDSA\n\n        other-modules:\n                ECDSA.Util\n\n        build-depends:\n                base == 4.*,\n                bytestring,\n                hecc,\n                crypto-pubkey-types,\n                crypto-api\n\nsource-repository head\n        type:     git\n        location: git://github.com/singpolyma/ecdsa-haskell.git\n</code></pre>\n\n<p>This is the .cabal file, and i downloaded this project from this github link to try to understand it</p>\n\n<p><a href=\"https://github.com/singpolyma/ecdsa-haskell\" rel=\"nofollow noreferrer\">https://github.com/singpolyma/ecdsa-haskell</a></p>\n"}, {"tags": ["haskell", "gloss"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1509285817, "post_id": 47000588, "comment_id": 80948635, "body": "I seem to recall having made a comment about <i>repetitive code</i>... please factor out all that <code>translate</code> stuff so the code isn&#39;t bloated with needless, maintenance- and reading unfriendly repetition!"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1509303476, "post_id": 47000588, "comment_id": 80954522, "body": "You do not &#39;combine&#39; <code>play</code> and <code>animate</code> in any sense - you always use one or the other. You can recover the absolute time since starting the program from a sequence of time deltas by storing the absolute time in the game state (this is a typical solution to this problem.. I&#39;m sure there&#39;s a duplicate somewhere)."}], "answers": [{"tags": [], "owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "is_accepted": true, "score": 1, "last_activity_date": 1509395408, "creation_date": 1509395408, "answer_id": 47023667, "question_id": 47000588, "link": "https://stackoverflow.com/questions/47000588/combining-animation-and-play-functions-in-gloss/47023667#47023667", "title": "Combining `animation` and `play` functions in gloss", "body": "<p>Compare the types of <code>animate</code> and <code>play</code> (and also <code>simulate</code>).\n  <a href=\"https://hackage.haskell.org/package/gloss-1.11.1.1/docs/Graphics-Gloss.html\" rel=\"nofollow noreferrer\">docs/Graphics-Gloss</a>.\n<code>animate</code> is a simplified version of <code>play</code> where you ignore any inputs, and ignore any previous state of the animation.  So have your input handler check whether your're in the first 4 seconds or not, and have your step function do the same.</p>\n"}], "owner": {"reputation": 1142, "user_id": 5180554, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/5OWnC.jpg?s=128&g=1", "display_name": "Alex Goft", "link": "https://stackoverflow.com/users/5180554/alex-goft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "accepted_answer_id": 47023667, "answer_count": 1, "score": 0, "last_activity_date": 1509395408, "creation_date": 1509282882, "question_id": 47000588, "link": "https://stackoverflow.com/questions/47000588/combining-animation-and-play-functions-in-gloss", "title": "Combining `animation` and `play` functions in gloss", "body": "<p>I am implementing a simple Simon game using Haskell with Gloss. I wish, at the moment, that, for example, for the first 4 seconds some rectangles will change their color (or simply in other words show some animation), and afterwards allow colors change using specific keyboard keys input.</p>\n\n<p>This is the code, using <code>animate</code> for an animation:</p>\n\n<pre><code>window :: Display\nwindow = InWindow \"Simon\" (width, height) (offset, offset)\n\nbackground :: Color\nbackground = black\n\ndata SimonGame = Game {\n    rectangleGreen::Picture, \n    rectangleRed::Picture,\n    rectangleBlue::Picture,\n    rectangleYellow::Picture\n} deriving Show\n\ninitialState :: SimonGame\ninitialState = Game\n  { rectangleGreen = translate (-100) (0) $ color green $ rectangleSolid 60 60,\n    rectangleRed = translate (100) (0) $ color red $ rectangleSolid 60 60,\n    rectangleBlue = translate (0) (100)  $  color blue $ rectangleSolid 60 60,\n    rectangleYellow = translate (0) (-100)  $  color yellow $ rectangleSolid 60 60\n  }\n\nrender :: SimonGame -&gt; Picture \nrender game = pictures\n              [ rectangleGreen game,\n                rectangleRed game,\n                rectangleBlue game,\n                rectangleYellow game\n              ]\n\nupdateBoard :: Int-&gt; SimonGame -&gt; SimonGame\nupdateBoard seconds game\n  | sec_value == 1 = game {\n                              rectangleGreen = translate (-100) (0) $ color white  $ rectangleSolid 60 60,\n                              rectangleRed = translate (100) (0) $ color red $ rectangleSolid 60 60,\n                              rectangleBlue = translate (0) (100)  $  color blue $ rectangleSolid 60 60,\n                              rectangleYellow = translate (0) (-100)  $  color yellow $ rectangleSolid 60 60\n                          }\n  | sec_value == 2 = game {\n                              rectangleGreen = translate (-100) (0) $ color green  $ rectangleSolid 60 60,\n                              rectangleRed = translate (100) (0) $ color white $ rectangleSolid 60 60,\n                              rectangleBlue = translate (0) (100)  $  color blue $ rectangleSolid 60 60,\n                              rectangleYellow = translate (0) (-100)  $  color yellow $ rectangleSolid 60 60\n                          }\n  | sec_value == 3 = game {\n                              rectangleGreen = translate (-100) (0) $ color green  $ rectangleSolid 60 60,\n                              rectangleRed = translate (100) (0) $ color red $ rectangleSolid 60 60,\n                              rectangleBlue = translate (0) (100)  $  color white $ rectangleSolid 60 60,\n                              rectangleYellow = translate (0) (-100)  $  color yellow $ rectangleSolid 60 60\n                          }\n  | sec_value == 0 = game {\n                              rectangleGreen = translate (-100) (0) $ color green  $ rectangleSolid 60 60,\n                              rectangleRed = translate (100) (0) $ color red $ rectangleSolid 60 60,\n                              rectangleBlue = translate (0) (100)  $  color blue $ rectangleSolid 60 60,\n                              rectangleYellow = translate (0) (-100)  $  color white $ rectangleSolid 60 60\n                          }\n  | otherwise = game\n  where\n    sec_value = (seconds `mod` 4)\n\n\nmain :: IO ()\nmain = animate window background frame\n  where\n    frame :: Float -&gt; Picture\n    frame seconds = render $ updateBoard (ceiling seconds) initialState\n</code></pre>\n\n<p>I know that using the function <code>play</code> i can somehow implement a logic, that using the function i implemented <code>handleKeys</code>, that takes users input and changes the game state.</p>\n\n<pre><code>handleKeys :: Event -&gt; SimonGame -&gt; SimonGame\nhandleKeys (EventKey (Char 'a') _ _ _) game = game { rectangleGreen = translate (-100) (0) $ color white  $ rectangleSolid 60 60 }\nhandleKeys (EventKey (Char 's') _ _ _) game = game { rectangleRed = translate (100) (0) $ color white $ rectangleSolid 60 60 }\nhandleKeys (EventKey (Char 'd') _ _ _) game = game { rectangleBlue = translate (0) (100)  $  color white $ rectangleSolid 60 60 }\nhandleKeys (EventKey (Char 'f') _ _ _) game = game { rectangleYellow = translate (0) (-100)  $  color white $ rectangleSolid 60 60 }\nhandleKeys _ game = game\n</code></pre>\n\n<p>Is there a way to combine the function <code>play</code> with the function <code>animate</code> so my program will show a short animation and <strong>then</strong> wait for input and act accordingly?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1509275808, "post_id": 46999495, "comment_id": 80945694, "body": "Maybe give your function a type signauter, to give us some hint of what you were thinking. What is u and why does it have the same type as v and why is it <code>Comparable</code>?"}, {"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "reply_to_user": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1509275955, "post_id": 46999495, "comment_id": 80945731, "body": "It should give one the length of a walk to a certain thing in a tree."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1509276122, "post_id": 46999495, "comment_id": 80945775, "body": "What if the thing you want to find is not in a tree?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "edited": false, "score": 0, "creation_date": 1509292171, "post_id": 46999495, "comment_id": 80950823, "body": "@jpath, I don&#39;t know what <code>Comparable</code> is. Purescript? Scala? It&#39;s not a standard or well-known Haskell class. Without a type signature, an <code>Ord</code> constraint will be inferred once the error is corrected."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1509292558, "post_id": 46999495, "comment_id": 80950948, "body": "@MarkNeu, in the future, please give much more information in your questions. You should have explained that the tree is a <i>binary search tree</i>. You should have explained that your function is supposed to find the length of the path to a particular element (trees don&#39;t necessarily have &quot;lengths&quot; in general). You can often get more useful type errors by giving your functions type signatures, but in this case you actually got quite a good error message; you just need to get used to reading them."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509292565, "post_id": 46999495, "comment_id": 80950950, "body": "Separately, you should probably make your function return <code>Maybe Int</code> (or whichever numeric type you want) to deal gracefully with the case where the element is not found."}, {"owner": {"reputation": 2226, "user_id": 2246434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bTuEI.jpg?s=128&g=1", "display_name": "Julia Path", "link": "https://stackoverflow.com/users/2246434/julia-path"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509309091, "post_id": 46999495, "comment_id": 80956261, "body": "@dfeuer Yeah, I meant <code>Ord</code>. I don&#39;t know any language that has <code>Comparable</code> actually."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1509285041, "post_id": 46999541, "comment_id": 80948408, "body": "@WillemVanOnsem He&#39;s looking for the length of the path from the root to <code>u</code>, not the size of the tree."}], "tags": [], "owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "is_accepted": true, "score": 2, "last_activity_date": 1509310346, "last_edit_date": 1509310346, "creation_date": 1509275875, "answer_id": 46999541, "question_id": 46999495, "link": "https://stackoverflow.com/questions/46999495/find-length-of-the-path-in-a-tree-to-a-certain-element/46999541#46999541", "title": "Find length of the path in a tree to a certain element", "body": "<p>I have now found the reason. I was calling <code>tWLength</code> with only one argument in</p>\n\n<pre><code>tWLength  (Node v l r) u        | v == u = 0\n                                | v &lt;  u = 1 + (tWLength l)\n                                | v &gt;  u = 1 + (tWLength r)\n</code></pre>\n\n<p>when it should have been</p>\n\n<pre><code>tWLength  (Node v l r) u        | v == u = 0\n                                | v &lt;  u = 1 + (tWLength l u)\n                                | v &gt;  u = 1 + (tWLength r u)\n</code></pre>\n"}], "owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 46999541, "answer_count": 1, "score": -2, "last_activity_date": 1509310750, "creation_date": 1509275527, "last_edit_date": 1509310750, "question_id": 46999495, "link": "https://stackoverflow.com/questions/46999495/find-length-of-the-path-in-a-tree-to-a-certain-element", "title": "Find length of the path in a tree to a certain element", "body": "<p>I have tried this:</p>\n\n<pre><code>tWLength  (Node v l r) u            | v == u = 0\n                                    | v &lt;  u = 1 + (tWLength l)\n                                    | v &gt;  u = 1 + (tWLength r)\n</code></pre>\n\n<p>However it returns (in WinGHCi):</p>\n\n<pre><code>experiments\\treetest.hs:170:1: error:\n    \u2022 Occurs check: cannot construct the infinite type: a1 ~ a -&gt; a1\n      Expected type: Tree a -&gt; a1\n        Actual type: Tree a -&gt; a -&gt; a1\n    \u2022 Relevant bindings include\n        tWLength :: Tree a -&gt; a1 (bound at experiments\\treetest.hs:170:1)\n    |\n170 | tWLength  (Node v l r) u            | v == u = 0\n    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^...\n</code></pre>\n\n<p>The tree is defined as:</p>\n\n<pre><code>data Tree a = NullTree | Node a (Tree a) (Tree a) deriving (Show, Read, Eq, Ord)\n</code></pre>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1509274313, "post_id": 46999259, "comment_id": 80945298, "body": "what is <code>n</code>? Can you provide valid inputs where your function failed? I think your problem is <i>underspecified</i> right now."}, {"owner": {"reputation": 19, "user_id": 8851199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eff8e3eb97d5f3091cd1b2e5ba98cbc?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/8851199/j-doe"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509274662, "post_id": 46999259, "comment_id": 80945395, "body": "Sorry, n is the length that the input list needs to be to be valid. so if n = 4 then the length of the input list needs to equal four. Its just an extra constraint on the input list in addition to needing all its elements be in listb."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1509282379, "post_id": 46999259, "comment_id": 80947576, "body": "How does it fail?"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1509292860, "post_id": 47000527, "comment_id": 80951037, "body": "The constraint should either be <code>Ord a</code>, <code>(Eq a, Hashable a)</code>, or <code>Enum a</code>. Just <code>Eq a</code> admits only inefficient implementations."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509298817, "post_id": 47000527, "comment_id": 80952972, "body": "@dfeuer indeed you are right - for any production grade, or better non learning grade version of this problem I would use existing data structures like <code>HashMap</code> or <code>Set</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509308853, "post_id": 47000527, "comment_id": 80956188, "body": "Even for &quot;learning grade&quot;, most students understand <code>sort</code>. You can get tolerable performance with just that and some care."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 2, "last_activity_date": 1509282500, "creation_date": 1509282500, "answer_id": 47000527, "question_id": 46999259, "link": "https://stackoverflow.com/questions/46999259/haskell-how-to-search-if-elements-of-one-list-exist-in-another/47000527#47000527", "title": "Haskell - How to search if elements of one list exist in another", "body": "<p>Your code has a few problems:</p>\n\n<ol>\n<li><p>Types start with upper-case letters, where type variables start lower case, thus </p>\n\n<pre><code>function :: [char] -&gt; Bool\n</code></pre>\n\n<p>is not what you want, but either <code>function :: [Char] -&gt; Bool</code> which I would write <code>isSubSet :: String -&gt; Bool</code> or more general <code>isSubSet :: Eq a =&gt; [a] -&gt; Bool</code>.</p></li>\n<li><p>Usually in haskell you do not use global constants like</p>\n\n<pre><code>listB :: [Char]\nlistB = ['a'..'d']\n</code></pre></li>\n<li><p>But rather parametrize functions - so </p>\n\n<pre><code>isSubSetOf :: String -&gt; String -&gt; Bool\nisSubSetOf [] _ = True\nisSubSetOf small@(x:xs) big = (length small &lt;= length big)\n                           &amp;&amp; (x `elem` big &amp;&amp; isSubsetOf xs big)\n\nisSubSet x = isSubSetOf x listB\n</code></pre></li>\n</ol>\n\n<p>would be a correct implementation by type signature and it is a total function, which is a fancy way of saying - all cases of input types are handled, you missed the base case for lists, i.e. handling the empty list.</p>\n\n<p>But it has a few (logical) errors which you need to solve:</p>\n\n<ul>\n<li>checking for <code>length</code> in every step is not necessary, in fact it is not necessary at all - and it is slowing down your algorithm!</li>\n<li>look at the test case like <code>isSubSetOf \"aab\" \"abbb\"</code>.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 4, "last_activity_date": 1509293677, "creation_date": 1509293677, "answer_id": 47002400, "question_id": 46999259, "link": "https://stackoverflow.com/questions/46999259/haskell-how-to-search-if-elements-of-one-list-exist-in-another/47002400#47002400", "title": "Haskell - How to search if elements of one list exist in another", "body": "<p>It sounds like you're trying to check two unrelated things:</p>\n\n<ol>\n<li><p>Are the elements of a list <code>xs</code> a subset of the elements of another list, <code>ys</code>?</p></li>\n<li><p>Is the length of <code>xs</code> at most <code>n</code>?</p></li>\n</ol>\n\n<p>The easy thing to do is check these separately.</p>\n\n<pre><code>import qualified Data.Set as S\n\nisSubset :: Ord a =&gt; [a] -&gt; [a] -&gt; Bool\nisSubset xs ys = all (`S.member` yset) xs where\n  yset = S.fromList ys\n\nlengthAtMost :: Int -&gt; [a] -&gt; Bool\nlengthAtMost n _ | n &lt; 0 = False\nlengthAtMost _ [] = True\nlengthAtMost n (_ : xs) = lengthAtMost (n-1) xs\n</code></pre>\n\n<p>You can save some more time by weaving these operations together, but my phone is running out of batteries, so I'll leave that for later.</p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 3, "last_activity_date": 1509308380, "creation_date": 1509308380, "answer_id": 47004828, "question_id": 46999259, "link": "https://stackoverflow.com/questions/46999259/haskell-how-to-search-if-elements-of-one-list-exist-in-another/47004828#47004828", "title": "Haskell - How to search if elements of one list exist in another", "body": "<p>Generalizing the concept to any type being an instance of <code>Eq</code> class, you may simply do as follows;</p>\n\n<pre><code>import Control.Applicative\n\nexists :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool\nexists x y = any id $ (==) &lt;$&gt; x &lt;*&gt; y\n\n*Main&gt; exists [1,2,3] [3,4,5]\nTrue\n*Main&gt; exists [1,2,3] [7,4,5]\nFalse\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8851199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eff8e3eb97d5f3091cd1b2e5ba98cbc?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/8851199/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3552, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1509308380, "creation_date": 1509274027, "last_edit_date": 1509274148, "question_id": 46999259, "link": "https://stackoverflow.com/questions/46999259/haskell-how-to-search-if-elements-of-one-list-exist-in-another", "title": "Haskell - How to search if elements of one list exist in another", "body": "<p>I'm trying to define a function in Haskell that will check if elements in list A are all in list B and return a Boolean.</p>\n\n<p>So given the following:</p>\n\n<pre><code>listb = [a,b,c,d]\n\nfunction :: [char]-&gt;Bool\n</code></pre>\n\n<p>the function should check that the input list only contains elements of listb\nthe input list also <em>cannot exceed a length of n</em>.</p>\n\n<p>These are some of the methods I've tried but none of them seem to work:</p>\n\n<pre><code>function :: [char] -&gt; Bool\nfunction xs = length xs == n &amp;&amp; isElem xs\n\nisElem :: [char] -&gt; Bool\nisElem (x:xs) = x  `elem` listb &amp;&amp; isElem xs\n</code></pre>\n\n<p>This failed for valid inputs.</p>\n\n<p>Ive also tried:</p>\n\n<pre><code>function :: [char] -&gt; Bool\nfunction xs = length xs == n &amp;&amp; whileValid xs\n\nwhileValid :: [char] -&gt; Bool\nwhileValid (x:xs)\n    |x `elem` listb = True &amp;&amp; whileValid xs\n    |otherwise = False\n</code></pre>\n\n<p>This fails for the same reason.</p>\n\n<p>What is wrong about these methods and how do I define this function for it to work?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509268990, "post_id": 46997569, "comment_id": 80943920, "body": "<code>g v xs = [x | x &lt;- xs, x ..... v]</code>. means, &quot;list of each x in xs, such that <code>x ..... v</code> holds&quot;.  What should <code>.....</code> be? ---- in your code, you probably meant <code>maxnums n (x:xs) = [x | n &lt; x] ++ maxnums v xs</code>. Will any list always match the pattern <code>(x:xs)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 1568210, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1002efe0fd5f4510f07f366cc8b5b95?s=128&d=identicon&r=PG", "display_name": "Cosmic Badal", "link": "https://stackoverflow.com/users/1568210/cosmic-badal"}, "edited": false, "score": 0, "creation_date": 1509283711, "post_id": 46997668, "comment_id": 80947995, "body": "thanks peri4n. That worked. But where do you specify on the 2 input arguments i.e. 1&gt; variable 2&gt; list . eg 5 [2,3,4,5]"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 3, "user_id": 1568210, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1002efe0fd5f4510f07f366cc8b5b95?s=128&d=identicon&r=PG", "display_name": "Cosmic Badal", "link": "https://stackoverflow.com/users/1568210/cosmic-badal"}, "edited": false, "score": 0, "creation_date": 1509285239, "post_id": 46997668, "comment_id": 80948470, "body": "@CosmicBadal <code>filter</code> is only partially applied, and so has the desired type. This is just a simpler way of writing <code>maxNumbers x xs = filter (&gt;x) xs</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509285816, "post_id": 46997668, "comment_id": 80948634, "body": "One could go completely point-free and write <code>maxNumbers = filter . flip (&gt;)</code> (ew) or <code>maxNumbers = filter . (&lt;=)</code>, but answer strikes a sweet spot between brevity and readability."}, {"owner": {"reputation": 3, "user_id": 1568210, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1002efe0fd5f4510f07f366cc8b5b95?s=128&d=identicon&r=PG", "display_name": "Cosmic Badal", "link": "https://stackoverflow.com/users/1568210/cosmic-badal"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509294449, "post_id": 46997668, "comment_id": 80951497, "body": "@chepner Wow thank you. Can you explain the first line of the code. i.e. maxNumbers :: Ord a =&gt; a =&gt; [a] -&gt; [a]. I got the last [a] is the returning list."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509308010, "post_id": 46997668, "comment_id": 80955890, "body": "The <code>a</code> is the threshold below which you want to remove items; the first <code>[a]</code> is the list you are filtering. Since <code>maxNumbers :: a -&gt; [a] -&gt; [a]</code>, then <code>maxNumbers x :: [a] -&gt; [a]</code>, the same as <code>filter (&gt; x)</code>."}], "tags": [], "owner": {"reputation": 1293, "user_id": 928752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f6d5c7f8aa0457cf0c231eab69cb539d?s=128&d=identicon&r=PG", "display_name": "peri4n", "link": "https://stackoverflow.com/users/928752/peri4n"}, "is_accepted": true, "score": 5, "last_activity_date": 1509260619, "creation_date": 1509260619, "answer_id": 46997668, "question_id": 46997569, "link": "https://stackoverflow.com/questions/46997569/construct-a-list-of-all-the-integers-in-a-list-l-which-are-greater-than-a-given/46997668#46997668", "title": "Construct a list of all the integers in a list l which are greater than a given value v in Haskell", "body": "<p>What is lacking in your signature is a way to tell haskell that the elements in your list can be ordered (the <code>Ord</code> typeclass). This is not true for every type so you have to take that into account.</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>maxNumbers :: Ord a =&gt; a -&gt; [a] -&gt; [a]\nmaxNumbers x = filter (&gt;x)\n</code></pre>\n\n<p>Is an implementation that should work.</p>\n"}], "owner": {"reputation": 3, "user_id": 1568210, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1002efe0fd5f4510f07f366cc8b5b95?s=128&d=identicon&r=PG", "display_name": "Cosmic Badal", "link": "https://stackoverflow.com/users/1568210/cosmic-badal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 46997668, "answer_count": 1, "score": 0, "last_activity_date": 1509266668, "creation_date": 1509259825, "last_edit_date": 1509266668, "question_id": 46997569, "link": "https://stackoverflow.com/questions/46997569/construct-a-list-of-all-the-integers-in-a-list-l-which-are-greater-than-a-given", "title": "Construct a list of all the integers in a list l which are greater than a given value v in Haskell", "body": "<p>I would expect </p>\n\n<p>input : <code>maxNumbers 5 [1,4,5,6,8,4,5,8]</code></p>\n\n<p>output : <code>[6,8,8]</code></p>\n\n<p><strong>My Approach:</strong> </p>\n\n<pre><code>maxNumbers ::a =&gt;[a] -&gt; [a]\nmaxNumbers n (x:xs) = enumFrom(n &lt; x) + maxNumbers n xs\n</code></pre>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1509227479, "post_id": 46994665, "comment_id": 80936077, "body": "That diagram used to be correct, but since then they removed some arrows from that (and added others, e.g. functor =&gt; applicative =&gt; monad)."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1509241037, "post_id": 46994665, "comment_id": 80938658, "body": "Eurgh. That is awful, what is such an outdated hierarchy diagram doing on Wikibooks? Anybody active there? I <a href=\"https://github.com/leftaroundabout/haskell-report/blob/b30d2690e4dfc5cda8022eea488ce60944b8139c/report/classes.pdf\" rel=\"nofollow noreferrer\">made an updated version of the diagram</a>, just in case..."}], "answers": [{"tags": [], "owner": {"reputation": 1946, "user_id": 1432740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a84709030a711eb919bec460051eac8?s=128&d=identicon&r=PG", "display_name": "Mateusz Kowalczyk", "link": "https://stackoverflow.com/users/1432740/mateusz-kowalczyk"}, "is_accepted": true, "score": 9, "last_activity_date": 1509226654, "creation_date": 1509226654, "answer_id": 46994733, "question_id": 46994665, "link": "https://stackoverflow.com/questions/46994665/typeclass-constraints-necessary-for-a-function-that-prints-integers-not-greater/46994733#46994733", "title": "Typeclass constraints necessary for a function that prints integers not greater than 10 in Haskell?", "body": "<p>The diagram is simply quite out of date. On GHC 8.0.2 (and any after 7.4?)</p>\n\n<pre><code>Prelude&gt; :i Num\nclass Num a where\n  (+) :: a -&gt; a -&gt; a\n  (-) :: a -&gt; a -&gt; a\n  (*) :: a -&gt; a -&gt; a\n  negate :: a -&gt; a\n  abs :: a -&gt; a\n  signum :: a -&gt; a\n  fromInteger :: Integer -&gt; a\n  {-# MINIMAL (+), (*), abs, signum, fromInteger, (negate | (-)) #-}\n    -- Defined in \u2018GHC.Num\u2019\ninstance Num Word -- Defined in \u2018GHC.Num\u2019\ninstance Num Integer -- Defined in \u2018GHC.Num\u2019\ninstance Num Int -- Defined in \u2018GHC.Num\u2019\ninstance Num Float -- Defined in \u2018GHC.Float\u2019\ninstance Num Double -- Defined in \u2018GHC.Float\u2019\n</code></pre>\n\n<p><code>Integral</code> does not impose <code>Show</code> therefore the <code>Show</code> constraint has to be given explicitly due to your <code>show</code> usage.</p>\n"}], "owner": {"reputation": 113, "user_id": 8840662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af241ced103eaaf6b9a75891528c74d0?s=128&d=identicon&r=PG&f=1", "display_name": "IMK", "link": "https://stackoverflow.com/users/8840662/imk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 1, "closed_date": 1509227375, "accepted_answer_id": 46994733, "answer_count": 1, "score": 1, "last_activity_date": 1509226654, "creation_date": 1509226119, "question_id": 46994665, "link": "https://stackoverflow.com/questions/46994665/typeclass-constraints-necessary-for-a-function-that-prints-integers-not-greater", "closed_reason": "Duplicate", "title": "Typeclass constraints necessary for a function that prints integers not greater than 10 in Haskell?", "body": "<p>I'm trying to program in Haskell a function that takes an integer and prints it only if it is less than or equal to 10.</p>\n\n<p>In ghci, executing a function programmed like this:</p>\n\n<p><code>sayMeUntilTen :: (Integral a, Show a) =&gt; a -&gt; String\nsayMeUntilTen x = if x &lt;= 10 then  show x else \"Sorry, greater than 10\"</code></p>\n\n<p>works. </p>\n\n<p>However if I don't include the constraint <code>Show a</code> ghci displays the following error:</p>\n\n<blockquote>\n  <p>\u2022 Could not deduce (Show a) arising from a use of \u2018show\u2019\n       from the context: </p>\n  \n  <p>Integral a\n         bound by the type signature for:\n                    sayMeUntilTen :: forall a. Integral a => a -> String</p>\n  \n  <p>Possible fix:\n         add (Show a) to the context of\n           the type signature for:\n             sayMeUntilTen :: forall a. Integral a => a -> String</p>\n</blockquote>\n\n<p>I don't understand why adding <code>Show a</code> is necessary. Isn't <code>Integral</code> like a \"subset\" of <code>Show</code>? Looking for information I found this website: <a href=\"https://en.wikibooks.org/wiki/Haskell/Classes_and_types\" rel=\"nofollow noreferrer\">https://en.wikibooks.org/wiki/Haskell/Classes_and_types</a></p>\n\n<p>It describes the inheritance relations between typeclases in Haskell with this picture:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Rex1J.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rex1J.png\" alt=\"enter image description here\"></a></p>\n\n<p>It leads me to think that the <code>Show</code> type class constraint is already implied by the <code>Integral</code> one but there is obviously something I'm misunderstanding. </p>\n\n<p><strong>Could anyone explain to me why is <code>Show</code> necessary ?</strong></p>\n\n<p>Sorry if the question is too stupid, I'm just trying to learn.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509217648, "post_id": 46993405, "comment_id": 80933335, "body": "Shouldn&#39;t you write it all in one line? <code>m &gt;&gt;= \\mvar -&gt; modifyMVar_ mvar (\\_ -&gt; return &quot;bar&quot;) &gt;&gt; readMVar</code>?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1509220731, "post_id": 46993405, "comment_id": 80934199, "body": "I&#39;d recommend you read about <a href=\"https://stackoverflow.com/questions/28624408/equal-vs-left-arrow-symbols-in-haskell\"><code>let</code> vs <code>&lt;-</code></a>. Above you used <code>let</code> when you meant <code>&lt;-</code>, I think."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1509221207, "post_id": 46993405, "comment_id": 80934362, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/46959753/setting-off-a-interval-on-application-launch-in-a-haskell-servant-app\">Setting off a interval on application launch in a Haskell Servant app</a>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1509221599, "post_id": 46993405, "comment_id": 80934471, "body": "@jberryman that question&#39;s code is so much more involved though. here it is simple, short. also, the setting and specific types are different."}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 4, "creation_date": 1509221417, "post_id": 46993500, "comment_id": 80934421, "body": "Phrased differently. <code>m</code> is not an MVar."}], "tags": [], "owner": {"reputation": 1946, "user_id": 1432740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a84709030a711eb919bec460051eac8?s=128&d=identicon&r=PG", "display_name": "Mateusz Kowalczyk", "link": "https://stackoverflow.com/users/1432740/mateusz-kowalczyk"}, "is_accepted": true, "score": 8, "last_activity_date": 1509218052, "creation_date": 1509218052, "answer_id": 46993500, "question_id": 46993405, "link": "https://stackoverflow.com/questions/46993405/understanding-modifymvar/46993500#46993500", "title": "Understanding `modifyMVar_`", "body": "<p><code>m</code> creates new <code>MVar</code> with <code>\"foo\"</code> every time it's called. You're modifying one <code>MVar</code> then making a new one and checking that. It is the same problem as seen here <a href=\"https://stackoverflow.com/questions/46959753/setting-off-a-interval-on-application-launch-in-a-haskell-servant-app\">Setting off a interval on application launch in a Haskell Servant app</a> with exception that there it was an <code>IORef</code>.</p>\n\n<pre><code>myVar &lt;- m\nmodifyMVar_ myVar (\\_ -&gt; return \"bar\")\nreadMVar myVar\n</code></pre>\n\n<p>This should give you <code>\"bar\"</code> as expected.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 46993500, "answer_count": 1, "score": 2, "last_activity_date": 1509218052, "creation_date": 1509217480, "question_id": 46993405, "link": "https://stackoverflow.com/questions/46993405/understanding-modifymvar", "title": "Understanding `modifyMVar_`", "body": "<p>Given:</p>\n\n<pre><code>\u03bb: &gt;let m = newMVar \"foo\"\n\n\u03bb: &gt;m &gt;&gt;= readMVar \n\"foo\"\n</code></pre>\n\n<p>I tried to use <code>modifyMVar_</code>:</p>\n\n<pre><code>\u03bb: &gt;:t modifyMVar_\nmodifyMVar_ :: MVar a -&gt; (a -&gt; IO a) -&gt; IO ()\n</code></pre>\n\n<p>through:</p>\n\n<pre><code>\u03bb: &gt;m &gt;&gt;= \\mvar -&gt; modifyMVar_ mvar (\\_ -&gt; return \"bar\")\n</code></pre>\n\n<p>But, it doesn't look like it modified <code>m</code> from <code>\"foo\"</code> to <code>\"bar\"</code>.</p>\n\n<pre><code>\u03bb: &gt;m &gt;&gt;= readMVar \n\"foo\"\n</code></pre>\n\n<p>What'd I do wrong?</p>\n"}, {"tags": ["haskell", "dynamic", "types", "polymorphism", "generic-programming"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1509213416, "post_id": 46992740, "comment_id": 80931997, "body": "What would be the type of the resulting list? Something like this is likely possible using the new reflection machinery, but you&#39;d need to return an HList at the very least."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1509213441, "post_id": 46992740, "comment_id": 80932002, "body": "A list can only consists out of <i>one</i> type of elements."}, {"owner": {"reputation": 243, "user_id": 7252948, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bcg6i.jpg?s=128&g=1", "display_name": "errfrom", "link": "https://stackoverflow.com/users/7252948/errfrom"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509213650, "post_id": 46992740, "comment_id": 80932044, "body": "@WillemVanOnsem Edited."}, {"owner": {"reputation": 243, "user_id": 7252948, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bcg6i.jpg?s=128&g=1", "display_name": "errfrom", "link": "https://stackoverflow.com/users/7252948/errfrom"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1509213840, "post_id": 46992740, "comment_id": 80932102, "body": "@Alec In my situation it should be turned into dynamic later."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509216530, "post_id": 46993143, "comment_id": 80932975, "body": "P.S. I am very sad that <code>[] @ByteString</code> doesn&#39;t work."}, {"owner": {"reputation": 243, "user_id": 7252948, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bcg6i.jpg?s=128&g=1", "display_name": "errfrom", "link": "https://stackoverflow.com/users/7252948/errfrom"}, "edited": false, "score": 0, "creation_date": 1509216594, "post_id": 46993143, "comment_id": 80932991, "body": "Seems, it doesn&#39;t solve the problem of specifying type based on <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Typeable.html#t:TypeRep\" rel=\"nofollow noreferrer\">TypeRep</a>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 243, "user_id": 7252948, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bcg6i.jpg?s=128&g=1", "display_name": "errfrom", "link": "https://stackoverflow.com/users/7252948/errfrom"}, "edited": false, "score": 0, "creation_date": 1509216698, "post_id": 46993143, "comment_id": 80933026, "body": "@errfrom Correct, you must specify it based on <code>Evidence</code> or the new <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Type-Reflection.html\" rel=\"nofollow noreferrer\"><code>TypeRep :: k -&gt; *</code></a>. But I don&#39;t see this as an issue: just replace <code>typeRep (Proxy :: Proxy a)</code> with <code>Evidence ([] :: [a])</code> everywhere (or save both if you need the <code>typeRep</code> for other uses); it&#39;s even characters saved."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1509217195, "post_id": 46993143, "comment_id": 80933183, "body": "@DanielWagner True, but what should that do in the presence of <code>OverloadedLists</code>? In that case, the application should likely be for container type rather than the contained type."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1509217528, "post_id": 46993143, "comment_id": 80933294, "body": "@Alec So what if it doesn&#39;t work with <code>OverloadedLists</code>? Lots of things break when you turn on pragmas."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1509216434, "last_edit_date": 1509216434, "creation_date": 1509215703, "answer_id": 46993143, "question_id": 46992740, "link": "https://stackoverflow.com/questions/46992740/how-to-specify-type-of-value-via-typerep/46993143#46993143", "title": "How to specify type of value via &#39;TypeRep&#39;?", "body": "<p>Hold my beer.</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE ConstraintKinds #-}\n{-# LANGUAGE OverloadedStrings #-}\n\nimport Data.ByteString (ByteString)\nimport Data.String\nimport Data.Text (Text)\n\ndata Forall c where Forall :: (forall a. c a =&gt; a) -&gt; Forall c\ndata Exists c where Exists :: c a =&gt; a -&gt; Exists c\ndata Evidence c where Evidence :: c a =&gt; proxy a -&gt; Evidence c\n\ninstance c ~ IsString =&gt; IsString (Forall c) where\n    fromString s = Forall (fromString s)\n\nasProxyType :: proxy a -&gt; a -&gt; a\nasProxyType = const id\n\ndowncast :: Evidence c -&gt; Forall c -&gt; Exists c\ndowncast (Evidence proxy) (Forall v) = Exists (asProxyType proxy v)\n\npolymorphicStrings :: c ~ IsString =&gt; [Forall c]\npolymorphicStrings = [\"one\", \"two\"]\n\ntypes :: c ~ IsString =&gt; [Evidence c]\ntypes = [Evidence ([] :: [ByteString]), Evidence ([] :: [Text])]\n\nmonomorphicStrings :: c ~ IsString =&gt; [Exists c]\nmonomorphicStrings = zipWith downcast types polymorphicStrings\n</code></pre>\n\n<p>To connect with the question as asked: <code>Exists Typeable</code> is isomorphic to <code>Dynamic</code>. You might need to generalize <code>Forall, Exists :: Constraint -&gt; *</code> to <code>Forall, Exists :: [Constraint] -&gt; *</code> to comfortably support both <code>IsString</code> and <code>Typeable</code> at once, which is a bit of type-level hacking but nothing too strenuous. Type families can give you an <code>Elem :: Constraint -&gt; [Constraint] -&gt; Bool</code> which can be used to replace <code>c ~ IsString</code> everywhere above.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509216882, "post_id": 46993294, "comment_id": 80933076, "body": "Classic <code>Data.Typeable</code> won&#39;t work for this too: it doesn&#39;t offer <code>eqTypeRep</code> to get a type-level equality, only term-level equality. You&#39;d need <code>unsafeCoerce</code> or similar instead."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1509216984, "post_id": 46993294, "comment_id": 80933113, "body": "This is exactly the solution I had in mind. I love the new <code>Type.Reflection</code> module. :)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1509216996, "post_id": 46993294, "comment_id": 80933121, "body": "Also this seems to require you to know the list of possible types one might ask for ahead of time, right? (Here one couldn&#39;t add <code>SomeTypeRep (typeRep @ByteString)</code> to <code>types</code> without modifying <code>convert</code> -- so <code>convert</code> can&#39;t be forward-compatible with new instances of <code>IsString</code>.)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509217505, "post_id": 46993294, "comment_id": 80933289, "body": "@DanielWagner <code>convert</code> is really doing a lookup in a dependent map (keys being types <code>T</code>, values being functions <code>String -&gt; T</code>) and then applying the function. A more general implementation would accept as input any such map, making it extensible in such a way."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1509217605, "post_id": 46993294, "comment_id": 80933322, "body": "@user2407038 Hey, guess what, <code>fromString</code> is doing that too! Why not reuse that machinery? (...like my answer does, hint hint.) (Also that mapping isn&#39;t dependent. Dependent goes <code>term -&gt; type</code>; this goes <code>type -&gt; term</code>.)"}, {"owner": {"reputation": 243, "user_id": 7252948, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bcg6i.jpg?s=128&g=1", "display_name": "errfrom", "link": "https://stackoverflow.com/users/7252948/errfrom"}, "edited": false, "score": 0, "creation_date": 1509219069, "post_id": 46993294, "comment_id": 80933735, "body": "@dfeuer Your desicion based on typereps comparison fit me the most. Thank you =)"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 5, "last_activity_date": 1509216752, "creation_date": 1509216752, "answer_id": 46993294, "question_id": 46992740, "link": "https://stackoverflow.com/questions/46992740/how-to-specify-type-of-value-via-typerep/46993294#46993294", "title": "How to specify type of value via &#39;TypeRep&#39;?", "body": "<p>I can't really imagine your purpose, but the code will probably look something like this. I'm using the new <code>Type.Reflection</code> interface because I'm more familiar with it than with the classic <code>Data.Typeable</code>, but that should work for this too.</p>\n\n<pre><code>import Type.Reflection\n\ntypes :: [SomeTypeRep]\ntypes = [SomeTypeRep (typeRep @String), SomeTypeRep (typeRep @Text)]\n\nstrings :: [String]\nstrings = [\"one\", \"two\"]\n\nconverted :: [Dynamic]\nconverted = fromJust $ zipWithM convert types strings\n\nconvert :: SomeTypeRep -&gt; String -&gt; Maybe Dynamic\nconvert (SomeTypeRep rep) s\n  | Just HRefl &lt;- eqTypeRep rep (typeRep @String) = Just $ toDynamic s\n  | Just HRefl &lt;- eqTypeRep rep (typeRep @Text) = Just $ toDynamic (fromString s)\n  | otherwise = Nothing\n</code></pre>\n"}], "owner": {"reputation": 243, "user_id": 7252948, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bcg6i.jpg?s=128&g=1", "display_name": "errfrom", "link": "https://stackoverflow.com/users/7252948/errfrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 46993294, "answer_count": 2, "score": 1, "last_activity_date": 1509216752, "creation_date": 1509213157, "last_edit_date": 1509214076, "question_id": 46992740, "link": "https://stackoverflow.com/questions/46992740/how-to-specify-type-of-value-via-typerep", "title": "How to specify type of value via &#39;TypeRep&#39;?", "body": "<p>My aim is to write function that takes some polymorphic values and list with typereps representing concrete types. It returns new list with the same values but already casted to concrete types specified via typereps.  </p>\n\n<p>Let we have such list of values: <code>[\"one\", \"two\"]</code> with <code>-XOverloadedStrings</code> enabled.<br>\nRespectively, type of each one is <code>IsString a =&gt; a</code>.  </p>\n\n<p>List of typereps we could get in such way: </p>\n\n<pre><code>import Data.Typeable (Proxy(..), typeRep)\nimport Data.Text     (Text)\n\n[typeRep (Proxy :: Proxy String), typeRep (Proxy :: Proxy ByteString)]\n</code></pre>\n\n<p>Is there any way to get <code>\"one\"</code> of type <code>String</code> and <code>\"two\"</code> of type <code>ByteString</code>?</p>\n\n<p>P.S. To prevent error according to list containing values of different types, we may wrap every value in <code>Dynamic.</code>, as in the example below(pseudocode): </p>\n\n<pre><code> {-# LANGUAGE ParallelListComp #-}\n\n import Data.Dynamic (toDyn)\n\n [ toDyn (val :: type') | val &lt;- vals | type' &lt;- concreteTypes ]\n</code></pre>\n\n<p><em>It could be done using Template Haskell, but it will be too ugly.</em></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1946, "user_id": 1432740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a84709030a711eb919bec460051eac8?s=128&d=identicon&r=PG", "display_name": "Mateusz Kowalczyk", "link": "https://stackoverflow.com/users/1432740/mateusz-kowalczyk"}, "edited": false, "score": 1, "creation_date": 1509211489, "post_id": 46992307, "comment_id": 80931495, "body": "Looks correct to me."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 2, "creation_date": 1509211895, "post_id": 46992307, "comment_id": 80931585, "body": "Your intuition is exactly right. Next, you should tackle the <code>Monad</code> instance. In studying the instances for <code>(-&gt;) r</code>, you can also gain valuable intuitions for other applicatives and monads."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8583928"}, "edited": false, "score": 0, "creation_date": 1509214270, "post_id": 46992307, "comment_id": 80932225, "body": "Thanks guys! It&#39;s very mathematically rewarding to derive a result with pen and paper after noticing that an empirical approach to understanding fails miserably. And sure thing, monad instance next."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509269517, "post_id": 46992307, "comment_id": 80944070, "body": "writing  this with redundant parentheses might make it clearer and easier to read, like <code>(f &lt;*&gt; g &lt;*&gt; h &lt;*&gt; v) z = (f z) (g z) (h z) (v z)</code>.  it is also <code>sequenceA [f,g,h,v] z = [f z, g z, h z, v z]</code>. in general, <code>instance Applicative ((-&gt;) x) where pure v x = v ; (f &lt;*&gt; g) x = (f x) $ (g x)</code> too can be easier to read."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8583928"}, "edited": false, "score": 0, "creation_date": 1509279730, "post_id": 46992307, "comment_id": 80946793, "body": "Will, I like the symmetry in the form <code>(f z) (g z) (h z) (v z)</code>, but also like <code>f z (g z) (h z) (v z)</code> simply because it explicitly shows that there are four arguments supplied to <code>f.</code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509308735, "post_id": 46992307, "comment_id": 80956138, "body": "btw <code>(\\z g -&gt; g)</code> is just <code>pure id</code>. see? you thought about it in a special way, but it isn&#39;t special. It&#39;s an <code>id</code> supplied with <i>one</i> argument, <code>(++)</code>. :) I find it much <a href=\"https://stackoverflow.com/a/45516443/849891\">easier</a> to think with <a href=\"https://en.wikipedia.org/wiki/Combinatory_logic\" rel=\"nofollow noreferrer\">combinatory</a> equations, than with lambda definitions. <code>f = \\x -&gt; \\y -&gt; \\z -&gt; g</code> === <code>f x y z = g</code>, &quot;what&#39;s the problem?&quot;"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509309150, "post_id": 46992307, "comment_id": 80956287, "body": "your question is great as it shows that it is much easier to learn stuff when we put several/many related things side-by-side, like your <code>f&lt;*&gt;g&lt;*&gt;h</code> and <code>f&lt;*&gt;g&lt;*&gt;h&lt;*&gt;v</code>. Just one definition is usually given, for the <code>f&lt;*&gt;g</code>, which we need to &quot;understand&quot; then. But with multiple definitions, we can <i>see</i> the pattern. Human cognition is much tied up with our visual perception. This should be acknowledged and used more. Same with <code>sequenceA [f,g,h] z = [f z, g z, h z]</code>, which <i>looks</i> &quot;the same&quot; in a way, just &quot;parens&quot; are different. Multiple examples kind of &quot;show&quot; <i>why</i> a feature is needed."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1509319265, "post_id": 46992618, "comment_id": 80959093, "body": "I would add: <code>&lt;*&gt;</code> in the function applicative is the S combinator from combinatory logic: S <i>f</i> <i>g</i> <i>e</i> = <i>f</i> <i>e</i> (<i>g</i> <i>e</i>); it applies <i>f</i> to <i>g</i>, where each of them can access the \u201cenvironment\u201d <i>e</i>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1509212423, "creation_date": 1509212423, "answer_id": 46992618, "question_id": 46992307, "link": "https://stackoverflow.com/questions/46992307/an-intuitive-idea-of-the-arrow-operator-applicative/46992618#46992618", "title": "An intuitive idea of the arrow operator applicative", "body": "<p>Yes, your calculations are correct.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8583928"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 46992618, "answer_count": 1, "score": 4, "last_activity_date": 1509212423, "creation_date": 1509210294, "last_edit_date": 1509211005, "question_id": 46992307, "link": "https://stackoverflow.com/questions/46992307/an-intuitive-idea-of-the-arrow-operator-applicative", "title": "An intuitive idea of the arrow operator applicative", "body": "<p>I had a couple of hours of fun today trying to understand what the arrow operator applicative does in Haskell. I am now trying to verify whether my understanding is correct. In short, I found that for the arrow operator applicative</p>\n\n<pre><code> (f &lt;*&gt; g &lt;*&gt; h &lt;*&gt; v) z = f z (g z) (h z) (v z)\n</code></pre>\n\n<p>Before I proceed, I am aware of <a href=\"https://softwareengineering.stackexchange.com/questions/348233/how-is-arrow-operator-an-applicative-functor-in-haskell\">this discussion</a> but found it to be very convoluted and much more complicated than what I hope I derived today.</p>\n\n<p>In order to understand what the applicative does I started from the definition of the arrow applicative in base</p>\n\n<pre><code>instance Applicative ((-&gt;) a) where\n    pure = const\n    (&lt;*&gt;) f g x = f x (g x)\n</code></pre>\n\n<p>and then proceeded to explore what the expressions</p>\n\n<pre><code>(f &lt;*&gt; g &lt;*&gt; h) z\n</code></pre>\n\n<p>and</p>\n\n<pre><code>(f &lt;*&gt; g &lt;*&gt; h &lt;*&gt; v) z\n</code></pre>\n\n<p>yield when expanded.</p>\n\n<p>From the definition we get that</p>\n\n<pre><code> f &lt;*&gt; g = \\x -&gt; f x (g x)\n</code></pre>\n\n<p>Because <code>(&lt;*&gt;)</code> is left associative, it follows that</p>\n\n<pre><code> f &lt;*&gt; g &lt;*&gt; h = (f &lt;*&gt; g) &lt;*&gt; h\n               = (\\x -&gt; f x (g x)) &lt;*&gt; h\n               = \\y -&gt; (\\x -&gt; f x (g x)) y (h y)\n</code></pre>\n\n<p>Therefore</p>\n\n<pre><code> (f &lt;*&gt; g &lt;*&gt; h) z = (\\y -&gt; (\\x -&gt; f x (g x)) y (h y)) z\n                   = (\\x -&gt; f x (g x)) z (h z)\n                   = (f z (g z)) (h z)\n                   = f z (g z) (h z)\n</code></pre>\n\n<p>The last step is due to the fact that function application is left associative. Similarly</p>\n\n<pre><code> (f &lt;*&gt; g &lt;*&gt; h &lt;*&gt; v) z = f z (g z) (h z) (v z)\n</code></pre>\n\n<p>This, to me, provides a very clear intuitive idea of what the arrow applicative does. <strong>But is this correct?</strong></p>\n\n<p>To test the result I ran, for example, the following,</p>\n\n<pre><code>\u03bb&gt; ((\\z g h v -&gt; [z, g, h, v]) &lt;*&gt; (1+) &lt;*&gt; (2+) &lt;*&gt; (3+)) 4\n[4,5,6,7]\n</code></pre>\n\n<p>which conforms to the result derived above.</p>\n\n<p>Before doing the expansion above I found this applicative very difficult to understand, since <em>extremely</em> complicated behaviour can result from its use because of currying. In particular, in</p>\n\n<pre><code> (f &lt;*&gt; g &lt;*&gt; h &lt;*&gt; v) z = f z (g z) (h z) (v z)\n</code></pre>\n\n<p>functions can return other functions. Here is an example:</p>\n\n<pre><code>\u03bb&gt; ((\\z g -&gt; g) &lt;*&gt; pure (++) &lt;*&gt; pure \"foo\" &lt;*&gt; pure \"bar\") undefined\n\"foobar\"\n</code></pre>\n\n<p>In this case <code>z=undefined</code> is ignored by all functions, because <code>pure x z = x</code> and the first function ignores <code>z</code> by construction. Furthermore, the first function takes only two arguments but returns a function taking two arguments.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509221461, "post_id": 46992180, "comment_id": 80934437, "body": "Since you don&#39;t care about the <code>Int</code> value of each tuple, you can just define the function in terms of <code>elem</code> and <code>map</code>: <code>elemMSet a xs = elem a (map fst xs)</code>. (Increasingly point-free versions would be <code>elemMSet a = elem a . map fst</code> and <code>elemMSet = (. map fst) . elem</code>.)"}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 4, "creation_date": 1509209689, "post_id": 46992215, "comment_id": 80930940, "body": "Compiler warning will catch these sorts of issues, I strongly suggest you turn them on (<code>-Wall</code>) and pay attention to them."}, {"owner": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "edited": false, "score": 0, "creation_date": 1509209907, "post_id": 46992215, "comment_id": 80931015, "body": "where do i put -wall?"}, {"owner": {"reputation": 631, "user_id": 6514691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ee33b08c26c153742e975d043ab892f?s=128&d=identicon&r=PG&f=1", "display_name": "Rick Majpruz", "link": "https://stackoverflow.com/users/6514691/rick-majpruz"}, "edited": false, "score": 0, "creation_date": 1509210803, "post_id": 46992215, "comment_id": 80931299, "body": "It&#39;s uppercase W and it&#39;s a command-line option used when you compile the script. Supposed you&#39;re using <code>ghc</code> to compile a script called elem.hs. Then you&#39;ll want to enter <code>ghc -Wall elem.hs</code> at your console/shell prompt. However, <code>-Wall</code> is from <code>-W</code> which supplies various warning. However, you may find <code>-Wall</code> to be tad annoying because it prompts you to add extra safeguards, mostly notably type signatures to all your functions."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 3, "creation_date": 1509221327, "post_id": 46992215, "comment_id": 80934395, "body": "In ghci you do <code>:set -Wall</code>"}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 3, "last_activity_date": 1509209599, "creation_date": 1509209599, "answer_id": 46992215, "question_id": 46992180, "link": "https://stackoverflow.com/questions/46992180/non-exhaustive-pattern/46992215#46992215", "title": "Non.exhaustive pattern", "body": "<p>You misspelled the function name on line 2, so <code>elemMSet</code> only covers the non-empty case. Change the name on line 2 to <code>elemMSet</code> (with a capital S) and it will work fine.</p>\n"}], "owner": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "closed_date": 1509288003, "answer_count": 1, "score": 0, "last_activity_date": 1509209599, "creation_date": 1509209316, "question_id": 46992180, "link": "https://stackoverflow.com/questions/46992180/non-exhaustive-pattern", "closed_reason": "Not suitable for this site", "title": "Non.exhaustive pattern", "body": "<p>So im creating a function that says true if a is equal to the fst element of any pair in a list</p>\n\n<pre><code> elemMSet :: Eq a =&gt; a -&gt; [(a,Int)] -&gt; Bool\n elemMset a [] = False\n elemMSet a ((t,q):xs)| a==t = True\n                      | otherwise = elemMSet a xs\n</code></pre>\n\n<p>I dont undertstand why, it shows an error of non-exhaustive pattern when i try something that should give False like : </p>\n\n<pre><code>    elemMSet 'd' [('b',2), ('a',4), ('c',1)]\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>  Tseis.hs:(4,1)-(5,48): Non-exhaustive patterns in function elemMSet\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1509204594, "post_id": 46991198, "comment_id": 80929309, "body": "The strings aren&#39;t empty. The strings are filled with space ` <code>.That&#39;s because your grid contains a space at every even position, e.g. </code>I U P G`. If you remove those spaces, everything will turn out as you wanted."}, {"owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "edited": false, "score": 0, "creation_date": 1509205183, "post_id": 46991198, "comment_id": 80929526, "body": "Is this just a &quot;how do I get it to print in this specific way&quot; question?"}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 3, "last_activity_date": 1509205255, "creation_date": 1509205255, "answer_id": 46991476, "question_id": 46991198, "link": "https://stackoverflow.com/questions/46991198/transpose-returns-list-with-empty-strings/46991476#46991476", "title": "Transpose returns list with empty strings", "body": "<p>The issue is that <code>transpose</code> treats the strings as lists of characters <strong>including the spaces</strong>.  If you tried:</p>\n\n<pre><code>transpose [\"ABC\",\n           \"DE \",\n           \"FGH\"]\n</code></pre>\n\n<p>you'd get:</p>\n\n<pre><code>[\"ADF\",\n \"BEG\",\n \"C H\"]\n</code></pre>\n\n<p>and you can see that all character, spaces included, are transposed.</p>\n\n<p>For your particular case, there's an easy fix.  You can use <code>words</code> and <code>unwords</code> to convert <code>\"A B C\"</code> to <code>[\"A\",\"B\",\"C\"]</code> and back before and after the transpose:</p>\n\n<pre><code>&gt; import Data.List\n&gt; (map unwords . transpose . map words) [\"A B C\",\"D E F\",\"G H I\"]\n[\"A D G\",\"B E H\",\"C F I\"]\n&gt;\n</code></pre>\n\n<p>The reason your <code>filter</code> didn't work is that only the empty string is <code>null</code> -- a string of spaces is non-null.  You could have maybe used:</p>\n\n<pre><code>&gt; import Data.Char\n&gt; filter (not . all isSpace) [\"abc\",\"   \",\"def\"]\n[\"abc\",\"def\"]\n&gt; \n</code></pre>\n\n<p>As a side note, you might want to reconsider whether you want to represent the grid with spaces internally in your program.  It seems like it would be easier to work with either:</p>\n\n<pre><code>[[\"a\",\"b\",\"c\"],[\"d\",\"e\",\"f\"],[\"g\",\"h\",\"i\"]]   :: [[String]]\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>[\"abc\",\"def\",\"ghi\"]   :: [[Char]]\n</code></pre>\n\n<p>internally and only add or subtract spaces when inputting or outputting a grid.</p>\n\n<p>For the former representation, you can use <code>map words</code> and <code>map unwords</code> to convert back and forth.  For the latter, you can use:</p>\n\n<pre><code>&gt; map (intersperse ' ') [\"abc\",\"def\",\"ghi\"]\n[\"a b c\",\"d e f\",\"g h i\"]\n&gt; map (concat . words) [\"a b c\",\"d e f\",\"g h i\"]\n[\"abc\",\"def\",\"ghi\"]\n&gt;\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 8383476, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/66893da737c29fad8518f5fed5827587?s=128&d=identicon&r=PG&f=1", "display_name": "ProPall", "link": "https://stackoverflow.com/users/8383476/propall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 46991476, "answer_count": 1, "score": 2, "last_activity_date": 1509205255, "creation_date": 1509203487, "question_id": 46991198, "link": "https://stackoverflow.com/questions/46991198/transpose-returns-list-with-empty-strings", "title": "Transpose returns list with empty strings", "body": "<p>I am new to haskell and I am currently writing a word search in a grid game where it's possible to find words in diagonals, rows and columns. I use <code>Data.List.transpose</code> in order to create columns but the output always creates new empty strings. I've tried filter function but it doesn't change the output : <code>filter (not.null) (L.transpose y)</code>. The output looks like this : <code>[\"IYYPPOLFHTNMTDI\",\"               \",\"UTVCGNVAEEZXEIR\",\"               \",\"PDCPLTRUGSWTSQC\",\"               \",\"GZEGUDGHSZTGSDT\",\"               \",\"RMCEDJABPEUERTL\",\"               \",\"ATTRVRXGKBRAMRA\",\"               \",\"DZISDRASHAODEOP\",\"               \",\"EVWWUWIXWBHGMMT\",\"               \",\"ENAGCDYTYIOAOTO\",\"               \",\"PRLCFFFEPDIVRKP\",\"               \",\"EXZRNOKLOKPLYSO\",\"               \",\"QSRESYZICYKUOLX\"]</code></p>\n\n<p>The initial grid : </p>\n\n<pre><code>grid :: [String]\ngrid\n     = [\"I U P G R A D E E P E Q\",\n        \"Y T D Z M T Z V N R X S\",\n        \"Y V C E C T I W A L Z R\",\n        \"P C P G E R S W G C R E\",\n        \"P G L U D V D U C F N S\",\n        \"O N T D J R R W D F O Y\",\n        \"L V R G A X A I Y F K Z\",\n        \"F A U H B G S X T E L I\",\n        \"H E G S P K H W Y P O C\",\n        \"T E S Z E B A B I D K Y\",\n        \"N Z W T U R O H O I P K\",\n        \"M X T G E A D G A V L U\",\n        \"T E S S R M E M O R Y O\",\n        \"D I Q D T R O M T K S L\",\n        \"I R C T L A P T O P O X\" ]\n</code></pre>\n\n<p>How can I solve this issue or is there a better way to transpose list of strings?</p>\n"}, {"tags": ["variables", "haskell", "scope", "char"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1509201614, "post_id": 46990868, "comment_id": 80928301, "body": "What&#39;s the actual error message?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1509201659, "post_id": 46990868, "comment_id": 80928316, "body": "Please always include the actual error message. \u2014 The problem you&#39;re experiencing is probably that <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Char.html#v:isDigit\" rel=\"nofollow noreferrer\"><code>isDigit</code> <i>itself</i></a> is not in scope. Have you actually imported <code>Data.Char</code>?"}, {"owner": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "edited": false, "score": 0, "creation_date": 1509202212, "post_id": 46990868, "comment_id": 80928510, "body": "error: Variable not in scope: isDigit :: Char -&gt; Bool    | 6 | algarismos (x:xs) | (isDigit x) =x:(algarismos xs)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1509202475, "post_id": 46990868, "comment_id": 80928585, "body": "In my experience, compared to other languages, examples of Haskell code are more likely to assume that you will know which imports are necessary for the example to work (and to know which third-party library to install for the import to work)."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 5, "last_activity_date": 1509201703, "creation_date": 1509201703, "answer_id": 46990922, "question_id": 46990868, "link": "https://stackoverflow.com/questions/46990868/haskell-scope-of-a-variable/46990922#46990922", "title": "Haskell: Scope of a variable", "body": "<p>As long as you're giving us all your code, this is the actual error message:</p>\n\n<pre><code>error: Variable not in scope: isDigit :: Char -&gt; Bool\n</code></pre>\n\n<p>This is saying that <code>isDigit</code> isn't defined, not anything else.</p>\n\n<hr>\n\n<p>You need to import <code>Data.Char</code>, which contains <code>isDigit</code>. Put this at the top of your file:</p>\n\n<pre><code>import Data.Char (isDigit)\n</code></pre>\n\n<p>This imports the function <code>isDigit</code> from the base module <code>Data.Char</code>.</p>\n\n<p>In the future, look for the imports you need to make using <a href=\"https://www.haskell.org/hoogle/?hoogle=isDigit\" rel=\"noreferrer\">hoogle</a>.</p>\n"}], "owner": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1509205535, "creation_date": 1509201366, "last_edit_date": 1509205535, "question_id": 46990868, "link": "https://stackoverflow.com/questions/46990868/haskell-scope-of-a-variable", "title": "Haskell: Scope of a variable", "body": "<p>I am creating a function that given a list of <code>Char</code>, gives the same list but only with the numbers:</p>\n\n<pre><code>algarismos :: [Char] -&gt; [Char]\n\nalgarismos [] = []\nalgarismos (x:xs) | (isDigit x) =x:(algarismos xs)\n                  |  otherwise =(algarismos xs)\n</code></pre>\n\n<p>I get the error message</p>\n\n<pre><code>error: Variable not in scope: isDigit :: Char -&gt; Bool\n</code></pre>\n\n<p>Why does it say <code>isDigit</code> doesn't have variable in scope if the <code>x</code> is there?</p>\n"}, {"tags": ["haskell", "gloss"], "comments": [{"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 1, "creation_date": 1509199766, "post_id": 46990462, "comment_id": 80927732, "body": "My guess is that the pattern matches on <code>1.0</code>, <code>2.0</code>, etc. are failing and you&#39;re matching on the <code>_</code> case.  Maybe temporarily make the <code>_</code> case the same as the <code>4.0</code> case and see if that behaves differently.  Do you know about the pitfalls of comparing floating point numbers?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1509201342, "post_id": 46990462, "comment_id": 80928209, "body": "<a href=\"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"nofollow noreferrer\">What every computer scientist should know about floating-point arithmetic</a>. (But the problem with your code is actually more fundamental than the typical float problems.)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1509201531, "post_id": 46990462, "comment_id": 80928273, "body": "Another thing: please don&#39;t write such repetitive code as in <code>updateBoard</code>."}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1509209360, "post_id": 46990855, "comment_id": 80930817, "body": "Guards can also result in an acceptable looking solution.  <code>updateBoard t game | t &lt; 1 = ... ; | t &lt; 2 = ... ; | t &lt; 3 = ... ; | t &lt; = 4 ... ; | otherwise = ...</code>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1509201272, "creation_date": 1509201272, "answer_id": 46990855, "question_id": 46990462, "link": "https://stackoverflow.com/questions/46990462/gloss-function-animate-doesnt-seem-to-be-doing-anything/46990855#46990855", "title": "Gloss function `animate` doesnt seem to be doing anything", "body": "<p><em>Never equality-check on floating point numbers</em>. (Or, if you do, always assume the result may be <code>False</code> even if the numbers are conceptually equal.)</p>\n\n<p>In your case, that's not even conceptually the case, because <code>animate</code> is called on some finite points in time; why would these include any exact integral number of seconds?</p>\n\n<p>One simple way to get around this is to look up the <em>rounded-to-whole-seconds</em> time.</p>\n\n<pre><code>updateBoard :: Int -&gt; SimonGame -&gt; SimonGame \nupdateBoard 1 game = game { ... }\nupdateBoard 2 game = game { ... }\n...\n\nmain = animate window background frame\n  where\n    frame :: Float -&gt; Picture\n    frame seconds = render $ updateBoard (floor seconds) initialState\n</code></pre>\n"}], "owner": {"reputation": 1142, "user_id": 5180554, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/5OWnC.jpg?s=128&g=1", "display_name": "Alex Goft", "link": "https://stackoverflow.com/users/5180554/alex-goft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 46990855, "answer_count": 1, "score": 1, "last_activity_date": 1509201272, "creation_date": 1509198686, "last_edit_date": 1509199092, "question_id": 46990462, "link": "https://stackoverflow.com/questions/46990462/gloss-function-animate-doesnt-seem-to-be-doing-anything", "title": "Gloss function `animate` doesnt seem to be doing anything", "body": "<p>I am tying to create a simple animation using <code>haskell</code> gloss. I want that at the first 4 seconds, every rectangle will change its color to a darker one. The problem is that after a relatively long time of linking, nothing really happens -</p>\n\n<p><a href=\"https://i.stack.imgur.com/S6GH2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S6GH2.png\" alt=\"enter image description here\"></a></p>\n\n<p>All rectangles appear and they don't change color</p>\n\n<p>This is the following code i used -</p>\n\n<pre><code>window :: Display\nwindow = InWindow \"Simon\" (width, height) (offset, offset)\n\nbackground :: Color\nbackground = black\n\ndata SimonGame = Game {\n    rectangleGreen::Picture, \n    rectangleRed::Picture,\n    rectangleBlue::Picture,\n    rectanglYellow::Picture\n} deriving Show\n\ninitialState :: SimonGame\ninitialState = Game\n  { rectangleGreen = translate (-100) (0) $ color green $ rectangleSolid 60 60,\n    rectangleRed = translate (100) (0) $ color red $ rectangleSolid 60 60,\n    rectangleBlue = translate (0) (100)  $  color blue $ rectangleSolid 60 60,\n    rectanglYellow = translate (0) (-100)  $  color yellow $ rectangleSolid 60 60\n  }\n\nrender :: SimonGame -&gt; Picture \nrender game = pictures\n              [ rectangleGreen game,\n                rectangleRed game,\n                rectangleBlue game,\n                rectanglYellow game\n              ]\n\nupdateBoard :: Float-&gt; SimonGame -&gt; SimonGame \nupdateBoard 1.0 game = game { \n                              rectangleGreen = translate (-100) (0) $ color (dark green)  $ rectangleSolid 60 60,\n                              rectangleRed = translate (100) (0) $ color red $ rectangleSolid 60 60,\n                              rectangleBlue = translate (0) (100)  $  color blue $ rectangleSolid 60 60,\n                              rectanglYellow = translate (0) (-100)  $  color yellow $ rectangleSolid 60 60\n                            }\nupdateBoard 2.0 game = game { \n                              rectangleGreen = translate (-100) (0) $ color green $ rectangleSolid 60 60,\n                              rectangleRed = translate (100) (0) $ color (dark red) $ rectangleSolid 60 60,\n                              rectangleBlue = translate (0) (100)  $  color blue $rectangleSolid 60 60,\n                              rectanglYellow = translate (0) (-100)  $  color yellow $rectangleSolid 60 60\n                            }                         \nupdateBoard 3.0 game = game {\n                              rectangleGreen = translate (-100) (0) $ color green $ rectangleSolid 60 60,\n                              rectangleRed = translate (100) (0) $ color red $ rectangleSolid 60 60,\n                              rectangleBlue = translate (0) (100)  $  color (dark blue) $rectangleSolid 60 60,\n                              rectanglYellow = translate (0) (-100)  $  color yellow $rectangleSolid 60 60\n                            }\nupdateBoard 4.0 game = game { \n                              rectangleGreen = translate (-100) (0) $ color green $ rectangleSolid 60 60,\n                              rectangleRed = translate (100) (0) $ color red $ rectangleSolid 60 60,\n                              rectangleBlue = translate (0) (100)  $  color blue $rectangleSolid 60 60,\n                              rectanglYellow = translate (0) (-100)  $  color (dark yellow) $rectangleSolid 60 60\n                            }\nupdateBoard _ game = game\n\nmain :: IO ()\nmain = animate window background frame\n  where\n    frame :: Float -&gt; Picture\n    frame seconds = render $ updateBoard seconds initialState\n</code></pre>\n"}, {"tags": ["haskell", "search", "max"], "comments": [{"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 2, "creation_date": 1509207064, "post_id": 46990446, "comment_id": 80930129, "body": "Don&#39;t worry about the scores being &quot;stored&quot; -- the way Haskell and GHC work, they won&#39;t be.  For example, the compiled program <code>main = print (maximum [(2*x, x) | x &lt;- [1..100000000000] :: [Int]])</code> may take about 10-15 minutes to run but will do so in small, constant memory, since the compiler will determine that neither the codes nor the scores need to be kept around to get the answer."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1509251965, "post_id": 46990446, "comment_id": 80940370, "body": "Be aware that if any codes have the same score, this will select between them by choosing the maximal code, however <code>Ord</code> is defined for that type.  This may or may not be what you want."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509402386, "post_id": 46990446, "comment_id": 80997374, "body": "<code>snd . maximumBy (comparing fst) . map (score &amp;&amp;&amp; id)</code> works for non-<code>Ord</code> types too."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1509305386, "post_id": 46990490, "comment_id": 80955135, "body": "@AJFarmar Before it was introduced, the idiom was <code>compare `on` score</code>. This was so common that <code>comparing = on compare</code> was eventually added to the libraries."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 7, "last_activity_date": 1509198964, "creation_date": 1509198964, "answer_id": 46990490, "question_id": 46990446, "link": "https://stackoverflow.com/questions/46990446/x-in-list-for-which-fx-is-maximum/46990490#46990490", "title": "x in list for which f(x) is maximum", "body": "<p>Your solution is fine. If you want some library help, you can use</p>\n\n<pre><code>maximumBy (comparing score) codes\n</code></pre>\n\n<p>Note that this, compared to your code, will perform more calls to <code>score</code>. If <code>score</code> is expensive to compute, your approach is better since it will compute <code>score</code> only once per list element.</p>\n"}], "owner": {"reputation": 91, "user_id": 7396005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ec94c8d1820a9b655af9c22339c55cd?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy", "link": "https://stackoverflow.com/users/7396005/timothy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1529534235, "creation_date": 1509198601, "last_edit_date": 1529534235, "question_id": 46990446, "link": "https://stackoverflow.com/questions/46990446/x-in-list-for-which-fx-is-maximum", "title": "x in list for which f(x) is maximum", "body": "<p>I am trying to find an <code>x</code> in a list for which <code>score x</code> has the maximum value. I tried <code>snd (maximum [(score x, x) | x &lt;- codes])</code> which works, but I was wondering whether there were a faster way to do this, without actually storing both the function and the value.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1509200525, "post_id": 46990037, "comment_id": 80927946, "body": "That file seems to contain a large amount of pointfree-style code, such as the <code>getFile</code> you mention. As it often happens, pointfree leads to almost obfuscated code. In this case, we could instead use the pointful equivalent <code>getFile f = (,) f &lt;$&gt; readFile f</code> which is not only clearer but even shorter! Pointfree is sometimes cool, but it should never be used at all costs, just for its own sake."}, {"owner": {"reputation": 521, "user_id": 7126380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207438513426512/picture?type=large", "display_name": "Johnny Liao", "link": "https://stackoverflow.com/users/7126380/johnny-liao"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1509205081, "post_id": 46990037, "comment_id": 80929494, "body": "Yes!  the lambda way is much clearer. So lift2 just lift unknown argument in this case and make the expression point-free. It all makes sense now. Thx!"}], "answers": [{"comments": [{"owner": {"reputation": 521, "user_id": 7126380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207438513426512/picture?type=large", "display_name": "Johnny Liao", "link": "https://stackoverflow.com/users/7126380/johnny-liao"}, "edited": false, "score": 0, "creation_date": 1509204708, "post_id": 46990349, "comment_id": 80929357, "body": "(&lt;*&gt;) f g = \\x -&gt; f x (g x) ..................and (&lt;$&gt;) f g = \\x -&gt; f (g x) ........... Is that right? Plus this one, lift2 f g h = \\x -&gt; f (g x) (h x), the three functions make some kind of sense I don&#39;t get yet... but first, thx for the detailed explanation and exercise!"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 521, "user_id": 7126380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207438513426512/picture?type=large", "display_name": "Johnny Liao", "link": "https://stackoverflow.com/users/7126380/johnny-liao"}, "edited": false, "score": 0, "creation_date": 1509205681, "post_id": 46990349, "comment_id": 80929701, "body": "@JohnnyLiao That looks correct. <code>&lt;*&gt;</code> is also known as the S combinator; <code>&lt;$&gt;</code> is <code>.</code> (function composition)."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 5, "last_activity_date": 1509198644, "last_edit_date": 1509198644, "creation_date": 1509197913, "answer_id": 46990349, "question_id": 46990037, "link": "https://stackoverflow.com/questions/46990037/haskell-syntax-how-are-functions-combined-together/46990349#46990349", "title": "Haskell Syntax: How are functions combined together?", "body": "<p>Let's look at</p>\n\n<pre><code>lift2 (&lt;$&gt;) (,) readFile\n</code></pre>\n\n<p>This is indeed straightforward function application:</p>\n\n<pre><code>((lift2 (&lt;$&gt;)) (,)) readFile\n</code></pre>\n\n<p>(or <code>lift2</code> being applied to three arguments).</p>\n\n<p>The types involved (with uniquely renamed type variables to reduce confusion) are:</p>\n\n<pre><code>lift2 :: (Applicative f) =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c\n(&lt;$&gt;) :: (Functor g) =&gt; (j -&gt; k) -&gt; g j -&gt; g k\n(,) :: m -&gt; n -&gt; (m, n)\nreadFile :: FilePath -&gt; IO Chars\n</code></pre>\n\n<p>The first thing in our expression is applying <code>lift2</code> to <code>(&lt;$&gt;)</code>. That means we need to unify <code>a -&gt; b -&gt; c</code> (type of <code>lift2</code>'s first argument) and <code>(Functor g) =&gt; (j -&gt; k) -&gt; g j -&gt; g k</code> (type of <code>&lt;$&gt;</code>) somehow.</p>\n\n<p>That is:</p>\n\n<pre><code>a -&gt; b -&gt; c = (j -&gt; k) -&gt; g j -&gt; g k\n-- where g is a Functor\na = j -&gt; k\nb = g j\nc = g k\n</code></pre>\n\n<p>This works out. The result type is</p>\n\n<pre><code>f a -&gt; f b -&gt; f c\n-- where f is an Applicative\n</code></pre>\n\n<p>which is</p>\n\n<pre><code>f (j -&gt; k) -&gt; f (g j) -&gt; f (g k)\n</code></pre>\n\n<p>Now this expression (<code>lift2 (&lt;$&gt;)</code>) is applied to <code>(,)</code>. Again we have to make the types line up:</p>\n\n<pre><code>f (j -&gt; k) = m -&gt; n -&gt; (m, n)\n</code></pre>\n\n<p>Here we make use of the property that <code>-&gt;</code> is right associative (i.e. <code>a -&gt; b -&gt; c</code> means <code>a -&gt; (b -&gt; c)</code>) and that we can use (curried) prefix notation in types (i.e. <code>a -&gt; b</code> is the same as <code>(-&gt;) a b</code>, which is the same as <code>((-&gt;) a) b</code>).</p>\n\n<pre><code>f (j -&gt; k) = ((-&gt;) m) (n -&gt; (m, n))\nf = (-&gt;) m\nj = n\nk = (m, n)\n</code></pre>\n\n<p>This also works out. The result type is</p>\n\n<pre><code>f (g j) -&gt; f (g k)\n</code></pre>\n\n<p>which (after substituting) becomes</p>\n\n<pre><code>((-&gt;) m) (g n) -&gt; ((-&gt;) m) (g (m, n))\n(m -&gt; g n) -&gt; (m -&gt; g (m, n))\n</code></pre>\n\n<p>This expression (<code>lift2 (&lt;$&gt;) (,)</code>) is applied to <code>readFile</code>. Again, making the types line up:</p>\n\n<pre><code>m -&gt; g n = FilePath -&gt; IO Chars\nm = FilePath\ng = IO\nn = Chars\n</code></pre>\n\n<p>And substituting into the result type:</p>\n\n<pre><code>m -&gt; g (m, n)\nFilePath -&gt; IO (FilePath, Chars)\n</code></pre>\n\n<p>This is the type of the whole <code>lift2 (&lt;$&gt;) (,) readFile</code> expression. As expected, it matches the declaration of <code>getFile :: FilePath -&gt; IO (FilePath, Chars)</code>.</p>\n\n<hr>\n\n<p>However, we still need to verify that our class constraints (<code>Functor g</code>, <code>Applicative f</code>) are resolved.</p>\n\n<p><code>g</code> is <code>IO</code>, which is indeed a <code>Functor</code> (as well as <code>Applicative</code> and <code>Monad</code>). There are no big surprises here.</p>\n\n<p><code>f</code> is more interesting: <code>f = (-&gt;) m</code>, so we need to look for an <code>Applicative</code> instance for <code>(-&gt;) m</code>. Such an instance does in fact exist, and its definition contains the answer to what <code>getFile</code> actually does.</p>\n\n<p>We can derive what the instance must look like by just looking at the type of <code>lift2</code> (as used in <code>getFile</code>):</p>\n\n<pre><code>lift2 :: (Applicative f) =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c\nlift2 :: (a -&gt; b -&gt; c) -&gt; ((-&gt;) m) a -&gt; ((-&gt;) m) b -&gt; ((-&gt;) m) c\nlift2 :: (a -&gt; b -&gt; c) -&gt; (m -&gt; a) -&gt; (m -&gt; b) -&gt; (m -&gt; c)\nlift2 :: (a -&gt; b -&gt; c) -&gt; (m -&gt; a) -&gt; (m -&gt; b) -&gt; m -&gt; c\n</code></pre>\n\n<p>I.e. <code>lift2</code> takes</p>\n\n<ul>\n<li>a function that combines an <code>a</code> and a <code>b</code> into a <code>c</code>,</li>\n<li>a function that transforms an <code>m</code> into an <code>a</code>,</li>\n<li>a function that transforms an <code>m</code> into a <code>b</code>,</li>\n<li>and an <code>m</code>,</li>\n</ul>\n\n<p>and produces a <code>c</code>.</p>\n\n<p>The only way it can do that is by passing the <code>m</code> into the second and third functions and combining their results using the first function:</p>\n\n<pre><code>lift2 f g h x = f (g x) (h x)\n</code></pre>\n\n<p>If we inline this definition in <code>getFile</code>, we get</p>\n\n<pre><code>getFile = lift2 (&lt;$&gt;) (,) readFile\ngetFile = \\x -&gt; (&lt;$&gt;) ((,) x) (readFile x)\ngetFile = \\x -&gt; (,) x &lt;$&gt; readFile x\n</code></pre>\n\n<hr>\n\n<p><strong>Excercise for the reader:</strong></p>\n\n<p><code>lift2</code> is actually defined in terms of <code>&lt;$&gt;</code> and <code>&lt;*&gt;</code>. What are the types of <code>&lt;$&gt;</code> and <code>&lt;*&gt;</code> in the <code>Applicative</code> instance of <code>(-&gt;) m</code>? What must their definition look like?</p>\n"}], "owner": {"reputation": 521, "user_id": 7126380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207438513426512/picture?type=large", "display_name": "Johnny Liao", "link": "https://stackoverflow.com/users/7126380/johnny-liao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "accepted_answer_id": 46990349, "answer_count": 1, "score": 1, "last_activity_date": 1509198644, "creation_date": 1509195868, "question_id": 46990037, "link": "https://stackoverflow.com/questions/46990037/haskell-syntax-how-are-functions-combined-together", "title": "Haskell Syntax: How are functions combined together?", "body": "<p>a line from <a href=\"https://github.com/tonymorris/fp-course/blob/master/src/Course/FileIO.hs\" rel=\"nofollow noreferrer\">FileIO.hs</a> in <a href=\"https://github.com/tonymorris/fp-course/tree/master/src/Course\" rel=\"nofollow noreferrer\">Functional Programming Course exercise</a></p>\n\n<pre><code>getFile :: FilePath -&gt; IO (FilePath, Chars)\ngetFile = lift2 (&lt;$&gt;) (,) readFile\n</code></pre>\n\n<p>According to its type signature, <code>getFile</code> returns <code>IO ( FilePath, Chars)</code>, which means a tuple of filename and its content.</p>\n\n<p>But I just can't figure out why it turns that way.</p>\n\n<p>Why does <code>FilePath</code> turn out unchanged in the left, and <code>readFile</code> filename filled in the right? </p>\n\n<p>Is <code>(,)</code> an Applicative instance too? <code>(,)</code> is not an <code>IO</code>, so what did <code>lift2</code> lift?</p>\n\n<p>And, is there a way to derive those type signatures and get proved? </p>\n\n<p>The syntax I know is that a function follows by its arguments, and it eats one argument on its right hand and becomes a new function. But when it comes to code like that, it looks just like a magic cube to me...</p>\n\n<p>Thank you for helping me out! </p>\n\n<p>Ps. Extra Information as follows</p>\n\n<pre><code>instance Functor IO where\n  (&lt;$&gt;) =\n    P.fmap\n\nlift2 ::\n  Applicative f =&gt;\n  (a -&gt; b -&gt; c)\n  -&gt; f a\n  -&gt; f b\n  -&gt; f c\nlift2 f a b =\n  f &lt;$&gt; a &lt;*&gt; b\n\ngetFiles :: List FilePath -&gt; IO (List (FilePath, Chars))\ngetFiles = sequence . (&lt;$&gt;) getFile\n</code></pre>\n"}, {"tags": ["haskell", "monads", "monad-transformers", "conduit"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1509194988, "post_id": 46989884, "comment_id": 80926250, "body": "<code>(MonadThrow m, MonadBase IO m, MonadIO m, Applicative m) =&gt; MonadResource (ResourceT m)</code> is not recursive."}, {"owner": {"reputation": 2781, "user_id": 1540547, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4f07f7dc869bd71c0ba13719468daeab?s=128&d=identicon&r=PG", "display_name": "jorgen", "link": "https://stackoverflow.com/users/1540547/jorgen"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1509195160, "post_id": 46989884, "comment_id": 80926300, "body": "Aha, missed that. Time to dive in and learn how <code>ResourceT</code> works I guess.."}, {"owner": {"reputation": 1946, "user_id": 1432740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a84709030a711eb919bec460051eac8?s=128&d=identicon&r=PG", "display_name": "Mateusz Kowalczyk", "link": "https://stackoverflow.com/users/1432740/mateusz-kowalczyk"}, "edited": false, "score": 0, "creation_date": 1509199723, "post_id": 46989884, "comment_id": 80927716, "body": "simply some form of <code>main = runResourceT . runConduit $ sourceFile \u2026</code> should work."}], "answers": [{"tags": [], "owner": {"reputation": 1946, "user_id": 1432740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a84709030a711eb919bec460051eac8?s=128&d=identicon&r=PG", "display_name": "Mateusz Kowalczyk", "link": "https://stackoverflow.com/users/1432740/mateusz-kowalczyk"}, "is_accepted": true, "score": 1, "last_activity_date": 1509200481, "creation_date": 1509200481, "answer_id": 46990738, "question_id": 46989884, "link": "https://stackoverflow.com/questions/46989884/monadresource-for-reading-files-with-error-handling/46990738#46990738", "title": "MonadResource for reading files with error handling", "body": "<p>A simple way is to use <code>tryC</code> for example:</p>\n\n<pre><code>module Main (main) where\n\nimport           Conduit\nimport           Control.Exception (SomeException)\nimport qualified Control.Monad.Trans.Resource as R\nimport           Data.Monoid ((&lt;&gt;))\nimport           System.Environment (getArgs)\n\nmain :: IO ()\nmain = do\n  [fname] &lt;- getArgs\n  r &lt;- R.runResourceT . runConduit . tryC $ sourceFile fname .| await &gt;&gt;= pure\n  case r of\n    Left e -&gt; putStrLn $ \"Failed to read file content with \" &lt;&gt; show (e :: SomeException)\n    Right r' -&gt; putStrLn $ \"File content: \" &lt;&gt; show r'\n</code></pre>\n\n<p>Then you get:</p>\n\n<pre><code>[nix-shell:/tmp]$ ghc -Wall M.hs &amp;&amp; ./M /tmp/doesnt_exist\n[1 of 1] Compiling Main             ( M.hs, M.o )\nLinking M ...\nFailed to read file content with /tmp/doesnt_exist: openBinaryFile: does not exist (No such file or directory)\n\n[nix-shell:/tmp]$ ghc -Wall M.hs &amp;&amp; ./M /tmp/hello-file\nFile content: Just \"Hello world!\n</code></pre>\n"}], "owner": {"reputation": 2781, "user_id": 1540547, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4f07f7dc869bd71c0ba13719468daeab?s=128&d=identicon&r=PG", "display_name": "jorgen", "link": "https://stackoverflow.com/users/1540547/jorgen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 46990738, "answer_count": 1, "score": 0, "last_activity_date": 1509200481, "creation_date": 1509194824, "question_id": 46989884, "link": "https://stackoverflow.com/questions/46989884/monadresource-for-reading-files-with-error-handling", "title": "MonadResource for reading files with error handling", "body": "<p>I'm creating a Conduit that will read binary files. Stuff can go wrong, so I need a monad with some error handling; for now <code>Maybe</code> is good enough.</p>\n\n<p>I'd like to use <code>sourceFile</code>, which requires that the conduit monad be a <code>MonadResource</code>, and this is the crux of the problem.</p>\n\n<p>I see from <a href=\"https://hackage.haskell.org/package/resourcet-1.1.9/docs/Control-Monad-Trans-Resource.html\" rel=\"nofollow noreferrer\">the docs</a> that e.g. <code>MaybeT m</code> has an instance, but it requires <code>m</code> to already be a <code>MonadResource</code>; in fact this is true of all the instances. With my limited understanding this kinda sounds like a chicken-and-egg thing, requiring that I write a <code>MonadResource</code> instance by hand no matter what? </p>\n\n<p>I assume that to read files, my monad has to contain IO. So does all this mean that I have to write a <code>MonadResource</code> instance for <code>MaybeT IO</code>? If so, any pointers on how to do that? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509183132, "post_id": 46988230, "comment_id": 80923074, "body": "What do you do with the empty list?"}, {"owner": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509183249, "post_id": 46988230, "comment_id": 80923105, "body": "first i putted unlinhas [] = &quot;&quot;  , but the function woulnt even load so i tried when has 1 element"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1509183421, "post_id": 46988230, "comment_id": 80923146, "body": "what kind of debugging is that? &quot;<i>I don&#39;t know what is wrong, so I simply change a few lines with random stuff, and hope that all of a sudden, it will work</i>&quot;?"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1509183444, "post_id": 46988230, "comment_id": 80923153, "body": "I&#39;m sure you know this, but this is essentially just <code>unlines</code> (unlines also trails a newline, so it&#39;s literally just <code>init . unlines</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "edited": false, "score": 0, "creation_date": 1509183419, "post_id": 46988251, "comment_id": 80923145, "body": "thx it works  by the way what is the diference between &quot;&quot; and &#39;&#39;?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "edited": false, "score": 0, "creation_date": 1509183460, "post_id": 46988251, "comment_id": 80923156, "body": "@JoaoParente: that&#39;s because you named the first clause differently. It is now fixed."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "edited": false, "score": 0, "creation_date": 1509183486, "post_id": 46988251, "comment_id": 80923168, "body": "@JoaoParente what&#39;s the difference between <code>&quot;a&quot;</code> and <code>&#39;a&#39;</code>? Check it out in GHCI."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "edited": false, "score": 0, "creation_date": 1509183646, "post_id": 46988251, "comment_id": 80923199, "body": "@JoaoParente right, so <code>&quot;&quot;</code> is the empty string <code>[] :: [Char]</code>, while <code>&#39;&#39;</code> would be the empty Char (which isn&#39;t a thing, it&#39;s just an error)."}, {"owner": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1509183699, "post_id": 46988251, "comment_id": 80923208, "body": "thx very much @AdamSmith and  , i have been functions after functions and my brain randomly freezes Kappa"}, {"owner": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "edited": false, "score": 2, "creation_date": 1509183827, "post_id": 46988251, "comment_id": 80923238, "body": "and @WillemVanOnsem couldnt mention 1 person per comment"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1509184185, "last_edit_date": 1509184185, "creation_date": 1509183246, "answer_id": 46988251, "question_id": 46988230, "link": "https://stackoverflow.com/questions/46988230/non-exhaustive-pattern-in-string-string/46988251#46988251", "title": "Non exhaustive pattern in [String] -&gt;String?", "body": "<p>Your first pattern <code>[x]</code> is a <strong>list with one element</strong>. So the Haskell compiler is wondering what to do with an empty list.</p>\n\n<p>Furthermore in your first line you write <code>uninhas</code>, instead of <code>unlinhas</code>, as a result the Haskell compiler thinks that you write two different functions.</p>\n\n<p>Based on your specifications however, you want to process the empty list, so you can fix it with:</p>\n\n<pre><code>unlinhas:: [String] -&gt; String\n<b>unlinhas []</b> = \"\"\nunlinhas (x:xs) = x ++ \"\\n\" ++(unlinhas( xs))</code></pre>\n\n<p>You can further cleanup the code, and write it as:</p>\n\n<pre><code>unlinhas:: [String] -&gt; String\nunlinhas [] = \"\"\nunlinhas (x:xs) = x ++ <b>'\\n' : unlinhas xs</b></code></pre>\n"}], "owner": {"reputation": 287, "user_id": 8738033, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1944285682265003/picture?type=large", "display_name": "Joao Parente", "link": "https://stackoverflow.com/users/8738033/joao-parente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509184185, "creation_date": 1509183093, "last_edit_date": 1509183877, "question_id": 46988230, "link": "https://stackoverflow.com/questions/46988230/non-exhaustive-pattern-in-string-string", "title": "Non exhaustive pattern in [String] -&gt;String?", "body": "<p>so I'm creating an function like this:</p>\n\n<pre><code> unlinhas::[String]-&gt;String\n uninhas [x] = \"\"\n unlinhas (x:xs) = x ++ \"\\n\" ++(unlinhas( xs))\n</code></pre>\n\n<p>that given a list of strings like this <code>[\"arroz\",\"atum\"]</code> is supposed to give <code>\"arroz\\natum\\n\"</code> the problem is that this function that I created says non-exhaustive patterns.</p>\n"}, {"tags": ["haskell", "hdbc"], "comments": [{"owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "edited": false, "score": 1, "creation_date": 1509184738, "post_id": 46987773, "comment_id": 80923487, "body": "Please post your <i>*.cabal</i> and your <i>stack.yaml</i> files. Without them it&#39;s difficult to help you."}, {"owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "edited": false, "score": 0, "creation_date": 1509185138, "post_id": 46987773, "comment_id": 80923581, "body": "If you add a package to the extra-deps section of the stack.yaml file, you have to give an exact version. <code>HDBC-Sqlite3-2.3.3.0</code>"}, {"owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "reply_to_user": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "edited": false, "score": 0, "creation_date": 1509189363, "post_id": 46987773, "comment_id": 80924613, "body": "I have tried this as well, same issue. also the files are uploaded."}], "answers": [{"comments": [{"owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "edited": false, "score": 0, "creation_date": 1509195897, "post_id": 46989807, "comment_id": 80926536, "body": "Thanks, tried this and got ` Some extra-deps are neither installed nor in the index` and then tried to install it using stack install but same issue"}, {"owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "reply_to_user": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "edited": false, "score": 1, "creation_date": 1509196209, "post_id": 46989807, "comment_id": 80926635, "body": "Please commit the new versions of your cabal and stack.yaml files to your Git repo."}, {"owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "edited": false, "score": 0, "creation_date": 1509197293, "post_id": 46989807, "comment_id": 80926938, "body": "Updated. Thank you, just I have updated and put it in [String] in the <code>stack.yaml</code> file since it won&#39;t be parsed otherwise"}, {"owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "reply_to_user": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "edited": false, "score": 0, "creation_date": 1509197574, "post_id": 46989807, "comment_id": 80927034, "body": "Strange..., I downloaded you repo, did a <code>stack setup</code> and a <code>stack build</code> and it installed packages. I got an error, because I don&#39;t have installed the binaries of sqlite3. I&#39;m using version 1.5.1 of stack."}, {"owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "edited": false, "score": 1, "creation_date": 1509198306, "post_id": 46989807, "comment_id": 80927276, "body": "I update the code to files ( cabal and stack) the version <code>2.3.3.0</code> and it works!"}], "tags": [], "owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "is_accepted": true, "score": 3, "last_activity_date": 1509195111, "last_edit_date": 1509195111, "creation_date": 1509194278, "answer_id": 46989807, "question_id": 46987773, "link": "https://stackoverflow.com/questions/46987773/cannot-add-database-hdbc-sqlite3-to-stack-file/46989807#46989807", "title": "cannot add Database.HDBC.Sqlite3 to stack file", "body": "<p>Your main error was the uppercase <strong>S</strong> in HDBC-<strong>s</strong>qlite3!</p>\n\n<p>This should be the library section of your cabal file</p>\n\n<pre><code>library\n  hs-source-dirs:      src\n  exposed-modules:     Lib\n  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5\n                     , parsec &gt;= 3.1.11 &amp;&amp; &lt; 4\n                     , servant\n                     , servant-client\n                     , servant-server\n                     , aeson &gt;= 1.1\n                     , mtl\n                     , HDBC &gt;=2.4 &amp;&amp; &lt;3.0\n                     , HDBC-sqlite3 &gt;= 2.3.3.0\n</code></pre>\n\n<p>and this should be the <em>extra-deps</em> section of your stack.yaml file:</p>\n\n<pre><code># Dependency packages to be pulled from upstream that are not in the resolver\n# (e.g., acme-missiles-0.3)\nextra-deps:\n- HDBC-sqlite3-2.3.3.0\n</code></pre>\n\n<p>You must add the package HDBC-sqlite3-2.3.3.0\nto the extra-deps section of the stack.yaml file because it is missing in the set of packages of Stackage LTS-9.9.</p>\n"}], "owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "accepted_answer_id": 46989807, "answer_count": 1, "score": 2, "last_activity_date": 1509195111, "creation_date": 1509179544, "last_edit_date": 1509189305, "question_id": 46987773, "link": "https://stackoverflow.com/questions/46987773/cannot-add-database-hdbc-sqlite3-to-stack-file", "title": "cannot add Database.HDBC.Sqlite3 to stack file", "body": "<p>I am trying to implement the database using both libs <code>HDBC</code> and <code>HDBC-sqlite3</code>, while I am getting error for adding <code>HDBC-Sqlie3</code> and  I have tried the below :</p>\n\n<ul>\n<li>HDBC-Sqlite3</li>\n<li>HDBC-Sqlite3 -any</li>\n<li>HDBC-Sqlite3  >= 2.3.3.0 &amp;&amp; &lt; 2.3.3.1</li>\n<li>HDBC-Sqlite3 >= 2.3.3.0 </li>\n</ul>\n\n<p>and none of the above works and getting the error, when try the <code>- any</code> I got the following error :</p>\n\n<pre><code>In the dependencies for blog-post-0.1.0.0:\nHDBC-Sqlite3 must match -any, but the stack configuration has no specified version\n</code></pre>\n\n<p>edit :</p>\n\n<p><a href=\"https://github.com/kwaleko/blog-post/blob/master/stack.yaml\" rel=\"nofollow noreferrer\">stack.yaml file </a></p>\n\n<p><a href=\"https://github.com/kwaleko/blog-post/blob/master/blog-post.cabal\" rel=\"nofollow noreferrer\">cabal file</a></p>\n"}, {"tags": ["git", "haskell", "github", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1509139384, "post_id": 46983551, "comment_id": 80914608, "body": "Thank you. Do you happen to know why my example doesn&#39;t work? Has the support for adding git repos to <code>extra-deps</code> been removed?"}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1509140429, "post_id": 46983551, "comment_id": 80914972, "body": "I&#39;d like to accept, but it&#39;s not a standalone answer, since it depends on a link."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1509140493, "post_id": 46983551, "comment_id": 80914990, "body": "@SwiftsNamesake I&#39;m not sure about support for <code>extra-deps</code>... But this should be done like this: you add dependency to your package and mark is as <code>extra-dep: true</code>. Because in Haskell build system when you depend on github repository you basically depend on local package. But <code>stack</code> handles downloading from GitHub for you automatically."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1509140667, "post_id": 46983551, "comment_id": 80915059, "body": "I think the issue stemmed from a malformed <code>packages</code> section, and possibly outdated <code>stack</code> documentation. Thanks for your help."}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 1, "last_activity_date": 1509139201, "creation_date": 1509139201, "answer_id": 46983551, "question_id": 46983508, "link": "https://stackoverflow.com/questions/46983508/git-repos-in-extra-deps/46983551#46983551", "title": "Git repos in extra-deps", "body": "<p>See example in <a href=\"https://github.com/input-output-hk/cardano-sl/blob/388ca8f147862710316709d2a095726901f4dcbc/stack.yaml#L31\" rel=\"nofollow noreferrer\">this project</a> which has a lot of external dependencies from <em>GitHub</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": true, "score": 5, "last_activity_date": 1509141359, "creation_date": 1509141359, "answer_id": 46983932, "question_id": 46983508, "link": "https://stackoverflow.com/questions/46983508/git-repos-in-extra-deps/46983932#46983932", "title": "Git repos in extra-deps", "body": "<p>You are probably looking at documentation for the latest development version of stack.  The syntax you are using will be supported in stack 1.6 and newer, which will be released in a few days.</p>\n\n<p>Note the disclaimer at the top of the documentation - <a href=\"https://github.com/commercialhaskell/stack/blob/master/doc/yaml_configuration.md\" rel=\"noreferrer\">https://github.com/commercialhaskell/stack/blob/master/doc/yaml_configuration.md</a></p>\n\n<p>Whereas you should instead look at <a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/\" rel=\"noreferrer\">https://docs.haskellstack.org/en/stable/yaml_configuration/</a></p>\n"}], "owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 644, "favorite_count": 0, "accepted_answer_id": 46983932, "answer_count": 2, "score": 5, "last_activity_date": 1509141359, "creation_date": 1509138920, "question_id": 46983508, "link": "https://stackoverflow.com/questions/46983508/git-repos-in-extra-deps", "title": "Git repos in extra-deps", "body": "<p>What's the proper way of referencing a specific version of a <code>git</code> repository with <code>Stack</code>?</p>\n\n<p>Stack complains about a parse error for the first field in <code>extra-deps</code> section of <code>stack.yaml</code>. Having based the snippet below on an example from the official Stack documentation, I'm not quite sure why it doesn't work.</p>\n\n<pre><code># Dependency packages to be pulled from upstream that are not in the resolver\n# (e.g., acme-missiles-0.3)\nextra-deps:\n- git: https://github.com/jwaldmann/moo\n  commit: b429a7d371c0b268a4bb8dbea8044054aaf04cd5\n- git: https://github.com/jwaldmann/monad-mersenne-random\n  commit: d1f949fe60dc0c0cfbd310b339fe7fd5ecf4c5f5\n- gray-code-0.3.1\n#extra-deps: [gray-code-0.3.1]\n</code></pre>\n"}, {"tags": ["r", "haskell", "inline"], "comments": [{"owner": {"reputation": 71, "user_id": 8845822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e57160de098048b3dd66e69166ef77?s=128&d=identicon&r=PG&f=1", "display_name": "Rodolpho Pueyrred&#243;n", "link": "https://stackoverflow.com/users/8845822/rodolpho-pueyrred%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1509138506, "post_id": 46983413, "comment_id": 80914276, "body": "rectifying: I installed H and inline-r with cabal."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1509141392, "post_id": 46983413, "comment_id": 80915292, "body": "Do you have <code>R</code> installed?"}, {"owner": {"reputation": 1946, "user_id": 1432740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a84709030a711eb919bec460051eac8?s=128&d=identicon&r=PG", "display_name": "Mateusz Kowalczyk", "link": "https://stackoverflow.com/users/1432740/mateusz-kowalczyk"}, "edited": false, "score": 0, "creation_date": 1509144718, "post_id": 46983413, "comment_id": 80916202, "body": "<code>R</code> doesn&#39;t seem to be installed. I recommend using <code>nix</code> with <code>stack build --nix</code> which will automatically install all dependencies that you need, including system ones. See <a href=\"https://tweag.github.io/HaskellR/docs/build-and-install.html\" rel=\"nofollow noreferrer\">tweag.github.io/HaskellR/docs/build-and-install.html</a>"}, {"owner": {"reputation": 71, "user_id": 8845822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e57160de098048b3dd66e69166ef77?s=128&d=identicon&r=PG&f=1", "display_name": "Rodolpho Pueyrred&#243;n", "link": "https://stackoverflow.com/users/8845822/rodolpho-pueyrred%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1509149606, "post_id": 46983413, "comment_id": 80917300, "body": "Yes. Version R-3.4.2. The cabal.config set with: extra-include-dirs: C:\\Program Files\\Haskell Platform\\8.0.2\\mingw\\include extra-include-dirs: C:\\Program Files\\R\\R-3.4.2\\include extra-lib-dirs: C:\\Program Files\\Haskell Platform\\8.0.2\\mingw\\lib extra-lib-dirs: C:\\Program Files\\R\\R-3.4.2\\bin\\x64 extra-prog-path: C:\\Users\\Rodolpho Morethson\\AppData\\Roaming\\cabal\\bin extra-prog-path: C:\\Program Files\\Haskell Platform\\8.0.2\\msys\\usr\\bin extra-prog-path: C:\\Users\\Rodolpho Morethson\\AppData\\Roaming\\cabal\\bin extra-prog-path: C:\\Program Files\\Haskell Platform\\8.0.2\\msys\\usr\\bin"}, {"owner": {"reputation": 71, "user_id": 8845822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e57160de098048b3dd66e69166ef77?s=128&d=identicon&r=PG&f=1", "display_name": "Rodolpho Pueyrred&#243;n", "link": "https://stackoverflow.com/users/8845822/rodolpho-pueyrred%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1509149997, "post_id": 46983413, "comment_id": 80917390, "body": "I want a globally installing inline-r. The packages that I use are: yesod , inline-r and H."}, {"owner": {"reputation": 71, "user_id": 8845822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e57160de098048b3dd66e69166ef77?s=128&d=identicon&r=PG&f=1", "display_name": "Rodolpho Pueyrred&#243;n", "link": "https://stackoverflow.com/users/8845822/rodolpho-pueyrred%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1509150107, "post_id": 46983413, "comment_id": 80917420, "body": "Is there some way installing H and inline-r globally with stack?"}, {"owner": {"reputation": 71, "user_id": 8845822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e57160de098048b3dd66e69166ef77?s=128&d=identicon&r=PG&f=1", "display_name": "Rodolpho Pueyrred&#243;n", "link": "https://stackoverflow.com/users/8845822/rodolpho-pueyrred%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1509307786, "post_id": 46983413, "comment_id": 80955808, "body": "I instaled using: stack build H --extra-lib-dirs=C:\\R\\bin\\i386 --extra-include-dirs=C:\\R\\include. Same error!!"}], "owner": {"reputation": 71, "user_id": 8845822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e57160de098048b3dd66e69166ef77?s=128&d=identicon&r=PG&f=1", "display_name": "Rodolpho Pueyrred&#243;n", "link": "https://stackoverflow.com/users/8845822/rodolpho-pueyrred%c3%b3n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1509138345, "creation_date": 1509138345, "question_id": 46983413, "link": "https://stackoverflow.com/questions/46983413/inline-r-exception-when-installing-with-cabal", "title": "inline-r exception when installing with cabal", "body": "<p>I installed H and inline-r with full. I did not use sandbox. Apparently everything installed, but when I run some script the following error occurs:</p>\n\n<pre><code>\u2022 Exception when trying to run compile-time code:\n    R: readCreateProcess: does not exist (No such file or directory)\n  Code: Language.Haskell.TH.Quote.quoteExp\n          r \" matrix(xs_hs,ncol = 2) \"\n\u2022 In the quasi-quotation: [r| matrix(xs_hs,ncol = 2) |]\n</code></pre>\n\n<p>The code is the example of the official website: <a href=\"https://tweag.github.io/HaskellR/\" rel=\"nofollow noreferrer\">https://tweag.github.io/HaskellR/</a></p>\n\n<pre><code>{-# LANGUAGE QuasiQuotes #-}\n{-# LANGUAGE ScopedTypeVariables #-}\nimport H.Prelude as H\nimport Language.R.QQ\n\nimport System.Random\n\nmain = H.withEmbeddedR defaultConfig $ do\n  H.runRegion $ do\n    -- Put any complex model here\n    std &lt;- io $ newStdGen\n    let (xs::[Double]) = take 100 $ randoms std\n    d  &lt;- [r| matrix(xs_hs,ncol = 2) |]\n    rv &lt;- [r| clusters &lt;- kmeans(d_hs, 2) |]\n    [r| par(mar = c(5.1, 4.1, 0, 1));\n        plot(d_hs, col = rv_hs$cluster, pch = 20\n            , cex = 3, xlab = \"x\", ylab = \"y\");\n        points(rv_hs$centers, pch = 4, cex = 4, lwd = 4);\n      |]\n    return ()\n</code></pre>\n\n<p>somebody salve me!!</p>\n"}, {"tags": ["haskell", "logic"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509125243, "post_id": 46980260, "comment_id": 80908376, "body": "It&#39;s not clear what <code>eq</code> and <code>eq1</code> are supposed to be; right now, they are just partial functions of type <code>Logic a -&gt; Logic a -&gt; Bool</code>, rather than Prolog-like statements of fact. Also, you need to define an <code>Eq</code> instance for <code>Logic a</code>."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1509125301, "post_id": 46980260, "comment_id": 80908414, "body": "I am a bit confused - do you want to &quot;validate&quot; if your <code>Logic</code> is <code>True</code> something like <code>validate $ Equal (Val &#39;a&#39;) (Val &#39;a&#39;) ~&gt; True</code>. Then my question would be what is <code>validate $ Val &#39;a&#39;</code>? Or do you want to create an equivalence relation between two <code>Logic</code> - like <code>equiv (And (Equal (Val &#39;a&#39;) (Val &#39;a&#39;)) (Equal (Val &#39;a&#39;) (Val &#39;b&#39;))) (And (Equal (Val &#39;a&#39;) (Val &#39;b&#39;)) (Equal (Val &#39;a&#39;) (Val &#39;a&#39;)))</code> should be <code>True</code>."}, {"owner": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "edited": false, "score": 0, "creation_date": 1509128022, "post_id": 46980260, "comment_id": 80909728, "body": "I want to build a function check: check :: Logic a -&gt; Logic a -&gt; Logic a check (logic1) (logic2) = &quot;checks if I can add logic1 to logic2 and if neccesary modifies logic2. E.g. check (a=b) ((a/=b &quot;or&quot; a/=c) &quot;and&quot; (d=e)) should return: (a/=c) &quot;and&quot; (d=e)"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1509129288, "post_id": 46980260, "comment_id": 80910307, "body": "So make a combined theory solver where you replace each logical statement with a boolean and find a satisfying assignment. Remove the terms that correspond with any value that the SAT solver set to False."}, {"owner": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "edited": false, "score": 0, "creation_date": 1509129454, "post_id": 46980260, "comment_id": 80910361, "body": "And how should something like this look like? sorry I am not too much into this topic."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1509129758, "post_id": 46980260, "comment_id": 80910477, "body": "It would help to understand if this is for you or for class. If this is for you then use SBV. If it&#39;s for class then I doubt that is what the instructor expects and it might not be wanted."}, {"owner": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "edited": false, "score": 0, "creation_date": 1509130077, "post_id": 46980260, "comment_id": 80910616, "body": "it is a project for the university"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 8, "creation_date": 1509131045, "post_id": 46980260, "comment_id": 80911054, "body": "You need to discuss this with your professor or TA. I strongly suspect that you have misunderstood the assignment."}, {"owner": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "edited": false, "score": 0, "creation_date": 1509133595, "post_id": 46980260, "comment_id": 80912198, "body": "There is no restriction from the university. It is just an idea I came up with to solve a problem."}], "owner": {"reputation": 73, "user_id": 8702185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8e5108dd07336da0fde1fdb3e856f3?s=128&d=identicon&r=PG&f=1", "display_name": "Momo", "link": "https://stackoverflow.com/users/8702185/momo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 408, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509124135, "creation_date": 1509124135, "question_id": 46980260, "link": "https://stackoverflow.com/questions/46980260/haskell-propositional-logic", "title": "haskell propositional logic", "body": "<p>I am trying to create a structure for propositional logic in haskell. This structure contains \"AND\", \"OR\" and \"Equalities\" and \"Inequalities\" of \"Variables (instead of just Variables).\nThe programm I want to build should check if a new \"Equality\"/\"Inequality\" satisfies the previous ones and add it and should the occasion arise delete some, to let it be correct.</p>\n\n<pre><code>data Logic a = Val a \n              | And     (Logic a) (Logic a)\n              | Or      (Logic a) (Logic a)\n              | Equal   (Logic a) (Logic a)\n              | Inequal (Logic a) (Logic a)\n              | Parenthesis (Logic a) \n              deriving (Show, Eq)\n\nequal :: Eq a =&gt; Logic a -&gt; Logic a -&gt; Bool\nequal (Equal a b) (Equal c d) \n    | a == c &amp;&amp; b == d = True\n    | a == d &amp;&amp; b == c = True\n    | otherwise = False\n\neq (Equal a b) (Inequal c d) = False\neq1 (Inequal a b) (Equal c d ) = False\n\ninequal :: Eq a =&gt; Logic a -&gt; Logic a -&gt; Bool    \ninequal (Inequal a b) (Inequal c d) \n    | a == c &amp;&amp; b == d = True\n    | a == d &amp;&amp; b == c = True\n    | otherwise = False\n</code></pre>\n\n<p>This is what I got so far. I am quite confused since I don't know how to manage the problem, that if I have a new \"Inequality\" or \"Equality\" to check how to handle it, because I can't check like:</p>\n\n<pre><code>check logic = if logic == (Equal a) then something else somethingelse\n</code></pre>\n\n<p>Many thanks in advance.</p>\n"}, {"tags": ["haskell", "caching", "haskell-stack"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509146921, "post_id": 46980225, "comment_id": 80916732, "body": "It would be pretty cool if there were a way to install packages dynamically on demand (when their modules are requested) from a set of &quot;virtually installed&quot; packages. Then the least recently used package could be uninstalled when the package count got too high, and no one would be the wiser."}], "answers": [{"tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 3, "last_activity_date": 1509184841, "creation_date": 1509184841, "answer_id": 46988460, "question_id": 46980225, "link": "https://stackoverflow.com/questions/46980225/how-long-does-stack-keep-the-packages-in-its-cache/46988460#46988460", "title": "How long does stack keep the packages in its cache?", "body": "<p><code>stack</code> keeps packages in cache <em>forever</em>. Or until you manually delete those packages. There's no snapshot garbage collection implemented in <code>stack</code>. So what you can only do is to manually call</p>\n\n<pre><code>rm -rf ~/.stack\n</code></pre>\n\n<p>to remove <strong>whole</strong> stack cache. It's in general good practice to do it periodically to remove outdated packages which were accumulated for some period of time. But make sure to backup <code>.stack/global-project/stack.yaml</code> if you changed it manually. </p>\n\n<p><code>stack</code> command which handles cache removal for you is under development:</p>\n\n<p><a href=\"https://github.com/commercialhaskell/stack/issues/133\" rel=\"nofollow noreferrer\">https://github.com/commercialhaskell/stack/issues/133</a></p>\n"}], "owner": {"reputation": 555, "user_id": 1505475, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bc72887d0b9f71cdbc2eeb5f9899d8f?s=128&d=identicon&r=PG", "display_name": "simon1505475", "link": "https://stackoverflow.com/users/1505475/simon1505475"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 46988460, "answer_count": 1, "score": 6, "last_activity_date": 1510917316, "creation_date": 1509123970, "last_edit_date": 1510917316, "question_id": 46980225, "link": "https://stackoverflow.com/questions/46980225/how-long-does-stack-keep-the-packages-in-its-cache", "title": "How long does stack keep the packages in its cache?", "body": "<p>I'm working with the Lean theorem prover and I would like to build features like those of stack and start building library caches. One thing that I'm unsure about is when to delete older packages in the cache. I could think that, if I have two versions of Lean installed, say 3.3.0 and 3.3.1, I could argue for keeping all the versions of all the packages that work on those. Since the Lean syntax moves fast, it is quite restrictive. </p>\n\n<p>On the other hand, I could see keeping only 10 versions of any given package. This could be the 10 most recent versions or the 10 most recently requested versions.</p>\n\n<p>I'd love to know some of the ideas considered in building <code>stack</code> and related tools.</p>\n"}, {"tags": ["haskell", "scripting", "imagemagick", "sh", "python-import"], "answers": [{"comments": [{"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1509120501, "post_id": 46979259, "comment_id": 80905994, "body": "Have you found a way to introduce a shell syntax error before the import statement? I would like to do just that in some of my scripts."}, {"owner": {"reputation": 631, "user_id": 6514691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ee33b08c26c153742e975d043ab892f?s=128&d=identicon&r=PG&f=1", "display_name": "Rick Majpruz", "link": "https://stackoverflow.com/users/6514691/rick-majpruz"}, "reply_to_user": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1509121331, "post_id": 46979259, "comment_id": 80906379, "body": "Some ideas come to mind. First, maybe we can add something to <code>~&#47;.profile</code> file ... can profile access the contents of a subsequent script (when not interactive)? Second, replace <code>sh</code> with something to first checks the head of script for <code>import</code>. But, to my mind, the cleanest solution would have <code>import</code> command output a text prompt like &quot;Click mouse button to save screenshot&quot;. Then add a <code>--quiet</code> flag for silent operation. Really, this confusion is a big coincidence between the start of Python/Haskell and ImageMagick. I can imagine other keyword/command interactions from other languages."}, {"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1509121523, "post_id": 46979259, "comment_id": 80906477, "body": "None of the scripts are executed for non-interactive use. With bash, you could use an exported function (yuck) called <code>import</code> to override the command. But at this point, it is probably easier to put <code>~&#47;bin</code> on your path and have a fake <code>import</code> program there."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509124077, "post_id": 46979259, "comment_id": 80907801, "body": "Why would you want a syntax error? Put a shebang at the top of the script if you intend to run it as one so your shell/OS knows what interpreter to use."}, {"owner": {"reputation": 631, "user_id": 6514691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ee33b08c26c153742e975d043ab892f?s=128&d=identicon&r=PG&f=1", "display_name": "Rick Majpruz", "link": "https://stackoverflow.com/users/6514691/rick-majpruz"}, "reply_to_user": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1509124796, "post_id": 46979259, "comment_id": 80908143, "body": "I do use shebang but in this situation I was creating a minimal script. Once we become practiced enough, then shebang becomes a reflex ... and I have macros to generate them. But I suppose @Florian maybe be considering protection for newbies. Overall, it is better to have a system that provides timely error messages. Then again, the only way to gain experience is to make mistakes."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1509126625, "post_id": 46979259, "comment_id": 80909063, "body": "The shell does provide timely error messages; you just don&#39;t have any errors in the script (or aren&#39;t reaching them) because you have a program named <code>import</code> installed. This is a basic operational issue: if you want to run a script as a standalone executable, it <i>must</i> have a shebang to specify the correct interpreter to use."}], "tags": [], "owner": {"reputation": 631, "user_id": 6514691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ee33b08c26c153742e975d043ab892f?s=128&d=identicon&r=PG&f=1", "display_name": "Rick Majpruz", "link": "https://stackoverflow.com/users/6514691/rick-majpruz"}, "is_accepted": true, "score": 10, "last_activity_date": 1509156594, "last_edit_date": 1509156594, "creation_date": 1509120391, "answer_id": 46979259, "question_id": 46979258, "link": "https://stackoverflow.com/questions/46979258/why-does-a-simple-python-haskell-etc-program-freeze-hang-when-doing-an-import/46979259#46979259", "title": "why does a simple Python/Haskell/etc program freeze/hang when doing an import?", "body": "<p>(I know this is a rudimentary/rookie mistake. But I doubt that I'm the first or last person to make this mistake ...so I'll document it here so future klutzes like me can google it.)</p>\n\n<p>These scripts freeze because they are actually shell scripts. These shell scripts are actually running the <code>import</code> command-line program ... which is provided by the <a href=\"https://en.wikipedia.org/wiki/ImageMagick\" rel=\"nofollow noreferrer\">ImageMagick</a> package:</p>\n\n<pre><code>$ sh freeze.hs\n  C-c\n$ which import\n/usr/bin/import\n$ man import | head -10\n... import - saves any visible window on an X server and outputs it as an image file.\n$ import screenshot.ps\n    ... and here notice the mouse icon changes to a cross-hair icon ...\n    ... so then press the mouse button to finish this operation ...\n$ file screenshot.ps\nscreenshot.ps: PostScript document text conforming DSC level 3.0, Level 1\n</code></pre>\n\n<p>So my kudos to the ImageMagick crew for providing a nice, silent command-line operation.</p>\n\n<p>At least on various Linux-based operating system, these scripts trigger operation of the <code>import</code> command-line program. BSD, Windows, MacOS, etc may respond differently.</p>\n\n<p>Here is <strong>correct</strong> operation of the script with the Python interpreter and <code>ghc</code> compiler:</p>\n\n<pre><code>$ python freeze.py\nhello\n$ runghc freeze.hs\n\"hello\"\n</code></pre>\n\n<p>Or alternatively, include the <code>#!</code> <a href=\"https://en.wikipedia.org/wiki/Shebang_(Unix)\" rel=\"nofollow noreferrer\">shebang</a>:</p>\n\n<pre><code>$ ls -l no_freeze.py\n-rwx------ 1 rick rick 46 Oct 27 11:44 no_freeze.py\n$ cat no_freeze.py\n#!/usr/bin/env python\nimport re\nprint \"hello\"\n$ ./no_freeze.py\nhello\n</code></pre>\n\n<p>And the same for Haskell:</p>\n\n<pre><code>$ ls -l no_freeze.hs\n-rwx------ 1 rick rick 68 Oct 27 11:26 no_freeze.hs\n$ cat no_freeze.hs\n#!/usr/bin/env runghc\nimport Text.Regex.Posix\nmain = print \"hello\"\n$ ./no_freeze.hs\n\"hello\"\n</code></pre>\n\n<p>On my MacOS computer, I'm getting this error because some part of my X11 setup isn't finished. For those who didn't install X11, I imagine you would get the <em>command not found</em> error.</p>\n\n<pre><code>$ import screenshot\nVersion: ImageMagick 6.9.5-0 Q16 x86_64 2016-07-02 http://www.imagemagick.org\n...\nimport: delegate library support not built-in `' (X11) @ error/import.c/ImportImageCommand/1297.\n</code></pre>\n"}], "owner": {"reputation": 631, "user_id": 6514691, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0ee33b08c26c153742e975d043ab892f?s=128&d=identicon&r=PG&f=1", "display_name": "Rick Majpruz", "link": "https://stackoverflow.com/users/6514691/rick-majpruz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 46979259, "answer_count": 1, "score": 6, "last_activity_date": 1509156594, "creation_date": 1509120391, "last_edit_date": 1509121464, "question_id": 46979258, "link": "https://stackoverflow.com/questions/46979258/why-does-a-simple-python-haskell-etc-program-freeze-hang-when-doing-an-import", "title": "why does a simple Python/Haskell/etc program freeze/hang when doing an import?", "body": "<p>Why does this Python program freeze/hang:</p>\n\n<pre><code>$ ls -l freeze.py\n-rwx------ 1 rick rick 24 Oct 27 11:40 freeze.py\n$ cat freeze.py\nimport re\nprint \"hello\"\n$ ./freeze.py\n  C-c\n</code></pre>\n\n<p>And why does this Haskell program also freeze/hang:</p>\n\n<pre><code>$ ls -l freeze.hs\n-rwxrw-r-- 1 rick rick 46 Oct 27 11:22 freeze.hs\n$ cat freeze.hs\nimport Text.Regex.Posix\nmain = print \"hello\"\n$ ./freeze.hs\n  C-c\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 2, "creation_date": 1509113968, "post_id": 46977132, "comment_id": 80901894, "body": "It does work.  You&#39;re not getting a type error in your expression."}, {"owner": {"reputation": 23557, "user_id": 12266, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6a2a454191fa75d4114ed05836a0b924?s=128&d=identicon&r=PG", "display_name": "Andrew Jaffe", "link": "https://stackoverflow.com/users/12266/andrew-jaffe"}, "edited": false, "score": 0, "creation_date": 1509114139, "post_id": 46977132, "comment_id": 80902035, "body": "Instead, try <code>&gt; :t map (map getEqs) mixpairs</code> which will show that it works and give the resulting type. (Conversely, try just <code>&gt; map</code> which will &quot;fail&quot; in the same way...)"}, {"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 0, "creation_date": 1509116310, "post_id": 46977132, "comment_id": 80903496, "body": "Clarification: I should&#39;ve typed &quot;returned this:... ...instead of the intended [([Bool],[Bool])]&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 0, "creation_date": 1509116095, "post_id": 46977247, "comment_id": 80903355, "body": "Yes, but (map getEqs) is of type [[Char]] -&gt; ([Bool], [Bool]), so mapping it over [[[Char]]] should result in [([Bool],[Bool])], not a -&gt; b or t (a -&gt; b)."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 5, "creation_date": 1509116503, "post_id": 46977247, "comment_id": 80903621, "body": "Why would <code>map getEqs</code> have type <code>[[Char]] -&gt; ([Bool], [Bool])</code>? You forgot about the second <code>[Char]</code> argument of <code>getEqs</code>. (Besides \u2013 even if it had only one argument, <code>map getEqs</code> would have type <code>[[Char]] -&gt; [([Bool], [Bool])]</code>)."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 10, "last_activity_date": 1509114002, "creation_date": 1509114002, "answer_id": 46977247, "question_id": 46977132, "link": "https://stackoverflow.com/questions/46977132/why-doesnt-map-map-f-x-work-in-this-case/46977247#46977247", "title": "Why doesn&#39;t map (map f) x work in this case?", "body": "<p>It seems like that should work, and indeed it does work.</p>\n\n<p>However, if you do this at the prompt, GHCi wants to <em>print out the result</em>, and that does <em>not</em> work, because the result is a list of functions, and functions can't be printed.</p>\n"}], "owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 46977247, "answer_count": 1, "score": 0, "last_activity_date": 1509114027, "creation_date": 1509113677, "question_id": 46977132, "link": "https://stackoverflow.com/questions/46977132/why-doesnt-map-map-f-x-work-in-this-case", "title": "Why doesn&#39;t map (map f) x work in this case?", "body": "<p>I recently tried this in Haskell:</p>\n\n<pre><code>&gt; :t getEqs\ngetEqs :: [Char] -&gt; [Char] -&gt; ([Bool], [Bool])\n&gt; :t mixpairs\nmixpairs :: [[[Char]]]\n&gt; :t map\nmap :: (a -&gt; b) -&gt; [a] -&gt; [b]\n&gt; map (map getEqs) mixpairs\n</code></pre>\n\n<p>However, for seemingly no reason, it returned this:</p>\n\n<pre><code>&lt;interactive&gt;:38:1: error:\n    \u2022 No instance for (Show ([Char] -&gt; ([Bool], [Bool])))\n        arising from a use of \u2018print\u2019\n        (maybe you haven't applied a function to enough arguments?)\n    \u2022 In a stmt of an interactive GHCi command: print it\n&gt; \n</code></pre>\n\n<p>AFAICS what should happen is that a function that takes a list of lists and returns another thing is mapped over another list of lists of lists.<br>\nAnd it seems like that should work.</p>\n"}, {"tags": ["json", "haskell", "types", "instance", "aeson"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509107602, "post_id": 46975085, "comment_id": 80897646, "body": "What does <code>Color</code> looks like? Furthermore it does not make much sense for me that you parse this that way. I would explect <code>parseJSON</code> to parse a JSON string, or something equivalent."}, {"owner": {"reputation": 95, "user_id": 8843491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d545338c29b973eaa81ec89d93e57867?s=128&d=identicon&r=PG&f=1", "display_name": "Viletung", "link": "https://stackoverflow.com/users/8843491/viletung"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509108608, "post_id": 46975085, "comment_id": 80898262, "body": "@WillemVanOnsem I have updated my question. The main problem is <code>Color</code>, without this property we can successfully read a JSON object with the given code."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 8843491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d545338c29b973eaa81ec89d93e57867?s=128&d=identicon&r=PG&f=1", "display_name": "Viletung", "link": "https://stackoverflow.com/users/8843491/viletung"}, "edited": false, "score": 0, "creation_date": 1509174309, "post_id": 46979467, "comment_id": 80921137, "body": "Thank you, I guess there is no direct way to do this (without converting from a string to a color). Anyway, this solves pur problem :)"}], "tags": [], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "is_accepted": true, "score": 0, "last_activity_date": 1509121065, "creation_date": 1509121065, "answer_id": 46979467, "question_id": 46975085, "link": "https://stackoverflow.com/questions/46975085/haskell-aeson-gloss-json-instance-parser-color/46979467#46979467", "title": "Haskell Aeson - Gloss - JSON instance parser: Color", "body": "<p>If all you need is to parse base strings, this is pretty simple:</p>\n\n<pre><code>instance FromJSON Color where\n  parseJSON (String s) = maybe mzero return $ stringToColor s \n  parseJSON _ = mzero\n\n\nstringToColor :: String -&gt; Maybe Color\nstringToColor s \n  | s == \"red\" = Just red\n  | s == \"blue\" = Just blue \n  ... -- fill in all of your options from Gloss\n  | otherwise = Nothing \n</code></pre>\n\n<p>This allows you to turn a simple string into one of your <code>Color</code> objects. Once you have the <code>FromJSON</code> instance for <code>Color</code>, you can just use <code>instance FromJSON Car</code>. </p>\n"}], "owner": {"reputation": 95, "user_id": 8843491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d545338c29b973eaa81ec89d93e57867?s=128&d=identicon&r=PG&f=1", "display_name": "Viletung", "link": "https://stackoverflow.com/users/8843491/viletung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 46979467, "answer_count": 1, "score": 0, "last_activity_date": 1509121065, "creation_date": 1509107476, "last_edit_date": 1509110681, "question_id": 46975085, "link": "https://stackoverflow.com/questions/46975085/haskell-aeson-gloss-json-instance-parser-color", "title": "Haskell Aeson - Gloss - JSON instance parser: Color", "body": "<p>We are trying to decode a JSON object using the <a href=\"https://hackage.haskell.org/package/aeson-0.6.2.1/docs/Data-Aeson-Types.html\" rel=\"nofollow noreferrer\">Aeson-JSON</a> hackage using the following data:</p>\n\n<pre><code>data Car = Car\n  { carPosition  :: Position,\n    carColor     :: Color,\n    carDirection :: Direction }\n  deriving (Show, Generic)\n</code></pre>\n\n<p>Created an instance for <code>Car</code>, and did the same for the data types <code>Postion</code>, <code>Direction</code>:</p>\n\n<pre><code>instance FromJSON Position\ninstance FromJSON Direction\ninstance FromJSON Car\n</code></pre>\n\n<p>But now the trouble starts, the data type <a href=\"https://hackage.haskell.org/package/gloss-1.1.1.0/docs/Graphics-Gloss-Color.html\" rel=\"nofollow noreferrer\"><code>Color</code></a> comes from the <a href=\"https://hackage.haskell.org/package/gloss\" rel=\"nofollow noreferrer\"><code>Gloss</code></a> hackage and the value is e.g. written as <a href=\"https://hackage.haskell.org/package/gloss-1.1.1.0/docs/Graphics-Gloss-Color.html\" rel=\"nofollow noreferrer\">Red</a>. The <code>Color</code> data only knows: <code>deriving Show</code>, so no possibility of adding the <code>deriving Generic</code>. We tried the following code:</p>\n\n<pre><code>instance FromJSON Color where\n      parseJSON (Object v) = Color &lt;$&gt;\n        v .: \"carColor\"\n</code></pre>\n\n<p>It complains about not matching type <code>Picture -&gt; Picture</code> and we expected something like <code>Color</code>. </p>\n\n<p>Our question is: how can we use the data <code>Color</code> from <code>Gloss</code> to read a JSON object like</p>\n\n<p><code>{ \n  \"carPostion\": { \"x\": 0, \"y\": 10}, \n  \"carColor\": \"Red\", \n  \"carDirection\": \"Up\"\n}</code></p>\n\n<p>We have tried to read a JSON object without <code>carColor</code> (just for testing purposes) and that works.</p>\n\n<p>UPDATE: It looks like this question: <a href=\"https://stackoverflow.com/questions/40331851/haskell-data-decimal-as-aeson-type\">Haskell Data.Decimal as Aeson type</a> except in our case we want to use <code>Color</code> where in the given like <code>Data.Decimal</code> is the trouble maker.</p>\n"}, {"tags": ["haskell", "higher-order-functions", "parametric-polymorphism"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 6, "creation_date": 1509104204, "post_id": 46973642, "comment_id": 80895564, "body": "Haskell&#39;s type inference algorithm says &quot;Can I come up with a substitution which makes these two types the same?&quot; The types of <code>f</code> and <code>g</code> unify, under the substitution <code>b ~ a</code>, at the type <code>(a -&gt; a) -&gt; a -&gt; a</code>. So <code>xs :: [(a -&gt; a) -&gt; a -&gt; a]</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1509107650, "post_id": 46973642, "comment_id": 80897682, "body": "@Benjamin OK, it passes the type check because of the lack of code that Haskell&#39;s type inference can work with. For the given code the assertion that these two types may be equivalent is simply sufficient."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1509122799, "post_id": 46973642, "comment_id": 80907117, "body": "I think Haskell isn&#39;t rigid in this example in order to minimize the number of programs that are beyond the expressiveness of its type system. i. e. programs that do not compile, but would still make sense."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1509106998, "post_id": 46974276, "comment_id": 80897265, "body": "So when these two types are merely added to a list it is sufficient for the type checker that <code>f</code>&#39;s and <code>g</code>&#39;s polymorphic types have some ground types in common. But as soon as I map a pure function of type <code>(a -&gt; b)</code> over this list, type inference will detect the type error. Haskell&#39;s type inference weighs up every single case and is only as restrictive as needed. That&#39;s brilliant again."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 12, "last_activity_date": 1509108980, "last_edit_date": 1509108980, "creation_date": 1509104750, "answer_id": 46974276, "question_id": 46973642, "link": "https://stackoverflow.com/questions/46973642/why-are-two-polymorphic-higher-order-functions-with-different-type-vars-equivale/46974276#46974276", "title": "Why are two polymorphic higher order functions with different type vars equivalent regarding their types?", "body": "<p>Haskell is statically typed, but that doesn't mean it's Fortran. Every type must get fixed <em>at compile time</em>, but not necessarily within a single definition. The types of both <code>f</code> and <code>g</code> are <a href=\"https://en.wikipedia.org/wiki/Parametric_polymorphism\" rel=\"noreferrer\">polymorphic</a>. One way to interpret this is that <code>f</code> is not just a single function, but a whole family of overloaded functions. Like (in C++)</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>int f (function&lt;int(int)&gt; g, int x) { return g(x); }\nchar f (function&lt;char(char)&gt; g, char x) { return g(x); }\ndouble f (function&lt;double(double)&gt; g, double x) { return g(x); }\n...\n</code></pre>\n\n<p>Of course it wouldn't be practical to actually generate <em>all of these functions</em>, so in C++ you'd instead write this as a <em>template</em></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename T&gt;\nT f (function&lt;T(T)&gt; g, T x) { return g(x); }\n</code></pre>\n\n<p>...meaning, whenever the compiler finds <code>f</code> if your project's code, it'll figure out what <code>T</code> is in the specific case, then create a concrete <em>template instantiation</em> (a monomorphic function fixed to that concrete type, like the example ones I wrote above) and only use that concrete instantiation at runtime.</p>\n\n<p>These concrete instantiations of two template-functions may then have the same type, even if the templates looked a bit different.</p>\n\n<p>Now, Haskell's parametric polymorphism is resolved a little bit different from C++ templates, but at least in your example they amount to the same: <code>g</code> is a whole family of functions, including the instantiation <code>g :: (Int -&gt; Char) -&gt; Int -&gt; Char</code> (which is not compatible with the type of <code>f</code>) but also <code>g :: (Int -&gt; Int) -&gt; Int -&gt; Int</code>, which is. When you put <code>f</code> and <code>g</code> in a single list, the compiler automatically realises that only the subfamily of <code>g</code> whose type is compatible with <code>f</code> is relevant here.</p>\n\n<p>Yes, this is indeed a form of subtyping. When we say \u201cHaskell doesn't have subtyping\u201d we mean that any <em>concrete</em> (Rank-0) type is disjoint from all other Rank-0 types, but <em>polymorphic types</em> may overlap.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509149881, "post_id": 46984267, "comment_id": 80917363, "body": "Doesn&#39;t co/contravariance only really come into play for higher-rank types? Without <code>RankNTypes</code>, all the <code>forall</code>s are on the outside, and class constraints are always &quot;contravariant&quot;. But maybe I&#39;m wrong...."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1509174812, "post_id": 46984267, "comment_id": 80921264, "body": "@dfeuer: Yes, I think that\u2019s the only time contravariance matters. To use an example from &#167;3.3 of <a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/putting.pdf\" rel=\"nofollow noreferrer\">this paper</a>, given <code>f \u2237 ((\u2200a. [a] \u2192 [a]) \u2192 Int) \u2192 Int</code>, <code>g \u2237 (\u2200a. a \u2192 a) \u2192 Int</code>, and <code>h \u2237 ([Int] \u2192 [Int]) \u2192 Int</code>, <code>\u2200a. a \u2192 a</code> is <i>more</i> polymorphic than <code>\u2200a. [a] \u2192 [a]</code>, and therefore <code>(\u2200a. a \u2192 a) \u2192 Int</code> is <i>less</i> polymophic than <code>(\u2200a. [a] \u2192 [a]) \u2192 Int</code>, which is why <code>f g</code> is a type error but <code>f h</code> is fine."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1509174912, "post_id": 46984267, "comment_id": 80921290, "body": "Thank you for this insight into the machinery. I&#39;ll take a closer look at the subsumption process and the type constants."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1509278233, "post_id": 46984267, "comment_id": 80946350, "body": "If I understand your answer correctly, type vars are replaced by fresh skolem type vars whenever an explicit user-defined type annotation is provided, in order to distinguish them from programmatically inferred type variables. And subsumption is unification that takes the &quot;more polymorphic than&quot; relation into account, which describes a kind of subtyping. Is this correct?"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1509312445, "post_id": 46984267, "comment_id": 80957318, "body": "@ftor: Yup, that\u2019s correct. The first part of my answer describes why you can use a less-general type signature; the second part describes why you can put multiple functions of different (but compatible) types in a homogeneous list."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1518507672, "post_id": 46984267, "comment_id": 84523706, "body": "The more I study polymorphism and unification the more I appreciate your answer. For rank-1 types covariance matters. For higher-rank polymorphism contravariance matters too. This answer definitely deserves more upvotes."}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 2, "last_activity_date": 1509143456, "creation_date": 1509143456, "answer_id": 46984267, "question_id": 46973642, "link": "https://stackoverflow.com/questions/46973642/why-are-two-polymorphic-higher-order-functions-with-different-type-vars-equivale/46984267#46984267", "title": "Why are two polymorphic higher order functions with different type vars equivalent regarding their types?", "body": "<p>@leftroundabout\u2019s answer is solid; here\u2019s a more technical supplementary answer.</p>\n\n<p>There <em>is</em> a sort of subtyping relationship at work in Haskell: the System F \u201cgeneric instance\u201d relation. This is what the compiler uses when checking the inferred type of a function against its signature. Basically, the inferred type of a function must be <em>at least as polymorphic as</em> its signature:</p>\n\n<pre><code>f :: (a -&gt; a) -&gt; a -&gt; a\nf g x = g x\n</code></pre>\n\n<p>Here, the inferred type of <code>f</code> is <code>forall a b. (a -&gt; b) -&gt; a -&gt; b</code>, the same as the definition of <code>g</code> you gave. But the signature is more restrictive: it <em>adds</em> the constraint <code>a ~ b</code> (<code>a</code> is equal to <code>b</code>).</p>\n\n<p>Haskell checks this by first replacing the type variables in the signature with <em>Skolem type variables</em>\u2014these are fresh unique type constants that only unify with themselves (or type variables). I\u2019ll use the notation <code>$a</code> to represent a Skolem constant.</p>\n\n<pre><code>forall a. (a -&gt; a) -&gt; a -&gt; a\n($a -&gt; $a) -&gt; $a -&gt; $a\n</code></pre>\n\n<p>You may see references to \u201crigid, Skolem\u201d type variables when you accidentally have a type variable that \u201cescapes its scope\u201d: it\u2019s used outside the <code>forall</code> quantifier that introduced it.</p>\n\n<p>Next, the compiler does a <em>subsumption check</em>. This is essentially the same as normal unification of types, where <code>a -&gt; b ~ Int -&gt; Char</code> gives <code>a ~ Int</code> and <code>b ~ Char</code>; but because it\u2019s a subtyping relationship, it also accounts for covariance and contravariance of function types. If <code>(a -&gt; b)</code> is a subtype of <code>(c -&gt; d)</code>, then <code>b</code> must be a subtype of <code>d</code> (covariant), but <code>a</code> must be a <em>supertype</em> of <code>c</code> (contravariant).</p>\n\n<pre><code>{-1-}(a -&gt; b) -&gt; {-2-}(a -&gt; b)  &lt;:  {-3-}($a -&gt; $a) -&gt; {-4-}($a -&gt; $a)\n\n{-3-}($a -&gt; $a) &lt;: {-1-}(a -&gt; b)  -- contravariant (argument)\n{-2-}(a -&gt; b) &lt;: {-4-}($a -&gt; $a)  -- covariant (result)\n</code></pre>\n\n<p>The compiler generates the following constraints:</p>\n\n<pre><code>$a &lt;: a  -- contravariant\nb &lt;: $a  -- covariant\na &lt;: $a  -- contravariant\n$a &lt;: b  -- covariant\n</code></pre>\n\n<p>And solves them by unification:</p>\n\n<pre><code>a ~ $a\nb ~ $a\na ~ $a\nb ~ $a\n\na ~ b\n</code></pre>\n\n<p>So the inferred type <code>(a -&gt; b) -&gt; a -&gt; b</code> is at least as polymorphic as the signature <code>(a -&gt; a) -&gt; a -&gt; a</code>.</p>\n\n<hr>\n\n<p>When you write <code>xs = [f, g]</code>, normal unification kicks in: you have the two signatures:</p>\n\n<pre><code>forall a.   (a -&gt; a) -&gt; a -&gt; a\nforall a b. (a -&gt; b) -&gt; a -&gt; b\n</code></pre>\n\n<p>These are <em>instantiated</em> with fresh type variables:</p>\n\n<pre><code>(a1 -&gt; a1) -&gt; a1 -&gt; a1\n(a2 -&gt; b2) -&gt; a2 -&gt; b2\n</code></pre>\n\n<p>Then unified:</p>\n\n<pre><code>(a1 -&gt; a1) -&gt; a1 -&gt; a1  ~  (a2 -&gt; b2) -&gt; a2 -&gt; b2\na1 -&gt; a1  ~  a2 -&gt; b2\na1 -&gt; a1  ~  a2 -&gt; b2\na1 ~ a2\na1 ~ b2\n</code></pre>\n\n<p>And finally solved &amp; generalised:</p>\n\n<pre><code>forall a1. (a1 -&gt; a1) -&gt; a1 -&gt; a1\n</code></pre>\n\n<p>So the type of <code>g</code> has been made less general because it\u2019s been constrained to have the same type as <code>f</code>. The inferred type of <code>xs</code> will therefore be <code>[(a -&gt; a) -&gt; a -&gt; a]</code>, so you\u2019ll get the same type error writing <code>[f (\\x -&gt; [x]) \"foo\" | f &lt;- xs]</code> as you did writing <code>f (\\x -&gt; [x]) \"foo\"</code>; even though <code>g</code> is more general, you\u2019ve hidden away some of that generality.</p>\n\n<hr>\n\n<p>Now you might be wondering why you would ever give a more restrictive signature for a function than necessary. The answer is\u2014to guide type inference and produce better error messages.</p>\n\n<p>For example, the type of <code>($)</code> is <code>(a -&gt; b) -&gt; a -&gt; b</code>; but in fact this is a more restrictive version of <code>id :: c -&gt; c</code>! Just set <code>c ~ a -&gt; b</code>. So in fact you can write <code>foo `id` (bar `id` baz quux)</code> instead of <code>foo $ bar $ baz quux</code>, but having this specialised identity function makes it clear to the compiler that you <em>expect</em> to use it to apply functions to arguments, so it can bail out earlier and give you a more descriptive error message if you make a mistake.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 46974276, "answer_count": 2, "score": 11, "last_activity_date": 1509143456, "creation_date": 1509102458, "question_id": 46973642, "link": "https://stackoverflow.com/questions/46973642/why-are-two-polymorphic-higher-order-functions-with-different-type-vars-equivale", "title": "Why are two polymorphic higher order functions with different type vars equivalent regarding their types?", "body": "<p>Coming from Javascript I understand that Haskell's list type enforces homogeneous lists. Now it has surprised me that the following different function types meet this requirement:</p>\n\n<pre><code>f :: (a -&gt; a) -&gt; a -&gt; a \nf g x = g x\n\ng :: (a -&gt; b) -&gt; a -&gt; b \ng h x = h x\n\nlet xs = [f, g] -- type checks\n</code></pre>\n\n<p>even though <code>g</code> is more widely applicable than <code>f</code>:</p>\n\n<pre><code>f(\\x -&gt; [x]) \"foo\" -- type error\ng(\\x -&gt; [x]) \"foo\" -- type checks\n</code></pre>\n\n<p>Shouldn't <code>(a -&gt; a)</code> be treated diffenrently than <code>(a -&gt; b)</code>. It seems to me as if the latter is a subtype of the former. But there are no subtype relationships in Haskell, right? So why does this work?</p>\n"}, {"tags": ["haskell", "header", "bytestring", "conduit"], "answers": [{"comments": [{"owner": {"reputation": 2781, "user_id": 1540547, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4f07f7dc869bd71c0ba13719468daeab?s=128&d=identicon&r=PG", "display_name": "jorgen", "link": "https://stackoverflow.com/users/1540547/jorgen"}, "edited": false, "score": 0, "creation_date": 1509153208, "post_id": 46984627, "comment_id": 80917953, "body": "Great! As a small detail I opted for takeWhileCE instead for now, but I&#39;ll benchmark it against Conduit.Binary."}, {"owner": {"reputation": 1946, "user_id": 1432740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a84709030a711eb919bec460051eac8?s=128&d=identicon&r=PG", "display_name": "Mateusz Kowalczyk", "link": "https://stackoverflow.com/users/1432740/mateusz-kowalczyk"}, "reply_to_user": {"reputation": 2781, "user_id": 1540547, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4f07f7dc869bd71c0ba13719468daeab?s=128&d=identicon&r=PG", "display_name": "jorgen", "link": "https://stackoverflow.com/users/1540547/jorgen"}, "edited": false, "score": 0, "creation_date": 1509198261, "post_id": 46984627, "comment_id": 80927258, "body": "<code>takeWhileCE</code> should work: I actually wanted to use that but I forgot its name and Conduit.Binary came up first on hackage."}, {"owner": {"reputation": 2781, "user_id": 1540547, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4f07f7dc869bd71c0ba13719468daeab?s=128&d=identicon&r=PG", "display_name": "jorgen", "link": "https://stackoverflow.com/users/1540547/jorgen"}, "edited": false, "score": 0, "creation_date": 1509198691, "post_id": 46984627, "comment_id": 80927371, "body": "Ok! Incidentally, can you think of something more elegant than <code>mapC id</code>, or is that standard? Apologies if this is now off topic.."}, {"owner": {"reputation": 1946, "user_id": 1432740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a84709030a711eb919bec460051eac8?s=128&d=identicon&r=PG", "display_name": "Mateusz Kowalczyk", "link": "https://stackoverflow.com/users/1432740/mateusz-kowalczyk"}, "reply_to_user": {"reputation": 2781, "user_id": 1540547, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4f07f7dc869bd71c0ba13719468daeab?s=128&d=identicon&r=PG", "display_name": "jorgen", "link": "https://stackoverflow.com/users/1540547/jorgen"}, "edited": false, "score": 1, "creation_date": 1509199599, "post_id": 46984627, "comment_id": 80927664, "body": "I think <code>mapC id</code> is canonical: you can see conduit author use it here <a href=\"https://www.snoyman.com/blog/2017/05/worst-function-in-conduit\" rel=\"nofollow noreferrer\">snoyman.com/blog/2017/05/worst-function-in-conduit</a>"}], "tags": [], "owner": {"reputation": 1946, "user_id": 1432740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a84709030a711eb919bec460051eac8?s=128&d=identicon&r=PG", "display_name": "Mateusz Kowalczyk", "link": "https://stackoverflow.com/users/1432740/mateusz-kowalczyk"}, "is_accepted": true, "score": 1, "last_activity_date": 1509145952, "creation_date": 1509145952, "answer_id": 46984627, "question_id": 46970428, "link": "https://stackoverflow.com/questions/46970428/conduit-that-checks-file-header/46984627#46984627", "title": "Conduit that checks file header", "body": "<p>Your <code>takeWhileC (/= separator)</code> is taking the whole <code>ByteString</code>: it's not working on chunks of <code>ByteString</code>s! You can use <code>Data.Conduit.Binary</code> to work on individual bytes of the stream. The below code works \"as expected\" I believe.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>module Main (main) where\n\nimport           Conduit\nimport           Data.ByteString (ByteString)\nimport           Data.ByteString.Conversion (toByteString')\nimport           Data.Char (ord)\nimport qualified Data.Conduit.Binary as B\nimport           GHC.Word (Word8)\n\nseparator :: Word8\nseparator = toEnum $ ord '#'\n\ncheck :: ByteString -&gt; Either String ()\ncheck _ = Right ()\n\nconfirmHeader :: ConduitM ByteString ByteString (Either String) ()\nconfirmHeader = do\n  B.takeWhile (/= separator) .| mapM_C check\n  B.drop 1 -- drop separator which stayed in stream\n  mapC id\n\nmain :: IO ()\nmain = print . runConduit $\n  yield (toByteString' \"header#rest\") .| confirmHeader .| sinkList\n</code></pre>\n\n<p>And the output:</p>\n\n<pre><code>[nix-shell:/tmp]$ ghc C.hs -fforce-recomp -Wall -Werror -o Main &amp;&amp; ./Main\n[1 of 1] Compiling Main             ( C.hs, C.o )\nLinking Main ...\nRight [\"rest\"]\n</code></pre>\n"}], "owner": {"reputation": 2781, "user_id": 1540547, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4f07f7dc869bd71c0ba13719468daeab?s=128&d=identicon&r=PG", "display_name": "jorgen", "link": "https://stackoverflow.com/users/1540547/jorgen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 1, "accepted_answer_id": 46984627, "answer_count": 1, "score": 2, "last_activity_date": 1509145952, "creation_date": 1509092093, "question_id": 46970428, "link": "https://stackoverflow.com/questions/46970428/conduit-that-checks-file-header", "title": "Conduit that checks file header", "body": "<p>I'd like to use <code>Conduit</code> in a setting where I read a binary file, check that it has the correct header, and then work on the remaining data in the file.</p>\n\n<p>Trying to write a conduit that checks the header and then streams the rest of the data on to the following conduits I run into trouble. I have them live in a <code>Either String</code> monad for some exception handling. Here's a simplified version of the code (I'm aware there's a <code>Condiut.Attoparsec</code> module, but for now I'd like to write it myself):</p>\n\n<pre><code>import Conduit (ConduitM, mapC, mapM_C, takeWhileCE) \nimport Data.ByteString.Conversion (toByteString')\n\nseparator :: ByteString\nseparator = toByteString' '#' \n\ncheck :: ByteString -&gt; Either String ()\n\nconfirmHeader :: ConduitM ByteString ByteString (Either String) ()\nconfirmHeader = do\n  takeWhileC (/= separator) .| mapM_C check\n  mapC id\n</code></pre>\n\n<p><code>separator</code> is a predefined <code>ByteString</code> that signals the end of the header. The line <code>mapC id</code> is supposed to pass on the rest of the stream if the header checks out. I left out the nonimportant details of <code>check</code>. </p>\n\n<p>The part checking the header works. The last line, however, apart from looking inelegant and non-idiomatic, doesn't work. Running something like</p>\n\n<pre><code>runConduit $ yield (toByteString' \"header#rest\") .| confirmHeader .| sinkList\n</code></pre>\n\n<p>Gives <code>Right []</code> rather than <code>Right [\"rest\"]</code>, as I had hoped. Any ideas? </p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1509094540, "post_id": 46968563, "comment_id": 80889548, "body": "I don&#39;t think you can in any meaningful way claim \u201cIO wraps at most one value\u201d."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509094547, "post_id": 46968563, "comment_id": 80889552, "body": "I think the IO monad is a bit a tricky one here, since &quot;implicitly&quot; it wraps over the state of the entire world (<code>IO</code>, theoretically speaking, stores the state and content of all files, network, devices,...)"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1509105234, "post_id": 46968563, "comment_id": 80896204, "body": "I don&#39;t know that they&#39;re an important enough concept that anyone thought of naming them. (Might be interesting to try to figure out how to characterise them formally though...)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1509112442, "post_id": 46968563, "comment_id": 80900894, "body": "As a container, though, <code>IO a</code> &quot;wraps&quot; exactly one value of type <code>a</code>. Just like <code>State</code> isn&#39;t a monad, but <code>State a</code> is (for some given type <code>a</code>). Maybe an affine monad, by analogy with affine types (an object can be used at most once).?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1509113496, "post_id": 46968563, "comment_id": 80901574, "body": "@chepner <code>State</code> is a better example since it can properly be analysed. I&#39;d say <code>State Bool</code> wraps exactly two values, <code>State Int</code> wraps 2\u2076\u2074 values, etc.. Then <code>IO ~ State RealWorld</code> wraps quite a lot of values..."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1509113892, "post_id": 46968563, "comment_id": 80901833, "body": "But the &quot;state&quot; type isn&#39;t relevant to what the OP is asking as I understand. A <code>Maybe b</code> value can contain at most one value of type <code>b</code>, while <code>[b]</code> wraps an arbitrary number of values of type <code>b</code>. Likewise, <code>IO b</code> wraps exactly one value of type <code>b</code>, because the fake <code>RealWorld</code> value stored as state doesn&#39;t affect any function you would bind the <code>IO</code> value to."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1509114337, "post_id": 46968563, "comment_id": 80902160, "body": "I think this can be formalized as something like this: Monads for which in the expression <code>x &gt;&gt;= f</code>, <code>f</code> is called at most once.  I still don&#39;t know a name for it."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1509117961, "post_id": 46968563, "comment_id": 80904568, "body": "Well, perhaps you&#39;re just looking for <i>monads isomorphic to <code>ErrorT e (Writer w)</code></i>."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1509121860, "post_id": 46968563, "comment_id": 80906650, "body": "@leftroundaboit it would at least be <code>State</code> instead of <code>Writer</code>. I&#39;m not sure if there are more things."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1509123348, "post_id": 46968563, "comment_id": 80907436, "body": "@Carl I&#39;ve abused the term &quot;linear&quot; before, in the sense of linear logic at the type level. The type signature <code>m a</code> must use <code>a</code> at most once, in the same way that <code>x &gt;&gt;= f</code> uses <code>f</code> at most once. The reason it&#39;s abuse is it would be &quot;linear&quot; if it must use it exactly once."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 2, "creation_date": 1509141755, "post_id": 46968563, "comment_id": 80915404, "body": "@Cirdec &quot;affine&quot; is the word for &quot;used at least once.&quot; <a href=\"https://en.wikipedia.org/wiki/Substructural_type_system\" rel=\"nofollow noreferrer\">See this</a>"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1509144035, "post_id": 46968563, "comment_id": 80916021, "body": "@HTNW: Not quite: <i>relevant</i> is \u201cat least once\u201d (no weakening/drop); <i>affine</i> is \u201cat most once\u201d (no contraction/copy), and <i>linear</i> is \u201cexactly once\u201d (no copy or drop)."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1509145054, "post_id": 46968563, "comment_id": 80916300, "body": "@JonPurdy Whoops, typo. Anyway, I think that&#39;s the word we&#39;re after."}, {"owner": {"reputation": 5480, "user_id": 532901, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5581aede1e72c9bbadf038129896b809?s=128&d=identicon&r=PG", "display_name": "Tiddo", "link": "https://stackoverflow.com/users/532901/tiddo"}, "edited": false, "score": 1, "creation_date": 1512117503, "post_id": 46968563, "comment_id": 82136066, "body": "It seems that &quot;affine monad&quot; is actually a term used in literature, but unfortunately I&#39;m not nearly familiar enough with category theorem to understand if that is what I meant. They seem to be introduced in the paper &quot;Bilinearity and cartesian closed monads.&quot; from &quot;A. Knock&quot; (theorem 2.1)."}], "owner": {"reputation": 5480, "user_id": 532901, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5581aede1e72c9bbadf038129896b809?s=128&d=identicon&r=PG", "display_name": "Tiddo", "link": "https://stackoverflow.com/users/532901/tiddo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 2, "answer_count": 0, "score": 4, "last_activity_date": 1509095223, "creation_date": 1509084807, "last_edit_date": 1509095223, "question_id": 46968563, "link": "https://stackoverflow.com/questions/46968563/is-there-a-name-for-the-set-of-monads-that-wrap-at-most-one-value", "title": "Is there a name for the set of Monads that wrap at most one value?", "body": "<p>As the title says, I'm looking for the name of the set of Monads that wrap at most one value (i.e. monads that call their binding operation at most once). This set includes monads like <code>Maybe</code> and <code>Either</code>, but not <code>List</code>. Does this set have a formal name? </p>\n\n<p>(EDIT: removed <code>IO</code> from the list, based on the comments)</p>\n"}, {"tags": ["dictionary", "haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1509076425, "post_id": 46967233, "comment_id": 80881806, "body": "<code>map (take 3) (take 3 (tails [1,2,3,4,5]))</code>"}, {"owner": {"reputation": 53, "user_id": 5315175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/296dc19f4ed9e20d6aad9039b8af8d86?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Johnny Sotoparra", "link": "https://stackoverflow.com/users/5315175/christian-johnny-sotoparra"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1509076749, "post_id": 46967233, "comment_id": 80881887, "body": "wait, what&#39;s going on here? and this returns the same error"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1509077127, "post_id": 46967233, "comment_id": 80881973, "body": "<code>map</code> only passes one item at a time to each call of the mapping function, not a sublist. My code uses <code>tails</code> followed by <code>take 3</code> in order to get the first 3 sublists."}, {"owner": {"reputation": 53, "user_id": 5315175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/296dc19f4ed9e20d6aad9039b8af8d86?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Johnny Sotoparra", "link": "https://stackoverflow.com/users/5315175/christian-johnny-sotoparra"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1509077500, "post_id": 46967233, "comment_id": 80882056, "body": "it still results as an error"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1509077791, "post_id": 46967233, "comment_id": 80882131, "body": "<a href=\"https://ideone.com/Jsa368\" rel=\"nofollow noreferrer\">It works for me</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6183967"}, "edited": false, "score": 0, "creation_date": 1521710529, "post_id": 46967233, "comment_id": 85850486, "body": "BTW, Haskell&#39;s error messages are weird which maybe daunting for beginner, you need to either devote your time into this old language which is said to be underrated (I think its getting overrated now) which practically will hinder your productivity(those hard to understand error messages), keep going deeper into the language and you will find it easier to debug. Switching to another easier language would boost your productivity without a doubt!"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5315175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/296dc19f4ed9e20d6aad9039b8af8d86?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Johnny Sotoparra", "link": "https://stackoverflow.com/users/5315175/christian-johnny-sotoparra"}, "edited": false, "score": 0, "creation_date": 1509077852, "post_id": 46967401, "comment_id": 80882145, "body": "Thanks for the detailed answer"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1509100386, "post_id": 46967401, "comment_id": 80893374, "body": "Filtering like that is much slower than just using <code>take 3</code> again as 4castle suggested."}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": true, "score": 7, "last_activity_date": 1509077577, "creation_date": 1509077577, "answer_id": 46967401, "question_id": 46967233, "link": "https://stackoverflow.com/questions/46967233/how-to-use-the-map-function-in-haskell/46967401#46967401", "title": "How to use the map function in haskell?", "body": "<p>Let's take a look at exactly what the error message is saying.</p>\n\n<pre><code>map (take 3) [1, 2, 3, 4, 5]\n</code></pre>\n\n<p><code>map</code>'s type signature is</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>So it takes a function from <code>a</code> to <code>b</code> and returns a function from <code>[a]</code> to <code>[b]</code>. In your case, the function is <code>take 3</code>, which takes a list and returns a list. So <code>a</code> and <code>b</code> are both <code>[t]</code>. Therefore, the second argument to <code>map</code> should be <code>[[t]]</code>, a list of lists. Now, Haskell looks at the second argument and sees that it's a list of numbers. So it says \"How can I make a number into a list?\" Haskell doesn't know of any good way to do that, so it complains that it doesn't know any type <code>Num [t]</code>.</p>\n\n<p>Now, as for what you meant to do, I believe it was mentioned in the comments. The <code>tails</code> function<sup>1</sup> takes a list and returns the list of all tails of that list. So</p>\n\n<pre><code>tails [1, 2, 3, 4, 5]\n-- ==&gt; [[1, 2, 3, 4, 5], [2, 3, 4, 5], [3, 4, 5], [4, 5], [5], []]\n</code></pre>\n\n<p>Now you can apply the <code>take</code> function to each argument.</p>\n\n<pre><code>map (take 3) (tails [1, 2, 3, 4, 5])\n-- ==&gt; [[1, 2, 3], [2, 3, 4], [3, 4, 5], [4, 5], [5], []]\n</code></pre>\n\n<p>Oops! We've got some extra values we don't want. We only want the values that have three elements in them. So let's <em>filter</em> out the ones we don't want. <code>filter</code> takes a predicate (which is just a fancy way of saying \"a function that returns a Boolean) and a list and returns a list containing only the elements that satisfy the predicate. The predicate we want is one that takes a list and returns whether or not that list has three elements.</p>\n\n<pre><code>\\x -&gt; ...           -- We want only the lists\n\\x -&gt; length x ...  -- whose length\n\\x -&gt; length x == 3 -- is exactly equal to 3\n</code></pre>\n\n<p>So that's our function. Now we pass that to <code>filter</code>.</p>\n\n<pre><code>filter (\\x -&gt; length x == 3) (map (take 3) (tails [1, 2, 3, 4, 5]))\n-- ==&gt; [[1, 2, 3], [2, 3, 4], [3, 4, 5]]\n</code></pre>\n\n<hr>\n\n<p>[1] Note that you may need to <code>import Data.List</code> to get the <code>tails</code> function.</p>\n"}], "owner": {"reputation": 53, "user_id": 5315175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/296dc19f4ed9e20d6aad9039b8af8d86?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Johnny Sotoparra", "link": "https://stackoverflow.com/users/5315175/christian-johnny-sotoparra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2949, "favorite_count": 0, "accepted_answer_id": 46967401, "answer_count": 1, "score": 1, "last_activity_date": 1509077577, "creation_date": 1509076252, "last_edit_date": 1509077053, "question_id": 46967233, "link": "https://stackoverflow.com/questions/46967233/how-to-use-the-map-function-in-haskell", "title": "How to use the map function in haskell?", "body": "<p>I'm trying to use map to return a list of lists.  But i keep getting an error.  I know map takes in a function and then uses that function.  But i keep getting an error on it.</p>\n\n<pre><code>map (take 3) [1,2,3,4,5]\n</code></pre>\n\n<p>This is supposed to return [[1,2,3],[2,3,4],[3,4,5]], but it returns this error</p>\n\n<pre><code>&lt;interactive&gt;:6:1: error:\n\u2022 Non type-variable argument in the constraint: Num [a]\n  (Use FlexibleContexts to permit this)\n\u2022 When checking the inferred type\n    it :: forall a. Num [a] =&gt; [[a]]\n</code></pre>\n\n<p>is it hitting null is that why?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1509063764, "post_id": 46965646, "comment_id": 80879065, "body": "Do you mean <code>threeTimes:: (a -&gt; a) -&gt; a -&gt; a</code>? Also, <code>f (f(fx))</code> is <i>not</i> the same as <code>f (f(f x))</code> - the space matters here. I&#39;m really unclear on what you are asking..."}, {"owner": {"reputation": 63648, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 1, "creation_date": 1509063784, "post_id": 46965646, "comment_id": 80879070, "body": "Likely you are just missing a space between <code>f</code> and <code>x</code>"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1509063830, "post_id": 46965646, "comment_id": 80879080, "body": "Your <code>threeTimes</code> function takes 3 parameters according to the type signature, but you&#39;re only using 2 parameters."}, {"owner": {"reputation": 11, "user_id": 1982065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ArR5X.jpg?s=128&g=1", "display_name": "Darren76", "link": "https://stackoverflow.com/users/1982065/darren76"}, "edited": false, "score": 0, "creation_date": 1509064079, "post_id": 46965646, "comment_id": 80879122, "body": "so let&#39;s say I run the code with  twice (+2) 10  The output would be 14. It adds 2 to 10 twice. What I am trying to figure out is how would it apply it three times so that output would be 16 instead of 14"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1509066864, "post_id": 46965646, "comment_id": 80879687, "body": "<code>applyNTimes n f x = iterate f x !! n</code>"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1509069566, "post_id": 46965646, "comment_id": 80880272, "body": "@4castle or <code>applyNTimes n = appEndo . stimes n . Endo</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 1982065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ArR5X.jpg?s=128&g=1", "display_name": "Darren76", "link": "https://stackoverflow.com/users/1982065/darren76"}, "edited": false, "score": 0, "creation_date": 1509066323, "post_id": 46965872, "comment_id": 80879563, "body": "Thank you so much. I got it now."}], "tags": [], "owner": {"reputation": 2970, "user_id": 1763955, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3a7a94d762a9d702b88404f840e31d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Carbon", "link": "https://stackoverflow.com/users/1763955/carbon"}, "is_accepted": false, "score": 1, "last_activity_date": 1509065244, "creation_date": 1509065244, "answer_id": 46965872, "question_id": 46965646, "link": "https://stackoverflow.com/questions/46965646/write-a-function-that-takes-another-function-and-an-int-and-applies-it-3-times/46965872#46965872", "title": "Write a function that takes another function and an Int and applies it 3 times", "body": "<p>Your space is getting in the way. Try this:</p>\n\n<pre><code>thrice :: (a -&gt; a) -&gt; a -&gt; a\nthrice f x = f $ f $ f x\n</code></pre>\n\n<p>That's an equivalent statement to:</p>\n\n<pre><code>thrice' :: (a -&gt; a) -&gt; a -&gt; a\nthrice' f x = f (f (f x))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 1982065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ArR5X.jpg?s=128&g=1", "display_name": "Darren76", "link": "https://stackoverflow.com/users/1982065/darren76"}, "edited": false, "score": 0, "creation_date": 1509066343, "post_id": 46965881, "comment_id": 80879570, "body": "Thank you guys. I got it now."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1509066303, "last_edit_date": 1509066303, "creation_date": 1509065282, "answer_id": 46965881, "question_id": 46965646, "link": "https://stackoverflow.com/questions/46965646/write-a-function-that-takes-another-function-and-an-int-and-applies-it-3-times/46965881#46965881", "title": "Write a function that takes another function and an Int and applies it 3 times", "body": "<p>You have two problems, one a simple typo, the other more conceptual.</p>\n\n<p>The <em>type</em> of <code>threeTimes</code> is exactly the same as that of <code>twice</code>; you give it a function and an argument.</p>\n\n<pre><code>threeTimes :: (a -&gt; a) -&gt; a -&gt; a\n</code></pre>\n\n<p>The body is fine; you simply forgot the space between <code>f</code> and <code>x</code>; <code>fx</code> is an undefined name.</p>\n\n<pre><code>threeTimes f x = f (f (f x))\n</code></pre>\n\n<p>The similarity between <code>twice</code> and <code>threeTimes</code> is even more apparent if you write them in point-free style (with a little more whitespace than is usual to emphasize the similar parts):</p>\n\n<pre><code>twice      f = f . f\nthreeTimes f = f . f . f\n</code></pre>\n\n<p>In fact, you could simply define <code>threeTimes f = f . twice f</code> (or <code>twice f . f</code>; the two are equivalent since composition is associative).</p>\n"}], "owner": {"reputation": 11, "user_id": 1982065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ArR5X.jpg?s=128&g=1", "display_name": "Darren76", "link": "https://stackoverflow.com/users/1982065/darren76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1509066303, "creation_date": 1509063296, "last_edit_date": 1509063751, "question_id": 46965646, "link": "https://stackoverflow.com/questions/46965646/write-a-function-that-takes-another-function-and-an-int-and-applies-it-3-times", "title": "Write a function that takes another function and an Int and applies it 3 times", "body": "<pre><code>twice :: (a -&gt; a) -&gt; a -&gt; a  \ntwice f x = f (f x)\n</code></pre>\n\n<p>This function applies it twice, but I couldn't figure out how it can apply it 3 times. I tried:</p>\n\n<pre><code>threeTimes:: (a -&gt; a) -&gt; a -&gt; a -&gt; a  \nthreeTimes f x = f (f(fx))  \n</code></pre>\n\n<p>and many other ways, but could't come up with a solution. Any help would be appreciated.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1509061866, "post_id": 46965379, "comment_id": 80878622, "body": "Or <code>readLn &gt;&gt;= sequence_ . flip replicate (putStrLn &quot;Hello World&quot;)</code>  (no imports needed)"}], "answers": [{"comments": [{"owner": {"reputation": 1192, "user_id": 7023187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/321015561587503/picture?type=large", "display_name": "Rares Dima", "link": "https://stackoverflow.com/users/7023187/rares-dima"}, "edited": false, "score": 0, "creation_date": 1509062095, "post_id": 46965417, "comment_id": 80878682, "body": "Thank you! That makes sense, I guess haskell has a pretty different typecasting mechanism."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 1192, "user_id": 7023187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/321015561587503/picture?type=large", "display_name": "Rares Dima", "link": "https://stackoverflow.com/users/7023187/rares-dima"}, "edited": false, "score": 0, "creation_date": 1509062217, "post_id": 46965417, "comment_id": 80878709, "body": "@RaresDima It&#39;s true! In general, try to write Haskell without declaring every type, and only do so when the compiler can&#39;t work it out, and it&#39;ll tell you when that is. GHC is smarter than most compilers you may be used to!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1192, "user_id": 7023187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/321015561587503/picture?type=large", "display_name": "Rares Dima", "link": "https://stackoverflow.com/users/7023187/rares-dima"}, "edited": false, "score": 4, "creation_date": 1509074109, "post_id": 46965417, "comment_id": 80881272, "body": "@RaresDima, but it&#39;s generally considered good practice to give a type signature to every top-level function. I also like to give a type signature to any non-trivial definition in a <code>let</code> or <code>where</code> clause, but that sometimes necessitates use of the <code>ScopedTypeVariables</code> language extension."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 6, "last_activity_date": 1509061992, "last_edit_date": 1509061992, "creation_date": 1509061327, "answer_id": 46965417, "question_id": 46965379, "link": "https://stackoverflow.com/questions/46965379/how-to-read-an-int-in-one-line-of-code/46965417#46965417", "title": "How to read an Int in one line of code?", "body": "<p>You're mixing type declarations with expressions. It should be:</p>\n\n<pre><code>main = (readLn :: IO Int) &gt;&gt;= \\n -&gt; mapM_ putStrLn $ replicate n \"Hello World!\"\n</code></pre>\n\n<p>Your problem was that without bracketing, the compiler continues to parse as if it were reading a type declaration, and so it ran across <code>\\</code> and got stuck.</p>\n\n<p>However, this type declaration is inferred (since <code>replicate :: Int -&gt; a -&gt; [a]</code>) and thus unnecessary. <strong>Remove it!</strong></p>\n\n<pre><code>main = readLn &gt;&gt;= \\n -&gt; mapM_ putStrLn $ replicate n \"Hello World!\"\n</code></pre>\n\n<p>In general however, it's much better to avoid this entirely and just use <code>do</code>-notation. This kind of 'golfing' in Haskell is very fun, but not the way to make clear, maintainable code.</p>\n\n<pre><code>import Control.Monad (replicateM_)\n\nmain = do\n    n &lt;- readLn :: IO Int                   -- Type optional here.\n    replicateM_ n $ putStrLn \"Hello World!\" -- A more concise expression.\n</code></pre>\n"}], "owner": {"reputation": 1192, "user_id": 7023187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/321015561587503/picture?type=large", "display_name": "Rares Dima", "link": "https://stackoverflow.com/users/7023187/rares-dima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1509061992, "creation_date": 1509061024, "question_id": 46965379, "link": "https://stackoverflow.com/questions/46965379/how-to-read-an-int-in-one-line-of-code", "title": "How to read an Int in one line of code?", "body": "<p>I'm just starting to learn Haskell after first getting my hands dirty in functional programming with python.</p>\n\n<p>First of all, I know what I will ask is bad practice is virtually every programming language known to man, and I promise to not use this in any serious purpose other than purely educational. That said...</p>\n\n<p>One of the things I liked best was the elegance of writing a function using just one line of code while still keeping the code readable(things like C/C++ style where you just place all the statements on one line separated by semicolons don't count, obviously)</p>\n\n<p>I have looked trough questions and tried at least a few different haskell tutorials and documentations and some things have gotten close, but I could not find something that lets me read a usable Int in one line of code. </p>\n\n<p>For the sake of the question let's say I want something like reading an Int for the keyboard and printing \"Hello World!\" that many times(shamelessly stolen from HackerRank).</p>\n\n<p>The things I have tried using <code>getLine</code>, <code>readLn</code>, <code>read</code>, looked into <code>&gt;&gt;=</code> instead of do notation, only to remain stuck with IO operations stubbornly giving me an error every time I did not put them in a separate statement.</p>\n\n<p>Some of the things I have tried:</p>\n\n<pre><code>main :: IO ()\nmain = readLn :: IO Int &gt;&gt;= \\n -&gt; mapM_ putStrLn $ replicate n \"Hello World!\"\n</code></pre>\n\n<p>gives: </p>\n\n<pre><code>parse error on input \u2018\\\u2019\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>main = readLn &gt;&gt;= \\n -&gt; read n :: Int &gt;&gt;= \\n -&gt; mapM_ putStrLn $ replicate n \"Hello World!\"\n</code></pre>\n\n<p>Gives the same error.</p>\n\n<p>Same with:</p>\n\n<pre><code>main = getLine &gt;&gt;= \\n -&gt; read n :: Int &gt;&gt;= \\n -&gt; mapM_ putStrLn $ replicate n \"Hello World!\"\n</code></pre>\n\n<p>What exactly am I not understanding? Thanks in advance! </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1509055667, "post_id": 46964181, "comment_id": 80876926, "body": "Try <code>deepseq</code> to force creation of matrices <code>a</code> &amp; <code>b</code> before <code>start &lt;- ...</code> in above examples."}, {"owner": {"reputation": 107, "user_id": 3925436, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf9a6edd82ce618bfb3a69a9ab3214cd?s=128&d=identicon&r=PG&f=1", "display_name": "vvebik", "link": "https://stackoverflow.com/users/3925436/vvebik"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1509055980, "post_id": 46964181, "comment_id": 80877029, "body": "@freestyle It helps, but I wonder why this increases the time? Is it laziness, or optimization, or something else?"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 1, "creation_date": 1509056130, "post_id": 46964181, "comment_id": 80877083, "body": "Your code looks like: &quot;Hey, compiler/runtime, create matrices when you want.&quot; And this they do. Why, I don&#39;t known. But I know it&#39;s compiler dependent code."}], "owner": {"reputation": 107, "user_id": 3925436, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf9a6edd82ce618bfb3a69a9ab3214cd?s=128&d=identicon&r=PG&f=1", "display_name": "vvebik", "link": "https://stackoverflow.com/users/3925436/vvebik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509057195, "creation_date": 1509053583, "last_edit_date": 1509055164, "question_id": 46964181, "link": "https://stackoverflow.com/questions/46964181/haskell-time-measurment", "title": "Haskell time measurment", "body": "<p>I have the following matrix multiplication function</p>\n\n<pre><code>winograd :: M.Matrix Int -&gt; M.Matrix Int -&gt; M.Matrix Int\nwinograd a b = c\nwhere\n  ra = M.nrows a\n  ca = M.ncols a\n  rb = M.nrows b\n  cb = M.ncols b\n\n  isEven = even ca\n\n  avs = V.generate ra $ \\i -&gt; M.getRow (i+1) a\n  bvs = V.generate cb $ \\j -&gt; M.getCol (j+1) b\n\n  rows = V.generate ra $ \\i -&gt; wgdGroup $ V.unsafeIndex avs i\n  cols = V.generate cb $ \\j -&gt; wgdGroup $ V.unsafeIndex bvs j\n\n  wgdGroup x = let\n                 finish = (V.length x - 1)\n               in\n                 forLoopFold 0 (&lt;finish) (+2) 0 $\n                 \\acc i -&gt; acc\n                 - V.unsafeIndex x i *  V.unsafeIndex x (i+1)\n\n  c = if isEven then\n        M.matrix ra cb $\n        \\(i,j) -&gt;\n        V.unsafeIndex rows (i-1) +\n        V.unsafeIndex cols (j-1)  +\n        g (V.unsafeIndex avs (i-1)) (V.unsafeIndex bvs (j-1))\n      else\n        M.matrix ra cb $\n        \\(i,j) -&gt;\n        V.unsafeIndex rows (i-1) +\n        V.unsafeIndex cols (j-1) +\n        g (V.unsafeIndex avs (i-1)) (V.unsafeIndex bvs (j-1)) +\n        V.last (V.unsafeIndex avs (i-1)) * V.last (V.unsafeIndex bvs (j-1))\n\n  g r c = forLoopFold 0 (&lt;(ca-1)) (+2) 0 $ \\acc i -&gt;\n            let\n              x1 = V.unsafeIndex r i\n              x2 = V.unsafeIndex r (i+1)\n              y1 = V.unsafeIndex c i\n              y2 = V.unsafeIndex c (i+1)\n            in\n            acc + (x1+y2)*(x2+y1)\n</code></pre>\n\n<p>And I measure the execution time of this function as follows, using <code>clock</code> and <code>formatting</code> packages (yes, I know about Criterion, but now I need to measure it this way):</p>\n\n<pre><code>main :: IO ()\nmain = do\n  let a = simple 2 (-1) 1000\n  let b = simple 2 (-3) 1000\n  start &lt;- getTime Realtime\n  let\n    c = winograd a b\n  end &lt;- c `deepseq` getTime Realtime\n  fprint (timeSpecs % \"\\n\") start end\n</code></pre>\n\n<p>where <code>simple</code> is</p>\n\n<pre><code>simple :: Int -&gt; Int -&gt; Int -&gt; M.Matrix Int\nsimple x y size = M.matrix size size $ \\(i,j) -&gt; x*i+y*j\n</code></pre>\n\n<p>I get the result about 5 seconds. But when I get rid of the function <code>simple</code> and do like this:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  let a = M.matrix 1000 1000 $ \\(i,j) -&gt; 2*i-1*j\n  let b = M.matrix 1000 1000 $ \\(i,j) -&gt; 2*i-3*j\n  start &lt;- getTime Realtime\n  let\n    c = winograd a b\n  end &lt;- c `deepseq` getTime Realtime\n  fprint (timeSpecs % \"\\n\") start end\n</code></pre>\n\n<p>the time increases to 15 seconds!</p>\n\n<p>Very interesting why. Compiled with flag -O2.</p>\n"}, {"tags": ["haskell", "elm", "quickcheck", "fuzzing"], "comments": [{"owner": {"reputation": 1946, "user_id": 1432740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a84709030a711eb919bec460051eac8?s=128&d=identicon&r=PG", "display_name": "Mateusz Kowalczyk", "link": "https://stackoverflow.com/users/1432740/mateusz-kowalczyk"}, "edited": false, "score": 1, "creation_date": 1509050260, "post_id": 46963209, "comment_id": 80874501, "body": "A large part of using QuickCheck (or other similar test generators) is controlling the size of the structures generated, trying to get meaningful coverage. See <a href=\"https://begriffs.com/posts/2017-01-14-design-use-quickcheck.html\" rel=\"nofollow noreferrer\">begriffs.com/posts/2017-01-14-design-use-quickcheck.html</a> for an example of controlling the size. As a side note, I think testing that <code>(encode . decode) = id</code> is somewhat silly. Assuming your contained data doesn&#39;t violated, neither will your automatically generated instance. I would advise instead to make <code>personOptions :: Options</code> and make sure from FromJSON/ToJSON instances use these: that way both change when needed."}], "owner": {"reputation": 115, "user_id": 1633942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CimlZ.png?s=128&g=1", "display_name": "anotherhale", "link": "https://stackoverflow.com/users/1633942/anotherhale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1509049538, "creation_date": 1509049538, "question_id": 46963209, "link": "https://stackoverflow.com/questions/46963209/too-many-quickcheck-permutations-for-nested-json", "title": "Too many quickcheck permutations for nested JSON", "body": "<p>I am following the example from this <a href=\"http://shmish111.github.io/2017/03/18/safe-json-with-haskell/\" rel=\"nofollow noreferrer\">blog</a> to test my JSON encoding/decoding and have run into an issue with deeply nested JSON.  The JSON structure has too many permutations to successfully test with quickcheck.  I ran into a similar issue with my client side Elm encode/decode fuzz testing.  I was able to overcome that by testing the two branches under the root node individually and then when testing the root node using constant values for the branches (because they were already tested).  Elm and haskell code are <a href=\"https://gist.github.com/anotherhale/ba9fd29bf07b261f01037a54c553ebc3\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Is there a similar solution that I can apply to haskell?</p>\n\n<p>Notes from my Elm code:</p>\n\n<pre><code>-- Initially `round trip table` attempted to fuzz test the entire table structure.\n-- This was conuming massive amounts of memory (&gt;1.5G) until the node process ran\n-- out of memory.  To overcome this I fuzz test the board and sprite structures\n-- individually and then fuzz test the table structure using Fuzz.constant on the\n-- board and sprite lists so that it does not consume too much memory on the\n-- already fuzz tested structures.\n</code></pre>\n\n<p><a href=\"https://gist.github.com/anotherhale/ba9fd29bf07b261f01037a54c553ebc3\" rel=\"nofollow noreferrer\">Example Gist</a></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 5, "creation_date": 1509048903, "post_id": 46962779, "comment_id": 80873828, "body": "<code>pairs</code> takes a list of <b>pairs</b> and a pair. You are sending it a list of <b>numbers</b> and a pair."}], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 3, "last_activity_date": 1509048671, "creation_date": 1509048671, "answer_id": 46962963, "question_id": 46962779, "link": "https://stackoverflow.com/questions/46962779/adding-a-calculation-to-a-tuple/46962963#46962963", "title": "Adding a calculation to a tuple", "body": "<p>You are putting the wrong types into your function</p>\n\n<pre><code>pairs [1,1] (1,1)\n</code></pre>\n\n<p>Should be <code>pairs [(1,1)] (1,1)</code></p>\n\n<p>The error message you get is because the compiler tries to convert a <code>1</code> (list element) into a pair <code>??</code> but fails to do so.</p>\n"}], "owner": {"reputation": 105, "user_id": 7841878, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ea84e22431b5da70d9f514ee95767b09?s=128&d=identicon&r=PG&f=1", "display_name": "James Hamish", "link": "https://stackoverflow.com/users/7841878/james-hamish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1509048671, "creation_date": 1509047903, "last_edit_date": 1509048285, "question_id": 46962779, "link": "https://stackoverflow.com/questions/46962779/adding-a-calculation-to-a-tuple", "title": "Adding a calculation to a tuple", "body": "<p>I have two functions </p>\n\n<pre><code>somefunc:: (Floating a, Ord a) =&gt; (a, a) -&gt; (a, a) -&gt; a\n\npairs :: (Floating a, Ord a) =&gt;[(a,a)] -&gt; (a,a) -&gt; [((a, a), a)]\npairs xs p = zip xs (map (somefunc p) xs)\n</code></pre>\n\n<p>I am trying to make a calculation with some func and append this to each tuple.\nMy code compiles, however when I try to execute my code like this</p>\n\n<pre><code>pairs [1,1] (1,1)\n</code></pre>\n\n<p>I get the following error </p>\n\n<pre><code>&lt;interactive&gt;:49:1: error:\n\u2022 Non type-variable argument in the constraint: Num (a, a)\n  (Use FlexibleContexts to permit this)\n\u2022 When checking the inferred type\n    it :: forall a. (Num (a, a), Ord a, Floating a) =&gt; [((a, a), a)]\n</code></pre>\n\n<p>Could someone explain this error to me?</p>\n"}, {"tags": ["list", "haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1509046891, "post_id": 46962187, "comment_id": 80872745, "body": "Since <code>||</code> is lazy, I&#39;d consider the alternative to be, in all aspects but syntax, tail recursive. Its execution has essentially the same space and time of the tail recursive one."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1509047047, "post_id": 46962187, "comment_id": 80872836, "body": "Why did you change <code>||</code> to <code>&amp;&amp;</code> in the <code>foldl</code>?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1509048249, "post_id": 46962187, "comment_id": 80873499, "body": "@4castle - because I had it copied from the wrong section in my ghci session, I tested it in order to have no incorrect code - but then copied the wrong part. - updated"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1509056800, "post_id": 46962187, "comment_id": 80877290, "body": "I think starting the second section with &quot;Alternatively&quot; could be a bit confusing, since it sounds like you&#39;re saying rewriting the last line is an alternative way to solve the OP&#39;s problem. It&#39;s actually just extra advice; they&#39;ll need to add <code>Eq a</code> anyway. Would something like &quot;Additionally&quot; be a better lead in?"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 8, "last_activity_date": 1509058421, "last_edit_date": 1509058421, "creation_date": 1509045481, "answer_id": 46962187, "question_id": 46962107, "link": "https://stackoverflow.com/questions/46962107/haskell-ismember-function-error/46962187#46962187", "title": "Haskell isMember function error", "body": "<p>you are almost there</p>\n\n<pre><code>isMember :: Eq a =&gt; a -&gt; [a] -&gt; Bool\nisMember _ [] = False\nisMember y (x:xs) =\n if y == x then True else isMember y xs\n</code></pre>\n\n<p>What the compiler tells you that you promised to accept any type of list members - but later you use the function <code>==</code> which is not available for all types (for example functions).</p>\n\n<p>By adding <code>Eq a =&gt;</code> you say I accept all input which have an equals method.</p>\n\n<h2>Some additional notes</h2>\n\n<p>You can (re)write the last line as</p>\n\n<pre><code>isMember y (x:xs) = (y == x) || isMember y xs\n</code></pre>\n\n<p>which is equivalent to your implementation (thanks @chi for the comment).\nWhat is nice about your version is that it is tail recursive.</p>\n\n<p>Another point to note - the pattern:</p>\n\n<ul>\n<li>return something for empty list case (<code>isMember _ [] = False</code>)</li>\n<li>and iterate over the list with this value (<code>isMember y (x:xs) = ...</code>)</li>\n</ul>\n\n<p>happens to turn up a lot and has been abstracted into the family of <code>fold</code> -functions (<code>foldl</code>, <code>foldr</code> ...). Putting it in your use case it looks like</p>\n\n<pre><code>isMember y xs = foldl False (\\x b -&gt; (x == y) || b) xs\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 8486961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XQbtc.jpg?s=128&g=1", "display_name": "Kieran Atkins", "link": "https://stackoverflow.com/users/8486961/kieran-atkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 46962187, "answer_count": 1, "score": 6, "last_activity_date": 1509058559, "creation_date": 1509045201, "last_edit_date": 1509058559, "question_id": 46962107, "link": "https://stackoverflow.com/questions/46962107/haskell-ismember-function-error", "title": "Haskell isMember function error", "body": "<pre><code>isMember:: a -&gt; [a] -&gt; Bool\nisMember y [] = False\nisMember y (x:xs) =\n if y == x then\n  True\n else\n  isMember y xs\n</code></pre>\n\n<p>Trying to create a function that will identify whether something is a member of a list. For example: </p>\n\n<pre><code>isMember 6 [1,2,3,4,5,6]\n&gt;True\n</code></pre>\n\n<p>However I keep getting a complier error stating 'no instance for (Eq a) arising from the use of '=='</p>\n\n<p>Help would be appreciated (I'm new to Haskell &amp; Recursion in functional languages so explain like I'm five.)</p>\n"}, {"tags": ["haskell", "game-loop"], "answers": [{"comments": [{"owner": {"reputation": 2447, "user_id": 2061783, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5fc1d7081d9f24bd0307795baea57d56?s=128&d=identicon&r=PG", "display_name": "danbroooks", "link": "https://stackoverflow.com/users/2061783/danbroooks"}, "edited": false, "score": 0, "creation_date": 1509039386, "post_id": 46960052, "comment_id": 80868407, "body": "Thats sorted it, great!"}], "tags": [], "owner": {"reputation": 1946, "user_id": 1432740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2a84709030a711eb919bec460051eac8?s=128&d=identicon&r=PG", "display_name": "Mateusz Kowalczyk", "link": "https://stackoverflow.com/users/1432740/mateusz-kowalczyk"}, "is_accepted": true, "score": 5, "last_activity_date": 1509042274, "last_edit_date": 1509042274, "creation_date": 1509037674, "answer_id": 46960052, "question_id": 46959753, "link": "https://stackoverflow.com/questions/46959753/setting-off-a-interval-on-application-launch-in-a-haskell-servant-app/46960052#46960052", "title": "Setting off a interval on application launch in a Haskell Servant app", "body": "<p><code>state</code> creates new IORef every time. Your web server and your thread update function work on two different IORefs and therefore on two different states. You want to share the IORef. Something like the following should work.</p>\n\n<pre><code>main :: IO ()\nmain = do\n  let port = 8000\n  ref &lt;- newIORef initialState\n  threadId &lt;- forkIO $ forever $ do\n    threadDelay $ seconds 2\n    updateState state ref\n  run port $ app ref\n</code></pre>\n"}], "owner": {"reputation": 2447, "user_id": 2061783, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5fc1d7081d9f24bd0307795baea57d56?s=128&d=identicon&r=PG", "display_name": "danbroooks", "link": "https://stackoverflow.com/users/2061783/danbroooks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 46960052, "answer_count": 1, "score": 1, "last_activity_date": 1509042274, "creation_date": 1509036640, "question_id": 46959753, "link": "https://stackoverflow.com/questions/46959753/setting-off-a-interval-on-application-launch-in-a-haskell-servant-app", "title": "Setting off a interval on application launch in a Haskell Servant app", "body": "<p>I'm trying to build the backend for a browser based game using Servant, I want to have some kind of game loop that lets me fire out requests every <code>x</code> seconds. I already have some game state contained in an <code>IORef</code>, and as an initial attempt to get something working I am trying to update my state value every 2 seconds. Here is what I have:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE TypeOperators #-}\n\nmodule Main where\n\nimport Prelude ()\nimport Prelude.Compat\n\nimport Control.Concurrent(forkIO, threadDelay)\nimport Control.Monad(forever)\nimport Control.Monad.Reader\nimport Data.Aeson.Compat\nimport Data.Aeson.Types\nimport Data.Maybe\nimport Data.IORef\nimport GHC.Generics\nimport Network.Wai.Handler.Warp\nimport Servant\nimport Servant.Utils.StaticFiles (serveDirectory)\n\ntype Api = \"players\" :&gt; Get '[JSON] [Player]\n      :&lt;|&gt; \"tick\" :&gt; Get '[JSON] Integer\n\ntype Game = Api :&lt;|&gt; Raw\n\ndata Player = Player\n  { name :: String\n  } deriving (Eq, Show, Generic)\n\ninstance ToJSON Player\n\ndata Action = AddPlayer Player\n  | Tick\n\ndata State = State {\n    players :: [Player]\n  , tick :: Integer }\n\ninitialState :: State\ninitialState = State { players = []\n                     , tick = 0\n                     }\n\nupdate :: Action -&gt; State -&gt; State\nupdate action state =\n  case action of\n    AddPlayer p -&gt;\n        state { players = [p] ++ (players state) }\n\n    Tick -&gt;\n        state { tick = 1 + (tick state) }\n\nupdateState :: Action -&gt; IORef State -&gt; IO State\nupdateState action state =\n  atomicModifyIORef state (\\s -&gt; (next s, s))\n  where next = update action\n\nseconds :: Int -&gt; Int\nseconds = (* 1000000)\n\ngetPlayers :: IORef State -&gt; Handler [Player]\ngetPlayers state = liftIO $ do\n  _ &lt;- updateState (AddPlayer $ Player \"Me\") state\n  s &lt;- readIORef state\n  return $ players s\n\ngetTick :: IORef State -&gt; Handler Integer\ngetTick state = liftIO $ do\n  s &lt;- readIORef state\n  return $ tick s\n\neverything :: Proxy Game\neverything = Proxy\n\nserver :: IORef State -&gt; Server Game\nserver state = (getPlayers state\n  :&lt;|&gt; getTick state)\n  :&lt;|&gt; serveDirectoryFileServer \"./build\"\n\napp :: IORef State -&gt; Application\napp state = serve everything (server state)\n\nmain :: IO ()\nmain = do\n  let port = 8000\n      state = newIORef initialState\n\n  threadId &lt;- forkIO $ forever $ do\n    threadDelay $ seconds 2\n    return $ updateState Tick =&lt;&lt; state\n\n  putStrLn $ \"Running server on \" ++ show port\n  run port . app =&lt;&lt; state\n</code></pre>\n\n<p>The app builds, but it doesn't do what I want it to, visiting <code>/tick</code> always returns <code>0</code>. I'm guessing this is either something to do with the change to state happening in a separate thread, or the <code>IO</code> value being passed in two separate times? However I believe that <code>forkIO</code> has to happen inside an <code>IO</code> block, so I'm unsure how to get the two values to meet. </p>\n\n<p>This kind of thing is exactly what Haskell seeks to avoid, which is probably why it's so difficult to achieve. My problem is that I want to have some way to trigger a function (that is able to modify <code>State</code>) every <code>x</code> seconds, if the solution involves going down an entirely separate route then so be it.</p>\n"}, {"tags": ["list", "function", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509028550, "post_id": 46957135, "comment_id": 80861645, "body": "Looks almost exactly like what <a href=\"https://stackoverflow.com/questions/46951089/get-permutations-of-length-n-of-a-list-in-haskell\">this question wants</a>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509028606, "post_id": 46957135, "comment_id": 80861690, "body": "And <code>qs = [ z:[] | z &lt;- ys ] com (x-1) qs</code> does not make any sense at all, since a list does not take any arguments..."}, {"owner": {"reputation": 21, "user_id": 8734913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a1e1c06250d63116de45701eab3e034?s=128&d=identicon&r=PG&f=1", "display_name": "Even Sandvik", "link": "https://stackoverflow.com/users/8734913/even-sandvik"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509029618, "post_id": 46957135, "comment_id": 80862426, "body": "Yes thats obvious to me now, oops. What im trying to do with this code is to repeat the add list element x-times"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509029685, "post_id": 46957135, "comment_id": 80862480, "body": "What do you mean with <i>i needed it as a parameterd</i>?"}, {"owner": {"reputation": 21, "user_id": 8734913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a1e1c06250d63116de45701eab3e034?s=128&d=identicon&r=PG&f=1", "display_name": "Even Sandvik", "link": "https://stackoverflow.com/users/8734913/even-sandvik"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509032517, "post_id": 46957135, "comment_id": 80864375, "body": "I prematurely sent the message haha."}, {"owner": {"reputation": 21, "user_id": 8734913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a1e1c06250d63116de45701eab3e034?s=128&d=identicon&r=PG&f=1", "display_name": "Even Sandvik", "link": "https://stackoverflow.com/users/8734913/even-sandvik"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509033426, "post_id": 46957135, "comment_id": 80864950, "body": "Sorry it took so long to answer btw, but do you have any ideas for a solution. What i find hard is making the code repeat."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1509035321, "post_id": 46957135, "comment_id": 80866139, "body": "Your function is the same as <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Monad.html#v:replicateM\" rel=\"nofollow noreferrer\"><code>replicateM</code></a> where <code>Applicative m</code> is specialized to <code>[]</code>. The source code for that function is <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/src/Control.Monad.html#replicateM\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1509035519, "post_id": 46957135, "comment_id": 80866243, "body": "The case when <code>x = 0</code> should be <code>[[]]</code>, there&#39;s 1 list of length 0, the empty list <code>[]</code>."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1509043414, "post_id": 46957135, "comment_id": 80870669, "body": "You could also implement it as <code>com x ys = sequence (replicate x ys)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 42750, "user_id": 189134, "user_type": "moderator", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jFsyb.png?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/189134/andy"}, "edited": false, "score": 0, "creation_date": 1509041209, "post_id": 46958704, "comment_id": 80869388, "body": "Comments are not for extended discussion; this conversation has been <a href=\"http://chat.stackoverflow.com/rooms/157604/discussion-on-answer-by-will-ness-i-need-to-combine-all-elements-in-a-list-using\">moved to chat</a>."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 4, "last_activity_date": 1509039380, "last_edit_date": 1509039380, "creation_date": 1509033156, "answer_id": 46958704, "question_id": 46957135, "link": "https://stackoverflow.com/questions/46957135/i-need-to-combine-all-elements-in-a-list-using-only-prelude-and-no-other-modules/46958704#46958704", "title": "I need to combine all elements in a list using only prelude and no other modules in Haskell", "body": "<p>You started good:\n<code><pre>com :: Int -> [t] -> [[t]]\ncom x [] = {- [] -} [[]]     -- thanks to @cirdec for spotting this\ncom 1 ys = [ [z]   | z &lt;- ys]\ncom 2 ys = <b>[ [z,q] | z &lt;- ys, q &lt;- ys]</b>                                 -- &lt;&lt;----</pre></code></p>\n\n<p>now continue with it for a while:\n<code><pre>com 3 ys = [ [y,z,q] | y &lt;- ys, z &lt;- ys, q &lt;- ys]\n         = [ y:[z,q] | y &lt;- ys, z &lt;- ys, q &lt;- ys]\n         = [ y:[z,q] | y &lt;- ys, [z,q] &lt;- <b>[ [z,q] | z &lt;- ys, q &lt;- ys]</b>]  -- &lt;&lt;----\n         = [ y:r2    | y &lt;- ys, r2    &lt;- <b>[ [z,q] | z &lt;- ys, q &lt;- ys]</b>]  -- &lt;&lt;----\n         = [ y:r2    | y &lt;- ys, r2    &lt;- ...... ]</pre></code></p>\n\n<p>right? We can always replace equals by equals, in Haskell!</p>\n\n<pre><code>com 4 ys = [ [x,y,z,q] | x &lt;- ys, y &lt;- ys, z &lt;- ys, q &lt;- ys]\n         = [ x:[y,z,q] | x &lt;- ys, y &lt;- ys, z &lt;- ys, q &lt;- ys]\n         = ....\n         = [ x:r3      | x &lt;- ys, r3 &lt;- ...... ]\n</code></pre>\n\n<p>can you continue this? can you finish up this line of thought?</p>\n\n<pre><code>com n ys | n &gt; 4 = [ x:r | x &lt;- ys, r &lt;- .... (n-1) .... ]\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8734913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a1e1c06250d63116de45701eab3e034?s=128&d=identicon&r=PG&f=1", "display_name": "Even Sandvik", "link": "https://stackoverflow.com/users/8734913/even-sandvik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1509039380, "creation_date": 1509028491, "last_edit_date": 1509028811, "question_id": 46957135, "link": "https://stackoverflow.com/questions/46957135/i-need-to-combine-all-elements-in-a-list-using-only-prelude-and-no-other-modules", "title": "I need to combine all elements in a list using only prelude and no other modules in Haskell", "body": "<p>n is the first argument, and a list is the second. The elements can be can selected several times and in different order.\nSo it will look something like: </p>\n\n<pre><code>com 1 [1,2,3] = [ [1], [2], [3] ]\n\ncom 2 [1,2,3] = [[1,1],[1,2],[1,3],[2,1],[2,2],[2,3],[3,1],[3,2],[3,3]]\n</code></pre>\n\n<p>Ive written these and they work but i need a general function</p>\n\n<pre><code>com :: Int -&gt; [t] -&gt; [[t]]\ncom x [] = []\ncom 1 ys = [[z]| z &lt;- ys]\ncom 2 ys = [z:q:[] | z &lt;- ys, q &lt;- ys]\n</code></pre>\n\n<p>I think it will look something like this:</p>\n\n<pre><code>com x ys\n  | x &lt; 0 = []\n  | otherwise qs = [ z:[] | z &lt;- ys ] com (x-1) qs\n</code></pre>\n\n<p>all help appreciated</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1509016907, "post_id": 46952793, "comment_id": 80852902, "body": "Although it is finite for every <code>n</code>, Haskell is <b>statically typed</b>. This means that the type of a function can not depend on the <b>value</b> of a parameter."}, {"owner": {"reputation": 144, "user_id": 8299684, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/13e72908732ef4648880cd34f9b0279d?s=128&d=identicon&r=PG", "display_name": "Raskell", "link": "https://stackoverflow.com/users/8299684/raskell"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509017192, "post_id": 46952793, "comment_id": 80853080, "body": "Is there any way to get around the type system in this case?"}, {"owner": {"reputation": 144, "user_id": 8299684, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/13e72908732ef4648880cd34f9b0279d?s=128&d=identicon&r=PG", "display_name": "Raskell", "link": "https://stackoverflow.com/users/8299684/raskell"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509017444, "post_id": 46952793, "comment_id": 80853255, "body": "I realise it&#39;s probably not possible as we do not specify enough to the compiler: for one, the function only works for polymorphic f. Is there a way to declare a type as polymorphic? If I&#39;m not wrong, writing a type declaration for composeMap will result in a static type for f, but that won&#39;t do."}, {"owner": {"reputation": 144, "user_id": 8299684, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/13e72908732ef4648880cd34f9b0279d?s=128&d=identicon&r=PG", "display_name": "Raskell", "link": "https://stackoverflow.com/users/8299684/raskell"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509017851, "post_id": 46952793, "comment_id": 80853514, "body": "I realise the broader question here is: how is the composition of polymorphically-typed functions handled? It seems that Haskell needs all of the information about which functions are going to be composed to come up with a sensible type inference."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1509018556, "post_id": 46952793, "comment_id": 80853996, "body": "Well after compile time, the type of all functions is fully known, or it does not matter. That&#39;s afaik one of the reasons one speaks of <i>type erasure</i>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1509019746, "post_id": 46952793, "comment_id": 80854811, "body": "Your first definition of <code>composeMap</code> works just fine here. Your second one works fine, too, once I add a <code>&#39;</code> to the recursive call. I&#39;m voting to close."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509019894, "post_id": 46952793, "comment_id": 80854905, "body": "You can also avoid explicit recursion with <code>composeMap n f = foldr (.) id (replicate n f)</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509019972, "post_id": 46952793, "comment_id": 80854957, "body": "I wouldn&#39;t say it <i>only</i> works for polymorphic functions; rather, it <i>works</i> for polymorphic functions, as long as the input and output types match, i.e., <code>b -&gt; b</code> but not <code>a -&gt; b</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1509020074, "post_id": 46952793, "comment_id": 80855034, "body": "See also <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Data-Semigroup.html#v:stimesMonoid\" rel=\"nofollow noreferrer\"><code>stimesMonoid</code></a> which is your operation when you choose <code>Endo a</code> as the <code>Monoid</code>, and <a href=\"https://stackoverflow.com/q/40983249/791604\">further discussion of this operation</a>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1509020459, "post_id": 46952793, "comment_id": 80855342, "body": "And, <i>both</i> your functions are recursive; the second one is tail-recursive because nothing is done with the return value of the recursive call except to return it."}, {"owner": {"reputation": 144, "user_id": 8299684, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/13e72908732ef4648880cd34f9b0279d?s=128&d=identicon&r=PG", "display_name": "Raskell", "link": "https://stackoverflow.com/users/8299684/raskell"}, "edited": false, "score": 0, "creation_date": 1509023970, "post_id": 46952793, "comment_id": 80857997, "body": "chepner         try, for example, composeMap 3 map. Haskell, considers it, like the functions I gave in the post, as trying to implement an infinite type."}, {"owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "edited": false, "score": 1, "creation_date": 1509026214, "post_id": 46952793, "comment_id": 80859800, "body": "If I am interpreting your clarification correctly, then you want <code>composeMap 2 map</code> to behave like <code>map . map</code> and <code>composeMap 3 map</code> to behave like <code>map . map . map</code> and so on. Is that correct?  The type of <code>map . map</code> is <code>(a -&gt; b) -&gt; [[a]] -&gt; [[b]]</code> and that of <code>map . map . map</code> is <code>(a -&gt; b) -&gt; [[[a]]] -&gt; [[[b]]]</code>, i.e. you want the type of the output value of <code>composeMap</code> to depend on value of input <code>n</code> (which is always of type <code>Eq a, Num a =&gt; a</code>).  I don&#39;t think this is possible but it might be using dependent types or maybe some hack involving dynamic types."}, {"owner": {"reputation": 144, "user_id": 8299684, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/13e72908732ef4648880cd34f9b0279d?s=128&d=identicon&r=PG", "display_name": "Raskell", "link": "https://stackoverflow.com/users/8299684/raskell"}, "edited": false, "score": 0, "creation_date": 1509028068, "post_id": 46952793, "comment_id": 80861275, "body": "sam             That is indeed what I want. I am open to even using templates to write the boilerplate code <code>(map . map . ...  . map)</code>"}, {"owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "edited": false, "score": 0, "creation_date": 1509033623, "post_id": 46952793, "comment_id": 80865069, "body": "@Raskell although the thing that you want exactly is not possible, it seems like the problem you are facing is updating values in deeply nested data structures. For this there is a nice template haskell library here: <a href=\"https://www.stackage.org/lts-9.10/package/syb-0.7\" rel=\"nofollow noreferrer\">stackage.org/lts-9.10/package/syb-0.7</a> and a good introduction to using this library is the paper &#39;Scrap Your Boilerplate: A Practical Design Pattern for Generic Programming&#39; available at: <a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/2003/01/hmap.pdf\" rel=\"nofollow noreferrer\">microsoft.com/en-us/research/wp-content/uploads/2003/01/&hellip;</a>"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1509036634, "post_id": 46952793, "comment_id": 80866882, "body": "You don&#39;t need dependent types. This is the sort of thing you can do with a type class with overlapping instances (and additionally in this case, I think you want type families), but this isn&#39;t often done because these are sort of end-of-the-road abstractions; you start to lose type inference and it&#39;s difficult to build anything useful on top of them. But this kind of thing can be useful for getting rid of boilerplate, saving programmers keystrokes or mental overhead or making an API look a little prettier on the value level and uglier in the types."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1509084568, "post_id": 46952793, "comment_id": 80884358, "body": "You can also model something like this with non-regular datatypes.  E.g. <code>data Nested f a = Pure a | Nest (Nested f (f a))</code> is a data type that represents the disjunction <code>a</code> or <code>f a</code> or <code>f (f a)</code> ... which would be the return type of your function."}], "answers": [{"comments": [{"owner": {"reputation": 144, "user_id": 8299684, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/13e72908732ef4648880cd34f9b0279d?s=128&d=identicon&r=PG", "display_name": "Raskell", "link": "https://stackoverflow.com/users/8299684/raskell"}, "edited": false, "score": 0, "creation_date": 1509024566, "post_id": 46954194, "comment_id": 80858514, "body": "As I&#39;ve clarified in my post, I don&#39;t want the function to only work on f of type signature <code>f :: a  -&gt; a</code>"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 144, "user_id": 8299684, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/13e72908732ef4648880cd34f9b0279d?s=128&d=identicon&r=PG", "display_name": "Raskell", "link": "https://stackoverflow.com/users/8299684/raskell"}, "edited": false, "score": 1, "creation_date": 1509029471, "post_id": 46954194, "comment_id": 80862306, "body": "@Raskell Then what type do you want your function to have?"}, {"owner": {"reputation": 144, "user_id": 8299684, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/13e72908732ef4648880cd34f9b0279d?s=128&d=identicon&r=PG", "display_name": "Raskell", "link": "https://stackoverflow.com/users/8299684/raskell"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1509030515, "post_id": 46954194, "comment_id": 80863112, "body": "@Carl           Maybe the type system can&#39;t handle what I want, which, really, is dependently typed."}, {"owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509042388, "post_id": 46954194, "comment_id": 80870062, "body": "@Will Ness What? There clearly is a <code>&#39;</code>. I copy pasted this code from my source file (which compiled) without editing"}, {"owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "edited": false, "score": 0, "creation_date": 1509042692, "post_id": 46954194, "comment_id": 80870247, "body": "The first <code>composeMap</code> on that line is supposed to be without <code>&#39;</code>. It&#39;s a different function than the second <code>composeMap&#39;</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1509042726, "post_id": 46954194, "comment_id": 80870268, "body": "oh yes yes yes. I didn&#39;t read it through properly. sorry... :)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1509043873, "post_id": 46954194, "comment_id": 80870926, "body": "the OP wants <code>composeMap2 _n map</code> to work (with the actual <code>map</code> function)."}], "tags": [], "owner": {"reputation": 1317, "user_id": 2496293, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/00f8e804a4fc2e35e44f88aae73100d9?s=128&d=identicon&r=PG", "display_name": "Sam De Meyer", "link": "https://stackoverflow.com/users/2496293/sam-de-meyer"}, "is_accepted": false, "score": 1, "last_activity_date": 1509023568, "last_edit_date": 1509023568, "creation_date": 1509020458, "answer_id": 46954194, "question_id": 46952793, "link": "https://stackoverflow.com/questions/46952793/composing-arbitrarily-many-maps-in-haskell/46954194#46954194", "title": "Composing arbitrarily many maps in Haskell", "body": "<p>I am afraid I am missing something. Your first implementation compiles and works fine for me (ghc 8.0.2).</p>\n\n<p>Your second implementation failed to compile because you forgot the <code>'</code> in the else clause. Here is my complete source file:</p>\n\n<pre><code>composeMap1 0 f = (\\x -&gt; x)\ncomposeMap1 n f = (.) f (composeMap1 (n-1) f)\n\ncomposeMap2' n k f g =\n  if n == k then g\n            else composeMap2' n (k+1) f (f . g)\n\ncomposeMap2 n f = composeMap2' n 0 f (\\x -&gt; x)\n</code></pre>\n\n<p>And some tests</p>\n\n<pre><code>\u03bb: :l question.hs\n[1 of 1] Compiling Main             ( question.hs, interpreted )\nOk, modules loaded: Main.\n\u03bb: doubleQuote = composeMap1 2 (\\x -&gt; \"'\" ++ x ++ \"'\")\n\u03bb: doubleQuote \"something\"\n\"''something''\"\n\u03bb: doubleQuote = composeMap2 2 (\\x -&gt; \"'\" ++ x ++ \"'\")\n\u03bb: doubleQuote \"something\"\n\"''something''\"\n\u03bb: plusThree = composeMap1 3 (+1)\n\u03bb: plusThree 10\n13\n\u03bb: plusThree = composeMap2 3 (+1)\n\u03bb: plusThree 10\n13\n</code></pre>\n"}], "owner": {"reputation": 144, "user_id": 8299684, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/13e72908732ef4648880cd34f9b0279d?s=128&d=identicon&r=PG", "display_name": "Raskell", "link": "https://stackoverflow.com/users/8299684/raskell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1509440637, "creation_date": 1509016293, "last_edit_date": 1509064779, "question_id": 46952793, "link": "https://stackoverflow.com/questions/46952793/composing-arbitrarily-many-maps-in-haskell", "title": "Composing arbitrarily many maps in Haskell", "body": "<p>How is it possible to compose n maps in Haskell?\nI've tried doing it recursively:</p>\n\n<pre><code>composeMap 0 f = (\\x -&gt; x)\ncomposeMap n f = (.) f (composeMap (n-1) f)\n</code></pre>\n\n<p>And iteratively:</p>\n\n<pre><code>composeMap' n k f g =\n  if n == k then g\n            else composeMap' n (k+1) f (f . g)\n\ncomposeMap n f = composeMap' n 0 f (\\x -&gt; x)\n</code></pre>\n\n<p>But to no avail. Haskell thinks I am constructing an infinite type.\nThis is obviously false as the function defined is finite for any\nn >= 0. </p>\n\n<p>Any suggestions?</p>\n\n<p>Some have posted solutions treating f as having the following type signature:</p>\n\n<pre><code>f :: a -&gt; a\n</code></pre>\n\n<p>However, I want this to work for f s.t. f is polymorphic in the following way:</p>\n\n<pre><code>f :: a -&gt; a'\nf :: a' -&gt; a''\n</code></pre>\n\n<p>In particular, I want a function that works for the function map, with possible type signatures:</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmap (polymorphic) :: ([a] -&gt; [b]) -&gt; [[a]] -&gt; [[b]]\n</code></pre>\n\n<p>The function compiles perfectly fine, but Haskell infers the following type signature, which is not what I want:</p>\n\n<pre><code>composeMap'' :: Int -&gt; (b -&gt; b) -&gt; b -&gt; b\n</code></pre>\n\n<p>I've even tried wrapping map in a monad, but Haskell still thinks I'm constructing an infinite type:</p>\n\n<pre><code>composeMap n f = foldl (&gt;&gt;=) f (replicate n (\\x -&gt; return (map x))) \n</code></pre>\n\n<p>Edit: \nI got what I want with the following template Haskell code. Pretty sweet.</p>\n\n<p>This is for declaring the composed map functions:</p>\n\n<pre><code>composeMap :: Int -&gt; Q Dec\ncomposeMap n\n  | n &gt;= 1    = funD name [cl]\n  | otherwise = fail \"composeMap: argument n may not be &lt;= 0\"\n  where\n    name = mkName $ \"map\" ++ show n\n    composeAll = foldl1 (\\fs f -&gt; [| $fs . $f |])\n    funcs = replicate n [| map |]\n    composedF = composeAll funcs\n    cl = clause [] (normalB composedF) []\n</code></pre>\n\n<p>This is for inlining the composed map. It is more flexible:</p>\n\n<pre><code>composeMap :: Int -&gt; Q Exp\ncomposeMap n = do\n  f &lt;- newName \"f\"\n  maps &lt;- composedF\n  return $ LamE [(VarP f)] (AppE maps (VarE f))\n  where\n    composeAll = foldl1 (\\fs f -&gt; [| $fs . $f |])\n    funcs = replicate n [| map |]\n    composedF = composeAll funcs\n</code></pre>\n\n<p>Also, the guys who put the question on hold didn't even understand the question in the first place... </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1509020167, "post_id": 46944347, "comment_id": 80855110, "body": "<a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">Hoogle</a> is really convenient to discover functions you don&#39;t know the name of by searching for the type you want."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1509066744, "post_id": 46944347, "comment_id": 80879658, "body": "Make sure to pick up a haskell book so you get a good grounding in the basics. In haskell the fundamental way you inspect values to &quot;get stuff out&quot; is through &quot;pattern matching&quot;, either in <code>case</code> or the left-hand side of a function definition or a <code>let</code> binding, etc. If you see a type you don&#39;t understand use <code>:info</code> to print the definition. You should also make a habit to click through to the source code of the libs you&#39;re using and learn by example (click &quot;Source&quot; anywhere on this page for instance: <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Either.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.10.0.0/docs/Data-Either.h&zwnj;&#8203;tml</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 685, "user_id": 3222117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uEbIs.jpg?s=128&g=1", "display_name": "Alexandre Lucchesi", "link": "https://stackoverflow.com/users/3222117/alexandre-lucchesi"}, "is_accepted": false, "score": 8, "last_activity_date": 1508980879, "creation_date": 1508980879, "answer_id": 46944385, "question_id": 46944347, "link": "https://stackoverflow.com/questions/46944347/how-to-get-value-from-either/46944385#46944385", "title": "How to get value from Either?", "body": "<p>You can use the <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Either.html#v:either\" rel=\"noreferrer\"><code>either</code></a> function from <code>Data.Either</code>.</p>\n\n<p>Its signature is:</p>\n\n<pre><code>either :: (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c\n</code></pre>\n\n<p>It means it takes two functions as inputs: the first one to be applied in case it's a <code>Left</code>, and the second one to be applied if it's a <code>Right</code>. The third parameter is your <code>Either</code> data type. Notice that the type of the return value of both functions must be the same.</p>\n"}, {"comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 3, "creation_date": 1508981166, "post_id": 46944389, "comment_id": 80836229, "body": "Note that this is a very recent addition to base. I believe you need ghc 8.2 for it."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1508981307, "post_id": 46944389, "comment_id": 80836261, "body": "@Carl I actually just noticed that when I went to test it and my ghc was too old!"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1508981440, "post_id": 46944389, "comment_id": 80836293, "body": "@Carl and you&#39;re right, per <a href=\"https://downloads.haskell.org/~ghc/8.2.1/docs/html/users_guide/8.2.1-notes.html#base\" rel=\"nofollow noreferrer\">the release notes</a> &quot;Data.Either now provides fromLeft and fromRight&quot;"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 4, "last_activity_date": 1508980903, "creation_date": 1508980903, "answer_id": 46944389, "question_id": 46944347, "link": "https://stackoverflow.com/questions/46944347/how-to-get-value-from-either/46944389#46944389", "title": "How to get value from Either?", "body": "<p>You're looking for <code>Data.Either</code>'s <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Either.html#v:fromRight\" rel=\"nofollow noreferrer\"><code>fromRight</code></a> which has a type signature</p>\n\n<pre><code>fromRight :: b -&gt; Either a b -&gt; b\n</code></pre>\n\n<p>the first value is a default value (what you'll get back if you have a <code>Left</code> instead of a <code>Right</code>.</p>\n\n<pre><code>fromRight 'a' (Left \"b\")\n-- gives 'a'\n\nfromRight 'a' (Right 'c')\n-- gives 'c'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 685, "user_id": 3222117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uEbIs.jpg?s=128&g=1", "display_name": "Alexandre Lucchesi", "link": "https://stackoverflow.com/users/3222117/alexandre-lucchesi"}, "edited": false, "score": 0, "creation_date": 1508981607, "post_id": 46944433, "comment_id": 80836332, "body": "I agree that <code>fromJust</code> should be avoided, but since <code>fromRight</code> takes a default value to be used in the <code>Left</code> case, I don&#39;t think &quot;throwing unrecoverable errors&quot; is an issue. :)"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 685, "user_id": 3222117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uEbIs.jpg?s=128&g=1", "display_name": "Alexandre Lucchesi", "link": "https://stackoverflow.com/users/3222117/alexandre-lucchesi"}, "edited": false, "score": 0, "creation_date": 1508981704, "post_id": 46944433, "comment_id": 80836357, "body": "Oh I just assumed I knew what <code>fromRight</code> was.  Thanks."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 10, "last_activity_date": 1508981702, "last_edit_date": 1508981702, "creation_date": 1508981223, "answer_id": 46944433, "question_id": 46944347, "link": "https://stackoverflow.com/questions/46944347/how-to-get-value-from-either/46944433#46944433", "title": "How to get value from Either?", "body": "<p>Use <code>case</code>:</p>\n\n<pre><code>case decode a of\n  Left err -&gt; {- what to do if decode gave an error -}\n  Right msg -&gt; {- what to do if decode succeeded -}\n</code></pre>\n\n<p>The <code>either</code> function that Alexandre suggests is essentially the same as this, the two branches are just taken as functions instead; i.e. it's equivalent to write:</p>\n\n<pre><code>either \n  (\\err -&gt; {- what to do if decode gave an error -}) \n  (\\msg -&gt; {- what to do if decode succeeded -}) \n  (decode a)\n</code></pre>\n"}], "owner": {"reputation": 1277, "user_id": 7254635, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/280e5fa5140a804fcd8fd9dfe3198542?s=128&d=identicon&r=PG&f=1", "display_name": "wang kai", "link": "https://stackoverflow.com/users/7254635/wang-kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5243, "favorite_count": 0, "accepted_answer_id": 46944433, "answer_count": 3, "score": 6, "last_activity_date": 1508981702, "creation_date": 1508980543, "question_id": 46944347, "link": "https://stackoverflow.com/questions/46944347/how-to-get-value-from-either", "title": "How to get value from Either?", "body": "<p>I have this code in ghci,try to decode base64 code:</p>\n\n<pre><code>let a=pack \"MTExMTEx\"\nlet b=decode a\n:t b\nb :: Either String ByteString\n</code></pre>\n\n<p>so how to get the decode bytestring from either?is there some func like Maybe's fromJust?I can't find it,thanks.</p>\n"}]