[{"tags": ["c", "haskell", "ffi", "c2hs"], "comments": [{"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1428561377, "post_id": 29526738, "comment_id": 47216201, "body": "Does it work when just built with GHC (i.e. not loaded with GHCi, but turned into a proper executable)?"}, {"owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "reply_to_user": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1428564526, "post_id": 29526738, "comment_id": 47217890, "body": "<code>ghc --make Structs.hs</code> gives what I believe is the same error, I&#39;ve edited the question"}], "answers": [{"tags": [], "owner": {"reputation": 965, "user_id": 229255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588fe10267b620e1c0d0d188a8db2621?s=128&d=identicon&r=PG", "display_name": "Ian Ross", "link": "https://stackoverflow.com/users/229255/ian-ross"}, "is_accepted": true, "score": 5, "last_activity_date": 1428565807, "creation_date": 1428565807, "answer_id": 29532796, "question_id": 29526738, "link": "https://stackoverflow.com/questions/29526738/linker-error-in-c2hs-generated-c-binding/29532796#29532796", "title": "linker error in C2HS generated C binding", "body": "<p>The <code>get_foo</code> C function is defined in <code>Structs.c</code>, so you need to make that available to GHC.  This ought to work:</p>\n\n<pre><code>gcc -o Structs_c.o -c Structs.c\nghc --make Structs.hs Structs_c.o\n</code></pre>\n\n<p>For GHCi, I think you can then just say <code>ghci Structs.hs Structs_c.o</code>.  But you definitely need the C object file!</p>\n"}], "owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 1, "accepted_answer_id": 29532796, "answer_count": 1, "score": 3, "last_activity_date": 1428571697, "creation_date": 1428533718, "last_edit_date": 1428571697, "question_id": 29526738, "link": "https://stackoverflow.com/questions/29526738/linker-error-in-c2hs-generated-c-binding", "title": "linker error in C2HS generated C binding", "body": "<p>I build and run the following minimal example (no external dependencies) with \n<code>C-&gt;Haskell Compiler, version 0.25.2 Snowboundest, 31 Oct 2014\n  build platform is \"x86_64-darwin\" &lt;1, True, True, 1&gt;</code> ; build command: </p>\n\n<pre><code>c2hs Structs.chs\nghci Structs.hs\n</code></pre>\n\n<p>but the linker complains with a </p>\n\n<pre><code>During interactive linking, GHCi couldn't find the following symbol: get_foo\n</code></pre>\n\n<p>Q : Why is this and how can I fix it? Thx in advance</p>\n\n<p>A : tl;dr : I wasn't compiling the .c into .o object code, DUH!</p>\n\n<p>Code follows:</p>\n\n<p><em>Structs.chs</em></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>module Main where\n\nimport Foreign\nimport Foreign.C\n\n#include \"Structs.h\"\n\n{#pointer *foo as Foo#}\n\n{#fun get_foo {`Int'} -&gt; `Foo' return* #}\n\nmain :: IO ()\nmain = do\n  foo &lt;- get_foo 3\n  a1 &lt;- {#get struct foo-&gt;a#} foo\n  print a1\n</code></pre>\n\n<p><em>Structs.h</em></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>struct foo {\n  int a;\n};\n\nstruct foo *get_foo(int n);\n</code></pre>\n\n<p><em>Structs.c</em></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include \"Structs.h\"\n\nstruct foo f;\n\nstruct foo *get_foo(int n)\n{\n  f.a = n;\n  return &amp;f;\n}\n</code></pre>\n\n<p><em>Structs.hs</em></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- -- C2HS generated Hs file, edited for clarity\nmodule Main where\n\nimport Foreign\nimport Foreign.C\n\ntype Foo = Ptr ()\n\nget_foo :: Int -&gt; IO Foo\nget_foo p =\n  get_foo'_ (fromIntegral p)\n\nmain :: IO ()\nmain = do\n  foo &lt;- get_foo 3\n  a1 &lt;- (\\ptr -&gt; peekByteOff ptr 0 :: IO CInt) foo\n  print a1\n\nforeign import ccall safe \"Structs.chs.h get_foo\"\n  get_foo'_ :: CInt -&gt; IO Foo\n</code></pre>\n\n<p>EDIT : <code>ghc --make Structs.hs</code> gives the same linker error:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ ghc --make Structs.hs\nLinking Structs1a ...\nUndefined symbols for architecture x86_64:\n\"_get_foo\", referenced from:\n    _c2MX_info in Structs.o\n    _c2Or_info in Structs.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n"}, {"tags": ["list", "haskell", "return"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428522790, "post_id": 29523882, "comment_id": 47202620, "body": "Make a helper function in a <code>where</code> clause."}, {"owner": {"reputation": 6236, "user_id": 217931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbd77f5bffc9cbbb85c2f9fbbc3fe37?s=128&d=identicon&r=PG", "display_name": "Marcus Borkenhagen", "link": "https://stackoverflow.com/users/217931/marcus-borkenhagen"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428523039, "post_id": 29523882, "comment_id": 47202787, "body": "That would be <code>where</code> @AJFarmar"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 6236, "user_id": 217931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbd77f5bffc9cbbb85c2f9fbbc3fe37?s=128&d=identicon&r=PG", "display_name": "Marcus Borkenhagen", "link": "https://stackoverflow.com/users/217931/marcus-borkenhagen"}, "edited": false, "score": 0, "creation_date": 1428523076, "post_id": 29523882, "comment_id": 47202815, "body": "@MarcusFritzsch Oops, that&#39;s embarrassing!"}, {"owner": {"reputation": 6236, "user_id": 217931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbd77f5bffc9cbbb85c2f9fbbc3fe37?s=128&d=identicon&r=PG", "display_name": "Marcus Borkenhagen", "link": "https://stackoverflow.com/users/217931/marcus-borkenhagen"}, "edited": false, "score": 0, "creation_date": 1428523120, "post_id": 29523882, "comment_id": 47202847, "body": "Nah, happens to the best! :)"}, {"owner": {"reputation": 85, "user_id": 1792030, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0c860cf66befc8f0d5c745ec55be4047?s=128&d=identicon&r=PG", "display_name": "Kolling Master", "link": "https://stackoverflow.com/users/1792030/kolling-master"}, "edited": false, "score": 0, "creation_date": 1428523142, "post_id": 29523882, "comment_id": 47202858, "body": "Could you explain what would the helper function exactly do? Sorry I&#39;m still a newbie to Haskell"}], "answers": [{"tags": [], "owner": {"reputation": 777, "user_id": 3900056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45ff0756018a3a41955b5d29e3ab63fb?s=128&d=identicon&r=PG&f=1", "display_name": "zcleghern", "link": "https://stackoverflow.com/users/3900056/zcleghern"}, "is_accepted": false, "score": 1, "last_activity_date": 1428523391, "creation_date": 1428523391, "answer_id": 29524304, "question_id": 29523882, "link": "https://stackoverflow.com/questions/29523882/get-back-original-xxs/29524304#29524304", "title": "Get back original x:xs", "body": "<p>Firstly, you can use pattern matching to avoid checking the length of the list (x:xs).  It will be much easier to understand what is going on in your functions.</p>\n\n<p>To answer your question, it looks like you are recursively calling encode in the second line and returning its value.  This will only end up returning the last result.  Prepend the intermediate encoded values with the <code>:</code> operator to get the full encoded string.</p>\n"}, {"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 4, "last_activity_date": 1428524030, "creation_date": 1428524030, "answer_id": 29524469, "question_id": 29523882, "link": "https://stackoverflow.com/questions/29523882/get-back-original-xxs/29524469#29524469", "title": "Get back original x:xs", "body": "<p>I think your problem here really stems from trying to do too much at once.  Instead of working with the whole string you want to encode, work with just a single character at a time.  If you can correctly encode one character, then you can encode them all:</p>\n\n<pre><code>encodeChar :: [(Char, Char)] -&gt; Char -&gt; Char\nencodeChar table charToEncode = ???\n</code></pre>\n\n<p>To encode a single character we want to find the <code>pair</code> in <code>table</code> where <code>fst pair == c</code>.  This can be performed using basic recursion and pattern matching:</p>\n\n<pre><code>encodeChar [] _ = error \"Empty table!\"\nencodeChar ((fromChar, toChar):restOfTable) charToEncode\n    = if fromChar == charToEncode\n        then toChar\n        else encodeChar restOfTable charToEncode\n</code></pre>\n\n<p>However, it's bad practice to use <code>error</code>.  For most cases it'd be better to return a <code>Maybe</code> instead.  Luckily for us Haskell comes with a handy function called <code>lookup</code> that can do this entire operation for us, but first I'll show what it looks like to return <code>Maybe Char</code> manually:</p>\n\n<pre><code>encodeCharMaybe [] _ = Nothing\nencodeCharMaybe ((fromChar, toChar):restOfTable) charToEncode\n    = if fromChar == charToEncode\n        then Just toChar\n        else encodeCharMaybe restOfTable charToEncode\n</code></pre>\n\n<p>And with <code>lookup</code>:</p>\n\n<pre><code>encodeCharMaybe table charToEncode = lookup charToEncode table\n</code></pre>\n\n<p>Now we can implement <code>encode</code> more simply:</p>\n\n<pre><code>encode1 :: [(Char, Char)] -&gt; String -&gt; String\nencode1 table msg = map (encodeChar table) msg\n</code></pre>\n\n<p>Here the same <code>table</code> is used for each <code>encodeChar</code> call, which was causing you problems with your current implementation.  If you wanted to use proper error handling with <code>Maybe</code> you could implement it as</p>\n\n<pre><code>encode2 :: [(Char, Char)] -&gt; String -&gt; Maybe String\nencode2 table [] = Just []\nencode2 table (c:msg) = do\n    encodedC &lt;- encodeCharMaybe table c\n    encodedMsg &lt;- encode2 table msg\n    Just (encodedC : encodedMsg)\n</code></pre>\n\n<p>Or using <code>mapM</code>, which basically is just a generalization of this pattern</p>\n\n<pre><code>encode2 table msg = mapM (encodeCharMaybe table) msg\n</code></pre>\n\n<p>As mentioned in the comments above you could use a helper function in a <code>where</code> clause, and that would look something like</p>\n\n<pre><code>encode2 table msg = mapM (encodeCharMaybe table) msg\n    where\n        encodeCharMaybe table charToEncode = lookup charToEncode table\n</code></pre>\n\n<p>Although you could just write all of this in one function:</p>\n\n<pre><code>encode2 table msg = mapM (\\charToEncode -&gt; lookup charToEncode table) msg\n</code></pre>\n\n<p>And if you want to be confusing you can write this in <a href=\"https://wiki.haskell.org/Pointfree\" rel=\"nofollow\">pointfree</a> style:</p>\n\n<pre><code>encode2 = mapM . flip lookup\n</code></pre>\n\n<p>But this is completely optional and certainly isn't the most intuitive explanation.  I only include it here to show off how awesome Haskell can be; your entire problem can be reduced to just a few built-in functions and a composition.</p>\n"}, {"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 5, "last_activity_date": 1428530651, "creation_date": 1428530651, "answer_id": 29526196, "question_id": 29523882, "link": "https://stackoverflow.com/questions/29523882/get-back-original-xxs/29526196#29526196", "title": "Get back original x:xs", "body": "<p>The problem with your function is when you search through the list of associations, you throw away the values at the beginning. You just need to retain a reference to that list. You can perform a transformation like </p>\n\n<pre><code>encode l n0 = encode' l n0 where \n  encode' (x:xs) (n:ns) \n    | ... = snd x : encode (x:xs) ns0\n</code></pre>\n\n<p>But you can recognize an even higher level of abstraction will make this a much simpler problem. </p>\n\n<p>Assume you have an abstract type <code>Table</code> which can encode one <code>Char</code>. Encoding might fail (a character might not have an association) so it returns a <code>Maybe Char</code>:</p>\n\n<pre><code>type Table = ...\nencode1 :: Table -&gt; Char -&gt; Maybe Char\n</code></pre>\n\n<p>Then to encode a whole string, just encode each character with the same table - if any returns <code>Nothing</code>, then return <code>Nothing</code>. A string is a list, and you need to apply a function with effects to each element of that list - this is precisely what <code>mapM</code> does:</p>\n\n<pre><code>encode :: Table -&gt; [Char] -&gt; Maybe Char\nencode t = mapM (encode1 t)\n</code></pre>\n\n<p>Now the question of how to define <code>Table</code>. Since it represents an associative map, why not use an associative map datatype - <code>Data.Map</code>.</p>\n\n<pre><code>import qualified Data.Map as M\n\ntype Table = M.Map Char Char \n\nencode1 :: Table -&gt; Char -&gt; Maybe Char \nencode1 = flip M.lookup \n\ntable :: Int -&gt; [Char] -&gt; [(Char, Char)]\ntable _ [] = []\ntable n l   = zip l (drop n (cycle l))\n\ntable' :: Int -&gt; [Char] -&gt; Table\ntable' n l = M.fromList (table n l) \n</code></pre>\n\n<p>And now:</p>\n\n<pre><code>&gt; encode (table 2 (['a'..'z'] ++ ['A'..'Z'] ++ ['.', '!', '?', ' '])) \"SOS\"\nJust \"UQU\"\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 1792030, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0c860cf66befc8f0d5c745ec55be4047?s=128&d=identicon&r=PG", "display_name": "Kolling Master", "link": "https://stackoverflow.com/users/1792030/kolling-master"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 29526196, "answer_count": 3, "score": 1, "last_activity_date": 1428530651, "creation_date": 1428521947, "last_edit_date": 1428523652, "question_id": 29523882, "link": "https://stackoverflow.com/questions/29523882/get-back-original-xxs", "title": "Get back original x:xs", "body": "<p>I want to create a function in Haskell which is like this:</p>\n\n<p>encode :: [(Char, Char)] -> String -> String</p>\n\n<p>I have a \"dictionary\" function called \"table\" which creates a list of pairs:</p>\n\n<pre><code>table :: Int -&gt; [Char] -&gt; [(Char, Char)]\ntable __ [] = []\ntable n l   = zip l (drop n (cycle l))\n</code></pre>\n\n<p>The encode function encodes a string by characters. So far it looks like this:</p>\n\n<pre><code>encode (x:xs) (n:ns)\n| length(n:ns) &gt; 1 &amp;&amp; (fst x) == n  = [snd x] ++ (encode (x:xs) ns)\n| length(xs) &gt; 1 &amp;&amp; (fst x) /= n    = encode xs (n:ns)\n| length(ns) &gt; 0 &amp;&amp; length(xs) == 0 = encode (x:xs) ns\n</code></pre>\n\n<p>For the test <code>encode table2 \"SOS\"</code> it gives me only \"U\" but it needs to be \"UQU\".\nthe table2 is a constant: <code>table2 = table 2 (['a'..'z'] ++ ['A'..'Z'] ++ ['.', '!', '?', ' '])</code></p>\n\n<p>My question is: How can I get back the original list of (x:xs)? I think I get only a \"U\" because I return with xs always and it cuts the first pair, but I need the whole original (x:xs) for every character.</p>\n\n<p>the constant functions return: <a href=\"http://prntscr.com/6rat13\" rel=\"nofollow\">picture</a></p>\n"}, {"tags": ["haskell", "ghc", "type-families"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428520233, "post_id": 29522821, "comment_id": 47201111, "body": "What&#39;s wrong with GHC&#39;s generalised type? If it works on GHC, then it should compile just fine."}], "answers": [{"comments": [{"owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "edited": false, "score": 3, "creation_date": 1428520848, "post_id": 29523240, "comment_id": 47201473, "body": "<code>NoMonoLocalBinds</code> indeed makes it build. I didn&#39;t know that one. Right now I don&#39;t understand the difference between that and <code>NoMonomorphismRestriction</code> though, they appear to be almost about the same thing.. Anyway I know where to search now thank you!"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "edited": false, "score": 0, "creation_date": 1428522021, "post_id": 29523240, "comment_id": 47202157, "body": "I totally forgot that there is a <code>NoMonoLocalBinds</code> flag too."}, {"owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "edited": false, "score": 1, "creation_date": 1428522123, "post_id": 29523240, "comment_id": 47202217, "body": "Yes but <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/other-type-extensions.html#mono-local-binds\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/latest/docs/html/users_guide/&hellip;</a> says &quot; You can switch it off again with <code>-XNoMonoLocalBinds</code> but type inference becomes less predicatable if you do so. (Read the papers!)&quot; -- therefore I&#39;ll rather annotate the local variables as you suggested."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "edited": false, "score": 1, "creation_date": 1428532404, "post_id": 29523240, "comment_id": 47207421, "body": "@EmmanuelTouzery, you can enable <code>NoMonoLocalBinds</code> and also turn on <code>-fwarn-missing-local-sigs</code>. This will spit out type signatures for all local polymorphic bindings without signatures. You can copy and paste, then remove <code>NoMonoLocalBinds</code>. It is very often necessary in these cases to add <code>ScopedTypeVariables</code> so your local signatures can refer to type variables around them."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "edited": false, "score": 0, "creation_date": 1428536719, "post_id": 29523240, "comment_id": 47208756, "body": "@EmmanuelTouzery <code>MonoLocalBinds</code> and <code>MonomorphismRestriction</code> both make some bindings more monomorphic, but with very different rules and reasons for when they trigger (I know what MR is about but not so much MLB). Although when both are enabled, the rules for MLB depend some on whether MR has triggered."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 9, "last_activity_date": 1428519984, "creation_date": 1428519984, "answer_id": 29523240, "question_id": 29522821, "link": "https://stackoverflow.com/questions/29522821/enabling-typefamilies-makes-the-code-not-build-anymore/29523240#29523240", "title": "enabling TypeFamilies makes the code not build anymore", "body": "<p>The type equality constraint <code>~</code> can only be written out if you have either <code>TypeFamilies</code> or <code>GADTs</code> enabled. </p>\n\n<p>However, enabling <code>TypeFamilies</code> or <code>GADTs</code> also enables <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/other-type-extensions.html#mono-local-binds\" rel=\"noreferrer\"><code>MonoLocalBinds</code>.</a> As the name says, it disables generalization of locally defined variables. </p>\n\n<p>If <code>MonoLocalBinds</code> prevents code from compiling, you should either write out the generalized type signatures or factor out such locals into top-level definitions. Sometimes writing out the generalized types is a bit difficult; in such cases you can try querying GHCi, or you can enable <code>NoMonomorphismRestriction</code>, write unannotated top-level definitions and then look at the inferred types.</p>\n"}], "owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 29523240, "answer_count": 1, "score": 6, "last_activity_date": 1428522904, "creation_date": 1428518479, "last_edit_date": 1428522904, "question_id": 29522821, "link": "https://stackoverflow.com/questions/29522821/enabling-typefamilies-makes-the-code-not-build-anymore", "title": "enabling TypeFamilies makes the code not build anymore", "body": "<p>I have a module coded and working, however I can't manage to enter two function signatures for it, because to enter them I must enable the <code>TypeFamilies</code> extension for the module, and when I do that, it no longer builds.</p>\n\n<p>For one of them I need <code>TypeFamilies</code> because it's using <a href=\"https://github.com/emmanueltouzery/projectpad/blob/master/src/Search.hs#L118\" rel=\"nofollow\">persisent/esqueleto functions</a>.</p>\n\n<p>The proper type would be, I believe:</p>\n\n<pre><code>getByIds :: (PersistEntityBackend a ~ SqlBackend) =&gt;\n   EntityField a (Key a) -&gt; [Key a] -&gt; SqlPersistM [Entity a]\n</code></pre>\n\n<p>(ghc suggests a more generic signature)</p>\n\n<p>The other one uses <a href=\"https://github.com/emmanueltouzery/projectpad/blob/master/src/Search.hs#L44\" rel=\"nofollow\">hsqml</a>.</p>\n\n<p>ghc suggests this signature but I guess it could be simplified:</p>\n\n<pre><code>  prop :: forall tr b.\n          (Marshal tr, Typeable b, MarshalMode tr ICanReturnTo () ~ Yes) =&gt;\n          String -&gt; (b -&gt; tr) -&gt; Member (GetObjType (ObjRef b))\n</code></pre>\n\n<p>The bottom line is, that without <code>TypeFamilies</code> I cannot write those signatures. The moment I enable <code>TypeFamilies</code>, however, the code won't build, and I don't understand why. The error looks like some polymorphic functions suddenly became monomorphic.</p>\n\n<p>The error output is relatively long, you can find it <a href=\"https://dl.dropboxusercontent.com/u/22600720/typefamilies_error.txt\" rel=\"nofollow\">here</a>.</p>\n\n<p>I have <code>TypeFamilies</code> enabled in several other modules of the application without problems, and that enables me to write signatures using both the <code>SqlBackend</code> &amp; <code>ICanReturnTo</code> constraints without problems.</p>\n\n<p>Is there something wrong with that module that prevents it from building with <code>TypeFamilies</code>? Or should I enable yet another extension to fix it? I didn't expect just enabling that extension to break the compilation.</p>\n"}, {"tags": ["scala", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4568055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ece116ef5b2ed4c92acc04aff7964dd?s=128&d=identicon&r=PG&f=1", "display_name": "rribeiro", "link": "https://stackoverflow.com/users/4568055/rribeiro"}, "edited": false, "score": 0, "creation_date": 1428513478, "post_id": 29521039, "comment_id": 47197111, "body": "Let&#39;s say I want to execute the code with <code>trifecta ( (+1), (+3), (+4), 8)</code>. Why do I get errors? I want the function to take three functions and a variable."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "reply_to_user": {"reputation": 63, "user_id": 4568055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ece116ef5b2ed4c92acc04aff7964dd?s=128&d=identicon&r=PG&f=1", "display_name": "rribeiro", "link": "https://stackoverflow.com/users/4568055/rribeiro"}, "edited": false, "score": 2, "creation_date": 1428514548, "post_id": 29521039, "comment_id": 47197724, "body": "@rribeiro - Scala doesn&#39;t support sections like <code>+1</code> in Haskell. You can supply functions but the type checker can&#39;t infer the argument types without any surrounding context. You can do <code>trifecta((i: Int) =&gt; i+1, (i: Int) =&gt; i+3, (i: Int) =&gt; i+4, 8)</code>"}, {"owner": {"reputation": 63, "user_id": 4568055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ece116ef5b2ed4c92acc04aff7964dd?s=128&d=identicon&r=PG&f=1", "display_name": "rribeiro", "link": "https://stackoverflow.com/users/4568055/rribeiro"}, "edited": false, "score": 0, "creation_date": 1428515538, "post_id": 29521039, "comment_id": 47198298, "body": "Thank you, for the help!"}, {"owner": {"reputation": 6961, "user_id": 3087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d0939f834c7658366376f94fbc6a4e6?s=128&d=identicon&r=PG", "display_name": "Cem Catikkas", "link": "https://stackoverflow.com/users/3087/cem-catikkas"}, "edited": false, "score": 2, "creation_date": 1428516858, "post_id": 29521039, "comment_id": 47199113, "body": "<code>trifecta[Int, Int, Int, Int](_ + 1, _ + 3, _ + 4, 8)</code> would also do. Just have to hint the compiler what the types will be"}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 6, "last_activity_date": 1428513285, "last_edit_date": 1428513285, "creation_date": 1428512887, "answer_id": 29521039, "question_id": 29520957, "link": "https://stackoverflow.com/questions/29520957/haskell-function-type-signature-in-scala/29521039#29521039", "title": "Haskell Function Type Signature in Scala", "body": "<p>Your types are fine but your implementation won't terminate. You probably meant:</p>\n\n<pre><code>def trifecta[A,B,C,D](a: A=&gt;B, b: B=&gt;C, c: C=&gt;D, d: A): D = c(b(a(d)))\n</code></pre>\n\n<p>if you want it to be curried like the Haskell version you need separate argument lists:</p>\n\n<pre><code>def trifecta[A,B,C,D](a: A=&gt;B)(b: B=&gt;C)(c: C=&gt;D)(d: A): D = c(b(a(d)))\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 4568055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ece116ef5b2ed4c92acc04aff7964dd?s=128&d=identicon&r=PG&f=1", "display_name": "rribeiro", "link": "https://stackoverflow.com/users/4568055/rribeiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 29521039, "answer_count": 1, "score": 3, "last_activity_date": 1428548504, "creation_date": 1428512644, "last_edit_date": 1428548504, "question_id": 29520957, "link": "https://stackoverflow.com/questions/29520957/haskell-function-type-signature-in-scala", "title": "Haskell Function Type Signature in Scala", "body": "<p>I have this Haskell function i'm trying to convert into Scala.</p>\n\n<p>In Haskell you have a function like:</p>\n\n<pre><code>trifecta :: (a-&gt;b) -&gt; (b-&gt;c) -&gt; (c-&gt;d) -&gt; a -&gt; d\n</code></pre>\n\n<p>I haven't found anything online about converting these kinds of type signature in Scala.</p>\n\n<p>This is what I have done so far, but I'm not quite sure this is correct.</p>\n\n<p>Scala Code:</p>\n\n<pre><code>def trifecta[A,B,C,D](a: (A=&gt;B), b: (B=&gt;C), c: (C=&gt;D), d: A): D = { \n\n    trifecta(a, b, c, d)\n}\n</code></pre>\n\n<p>I'd really appreciate if you guys could help me clarify this. Thank You!</p>\n"}, {"tags": ["haskell", "parse-error"], "comments": [{"owner": {"reputation": 777, "user_id": 3900056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45ff0756018a3a41955b5d29e3ab63fb?s=128&d=identicon&r=PG&f=1", "display_name": "zcleghern", "link": "https://stackoverflow.com/users/3900056/zcleghern"}, "edited": false, "score": 0, "creation_date": 1428511904, "post_id": 29520631, "comment_id": 47196172, "body": "Could you tell us what the error you are seeing is?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1428512225, "post_id": 29520631, "comment_id": 47196400, "body": "I might as well tell you that this isn&#39;t going to work. Haskell has no <code>randInt</code> function that works in the way you expect. Do some research on Haskell random-number generation, or consider using a different language for this task."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1428513059, "post_id": 29520631, "comment_id": 47196872, "body": "@AJFarmar no big deal as he is already in <code>IO</code> - just use <a href=\"https://hackage.haskell.org/package/random-1.1/docs/System-Random.html#v:randomIO\" rel=\"nofollow noreferrer\"><code>randomIO</code></a> - to the op: you should use this with something like <code>fmap (`mod` 10) randomIO</code> to get it into range ;)"}, {"owner": {"reputation": 69, "user_id": 4394101, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6542fcf97a0ec1a98baf00fb17958818?s=128&d=identicon&r=PG&f=1", "display_name": "scholar guy", "link": "https://stackoverflow.com/users/4394101/scholar-guy"}, "edited": false, "score": 0, "creation_date": 1468760019, "post_id": 29520631, "comment_id": 64249266, "body": "randInt is a function that depends on the Time."}, {"owner": {"reputation": 69, "user_id": 4394101, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6542fcf97a0ec1a98baf00fb17958818?s=128&d=identicon&r=PG&f=1", "display_name": "scholar guy", "link": "https://stackoverflow.com/users/4394101/scholar-guy"}, "edited": false, "score": 0, "creation_date": 1468760039, "post_id": 29520631, "comment_id": 64249273, "body": "<code>randomInt :: Integer -&gt; IO Integer  randomInt n =      do       time &lt;- getCurrentTime       return ( (</code>rem` n) $ read $ take 6 $ formatTime defaultTimeLocale &quot;%q&quot; time)  -- Extract the random number from the IO monad, unsafely!  randInt :: Integer -&gt; Integer  randInt = unsafePerformIO . randomInt`"}, {"owner": {"reputation": 69, "user_id": 4394101, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6542fcf97a0ec1a98baf00fb17958818?s=128&d=identicon&r=PG&f=1", "display_name": "scholar guy", "link": "https://stackoverflow.com/users/4394101/scholar-guy"}, "edited": false, "score": 0, "creation_date": 1468760394, "post_id": 29520631, "comment_id": 64249388, "body": "The code is really sexy!"}], "answers": [{"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428512416, "post_id": 29520825, "comment_id": 47196497, "body": "This is valid. Now, go ahead and try to make a pure <code>randInt</code> function! :P"}, {"owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428512630, "post_id": 29520825, "comment_id": 47196639, "body": "sorry,  I wasn&#39;t sure what randInt was suppose to do"}, {"owner": {"reputation": 69, "user_id": 4394101, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6542fcf97a0ec1a98baf00fb17958818?s=128&d=identicon&r=PG&f=1", "display_name": "scholar guy", "link": "https://stackoverflow.com/users/4394101/scholar-guy"}, "edited": false, "score": 0, "creation_date": 1468760119, "post_id": 29520825, "comment_id": 64249298, "body": "randomInt n =      do       time &lt;- getCurrentTime       return ( (<code>rem</code> n) $ read $ take 6 $ formatTime defaultTimeLocale &quot;%q&quot; time)  -- Extract the random number from the IO monad, unsafely!  randInt :: Integer -&gt; Integer  randInt = unsafePerformIO . randomInt"}], "tags": [], "owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "is_accepted": false, "score": 1, "last_activity_date": 1428512470, "last_edit_date": 1428512470, "creation_date": 1428512213, "answer_id": 29520825, "question_id": 29520631, "link": "https://stackoverflow.com/questions/29520631/haskell-parse-error-in-an-io-program/29520825#29520825", "title": "Haskell: Parse error in an IO program", "body": "<p>The problem is the indentation of the if statement and that randInt is an IO operation:</p>\n\n<pre><code>mathExercise times (a,b) = \n    if times&lt;=0\n    then return ()\n    else do x &lt;- randInt a\n            y &lt;- randInt b \n            putStr (show x ++ \" + \"++ show y++ \" = \")\n            ans &lt;- getInt\n            if (ans==x+y)\n               then do print True\n                       mathExercise (times-1) (a,b)\n               else do print False\n            -- ^ Indented here\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1428513402, "post_id": 29521120, "comment_id": 47197066, "body": "I added one possible implementation using <code>randomIO</code> I hope you don&#39;t mind - feel free to delete it again if so"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1428514026, "post_id": 29521120, "comment_id": 47197405, "body": "@CarstenK&#246;nig Thanks. I was going to add the other one <code>randInt a = randomRIO (1,a)</code> but I tripped over the dreaded monomorphism restriction when I defined <code>getInt = readLn</code>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1428514440, "post_id": 29521120, "comment_id": 47197659, "body": "maybe randomRIO is even nicer (probably easier to understand and your bounds are shifted by 1 which might be desired) - to be honest I did not remember although I must have skimmed it on the docs  - so thanks for the reminder ;)"}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 8, "last_activity_date": 1428514109, "last_edit_date": 1428514109, "creation_date": 1428513126, "answer_id": 29521120, "question_id": 29520631, "link": "https://stackoverflow.com/questions/29520631/haskell-parse-error-in-an-io-program/29521120#29521120", "title": "Haskell: Parse error in an IO program", "body": "<p>You have mixed tabs and spaces. The code you posted has tabs in the following places (marked with <code>---&gt;</code>)</p>\n\n<pre><code>mathExercise times (a,b) = \n    if times&lt;=0\n---&gt;then return ()\n---&gt;else do let x = randInt a\n---&gt;        let y = randInt b \n---&gt;        putStr (show x ++ \" + \"++ show y++ \" = \")\n---&gt;---&gt;---&gt;ans &lt;- getInt\n---&gt;---&gt;---&gt;if (ans==x+y)\n---&gt;---&gt;---&gt;then do print True\n---&gt;---&gt;---&gt;---&gt;---&gt;mathExercise (times-1) (a,b)\n---&gt;---&gt;---&gt;else do print False\n</code></pre>\n\n<p>Assuming there exist correct <code>getInt</code> and <code>randInt</code> declarations, the code will compile with the same layout if all of the tabs are replaced with spaces.</p>\n\n<pre><code>mathExercise times (a,b) = \n    if times&lt;=0\n    then return ()\n    else do let x = randInt a\n            let y = randInt b \n            putStr (show x ++ \" + \"++ show y++ \" = \")\n            ans &lt;- getInt\n            if (ans==x+y)\n            then do print True\n                    mathExercise (times-1) (a,b)\n            else do print False\n</code></pre>\n\n<p>If  <code>randInt</code> is actually a random integer in <code>IO</code>, you will instead need to write</p>\n\n<pre><code>mathExercise times (a,b) = \n    if times&lt;=0\n    then return ()\n    else do x &lt;- randInt a\n            y &lt;- randInt b\n            ...\n</code></pre>\n\n<p>using <code>System.Random</code>:</p>\n\n<pre><code>import System.Random (randomIO)\n\nrandInt a = fmap (`mod` a) randomIO\n\nmathExercise times (a,b) = \n    if times&lt;=0\n    then return ()\n    else do x &lt;- randInt a\n            y &lt;- randInt b\n            ...\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 4394101, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6542fcf97a0ec1a98baf00fb17958818?s=128&d=identicon&r=PG&f=1", "display_name": "scholar guy", "link": "https://stackoverflow.com/users/4394101/scholar-guy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1784, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1504684993, "creation_date": 1428511572, "last_edit_date": 1504684993, "question_id": 29520631, "link": "https://stackoverflow.com/questions/29520631/haskell-parse-error-in-an-io-program", "title": "Haskell: Parse error in an IO program", "body": "<p>I am writing a program to help my younger brother learn addition. I am not experienced in writing IO programs, And I am stuck with this parse error:</p>\n\n<pre><code>MyCode.hs:6:25:\n    Parse error in pattern: show\n    Possibly caused by a missing 'do'?\n</code></pre>\n\n<p>The code:</p>\n\n<pre><code>mathExercise times (a,b) = \n    if times&lt;=0\n    then return ()\n    else do let x = randInt a\n            let y = randInt b \n            putStr (show x ++ \" + \"++ show y++ \" = \")\n            ans &lt;- getInt\n            if (ans==x+y)\n            then do print True\n                    mathExercise (times-1) (a,b)\n            else do print False\n</code></pre>\n"}, {"tags": ["haskell", "concurrency", "channels"], "comments": [{"owner": {"reputation": 897, "user_id": 1755520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mqzKa.jpg?s=128&g=1", "display_name": "bartavelle", "link": "https://stackoverflow.com/users/1755520/bartavelle"}, "edited": false, "score": 3, "creation_date": 1428512548, "post_id": 29519671, "comment_id": 47196585, "body": "When you get <code>Exception &lt;&lt;loop&gt;&gt;</code>, it usually means you have written a recursive term in a <code>let</code> clause, such as <code>let results = takeWhile isJust results :: [Maybe Link]</code>."}, {"owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "reply_to_user": {"reputation": 897, "user_id": 1755520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mqzKa.jpg?s=128&g=1", "display_name": "bartavelle", "link": "https://stackoverflow.com/users/1755520/bartavelle"}, "edited": false, "score": 0, "creation_date": 1428512783, "post_id": 29519671, "comment_id": 47196723, "body": "Well... that explains why it wasn&#39;t working I guess :)  Seems like that should have been a compile-time error. One more lesson learned!"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1428516619, "post_id": 29519671, "comment_id": 47198948, "body": "<code>getChanContents</code> may still be broken on GHC 7.10 as well, per this <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9965\" rel=\"nofollow noreferrer\">bug</a>"}, {"owner": {"reputation": 897, "user_id": 1755520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mqzKa.jpg?s=128&g=1", "display_name": "bartavelle", "link": "https://stackoverflow.com/users/1755520/bartavelle"}, "edited": false, "score": 1, "creation_date": 1428556277, "post_id": 29519671, "comment_id": 47214062, "body": "It actually can&#39;t be a compile time error, as expressions such as this are perfectly valid : <code>let a = 1 : a</code>. But you should have had a compilation warning if compiled with <code>-Wall</code>."}], "answers": [{"tags": [], "owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "is_accepted": true, "score": 2, "last_activity_date": 1428512873, "creation_date": 1428512873, "answer_id": 29521034, "question_id": 29519671, "link": "https://stackoverflow.com/questions/29519671/collect-all-results-from-a-chan-with-getchancontents/29521034#29521034", "title": "Collect all results from a Chan with getChanContents", "body": "<p>Thanks to @bartavelle. I had an error unrelated to the channel code. Here's the relevant fix: </p>\n\n<pre><code>-- collect the results\nresults &lt;- getChanContents cdone\nlet links = catMaybes $ takeWhile isJust results\n\nreturn links\n</code></pre>\n"}], "owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 29521034, "answer_count": 1, "score": 1, "last_activity_date": 1428512873, "creation_date": 1428508911, "last_edit_date": 1428509337, "question_id": 29519671, "link": "https://stackoverflow.com/questions/29519671/collect-all-results-from-a-chan-with-getchancontents", "title": "Collect all results from a Chan with getChanContents", "body": "<p>I'm playing with <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Concurrent-Chan.html\" rel=\"nofollow\">Channels</a> in Haskell. I want to do some <code>IO</code> actions in parallel until one of them fails, then collect all the results into a list. </p>\n\n<p>This code errors with <code>Exception &lt;&lt;loop&gt;&gt;</code>. How can I get it to work with <code>getChanContents</code>? All of the examples I've seen assume they know how many messages are on the channel. </p>\n\n<p>Is there a cleaner way to collect a bunch of results from workers?</p>\n\n<pre><code>module UrlPatterns where\n\nimport Control.Concurrent\nimport Types\nimport Text.HTML.Scalpel\nimport Data.Monoid ((&lt;&gt;))\nimport Control.Concurrent.Chan\nimport Control.Applicative\nimport Data.Maybe (isJust, catMaybes)\nimport Data.List (takeWhile)\n\n\n-- find all valid links under a domain that follow the pattern:\n-- http://example.com/pages/(1..N)\n-- as soon as one is missing, return a list of all the ones you found\nfindIncrementing :: URL -&gt; IO [Link]\nfindIncrementing base = do\n\n    let num = 1\n\n    -- find channel\n    cfind &lt;- newChan\n    writeChan cfind (base, num)\n\n    -- results channel\n    cdone &lt;- newChan\n\n    forkIO $ worker cfind cdone\n\n    -- collect the results\n    results &lt;- getChanContents cdone\n    let results = takeWhile isJust results :: [Maybe Link]\n    print results\n\n    return []\n\n\nworker :: Chan (URL, Int) -&gt; Chan (Maybe Link) -&gt; IO ()\nworker next done = loop\n  where \n    loop = do\n      (base, num) &lt;- readChan next\n      let url = pageUrl base num\n      putStrLn $ \"FETCHING: \" &lt;&gt; url\n\n      mt &lt;- findPageTitle url\n\n      case mt of\n        Nothing -&gt; do\n          writeChan done Nothing\n          putStrLn (\"Missed \" &lt;&gt; show num)\n        Just t  -&gt; do\n          writeChan done $ Just $ Link url t\n          writeChan next (base, num+1)\n\n      loop\n\nscrapeTitle :: Scraper String String\nscrapeTitle = text \"title\"\n\nfindPageTitle :: URL -&gt; IO (Maybe String)\nfindPageTitle url = scrapeURL url scrapeTitle\n\npageUrl :: URL -&gt; Int -&gt; URL\npageUrl base num = base &lt;&gt; show num\n</code></pre>\n"}, {"tags": ["haskell", "digestive-functors"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1428511575, "post_id": 29519507, "comment_id": 47195978, "body": "tbh: I don&#39;t know exactly how a Sql-Key looks like (it will be an instance of <code>Show</code> and <code>Read</code>) but based on what you see here it is not just an integer - easiest solution I can think of is that you just use <code>show</code> to print you one such key and have a look at it - it will most likely be some kind of GUID(?)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1428511674, "post_id": 29519507, "comment_id": 47196039, "body": "or you use <a href=\"https://hackage.haskell.org/package/persistent-2.1.2/docs/Database-Persist-Sql.html#v:fromSqlKey\" rel=\"nofollow noreferrer\"><code>fmap fromSqlKey</code></a> with what you have"}, {"owner": {"reputation": 579, "user_id": 547797, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bf85d3849e3559c9a06befc9318b4fd9?s=128&d=identicon&r=PG", "display_name": "will", "link": "https://stackoverflow.com/users/547797/will"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1428548843, "post_id": 29519507, "comment_id": 47212034, "body": "@CarstenK&#246;nig after some digging, you are right, it&#39;s not directly an integer. CountryKey {unCountryKey = SqlBackendKey {unSqlBackendKey = 3}}. Do you know of any way to parse an Integer (presumably in the form it&#39;s given as a String) to CountryKey type?"}], "answers": [{"tags": [], "owner": {"reputation": 579, "user_id": 547797, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bf85d3849e3559c9a06befc9318b4fd9?s=128&d=identicon&r=PG", "display_name": "will", "link": "https://stackoverflow.com/users/547797/will"}, "is_accepted": false, "score": 1, "last_activity_date": 1428551105, "creation_date": 1428551105, "answer_id": 29529365, "question_id": 29519507, "link": "https://stackoverflow.com/questions/29519507/how-can-i-parse-custom-type-in-a-digestive-functors-form/29529365#29529365", "title": "How can I parse custom type in a digestive-functors form?", "body": "<p>After some help from dmwit Freenode #haskell, the following will solve the problem:</p>\n\n<pre><code>clientForm :: Monad m =&gt; Form String m Client                                                                           \nclientForm = Client &lt;$&gt; \"firstName\" .: string Nothing                                                                   \n                &lt;*&gt; \"lastName\"  .: string Nothing                                                              \n                &lt;*&gt; \"address\"   .: string Nothing                                                              \n                &lt;*&gt; (toSqlKey &lt;$&gt; \"country\" .: stringRead \"Cannot parse country id.\" Nothing)                                   \n                &lt;*&gt; \"age\"       .: optionalStringRead \"Cannot parse age\" Nothing\n</code></pre>\n\n<p>I think the confusion came from the fact that \"Key Country\" type (a newtype) cannot be \"read\" directly from an integer...</p>\n"}], "owner": {"reputation": 579, "user_id": 547797, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bf85d3849e3559c9a06befc9318b4fd9?s=128&d=identicon&r=PG", "display_name": "will", "link": "https://stackoverflow.com/users/547797/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428551105, "creation_date": 1428508470, "question_id": 29519507, "link": "https://stackoverflow.com/questions/29519507/how-can-i-parse-custom-type-in-a-digestive-functors-form", "title": "How can I parse custom type in a digestive-functors form?", "body": "<p>I have no problems trying to parse built-in types in a digestive-functors form, e.g I have a Client type (generated by the persistent library) that references a Country ID (of Key Country type):</p>\n\n<pre><code>Client\n  :: String\n     -&gt; String\n     -&gt; String\n     -&gt; Database.Persist.Class.Key Country\n     -&gt; Maybe Int\n     -&gt; Client\n</code></pre>\n\n<p>Then I define a clientForm value:</p>\n\n<pre><code>clientForm :: Monad m =&gt; Form String m Client                                                                           \nclientForm = Client &lt;$&gt; \"firstName\" .: string Nothing                                                                   \n                    &lt;*&gt; \"lastName\"  .: string Nothing                                                              \n                    &lt;*&gt; \"address\"   .: string Nothing                                                              \n                    &lt;*&gt; \"country\"   .: stringRead \"Cannot parse country\" Nothing                                   \n                    &lt;*&gt; \"age\"       .: optionalStringRead \"Cannot parse age\" Nothing        \n</code></pre>\n\n<p>Strangely, the clientForm when submitted (POST), cannot parse the country id field.\n<img src=\"https://i.stack.imgur.com/em3iD.png\" alt=\"enter image description here\"></p>\n\n<p>Is it wrong to use \"stringRead\" to parse \"Key Country\" type (which can be obtained from \"toSqlKey int64\")?</p>\n"}, {"tags": ["haskell", "ghc", "travis-ci"], "comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447956588, "post_id": 29516932, "comment_id": 55387957, "body": "Did you every get this working? Does Travis support 7.10 at all? When I try (using quotes) <a href=\"https://travis-ci.org/orome/crypto-enigma-hs/builds/92100003\" rel=\"nofollow noreferrer\">I get</a> a &quot;no such version&quot; error."}, {"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447969695, "post_id": 29516932, "comment_id": 55395588, "body": "Hmm ... yep ... there is a travis configuration file for multiple ghc versions here: <a href=\"https://github.com/hvr/multi-ghc-travis\" rel=\"nofollow noreferrer\">github.com/hvr/multi-ghc-travis</a> ... but if I remember correct I lost some travis features along the way."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447970802, "post_id": 29516932, "comment_id": 55396130, "body": "So the above does not work, correct? You have to go down to C and build the whole Haskell stack from scratch. Right?"}, {"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447971245, "post_id": 29516932, "comment_id": 55396352, "body": "The multi-ghc thing worked. I can\u2019t really remember why I don&#39;t use it anymore."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447971571, "post_id": 29516932, "comment_id": 55396519, "body": "The link, yes, but not the example in the question, right? <code>language: haskell</code> doesn&#39;t work (for 7.10) does it?"}, {"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447973109, "post_id": 29516932, "comment_id": 55397273, "body": "If they have not updated travis then no, it does not work."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447973220, "post_id": 29516932, "comment_id": 55397320, "body": "So just to be clear &quot;It works if I put marks around the version number&quot; is not correct. right?"}, {"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1448004915, "post_id": 29516932, "comment_id": 55408009, "body": "Yes. I was hoping that this would change given some time."}], "answers": [{"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447956566, "post_id": 29517437, "comment_id": 55387942, "body": "<i>Does</i> Travis support 7.10 at all? When I try (using quotes) <a href=\"https://travis-ci.org/orome/crypto-enigma-hs/builds/92100003\" rel=\"nofollow noreferrer\">I get</a> a &quot;no such version&quot; error."}], "tags": [], "owner": {"reputation": 187800, "user_id": 320615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65c80e12b6a33913538653f6d4ef1277?s=128&d=identicon&r=PG", "display_name": "Dogbert", "link": "https://stackoverflow.com/users/320615/dogbert"}, "is_accepted": true, "score": 6, "last_activity_date": 1428503021, "creation_date": 1428503021, "answer_id": 29517437, "question_id": 29516932, "link": "https://stackoverflow.com/questions/29516932/does-travis-ci-allow-ghc-versions-larger-than-7-8/29517437#29517437", "title": "Does Travis ci allow ghc versions larger than 7.8?", "body": "<p>It's not a bug, it's a consequence of using YAML files for config: YAML parses <code>7.10</code> as the number <code>7.1</code>.</p>\n\n<p>The <a href=\"http://docs.travis-ci.com/user/languages/javascript-with-nodejs/\">node.js docs</a> on Travis <em>do</em> have all the version numbers in quotes:</p>\n\n<pre><code>language: node_js\nnode_js:\n  - \"0.12\"\n  - \"0.11\"\n  - \"0.10\"\n  - \"0.8\"\n  - \"0.6\"\n  - \"iojs\"\n  - \"iojs-v1.0.4\" \n</code></pre>\n"}], "owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 2, "accepted_answer_id": 29517437, "answer_count": 1, "score": 11, "last_activity_date": 1448189716, "creation_date": 1428501837, "last_edit_date": 1448189716, "question_id": 29516932, "link": "https://stackoverflow.com/questions/29516932/does-travis-ci-allow-ghc-versions-larger-than-7-8", "title": "Does Travis ci allow ghc versions larger than 7.8?", "body": "<p>I just created a Haskell Travis CI project with this <code>.travis.yml</code>:</p>\n\n<pre><code>language: haskell\nghc:\n  - 7.8\n  - 7.10\n</code></pre>\n\n<p>But Travis interprets the second version as <code>7.1</code>: <a href=\"https://travis-ci.org/fhaust/dtw/jobs/57648139\" rel=\"nofollow\">https://travis-ci.org/fhaust/dtw/jobs/57648139</a></p>\n\n<p>The version is only recognized if I enclose it in quotes (though this results in other errors, since 7.10 is not a version available on Travis CI):</p>\n\n<pre><code>language: haskell\nghc:\n  - 7.8\n  - \"7.10\"\n</code></pre>\n\n<p>Is this a bug?</p>\n\n<h3>Edit 2015-11-22</h3>\n\n<p>There is an open issue for GHC 7.10 on travis-ci: <a href=\"https://github.com/travis-ci/travis-ci/issues/3785\" rel=\"nofollow\">https://github.com/travis-ci/travis-ci/issues/3785</a></p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428503865, "post_id": 29516861, "comment_id": 47190630, "body": "There&#39;s a nice function: <code>maybe :: b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b</code>"}], "answers": [{"comments": [{"owner": {"reputation": 6364, "user_id": 288913, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/902e8cc4ad1dab7e25d3a2dc1eac732f?s=128&d=identicon&r=PG", "display_name": "Sarah", "link": "https://stackoverflow.com/users/288913/sarah"}, "reply_to_user": {"reputation": 2916, "user_id": 3646096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KUofm.jpg?s=128&g=1", "display_name": "M&#225;rio Feroldi", "link": "https://stackoverflow.com/users/3646096/m%c3%a1rio-feroldi"}, "edited": false, "score": 0, "creation_date": 1428502243, "post_id": 29516969, "comment_id": 47189370, "body": "Sorry, I didn&#39;t understand that."}], "tags": [], "owner": {"reputation": 6364, "user_id": 288913, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/902e8cc4ad1dab7e25d3a2dc1eac732f?s=128&d=identicon&r=PG", "display_name": "Sarah", "link": "https://stackoverflow.com/users/288913/sarah"}, "is_accepted": false, "score": 3, "last_activity_date": 1428501931, "creation_date": 1428501931, "answer_id": 29516969, "question_id": 29516861, "link": "https://stackoverflow.com/questions/29516861/how-can-i-extract-an-io-from-maybe-and-execute-this/29516969#29516969", "title": "How can I extract an IO () from Maybe and execute this?", "body": "<p>The easiest solution to start out with is probably to realize that you can decide what to do based on the value of the <code>Maybe (IO ())</code> via pattern matching.</p>\n\n<pre><code>maybeDoIO :: Maybe (IO ()) -&gt; IO ()\nmaybeDoIO (Just io) = io\nmaybeDoIO Nothing   = return ()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 2916, "user_id": 3646096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KUofm.jpg?s=128&g=1", "display_name": "M&#225;rio Feroldi", "link": "https://stackoverflow.com/users/3646096/m%c3%a1rio-feroldi"}, "edited": false, "score": 0, "creation_date": 1428502767, "post_id": 29516992, "comment_id": 47189807, "body": "@Thelost <code>maybe</code> requires a default value to provide in case the extraction of <code>Maybe</code> fails."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 2916, "user_id": 3646096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KUofm.jpg?s=128&g=1", "display_name": "M&#225;rio Feroldi", "link": "https://stackoverflow.com/users/3646096/m%c3%a1rio-feroldi"}, "edited": false, "score": 0, "creation_date": 1428503253, "post_id": 29516992, "comment_id": 47190200, "body": "@Thelost ah you&#39;re right I got the argument order wrong. Fixed."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1428913623, "post_id": 29516992, "comment_id": 47347874, "body": "If the op really wants the program to do nothing if the value is Nothing, then <code>putStrLn &quot;Nothing&quot;</code> can just be changed to <code>return ()</code>"}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 1, "last_activity_date": 1428503238, "last_edit_date": 1428503238, "creation_date": 1428501987, "answer_id": 29516992, "question_id": 29516861, "link": "https://stackoverflow.com/questions/29516861/how-can-i-extract-an-io-from-maybe-and-execute-this/29516992#29516992", "title": "How can I extract an IO () from Maybe and execute this?", "body": "<p>You have to take the <code>Nothing</code> into account, basically:</p>\n\n<pre><code>main = maybe (putStrLn \"Nothing\") id foo\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 2916, "user_id": 3646096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KUofm.jpg?s=128&g=1", "display_name": "M&#225;rio Feroldi", "link": "https://stackoverflow.com/users/3646096/m%c3%a1rio-feroldi"}, "edited": false, "score": 0, "creation_date": 1428503124, "post_id": 29516995, "comment_id": 47190102, "body": "@Thelost Where is Gabriel using <code>case</code> ?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 2916, "user_id": 3646096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KUofm.jpg?s=128&g=1", "display_name": "M&#225;rio Feroldi", "link": "https://stackoverflow.com/users/3646096/m%c3%a1rio-feroldi"}, "edited": false, "score": 1, "creation_date": 1428511609, "post_id": 29516995, "comment_id": 47195999, "body": "@Thelost Sure, see <a href=\"http://stackoverflow.com/questions/3375483/operating-on-a-return-from-a-maybe-that-contains-just/3375712#3375712\" title=\"operating on a return from a maybe that contains just\">stackoverflow.com/questions/3375483/&hellip;</a>   In brief: <code>maybe (return ()) id trick</code>"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1428512359, "post_id": 29516995, "comment_id": 47196461, "body": "or <code>fromMaybe (return ()) trick</code>, which is also equivalent to <code>sequence_ trick</code>."}, {"owner": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "reply_to_user": {"reputation": 2916, "user_id": 3646096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KUofm.jpg?s=128&g=1", "display_name": "M&#225;rio Feroldi", "link": "https://stackoverflow.com/users/3646096/m%c3%a1rio-feroldi"}, "edited": false, "score": 0, "creation_date": 1428597163, "post_id": 29516995, "comment_id": 47239774, "body": "@Thelost You would use a function like <code>maybe</code> or <code>fromMaybe</code>, like the others suggested.  Those function are themselves implemented in terms of pattern matching (equivalent to <code>case</code>)"}], "tags": [], "owner": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "is_accepted": true, "score": 6, "last_activity_date": 1428502304, "last_edit_date": 1428502304, "creation_date": 1428501991, "answer_id": 29516995, "question_id": 29516861, "link": "https://stackoverflow.com/questions/29516861/how-can-i-extract-an-io-from-maybe-and-execute-this/29516995#29516995", "title": "How can I extract an IO () from Maybe and execute this?", "body": "<p>The function you are looking for is <code>Data.Foldable.sequence_</code>:</p>\n\n<pre><code>&gt;&gt;&gt; Data.Foldable.sequence_ (Just (putStrLn \"Hello?\"))\nHello?\n&gt;&gt;&gt;\n</code></pre>\n\n<p>If your <code>Maybe</code> is <code>Nothing</code>, it will not do anything:</p>\n\n<pre><code>&gt;&gt;&gt; Data.Foldable.sequence_ Nothing\n&gt;&gt;&gt;\n</code></pre>\n\n<p>This works because the type of <code>Data.Foldable.sequence_</code> is:</p>\n\n<pre><code>Data.Foldable.sequence_\n    :: (Foldable t, Monad m) =&gt; t (m a) -&gt; m ()\n</code></pre>\n\n<p>... and if you specialize <code>t</code> to <code>Maybe</code> and <code>m</code> to <code>IO</code>, you get:</p>\n\n<pre><code>Data.Foldable.sequence_ :: Maybe (IO a) -&gt; IO ()\n</code></pre>\n\n<p>In the specific context of <code>Maybe</code>, it's equivalent to:</p>\n\n<pre><code>sequence_ (Just io) = do\n    _ &lt;- io\n    return ()\nsequence   Nothing  = return ()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2916, "user_id": 3646096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KUofm.jpg?s=128&g=1", "display_name": "M&#225;rio Feroldi", "link": "https://stackoverflow.com/users/3646096/m%c3%a1rio-feroldi"}, "edited": false, "score": 0, "creation_date": 1428504472, "post_id": 29517763, "comment_id": 47191097, "body": "Is there some kind of <code>m1 a -&gt; (a -&gt; m2 b) -&gt; m2 b</code> in the standard?"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 2916, "user_id": 3646096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KUofm.jpg?s=128&g=1", "display_name": "M&#225;rio Feroldi", "link": "https://stackoverflow.com/users/3646096/m%c3%a1rio-feroldi"}, "edited": false, "score": 0, "creation_date": 1428504791, "post_id": 29517763, "comment_id": 47191338, "body": "@Thelost <code>m2</code> would need to be able to run <code>m1</code>. Try <code>m1 ~ IO</code> and <code>m2 ~ Id</code>"}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": false, "score": 1, "last_activity_date": 1428503860, "creation_date": 1428503860, "answer_id": 29517763, "question_id": 29516861, "link": "https://stackoverflow.com/questions/29516861/how-can-i-extract-an-io-from-maybe-and-execute-this/29517763#29517763", "title": "How can I extract an IO () from Maybe and execute this?", "body": "<p>The problem with your <code>main</code> function is that you are mixing two different monads in the same <code>do</code> block.</p>\n\n<p>The <code>foo &lt;- trick</code> action is \"relative\" to the <code>Maybe</code> monad but the <code>foo</code> action afterwards is an <code>IO</code> action. The type for <code>&gt;&gt;=</code> is:</p>\n\n<pre><code>Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>But in your case you'd need something with type:</p>\n\n<pre><code>Maybe a -&gt; (a -&gt; IO b) -&gt; IO b\n</code></pre>\n\n<p>with two different monads.</p>\n\n<p>If you want to execute the <code>IO</code> action then the type of <code>main</code> <strong>must</strong> be of the kind <code>IO a</code> so the <code>do</code> notation must refer to <code>IO</code> and not <code>Maybe</code>. Which means that you <em>cannot</em> use <code>&lt;-</code> to extract the action but you have to use something else. For example <code>Data.Maybe.fromMaybe</code>:</p>\n\n<pre><code>import Data.Maybe\n\nmain = do fromMaybe (return ()) trick\n</code></pre>\n"}], "owner": {"reputation": 2916, "user_id": 3646096, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KUofm.jpg?s=128&g=1", "display_name": "M&#225;rio Feroldi", "link": "https://stackoverflow.com/users/3646096/m%c3%a1rio-feroldi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 589, "favorite_count": 1, "accepted_answer_id": 29516995, "answer_count": 4, "score": 0, "last_activity_date": 1428503860, "creation_date": 1428501644, "question_id": 29516861, "link": "https://stackoverflow.com/questions/29516861/how-can-i-extract-an-io-from-maybe-and-execute-this", "title": "How can I extract an IO () from Maybe and execute this?", "body": "<p>I have this code:</p>\n\n<pre><code>trick = Just (putStrLn \"Hello?\")\n</code></pre>\n\n<p>And I want to unwrap this <code>IO ()</code> out the Maybe context and call it.</p>\n\n<pre><code>main = do foo &lt;- trick\n          foo\n</code></pre>\n\n<p>However, this throws an error:</p>\n\n<pre><code>Couldn't match type \u2018IO\u2019 with \u2018Maybe\u2019\nExpected type: Maybe ()\n  Actual type: IO ()\n</code></pre>\n\n<p>How could I resolve this?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1428501902, "post_id": 29516548, "comment_id": 47189088, "body": "This looks like a bug. Is there any reason to have <code>OverloadedLists</code> enabled in this module?"}, {"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1428502227, "post_id": 29516548, "comment_id": 47189350, "body": "No not really. Guess I needed it at some point. But removing it fixes the problem."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 3, "creation_date": 1428506795, "post_id": 29516548, "comment_id": 47192862, "body": "<code>OverloadedLists</code> is pretty much unusable with the Foldable changes in 7.10, though hardly anyone was using it anyways (5 modules in all of Hackage according to this recent survey: <a href=\"http://www.reddit.com/r/haskell/comments/31t2y9/distribution_of_ghc_extensions_on_hackage/\" rel=\"nofollow noreferrer\">reddit.com/r/haskell/comments/31t2y9/&hellip;</a>)"}, {"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1428569554, "post_id": 29516548, "comment_id": 47220806, "body": "@ReidBarton that&#39;s sad. I actually use it quite a lot to define static vectors."}], "answers": [{"comments": [{"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "edited": false, "score": 0, "creation_date": 1428503013, "post_id": 29517154, "comment_id": 47190002, "body": "This doesn&#39;t fix the problem.  <code>Expected type: Int -&gt; [c] -&gt; [c1] Actual type: Int -&gt; [GHC.Exts.Item [c1]] -&gt; [c1]</code>. It seems that ghc now knows that this is a list, but not the relation between the list item (<code>c1</code>) and the actual type (<code>c</code>)."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "edited": false, "score": 0, "creation_date": 1428503803, "post_id": 29517154, "comment_id": 47190587, "body": "Could you provide a  type-checkable example? I filled in some guesswork code for <code>DataSet</code> and <a href=\"http://lpaste.net/130347\" rel=\"nofollow noreferrer\">it worked for me</a>, but that&#39;s apparently not enough."}, {"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "edited": false, "score": 0, "creation_date": 1428505996, "post_id": 29517154, "comment_id": 47192250, "body": "It&#39;s right there: <a href=\"https://github.com/fhaust/dtw/tree/ghc-7.10\" rel=\"nofollow noreferrer\">github.com/fhaust/dtw/tree/ghc-7.10</a> (it&#39;s the fixed version as proposed by @Cirdec above)."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "edited": false, "score": 0, "creation_date": 1428506698, "post_id": 29517154, "comment_id": 47192795, "body": "Here&#39;s <a href=\"http://lpaste.net/130349\" rel=\"nofollow noreferrer\">DTW.hs</a> with my proposed fix. It works on GHC 7.10.1."}, {"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "edited": false, "score": 0, "creation_date": 1428569818, "post_id": 29517154, "comment_id": 47220956, "body": "I think what I was missing was the existential quantification over <code>dtwNaive</code>.  I&#39;ll mark this as solved, but have used the easier way to just remove the <code>OverloadedLists</code> pragma."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 3, "last_activity_date": 1428502322, "creation_date": 1428502322, "answer_id": 29517154, "question_id": 29516548, "link": "https://stackoverflow.com/questions/29516548/how-to-unify-c-and-ghc-exts-item-t-c/29517154#29517154", "title": "How to unify c and GHC.Exts.Item t c?", "body": "<p>The type of <code>minimum</code> is not the same as before. The old type was <code>Ord a =&gt; [a] -&gt; a</code>. The new type is <code>(Ord a, Foldable t) =&gt; t a -&gt; a</code>. </p>\n\n<p>It's not obvious anymore that there is an <code>IsList</code> instance for the list literal that is the argument to <code>minimum</code>. You can fix the problem here by adding a local annotation:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\ndtwNaive :: \n            forall a b c.\n            (Ord c, Fractional c, DataSet a, DataSet b)\n         =&gt; (Item a -&gt; Item b -&gt; c) -&gt; a -&gt; b -&gt; c\ndtwNaive = ...\n    minimum ([go (x-1) y, go x (y-1), go (x-1) (y-1)] :: [c])\n</code></pre>\n"}], "owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 29517154, "answer_count": 1, "score": 3, "last_activity_date": 1428502322, "creation_date": 1428500888, "question_id": 29516548, "link": "https://stackoverflow.com/questions/29516548/how-to-unify-c-and-ghc-exts-item-t-c", "title": "How to unify c and GHC.Exts.Item t c?", "body": "<p>I just updated my <a href=\"https://github.com/fhaust/dtw/tree/ghc-7.10\" rel=\"nofollow\">dynamic time warping library</a> to compile with <code>ghc-7.10</code> and stumbled into a strange problem:</p>\n\n<p>The code that compiled fine in <code>ghc-7.8</code>:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>{-# LANGUAGE OverloadedLists #-}\n{-# LANGUAGE TypeFamilies #-}\ndtwNaive :: (Ord c, Fractional c, DataSet a, DataSet b)\n         =&gt; (Item a -&gt; Item b -&gt; c) -&gt; a -&gt; b -&gt; c\ndtwNaive \u03b4 as bs = go (len as - 1) (len bs - 1)\n    where go 0 0 = 0\n          go _ 0 = 1/0\n          go 0 _ = 1/0\n          go x y = \u03b4 (ix as x) (ix bs y) + minimum [ go (x-1)  y\n                                                   , go  x    (y-1)\n                                                   , go (x-1) (y-1)\n                                                   ]\n</code></pre>\n\n<p>Now produces the following error:</p>\n\n<pre><code>src/Data/DTW.hs:112:52:\n    Couldn't match type \u2018c\u2019 with \u2018GHC.Exts.Item (t1 c)\u2019\n      \u2018c\u2019 is a rigid type variable bound by\n          the type signature for\n            dtwNaive :: (Ord c, Fractional c, DataSet a, DataSet b) =&gt;\n                        (Item a -&gt; Item b -&gt; c) -&gt; a -&gt; b -&gt; c\n          at src/Data/DTW.hs:106:13\n    Expected type: Int -&gt; [c] -&gt; t1 c\n      Actual type: Int -&gt; [GHC.Exts.Item (t1 c)] -&gt; t1 c\n    Relevant bindings include\n      go :: Int -&gt; Int -&gt; c (bound at src/Data/DTW.hs:109:11)\n      \u03b4 :: Item a -&gt; Item b -&gt; c (bound at src/Data/DTW.hs:108:10)\n      dtwNaive :: (Item a -&gt; Item b -&gt; c) -&gt; a -&gt; b -&gt; c\n        (bound at src/Data/DTW.hs:108:1)\n    In the first argument of \u2018minimum\u2019, namely\n      \u2018[go (x - 1) y, go x (y - 1), go (x - 1) (y - 1)]\u2019\n    In the second argument of \u2018(+)\u2019, namely\n      \u2018minimum [go (x - 1) y, go x (y - 1), go (x - 1) (y - 1)]\u2019\n    In the expression:\n      \u03b4 (ix as x) (ix bs y)\n      + minimum [go (x - 1) y, go x (y - 1), go (x - 1) (y - 1)]\n</code></pre>\n\n<p>I am honestly confused as I believe <code>[c]</code> to be the same thing as <code>[GHC.Exts.Item (t c)]</code> when <code>t ~ []</code>. What am I missing?</p>\n"}, {"tags": ["list", "haskell", "recursion", "sublist"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1428537715, "post_id": 29516517, "comment_id": 47209057, "body": "I get errors, but none of them say &quot;error on input&quot;. Are you sure you pasted exactly the code you have? Have you tried making a file with <i>just</i> this code, to make sure the error is in this part?"}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1428501682, "post_id": 29516781, "comment_id": 47188870, "body": "after one week <code>all</code>, <code>uncurry</code> and <code>zip</code> might not be that obvious as well (maybe you should use <code>zipWith</code> and a lambda instead?) - but nice answer!"}, {"owner": {"reputation": 7189, "user_id": 2898458, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/bc37a9f235a6fa726c8047459ecf0a3f?s=128&d=identicon&r=PG", "display_name": "randomusername", "link": "https://stackoverflow.com/users/2898458/randomusername"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1428501715, "post_id": 29516781, "comment_id": 47188905, "body": "@CarstenK&#246;nig Good point, I&#39;ll edit it to explain that better then"}, {"owner": {"reputation": 37, "user_id": 4110727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2313b8902d1ead80465b10ea49e1fbce?s=128&d=identicon&r=PG&f=1", "display_name": "ExecutionStyle21", "link": "https://stackoverflow.com/users/4110727/executionstyle21"}, "edited": false, "score": 0, "creation_date": 1428502595, "post_id": 29516781, "comment_id": 47189674, "body": "@randomusername thanks for the explanation, I&#39;m familiar with <code>zip</code> a little as I&#39;ve been reading the &quot;To Learn You A Haskell&quot; book. However thanks for explaining the others to me."}, {"owner": {"reputation": 37, "user_id": 4110727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2313b8902d1ead80465b10ea49e1fbce?s=128&d=identicon&r=PG&f=1", "display_name": "ExecutionStyle21", "link": "https://stackoverflow.com/users/4110727/executionstyle21"}, "edited": false, "score": 0, "creation_date": 1428502765, "post_id": 29516781, "comment_id": 47189806, "body": "@randomusername I am still a little confused on one thing, when using the &#39;@&#39; syntax I receive a parsing error for that symbol. Why is that?"}, {"owner": {"reputation": 7189, "user_id": 2898458, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/bc37a9f235a6fa726c8047459ecf0a3f?s=128&d=identicon&r=PG", "display_name": "randomusername", "link": "https://stackoverflow.com/users/2898458/randomusername"}, "reply_to_user": {"reputation": 37, "user_id": 4110727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2313b8902d1ead80465b10ea49e1fbce?s=128&d=identicon&r=PG&f=1", "display_name": "ExecutionStyle21", "link": "https://stackoverflow.com/users/4110727/executionstyle21"}, "edited": false, "score": 0, "creation_date": 1428502925, "post_id": 29516781, "comment_id": 47189936, "body": "@ExecutionStyle21 It could be that I&#39;ve gotten the order mixed up, I can never remember which one it&#39;s supposed to be.  Try <code>xxs@(x:xs)</code>."}, {"owner": {"reputation": 37, "user_id": 4110727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2313b8902d1ead80465b10ea49e1fbce?s=128&d=identicon&r=PG&f=1", "display_name": "ExecutionStyle21", "link": "https://stackoverflow.com/users/4110727/executionstyle21"}, "edited": false, "score": 0, "creation_date": 1428503172, "post_id": 29516781, "comment_id": 47190143, "body": "@randomusername yeah that is all it was! That is actually going to come in handy thank you so much for the information that clears up so much."}, {"owner": {"reputation": 7189, "user_id": 2898458, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/bc37a9f235a6fa726c8047459ecf0a3f?s=128&d=identicon&r=PG", "display_name": "randomusername", "link": "https://stackoverflow.com/users/2898458/randomusername"}, "reply_to_user": {"reputation": 37, "user_id": 4110727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2313b8902d1ead80465b10ea49e1fbce?s=128&d=identicon&r=PG&f=1", "display_name": "ExecutionStyle21", "link": "https://stackoverflow.com/users/4110727/executionstyle21"}, "edited": false, "score": 0, "creation_date": 1428506147, "post_id": 29516781, "comment_id": 47192372, "body": "@ExecutionStyle21 I have edited it so it is in the correct order now."}, {"owner": {"reputation": 2044, "user_id": 1258491, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/yyvEu.png?s=128&g=1", "display_name": "metaleap", "link": "https://stackoverflow.com/users/1258491/metaleap"}, "edited": false, "score": 0, "creation_date": 1482135134, "post_id": 29516781, "comment_id": 69634871, "body": "Nice function! But only worked for me once I replaced <code>subList _ [] = -1</code> with <code>subList _ [] = minBound::Int</code> --- still hacky as it would fail the (probably impossible, in any event unrealistic) case of strings with length&gt;maxBound::Int"}, {"owner": {"reputation": 2044, "user_id": 1258491, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/yyvEu.png?s=128&g=1", "display_name": "metaleap", "link": "https://stackoverflow.com/users/1258491/metaleap"}, "edited": false, "score": 0, "creation_date": 1482135171, "post_id": 29516781, "comment_id": 69634882, "body": "My adaptation: maybe I messed something up? Pretty much the same though except for minBound (the smallest negative int possible) ---  <code>indexOfSub _ [] = minBound::Int ; indexOfSub sub str@(char:rest) | all (uncurry (==)) (zip sub str) = 0 | otherwise = 1+(indexOfSub sub rest)</code>  --- obviously you&#39;re counting back up from the final -1 all the way the length of the string so if you don&#39;t like minBound need a check on the-result-of-the-recursion in <code>otherwise</code>"}, {"owner": {"reputation": 2044, "user_id": 1258491, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/yyvEu.png?s=128&g=1", "display_name": "metaleap", "link": "https://stackoverflow.com/users/1258491/metaleap"}, "edited": false, "score": 0, "creation_date": 1482137507, "post_id": 29516781, "comment_id": 69636035, "body": "Just for fun, here&#39;s a dirty &quot;last index of sublist&quot; using y/our above:  <code>lastIndexOfSub sub str = if idx&lt;0 then -1 else (length str)-(length sub)-idx where idx = indexOfSub (reverse sub) (reverse str)</code>"}], "tags": [], "owner": {"reputation": 7189, "user_id": 2898458, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/bc37a9f235a6fa726c8047459ecf0a3f?s=128&d=identicon&r=PG", "display_name": "randomusername", "link": "https://stackoverflow.com/users/2898458/randomusername"}, "is_accepted": true, "score": 2, "last_activity_date": 1428506123, "last_edit_date": 1428506123, "creation_date": 1428501429, "answer_id": 29516781, "question_id": 29516517, "link": "https://stackoverflow.com/questions/29516517/how-can-i-find-the-index-where-one-list-appears-as-a-sublist-of-another/29516781#29516781", "title": "How can I find the index where one list appears as a sublist of another?", "body": "<p>Let's first look at the function signature.  You want to take in two lists whose contents can be compared for equality and return an index like so</p>\n\n<pre><code>subList :: Eq a =&gt; [a] -&gt; [a] -&gt; Int\n</code></pre>\n\n<p>So now we go through pattern matching on the arguments.  First off, when the second list is empty then there is nothing we can do, so we'll return -1 as an error condition</p>\n\n<pre><code>subList _ [] = -1\n</code></pre>\n\n<p>Then we look at the recursive step</p>\n\n<pre><code>subList as xxs@(x:xs)\n  | all (uncurry (==)) $ zip as xxs = 0\n  | otherwise                       = 1 + subList as xs\n</code></pre>\n\n<p>You should be familiar with the guard syntax I've used, although you may not be familiar with the <code>@</code> syntax.  Essentially it means that <code>xxs</code> is just a sub-in for if we had used <code>(x:xs)</code>.</p>\n\n<p>You may not be familiar with <code>all</code>, <code>uncurry</code>, and possibly <code>zip</code> so let me elaborate on those more.  <code>zip</code> has the function signature <code>zip :: [a] -&gt; [b] -&gt; [(a,b)]</code>, so it takes two lists and pairs up their elements (and if one list is longer than the other, it just chops off the excess).  <code>uncurry</code> is weird so lets just look at <code>(uncurry (==))</code>, its signature is <code>(uncurry (==)) :: Eq a =&gt; (a, a) -&gt; Bool</code>, it essentially checks if both the first and second element in the pair are equal.  Finally, <code>all</code> will walk over the list and see if the first and second of each pair is equal and return true if that is the case.</p>\n"}], "owner": {"reputation": 37, "user_id": 4110727, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2313b8902d1ead80465b10ea49e1fbce?s=128&d=identicon&r=PG&f=1", "display_name": "ExecutionStyle21", "link": "https://stackoverflow.com/users/4110727/executionstyle21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 784, "favorite_count": 0, "accepted_answer_id": 29516781, "answer_count": 1, "score": 1, "last_activity_date": 1428509864, "creation_date": 1428500818, "last_edit_date": 1428509864, "question_id": 29516517, "link": "https://stackoverflow.com/questions/29516517/how-can-i-find-the-index-where-one-list-appears-as-a-sublist-of-another", "title": "How can I find the index where one list appears as a sublist of another?", "body": "<p>I have been working with Haskell for a little over a week now so I am practicing some functions that might be useful for something. I want to compare two lists recursively. When the first list appears in the second list, I simply want to return the index at where the list starts to match. The index would begin at 0. Here is an example of what I want to execute for clarification:</p>\n\n<pre><code>subList [1,2,3] [4,4,1,2,3,5,6] \n</code></pre>\n\n<p>the result should be 2 </p>\n\n<p>I have attempted to code it:</p>\n\n<pre><code>subList :: [a] -&gt; [a] -&gt; a\nsubList [] = []\nsubList (x:xs) = x + 1 (subList xs)\nsubList xs = [ y:zs | (y,ys) &lt;- select xs, zs &lt;- subList ys]\n        where select []     = []\n              select (x:xs) = x\n</code></pre>\n\n<p>I am receiving an \"error on input\" and I cannot figure out why my syntax is not working. Any suggestions?</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 1, "last_activity_date": 1428505204, "creation_date": 1428505204, "answer_id": 29518318, "question_id": 29516460, "link": "https://stackoverflow.com/questions/29516460/use-one-form-field-for-two-model-entries-in-yesod/29518318#29518318", "title": "Use one form field for two Model entries in Yesod", "body": "<p>I'd recommend a helper function like:</p>\n\n<pre><code>makeArticle :: Text -&gt; Text -&gt; Article\n</code></pre>\n\n<p>Which takes the title and URL, extracts the domain name from the URL, and constructs an <code>Article</code> value. Then you can use that in place of calling the <code>Article</code> data constructor directly.</p>\n"}], "owner": {"reputation": 65, "user_id": 4735483, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-3_9arYwT3jc/AAAAAAAAAAI/AAAAAAAABfY/Mywd_xz71Iw/photo.jpg?sz=128", "display_name": "Amedee d&#39;Aboville", "link": "https://stackoverflow.com/users/4735483/amedee-daboville"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 29518318, "answer_count": 1, "score": 1, "last_activity_date": 1428505204, "creation_date": 1428500711, "question_id": 29516460, "link": "https://stackoverflow.com/questions/29516460/use-one-form-field-for-two-model-entries-in-yesod", "title": "Use one form field for two Model entries in Yesod", "body": "<p>I am making a link aggregator where people can submit articles.</p>\n\n<p>My data model contains</p>\n\n<pre><code>Article\n    title Text\n    url Text\n    domain Text\n</code></pre>\n\n<p>I would like the user to input a url into the form and then I run a function on the URL to extract the domain and then save both in the database.\nI would like the user to only have to enter the URL once, as in:</p>\n\n<pre><code>entryForm = renderDivs $ Article\u00ac\n     &lt;$&gt; areq   textField \"Url\" Nothing\u00ac\n     &lt;*&gt; areq   textField \"Title\" Nothing\u00ac\n</code></pre>\n\n<p>But I get this error</p>\n\n<pre><code>Couldn't match type \u2018Text -&gt; Article\u2019 with \u2018Article\u2019\n  Expected type: Form Article\n    Actual type: blaze-markup-0.7.0.0:Text.Blaze.Internal.Markup\n               -&gt; MForm\n                    (HandlerT App IO)\n                    (FormResult (Text -&gt; Article),\n                     WidgetT (HandlerSite (HandlerT App IO)) IO ())\nIn the expression:\n  renderDivs\n  $ Article &lt;$&gt; areq textField \"Url\" Nothing\n    &lt;*&gt; areq textField \"Title\" Nothing\nIn an equation for \u2018entryForm\u2019:\n    entryForm\n      = renderDivs\n        $ Article &lt;$&gt; areq textField \"Url\" Nothing\n          &lt;*&gt; areq textField \"Title\" Nothing\n</code></pre>\n\n<p>because clearly the form doesn't match the type Article. </p>\n\n<p>I am not sure how to proceed. I've been told I can either a)write an alternative Article' datatype and convert between the two, or b) create my own custom field, though both of those seem difficult to me as a newbie.</p>\n"}, {"tags": ["string", "list", "haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1428498546, "post_id": 29515413, "comment_id": 47186488, "body": "what have you tried? Any ideas? Do you know a function/operator that gives you an element of your list based on the index? If not can you write one?"}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 1, "creation_date": 1428498772, "post_id": 29515413, "comment_id": 47186640, "body": "Your type signature right now says &quot;take an ordered pair containing a double and a list of ints and return an ordered pair containing a double and a function from a list of ints to a list of strings&quot;. What are you trying to accomplish here exactly?"}, {"owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "edited": false, "score": 0, "creation_date": 1428498812, "post_id": 29515413, "comment_id": 47186678, "body": "If you&#39;re trying to make a tuple with a variable size, that&#39;s not possible."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1428499212, "post_id": 29515413, "comment_id": 47186947, "body": "<b>Hint</b>: <a href=\"https://www.haskell.org/hoogle/?hoogle=%5Ba%5D+-%3E+Int+-%3E+a\" rel=\"nofollow noreferrer\">use Hoogle to find something like <code>[a] -&gt; Int -&gt; a</code></a>"}, {"owner": {"reputation": 29, "user_id": 3037801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f61e6cb2eeecd5447294488f81c5973?s=128&d=identicon&r=PG&f=1", "display_name": "HopefulSplash", "link": "https://stackoverflow.com/users/3037801/hopefulsplash"}, "edited": false, "score": 0, "creation_date": 1428499309, "post_id": 29515413, "comment_id": 47187024, "body": "thanks guys already found the answer"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1428499337, "post_id": 29515413, "comment_id": 47187050, "body": "@HopefulSplash ok - you should either edit and answer your question or delete it then - thanks"}, {"owner": {"reputation": 29, "user_id": 3037801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f61e6cb2eeecd5447294488f81c5973?s=128&d=identicon&r=PG&f=1", "display_name": "HopefulSplash", "link": "https://stackoverflow.com/users/3037801/hopefulsplash"}, "edited": false, "score": 0, "creation_date": 1428499370, "post_id": 29515413, "comment_id": 47187077, "body": "getnames :: (Double, [Int]) -&gt; (Double, [Int],[[Char]])      getnames ( nil , []) = error &quot;List is empty&quot;     getnames xs = (fst xs , snd xs, [city_Name_Array !! p| p&lt;-(snd xs)] )  have the wrong declaration but used to !! operator"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1428499498, "post_id": 29515413, "comment_id": 47187163, "body": "yeah this should work but you should rather use pattern matching instead of <code>fst</code> and <code>snd</code>: <code>getnames (dbl, js) = (dbl, js, [... | j &lt;- js])</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1428513798, "post_id": 29515413, "comment_id": 47197270, "body": "The OP does no longer need the answer"}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1428499671, "post_id": 29515954, "comment_id": 47187286, "body": "nice - +1 for the live-demo alone - never saw this before - thanks for demonstrating :D"}], "tags": [], "owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "is_accepted": true, "score": 3, "last_activity_date": 1428499809, "last_edit_date": 1428499809, "creation_date": 1428499494, "answer_id": 29515954, "question_id": 29515413, "link": "https://stackoverflow.com/questions/29515413/haskell-list-of-list-of-chars-adding-to-tuple/29515954#29515954", "title": "Haskell list of list of chars adding to tuple", "body": "<p>The operator <code>(!!)</code> can be used to index a list. Given a pair, you can use something along the lines of:</p>\n\n<pre><code>getnames :: (Double, [Int]) -&gt; [String] -&gt; (Double, [Int], [String])\ngetnames (dbl, ixes) names = \n    let namesLst = map (names !!) ixes in\n    (dbl, ixes, namesLst)\n</code></pre>\n\n<p><kbd><a href=\"http://coliru.stacked-crooked.com/a/1eaf1a654481e138\" rel=\"nofollow\">Live demo</a></kbd></p>\n\n<p>To get what you want, I've fixed your signature to be able to pass the names and fixed the return value type (which was returning a triple with a function at the end). Also notice that <code>[Char]</code> and <code>String</code> are exactly the same type.</p>\n\n<p>So inside the body of the function you have <code>dbl</code> which is your double and is directly forwarded to the final triple. Then you have <code>ixes</code> which are the indexes of the elements you have to take from <code>ixes</code>.</p>\n\n<p>At this point we calculate the <code>namesLst</code> by mapping the index function over the indexes to get the names in the correct order. Once we have this list, we just have to put it in the third element of the triple.</p>\n\n<p>If you want it to fail on empty index list (even if the names list is empty) then you can add:</p>\n\n<pre><code>getnames (_, []) _ = error \"...\"\n</code></pre>\n\n<p>where <code>_</code> means \"I don't care enough to name this argument\". And can be seen as a placeholder for an argument you'll not use.</p>\n"}], "owner": {"reputation": 29, "user_id": 3037801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f61e6cb2eeecd5447294488f81c5973?s=128&d=identicon&r=PG&f=1", "display_name": "HopefulSplash", "link": "https://stackoverflow.com/users/3037801/hopefulsplash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "closed_date": 1429765054, "accepted_answer_id": 29515954, "answer_count": 1, "score": 1, "last_activity_date": 1428499809, "creation_date": 1428498099, "last_edit_date": 1428498597, "question_id": 29515413, "link": "https://stackoverflow.com/questions/29515413/haskell-list-of-list-of-chars-adding-to-tuple", "closed_reason": "Needs details or clarity", "title": "Haskell list of list of chars adding to tuple", "body": "<p>example original <code>(41.12, [1,2,3,0])</code></p>\n\n<pre><code>name = [\"pete\",\"ben\",\"bill\",\"bob\"]\n</code></pre>\n\n<p>example output   <code>(41.12, [1,2,3,0], [\"ben\",\"bill\",\"bob\",\"pete\"])</code></p>\n\n<p>code so far: </p>\n\n<pre><code>getnames :: (Double, [Int]) -&gt; (Double, [Int] -&gt; [[Char]])\ngetnames ( nil , []) = error \"List is empty\"\ngetnames xs = [(doublevalue , listofints, listofstrings))  | x &lt;- xs]\n</code></pre>\n\n<p>How do i use the int list to get a value from the name list and put it in the tuple (i know when i add this to the tulle it isn't a tuple anymore)</p>\n\n<p>What method would i use to do this? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1428494995, "post_id": 29513977, "comment_id": 47183946, "body": "Applying it to <code>birthNumber</code> returns a list <code>[9259140000,9259140011]</code> with the first number in it which is the same as expected by you."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 3, "creation_date": 1428495280, "post_id": 29513977, "comment_id": 47184140, "body": "To be on the safer side you can use <code>Integer</code> for storing number of arbitrary precision. That may be the problem in your case."}, {"owner": {"reputation": 161, "user_id": 4528638, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-T-SI7I-wG3s/AAAAAAAAAAI/AAAAAAAAAKE/5LlR9056P_g/photo.jpg?sz=128", "display_name": "Lenusska1414", "link": "https://stackoverflow.com/users/4528638/lenusska1414"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1428497370, "post_id": 29513977, "comment_id": 47185644, "body": "I dont understand it, calling birthNumber (Date 1992 9 14) Female I get [669205408,669205419]"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1428497391, "post_id": 29513977, "comment_id": 47185658, "body": "According to GHCi, <code>9259140000 :: Int32</code> yields exactly <code>669205408</code>, so it is indeed a problem of integer overflow. As @Sibi suggests, use <code>Integer</code> instead."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428497562, "post_id": 29513977, "comment_id": 47185780, "body": "Basically, your numbers are too large for an <code>Int</code>: on 32-bit systems, the maximum number that <code>Int</code> can have is 2147483647. <code>Integer</code> instead has no bounds (except those imposed by the amount of memory you have)."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 3, "last_activity_date": 1428497993, "creation_date": 1428497993, "answer_id": 29515364, "question_id": 29513977, "link": "https://stackoverflow.com/questions/29513977/cant-get-correct-birth-number-in-haskell-function/29515364#29515364", "title": "Can&#39;t get correct birth number in haskell function", "body": "<p>Change your <code>Date</code> type to this:</p>\n\n<pre><code>data Date = Date Integer Integer Integer\n</code></pre>\n\n<p><code>Integer</code> can be used for storing numbers of arbitrary precision. Note that <code>Int</code> is machine specific. As @chi points out in your case you are being bitten by a 32-bit architecture. And moreover, it's a good practice to write type signature before the functions:</p>\n\n<pre><code>birthNum :: Date -&gt; Sex -&gt; Integer\nbirthNumber :: Date -&gt; Sex -&gt; [Integer]\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 4528638, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh5.googleusercontent.com/-T-SI7I-wG3s/AAAAAAAAAAI/AAAAAAAAAKE/5LlR9056P_g/photo.jpg?sz=128", "display_name": "Lenusska1414", "link": "https://stackoverflow.com/users/4528638/lenusska1414"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 29515364, "answer_count": 1, "score": 2, "last_activity_date": 1428498241, "creation_date": 1428494309, "last_edit_date": 1428498241, "question_id": 29513977, "link": "https://stackoverflow.com/questions/29513977/cant-get-correct-birth-number-in-haskell-function", "title": "Can&#39;t get correct birth number in haskell function", "body": "<p>I'm quite new to haskell, so I'd need some help, because I really don't understand why it's not working. I have a function as showed below, it should evaluate proper birth number. Calling function <code>birthNum</code> like this: </p>\n\n<pre><code>birthNum (Date 1992 9 14) Female \n</code></pre>\n\n<p>returns correct result (<code>925914</code>), but when I use it in function <code>birthNumber</code> I get strange results, for example something like this: \n<code>669205408</code> insead of, for example: <code>9259140000</code>.</p>\n\n<pre><code>data Date = Date Int Int Int -- Year, Month, Day\ndata Sex = Male | Female deriving Eq\n\nbirthNum (Date y m d) s = (y `mod` 100)*10000 + m*100 + d + sex s\n    where sex s | (s == Male) = 0\n                | otherwise = 5000\n\nbirthNumber (Date y m d) s = [birthNum (Date y m d) s *10000 + o | o &lt;- [0..20], (birthNum (Date y m d) s + o) `mod` 11 == 0]\n</code></pre>\n"}, {"tags": ["haskell", "yesod", "yesod-forms"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428494013, "post_id": 29513631, "comment_id": 47183293, "body": "I know nothing about yesod, but... shouldn&#39;t the type be <code>HandlerT something IO [(Text, Text)]</code> as GHC reports? I would be very surprised if you could access the database and return a pure list <code>[(Text,Text)]</code>. That type indicates that you can generate the list without accessing any data outside what&#39;s in the Haskell source (hence, not the DB)."}, {"owner": {"reputation": 575, "user_id": 2274220, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2612030d75e2235b2cb3a23297eb8466?s=128&d=identicon&r=PG", "display_name": "bitli", "link": "https://stackoverflow.com/users/2274220/bitli"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428494475, "post_id": 29513631, "comment_id": 47183594, "body": "I expected runDB function returns with [Entity Category] see here :<a href=\"http://stackoverflow.com/questions/11285419/yesod-persistent-type-error\" title=\"yesod persistent type error\">stackoverflow.com/questions/11285419/&hellip;</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428497099, "post_id": 29513631, "comment_id": 47185446, "body": "According to the docs: <code>runDB :: YesodPersist site =&gt; YesodDB site a -&gt; HandlerT site IO a</code>, so it does return something inside the Handler monad. <a href=\"https://www.fpcomplete.com/hoogle?q=runDB&amp;env=ghc-7.8-stable-14.09\" rel=\"nofollow noreferrer\">fpcomplete.com/hoogle?q=runDB&amp;env=ghc-7.8-stable-14.09</a>"}, {"owner": {"reputation": 575, "user_id": 2274220, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2612030d75e2235b2cb3a23297eb8466?s=128&d=identicon&r=PG", "display_name": "bitli", "link": "https://stackoverflow.com/users/2274220/bitli"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428497667, "post_id": 29513631, "comment_id": 47185855, "body": "Yes i know that, that why I tried to use fmap and later do notation to unpack the item, but It did not work."}], "answers": [{"comments": [{"owner": {"reputation": 575, "user_id": 2274220, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2612030d75e2235b2cb3a23297eb8466?s=128&d=identicon&r=PG", "display_name": "bitli", "link": "https://stackoverflow.com/users/2274220/bitli"}, "edited": false, "score": 0, "creation_date": 1428501971, "post_id": 29516719, "comment_id": 47189148, "body": "I do not understand the &quot;convertYourListToOptionList&quot; function. Please write down."}], "tags": [], "owner": {"reputation": 483, "user_id": 521370, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a8d69ed3d32273571045f30fc755ff0a?s=128&d=identicon&r=PG", "display_name": "Dmitry Olshansky", "link": "https://stackoverflow.com/users/521370/dmitry-olshansky"}, "is_accepted": false, "score": 2, "last_activity_date": 1428501282, "creation_date": 1428501282, "answer_id": 29516719, "question_id": 29513631, "link": "https://stackoverflow.com/questions/29513631/how-should-i-create-a-selectfieldlist-with-using-rundb-function-to-fetch-values/29516719#29516719", "title": "How should I create a selectFieldList with using runDB function to fetch values?", "body": "<p>Type of <code>findAllAsTuple</code> is <code>HandlerT site IO [(Text, Text)]</code>. \nYou can check it in GHCI by removing your (wrong) type signature.</p>\n\n<p>Function <code>selectFieldList</code> should getting data from static list without any IO. </p>\n\n<p>Best way is using function <code>selectField</code>. You should look to it's type:\n<code>\nselectField ::(Eq a, RenderMessage site FormMessage) =&gt;\n  HandlerT site IO (OptionList a) -&gt; Field (HandlerT site IO) a\n</code></p>\n\n<p>I.e. you can use something like\n<code>\nselectList (fmap convertYourListToOptionList findAllAsTuple)\n</code></p>\n"}, {"tags": [], "owner": {"reputation": 575, "user_id": 2274220, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2612030d75e2235b2cb3a23297eb8466?s=128&d=identicon&r=PG", "display_name": "bitli", "link": "https://stackoverflow.com/users/2274220/bitli"}, "is_accepted": true, "score": 0, "last_activity_date": 1428503985, "last_edit_date": 1495539911, "creation_date": 1428503985, "answer_id": 29517813, "question_id": 29513631, "link": "https://stackoverflow.com/questions/29513631/how-should-i-create-a-selectfieldlist-with-using-rundb-function-to-fetch-values/29517813#29517813", "title": "How should I create a selectFieldList with using runDB function to fetch values?", "body": "<p>Finally I found the solution.</p>\n\n<p>My function should look like this :</p>\n\n<pre><code>findAllAsTuple :: HandlerT App IO (OptionList Text)\nfindAllAsTuple =do \n             items &lt;- runDB $ selectList [] [Asc CategoryName] \n             optionsPairs $ map (\\c -&gt; (categoryName $ entityVal    c,categoryName $ entityVal c)) items\n</code></pre>\n\n<p>Dmitry was right I should use selectField instead of selectFieldList.</p>\n\n<p>The <code>optionsPairs</code> will create the OptionList from result. \nThis question was duplicated : <a href=\"https://stackoverflow.com/questions/17778494/capturing-persistent-relations-in-a-form\">Capturing Persistent Relations in a Form</a></p>\n"}], "owner": {"reputation": 575, "user_id": 2274220, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2612030d75e2235b2cb3a23297eb8466?s=128&d=identicon&r=PG", "display_name": "bitli", "link": "https://stackoverflow.com/users/2274220/bitli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 29517813, "answer_count": 2, "score": 1, "last_activity_date": 1428503985, "creation_date": 1428493368, "question_id": 29513631, "link": "https://stackoverflow.com/questions/29513631/how-should-i-create-a-selectfieldlist-with-using-rundb-function-to-fetch-values", "title": "How should I create a selectFieldList with using runDB function to fetch values?", "body": "<p>I would like to add a selectionFieldList to my Form, but unfortunetlly I could not fill with values from DB beacuse I got compile error.</p>\n\n<p>I have form definition like this:</p>\n\n<pre><code>flowerForm = renderDivs $ FormFlower\n&lt;$&gt; areq textField \"Flower\" Nothing\n&lt;*&gt; areq (selectFieldList findAllAsTuple) \"Category\" Nothing\n</code></pre>\n\n<p>And the findAllAsTuple function :</p>\n\n<pre><code>findAllAsTuple ::[(Text,Text)]\nfindAllAsTuple = fmap (map (\\cat -&gt; (categoryName $ entityVal cat, categoryName $ entityVal cat))) $ runDB $ selectList [] [Asc CategoryName]\n</code></pre>\n\n<p>But I got this  error:</p>\n\n<pre><code>Handler\\Category.hs:6:18:\nCouldn't match type `HandlerT site0 IO' with `[]'\nExpected type: [(Text, Text)]\n  Actual type: HandlerT site0 IO [(Text, Text)]\nIn the expression:\n  fmap\n    (map\n       (\\ cat\n          -&gt; (categoryName $ entityVal cat, categoryName $ entityVal cat)))\n  $ runDB $ selectList [] [Asc CategoryName]\nIn an equation for `findAllAsTuple':\n    findAllAsTuple\n      = fmap\n          (map\n             (\\ cat\n                -&gt; (categoryName $ entityVal cat, categoryName $ entityVal cat)))\n        $ runDB $ selectList [] [Asc CategoryName]\n</code></pre>\n\n<p>If I delete the fmap I got this error:</p>\n\n<pre><code>Handler\\Category.hs:6:95:\nCouldn't match expected type `[Entity Category]'\n            with actual type `HandlerT site0 IO [Entity Category]'\nIn the second argument of `($)', namely\n  `runDB $ selectList [] [Asc CategoryName]'\nIn the expression:\n  map\n    (\\ cat\n       -&gt; (categoryName $ entityVal cat, categoryName $ entityVal cat))\n  $ runDB $ selectList [] [Asc CategoryName]\nIn an equation for `findAllAsTuple':\n    findAllAsTuple\n      = map\n          (\\ cat\n             -&gt; (categoryName $ entityVal cat, categoryName $ entityVal cat))\n        $ runDB $ selectList [] [Asc CategoryName]\n</code></pre>\n\n<p>I tried this way as well :</p>\n\n<pre><code>findAllAsTuple ::[(Text,Text)]\nfindAllAsTuple = do\n            items &lt;-  runDB $ selectList [] [Asc CategoryName]\n            return $ map (\\cat -&gt; (categoryName $ entityVal cat,      categoryName $ entityVal cat))  items\n</code></pre>\n\n<p>But I then got this :</p>\n\n<pre><code>Handler\\Category.hs:8:17:\nCouldn't match type `[(Text, Text)]' with `(Text, Text)'\nExpected type: [(Text, Text)]\n  Actual type: [[(Text, Text)]]\nIn a stmt of a 'do' block:\n  return\n  $ map\n      (\\ cat\n         -&gt; (categoryName $ entityVal cat, categoryName $ entityVal cat))\n      items\nIn the expression:\n  do { items &lt;- runDB $ selectList [] [Asc CategoryName];\n       return\n       $ map\n           (\\ cat\n              -&gt; (categoryName $ entityVal cat, categoryName $ entityVal cat))\n           items }\nIn an equation for `findAllAsTuple':\n    findAllAsTuple\n      = do { items &lt;- runDB $ selectList [] [Asc CategoryName];\n             return\n             $ map\n                 (\\ cat\n                    -&gt; (categoryName $ entityVal cat, categoryName $ entityVal cat))\n                 items }\n</code></pre>\n\n<p>I do not understand why. If I write a simple map function like this :</p>\n\n<pre><code> findAllAsTuple ::[(Text,Text)]\n findAllAsTuple =  map (\\cat -&gt; (cat,cat))  [\"red\",\"blue\",\"yellow\"]\n</code></pre>\n\n<p>It is work well and I do not get any type error.</p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"comments": [{"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "edited": false, "score": 0, "creation_date": 1428486894, "post_id": 29511043, "comment_id": 47178626, "body": "Looks good, will wait for more answers before accepting this."}, {"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "edited": false, "score": 0, "creation_date": 1428570064, "post_id": 29511043, "comment_id": 47221125, "body": "Have tried the <code>packdeps</code> commandline tool now. Nice tool to have."}], "tags": [], "owner": {"reputation": 27942, "user_id": 96982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "GS - Apologise to Monica", "link": "https://stackoverflow.com/users/96982/gs-apologise-to-monica"}, "is_accepted": true, "score": 8, "last_activity_date": 1428485928, "creation_date": 1428485928, "answer_id": 29511043, "question_id": 29510634, "link": "https://stackoverflow.com/questions/29510634/is-there-a-recommended-way-to-update-version-bounds-on-cabal-packages/29511043#29511043", "title": "Is there a recommended way to update version bounds on cabal packages?", "body": "<p>I regularly use <a href=\"http://packdeps.haskellers.com/\"><code>packdeps</code></a> to check on my dependencies and bump any that are too restrictive. As well as the website, there's a <a href=\"http://hackage.haskell.org/package/packdeps\">hackage package</a> so you can run it locally.</p>\n\n<p>Once I bump a dependency, e.g. by bumping <code>foo &lt; 1.5</code> to <code>foo &lt; 1.6</code>, I build and test locally using the <code>--constraint 'foo&gt;=1.5'</code> argument to <code>cabal</code>, to check that the new version does indeed work.</p>\n"}, {"comments": [{"owner": {"reputation": 2191, "user_id": 4771017, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/975661e1ab7e8f7e4a22ccbb6cde5ad6?s=128&d=identicon&r=PG&f=1", "display_name": "CubeJockey", "link": "https://stackoverflow.com/users/4771017/cubejockey"}, "edited": false, "score": 1, "creation_date": 1439829572, "post_id": 32055139, "comment_id": 52009890, "body": "Links to external resources are encouraged, but please add context around the link so your fellow users will have some idea what it is and why it\u2019s there. Always quote the most relevant part of an important link, in case the target site is unreachable or goes permanently offline."}], "tags": [], "owner": {"reputation": 11, "user_id": 5236048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bda64711485d4f380c5d884f90b6dfb?s=128&d=identicon&r=PG", "display_name": "dan-t", "link": "https://stackoverflow.com/users/5236048/dan-t"}, "is_accepted": false, "score": 1, "last_activity_date": 1439828236, "creation_date": 1439828236, "answer_id": 32055139, "question_id": 29510634, "link": "https://stackoverflow.com/questions/29510634/is-there-a-recommended-way-to-update-version-bounds-on-cabal-packages/32055139#32055139", "title": "Is there a recommended way to update version bounds on cabal packages?", "body": "<p>You might like the tool <a href=\"https://github.com/dan-t/cabal-bounds\" rel=\"nofollow\">cabal-bounds</a>.</p>\n"}], "owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 2, "accepted_answer_id": 29511043, "answer_count": 2, "score": 8, "last_activity_date": 1439828236, "creation_date": 1428484719, "question_id": 29510634, "link": "https://stackoverflow.com/questions/29510634/is-there-a-recommended-way-to-update-version-bounds-on-cabal-packages", "title": "Is there a recommended way to update version bounds on cabal packages?", "body": "<p>With the release of GHC 7.10 and the accompanying version bump on the <code>base</code> package I found myself in the situation that I needed to fix my library dependencies.</p>\n\n<p>For the moment I have run <code>cabal install --allow-newer</code> which found a set of working versions and installed fine.</p>\n\n<p>Now I am in the process of manually searching through the installed libraries and updating the cabal files version bounds by hand.</p>\n\n<p>Is there an easier/automatic way to do this?</p>\n"}, {"tags": ["haskell", "type-kinds", "constraint-kinds"], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 12, "last_activity_date": 1486332952, "last_edit_date": 1486332952, "creation_date": 1428483429, "answer_id": 29510180, "question_id": 29509786, "link": "https://stackoverflow.com/questions/29509786/what-is-constraint-in-kind-signature/29510180#29510180", "title": "What is Constraint in kind signature", "body": "<p><strong>Unlike <code>Maybe</code>, <code>Monad</code> is not a <em>type</em>; it is a <em>typeclass</em>.</strong></p>\n\n<p>The same goes for other typeclasses:</p>\n\n<pre><code>Num :: * -&gt; Constraint\nFunctor :: (* -&gt; *) -&gt; Constraint\nBifunctor :: (* -&gt; * -&gt; *) -&gt; Constraint\n</code></pre>\n\n<p>Where <code>*</code> represents concrete types (such as <code>Bool</code> or <code>Int</code>), <code>-&gt;</code> represent higher-kinded types (such as <code>Maybe</code>), and <code>Constraint</code> represents the idea of a type constraint. This is why:</p>\n\n<hr>\n\n<p>As we know we can't make a signature like this:</p>\n\n<pre><code>return :: a -&gt; Monad a -- This is nonsense!\n</code></pre>\n\n<p>Because <code>Monad</code> should be used as a <em>constraint</em>, to say that, 'this must be a monad to work':</p>\n\n<pre><code>return :: (Monad m) =&gt; a -&gt; m a\n</code></pre>\n\n<p>We do this because we know that <code>return</code> can't work on any old type <code>m</code>, so we define the behaviour of <code>return</code> for different types under the name <code>Monad</code>. In other words, <em>there is no single thing that can be called a Monad, but only behaviour that can be called Monadic.</em></p>\n\n<p>For this reason, we have created this type constraint, saying that we must have pre-defined something as a Monad to use this function. This is why the kind of <code>Monad</code> is <code>(* -&gt; *) -&gt; Constraint</code> - it itself is not a type!</p>\n\n<hr>\n\n<p><code>Maybe</code> is an instance of <code>Monad</code>. This means that somewhere, someone has written:</p>\n\n<pre><code>instance Monad Maybe where\n  (&gt;&gt;=) = ... -- etc\n</code></pre>\n\n<p>...and defined how <code>Maybe</code> should behave as a Monad. This is why we can use <code>Maybe</code> with functions or types that have the prefix constraint <code>Monad m =&gt; ...</code>. This is essentially where one defines the constraint applied by <code>Monad</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 8, "last_activity_date": 1428483623, "creation_date": 1428483623, "answer_id": 29510252, "question_id": 29509786, "link": "https://stackoverflow.com/questions/29509786/what-is-constraint-in-kind-signature/29510252#29510252", "title": "What is Constraint in kind signature", "body": "<p><code>Constraint</code> is the kind of e.g. <code>Show Int</code>, <code>Monad Maybe</code>, and <code>Monoid [a]</code>. Roughly, it is the kind of everything that can occur on the left side of <code>=&gt;</code> in type annotations.</p>\n\n<p>Now since</p>\n\n<pre><code>Show Int :: Constraint\n</code></pre>\n\n<p>and <code>Int</code> is a type, i.e.</p>\n\n<pre><code>Int :: *\n</code></pre>\n\n<p>we can assign a functional kind to <code>Show</code> as follows</p>\n\n<pre><code>Show :: * -&gt; Constraint\n             ^-- the result kind\n        ^-- the kind of Int\n</code></pre>\n\n<p>In your case it just happens that a <code>Monad</code> takes argument like <code>Maybe</code>, so</p>\n\n<pre><code>Maybe Int :: *\nMaybe :: * -&gt; *\nMonad :: (* -&gt; *) -&gt; Constraint\n                     ^-- the result kind\n         ^-- the kind of Maybe\n</code></pre>\n"}], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 1, "accepted_answer_id": 29510180, "answer_count": 2, "score": 9, "last_activity_date": 1486332952, "creation_date": 1428482248, "last_edit_date": 1436573480, "question_id": 29509786, "link": "https://stackoverflow.com/questions/29509786/what-is-constraint-in-kind-signature", "title": "What is Constraint in kind signature", "body": "<p>If I inspect the <code>kind</code> of <code>Maybe</code> I get this:</p>\n\n<pre><code>\u03bb&gt; :k Maybe\nMaybe :: * -&gt; *\n</code></pre>\n\n<p>Now, if I inspect the kind of <code>Monad</code> I get this:</p>\n\n<pre><code>\u03bb&gt; :k Monad\nMonad :: (* -&gt; *) -&gt; Constraint\n</code></pre>\n\n<p>What is <code>Constraint</code> there and why it is needed ? Why not just this <code>* -&gt; *</code> ?</p>\n"}, {"tags": ["haskell", "quickcheck"], "answers": [{"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 14, "last_activity_date": 1428471436, "creation_date": 1428471436, "answer_id": 29506743, "question_id": 29506655, "link": "https://stackoverflow.com/questions/29506655/haskell-quickcheck-minimal-counter-example/29506743#29506743", "title": "Haskell QuickCheck minimal counter example", "body": "<p>When you actually evaluate <code>test2</code>, GHCi has to pick a type <code>a</code> to use. Without more information, GHCi's extended default rules make it default to <code>()</code>, for which the law is true.</p>\n"}, {"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 13, "last_activity_date": 1428471465, "creation_date": 1428471465, "answer_id": 29506752, "question_id": 29506655, "link": "https://stackoverflow.com/questions/29506655/haskell-quickcheck-minimal-counter-example/29506752#29506752", "title": "Haskell QuickCheck minimal counter example", "body": "<pre><code>&gt; verboseCheck test2 \n\nPassed:\n[]\n[]\nPassed:\n[]\n[]\nPassed:\n[(),()]\n[()]\nPassed:\n[(),(),()]\n[()]\nPassed:\n[()]\n[(),(),(),()]\n...\n</code></pre>\n\n<p>The polymorphic parameter defaults to <code>()</code>, and of course all such values are equal.</p>\n"}], "owner": {"reputation": 18463, "user_id": 3189923, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5d3122866199817cdf56b96a788d406f?s=128&d=identicon&r=PG&f=1", "display_name": "elm", "link": "https://stackoverflow.com/users/3189923/elm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "accepted_answer_id": 29506743, "answer_count": 2, "score": 9, "last_activity_date": 1428472320, "creation_date": 1428471017, "last_edit_date": 1428472320, "question_id": 29506655, "link": "https://stackoverflow.com/questions/29506655/haskell-quickcheck-minimal-counter-example", "title": "Haskell QuickCheck minimal counter example", "body": "<p>Consider the following tests for the <a href=\"https://www.fpcomplete.com/user/pbv/an-introduction-to-quickcheck-testing\">distributivity law between reverse and ++</a>, </p>\n\n<pre><code>import Test.QuickCheck\n\ntest :: [Int] -&gt; [Int] -&gt; Bool\ntest xs ys = reverse (xs ++ ys) == reverse xs ++ reverse ys\n\ntest2 :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Bool\ntest2 xs ys = reverse (xs ++ ys) == reverse xs ++ reverse ys\n</code></pre>\n\n<p>Note for lists of <code>Int</code> that</p>\n\n<pre><code>*Main&gt; quickCheck test\n*** Failed! Falsifiable (after 5 tests and 3 shrinks):    \n[1]\n[0]\n</code></pre>\n\n<p>However the test for lists of equatable items,</p>\n\n<pre><code>*Main&gt; quickCheck test2\n+++ OK, passed 100 tests.\n</code></pre>\n\n<p>What makes the second test pass ?</p>\n\n<p><strong>Update</strong> On compiling with <code>main = quickCheck test2</code>, the subsequent error on ambiguous type variable hints the problem (as already depicted in answers),</p>\n\n<pre><code>No instance for (Eq a0) arising from a use of `test2'\nThe type variable `a0' is ambiguous\nPossible fix: add a type signature that fixes these type variable(s)\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1428464625, "post_id": 29505392, "comment_id": 47168143, "body": "Thanks!  Could you please check out my related question - <a href=\"http://stackoverflow.com/q/29505152/409976\">stackoverflow.com/q/29505152/409976</a>?"}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 7, "last_activity_date": 1428463545, "creation_date": 1428463545, "answer_id": 29505392, "question_id": 29505363, "link": "https://stackoverflow.com/questions/29505363/understanding-kind-of-monadtrans/29505392#29505392", "title": "Understanding `kind` of MonadTrans", "body": "<p>The second <code>* -&gt; *</code> also comes from <code>Monad</code>'s kind! A monad transformer takes a type argument that is a <code>Monad</code> (or at least a type that has the kind of a <code>Monad</code>) and produces a new type which is a <code>Monad</code> (which also has the kind of a <code>Monad</code>).</p>\n\n<pre><code> * -&gt; *            -- a Monad\n(* -&gt; *) -&gt; * -&gt; * -- Something that takes a Monad and makes a new Monad.\n            * -&gt; * -- also a Monad\n</code></pre>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 29505392, "answer_count": 1, "score": 3, "last_activity_date": 1428463545, "creation_date": 1428463382, "question_id": 29505363, "link": "https://stackoverflow.com/questions/29505363/understanding-kind-of-monadtrans", "title": "Understanding `kind` of MonadTrans", "body": "<p>Looking at the <code>kind</code> of <code>Monad</code>:</p>\n\n<pre><code>ghci&gt;:k Monad\nMonad :: (* -&gt; *) -&gt; Constraint\n</code></pre>\n\n<p>I believe that's because it takes an <code>a</code> from <code>m a</code>, and returns the <code>Monad</code> constraint.</p>\n\n<p>Looking at <code>MonadTrans</code>'s *<code>kind</code>, I see:</p>\n\n<pre><code>ghci&gt;:i MonadTrans\nclass MonadTrans (t :: (* -&gt; *) -&gt; * -&gt; *) where\n  lift :: Monad m =&gt; m a -&gt; t m a\n        -- Defined in `Control.Monad.Trans.Class'\ninstance MonadTrans MaybeT\n  -- Defined in `Control.Monad.Trans.Maybe'\n</code></pre>\n\n<p>So, the first <code>(* -&gt; *)</code> comes from <code>Monad</code>'s <code>kind</code>, I believe. But what about the <code>* -&gt; *</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428476343, "post_id": 29505152, "comment_id": 47172383, "body": "<code>join</code> from <code>Control.Monad</code>."}], "answers": [{"comments": [{"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1428463603, "post_id": 29505330, "comment_id": 47167859, "body": "ah, so the <code>a</code> in <code>MaybeT m a</code> is expected to be the wrapped <code>monad</code>?"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 3, "creation_date": 1428464208, "post_id": 29505330, "comment_id": 47168020, "body": "@KevinMeredith No, the <code>a</code> in <code>MaybeT m a</code> is not expected to be the wrapped monad. It is expected to be the type of the value inside the wrapped monad. To be clear <code>MaybeT m a</code> means a <code>Maybe a</code> value wrapped inside a monad <code>m</code>. Here the wrapped monad is <code>Maybe a</code>, not <code>a</code>. The <code>a</code> is just the value wrapped in the <code>Maybe</code> which is in turn wrapped in the monad <code>m</code>."}, {"owner": {"reputation": 4773, "user_id": 4148211, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/DiKJf.jpg?s=128&g=1", "display_name": "frasertweedale", "link": "https://stackoverflow.com/users/4148211/frasertweedale"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1428464528, "post_id": 29505330, "comment_id": 47168111, "body": "Whups, sorry KevinMeredith ; @AaditMShah is right.  Listen to him :)"}], "tags": [], "owner": {"reputation": 4773, "user_id": 4148211, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/DiKJf.jpg?s=128&g=1", "display_name": "frasertweedale", "link": "https://stackoverflow.com/users/4148211/frasertweedale"}, "is_accepted": false, "score": 3, "last_activity_date": 1428463620, "last_edit_date": 1428463620, "creation_date": 1428463162, "answer_id": 29505330, "question_id": 29505152, "link": "https://stackoverflow.com/questions/29505152/using-maybet-with-join/29505330#29505330", "title": "Using MaybeT with `join`", "body": "<p>The type of <code>MaybeT</code> is:</p>\n\n<pre><code>MaybeT :: Monad m =&gt; m (Maybe a) -&gt; MaybeT m a\n</code></pre>\n\n<p>Accordingly, the type of <code>MaybeT $ Just 1234</code> (the expression bound to <code>x</code> in your question) is:</p>\n\n<pre><code>MaybeT $ Just 1234 :: Num (Maybe a) =&gt; MaybeT Maybe a\n</code></pre>\n\n<p>Haskell number literals are overloaded and will interpreted according to what the context demands.  In your case, the \"wrapped\" monad <code>m</code> is <code>Maybe</code>, and the compiler tries to interpret the literal <code>1234</code> as a <code>Maybe a</code>, but there is no <code>Num</code> instance.  This explains the type error you encountered.</p>\n\n<p>If you do really want a <code>MaybeT Maybe a</code>, your code should read:</p>\n\n<pre><code>ghci&gt; let x = MaybeT $ Just $ Just 1234\nghci&gt; :t x\nx :: Num a =&gt; MaybeT Maybe a\nghci&gt; let y = runMaybeT x\nghci&gt; :t y\ny :: Num a =&gt; Maybe (Maybe a)\nghci&gt; join y\nJust 1234\n</code></pre>\n\n<p>However, it is more likely that you want to use the <code>MaybeT</code> transformer to add a <em>success/failure</em> or <em>result/no result</em> context to an existing (monadic) computation.  A minimal example using the <code>Identity</code> monad:</p>\n\n<pre><code>ghci&gt; let x = MaybeT $ Identity $ Just 1234\nghci&gt; :t x\nx :: Num a =&gt; MaybeT Identity a\nghci&gt; let y = runMaybeT x\nghci&gt; :t y\ny :: Num a =&gt; Identity (Maybe a)\nghci&gt; runIdentity y\nJust 1234\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": true, "score": 4, "last_activity_date": 1428464299, "last_edit_date": 1428464299, "creation_date": 1428463882, "answer_id": 29505432, "question_id": 29505152, "link": "https://stackoverflow.com/questions/29505152/using-maybet-with-join/29505432#29505432", "title": "Using MaybeT with `join`", "body": "<p>You are not using the <code>MaybeT</code> constructor correctly. Look at the type signatures:</p>\n\n<pre><code>MaybeT    ::            m   (Maybe a) -&gt; MaybeT m a\n                        |   |       |\n                      /-+-\\ \\---+---/\n                      |   |     |\nJust 1234 :: Num x =&gt; Maybe     x\n</code></pre>\n\n<p>Hence:</p>\n\n<pre><code>m := Maybe\nx := Maybe a\n</code></pre>\n\n<p>Therefore:</p>\n\n<pre><code>MaybeT $ Just 1234 :: Num (Maybe a) =&gt; MaybeT Maybe a\n</code></pre>\n\n<p>So here <code>Maybe a</code> is expected to be an instance of <code>Num</code> which is clearly wrong. An option type is not a number. Why does this problem arise?</p>\n\n<p>Consider the numeric literal <code>1234</code>. Numeric literals are bounded polymorphic values in Haskell. Hence, they have the type <code>Num x =&gt; x</code>. In other words <code>1234</code> can be of any type depending upon the context as long as that type is an instance of <code>Num</code> (e.g. <code>Int</code>, <code>Integer</code>, <code>Double</code>).</p>\n\n<p>In your code, the polymorphic type <code>x</code> is instantiated to <code>Maybe a</code> which is why Haskell expects <code>Maybe a</code> to be an instance of <code>Num</code>.</p>\n\n<p>I think what you really want to do is this:</p>\n\n<pre><code>MaybeT             ::                     m (Maybe a) -&gt; MaybeT m a\n\nreturn $ Just 1234 :: (Num a, Monad m) =&gt; m (Maybe a)\n</code></pre>\n\n<p>Therefore:</p>\n\n<pre><code>MaybeT $ return $ Just 1234 :: (Num a, Monad m) =&gt; MaybeT m a\n</code></pre>\n\n<p>Now you can easily extract the inner <code>Maybe a</code>:</p>\n\n<pre><code>runMaybeT $ MaybeT $ return $ Just 1234 :: (Num a, Monad m) =&gt; m (Maybe a)\n</code></pre>\n\n<p>Since the inner <code>Maybe a</code> value is wrapped in a monad all you need to do is use <code>&gt;&gt;=</code> to extract the <code>Maybe a</code>:</p>\n\n<pre><code>(runMaybeT $ MaybeT $ return $ Just 1234) &gt;&gt;= \\x -&gt; do\n    -- do something with x\n    -- x :: Maybe a\n</code></pre>\n\n<p>You could also write this using the <code>do</code> notation:</p>\n\n<pre><code>do\n    x &lt;- runMaybeT $ MaybeT $ return $ Just 1234\n    -- do something with x\n    -- x :: Maybe a\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 29505432, "answer_count": 2, "score": 2, "last_activity_date": 1428464299, "creation_date": 1428461937, "question_id": 29505152, "link": "https://stackoverflow.com/questions/29505152/using-maybet-with-join", "title": "Using MaybeT with `join`", "body": "<p>Looking at the <code>MaybeT</code> transformer:</p>\n\n<pre><code>ghci&gt; let x = MaybeT $ Just 1234\nghci&gt; let y = runMaybeT x\nghci&gt; :t y\ny :: Num (Maybe a) =&gt; Maybe (Maybe a)\n</code></pre>\n\n<p>Now I want to get the inner <code>Maybe a</code>, but <code>join</code> does not work.</p>\n\n<pre><code>ghci&gt; join y\n\n&lt;interactive&gt;:53:1:\n    No instance for (Num (Maybe a0)) arising from a use of `it'\n    In a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>How can I get at the inner <code>Maybe a</code> value?</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1428470531, "post_id": 29504200, "comment_id": 47169865, "body": "Can you elaborate on how to cause crashes with this?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428520236, "post_id": 29504200, "comment_id": 47201116, "body": "@chi I&#39;ve given a snippet that shows how to get two different instances in scope. From there it&#39;s not hard -- just make some assumptions in your code about all instances being equal and you&#39;ve got yourself a problem."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1428520789, "post_id": 29504200, "comment_id": 47201433, "body": "I don&#39;t think you can cause crashes with this, unless you count a crash caused by breaking an invariant in a module that assumes that instances are coherent, and uses this assumption to justify <code>unsafeCoerce</code> or the like. (But then I would say the crash is caused by <code>unsafeCoerce</code>.)"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1428521075, "post_id": 29504200, "comment_id": 47201592, "body": "Specifically one might think that, while confusing <code>True</code> and <code>False</code> is harmless to an otherwise valid Haskell program, one could use associated types to get a less harmless confusion between <code>Int</code> and <code>Maybe Int</code>. But in fact GHC seems to always check type family instances for overlap."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428524053, "post_id": 29504200, "comment_id": 47203377, "body": "@DanielWagner Interesting. I thought that it was forbidden to import two modules defining two instances for the same type. Probably the check is deferred on use, which would be ok if it weren&#39;t for the GADT..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1428533822, "post_id": 29504200, "comment_id": 47207888, "body": "@ReidBarton, I believe you are wrong. <code>unsafeCoerce</code> is much better behaved than <code>IncoherentInstances</code>. In particular, I believe GHC assumes coherence in its optimizations. I&#39;m pretty sure you could convince GHC that a particular <code>case</code> branch is dead, then hand it an incoherent instance dictionary in a GADT blowing everything up."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1428548632, "post_id": 29504200, "comment_id": 47211972, "body": "@dfeuer, if you can do that, please file a bug report. It would be a previously unknown and significant bug."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1428548924, "post_id": 29504200, "comment_id": 47212052, "body": "@ReidBarton, maybe I&#39;m wrong then. But the sorts of problems <code>IncoherentInstances</code> is <i>known</i> to cause are at least as bad as hard crashes anyway. I will see if I can make a hard crash of it...."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1428520183, "last_edit_date": 1428520183, "creation_date": 1428455571, "answer_id": 29504200, "question_id": 29504107, "link": "https://stackoverflow.com/questions/29504107/which-dictionary-does-ghc-choose-when-more-than-one-is-in-scope/29504200#29504200", "title": "Which dictionary does GHC choose when more than one is in scope?", "body": "<p>It just picks one. This isn't the correct choice; it's a pretty well-known wart. You can cause crashes this way, so it's a pretty bad state of affairs. Here is a short example using nothing but <code>GADTs</code> that demonstrates that it is possible to have two <em>different</em> instances in scope at once:</p>\n\n<pre><code>-- file Class.hs\n{-# LANGUAGE GADTs #-}\nmodule Class where\n\ndata Dict a where\n  Dict :: C a =&gt; Dict a\n\nclass C a where\n  test :: a -&gt; Bool\n\n-- file A.hs\nmodule A where\n\nimport Class\n\ninstance C Int where\n  test _ = True\n\nv :: Dict Int\nv = Dict\n\n-- file B.hs\nmodule B where\n\nimport Class\n\ninstance C Int where\n  test _ = False\n\nf :: Dict Int -&gt; Bool\nf Dict = test (0 :: Int)\n\n-- file Main.hs\nimport TestA\nimport TestB\n\nmain = print (f v)\n</code></pre>\n\n<p>You will find that <code>Main.hs</code> compiles just fine, and even runs. It prints <code>True</code> on my machine with GHC 7.10.1, but that's not a stable outcome. Turning this into a crash is left to the reader.</p>\n"}, {"comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1428498694, "post_id": 29506517, "comment_id": 47186590, "body": "I&#39;m aware that <code>IncoherentInstances</code> can lead to all sorts of nastiness, which is why my example <i>doesn&#39;t</i> use it (but it does use <code>OverlappingInstances and an orphan instance in another module). I didn&#39;t realize </code>OverlappingInstances` could also lead to undefined behavior...I thought it was &quot;safe&quot;."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1428503879, "post_id": 29506517, "comment_id": 47190643, "body": "@Eric I thought so as well. Maybe it could be considered a bug but I&#39;m not an expert on that."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1428504068, "post_id": 29506517, "comment_id": 47190787, "body": "@Eric For the record, using only overlapping instances I can make <code>Dict</code> to pack the &quot;best&quot; instance in a module: GHC commits to it even without the &quot;incoherent&quot; extension since there&#39;s a single best option. In another module I import that, and define an even better instance (this should be disallowed, IMHO)."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1428504430, "post_id": 29506517, "comment_id": 47191067, "body": "Can you update your example? If you have another way in which <code>Overlapping</code> without <code>Incoherent</code> can be unsafe, I&#39;ll post a bug."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1428507763, "post_id": 29506517, "comment_id": 47193591, "body": "I believe it&#39;s possible to trick GHC even without <code>OverlappingInstances</code>, which is one big reason orphans are considered evil."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1428513937, "post_id": 29506517, "comment_id": 47197357, "body": "@Eric There&#39;s no need to post a bug: Reid Barton below states this is already known, and a long-standing one... :-/"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1428494052, "last_edit_date": 1428494052, "creation_date": 1428470353, "answer_id": 29506517, "question_id": 29504107, "link": "https://stackoverflow.com/questions/29504107/which-dictionary-does-ghc-choose-when-more-than-one-is-in-scope/29506517#29506517", "title": "Which dictionary does GHC choose when more than one is in scope?", "body": "<p>Here's a test:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, OverlappingInstances, IncoherentInstances #-}\nimport Data.Constraint\n\nclass    C a    where foo :: a -&gt; String\ninstance C [a]  where foo _ = \"[a]\"\ninstance C [()] where foo _ = \"[()]\"\n\naDict :: Dict (C [a])\naDict = Dict\n\nbDict :: Dict (C [()])\nbDict = Dict\n\nbar1 :: String\nbar1 = case (bDict, aDict :: Dict (C [()])) of\n         (Dict,Dict) -&gt; foo [()]              -- output: \"[a]\"\n\nbar2 :: String\nbar2 = case (aDict :: Dict (C [()]), bDict) of\n         (Dict,Dict) -&gt; foo [()]              -- output: \"[()]\"\n</code></pre>\n\n<p>GHC above happens to use the \"last\" dictionary which was brought into scope. I wouldn't rely on this, though.</p>\n\n<p>If you limit yourself to <em>overlapping instances</em>, only, then you wouldn't be able to bring in scope two different dictionaries for the same type (as far as I can see), and everything should be fine since the choice of the dictionary becomes immaterial.</p>\n\n<p>However, <em>incoherent instances</em> are another beast, since they allow you to commit to a generic instance and then use it at a type which has a more specific instance. This makes it very hard to understand which instance will be used.</p>\n\n<p>In short, incoherent instances are evil.</p>\n\n<hr>\n\n<p>Update: I ran some further tests. Using only overlapping instances and an orphan instance in a separate module you can still obtain two different dictionaries for the same type. So, we need even more caveats. :-(</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1428514114, "post_id": 29520269, "comment_id": 47197462, "body": "One might then ask why we have two extensions (incoherent/overlapping) instead of just one. One might get the impression that overlapping alone is still &quot;safe&quot;, and only with incoherent the real trouble begins."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1428520277, "post_id": 29520269, "comment_id": 47201145, "body": "&quot;Any two dictionaries for the same constraint are supposed to be equal.&quot; -- Supposed to be, but aren&#39;t. See my answer for an example of violating this claim without using either of incoherent or overlapping instances."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1428521139, "post_id": 29520269, "comment_id": 47201633, "body": "Yes, that&#39;s what I mean by the loss of instance coherence."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 5, "last_activity_date": 1428510454, "creation_date": 1428510454, "answer_id": 29520269, "question_id": 29504107, "link": "https://stackoverflow.com/questions/29504107/which-dictionary-does-ghc-choose-when-more-than-one-is-in-scope/29520269#29520269", "title": "Which dictionary does GHC choose when more than one is in scope?", "body": "<p>GHC just picks one, and this is the correct choice. Any two dictionaries for the same constraint are supposed to be equal.</p>\n\n<p>OverlappingInstances and IncoherentInstances are basically equivalent in destructive power; they both lose instance coherence by design (any two equal constraints in your program being satisfied by the same dictionary). OverlappingInstances gives you a little more ability to work out which instances will be used on a case-by-case basis, but this isn't that useful when you get to the point of passing around Dicts as first class values and so on. I would only consider using OverlappingInstances when I consider the overlapping instances extensionally equivalent (e.g., a more efficient but otherwise equal implementation for a specific type like Int), but even then, if I care enough about performance to write that specialized implementation, isn't it a performance bug if it doesn't get used when it could be?</p>\n\n<p>In short, if you use OverlappingInstances, you give up the right to ask the question of which dictionary will be selected here.</p>\n\n<p>Now it's true that you can break instance coherence without OverlappingInstances. In fact you can do it without orphans and without any extensions other than FlexibleInstances (arguably the problem is that the definition of \"orphan\" is wrong when FlexibleInstances is enabled). This is a very long-standing GHC bug, which hasn't been fixed in part because (a) it actually can't cause crashes directly as far as anybody seems to know, and (b) there might be a lot of programs that actually rely on having multiple instances for the same constraint in separate parts of the program, and that might be hard to avoid.</p>\n\n<p>Getting back to the main topic, in principle it's important that GHC can select any dictionary that it has available to satisfy a constraint, because even though they are supposed to be equal, GHC might have more static information about some of them than others. Your example is a little bit too simple to be illustrative but imagine that you passed an argument to <code>bar</code>; in general GHC doesn't know anything about the dictionary passed in via <code>Dict</code> so it has to treat this as a call to an unknown function, but you called <code>foo</code> at a specific type <code>T</code> for which there was a <code>Bar T</code> instance in scope, then GHC would know that the <code>bar</code> from the <code>Bar a</code> constraint dictionary was <code>T</code>'s <code>bar</code> and could generate a call to a known function, and potentially inline <code>T</code>'s <code>bar</code> and do more optimizations as a result.</p>\n\n<p>In practice, GHC is currently not this smart and it just uses the innermost dictionary available. It would probably be already better to always use the outermost dictionary. But cases like this where there are multiple dictionaries available are not very common, so we don't have good benchmarks to test on.</p>\n"}], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 1, "accepted_answer_id": 29520269, "answer_count": 3, "score": 11, "last_activity_date": 1428520183, "creation_date": 1428454806, "last_edit_date": 1495539865, "question_id": 29504107, "link": "https://stackoverflow.com/questions/29504107/which-dictionary-does-ghc-choose-when-more-than-one-is-in-scope", "title": "Which dictionary does GHC choose when more than one is in scope?", "body": "<p>Consider the following example:</p>\n\n<pre><code>import Data.Constraint\n\nclass Bar a where\n  bar :: a -&gt; a\n\nfoo :: (Bar a) =&gt; Dict (Bar a) -&gt; a -&gt; a\nfoo Dict = bar\n</code></pre>\n\n<p>GHC has two choices for the dictionary to use when selecting a <code>Bar</code> instance in <code>foo</code>: it could use the dictionary from the <code>Bar a</code> constraint on <code>foo</code>, or it could use the runtime <code>Dict</code> to get a dictionary. See <a href=\"https://stackoverflow.com/questions/29482576/turning-a-dict-into-a-constraint\">this question</a> for an example where the dictionaries correspond to <em>different</em> instances. </p>\n\n<p>Which dictionary does GHC use, and why is it the \"correct\" choice?</p>\n"}, {"tags": ["haskell", "hoogle"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1428434317, "post_id": 29499253, "comment_id": 47157540, "body": "AFAIK you have to run <code>hoogle combine</code> to get your database in there - sadly all online docs are deadlinked right now and I cannot find the details - I am sure someone will help ASAP"}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1428440325, "post_id": 29499253, "comment_id": 47160781, "body": "The <a href=\"http://code.google.com/p/ganeti/\" rel=\"nofollow noreferrer\">Ganeti</a> project has a <a href=\"http://git.ganeti.org/?p=ganeti-hoogle.git\" rel=\"nofollow noreferrer\">repository</a> with a slack role that automates setting up a Hoogle web server from scratch which indexes all the Haskell code of the project. Perhaps it could be helpful to you. (Disclaimer: I&#39;m involved in the project.)"}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 4530052, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/67c7db4146b0cff401bf789ce8ed8fa5?s=128&d=identicon&r=PG&f=1", "display_name": "Oxy", "link": "https://stackoverflow.com/users/4530052/oxy"}, "edited": false, "score": 0, "creation_date": 1428449167, "post_id": 29501200, "comment_id": 47164167, "body": "Great! It actually somehow solved the problem. Now, my functions show up in the search results, but they are not linked to local hackage documentation. How can I link to local documents of the packages?"}], "tags": [], "owner": {"reputation": 31, "user_id": 1109611, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wtomj.jpg?s=128&g=1", "display_name": "mhuesch", "link": "https://stackoverflow.com/users/1109611/mhuesch"}, "is_accepted": false, "score": 3, "last_activity_date": 1428456028, "last_edit_date": 1428456028, "creation_date": 1428440304, "answer_id": 29501200, "question_id": 29499253, "link": "https://stackoverflow.com/questions/29499253/running-hoogle-locally/29501200#29501200", "title": "Running Hoogle Locally", "body": "<p>Hoogle searches the current directory (where the command <code>hoogle</code> is run) for a database called 'default.hoo', so if you rename your database to that it should find it.</p>\n\n<p>To add it to the database in your cabal directory, I believe this should work (taken from <a href=\"http://newartisans.com/2012/09/running-a-fully-local-hoogle/\" rel=\"nofollow\">http://newartisans.com/2012/09/running-a-fully-local-hoogle/</a>):</p>\n\n<pre><code>cd {...path to hoogle databases dir...}\nmv default.hoo default.hoo-prev\nhoogle combine *.hoo\n</code></pre>\n\n<p><strong>Edit:</strong> (in response on <code>Oxy</code>'s edits)</p>\n\n<p>My knowledge of <code>default.hoo</code> comes from <a href=\"https://github.com/gilligan/hoobuddy\" rel=\"nofollow\">here</a>. It seems to doesn't seem to be very well know.</p>\n\n<p>hoobuddy (the above linked project), while cool, doesn't seem to address what you want. I think the key to that is in the help of hoogle data</p>\n\n<pre><code>$ hoogle data --help\n...\n-l --local[=FILEPATH]  Use local documentation if available\n...\n</code></pre>\n\n<p>I haven't done it myself so I am not sure. The author of <a href=\"http://newartisans.com/2012/09/running-a-fully-local-hoogle/\" rel=\"nofollow\">this writeup</a> achieved local documentation linking by compiling hoogle from source and adding his local docs directory. I <em>think</em> that you can avoid that by using hoogle data.</p>\n"}], "owner": {"reputation": 293, "user_id": 4530052, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/67c7db4146b0cff401bf789ce8ed8fa5?s=128&d=identicon&r=PG&f=1", "display_name": "Oxy", "link": "https://stackoverflow.com/users/4530052/oxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1910, "favorite_count": 3, "answer_count": 1, "score": 5, "last_activity_date": 1478641830, "creation_date": 1428433434, "last_edit_date": 1478641830, "question_id": 29499253, "link": "https://stackoverflow.com/questions/29499253/running-hoogle-locally", "title": "Running Hoogle Locally", "body": "<p>I want to run <code>hoogle</code> on a project of mine. I successfully generated the hoogle database (a file with <code>.hoo</code> extension) from my project.\nBut when I run the server locally, hoogle cannot find any of the functions or types that are defined in my project.\nIt can find some of the prelude functions such as <code>map</code>, but none of the functions that are defined in my project.\n<code>hoogle dump my-project.hoo</code> dumps the content with no error.\nI also moved <code>my-project.hoo</code> to <code>~/.cabal/share/x86_64-osx-ghc-7.8.4/hoogle-4.2.38/databases</code> where all the <code>.hoo</code> files reside. No success again.\n<code>-verbose</code> switch also does not output any useful information.\nAny suggestion is appreciated.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Thanks to <code>mhuesch</code>'s suggestion, I was able to get the search results. Although, the returned results are not linked to the local hackage documents. <strong>Something that I couldn't find anywhere on the web is that the hoogle server looks for a file called <code>default.hoo</code> in the current directory.</strong></p>\n\n<p><strong>Edit 2:</strong></p>\n\n<p>If you, like me, have 5000+ databases (<em>i.e.</em>, <code>.hoo</code> files) you may get a \"too many open files\" error when combining them. The trick is simple: run <code>hoogle combine x*.hoo -o=parts/x.hoo</code> for all <code>x='a' ... 'z'</code> and then run <code>hoogle combine *.hoo -o=default.hoo</code> in the parts folder.</p>\n\n<p><strong>Edit 3:</strong></p>\n\n<p>If you want to link your hoogle search results with local hackage documentation,\nuse <code>hoogle convert --doc='absolute-path-to-your-doc' your-package-hoogle-doc.txt default.hoo</code>.\nI couldn't get relative path working.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 6, "creation_date": 1428433930, "post_id": 29499203, "comment_id": 47157347, "body": "@KevinMeredith If you&#39;re using GHC 7.8 or newer then <code>Sum</code> and <code>Product</code> implement <code>Num</code>, so you can do <code>getSum $ mconcat $ take 10 $ iterate (+1) 1</code>, although they don&#39;t implement <code>Enum</code> so you can&#39;t do <code>getSum $ mconcat [1..10]</code>.  In the first expression you can swap <code>getSum</code> for <code>getProduct</code> and it&#39;ll still compile."}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 8, "creation_date": 1428434399, "post_id": 29499203, "comment_id": 47157575, "body": "Other valid monoid implementations: max and min (with mempty being minBound and maxBound respectively).  There are <i>lots</i> of valid implementations."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1428435921, "post_id": 29499203, "comment_id": 47158444, "body": "... not to mention that it could be minimum, maximum, first positive number, and so on."}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "edited": false, "score": 5, "creation_date": 1428440662, "post_id": 29499203, "comment_id": 47160944, "body": "Since <code>Int</code> is fixed size, we also have various bitwise operations."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 1, "creation_date": 1428441139, "post_id": 29499203, "comment_id": 47161124, "body": "@augustss The other good fundamental theorem of arithmetic related <code>Monoid</code> instance for <code>Integral</code> types would be (signed) <code>lcm</code> with identity <code>1</code>. A <code>gcd</code> instance also needs to be signed to obey the identity laws for identity <code>0</code>."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "edited": false, "score": 0, "creation_date": 1428444416, "post_id": 29499203, "comment_id": 47162525, "body": "@TikhonJelvis Many of the bitwise operations work for <code>Integer</code>s as well."}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 0, "creation_date": 1428444848, "post_id": 29499203, "comment_id": 47162683, "body": "You could even interpret Integer or Int as members of equivalence classes mod primes and pick up even more fun."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 1, "creation_date": 1428447074, "post_id": 29499203, "comment_id": 47163503, "body": "I think it&#39;s an interesting and not always obvious question of what rules to follow when a type allows multiple lawful instances of the same class . In some cases, like <code>Int</code> and <code>Monoid</code> here, the choice has been not to implement the class at all, and leave the instances to <code>newtype</code>s, because there&#39;s no obvious choice of one as the default. In the case of the <code>Applicative []</code> instance, on the other hand, only one of them is compatible with the <code>Monad</code> instance, which determines the choice. Then there are cases like <code>Monoid Maybe</code> instance which many people dislike..."}, {"owner": {"reputation": 1403, "user_id": 1748746, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/ZMrp9.png?s=128&g=1", "display_name": "Anthony Raimondo", "link": "https://stackoverflow.com/users/1748746/anthony-raimondo"}, "edited": false, "score": 0, "creation_date": 1540673748, "post_id": 29499203, "comment_id": 92954159, "body": "Many types have class instances that have multiple possible implementations and it seems we just pick one of them, so why havent we picked one for the Int Monoid?"}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 42, "last_activity_date": 1428433402, "last_edit_date": 1428433402, "creation_date": 1428433277, "answer_id": 29499203, "question_id": 29499119, "link": "https://stackoverflow.com/questions/29499119/why-int-does-not-implement-monoid/29499203#29499203", "title": "Why Int Does Not Implement &#39;Monoid&#39;?", "body": "<p><code>Int</code> isn't a <code>Monoid</code> because there's more than one obvious <code>Monoid</code> implementation for <code>Int</code>.</p>\n\n<pre><code>instance Monoid Int where\n    mempty  = 0\n    mappend = (+)\n\ninstance Monoid Int where\n    mempty  = 1\n    mappend = (*)\n</code></pre>\n\n<p>The <code>newtype</code>s <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Monoid.html#v:Sum\" rel=\"noreferrer\"><code>Sum</code></a> and <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Monoid.html#v:Product\" rel=\"noreferrer\"><code>Product</code></a> defined in <code>Data.Monoid</code> allow you to easily select which <code>Monoid</code> instance to use with numbers.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1914, "favorite_count": 4, "accepted_answer_id": 29499203, "answer_count": 1, "score": 24, "last_activity_date": 1428433402, "creation_date": 1428433011, "question_id": 29499119, "link": "https://stackoverflow.com/questions/29499119/why-int-does-not-implement-monoid", "title": "Why Int Does Not Implement &#39;Monoid&#39;?", "body": "<p>Given a <code>Maybe Int</code>, I tried to <code>mappend</code> it to itself.</p>\n\n<pre><code>$let x = Just 55 :: Maybe Int\n\n$mappend x x\n\n&lt;interactive&gt;:126:1:\n    No instance for (Monoid Int) arising from a use of `mappend'\n    In the expression: mappend x x\n    In an equation for `it': it = mappend x x\n</code></pre>\n\n<p>Looking at <a href=\"https://hackage.haskell.org/package/base-4.2.0.1/docs/Data-Maybe.html\">Maybe</a>, I see:</p>\n\n<blockquote>\n  <p>Monoid a => Monoid (Maybe a)</p>\n</blockquote>\n\n<p>Since <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Int.html\">Int</a> does not implement <code>Monoid</code> type-class, that explains why I can't use <code>mappend</code> with <code>Maybe Int</code>.</p>\n\n<p>But, I remembered from <a href=\"http://learnyouahaskell.com/functors-applicative-functors-and-monoids\">LYAH</a> that I can use <code>Sum</code>:</p>\n\n<pre><code>ghci&gt; let x = Sum 55\nghci&gt; mappend x x\nSum {getSum = 110}\n</code></pre>\n\n<p>But, why isn't <code>Int</code> a Monoid?</p>\n"}, {"tags": ["list", "haskell", "recursion", "vector"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1428438866, "post_id": 29499035, "comment_id": 47160053, "body": "The <a href=\"https://www.haskell.org/hoogle/?hoogle=%28a+-%3E+Maybe+b%29+-%3E+%5Ba%5D+-%3E+b\" rel=\"nofollow noreferrer\">Hoogle results for <code>(a -&gt; Maybe b) -&gt; [a] -&gt; b</code></a> are pretty suggestive."}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "edited": false, "score": 2, "creation_date": 1428439898, "post_id": 29499035, "comment_id": 47160594, "body": "It is worth mentioning that your function is itero-recursive or tail-recursive, meaning that it automatically will get turned into a loop rather than a stack recursion. With that said, what you&#39;ve done can be expressed in many other ways, many of which hide the loop in existing constructs. For example, using <code>Data.Maybe.isJust</code> there is a point-free version, <code>go = (head .) . filter . (isJust .) . V.find</code> or, partially applied, <code>go p = head . filter (isJust . V.find p)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1428439519, "post_id": 29499185, "comment_id": 47160387, "body": "<code>foldr (&lt;|&gt;) mzero</code> should probably be <code>foldr (&lt;|&gt;) empty</code> to avoid mixing <code>Alternative</code> and <code>MonadPlus</code>, which is then just <code>asum</code> -- essentially the same as <code>msum</code>."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1428439566, "post_id": 29499185, "comment_id": 47160411, "body": "@DanielWagner Good point, I mixed up which <code>:i</code> output I was looking at."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 2, "last_activity_date": 1428439576, "last_edit_date": 1428439576, "creation_date": 1428433218, "answer_id": 29499185, "question_id": 29499035, "link": "https://stackoverflow.com/questions/29499035/non-recursive-way-to-search-an-infinite-list-of-vectors-in-haskell/29499185#29499185", "title": "Non-recursive way to search an infinite list of vectors in Haskell?", "body": "<p>At some point recursion is used, but you could certainly simplify this using <code>Data.Monoid</code> and <code>map</code>:</p>\n\n<pre><code>go :: (a -&gt; Bool) -&gt; [V.Vector a] -&gt; Maybe a\ngo pred = getFirst . mconcat . map (First . V.find pred)\n</code></pre>\n\n<p>I would recommend leaving this as returning <code>Maybe a</code> instead of using <code>error</code>, most will generally recommend against the use of <code>error</code> since it simply crashes your program instead of allowing you to exit gracefully.</p>\n\n<p>Another way you could implement this is with <code>Data.Maybe</code> functions:</p>\n\n<pre><code>go pred = listToMaybe . catMaybes . map (V.find pred)\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>go pred = listToMaybe . mapMaybe (V.find pred)\n</code></pre>\n\n<p>Or you can use the <code>MonadPlus</code> instance for <code>Maybe</code> (import <code>Control.Monad</code> first):</p>\n\n<pre><code>go pred = msum . map (V.find pred)\n</code></pre>\n\n<p>Or the <code>Alternative</code> instance in <code>Control.Applicative</code>:</p>\n\n<pre><code>go pred = foldr (&lt;|&gt;) empty . map (V.find pred)\n-- Or using foldl if you really want to\n</code></pre>\n\n<p>There really are many ways to solve this problem.</p>\n"}, {"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1428453855, "post_id": 29501092, "comment_id": 47165489, "body": "For those who, like me, are confused by the magic <code>ala&#39;</code> function, this is just <code>\\f -&gt; getFirst . F.foldMap (First . f)</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1428439937, "creation_date": 1428439937, "answer_id": 29501092, "question_id": 29499035, "link": "https://stackoverflow.com/questions/29499035/non-recursive-way-to-search-an-infinite-list-of-vectors-in-haskell/29501092#29501092", "title": "Non-recursive way to search an infinite list of vectors in Haskell?", "body": "<p>Using the <a href=\"http://hackage.haskell.org/package/newtype-0.2/docs/Control-Newtype.html\" rel=\"noreferrer\">newtype</a> package, this can be conveniently written</p>\n\n<pre><code>import Control.Newtype\nimport Data.Monoid\nimport Data.Foldable\n\ngo :: Foldable f =&gt; (a -&gt; Maybe b) -&gt; f a -&gt; Maybe b\ngo = ala' First foldMap\n</code></pre>\n\n<p>which I think nicely exposes the structure you are using in this computation.</p>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1428439937, "creation_date": 1428432733, "question_id": 29499035, "link": "https://stackoverflow.com/questions/29499035/non-recursive-way-to-search-an-infinite-list-of-vectors-in-haskell", "title": "Non-recursive way to search an infinite list of vectors in Haskell?", "body": "<p>I've got a data structure like the following:</p>\n\n<pre><code>import qualified Data.Vector.Unboxed as V\nmylist :: [V.Vector (Int, Int)]\n</code></pre>\n\n<p>I need to search through this list of vectors to look for an element satisfying a predicate. The algorithm guarantees that I'll find the element. </p>\n\n<p>So far I've got something like this:</p>\n\n<pre><code>go []     = error \"Could not find\"\ngo pred (p:ps) =\n  case V.find pred p of\n    Just a  -&gt; a\n    Nothing -&gt; go ps\n</code></pre>\n\n<p>It's simple, but I'd like to get rid of the recursion. Is there a construct that lets me \"compose away\" the recursion?</p>\n"}, {"tags": ["haskell", "for-loop"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 4, "creation_date": 1428427040, "post_id": 29497076, "comment_id": 47153402, "body": "So, you want a function of type <code>[something] -&gt; IO ()</code>, essentially? That would be <code>mapM_ print</code> after <code>import Control.Monad</code>."}], "answers": [{"comments": [{"owner": {"reputation": 777, "user_id": 3900056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45ff0756018a3a41955b5d29e3ab63fb?s=128&d=identicon&r=PG&f=1", "display_name": "zcleghern", "link": "https://stackoverflow.com/users/3900056/zcleghern"}, "edited": false, "score": 0, "creation_date": 1428427094, "post_id": 29497267, "comment_id": 47153436, "body": "Look at the type of putStrLn and the type of items in your list (which should have 25 items)."}, {"owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "edited": false, "score": 0, "creation_date": 1428427095, "post_id": 29497267, "comment_id": 47153437, "body": "<code>putStrLn</code> uses IO, which makes it more complicated. But you don&#39;t have to get that into the map - you can create complete string, and then output it using putStrLn later."}], "tags": [], "owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "is_accepted": false, "score": 2, "last_activity_date": 1428427838, "last_edit_date": 1428427838, "creation_date": 1428426804, "answer_id": 29497267, "question_id": 29497076, "link": "https://stackoverflow.com/questions/29497076/how-can-i-execute-io-commands-repeatedly-in-haskell/29497267#29497267", "title": "How can I execute IO commands repeatedly in Haskell?", "body": "<p>You're still thinking in a procedural fashion. Try to think in terms of lists, rather than in terms of loops.</p>\n\n<p>Then what you want is a list like this: <code>[1,f(1),2,f(2),3,f(3)...,n,f(n)]</code></p>\n\n<p>This is where <code>map</code> enters the picture. If you had a function <code>f</code> and wanted to apply it to a list <code>[1,2,3...,n]</code>, you use <code>map f [1..n]</code>.</p>\n\n<p>What you want is a function that takes a number <code>i</code> and applies a function <code>f</code> to it,then responds with <code>[i,f(i)]</code> or perhaps a tuple <code>(i,f(i))</code>.\nSo you create this function and map it to your list. </p>\n\n<p>And, of course, you need to create that initial list to operate on - that list from [1..n]. </p>\n\n<p>Another approach is to use a list comprehension:</p>\n\n<pre><code>forloop n = [(x,f x)|x &lt;- [1..n] ]\n</code></pre>\n\n<p>(Note: I have no Haskell compiler with me right now, so I need to verify that last part later. I believe it should work as presented).</p>\n"}, {"comments": [{"owner": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "edited": false, "score": 1, "creation_date": 1428427347, "post_id": 29497344, "comment_id": 47153591, "body": "<code>blabla = (: []) . (&quot;blabla&quot; !!)</code> ?"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "edited": false, "score": 1, "creation_date": 1428427555, "post_id": 29497344, "comment_id": 47153709, "body": "@Mokosha <code>blabla x = blabla x</code>."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1428429245, "post_id": 29497344, "comment_id": 47154626, "body": "&quot;I would advice you to stay away from such imperative style code&quot; - Add an alternative that you consider better and you&#39;ll have my vote for this answer."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1428433955, "post_id": 29497344, "comment_id": 47157358, "body": "I would make this code even less imperative: <code>putStrLn $ unlines $ map (\\x -&gt; concat[show x, &quot;: &quot;, f x]) [1..25]</code>. Sometimes you need to print a string lazily, line by line, because it is very long or even infinite, but for a short string, it is usually nice to build the entire thing at once and print it."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1428445443, "post_id": 29497344, "comment_id": 47162900, "body": "@user2407038 Your version is also lazy and works perfectly for an infinite list. BTW both <code>putStrLn</code> and <code>unlines</code> add a final newline."}], "tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": true, "score": 14, "last_activity_date": 1428430979, "last_edit_date": 1428430979, "creation_date": 1428427102, "answer_id": 29497344, "question_id": 29497076, "link": "https://stackoverflow.com/questions/29497076/how-can-i-execute-io-commands-repeatedly-in-haskell/29497344#29497344", "title": "How can I execute IO commands repeatedly in Haskell?", "body": "<p>There's a <a href=\"https://www.haskell.org/hoogle/?hoogle=forM_\"><code>forM_</code></a> function in the <code>Control.Monad</code> module which is similar to a for loop in imperative programming languages:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Control.Monad (forM_)\n\nblabla :: Int -&gt; String\nblabla = show\n\nmain = forM_ [1..25] $ \\i -&gt; do\n    putStr   (show i)\n    putStr   \": \"\n    putStrLn (blabla i)\n</code></pre>\n\n<p>However, I would advise you to stay away from such imperative style code. For example, the same code can be written more succinctly as:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Control.Monad (mapM_)\n\nblabla :: Int -&gt; String\nblabla = show\n\nmain = mapM_ (\\i -&gt; putStrLn $ show i ++ \": \" ++ blabla i) [1..25]\n</code></pre>\n\n<p>Hope that helps.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1428427831, "post_id": 29497345, "comment_id": 47153845, "body": "That surely works, and there&#39;s nothing wrong with using explicit recursion as you just did. You will find that common patterns like the above one have their place in the standard library. For instance <code>main = do mapM_ (putStrLn . blabla) [0..25]; putStrLn &quot;That&#39;s all, folks!&quot;</code> is equivalent to the above."}], "tags": [], "owner": {"reputation": 1216, "user_id": 2682133, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/e6O9c.jpg?s=128&g=1", "display_name": "Hennes", "link": "https://stackoverflow.com/users/2682133/hennes"}, "is_accepted": false, "score": 0, "last_activity_date": 1428427109, "creation_date": 1428427109, "answer_id": 29497345, "question_id": 29497076, "link": "https://stackoverflow.com/questions/29497076/how-can-i-execute-io-commands-repeatedly-in-haskell/29497345#29497345", "title": "How can I execute IO commands repeatedly in Haskell?", "body": "<p>I think, I got it by myself:</p>\n\n<pre><code>blablaOutput :: [Int] -&gt; IO()\nblablaOutput (x:xs) = do \n  putStrLn (blabla x)\n  blablaOutput xs\nblablaOutput _ = putStrLn \"That's all, folks!\"  \n\nmain = blablaOutput [0..25]\n</code></pre>\n\n<p>Certainly not very functional in means of functional programming, but it works.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1428428268, "post_id": 29497638, "comment_id": 47154086, "body": "For this specific case, I think this is the best approach because it clearly separates computation and I/O."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1428428538, "post_id": 29497638, "comment_id": 47154223, "body": "Yes, now you are thinking in a functional style. BTW, you could do truncate this into one line <code>main = mapM_ (\\x -&gt; putStrLn $ show x ++ &quot;: &quot; ++ blabla x) [0..25]</code>."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1428445573, "post_id": 29497638, "comment_id": 47162950, "body": "As I mentioned to @user2407038, both <code>putStrLn</code> and <code>unlines</code> add a final newline."}], "tags": [], "owner": {"reputation": 1216, "user_id": 2682133, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/e6O9c.jpg?s=128&g=1", "display_name": "Hennes", "link": "https://stackoverflow.com/users/2682133/hennes"}, "is_accepted": false, "score": 7, "last_activity_date": 1428428086, "creation_date": 1428428086, "answer_id": 29497638, "question_id": 29497076, "link": "https://stackoverflow.com/questions/29497076/how-can-i-execute-io-commands-repeatedly-in-haskell/29497638#29497638", "title": "How can I execute IO commands repeatedly in Haskell?", "body": "<p>Upon drinking a cup of tea I got the best result, I think:</p>\n\n<pre><code>blablaResults = map (\\x -&gt; show x ++ \":\" ++ blabla x) [0..25]\n\nmain = putStrLn $ unlines blablaResults\n</code></pre>\n"}], "owner": {"reputation": 1216, "user_id": 2682133, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/e6O9c.jpg?s=128&g=1", "display_name": "Hennes", "link": "https://stackoverflow.com/users/2682133/hennes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "accepted_answer_id": 29497344, "answer_count": 4, "score": 10, "last_activity_date": 1429466501, "creation_date": 1428426101, "last_edit_date": 1429466501, "question_id": 29497076, "link": "https://stackoverflow.com/questions/29497076/how-can-i-execute-io-commands-repeatedly-in-haskell", "title": "How can I execute IO commands repeatedly in Haskell?", "body": "<p>I have a function <code>blabla</code> in Haskell which takes an Int and returns a string:</p>\n\n<pre><code>blabla :: Int -&gt; [Char]\n</code></pre>\n\n<p>I want to run that method repeatedly in a for-loop, something like this:</p>\n\n<pre><code>for i := 1 to 25 do begin\n    write(i);\n    write(\": \");\n    writeln(blabla(i));\nend;\n</code></pre>\n\n<p>Does haskell have a for loop feature?</p>\n"}, {"tags": ["haskell", "uml", "associations", "class-diagram"], "comments": [{"owner": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 0, "creation_date": 1428422917, "post_id": 29495447, "comment_id": 47151078, "body": "Your problem may be warmly received at <a href=\"http://cstheory.stackexchange.com\">cstheory.stackexchange.com</a> or maybe deciphered here if you add the <a href=\"http://stackoverflow.com/questions/tagged/haskell\">haskell</a> tag as smart-guy attention attractor"}, {"owner": {"reputation": 1703, "user_id": 2757620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/wFg9k.jpg?s=128&g=1", "display_name": "qartal", "link": "https://stackoverflow.com/users/2757620/qartal"}, "reply_to_user": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 0, "creation_date": 1428424331, "post_id": 29495447, "comment_id": 47151876, "body": "Thanks for your suggestion, but can I add tags here just for attracting  another communities attention when the question is not directly related. It would be good, but I am worried that I would compromise the stackoverflow rules by doing so. wouldn&#39;t I?"}, {"owner": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 1, "creation_date": 1428429169, "post_id": 29495447, "comment_id": 47154583, "body": "in my eyes you&#39;ve already compromised the Stack Overflow community and your questions is far from comprehensible practical coding problem. Can you simplify/translate it for non-haskell guys like me.. <code>UML</code> talks pictures. Can you translate your <code>A ---r1 {bag} [1..2]--&gt; B</code> code into <code>UML</code> picture? At the other side of <code>UML</code> is some <code>code</code>, imagine <code>C#</code> code. Can you translate your <code>a.r1={(b1,1),(b1,2),(b2,1)}</code> into <code>C#</code> code example? It seems that you have doubt which one of 2 possible interpretations is correct. Can you show the 2 cases side by side clearly? (picture+code)*2?"}, {"owner": {"reputation": 1703, "user_id": 2757620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/wFg9k.jpg?s=128&g=1", "display_name": "qartal", "link": "https://stackoverflow.com/users/2757620/qartal"}, "reply_to_user": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 1, "creation_date": 1428477437, "post_id": 29495447, "comment_id": 47173015, "body": "I think @peter kindly did what you asked. Now the problem is that if I want to implement the picture in his answer, and I have a collection of type bag, putting in this collection two b1 and one b2, violates the constraints or not. There is two interpretation as I wrote in the question: 1) it violates because collection contains three elements. 2) does not violate because there is only two references to B instances in the collection."}], "answers": [{"comments": [{"owner": {"reputation": 1703, "user_id": 2757620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/wFg9k.jpg?s=128&g=1", "display_name": "qartal", "link": "https://stackoverflow.com/users/2757620/qartal"}, "edited": false, "score": 0, "creation_date": 1428476311, "post_id": 29503181, "comment_id": 47172366, "body": "You wrote my class model &quot;means that A has reference to one to two B instances&quot;. In my provided instance, A has references to exactly two distinct B&#39;s, but three bag elements. In fact, the bag itself contains two instances of B (i.e., b1,b2) such that whose three elements are built out of these two instances. Actually, confusion still stays on the board. p.s. BTW, Is there any handy tool to draws quickly the useful picture you included?"}, {"owner": {"reputation": 8064, "user_id": 2007760, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/da33a5de07879db5ea0d55be9f875932?s=128&d=identicon&r=PG", "display_name": "Peter Uhnak", "link": "https://stackoverflow.com/users/2007760/peter-uhnak"}, "reply_to_user": {"reputation": 1703, "user_id": 2757620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/wFg9k.jpg?s=128&g=1", "display_name": "qartal", "link": "https://stackoverflow.com/users/2757620/qartal"}, "edited": false, "score": 2, "creation_date": 1428481053, "post_id": 29503181, "comment_id": 47174961, "body": "Well you chose Bag, which is nonunique, that means that even the same element twice will count as two distinct elements; so A still has three distinct references. If you want not to distinguish the same B&#39;s then use Set instead (unique, onordered). I drew those in <a href=\"http://www.umlet.com/\" rel=\"nofollow noreferrer\">umlet.com</a> which is a great tool for quick sketching."}], "tags": [], "owner": {"reputation": 8064, "user_id": 2007760, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/da33a5de07879db5ea0d55be9f875932?s=128&d=identicon&r=PG", "display_name": "Peter Uhnak", "link": "https://stackoverflow.com/users/2007760/peter-uhnak"}, "is_accepted": true, "score": 3, "last_activity_date": 1428449296, "creation_date": 1428449296, "answer_id": 29503181, "question_id": 29495447, "link": "https://stackoverflow.com/questions/29495447/precise-semantic-of-annotated-associations-with-bag-and-multiplicity-bound-c/29503181#29503181", "title": "Precise semantic of annotated associations with { bag } and multiplicity bound constraints", "body": "<p>As stated in specs, Bag is unordered, nonunique collection.\nHowever this describes the relation between the elements you are pointing to.</p>\n\n<p>So your example can be expressed in either way:\n <img src=\"https://i.stack.imgur.com/s9yC2.png\" alt=\"not the bees\"></p>\n\n<p>This means that A has reference to <em>one</em> to <em>two</em> B instances, and those references are stored in a Bag (or any nonunique, unsorted collection; but that is implementation detail).</p>\n\n<p>To answer your question: no, because the Bag contains three instances of B, whilst the allowed maximum is two B's.</p>\n"}], "owner": {"reputation": 1703, "user_id": 2757620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/wFg9k.jpg?s=128&g=1", "display_name": "qartal", "link": "https://stackoverflow.com/users/2757620/qartal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 29503181, "answer_count": 1, "score": 0, "last_activity_date": 1428477957, "creation_date": 1428420937, "last_edit_date": 1495539868, "question_id": 29495447, "link": "https://stackoverflow.com/questions/29495447/precise-semantic-of-annotated-associations-with-bag-and-multiplicity-bound-c", "title": "Precise semantic of annotated associations with { bag } and multiplicity bound constraints", "body": "<p>Suppose I have   <code>A ---r1 {bag} [1..2]--&gt; B</code> in a UML class diagram (that is, r1 is an association from A to B and is annotated with {bag} and multiplicity [1..2]. </p>\n\n<p><strong>My Question:</strong> if a:A is an instance of A, is the following collection valid?</p>\n\n<blockquote>\n  <p>a.r1={(b1,1),(b1,2),(b2,1)}   //collection contains two copies of b1 and one b2</p>\n</blockquote>\n\n<p>In other words, multiplicity bounds (i.e., [1..2]) apply to the association when it is interpreted purely as r1:A --> B, or it applies to r1: A --> Bag(B)? In the former interpretation, the above collection is valid, since r1 contains at most two instances of B, but in the latter it is not, since r1 contains three elements of Bag(B)! which interpretation is correct? </p>\n\n<p>Multiplicity constraints in UML are explained in Chapter 7.5.3 of <a href=\"http://www.omg.org/spec/UML/2.5/Beta2/PDF/\" rel=\"nofollow noreferrer\">UML document</a> as I am referred to in <a href=\"https://stackoverflow.com/questions/28634616/ordered-bag-in-uml\">this question</a>. </p>\n\n<p>p.s.1: A similar question arises when we substitute {bag} with {seq}.</p>\n\n<p>p.s.2: I added haskell tag to get comment from large haskell community here as @xmojmr suggested. Thanks to @peter that nicely draw the pictures in his answer.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 187800, "user_id": 320615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65c80e12b6a33913538653f6d4ef1277?s=128&d=identicon&r=PG", "display_name": "Dogbert", "link": "https://stackoverflow.com/users/320615/dogbert"}, "edited": false, "score": 2, "creation_date": 1428413400, "post_id": 29492764, "comment_id": 47144687, "body": "Maybe <a href=\"https://ghc.haskell.org/trac/ghc/wiki/OverloadedLists\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/wiki/OverloadedLists</a>?"}, {"owner": {"reputation": 354, "user_id": 1456428, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Vl2tY.jpg?s=128&g=1", "display_name": "joschuck", "link": "https://stackoverflow.com/users/1456428/joschuck"}, "reply_to_user": {"reputation": 187800, "user_id": 320615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65c80e12b6a33913538653f6d4ef1277?s=128&d=identicon&r=PG", "display_name": "Dogbert", "link": "https://stackoverflow.com/users/320615/dogbert"}, "edited": false, "score": 0, "creation_date": 1428414023, "post_id": 29492764, "comment_id": 47144988, "body": "How exactly could i implement this? My GHC version is 7.6.3"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1428414839, "post_id": 29492764, "comment_id": 47145504, "body": "Are you sure this <code>Map</code> is actually <code>Data.Map.Map</code>?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 7, "creation_date": 1428414962, "post_id": 29492764, "comment_id": 47145585, "body": "@joschuck The simple answer is that without GHC 7.8 you can&#39;t use <code>OverloadedLists</code>.  Ensure that the <code>Map</code> type shown here is actually <code>Data.Map.Map</code> and not a locally defined type alias of <code>type Map k v = [(k, v)]</code>, as is often the case with example code."}, {"owner": {"reputation": 615, "user_id": 2008797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19kgV.png?s=128&g=1", "display_name": "dredozubov", "link": "https://stackoverflow.com/users/2008797/dredozubov"}, "edited": false, "score": 1, "creation_date": 1428418643, "post_id": 29492764, "comment_id": 47148185, "body": "You should provide the error message and complete code listing, so others would be able to provide clear and concise answer. It&#39;s possible to create Map with a code like this: <code>M.fromList [(&#39;a&#39;, &quot;first&quot;), (&#39;b&#39;, &quot;second&quot;)]</code>, where M is Data.Map imported qualified. Syntax you&#39;re using in a second code block is wrong, because haskell function application looks like <code>f x</code>, not <code>f(x)</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 615, "user_id": 2008797, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19kgV.png?s=128&g=1", "display_name": "dredozubov", "link": "https://stackoverflow.com/users/2008797/dredozubov"}, "edited": false, "score": 0, "creation_date": 1428419308, "post_id": 29492764, "comment_id": 47148696, "body": "@dredozubov, extra parentheses are ugly, but not really wrong."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 6, "creation_date": 1428419520, "post_id": 29492764, "comment_id": 47148858, "body": "@joschuck leftaroundabout isn&#39;t asking whether you have <code>Data.Map</code>. He is asking whether, <i>in the example code</i>, <code>Map</code> is referring to <code>Data.Map.Map</code>, which is not a property of your system. It could be a type alias like <code>type Map k v = [(k, v)]</code>, defined earlier in the example, or something similar."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1428433075, "post_id": 29492764, "comment_id": 47156908, "body": "@joschuck That wasn&#39;t the question either. The question was if you&#39;re sure that <code>Map</code> means <code>Data.Map.Map</code> <i>in whatever code you got this snippet from</i>."}, {"owner": {"reputation": 354, "user_id": 1456428, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Vl2tY.jpg?s=128&g=1", "display_name": "joschuck", "link": "https://stackoverflow.com/users/1456428/joschuck"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1428433561, "post_id": 29492764, "comment_id": 47157164, "body": "@Cubic Yes, im 100% sure about that."}, {"owner": {"reputation": 3611, "user_id": 1029158, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YmuXk.jpg?s=128&g=1", "display_name": "DiegoNolan", "link": "https://stackoverflow.com/users/1029158/diegonolan"}, "edited": false, "score": 0, "creation_date": 1428439348, "post_id": 29492764, "comment_id": 47160299, "body": "Slightly related. There is a package that defines a syntax for creating maps <a href=\"https://hackage.haskell.org/package/map-syntax\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/map-syntax</a>"}], "owner": {"reputation": 354, "user_id": 1456428, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Vl2tY.jpg?s=128&g=1", "display_name": "joschuck", "link": "https://stackoverflow.com/users/1456428/joschuck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 212, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1428413101, "creation_date": 1428413101, "question_id": 29492764, "link": "https://stackoverflow.com/questions/29492764/implicit-way-to-create-a-map-in-haskell", "title": "Implicit way to create a Map in Haskell", "body": "<p>I stumpled upon this example for creating a Map. But I am not able to compile / reproduce it.</p>\n\n<pre><code>data State r = S (Maybe r) (Map Char (State r))\ndata NumberSystem = Zero | Bin | Dec | Oct\nautomata :: State NumberSystem\nautomata = s where\n    s   = S Nothing     ([(d,s10) | d &lt;- ['1'..'9']] ++ [('0',s0)])\n    s0  = S (Just Zero) ([('b',s2)] ++ [(d,s8) | d &lt;- ['0'..'7']])\n    s2  = S (Just Bin)  ([('0',s2),('1',s2)])\n    ...\n</code></pre>\n\n<p>I used fromList to create it.</p>\n\n<pre><code>s   = S Nothing     (fromList([(d,s10) | d &lt;- ['1'..'9']] ++ [('0',s0)]))\ns0  = S (Just Zero) (fromList([('b',s2)] ++ [(d,s8) | d &lt;- ['0'..'7']]))\n</code></pre>\n\n<p>So is there a implicit version for creating Maps in Haskell without using fromList in a way that the example above will compile?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1428407190, "post_id": 29490798, "comment_id": 47140579, "body": "How are we supposed to know where your implementation goes wrong when you don&#39;t post its source code?"}, {"owner": {"reputation": 51, "user_id": 3475814, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c4b7efc253f54f5bdbd5118a608274a0?s=128&d=identicon&r=PG&f=1", "display_name": "DiVeRsi0n", "link": "https://stackoverflow.com/users/3475814/diversi0n"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1428407912, "post_id": 29490798, "comment_id": 47141028, "body": "You are right, post edited. I didnt post the code because I didnt write something to handle infinite lists..."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1428408129, "post_id": 29490798, "comment_id": 47141186, "body": "<code>function</code> is a little weird; we usually index lists starting at <code>0</code> in Haskell rather than starting at <code>1</code>. That said, you can easily define it in terms of prelude functions <code>drop</code> and <code>take</code> which both operate correctly on infinite lists. <code>function start end = drop (start - 1) . take end</code>."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1428408627, "post_id": 29490798, "comment_id": 47141508, "body": "@Cirdec Almost, but in that case the example would be <code>[2,3,4,5,6]</code> if I am not mistaken."}], "answers": [{"comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1428408314, "post_id": 29490933, "comment_id": 47141311, "body": "A function with the type <code>Int-&gt;Int-&gt;[u]-&gt;[u]</code> can&#39;t be &quot;searching&quot; for its arguments in the list, since there&#39;s no way to compare a <code>u</code> to an <code>Int</code>. The integer arguments are described as being &quot;positions&quot; or indexes into the list."}, {"owner": {"reputation": 51, "user_id": 3475814, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c4b7efc253f54f5bdbd5118a608274a0?s=128&d=identicon&r=PG&f=1", "display_name": "DiVeRsi0n", "link": "https://stackoverflow.com/users/3475814/diversi0n"}, "edited": false, "score": 0, "creation_date": 1428409528, "post_id": 29490933, "comment_id": 47142108, "body": "Thanks for your answer, the code works but it couldnt handle a negative input. I added this and its okay now :  <code>|i&lt;0 = function 0 j list |otherwise = take (j - i + 1) (drop (i - 1) list)</code>"}], "tags": [], "owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "is_accepted": true, "score": 8, "last_activity_date": 1428424337, "last_edit_date": 1428424337, "creation_date": 1428407550, "answer_id": 29490933, "question_id": 29490798, "link": "https://stackoverflow.com/questions/29490798/code-doesnt-work-with-infinite-lists/29490933#29490933", "title": "Code doesnt work with infinite lists", "body": "<p>The problem with your implementation is the use of <code>length</code>. Using <code>length</code> with an infinite list as parameter is not a good idea because, well, the list in infinitely long.</p>\n\n<p>I would suggest altering the implementation to use other functions which can work on infinite lists, such as <code>drop</code> and <code>take</code>:</p>\n\n<pre><code>function :: Int -&gt; Int -&gt; [a] -&gt; [a]\nfunction i j list = take (i - j + 1) (drop (i - 1) list)\n</code></pre>\n\n<p>Or, pointfree:</p>\n\n<pre><code>function i j = take (j - i + 1) . drop (i - 1)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 3475814, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c4b7efc253f54f5bdbd5118a608274a0?s=128&d=identicon&r=PG&f=1", "display_name": "DiVeRsi0n", "link": "https://stackoverflow.com/users/3475814/diversi0n"}, "edited": false, "score": 0, "creation_date": 1428413057, "post_id": 29492526, "comment_id": 47144499, "body": "Of course, an infinite list doesn&#39;t have length. I already knew that my code wouldnt work for infinite lists. I just wanted to know a way to handle an infinite list as an input and return a correct result."}], "tags": [], "owner": {"reputation": 31, "user_id": 2579079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20ce791371fcc29edc4501aaf12c5484?s=128&d=identicon&r=PG", "display_name": "Jack", "link": "https://stackoverflow.com/users/2579079/jack"}, "is_accepted": false, "score": 1, "last_activity_date": 1428412401, "creation_date": 1428412401, "answer_id": 29492526, "question_id": 29490798, "link": "https://stackoverflow.com/questions/29490798/code-doesnt-work-with-infinite-lists/29492526#29492526", "title": "Code doesnt work with infinite lists", "body": "<p>How about: the length of an infinite list?\nI think that is not possible.</p>\n"}, {"tags": [], "owner": {"reputation": 18463, "user_id": 3189923, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5d3122866199817cdf56b96a788d406f?s=128&d=identicon&r=PG&f=1", "display_name": "elm", "link": "https://stackoverflow.com/users/3189923/elm"}, "is_accepted": false, "score": 0, "last_activity_date": 1428468084, "last_edit_date": 1428468084, "creation_date": 1428434095, "answer_id": 29499459, "question_id": 29490798, "link": "https://stackoverflow.com/questions/29490798/code-doesnt-work-with-infinite-lists/29499459#29499459", "title": "Code doesnt work with infinite lists", "body": "<p>An approach based in zipping with indexes and filtering out those not within the given range,</p>\n\n<pre><code>f :: Int -&gt; Int -&gt; [a] -&gt; [a]\nf i j = map (snd) . filter (\\v -&gt; fst v `elem` [i..j]) . zip [1..]\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 3475814, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c4b7efc253f54f5bdbd5118a608274a0?s=128&d=identicon&r=PG&f=1", "display_name": "DiVeRsi0n", "link": "https://stackoverflow.com/users/3475814/diversi0n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 29490933, "answer_count": 3, "score": 0, "last_activity_date": 1428468084, "creation_date": 1428407094, "last_edit_date": 1428407830, "question_id": 29490798, "link": "https://stackoverflow.com/questions/29490798/code-doesnt-work-with-infinite-lists", "title": "Code doesnt work with infinite lists", "body": "<p>I'm currently working on function which takes 2 integers and a list as arguments and returns a list with the elements of the first list which are at the positions between these 2 integers (function :: Int->Int->[u]->[u]). For example:</p>\n\n<pre><code>&gt;function 2 5 [1..10]\n</code></pre>\n\n<p>returns </p>\n\n<pre><code>[2,3,4,5]\n</code></pre>\n\n<p>The above example is working with my current code...but if I insert an infinite list like [0..] it returns an \"ERROR - Garbage collection fails to reclaim sufficient space\". Any suggestions? \nHere is the code</p>\n\n<pre><code>function :: Int-&gt;Int-&gt;[u]-&gt;[u]                                                       \nfunction i j s\n    |i&lt;0 = function 0 j s\n    |j&lt; length s = function i j (init s) \n    |j-i&lt; (length s)-1 = function i j (tail s)\n    |otherwise = s\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28466, "user_id": 102008, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/eeae0562ab53da4f56ed31d1d5650bde?s=128&d=identicon&r=PG", "display_name": "user102008", "link": "https://stackoverflow.com/users/102008/user102008"}, "edited": false, "score": 0, "creation_date": 1428446010, "post_id": 29489905, "comment_id": 47163102, "body": "It&#39;ll be obvious once you realize that <code>($)</code> is the same as <code>id</code>, just with a more specific type."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 12, "last_activity_date": 1428404934, "creation_date": 1428404934, "answer_id": 29490137, "question_id": 29489905, "link": "https://stackoverflow.com/questions/29489905/how-does-flip-id-work/29490137#29490137", "title": "How does `flip id` work?", "body": "<p>The point is that</p>\n\n<pre><code>id :: a -&gt; a\n</code></pre>\n\n<p>for <em>any</em> type <code>a</code>, including function types. That is, we can choose <code>a = (b -&gt; c)</code> and obtain</p>\n\n<pre><code>id :: (b -&gt; c) -&gt; (b -&gt; c)\n</code></pre>\n\n<p>which, since <code>-&gt;</code> associates to the right, is typically written as</p>\n\n<pre><code>id :: (b -&gt; c) -&gt; b -&gt; c\n</code></pre>\n\n<p>The above can be interpreted as a function taking two arguments: the first of type <code>b -&gt; c</code> and the second of type <code>b</code>. So we can <code>flip</code> it.</p>\n"}, {"tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": false, "score": 2, "last_activity_date": 1428404945, "creation_date": 1428404945, "answer_id": 29490142, "question_id": 29489905, "link": "https://stackoverflow.com/questions/29489905/how-does-flip-id-work/29490142#29490142", "title": "How does `flip id` work?", "body": "<p>The <code>a</code>s in the type of <code>id</code> can match <em>any</em> type, in particular, <code>(b-&gt;c)</code>.</p>\n\n<pre><code>Prelude&gt; :t id :: (b -&gt; c) -&gt; (b -&gt; c)\nid :: (b -&gt; c) -&gt; (b -&gt; c) :: (b -&gt; c) -&gt; (b -&gt; c)\n</code></pre>\n\n<p>The <code>-&gt;</code> is right-associative, so we can drop the rightmost set of parens</p>\n\n<pre><code>Prelude&gt; :t id :: (b -&gt; c) -&gt; b -&gt; c\nid :: (b -&gt; c) -&gt; b -&gt; c :: (b -&gt; c) -&gt; b -&gt; c\n</code></pre>\n\n<p>Making id into a two-argument function.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "closed_date": 1428405151, "answer_count": 2, "score": 2, "last_activity_date": 1428404945, "creation_date": 1428404252, "question_id": 29489905, "link": "https://stackoverflow.com/questions/29489905/how-does-flip-id-work", "closed_reason": "Duplicate", "title": "How does `flip id` work?", "body": "<p>Why is <code>flip id</code> accepted as valid expression? Shouldn't it fail at type check of <code>a</code> against <code>b -&gt; c</code>?</p>\n\n<pre><code>Prelude&gt; :t flip\nflip :: (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c\nPrelude&gt; :t id\nid :: a -&gt; a\nPrelude&gt; :t flip id\nflip id :: b -&gt; (b -&gt; c) -&gt; c\n</code></pre>\n"}, {"tags": ["arrays", "algorithm", "list", "haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428403360, "post_id": 29489192, "comment_id": 47138261, "body": "Beware of <code>getperm [[]]</code>: this applies only to a list of length one, containing an empty list. Chances are this is not what you intended."}, {"owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "edited": false, "score": 0, "creation_date": 1428403685, "post_id": 29489192, "comment_id": 47138471, "body": "What is your question?"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 3037801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f61e6cb2eeecd5447294488f81c5973?s=128&d=identicon&r=PG&f=1", "display_name": "HopefulSplash", "link": "https://stackoverflow.com/users/3037801/hopefulsplash"}, "edited": false, "score": 0, "creation_date": 1428406211, "post_id": 29489957, "comment_id": 47140006, "body": "thanks man i just look at the zip function and i totally understand now, i have done the functions for the sums and stuff but thanks for clarifying it for me. PS your a life saver i can now implement NN and RNN using the matrix look upthanks"}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 3, "last_activity_date": 1428404385, "creation_date": 1428404385, "answer_id": 29489957, "question_id": 29489192, "link": "https://stackoverflow.com/questions/29489192/accessing-values-in-matrix-haskell-newbie/29489957#29489957", "title": "Accessing Values In Matrix (Haskell Newbie)", "body": "<p>Given a permutation, for example <code>[3, 2, 7, 5, 4, 6, 0, 1]</code> you can compute all of the legs by <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:zip\" rel=\"nofollow\"><code>zip</code></a>ping it with its own <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:tail\" rel=\"nofollow\"><code>tail</code></a>.</p>\n\n<pre><code>zip [3, 2, 7, 5, 4, 6, 0, 1]\n    (tail [3, 2, 7, 5, 4, 6, 0, 1])\n\nzip [3, 2, 7, 5, 4, 6, 0, 1]\n    [2, 7, 5, 4, 6, 0, 1]\n\n[(3,2),(2,7),(7,5),(5,4),(4,6),(6,0),(0,1)]\n</code></pre>\n\n<p>These are the indexes into the distance matrix for the cost of traveling between two points. If we look these up in the <code>city_Distance_Matrix</code> using the list indexing function <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:-33--33-\" rel=\"nofollow\"><code>!!</code></a> we get the cost for each leg</p>\n\n<pre><code>map (\\(c0, c1) -&gt; city_Distance_Matrix !! c0 !! c1)\n    [(3,2),(2,7),(7,5),(5,4),(4,6),(6,0),(0,1)]\n\n    [97.4, 71.6, 111.0,138.0,85.2 ,86.3 ,129.0]\n</code></pre>\n\n<p>If we total these, we get the total cost for traveling the legs of this permutation.</p>\n\n<pre><code>sum [97.4, 71.6, 111.0,138.0,85.2 ,86.3 ,129.0] = 718.5\n</code></pre>\n\n<p>Putting this all together, we can define a function that computes the total length of all the legs of a permutation of the cities. We can simplify the function by using <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:zipWith\" rel=\"nofollow\"><code>zipWith</code></a> which is a combination of <code>zip</code> and <code>map</code>.</p>\n\n<pre><code>totalLength :: [Int] -&gt; Double\ntotalLength cities = sum $ zipWith (\\c0 c1 -&gt; city_Distance_Matrix !! c0 !! c1) cities (tail cities)\n</code></pre>\n\n<p>You should be able to use this to find the permutation whose <code>totalLength</code> is minimal.</p>\n"}], "owner": {"reputation": 29, "user_id": 3037801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f61e6cb2eeecd5447294488f81c5973?s=128&d=identicon&r=PG&f=1", "display_name": "HopefulSplash", "link": "https://stackoverflow.com/users/3037801/hopefulsplash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 29489957, "answer_count": 1, "score": 0, "last_activity_date": 1428655369, "creation_date": 1428401871, "last_edit_date": 1428655369, "question_id": 29489192, "link": "https://stackoverflow.com/questions/29489192/accessing-values-in-matrix-haskell-newbie", "title": "Accessing Values In Matrix (Haskell Newbie)", "body": "<p>i am trying to do the equvilant of this in haskell bascially </p>\n\n<pre><code>for (int i = 0; i &lt; city_Permutation_Route.length - 1; i++) {\n        route_Distance = route_Distance + city_Distance_Matrix[city_Permutation_Route[i]][city_Permutation_Route[i + 1]];\n\n    }\n</code></pre>\n\n<p>there i get the weight of each route, compare it against each of the others so that i print out the route with the lowest weighted route as follows</p>\n\n<p>Route Weight = 453.4\nRoute = 0,1,2,3,4,5,6,7,8</p>\n\n<p>i have functions to get the total route and all the other data but do not understand how to get values from the matrix</p>\n\n<p>Question: How do i do this in haskell</p>\n\n<p>i want to be able to get the values from my distance matrix using the permutation values as the index to it</p>\n"}, {"tags": ["haskell", "variadic-functions", "continuations"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1428397962, "post_id": 29487773, "comment_id": 47134990, "body": "Well, what type is <code>adder</code> supposed to be? Apparently you want the type to depend on the length of the list. That&#39;d be a <a href=\"https://en.wikipedia.org/wiki/Dependent_type\" rel=\"nofollow noreferrer\">dependent type</a>. Haskell is not (<a href=\"http://stackoverflow.com/questions/12961651/why-not-be-dependently-typed/13241158#13241158\">quite</a>) a dependently-typed language, so this isn&#39;t possible. What could work is to decide the type according to the arguments you give, and crash at runtime when this doesn&#39;t match the list... but that&#39;s not exactly Haskell idiomatic."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1428399770, "post_id": 29487773, "comment_id": 47136142, "body": "Not with regular lists. With GADT-y lists you can likely achieve something similar e.g. as in <a href=\"http://stackoverflow.com/a/25422805/3234959\">stackoverflow.com/a/25422805/3234959</a>"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1428419323, "post_id": 29487773, "comment_id": 47148702, "body": "@leftaroundabout It may not be idiomatic, but that&#39;s essentially what <code>Text.Printf</code> does. Apart from the runtime checking this method also has the problem that it cannot handle polymorphic functions like <code>show</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1428430863, "post_id": 29487773, "comment_id": 47155615, "body": "Well, printf has one special application where this particular overloading mechanism is just spot on \u2013 if you want to quickly print multiple values of primitive (monomorphic), possible different types, in a single line. If it weren&#39;t for the requirement of different types, this would better be implemented with a simple list argument."}, {"owner": {"reputation": 3113, "user_id": 1193741, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be1d97fc244eaa2bfd3d7d64c1717f9f?s=128&d=identicon&r=PG", "display_name": "jtobin", "link": "https://stackoverflow.com/users/1193741/jtobin"}, "edited": false, "score": 0, "creation_date": 1428443198, "post_id": 29487773, "comment_id": 47162005, "body": "Presently in my real application I&#39;m passing a <code>Map</code> of labelled <code>Dynamic</code> arguments to a function, where the label indicates to which node of an AST to supply the value.  This works, but is obviously not ideal; in particular the manual wrapping of arguments via <code>toDyn</code> is a pain.  I&#39;m not 100% sure if the <code>printf</code>-style route is really better, but it could be."}], "answers": [{"tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 2, "last_activity_date": 1428475263, "last_edit_date": 1428475263, "creation_date": 1428474918, "answer_id": 29507566, "question_id": 29487773, "link": "https://stackoverflow.com/questions/29487773/how-to-build-a-typed-variadic-function-from-a-container/29507566#29507566", "title": "How to build a typed variadic function from a container?", "body": "<p>I'll ignore the HoleyMonoid library.</p>\n\n<p>We need natural numbers:</p>\n\n<pre><code>data Nat = Z | S Nat\n</code></pre>\n\n<p>A singleton to lift them to the type level:</p>\n\n<pre><code>data Natty :: Nat -&gt; * where\n    Zy :: Natty Z\n    Sy :: Natty n -&gt; Natty (S n)\n</code></pre>\n\n<p>The type of lists of existentials:</p>\n\n<pre><code>data Listy (b :: a -&gt; *) :: [a] -&gt; * where\n    Nilly :: Listy b '[]\n    Consy :: b x -&gt; Listy b xs -&gt; Listy b (x ': xs)\n</code></pre>\n\n<p>Then with</p>\n\n<pre><code>type Natties = Listy Natty\n</code></pre>\n\n<p>We can define</p>\n\n<pre><code>adder :: Natties ns -&gt; Adder ns\n</code></pre>\n\n<p>where <code>ns :: [Nat]</code>. The <code>Adder</code> type family is defined like this:</p>\n\n<pre><code>type family Adder (ns :: [Nat]) :: * where\n    Adder '[]       = Int\n    Adder (n ': ns) = If (NatEq n (S (S (S (S (S Z)))))) Int (Int -&gt; Adder ns)\n</code></pre>\n\n<p>I.e. fold a list of <code>Nat</code>s, prepending <code>(Int -&gt;)</code> for each number in the list, until <code>5</code> (in a <code>Nat</code> form) is encountered. It actually should be something like</p>\n\n<pre><code>if_then_else_ b x y = if b then x else y\n\ntype family Adder (ns :: [Nat]) :: * where\n    Adder '[]       = Int\n    Adder (n ': ns) = 'if_then_else_ (n '== 'fromInt 5) Int (Int -&gt; Adder ns)\n</code></pre>\n\n<p>but GHC throws at me some creepy errors, that I do not want to understand.</p>\n\n<p>The <code>NatEq</code> type family is defined in the obvious way:</p>\n\n<pre><code>type family NatEq n m :: Bool where\n    NatEq  Z     Z    = True\n    NatEq  Z    (S m) = False\n    NatEq (S n)  Z    = False\n    NatEq (S n) (S m) = NatEq n m\n</code></pre>\n\n<p>We need to compare <code>Natty</code>s at the value level. Two <code>Natty</code>s are equal, iff they indexed by the same number (that's why <code>Natty</code> is a singleton):</p>\n\n<pre><code>nattyEq :: Natty n -&gt; Natty m -&gt; Booly (NatEq n m)\nnattyEq  Zy     Zy    = Truly\nnattyEq  Zy    (Sy m) = Falsy\nnattyEq (Sy n)  Zy    = Falsy\nnattyEq (Sy n) (Sy m) = nattyEq n m\n</code></pre>\n\n<p>Where <code>Booly</code> is another singleton:</p>\n\n<pre><code>data Booly :: Bool -&gt; * where\n    Truly :: Booly True\n    Falsy :: Booly False\n</code></pre>\n\n<p>Finally, the definition of <code>adder</code>:</p>\n\n<pre><code>adder = go 0 where\n    go :: Int -&gt; Natties ns -&gt; Adder ns\n    go i  Nilly       = 0\n    go i (Consy n ns) = case nattyEq n (Sy (Sy (Sy (Sy (Sy Zy))))) of\n        Truly -&gt; i + 100\n        Falsy -&gt; \\a -&gt; go (i + a) ns\n</code></pre>\n\n<p>I.e. sum all arguments, until <code>5</code> (in a <code>Natty</code> form) is encountered, and add <code>100</code>. If there is no <code>5</code> in the list, then return <code>0</code>.</p>\n\n<p>Tests:</p>\n\n<pre><code>list = Consy Zy $ Consy (Sy Zy) $ Consy (Sy (Sy (Sy (Sy (Sy Zy))))) $ Consy Zy $ Nilly\n\nmain = do\n    print $ adder (Consy Zy $ Consy (Sy Zy) $ Nilly) 3 9 -- 0\n    print $ adder list 6 8                               -- 114\n    print $ adder (Consy (Sy (Sy Zy)) list) 1 2 3        -- 106\n</code></pre>\n\n<p>The <a href=\"https://github.com/effectfully/random-stuff/blob/master/stuff/adder.hs\" rel=\"nofollow\">code</a>.</p>\n"}], "owner": {"reputation": 3113, "user_id": 1193741, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be1d97fc244eaa2bfd3d7d64c1717f9f?s=128&d=identicon&r=PG", "display_name": "jtobin", "link": "https://stackoverflow.com/users/1193741/jtobin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 29507566, "answer_count": 1, "score": 4, "last_activity_date": 1428475263, "creation_date": 1428397539, "question_id": 29487773, "link": "https://stackoverflow.com/questions/29487773/how-to-build-a-typed-variadic-function-from-a-container", "title": "How to build a typed variadic function from a container?", "body": "<p>Consider the lovely little <a href=\"https://hackage.haskell.org/package/HoleyMonoid\" rel=\"nofollow\">HoleyMonoid</a> library, which lets you build typed variadic printf-like functions as follows:</p>\n\n<pre><code>{-# LANGUAGE NoMonomorphismRestriction #-}\n\nimport Control.Category\nimport Data.HoleyMonoid\nimport Prelude hiding ((.), id)\n\nfoo =\n    now \"hello \"\n  . later id\n  . now \", you are \"\n  . later show\n  . now \" years old\"\n\nbar = run foo\n\n-- &gt; bar \"alice\" 42\n-- \"hello alice, you are 42 years old\"\n\n-- &gt; bar 42 \"alice\"\n-- type error\n</code></pre>\n\n<p>Is there any way to examine a container (a list, an AST, etc.) and build such a function based on its contents?</p>\n\n<p>As a toy example, you can picture something like the following:</p>\n\n<pre><code>import Data.Monoid\n\nadder = go where\n  go [] = now (Sum 0)\n  go (x:xs)\n    | x == 5    = now 100 . go xs\n    | otherwise = later id . go xs\n\n-- hypothetical usage\n--\n-- &gt; :t run adder [1, 3, 5]\n-- Num a =&gt; Sum a -&gt; Sum a -&gt; Sum a\n--\n-- &gt; getSum $ run adder [1, 3, 5] 0 1\n-- 101\n</code></pre>\n\n<p><code>adder</code> fails the occurs check, but you can see what I'm shooting for.  The problem seems to be that it's difficult to hold the state of the computation anywhere, as i.e. <code>now 100</code> and <code>later id</code> are at different types.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1428391352, "post_id": 29485732, "comment_id": 47131496, "body": "You can pass it down to functions like <code>fdSeek</code>, unwrap it to get the underlying integer, or use it as ay other instance of <code>Num</code> and <code>Integral</code>"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1428391401, "post_id": 29485732, "comment_id": 47131528, "body": "@n.m.: I think OP&#39;s confused about <code>IO FileOffset</code>, not <code>FileOffset</code>."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1428391574, "post_id": 29485732, "comment_id": 47131623, "body": "I think one could generalize this question into &quot;What&#39;s <code>IO a</code>, and how can I use it?&quot;, but at that point the question gets (possibly) too broad and any potential answer results in another monad tutorial. @OP: Have a look at monads."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1428391739, "post_id": 29485732, "comment_id": 47131724, "body": "An example: <a href=\"http://ideone.com/AWqlJT\" rel=\"nofollow noreferrer\">ideone.com/AWqlJT</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1428391768, "post_id": 29485732, "comment_id": 47131742, "body": "@Zeta Ah, makes sense."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1428391980, "post_id": 29485732, "comment_id": 47131864, "body": "@Zeta Or rather, have a look at any number of IO tutorials that avoid the M-word."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1428392461, "post_id": 29485732, "comment_id": 47132107, "body": "<a href=\"http://learnyouahaskell.com/input-and-output\" rel=\"nofollow noreferrer\">learnyouahaskell.com/input-and-output</a> shows how to use the <code>String</code> inside <code>getLine :: IO String</code>. You can do the same for your <code>IO FileOffset</code>."}], "answers": [{"comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 2, "creation_date": 1428394455, "post_id": 29486466, "comment_id": 47133078, "body": "Pointing out that <code>unsafePerformIO</code> belongs to the foreign function interface is extremely helpful."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 10, "last_activity_date": 1428591310, "last_edit_date": 1495540244, "creation_date": 1428392949, "answer_id": 29486466, "question_id": 29485732, "link": "https://stackoverflow.com/questions/29485732/io-fileoffset-seems-pretty-much-useless/29486466#29486466", "title": "IO FileOffset seems pretty much useless", "body": "<p>As discussed in numerous other questions, like <a href=\"https://stackoverflow.com/questions/5948300/transforming-io-string-to-string\">this</a>, there is <em>never anything</em> you can do with an <code>IO a</code> value as such &ndash; except bind it in another <code>IO</code> computation, which eventually has to be invoked from either <code>main</code> or <code>ghci</code>. And this is not some stupid arbitrary restriction of Haskell, but reflects the fact that something like a file offset <em>can impossibly be known</em> without the program first going &ldquo;out into the world&rdquo;, doing the file operation, coming back with the result. In impure languages, this kind of thing just suddenly happens when you try to evaluate an IO &ldquo;function&rdquo;, but only because half a century of imperative programming has done it this way doesn't mean it's a good idea. In fact it's a cause for quite a lot of bugs in non-purely functional languages, but more importantly it makes it way harder to understand what some library function will actually do &ndash; in Haskell you only need to look at the signature, and when there's no <code>IO</code> in it, you can be utterly sure<sup>1</sup> it won't do any!</p>\n\n<p>Question remains: how do you actually get any &ldquo;real&rdquo; work done? Well, it's <a href=\"https://en.wikipedia.org/wiki/Monad_%28functional_programming%29\" rel=\"nofollow noreferrer\">pretty clever</a>. For beginners, it's probably helpful to keep to this guideline:</p>\n\n<ul>\n<li>An <code>IO</code> action always needs to be evaluated in a <code>do</code> block.</li>\n<li>To retrieve results from such actions, use the <code>val &lt;- action</code> syntax. This can stand anywhere in a <code>do</code> block except at the end. It is equivalent to what procedural languages write as <code>var val = action()</code> or similar. If <code>action</code> had a type <code>IO T</code>, then <code>val</code> will have simply type <code>T</code>!</li>\n<li>The value obtained this way can be used anywhere in the same <code>do</code> block below the line you've obtained it from. Quite like in procedural languages.</li>\n</ul>\n\n<p>So if your action was, say,</p>\n\n<pre><code>findOffsetOfFirstChar :: Handle -&gt; Char -&gt; IO FileOffset\n</code></pre>\n\n<p>you can use it like this:</p>\n\n<pre><code>printOffsetOfQ :: Handle -&gt; IO ()\nprintOffsetOfQ h = do\n   offset &lt;- findOffsetOfFirstChar h 'Q'\n   print offset\n</code></pre>\n\n<p>Later on you'll learn that many of these <code>do</code>s arent really necessary, but for the time being it's probably easiest to use them everywhere where there's <code>IO</code> going on.</p>\n\n<hr>\n\n<p><sup>1</sup><sub>Some people will now object that there is a thing called <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/System-IO-Unsafe.html#v:unsafePerformIO\" rel=\"nofollow noreferrer\"><code>unsafePerformIO</code></a> which allows you to do IO without the signature telling so, but apart from being, well, <em>unsafe</em>, this does not actually belong to the Haskell language but to its foreign function interface.</sub></p>\n"}], "owner": {"reputation": 2482, "user_id": 1129436, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/09511512293a4e31936309f2c6aee08e?s=128&d=identicon&r=PG", "display_name": "River Tam", "link": "https://stackoverflow.com/users/1129436/river-tam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 29486466, "answer_count": 1, "score": 1, "last_activity_date": 1428591310, "creation_date": 1428390259, "question_id": 29485732, "link": "https://stackoverflow.com/questions/29485732/io-fileoffset-seems-pretty-much-useless", "title": "IO FileOffset seems pretty much useless", "body": "<p>I'm sure it's not, but I've received the type <code>IO FileOffset</code> from <code>System.Posix</code> functions, and I can't figure out what I can do with it. It seems like it's just a rename of type <code>COFF</code>, which seems to be just a wrapper for <code>Int64</code>, and in fact when I get it in GHCI, I can see the number that the <code>IO FileOffset</code> corresponds to. However, I can't add it to anything else, print it out (except for through the interpreter), or even convert it to another type. It seems to be immune to <code>show</code>.</p>\n\n<p>How can I actually use this type? I'm new to Haskell so I'm sure I'm missing something fundamental about types and possibly the documentation.</p>\n"}, {"tags": ["haskell", "main"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 2, "creation_date": 1428385172, "post_id": 29484242, "comment_id": 47128946, "body": "See <a href=\"http://stackoverflow.com/q/26474892/102937\">here</a> for an example of a <code>main</code> function in Haskell.  I dispute the notion that your instructor is requiring you to complete the assignment without a <code>main</code> function, unless he specifically instructed you as such."}, {"owner": {"reputation": 91, "user_id": 4139651, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9c9762f575c8596d96db035c05be5681?s=128&d=identicon&r=PG&f=1", "display_name": "Exudes", "link": "https://stackoverflow.com/users/4139651/exudes"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1428385778, "post_id": 29484242, "comment_id": 47129132, "body": "Thanks a bunch, the print statement solved our problem."}, {"owner": {"reputation": 6364, "user_id": 288913, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/902e8cc4ad1dab7e25d3a2dc1eac732f?s=128&d=identicon&r=PG", "display_name": "Sarah", "link": "https://stackoverflow.com/users/288913/sarah"}, "edited": false, "score": 0, "creation_date": 1428387505, "post_id": 29484242, "comment_id": 47129751, "body": "<code>easy</code> is not an array, it is a list. :)"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428422128, "post_id": 29484242, "comment_id": 47150586, "body": "<code>main</code> must be <code>:: IO t</code>, and <code>[Int]</code> <i>is most definitely not</i> <code>IO [Int]</code> Just say <code>print $</code> at the start of the declaration. Also, does it need to be compiled?"}], "answers": [{"comments": [{"owner": {"reputation": 6500, "user_id": 57879, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/419a88bdf20aeaa3fb2de53ca0f4d836?s=128&d=identicon&r=PG", "display_name": "yatima2975", "link": "https://stackoverflow.com/users/57879/yatima2975"}, "edited": false, "score": 3, "creation_date": 1428400842, "post_id": 29484704, "comment_id": 47136759, "body": "<code>putStrLn . show</code> is the same as <code>print</code>, and the second solution only makes sure the types check; that is, <code>solution</code> is not evaluated at all!"}, {"owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "reply_to_user": {"reputation": 6500, "user_id": 57879, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/419a88bdf20aeaa3fb2de53ca0f4d836?s=128&d=identicon&r=PG", "display_name": "yatima2975", "link": "https://stackoverflow.com/users/57879/yatima2975"}, "edited": false, "score": 1, "creation_date": 1428403433, "post_id": 29484704, "comment_id": 47138306, "body": "@yatima2975 : True. I was not sure of your second point when I wrote the answer, so I did not mention it then. I will add it to the answer now."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1428434219, "post_id": 29484704, "comment_id": 47157488, "body": "If you want to evaluate the solution but not print it for whatever reason, use <code>main = Control.Exception.evaluate (solve easy) &gt;&gt; return ()</code>. Note this only  evaluates to whnf."}], "tags": [], "owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "is_accepted": true, "score": 7, "last_activity_date": 1428403559, "last_edit_date": 1428403559, "creation_date": 1428385976, "answer_id": 29484704, "question_id": 29484242, "link": "https://stackoverflow.com/questions/29484242/compiling-testing-haskell-without-a-main-function/29484704#29484704", "title": "Compiling / testing Haskell without a main function", "body": "<p>Firstly: the function <code>main</code> must have type <code>IO t</code> for some type <code>t</code>. When the program is executed, the computation defined by <code>main</code> is executed, and its result (of type <code>t</code>) is thrown away; <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch5.html#x11-980005\" rel=\"nofollow\">see here</a>.</p>\n\n<p>So, in particular, you cannot have the type of <code>main</code> as <code>[Int]</code> and have the compiler not complain.</p>\n\n<p>Depending on whether you want to see the results of solving the easy case or not, you can try one of the following:</p>\n\n<p>If you want to see the results: print them!</p>\n\n<pre><code>main :: IO ()\nmain = putStrLn $ show (solve easy)\n</code></pre>\n\n<p>If you are not interested in seeing the results, throw them away:</p>\n\n<pre><code>main :: IO ()\nmain = let solution = solve easy \n       in putStrLn \"\"\n</code></pre>\n\n<p>Edit: Note, however, that if you do the latter, then (as @yatima2975 mentions in a comment) the \"solve easy\" part will <em>not</em> be evaluated.</p>\n"}, {"tags": [], "owner": {"reputation": 6364, "user_id": 288913, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/902e8cc4ad1dab7e25d3a2dc1eac732f?s=128&d=identicon&r=PG", "display_name": "Sarah", "link": "https://stackoverflow.com/users/288913/sarah"}, "is_accepted": false, "score": 8, "last_activity_date": 1428387453, "creation_date": 1428387453, "answer_id": 29485011, "question_id": 29484242, "link": "https://stackoverflow.com/questions/29484242/compiling-testing-haskell-without-a-main-function/29485011#29485011", "title": "Compiling / testing Haskell without a main function", "body": "<p>Without writing a proper <code>main</code> with a correct type, as described by @G Philip, you can load your file in ghci by writing <code>ghci file.hs</code> in your terminal, or by invoking <code>:l file.hs</code> inside ghci.</p>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 5, "last_activity_date": 1428387903, "creation_date": 1428387903, "answer_id": 29485111, "question_id": 29484242, "link": "https://stackoverflow.com/questions/29484242/compiling-testing-haskell-without-a-main-function/29485111#29485111", "title": "Compiling / testing Haskell without a main function", "body": "<p>Just to add to the other answers:</p>\n\n<p>you don't need to write a <code>main</code> function and can still compile the file into a lib and the easiest way to do this is just giving a module name (that is not <code>Main</code>):</p>\n\n<pre><code>module MyCode where\n\nsolve :: ...\n</code></pre>\n\n<p>But of course compiling it might not make any sense anymore (as you will not be able to run it - and of course even if you have not specified what to output anyway).</p>\n\n<p>So in this case rather load the file into ghci:</p>\n\n<pre><code>ghci MyFile.hs\n</code></pre>\n\n<p>and then everytime you changed something in your code you can do <code>:r</code> inside ghci to reload it.</p>\n\n<p>Or even better set up your favorite editor (emacs and vi are quite easy but sublime text and some other works great too) to give you integrated ghci - <a href=\"http://www.mew.org/~kazu/proj/ghc-mod/en/preparation.html\" rel=\"noreferrer\">this explains</a> what you need to do to setup emacs with haskell-mode if you are interested.</p>\n"}, {"tags": [], "owner": {"reputation": 18463, "user_id": 3189923, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5d3122866199817cdf56b96a788d406f?s=128&d=identicon&r=PG&f=1", "display_name": "elm", "link": "https://stackoverflow.com/users/3189923/elm"}, "is_accepted": false, "score": 0, "last_activity_date": 1428425006, "creation_date": 1428425006, "answer_id": 29496748, "question_id": 29484242, "link": "https://stackoverflow.com/questions/29484242/compiling-testing-haskell-without-a-main-function/29496748#29496748", "title": "Compiling / testing Haskell without a main function", "body": "<p>Consider </p>\n\n<pre><code>main :: IO ()\nmain = do\n    let res = solve easy // easy is an array\n    return ()\n</code></pre>\n\n<p>where <code>return ()</code> yields a result of type Unit which conveys with the type signature of <code>main</code>. Note <code>solve easy</code> is bound to <code>res</code> which is not used further.</p>\n"}], "owner": {"reputation": 91, "user_id": 4139651, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9c9762f575c8596d96db035c05be5681?s=128&d=identicon&r=PG&f=1", "display_name": "Exudes", "link": "https://stackoverflow.com/users/4139651/exudes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2081, "favorite_count": 0, "accepted_answer_id": 29484704, "answer_count": 4, "score": 3, "last_activity_date": 1428425006, "creation_date": 1428383731, "last_edit_date": 1428424541, "question_id": 29484242, "link": "https://stackoverflow.com/questions/29484242/compiling-testing-haskell-without-a-main-function", "title": "Compiling / testing Haskell without a main function", "body": "<p>I'm working on an assignment in Haskell. However, the base code I am working with does not have a main function defined, and from the wording of the assignment I believe I am not expected to have to write any code outside of the solution to the problem. However, when I try to compile my code, I receive the error:</p>\n\n<pre><code>The IO function 'main' is not defined in module 'Main'\n</code></pre>\n\n<p>I assume this is because the function does not have a main function. However, when I try to write my own main function:</p>\n\n<pre><code>main :: IO ()\nmain = solve easy // easy is an array\n</code></pre>\n\n<p>I get the error:</p>\n\n<pre><code>Couldn't match expected type 'IO()' with actual type '[Int]'\n</code></pre>\n\n<p>The solve function's type is declared as follows:</p>\n\n<pre><code>solve :: [Int] -&gt; [Int]\n</code></pre>\n\n<p>So it takes an array and returns an array. What am I doing wrong in writing my <code>main</code> function? Even when I try changing the declaration of <code>main</code> to things like:</p>\n\n<pre><code>main :: [Int]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>main :: IO [Int]\n</code></pre>\n\n<p>I still can't get it to compile.</p>\n"}, {"tags": ["haskell", "functional-programming", "parentheses"], "comments": [{"owner": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 6, "creation_date": 1428384084, "post_id": 29484234, "comment_id": 47128606, "body": "It&#39;s ok to have few parenthesis"}, {"owner": {"reputation": 721, "user_id": 2512324, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f9d51819edf28a5befe8b255e51d95d7?s=128&d=identicon&r=PG", "display_name": "user2512324", "link": "https://stackoverflow.com/users/2512324/user2512324"}, "reply_to_user": {"reputation": 32405, "user_id": 553209, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HCxak.jpg?s=128&g=1", "display_name": "Ankur", "link": "https://stackoverflow.com/users/553209/ankur"}, "edited": false, "score": 0, "creation_date": 1428384382, "post_id": 29484234, "comment_id": 47128692, "body": "Isn&#39;t there any way to do it without parenthesis? Its all right if there isn&#39;t. I just wanted to know."}], "answers": [{"comments": [{"owner": {"reputation": 721, "user_id": 2512324, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f9d51819edf28a5befe8b255e51d95d7?s=128&d=identicon&r=PG", "display_name": "user2512324", "link": "https://stackoverflow.com/users/2512324/user2512324"}, "edited": false, "score": 0, "creation_date": 1428388291, "post_id": 29484417, "comment_id": 47130042, "body": "I&#39;ve writing another piece of code which I thought looked a bit ugly <code>(C.init . foldl addSource emptySource $ xs) &lt;&gt; C.pack &quot;&lt;head&gt;&quot;</code> . Can you suggest a way to remove this pair of parenthesis?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 721, "user_id": 2512324, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f9d51819edf28a5befe8b255e51d95d7?s=128&d=identicon&r=PG", "display_name": "user2512324", "link": "https://stackoverflow.com/users/2512324/user2512324"}, "edited": false, "score": 0, "creation_date": 1428393119, "post_id": 29484417, "comment_id": 47132436, "body": "@user2512324 I&#39;d use <code>mconcat [ C.init . foldl addSource emptySource $ xs , C.pack &quot;&lt;head&gt;&quot; ]</code> which has nicer brackets. Otherwise <code>C.append</code> as shown above should work."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 721, "user_id": 2512324, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f9d51819edf28a5befe8b255e51d95d7?s=128&d=identicon&r=PG", "display_name": "user2512324", "link": "https://stackoverflow.com/users/2512324/user2512324"}, "edited": false, "score": 0, "creation_date": 1428393838, "post_id": 29484417, "comment_id": 47132791, "body": "@user2512324 It&#39;s easy to add additional functions like that when the definition is written point-free. I&#39;ve added some point-free examples to my answer."}, {"owner": {"reputation": 721, "user_id": 2512324, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f9d51819edf28a5befe8b255e51d95d7?s=128&d=identicon&r=PG", "display_name": "user2512324", "link": "https://stackoverflow.com/users/2512324/user2512324"}, "edited": false, "score": 0, "creation_date": 1428399715, "post_id": 29484417, "comment_id": 47136102, "body": "@Cirdec Thanks a lot."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 10, "last_activity_date": 1428394148, "last_edit_date": 1428394148, "creation_date": 1428384584, "answer_id": 29484417, "question_id": 29484234, "link": "https://stackoverflow.com/questions/29484234/remove-parenthesis-in-a-haskell-statement/29484417#29484417", "title": "Remove parenthesis in a haskell statement", "body": "<p>You can write this with no parenthesis by using <code>C.append</code> as an <a href=\"https://wiki.haskell.org/Infix_operator\" rel=\"noreferrer\">infix operator</a>.</p>\n\n<pre><code>selectSource :: [String] -&gt; C.ByteString\nselectSource xs = foldl addSource emptySource xs `C.append` C.pack \"&lt;head&gt;\"\n</code></pre>\n\n<p>Since <code>ByteString</code>s have <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Monoid.html#t:Monoid\" rel=\"noreferrer\"><code>Monoid</code></a> instances with <code>mappend = append</code> you can write this more elegantly with the infix <code>Monoid</code> operator <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Monoid.html#v:-60--62-\" rel=\"noreferrer\"><code>&lt;&gt;</code></a>.</p>\n\n<pre><code>import Data.Monoid\n\nselectSource :: [String] -&gt; C.ByteString\nselectSource xs = foldl addSource emptySource xs &lt;&gt; C.pack \"&lt;head&gt;\"\n</code></pre>\n\n<p>If you enable <a href=\"https://ocharles.org.uk/blog/posts/2014-12-17-overloaded-strings.html\" rel=\"noreferrer\"><code>OverloadedStrings</code></a> you can write string literals like <code>\"&lt;head&gt;\"</code> and use them as <code>ByteString</code>s. The <code>ByteString</code>'s <code>fromString</code> is either <code>pack</code> or <code>packChars</code> as appropriate (it's <code>pack</code> for <code>Char8</code> <code>ByteString</code>s). This can get rid of one set of parenthesis, which will let you write <code>selectSource</code> point-free without any parenthesis. </p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nselectSource :: [String] -&gt; C.ByteString\nselectSource = flip C.append \"&lt;head&gt;\" . foldl addSource emptySource\n</code></pre>\n\n<p>If you prefer the operator to <code>flip</code> you can write this point-free with an <a href=\"https://wiki.haskell.org/Section_of_an_infix_operator\" rel=\"noreferrer\">operator section</a> instead. This requires parenthesis around the operator for the operator section syntax. Operator section parenthesis don't bother me because I never nest them.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}    \nimport Data.Monoid\n\nselectSource :: [String] -&gt; C.ByteString\nselectSource = (&lt;&gt; \"&lt;head&gt;\") . foldl addSource emptySource\n</code></pre>\n\n<p>With either point-free definition we can add additional functions like <code>C.init</code> without messing around with parenthesis.</p>\n\n<pre><code>selectSource' :: [String] -&gt; C.ByteString\nselectSource' = flip C.append \"&lt;head&gt;\" . C.init . foldl addSource emptySource\n\nselectSource' :: [String] -&gt; C.ByteString\nselectSource' = (&lt;&gt; \"&lt;head&gt;\") . C.init . foldl addSource emptySource\n</code></pre>\n"}], "owner": {"reputation": 721, "user_id": 2512324, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f9d51819edf28a5befe8b255e51d95d7?s=128&d=identicon&r=PG", "display_name": "user2512324", "link": "https://stackoverflow.com/users/2512324/user2512324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1223, "favorite_count": 0, "accepted_answer_id": 29484417, "answer_count": 1, "score": 2, "last_activity_date": 1428394148, "creation_date": 1428383684, "last_edit_date": 1428384237, "question_id": 29484234, "link": "https://stackoverflow.com/questions/29484234/remove-parenthesis-in-a-haskell-statement", "title": "Remove parenthesis in a haskell statement", "body": "<p>I'm trying to a bytestring manipulation using folds and appends. Please see the  code below.</p>\n\n<pre><code>import qualified Data.ByteString.Char8 as C\n\nselectSource :: [String] -&gt; C.ByteString\nselectSource xs = C.append (foldl addSource emptySource xs) (C.pack \"&lt;head&gt;\")\n</code></pre>\n\n<p><code>addSource</code> and <code>emptySource</code> are defined accordingly. It looks a bit ugly with the parenthesis and I'd like to remove them in the <code>selectSource</code> function  as</p>\n\n<pre><code>C.append $ foldl addSource emptySource xs $ C.pack \"&lt;head&gt;\"\n</code></pre>\n\n<p>but failed to do so and got an error messaging saying </p>\n\n<pre><code>Couldn't match expected type \u2018C.ByteString -&gt; C.ByteString\u2019\n            with actual type \u2018C.ByteString\u2019\nThe first argument of ($) takes one argument,\nbut its type \u2018SourceByteString\u2019 has none\nIn the second argument of \u2018($)\u2019, namely\n  \u2018foldl addSource emptySource [] $ C.pack \"&lt;head&gt;\"\u2019\n</code></pre>\n\n<p>This works</p>\n\n<pre><code>C.append (foldl addSource emptySource xs) $ C.pack \"&lt;head&gt;\"\n</code></pre>\n\n<p>but it still has one last pair of parenthesis. </p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 3, "creation_date": 1428377750, "post_id": 29482576, "comment_id": 47126843, "body": "If you are using <a href=\"https://hackage.haskell.org/package/constraints\" rel=\"nofollow noreferrer\">constraints</a> the idiomatic way to define <code>witNum</code> would be <code>witNum :: Foo m :- Num (c m r)</code> which you deconstruct with e.g. <code>foo = case witNum :: Foo m :- Num (c m r) of Sub Dict -&gt; (*2)</code> (which isn&#39;t any prettier)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1428461109, "post_id": 29482576, "comment_id": 47167219, "body": "That <code>Num (c m r)</code> instance head <i>should</i> scare you."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1428462952, "post_id": 29482576, "comment_id": 47167683, "body": "But what do I <i>do</i> about it? :-)"}], "answers": [{"tags": [], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "is_accepted": true, "score": 1, "last_activity_date": 1444494460, "creation_date": 1444494460, "answer_id": 33056212, "question_id": 29482576, "link": "https://stackoverflow.com/questions/29482576/turning-a-dict-into-a-constraint/33056212#33056212", "title": "Turning a Dict into a constraint", "body": "<p>After 6 months of thought, I finally have an answer to my dangling comment above: add a <code>newtype</code> wrapper!</p>\n\n<p>I split the <code>Cyc</code> class in two: </p>\n\n<pre><code>class Foo m\n\nclass Cyc c where\n  cyc :: (Foo m, Foo m') =&gt; c m r -&gt; c m' r\n\nclass EntailCyc c where\n  entailCyc :: Tagged (c m r) ((Foo m, Num r) :- (Num (c m r)))\n</code></pre>\n\n<p>Then I define my <code>Cyc</code> instance as above:</p>\n\n<pre><code>data Bar m r = ...\n\ninstance Cyc Bar where ...\n\ninstance (Num r, Foo m) =&gt; Num (Bar m r) where ...\n\ninstance EntailCyc Bar where\n  witNum _ = Dict\n</code></pre>\n\n<p>Then I define a newtype wrapper and give a generic <code>Cyc</code> instance for it:</p>\n\n<pre><code>newtype W c m r = W (c m r)\n\ninstance Cyc (W c m r) where cyc (W a) = W $ cyc a\n\ninstance (EntailCyc c, Foo m, Num r) =&gt; Num (W c m r) where\n  (W a) + (W b) = a + b \\\\ witness entailCyc a\n</code></pre>\n\n<p>Finally, I change all functions that used a generic <code>c m r</code> type to use a <code>W c m r</code> type:</p>\n\n<pre><code>foo :: (Cyc c, EntailCyc c, Foo m, Num r) =&gt; W c m r -&gt; W c m r\nfoo = (*2)\n</code></pre>\n\n<p>The point here is that <code>foo</code> might need <em>many</em> constraints (e.g., <code>Eq (W c m r)</code>, <code>Show (W c m r)</code>, etc) that would each individually require their own constraints. However, the generic instances for <code>W c m r</code> for <code>Eq</code>, <code>Show</code>, etc all have <em>exactly</em> the constraints <code>(EntailCyc c, Foo m, Eq/Show/... a)</code>, so the constraints on <code>foo</code> above are the <em>only</em> constraints I need to write!</p>\n"}], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 33056212, "answer_count": 1, "score": 15, "last_activity_date": 1444494460, "creation_date": 1428372542, "last_edit_date": 1428454930, "question_id": 29482576, "link": "https://stackoverflow.com/questions/29482576/turning-a-dict-into-a-constraint", "title": "Turning a Dict into a constraint", "body": "<p>I have a class <code>Cyc c r</code> which has functions for datas of the form <code>c m r</code>, where <code>m</code> is a phantom type. For example,</p>\n\n<pre><code>class Cyc c r where\n  cyc :: (Foo m, Foo m') =&gt; c m r -&gt; c m' r\n</code></pre>\n\n<p>I do have good reasons for not making <code>m</code> a class parameter. For the purposes of this example, the primary reason is that it reduces the number of constraints on functions. In my actual example, a more compelling need for this interface is that I work with changing and hidden phantom types, so this interface lets me get a <code>Cyc</code> constraint for any phantom type.</p>\n\n<p>One downside to that choice is that I can't make <code>Num (c m r)</code> a superclass constraint of <code>Cyc</code>. My intention is that <code>c m r</code> should be a <code>Num</code> whenever <code>(Cyc c r, Foo m)</code>. The current solution is very annoying: I added  method to class <code>Cyc</code></p>\n\n<pre><code>witNum :: (Foo m) =&gt; c m r -&gt; Dict (Num (c m r))\n</code></pre>\n\n<p>which sort-of accomplishes the same thing. Now when I have a function that takes a generic <code>Cyc</code> and needs a <code>Num (c m r)</code> constraint, I can write:</p>\n\n<pre><code>foo :: (Cyc c r, Foo m) =&gt; c m r -&gt; c m r\nfoo c = case witNum c of\n  Dict -&gt; c*2\n</code></pre>\n\n<p>Of courses I <em>could</em> add a <code>Num (c m r)</code> constraint to <code>foo</code>, but I'm trying to reduce the number of constraints, remember? <code>(Cyc c r, Foo m)</code> is supposed to imply a <code>Num (c m r)</code> constraint (and I need <code>Cyc c r</code> and <code>Foo m</code> for other purposes), so I don't want to have to write out the <code>Num</code> constraint also.</p>\n\n<p>In the process of writing this question, I found a better(?) way to accomplish this, but it has its own drawbacks.</p>\n\n<p>Module Foo:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses, FlexibleInstances, ScopedTypeVariables #-}\nmodule Foo where\n\nimport Data.Constraint\n\nclass Foo m\n\nclass Cyc c r where\n  cyc :: (Foo m, Foo m') =&gt; c m r -&gt; c m' r  \n  witNum :: (Foo m) =&gt; c m r -&gt; Dict (Num (c m r))\n\ninstance (Foo m, Cyc c r) =&gt; Num (c m r) where\n  a * b = case witNum a of\n            Dict -&gt; a * b\n  fromInteger a = case witNum (undefined :: c m r) of\n                    Dict -&gt; fromInteger a\n\n-- no Num constraint and no Dict, best of both worlds\nfoo :: (Foo m, Cyc c r) =&gt; c m r -&gt; c m r\nfoo = (*2)\n</code></pre>\n\n<p>Module Bar:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, MultiParamTypeClasses, OverlappingInstances #-}\nmodule Bar where\n\nimport Foo\nimport Data.Constraint\n\ndata Bar m r = Bar r deriving (Show)\n\ninstance (Num r) =&gt; Cyc Bar r where\n  witNum _ = Dict\n\ninstance (Num r, Foo m) =&gt; Num (Bar m r) where\n  (Bar a) * (Bar b) = Bar $ a*b\n  fromInteger = Bar . fromInteger\n\ninstance Foo ()  \n\nbar :: Bar () Int\nbar = foo 3\n</code></pre>\n\n<p>While this approach gets me everything I'm looking for, it seems fragile. My main concerns are:</p>\n\n<ol>\n<li>I'm wary of the generic instance head for <code>Num</code> in module <code>Foo</code>.</li>\n<li>If any overlapping instances are imported into <code>Foo</code>, I suddenly need <code>IncoherentInstances</code> or the <code>Num</code> constraint on <code>foo</code> to defer instance selection to runtime.</li>\n</ol>\n\n<p>Is there an alternative way to avoid using <code>Dict</code> in every function that needs <code>Num (c m r)</code> that avoids either of these downsides?</p>\n"}, {"tags": ["haskell", "math", "types"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1428368974, "post_id": 29481835, "comment_id": 47124706, "body": "What kind of help are you looking for? Do you want someone to teach you java?"}], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 5, "last_activity_date": 1428368590, "last_edit_date": 1495542505, "creation_date": 1428367663, "answer_id": 29481918, "question_id": 29481835, "link": "https://stackoverflow.com/questions/29481835/java-to-haskell-calculator/29481918#29481918", "title": "Java to Haskell - Calculator", "body": "<p>The elaborate <a href=\"http://en.wikipedia.org/wiki/Visitor_pattern\" rel=\"nofollow noreferrer\">visitor pattern</a> in the Java code is simulating a <a href=\"https://www.fpcomplete.com/school/to-infinity-and-beyond/pick-of-the-week/sum-types\" rel=\"nofollow noreferrer\">sum type</a> with a product and <a href=\"http://en.wikibooks.org/wiki/Haskell/Existentially_quantified_types\" rel=\"nofollow noreferrer\">quantification</a>. In Java the quantification takes the form of a generic type. I've written a simpler example (in C#) of <a href=\"https://stackoverflow.com/a/18426577/414413\">using generics to simulate sum types</a>.</p>\n\n<p>In Haskell we don't need to resort to such an elaborate representation and can use a sum type directly</p>\n\n<pre><code>data Expression\n     = IntNumber Integer\n     | Add      Expression Expression\n     | Subtract Expression Expression\n     | Multiply Expression Expression\n     | Divide   Expression Expression\n</code></pre>\n\n<p>The <code>Evaluate</code> <code>Visitor &lt;Integer&gt;</code> can be written in Haskell as a simple function with the type <code>Expression -&gt; Integer</code>.</p>\n\n<pre><code>evaluate :: Expression     -&gt; Integer\nevaluate    (IntNumber x)  =  x\nevaluate    (Add      a b) =  evaluate a + evaluate b\nevaluate    (Subtract a b) =  evaluate a - evaluate b\nevaluate    (Multiply a b) =  evaluate a * evaluate b\nevaluate    (Divide   a b) =  evaluate a `div` evaluate b\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 1748977, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2b5ffcfd4e2f5294728bfef99fd1a2?s=128&d=identicon&r=PG", "display_name": "camrymps", "link": "https://stackoverflow.com/users/1748977/camrymps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 29481918, "answer_count": 1, "score": 0, "last_activity_date": 1428404284, "creation_date": 1428366994, "last_edit_date": 1428368816, "question_id": 29481835, "link": "https://stackoverflow.com/questions/29481835/java-to-haskell-calculator", "title": "Java to Haskell - Calculator", "body": "<p>I need some help converting some Java code to Haskell. I have managed to make a dumbed-down version. The dumbed-down version is as follows:</p>\n\n<pre><code>add :: Integer -&gt; Integer -&gt; Integer\nadd a b = a + b\n\nsub :: Integer -&gt; Integer -&gt; Integer\nsub a b = a - b\n\nmult :: Integer -&gt; Integer -&gt; Integer\nmult a b = a * b\n\ndivi :: Integer -&gt; Integer -&gt; Integer\ndivi a b = a `div` b\n</code></pre>\n\n<p>So, for the above, if I do the following example:</p>\n\n<pre><code>Prelude&gt; add (mult 3 2) (sub 2 1)\n</code></pre>\n\n<p>It will return:</p>\n\n<pre><code>Prelude&gt; 7\n</code></pre>\n\n<p>I know this works, however I am supposed to convert the following Java code into Haskell, and I know that the code above is not the same as the Java code:</p>\n\n<pre><code>public class Calculator {\n    static interface Expression { &lt; T &gt; T accept(Visitor &lt; T &gt; v);\n    }\n    static class IntNumber implements Expression {\n        int value;\n        IntNumber(int value) {\n            this.value = value;\n        }@Override\n        public &lt; T &gt; T accept(Visitor &lt; T &gt; v) {\n            return v.visit(this);\n        }\n    }\n    static class Multiply implements Expression {\n\n        Expression a, b;\n        Multiply(Expression a, Expression b) {\n            this.a = a;\n            this.b = b;\n        }@Override\n        public &lt; T &gt; T accept(Visitor &lt; T &gt; v) {\n            return v.visit(this);\n        }\n    }\n    static class Divide implements Expression {\n        Expression numerator, denominator;\n        Divide(Expression numerator, Expression denominator) {\n            this.numerator = numerator;\n            this.denominator = denominator;\n        }@Override\n        public &lt; T &gt; T accept(Visitor &lt; T &gt; v) {\n            return v.visit(this);\n        }\n    }\n    static class Add implements Expression {\n        Expression a, b;\n        Add(Expression a, Expression b) {\n            this.a = a;\n            this.b = b;\n        }@Override\n        public &lt; T &gt; T accept(Visitor &lt; T &gt; v) {\n            return v.visit(this);\n        }\n    }\n    static class Subtract implements Expression {\n        Expression a, b;\n        Subtract(Expression a, Expression b) {\n            this.a = a;\n            this.b = b;\n        }@Override\n        public &lt; T &gt; T accept(Visitor &lt; T &gt; v) {\n            return v.visit(this);\n        }\n    }\n    static interface Visitor &lt; T &gt; {\n        public T visit(IntNumber integer);\n        public T visit(Add add);\n        public T visit(Subtract subtract);\n        public T visit(Multiply multiply);\n        public T visit(Divide divide);\n    }\n    static class Evaluate implements Visitor &lt; Integer &gt; {@Override\n        //this method will be called and return \u201c3\u201d\n        public Integer visit(IntNumber integer) {\n            return integer.value;\n        }@Override\n        public Integer visit(Add add) {\n            return add.a.accept(this) + add.b.accept(this);\n        }@Override\n        public Integer visit(Subtract subtract) {\n            return subtract.a.accept(this) - subtract.b.accept(this);\n        }@Override\n        public Integer visit(Multiply multiply) {\n            // \u201cthis\u201d means an instance (eval) of Evaluate class\n            return multiply.a.accept(this) * multiply.b.accept(this);\n        }@Override\n        public Integer visit(Divide divide) {\n            return divide.numerator.accept(this) / divide.denominator.accept(this);\n        }\n    }\n    /**\n     * @param args\n     */\n    public static void main(String[] args) {\n        Evaluate eval = new Evaluate();\n        System.out.println(eval.visit(\n        new Multiply(\n        new IntNumber(3),\n        new Subtract(new IntNumber(10), new IntNumber(5)))));\n    }\n}\n</code></pre>\n\n<p>I am just really lost, even the Java code is confusing me a bit. I really need some help. Any help is greatly appreciated! </p>\n"}, {"tags": ["haskell", "state-monad", "haskell-lens", "free-monad"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 5, "creation_date": 1428350185, "post_id": 29478398, "comment_id": 47117823, "body": "Would it not be easier to instead have <code>StateT GameState (Free MyIO) a</code>?  If you are wanting to later swap <code>Free MyIO</code> for <code>IO</code> then this would be the usual way, since there is no transformer version of <code>IO</code>."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1428357960, "post_id": 29478398, "comment_id": 47121568, "body": "Also, the problem stems from the fact that indexing a list is not a safe operation.  The lens library wants you to return a type that can be defaulted, and the standard typeclass for this is <code>Monoid</code>.  If you simply add <code>Monoid a =&gt; </code> to the type signature of <code>zoomPlayer</code> then you&#39;ll be set.  This does restrict what you can return, of course, but you&#39;ll have to unless you want to write more code."}, {"owner": {"reputation": 48293, "user_id": 964135, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c8caec1b0320fe1b8b498936fbb6b846?s=128&d=identicon&r=PG", "display_name": "Pubby", "link": "https://stackoverflow.com/users/964135/pubby"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1428381945, "post_id": 29478398, "comment_id": 47127966, "body": "@bheklir My bad, the <code>a</code>in the error was a typo; it was actually <code>a1</code>. I&#39;m sorry for the confusion. It seems like <code>FreeF</code> is the thing it expects to be a monoid, but I don&#39;t have a way of writing an instance for that. Maybe I could temporarily wrap it in a list and then unwrap it."}], "answers": [{"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 2, "last_activity_date": 1428563475, "last_edit_date": 1428563475, "creation_date": 1428561840, "answer_id": 29531554, "question_id": 29478398, "link": "https://stackoverflow.com/questions/29478398/difficulty-with-zoom-and-free-monads/29531554#29531554", "title": "Difficulty with zoom and free monads", "body": "<p>If you are sure you'll never index into a non-existing player and don't mind a little unsafety, you can use the <a href=\"http://hackage.haskell.org/package/lens-4.9/docs/Control-Lens-Traversal.html#v:unsafeSingular\" rel=\"nofollow\"><code>unsafeSingular</code></a> combinator to turn a <code>Traversal</code> into a <code>Lens</code>, like this:</p>\n\n<pre><code>zoomPlayer :: Int -&gt; FreeT MyIO (State PlayerState) a -&gt; FreeT MyIO (State GameState) a\nzoomPlayer i prog = hoistFreeT (zoom (players . unsafeSingular (element i))) prog\n</code></pre>\n\n<p>(Also, perhaps I would use <a href=\"http://hackage.haskell.org/package/lens-4.9/docs/Control-Lens-At.html#v:ix\" rel=\"nofollow\"><code>ix</code></a> instead of <code>element</code>, but that's unrelated to the problem.)</p>\n\n<p>We can also construct safe indexing lenses for always-infinite sequences, like streams defined using <a href=\"http://hackage.haskell.org/package/free-4.11/docs/Control-Comonad-Cofree.html\" rel=\"nofollow\"><code>Cofree</code></a> from the <code>free</code> package:</p>\n\n<pre><code>import Control.Lens (Lens', _Wrapped')\nimport Control.Comonad.Cofree (Cofree, telescoped)\nimport Data.Functor.Identity\nimport Control\n\nsureIx :: Int -&gt; Lens' (Cofree Identity a) a\nsureIx i = telescoped $ replicate i _Wrapped'\n</code></pre>\n\n<p>But a game is unlikely to have infinite players.</p>\n"}], "owner": {"reputation": 48293, "user_id": 964135, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c8caec1b0320fe1b8b498936fbb6b846?s=128&d=identicon&r=PG", "display_name": "Pubby", "link": "https://stackoverflow.com/users/964135/pubby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 1, "accepted_answer_id": 29531554, "answer_count": 1, "score": 5, "last_activity_date": 1428563475, "creation_date": 1428349262, "last_edit_date": 1428380279, "question_id": 29478398, "link": "https://stackoverflow.com/questions/29478398/difficulty-with-zoom-and-free-monads", "title": "Difficulty with zoom and free monads", "body": "<p>I am mucking around with free monads and lens, using the free monad to create my own version of the IO monad:</p>\n\n<pre><code>data MyIO next\n    = LogMsg String next\n    | GetInput (String -&gt; next)\n    deriving (Functor)\n</code></pre>\n\n<p>I am stacking this on top of a state monad like so: <code>FreeT MyIO (State GameState) a</code> where <code>GameState</code> is:</p>\n\n<pre><code>data GameState = GameState { _players :: [PlayerState] }\n</code></pre>\n\n<p>Now, what I would like to have is a way to \"zoom-into\" a <code>PlayerState</code> from a <code>GameState</code> context. Something like this:</p>\n\n<pre><code>zoomPlayer :: Int -&gt; FreeT MyIO (State PlayerState) a -&gt; FreeT MyIO (State GameState) a\nzoomPlayer i prog = hoistFreeT (zoom (players . element i)) prog\n</code></pre>\n\n<p>But I'm getting this error:</p>\n\n<pre><code>No instance for (Data.Monoid.Monoid a1)\n  arising from a use of \u2018_head\u2019\n</code></pre>\n\n<p>This error seems related to the fact that <code>players . element i</code> is a traversal; if I remove the list aspect from <code>_players</code> and use normal lens then the code works.</p>\n\n<p>Any ideas on how to write this function?</p>\n"}, {"tags": ["debugging", "haskell", "ghc", "cabal", "ghci"], "comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1428364079, "post_id": 29477748, "comment_id": 47123507, "body": "I don&#39;t know the answer to the <code>cabal</code> file part, but as far as I know, GHCi can <i>only</i> debug code in its internal bytecode format. In particular, you want to avoid natively compiling with <code>cabal build</code>, since the resulting <code>.o</code> files would be used by default instead of bytecode."}, {"owner": {"reputation": 4738, "user_id": 917635, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2365756407af40c28c05d4d30182dbac?s=128&d=identicon&r=PG", "display_name": "artella", "link": "https://stackoverflow.com/users/917635/artella"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1428387225, "post_id": 29477748, "comment_id": 47129648, "body": "@&#216;rjanJohansen Thanks, I have managed to debug cassava before by &quot;merging&quot; the cabal files, which allowed me to seamlessly step from my application into cassava. However the same attempts with criterion results in a <code>criterion-1.1.0.0&#47;cbits&#47;time-posix.o: relocation R_X86_64_PC32 against undefined symbol clock_gettime@@GLIBC_2.2.5 can not be used when making a shared object; recompile with -fPIC</code>, which is what I am currently trying to solve!"}, {"owner": {"reputation": 4738, "user_id": 917635, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2365756407af40c28c05d4d30182dbac?s=128&d=identicon&r=PG", "display_name": "artella", "link": "https://stackoverflow.com/users/917635/artella"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1428400961, "post_id": 29477748, "comment_id": 47136828, "body": "@&#216;rjanJohansen : Ah it seems that the way to resolve the <code>time-posix.o</code> error in comment above is to add the option <code>cc-options: -fPIC</code>. So for the moment I can achieve the desired behaviour by merging the cabal files and adding <code>cc-options: -fPIC</code> to the resulting cabal file."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1428416426, "post_id": 29477748, "comment_id": 47146562, "body": "Great! This does sound like a generally useful tip. If you want you can post an answer to your own question describing how you solved it."}, {"owner": {"reputation": 4738, "user_id": 917635, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2365756407af40c28c05d4d30182dbac?s=128&d=identicon&r=PG", "display_name": "artella", "link": "https://stackoverflow.com/users/917635/artella"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1428524356, "post_id": 29477748, "comment_id": 47203537, "body": "@&#216;rjanJohansen : I posted the method below. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 4738, "user_id": 917635, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2365756407af40c28c05d4d30182dbac?s=128&d=identicon&r=PG", "display_name": "artella", "link": "https://stackoverflow.com/users/917635/artella"}, "is_accepted": true, "score": 1, "last_activity_date": 1428524657, "last_edit_date": 1428524657, "creation_date": 1428524313, "answer_id": 29524554, "question_id": 29477748, "link": "https://stackoverflow.com/questions/29477748/debugging-stepping-into-a-package-module-via-cabal-repl/29524554#29524554", "title": "Debugging/Stepping into a package module via cabal repl", "body": "<p>This is how I managed to achieve the desired goal of being able to step (within <code>cabal repl</code>) from my code into the criterion source : </p>\n\n<ol>\n<li><p>First do : </p>\n\n<pre><code>mkdir /tmp/testCrit\ncd /tmp/testCrit\n</code></pre></li>\n<li><p>Download <code>criterion-1.1.0.0.tar.gz</code></p></li>\n<li><p>Unzip into <code>/tmp/testCrit</code>, so we should have <code>/tmp/testCrit/criterion-1.1.0.0</code>. In this directory we have <code>Criterion.hs</code> etc.</p></li>\n<li><p>Then jump into the folder containing the criterion source and do : </p>\n\n<pre><code>cd /tmp/testCrit/criterion-1.1.0.0\ncabal sandbox init\ncabal install -j\n</code></pre>\n\n<p>Note that this creates a directory : <code>/tmp/testCrit/criterion-1.1.0.0/dist/dist-sandbox-782e42f0/build/autogen</code> which we shall use later</p></li>\n<li><p>Back in <code>/tmp/testCrit</code> create a <code>Main.hs</code> file containing the benchmark code above and also the cabal file above, but merge it with the criterion cabal file contained in <code>/tmp/testCrit/criterion-1.1.0.0</code> in the following way. Note the main new additions are the lines : </p>\n\n<pre><code>cc-options: -fPIC\n</code></pre>\n\n<p>which allows one to run it in <code>cabal repl</code>, and the following \nlines : </p>\n\n<pre><code>hs-source-dirs: \n  ./\n  ./criterion-1.1.0.0\n  ./criterion-1.1.0.0/dist/dist-sandbox-782e42f0/build/autogen\n</code></pre>\n\n<p>The full cabal file should then look like : </p>\n\n<pre><code>  name:                test\n  version:             0.1.0.0\n  build-type:          Simple\n  cabal-version:       &gt;=1.10\n\n  executable test\n    main-is:             Main.hs\n    build-depends:       \n      base &gt;=4.8 &amp;&amp; &lt;4.9,\n      aeson &gt;= 0.8,\n      ansi-wl-pprint &gt;= 0.6.7.2,\n      base &gt;= 4.5 &amp;&amp; &lt; 5,\n      binary &gt;= 0.5.1.0,\n      bytestring &gt;= 0.9 &amp;&amp; &lt; 1.0,\n      cassava &gt;= 0.3.0.0,\n      containers,\n      deepseq &gt;= 1.1.0.0,\n      directory,\n      filepath,\n      Glob &gt;= 0.7.2,\n      hastache &gt;= 0.6.0,\n      mtl &gt;= 2,\n      mwc-random &gt;= 0.8.0.3,\n      optparse-applicative &gt;= 0.11,\n      parsec &gt;= 3.1.0,\n      statistics &gt;= 0.13.2.1,\n      text &gt;= 0.11,\n      time,\n      transformers,\n      transformers-compat &gt;= 0.4,\n      vector &gt;= 0.7.1,\n      vector-algorithms &gt;= 0.4\n    default-language:    Haskell2010\n    ghc-options:         \"-O3\"\n    c-sources: \n      ./criterion-1.1.0.0/cbits/cycles.c\n      ./criterion-1.1.0.0/cbits/time-posix.c\n    hs-source-dirs: \n      ./\n      ./criterion-1.1.0.0\n      ./criterion-1.1.0.0/dist/dist-sandbox-782e42f0/build/autogen\n    cc-options: -fPIC\n</code></pre></li>\n<li><p>Then in the main directory do :  </p>\n\n<pre><code>cd /tmp/testCrit/\ncabal sandbox init\ncabal install -j\n</code></pre></li>\n<li><p>Then we can spin up a <code>cabal repl</code> and step directly into\ncriterion <strong><em>from our <code>Main.hs</code> code</em></strong> : </p>\n\n<pre><code>*Main&gt; :break Criterion.Main.defaultMain\nBreakpoint 0 activated at criterion-1.1.0.0/Criterion/Main.hs:79:15-43\n*Main&gt; main\nStopped at criterion-1.1.0.0/Criterion/Main.hs:79:15-43\n_result :: [Benchmark] -&gt; IO () = _\n[criterion-1.1.0.0/Criterion/Main.hs:79:15-43] *Main&gt; :step\nStopped at criterion-1.1.0.0/Criterion/Main.hs:(131,1)-(147,39)\n_result :: IO () = _\n[criterion-1.1.0.0/Criterion/Main.hs:(131,1)-(147,39)] *Main&gt; :step\nStopped at criterion-1.1.0.0/Criterion/Main.hs:(131,29)-(147,39)\n_result :: IO () = _\nbs :: [Benchmark] = [_]\ndefCfg :: Criterion.Types.Config = _\n[criterion-1.1.0.0/Criterion/Main.hs:(131,29)-(147,39)] *Main&gt; :step\nStopped at criterion-1.1.0.0/Criterion/Main.hs:132:10-37\n_result :: IO Criterion.Main.Options.Mode = _\ndefCfg :: Criterion.Types.Config = _\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 4738, "user_id": 917635, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2365756407af40c28c05d4d30182dbac?s=128&d=identicon&r=PG", "display_name": "artella", "link": "https://stackoverflow.com/users/917635/artella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 495, "favorite_count": 0, "accepted_answer_id": 29524554, "answer_count": 1, "score": 3, "last_activity_date": 1428524657, "creation_date": 1428346801, "last_edit_date": 1495541603, "question_id": 29477748, "link": "https://stackoverflow.com/questions/29477748/debugging-stepping-into-a-package-module-via-cabal-repl", "title": "Debugging/Stepping into a package module via cabal repl", "body": "<p>So I have the following code from <a href=\"https://stackoverflow.com/q/29340053\">Preventing caching of computation in Criterion benchmark</a> and my aim is to be able to step from <code>main</code> directly into the function <code>defaultMain</code> in <code>Criterion.Main</code> :</p>\n\n<pre><code>{-# OPTIONS -fno-full-laziness #-}\n{-# OPTIONS_GHC -fno-cse #-}\n{-# LANGUAGE BangPatterns #-}\nmodule Main where\nimport Criterion.Main\nimport Data.List\n\nnum :: Int\nnum = 100000000\n\nlst :: a -&gt; [Int]\nlst _ = [1,2..num]\n\nmyadd :: Int -&gt; Int -&gt; Int\nmyadd !x !y = let !result = x + y in\n  result\n\nmysum = foldl' myadd 0\n\nmain :: IO ()\nmain = defaultMain [\n  bgroup \"summation\" \n    [bench \"mysum\" $ whnf (mysum . lst) ()]\n  ]\n</code></pre>\n\n<p>and the cabal file is : </p>\n\n<pre><code>name:                test\nversion:             0.1.0.0\nbuild-type:          Simple\ncabal-version:       &gt;=1.10\n\nexecutable test\n  main-is:             Main.hs\n  build-depends:       base &gt;=4.8 &amp;&amp; &lt;4.9,\n                       criterion==1.1.0.0\n  default-language:    Haskell2010\n  ghc-options:         \"-O3\"\n</code></pre>\n\n<p>(using ghc 7.10.1 and cabal 1.22.0.0).</p>\n\n<p>If from within <code>cabal repl</code> I try to set a breakpoint in criterion I get the following error : </p>\n\n<pre><code>*Main&gt; :break Criterion.Main.defaultMain\ncannot set breakpoint on defaultMain: module Criterion.Main is not interpreted\n</code></pre>\n\n<p>Furthermore if I try to <code>add</code> the package I get the following error : </p>\n\n<pre><code>*Main&gt; :add *Criterion\n\n&lt;no location info&gt;: module \u2018Criterion\u2019 is a package module\nFailed, modules loaded: Main.\n</code></pre>\n\n<p>If I do within the directory <code>git clone https://github.com/bos/criterion</code>\nand then add the following two lines to my cabal file : </p>\n\n<pre><code>other-modules:       Criterion\nhs-source-dirs:      .\n                 ./criterion\n</code></pre>\n\n<p>then upon doing <code>cabal build</code> I get the following errors : </p>\n\n<pre><code>criterion/Criterion/IO.hs:23:0:\n     error: missing binary operator before token \"(\"\n     #if MIN_VERSION_binary(0, 6, 3)\n</code></pre>\n\n<p>so I suspect that I have to do a full on merge of the criterion cabal \nfile with my cabal file above, which feels a bit excessive.</p>\n\n<p>Is there an easier way for me to go about setting a breakpoint \nin Criterion, so that I can step (when debugging in cabal repl/ghci) directly from my source into criterion's source? Thanks</p>\n\n<p>p.s. There is a related question at <a href=\"https://stackoverflow.com/q/28570367\">Debugging IO in a package module inside GHCi</a> but unfortunately it did not help.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1428344375, "post_id": 29476988, "comment_id": 47114962, "body": "You are deriving <code>Eq</code> and <code>Ord</code> for <code>Tree</code>. Then why are you writing instances of it ?"}, {"owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "edited": false, "score": 0, "creation_date": 1428344465, "post_id": 29476988, "comment_id": 47115002, "body": "Apart of what bheklir have said you are pattern matching using Tree, But Tree is a type constructor not a Data constructor. You can only pattern match using the data constructors Leaf or Internal"}, {"owner": {"reputation": 175, "user_id": 2901259, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5eec020647b0d7ff639b31db7aed9cca?s=128&d=identicon&r=PG&f=1", "display_name": "ssh", "link": "https://stackoverflow.com/users/2901259/ssh"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1428344525, "post_id": 29476988, "comment_id": 47115037, "body": "@Sibi I might be misunderstanding something, but my understanding is that Eq and Ord are interfaces, and I&#39;m providing the concrete implementation of Eq and Ord. I come from a Java background."}, {"owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "edited": false, "score": 3, "creation_date": 1428345271, "post_id": 29476988, "comment_id": 47115397, "body": "In Haskell You have 2 options: you automatically derive the instances of the classes (using derive) or you write the instances yourself. Here You are first deriving them automatically then providing an implementation for them."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 2901259, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5eec020647b0d7ff639b31db7aed9cca?s=128&d=identicon&r=PG&f=1", "display_name": "ssh", "link": "https://stackoverflow.com/users/2901259/ssh"}, "edited": false, "score": 0, "creation_date": 1428345109, "post_id": 29477042, "comment_id": 47115315, "body": "Thank you so much for your help!"}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 4, "last_activity_date": 1428344681, "last_edit_date": 1428344681, "creation_date": 1428344314, "answer_id": 29477042, "question_id": 29476988, "link": "https://stackoverflow.com/questions/29476988/ambiguous-definition-error-while-trying-to-define-eq-for-custom-tree-data-struct/29477042#29477042", "title": "Ambiguous definition error while trying to define Eq for custom Tree data structure", "body": "<p>The problem is indentation.  You need to indent all lines with <code>==</code> and <code>&lt;=</code>.  The compiler sees <code>instance (Eq a) =&gt; Eq (Tree a) where</code> as one block, then the definition for <code>==</code> on trees as completely separate blocks of code.  Indent this and your <code>Tree a &lt;= Tree b = ...</code> line, and it should be good to go.  Otherwise, it looks like you're defining <code>==</code> at the top level of your source code, which Haskell happily lets you do.</p>\n\n<p>Since you're already deriving <code>Eq</code> and <code>Ord</code> for <code>Tree</code>, you don't have to define them yourself.  If you want custom instances here then <em>don't</em> derive them.  Aside from that you need to fix the definition for your <code>Ord</code> instance to just be</p>\n\n<pre><code>instance Ord (Tree a) where\n    a &lt;= b = freq a &lt;= freq b\n</code></pre>\n\n<p>with the same definition for <code>freq</code>.  You don't need to do pattern matching here, especially since <code>Tree</code> is a type constructor, but you can only pattern match with data constructors.  <code>Leaf</code> and <code>Internal</code> are data constructors here, so they can be pattern matched on.  You'll need to fix this for your <code>Eq</code> instance too, but the solution is similar.</p>\n"}], "owner": {"reputation": 175, "user_id": 2901259, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5eec020647b0d7ff639b31db7aed9cca?s=128&d=identicon&r=PG&f=1", "display_name": "ssh", "link": "https://stackoverflow.com/users/2901259/ssh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 29477042, "answer_count": 1, "score": 0, "last_activity_date": 1428344681, "creation_date": 1428344054, "question_id": 29476988, "link": "https://stackoverflow.com/questions/29476988/ambiguous-definition-error-while-trying-to-define-eq-for-custom-tree-data-struct", "title": "Ambiguous definition error while trying to define Eq for custom Tree data structure", "body": "<p>I'm trying to implement <code>Eq</code> and <code>Ord</code> for the Huffman tree data structure, but I'm getting several \"ambiguous definition\" and scope related errors. I've been following the tree example on <a href=\"https://www.haskell.org/tutorial/classes.html\" rel=\"nofollow\">https://www.haskell.org/tutorial/classes.html</a></p>\n\n<pre><code>import Data.List\n\ndata Tree a = Leaf a Int | Internal (Tree a) (Tree a) Int deriving (Eq, Ord)\n\ninstance (Eq a) =&gt; Eq (Tree a) where\n(Leaf a ac) == (Leaf b bc) = (a == b) &amp;&amp; (ac == bc)\n(Internal (Tree a1) (Tree a2) ac) == (Internal (Tree b1) (Tree b2) bc) = \n                    (a1 == b1) &amp;&amp; (a2 == b2) &amp;&amp; (ac == bc)\n_ == _ = False\n\ninstance Ord (Tree a) where\nTree a &lt;= Tree b = (freq a) &lt;= (freq b)\n\nfreq :: Tree a -&gt; Int\nfreq (Leaf _ c) = c\nfreq (Internal _ _ c) = c\n</code></pre>\n\n<p>I'm not sure what is ambiguous. It says <code>==</code> might be from <code>Prelude</code> or my code. However, my == is defined only for my <code>Tree</code> so I'm not sure what's going on. Please help me understand and rectify this issue.</p>\n"}, {"tags": ["haskell", "erlang", "parsec"], "comments": [{"owner": {"reputation": 12004, "user_id": 988678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a073cbc871c26b0fb4f1cc1f808e9749?s=128&d=identicon&r=PG", "display_name": "zxq9", "link": "https://stackoverflow.com/users/988678/zxq9"}, "edited": false, "score": 0, "creation_date": 1428342027, "post_id": 29476289, "comment_id": 47113677, "body": "Depends on what you&#39;re looking for, but generally this is where I look first: <a href=\"http://www.erlang.org/doc/apps/parsetools/index.html\" rel=\"nofollow noreferrer\">erlang.org/doc/apps/parsetools/index.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 1, "last_activity_date": 1428343621, "last_edit_date": 1428343621, "creation_date": 1428341993, "answer_id": 29476435, "question_id": 29476289, "link": "https://stackoverflow.com/questions/29476289/erlang-equivalent-to-parsec-library/29476435#29476435", "title": "Erlang equivalent to Parsec library", "body": "<p>Yes, there is, written in Erlang.</p>\n\n<p>It's called <a href=\"https://bitbucket.org/dmercer/parsec-erlang/src\" rel=\"nofollow\">Parsec Erlang</a>.</p>\n\n<p>More Parsec clones in other languages can be found <a href=\"https://wiki.haskell.org/Parsec#Parsec_clones_in_other_languages\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "closed_date": 1428354890, "accepted_answer_id": 29476435, "answer_count": 1, "score": 1, "last_activity_date": 1428343621, "creation_date": 1428341507, "question_id": 29476289, "link": "https://stackoverflow.com/questions/29476289/erlang-equivalent-to-parsec-library", "closed_reason": "Not suitable for this site", "title": "Erlang equivalent to Parsec library", "body": "<p>Is there an <strong>Erlang</strong> library equivalent to <strong>Parsec</strong> or <strong>attoparsec</strong> (Written with Haskell) ?</p>\n"}, {"tags": ["haskell", "compiler-errors", "ghc"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 6, "creation_date": 1428337464, "post_id": 29474908, "comment_id": 47111272, "body": "As for your last bullet, if you add <code>{-# LANGUAGE ScopedTypeVariables #-} at the top of your source, then write </code>score<code>&#39;s signature as </code>forall c. Cell c =&gt; (c -&gt; Float) -&gt; Int -&gt; c -&gt; Float` then you can use the <code>c</code> type variable inside the <code>where</code> clause."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1428338025, "post_id": 29474908, "comment_id": 47111563, "body": "If you have access to GHC 7.10, then you can use the new holes features that let you put a <code>_</code> in a type signature or expression and GHC will infer the type of that <code>_</code>.  After playing around with it for a few minutes it becomes a really useful tool."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1428338427, "post_id": 29474908, "comment_id": 47111766, "body": "@bheklilr Precisely what I would suggest, you should make those into an answer.  Also, holes for <i>values</i> are available in 7.8 too."}], "answers": [{"comments": [{"owner": {"reputation": 36975, "user_id": 94977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8341c5bff3dcbd8ed34d9d68bd4169f2?s=128&d=identicon&r=PG", "display_name": "Jason Orendorff", "link": "https://stackoverflow.com/users/94977/jason-orendorff"}, "edited": false, "score": 0, "creation_date": 1428348007, "post_id": 29476312, "comment_id": 47116822, "body": "I think ScopedTypeVariables is going to help a lot, since adding type annotations is what I&#39;m already in the habit of doing. Thanks for this explanation."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1528834322, "last_edit_date": 1528834322, "creation_date": 1428341567, "answer_id": 29476312, "question_id": 29474908, "link": "https://stackoverflow.com/questions/29474908/how-can-i-track-down-ghc-couldnt-match-expected-type-errors/29476312#29476312", "title": "How can I track down GHC &quot;Couldn&#39;t match expected type&quot; errors?", "body": "<p>For what it's worth, here's how I mentally process the error.</p>\n\n<p>I start from <code>c -&gt; c</code> vs <code>Float</code>, and realize there's a problem with the number of arguments somewhere: some non-function is being applied, or a function is being passed too many arguments (which is the same thing, because of currying).</p>\n\n<p>Then I consider where the error points to: <code>estimate x</code>. I check the type for <code>estimate</code> to discover that <code>estimate</code> takes exactly one parameter. (Eyebrow-raising step here.) I infer that that code is fine, but that it's used in a context which passes too many arguments, something like</p>\n\n<pre><code>(if ... then estimate x else ...) unexpectedArg\n</code></pre>\n\n<p>Fortunately, <code>estimate</code> is used inside the definition of a function:</p>\n\n<pre><code>scoreBlue limit best x worst = ...\n</code></pre>\n\n<p>Here's where I add a type signature to that definition before investigating further. As you noticed, doing that is not trivial in this case, since you cope with one of the plain Haskell's shortcomings :-/ Also fortunately, as @bheklilr points out in a comment, you can write the signature anyway if you turn on the <code>ScopedTypeVariables</code> extension. (Personally, I hope that the next Haskell standard includes this (and a few others very common extensions).)</p>\n\n<p>In this case, since I have no editor open with the code at hand, I check where <code>scoreBlue</code> is used, noting that <code>foldr</code> above is passing one argument too much. (... but this is not what the question is about.)</p>\n\n<p>To be honest, in my own code I tend to frequently add type annotations in <code>let</code>/<code>where</code> definitions, perhaps a bit too defensively. While I sometimes omit these when the code is simple, when writing a many-arguments function like <code>scoreBlue</code> I would surely write the type <em>before</em> starting with the actual definition, since I'd consider the type as a fundamental guideline and documentation to the actual code.</p>\n"}, {"comments": [{"owner": {"reputation": 36975, "user_id": 94977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8341c5bff3dcbd8ed34d9d68bd4169f2?s=128&d=identicon&r=PG", "display_name": "Jason Orendorff", "link": "https://stackoverflow.com/users/94977/jason-orendorff"}, "edited": false, "score": 0, "creation_date": 1428347894, "post_id": 29477018, "comment_id": 47116773, "body": "Thank you very much for sharing your techniques at such length. I really appreciate it."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 36975, "user_id": 94977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8341c5bff3dcbd8ed34d9d68bd4169f2?s=128&d=identicon&r=PG", "display_name": "Jason Orendorff", "link": "https://stackoverflow.com/users/94977/jason-orendorff"}, "edited": false, "score": 0, "creation_date": 1428349784, "post_id": 29477018, "comment_id": 47117635, "body": "@JasonOrendorff The typed holes feature (available in 7.8 and up) for expressions is immensely useful.  Now that 7.10 has the same feature for type signatures it gets even more powerful since you can have the compiler give you hints as to what types are inferred where and what values are available for constructing expressions.  You can also pass the <code>-fdefer-type-errors</code> flag which lets you compile with mere warnings where your holes are, then when you run your code it&#39;ll raise an error at the first hole it hits.  This has basically become my Haskell workflow since the feature was released."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 4, "last_activity_date": 1428344192, "creation_date": 1428344192, "answer_id": 29477018, "question_id": 29474908, "link": "https://stackoverflow.com/questions/29474908/how-can-i-track-down-ghc-couldnt-match-expected-type-errors/29477018#29477018", "title": "How can I track down GHC &quot;Couldn&#39;t match expected type&quot; errors?", "body": "<p>For a problem like this, you could easily use the <code>ScopedTypeVariables</code> extension and change <code>score</code>'s type signature to begin with <code>forall c. Cell c =&gt; ...</code>, but I would prefer extracting those functions out to the top level instead.  In order to do this you'll need to add <code>estimate</code> as an argument to both <code>scoreRed</code> and <code>scoreBlue</code>:</p>\n\n<pre><code>score :: Cell c =&gt; (c -&gt; Float) -&gt; Int -&gt; c -&gt; Float\nscore estimate limit x =\n    foldr (scoreRed estimate (limit - 1)) (-1) (moves x)\n\nscoreRed estimate limit x best =\n    max best $ foldr (scoreBlue estimate limit best x) 1 (moves x)\n\nscoreBlue estimate limit best x worst =\n    if limit &lt;= 0\n        then estimate x\n        else min worst $ foldr (scoreRed estimate (limit - 1)) best (moves x)\n</code></pre>\n\n<p>And now you'll get the errors</p>\n\n<pre><code>jason_orendorff.hs:9:25:\n    Couldn't match type \u2018Float\u2019 with \u2018Float -&gt; Float\u2019\n    Expected type: Float -&gt; Float -&gt; Float\n      Actual type: c -&gt; Float\n    In the first argument of \u2018scoreRed\u2019, namely \u2018estimate\u2019\n    In the first argument of \u2018foldr\u2019, namely\n      \u2018(scoreRed estimate (limit - 1))\u2019\n\njason_orendorff.hs:17:18:\n    Occurs check: cannot construct the infinite type: r ~ r -&gt; r\n    Relevant bindings include\n      worst :: r (bound at jason_orendorff.hs:14:37)\n      x :: r (bound at jason_orendorff.hs:14:35)\n      best :: r (bound at jason_orendorff.hs:14:30)\n      estimate :: r -&gt; r -&gt; r (bound at jason_orendorff.hs:14:15)\n      scoreBlue :: (r -&gt; r -&gt; r) -&gt; a -&gt; r -&gt; r -&gt; r -&gt; r -&gt; r\n        (bound at jason_orendorff.hs:14:5)\n    In the expression:\n      min worst $ foldr (scoreRed estimate (limit - 1)) best (moves x)\n    In the expression:\n      if limit &lt;= 0 then\n          estimate x\n      else\n          min worst $ foldr (scoreRed estimate (limit - 1)) best (moves x)\n    In an equation for \u2018scoreBlue\u2019:\n        scoreBlue estimate limit best x worst\n          = if limit &lt;= 0 then\n                estimate x\n            else\n                min worst $ foldr (scoreRed estimate (limit - 1)) best (moves x)\n</code></pre>\n\n<p>Which tells us there's still a problem with the use of <code>estimate</code>.  At this point, I would comment out <code>scoreRed</code> and <code>scoreBlue</code>, then put an underscore in front of the call to <code>scoreRed</code> in <code>score</code>, making it a named hole:</p>\n\n<pre><code>score :: Cell c =&gt; (c -&gt; Float) -&gt; Int -&gt; c -&gt; Float\nscore estimate limit x =\n    foldr (_scoreRed estimate (limit - 1)) (-1) (moves x)\n</code></pre>\n\n<p>Which tells us that <code>_scoreRed</code> should have the type <code>(c -&gt; Float) -&gt; Int -&gt; c -&gt; Float -&gt; Float</code>.  So now we can put this as a type signature and a function declaration with a hole for <code>scoreBlue</code>:</p>\n\n<pre><code>score :: Cell c =&gt; (c -&gt; Float) -&gt; Int -&gt; c -&gt; Float\nscore estimate limit x =\n    foldr (scoreRed estimate (limit - 1)) (-1) (moves x)\n\nscoreRed :: Cell c =&gt; (c -&gt; Float) -&gt; Int -&gt; c -&gt; Float -&gt; Float\nscoreRed estimate limit x best =\n    max best $ foldr (_scoreBlue estimate limit best x) 1 (moves x)\n</code></pre>\n\n<p>Compiling tells us that <code>_scoreBlue :: (c -&gt; Float) -&gt; Int -&gt; Float -&gt; c -&gt; c -&gt; Float -&gt; Float</code>, and this is where I see the problem, <code>scoreBlue</code> is expecting two <code>c</code> arguments, when in reality I bet you want it to only take one.  You want to <code>fold</code> across <code>scoreBlue</code> when it only needs <code>x</code> and <code>worst</code> as arguments, but you've already provided it with <code>x</code>.  If we remove that from the <code>fold</code> and uncomment <code>scoreBlue</code>:</p>\n\n<pre><code>score :: Cell c =&gt; (c -&gt; Float) -&gt; Int -&gt; c -&gt; Float\nscore estimate limit x =\n    foldr (scoreRed estimate (limit - 1)) (-1) (moves x)\n\nscoreRed :: Cell c =&gt; (c -&gt; Float) -&gt; Int -&gt; c -&gt; Float -&gt; Float\nscoreRed estimate limit x best =\n    max best $ foldr (scoreBlue estimate limit best) 1 (moves x)\n\nscoreBlue :: Cell c =&gt; (c -&gt; Float) -&gt; Int -&gt; Float -&gt; c -&gt; Float -&gt; Float\nscoreBlue estimate limit best x worst =\n    if limit &lt;= 0\n        then estimate x\n        else min worst $ foldr (scoreRed estimate (limit - 1)) best (moves x)\n</code></pre>\n\n<p>And now everything type-checks.  I don't know if this is the correct behavior, the type system can help only to a certain point, but this code will run.  Then you can refactor this back to use the local functions instead of top-level:</p>\n\n<pre><code>score :: Cell c =&gt; (c -&gt; Float) -&gt; Int -&gt; c -&gt; Float\nscore estimate limit x =\n    foldr (scoreRed (limit - 1)) (-1) (moves x)\n    where\n        scoreRed limit x best =\n            max best $ foldr (scoreBlue limit best) 1 (moves x)\n        scoreBlue limit best x worst =\n            if limit &lt;= 0\n                then estimate x\n                else min worst $ foldr (scoreRed (limit - 1)) best (moves x)\n</code></pre>\n\n<p>And everything still type-checks.</p>\n"}], "owner": {"reputation": 36975, "user_id": 94977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8341c5bff3dcbd8ed34d9d68bd4169f2?s=128&d=identicon&r=PG", "display_name": "Jason Orendorff", "link": "https://stackoverflow.com/users/94977/jason-orendorff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 29476312, "answer_count": 2, "score": 11, "last_activity_date": 1528834322, "creation_date": 1428336430, "question_id": 29474908, "link": "https://stackoverflow.com/questions/29474908/how-can-i-track-down-ghc-couldnt-match-expected-type-errors", "title": "How can I track down GHC &quot;Couldn&#39;t match expected type&quot; errors?", "body": "<p>This Haskell code contains a type error, a dumb mistake on my part that will be obvious once you see it.</p>\n\n<p>I figured it out, but it was hard. My question is: <strong>How should I have gone about diagnosing this?</strong></p>\n\n<pre><code>class Cell c where\n  start :: c\n  moves :: c -&gt; [c]\n\nscore :: Cell c =&gt; (c -&gt; Float) -&gt; Int -&gt; c -&gt; Float\nscore estimate limit x =\n  foldr (scoreRed (limit - 1)) (-1) (moves x)\n  where\n    scoreRed limit x best =\n      max best $ foldr (scoreBlue limit best x) 1 (moves x)\n    scoreBlue limit best x worst =\n      if limit &lt;= 0\n      then estimate x\n      else min worst $ foldr (scoreRed (limit - 1)) best (moves x)\n\nmain = return ()\n</code></pre>\n\n<p>Notes:</p>\n\n<ul>\n<li>Everything named <code>limit</code> is of type <code>Int</code>.</li>\n<li>Everything named <code>x</code> is of type <code>c</code>, an instance of <code>Cell</code>.</li>\n<li><code>best</code> and <code>worst</code> are <code>Float</code>.</li>\n<li><code>score</code>, <code>estimate</code>, <code>scoreRed</code>, and <code>scoreBlue</code> all return <code>Float</code>.</li>\n<li>I deleted a bunch of code to simplify it enough for this question. Focus on the types and not runtime behavior.</li>\n</ul>\n\n<p>The error message from GHC 7.6.3 is:</p>\n\n<pre><code>[1 of 1] Compiling Main             ( Game.hs, Game.o )\n\nGame.hs:13:12:\n    Couldn't match expected type `c -&gt; c' with actual type `Float'\n    In the return type of a call of `estimate'\n    Probable cause: `estimate' is applied to too many arguments\n    In the expression: estimate x\n    In the expression:\n      if limit &lt;= 0 then\n          estimate x\n      else\n          min worst $ foldr (scoreRed (limit - 1)) best (moves x)\n</code></pre>\n\n<p>Why I found this hard:</p>\n\n<ul>\n<li><p>The actual error is <em>not</em> on line 13 and has nothing to do with <code>estimate</code>.</p></li>\n<li><p>It seemed like the error could be caused by almost any identifier in the program.</p></li>\n<li><p>Sometimes adding explicit type declarations to everything helps, but not here: I don't know how to write type declarations for <code>scoreRed</code> and <code>scoreBlue</code>. If I write</p>\n\n<pre><code>scoreRed :: Int -&gt; Float -&gt; c -&gt; Float\n</code></pre>\n\n<p>then GHC thinks I'm introducing a fresh type variable <code>c</code>, not referring to the type variable <code>c</code> in <code>score</code>'s type. I get different error messages, but not better ones.</p></li>\n</ul>\n\n<p>It looks like the \"please please give me a fish\" version of this question has been asked dozens of times. How about we teach me to fish instead. I'm ready.</p>\n"}, {"tags": ["haskell", "scotty"], "answers": [{"comments": [{"owner": {"reputation": 264, "user_id": 2658199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95cc276d106c19c1c44fc0c0e569d48d?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/2658199/adam"}, "edited": false, "score": 0, "creation_date": 1428422124, "post_id": 29479800, "comment_id": 47150582, "body": "Thanks, you put me on the right lines with Either and the types."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 4, "last_activity_date": 1428388400, "last_edit_date": 1428388400, "creation_date": 1428354816, "answer_id": 29479800, "question_id": 29474867, "link": "https://stackoverflow.com/questions/29474867/catching-exceptions-in-scotty-haskell/29479800#29479800", "title": "Catching exceptions in Scotty / Haskell", "body": "<p>The problem is that the return value of <code>catchViolation</code> lives in the <code>IO</code> monad, but <code>text</code> lives in the  <code>ActionT e IO</code> monad, which is a monad built on top on <code>IO</code> using the <code>ActionT</code> monad transformer.</p>\n\n<p>Monad transformers add additional capabilities to their base monads. In the case of <code>ActionT</code>, it adds things like access to the \"response-in-construction\" (which is why <code>text</code> requires it).</p>\n\n<p>One possible solution is to pull the use of <code>text</code> out of <code>catchViolation</code>. Instead, make <code>catchViolation</code> return an <code>Either</code>, and then, once back into an <code>ActionT</code> context, pattern match on the <code>Either</code> to decide what to do. Something like:</p>\n\n<pre><code>ei &lt;- liftIO $ catchViolation catcher $ fmap Right $ withResource pool\ncase ei of\n    Left str -&gt; text str\n    Right _ -&gt; return ()\nwhere \n    catcher e (UniqueViolation \"mykey\") = return $ Left \"some error\"\n    catcher e _ = return $ Left \"some other error\"\n</code></pre>\n\n<p>There's another solution, more powerful but not as intuitive. It happens that <a href=\"http://hackage.haskell.org/package/scotty-0.9.1/docs/Web-Scotty-Trans.html#t:ActionT\" rel=\"nofollow\"><code>ActionT</code></a> is an instance of  <a href=\"http://hackage.haskell.org/package/monad-control-1.0.0.4/docs/Control-Monad-Trans-Control.html#t:MonadBaseControl\" rel=\"nofollow\"><code>MonadBaseControl</code></a>. This typeclass has <a href=\"http://hackage.haskell.org/package/monad-control-1.0.0.4/docs/Control-Monad-Trans-Control.html#v:liftBaseWith\" rel=\"nofollow\">methods</a> that let you hide all the \"extra layers\" added by monad transformers into a plain value of the base monad. You can then pass that value to some callback-accepting function like <code>catchViolation</code>, and afterwards \"pop out\" all the extra layers back. </p>\n\n<p>(It's a bit like pressing a jack-in-the-box back into its box in order to pass through customs or whatever, and then making it spring out again.)</p>\n\n<p>It would be something like:</p>\n\n<pre><code>control $ \\runInBase -&gt; catchViolation \n     (\\_ _ -&gt; runInBase $ text \"some error\") \n     (runInBase $ liftIO $ withResource $ \n                .... all the query stuff goes here ...)\n</code></pre>\n\n<p>We are using the <a href=\"http://hackage.haskell.org/package/monad-control-1.0.0.4/docs/Control-Monad-Trans-Control.html#v:control\" rel=\"nofollow\">control</a> utility function. <code>control</code> provides you with a magical function (<code>RunInBase m b</code>) that lets you \"put the jack-in-the-box back into the box\". That is, construct an <code>IO</code> value out of an <code>ActionT</code> one. You then pass that value to <code>catchViolation</code>, and <code>control</code> takes care of unpaking the layers encoded in the result, bringing back the full <code>ActionT</code> monad at the end.</p>\n"}, {"comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1428441494, "post_id": 29496373, "comment_id": 47161272, "body": "When pattern-matching, leave a space after the constructor: <code>Left (Just (...</code>. To manipulate the two branches of an <code>Either</code>, you can also use the <code>Bifunctor</code> typeclass from <code>Data.Bifunctor</code>. You could also use the <code>ViewPatterns</code> extension, that would let you do things like <code>Left (constraintViolation -&gt; Just (UniqueViolation &quot;mykey&quot;)) -&gt; ...</code> <a href=\"https://ocharles.org.uk/blog/posts/2014-12-02-view-patterns.html\" rel=\"nofollow noreferrer\">ocharles.org.uk/blog/posts/2014-12-02-view-patterns.html</a>"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1428523481, "post_id": 29496373, "comment_id": 47203067, "body": "One thing: when working in the <code>IO</code> monad, or in a monad based on <code>IO</code>, it&#39;s better to use <code>throwIO</code> instead of <code>throw</code> (lifting it with <code>liftIO</code> as needed). <code>throw</code> is better left for pure code."}], "tags": [], "owner": {"reputation": 264, "user_id": 2658199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95cc276d106c19c1c44fc0c0e569d48d?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/2658199/adam"}, "is_accepted": false, "score": 0, "last_activity_date": 1428486860, "last_edit_date": 1495535251, "creation_date": 1428423687, "answer_id": 29496373, "question_id": 29474867, "link": "https://stackoverflow.com/questions/29474867/catching-exceptions-in-scotty-haskell/29496373#29496373", "title": "Catching exceptions in Scotty / Haskell", "body": "<p>Thanks you put me on the right lines with the <a href=\"https://hackage.haskell.org/package/category-extras-0.52.0/docs/Control-Monad-Either.html\" rel=\"nofollow noreferrer\">Either</a>. I found <em>try</em> in <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Exception.html#v:try\" rel=\"nofollow noreferrer\">Control.Exception</a> which creates an Either from an IO of a:</p>\n\n<pre><code>try :: Exception e =&gt; IO a -&gt; IO (Either e a) \n</code></pre>\n\n<p>I use try to give me an <em>[Either SqlError Int64]</em> from the PostgreSQL Simple execute function then do a map on the left values with the PostgreSQL Simple <a href=\"https://hackage.haskell.org/package/postgresql-simple-0.4.10.0/docs/Database-PostgreSQL-Simple-Errors.html\" rel=\"nofollow noreferrer\">constraintViolation</a> function using <a href=\"http://hackage.haskell.org/package/base-4.7.0.1/docs/Control-Arrow.html\" rel=\"nofollow noreferrer\">Control.Arrow.left</a> which I found at <a href=\"https://stackoverflow.com/a/13504032/2658199\">https://stackoverflow.com/a/13504032/2658199</a>.</p>\n\n<pre><code>constraintViolation :: SqlError -&gt; Maybe ConstraintViolation\n\nleft :: a b c -&gt; a (Either b d) (Either c d) \n</code></pre>\n\n<p>This then gives me the below type to pattern match on</p>\n\n<pre><code>Either (Maybe ConstraintViolation) Int64\n</code></pre>\n\n<p>With the above I've come up with the this which I'm happy with but not sure if idiomatic or can be further improved?</p>\n\n<pre><code>create' :: ActionT Text ConfigM ()\ncreate' = do\n  a :: Affiliate &lt;- jsonData\n  pool  &lt;- lift $ asks pool\n  result &lt;- liftIO $ E.try $ withResource pool $ \\conn -&gt; do\n       PgSQL.execute conn \"INSERT INTO affiliate (id, network, name, status) VALUES (?, ?, ?, ?)\"\n                (slug a, network a, name a, status a)\n  let slugT = fromStrict $ unSlug $ slug a\n  case left constraintViolation result of\n    Right _ -&gt; text $ \"Created: \" `T.append` slugT\n    Left(Just(UniqueViolation \"mykey\")) -&gt; text \"Duplicate key\"\n    _ -&gt; text \"Fatal Error\"\n</code></pre>\n\n<h2>Update</h2>\n\n<p>After the suggestion of using <code>ViewPatterns</code> I've simplified my previous version to the below.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings, ScopedTypeVariables, ViewPatterns #-}\n\ncreate :: ActionT Text ConfigM ()\ncreate = do\n    a :: A.Affiliate &lt;- jsonData\n    pool  &lt;- lift $ asks pool\n    result &lt;- liftIO $ try $ withResource pool $ \\conn -&gt;\n        PgSQL.execute conn \"INSERT INTO affiliate (id, network, name, status) VALUES (?, ?, ?, ?)\"\n          (A.slug a, A.network a, A.name a, A.status a)\n    let slugT = fromStrict $ unSlug $ A.slug a\n    case result of\n        Right _ -&gt; text (\"Created: \" `T.append` slugT) &gt;&gt; status created201\n        Left (constraintViolation -&gt; Just (UniqueViolation _)) -&gt; text (slugT `T.append` \" already exists\") &gt;&gt; status badRequest400\n        Left e -&gt; throw e\n</code></pre>\n"}], "owner": {"reputation": 264, "user_id": 2658199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95cc276d106c19c1c44fc0c0e569d48d?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/2658199/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1428486860, "creation_date": 1428336263, "question_id": 29474867, "link": "https://stackoverflow.com/questions/29474867/catching-exceptions-in-scotty-haskell", "title": "Catching exceptions in Scotty / Haskell", "body": "<p>I'm just starting out learning Haskell and am stuck on how to handle exceptions in Scotty.</p>\n\n<p>I have the basic function below. It gets a JSON POST, converts it in to a Haskell data record, gets a hold of a postgres connection pool from the config reader and then inserts the record in to the database.</p>\n\n<pre><code>create :: ActionT Text ConfigM ()\ncreate = do\n    a :: Affiliate &lt;- jsonData\n    pool  &lt;- lift $ asks pool\n    _ &lt;- liftIO $ catchViolation catcher $ withResource pool $ \\conn -&gt;\n        PgSQL.execute conn \"INSERT INTO affiliate (id, network, name, status) VALUES (?, ?, ?, ?)\"\n            (slug a, network a, name a, status a)\n    let s = fromStrict $ unSlug $ slug a\n    text $ \"Created: \" `T.append` s\nwhere\n    catcher e (UniqueViolation \"mykey\") = throw e --text \"Error\"\n    catcher e _ = throw e\n</code></pre>\n\n<p>This function compiles ok but when I change the UniqueViolation to return text it fails to compile.</p>\n\n<pre><code>catcher e (UniqueViolation \"mykey\") = text \"Error\"\n</code></pre>\n\n<p>The compilation error given is:</p>\n\n<pre><code>Couldn't match type \u2018ActionT e0 m0 ()\u2019 with \u2018IO Int64\u2019\n    Expected type: PgSQL.SqlError -&gt; ConstraintViolation -&gt; IO Int64\n      Actual type: PgSQL.SqlError\n               -&gt; ConstraintViolation -&gt; ActionT e0 m0 ()\nIn the first argument of \u2018catchViolation\u2019, namely \u2018catcher\u2019\nIn the expression: catchViolation catcher\n</code></pre>\n\n<p><em>catchViolation</em> comes from the <a href=\"https://hackage.haskell.org/package/postgresql-simple-0.4.10.0/docs/Database-PostgreSQL-Simple-Errors.html\" rel=\"nofollow\">Database.PostgreSQL.Simple.Errors</a> and has the below signiture:</p>\n\n<pre><code>catchViolation :: (SqlError -&gt; ConstraintViolation -&gt; IO a) -&gt; IO a -&gt; IO a \n</code></pre>\n\n<p>I know part of the issue is it's getting the IO Int64 from PgSQL.execute but a ActionT from the catcher but not sure how to resolve the types or a more idiomatic way of doing this.</p>\n"}, {"tags": ["haskell", "types", "language-design", "type-systems"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user395760"}, "edited": false, "score": 3, "creation_date": 1428326425, "post_id": 29472000, "comment_id": 47105403, "body": "<i>Arbitrary</i> subsets are not decidable. A cassic example is the subset of positive integers specified by &quot;is an encoding of a program that terminates in finite time for all inputs&quot; (this is a variant of the halting problem). If you wanted that subset as a type, the compiler can&#39;t even decide whether a program with full type annotations is correct."}, {"owner": {"reputation": 713, "user_id": 2123737, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/319770365a555574de7b3994c63c3c27?s=128&d=identicon&r=PG", "display_name": "Syd Kerckhove", "link": "https://stackoverflow.com/users/2123737/syd-kerckhove"}, "edited": false, "score": 0, "creation_date": 1428326508, "post_id": 29472000, "comment_id": 47105459, "body": "Does it suffice to replace <code>arbitrary subsets</code> with <code>decidable</code> or <code>easily-computable</code> subsets?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user395760"}, "edited": false, "score": 1, "creation_date": 1428326706, "post_id": 29472000, "comment_id": 47105560, "body": "It may suffice to make type checking decidabe. But the result will still be as complicated as dependent types (in fact, there&#39;s probably a dependent type theory that expresses exactly those types)."}], "answers": [{"comments": [{"owner": {"reputation": 713, "user_id": 2123737, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/319770365a555574de7b3994c63c3c27?s=128&d=identicon&r=PG", "display_name": "Syd Kerckhove", "link": "https://stackoverflow.com/users/2123737/syd-kerckhove"}, "edited": false, "score": 0, "creation_date": 1428326016, "post_id": 29472025, "comment_id": 47105212, "body": "Are those used in practice? If not, why not?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 713, "user_id": 2123737, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/319770365a555574de7b3994c63c3c27?s=128&d=identicon&r=PG", "display_name": "Syd Kerckhove", "link": "https://stackoverflow.com/users/2123737/syd-kerckhove"}, "edited": false, "score": 5, "creation_date": 1428326382, "post_id": 29472025, "comment_id": 47105384, "body": "@Syd: Try programming something in one of those languages. It&#39;s not, like, unfeasible, but you start thinking so much about proofs that you hardly get to the actual programming part anymore... at least that was my experience so far, though I consider myself rather tenacious in making everything mathematically beautiful etc.. That would be why they&#39;re hardly used in practice. Perhaps dependent type should actually be used more, but I doubt Agda, Idris or the like will make it in the forseeable future. Coq has a head-start; and Haskell itself gets ever more \u201cdependent\u201d with GHC extensions."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 3, "creation_date": 1428326540, "post_id": 29472025, "comment_id": 47105477, "body": "There are smaller systems than full dependent types that do what&#39;s desired here.  Refinement types a la Liquid Haskell, for instance."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1428328458, "post_id": 29472025, "comment_id": 47106484, "body": "@Carl: I think that deserves to be an answer of its own."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1428332051, "post_id": 29472025, "comment_id": 47108422, "body": "@leftaroundabout, have you read <a href=\"http://stackoverflow.com/a/13241158/3237465\">this</a>? If you use a dependently typed language and don&#39;t need dependent types for solving some problem, just do not use them. You can turn off a termination checker, use <code>Type:Type</code> (in Agda) (Coq and Idris have typical ambiguity, which is almost invisible for a user), postulate <code>undefined</code> and do whatever other stuff to get just a usual functional language, only quite more powerful."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1428332101, "post_id": 29472025, "comment_id": 47108453, "body": "On the other hand it&#39;s a <a href=\"https://personal.cis.strath.ac.uk/conor.mcbride/pub/hasochism.pdf\" rel=\"nofollow noreferrer\">hasochism</a> to enforce certain invariants in a poorly typed language like Haskell. Besides, Agda also has brilliant module system, type classes machinery and reflection opportunities. Agda is a bit impractical at the moment, but IMO Idris should replace Haskell. Just have a look at the coolest <a href=\"https://www.cs.st-andrews.ac.uk/~eb/drafts/effects.pdf\" rel=\"nofollow noreferrer\">effects</a> system ever."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1428334792, "post_id": 29472025, "comment_id": 47109951, "body": "Joining user3237465 here. Having proper dependent types ceteris paribus subtracts nothing from usability, performance, maintainability, ease of learning the language, etc.. Current dependent languages are obscure in software development for unrelated reasons. Also, supporting GHC-level verification capabilities is much simpler with a full-dependent core language than with GHC&#39;s creaking many-times-extended core."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1428365698, "post_id": 29472025, "comment_id": 47123919, "body": "@Andr&#225;sKov&#225;cs: yeah. I suppose most programmers give just up when, after several attempts to find a backend that actually gives \u201csomething that actually does something!\u201d and quite a while of compiling stuff called <code>Relation.Nullary.Decidable</code>, their Hello World Agda program drives the compiler into consuming all memory and hangs the system..."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1428586278, "post_id": 29472025, "comment_id": 47231785, "body": "FTR, it wasn&#39;t my purpose to give dependent types negative advertisement. I have now given Idris a shot, and was delighted to find out it really feels much more lightweight than Agda or Coq, allows compiling simple programs to actual executables with no extra hurdles at all, and overall looks very familiar for a Haskeller \u2013 but at the same time it allows value-level magic in types, which would be really much uglier in Haskell. \u2014 Again, that&#39;s nothing said against Agda (which includes many ideas that I find sound really amazing), but is just too unwieldy to be attractive to most programmers."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 8, "last_activity_date": 1428326944, "last_edit_date": 1428326944, "creation_date": 1428325962, "answer_id": 29472025, "question_id": 29472000, "link": "https://stackoverflow.com/questions/29472000/missing-feature-in-programming-languages/29472025#29472025", "title": "&#39;Missing&#39;(?) feature in programming languages?", "body": "<p>You are looking for <a href=\"http://en.wikipedia.org/wiki/Dependent_type\">Dependent types</a>. Idris, Agda and Coq are well known in this category.</p>\n"}, {"tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": false, "score": 2, "last_activity_date": 1428332710, "creation_date": 1428332710, "answer_id": 29473873, "question_id": 29472000, "link": "https://stackoverflow.com/questions/29472000/missing-feature-in-programming-languages/29473873#29473873", "title": "&#39;Missing&#39;(?) feature in programming languages?", "body": "<p>You can actually mostly define that in Haskell because it's basically an <code>Int</code> plus some semantics. For example, you have to decide what you're going to do with subtractions that go beneath the threshold, like what <code>(-) 6 7</code> gives. (A common convention with Peano arithmetic is to give 0 -- so in this case it would return <code>6</code>, the least value of the system.) You also need to choose whether you're going to <code>error</code> on a <code>fromInteger 3</code> or else whether you're going to store, say, <code>newtype IntGT5 = IntGT5 (Maybe Int)</code> instead of <code>newtype IntGT5 = IntGT5 Int</code>. You have to write all of the typeclass instances yourself, and once you've done that you'll have an appropriate type.</p>\n\n<p>If you've got an abiding interest in this problem, two things to pay attention to are <a href=\"http://goto.ucsd.edu/~rjhala/liquid/haskell/blog/about/\" rel=\"nofollow\">liquid types</a> and <a href=\"https://www.era.lib.ed.ac.uk/handle/1842/3937\" rel=\"nofollow\">subtyping</a>. Let me tell you a little about the latter.</p>\n\n<p>Alan Kay invented OOP to be something different than what it is (he wanted every program to be written as a network of communicating computers), but what it turned out to be in the modern world is basically a way to do complex subtyping. \"Duck typing\", for example, is about creating an \"intersection type\" of a bunch of really general types (like `things with a \"waddle\" method, things with a \"quack\" method) which other types are subtypes of. So subtyping is very naturally OOP. </p>\n\n<p>The thesis I've linked you to points out another interesting thing about subtyping: you can use subtypes to erase the distinction between type and value. Of course, making types into values does not need subtyping; it is e.g. already the case in the Python language, where you can call <code>type(x)</code> to get an object which represents the type of the object. But the interesting thing is that as subtypes go, you can just define a type <code>3 :: Int</code> (<code>3</code> of kind <code>Int</code>) which is the type of all <code>Int</code>s which are equal to <code>3</code>. It is in essence a unit/void type which is a subtype of a bigger class. By blurring the distinction between <code>3</code> of kind <code>Int</code> and <code>3</code> of type <code>Int</code> you get every value being a type as well. You could then do something JSON-like with this approach, where <code>{x: Int, y: 3 :: Int}</code> is a type of objects containing two properties <code>x</code> and <code>y</code> where <code>x</code> is any <code>Int</code> and <code>y</code> is the integer <code>3 :: Int</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 0, "last_activity_date": 1428345297, "creation_date": 1428345297, "answer_id": 29477332, "question_id": 29472000, "link": "https://stackoverflow.com/questions/29472000/missing-feature-in-programming-languages/29477332#29477332", "title": "&#39;Missing&#39;(?) feature in programming languages?", "body": "<p>The <a href=\"http://en.wikipedia.org/wiki/Ada_%28programming_language%29#Data_types\" rel=\"nofollow\">Ada language</a> supports ranged numeric types.  I can't really comment intelligently on this language, but I've been led to understand by folks who know it that the range checks are enforced by runtime checks inserted by the compiler.</p>\n\n<p>Relational database theory also has concepts that tie to this. The set of values that an attribute can take is its <a href=\"http://en.wikipedia.org/wiki/Data_domain\" rel=\"nofollow\">domain</a>, which is a function of its data type  and the <a href=\"http://en.wikipedia.org/wiki/Relational_database#Constraints\" rel=\"nofollow\">constraints</a> on it.  Actual RDBMSs often do not implement these concepts in their full generality, though.</p>\n\n<p>Dependent types are a much more general system that can encode this sort of constraint, and many others.  My capsule explanation of dependent types is like this: they are a way of designing a programming language that contains <strong>proofs as first-class values</strong>.  A proof is a value that, by virtue its existence and the rules that it obeys, guarantees the truth of a <em>proposition</em> (a.k.a. \"sentence,\" \"statement,\" etc.).</p>\n\n<p>So under dependent types, you can have a type <code>x &gt; 5</code> whose values are proofs that <code>x</code> is larger than five.  If you have an actual value of this type, then it really is true that <code>x</code> is larger than five, and thus the code where this proof is in scope may safely proceed under that assumption.  You can package up the number and the proof together using a <strong>dependent sum type</strong> that we can notate as <code>\u2203x : Int. x &gt; 5</code>, whose values are <em>pairs</em> such that:</p>\n\n<ol>\n<li>The first element is an integer <code>x</code></li>\n<li>The second element is a proof of <code>x &gt; 5</code></li>\n</ol>\n"}], "owner": {"reputation": 713, "user_id": 2123737, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/319770365a555574de7b3994c63c3c27?s=128&d=identicon&r=PG", "display_name": "Syd Kerckhove", "link": "https://stackoverflow.com/users/2123737/syd-kerckhove"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 1, "closed_date": 1428347985, "accepted_answer_id": 29472025, "answer_count": 3, "score": 3, "last_activity_date": 1428345297, "creation_date": 1428325851, "question_id": 29472000, "link": "https://stackoverflow.com/questions/29472000/missing-feature-in-programming-languages", "closed_reason": "Duplicate", "title": "&#39;Missing&#39;(?) feature in programming languages?", "body": "<p>Let's take Haskell as an example, as it gets the closest to what I'm about to describe of the languages I know.</p>\n\n<p>A type, <code>Int</code> for example, can be viewed as the set of all possible values (of that type).\nWhy is it that we only get to work with very specific sets?\n<code>Int</code>, <code>Double</code>, etc... and not with all their subsets in the type system.</p>\n\n<p>I would love a language where we can define arbitrary types like <code>Int greater than 5</code>. Are there examples of such languages? If not, why not? </p>\n"}, {"tags": ["haskell", "recursion", "ocaml", "algebraic-data-types", "mutual-recursion"], "answers": [{"comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 1, "creation_date": 1428325627, "post_id": 29471895, "comment_id": 47105041, "body": "Explicit mutual recursion. I like that more than the Haskell syntax. Explicit is always better than implicit."}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 2, "creation_date": 1428326755, "post_id": 29471895, "comment_id": 47105584, "body": "It&#39;s actually annoyingly slightly less than totally explicit. What would be maximally explicit would be <code>type rec foo = Foo of bar and bar = Bar of foo</code>. You run into (small) issues when, for instance, there&#39;s an ambient type <code>t</code> and you&#39;d like to make a new type <code>t</code> in a submodule which aliases the ambient <code>t</code>, but <code>type t module X = struct type t = t end</code> is an error because it assumes you mean to construct the infinite type <code>type x = x</code>."}, {"owner": {"reputation": 28350, "user_id": 2625442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a48a497d3aae41354bc1189d57db2c3?s=128&d=identicon&r=PG", "display_name": "ivg", "link": "https://stackoverflow.com/users/2625442/ivg"}, "edited": false, "score": 0, "creation_date": 1428328987, "post_id": 29471895, "comment_id": 47106784, "body": "there is an interesting several years <a href=\"http://caml.inria.fr/mantis/view.php?id=6623\" rel=\"nofollow noreferrer\">discussion</a> on this topic, that results in a new <code>nonrec</code> keyword. In 4.03 we will have <code>type nonrec t</code> and even (I&#39;m not sure whether it ended up in the final patch) <code>type rec t</code>."}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "edited": false, "score": 0, "creation_date": 1428350669, "post_id": 29471895, "comment_id": 47118034, "body": "So <code>type rec</code> is still the default? You can just add the declaration to be extra explicit?"}], "tags": [], "owner": {"reputation": 28350, "user_id": 2625442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a48a497d3aae41354bc1189d57db2c3?s=128&d=identicon&r=PG", "display_name": "ivg", "link": "https://stackoverflow.com/users/2625442/ivg"}, "is_accepted": false, "score": 12, "last_activity_date": 1428325445, "creation_date": 1428325445, "answer_id": 29471895, "question_id": 29471873, "link": "https://stackoverflow.com/questions/29471873/mutually-recursive-types-in-ocaml/29471895#29471895", "title": "Mutually recursive types in OCaml", "body": "<p>Use <code>and</code></p>\n\n<pre><code>type foo = Foo of bar\n and bar = Bar of foo\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28350, "user_id": 2625442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a48a497d3aae41354bc1189d57db2c3?s=128&d=identicon&r=PG", "display_name": "ivg", "link": "https://stackoverflow.com/users/2625442/ivg"}, "edited": false, "score": 1, "creation_date": 1428329486, "post_id": 29472258, "comment_id": 47107061, "body": "actually, your second type definition doesn&#39;t work, it will say that type definition is cyclic. The correct way would be <code>type &#39;a t = Stream of (unit -&gt; (&#39;a * &#39;a t) option)</code>"}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "reply_to_user": {"reputation": 28350, "user_id": 2625442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a48a497d3aae41354bc1189d57db2c3?s=128&d=identicon&r=PG", "display_name": "ivg", "link": "https://stackoverflow.com/users/2625442/ivg"}, "edited": false, "score": 0, "creation_date": 1428350561, "post_id": 29472258, "comment_id": 47117993, "body": "Oh, whoops! Yep, didn&#39;t check it in the interpreter. Fixed now, thanks."}], "tags": [], "owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "is_accepted": true, "score": 4, "last_activity_date": 1428358537, "last_edit_date": 1428358537, "creation_date": 1428326934, "answer_id": 29472258, "question_id": 29471873, "link": "https://stackoverflow.com/questions/29471873/mutually-recursive-types-in-ocaml/29472258#29472258", "title": "Mutually recursive types in OCaml", "body": "<p><code>ivg</code> answered your question, but here's a non-trivial mutually recursive type.</p>\n\n\n\n<pre class=\"lang-ml prettyprint-override\"><code>module Stream = struct\n\n  type 'a t    = unit -&gt; 'a node\n   and 'a node = Nil\n               | Cons of 'a * 'a t \n\nend\n</code></pre>\n\n<p>This is the genuine type of spine-lazy streams. That said, you could construct it without mutually recursive types</p>\n\n<pre class=\"lang-ml prettyprint-override\"><code>type 'a t = Stream of (unit -&gt; ('a * 'a t) option)\n</code></pre>\n\n<p>Offhand my thought is that you can always reduce a family of mutually recursive types into a single one if you like (though perhaps not in OCaml\u2014the encoding I'm thinking of would make non-trivial use of dependent type indices), but it can certainly be more clear directly.</p>\n"}], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2259, "favorite_count": 0, "accepted_answer_id": 29472258, "answer_count": 2, "score": 3, "last_activity_date": 1428358537, "creation_date": 1428325381, "question_id": 29471873, "link": "https://stackoverflow.com/questions/29471873/mutually-recursive-types-in-ocaml", "title": "Mutually recursive types in OCaml", "body": "<p>In Haskell you can do the following:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Prelude&gt; data Foo = Foo Bar; data Bar = Bar Foo\n</code></pre>\n\n<p>How can you do the same thing in OCaml? I tried:</p>\n\n<pre class=\"lang-ml prettyprint-override\"><code>                    ___\n# type foo = Foo of bar;; type bar = Bar of foo;;\nError: Unbound type constructor bar\n</code></pre>\n\n<p>Is it even possible to define mutually recursive data types in OCaml? If not then why?</p>\n\n<p>Comparing data definitions to let expressions: mutually recursive data types correspond to using <code>let rec</code> (or more appropriately <code>type rec</code> for want of a better phrase). What are the advantages of being able to define mutually recursive data types? My foobar example is trivial. Can you think of any non-trivial uses of mutually recursive data types?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 1, "creation_date": 1428312116, "post_id": 29468407, "comment_id": 47098983, "body": "A function of type <code>EnvV</code> takes <code>Variable</code> a.k.a. <code>String</code>, while you&#39;re applying it to <code>Store</code>. Please elaborate what you want to do."}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 1, "creation_date": 1428312316, "post_id": 29468407, "comment_id": 47099058, "body": "Unrelated note: Parentheses are not needed for function application (so you should write <code>envV store</code> instead of <code>envV(store)</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": false, "score": 1, "last_activity_date": 1428313157, "creation_date": 1428313157, "answer_id": 29468707, "question_id": 29468407, "link": "https://stackoverflow.com/questions/29468407/haskell-function-definition/29468707#29468707", "title": "Haskell function definition", "body": "<p>Your question seems to simplify to:</p>\n\n<pre><code>type State = String -&gt; Integer\ntype Store = Integer -&gt; Integer\n\nsearch :: State -&gt; Store -&gt; State\n</code></pre>\n\n<p>There are an infinite number of ways to implement this, but I'm going to guess that the result you want is simply the composition of the two functions.</p>\n\n<pre><code>search state store = store . state\n</code></pre>\n\n<p>Or more simply</p>\n\n<pre><code>search = flip (.)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1428313501, "last_edit_date": 1428313501, "creation_date": 1428313179, "answer_id": 29468711, "question_id": 29468407, "link": "https://stackoverflow.com/questions/29468407/haskell-function-definition/29468711#29468711", "title": "Haskell function definition", "body": "<p>The type</p>\n\n<pre><code>search :: EnvV -&gt; Store -&gt; State\n</code></pre>\n\n<p>means</p>\n\n<pre><code>search :: EnvV -&gt; Store -&gt; Variable -&gt; Z\n</code></pre>\n\n<p>Hence, you can use</p>\n\n<pre><code>search envV store var = store (envV var)\n</code></pre>\n\n<p>because <code>envV var</code> is a <code>Location</code>, which is then applied to <code>store</code> to produce a <code>Z</code>.</p>\n\n<p>Note that the following code is correct, even if it's a bit puzzling</p>\n\n<pre><code>search :: EnvV -&gt; Store -&gt; State\nsearch envV store var = store (envV var)\n</code></pre>\n\n<p>It's puzzling because its type shows two arguments, when the code below takes three. Equivalently, the code above is more commonly written as</p>\n\n<pre><code>search :: EnvV -&gt; Store -&gt; State\nsearch envV store = \\var -&gt; store (envV var)\n</code></pre>\n\n<p>so that even in the definition we can find two arguments, and a result value which is actually a function of type <code>State</code> which maps every variable <code>var</code> into its value.</p>\n\n<p>The code above can then further be simplified to use the function composition operator <code>.</code>, as @ChrisMartin already showed.</p>\n"}, {"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 0, "last_activity_date": 1428313618, "last_edit_date": 1428313618, "creation_date": 1428313220, "answer_id": 29468720, "question_id": 29468407, "link": "https://stackoverflow.com/questions/29468407/haskell-function-definition/29468720#29468720", "title": "Haskell function definition", "body": "<p>Try matching the types:</p>\n\n<p>You have <code>EnvV</code> which is <code>Variable -&gt; Location</code>\nand <code>Store</code> which is <code>Location -&gt; Z</code></p>\n\n<p>And you want the output of <code>State</code> which is <code>Variable -&gt; Z</code></p>\n\n<p>Can you see the connection between them ? You have to eliminate <code>Location</code> between them. </p>\n\n<pre><code>search :: EnvV -&gt; Store -&gt; State\nsearch envV store = \\x -&gt; store (envV x)\n</code></pre>\n\n<p>Since you want <code>Variable</code> in the output, introduce <code>x</code>  which denotes that. Then apply it to <code>envV</code> which will give you <code>Location</code> . Now apply that to <code>store</code> which will give <code>Z</code>. This will give you a type of <code>Variable -&gt; Z</code> which is expected by you.</p>\n\n<p>This can be written more concisely:</p>\n\n<pre><code>search :: EnvV -&gt; Store -&gt; State\nsearch envV store = store . envV\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4753887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af896967d6d082314f38df409a1cdf98?s=128&d=identicon&r=PG&f=1", "display_name": "Eleftherios", "link": "https://stackoverflow.com/users/4753887/eleftherios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 29468720, "answer_count": 3, "score": 0, "last_activity_date": 1428452414, "creation_date": 1428311845, "last_edit_date": 1428452414, "question_id": 29468407, "link": "https://stackoverflow.com/questions/29468407/haskell-function-definition", "title": "Haskell function definition", "body": "<p>I'm having trouble defining a function in Haskell. What I want to do is input a variable of type <code>EnvV</code> and one of type <code>Store</code> and return a <code>State</code> type variable:</p>\n\n<pre><code>type Variable = String\ntype Z = Integer\ntype T = Bool\ntype State = Variable -&gt; Z\ntype Location = Z\ntype Store = Location -&gt; Z\ntype EnvV = Variable -&gt; Location\n\nsearch :: EnvV -&gt; Store -&gt; State\nsearch envV store = envV(store)  \n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "sml", "fold", "smlnj"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1428304276, "creation_date": 1428304276, "answer_id": 29466943, "question_id": 29465217, "link": "https://stackoverflow.com/questions/29465217/sml-does-the-function-foldl-take-the-list-predefined-or-list-could-be-accumula/29466943#29466943", "title": "SML: Does the function foldl take the list predefined, or list could be accumulated during the process?", "body": "<p>Using both recursion and <code>foldl</code> is unusual, especially in basic exercises. I believe the professor is telling you to use <code>foldl</code> <em>instead</em> of recursion.</p>\n\n<p>As you state, this requires you to define a list and pass it to <code>foldl</code>. Often, if you need to loop over the numbers from <code>1</code> to <code>n</code>, you start from the list of such numbers.</p>\n"}], "owner": {"reputation": 2699, "user_id": 1804697, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0513f54d141d2d01ce049f4a082979bf?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1804697/ralph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 29466943, "answer_count": 1, "score": 1, "last_activity_date": 1428304276, "creation_date": 1428293304, "last_edit_date": 1428299741, "question_id": 29465217, "link": "https://stackoverflow.com/questions/29465217/sml-does-the-function-foldl-take-the-list-predefined-or-list-could-be-accumula", "title": "SML: Does the function foldl take the list predefined, or list could be accumulated during the process?", "body": "<p>The following is related to a homework question. Not looking for an answer, looking for a <strong>clarification</strong></p>\n\n<p>I am supposed to find the n-th Catalan number which is based on a recurrence rel that is not relevant to my question.</p>\n\n<p>My question is: </p>\n\n<p>The function foldl takes a function, an accumulator, and a list</p>\n\n<p>When I apply foldl, it will look something like that\nfoldl function_name initial_value_for_accumulator list</p>\n\n<p>Our professor says in the question the following:</p>\n\n<p>Implement a function <code>Catalan:int -&gt; int</code> which, when given an integer <code>n</code>, computes\nthe n-th Catalan number. For full credit, use the higher order function <code>foldl</code> in your solution.</p>\n\n<p>Foldl has to take a list. So, the question is: Am I able to pass a list that is being built up during the recursion? or I have to compute the list and then pass it to foldl?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 5, "creation_date": 1428282975, "post_id": 29464102, "comment_id": 47091286, "body": "<code>foldr (&gt;&gt;) (return ())</code> is <a href=\"https://www.haskell.org/hoogle/?hoogle=Monad+m+%3D%3E+%5Bm%28%29%5D+-%3E+m%28%29\" rel=\"nofollow noreferrer\">better known as <code>sequence_</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 2, "last_activity_date": 1428284082, "last_edit_date": 1428284082, "creation_date": 1428283351, "answer_id": 29464173, "question_id": 29464102, "link": "https://stackoverflow.com/questions/29464102/io-function-to-print-chars-with/29464173#29464173", "title": "IO function to print Chars with (&gt;&gt;)", "body": "<p>Suppose I write <code>f \"hey\"</code>. We begin with a <code>String</code></p>\n\n<pre><code>f \"hey\"\n</code></pre>\n\n<p>which is really a <code>[Char]</code></p>\n\n<pre><code>f ['h', 'e', 'y']\n</code></pre>\n\n<p>and we substitute it into the definition of <code>f</code></p>\n\n<pre><code>foldr (&gt;&gt;) (return ()) (map putChar ['h', 'e', 'y']) &gt;&gt; putChar '\\n'\n                                    ~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>where we generate a list of actions to print the characters <code>[IO ()]</code></p>\n\n<pre><code>foldr (&gt;&gt;) (return ()) [putChar 'h', putChar 'e', putChar 'y'] &gt;&gt; putChar '\\n'\n                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n</code></pre>\n\n<p>and use <code>foldr</code> to sequence them together using <code>&gt;&gt;</code></p>\n\n<pre><code>putChar 'h' &gt;&gt; putChar 'e' &gt;&gt; putChar 'y' &gt;&gt; return () &gt;&gt; putChar '\\n'\n</code></pre>\n\n<p>which is the desugared version of <code>do</code> statements that don\u2019t bind return values with <code>&lt;-</code></p>\n\n<pre><code>do\n  putChar 'h'\n  putChar 'e'\n  putChar 'y'\n  return ()\n  putChar '\\n'\n</code></pre>\n\n<p>So <code>&gt;&gt;</code> or an equivalent function is required, because what this function is doing is building up an <code>IO</code> action that prints each character in the <code>String</code> you give it, exactly as if you had written a series of statements in <code>do</code> notation.</p>\n\n<p>Of course, this is a common thing to do, so <code>foldr (&gt;&gt;) (return ())</code> is called <code>Control.Monad.sequence_</code> and <code>sequence_ . map f</code> is called <code>Control.Monad.mapM_ f</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1428285038, "post_id": 29464183, "comment_id": 47091727, "body": "without typing <code>&gt;&gt;</code>, but it&#39;s worth noting that <code>do { putChar x ; f&#39; xs }</code> is desugared by the compiler to your second case."}], "tags": [], "owner": {"reputation": 2483, "user_id": 1729005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a471f843e0b60ef6683f2671d3fb9fe?s=128&d=identicon&r=PG", "display_name": "axblount", "link": "https://stackoverflow.com/users/1729005/axblount"}, "is_accepted": false, "score": 5, "last_activity_date": 1428327048, "last_edit_date": 1428327048, "creation_date": 1428283443, "answer_id": 29464183, "question_id": 29464102, "link": "https://stackoverflow.com/questions/29464102/io-function-to-print-chars-with/29464183#29464183", "title": "IO function to print Chars with (&gt;&gt;)", "body": "<p>In the context of the IO monad, <code>&gt;&gt;</code> performs one action followed by another, without passing any data between. It's just bind (<code>&gt;&gt;=</code>) for when you don't care about the return value.</p>\n\n<p><code>putChar x</code>, where <code>x</code> is some Char, has type <code>IO ()</code>. It's an IO action that returns <code>()</code> ('nothing'). <code>map putChar xs</code> takes a list of characters and returns a list of IO actions, all of which return 'nothing'.</p>\n\n<p>By <code>foldr</code>ing this list with <code>&gt;&gt;</code>, we're just performing each action in sequence, not caring about any intermediate results. As @leftaroundabout noted in the comments, this is commonly expressed with <code>sequence_</code>.</p>\n\n<p>And yes, we certainly could write this without using <code>&gt;&gt;</code>.</p>\n\n<pre><code>f' :: String -&gt; IO ()\nf' [] = return ()\nf' (x:xs) = do putChar x\n               f' xs\n-- or\nf [] = return ()\nf' (x:xs) = (putChar x) &gt;&gt; f' xs\n-- or\nf' xs = sequence_ $ map putChar xs\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>@rampion makes a good point in the comments that I've only really obscured the <code>&gt;&gt;</code>. In all three of those cases there's a <code>&gt;&gt;</code> somewhere behind the scenes. Here's the function written using the normal bind operator, <code>&gt;&gt;=</code>.</p>\n\n<pre><code>-- same base case\nf' (x:xs) = putChar x &gt;&gt;= \\_ -&gt; f' xs\n</code></pre>\n\n<p>But again I've cheated and just expanded the definition of <code>&gt;&gt;</code> in terms of <code>&gt;&gt;=</code>. We're composing functions inside of a monad. We have to use <code>&gt;&gt;=</code> or <code>&gt;&gt;=</code> somewhere, otherwise why use a monad?</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 0, "last_activity_date": 1428353050, "creation_date": 1428353050, "answer_id": 29479356, "question_id": 29464102, "link": "https://stackoverflow.com/questions/29464102/io-function-to-print-chars-with/29479356#29479356", "title": "IO function to print Chars with (&gt;&gt;)", "body": "<blockquote>\n  <p>Could this function have been written without using <code>&gt;&gt;</code>?</p>\n</blockquote>\n\n<p>There are three ways to answer to this.  The first one is: yes, it could have been implemented with <code>&gt;&gt;=</code>, because <code>&gt;&gt;</code> can be reduced to <code>&gt;&gt;=</code>:</p>\n\n<pre><code>a &gt;&gt; b = a &gt;&gt;= \\_ -&gt; b\n</code></pre>\n\n<p>The second one is: not really, because any real implementation in Haskell is going to bottom out to <code>&gt;&gt;</code> or some way of writing <code>&gt;&gt;</code> it in terms of <code>&gt;&gt;=</code>.</p>\n\n<p>The third, and much more complicated answer is: yes, in a sense, because this function fundamentally doesn't use the full power of monads, only that of <em>monoids</em>.  <code>IO ()</code> is a monoid with <code>&gt;&gt;</code> as its associative operation and <code>return ()</code> as its identity element.  So what the function is doing, fundamentally, is what the <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Foldable.html\" rel=\"nofollow\"><code>foldMap</code> operation from the <code>Foldable</code> class</a> does\u2014reduce the list to a single value by mapping the element type to an appropriate monoid.</p>\n\n<p>You take the sum of a list of persons' salaries by mapping each person to their salary and folding with <code>+</code> and <code>0</code> monoid.  You print a sequence of characters by mapping each character to the <code>IO ()</code> action that prints it and then folding with the <code>&gt;&gt;</code> and <code>return ()</code>.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1428353050, "creation_date": 1428282712, "last_edit_date": 1428305079, "question_id": 29464102, "link": "https://stackoverflow.com/questions/29464102/io-function-to-print-chars-with", "title": "IO function to print Chars with (&gt;&gt;)", "body": "<p><a href=\"http://www.cambridge.org/us/academic/subjects/computer-science/programming-languages-and-applied-logic/thinking-functionally-haskell\" rel=\"nofollow\">Thinking Functionally in Haskell</a> presents the following function:</p>\n\n<pre><code>f :: String -&gt; IO ()\nf xs = foldr (&gt;&gt;) (return ()) (map putChar xs) &gt;&gt; putChar '\\n'\n</code></pre>\n\n<p>I'm confused by the <code>foldr (&gt;&gt;)</code>.</p>\n\n<pre><code>ghci&gt; :t foldr (&gt;&gt;)\nfoldr (&gt;&gt;) :: Monad m =&gt; m b -&gt; [m a] -&gt; m b\n</code></pre>\n\n<p>It looks like the purpose of using <code>(&gt;&gt;)</code> here was to \"lift\" <code>Monad m</code> onto the remaining <code>foldr</code> arguments, no?</p>\n\n<p>Could this function have been written without using <code>&gt;&gt;</code>?</p>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1428286128, "post_id": 29464065, "comment_id": 47091924, "body": "Could you explain more about the lens using the traditional approach, in particular what can&#39;t be achieved with type families, perhaps with a simple example?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1428321232, "post_id": 29464065, "comment_id": 47103003, "body": "@Clinton: I thought about it; <code>lens</code> <i>could</i> probably be expressed with a <code>*-&gt;*-&gt;Constraint</code> functor class (albeit rather more awkwardly). I added a different example."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1428321132, "last_edit_date": 1428321132, "creation_date": 1428282347, "answer_id": 29464065, "question_id": 29463811, "link": "https://stackoverflow.com/questions/29463811/any-advantage-of-using-type-constructors-in-type-classes/29464065#29464065", "title": "Any advantage of using type constructors in type classes?", "body": "<p>Well, for one thing the traditional functor class is just much simpler. That alone is a valid reason to prefer it, even though this is Haskell <a href=\"https://www.python.org/dev/peps/pep-0020/\" rel=\"nofollow\">and not Python</a>. And it also represents the mathematical idea better of what a functor is supposed to be: a mapping from objects to objects (<code>f :: *-&gt;*</code>), with extra property (<code>-&gt;Constraint</code>) that each (<code>forall (a::*) (b::*)</code>) morphism (<code>a-&gt;b</code>) is lifted to a morphism on the corresponding object mapped to (<code>-&gt; f a-&gt;f b</code>). <br>None of that can be seen very clearly in the <code>* -&gt; * -&gt; Constraint</code> version of the class, or its TypeFamilies equivalent.</p>\n\n<p>On a more practical account, yes, there are also things you can only do with the <code>(*-&gt;*)-&gt;Constraint</code> version.</p>\n\n\n\n<p>In particular, what this constraint guarantees you right away is that <em>all</em> Haskell types are valid objects you can put into the functor, whereas for <code>MultiFunctor</code> you need to check every possible contained type, one by one. Sometimes that's just not possible (or is it?), like when you're mapping over infinitely many types:</p>\n\n<pre><code>data Tough f a = Doable (f a)\n               | Tough (f (Tough f (a, a)))\n\ninstance (Applicative f) = Semigroup (Tough f a) where\n  Doable x &lt;&gt; Doable y = Tough . Doable $ (,)&lt;$&gt;x&lt;*&gt;y\n  Tough xs &lt;&gt; Tough ys = Tough $ xs &lt;&gt; ys\n  -- The following actually violates the semigroup associativity law. Hardly matters here I suppose...\n  xs &lt;&gt; Doable y = xs &lt;&gt; Tough (Doable $ fmap twice y)\n  Doable x &lt;&gt; ys = Tough (Doable $ fmap twice x) &lt;&gt; ys\n\ntwice x = (x,x)\n</code></pre>\n\n<p>Note that this uses the <code>Applicative</code> instance of <code>f</code> not just on the <code>a</code> type, but also on arbitrary tuples thereof. I can't see how you could express that with a <code>MultiParamTypeClasses</code>- or <code>TypeFamilies</code>-based applicative class. (It might be possible if you make <code>Tough</code> a suitable GADT, but without that... probably not.)</p>\n\n<p>BTW, this example is perhaps not as useless as it may look &ndash; it basically expresses read-only vectors of length 2<sup><em>n</em></sup> in a monadic state.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1428321298, "post_id": 29466770, "comment_id": 47103041, "body": "Worth to say that for quite some time now, restricted monads etc. can be done in a rather more straightforward way using <code>ConstraintKinds</code>. If I may <a href=\"http://hackage.haskell.org/package/constrained-categories\" rel=\"nofollow noreferrer\">advertise my implementation of this</a>..."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1428303329, "creation_date": 1428303329, "answer_id": 29466770, "question_id": 29463811, "link": "https://stackoverflow.com/questions/29463811/any-advantage-of-using-type-constructors-in-type-classes/29466770#29466770", "title": "Any advantage of using type constructors in type classes?", "body": "<p>The expanded variant is indeed more flexible. It was used e.g. by Oleg Kiselyov to define <a href=\"http://okmij.org/ftp/Haskell/types.html#restricted-datatypes\" rel=\"nofollow\">restricted monads</a>. Roughly, you can have</p>\n\n<pre><code> class MN2 m a where\n     ret2  :: a -&gt; m a\n\n class (MN2 m a, MN2 m b) =&gt; MN3 m a b where\n     bind2 :: m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>allowing monad instances to be parametrized over <code>a</code> and <code>b</code>. This is useful because you can restrict those types to members of some other class:</p>\n\n<pre><code>import Data.Set as Set\n\ninstance MN2 Set.Set a where\n    -- does not require Ord\n    return = Set.singleton \n\ninstance Prelude.Ord b =&gt; MN3 SMPlus a b where\n    -- Set.union requires Ord\n    m &gt;&gt;= f = Set.fold (Set.union . f) Set.empty m\n</code></pre>\n\n<p>Note than because of that <code>Ord</code> constraint, we are unable to define <code>Monad Set.Set</code> using unrestricted monads. Indeed, the monad class requires the monad to be usable at all types.</p>\n\n<p>Also see: <a href=\"http://okmij.org/ftp/Computation/monads.html#param-monad\" rel=\"nofollow\">parameterized (indexed) monad</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1428328579, "post_id": 29471935, "comment_id": 47106556, "body": "Wow, I didn&#39;t even realise how quickly this class gets out of bound if we don&#39;t implement it with the <code>*-&gt;*</code> kind (I thought simply having <code>mfmap :: MultiFunctor b d =&gt; (a-&gt;b) -&gt; e-&gt;d</code> would do the trick, but no way)."}], "tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 12, "last_activity_date": 1428331863, "last_edit_date": 1428331863, "creation_date": 1428325597, "answer_id": 29471935, "question_id": 29463811, "link": "https://stackoverflow.com/questions/29463811/any-advantage-of-using-type-constructors-in-type-classes/29471935#29471935", "title": "Any advantage of using type constructors in type classes?", "body": "<p>Your proposals ignore some rather important details about the existing <code>Functor</code> definition because you didn't work through the details of writing out what would happen with the class's member function.</p>\n\n<pre><code>class MultiFunctor a e where\n    mfmap :: (e -&gt; ??) -&gt; a -&gt; ????\n\ninstance MultiFunctor (Maybe a) a where\n    mfmap = ???????\n</code></pre>\n\n<p>An important property of <code>fmap</code> at the moment is that its first argument can change types.  <code>fmap show :: (Functor f, Show a) =&gt; f a -&gt; f String</code>.  You can't just throw that away, or you lose most of the value of <code>fmap</code>.  So really, <code>MultiFunctor</code> would need to look more like...</p>\n\n<pre><code>class MultiFunctor s t a b | s -&gt; a, t -&gt; b, s b -&gt; t, t a -&gt; s where\n    mfmap :: (a -&gt; b) -&gt; s -&gt; t\n\ninstance (a ~ c, b ~ d) =&gt; MultiFunctor (Maybe a) (Maybe b) c d where\n    mfmap _ Nothing = Nothing\n    mfmap f (Just a) = Just (f a)\n</code></pre>\n\n<p>Note just how incredibly complicated this has become to try to make inference at least <em>close</em> to possible.  All the functional dependencies are in place to allow instance selection without annotating types all over the place.  (I may have missed a couple possible functional dependencies in there!)  The instance itself grew some crazy type equality constraints to allow instance selection to be more reliable.  And the worst part is - this still has worse properties for reasoning than <code>fmap</code> does.</p>\n\n<p>Supposing my previous instance didn't exist, I could write an instance like this:</p>\n\n<pre><code>instance MultiFunctor (Maybe Int) (Maybe Int) Int Int where\n    mfmap _ Nothing = Nothing\n    mfmap f (Just a) = Just (if f a == a then a else f a * 2)\n</code></pre>\n\n<p>This is broken, of course - but it's broken in a new way that wasn't even possible before. A <em>really</em> important part of the definition of <code>Functor</code> is that the types <code>a</code> and <code>b</code> in <code>fmap</code> don't appear anywhere in the instance definition. Just looking at the class is enough to tell the programmer that the behavior of <code>fmap</code> <em>cannot</em> depend on the types <code>a</code> and <code>b</code>.  You get that guarantee for free.  You don't need to trust that instances were written correctly.</p>\n\n<p>Because <code>fmap</code> gives you that guarantee for free, you don't even need to check both <code>Functor</code> laws when defining an instance. It's sufficient to check the law <code>fmap id x == x</code>. The second law comes along for free when the first law is proven.  But with that broken <code>mfmap</code> I just provided, <code>mfmap id x == x</code> is true, even though the second law is not.</p>\n\n<p>As the implementer of <code>mfmap</code>, you have more work to do to prove your implementation is correct. As a user of it, you have to put more trust in the implementation's correctness, since the type system can't guarantee as much.</p>\n\n<p>If you work out more complete examples for the other systems, you find that they have just as many issues if you want to support the full functionality of <code>fmap</code>.  And this is why they aren't really used.  They add a <em>lot</em> of complexity for only a small gain in utility.</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 1, "answer_count": 3, "score": 8, "last_activity_date": 1428331863, "creation_date": 1428279972, "question_id": 29463811, "link": "https://stackoverflow.com/questions/29463811/any-advantage-of-using-type-constructors-in-type-classes", "title": "Any advantage of using type constructors in type classes?", "body": "<p>Take for example the class <code>Functor</code>:</p>\n\n<pre><code>class Functor a\ninstance Functor Maybe\n</code></pre>\n\n<p>Here <code>Maybe</code> is a type constructor.</p>\n\n<p>But we can do this in two other ways:</p>\n\n<p>Firstly, using multi-parameter type classes:</p>\n\n<pre><code>class MultiFunctor a e\ninstance MultiFunctor (Maybe a) a\n</code></pre>\n\n<p>Secondly using type families:</p>\n\n<pre><code>class MonoFunctor a\ninstance MonoFunctor (Maybe a)\n\ntype family Element\ntype instance Element (Maybe a) a\n</code></pre>\n\n<p>Now there's one obvious advantage of the two latter methods, namely that it allows us to do things like this:</p>\n\n<pre><code>instance Text Char\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>instance Text\ntype instance Element Text Char\n</code></pre>\n\n<p>So we can work with monomorphic containers.</p>\n\n<p>The second advantage is that we can make instances of types that don't have the type parameter as the final parameter. Lets say we make an <code>Either</code> style type but put the types the wrong way around:</p>\n\n<pre><code>data Silly t errorT = Silly t errorT\n\ninstance Functor Silly -- oh no we can't do this without a newtype wrapper\n</code></pre>\n\n<p>Whereas</p>\n\n<pre><code>instance MultiFunctor (Silly t errorT) t\n</code></pre>\n\n<p>works fine and</p>\n\n<pre><code>instance MonoFunctor (Silly t errorT)\ntype instance Element (Silly t errorT) t\n</code></pre>\n\n<p>is also good.</p>\n\n<p>Given these flexibility advantages of only using complete types (not type signatures) in type class definitions, is there any reason to use the original style definition, assuming you're using GHC and don't mind using the extensions? That is, is there anything special you can do putting a type constructor, not just a full type in a type class that you can't do with multi-parameter type classes or type families?</p>\n"}, {"tags": ["haskell", "if-statement", "recursion", "tree"], "comments": [{"owner": {"reputation": 11, "user_id": 4744432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04aca1cacc433d2c633abcfe2c7692b?s=128&d=identicon&r=PG&f=1", "display_name": "Tomahawk", "link": "https://stackoverflow.com/users/4744432/tomahawk"}, "edited": false, "score": 0, "creation_date": 1428287460, "post_id": 29463220, "comment_id": 47092130, "body": "Answer helped a lot . I guess it is the only way.(Already tried let-in structure and other tricks but all fail)"}], "answers": [{"comments": [{"owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "reply_to_user": {"reputation": 11, "user_id": 4744432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04aca1cacc433d2c633abcfe2c7692b?s=128&d=identicon&r=PG&f=1", "display_name": "Tomahawk", "link": "https://stackoverflow.com/users/4744432/tomahawk"}, "edited": false, "score": 0, "creation_date": 1428284789, "post_id": 29463973, "comment_id": 47091667, "body": "What prevents you from having a <code>decode</code> with more than one parameter?"}, {"owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "reply_to_user": {"reputation": 11, "user_id": 4744432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04aca1cacc433d2c633abcfe2c7692b?s=128&d=identicon&r=PG&f=1", "display_name": "Tomahawk", "link": "https://stackoverflow.com/users/4744432/tomahawk"}, "edited": false, "score": 0, "creation_date": 1428285439, "post_id": 29463973, "comment_id": 47091786, "body": "And why, exactly, did you delete your first comment to my answer so that now I look like an idiot who is talking to myself?"}, {"owner": {"reputation": 11, "user_id": 4744432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04aca1cacc433d2c633abcfe2c7692b?s=128&d=identicon&r=PG&f=1", "display_name": "Tomahawk", "link": "https://stackoverflow.com/users/4744432/tomahawk"}, "edited": false, "score": 0, "creation_date": 1428285824, "post_id": 29463973, "comment_id": 47091871, "body": "is it so important ? I delete it before refleshing page so didnt see your answer to my comment . Take it easy man it is stupid question. Maybe max 10 person will see it ^^ Btw I succeed to apply your way to my program and it worked  !! Thnx so much"}, {"owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "reply_to_user": {"reputation": 11, "user_id": 4744432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04aca1cacc433d2c633abcfe2c7692b?s=128&d=identicon&r=PG&f=1", "display_name": "Tomahawk", "link": "https://stackoverflow.com/users/4744432/tomahawk"}, "edited": false, "score": 0, "creation_date": 1428286315, "post_id": 29463973, "comment_id": 47091960, "body": "&quot;is it so important ?&quot;  It is only important if you care about being nice to other people.   &quot;I delete it before refleshing page so didnt see your answer to my comment .&quot;  Really? Then how did you manage to reply to my question which you &quot;did not see&quot;?  &quot;Btw I succeed to apply your way to my program and it worked !!&quot;   Perhaps you should mark my answer as accepted?  &quot;Thnx so much&quot;  You are very welcome."}, {"owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "reply_to_user": {"reputation": 11, "user_id": 4744432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04aca1cacc433d2c633abcfe2c7692b?s=128&d=identicon&r=PG&f=1", "display_name": "Tomahawk", "link": "https://stackoverflow.com/users/4744432/tomahawk"}, "edited": false, "score": 0, "creation_date": 1428286746, "post_id": 29463973, "comment_id": 47092033, "body": "You should be able to accept an answer to your own question without having to vote it up."}], "tags": [], "owner": {"reputation": 555, "user_id": 4108393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1616347e88a4828ad7b5eaf6dff2337?s=128&d=identicon&r=PG&f=1", "display_name": "G Philip", "link": "https://stackoverflow.com/users/4108393/g-philip"}, "is_accepted": false, "score": 2, "last_activity_date": 1428281498, "creation_date": 1428281498, "answer_id": 29463973, "question_id": 29463220, "link": "https://stackoverflow.com/questions/29463220/how-to-use-same-tree-after-use-it-in-same-function-in-haskell-recursive-function/29463973#29463973", "title": "How to use same tree after use it in same function in Haskell Recursive Function", "body": "<p>You could pass the original tree along as an additional parameter:</p>\n\n<pre><code>decode' :: HuffmanTree -&gt; HuffmanTree -&gt; [Char] -&gt; [Char]\ndecode' (Intermediate originalN originalX originalY) (Intermediate n x y) (z:zs) = \n  if ..... (some checks for x,y,z)..... \n  then [getChar x] ++ (decode' (Intermediate originalN originalX originalY) (Intermediate originalN originalX originalY) zs)\n</code></pre>\n\n<p>so that you have access to the whole input tree at any point.</p>\n"}], "owner": {"reputation": 11, "user_id": 4744432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04aca1cacc433d2c633abcfe2c7692b?s=128&d=identicon&r=PG&f=1", "display_name": "Tomahawk", "link": "https://stackoverflow.com/users/4744432/tomahawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1428286496, "creation_date": 1428275173, "last_edit_date": 1428286496, "question_id": 29463220, "link": "https://stackoverflow.com/questions/29463220/how-to-use-same-tree-after-use-it-in-same-function-in-haskell-recursive-function", "title": "How to use same tree after use it in same function in Haskell Recursive Function", "body": "<pre><code>data HuffmanTree \n   = Empty \n   | Intermediate Integer HuffmanTree HuffmanTree \n   | Leaf Char Integer\n   deriving (Show,Eq)\n\ndecode :: HuffmanTree -&gt; [Char] -&gt; [Char]\ndecode (Intermediate n x y) (z:zs) = \n   if ..... (some checks for x,y,z)..... \n   then [getChar x] ++ (decode (Intermediate n x y) zs)\n</code></pre>\n\n<p>in this function I m moving on a tree. At \"then\" part I take deepest Leaf's x and after \"++\" I should give whole input tree again.The problem is : After ++ part still my function accepts my current tree (deepest leaf's parent). How to fix it ? (I can't change the type of decode, because it is predefined at homework)</p>\n"}, {"tags": ["haskell", "ghci", "hugs"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1428275896, "creation_date": 1428275896, "answer_id": 29463321, "question_id": 29463161, "link": "https://stackoverflow.com/questions/29463161/is-there-a-way-to-run-a-haskell-console-in-a-recursion-depth-or-memory-limited-m/29463321#29463321", "title": "Is there a way to run a Haskell console in a recursion depth or memory limited mode?", "body": "<p>You can try using the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/runtime-control.html#rts-options-gc\" rel=\"nofollow\">RTS options to control the garbage collector</a> when starting GHCi. For instance,</p>\n\n<pre><code>ghci +RTS -M100M -RTS Foo.hs\n</code></pre>\n\n<p>should limit the memory to 100MB. Alternatively, use <code>-Ksize</code> to limit the stack (by default it is limited by 80% of the heap).</p>\n"}], "owner": {"reputation": 767, "user_id": 2078678, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41918ea59bc753ab7e6b58a5f3dc2973?s=128&d=identicon&r=PG", "display_name": "matiascelasco", "link": "https://stackoverflow.com/users/2078678/matiascelasco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "closed_date": 1428276641, "accepted_answer_id": 29463321, "answer_count": 1, "score": 3, "last_activity_date": 1428307421, "creation_date": 1428274709, "last_edit_date": 1495541603, "question_id": 29463161, "link": "https://stackoverflow.com/questions/29463161/is-there-a-way-to-run-a-haskell-console-in-a-recursion-depth-or-memory-limited-m", "closed_reason": "Duplicate", "title": "Is there a way to run a Haskell console in a recursion depth or memory limited mode?", "body": "<p>Here is the problem: sometimes, when playing with GHCI, I end up running an infinite computation by mistake. When this happens, most times, my computer crashes and I'm not even able to interrupt it using Ctrl+C.\nI wonder if there is a way to run GHCI (or another interactive console like Hugs) in some mode that allows me to interrupt the program before the memory runs out. Maybe setting a virtual limit for the recursion depth or for the memory used.</p>\n\n<p>(This question may be a duplicated of <a href=\"https://stackoverflow.com/questions/3766656/is-there-a-way-to-limit-the-memory-ghci-can-have\">Is there a way to limit the memory, ghci can have?</a> but this also considers the posibility of a recursion depth limit, not just memory limit.)</p>\n"}, {"tags": ["haskell", "llvm"], "comments": [{"owner": {"reputation": 7803, "user_id": 190744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ia1FC.jpg?s=128&g=1", "display_name": "Stephen Diehl", "link": "https://stackoverflow.com/users/190744/stephen-diehl"}, "edited": false, "score": 0, "creation_date": 1428359941, "post_id": 29462859, "comment_id": 47122244, "body": "Does adding <code>-optl -rdynamic</code> to the invocation of ghc fix the problem? Can you run <code>nm chapter4 | grep putchard</code> and paste the resulting output in the question?"}, {"owner": {"reputation": 263, "user_id": 361709, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/aea0c5d16015d9d6d91ebc5b5abe9bc3?s=128&d=identicon&r=PG", "display_name": "esato1981", "link": "https://stackoverflow.com/users/361709/esato1981"}, "reply_to_user": {"reputation": 7803, "user_id": 190744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ia1FC.jpg?s=128&g=1", "display_name": "Stephen Diehl", "link": "https://stackoverflow.com/users/190744/stephen-diehl"}, "edited": false, "score": 0, "creation_date": 1428381273, "post_id": 29462859, "comment_id": 47127765, "body": "Stephen, I had tried adding <code>-optl -rdynamic</code> but it didnt&#39; work. Unfortunately the output to <code>nm chapter4 | grep putchard</code> is null. It seems like ghc is ignoring <code>cbits.so</code>. On OS X the executable won&#39;t even run if it doesn&#39;t find <code>cbits.so</code>. On linux it does not make a difference. Maybe there&#39;s a way to link with ld instead of ghc? What was your setup when writing the tutorial?"}, {"owner": {"reputation": 7803, "user_id": 190744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ia1FC.jpg?s=128&g=1", "display_name": "Stephen Diehl", "link": "https://stackoverflow.com/users/190744/stephen-diehl"}, "edited": false, "score": 0, "creation_date": 1428535932, "post_id": 29462859, "comment_id": 47208523, "body": "I&#39;ve tested the code on both Ubuntu and Arch Linux. People have reported running it on every major operating system though. Perhaps there was a linker bug upstream in GHC that is a bit overzealous at stripping symbols that don&#39;t appear in the Haskell source. Have you tried it on either 7.6 or 7.10?"}, {"owner": {"reputation": 263, "user_id": 361709, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/aea0c5d16015d9d6d91ebc5b5abe9bc3?s=128&d=identicon&r=PG", "display_name": "esato1981", "link": "https://stackoverflow.com/users/361709/esato1981"}, "reply_to_user": {"reputation": 7803, "user_id": 190744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ia1FC.jpg?s=128&g=1", "display_name": "Stephen Diehl", "link": "https://stackoverflow.com/users/190744/stephen-diehl"}, "edited": false, "score": 0, "creation_date": 1428641108, "post_id": 29462859, "comment_id": 47258049, "body": "I tried on latest Ubuntu  (14.10) and it doesn&#39;t work there as well. So far what I tested was: CentOS 7 (works), Mint 17 (doesn&#39;t work), Ubuntu 14.10 (doesn&#39;t work), OS 10.10 (works)."}], "answers": [{"comments": [{"owner": {"reputation": 263, "user_id": 361709, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/aea0c5d16015d9d6d91ebc5b5abe9bc3?s=128&d=identicon&r=PG", "display_name": "esato1981", "link": "https://stackoverflow.com/users/361709/esato1981"}, "edited": false, "score": 0, "creation_date": 1428556925, "post_id": 29527167, "comment_id": 47214263, "body": "I&#39;ll be damned! This solution <i>did</i> work (manually adding a reference in <code>Main.hs</code>.) Before trying that I tried using GHC 7.6 and GHC 7.8. I tried a hack to use <code>ld.gold</code> instead of <code>ld.ld</code>, but none of that worked."}], "tags": [], "owner": {"reputation": 7803, "user_id": 190744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ia1FC.jpg?s=128&g=1", "display_name": "Stephen Diehl", "link": "https://stackoverflow.com/users/190744/stephen-diehl"}, "is_accepted": true, "score": 2, "last_activity_date": 1428536112, "creation_date": 1428536112, "answer_id": 29527167, "question_id": 29462859, "link": "https://stackoverflow.com/questions/29462859/haskell-llvm-general-jit-calling-a-c-function-on-the-fly-stephen-diehls-tutor/29527167#29527167", "title": "Haskell llvm-general JIT: calling a C function on the fly. Stephen Diehl&#39;s tutorial", "body": "<p>Perhaps GHC is being a bit overzealous during linking and stripping out the symbol? Can you manually add a reference using the FFI in <code>Main.hs</code> and then recompile.</p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\n\nimport Foreign.C.Types\n\nforeign import ccall safe \"putchard\" putchard\n    :: CDouble -&gt; CDouble\n</code></pre>\n"}], "owner": {"reputation": 263, "user_id": 361709, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/aea0c5d16015d9d6d91ebc5b5abe9bc3?s=128&d=identicon&r=PG", "display_name": "esato1981", "link": "https://stackoverflow.com/users/361709/esato1981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 3, "accepted_answer_id": 29527167, "answer_count": 1, "score": 6, "last_activity_date": 1428536112, "creation_date": 1428272227, "last_edit_date": 1428451899, "question_id": 29462859, "link": "https://stackoverflow.com/questions/29462859/haskell-llvm-general-jit-calling-a-c-function-on-the-fly-stephen-diehls-tutor", "title": "Haskell llvm-general JIT: calling a C function on the fly. Stephen Diehl&#39;s tutorial", "body": "<p>I am following <a href=\"http://www.stephendiehl.com/llvm/\" rel=\"nofollow\">Stephen Diehl's excellent LLVM Haskell tutorial</a> on a Linux Mint box (Linux Mint 17 Qiana, GHC 7.8.4, llvm 3.4).</p>\n\n<p>I cloned the project's github repo and I was able to build each chapter's example by using the included <code>Makefile</code>.</p>\n\n<p>In chapter 4 the tutorial presents us a JIT compiler:</p>\n\n<pre><code>import qualified LLVM.General.ExecutionEngine as EE\n\njit :: Context -&gt; (EE.MCJIT -&gt; IO a) -&gt; IO a\njit c = EE.withMCJIT c optlevel model ptrelim fastins\n  where\n    optlevel = Just 2  -- optimization level\n    model    = Nothing -- code model ( Default )\n    ptrelim  = Nothing -- frame pointer elimination\n    fastins  = Nothing -- fast instruction selection\n\nrunJIT :: AST.Module -&gt; IO (Either String ())\nrunJIT mod = do\n    ...\n    jit context $ \\executionEngine -&gt;\n        ...\n        EE.withModuleInEngine executionEngine m $ \\ee -&gt; do\n          mainfn &lt;- EE.getFunction ee (AST.Name \"main\")\n          case mainfn of\n            Just fn -&gt; do\n              res &lt;- run fn\n              putStrLn $ \"Evaluated to: \" ++ show res\n            Nothing -&gt; return ()\n</code></pre>\n\n<p>Then the tutorial extends the language by writing C code to implement operations.</p>\n\n<pre><code>/* cbits\n$ gcc -fPIC -shared cbits.c -o cbits.so\n$ clang -fPIC -shared cbits.c -o cbits.so\n*/\n\n#include \"stdio.h\"\n\n// putchard - putchar that takes a double and returns 0.\ndouble putchard(double X) {\n  putchar((char)X);\n  fflush(stdout);\n  return 0;\n}\n</code></pre>\n\n<p>The makefile builds the project by running:</p>\n\n<pre><code>gcc -fPIC -shared src/chapter4/cbits.c -o src/chapter4/cbits.so\nghc -no-user-package-db -package-db .cabal-sandbox/*-packages.conf.d src/chapter4/cbits.so --make src/chapter4/*.hs -o chapter4\n</code></pre>\n\n<p>But when I try to call <code>putchard()</code> I get an error:</p>\n\n<pre><code>LLVM ERROR: Program used external function 'putchard' which could not be resolved!\n</code></pre>\n\n<p>Am I missing something here?</p>\n\n<p>I've seen people having a similar issue with the original C++ version of the tutorial. They usually solve it by adding a flag to gcc build command (<code>-rdynamic</code>) which is supposed to make the linker add all symbols, no only used ones, to the dynamic symbol table. I suspect ghc is stripping <code>putchard()</code> from the executable file.</p>\n\n<p>When I follow the exact same steps on OS X I everything works fine and I can call <code>putchard()</code> without a problem.</p>\n\n<p>What's happening?</p>\n\n<p>I just tried running the project on Centos 7 and it worked. There must be something wrong with my Mint machine.</p>\n"}, {"tags": ["haskell", "partial-application", "constraint-kinds", "type-synonyms"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1428273403, "post_id": 29462675, "comment_id": 47089441, "body": "This behaviour is enabled by <a href=\"https://downloads.haskell.org/~ghc/7.6.3/docs/html/users_guide/data-type-extensions.html#type-synonyms\" rel=\"nofollow noreferrer\">LiberalTypeSynonyms</a>. Specifically, with it enabled, the compiler will expand out all type synonyms before doing the check for partially applied type synonyms. I&#39;m guessing that one of TypeFamilies or ContraintKinds implies LiberalTypeSynonyms."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1428273571, "post_id": 29462675, "comment_id": 47089483, "body": "@user2407038 Strangely enough, they don&#39;t imply it."}], "answers": [{"tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": false, "score": 4, "last_activity_date": 1428271611, "creation_date": 1428271611, "answer_id": 29462765, "question_id": 29462675, "link": "https://stackoverflow.com/questions/29462675/when-if-ever-can-type-synonyms-be-partially-applied/29462765#29462765", "title": "When (if ever) can type synonyms be partially applied?", "body": "<p>I don't know what the official rules are, but it seems reasonable for this sort of thing to work on the basis of a leftmost-outermost type synonym expansion strategy. The only thing that matters is that type synonyms can be disposed of in a separate and terminating phase, before the rest of typechecking happens. I don't know whether it's intended that you can use a partially applied type synonym F as an argument to another type synonym G, just as long as G ensures that F receives its missing arguments, but that's certainly consistent with the idea that type synonyms are a shallow convenience.</p>\n"}, {"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": false, "score": 5, "last_activity_date": 1428273444, "creation_date": 1428273444, "answer_id": 29462996, "question_id": 29462675, "link": "https://stackoverflow.com/questions/29462675/when-if-ever-can-type-synonyms-be-partially-applied/29462996#29462996", "title": "When (if ever) can type synonyms be partially applied?", "body": "<p>Partial application <em>should</em> be enabled by the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/data-type-extensions.html#type-synonyms\" rel=\"noreferrer\"><code>LiberalTypeSynonyms</code></a> extension.</p>\n\n<p>Basically this defers most consistency checking of type synonyms until they have been expanded, so your \"inlining\" explanation is essentially the right idea.</p>\n\n<p>The strange thing here, though, is that this extension is <em>not</em> implied by the ones in your module.  I just tested, and partial application doesn't work in general with just <code>ConstraintKinds</code>, <code>TypeFamilies</code> and <code>PolyKinds</code>. (I added the latter because kinds <em>are</em> checked before expansion and my test types got inferred the wrong ones otherwise.)</p>\n\n<p>Nevertheless, your file loads fine for me in GHCi 7.8.3.  Maybe this <em>is</em> some kind of bug, even if there is an extension to make it properly legal.</p>\n"}, {"tags": [], "owner": {"reputation": 24443, "user_id": 100020, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7b137a205dff52b6471dfd17158c8b8f?s=128&d=identicon&r=PG", "display_name": "sdcvvc", "link": "https://stackoverflow.com/users/100020/sdcvvc"}, "is_accepted": false, "score": 9, "last_activity_date": 1428274529, "creation_date": 1428274529, "answer_id": 29463134, "question_id": 29462675, "link": "https://stackoverflow.com/questions/29462675/when-if-ever-can-type-synonyms-be-partially-applied/29463134#29463134", "title": "When (if ever) can type synonyms be partially applied?", "body": "<p>Your file compiles in GHC 7.8, but in GHC 7.10 I get an error:</p>\n\n<blockquote>\n  <p>Type synonym \u2018Baz\u2019 should have 1 argument, but has been given none</p>\n  \n  <p>In the type signature for \u2018naim\u2019: naim :: WithBar () Baz u => IO u</p>\n</blockquote>\n\n<p>Adding <code>-XLiberalTypeSynonyms</code> fixes the error. Therefore, this is a bug in 7.8.</p>\n"}], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 880, "favorite_count": 0, "answer_count": 3, "score": 14, "last_activity_date": 1428274529, "creation_date": 1428271006, "question_id": 29462675, "link": "https://stackoverflow.com/questions/29462675/when-if-ever-can-type-synonyms-be-partially-applied", "title": "When (if ever) can type synonyms be partially applied?", "body": "<p>Apparently a bit absent-mindedly, I wrote <a href=\"https://github.com/leftaroundabout/manifolds/commit/3cef6cd231130fa179a1812df7f07e8c53bff3ff#diff-e59c0103479c9d73acd7de529c84ec36R431\" rel=\"noreferrer\">something like</a> the following:</p>\n\n<pre><code>{-# LANGUAGE ConstraintKinds     #-}\n{-# LANGUAGE TypeFamilies        #-}\n\nclass Foo f where\n  type Bar f :: *\n  retbar :: Bar f -&gt; IO f\n\ntype Baz f = (Foo f, Eq f)\n\n  -- WithBar :: * -&gt; (*-&gt;Constraint) -&gt; * -&gt; Constraint\ntype WithBar b c f = (c f, Bar f ~ b)\n\ninstance Foo () where\n  type Bar () = ()\n  retbar = return\n\nnaim :: WithBar () Baz u =&gt; IO u  -- why can I do this?\nnaim = retbar ()\n\nmain = naim :: IO ()\n</code></pre>\n\n<p>Only after successfully compiling, I realised this <em>shouldn't</em> actually work: <code>Baz</code> is defined as a type synonym with one argument, but here I use it without a direct argument. Usually GHC barks at me <code>Type synonym \u2018Baz\u2019 should have 1 argument, but has been given none</code> when I try something like that.</p>\n\n<p>Now, don't get me wrong: I would really like being able to write that, and it's easy enough to see how it could work in this particular example (simply inlining <code>WithBar</code> would yield the signature <code>naim :: (Foo u, Bar u ~ ()) =&gt; IO u</code>, which is certainly fine), but what I don't understand why it actually works just like that here. Is it perhaps only a bug in <code>ghc-7.8.2</code> to allow this?</p>\n"}, {"tags": ["haskell", "vinyl"], "answers": [{"comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1428245085, "post_id": 29458437, "comment_id": 47081037, "body": "Ah, I see. So <code>Dict</code> is a GADT, and pattern-matching on it lets you recover the <code>Show</code> constraint for the results of the match?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1428245162, "post_id": 29458437, "comment_id": 47081052, "body": "That&#39;s exactly the case."}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 5, "last_activity_date": 1428245136, "last_edit_date": 1428245136, "creation_date": 1428244812, "answer_id": 29458437, "question_id": 29458112, "link": "https://stackoverflow.com/questions/29458112/vinyl-rtraverse-with-a-function-requiring-a-constraint-shared-by-all-fields/29458437#29458437", "title": "Vinyl: rtraverse with a function requiring a constraint shared by all fields", "body": "<p>You are correct that reifyConstraint will solve this problem. What this function does is convert (or \"reify\") constraints into datatypes, namely the <code>Dict</code> datatype. For example</p>\n\n<pre><code>&gt;:t reifyConstraint (Proxy :: Proxy Show) mytuple\n(reifyConstraint (Proxy :: Proxy Show) mytuple)\n  :: Rec (Dict Show :. Identity) '[Integer, Bool]\n</code></pre>\n\n<p>Each element in this record will have form <code>Dict (Identity _)</code>. <code>Dict</code> is defined as </p>\n\n<pre><code>data Dict c x where Dict :: c x =&gt; x -&gt; Dict c x\n</code></pre>\n\n<p>Now you simply need a traversal function which can handle a <code>(Dict Show :. Identity) a</code> as an input. </p>\n\n<pre><code>printi :: Compose (Dict Show) Identity a -&gt; IO (Compose (Dict Show) Identity a) \nprinti x@(Compose (Dict a)) = print a &gt;&gt; return x\n</code></pre>\n\n<p>Note that you don't need a <code>Show</code> constraint on <code>a</code> - the <code>Show</code> class dictionary is stored in the <code>Dict</code> datatype. You can rtraverse with this function.</p>\n\n<pre><code>main = rtraverse printi (reifyConstraint (Proxy :: Proxy Show) mytuple)\n</code></pre>\n"}], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 29458437, "answer_count": 1, "score": 2, "last_activity_date": 1428253186, "creation_date": 1428242617, "last_edit_date": 1428253186, "question_id": 29458112, "link": "https://stackoverflow.com/questions/29458112/vinyl-rtraverse-with-a-function-requiring-a-constraint-shared-by-all-fields", "title": "Vinyl: rtraverse with a function requiring a constraint shared by all fields", "body": "<p>I have constructed a simple example of a <a href=\"http://hackage.haskell.org/package/vinyl-0.5.1\" rel=\"nofollow\">Vinyl</a> record. First, some language pragmas and imports:</p>\n\n<pre><code>{-# LANGUAGE DataKinds, TypeOperators #-}\n\nimport Data.Vinyl\nimport Data.Vinyl.Functor\nimport Control.Applicative\n</code></pre>\n\n<p>the actual example (it employs the <a href=\"http://hackage.haskell.org/package/vinyl-0.5.1/docs/Data-Vinyl-Derived.html#t:HList\" rel=\"nofollow\">HList</a> type synonym for simplicity):</p>\n\n<pre><code>mytuple :: HList [Integer,Bool]\nmytuple = Identity 4 :&amp; Identity True :&amp; RNil\n</code></pre>\n\n<p>This compiles ok. But now I want to print the Vinyl record using <a href=\"http://hackage.haskell.org/package/vinyl-0.5.1/docs/Data-Vinyl-Core.html#v:rtraverse\" rel=\"nofollow\">rtraverse</a>:</p>\n\n<pre><code>printi :: Show a =&gt; Identity a -&gt; IO (Identity a)\nprinti (Identity x) = print x *&gt; pure (Identity x)\n\nmain :: IO ()\nmain = rtraverse printi mytuple *&gt; pure ()\n</code></pre>\n\n<p>This gives the following error: <code>No instance for (Show x) arising from a use of \u2018printi\u2019</code>. Which is expected I guess, because <code>rtraverse</code> expects a function with no constraints.</p>\n\n<p>How to solve this? It seems like <a href=\"http://hackage.haskell.org/package/vinyl-0.5.1/docs/Data-Vinyl-Core.html#v:reifyConstraint\" rel=\"nofollow\"><code>reifyConstraint</code></a> will be a part of the solution, but I don't know how to use it.</p>\n"}, {"tags": ["function", "file", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "edited": false, "score": 0, "creation_date": 1428241039, "post_id": 29457691, "comment_id": 47079895, "body": "Worked like a charm. Thanks."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1428239755, "creation_date": 1428239755, "answer_id": 29457691, "question_id": 29457516, "link": "https://stackoverflow.com/questions/29457516/how-to-turn-data-structure-taken-from-file-to-a-function/29457691#29457691", "title": "How to turn data structure taken from file to a function", "body": "<p>You can use <code>foldl</code> even if you add a third argument. Suppose you define</p>\n\n<pre><code>t tab n c = case lookup (n,c) tab of\n      Just x -&gt; x\n      _      -&gt; error \"transici\u00f3n err\u00f3nea\"\n</code></pre>\n\n<p>so that <code>t</code> acts on the new parameter <code>tab</code> instead of the fixed <code>table</code>. To use <code>foldl</code> you now need to use</p>\n\n<pre><code>dfa = DFA i a (t table)\n</code></pre>\n\n<p>This is because <code>t tab</code> is a two argument function, obtained from the three argument function <code>t</code> by fixing its first argument. For this to actually work, <code>table</code> must be what you have just read from the file. Perhaps you need something like (completely untested):</p>\n\n<pre><code>readDFA :: String -&gt; IO ()\nreadDFA filename = do\n              contenidos &lt;- readFile filename\n              let table = strToRow . lines $ contenidos\n                  dfa = DFA i a (t table)\n              print (testDFA dfa \"some string\")\n</code></pre>\n"}], "owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 29457691, "answer_count": 1, "score": 0, "last_activity_date": 1428239755, "creation_date": 1428238687, "question_id": 29457516, "link": "https://stackoverflow.com/questions/29457516/how-to-turn-data-structure-taken-from-file-to-a-function", "title": "How to turn data structure taken from file to a function", "body": "<p>This is my try of doing a DFA in Haskell. The DFA works, but now I want it to read some file instead of a hardcoded table. Was done using <code>foldl</code>. Now the problem is that I need the function <code>table</code> to be defined, and I want that the function <code>t</code> don't need to have defined <code>table</code>, just take it from memory. If I use 3 parameters in <code>t</code>, then I can't use <code>foldl</code>.</p>\n\n<pre><code>module DFA where\n\ndata DFA = DFA { intialState :: String\n               , isAccepting :: String -&gt; Bool\n               , transition  :: String -&gt; Char -&gt; String\n               }\n\n-- estado inicial\ni = \"Q1\"\n\n-- criterio de aceptaci\u00f3n\na = (`elem` [\"Q1\"])\n\ntable :: [((String, Char), String)]\ntable = [((\"Q1\",'A'), \"Q2\")\n        ,((\"Q1\",'B'), \"Q1\")\n        ,((\"Q2\",'A'), \"Q1\")\n        ,((\"Q2\",'B'), \"Q2\")]\n\nstrToRow :: [String] -&gt; [((String, Char), String)]\nstrToRow str = map crea_tupla por_espacios\n  where\n    crea_tupla [x,y,z] = ((x, head y), z)\n    por_espacios = map words str\n\nreadDFA :: String -&gt; IO ()\nreadDFA filename = do\n                  contenidos &lt;- readFile filename\n                  print . strToRow . lines $ contenidos\n\nt n c = case lookup (n,c) table of\n          Just x -&gt; x\n          _      -&gt; error \"transici\u00f3n err\u00f3nea\"\n\ndfa = DFA i a t\n\ntestDFA :: DFA -&gt; [Char] -&gt; Bool\ntestDFA (DFA i a t) = a . foldl t i\n</code></pre>\n\n<p>The file format is easy, only state char next:</p>\n\n<pre><code>Q1 A Q2\nQ1 B Q1\nQ2 A Q1\nQ2 B Q2\n</code></pre>\n"}, {"tags": ["haskell", "maybe"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 5, "creation_date": 1428233748, "post_id": 29456824, "comment_id": 47078055, "body": "What is the thing you are not able to understand ? What error are you facing ? I would suggest you to try initially before posting question."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1428233909, "post_id": 29456824, "comment_id": 47078089, "body": "Is it actually a valid definition? (a note: I referred to a revision that began with <code>function calculate</code> on the same line)"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1428234018, "post_id": 29456824, "comment_id": 47078110, "body": "<a href=\"http://en.wikibooks.org/wiki/Haskell/Libraries/Maybe\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Haskell/Libraries/Maybe</a>"}, {"owner": {"reputation": 127, "user_id": 4750594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/089fe480431b91c26d7457d906d6e906?s=128&d=identicon&r=PG&f=1", "display_name": "K...", "link": "https://stackoverflow.com/users/4750594/k"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1428235505, "post_id": 29456824, "comment_id": 47078430, "body": "@Sibi I would suggest you to try to read the question before posting your answer."}, {"owner": {"reputation": 127, "user_id": 4750594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/089fe480431b91c26d7457d906d6e906?s=128&d=identicon&r=PG&f=1", "display_name": "K...", "link": "https://stackoverflow.com/users/4750594/k"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1428235626, "post_id": 29456824, "comment_id": 47078460, "body": "@zerkms thanks for the note,  I meant to type function_calculate."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1428235720, "post_id": 29456824, "comment_id": 47078493, "body": "Why is this question downvoted? There is no duplicate and I guess it&#39;s sometimes hard to understand the wiki since it starts talking about <i>monads</i> almost immediately."}, {"owner": {"reputation": 127, "user_id": 4750594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/089fe480431b91c26d7457d906d6e906?s=128&d=identicon&r=PG&f=1", "display_name": "K...", "link": "https://stackoverflow.com/users/4750594/k"}, "edited": false, "score": 2, "creation_date": 1428237030, "post_id": 29456824, "comment_id": 47078850, "body": "I agree man after I had read the wiki, it didn&#39;t make much sense, but your answer with the examples helped a lot, cheers CommuSoft."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 1, "creation_date": 1428258099, "post_id": 29456824, "comment_id": 47085073, "body": "Looks to me like you&#39;re getting a bit ahead of yourself. I suggest you take a step back from what you&#39;re dealing with and <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">Learn You a Haskell</a>."}, {"owner": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "edited": false, "score": 0, "creation_date": 1428297573, "post_id": 29456824, "comment_id": 47094235, "body": "You might benefit from the answer I wrote to a similar question here: <a href=\"http://stackoverflow.com/questions/18808258/what-does-the-just-syntax-mean-in-haskell/18809252#18809252\" title=\"what does the just syntax mean in haskell\">stackoverflow.com/questions/18808258/&hellip;</a>"}, {"owner": {"reputation": 127, "user_id": 4750594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/089fe480431b91c26d7457d906d6e906?s=128&d=identicon&r=PG&f=1", "display_name": "K...", "link": "https://stackoverflow.com/users/4750594/k"}, "reply_to_user": {"reputation": 4444, "user_id": 2662193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7318fa44e2a2cf165441a765c3c4f62?s=128&d=identicon&r=PG", "display_name": "Levi Pearson", "link": "https://stackoverflow.com/users/2662193/levi-pearson"}, "edited": false, "score": 0, "creation_date": 1428322250, "post_id": 29456824, "comment_id": 47103501, "body": "@Levi, thanks for the recommendation that is a great explanation!"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 17, "last_activity_date": 1428237271, "last_edit_date": 1495535364, "creation_date": 1428234096, "answer_id": 29456881, "question_id": 29456824, "link": "https://stackoverflow.com/questions/29456824/what-is-the-maybe-type-and-how-does-it-work/29456881#29456881", "title": "What is the Maybe type and how does it work?", "body": "<p><code>Maybe a</code> is an ordinary data type defined as:</p>\n\n<pre><code>data Maybe a = Just a | Nothing\n</code></pre>\n\n<p>There are thus two possibilities: or you define a value of type <code>a</code> as <code>Just a</code> (like <code>Just 3</code>), or <code>Nothing</code> in case the query has no answer.</p>\n\n<p>It is meant to defined as a way to define output for non-total functions.</p>\n\n<p>For instance: say you want to define <code>sqrt</code>. The square root is only defined for positive integers, you can thus define <code>sqrt</code> as:</p>\n\n<pre><code>sqrt x | x &gt;= 0 = Just $ ...\n       | otherwise = Nothing\n</code></pre>\n\n<p>with <code>...</code> a way to calculate the square root for <code>x</code>.</p>\n\n<p>Some people compare <code>Nothing</code> with the \"null pointer\" you find in most programming languages. By default, you don't implement a null pointer for data types you define (and if you do, all these \"nulls\" look different), by adding <code>Nothing</code> you have a generic null pointer.</p>\n\n<p>It can thus be useful to use <code>Maybe</code> to denote that it is possible no output can be calculated. You could of course also error on values less than <code>0</code>:</p>\n\n<pre><code>sqrt x | x &gt;= 0 = Just $ ...\n       | otherwise = error \"The value must be larger or equal to 0\"\n</code></pre>\n\n<p>But errors are normally not mentioned in the type signature, nor does a compiler have any problem if you don't take them into account. Haskell is also shifting to <em>total</em> functions: it's better to alway try at least to return a value (e.g. <code>Nothing</code>) for all possible inputs.</p>\n\n<p>If you later want to use the result of a <code>Maybe a</code>, you for instance need to write:</p>\n\n<pre><code>succMaybe :: Maybe Int -&gt; Maybe Int\nsuccMaybe (Just x) = Just (x+1)\nsuccMaybe _ = Nothing\n</code></pre>\n\n<p>But by writing <code>Just</code> for the first case, you somehow warn yourself that it is possible <code>Nothing</code> can occur. You can also get rid of the <code>Maybe</code> by introducing a \"default\" value:</p>\n\n<pre><code>justOrDefault :: a -&gt; Maybe a -&gt; a\njustOrDefault _ (Just x) = x\njustOrDefault d _ = d\n</code></pre>\n\n<p>The builtin <code>maybe</code> function (note the lowercase), combines the two previous functions:</p>\n\n<pre><code>maybe :: b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b\nmaybe _ f (Just x) = f x\nmaybe z _ Nothing  = z\n</code></pre>\n\n<p>So you specify a <code>b</code> (default value) together with a function (<code>a -&gt; b</code>). In case <code>Maybe a</code> is <code>Just x</code>, the function is applied to it and returned, in case the input value is <code>Nothing</code>, the default value will be used.</p>\n\n<p>Working with <code>Maybe a</code>'s can be hard, because you always need to take the <code>Nothing</code> case into account, to simplify this you can use the <a href=\"https://stackoverflow.com/questions/26240534/haskell-maybe-monad-construction\"><em>Maybe monad</em></a>.</p>\n\n<hr>\n\n<p><em>Tom Schrijvers</em> also shows that <code>Maybe</code> is the successor function in type algebra: you add one extra value to your type (<code>Either</code> is an addition and <code>(,)</code> is the type-algebraic equivalent of multiplication).</p>\n"}], "owner": {"reputation": 127, "user_id": 4750594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/089fe480431b91c26d7457d906d6e906?s=128&d=identicon&r=PG&f=1", "display_name": "K...", "link": "https://stackoverflow.com/users/4750594/k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8874, "favorite_count": 2, "accepted_answer_id": 29456881, "answer_count": 1, "score": 7, "last_activity_date": 1428237271, "creation_date": 1428233655, "last_edit_date": 1428234384, "question_id": 29456824, "link": "https://stackoverflow.com/questions/29456824/what-is-the-maybe-type-and-how-does-it-work", "title": "What is the Maybe type and how does it work?", "body": "<p>I am just starting to program in Haskell, and I came across the following definition:</p>\n\n<pre><code>calculate :: Float -&gt; Float -&gt; Maybe Float\n</code></pre>\n"}, {"tags": ["haskell", "pretty-print", "gadt", "free-monad"], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1428226910, "post_id": 29455999, "comment_id": 47076591, "body": "You can&#39;t pattern match on a GADT in a case statement -- too hard to type."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1428227100, "post_id": 29455999, "comment_id": 47076629, "body": "I can here. GHC 7.8.4 and GHC 7.10.1 check it without problem."}, {"owner": {"reputation": 3113, "user_id": 1193741, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be1d97fc244eaa2bfd3d7d64c1717f9f?s=128&d=identicon&r=PG", "display_name": "jtobin", "link": "https://stackoverflow.com/users/1193741/jtobin"}, "edited": false, "score": 0, "creation_date": 1428227205, "post_id": 29455999, "comment_id": 47076649, "body": "Thanks.  I&#39;ll accept this answer just by virtue of it being first to the punch."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1428227981, "post_id": 29455999, "comment_id": 47076820, "body": "Andras, oh man, I&#39;m showing my unhipness. Time to upgrade I guess"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1428247661, "post_id": 29455999, "comment_id": 47081819, "body": "@luqui I&#39;m pretty sure you&#39;ve always been able to pattern-match a GADT in a <code>case</code> expression - it&#39;s <code>let</code> expressions that cause GHC to provide amusing messages about its brain exploding."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 4, "last_activity_date": 1428226808, "creation_date": 1428226808, "answer_id": 29455999, "question_id": 29455850, "link": "https://stackoverflow.com/questions/29455850/pretty-printing-with-free-monads-and-gadts/29455999#29455999", "title": "Pretty printing with free monads and GADTs", "body": "<p>Just pattern match on <code>f</code>. If you do that, the type of <code>k</code> gets refined to match the type contained inside <code>Foo</code>:</p>\n\n<pre><code>pretty (Pure r)          = show r\npretty (Free (Term f k)) = \"Term \" ++ show f ++ pretty r where\n  r = case f of\n    Bar a -&gt; k a\n    Baz a -&gt; k a\n</code></pre>\n\n<p>You might want to factor out this pattern:</p>\n\n<pre><code>applyToFoo :: (a -&gt; r) -&gt; Foo a -&gt; r\napplyToFoo f (Bar a) = f a\napplyToFoo f (Baz a) = f a\n\npretty (Pure r)          = show r\npretty (Free (Term f k)) = \"Term \" ++ show f ++ pretty (applyToFoo k f)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3113, "user_id": 1193741, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be1d97fc244eaa2bfd3d7d64c1717f9f?s=128&d=identicon&r=PG", "display_name": "jtobin", "link": "https://stackoverflow.com/users/1193741/jtobin"}, "edited": false, "score": 0, "creation_date": 1428227108, "post_id": 29456001, "comment_id": 47076632, "body": "/me shakes head.  One of those nights.  Thanks."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 2, "last_activity_date": 1428226823, "creation_date": 1428226823, "answer_id": 29456001, "question_id": 29455850, "link": "https://stackoverflow.com/questions/29455850/pretty-printing-with-free-monads-and-gadts/29456001#29456001", "title": "Pretty printing with free monads and GADTs", "body": "<p>Well it's not impossible. At the very least you can pattern match on <code>f</code>:</p>\n\n<pre><code>pretty :: (Show a) =&gt; Expr a -&gt; String\npretty (Pure r) = show r\npretty (Free (Term f@(Bar x) k)) = \"Term \" ++ show f ++ pretty (k x)\npretty (Free (Term f@(Baz x) k)) = \"Term \" ++ show f ++ pretty (k x)\n</code></pre>\n\n<p>But that is not very satisfying since you already did that in <code>Foo</code>'s <code>show</code> instance.</p>\n\n<p>The challenge, then, is to abstract appropriately.</p>\n"}], "owner": {"reputation": 3113, "user_id": 1193741, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be1d97fc244eaa2bfd3d7d64c1717f9f?s=128&d=identicon&r=PG", "display_name": "jtobin", "link": "https://stackoverflow.com/users/1193741/jtobin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "accepted_answer_id": 29455999, "answer_count": 2, "score": 2, "last_activity_date": 1428226823, "creation_date": 1428225666, "question_id": 29455850, "link": "https://stackoverflow.com/questions/29455850/pretty-printing-with-free-monads-and-gadts", "title": "Pretty printing with free monads and GADTs", "body": "<p>Consider the expression functor defined by the following GADT:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE KindSignatures #-}\n\nimport Control.Monad.Free\n\ndata ExprF :: * -&gt; * where\n  Term :: Foo a -&gt; (a -&gt; r) -&gt; ExprF r\n\ninstance Functor ExprF where\n  fmap f (Term d k) = Term d (f . k)\n\ntype Expr = Free ExprF\n</code></pre>\n\n<p>where <code>Foo</code> is defined as</p>\n\n<pre><code>data Foo :: * -&gt; * where\n  Bar :: Int    -&gt; Foo Int\n  Baz :: Double -&gt; Foo Double\n\ninstance Show a =&gt; Show (Foo a) where\n  show (Bar j) = show j\n  show (Baz j) = show j\n</code></pre>\n\n<p>The combination of the <code>(a -&gt; r)</code> field in <code>ExprF</code> and the (otherwise desirably) restrictive GADT constructors seem to make writing a pretty printing interpreter impossible:</p>\n\n<pre><code>pretty (Pure r)          = show r\npretty (Free (Term f k)) = \"Term \" ++ show f ++ pretty (k _)\n</code></pre>\n\n<p>The type hole is what one would expect:</p>\n\n<pre><code>Found hole \u2018_\u2019 with type: a1\nWhere: \u2018a1\u2019 is a rigid type variable bound by\n            a pattern with constructor\n              Term :: forall r a. Foo a -&gt; (a -&gt; r) -&gt; ExprF r,\n            in an equation for \u2018pretty\u2019\n            at Test.hs:23:15\nRelevant bindings include\n  k :: a1 -&gt; Free ExprF a (bound at Test.hs:23:22)\n  f :: Foo a1 (bound at Test.hs:23:20)\n  pretty :: Free ExprF a -&gt; String (bound at Test.hs:22:1)\nIn the first argument of \u2018k\u2019, namely \u2018_\u2019\nIn the first argument of \u2018pretty\u2019, namely \u2018(k _)\u2019\nIn the second argument of \u2018(++)\u2019, namely \u2018pretty (k _)\u2019\n</code></pre>\n\n<p>There seems to be no way to give the continuation a value at the type it requires.  That type is encoded in <code>f</code>, and other interpreters I'm using all handle <code>f</code> somehow to extract a value at the appropriate type.  But the path to a <code>String</code> representation seems blocked.</p>\n\n<p>Is there some common idiom I'm missing here?  How would one go about pretty printing a value of <code>Expr</code>, if it is indeed even possible?  If it's not possible, what alternate construction of <code>ExprF</code> might capture the same structure, but also support a pretty printer?</p>\n"}, {"tags": ["haskell", "return", "state-monad"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4751129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eYaIJ.jpg?s=128&g=1", "display_name": "DogOnKeyboard", "link": "https://stackoverflow.com/users/4751129/dogonkeyboard"}, "edited": false, "score": 0, "creation_date": 1428251825, "post_id": 29455718, "comment_id": 47083049, "body": "I can&#39;t do let (passed, failed) = partitionSt f l since it&#39;s State [a] [a]"}, {"owner": {"reputation": 1, "user_id": 4751129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eYaIJ.jpg?s=128&g=1", "display_name": "DogOnKeyboard", "link": "https://stackoverflow.com/users/4751129/dogonkeyboard"}, "edited": false, "score": 0, "creation_date": 1428253366, "post_id": 29455718, "comment_id": 47083515, "body": "Didn&#39;t exactly answer my question, but you did put me on the right track by showing me I could bind the return. Thanks"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1428268626, "post_id": 29455718, "comment_id": 47088244, "body": "The first approach can be streamlined, because <code>return passed</code> doesn&#39;t do anything. Just skip that line and use <code>put failed; return passed</code>"}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 4, "last_activity_date": 1428224564, "creation_date": 1428224564, "answer_id": 29455718, "question_id": 29455632, "link": "https://stackoverflow.com/questions/29455632/haskell-return-value-state-and-state-monads/29455718#29455718", "title": "Haskell: return value, state, and state monads", "body": "<p>You don't really need to use state for this since you could return a pair of <code>(passed, failed)</code> but you can do:</p>\n\n<pre><code>partitionSt :: (a-&gt;Bool) -&gt; [a] -&gt; State [a] [a]\npartitionSt f l = do\n  let (passed, failed) = partition f l\n  s &lt;- return passed\n  put failed\n  return s\n</code></pre>\n\n<p>or</p>\n\n<pre><code>partitionSt f l = return passed &lt;* (put failed)\n  where (passed, failed) = partition f l\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4751129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eYaIJ.jpg?s=128&g=1", "display_name": "DogOnKeyboard", "link": "https://stackoverflow.com/users/4751129/dogonkeyboard"}, "is_accepted": false, "score": 0, "last_activity_date": 1428253319, "creation_date": 1428253319, "answer_id": 29459830, "question_id": 29455632, "link": "https://stackoverflow.com/questions/29455632/haskell-return-value-state-and-state-monads/29459830#29459830", "title": "Haskell: return value, state, and state monads", "body": "<p>Alright I figured it out. I'm supposed to bind both the return value and the next iteration of the state and return that, otherwise just updating the state and iterating through. Lee did put me on the right track by showing me I could bind the return value.</p>\n"}], "owner": {"reputation": 1, "user_id": 4751129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eYaIJ.jpg?s=128&g=1", "display_name": "DogOnKeyboard", "link": "https://stackoverflow.com/users/4751129/dogonkeyboard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1428253319, "creation_date": 1428223904, "question_id": 29455632, "link": "https://stackoverflow.com/questions/29455632/haskell-return-value-state-and-state-monads", "title": "Haskell: return value, state, and state monads", "body": "<p>I'm making a function that does </p>\n\n<pre><code>(a-&gt;Bool) -&gt; [a] -&gt; State [a] [a]\n</code></pre>\n\n<p>and I was wondering if there was a simple way to go through the list storing \"failed\" items that didn't pass the predicate as the state and the \"passing\" items as the value that will eventually be returned?\nYou would see both the return value and the state. Samples:</p>\n\n<pre><code>*CL&gt; runState (func (&lt;3) [1, 2, 3]) []\n([1, 2], [3])\n*CL&gt; runState (func even [1, 2, 3]) [10]\n([2], [10, 1, 3])\n</code></pre>\n\n<p>I've looked long and hard for answers and haven't found anything on this specific situation yet. I know I can do it differently as I have, but I specifically want to know if I can do it in the way mentioned above.</p>\n"}, {"tags": ["haskell", "generics", "ocaml", "gadt", "type-theory"], "comments": [{"owner": {"reputation": 8625, "user_id": 2642162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f497a9526578cba7c81514047b3120fb?s=128&d=identicon&r=PG", "display_name": "gsg", "link": "https://stackoverflow.com/users/2642162/gsg"}, "edited": false, "score": 1, "creation_date": 1428213627, "post_id": 29454528, "comment_id": 47074319, "body": "Interesting question. Maybe equality witnesses? I&#39;m not sure whether they can be expressed in Java or not."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1428218806, "post_id": 29454528, "comment_id": 47075161, "body": "There isn&#39;t much that isn&#39;t shared, but GADTs make what would be nigh on impossible in Java very easy. I once made a <code>Maybe</code> type in Java, 70 lines of code all in all. In Haskell, it&#39;s <i>less than 10</i>, if you include monad/functor instances."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428229724, "post_id": 29454528, "comment_id": 47077180, "body": "@AJFarmar Agreed. In Scala it&#39;s not as long as Java, though."}], "answers": [{"comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1428219965, "post_id": 29454972, "comment_id": 47075346, "body": "What do you mean by &quot;open&quot; and &quot;closed&quot; here ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1428220770, "post_id": 29454972, "comment_id": 47075494, "body": "@Sibi Edited to include that."}, {"owner": {"reputation": 8625, "user_id": 2642162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f497a9526578cba7c81514047b3120fb?s=128&d=identicon&r=PG", "display_name": "gsg", "link": "https://stackoverflow.com/users/2642162/gsg"}, "edited": false, "score": 0, "creation_date": 1428221822, "post_id": 29454972, "comment_id": 47075641, "body": "Ah, I think I understand now. Thanks!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1428270062, "post_id": 29454972, "comment_id": 47088644, "body": "That&#39;s some pretty scary looking Java. Could you explain how it works?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1428271644, "post_id": 29454972, "comment_id": 47089039, "body": "@dfeuer I added something, but it should be rather close to the Haskell code. The main difference is that every function using a <code>Teq</code> must be a method of the interface&amp;class. (As an Haskeller I find this very inconvenient, but the encoding looks doable.)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 14, "last_activity_date": 1428301110, "last_edit_date": 1428301110, "creation_date": 1428217399, "answer_id": 29454972, "question_id": 29454528, "link": "https://stackoverflow.com/questions/29454528/what-does-gadt-offer-that-cannot-be-done-with-oop-and-generics/29454972#29454972", "title": "What does GADT offer that cannot be done with OOP and generics?", "body": "<p>OOP classes are open, GADTs are closed (like plain ADTs). </p>\n\n<p>Here, \"open\" means you can always add more subclasses later, hence the compiler can not assume to have access to all the subclasses of a given class. (There are a few exceptions, e.g. Java's <code>final</code> which however prevents any subclassing, and Scala's sealed classes). Instead, ADTs are \"closed\" in the sense you can not add further constructors later on, and the compiler knows that (and can exploit it to check e.g. exhaustiveness). For more information, see the \"<a href=\"http://en.wikipedia.org/wiki/Expression_problem\" rel=\"noreferrer\">expression problem</a>\".</p>\n\n<p>Consider the following code:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data A a where\n  A1 :: Char -&gt; A Char\n  A2 :: Int  -&gt; A Int\n\ndata B b where\n  B1 :: Char   -&gt; B Char\n  B2 :: String -&gt; B String\n\nfoo :: A t -&gt; B t -&gt; Char\nfoo (A1 x) (B1 y) = max x y\n</code></pre>\n\n<p>The above code relies on <code>Char</code> being the only type <code>t</code> for which one can produce both <code>A t</code> and <code>B t</code>. GADTs, being closed, can ensure that. If we tried to mimick this using OOP classes we fail:</p>\n\n<pre><code>class A1 extends A&lt;Char&gt;   ...\nclass A2 extends A&lt;Int&gt;    ...\nclass B1 extends B&lt;Char&gt;   ...\nclass B2 extends B&lt;String&gt; ...\n\n&lt;T&gt; Char foo(A&lt;T&gt; a, B&lt;T&gt; b) {\n      // ??\n}\n</code></pre>\n\n<p>Here I think we can not implement the same thing unless resorting to unsafe type operations like type casts. (Moreover, these in Java don't even consider the parameter <code>T</code> because of type erasure.) We might think of adding some generic method to <code>A</code> or <code>B</code> to allow this, but this would force us to implement said method for <code>Int</code> and/or <code>String</code> as well. </p>\n\n<p>In this specific case, one might simply resort to a non generic function:</p>\n\n<pre><code>Char foo(A&lt;Char&gt; a, B&lt;Char&gt; b) // ...\n</code></pre>\n\n<p>or, equivalently, to adding a non generic method to those classes.\nHowever, the types shared between <code>A</code> and <code>B</code> might be a larger set than the singleton <code>Char</code>. Worse, classes are open, so the set can get larger as soon as one adds a new subclass.</p>\n\n<p>Also, even if you have a variable of type <code>A&lt;Char&gt;</code> you still do not know if that's a <code>A1</code> or not, and because of that you can not access <code>A1</code>'s fields except by using a type cast. The type cast here would be safe only because the programmer knows there's no other subclass of <code>A&lt;Char&gt;</code>. In the general case, this might be false, e.g.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data A a where\n  A1 :: Char -&gt; A Char\n  A2 :: t -&gt; t -&gt; A t\n</code></pre>\n\n<p>Here <code>A&lt;Char&gt;</code> must be a superclass of both <code>A1</code> and <code>A2&lt;Char&gt;</code>.</p>\n\n<hr>\n\n<p>@gsg asks in a comment about equality witnesses. Consider</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Teq a b where\n   Teq :: Teq t t\n\nfoo :: Teq a b -&gt; a -&gt; b\nfoo Teq x = x\n\ntrans :: Teq a b -&gt; Teq b c -&gt; Teq a c\ntrans Teq Teq = Teq\n</code></pre>\n\n<p>This can be translated as</p>\n\n<pre><code>interface Teq&lt;A,B&gt; {\n  public B foo(A x);\n  public &lt;C&gt; Teq&lt;A,C&gt; trans(Teq&lt;B,C&gt; x);\n}\nclass Teq1&lt;A&gt; implements Teq&lt;A,A&gt; {\n  public A foo(A x) { return x; }\n  public &lt;C&gt; Teq&lt;A,C&gt; trans(Teq&lt;A,C&gt; x) { return x; }\n}\n</code></pre>\n\n<p>The code above declares an interface for all the type pairs <code>A,B</code>, which is then implemented only in the case <code>A=B</code> (<code>implements Teq&lt;A,A&gt;</code>) by the class <code>Teq1</code>. \nThe interface requires a conversion function <code>foo</code> from <code>A</code> to <code>B</code>, and a \"transitivity proof\" <code>trans</code>, which given <code>this</code> of type <code>Teq&lt;A,B&gt;</code> and\nan <code>x</code> of type <code>Teq&lt;B,C&gt;</code> can produce an object <code>Teq&lt;A,C&gt;</code>. This is the Java analogous of the Haskell code using GADTs right above.</p>\n\n<p>The class can not be safely implemented when <code>A/=B</code>, as far as I can see: it would require either returning nulls or cheating with non termination.</p>\n"}, {"tags": [], "owner": {"reputation": 31189, "user_id": 1097780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8f01ad795c29c3d05ad26ee47ea6069?s=128&d=identicon&r=PG", "display_name": "Andreas Rossberg", "link": "https://stackoverflow.com/users/1097780/andreas-rossberg"}, "is_accepted": false, "score": 5, "last_activity_date": 1428310481, "last_edit_date": 1428310481, "creation_date": 1428225281, "answer_id": 29455812, "question_id": 29454528, "link": "https://stackoverflow.com/questions/29454528/what-does-gadt-offer-that-cannot-be-done-with-oop-and-generics/29455812#29455812", "title": "What does GADT offer that cannot be done with OOP and generics?", "body": "<p>Generics do not provide type equality constraints. Without them you need to rely on downcasts, i.e., lose type safety. Moreover, certain dispatch  &ndash; in particular, the visitor pattern &ndash; cannot be implemented safely and with the proper interface for generics resembling GADTs. See this paper, investigating the very question:</p>\n\n<p>&nbsp;&nbsp;<a href=\"http://research.microsoft.com/en-us/um/people/akenn/generics/gadtoop.pdf\" rel=\"nofollow\">Generalized Algebraic Data Types and Object-Oriented Programming</a><br> \n&nbsp;&nbsp;Andrew Kennedy, Claudio Russo. OOPSLA 2005.</p>\n"}], "owner": {"reputation": 1084, "user_id": 3810395, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/50e8d958fbb9268523ba5e8af0dd2709?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3810395/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 765, "favorite_count": 4, "accepted_answer_id": 29454972, "answer_count": 2, "score": 12, "last_activity_date": 1428310481, "creation_date": 1428212883, "question_id": 29454528, "link": "https://stackoverflow.com/questions/29454528/what-does-gadt-offer-that-cannot-be-done-with-oop-and-generics", "title": "What does GADT offer that cannot be done with OOP and generics?", "body": "<p>Are <em>GADTs</em> in functional languages equivalent to traditional <em>OOP + generics</em>, or there is a scenario where there are correctness constrants easily enforced by GADT but hard or impossible to achieve using Java or C#?</p>\n\n<p>For example, this \"well-typed interpreter\" Haskell program:</p>\n\n<pre><code>data Expr a where\n  N :: Int -&gt; Expr Int\n  Suc :: Expr Int -&gt; Expr Int\n  IsZero :: Expr Int -&gt; Expr Bool\n  Or :: Expr Bool -&gt; Expr Bool -&gt; Expr Bool\n\neval :: Expr a -&gt; a\neval (N n) = n\neval (Suc e) = 1 + eval e\neval (IsZero e) = 0 == eval e\neval (Or a b) = eval a || eval b\n</code></pre>\n\n<p>can be written equivalently in Java using generics and appropriate implementation of each subclass, though much more verbose:</p>\n\n<pre><code>interface Expr&lt;T&gt; {\n    public &lt;T&gt; T eval();\n}\n\nclass N extends Expr&lt;Integer&gt; {\n    private Integer n;\n\n    public N(Integer m) {\n        n = m;\n    }\n\n    @Override public Integer eval() {\n        return n;\n    }\n}\n\nclass Suc extends Expr&lt;Integer&gt; {\n    private Expr&lt;Integer&gt; prev;\n\n    public Suc(Expr&lt;Integer&gt; aprev) {\n        prev = aprev;\n    }\n\n    @Override public Integer eval() {\n        return 1 + prev.eval()\n    }\n}\n\n\n/** And so on ... */\n</code></pre>\n"}, {"tags": ["haskell", "xml-parsing", "xml-conduit"], "answers": [{"comments": [{"owner": {"reputation": 729, "user_id": 2630788, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/efbfae4118cc6694219d174333fa2094?s=128&d=identicon&r=PG", "display_name": "Konstantinos", "link": "https://stackoverflow.com/users/2630788/konstantinos"}, "edited": false, "score": 0, "creation_date": 1428273182, "post_id": 29457209, "comment_id": 47089385, "body": "In that case, do you still recommend the streaming helper API in <code>xml-conduit</code>? Or is there another XML streaming library you suggest to use for this task?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 729, "user_id": 2630788, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/efbfae4118cc6694219d174333fa2094?s=128&d=identicon&r=PG", "display_name": "Konstantinos", "link": "https://stackoverflow.com/users/2630788/konstantinos"}, "edited": false, "score": 0, "creation_date": 1428299511, "post_id": 29457209, "comment_id": 47094724, "body": "The streaming helper API is still recommended, the comment you link to just points out that there are probably better ways to design the library these days. The library was originally written before conduit even existed, and modern conduit provides a lot of nicities that we&#39;d probably take advantage of today with a rewrite."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 1, "last_activity_date": 1428236502, "creation_date": 1428236502, "answer_id": 29457209, "question_id": 29454267, "link": "https://stackoverflow.com/questions/29454267/how-to-use-the-xml-conduit-cursor-interface-for-information-extraction-from-a-la/29457209#29457209", "title": "How to use the xml-conduit Cursor Interface for information extraction from a large XML file (around 30G)", "body": "<p>The <code>Cursor</code> module requires that the entire contents be in memory, which seems to not be possible in this case. If you want to process files that large, you'll need to use the streaming interface.</p>\n"}], "owner": {"reputation": 729, "user_id": 2630788, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/efbfae4118cc6694219d174333fa2094?s=128&d=identicon&r=PG", "display_name": "Konstantinos", "link": "https://stackoverflow.com/users/2630788/konstantinos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1428236502, "creation_date": 1428210035, "last_edit_date": 1495541254, "question_id": 29454267, "link": "https://stackoverflow.com/questions/29454267/how-to-use-the-xml-conduit-cursor-interface-for-information-extraction-from-a-la", "title": "How to use the xml-conduit Cursor Interface for information extraction from a large XML file (around 30G)", "body": "<p>The following question is based upon the accepted answer of this <a href=\"https://stackoverflow.com/questions/22748303/get-all-names-from-xml-conduit\">question</a>. The author of the accepted answer said that the streaming helper API in <code>xml-conduit</code> was not updated for years (source: <a href=\"https://stackoverflow.com/questions/21367423/streaming-xml-conduit-parse-results\">accepted answer of SO question</a>), and he recommends the <code>Cursor</code> interface.</p>\n\n<p>Based on the solution of the first question, I wrote the following haskell code which uses the <code>Cursor</code> interface of <code>xml-conduit</code> package.</p>\n\n<pre><code>import Text.XML as XML (readFile, def)\nimport Text.XML.Cursor (Cursor, ($/), (&amp;/), ($//), (&gt;=&gt;), \n    fromDocument, element, content)\nimport Data.Monoid (mconcat)\nimport Filesystem.Path (FilePath)\nimport Filesystem.Path.CurrentOS (fromText)\n\ndata Page = Page\n    { title :: Text\n    } deriving (Show)\n\nparse :: FilePath -&gt; IO ()\nparse path = do\n    doc &lt;- XML.readFile def path\n    let cursor = fromDocument doc\n    let pages = cursor $// element \"page\" &gt;=&gt; parseTitle\n    writeFile \"output.txt\" \"\"\n    mapM_ ((appendFile \"output.txt\") . (\\x -&gt; x ++ \"\\n\") . show) pages\n\nparseTitle :: Cursor -&gt; [Page]\nparseTitle c = do\n    let titleText = c $/ element \"title\" &amp;/ content\n    [Page (mconcat titleText)]\n\nmain :: IO ()\nmain = parse (fromText \"input.xml\")\n</code></pre>\n\n<p>This code works on small XML files. However, when the code is run on a 30G XML file, the execution is killed by the OS. </p>\n\n<p>How can I make this code work on a very large XML file?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 6, "creation_date": 1428206858, "post_id": 29453915, "comment_id": 47073329, "body": "Since this is under the &quot;Monad Transformers&quot; section, I believe all this means is that <code>(Applicative f, Applicative g) =&gt; Applicative (C f g)</code> but its not the case that <code>(Monad f, Monad g) =&gt; Monad (C f g)</code>, where <code>data C f g a = C (f (g a))</code>. If you want a deeper understanding of why this is the case, it may be illustrative to try to write the latter instance."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 2, "creation_date": 1428210812, "post_id": 29453915, "comment_id": 47073877, "body": "See also <a href=\"http://stackoverflow.com/q/13034229/1333025\">Concrete example showing that monads are not closed under composition (with proof)?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 7, "creation_date": 1428222222, "post_id": 29454112, "comment_id": 47075703, "body": "It&#39;s probably worth mentioning, that since the <code>Traversable</code> type class provides the <code>sequence</code> function, which has this type signature: <code>sequence :: Monad m =&gt; t (m a) -&gt; m (t a)</code>, you can define <code>NestedMonads</code> as <code>type NestedMonads m t = (Monad m, Traversable t, Monad t)</code> and then <code>bibind :: NestedMonads m t =&gt; m (t a) -&gt; (a -&gt; m (t b)) -&gt; m (t b)</code>. The <a href=\"http://lpaste.net/130180\" rel=\"nofollow noreferrer\">code</a>."}, {"owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1428245846, "post_id": 29454112, "comment_id": 47081251, "body": "That gives a good intuition as to what <code>Commute</code> might do as well, thanks!"}, {"owner": {"reputation": 596, "user_id": 2684007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0dc231525b77cbf9b18251173353c74f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon C", "link": "https://stackoverflow.com/users/2684007/simon-c"}, "edited": false, "score": 1, "creation_date": 1487354717, "post_id": 29454112, "comment_id": 71764045, "body": "It might be useful to add here that <code>Traversable</code> doesn&#39;t appear to be the correct constraint on the inner monad. See the answer <a href=\"http://stackoverflow.com/a/42298943/2684007\">here</a>."}], "tags": [], "owner": {"reputation": 64094, "user_id": 476408, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2bc1bffafe7aa29ef900b98d1fd1e94e?s=128&d=identicon&r=PG", "display_name": "J. Abrahamson", "link": "https://stackoverflow.com/users/476408/j-abrahamson"}, "is_accepted": true, "score": 43, "last_activity_date": 1428208470, "creation_date": 1428208470, "answer_id": 29454112, "question_id": 29453915, "link": "https://stackoverflow.com/questions/29453915/composing-monads-v-applicative-functors/29454112#29454112", "title": "Composing Monads v. Applicative Functors", "body": "<p>There are several notions by which types of kind <code>* -&gt; *</code> might \"compose\". The more important one is you can compose them \"sequentially\".</p>\n\n<pre><code>newtype Compose f g x = Compose { getCompose :: f (g x) }\n</code></pre>\n\n<p>Here you can see that <code>Compose</code> has kind <code>(* -&gt; *) -&gt; (* -&gt; *) -&gt; (* -&gt; *)</code> much like any good composition of functors ought to.</p>\n\n<p>So the question is: are there law-abiding instances like the following?</p>\n\n<pre><code>instance (Applicative f, Applicative g) =&gt; Applicative (Compose f g)\ninstance (Monad f,       Monad g)       =&gt; Monad       (Compose f g)\n</code></pre>\n\n<p>And the short answer as to why monads don't compose as well as applicatives is that while the first instance can be written the second cannot. Let's try!</p>\n\n<hr>\n\n<p>We can warm up with <code>Functor</code></p>\n\n<pre><code>instance (Functor f,     Functor g)     =&gt; Functor     (Compose f g) where\n  fmap f (Compose fgx) = Compose (fmap (fmap f) fgx)\n</code></pre>\n\n<p>Here we see that because we can <code>fmap</code> an <code>fmap</code>-ed <code>f</code> we can pass it through the layers <code>f</code> and <code>g</code> like we need to. A similar game is played with <code>pure</code></p>\n\n<pre><code>instance (Applicative f, Applicative g) =&gt; Applicative (Compose f g) where\n  pure a = Compose (pure (pure a))\n</code></pre>\n\n<p>and while <code>(&lt;*&gt;)</code> appears tricky, if you look carefully it's the exact same trick we used with both <code>fmap</code> and <code>pure</code>.</p>\n\n<pre><code>  Compose fgf &lt;*&gt; Compose fgx = Compose ((&lt;*&gt;) &lt;$&gt; fgf &lt;*&gt; fgx)\n</code></pre>\n\n<p>In all cases, we can push the operators we need \"through\" the layers of <code>f</code> and <code>g</code> exactly as we might hope.</p>\n\n<p>But now let's take a look at <code>Monad</code>. Instead of trying to define <code>Monad</code> via <code>(&gt;&gt;=)</code>, I'm going to instead work via <code>join</code>. To implement <code>Monad</code> we need to implement</p>\n\n<pre><code>join :: Compose f g (Compose f g x) -&gt; Compose f g x\n</code></pre>\n\n<p>using</p>\n\n<pre><code>join_f :: f (f x) -&gt; f x  -- and\njoin_g :: g (g x) -&gt; g x\n</code></pre>\n\n<p>or, if we strip off the <code>newtype</code> noise, we need</p>\n\n<pre><code>join :: f (g (f (g x))) -&gt; f (g x)\n</code></pre>\n\n<p>At this point it might be clear what the problem is---we only know how to join <em>consecutive</em> layers of <code>f</code>s or <code>g</code>s, but here we see them <em>interwoven</em>. What you'll find is that we need a <em>commutativity</em> property</p>\n\n<pre><code>class Commute f g where\n  commute :: g (f x) -&gt; f (g x)\n</code></pre>\n\n<p>and now we can implement</p>\n\n<pre><code>instance (Monad f, Monad g, Commute f g) =&gt; Monad (Compose f g)\n</code></pre>\n\n<p>with (the <code>newtype</code> agnostic) <code>join</code> defined as</p>\n\n<pre><code>join :: f (g (f (g x))) -&gt; f (g x)\njoin fgfgx = fgx where\n  ffggx :: f (f (g (g x)))\n  ffggx = fmap commute fgfgx\n  fggx :: f (g (g x))\n  fggx = join_f ffggx\n  fgx :: f (g x)\n  fgx = fmap join_g fggx\n</code></pre>\n\n<hr>\n\n<p>So what's the upshot of all this? <code>Applicative</code>s <em>always</em> <code>Compose</code>, but <code>Monad</code>s <code>Compose</code> only when their layers <code>Commute</code>.</p>\n\n<p>When can we <code>commute</code> layers? Here are some examples</p>\n\n<pre><code>instance Commute ((-&gt;) x) ((-&gt;) y) where\n  commute = flip\n\ninstance Commute ((,) x) ((,) y) where\n  commute (y, (x, a)) = (x, (y, a))\n\ninstance Commute ((-&gt;) x) ((,) y) where\n  commute (y, xa) = \\x -&gt; (y, xa x)\n\n-- instance Commute ((,) x) ((-&gt;) y) does not exist; try to write yourself!\n--\n-- OR:\n-- It turns out that you need to somehow \"travel back in time\" to make it\n-- work...\n-- \n-- instance Commute ((,) x) ((-&gt;) y) where\n--   commute yxa = ( ..., \\y -&gt; let (x, a) = yxa y in a )\n</code></pre>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2142, "favorite_count": 10, "accepted_answer_id": 29454112, "answer_count": 1, "score": 31, "last_activity_date": 1428208470, "creation_date": 1428206057, "last_edit_date": 1495540903, "question_id": 29453915, "link": "https://stackoverflow.com/questions/29453915/composing-monads-v-applicative-functors", "title": "Composing Monads v. Applicative Functors", "body": "<p>The <a href=\"https://wiki.haskell.org/Typeclassopedia\" rel=\"noreferrer\">Typeclassopedia</a>'s <em>Monad Transformers</em> section explains:</p>\n\n<blockquote>\n  <p>Unfortunately, monads do not compose as nicely as applicative functors (yet another reason to use Applicative if you don\u2019t need the full power that Monad provides)</p>\n</blockquote>\n\n<p>Looking at the types of <code>&gt;&gt;=</code> and <code>&lt;*&gt;</code>, the above statement is not clear to me.</p>\n\n<pre><code>(&lt;*&gt;) :: Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b\n(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>Please explain the \"monads do not compose as nicely as applicative functors.\"</p>\n\n<p>I read this <a href=\"https://stackoverflow.com/questions/7040844/applicatives-compose-monads-dont\">answer</a>, but could you please give an example to help me understand?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1428200124, "post_id": 29453414, "comment_id": 47072283, "body": "Where does <code>sort</code> come from? Please edit your question and add all relevant imports."}, {"owner": {"reputation": 51, "user_id": 3475814, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c4b7efc253f54f5bdbd5118a608274a0?s=128&d=identicon&r=PG&f=1", "display_name": "DiVeRsi0n", "link": "https://stackoverflow.com/users/3475814/diversi0n"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1428200200, "post_id": 29453414, "comment_id": 47072298, "body": "sort is a fucntion that I created... It works on its own...  sort &quot;bca&quot; returns   abc"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1428200285, "post_id": 29453414, "comment_id": 47072315, "body": "You should include the definition of <code>sort</code>, especially if it&#39;s a custom function of yours."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1428239937, "post_id": 29453414, "comment_id": 47079637, "body": "GHC has warnings that can point out this kind of issues, if you enable them. In this case you&#39;d get a warning &quot;name w1 shadows an earlier binding&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 4, "last_activity_date": 1428200192, "creation_date": 1428200192, "answer_id": 29453441, "question_id": 29453414, "link": "https://stackoverflow.com/questions/29453414/error-c-stack-overflow-in-haskell-sorting-strings/29453441#29453441", "title": "&quot;ERROR - C stack overflow&quot; in Haskell sorting Strings", "body": "<pre><code>where (w1,w2) = (sort w1,sort w2)\n</code></pre>\n\n<p>This definition is infinitely recursive (<code>w1 = sort w1 = sort (sort w1) = ...</code>). If you want to refer to the old bindings of <code>w1</code> and <code>w2</code> in your definition, you need to give your new bindings different names (and then use those new names when referring to the new values).</p>\n\n<p>Something like this:</p>\n\n<pre><code>function :: String-&gt;String-&gt;Bool        \nfunction w1 w2 \n    |sortedW1 == sortedW2 = True\n    |otherwise = False\n    where (sortedW1, sortedW2) = (sort w1,sort w2)\n</code></pre>\n\n<p>Or of course just:</p>\n\n<pre><code>function :: String-&gt;String-&gt;Bool        \nfunction w1 w2 \n    |sort w1 == sort w2 = True\n    |otherwise = False\n</code></pre>\n\n<p>Or even:</p>\n\n<pre><code>function :: String -&gt; String -&gt; Bool        \nfunction w1 w2 = sort w1 == sort w2\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 3475814, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c4b7efc253f54f5bdbd5118a608274a0?s=128&d=identicon&r=PG&f=1", "display_name": "DiVeRsi0n", "link": "https://stackoverflow.com/users/3475814/diversi0n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 29453441, "answer_count": 1, "score": 0, "last_activity_date": 1428200192, "creation_date": 1428199852, "question_id": 29453414, "link": "https://stackoverflow.com/questions/29453414/error-c-stack-overflow-in-haskell-sorting-strings", "title": "&quot;ERROR - C stack overflow&quot; in Haskell sorting Strings", "body": "<p>I have an \"ERROR - C stack overflow\" when I'm using my sort method in a where clause. But if I call the sort function separately (sort \"aString\") it works.\nAny suggestions?</p>\n\n<pre><code>function :: String-&gt;String-&gt;Bool        \nfunction w1 w2 \n    |w1==w2     = True\n    |otherwise  = False\n    where (w1,w2) = (sort w1,sort w2)\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 8, "last_activity_date": 1428181809, "creation_date": 1428181809, "answer_id": 29451435, "question_id": 29451307, "link": "https://stackoverflow.com/questions/29451307/returning-a-string-given-a-particular-integer-input/29451435#29451435", "title": "Returning a string given a particular integer input", "body": "<p>You cannot do what you want. In Haskell an expression should have the same type. It should not be <code>Integer</code> at some circumstances and <code>String</code> at some other circumstances. But what you want can be achived using an <code>Either</code> data type:</p>\n\n<pre><code>squarenumber :: (Ord a, Num a) =&gt; a -&gt; Either String a\nsquarenumber x = if x &lt; 10\n                 then Right (x^2)\n                 else Left $ \"Input is too large, please input a value less than 10.\"\n</code></pre>\n\n<p>Also you are confusing the Haskell's <code>return</code> with imperative language one. Note that in Haskell <code>return</code> has a completly different meaning. It is one of the methods of Monad typeclass.</p>\n"}], "owner": {"reputation": 133, "user_id": 3979561, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7bc697baa0616deff224540fa9fdcc2f?s=128&d=identicon&r=PG&f=1", "display_name": "David Patrick", "link": "https://stackoverflow.com/users/3979561/david-patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 29451435, "answer_count": 1, "score": 1, "last_activity_date": 1428181809, "creation_date": 1428180904, "last_edit_date": 1428181487, "question_id": 29451307, "link": "https://stackoverflow.com/questions/29451307/returning-a-string-given-a-particular-integer-input", "title": "Returning a string given a particular integer input", "body": "<p>I'm attempting to learn Haskell and while trying to write a simple function I have come across a problem. Using the following code:</p>\n\n<pre><code>squarenumber x = if x&lt;10\n                then x^2\n                else return \"Input is too large, please input a value less than 10.\"\n</code></pre>\n\n<p>The issue seems to be with the <code>else</code> portion of the function. How can I amend this function such that it will return a string if the input is greater than 10?</p>\n"}, {"tags": ["haskell", "xml-parsing", "profiling"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1428175258, "post_id": 29450397, "comment_id": 47066848, "body": "You may want to look on a streaming solution: <a href=\"https://hackage.haskell.org/package/xml-conduit\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/xml-conduit</a>"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1428211481, "post_id": 29450397, "comment_id": 47073991, "body": "What does <code>processEvent</code> do? Does it use <code>++</code> on the accumulator string? Also, do you run out of only stack space or RAM too? Please post some RAM usage stats (e. g. the <code>+RTS -s</code> flag output). Also, what&#39;s your GHC version? After GHC 7.8 stack the stack can grow to 80% of RAM by default."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1428498284, "post_id": 29450397, "comment_id": 47186303, "body": "@Sibi hexpat already has a streaming interface, just as xml-conduit does."}], "answers": [{"tags": [], "owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "is_accepted": false, "score": 2, "last_activity_date": 1428721577, "last_edit_date": 1428721577, "creation_date": 1428267571, "answer_id": 29462163, "question_id": 29450397, "link": "https://stackoverflow.com/questions/29450397/how-to-parse-a-large-xml-file-in-haskell-with-limited-amount-of-resources/29462163#29462163", "title": "How to parse a large XML file in Haskell with limited amount of resources?", "body": "<p>You don't say what <code>processEvent</code> is like. In principle, it ought to be unproblematic to use lazy <code>ByteString</code> for a strict left fold over lazily generated input, so I'm not sure what is going wrong in your case. But one ought to use streaming-appropriate types when dealing with gigantic files!</p>\n\n<p>In fact, <code>hexpat</code> does have 'streaming' interface (just like <code>xml-conduit</code>). It  uses the not-too-well known <a href=\"http://hackage.haskell.org/package/List\" rel=\"nofollow\"><code>List</code></a> library and <a href=\"http://hackage.haskell.org/package/List-0.5.2/docs/Data-List-Class.html#t:List\" rel=\"nofollow\">the rather ugly <code>List</code> class it defines</a>.  In principle the <a href=\"http://hackage.haskell.org/package/List-0.5.2/docs/Control-Monad-ListT.html#t:ListT\" rel=\"nofollow\"><code>ListT</code> type</a> from the List package should work well. I gave up quickly because of a lack of combinators, and wrote an appropriate instance of the ugly <code>List</code> class for a wrapped version of <code>Pipes.ListT</code> which I then used to export ordinary <code>Pipes.Producer</code> functions like <code>parseProduce</code>. The trivial manipulations needed for this are appended below as <code>PipesSax.hs</code>  </p>\n\n<p>Once we have <code>parseProducer</code> we can convert a ByteString or Text Producer into a Producer of <code>SaxEvents</code> with Text or ByteString components. Here are some simple operations. I was using a 238M \"input.xml\"; the programs never need more than 6 mb of memory, to judge from looking at <code>top</code>. </p>\n\n<p>-- <code>Sax.hs</code> Most of the IO actions use a <code>registerIds</code> pipe defined at the bottom which is tailored to a giant bit of xml of which this is a valid 1000 fragment <a href=\"http://sprunge.us/WaQK\" rel=\"nofollow\">http://sprunge.us/WaQK</a></p>\n\n<pre><code>{-#LANGUAGE OverloadedStrings #-}\nimport PipesSax ( parseProducer )\nimport Data.ByteString ( ByteString )\nimport Text.XML.Expat.SAX \nimport Pipes  -- cabal install pipes pipes-bytestring \nimport Pipes.ByteString (toHandle, fromHandle, stdin, stdout )\nimport qualified Pipes.Prelude as P\nimport qualified System.IO as IO\nimport qualified Data.ByteString.Char8 as Char8\n\nsax :: MonadIO m =&gt; Producer ByteString m () \n                 -&gt; Producer (SAXEvent ByteString ByteString) m ()\nsax =  parseProducer defaultParseOptions\n\n-- stream xml from stdin, yielding hexpat tagstream to stdout;\nmain0 :: IO ()\nmain0 =  runEffect $ sax stdin &gt;-&gt; P.print\n\n-- stream the extracted 'IDs' from stdin to stdout\nmain1 :: IO ()\nmain1 = runEffect $ sax stdin &gt;-&gt; registryIds &gt;-&gt; stdout\n\n-- write all IDs to a file\nmain2 =  \n IO.withFile \"input.xml\" IO.ReadMode $ \\inp -&gt; \n IO.withFile \"output.txt\" IO.WriteMode $ \\out -&gt; \n   runEffect $ sax (fromHandle inp) &gt;-&gt; registryIds &gt;-&gt; toHandle out \n\n-- folds:\n-- print number of IDs\nmain3 =  IO.withFile \"input.xml\" IO.ReadMode $ \\inp -&gt; \n           do n &lt;- P.length $ sax (fromHandle inp) &gt;-&gt; registryIds\n              print n\n\n-- sum the meaningful part of the IDs - a dumb fold for illustration\nmain4 =  IO.withFile \"input.xml\" IO.ReadMode $ \\inp -&gt;\n         do let pipeline =  sax (fromHandle inp) &gt;-&gt; registryIds &gt;-&gt; P.map readIntId\n            n &lt;- P.fold (+) 0 id pipeline\n            print n\n  where\n   readIntId :: ByteString -&gt; Integer\n   readIntId = maybe 0 (fromIntegral.fst) . Char8.readInt . Char8.drop 2\n\n-- my xml has tags with attributes that appear via hexpat thus:\n-- StartElement \"FacilitySite\" [(\"registryId\",\"110007915364\")] \n-- and the like. This is just an arbitrary demo stream manipulation.\nregistryIds :: Monad m =&gt; Pipe (SAXEvent ByteString ByteString) ByteString m ()\nregistryIds = do \n  e &lt;- await  -- we look for a 'SAXEvent'\n  case e of -- if it matches, we yield, else we go to the next event\n    StartElement \"FacilitySite\" [(\"registryId\",a)] -&gt; do yield a\n                                                         yield \"\\n\"\n                                                         registryIds\n    _ -&gt; registryIds  \n</code></pre>\n\n<p>-- 'library': PipesSax.hs </p>\n\n<p>This just newtypes Pipes.ListT to get the appropriate instances. We don't export anything to do with <code>List</code> or <code>ListT</code> but just use the standard Pipes.Producer concept.</p>\n\n<pre><code>{-#LANGUAGE TypeFamilies, GeneralizedNewtypeDeriving #-}\nmodule PipesSax (parseProducerLocations, parseProducer) where \nimport Data.ByteString (ByteString)\nimport Text.XML.Expat.SAX\nimport Data.List.Class\nimport Control.Monad\nimport Control.Applicative\nimport Pipes  \nimport qualified Pipes.Internal as I\n\nparseProducer\n  :: (Monad m, GenericXMLString tag, GenericXMLString text) \n  =&gt; ParseOptions tag text\n  -&gt; Producer ByteString m () \n  -&gt; Producer (SAXEvent tag text) m ()\nparseProducer opt  = enumerate . enumerate_ \n                     . parseG opt \n                     . Select_ . Select\n\nparseProducerLocations\n  :: (Monad m, GenericXMLString tag, GenericXMLString text) \n  =&gt; ParseOptions tag text\n  -&gt; Producer ByteString m () \n  -&gt; Producer (SAXEvent tag text, XMLParseLocation) m ()\nparseProducerLocations opt = \n  enumerate . enumerate_ . parseLocationsG opt . Select_ . Select  \n\nnewtype ListT_ m a = Select_ { enumerate_ :: ListT m a }\n    deriving (Functor, Monad, MonadPlus, MonadIO\n             , Applicative, Alternative, Monoid, MonadTrans)\n\ninstance Monad m =&gt; List (ListT_ m) where\n type ItemM (ListT_ m) = m\n joinL = Select_ . Select . I.M . liftM (enumerate . enumerate_) \n runList   = liftM emend  . next  . enumerate . enumerate_\n   where \n     emend (Right (a,q)) = Cons a (Select_ (Select q))\n     emend _ = Nil\n</code></pre>\n"}], "owner": {"reputation": 729, "user_id": 2630788, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/efbfae4118cc6694219d174333fa2094?s=128&d=identicon&r=PG", "display_name": "Konstantinos", "link": "https://stackoverflow.com/users/2630788/konstantinos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1428721577, "creation_date": 1428174745, "last_edit_date": 1592644375, "question_id": 29450397, "link": "https://stackoverflow.com/questions/29450397/how-to-parse-a-large-xml-file-in-haskell-with-limited-amount-of-resources", "title": "How to parse a large XML file in Haskell with limited amount of resources?", "body": "<p>I want to extract information from a large XML file (around 20G) in Haskell. Since it is a large file, I used SAX parsing functions from <a href=\"https://hackage.haskell.org/package/hexpat-0.20.9/docs/Text-XML-Expat-SAX.html\" rel=\"noreferrer\">Hexpath</a>.</p>\n<p>Here is a simple code I tested:</p>\n<pre><code>import qualified Data.ByteString.Lazy as L\nimport Text.XML.Expat.SAX as Sax\n\nparse :: FilePath -&gt; IO ()\nparse path = do\n    inputText &lt;- L.readFile path\n    let saxEvents = Sax.parse defaultParseOptions inputText :: [SAXEvent Text Text]\n    let txt = foldl' processEvent &quot;&quot; saxEvents\n    putStrLn txt\n</code></pre>\n<p>After activating profiling in Cabal, it says that <code>parse.saxEvents</code> took 85% of allocated memory. I also used <code>foldr</code> and the result is the same.</p>\n<p>If <code>processEvent</code> becomes complex enough, the program crashes with a <code>stack space overflow</code> error.</p>\n<p>What am I doing wrong?</p>\n"}, {"tags": ["opengl", "haskell", "glsl"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1428179687, "post_id": 29450186, "comment_id": 47068132, "body": "Ouch that&#39;s rough, looks like an API bug.  <a href=\"https://github.com/haskell-opengl/OpenGL/issues\" rel=\"nofollow noreferrer\">Report it</a>, then for now I guess change your uniform to a vector and just use one component :-("}, {"owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1428180096, "post_id": 29450186, "comment_id": 47068230, "body": "@luqui Oh, apparently <a href=\"https://github.com/haskell-opengl/OpenGL/issues/64\" rel=\"nofollow noreferrer\">it&#39;s reported already</a>."}], "answers": [{"tags": [], "owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "is_accepted": true, "score": 3, "last_activity_date": 1428410066, "last_edit_date": 1428410066, "creation_date": 1428180274, "answer_id": 29451226, "question_id": 29450186, "link": "https://stackoverflow.com/questions/29450186/setting-uniform-in-opengl/29451226#29451226", "title": "Setting uniform in OpenGL", "body": "<p>Apparently <a href=\"https://github.com/haskell-opengl/OpenGL/issues/64\" rel=\"nofollow\">it's a known bug</a> in the API.</p>\n\n<p>A possible alternative for now is to use the <code>Index1</code> overload, which is supposed to be a color index, but works fine with simple floats.</p>\n"}], "owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 29451226, "answer_count": 1, "score": 4, "last_activity_date": 1428410066, "creation_date": 1428173462, "question_id": 29450186, "link": "https://stackoverflow.com/questions/29450186/setting-uniform-in-opengl", "title": "Setting uniform in OpenGL", "body": "<p>I have an uniform in the <em>form</em> of:</p>\n\n<pre><code>uniform float abc;\n</code></pre>\n\n<p>and I get it in Haskell code as:</p>\n\n<pre><code>abc &lt;- GL.get (GL.uniformLocation program \"abc\")\n</code></pre>\n\n<p>How can I pass a <code>GLfloat</code> value to it?</p>\n\n<p>I see from <a href=\"http://hackage.haskell.org/package/OpenGL-2.12.0.0/docs/src/Graphics-Rendering-OpenGL-GL-Shaders-Uniform.html#UniformComponent\" rel=\"nofollow\">here</a> that I should probably be using <code>uniform1</code>, but that function is not exported by the module. </p>\n\n<p>Every other instance:</p>\n\n<pre><code>instance UniformComponent a =&gt; Uniform (Vertex2 a)\ninstance UniformComponent a =&gt; Uniform (Vertex3 a)\ninstance UniformComponent a =&gt; Uniform (Vertex4 a)\ninstance UniformComponent a =&gt; Uniform (TexCoord1 a)\ninstance UniformComponent a =&gt; Uniform (TexCoord2 a)\ninstance UniformComponent a =&gt; Uniform (TexCoord3 a)\ninstance UniformComponent a =&gt; Uniform (TexCoord4 a)\ninstance UniformComponent a =&gt; Uniform (Normal3 a)\ninstance UniformComponent a =&gt; Uniform (FogCoord1 a)\ninstance UniformComponent a =&gt; Uniform (Color3 a)\ninstance UniformComponent a =&gt; Uniform (Color4 a)\ninstance UniformComponent a =&gt; Uniform (Index1 a)\n</code></pre>\n\n<p>does not seem to cover this simple case.</p>\n\n<p>What can I do?</p>\n"}, {"tags": ["linux", "haskell", "cabal", "cabal-install"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1428194728, "post_id": 29449754, "comment_id": 47071438, "body": "Your first course of action should probably always be to build in a sandbox. The problem is that the selected version of netcore requires <code>bytestring==0.9.*</code> and the selected version of text requires <code>bytestring&gt;=0.10.4.0</code> - obviously incompatible. I think that the constraint introduced by netcore is much too tight, but you can try installing with <code>--constraint=&#39;bytestring==0.9.*&#39;</code>."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1428195210, "post_id": 29449754, "comment_id": 47071524, "body": "I tried and failed a bit on this too with <code>--dry-run</code>. I had a silly idea of trying to fix packages at the versions that were new back in 2012 when <code>netcore</code> was uploaded. I crashed hard into a problem you&#39;re also bound to hit: the <code>binary</code> versions required by <code>netcore</code> don&#39;t work with modern GHC. With the strange mixture of dependencies with too strict constraints and dependencies with no constraints at all, I suspect this package has thoroughly bitrotted."}, {"owner": {"reputation": 3826, "user_id": 1492106, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IBtzP.jpg?s=128&g=1", "display_name": "Roney Michael", "link": "https://stackoverflow.com/users/1492106/roney-michael"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1428208944, "post_id": 29449754, "comment_id": 47073617, "body": "@user2407038: Thanks! I&#39;ll be sure to try that first thing tomorrow."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1457850659, "creation_date": 1457850659, "answer_id": 35967286, "question_id": 29449754, "link": "https://stackoverflow.com/questions/29449754/errors-in-installing-netcore-with-cabal-install/35967286#35967286", "title": "Errors in installing netcore with cabal-install", "body": "<p>Rather than try to install old packages surrounding an old package I'm trying to build, I find it much more reasonable to go and bump all its version deps (or do so automatically with <code>--allow-newer</code>) then go do the janitorial work to fix the (minor) breakages introduced therein. Typically there are only a few things that need fixing, although they might need to be fixed a number of places. And the end result is an updated version of the package you can send back to the authors and ask them to put up on hackage!</p>\n"}], "owner": {"reputation": 3826, "user_id": 1492106, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IBtzP.jpg?s=128&g=1", "display_name": "Roney Michael", "link": "https://stackoverflow.com/users/1492106/roney-michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1457850659, "creation_date": 1428170763, "question_id": 29449754, "link": "https://stackoverflow.com/questions/29449754/errors-in-installing-netcore-with-cabal-install", "title": "Errors in installing netcore with cabal-install", "body": "<p>I tried the following command as was instructed:</p>\n\n<pre><code>cabal install netcore\n</code></pre>\n\n<p>The errors were as follows:</p>\n\n<pre><code>rmichael@node:~/netcore$ cabal install netcore --force-reinstalls --reinstall\nResolving dependencies...\ncabal: Could not resolve dependencies:\ntrying: netcore-1.0.0 (user goal)\nnext goal: network (dependency of netcore-1.0.0)\nrejecting: network-2.6.0.2/installed-9fc..., 2.6.0.2, 2.6.0.1, 2.6.0.0,\n2.5.0.0, 2.4.2.3, 2.4.2.2, 2.4.2.1, 2.4.2.0, 2.4.1.2, 2.4.1.1, 2.4.1.0,\n2.4.0.1, 2.4.0.0 (conflict: netcore =&gt; network==2.3.*)\ntrying: network-2.3.2.0\nnext goal: unix (dependency of network-2.3.2.0)\nrejecting: unix-2.7.0.1/installed-f86... (conflict: unix =&gt;\nbytestring==0.10.4.0/installed-d6f..., netcore =&gt; bytestring==0.9.*)\ntrying: unix-2.7.1.0\nnext goal: parsec (dependency of netcore-1.0.0)\nrejecting: parsec-3.1.9/installed-3e8... (package is broken)\ntrying: parsec-3.1.9\nnext goal: text (dependency of parsec-3.1.9)\nrejecting: text-1.2.0.4/installed-3df... (conflict: text =&gt;\nbytestring==0.10.6.0/installed-768..., netcore =&gt; bytestring==0.9.*)\ntrying: text-1.2.0.4\nnext goal: bytestring (dependency of netcore-1.0.0)\nrejecting: bytestring-0.10.6.0/installed-768..., 0.10.4.0/installed-d6f...,\n0.10.6.0, 0.10.4.1, 0.10.4.0, 0.10.2.0, 0.10.0.2, 0.10.0.1, 0.10.0.0\n(conflict: netcore =&gt; bytestring==0.9.*)\nrejecting: bytestring-0.9.2.1, 0.9.2.0 (conflict: text =&gt;\nbytestring&gt;=0.10.4.0)\nrejecting: bytestring-0.9.1.10, 0.9.1.9, 0.9.1.8, 0.9.1.7, 0.9.1.6, 0.9.1.5,\n0.9.1.4, 0.9.1.3, 0.9.1.2, 0.9.1.1, 0.9.1.0, 0.9.0.4, 0.9.0.3, 0.9.0.2,\n0.9.0.1, 0.9 (conflict: unix =&gt; bytestring&gt;=0.9.2 &amp;&amp; &lt;0.11)\nDependency tree exhaustively searched.\nrmichael@node:~/netcore$ \n</code></pre>\n\n<p>I'm not able to decipher what my next course of action should be from these messages. Any help would be greatly appreciated.</p>\n\n<p>P.S.: My end objective is to get <a href=\"https://github.com/tnelson/FlowLog\" rel=\"nofollow\">FlowLog</a> up and running. I'm using an Ubuntu 14.04 system here.</p>\n"}, {"tags": ["haskell", "build", "cabal", "cabal-install", "unix-ar"], "owner": {"reputation": 1260, "user_id": 1467419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78cfc322a3cc06cd4d310515286e3c78?s=128&d=identicon&r=PG", "display_name": "d3dave", "link": "https://stackoverflow.com/users/1467419/d3dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1428282677, "creation_date": 1428168446, "last_edit_date": 1428282677, "question_id": 29449359, "link": "https://stackoverflow.com/questions/29449359/cabal-fails-to-build-detailed-0-9-test-suite", "title": "Cabal fails to build detailed-0.9 test suite", "body": "<p>I'm trying to build a package with a single test suite:</p>\n\n<pre><code>name:                  test\nversion:               0.1.0.0\nbuild-type:            Simple\ncabal-version:         &gt;=1.10\n\nlibrary\n  -- exposed-modules:     \n  build-depends:       base\n  hs-source-dirs:      src\n  default-language:    Haskell2010\n\nTest-Suite tests\n  type:                detailed-0.9\n  test-module:         Tests\n  build-depends:       base, Cabal\n  hs-source-dirs:      tests\n  default-language:    Haskell2010\n</code></pre>\n\n<p>Here's what happens:</p>\n\n<pre>\nPS C:\\temporary\\test> cabal configure --enable-tests\nResolving dependencies...\nConfiguring test-0.1.0.0...\nPS C:\\temporary\\test> cabal build\nBuilding test-0.1.0.0...\nPreprocessing library test-0.1.0.0...\nIn-place registering test-0.1.0.0...\nPreprocessing test suite 'tests' for test-0.1.0.0...\n[1 of 1] Compiling Tests            ( tests\\Tests.hs, dist\\build\\Tests.o )\nC:\\Program Files\\Haskell Platform\\2014.2.0.0\\mingw\\bin\\ar.exe: dist\\build\\Tests.o: No such file or directory\nPS C:\\temporary\\test>\n</pre>\n\n<p>I'm using Windows 8.1 64-bit, with Haskell Platform 2014.2.0.0. I have installed MSYS, and the only MinGW on the path is GHC's. Also, all git binaries are after MSYS and MinGW on the path so they do not conflict. Any advice is appreciated.</p>\n\n<hr>\n\n<p><strong>Update</strong>: It appears that building tests works fine when using <code>type: exitcode-stdio-1.0</code>.</p>\n"}, {"tags": ["haskell", "monads", "hoogle"], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 10, "last_activity_date": 1428164911, "creation_date": 1428164911, "answer_id": 29448764, "question_id": 29448495, "link": "https://stackoverflow.com/questions/29448495/foldlwithkey-in-monad/29448764#29448764", "title": "foldlWithKey in monad", "body": "<p><code>foldlWithKey</code> is already very close to what you want. If you specialize <code>a</code> to <code>m a</code> you will have something that operates on values encapsulated in a monad.</p>\n\n<pre><code>foldlWithKey :: (  a -&gt; k -&gt; b -&gt;   a) -&gt;   a -&gt; Map k b -&gt;   a\nfoldlWithKey :: (m a -&gt; k -&gt; b -&gt; m a) -&gt; m a -&gt; Map k b -&gt; m a\n             {-  ^- you don't want these -^   -}\n</code></pre>\n\n<p>We can get rid of the two <code>m a</code>s you don't want with <code>&gt;&gt;=</code> and <code>return</code>.</p>\n\n<pre><code>foldlWithKeyM :: Monad m =&gt; (a -&gt; k -&gt; b -&gt; m a) -&gt; a -&gt; Map k b -&gt; m a\nfoldlWithKeyM f acc = foldlWithKey f' (return acc) \n    where\n        f' ma k b = ma &gt;&gt;= \\a -&gt; f a k b\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1428222342, "post_id": 29449818, "comment_id": 47075723, "body": "Equivalently could you not just wrap the monad in <code>ContT</code> for just this function?"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1428243275, "post_id": 29449818, "comment_id": 47080519, "body": "@luqui I don&#39;t think that&#39;s quite equivalent, with a left fold you would still be <i>building up</i> the entire left-nested action before <code>ContT</code> could convert it. In particular it cannot be as lazy when consuming."}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": false, "score": 7, "last_activity_date": 1428187833, "last_edit_date": 1428187833, "creation_date": 1428171207, "answer_id": 29449818, "question_id": 29448495, "link": "https://stackoverflow.com/questions/29448495/foldlwithkey-in-monad/29449818#29449818", "title": "foldlWithKey in monad", "body": "<p>@Cirdec's solution certainly works, but it has a possible problem: It nests <code>&gt;&gt;=</code>s deeply leftwards. For many (but not all!) monads, this can give stack blowup similar to when using non-strict <code>foldl</code>. So I'll present a different solution, which nests <code>&gt;&gt;=</code>s rightwards instead.  For monads such as <code>IO</code> this should allow the action to be constructed and consumed lazily from the map as it is executed.</p>\n\n<p>This solution is probably a bit trickier, as it uses a <em>right</em> fold to build up the monadic function that will eventually consume the starting value. At least I had some trouble getting the types right.</p>\n\n<p>Except for the key handling, this is essentially the same method as used by <code>Data.Foldable.foldlM</code>.</p>\n\n<pre><code>-- Pragma needed only to give f' a type signature for sanity.  Getting it \n-- right almost took a piece of mine until I remembered typed holes.\n{-# LANGUAGE ScopedTypeVariables #-}\n\nimport Data.Map\n\nfoldlWithKeyM\n  :: forall m a k b. Monad m =&gt; (a -&gt; k -&gt; b -&gt; m a) -&gt; a -&gt; Map k b -&gt; m a\nfoldlWithKeyM f start m = foldrWithKey f' return m $ start\n  where\n    f' :: k -&gt; b -&gt; (a -&gt; m a) -&gt; (a -&gt; m a)\n    f' k b a2mb a = f a k b &gt;&gt;= a2mb\n</code></pre>\n"}], "owner": {"reputation": 780, "user_id": 1315126, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/35561833646b79f4f817c343bacb7c78?s=128&d=identicon&r=PG", "display_name": "Mathias Vorreiter Pedersen", "link": "https://stackoverflow.com/users/1315126/mathias-vorreiter-pedersen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 2, "accepted_answer_id": 29448764, "answer_count": 2, "score": 6, "last_activity_date": 1428187833, "creation_date": 1428163432, "question_id": 29448495, "link": "https://stackoverflow.com/questions/29448495/foldlwithkey-in-monad", "title": "foldlWithKey in monad", "body": "<p>I'm looking for a function that like foldlWithKey, but encapsulated in a monad.</p>\n\n<p>I would expect it to have type</p>\n\n<pre><code>Monad m =&gt; (a -&gt; k -&gt; b -&gt; m a) -&gt; a -&gt; Map k b -&gt; m a\n</code></pre>\n\n<p>but Hoogle isn't giving me anything with that type.</p>\n"}, {"tags": ["haskell", "monads", "functor", "applicative"], "comments": [{"owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "edited": false, "score": 0, "creation_date": 1428161461, "post_id": 29448064, "comment_id": 47062687, "body": "There is a problem with myf, the binding operator (&gt;&gt;=) has type ma -&gt; (a -&gt; mb) -&gt; mb. It injects a value of type &#39;a&#39; into the monadic context and myf doesn&#39;t do that."}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "reply_to_user": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "edited": false, "score": 0, "creation_date": 1428163534, "post_id": 29448064, "comment_id": 47063345, "body": "@felipez what you say is correct, indeed if I replace the function with myf :: Int -&gt; FooBar Int myf (a) = Foo (a * 10) it will work but it won&#39;t be able to switch between Foo and Bar types."}], "answers": [{"comments": [{"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1428163570, "post_id": 29448169, "comment_id": 47063356, "body": "please check my answer above to felipez"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1428163845, "post_id": 29448169, "comment_id": 47063433, "body": "@Randomize I&#39;m not suggesting to change the type, but how you apply the function. I edited to make it clearer."}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1428165845, "post_id": 29448169, "comment_id": 47064024, "body": "what you said it was clear to me. What I am trying to achieve is actually writing down a &quot;myf&quot; that works with monad&#39;s bind to get the same result as in your case."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1428166187, "post_id": 29448169, "comment_id": 47064137, "body": "@Randomize I see. I think that&#39;s impossible though, since to use <code>&gt;&gt;= myf</code> the function should have type <code>Int -&gt; FooInt b</code>, but then it loses access to the constructors <code>Foo</code> and <code>Bar</code> you want to swap in the input."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1428163806, "last_edit_date": 1428163806, "creation_date": 1428161500, "answer_id": 29448169, "question_id": 29448064, "link": "https://stackoverflow.com/questions/29448064/interaction-between-functor-applicative-and-monad/29448169#29448169", "title": "Interaction between functor, applicative and Monad", "body": "<p>The problem is here:</p>\n\n<pre><code>myf :: FooBar Int -&gt; FooBar Int\n</code></pre>\n\n<p>The above causes trouble when you use</p>\n\n<pre><code>something &gt;&gt;= myf\n</code></pre>\n\n<p>because it requires <code>something</code> to have type <code>FooBar (FooBar Int)</code>. \nThis in turn makes numeric constants to be of type <code>FooBar Int</code> and not <code>Int</code>,\nand <code>(+)</code> operate on \"numbers\" of type <code>FooBar Int</code>. This triggers the\ntype error.</p>\n\n<p>Maybe you simply want to use</p>\n\n<pre><code>myf something\n</code></pre>\n\n<p>instead. In your particular case,</p>\n\n<pre><code>main = putStrLn $ show $ myf $ Foo (+3) &lt;$&gt; Foo 5\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1428195165, "post_id": 29452929, "comment_id": 47071513, "body": "Thing go awry even sooner: the <code>Functor</code> instance fails to satisfy <code>fmap id \u2261 id</code>."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1428197404, "post_id": 29452929, "comment_id": 47071868, "body": "@leftaroundabout, oh yeah, I didn&#39;t even see that!"}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "edited": false, "score": 0, "creation_date": 1428225040, "post_id": 29452929, "comment_id": 47076215, "body": "yes even the functor itself is wrong and thanks to highlight all the problems - it helped. I put this as the right answer :)"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 4, "last_activity_date": 1428195100, "last_edit_date": 1428195100, "creation_date": 1428194359, "answer_id": 29452929, "question_id": 29448064, "link": "https://stackoverflow.com/questions/29448064/interaction-between-functor-applicative-and-monad/29452929#29452929", "title": "Interaction between functor, applicative and Monad", "body": "<p>Since you are trying to understand the relationship between <code>Functor</code>,  <code>Applicative</code>, and <code>Monad</code>, you might like to know that your <code>Monad</code> and <code>Applicative</code> instances are incompatible.   <code>(&lt;*&gt;)</code> must behave the same way as <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Monad.html#v:ap\" rel=\"nofollow\"><code>Control.Monad.ap</code></a>:</p>\n\n<pre><code>ap :: (Monad m) =&gt; m (a -&gt; b) -&gt; m a -&gt; m b\nap mf mx = mf &gt;&gt;= (\\f -&gt; mx &gt;&gt;= (\\x -&gt; return (f x)))\n</code></pre>\n\n<p>but you have: </p>\n\n<pre><code>Bar id &lt;*&gt;  Bar 0 = Bar 0\nBar id `ap` Bar 0 = Foo 0\n</code></pre>\n\n<p>In fact, what is causing this is also causing a monad law to be violated:</p>\n\n<pre><code>m &gt;&gt;= return = m\n</code></pre>\n\n<p>but you have</p>\n\n<pre><code>Bar 0 &gt;&gt;= return = Foo 0\n</code></pre>\n\n<p>There is also an applicative law violated caused by the same thing.</p>\n\n<p>You cannot simply throw away the information of whether the value was constructed with <code>Foo</code> or <code>Bar</code> the way you are. <em>Since <code>return = Foo</code></em>, you need to make sure that <code>Foo</code> behaves \"purely\" -- i.e. combining with it (in <code>(&lt;*&gt;)</code> or <code>(&gt;&gt;=)</code>) does not change the structure of the other argument.  One possible way out of this is to always have <code>Bar</code> \"taint\" the computation:</p>\n\n<pre><code>-- Since we have a Foo, we need to preserve whatever f does:\nFoo x &gt;&gt;= f = f x\nBar x &gt;&gt;= f = case f x of   \n                  -- If f x returned a Foo, we need to preserve Bar from the left arg:\n                  Foo y -&gt; Bar y\n                  -- We can do whatever we like with this clause:\n                  Bar y -&gt; Bar y\n</code></pre>\n\n<p>Then use <code>ap</code> to find out what your <code>Applicative</code> instance should be. Interesting to note, this is now isomorphic to <a href=\"https://hackage.haskell.org/package/mtl-2.0.1.0/docs/Control-Monad-Writer-Lazy.html#t:Writer\" rel=\"nofollow\"><code>Writer</code></a> <a href=\"https://hackage.haskell.org/package/base-4.7.0.2/docs/Data-Monoid.html#t:Any\" rel=\"nofollow\"><code>Any</code></a>. </p>\n"}], "owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 29452929, "answer_count": 2, "score": 1, "last_activity_date": 1428233892, "creation_date": 1428160779, "last_edit_date": 1428233892, "question_id": 29448064, "link": "https://stackoverflow.com/questions/29448064/interaction-between-functor-applicative-and-monad", "title": "Interaction between functor, applicative and Monad", "body": "<p>I am totally new to Haskell and I am trying to understand better how functor, applicative and monad work together. Below in my example:</p>\n\n<pre><code>import Control.Monad\nimport Control.Applicative\n\ndata FooBar a = Foo a | Bar a deriving (Show)\n\nmyf :: FooBar Int -&gt; FooBar Int\nmyf (Bar a) = Foo (a * 10)\nmyf (Foo a) = Bar (a * 10)\n\ninstance Functor FooBar where\n    fmap func (Foo val) = Bar (func val)\n    fmap func (Bar val) = Foo (func val)\n\ninstance Applicative FooBar where\n    pure = Foo\n    (Foo f) &lt;*&gt; (Foo x) = Foo (f x)\n    (Foo f) &lt;*&gt; (Bar x) = Foo (f x)\n    (Bar f) &lt;*&gt; (Foo x) = Bar (f x)\n    (Bar f) &lt;*&gt; (Bar x) = Bar (f x)\n\ninstance Monad FooBar where\n    return = Foo\n    (Foo x) &gt;&gt;= f = f x\n    (Bar x) &gt;&gt;= f = f x\n\nmain = putStrLn $ show $ Foo (+3) &lt;*&gt; Foo 5 &gt;&gt;= myf\n</code></pre>\n\n<p>What I am trying to achieve is \"piping\" the value from a Functor/Applicative via monad's bind but I get an error in the <code>main</code> line:</p>\n\n<pre><code>ghc: No instance for (Num (FooBar Int)) arising from a use of `+'\nPossible fix: add an instance declaration for (Num (FooBar Int))\nIn the first argument of `Foo', namely `(+ 3)'\nIn the first argument of `(&lt;*&gt;)', namely `Foo (+ 3)'\nIn the first argument of `(&gt;&gt;=)', namely `Foo (+ 3) &lt;*&gt; Foo 5'\n</code></pre>\n\n<p>Something similar happens if I replace the Applicative with the Functor like this:</p>\n\n<pre><code>main = putStrLn $ show $ (+3) &lt;$&gt; Foo 5 &gt;&gt;= myf\n</code></pre>\n\n<p>Is actually possible what I am trying to do or there is a mistake in my definitions?</p>\n\n<p><strong>EDIT</strong>\nThis is a cleaner solution:</p>\n\n<pre><code>import Control.Monad\nimport Control.Applicative\n\ndata FooBar a = Foo a | Bar a deriving (Show)\n\nmyf :: Int -&gt; FooBar Int\nmyf (a) = return (a * 10)\n\ninstance Functor FooBar where\n    fmap func (Foo val) = Foo (func val)\n    fmap func (Bar val) = Bar (func val)\n\ninstance Applicative FooBar where\n    pure = Foo\n    (Foo f) &lt;*&gt; something = fmap f something\n    (Bar f) &lt;*&gt; something = fmap f something\n\ninstance Monad FooBar where\n    return = Foo\n    (Foo x) &gt;&gt;= f = f x\n    (Bar x) &gt;&gt;= f = f x\n\nmain = putStrLn $ show $ (+) &lt;$&gt; Bar(19) &lt;*&gt; (Foo 3) &gt;&gt;= myf\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14111, "user_id": 1126943, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yeuHw.png?s=128&g=1", "display_name": "zch", "link": "https://stackoverflow.com/users/1126943/zch"}, "edited": false, "score": 1, "creation_date": 1428151161, "post_id": 29446372, "comment_id": 47059769, "body": "I think it&#39;s not possible. There is uncountable number of binary trees. Your method generates all finite Blurgs, but there is no way to fit all infinite Blurgs into a list."}, {"owner": {"reputation": 14111, "user_id": 1126943, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yeuHw.png?s=128&g=1", "display_name": "zch", "link": "https://stackoverflow.com/users/1126943/zch"}, "edited": false, "score": 0, "creation_date": 1428151712, "post_id": 29446372, "comment_id": 47059913, "body": "Another problem is that most Blurgs are actually uncomputable, so there is no way to define them in Haskell."}, {"owner": {"reputation": 530, "user_id": 2784835, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6cc0189924e5765e3c297e67882db48?s=128&d=identicon&r=PG&f=1", "display_name": "Sid", "link": "https://stackoverflow.com/users/2784835/sid"}, "reply_to_user": {"reputation": 14111, "user_id": 1126943, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yeuHw.png?s=128&g=1", "display_name": "zch", "link": "https://stackoverflow.com/users/1126943/zch"}, "edited": false, "score": 0, "creation_date": 1428151899, "post_id": 29446372, "comment_id": 47059989, "body": "@zch: I think there is an infinite but countable number of binary trees, but either way I don&#39;t think that it is relevant here. At any rate, think about the question like this: if you give me an arbitrary Blurg, it should be contained in the list."}, {"owner": {"reputation": 14111, "user_id": 1126943, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yeuHw.png?s=128&g=1", "display_name": "zch", "link": "https://stackoverflow.com/users/1126943/zch"}, "edited": false, "score": 0, "creation_date": 1428152557, "post_id": 29446372, "comment_id": 47060164, "body": "there is countable number of finite binary trees (and your function generate all of them, including your example), but number of infinite trees is uncountable. You could easily encode digits of a real number on an infinite branch of binary tree. This means that there is no one-to-one function from Blurgs into natural numbers. Likewise, you could contain solution of halting problem on an infinite branch."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 14111, "user_id": 1126943, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yeuHw.png?s=128&g=1", "display_name": "zch", "link": "https://stackoverflow.com/users/1126943/zch"}, "edited": false, "score": 0, "creation_date": 1428152622, "post_id": 29446372, "comment_id": 47060182, "body": "@zch: I take it the task was meant as \u201ccompute a list of all <i>finite</i> <code>Blurg</code>s\u201d."}, {"owner": {"reputation": 530, "user_id": 2784835, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6cc0189924e5765e3c297e67882db48?s=128&d=identicon&r=PG&f=1", "display_name": "Sid", "link": "https://stackoverflow.com/users/2784835/sid"}, "reply_to_user": {"reputation": 14111, "user_id": 1126943, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yeuHw.png?s=128&g=1", "display_name": "zch", "link": "https://stackoverflow.com/users/1126943/zch"}, "edited": false, "score": 0, "creation_date": 1428153248, "post_id": 29446372, "comment_id": 47060354, "body": "@zch: It&#39;s good that you bring this up because I felt like it was clear by context that the problem was only about finite Blurgs - as you said, most infinite Blurgs wouldn&#39;t even be computable. I&#39;ll update the question so that this is clear, thanks for the note. But I don&#39;t think it&#39;s true that my list will contain the example I gave above, the Blurgs &quot;Blub&quot; and &quot;Parg (Parg Blub Blub) Blub&quot; will never be together in the list &quot;sofar&quot; at the same recursive call."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428153466, "post_id": 29446372, "comment_id": 47060416, "body": "Potential duplicate of <a href=\"http://stackoverflow.com/questions/23515191/how-to-enumerate-a-recursive-datatype-in-haskell\" title=\"how to enumerate a recursive datatype in haskell\">stackoverflow.com/questions/23515191/&hellip;</a>"}, {"owner": {"reputation": 530, "user_id": 2784835, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6cc0189924e5765e3c297e67882db48?s=128&d=identicon&r=PG&f=1", "display_name": "Sid", "link": "https://stackoverflow.com/users/2784835/sid"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428153767, "post_id": 29446372, "comment_id": 47060510, "body": "@chi: While a similar problem, it does not look like a duplicate to me."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428154272, "post_id": 29446372, "comment_id": 47060653, "body": "The difference is very thin, in my opinion: the other question asked explicitly how to do that using the Omega monad, while this question asks about how to do it in general. The only other minor difference is that they have a slightly different recursive type."}, {"owner": {"reputation": 530, "user_id": 2784835, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6cc0189924e5765e3c297e67882db48?s=128&d=identicon&r=PG&f=1", "display_name": "Sid", "link": "https://stackoverflow.com/users/2784835/sid"}, "edited": false, "score": 0, "creation_date": 1428155635, "post_id": 29446372, "comment_id": 47061041, "body": "chi: For me those differences are substantial: I am not especially interested in seeing how to solve this problem with a library function since I won&#39;t have access to those when I need to solve similar problems on an upcoming exam, which is why I asked for a general solution. And that the other problem uses a different recursive type makes it, well, a different problem. But it&#39;s still useful to see that link, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 530, "user_id": 2784835, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6cc0189924e5765e3c297e67882db48?s=128&d=identicon&r=PG&f=1", "display_name": "Sid", "link": "https://stackoverflow.com/users/2784835/sid"}, "edited": false, "score": 0, "creation_date": 1428153461, "post_id": 29446621, "comment_id": 47060412, "body": "Thanks for the solution. But my compiler cannot parse the word <code>each</code>, are you sure you meant to have that there?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 530, "user_id": 2784835, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6cc0189924e5765e3c297e67882db48?s=128&d=identicon&r=PG&f=1", "display_name": "Sid", "link": "https://stackoverflow.com/users/2784835/sid"}, "edited": false, "score": 0, "creation_date": 1428153564, "post_id": 29446621, "comment_id": 47060443, "body": "<code>each</code> is just another function, defined in the <code>Control.Monad.Omega</code> module."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428153639, "post_id": 29446621, "comment_id": 47060471, "body": "I&#39;m not a fan of mixing omega and lists in that way. I&#39;d rather keep everything inside omega as much as possible and escaping from that at the end. You can also use <code>Alternative</code> as in <a href=\"http://stackoverflow.com/questions/23515191/how-to-enumerate-a-recursive-datatype-in-haskell\" title=\"how to enumerate a recursive datatype in haskell\">stackoverflow.com/questions/23515191/&hellip;</a>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1428154824, "post_id": 29446621, "comment_id": 47060807, "body": "@chi: I kinda agree about better staying with the same container, however in this case it&#39;s not really a problem \u2013 at least performance-wise, because <code>Omega</code> is in fact nothing but a newtype wrapper around a list. And IMO, the combination of monad comprehension and <code>each</code> is actually extremely readable and intuitive."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 9, "last_activity_date": 1428152559, "last_edit_date": 1428152559, "creation_date": 1428151888, "answer_id": 29446621, "question_id": 29446372, "link": "https://stackoverflow.com/questions/29446372/compute-an-infinite-list-of-all-finite-blurgs/29446621#29446621", "title": "Compute an infinite list of all finite Blurgs", "body": "<p>Basically, we need this list:</p>\n\n<pre><code>Blub : Zarg : [ Parg x y | {- `x`,`y` from all possible `Blurg` values -} ]\n</code></pre>\n\n<p>Well, actually you can write this out just like that in Haskell:</p>\n\n<pre><code>allBlurg :: [Blurg]\nallBlurg = Blub : Zarg : [ Pargs x y | x&lt;-allBlurg, y&lt;-allBlurg ]\n</code></pre>\n\n<p>BTW this is <em>not</em> a function, though the definition is recursive. In Haskell, values can be recursive!</p>\n\n<p>Perhaps the above is actually what was expected in the task. Trouble is, it's actually wrong: <em>not</em> all <code>Blurg</code> values will be contained! The reason being, <code>y&lt;-allBlurg</code> has to work through an infinite list. It will never get to the end, therefore <code>x</code> will stay forever at the first element. I.e., with that &ldquo;solution&rdquo;, you'll actually only get lists of the form</p>\n\n<pre><code>   Pargs Blub . Pargs Blub . Pargs Blub . Pargs Blub ... Pargs Blub $ x\n</code></pre>\n\n<p>but never <code>Pargs x y</code> with some <code>x</code> apart from <code>Blub</code>.</p>\n\n<p>What's needed to solve this problem: enumerate combinations from two infinite lists. That's the <a href=\"https://en.wikipedia.org/wiki/Pairing_function#Cantor_pairing_function\" rel=\"noreferrer\">Cantor pairing function</a>, a Haskell implementation is available <a href=\"http://hackage.haskell.org/package/control-monad-omega-0.3.1/docs/Control-Monad-Omega.html\" rel=\"noreferrer\">here</a>.</p>\n\n<pre><code>{-# LANGUAGE MonadComprehensions #-}\nimport Control.Monad.Omega\n\nallBlurg :: [Blurg]\nallBlurg = Blub : Zarg : runOmega [ Pargs x y | x &lt;- each allBlurg\n                                              , y &lt;- each allBlurg ]\n</code></pre>\n\n<blockquote>\n  <p>GHCi> :set -XMonadComprehensions <br>\n  GHCi> :m +Control.Monad.Omega <br>\n  GHCi> let allG = B : Z : runOmega [ P x y | x &lt;\u200c- each allG, y &lt;\u200c- each allG ]<br>\n  GHCi> take 100 allG<br>\n  \u00a0 \u00a0 [B, Z, P B B, P B Z, P Z B, P B (P B B), P Z Z, P (P B B) B,<br>\n  \u00a0 \u00a0  P B (P B Z), P Z (P B B), P (P B B) Z, P (P B Z) B, P B (P Z B),<br>\n  \u00a0 \u00a0  P Z (P B Z), P (P B B) (P B B), P (P B Z) Z, P (P Z B) B,<br>\n  \u00a0 \u00a0  P B (P B (P B B)), P Z (P Z B), P (P B B) (P B Z), P (P B Z) (P B B),<br>\n  \u00a0 \u00a0  P (P Z B) Z, P (P B (P B B)) B, P B (P Z Z), P Z (P B (P B B)),<br>\n  \u00a0 \u00a0  P (P B B) (P Z B), P (P B Z) (P B Z), P (P Z B) (P B B),<br>\n  \u00a0 \u00a0  P (P B (P B B)) Z, P (P Z Z) B, P B (P (P B B) B), P Z (P Z Z),<br>\n  \u00a0 \u00a0  P (P B B) (P B (P B B)), P (P B Z) (P Z B), P (P Z B) (P B Z),<br>\n  \u00a0 \u00a0  P (P B (P B B)) (P B B), P (P Z Z) Z, P (P (P B B) B) B,<br>\n  \u00a0 \u00a0  P B (P B (P B Z)), P Z (P (P B B) B), P (P B B) (P Z Z),<br>\n  \u00a0 \u00a0  P (P B Z) (P B (P B B)), P (P Z B) (P Z B), P (P B (P B B)) (P B Z),<br>\n  \u00a0 \u00a0  P (P Z Z) (P B B), P (P (P B B) B) Z, P (P B (P B Z)) B,<br>\n  \u00a0 \u00a0  P B (P Z (P B B)), P Z (P B (P B Z)), P (P B B) (P (P B B) B),<br>\n  \u00a0 \u00a0  P (P B Z) (P Z Z), P (P Z B) (P B (P B B)), P (P B (P B B)) (P Z B),<br>\n  \u00a0 \u00a0  P (P Z Z) (P B Z), P (P (P B B) B) (P B B), P (P B (P B Z)) Z,<br>\n  \u00a0 \u00a0  P (P Z (P B B)) B, P B (P (P B B) Z), P Z (P Z (P B B)),<br>\n  \u00a0 \u00a0  P (P B B) (P B (P B Z)), P (P B Z) (P (P B B) B), P (P Z B) (P Z Z),<br>\n  \u00a0 \u00a0  P (P B (P B B)) (P B (P B B)), P (P Z Z) (P Z B),<br>\n  \u00a0 \u00a0  P (P (P B B) B) (P B Z), P (P B (P B Z)) (P B B), P (P Z (P B B)) Z,<br>\n  \u00a0 \u00a0  P (P (P B B) Z) B, P B (P (P B Z) B), P Z (P (P B B) Z),<br>\n  \u00a0 \u00a0  P (P B B) (P Z (P B B)), P (P B Z) (P B (P B Z)),<br>\n  \u00a0 \u00a0  P (P Z B) (P (P B B) B), P (P B (P B B)) (P Z Z),<br>\n  \u00a0 \u00a0  P (P Z Z) (P B (P B B)), P (P (P B B) B) (P Z B),<br>\n  \u00a0 \u00a0  P (P B (P B Z)) (P B Z), P (P Z (P B B)) (P B B), P (P (P B B) Z) Z,<br>\n  \u00a0 \u00a0  P (P (P B Z) B) B, P B (P B (P Z B)), P Z (P (P B Z) B),<br>\n  \u00a0 \u00a0  P (P B B) (P (P B B) Z), P (P B Z) (P Z (P B B)),<br>\n  \u00a0 \u00a0  P (P Z B) (P B (P B Z)), P (P B (P B B)) (P (P B B) B),<br>\n  \u00a0 \u00a0  P (P Z Z) (P Z Z), P (P (P B B) B) (P B (P B B)),<br>\n  \u00a0 \u00a0  P (P B (P B Z)) (P Z B), P (P Z (P B B)) (P B Z),<br>\n  \u00a0 \u00a0  P (P (P B B) Z) (P B B), P (P (P B Z) B) Z, P (P B (P Z B)) B,<br>\n  \u00a0 \u00a0  P B (P Z (P B Z)), P Z (P B (P Z B)), P (P B B) (P (P B Z) B),<br>\n  \u00a0 \u00a0  P (P B Z) (P (P B B) Z), P (P Z B) (P Z (P B B)),<br>\n  \u00a0 \u00a0  P (P B (P B B)) (P B (P B Z)), P (P Z Z) (P (P B B) B)]<br></p>\n</blockquote>\n\n<p>Now, actually this is <em>still</em> incomplete: it's actually just the list of all <em>finite-depth</em> <code>Blurgs</code>. As zch remarks, most <code>Blurg</code>s are uncomputable, there's no chance to actually enumerate <em>all</em> of them.</p>\n"}, {"tags": [], "owner": {"reputation": 14111, "user_id": 1126943, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yeuHw.png?s=128&g=1", "display_name": "zch", "link": "https://stackoverflow.com/users/1126943/zch"}, "is_accepted": true, "score": 2, "last_activity_date": 1428157168, "creation_date": 1428157168, "answer_id": 29447482, "question_id": 29446372, "link": "https://stackoverflow.com/questions/29446372/compute-an-infinite-list-of-all-finite-blurgs/29447482#29447482", "title": "Compute an infinite list of all finite Blurgs", "body": "<p>As @leftaroundabout explained the problem - in your solution <code>x</code> never matches anything beyond the first element, because <code>y</code> has infinite number of elements to match. </p>\n\n<p>Here is more elementary solution to this problem:</p>\n\n<pre><code>nextDepth :: [Blurg] -&gt; [Blurg] -&gt; [Blurg]\nnextDepth ls ms =\n    [Parg x y | x &lt;- ls, y &lt;- ms] ++\n    [Parg x y | x &lt;- ms, y &lt;- ls ++ ms]\n\ndeeper :: [Blurg] -&gt; [Blurg] -&gt; [Blurg]\ndeeper ls ms = ms ++ deeper (ls ++ ms) (nextDepth ls ms)\n\nallBlurg :: [Blurg]\nallBlurg = deeper [] [Blub, Zarg]\n</code></pre>\n\n<p>To avoid problem with infinite iteration I use lists with trees of various depths.</p>\n\n<p><code>nextDepth</code> takes a list of trees with depth <code>&lt; n</code> and list of trees of depth <code>== n</code> and returns trees of depth <code>== n + 1</code> that can be constructed from them.</p>\n\n<p><code>deeper</code> for similar arguments returns trees of depth <code>&gt;= n</code> (except for infinite ones).</p>\n"}, {"tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": false, "score": 0, "last_activity_date": 1429761792, "creation_date": 1429761792, "answer_id": 29813436, "question_id": 29446372, "link": "https://stackoverflow.com/questions/29446372/compute-an-infinite-list-of-all-finite-blurgs/29813436#29813436", "title": "Compute an infinite list of all finite Blurgs", "body": "<p>You can also use this approach: start with a leaf node and a function that expands one leaf node into a tree. The code I'm about to include is a slight variation but the same basic idea.</p>\n\n<pre><code>allBlurgs = ab [Blub] where\n  ab (a:r) = a : (r ++ expand a)\n  expand Blub = [Zarg, Parg Blub Blub]\n  expand Zarg = []\n  expand (Parg a b) = [Parg a' b | a' &lt;- expand a] ++ [Parg a b' | b' &lt;- expand b]\n</code></pre>\n"}], "owner": {"reputation": 530, "user_id": 2784835, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f6cc0189924e5765e3c297e67882db48?s=128&d=identicon&r=PG&f=1", "display_name": "Sid", "link": "https://stackoverflow.com/users/2784835/sid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 29447482, "answer_count": 3, "score": 1, "last_activity_date": 1429761792, "creation_date": 1428150261, "last_edit_date": 1428153345, "question_id": 29446372, "link": "https://stackoverflow.com/questions/29446372/compute-an-infinite-list-of-all-finite-blurgs", "title": "Compute an infinite list of all finite Blurgs", "body": "<p>Suppose we define the following datatype in Haskell:</p>\n\n<pre><code>data Blurg = Blub\n           | Zarg\n           | Parg Blurg Blurg\n</code></pre>\n\n<p>This means that <code>Zarg</code>, <code>Parg Blub (Parg Zarg Zarg)</code>, <code>Parg (Parg Blub Blub) (Parg Blub Blub)</code>, etc., are all examples of <code>Blurgs</code>.</p>\n\n<p>Now an old exam question is as follows:</p>\n\n<blockquote>\n  <p>Define a function which will compute a list of all Blurgs.</p>\n</blockquote>\n\n<p>So I tried:</p>\n\n<pre><code>allBlurg' :: [Blurg] -&gt; [Blurg]\nallBlurg' sofar = sofar ++ allBlurg' [Parg x y | x &lt;- sofar, y &lt;- sofar]\n\nallBlurg :: [Blurg]\nallBlurg = allBlurg' [Blub, Zarg]\n</code></pre>\n\n<p>At first I thought this was a solution, but then I realized that not all possible <code>Blurgs</code> are included in the resulting list <code>allBlurg</code>. Can someone write a proper solution?</p>\n\n<p>By the way, I'd just like to note that what the problem asks for won't really be a function since it doesn't take any arguments; it should be considered a value instead. Second, although the question doesn't explicitly say so, I think it should be a condition that each <code>Blurg</code> only appears once in the list. Also please note that the problem really should only ask for finite Blurgs as user zch has mentioned in the comments.</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1428148369, "post_id": 29444673, "comment_id": 47059051, "body": "If some type is not an instance of a standard class, it&#39;s generally probably a good idea to <i>not</i> add it as an orphan instance but rather look for a higher-level abstraction that has the desired instance. \u2013 Anyway... what&#39;s the particular instance you&#39;ve tried with Conduit, and what error do you get when trying this?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1428149313, "post_id": 29444673, "comment_id": 47059286, "body": "afaik <a href=\"http://haddocks.fpcomplete.com/fp/7.8/20140916-162/conduit/Data-Conduit-List.html\" rel=\"nofollow noreferrer\">Data.Conduit.List</a> should give you anything you need"}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1428153370, "post_id": 29444673, "comment_id": 47060384, "body": "I&#39;m trying to make it &quot;Foldable&quot;. As in Data.Foldable"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1428155407, "post_id": 29444673, "comment_id": 47060972, "body": "Yeah. Codez&amp;Errorz, PLZ!"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 2, "creation_date": 1428236694, "post_id": 29444673, "comment_id": 47078758, "body": "Most likely a <code>Foldable</code> instance- at least done the naive way- won&#39;t be what you&#39;re looking for. You most likely want to fold over the output stream from a conduit, but <code>Foldable</code> requires that the values be the final type argument, which will just be the return value (usually <code>()</code>). You&#39;ll likely need a newtype wrapper to do what you&#39;re trying to do."}], "answers": [{"tags": [], "owner": {"reputation": 11412, "user_id": 617159, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc43cf2d76ce0981a21c0e5a817f96f5?s=128&d=identicon&r=PG", "display_name": "Lambda Fairy", "link": "https://stackoverflow.com/users/617159/lambda-fairy"}, "is_accepted": false, "score": 2, "last_activity_date": 1428383116, "creation_date": 1428383116, "answer_id": 29484137, "question_id": 29444673, "link": "https://stackoverflow.com/questions/29444673/how-to-make-a-conduit-an-instance-of-foldable/29484137#29484137", "title": "How to make a conduit an instance of &quot;Foldable&quot;", "body": "<p>As Michael mentioned above, it's impossible to implement <code>Foldable</code> directly on a conduit. This is because given the type:</p>\n\n<pre><code>data ConduitM i o m r = ...\n</code></pre>\n\n<p>the parameter we want to fold over (<code>o</code>) is not in the final position.</p>\n\n<p>That said, we can work around this using a <code>newtype</code>, which lets us shuffle the parameters around. Something like this:</p>\n\n<pre><code>import Data.Functor.Identity\nimport Data.Conduit\nimport qualified Data.Conduit.List as CL\nimport qualified Data.Foldable as F\n\nnewtype FoldableSource a = FoldableSource (ConduitM () a Identity ())\n\ninstance F.Foldable FoldableSource where\n    foldMap f (FoldableSource s) = runIdentity $ s $$ CL.foldMap f\n    foldl' f z (FoldableSource s) = runIdentity $ s $$ CL.fold f z\n    -- GHC 7.10 only\n    -- toList (FoldableSource s) = runIdentity $ s $$ CL.consume s\n\n-- A silly example\nmain = print $ F.sum $ FoldableSource $ CL.sourceList [1..10]\n</code></pre>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1428383116, "creation_date": 1428138898, "question_id": 29444673, "link": "https://stackoverflow.com/questions/29444673/how-to-make-a-conduit-an-instance-of-foldable", "title": "How to make a conduit an instance of &quot;Foldable&quot;", "body": "<p>How do I make a Producer an instance of foldable, so:</p>\n\n<pre><code>foldr f2 init2 $ Data.Conduit.List.unfold f init\n</code></pre>\n\n<p>happily returns a value.</p>\n\n<p>I've done this with Streams quite easily as below:</p>\n\n<pre><code>instance Foldable (Data.Vector.Fusion.Stream.Stream) where\n  foldr = Data.Vector.Fusion.Stream.foldr\n</code></pre>\n\n<p>But I can't get it to work with conduits.</p>\n"}, {"tags": ["haskell", "cabal", "cabal-install"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1428165436, "post_id": 29444043, "comment_id": 47063906, "body": "Have you tried adding the package-version you want to the <code>cabal install</code> command line and using <code>-v</code> and trying to understand the messages about why the solver couldn&#39;t find a plan?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1428195111, "post_id": 29444043, "comment_id": 47071501, "body": "I believe that you need <code>-v3</code> to see the full output from the solver. Which is what you should do when you&#39;re interested in why cabal does something strange or wrong - run with <code>-v3</code> and read."}], "answers": [{"tags": [], "owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "is_accepted": false, "score": 1, "last_activity_date": 1428219901, "creation_date": 1428219901, "answer_id": 29455213, "question_id": 29444043, "link": "https://stackoverflow.com/questions/29444043/how-do-i-find-out-why-cabal-chooses-an-old-version-of-a-library/29455213#29455213", "title": "How do I find out why cabal chooses an old version of a library?", "body": "<p>One way to do this is to run cabal with <code>-v3</code>. This will give you a lot of debug output, but it will also show you the dead ends that the solver explored. </p>\n\n<p>If you are only interested in a few packages then another possibility is to add <code>--constraint='thePackage &gt;=   1.2.3'</code>, where 1.2.3 is the minimum version that you expect thePackage to have. Given this, cabal will generate an error that explains why this constraint is unsatisfiable. </p>\n"}], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1428219901, "creation_date": 1428134044, "last_edit_date": 1428135410, "question_id": 29444043, "link": "https://stackoverflow.com/questions/29444043/how-do-i-find-out-why-cabal-chooses-an-old-version-of-a-library", "title": "How do I find out why cabal chooses an old version of a library?", "body": "<p>Say I'm running <code>cabal install A B C D ... --dry-run</code> in a fresh install of GHC (I just updated a new version). I see some of the dependencies it wants to pull in are not the latest versions of those packages, e.g:</p>\n\n<pre><code>utf8-string-0.3.8 (latest: 1)\ncairo-0.12.5.3 (latest: 0.13.1.0)\nglib-0.12.5.4 (latest: 0.13.1.0)\ngio-0.12.5.3 (latest: 0.13.1.0)\npango-0.12.5.3 (latest: 0.13.1.0)\ngtk-0.12.5.7 (latest: 0.13.6)\n</code></pre>\n\n<p>Now, this is often perfectly normal (especially recently after a new version of GHC is released). I don't care about the particular packages listed here. But when I see this I like to do a quick check of why cabal was unable to use the most recent version of those packages. Often it means that one of the things I asked it to install hasn't been updated and is still depending on old versions, and sometimes I don't actually need to install that and would rather not have it dragging the version of other packages.</p>\n\n<p>Sometimes these \"not the latest versions\" are <em>very</em> old, which usually means something I'm asking for is totally incompatible with recent stuff, but has found a solution using ancient versions with very loose constraints.</p>\n\n<p>What I'd like to do is find out which of the packages I'm installing are causing this. Usually I can see something like \"oh, those are a bunch of graphics packages, it's probably xmonad or taffybar that's the reason\", and I go check the latest version of xmonad and taffybar on hackage to see what their constraints on these packages are. But often the \"obvious culprits\" like this actually don't have relevant constraints on these dependencies, which means the problem is some other package which is a dependency of what I asked for and <em>also</em> has a dependency on the packages that I'm not getting the latest version of, where <em>that</em> package isn't compatible with the latest version of the package cabal is reporting. Finding such a package (and why what I actually care about is depending on it) can be a tricky task!</p>\n\n<p>Are there any tools or tricks that can help answer this question? I'm aware of the dependency tools at <a href=\"http://packdeps.haskellers.com/\" rel=\"nofollow\">http://packdeps.haskellers.com/</a>, which is useful, but doesn't seem to do exactly what I want; I can use the reverse dependency list to start at the packages which cabal wants an out of date version of and work forward until I find something I recognise, or I can query individual packages in the dependency monitor one at a time and work backwards until I find one of the not-latest packages. But it seems like the question I'm asking should be more directly answerable.</p>\n"}, {"tags": ["haskell", "set", "combinations"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 4, "creation_date": 1428088888, "post_id": 29438190, "comment_id": 47045466, "body": "For an arbitrary ordering function you can&#39;t really do better.  Look for structure in your ordering function that you can exploit."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 2, "creation_date": 1428089654, "post_id": 29438190, "comment_id": 47045757, "body": "What is the ordering function or what are its properties?  Without some knowledge about the function, you can&#39;t do better - consider for example the function to be a <a href=\"http://en.wikipedia.org/wiki/Cryptographic_hash_function\" rel=\"nofollow noreferrer\">cryptographic hash funciton</a>."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 9, "last_activity_date": 1428097115, "last_edit_date": 1428097115, "creation_date": 1428089073, "answer_id": 29438420, "question_id": 29438190, "link": "https://stackoverflow.com/questions/29438190/directly-generating-specific-subsets-of-a-powerset/29438420#29438420", "title": "Directly generating specific subsets of a powerset?", "body": "<p>If you want to allow for completely general ordering-functions, then there <em>can't</em> be a way around checking all elements of the powerset. (After all, how would you know the isn't a special clause built in that gives, say, the particular set <code>[6,8,34,42]</code> a completely different ranking from its neighbours?)</p>\n\n<p>However, you could make the algorithm already drastically faster by</p>\n\n<ol>\n<li>Only sorting <em>after</em> filtering: sorting is <em>O</em> (<em>n</em> &middot; log <em>n</em>), so you want keep <em>n</em> low here; for the <em>O</em> (<em>n</em>) filtering step it matters less. (And anyway, number of elements doesn't change through sorting.)</li>\n<li>Apply the ordering-function only once to each subset.</li>\n</ol>\n\n<p>So</p>\n\n<pre><code>import Control.Arrow ((&amp;&amp;&amp;))\n\nlessBadFunction :: Ord b =&gt; (b,b) -&gt; ([a]-&gt;b) -&gt; [a] -&gt; [[a]]\nlessBadFunction (start,end) f\n     = map snd . sortBy (comparing fst)\n               . filter (\\(k,_) -&gt; k&gt;=start &amp;&amp; k&lt;=end)\n               . map (f &amp;&amp;&amp; id)\n               . powerset\n</code></pre>\n\n<p>Basically, let's face it, powersets of anything but a very small basis are infeasible. The particular application &ldquo;sum in a certain range&rdquo; is pretty much a <a href=\"https://en.wikipedia.org/wiki/Packing_problems\" rel=\"nofollow\">packaging problem</a>; there are quite efficient ways to do that kind of thing, but you'll have to give up the idea of perfect generality and of quantification over general subsets.</p>\n"}, {"tags": [], "owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "is_accepted": false, "score": 2, "last_activity_date": 1428122616, "last_edit_date": 1428122616, "creation_date": 1428122187, "answer_id": 29442755, "question_id": 29438190, "link": "https://stackoverflow.com/questions/29438190/directly-generating-specific-subsets-of-a-powerset/29442755#29442755", "title": "Directly generating specific subsets of a powerset?", "body": "<p>Since your problem is essentially a constraint satisfaction problem, using an external SMT solver might be the better alternative here; assuming you can afford the extra IO in the type and the need for such a solver to be installed. The SBV library allows construction of such problems. Here's one encoding:</p>\n\n<pre><code>import Data.SBV\n\n-- c is the cost type\n-- e is the element type\npick :: (Num e, SymWord e, SymWord c) =&gt; c -&gt; c -&gt; ([SBV e] -&gt; SBV c) -&gt; [e] -&gt; IO [[e]]\npick begin end cost xs = do\n        solutions &lt;- allSat constraints\n        return $ map extract $ extractModels solutions\n  where extract ts  = [x | (t, x) &lt;- zip ts xs, t]\n        constraints = do tags &lt;- mapM (const free_) xs\n                         let tagged    = zip tags xs\n                             finalCost = cost [ite t (literal x) 0 | (t, x) &lt;- tagged]    \n                         solve [finalCost .&gt;= literal begin, finalCost .&lt;= literal end]\n\ntest :: IO [[Integer]]\ntest = pick 3 7 sum [1,2,3,4,5]\n</code></pre>\n\n<p>We get:</p>\n\n<pre><code>Main&gt; test\n[[1,2],[1,3],[1,2,3],[1,4],[1,2,4],[1,5],[2,5],[2,3],[2,4],[3,4],[3],[4],[5]]\n</code></pre>\n\n<p>For large lists, this technique will beat out generating all subsets and filtering; assuming the cost function generates reasonable constraints. (Addition will be typically OK, if you've multiplications, the backend solver will have a harder time.)</p>\n\n<p>(As a side note, you should never use <code>filterM (const [True, False])</code> to generate power-sets to start with! While that expression is cute and fun, it is extremely inefficient!)</p>\n"}], "owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 29438420, "answer_count": 2, "score": 5, "last_activity_date": 1428122616, "creation_date": 1428087879, "question_id": 29438190, "link": "https://stackoverflow.com/questions/29438190/directly-generating-specific-subsets-of-a-powerset", "title": "Directly generating specific subsets of a powerset?", "body": "<p>Haskell's expressiveness enables us to rather easily define a powerset function:</p>\n\n<pre><code>import Control.Monad (filterM)\n\npowerset :: [a] -&gt; [[a]]\npowerset = filterM (const [True, False])\n</code></pre>\n\n<p>To be able to perform my task it is crucial for said powerset to be sorted by a specific function, so my implementation kind of looks like this:</p>\n\n<pre><code>import Data.List (sortBy)\nimport Data.Ord (comparing)\n\npowersetBy :: Ord b =&gt; ([a] -&gt; b) -&gt; [a] -&gt; [[a]]\npowersetBy f = sortBy (comparing f) . powerset\n</code></pre>\n\n<p>Now my question is whether there is a way to only generate a <strong>subset</strong> of the powerset given a specific <code>start</code> and <code>end</code>point, where <code>f(start) &lt; f(end)</code> and <code>|start| &lt; |end|</code>. For example, my parameter is a list of integers (<code>[1,2,3,4,5]</code>) and they are sorted by their sum. Now I want to extract only the subsets in a given range, lets say <code>3</code> to <code>7</code>. One way to achieve this would be to <code>filter</code> the powerset to only include my range but this seems (and is) ineffective when dealing with larger subsets:</p>\n\n<pre><code>badFunction :: Ord b =&gt; b -&gt; b -&gt; ([a] -&gt; b) -&gt; [a] -&gt; [[a]]\nbadFunction start end f = filter (\\x -&gt; f x &gt;= start &amp;&amp; f x &lt;= end) . powersetBy f\n</code></pre>\n\n<p><code>badFunction 3 7 sum [1,2,3,4,5]</code> produces <code>[[1,2],[3],[1,3],[4],[1,4],[2,3],[5],[1,2,3],[1,5],[2,4],[1,2,4],[2,5],[3,4]]</code>.</p>\n\n<p>Now my question is whether there is a way to generate this list directly, without having to generate all <code>2^n</code> subsets first, since it will improve performance drastically by not having to check all elements but rather generating them \"on the fly\".</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1428088168, "post_id": 29438118, "comment_id": 47045185, "body": "Google isn&#39;t the right engine for searching symbols in general (there&#39;s <a href=\"http://symbolhound.com/?q=Haskell+%3C%24%3E\" rel=\"nofollow noreferrer\">Symbolhound</a>... though, I can&#39;t get it to give me any results right now), and Haskell in particular, for it has <a href=\"https://www.haskell.org/hoogle/?hoogle=%3C%24%3E\" rel=\"nofollow noreferrer\">two</a> excellent <a href=\"http://hayoo.fh-wedel.de/?query=%3C%24%3E\" rel=\"nofollow noreferrer\">search engines</a> of its own, which would have pointed you to the definition right away."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428144699, "post_id": 29438118, "comment_id": 47058178, "body": "Ever heard of hoogle? <a href=\"https://www.haskell.org/hoogle/?hoogle=%3C$%3E\" rel=\"nofollow noreferrer\">haskell.org/hoogle/?hoogle=%3C$%3E</a>"}, {"owner": {"reputation": 3366, "user_id": 1756750, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/db2912f03e4de7e109367b40f874fea6?s=128&d=identicon&r=PG", "display_name": "Denis", "link": "https://stackoverflow.com/users/1756750/denis"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428145224, "post_id": 29438118, "comment_id": 47058310, "body": "@AJFarmar, yeah, now I know this service."}], "answers": [{"comments": [{"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1428088953, "post_id": 29438136, "comment_id": 47045490, "body": "Is that supposed to be <code>[1, 2, 3]</code> in the final example?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 0, "creation_date": 1428089111, "post_id": 29438136, "comment_id": 47045560, "body": "@SebastianRedl It was supposed to be <code>1</code> and not <code>a</code>, thanks for pointing it out."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 3366, "user_id": 1756750, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/db2912f03e4de7e109367b40f874fea6?s=128&d=identicon&r=PG", "display_name": "Denis", "link": "https://stackoverflow.com/users/1756750/denis"}, "edited": false, "score": 0, "creation_date": 1428089155, "post_id": 29438136, "comment_id": 47045578, "body": "@Denis No problem!  I will say that it took me quite a while to grok applicatives, they&#39;re kind of a weird area between functors and monads that has some nuances which aren&#39;t immediately obvious.  At this point I would encourage you to try to learn more about applicatives through the popular parsec or attoparsec libraries, both of which rely heavily on applicative operators.  While they&#39;re important to know how to use, it&#39;s certainly possible to get by without them for quite a lot of cases.  Most people will prefer <code>&lt;$&gt;</code> over <code>fmap</code>, though, so expect to see that a lot."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1428143151, "post_id": 29438136, "comment_id": 47057820, "body": "It might be worth mentioning that <code>(+) &lt;$&gt; [1,2,3]</code> is in fact <code>[(1+), (2+), (3+)]</code>."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 7, "last_activity_date": 1457560396, "last_edit_date": 1457560396, "creation_date": 1428087626, "answer_id": 29438136, "question_id": 29438118, "link": "https://stackoverflow.com/questions/29438118/what-do-symbols-and-mean-in-haskell/29438136#29438136", "title": "What do symbols &lt;$&gt; and &lt;*&gt; mean in Haskell?", "body": "<p>These operators are defined in <code>Control.Applicative</code>.  The <code>&lt;$&gt;</code> operator is just an infix version of <code>fmap</code>:</p>\n\n<pre><code>f &lt;$&gt; a = fmap f a\n</code></pre>\n\n<p>And <code>&lt;*&gt;</code> is part of the <code>Applicative</code> typeclass definition:</p>\n\n<pre><code>class Functor f =&gt; Applicative f where\n    pure :: a -&gt; f a\n    (&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>You can search for Haskell functions and operators more easily with <a href=\"https://www.fpcomplete.com/hoogle\" rel=\"nofollow\">hoogle</a>.</p>\n\n<p>The <code>Applicative</code> typeclass come in between <code>Functor</code> and <code>Monad</code>:</p>\n\n<pre><code>class Functor where ...\n\nclass Functor f =&gt; Applicative f where ...\n\nclass Applicative m =&gt; Monad m where ...\n</code></pre>\n\n<p>(Note that this is relationship between <code>Applicative</code> and <code>Monad</code> only enforced in the recently released GHC 7.10)</p>\n\n<p>Applicatives are structures that follow specific rules.  It's more powerful than a functor but less powerful than a monad.  Specifically a functor can only apply a single-argument function to values in a structure, returning a new structure that contains new values but not a new shape.  The canonical example is <code>fmap (+1) [1,2,3] == [2,3,4]</code>, the length of the input list is always the same as the output list.  With applicatives, you can apply a multi-argument pure function across multiple structures:</p>\n\n<pre><code>&gt; (+) &lt;$&gt; [1, 2, 3] &lt;*&gt; [10, 20]\n[11, 21, 12, 22, 13, 23]\n</code></pre>\n\n<p>The output list's length (its \"shape\") depends on the lengths of the input lists.  However, something to note is that the length of the output list does not depend on the <em>values</em> inside the list.  This is the power that monads add to this hierarchy:</p>\n\n<pre><code>&gt; print $ do a &lt;- [1, 2, 3]; b &lt;- replicate a 10; return (a + b)\n[11, 12, 12, 13, 13, 13]\n</code></pre>\n\n<p>Here we are combining two structures together, one of which has a \"shape\" that depends on the values in the other.  This is not possible with just applicatives, and it's the reason why monads are so ubiquitous in Haskell.  However, since every <code>Monad</code> is an <code>Applicative</code> and every <code>Applicative</code> a <code>Functor</code>, you still have access to all these tool when working with <code>Monad</code>s.</p>\n"}, {"tags": [], "owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "is_accepted": false, "score": 4, "last_activity_date": 1428088469, "creation_date": 1428088469, "answer_id": 29438295, "question_id": 29438118, "link": "https://stackoverflow.com/questions/29438118/what-do-symbols-and-mean-in-haskell/29438295#29438295", "title": "What do symbols &lt;$&gt; and &lt;*&gt; mean in Haskell?", "body": "<p><code>&lt;$&gt;</code> is a synonymous of fmap, <code>&lt;$&gt;</code> is the infix operator. It usually used in the context of an applicative functor.</p>\n\n<pre><code>import Control.Applicative ((&lt;$&gt;)\n\n-- (&lt;$&gt;), fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n\nexample1 :: (Int -&gt; Int) -&gt; Maybe Int -&gt; Maybe Int\nexample1 f g = f &lt;$&gt; g  -- f `fmap` (Just x) = Just (f x)\n                        -- f `fmap` Nothing  = Nothing\n</code></pre>\n\n<p>On the other hand the <code>&lt;*&gt;</code> is useful when you have a function in the context of a functor and you want to apply that to some value in a another functor context, for instance:</p>\n\n<pre><code>example2:: Maybe (Int -&gt; Int) -&gt; Maybe Int -&gt; Maybe Int\nexample2 f g = f &lt;*&gt; g -- (Just f) &lt;*&gt; (Just x) = Just ( f x)\n                       -- Nothing  &lt;*&gt; (Just x ) = Nothing\n                       -- (Just f) &lt;*&gt; Nothing   = Nothing\n                       -- Nothing &lt;*&gt;  Nothing   = Nothing\n</code></pre>\n\n<p>It can be pictured as an operator that applies a function and simultaneously takes into account the context in which the function is applied.</p>\n\n<p>These operators lift the values and functions to the context of the Functor in which the operations are carry out.</p>\n"}], "owner": {"reputation": 3366, "user_id": 1756750, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/db2912f03e4de7e109367b40f874fea6?s=128&d=identicon&r=PG", "display_name": "Denis", "link": "https://stackoverflow.com/users/1756750/denis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "accepted_answer_id": 29438136, "answer_count": 2, "score": 4, "last_activity_date": 1457560396, "creation_date": 1428087531, "last_edit_date": 1457560299, "question_id": 29438118, "link": "https://stackoverflow.com/questions/29438118/what-do-symbols-and-mean-in-haskell", "title": "What do symbols &lt;$&gt; and &lt;*&gt; mean in Haskell?", "body": "<p>What do the symbols <code>&lt;$&gt;</code> and <code>&lt;*&gt;</code> mean?</p>\n\n<p>Also, I find some information about <code>&lt;$</code> and <code>$&gt;</code>.</p>\n"}, {"tags": ["haskell", "scalaz"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1428086668, "post_id": 29437817, "comment_id": 47044620, "body": "If I&#39;m reading this right, those two links are talking about two different things both called &quot;variance&quot;. The first one has to do with subtyping (Haskell doesn&#39;t have subtyping, so this won&#39;t apply to Haskell) and the other one has to do with covariance and contravariance in functors."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 5, "creation_date": 1428087048, "post_id": 29437817, "comment_id": 47044762, "body": "in particular, note that the Scala code defines not only the objects <code>Red</code>, <code>Yellow</code> and <code>Green</code>, but also the types <code>Red.type</code>, <code>Yellow.type</code> and <code>Green.type</code>, which are all sub-types of <code>TrafficLight</code>, where the Haskell code defines three values <code>Red</code>, <code>Yellow</code>, and <code>Green</code>, but only one type, <code>TrafficLight</code>."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1428093008, "post_id": 29437817, "comment_id": 47047183, "body": "As mentioned, variance doesn&#39;t make sense because there&#39;s no subtyping (at all). The Haskell answer to subtyping is ad-hoc polymorphism, and in practical terms: type-classes. You might wanna check out the lecture &quot;Adventure with Types in Haskell&quot; by Simon Peyton Jones."}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "closed_date": 1428086889, "answer_count": 0, "score": 0, "last_activity_date": 1428086141, "creation_date": 1428086141, "question_id": 29437817, "link": "https://stackoverflow.com/questions/29437817/haskell-equality-variance", "closed_reason": "Duplicate", "title": "Haskell Equality - Variance?", "body": "<p><a href=\"http://eed3si9n.com/learning-scalaz/typeclasses+102.html\" rel=\"nofollow\">learning Scalaz</a> shows how to make an Algebraic Data Type in Haskell and scalaz:</p>\n\n<p><code>data TrafficLight = Red | Yellow | Green deriving Eq</code></p>\n\n<p>and</p>\n\n<pre><code>sealed trait TrafficLight\ncase object Red    extends TrafficLight\ncase object Yellow extends TrafficLight\ncase object Green  extends TrafficLight\n</code></pre>\n\n<p>But, as the tutorial explains, <a href=\"https://github.com/scalaz/scalaz/blob/c847654dcf75c748eacbaf246511bbd938b8631f/core/src/main/scala/scalaz/Equal.scala#L10\" rel=\"nofollow\">Equal.scala</a> is <strong>invariant</strong>.</p>\n\n<p>Does Haskell have variance? If so/no, does it play a role when comparing <code>Red</code> to <code>Yellow</code>?</p>\n\n<pre><code>Prelude&gt; Red == Red\nTrue\nPrelude&gt; Red == Yellow\nFalse\n</code></pre>\n"}, {"tags": ["parsing", "haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1428083939, "post_id": 29437243, "comment_id": 47043464, "body": "&quot;but I just get type errors&quot; - What type errors?  Can you include those with your question?"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1428084875, "post_id": 29437243, "comment_id": 47043841, "body": "Do you mean <code>attoparsec</code>?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1428085437, "post_id": 29437243, "comment_id": 47044077, "body": "There should be something along the lines of <code>char &#39;:&#39;</code>. To skip it, just write it there without a <code>&lt;-</code>."}, {"owner": {"reputation": 5428, "user_id": 57246, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/65a1be62dd6dee67ab4391b410740ec9?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/57246/david"}, "edited": false, "score": 0, "creation_date": 1428089344, "post_id": 29437243, "comment_id": 47045641, "body": "Yes, I did mean attoparsec. Just so used to typing &#39;attr&#39; in other contexts."}, {"owner": {"reputation": 5428, "user_id": 57246, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/65a1be62dd6dee67ab4391b410740ec9?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/57246/david"}, "edited": false, "score": 0, "creation_date": 1428089363, "post_id": 29437243, "comment_id": 47045648, "body": "Yes, char &#39;:&#39; did the trick. Thank you."}, {"owner": {"reputation": 5428, "user_id": 57246, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/65a1be62dd6dee67ab4391b410740ec9?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/57246/david"}, "edited": false, "score": 0, "creation_date": 1428089465, "post_id": 29437243, "comment_id": 47045681, "body": "The type errors were around Word8 expected but Char was seen."}, {"owner": {"reputation": 5428, "user_id": 57246, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/65a1be62dd6dee67ab4391b410740ec9?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/57246/david"}, "edited": false, "score": 0, "creation_date": 1428089475, "post_id": 29437243, "comment_id": 47045686, "body": "How do I mark this question as answered?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1428104711, "post_id": 29437243, "comment_id": 47050638, "body": "@David Write an answer using the big text box below (or convince AJFarmar to). Then click the green check mark next to that answer. It is considered fine etiquette to answer your own question."}], "answers": [{"tags": [], "owner": {"reputation": 5428, "user_id": 57246, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/65a1be62dd6dee67ab4391b410740ec9?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/57246/david"}, "is_accepted": true, "score": 0, "last_activity_date": 1428157538, "creation_date": 1428157538, "answer_id": 29447535, "question_id": 29437243, "link": "https://stackoverflow.com/questions/29437243/how-do-i-parse-skip-specific-characters-in-attrparsec/29447535#29447535", "title": "How do I parse/skip specific characters in attrparsec?", "body": "<p>AJFarmer posted the best answer.\nSimply use</p>\n\n<pre><code>char ':'\n</code></pre>\n\n<p>However, you'll get a warning about a discarded value so to avoid that warning write</p>\n\n<pre><code>_ &lt;- char ':'\n</code></pre>\n\n<p>Thanks for answering.</p>\n"}], "owner": {"reputation": 5428, "user_id": 57246, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/65a1be62dd6dee67ab4391b410740ec9?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/57246/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 29447535, "answer_count": 1, "score": 2, "last_activity_date": 1428157538, "creation_date": 1428083539, "question_id": 29437243, "link": "https://stackoverflow.com/questions/29437243/how-do-i-parse-skip-specific-characters-in-attrparsec", "title": "How do I parse/skip specific characters in attrparsec?", "body": "<p>I'm trying to learn how to use the attrparsec module and so am practicing by parsing one of my log files.</p>\n\n<p>I have the following code for the beginning of a line parser:</p>\n\n<pre><code> lineParser :: Parser LogEntry\n lineParser = do\n    theMonth &lt;- monthParser\n    skipSpace\n    theDate &lt;- decimal\n    skipSpace\n    theHour &lt;- decimal\n    skipColon\n    theMinute &lt;- decimal\n    skipColon\n    theSecond &lt;- decimal\n    return  LogEntry { monthOfYear = theMonth,  dayOfMonth = theDate,\n    hourOfDay = theHour, minuteOfHour = theMinute, secondOfMinute = theSecond}\n</code></pre>\n\n<p>but I'm having trouble with the skipColon function. I've tried various versions such as</p>\n\n<pre><code>skipColon = isColon \n   where isColon c = c == ':'\n</code></pre>\n\n<p>but I just get type errors</p>\n\n<p>I would have liked to have simply written something like</p>\n\n<pre><code>skipChar ':'\n</code></pre>\n\n<p>but haven't been able to figure that out either.</p>\n\n<p>Ran into all sorts of type errors around Char vs Word8 but most search results where about converting Word8 to Char, not the other way round.</p>\n\n<p>Would appreciate some guidance. Many thanks.</p>\n"}, {"tags": ["haskell", "yesod", "yesod-forms"], "comments": [{"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 2, "creation_date": 1428086173, "post_id": 29437021, "comment_id": 47044403, "body": "what exactly is &quot;not work&quot;? are you getting errors at compile time? at run time? running which command exactly? what output?"}, {"owner": {"reputation": 716, "user_id": 4118267, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xIgkR.jpg?s=128&g=1", "display_name": "oriaj", "link": "https://stackoverflow.com/users/4118267/oriaj"}, "reply_to_user": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1428101950, "post_id": 29437021, "comment_id": 47050052, "body": "yes I have a error at compile:  Handler/TakeExam.hs:32:23:     Not in scope: \u2018questions\u2019     In the splice: $(widgetFile &quot;TakeExam/answerQuestion&quot;)"}], "answers": [{"tags": [], "owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "is_accepted": true, "score": 1, "last_activity_date": 1428403577, "creation_date": 1428403577, "answer_id": 29489690, "question_id": 29437021, "link": "https://stackoverflow.com/questions/29437021/render-multiple-forms-in-the-same-handler-yesod/29489690#29489690", "title": "render multiple forms in the same handler yesod", "body": "<p>And what line of code does the error message refer to?</p>\n\n<pre><code>Handler/TakeExam.hs:32:23: \nNot in scope: \u2018questions\u2019 In the splice: $(widgetFile \"TakeExam/answerQuestion\") \n</code></pre>\n\n<p>I guess it is the splice in the second handler (<code>getAnswerQuestionPR</code>). Indeed, at the point where the file is spliced, no identifier with name <code>questions</code> is visible.</p>\n"}], "owner": {"reputation": 716, "user_id": 4118267, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xIgkR.jpg?s=128&g=1", "display_name": "oriaj", "link": "https://stackoverflow.com/users/4118267/oriaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 29489690, "answer_count": 1, "score": 2, "last_activity_date": 1428403577, "creation_date": 1428082501, "question_id": 29437021, "link": "https://stackoverflow.com/questions/29437021/render-multiple-forms-in-the-same-handler-yesod", "title": "render multiple forms in the same handler yesod", "body": "<p>I want render 2 differents forms in the same handler but I`m not sure if possible.</p>\n\n<p>the forms are:</p>\n\n<pre><code>questionForm ::  ExamId -&gt; AForm Handler Question \nquestionForm  eid =  Question \n            &lt;$&gt; areq textField (bfs (MsgQuestion)) Nothing \n            &lt;*&gt; pure eid \n\nanswerQuestionForm :: QuestionId -&gt; AForm Handler UserAnswer\nanswerQuestionForm  qid  = UserAnswer \n            &lt;$&gt; areq textField (bfs (MsgAnswer)) Nothing\n            &lt;*&gt; pure Nothing \n            &lt;*&gt; pure qid\n</code></pre>\n\n<p>I intend using this GET method</p>\n\n<pre><code> getAnswerQuestionR :: ExamId -&gt; Handler Html\n getAnswerQuestionR eid = do\n                mid &lt;- maybeAuthId\n                questions &lt;- runDB $ selectList [] [Desc     QuestionQuestionText]\n                (articleWidget, enctype) &lt;- generateFormPost $ renderBootstrap3 BootstrapBasicForm $ questionForm eid \n                defaultLayout $ do       \n                 $(widgetFile \"TakeExam/answerQuestion\")\n\n\n getAnswerQuestionPR :: QuestionId -&gt; Handler Html\n getAnswerQuestionPR qid = do \n           uid &lt;- requireAuthId\n           (widget, encoding) &lt;- generateFormPost $ renderBootstrap3 BootstrapBasicForm $ answerQuestionForm qid\n           defaultLayout $ do  \n                let  actionR = ExamR                        \n                $(widgetFile \"TakeExam/answerQuestion\")\n</code></pre>\n\n<p>but this option not work</p>\n"}, {"tags": ["haskell", "algebraic-data-types"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 2, "creation_date": 1428075104, "post_id": 29434403, "comment_id": 47039402, "body": "That&#39;s a type error, not a syntax error."}], "answers": [{"comments": [{"owner": {"reputation": 203, "user_id": 3657132, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/445d86c044c5251d316141ed21183f6e?s=128&d=identicon&r=PG&f=1", "display_name": "User137481", "link": "https://stackoverflow.com/users/3657132/user137481"}, "edited": false, "score": 0, "creation_date": 1428151789, "post_id": 29434638, "comment_id": 47059945, "body": "Your answer is the the same as the book I got the code from. I didn&#39;t understand why the book used BoolLit BoolLit instead of just BoolLit. I&#39;ve got it now. Thanks."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 4, "last_activity_date": 1428073253, "creation_date": 1428073253, "answer_id": 29434638, "question_id": 29434403, "link": "https://stackoverflow.com/questions/29434403/syntax-error-in-pattern-matching-on-algebraic-data-type/29434638#29434638", "title": "Syntax Error in Pattern Matching on Algebraic Data Type", "body": "<p>You have declared the type <code>BoolLit</code> with constructors <code>T :: BoolLit</code> and <code>F :: BoolLit</code>, and you have also declared the type <code>BExp</code> with constructors <code>BoolLit :: BExp</code> and <code>Or :: BExp -&gt; BExp -&gt; BExp</code>.  If you want to wrap the <code>BoolLit</code> type, you'll need to express that in <code>BExp</code>'s constructors:</p>\n\n<pre><code>data BExp = BoolLit BoolLit | Or BExpr BExpr\n</code></pre>\n\n<p>Then you can write <code>bEval</code> as</p>\n\n<pre><code>bEval (BoolLit T) = T\n</code></pre>\n\n<p>Also note that you've defined your <code>Eq</code> instance to always return <code>T</code>, no matter what the arguments to <code>==</code> are.  You need to pattern match here:</p>\n\n<pre><code>instance Eq BoolLit where\n    T == T = True\n    F == F = True\n    _ == _ = False\n</code></pre>\n\n<p>Alternatively you can let GHC figure it out for you using <code>deriving</code>:</p>\n\n<pre><code>data BoolLit = T | F deriving (Eq)\n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 3657132, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/445d86c044c5251d316141ed21183f6e?s=128&d=identicon&r=PG&f=1", "display_name": "User137481", "link": "https://stackoverflow.com/users/3657132/user137481"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 29434638, "answer_count": 1, "score": 1, "last_activity_date": 1428151524, "creation_date": 1428072426, "last_edit_date": 1428151524, "question_id": 29434403, "link": "https://stackoverflow.com/questions/29434403/syntax-error-in-pattern-matching-on-algebraic-data-type", "title": "Syntax Error in Pattern Matching on Algebraic Data Type", "body": "<pre><code>data BoolLit = T | F\ninstance Eq BoolLit where\n   b1 == b2 = True\n\ndata BExp = BoolLit |\n            Or BExp BExp\n\nbEval :: BExp -&gt; BoolLit\nbEval T = T\n</code></pre>\n\n<p>I'm getting the following syntax error:  </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Couldn't match expected type 'BExp' with actual type 'BoolLit'   \nIn the pattern: T   \nIn an equation for 'bEval': bEval T = T\n</code></pre>\n\n<p>The data declaration has declared that BoolLit is a BExp.<br>\nSo, I don't understand why Haskell is giving an error.<br>\nI'd like to know why and how to correct it.<br>\nThanks.</p>\n"}, {"tags": ["haskell", "alternative-functor"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1428067557, "post_id": 29432947, "comment_id": 47035598, "body": "How would you define <code>empty</code> for <code>(-&gt;) r</code>?  Its type would be <code>empty :: r -&gt; a</code>, which is only satisfiable with <code>unsafeCoerce</code> or <code>undefined</code>.  You would need to provide this definition in order to construct an <code>Alternative</code>.  Beyond that, how would you define <code>&lt;|&gt;</code>?  Its type would be <code>(r -&gt; a) -&gt; (r -&gt; a) -&gt; (r -&gt; a)</code>.  If you had the <code>Monoid a =&gt; a</code> constraint then the implementation would be straightforward, but to work with all <code>a</code> you would need to choose which argument to <code>&lt;|&gt;</code> to apply.  Which do you choose?"}], "answers": [{"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1428082117, "post_id": 29434026, "comment_id": 47042642, "body": "OP&#39;s choice of Alternative isn&#39;t very revealing, of course, since <code>&lt;&gt;</code> and <code>&lt;|&gt;</code> are both <code>++</code> for <code>[a]</code>."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 5, "last_activity_date": 1428082314, "last_edit_date": 1428082314, "creation_date": 1428071094, "answer_id": 29434026, "question_id": 29432947, "link": "https://stackoverflow.com/questions/29432947/is-there-instance-alternative-r/29434026#29434026", "title": "Is there instance Alternative ((-&gt;) r)?", "body": "<p>We'd like to express something like \"if the result type is <code>Alternative</code>, then a function returning that type is <code>Alternative</code> too\". This isn't right, however, because only <code>* -&gt; *</code> types can be <code>Alternative</code>. </p>\n\n<p>We might try to remedy our problem by saying that the result type should be <code>f a</code> for some <code>Alternative f</code>, but that's still not good, because the type for which we'd like to define the instance also has to have kind <code>* -&gt; *</code>. </p>\n\n<p>Actually, we just want to define an <code>Alternative</code> instance for the composition of <code>((-&gt;) r)</code> and some <code>Alternative f</code>. We can generalize this notion slightly to the following:</p>\n\n<pre><code>import Data.Functor.Compose\n\ninstance (Applicative f, Alternative g) =&gt; Alternative (Compose f g) where\n  empty = Compose $ pure empty\n  Compose a &lt;|&gt; Compose b = Compose $ liftA2 (&lt;|&gt;) a b\n</code></pre>\n\n<p>Unfortunately there is already a different <code>Alternative</code> <a href=\"https://hackage.haskell.org/package/transformers-0.4.3.0/docs/Data-Functor-Compose.html\" rel=\"nofollow\">instance</a> for <code>Compose f g</code> in the <code>transformers</code> library, and it clashes with the above instance. </p>\n\n<p>Alternatively, we could notice that <code>ReaderT r m</code> is the same thing as <code>Compose ((-&gt;) r) m</code> (modulo <code>newtype</code> wrapping), and fortunately the right instance is already exported by <code>transformers</code>:</p>\n\n<pre><code>instance Alternative m =&gt; Alternative (ReaderT r m)\n</code></pre>\n\n<p>So we can do the following:</p>\n\n<pre><code>import Control.Monad.Reader\n\nrunReaderT (lift [\"a\"] &lt;|&gt; lift [\"b\"]) True\n-- [\"a\", \"b\"] \n\nrunReaderT (empty &lt;|&gt; lift (Just 0)) True\n-- Just 0\n</code></pre>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 29434026, "answer_count": 1, "score": 2, "last_activity_date": 1614131853, "creation_date": 1428066976, "last_edit_date": 1614131853, "question_id": 29432947, "link": "https://stackoverflow.com/questions/29432947/is-there-instance-alternative-r", "title": "Is there instance Alternative ((-&gt;) r)?", "body": "<p>I got accustomed to using <code>a &lt;&gt; b</code> where <code>a</code> and <code>b</code> take arguments.</p>\n\n<pre><code>&gt; const [\"a\"] &lt;&gt; const [\"b\"] $ True\n[\"a\",\"b\"]\n</code></pre>\n\n<p>Why there is no <code>a &lt;|&gt; b</code> as well?</p>\n\n<pre><code>&gt; const [\"a\"] &lt;|&gt; const [\"b\"] $ True\n\n&lt;interactive&gt;:64:13:\n    No instance for (Alternative ((-&gt;) Bool))\n      arising from a use of \u2018&lt;|&gt;\u2019\n    In the expression: const [\"a\"] &lt;|&gt; const [\"b\"]\n    In the expression: const [\"a\"] &lt;|&gt; const [\"b\"] $ True\n    In an equation for \u2018it\u2019: it = const [\"a\"] &lt;|&gt; const [\"b\"] $ True\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 6, "last_activity_date": 1428066881, "last_edit_date": 1428066881, "creation_date": 1428066170, "answer_id": 29432719, "question_id": 29432675, "link": "https://stackoverflow.com/questions/29432675/haskell-couldnt-match-expected-type-char-b0-with-actual-type-char-int/29432719#29432719", "title": "Haskell Couldn&#39;t match expected type \u2018[(Char, b0)]\u2019 with actual type \u2018(Char, Int)\u2019", "body": "<p>Inside your <code>do</code> block</p>\n\n<pre><code>newList &lt;- zip word [0..length word]\n</code></pre>\n\n<p>is desugared into something like</p>\n\n<pre><code>zip word [0..length] &gt;&gt;= \\newList -&gt; ...\n</code></pre>\n\n<p>The type of <code>&gt;&gt;=</code> is <code>(Monad m) =&gt; m a -&gt; (a -&gt; m b) -&gt; m b</code>.</p>\n\n<p>Since <code>zip</code> returns a list, you are using the list monad and therefore the type of <code>newList</code> is actually an <code>(Int, Char)</code>. You cannot then use that as the source for the subsequent list comprehension.</p>\n\n<p>However you don't need to use <code>do</code> at all:</p>\n\n<pre><code>isPart :: Char -&gt; Int\nisPart x = let newList = zip word [0..length word]\n               result = [b | (a,b) &lt;- newList, a == x]\n           in  head result\n</code></pre>\n\n<p>although be aware this will throw an error if the given character is not in <code>word</code></p>\n\n<p>You can also write this more simply as</p>\n\n<pre><code>import Data.List (elemIndex)\nimport Data.Maybe (fromJust)\n\nisPart x = fromJust $ elemIndex x word\n</code></pre>\n\n<p>although a better solution would be to change the return type to <code>Maybe Int</code> instead of using <code>fromJust</code>.</p>\n"}], "owner": {"reputation": 1094, "user_id": 4314870, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8b0dfe71faba6f43642a0ff77581ec46?s=128&d=identicon&r=PG&f=1", "display_name": "Hespen", "link": "https://stackoverflow.com/users/4314870/hespen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "accepted_answer_id": 29432719, "answer_count": 1, "score": 0, "last_activity_date": 1428066881, "creation_date": 1428066012, "question_id": 29432675, "link": "https://stackoverflow.com/questions/29432675/haskell-couldnt-match-expected-type-char-b0-with-actual-type-char-int", "title": "Haskell Couldn&#39;t match expected type \u2018[(Char, b0)]\u2019 with actual type \u2018(Char, Int)\u2019", "body": "<p>So I have got this piece of code, which returns an error on it's expected type. <br><br>\nCouldn't match expected type \u2018[(Char, b0)]\u2019<br>\nwith actual type \u2018(Char, Int)\u2019<br>\nIn the expression: newList<br>\nIn a stmt of a list comprehension: (a, b) &lt;- newList<br><br></p>\n\n<p>I want to get the location of the character back, so that would be 'b'. I just don't understand why it gives me a type error. Whenever I run the code one by one inside the WinGHCI, I'll get the correct information back. When putting it in a .hs file, it won't.</p>\n\n<pre><code>word = \"apple\"\nisPart :: Char -&gt; a\nisPart x = do\n            newList &lt;- zip word [0..length word]\n            result &lt;- [b | (a,b) &lt;- newList, a == x]\n            return result\n</code></pre>\n"}, {"tags": ["haskell", "httprequest"], "answers": [{"comments": [{"owner": {"reputation": 28845, "user_id": 238232, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ccda2293fc93c7a871956102004ac19d?s=128&d=identicon&r=PG", "display_name": "cnd", "link": "https://stackoverflow.com/users/238232/cnd"}, "edited": false, "score": 0, "creation_date": 1428389339, "post_id": 29455743, "comment_id": 47130499, "body": "should I use <code>resourcet</code> package for <code>ResourceT</code> ?"}, {"owner": {"reputation": 28845, "user_id": 238232, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ccda2293fc93c7a871956102004ac19d?s=128&d=identicon&r=PG", "display_name": "cnd", "link": "https://stackoverflow.com/users/238232/cnd"}, "edited": false, "score": 0, "creation_date": 1428389933, "post_id": 29455743, "comment_id": 47130834, "body": "and run other methods with <code>liftIO $ putStrLn &quot;Timed out. Trying again.&quot;</code>"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 28845, "user_id": 238232, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ccda2293fc93c7a871956102004ac19d?s=128&d=identicon&r=PG", "display_name": "cnd", "link": "https://stackoverflow.com/users/238232/cnd"}, "edited": false, "score": 0, "creation_date": 1428403131, "post_id": 29455743, "comment_id": 47138093, "body": "Yes to both questions"}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 1, "last_activity_date": 1428224742, "creation_date": 1428224742, "answer_id": 29455743, "question_id": 29431886, "link": "https://stackoverflow.com/questions/29431886/how-to-retry-http-request-on-timeout/29455743#29455743", "title": "How to retry http request on timeout?", "body": "<p>The error message is telling you that your code expects a <code>IO a</code>, but in fact is being given a <code>ResourceT IO a</code>. The easiest thing to do is:</p>\n\n<ul>\n<li>Change your type signature to match</li>\n<li>Use <code>catch</code> from <code>Control.Exception.Lifted</code> (in the <code>lifted-base</code> package) instead of from <code>Control.Exception</code></li>\n</ul>\n"}], "owner": {"reputation": 28845, "user_id": 238232, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/ccda2293fc93c7a871956102004ac19d?s=128&d=identicon&r=PG", "display_name": "cnd", "link": "https://stackoverflow.com/users/238232/cnd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 502, "favorite_count": 1, "accepted_answer_id": 29455743, "answer_count": 1, "score": 1, "last_activity_date": 1428224742, "creation_date": 1428062691, "question_id": 29431886, "link": "https://stackoverflow.com/questions/29431886/how-to-retry-http-request-on-timeout", "title": "How to retry http request on timeout?", "body": "<p>I often have got timeouts in my download method, I want to add some retries here:</p>\n\n<pre><code>withSocketsDo $ do\n    irequest  \u2190 liftIO $ parseUrl url\n    fileExist \u2190 doesFileExist fname\n    when fileExist $ do\n        putStrLn \" -&gt; Removing old version\"\n        removeFile fname\n    withManager $ \\manager \u2192 do\n        let request = irequest\n             { method = methodGet\n             , responseTimeout = Just 10000000 }\n        response \u2190 http request manager\n        responseBody response C.$$+- sinkFile fname\n</code></pre>\n\n<p>I've found method with <code>ScopedTypeVariables</code></p>\n\n<pre><code>retryOnTimeout \u2237 IO a \u2192 IO a\nretryOnTimeout action = catch action $ \\ (_ :: HttpException) \u2192 do\n    putStrLn \"Timed out. Trying again.\"\n    threadDelay 5000000\n    action\n</code></pre>\n\n<p>Adding try count is not big problem but seems like I can't just use something alike</p>\n\n<pre><code>response \u2190 retryOnTimeout ( http request manager )\n</code></pre>\n\n<p>Because it cause strange type conflicts</p>\n\n<pre><code>Couldn't match type `IO'\n              with `resourcet-1.1.3.3:Control.Monad.Trans.Resource.Internal.ResourceT\n                      IO'\nExpected type: resourcet-1.1.3.3:Control.Monad.Trans.Resource.Internal.ResourceT\n                 IO\n                 (Network.HTTP.Conduit.Response\n                    (C.ResumableSource IO Data.ByteString.Internal.ByteString))\n  Actual type: IO\n                 (Network.HTTP.Conduit.Response\n                    (C.ResumableSource IO Data.ByteString.Internal.ByteString))\n</code></pre>\n\n<p>How can I implement retry on Timeout for HTTP get method?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1428063325, "post_id": 29431940, "comment_id": 47033388, "body": "This will apply every argument with every function, right? OP wants &quot;each element of the one list, map with the other element of the other list&quot; which I think can be understood as applying first function with first parameter only and so forth."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 1, "creation_date": 1428063670, "post_id": 29431940, "comment_id": 47033571, "body": "@user2079303 I had difficult parsing the question. If that&#39;s what OP what then he can take zip of both list and then apply them. But the expected output in his current question is wrong then ?"}, {"owner": {"reputation": 17, "user_id": 4740101, "user_type": "registered", "profile_image": "https://graph.facebook.com/358492341027085/picture?type=large", "display_name": "\u0394\u03b9\u03bf\u03bd\u03c5\u03c3\u03b9\u03b1 \u0391\u03b3\u03b1\u03bb\u03b9\u03ce\u03c4\u03b7", "link": "https://stackoverflow.com/users/4740101/%ce%94%ce%b9%ce%bf%ce%bd%cf%85%cf%83%ce%b9%ce%b1-%ce%91%ce%b3%ce%b1%ce%bb%ce%b9%cf%8e%cf%84%ce%b7"}, "edited": false, "score": 0, "creation_date": 1428064112, "post_id": 29431940, "comment_id": 47033800, "body": "I just corrected my question (2nd parameter to my apply) .. is it more clear now? @sibi i want to apply every argument with every function..right"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 17, "user_id": 4740101, "user_type": "registered", "profile_image": "https://graph.facebook.com/358492341027085/picture?type=large", "display_name": "\u0394\u03b9\u03bf\u03bd\u03c5\u03c3\u03b9\u03b1 \u0391\u03b3\u03b1\u03bb\u03b9\u03ce\u03c4\u03b7", "link": "https://stackoverflow.com/users/4740101/%ce%94%ce%b9%ce%bf%ce%bd%cf%85%cf%83%ce%b9%ce%b1-%ce%91%ce%b3%ce%b1%ce%bb%ce%b9%cf%8e%cf%84%ce%b7"}, "edited": false, "score": 0, "creation_date": 1428064279, "post_id": 29431940, "comment_id": 47033903, "body": "@\u0394\u03b9\u03bf\u03bd\u03c5\u03c3\u03b9\u03b1\u0391\u03b3\u03b1\u03bb\u03b9\u03ce\u03c4\u03b7 Since you have corrected your second part of the question, why don&#39;t you apply that parameter to the <code>&lt;*&gt;</code>  and see what it produces."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1428064300, "post_id": 29431940, "comment_id": 47033921, "body": "Ah, it seems my parsing was less accurate :)"}, {"owner": {"reputation": 17, "user_id": 4740101, "user_type": "registered", "profile_image": "https://graph.facebook.com/358492341027085/picture?type=large", "display_name": "\u0394\u03b9\u03bf\u03bd\u03c5\u03c3\u03b9\u03b1 \u0391\u03b3\u03b1\u03bb\u03b9\u03ce\u03c4\u03b7", "link": "https://stackoverflow.com/users/4740101/%ce%94%ce%b9%ce%bf%ce%bd%cf%85%cf%83%ce%b9%ce%b1-%ce%91%ce%b3%ce%b1%ce%bb%ce%b9%cf%8e%cf%84%ce%b7"}, "edited": false, "score": 0, "creation_date": 1428064825, "post_id": 29431940, "comment_id": 47034181, "body": "@sibi this is an exercise for my uni, and as far as i am a new haskell programmer, i can&#39;t use applicable just because the professor haven&#39;t learned it to me.."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 17, "user_id": 4740101, "user_type": "registered", "profile_image": "https://graph.facebook.com/358492341027085/picture?type=large", "display_name": "\u0394\u03b9\u03bf\u03bd\u03c5\u03c3\u03b9\u03b1 \u0391\u03b3\u03b1\u03bb\u03b9\u03ce\u03c4\u03b7", "link": "https://stackoverflow.com/users/4740101/%ce%94%ce%b9%ce%bf%ce%bd%cf%85%cf%83%ce%b9%ce%b1-%ce%91%ce%b3%ce%b1%ce%bb%ce%b9%cf%8e%cf%84%ce%b7"}, "edited": false, "score": 0, "creation_date": 1428065092, "post_id": 29431940, "comment_id": 47034319, "body": "@\u0394\u03b9\u03bf\u03bd\u03c5\u03c3\u03b9\u03b1\u0391\u03b3\u03b1\u03bb\u03b9\u03ce\u03c4\u03b7 Hint: Try applying map twice each wit one list and see where it goes."}, {"owner": {"reputation": 17, "user_id": 4740101, "user_type": "registered", "profile_image": "https://graph.facebook.com/358492341027085/picture?type=large", "display_name": "\u0394\u03b9\u03bf\u03bd\u03c5\u03c3\u03b9\u03b1 \u0391\u03b3\u03b1\u03bb\u03b9\u03ce\u03c4\u03b7", "link": "https://stackoverflow.com/users/4740101/%ce%94%ce%b9%ce%bf%ce%bd%cf%85%cf%83%ce%b9%ce%b1-%ce%91%ce%b3%ce%b1%ce%bb%ce%b9%cf%8e%cf%84%ce%b7"}, "edited": false, "score": 0, "creation_date": 1428065511, "post_id": 29431940, "comment_id": 47034534, "body": "i have done this:       apply :: Ord u =&gt; [v-&gt;u]-&gt;[v]-&gt;[u]                  apply p s = apply p s : ($ map t s) which is wrong."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 17, "user_id": 4740101, "user_type": "registered", "profile_image": "https://graph.facebook.com/358492341027085/picture?type=large", "display_name": "\u0394\u03b9\u03bf\u03bd\u03c5\u03c3\u03b9\u03b1 \u0391\u03b3\u03b1\u03bb\u03b9\u03ce\u03c4\u03b7", "link": "https://stackoverflow.com/users/4740101/%ce%94%ce%b9%ce%bf%ce%bd%cf%85%cf%83%ce%b9%ce%b1-%ce%91%ce%b3%ce%b1%ce%bb%ce%b9%cf%8e%cf%84%ce%b7"}, "edited": false, "score": 0, "creation_date": 1428065972, "post_id": 29431940, "comment_id": 47034773, "body": "@\u0394\u03b9\u03bf\u03bd\u03c5\u03c3\u03b9\u03b1\u0391\u03b3\u03b1\u03bb\u03b9\u03ce\u03c4\u03b7 Post your attempt with the error message you are facing as a new question."}, {"owner": {"reputation": 17, "user_id": 4740101, "user_type": "registered", "profile_image": "https://graph.facebook.com/358492341027085/picture?type=large", "display_name": "\u0394\u03b9\u03bf\u03bd\u03c5\u03c3\u03b9\u03b1 \u0391\u03b3\u03b1\u03bb\u03b9\u03ce\u03c4\u03b7", "link": "https://stackoverflow.com/users/4740101/%ce%94%ce%b9%ce%bf%ce%bd%cf%85%cf%83%ce%b9%ce%b1-%ce%91%ce%b3%ce%b1%ce%bb%ce%b9%cf%8e%cf%84%ce%b7"}, "edited": false, "score": 0, "creation_date": 1428066334, "post_id": 29431940, "comment_id": 47034968, "body": "i don&#39;t think that my logic is right.. but my error message is                                  Type error in application *** Expression     : map t s *** Term           : t *** Type           : [a -&gt; c] *** Does not match : a -&gt; b"}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 4, "last_activity_date": 1428062963, "creation_date": 1428062963, "answer_id": 29431940, "question_id": 29431841, "link": "https://stackoverflow.com/questions/29431841/higher-order-functions-in-haskell/29431940#29431940", "title": "higher order functions in haskell", "body": "<p>Let us take your first list:</p>\n\n<pre><code>[(^2),(^3),(^4),(2^)]\n</code></pre>\n\n<p>It's type is <code>xs :: Integral a =&gt; [a -&gt; a]</code></p>\n\n<p>Now you want to apply it to to a list <code>[10]</code>. What you want is exactly Applicative function <code>&lt;*&gt;</code> whose type is <code>Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b</code>:</p>\n\n<pre><code>\u03bb&gt; import Control.Applicative\n\u03bb&gt; let xs = [(^2),(^3),(^4),(2^)]\n\u03bb&gt; xs &lt;*&gt; [10]\n[100,1000,10000,1024]\n</code></pre>\n\n<p>You can work out the types to see how they fit together. Your second example doesn't seem to be correct as you are not passing any second parameter to your <code>apply</code> function. I would suggest you to start reading <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow\">LYAH</a> to further solidify the concepts.</p>\n"}], "owner": {"reputation": 17, "user_id": 4740101, "user_type": "registered", "profile_image": "https://graph.facebook.com/358492341027085/picture?type=large", "display_name": "\u0394\u03b9\u03bf\u03bd\u03c5\u03c3\u03b9\u03b1 \u0391\u03b3\u03b1\u03bb\u03b9\u03ce\u03c4\u03b7", "link": "https://stackoverflow.com/users/4740101/%ce%94%ce%b9%ce%bf%ce%bd%cf%85%cf%83%ce%b9%ce%b1-%ce%91%ce%b3%ce%b1%ce%bb%ce%b9%cf%8e%cf%84%ce%b7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1428063815, "creation_date": 1428062506, "last_edit_date": 1428063815, "question_id": 29431841, "link": "https://stackoverflow.com/questions/29431841/higher-order-functions-in-haskell", "title": "higher order functions in haskell", "body": "<p>i have a list with functions and one other list with \"arguments\" to make a new list where each element of the one list, map with the other element of the other list. (apply :: Ord u => [v->u]->[v]->[u] ) \nFor example, </p>\n\n<pre><code>apply [(^2),(^3),(^4),(2^)] [10] = [100,1000,1024,10000]. or \napply [reverse,(++\"ing\"),reverse.(++\"ing\"),(++\"ing\").reverse] [\"play\",\"do\"] = [\"doing\",\"gniod\",\"gniyalp\",\"od\",\"oding\",\"playing\",\"yalp\",\"yalping\"]..\n</code></pre>\n\n<p>What can i do, because i do my first steps in haskel..</p>\n"}, {"tags": ["haskell", "command-line-interface"], "comments": [{"owner": {"reputation": 6144, "user_id": 684285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e54dafa761a462367daa2d560bd72a86?s=128&d=identicon&r=PG", "display_name": "Evi1M4chine", "link": "https://stackoverflow.com/users/684285/evi1m4chine"}, "reply_to_user": {"reputation": 15041, "user_id": 1455016, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ae8ab91a64f21f0e65b69a0bf1ca4904?s=128&d=identicon&r=PG", "display_name": "tbodt", "link": "https://stackoverflow.com/users/1455016/tbodt"}, "edited": false, "score": 0, "creation_date": 1469471569, "post_id": 29428703, "comment_id": 64539193, "body": "Yes, @tbodt. This is just a case of the generic raw keyboard input problem. <b>How does one mark something as a duplicate?</b>"}, {"owner": {"reputation": 15041, "user_id": 1455016, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ae8ab91a64f21f0e65b69a0bf1ca4904?s=128&d=identicon&r=PG", "display_name": "tbodt", "link": "https://stackoverflow.com/users/1455016/tbodt"}, "reply_to_user": {"reputation": 6144, "user_id": 684285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e54dafa761a462367daa2d560bd72a86?s=128&d=identicon&r=PG", "display_name": "Evi1M4chine", "link": "https://stackoverflow.com/users/684285/evi1m4chine"}, "edited": false, "score": 1, "creation_date": 1469471824, "post_id": 29428703, "comment_id": 64539323, "body": "@Evi1M4chine You get 3,000 reputation, and then a &quot;close&quot; button appears under the question."}], "answers": [{"comments": [{"owner": {"reputation": 797, "user_id": 2799055, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/94df8a6bb7ee4d9b77adb8ab4f381422?s=128&d=identicon&r=PG&f=1", "display_name": "azaviruha", "link": "https://stackoverflow.com/users/2799055/azaviruha"}, "edited": false, "score": 0, "creation_date": 1428051914, "post_id": 29428805, "comment_id": 47028448, "body": "Thank you! Very helpful links."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 7, "last_activity_date": 1428049832, "creation_date": 1428049832, "answer_id": 29428805, "question_id": 29428703, "link": "https://stackoverflow.com/questions/29428703/how-to-process-arrow-keys-in-cli-based-application-in-haskell/29428805#29428805", "title": "How to process arrow keys in CLI-based application, in Haskell?", "body": "<p>One way to do that would be to use bindings to ncurses library. Infact <a href=\"https://hackage.haskell.org/package/ncurses\">ncurses</a> shows you an example of handing the key character \"Q\" in their sample program.</p>\n\n<p>Another nice Haskell solution is <a href=\"http://jtdaugherty.github.io/vty-ui/\">vty-ui</a> which has got a <a href=\"http://jtdaugherty.github.io/vty-ui/manuals/vty-ui-users-manual-1.8.pdf\">nice documentation</a> to it. </p>\n"}], "owner": {"reputation": 797, "user_id": 2799055, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/94df8a6bb7ee4d9b77adb8ab4f381422?s=128&d=identicon&r=PG&f=1", "display_name": "azaviruha", "link": "https://stackoverflow.com/users/2799055/azaviruha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 719, "favorite_count": 2, "closed_date": 1469530126, "accepted_answer_id": 29428805, "answer_count": 1, "score": 6, "last_activity_date": 1469471361, "creation_date": 1428049329, "question_id": 29428703, "link": "https://stackoverflow.com/questions/29428703/how-to-process-arrow-keys-in-cli-based-application-in-haskell", "closed_reason": "Duplicate", "title": "How to process arrow keys in CLI-based application, in Haskell?", "body": "<p>I'm writing simple console Pomodoro timer (as my Haskell learning exercise):\n<img src=\"https://i.stack.imgur.com/RULd8.png\" alt=\"pomodoro-cli\"></p>\n\n<p>Until that time menu was based on the prompt line. But now I want to replace it with arrow-based menu, like in <a href=\"http://yeoman.io/\" rel=\"nofollow noreferrer\">Yeoman</a>:\n<img src=\"https://i.stack.imgur.com/qqk8o.png\" alt=\"http://yeoman.io/codelab/install-generators.html\"></p>\n\n<p>How can I do it in Haskell?\nI read about System.Console.Terminfo.Keys and other System.Console packages, but not found solution for my question.</p>\n"}, {"tags": ["haskell", "types", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 204019, "user_id": 36723, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/d5a138149601087e78436b67718578cd?s=128&d=identicon&r=PG", "display_name": "bdonlan", "link": "https://stackoverflow.com/users/36723/bdonlan"}, "is_accepted": true, "score": 5, "last_activity_date": 1428042079, "creation_date": 1428042079, "answer_id": 29427204, "question_id": 29427155, "link": "https://stackoverflow.com/questions/29427155/random-returning-g-g-instead-of-double-g/29427204#29427204", "title": "random returning (g, g) instead of (Double, g)?", "body": "<p>You have <code>gen'</code> and <code>roll</code> backwards in your <code>randomR</code> invocation. GHC knows the second arg has to be of the same type as <code>gen</code> due to <code>randomR</code>'s definition, and knows that the first arg has to be <code>g</code> because it's returned in a context where it has to be <code>g</code>. So it turns up an unhelpful error like that when it eventually runs into a contradiction with this train of logic.</p>\n\n<p>As a tip, when you run into things like this, start adding <code>expr :: Type</code> annotations in the middle of your code with what you think is the correct type. It'll help force the contradiction to happen at the point where the actual error lies.</p>\n"}], "owner": {"reputation": 1192, "user_id": 3130218, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4bb68cdeb7d159067f837658ff981d0b?s=128&d=identicon&r=PG", "display_name": "bb94", "link": "https://stackoverflow.com/users/3130218/bb94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 29427204, "answer_count": 1, "score": 0, "last_activity_date": 1428042079, "creation_date": 1428041792, "question_id": 29427155, "link": "https://stackoverflow.com/questions/29427155/random-returning-g-g-instead-of-double-g", "title": "random returning (g, g) instead of (Double, g)?", "body": "<p>I have this snippet of code:</p>\n\n<pre><code>  markovNextSS :: (RandomGen g, Ord a) =&gt; (MarkovChain a, a, g) -&gt; (MarkovChain a, a, g)\n  markovNextSS (chain, prev, gen) = let\n    (gen', roll) = randomR (0.0, 1.0) gen\n    -- expected to get a (Double, g) above,\n    -- but GHC 7.8.3 says that this is a (g, g) instead\n    next = markovNext chain prev roll\n    in (chain, next, gen')\n</code></pre>\n\n<p>Why would GHC be inferring the wrong type above, especially if <code>RandomGen</code> is not an instance of <code>Random</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "edited": false, "score": 7, "creation_date": 1428022247, "post_id": 29424617, "comment_id": 47020794, "body": "You never call <code>f</code>.  Try deleting the type signatures and see what type GHC infers for your functions (the <code>f</code> argument will be completely polymorphic)."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "edited": false, "score": 0, "creation_date": 1428038830, "post_id": 29424617, "comment_id": 47024118, "body": "as @jcast said: you just need a summand more for your <code>otherwise</code> case but while manual recursion is nice to start I would recommend to think about how to do this with <code>map</code> and <code>sum</code> instead - <b>PS</b> what is the <code>hosum</code> for? I thnk you can just delete this here - also you might try to find better function names and give an example of how you want to call your functions - it&#39;s a bit strange here"}, {"owner": {"reputation": 17, "user_id": 4740101, "user_type": "registered", "profile_image": "https://graph.facebook.com/358492341027085/picture?type=large", "display_name": "\u0394\u03b9\u03bf\u03bd\u03c5\u03c3\u03b9\u03b1 \u0391\u03b3\u03b1\u03bb\u03b9\u03ce\u03c4\u03b7", "link": "https://stackoverflow.com/users/4740101/%ce%94%ce%b9%ce%bf%ce%bd%cf%85%cf%83%ce%b9%ce%b1-%ce%91%ce%b3%ce%b1%ce%bb%ce%b9%cf%8e%cf%84%ce%b7"}, "reply_to_user": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "edited": false, "score": 0, "creation_date": 1428050448, "post_id": 29424617, "comment_id": 47027888, "body": "@jcast i don&#39;t understand what you are saying just because i am a beginner with haskell .. this exercise is for my class  and my professor has told us to make this function starting with the following:    hosum :: (Int-&gt;Int)-&gt;(Int-&gt;Int)     hosum f n . something more clear would be helpfull"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4740101, "user_type": "registered", "profile_image": "https://graph.facebook.com/358492341027085/picture?type=large", "display_name": "\u0394\u03b9\u03bf\u03bd\u03c5\u03c3\u03b9\u03b1 \u0391\u03b3\u03b1\u03bb\u03b9\u03ce\u03c4\u03b7", "link": "https://stackoverflow.com/users/4740101/%ce%94%ce%b9%ce%bf%ce%bd%cf%85%cf%83%ce%b9%ce%b1-%ce%91%ce%b3%ce%b1%ce%bb%ce%b9%cf%8e%cf%84%ce%b7"}, "edited": false, "score": 0, "creation_date": 1428058989, "post_id": 29429299, "comment_id": 47031299, "body": "Furthermore, what would i do, if i had  a list with function and one other list to make a new list where each element of the one list, map with the other element of the other list ? For example, apply [(^2),(^3),(^4),(2^)] [10] =  [100,1000,1024,10000]. the length of each list could be bigger"}, {"owner": {"reputation": 17464, "user_id": 2040251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UsW2G.jpg?s=128&g=1", "display_name": "kraskevich", "link": "https://stackoverflow.com/users/2040251/kraskevich"}, "reply_to_user": {"reputation": 17, "user_id": 4740101, "user_type": "registered", "profile_image": "https://graph.facebook.com/358492341027085/picture?type=large", "display_name": "\u0394\u03b9\u03bf\u03bd\u03c5\u03c3\u03b9\u03b1 \u0391\u03b3\u03b1\u03bb\u03b9\u03ce\u03c4\u03b7", "link": "https://stackoverflow.com/users/4740101/%ce%94%ce%b9%ce%bf%ce%bd%cf%85%cf%83%ce%b9%ce%b1-%ce%91%ce%b3%ce%b1%ce%bb%ce%b9%cf%8e%cf%84%ce%b7"}, "edited": false, "score": 0, "creation_date": 1428069035, "post_id": 29429299, "comment_id": 47036310, "body": "@\u0394\u03b9\u03bf\u03bd\u03c5\u03c3\u03b9\u03b1\u0391\u03b3\u03b1\u03bb\u03b9\u03ce\u03c4\u03b7 You can use list comprehensions. Something like this: <code>[f x | f &lt;- [(2*), (2+)], x &lt;- [1, 2]]</code> = <code>[2, 4, 3, 4]</code>."}], "tags": [], "owner": {"reputation": 17464, "user_id": 2040251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UsW2G.jpg?s=128&g=1", "display_name": "kraskevich", "link": "https://stackoverflow.com/users/2040251/kraskevich"}, "is_accepted": true, "score": 1, "last_activity_date": 1428052243, "creation_date": 1428052243, "answer_id": 29429299, "question_id": 29424617, "link": "https://stackoverflow.com/questions/29424617/higher-order-functions-in-haskell/29429299#29429299", "title": "higher-order functions in Haskell", "body": "<p>As pointed out in the comments, your code never calls the <code>f</code> function. There are several other things in your code that I don't understand:</p>\n\n<ol>\n<li><p><code>hosum f 0 = 1</code>. Why is it one for any <code>f</code>. Shouldn't it be <code>f 0</code>? </p></li>\n<li><p>In <code>afunction</code>, why is the result <code>0</code> if <code>a == z</code>. If the range is inclusive, it should be zero only if <code>a &gt; z</code>.</p></li>\n<li><p><code>afunction</code> in the <code>otherwise</code> case calls itself twice. Why doesn't it apply <code>f</code> to  <code>a</code> and calls <code>afunction f (a + 1) z</code> only?</p></li>\n</ol>\n\n<p>Now about a correct solution.\nThe easiest(and idiomatic) way to implement it is to use standard <code>sum</code> and <code>map</code> functions. It gives a one-liner(if we don't count type signature):</p>\n\n<pre><code>hosum :: (Int -&gt; Int) -&gt; Int -&gt; Int\nhosum f n = sum $ map f [-abs(n)..abs(n)]\n</code></pre>\n\n<p>In plain English, this function takes a list of all numbers from <code>-abs(n)</code> to <code>abs(n)</code>, applies <code>f</code> to each of them and sums them up. That's exactly what the problem statement tells us to do.</p>\n"}], "owner": {"reputation": 17, "user_id": 4740101, "user_type": "registered", "profile_image": "https://graph.facebook.com/358492341027085/picture?type=large", "display_name": "\u0394\u03b9\u03bf\u03bd\u03c5\u03c3\u03b9\u03b1 \u0391\u03b3\u03b1\u03bb\u03b9\u03ce\u03c4\u03b7", "link": "https://stackoverflow.com/users/4740101/%ce%94%ce%b9%ce%bf%ce%bd%cf%85%cf%83%ce%b9%ce%b1-%ce%91%ce%b3%ce%b1%ce%bb%ce%b9%cf%8e%cf%84%ce%b7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 29429299, "answer_count": 1, "score": 0, "last_activity_date": 1428052243, "creation_date": 1428020918, "question_id": 29424617, "link": "https://stackoverflow.com/questions/29424617/higher-order-functions-in-haskell", "title": "higher-order functions in Haskell", "body": "<p>I have written the following code:</p>\n\n<pre><code>hosum :: (Int-&gt;Int)-&gt;(Int-&gt;Int)     \nhosum f 0 = 1\nhosum f n = afunction f (-abs(n)) (abs(n))\n\n\nafunction :: (Int-&gt;Int)-&gt;Int-&gt;Int-&gt;Int\nafunction f a z\n    |a==z\n        = 0\n    |otherwise\n        = afunction f (a+1) z + afunction f a z\n</code></pre>\n\n<p>to find the sum of f(i) from -|n| to |n|..  Where is my mistake? </p>\n"}, {"tags": ["list", "haskell", "matching"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1428077157, "post_id": 29423774, "comment_id": 47040371, "body": "When in doubt, Hoogle. <a href=\"https://www.haskell.org/hoogle/?hoogle=zip+%3A%3A+%5Ba%5D+-%3E+%5Bb%5D+-%3E+%5B%28a%2Cb%29%5D\" rel=\"nofollow noreferrer\">haskell.org/hoogle/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4744432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04aca1cacc433d2c633abcfe2c7692b?s=128&d=identicon&r=PG&f=1", "display_name": "Tomahawk", "link": "https://stackoverflow.com/users/4744432/tomahawk"}, "edited": false, "score": 0, "creation_date": 1428043169, "post_id": 29423789, "comment_id": 47025314, "body": "I was trying to solve from     [(x,y)|x&lt;-..., y&lt;-....]  , But your solution is more elegant and simplier . thnx"}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 5, "last_activity_date": 1428015768, "last_edit_date": 1428015768, "creation_date": 1428015047, "answer_id": 29423789, "question_id": 29423774, "link": "https://stackoverflow.com/questions/29423774/how-to-match-list-elements-1-to-1-in-haskell/29423789#29423789", "title": "how to match list elements 1-to-1 in Haskell", "body": "<p>You're looking for the <code>zip</code> function:</p>\n\n<pre><code>&gt; zip [1, 2, 3] ['a', 'b', 'c']\n</code></pre>\n\n<p>For future reference you can use <a href=\"https://www.fpcomplete.com/hoogle?q=[a]+-%3E+[b]+-%3E+[%28a%2C+b%29]&amp;env=ghc-7.8-stable-14.09\" rel=\"nofollow\">hoogle</a> to help find functions based on their type signature.</p>\n"}, {"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 0, "last_activity_date": 1428311492, "last_edit_date": 1428311492, "creation_date": 1428077527, "answer_id": 29435762, "question_id": 29423774, "link": "https://stackoverflow.com/questions/29423774/how-to-match-list-elements-1-to-1-in-haskell/29435762#29435762", "title": "how to match list elements 1-to-1 in Haskell", "body": "<p>There are three main ways of doing this.</p>\n\n<p>First, the <code>zip</code> function:</p>\n\n<pre><code>&gt; zip [1,2,3] \"abc\"\n[(1,'a'), (2,'b'), (3, 'c)]\n</code></pre>\n\n<p>And it's pal, the <code>zipWith</code> function:</p>\n\n<pre><code>&gt; zipWith (,) [1,2,3] \"abc\"\n[(1,'a'), (2,'b'), (3, 'c)]\n</code></pre>\n\n<p>Finally, with the <code>ParallelListComp</code> extension*: </p>\n\n<pre><code>&gt; [(a,b) | a &lt;- [1,2,3] | b &lt;- \"abc\"]\n[(1,'a'),(2,'b'),(3,'c')]\n</code></pre>\n\n<p>If you're looking for a function in the future, use <a href=\"https://www.haskell.org/hoogle/?hoogle=%3A%3A+%5Ba%5D+-%3E+%5Bb%5D+-%3E+%5B%28a%2Cb%29%5D\" rel=\"nofollow\">hoogle</a>, which lets you look for type signatures as well as names.</p>\n\n<hr>\n\n<p>If you really want to, you can define it explicitly:</p>\n\n<pre><code>zip' :: [a] -&gt; [b] -&gt; [(a,b)]\nzip' []     _      = []\nzip' _      []     = []\nzip' (a:as) (b:bs) = (a,b) : zip as bs\n</code></pre>\n\n<hr>\n\n<p>*call GHCi with <code>-XParallelListComp</code> or add <code>{-# OPTIONS_GHC -XParallelListComp #-}</code> to your file.</p>\n"}], "owner": {"reputation": 11, "user_id": 4744432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e04aca1cacc433d2c633abcfe2c7692b?s=128&d=identicon&r=PG&f=1", "display_name": "Tomahawk", "link": "https://stackoverflow.com/users/4744432/tomahawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1428311492, "creation_date": 1428014971, "last_edit_date": 1428020218, "question_id": 29423774, "link": "https://stackoverflow.com/questions/29423774/how-to-match-list-elements-1-to-1-in-haskell", "title": "how to match list elements 1-to-1 in Haskell", "body": "<p>I have 2 lists in equal number of elements e.g.: <code>[1,2,3]</code> and <code>['a','b','c']</code>.</p>\n\n<p>I want to merge both of them in the format <code>[(1,'a')(2,'b')(3,'c')]</code>. Is it possible? If so, how to do that? I couldn't find a way.</p>\n"}, {"tags": ["haskell", "lazy-evaluation"], "comments": [{"owner": {"reputation": 12035, "user_id": 603094, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/325af9a946cb4337c6640f0e95044be1?s=128&d=identicon&r=PG", "display_name": "kirelagin", "link": "https://stackoverflow.com/users/603094/kirelagin"}, "edited": false, "score": 0, "creation_date": 1428014183, "post_id": 29423483, "comment_id": 47018666, "body": "I can\u2019t understand what you are asking. Looks like you are trying to reason about evaluation of expressions, but I have no idea what you are talking about in your examples. The keyword to learn more at Google is \u201cWHNF\u201d."}, {"owner": {"reputation": 12035, "user_id": 603094, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/325af9a946cb4337c6640f0e95044be1?s=128&d=identicon&r=PG", "display_name": "kirelagin", "link": "https://stackoverflow.com/users/603094/kirelagin"}, "edited": false, "score": 0, "creation_date": 1428014330, "post_id": 29423483, "comment_id": 47018730, "body": "If someone tried to answer your question directly then the answer would be: \u201cNone of the expressions as they are written in your example are ever evaluated\u201d."}, {"owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "reply_to_user": {"reputation": 12035, "user_id": 603094, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/325af9a946cb4337c6640f0e95044be1?s=128&d=identicon&r=PG", "display_name": "kirelagin", "link": "https://stackoverflow.com/users/603094/kirelagin"}, "edited": false, "score": 0, "creation_date": 1428014853, "post_id": 29423483, "comment_id": 47018879, "body": "Do you mean <code>head [1,2]</code> is compiled to <code>1</code> directly?"}, {"owner": {"reputation": 12035, "user_id": 603094, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/325af9a946cb4337c6640f0e95044be1?s=128&d=identicon&r=PG", "display_name": "kirelagin", "link": "https://stackoverflow.com/users/603094/kirelagin"}, "edited": false, "score": 2, "creation_date": 1428016085, "post_id": 29423483, "comment_id": 47019246, "body": "This question doesn\u2019t make any sense as until the value is forced (e.g. your code performs IO with the value) nothing is evaluated. What <code>main = print $ head [1 ..]</code> will be compiled two is a question of optimisations used, it might as well be compiled to \u201cprint 1\u201d. Also it is slightly difficult to reason about built-in constructs like <code>[a..b]</code> lists. If you had infinite lists implemented by yourself you would see the terms and you would be able to perform reductions by hands until you get the value you need. Again, WHNF is the key."}, {"owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "reply_to_user": {"reputation": 12035, "user_id": 603094, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/325af9a946cb4337c6640f0e95044be1?s=128&d=identicon&r=PG", "display_name": "kirelagin", "link": "https://stackoverflow.com/users/603094/kirelagin"}, "edited": false, "score": 0, "creation_date": 1428016420, "post_id": 29423483, "comment_id": 47019356, "body": "Now I see your point. Thanks for referring to <code>WHNF</code>. Are <code>weak head normal form</code> and <code>lazy evaluation</code> orthogonal topics?"}, {"owner": {"reputation": 12035, "user_id": 603094, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/325af9a946cb4337c6640f0e95044be1?s=128&d=identicon&r=PG", "display_name": "kirelagin", "link": "https://stackoverflow.com/users/603094/kirelagin"}, "edited": false, "score": 1, "creation_date": 1428222558, "post_id": 29423483, "comment_id": 47075766, "body": "I think that what you mean by \u201clazy evaluation\u201d is not orthogonal. Actually WHNF, or, to be more precise, the combination of evaluation strategy \u201creduce everything to WHNF\u201d and the idea of keeping expressions in \u201cthunks\u201d is how lazy evaluation is implemented."}], "answers": [{"comments": [{"owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 0, "creation_date": 1428018400, "post_id": 29424083, "comment_id": 47019916, "body": "I should have better stated something that I typed the <code>head ..</code> expressions in <code>GHCi</code>  or abstracted them from <code>main = do print $ head ...</code> to avoid any confusion."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 1, "creation_date": 1428018731, "post_id": 29424083, "comment_id": 47020006, "body": "Well in ghci, it will - more or less - place a implicit <code>print $</code> in front, en thus evaluate until it can print the result."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1428017033, "creation_date": 1428017033, "answer_id": 29424083, "question_id": 29423483, "link": "https://stackoverflow.com/questions/29423483/list-lazy-evaluation-in-haskell/29424083#29424083", "title": "List lazy evaluation in Haskell", "body": "<p>There is nothing special about lists. They are simply recursive datatypes:</p>\n\n<pre><code>data [a] = a : [a] | []\n</code></pre>\n\n<p>Now when you use <code>[1 .. 2]</code>, that is <strong>not</strong> turned into a list <code>(1:(2:[]))</code> directly!, it is stored as the expression <code>[1 .. 2]</code>.</p>\n\n<p>Now <code>head</code> is defined as:</p>\n\n<pre><code>head :: [a] -&gt; a\nhead (x:_) = x\n</code></pre>\n\n<p>If you call <code>head [1 .. 2]</code>, into a <code>main</code> (and thus Haskell is somehow forced to evaluate it), it will see <code>[1 .. 2]</code> is not a datastructure, but an unresolved expression, it will resolve the expression a bit:</p>\n\n<pre><code>[1 .. 2] to (1:[(succ 1) .. 2])\n</code></pre>\n\n<p>And thus now one reads:</p>\n\n<pre><code>head (1:[(succ 1) .. 2])\n</code></pre>\n\n<p>(note that the tail is still an expression), but since <code>head</code> is only interested in - well - the \"head\" it will return <code>1</code>. Note that if the <code>head</code> was for instance <code>1+2</code>, it wouldn't evaluate this to <code>3</code> immediately either.</p>\n\n<p>Furthermore if you simply call <code>head [1 .. 2]</code> the expression will <strong>not be evaluated</strong> automatically, it is only if you want for instance to display the result, Haskell will do an effort to calculate it.</p>\n\n<p>Depending on the compiler-implementation, the compiler can do an effort at compile time to propagate constants (literals) and perform operations on them, but since a compiler should always follow the standard of execution, the semantics remain the same.</p>\n"}, {"comments": [{"owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 0, "creation_date": 1428020557, "post_id": 29424256, "comment_id": 47020428, "body": "Thanks for the detailed answer. I&#39;m wondering if I could find a Haskell vocabulary including its academic terms and relevant industrial jargon."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 1, "creation_date": 1428030003, "post_id": 29424256, "comment_id": 47022395, "body": "@sof Depending on your interests, you might like &quot;The Implementation of Functional Languages&quot;, &quot;The Spineless Tagless G-Machine&quot;, or &quot;Types and Programming Languages&quot;. Of course there is also the Haskell wiki, which has less depth, rigor, and direction, but is also immediately available and quite approachable."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1428018133, "creation_date": 1428018133, "answer_id": 29424256, "question_id": 29423483, "link": "https://stackoverflow.com/questions/29423483/list-lazy-evaluation-in-haskell/29424256#29424256", "title": "List lazy evaluation in Haskell", "body": "<p>The term \"lazy evaluation\" is used in many ways.</p>\n\n<ol>\n<li>Lazy evaluation is a semantics; it says something about which expressions evaluate to which values. (I admit that there are some details missing from the semantics, though!)</li>\n<li>Lazy evaluation is an implementation strategy; it gives a way to \"run\" lambda calculus terms that conforms to the above-mentioned semantics, and uses sharing to improve on the time and memory usage of the more obvious \"call-by-name\" implementation strategy.</li>\n<li>And you are using it in yet a third way, I think.</li>\n</ol>\n\n<p>In the remainder, I will use \"lazy evaluation\" for the implementation strategy and \"non-strict semantics\" for the semantics.</p>\n\n<blockquote>\n  <p>I suppose that <code>expr3</code> would be lazily evaluated like <code>eval1</code>, how about <code>expr1</code> and <code>expr2</code>?</p>\n</blockquote>\n\n<p>A non-strict semantics dictates that evaluation of all five terms should terminate and produce the value <code>1</code>, so any conforming implementation will behave in that way. Lazy evaluation will do this in about the same amount of space and time for each expression. I expect that GHC would choose lazy evaluation if you forced any of these five terms, though with optimizations on it may perform the evaluation at compile-time. You could check this yourself by passing it the <code>-ddump-simpl</code> flag, if you were very interested.</p>\n\n<blockquote>\n  <p>Is lazy evaluation in Haskell a technic on both compile and run time?</p>\n</blockquote>\n\n<p>Hopefully the discussion above clarifies this question already. Non-strict semantics describe a particular connection between the compile-time and run-time (that is, the compiler must produce a program whose runtime behavior produces the values the semantics specifies). Lazy evaluation is a particular implementation strategy for producing a program that conforms to the semantics. GHC sometimes uses lazy evaluation in its programs, but sometimes uses other implementation strategies; however, it conforms to a non-strict semantics. (If you find a place where it doesn't, that's a bug!)</p>\n\n<blockquote>\n  <p>Where is it said good for efficiency but hard to reason, on time, space complexity or program logic?</p>\n</blockquote>\n\n<p>Non-strict semantics generally don't say anything about how much time or space is used during a computation, so if you want to reason about that, you need entirely different techniques. Even if you decide to restrict your reasoning to programs implemented with lazy evaluation, things can be difficult. Thinking about an expression like <code>[1..]</code>: how much space does this use? This question cannot be answered in a vacuum; the fundamental idea of lazy evaluation is to give the consumer of a value control over how much of the value is constructed. So without seeing what the program <em>does</em> with the expression <code>[1..]</code>, we can't know much. It might throw the value away, in which case almost no space is used; or it might walk down the list, in which case a constant amount of space is used; or it might traverse the list twice at different times, in which case unbounded space is used; or it might do a million other things with other space requirements.</p>\n"}, {"tags": [], "owner": {"reputation": 2464, "user_id": 1076715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf07aa4cdf24f3a770c21cb26e61bc7f?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/1076715/eric"}, "is_accepted": false, "score": 2, "last_activity_date": 1428063299, "creation_date": 1428063299, "answer_id": 29432031, "question_id": 29423483, "link": "https://stackoverflow.com/questions/29423483/list-lazy-evaluation-in-haskell/29432031#29432031", "title": "List lazy evaluation in Haskell", "body": "<p>To complete other answers, you can check how lazy evaluation work with the <code>:sprint</code> command in ghci:</p>\n\n<pre><code>Prelude&gt; let xs = [1..10] :: [Int]\nPrelude&gt; :sprint xs\nxs = _\nPrelude&gt; head xs\n1\nPrelude&gt; :sprint xs\nxs = 1 : _\nPrelude&gt; take 3 xs\n[1,2,3]\nPrelude&gt; :sprint xs\nxs = 1 : 2 : 3 : _\nPrelude&gt; length xs\n10\nPrelude&gt; :sprint xs\nxs = [1,2,3,4,5,6,7,8,9,10]\n</code></pre>\n"}], "owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 1, "closed_date": 1428549904, "answer_count": 3, "score": 3, "last_activity_date": 1428063299, "creation_date": 1428013436, "last_edit_date": 1428017139, "question_id": 29423483, "link": "https://stackoverflow.com/questions/29423483/list-lazy-evaluation-in-haskell", "closed_reason": "Needs details or clarity", "title": "List lazy evaluation in Haskell", "body": "<p>I made simple assumptions below to understand list lazy evaluation in Haskell,</p>\n\n<pre><code>head [1, 2]                -- expr1\nhead [1 .. 2]              -- expr2\nhead [1 ..]                -- expr3\n\nhead . (1 :) $ []          -- eval1\nhead . (1 :) . (2 :) $ []  -- eval2\n</code></pre>\n\n<p>I suppose that <code>expr3</code> would be lazily evaluated like <code>eval1</code>, how about <code>expr1</code> and <code>expr2</code>? </p>\n\n<p>Generally speaking, </p>\n\n<ul>\n<li>is lazy evaluation in Haskell a technique on both compile and run time?</li>\n<li>where is it said good for efficiency but hard to reason, on time, space complexity or program logic?</li>\n</ul>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "edited": false, "score": 8, "creation_date": 1428012572, "post_id": 29423306, "comment_id": 47018090, "body": "Have you tried <code>-fwarn-incomplete-patterns</code>?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1428012882, "post_id": 29423306, "comment_id": 47018200, "body": "I recommend using <code>-Wall</code> to enable all warnings. Some/most of them should be on by default IMHO."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 4, "creation_date": 1428012949, "post_id": 29423306, "comment_id": 47018226, "body": "If you use <code>-Wall</code> and <code>-Werror</code> then you&#39;ll catch a lot more problems with your code."}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1439504798, "creation_date": 1428012434, "last_edit_date": 1439504798, "question_id": 29423306, "link": "https://stackoverflow.com/questions/29423306/haskell-find-missing-instance-with-ghc", "title": "Haskell : find missing instance with GHC", "body": "<p>I wrote a Haskell program with many data type such as :</p>\n\n<pre><code>data MyType = FirstType Int Int\n            | SecondType [Double]\n            | ThirdType Double Double Double\n            ...\n</code></pre>\n\n<p>and with some instance for these data types such as :</p>\n\n<pre><code>instance Show MyType where\n  show (FirstType a b ) = \"Some Messages \"++show a++show b++\" End\"\n  show (SecondType list ) = \"Another Message \"++show (head list)\n</code></pre>\n\n<p>Is there a GHC option to find <strong>incomplete instance declaration</strong> (the missing <code>show (ThirdType a b c ) =</code> above) and avoid a program failure?</p>\n\n<p>More extensively, what are the most common GHC options to find <strong>mistakes</strong> or <strong>omissions</strong> in a Haskell program? And what can they find?</p>\n"}, {"tags": ["haskell", "binary-tree"], "comments": [{"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 3, "creation_date": 1428008193, "post_id": 29422263, "comment_id": 47016131, "body": "Are the elements of the tree ordered, as in a binary search tree?  In any case, you should not need to use lists or <code>minimum</code> to do this. In the second and third equation they&#39;re superfluous anyway\u2014the minimum of a one-element list is the list&#39;s one element."}, {"owner": {"reputation": 1, "user_id": 4744162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edc0d5c2821bd83a5cd5d819626c0e54?s=128&d=identicon&r=PG&f=1", "display_name": "tamais2", "link": "https://stackoverflow.com/users/4744162/tamais2"}, "reply_to_user": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1428008420, "post_id": 29422263, "comment_id": 47016240, "body": "The tree is ordered, yes."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 2, "creation_date": 1428008921, "post_id": 29422263, "comment_id": 47016500, "body": "Also: I just tried your function and it has this bug: <code>minValue 17 (BNode 22 Empty Empty) == 22</code>"}, {"owner": {"reputation": 6215, "user_id": 388182, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TqkIS.jpg?s=128&g=1", "display_name": "RageD", "link": "https://stackoverflow.com/users/388182/raged"}, "reply_to_user": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1428009667, "post_id": 29422263, "comment_id": 47016829, "body": "As per @LuisCasillas&#39; comment: the formulation of this function is a little odd. You probably want to remove the first parameter. Using a <code>Maybe a</code> return type may help you cope with Empty trees. Then, at a higher level, you can determine what a reasonable &quot;default&quot; value should be."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1428010080, "post_id": 29422263, "comment_id": 47016999, "body": "If the tree is a binary search tree, the minimum value is located is the leftmost leaf."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1428019029, "post_id": 29422263, "comment_id": 47020074, "body": "What does &quot;will not run&quot; mean? When I try it, it runs (after adding a data type declaration)."}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 2, "last_activity_date": 1428010750, "creation_date": 1428010750, "answer_id": 29422928, "question_id": 29422263, "link": "https://stackoverflow.com/questions/29422263/returning-minimum-value-in-binary-tree/29422928#29422928", "title": "Returning Minimum Value in Binary Tree", "body": "<p>I'm assuming that <code>BTree</code> is defined as</p>\n\n<pre><code>data BTree a = Empty | BNode a (BTree a) (BTree a) deriving (Eq, Show)\n</code></pre>\n\n<p>Although for future reference please include data type definitions in your question.</p>\n\n<p>The key to the solution here is that the minimum of a node is the minimum of its value and the mins of each branch:</p>\n\n<pre><code>minValue :: Ord a =&gt; a -&gt; BTree a -&gt; a\nminValue val Empty = val\nminValue val (BNode v left right) =\n    let leftMin = minValue val left\n        rightMin = minValue val right\n    in ???\n</code></pre>\n\n<p>Instead of worrying if the left or right is <code>Empty</code>, just trust the recursion to handle it.  If <code>left</code> is <code>Empty</code>, then <code>minValue val left</code> will just be <code>val</code>, and similarly for <code>right</code>.  Then you have 4 values in scope that you want to determine the minimum of, <code>val</code>, <code>v</code>, <code>leftMin</code>, and <code>rightMin</code>.  How might you do that?</p>\n"}], "owner": {"reputation": 1, "user_id": 4744162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edc0d5c2821bd83a5cd5d819626c0e54?s=128&d=identicon&r=PG&f=1", "display_name": "tamais2", "link": "https://stackoverflow.com/users/4744162/tamais2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1020, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1428010750, "creation_date": 1428008000, "question_id": 29422263, "link": "https://stackoverflow.com/questions/29422263/returning-minimum-value-in-binary-tree", "title": "Returning Minimum Value in Binary Tree", "body": "<p>I'm trying to write code that if given a tree, will go through the tree and return the minimum value in that tree, if the tree is empty, it will return val. What I have right now compiles but will not run. Any help?</p>\n\n<pre><code>minValue :: Ord a =&gt; a -&gt; BTree a -&gt; a\nminValue val Empty = val\nminValue val (BNode v left Empty) = minimum [minValue v left]\nminValue val (BNode v Empty right) = minimum [minValue v right]\nminValue val (BNode v left right) = minimum ([minValue v left]++[minValue v right])\n</code></pre>\n"}, {"tags": ["json", "haskell", "state"], "answers": [{"comments": [{"owner": {"reputation": 9078, "user_id": 1366455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fa38c3a267295fb2978ded32786073d2?s=128&d=identicon&r=PG", "display_name": "tolgap", "link": "https://stackoverflow.com/users/1366455/tolgap"}, "edited": false, "score": 0, "creation_date": 1428000712, "post_id": 29420258, "comment_id": 47012398, "body": "I actually like @bheklilr &#39;s implementation more, as it sits closer to my current implementation. But I will surely keep the <code>Reader</code> in my mind."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 9078, "user_id": 1366455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fa38c3a267295fb2978ded32786073d2?s=128&d=identicon&r=PG", "display_name": "tolgap", "link": "https://stackoverflow.com/users/1366455/tolgap"}, "edited": false, "score": 2, "creation_date": 1428000858, "post_id": 29420258, "comment_id": 47012461, "body": "@tolgap As the edit just made says, <code>Reader</code> is a good choice if you want your settings to be static, but <code>State</code> is necessary if you want to be able to change your settings while the application is running.  Use the tool best suited to your application, and if you&#39;re always accessing it through <code>getSetting</code> then you won&#39;t have trouble converting between <code>Reader</code> or <code>State</code> for your application, you&#39;ll just have to change the <code>App</code> type and the implementation of <code>getSetting</code>"}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 3, "last_activity_date": 1428000492, "creation_date": 1428000492, "answer_id": 29420258, "question_id": 29420024, "link": "https://stackoverflow.com/questions/29420024/aeson-parse-json-and-use-state-to-keep-it-in-memory/29420258#29420258", "title": "Aeson parse JSON and use State to keep it in memory", "body": "<p>Unless you need to modify the configuration during the run of your program, it makes more sense to use <a href=\"http://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Reader.html#t:Reader\" rel=\"nofollow\"><code>Reader</code></a>. You could express your functions using the <code>Reader</code> (or <code>ReaderT</code>, if you need other monads in your stack, like <code>IO</code> etc.) monad and then something like</p>\n\n<pre><code>main :: IO ()\nmain = do\n  s &lt;- parseSettings\n  runReader program s\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9078, "user_id": 1366455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fa38c3a267295fb2978ded32786073d2?s=128&d=identicon&r=PG", "display_name": "tolgap", "link": "https://stackoverflow.com/users/1366455/tolgap"}, "edited": false, "score": 0, "creation_date": 1428002506, "post_id": 29420285, "comment_id": 47013330, "body": "I have it working the way you implemented it (with <code>runApp</code>), but I don&#39;t understand why the <code>App</code> type has the <code>Maybe</code> in it&#39;s definition. What is the <code>Maybe</code> for?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 9078, "user_id": 1366455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fa38c3a267295fb2978ded32786073d2?s=128&d=identicon&r=PG", "display_name": "tolgap", "link": "https://stackoverflow.com/users/1366455/tolgap"}, "edited": false, "score": 2, "creation_date": 1428002636, "post_id": 29420285, "comment_id": 47013403, "body": "@tolgap If you didn&#39;t use <code>Maybe</code> then you would have to have a valid <code>Settings</code> value to feed into <code>evalStateT app</code>, I&#39;m using it here to indicate that the settings may or may not exist, but so long as you&#39;re using <code>getSetting</code>, the settings will get loaded the first time, and after that it&#39;ll just the <code>Just settings</code> that are stored as the state.  Essentially, it&#39;s so that the application can load the settings inside <code>App</code> instead of in <code>main</code> before the application is run."}, {"owner": {"reputation": 9078, "user_id": 1366455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fa38c3a267295fb2978ded32786073d2?s=128&d=identicon&r=PG", "display_name": "tolgap", "link": "https://stackoverflow.com/users/1366455/tolgap"}, "edited": false, "score": 0, "creation_date": 1428003299, "post_id": 29420285, "comment_id": 47013760, "body": "Ah I get it, the <code>Maybe</code> is used to check if it&#39;s been parsed or not. Thank you"}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 2, "last_activity_date": 1428000570, "creation_date": 1428000570, "answer_id": 29420285, "question_id": 29420024, "link": "https://stackoverflow.com/questions/29420024/aeson-parse-json-and-use-state-to-keep-it-in-memory/29420285#29420285", "title": "Aeson parse JSON and use State to keep it in memory", "body": "<p>Using <code>StateT</code> you can do</p>\n\n<pre><code>import Control.Monad.State\nimport Control.Applicative\n\ntype App = StateT (Maybe Settings) IO\n\nparseSettings :: IO Settings\nparseSettings = undefined  -- Keep your implementation\n\nreloadSettings :: App ()\nreloadSettings = do\n    settings &lt;- liftIO parseSettings\n    put $ Just settings\n\ngetSetting :: (Settings -&gt; a) -&gt; App a\ngetSetting f = get &gt;&gt;= maybe (reloadSettings &gt;&gt; getSetting f) (return . f)\n</code></pre>\n\n<p>Then you can use this as</p>\n\n<pre><code>data Settings = Settings\n    { hostname :: String\n    , port :: Int\n    } deriving (Eq, Show)\n\nsendRequest :: Request -&gt; App Response\nsendRequest request = do\n    h &lt;- getSetting hostname\n    p &lt;- getSetting port\n    liftIO $ do\n        hndl &lt;- connect h p\n        sendRequest hndl request\n        readResponse hndl\n</code></pre>\n\n<p>And you can run it with</p>\n\n<pre><code>runApp :: App a -&gt; IO a\nrunApp app = evalStateT app Nothing\n</code></pre>\n\n<p>This allows you to worry about parsing the settings the first time you call <code>getSetting</code>, and it'll use the current settings after that.  If you need to reload the settings just use <code>reloadSettings</code>, and all subsequent commands will use the new settings.</p>\n\n<p>Note that if you want your settings to always be static throughout the application, it's much better to use the <code>Reader</code> monad as Petr shows.  This separates the loading of your settings from the running of your application, it has to occur in a two-step process.  If you do want to allow the settings to change throughout the application then the <code>State</code> monad is necessary.</p>\n"}], "owner": {"reputation": 9078, "user_id": 1366455, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fa38c3a267295fb2978ded32786073d2?s=128&d=identicon&r=PG", "display_name": "tolgap", "link": "https://stackoverflow.com/users/1366455/tolgap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 29420285, "answer_count": 2, "score": 1, "last_activity_date": 1428000570, "creation_date": 1427999617, "question_id": 29420024, "link": "https://stackoverflow.com/questions/29420024/aeson-parse-json-and-use-state-to-keep-it-in-memory", "title": "Aeson parse JSON and use State to keep it in memory", "body": "<p>I have a \"settings\" file in my Haskell learning project. It's a JSON file with a basic structure for defining some settings. The settings are now parsed every time when I try to grab something from it. It's reparsed everytime. So I figured I have to keep some <code>State</code> for it that it's been parsed and available.</p>\n\n<pre><code> parseSettings :: IO Settings\n parseSettings = do\n    settingsContent &lt;- B.readFile settingsFile\n    let settings = decode settingsContent :: Maybe Settings\n    case settings of\n        Just s  -&gt; return s\n        Nothing -&gt; error \"Couldn't parse settings file\"\n</code></pre>\n\n<p>This is the <code>getSetting</code> I am using atm:</p>\n\n<pre><code>getSetting :: (Settings -&gt; a) -&gt; IO a\ngetSetting f = do\n    settings &lt;- parseSettings\n    return (f settings)\n</code></pre>\n\n<p>Now instead of calling <code>parseSettings</code>, I want to actually do something stateful so that I don't have to reparse the settings file everytime I call <code>getSetting</code>. Can anyone recommend me blogposts/articles or any pointers at how to use the <code>State</code> monad for this? (or if there is a simpler way, I'd prefer that).</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1428010850, "post_id": 29417839, "comment_id": 47017343, "body": "Your particular example is not actually using a higher rank type. It&#39;s only using the <code>RankNTypes</code> extension to allow you to use explicit <code>forall</code> quantifiers in the type signature. There is another extension <code>ExplicitForAll</code> which allows you to use <code>forall</code> without turning on any new functionality."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1428092152, "post_id": 29417839, "comment_id": 47046800, "body": "@Ben, there&#39;s also the <code>ScopedTypeVariables</code> extension, that actually makes these useful."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1428127238, "post_id": 29417839, "comment_id": 47054187, "body": "@dfeuer Yes, I believe that&#39;s precisely why <code>ExplicitForAll</code> exists. Universal quantification (<code>forall</code>) has always existed as an <i>implicit</i> concept. So writing them explicitly is an &quot;extension&quot; that makes sense in its own right, independently of any other extension even though it doesn&#39;t enable you to <b>do</b> anything differently on its own. Since multiple type system extensions need explicit <code>forall</code>s, having a separate extension for just the <code>forall</code> syntax allows other extensions to depend on it, instead of depending on each other or duplicating the functionality."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1428129845, "post_id": 29417839, "comment_id": 47054753, "body": "@Ben, the problem is that the <code>forall</code>s mean different things depending on whether <code>ScopedTypeVariables</code> is on or not. It&#39;s best to start with <code>ScopedTypeVariables</code> and add things on top than to start with <code>ExplicitForAll</code> and risk breaking things when you realize you need to add <code>ScopedTypeVariables</code>."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1428131930, "post_id": 29417839, "comment_id": 47055209, "body": "@dfeuer Do the <code>forall</code>s mean something different? I thought it was just the &quot;implicitly foralled&quot; variabels that could mean something different when you turn on <code>ScopedTypeVariables</code> (since they could be reinterpreted as references to an outer-scope variable, rather than introducing a new type variable)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1428168498, "post_id": 29417839, "comment_id": 47064801, "body": "@Ben, no, the implicitly quantified ones stay the same; explicitly quantified ones extend their scope. Pattern variable signatures become legal, and act as though explicitly quantified (most of the time)."}], "answers": [{"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 11, "last_activity_date": 1428086733, "last_edit_date": 1428086733, "creation_date": 1427992501, "answer_id": 29417985, "question_id": 29417839, "link": "https://stackoverflow.com/questions/29417839/the-purpose-of-forall-in-rankntypes/29417985#29417985", "title": "The purpose of forall in RankNTypes", "body": "<p>You're missing that you can limit the scope of the quantified type variable:</p>\n\n<pre><code>modifyPair :: (Num b, Num c) =&gt; (forall a. Num a =&gt; a -&gt; a) -&gt; (b, c) -&gt; (b, c)\nmodifyPair f (b, c) = (f b, f c)\n</code></pre>\n\n<p>Try writing that function without the <code>RankNTypes</code> extension. In particular, allowing the elements of the pair to be different types from each other.</p>\n\n<p>This <em>specific</em> example isn't too useful, but the general idea holds. You can specify that an argument to a function must be polymorphic.</p>\n\n<p>There's an additional trick you can perform with this tooling. The canonical example comes from <code>ST</code>. The goal of the <code>ST</code> library is to allow constrained use of mutable data.  That is, you can implement an algorithm involving true mutation, and present an external interface that's pure. <code>ST</code> itself takes care of proving that the use is safe via clever type system tricks:</p>\n\n<pre><code>newtype ST s a    = ... -- details aren't important\nnewtype STRef s a = ... -- details still aren't important\n\n-- a standard-ish interface to mutable data\nnewSTRef :: ST s (STRef s a)\nreadSTRef :: STRef s a -&gt; ST s a\nwriteSTRef :: STRef s a -&gt; a -&gt; ST s ()\n\n-- the magic using RankNTypes\nrunST :: (forall s. ST s a) -&gt; a\n</code></pre>\n\n<p>That extra type variable, <code>s</code>, is worth paying attention to.  It appears in both <code>ST</code> and <code>STRef</code>. Every function that manipulates an <code>STRef</code> makes sure that the <code>s</code> in the <code>ST</code> and <code>STRef</code> is the <em>same</em> type variable.  So when you get to <code>runST</code>, you find that the type <code>s</code> has to be unrelated to the type <code>a</code>. <code>s</code> has its scope more confined than that of <code>a</code>. The end result of this is that you can't write something like <code>runST newSTRef</code>. The type checker will reject it because the type variable <code>s</code> would have to escape the context in which it's quantified.</p>\n\n<p>So there really are some handy tricks you can pull when you can specify that a function's argument must be polymorphic.</p>\n"}], "owner": {"reputation": 72435, "user_id": 119549, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/3KYsB.jpg?s=128&g=1", "display_name": "Jacob", "link": "https://stackoverflow.com/users/119549/jacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 3, "accepted_answer_id": 29417985, "answer_count": 1, "score": 6, "last_activity_date": 1428086733, "creation_date": 1427992026, "question_id": 29417839, "link": "https://stackoverflow.com/questions/29417839/the-purpose-of-forall-in-rankntypes", "title": "The purpose of forall in RankNTypes", "body": "<p>In writing some Haskell code with the help of <code>hlint</code>, I followed the prompt to add a type signature to a function. It injected something sort of like this:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\nmultipleOf :: forall a. Integral a =&gt; a -&gt; a -&gt; Bool\nmultipleOf divisor n = n `mod` divisor == 0\n</code></pre>\n\n<p>This language extension is new to me, but as I understand, this is identical with the simpler:</p>\n\n<pre><code>multipleOf :: Integral a =&gt; a -&gt; a -&gt; Bool\nmultipleOf divisor n = n `mod` divisor == 0\n</code></pre>\n\n<p>Every example of rank N types I've read about seem don't seem to add anything new over the polymorphism that was already available, and this <code>forall</code> syntax doesn't seem to add any value.</p>\n\n<p>What am I missing? Is there a good example of what this <code>forall</code> syntax does beyond what's available without extensions?</p>\n"}, {"tags": ["json", "haskell", "singleton-type"], "comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1427989483, "post_id": 29416343, "comment_id": 47006192, "body": "Is your final goal to implement <code>FromJSON</code> for <code>Market</code>? You can do that without needing to parse <code>MarketType</code> tags, if the <code>MarketIndex</code> fields provide enough information to disambiguate the types."}], "owner": {"reputation": 929, "user_id": 427785, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/651918248d103d4459c5ecafe6e40864?s=128&d=identicon&r=PG", "display_name": "dbeacham", "link": "https://stackoverflow.com/users/427785/dbeacham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1460013273, "creation_date": 1427987346, "last_edit_date": 1460013273, "question_id": 29416343, "link": "https://stackoverflow.com/questions/29416343/runtime-dynamic-singleton-types", "title": "Runtime/dynamic singleton types", "body": "<pre><code>$(singletons [d|\ndata MarketType\n  = WinDrawWin\n  | OverUnder\n  deriving (Show, Generic)\n|]\n\ntype family MarketIndex (mt :: MarketType) :: * where\n  MarketIndex 'OverUnder = Double\n  MarketIndex mt = ()\n\ndata Market (mt :: MarketType) = Market\n { marketType  :: SMarketType mt -- ^ type of the market\n , marketIndex :: MarketIndex mt -- ^ index of the market\n }\n\nprice :: SMarketType mt -&gt; MarketIndex mt -&gt; Either String (Market mt)\nprice SWinDrawWin ()   = Right $ Market SWinDrawWin ()\nprice SOverUnder  hcap = Right $ Market SOverUnder hcap\nprice mt          mi   = Left  $ unwords [show (fromSing mt), show mi, \"can't be priced\"]\n</code></pre>\n\n<p>The above (simplified) code works well for static code where all the types are known up front, but I want to extend it to be able to handle more dynamic input. For instance, a JSON request being made to price up one particular market - <code>WinDrawWin</code> or <code>OverUnder</code>. It's easy for me to create a <code>ToJSON</code> instance of all the types above using <code>fromSing</code> and my <code>ToJSON</code> instance on <code>MarketType</code>, but I'm not sure of the best way (if there is one) of creating the relevant <code>FromJSON</code> instances.</p>\n\n<p>Should I have code that looks like this (single instance across all types of kind <code>'MarketType</code>)</p>\n\n<pre><code>instance FromJSON (SMarketType mt) where\n    parseJSON = undefined\n</code></pre>\n\n<p>or this (separate instances per singleton)</p>\n\n<pre><code>instance FromJSON (SMarketType WinDrawWin) where\n    parseJSON = undefined\n</code></pre>\n\n<p>or should I use the <code>FromJSON</code> instances for the type <code>MarketType</code> and then do something to recover the singleton types I require in <code>price</code>?</p>\n\n<p>I'm aware of <code>toSing</code> but I've had no joy trying to understand how to correctly use it if that is what I require.</p>\n"}, {"tags": ["linux", "haskell", "vim", "autocomplete"], "answers": [{"comments": [{"owner": {"reputation": 729, "user_id": 2630788, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/efbfae4118cc6694219d174333fa2094?s=128&d=identicon&r=PG", "display_name": "Konstantinos", "link": "https://stackoverflow.com/users/2630788/konstantinos"}, "edited": false, "score": 0, "creation_date": 1427997844, "post_id": 29418216, "comment_id": 47010913, "body": "Thanks for your advice. For the edit, are you sure it is correct? I tested <code>inoremap =SuperTabAlternateCompletion(&quot;\\c-x&gt;\\c-o&gt;&quot;)</code> and it doesn&#39;t seem to work."}, {"owner": {"reputation": 39152, "user_id": 438329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4b5b093781b8d97da6b9c21cf2706d7?s=128&d=identicon&r=PG", "display_name": "Peter Rincker", "link": "https://stackoverflow.com/users/438329/peter-rincker"}, "reply_to_user": {"reputation": 729, "user_id": 2630788, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/efbfae4118cc6694219d174333fa2094?s=128&d=identicon&r=PG", "display_name": "Konstantinos", "link": "https://stackoverflow.com/users/2630788/konstantinos"}, "edited": false, "score": 0, "creation_date": 1428004075, "post_id": 29418216, "comment_id": 47014162, "body": "@Konstantinos, my mistake I didn&#39;t format my post correctly. I have updated the post"}, {"owner": {"reputation": 539, "user_id": 2375346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed8eb986fa99170cf09570b590b60396?s=128&d=identicon&r=PG", "display_name": "Joe Nelson", "link": "https://stackoverflow.com/users/2375346/joe-nelson"}, "edited": false, "score": 0, "creation_date": 1513357598, "post_id": 29418216, "comment_id": 82637409, "body": "Also, I&#39;d advise you make your customizations to <code>~&#47;.config&#47;haskell-vim-now&#47;vimrc.local</code> since <code>.vimrc</code> is symlinked to a file in version control. Using the .local file allows you to update haskell-vim-now more easily later on if you need to. See the <a href=\"https://github.com/begriffs/haskell-vim-now#customizing\" rel=\"nofollow noreferrer\">readme</a>."}], "tags": [], "owner": {"reputation": 39152, "user_id": 438329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4b5b093781b8d97da6b9c21cf2706d7?s=128&d=identicon&r=PG", "display_name": "Peter Rincker", "link": "https://stackoverflow.com/users/438329/peter-rincker"}, "is_accepted": true, "score": 1, "last_activity_date": 1428002304, "last_edit_date": 1428002304, "creation_date": 1427993241, "answer_id": 29418216, "question_id": 29415510, "link": "https://stackoverflow.com/questions/29415510/change-key-binding-for-autocomplete-in-haskell-vim-now/29418216#29418216", "title": "Change key binding for autocomplete in haskell-vim-now", "body": "<p>You just edit that line in your <code>~/.vimrc</code> to:</p>\n\n<pre><code>inoremap &lt;c-space&gt; &lt;c-r&gt;=SuperTabAlternateCompletion(\"\\&lt;lt&gt;c-x&gt;\\&lt;lt&gt;c-o&gt;\")&lt;cr&gt;\n</code></pre>\n\n<p>Mappings take the following basic form: <code>{mode}map {key} {lhs}</code>. For more information on mappings see <code>:h :map</code> as well as <code>:h key-notation</code>.</p>\n\n<p>Haskell-vim-now is not a plugin it is a more like vim config distribution. Now from what I see Haskell-vim-now seems to try and play as nice as possible for a vim distribution, but it still installs many vim plugins and makes many customizations. Such numerously and rapid changes to a newer vimmer's config often causes confusion because they are both using someone else's customization and they did not learn all the intermediary Vim steps. So I caution you against such distribution and to slowly build up your own <code>vimrc</code> as you learn.</p>\n"}, {"tags": [], "owner": {"reputation": 729, "user_id": 2630788, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/efbfae4118cc6694219d174333fa2094?s=128&d=identicon&r=PG", "display_name": "Konstantinos", "link": "https://stackoverflow.com/users/2630788/konstantinos"}, "is_accepted": false, "score": 0, "last_activity_date": 1428007396, "creation_date": 1428007396, "answer_id": 29422113, "question_id": 29415510, "link": "https://stackoverflow.com/questions/29415510/change-key-binding-for-autocomplete-in-haskell-vim-now/29422113#29422113", "title": "Change key binding for autocomplete in haskell-vim-now", "body": "<p>The reason <code>&lt;c-space&gt;</code> in <code>inoremap &lt;c-space&gt; &lt;c-r&gt;=SuperTabAlternateCompletion(\"\\&lt;lt&gt;c-x&gt;\\&lt;lt&gt;c-o&gt;\")&lt;cr&gt;</code> did not work for me was because there was a conflit with an existing <code>&lt;c-space&gt;</code> key shortcut.</p>\n\n<p>Once I solved the conflict, the Vim autocompletion shortcut worked.</p>\n"}], "owner": {"reputation": 729, "user_id": 2630788, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/efbfae4118cc6694219d174333fa2094?s=128&d=identicon&r=PG", "display_name": "Konstantinos", "link": "https://stackoverflow.com/users/2630788/konstantinos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 29418216, "answer_count": 2, "score": 0, "last_activity_date": 1428007396, "creation_date": 1427985010, "question_id": 29415510, "link": "https://stackoverflow.com/questions/29415510/change-key-binding-for-autocomplete-in-haskell-vim-now", "title": "Change key binding for autocomplete in haskell-vim-now", "body": "<p>I have installed the Vim plugin <a href=\"https://github.com/begriffs/haskell-vim-now/\" rel=\"nofollow\">haskell-vim-now</a> in Ubuntu 14.04 LTS and in Xubuntu 14.04 LTS.</p>\n\n<p>After using the plugin in Ubuntu, I could use the autocompletion with <code>Ctrl-space</code>. However, when I installed it in Xubuntu, the <code>Ctrl-space</code> key would not work. The only way I made the autocompletion work was with the key <code>Ctrl-@</code>.</p>\n\n<p>I looked in the .vimrc file generated by haskell-vim-now, and the problem seems to be in the following line:</p>\n\n<pre><code>inoremap &lt;Nul&gt; &lt;c-r&gt;=SuperTabAlternateCompletion(\"\\&lt;lt&gt;c-x&gt;\\&lt;lt&gt;c-o&gt;\")&lt;cr&gt;\n</code></pre>\n\n<p>It seems to me that <code>&lt;Nul&gt;</code> binds to <code>Ctrl-space</code> in Ubuntu and to <code>Ctrl-@</code> in Xubuntu. </p>\n\n<p>How can I change the configuration so that <code>&lt;Nul&gt;</code> binds to <code>Ctrl-space</code> in Xubuntu (so that autocompletion may be done with <code>Ctrl-space</code>).</p>\n\n<p>Thanks in advance for your answers.</p>\n"}, {"tags": ["haskell", "scalaz"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1427985091, "post_id": 29414360, "comment_id": 47003306, "body": "Not at the moment, AFAIK. You have to add <code>instance Applicative M where pure=return; (&lt;*&gt;)=ap</code>. I believe I saw some discussion about autoderiving superclasses, i.e. implement <code>Monad</code> and <code>Functor</code> and have <code>Applicative</code> implicitly added, but it has not been implemented (again, AFAIK). Perhaps you can write some Template Haskell to scan the current monad instances and autogenerate applicatives. I&#39;m not sure this is possible, though."}], "answers": [{"tags": [], "owner": {"reputation": 370, "user_id": 4557694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24e1eefea58ed065620e1b494503c0da?s=128&d=identicon&r=PG", "display_name": "Chad Groft", "link": "https://stackoverflow.com/users/4557694/chad-groft"}, "is_accepted": false, "score": 3, "last_activity_date": 1427985824, "creation_date": 1427985824, "answer_id": 29415822, "question_id": 29414360, "link": "https://stackoverflow.com/questions/29414360/can-i-automatically-implement-classes/29415822#29415822", "title": "Can I automatically implement classes?", "body": "<p>The problem comes when there are two places from which to derive the <code>Applicative</code> instance. For instance, suppose <code>m</code> is the type <code>a b</code> where <code>Arrow a</code>. Then there's an obvious instance of <code>Applicative</code> from this definition as well. Which one should the compiler use? It should work out the same, of course, but Haskell has no way to check this. By making us write out the instances, Haskell at least forces us to think about the consistency of our definitions.</p>\n\n<p>If you want, there's the <code>WrappedMonad</code> class in <code>Control.Applicative</code>, which provides all the obvious instances with a <code>newtype</code> wrapper, but using <code>WrapMonad</code> and <code>unwrapMonad</code> all the time isn't that attractive either.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1428019794, "creation_date": 1428019794, "answer_id": 29424469, "question_id": 29414360, "link": "https://stackoverflow.com/questions/29414360/can-i-automatically-implement-classes/29424469#29424469", "title": "Can I automatically implement classes?", "body": "<p>It isn't currently possible, though it would be if you changed the existing library to support this. Turning DefaultSignatures on would let you write</p>\n\n<pre><code>class Applicative f where\n    pure :: a -&gt; f a\n    (&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\n\n    default pure :: Monad f =&gt; a -&gt; f a\n    default (&lt;*&gt;) :: Monad f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b\n    pure = return\n    (&lt;*&gt;) = ap\n</code></pre>\n\n<p>Then once you had implemented <code>instance Monad M where {- ... -}</code>, a simple <code>instance Applicative M</code> (with no <code>where</code> or method definitions) would inherit these default implementations. I'm not sure why this wasn't done.</p>\n"}], "owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 29424469, "answer_count": 2, "score": 9, "last_activity_date": 1428019794, "creation_date": 1427981776, "question_id": 29414360, "link": "https://stackoverflow.com/questions/29414360/can-i-automatically-implement-classes", "title": "Can I automatically implement classes?", "body": "<p>In Scalaz every <code>Monad</code> instance is automatically an instance of <code>Applicative</code>. </p>\n\n<pre><code>implicit val listInstance = new Monad[List] {\n  def point[A](a: =&gt; A) = List(a)\n  def bind[A, B](fa: List[A])(f: A =&gt; List[B]) = fa flatMap f\n}\n\nList(2) &lt;*&gt; List((x: Int) =&gt; x + 1) // Works!\n</code></pre>\n\n<p>Another example: <code>Arrow</code> is automatically a <code>Profunctor</code>.</p>\n\n<p>However, in Haskell I must provide an instance of <code>Applicative</code> for every <code>Monad</code> again and again.</p>\n\n<p>Is it possible to avoid this repetitive job?</p>\n"}, {"tags": ["haskell", "monads", "io-monad"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1427983437, "post_id": 29414340, "comment_id": 47002238, "body": "There isn&#39;t really a good way to handle this since the <code>IO</code> actions are implemented solely as returning <code>IO a</code> instead of <code>MonadIO m =&gt; m a</code>.  I often see things like <code>where io = liftIO</code> on functions and the function <code>io</code> is used instead of <code>liftIO</code>, just to reduce typing.  Ideally we&#39;d have <code>hPutStrLn :: MonadIO m =&gt; Handle -&gt; String -&gt; m ()</code>, but we can&#39;t expect functions from <code>base</code> to depend on classes defined in 3rd party libraries (even if those libraries are part of the haskell platform)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1427984760, "post_id": 29414340, "comment_id": 47003095, "body": "If you have a sequence of IO action you can change <code>do liftIO action1 ; liftIO action2</code> to <code>liftIO $ do action1; action2</code> to save some lifts."}], "answers": [{"tags": [], "owner": {"reputation": 121, "user_id": 2924117, "user_type": "registered", "profile_image": "https://graph.facebook.com/821112709/picture?type=large", "display_name": "Arthur Welf", "link": "https://stackoverflow.com/users/2924117/arthur-welf"}, "is_accepted": false, "score": 0, "last_activity_date": 1427989883, "creation_date": 1427989883, "answer_id": 29417201, "question_id": 29414340, "link": "https://stackoverflow.com/questions/29414340/how-to-use-io-monad-in-another-monad/29417201#29417201", "title": "how to use IO Monad in another Monad", "body": "<p>You want to carry along 2 additional contexts - the <code>IO</code> context and <code>Action</code> context. That's the case for monad transformers, because they allow you to deal with layering monads and choose inside of <code>do</code> block which monad to choose for desired action. <a href=\"http://blog.sigfpe.com/2006/05/grok-haskell-monad-transformers.html\" rel=\"nofollow\">Here is a great explanation</a> of why we need them and how to use them. </p>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 3, "last_activity_date": 1427992180, "creation_date": 1427992180, "answer_id": 29417884, "question_id": 29414340, "link": "https://stackoverflow.com/questions/29414340/how-to-use-io-monad-in-another-monad/29417884#29417884", "title": "how to use IO Monad in another Monad", "body": "<p>You can\u2019t avoid the <code>liftIO</code>, unfortunately, because the standard <code>IO</code> actions are not overloaded to work in any <code>MonadIO</code>. But you can join sequences of <code>IO</code> actions under one call to <code>liftIO</code>:</p>\n\n<pre><code>intoFile :: String -&gt; Cursor -&gt; Action IO ()\nintoFile ric c = do\n  outH &lt;- liftIO $ do\n    openFile ric AppendMode\n    hPutStrLn outH \"Some log\"\n  loopIntoFile outH c\n  liftIO $ hClose outH\n</code></pre>\n\n<p>Or, if you intend to use the same <code>IO</code> operations repeatedly, you can introduce auxiliary definitions for them:</p>\n\n<pre><code>intoFile :: String -&gt; Cursor -&gt; Action IO ()\nintoFile ric c = do\n  outH &lt;- openLog ric AppendMode\n  log outH \"Some log\"\n  loopIntoFile outH c\n  closeLog outH\n\nopenLog path mode = liftIO (openFile path mode)\nlog handle message = liftIO (hPutStrLn handle message)\ncloseLog handle = liftIO (hClose handle)\n</code></pre>\n"}], "owner": {"reputation": 845, "user_id": 4131972, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/--SIseZZR51U/AAAAAAAAAAI/AAAAAAAAAAw/xWroBmQMpfk/photo.jpg?sz=128", "display_name": "hliu", "link": "https://stackoverflow.com/users/4131972/hliu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 0, "accepted_answer_id": 29417884, "answer_count": 2, "score": 0, "last_activity_date": 1427992180, "creation_date": 1427981713, "question_id": 29414340, "link": "https://stackoverflow.com/questions/29414340/how-to-use-io-monad-in-another-monad", "title": "how to use IO Monad in another Monad", "body": "<p>I use MongoDB library to handle data from Mongodb. There is a Monad called <code>Action</code> representing a DB read or write operation <code>https://github.com/TonyGen/mongoDB-haskell/blob/master/doc/tutorial.md</code>.\nBut, I find that when I in monad Action, I also want to do some IO which must be in an IO Monad. Some codes like</p>\n\n<pre><code>-- `Action' is a Monad\n--\nintoFile :: String -&gt; Cursor -&gt; Action IO ()\nintoFile ric c = do\n  outH &lt;- liftIO $ openFile ric AppendMode\n  liftIO $ hPutStrLn outH \"Some log\"\n  loopIntoFile outH c\n  liftIO $ hClose outH\n</code></pre>\n\n<p>There is a <code>liftIO</code> before any <code>IO</code> monad and I think it may be verbose. Any concise way to handle this ? </p>\n"}, {"tags": ["performance", "haskell"], "comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1427980980, "post_id": 29413564, "comment_id": 47000726, "body": "Did you compile the Haskell version with <code>-O</code>?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1427981259, "post_id": 29413564, "comment_id": 47000888, "body": "a very similar program compiled with <code>-O2</code> runs in 0.55s on my computer"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1427981314, "post_id": 29413564, "comment_id": 47000924, "body": "basically the same with your version (0.54s)"}], "answers": [{"comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 5, "creation_date": 1427983977, "post_id": 29414801, "comment_id": 47002593, "body": "\u201eGHC uses a branching construct for patterns\u201c \u2013 correct, but not for GHC HEAD, where it now uses a jump table: <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10137\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/10137</a>"}, {"owner": {"reputation": 2340, "user_id": 2068635, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/vFzWX.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2068635/stefan"}, "edited": false, "score": 2, "creation_date": 1427984447, "post_id": 29414801, "comment_id": 47002894, "body": "You should call <code>quotRem</code> instead of <code>quot</code> and <code>rem</code>."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 2340, "user_id": 2068635, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/vFzWX.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2068635/stefan"}, "edited": false, "score": 1, "creation_date": 1427984847, "post_id": 29414801, "comment_id": 47003151, "body": "@Stefan I guess I could but it doesn&#39;t matter at this level of optimization."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1427984864, "post_id": 29414801, "comment_id": 47003164, "body": "@JoachimBreitner that&#39;s really neat!"}, {"owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "edited": false, "score": 0, "creation_date": 1427995947, "post_id": 29414801, "comment_id": 47009864, "body": "@Andr&#225;sKov&#225;cs great answer! I should have tried with compiler optimizations! Anyway your solution on my laptop (quite old Intel centrino) ghc 7.8.2 runs in 555ms (~100 ms slower than mine version) and using the optimization suggested by@stefan speedups at ~350. I will try (and update the question) on my workstation.  Is someone aware of the type of optimizations that come in play using -O2 in this context?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 2340, "user_id": 2068635, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/vFzWX.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2068635/stefan"}, "edited": false, "score": 0, "creation_date": 1427996271, "post_id": 29414801, "comment_id": 47010045, "body": "@Stefan OK I should stick to <code>quotRem</code>, because with LLVM it doesn&#39;t matter but it does with native codegen."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "edited": false, "score": 0, "creation_date": 1427996594, "post_id": 29414801, "comment_id": 47010220, "body": "@user1417063: it seems you don&#39;t have LLVM. GHC 7.8.x works with LLVM 3.4, while GHC 7.10.1 works with LLVM 3.5. If you install it, you can compile with the <code>-fllvm</code> flag (LLVM provides a more advanced code generator backend than the default one in GHC). Although even if you use LLVM, GHC 7.8.x can be slower than GHC 7.10."}, {"owner": {"reputation": 2340, "user_id": 2068635, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/vFzWX.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2068635/stefan"}, "edited": false, "score": 0, "creation_date": 1428060925, "post_id": 29414801, "comment_id": 47032208, "body": "@Andr&#225;sKov&#225;cs That&#39;s surprising. I expected that the compiler notices this during optimization (even without LLVM). Thanks for the follow-up."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 12, "last_activity_date": 1427996095, "last_edit_date": 1427996095, "creation_date": 1427983134, "answer_id": 29414801, "question_id": 29413564, "link": "https://stackoverflow.com/questions/29413564/haskell-performance-tuning/29414801#29414801", "title": "Haskell performance tuning", "body": "<p>First, compile with optimizations. With <code>ghc-7.10.1 -O2 -fllvm</code>, the Haskell version runs in <strong>0.54</strong> secs for me. This is already pretty good. </p>\n\n<p>If we want to do even better, we should first replace <code>div</code> with <code>quot</code> and <code>mod</code> with <code>rem</code>. <code>div</code> and <code>mod</code> do some extra work, because they handle the rounding of negative numbers differently. Since we only have positive numbers here, we should switch to the faster functions.  </p>\n\n<p>Second, we should replace the pattern matching in <code>fc</code> with an array lookup. GHC uses a branching construct for <code>Int</code> patterns, and uses binary search when the number of cases is large enough. We can do better here with a lookup. </p>\n\n<p>The new code looks like this:</p>\n\n<pre><code>import qualified Data.Vector.Unboxed as V\n\nfacs :: V.Vector Int\nfacs =\n  V.fromList [1, 1, 2, 6, 24, 120, 720, 5040, 40320, 362880]\n\n--BRUTE FORCE SOLUTION\nsolve:: Int\nsolve = sum (filter (\\x-&gt; sfc x 0 == x) [10..2540160])\n\n--sum factorial of digits\nsfc :: Int -&gt; Int -&gt; Int\nsfc 0 acc = acc\nsfc n acc = sfc n' (acc + V.unsafeIndex facs r)\n    where\n        (n', r) = quotRem n 10\n\nmain = print solve\n</code></pre>\n\n<p>It runs in <strong>0.095</strong> seconds on my computer.</p>\n"}], "owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 29414801, "answer_count": 1, "score": 2, "last_activity_date": 1427996095, "creation_date": 1427979426, "last_edit_date": 1592644375, "question_id": 29413564, "link": "https://stackoverflow.com/questions/29413564/haskell-performance-tuning", "title": "Haskell performance tuning", "body": "<p>I'm quite new to Haskell, and to learn it better I started solving problems here and there and I ended up with this (<a href=\"https://projecteuler.net/problem=34\" rel=\"nofollow noreferrer\">project Euler 34</a>).</p>\n<blockquote>\n<p>145 is a curious number, as 1! + 4! + 5! = 1 + 24 + 120 = 145.</p>\n<p>Find the sum of all numbers which are equal to the sum of the factorial &gt;of their digits.</p>\n<p>Note: as 1! = 1 and 2! = 2 are not sums they are not included.</p>\n</blockquote>\n<p>I wrote a C and an Haskell brute force solution.</p>\n<p>Could someone explain me the Haskell version is ~15x (~0.450 s vs ~6.5s )slower than the C implementation and how to possibly tune and speedup the Haskell solution?</p>\n<pre><code>unsigned int solve(){\nunsigned int result = 0;\nunsigned int i=10;\nwhile(i&lt;2540161){\n    unsigned int sumOfFacts = 0;\n    unsigned int number = i;\n    while (number &gt; 0) {\n       unsigned int d = number % 10;\n        number /= 10;\n        sumOfFacts += factorial(d);\n    }\n    \n    if (sumOfFacts == i)\n        result += i;\n    \n    i++;\n }\n return result;\n}\n</code></pre>\n<p>here the haskell solution</p>\n<pre><code>--BRUTE FORCE SOLUTION\nsolve:: Int\nsolve = sum (filter (\\x-&gt; sfc x 0 == x) [10..2540160])\n\n--sum factorial of digits\nsfc :: Int -&gt; Int -&gt; Int\nsfc 0 acc = acc\nsfc n acc = sfc n' (acc+fc r)\n    where\n        n' = div n 10\n        r  = mod n 10   --n-(10*n')\n        fc 0 =1\n        fc 1 =1\n        fc 2 =2\n        fc 3 =6\n        fc 4 =24\n        fc 5 =120\n        fc 6 =720\n        fc 7 =5040\n        fc 8 =40320\n        fc 9 =362880\n    \n</code></pre>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1427977486, "post_id": 29412215, "comment_id": 46998474, "body": "Although it&#39;s a bit nitpicking, in functional program one in general does not <code>add</code> elements to lists. Once a variable gets a value. It normally cannot change that value anymore... Functional programming makes use of <i>persistent datastructures</i>."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4742290, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AJjnBM3UU6s/AAAAAAAAAAI/AAAAAAAAAE4/AWT4IkLZRB4/photo.jpg?sz=128", "display_name": "seedkey", "link": "https://stackoverflow.com/users/4742290/seedkey"}, "edited": false, "score": 0, "creation_date": 1427975978, "post_id": 29412323, "comment_id": 46997638, "body": "I see, thanks for that :) I knew filter had something to do with it. So the filter function will return a new list with all the matched elements in it?"}, {"owner": {"reputation": 25661, "user_id": 430766, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee7e736eeb33c4b03d4a5e6e813a9abc?s=128&d=identicon&r=PG", "display_name": "bitmask", "link": "https://stackoverflow.com/users/430766/bitmask"}, "reply_to_user": {"reputation": 15, "user_id": 4742290, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AJjnBM3UU6s/AAAAAAAAAAI/AAAAAAAAAE4/AWT4IkLZRB4/photo.jpg?sz=128", "display_name": "seedkey", "link": "https://stackoverflow.com/users/4742290/seedkey"}, "edited": false, "score": 0, "creation_date": 1427976154, "post_id": 29412323, "comment_id": 46997731, "body": "@seedkey: Well, not exactly. The expression <code>filter (dist 1 c)</code> returns a <i>function</i> that has the following property: It takes a list of coordinates and returns a list of coordinates. The returned list will only contain those coordinates with a distance at most <code>1</code> from <code>c</code>. You may type <code>:t filter</code> and <code>:t filter (dist 1 c)</code> into your ghci/hugs prompt to see what type they have."}], "tags": [], "owner": {"reputation": 25661, "user_id": 430766, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ee7e736eeb33c4b03d4a5e6e813a9abc?s=128&d=identicon&r=PG", "display_name": "bitmask", "link": "https://stackoverflow.com/users/430766/bitmask"}, "is_accepted": true, "score": 4, "last_activity_date": 1427975583, "creation_date": 1427975583, "answer_id": 29412323, "question_id": 29412215, "link": "https://stackoverflow.com/questions/29412215/making-a-new-list-inside-a-function-and-adding-an-element-into-it/29412323#29412323", "title": "Making a new list inside a function and adding an element into it", "body": "<p>You make a function</p>\n\n<pre><code>dist :: Int -&gt; Coordinate -&gt; Coordinate -&gt; Bool\ndist k (x_c,y_c) (x_1,y_1) = ((abs (x_1 - x_c)) &lt;= k) &amp;&amp; ((abs (y_1 - y_c)) &lt;= k)\n</code></pre>\n\n<p>It checks if a coordinate is fine. Theny ou say:</p>\n\n<pre><code>local_lements c = filter (dist 1 c)\n</code></pre>\n\n<p>This is sufficient to do exactly what you want. If two coordinates are only <code>1</code> apart, <code>dist 1</code> will return <code>True</code>, and the builtin function <code>filter</code> will take all elements <code>x</code> from list that cause <code>dist 1 c x</code> to return <code>True</code>.</p>\n"}], "owner": {"reputation": 15, "user_id": 4742290, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AJjnBM3UU6s/AAAAAAAAAAI/AAAAAAAAAE4/AWT4IkLZRB4/photo.jpg?sz=128", "display_name": "seedkey", "link": "https://stackoverflow.com/users/4742290/seedkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 29412323, "answer_count": 1, "score": 0, "last_activity_date": 1427978548, "creation_date": 1427975273, "last_edit_date": 1427978548, "question_id": 29412215, "link": "https://stackoverflow.com/questions/29412215/making-a-new-list-inside-a-function-and-adding-an-element-into-it", "title": "Making a new list inside a function and adding an element into it", "body": "<p>I am trying to create a function, that takes a co-ordinate, and then given a set of co-ordinates, it extracts all the coordinates that are within one unit of the given co-ordinates, and then makes a list out of that. I already know how to make this function, I just need clarification as to how I make it RETURN the new list.</p>\n\n<p>For example if I give the function <code>(2,1) [(1,3),(1,2),(3,0),(4,2),(2,2),(3,1)]</code>, it would return a list <code>[(1,2),(3,0),(2,2),(3,1)]</code>.</p>\n\n<p>I already know how to implement a function that can find if a list is within one unit, I just need to know how take the functions I found matching my pattern, and returning it into a fresh list</p>\n\n<pre><code>local_elements :: Coordinate -&gt; List_with_coordinates -&gt; List_with_coordinates\nlocal_elements (x_c,y_c) list = case list of\n  (x_l,y_l) :xs\n    | abs (x_l - x_c) &lt;= 1 &amp;&amp; abs (y_l - y_c) &lt;=1 -&gt; \"what would go here?\" local_elements xs\n    | otherwise -&gt; local_elements xs        \n  [] -&gt; []\n</code></pre>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1427968565, "post_id": 29409914, "comment_id": 46993341, "body": "Is this a Monad (<code>do</code> environment)? Haskell is a functional language, so you can&#39;t simply enumerate instructions..."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 3, "creation_date": 1427969244, "post_id": 29409914, "comment_id": 46993747, "body": "You should add the type of <code>doWhenSomething...</code> and other related information in the question."}], "answers": [{"tags": [], "owner": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "is_accepted": true, "score": 3, "last_activity_date": 1427980335, "creation_date": 1427980335, "answer_id": 29413876, "question_id": 29409914, "link": "https://stackoverflow.com/questions/29409914/haskell-case-branch-with-multiple-expressions/29413876#29413876", "title": "Haskell case branch with multiple expressions", "body": "<p>Assuming your code is in a monad, you probably want something like this:</p>\n\n<pre><code>case maybeV of Nothing -&gt; doWhenNothing \n               Just something -&gt; do\n                 doWhenSomethingExpression_1\n                 doWhenSomethingExpression_2 \n</code></pre>\n"}], "owner": {"reputation": 845, "user_id": 4131972, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/--SIseZZR51U/AAAAAAAAAAI/AAAAAAAAAAw/xWroBmQMpfk/photo.jpg?sz=128", "display_name": "hliu", "link": "https://stackoverflow.com/users/4131972/hliu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 574, "favorite_count": 0, "accepted_answer_id": 29413876, "answer_count": 1, "score": 1, "last_activity_date": 1427980335, "creation_date": 1427968189, "last_edit_date": 1427968744, "question_id": 29409914, "link": "https://stackoverflow.com/questions/29409914/haskell-case-branch-with-multiple-expressions", "title": "Haskell case branch with multiple expressions", "body": "<p>I use pattern match to handle multiple cases like this:</p>\n\n<pre><code>case maybeV of Nothing -&gt; doWhenNothing \n               Just something -&gt; doWhenSomethingExpression_1\n                                 doWhenSomethingExpression_2 \n</code></pre>\n\n<p>it seems compiler considers the second expression <code>doWhenSomethingExpression_2</code> as argument to <code>doWhenSomethingExpression_1</code> and reports error. How to handle this case when I have multiple expressions in one branch of <code>case</code> ?</p>\n\n<p>BTW, I think I can use <code>if</code> to judge the <code>maybe</code> value, but is using <code>if</code> a good way?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 4, "last_activity_date": 1427970568, "last_edit_date": 1427970568, "creation_date": 1427966377, "answer_id": 29409296, "question_id": 29409196, "link": "https://stackoverflow.com/questions/29409196/haskell-recursive-data-and-pattern-matching/29409296#29409296", "title": "Haskell, recursive data and pattern matching", "body": "<p>Ok one after the other:</p>\n\n<h2>tuple vs lists</h2>\n\n<p>Your <code>testElem</code> is not really a list - it is a tuple - so you have to write <code>[..]</code> instead of <code>(..)</code></p>\n\n<h2>constructors</h2>\n\n<p>Your <code>Sseq</code> can either be <code>E</code> or <code>S s</code> where <code>s</code> itself has to be a <code>Sseq</code> again - so your <code>testElem</code> will not work this way (that's why you got the error saying you used functions <code>Sseq -&gt; Sseq</code> (those are the <code>S</code>)</p>\n\n<p>I would suggest:</p>\n\n<pre><code>testElem :: [Sseq]\ntestElem = [S E, S (S (S E)), E, S (S E)]\n</code></pre>\n\n<p>this should evaluate (IMO) to either <code>3</code> or <code>S (S (S E))</code> depending on your desired behavior of <code>maxSseq</code> (see below)</p>\n\n<p>Use this and try again (I guess this is Homework of some sort)</p>\n\n<h3>PS</h3>\n\n<p>all the other errors you will see will basically come from misspelling something - mostlikely <code>SSeq</code>VS <code>Sseq</code> ;)</p>\n\n<h2>more hints:</h2>\n\n<ul>\n<li>Your function will not work (you consume max. one of the <code>S</code> while counting)</li>\n<li>You can try to fix this by cleverly reinserting the <code>x</code> from <code>(S x)::xs</code></li>\n<li>But I think what you really want to do is first implement a function <code>len :: Sseq -&gt; Int</code> and then use this cleverly in some way</li>\n<li>based on your description, what you really want is <code>maxSseq :: [Sseq] -&gt; Sseq</code> - so if you stick with your code you have to remember the max. seqence not (only) it's length</li>\n<li>if you are interested you can use my former hint to solve this easily using <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Ord.html#v:comparing\" rel=\"nofollow\">comparing</a> and <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-List.html#v:maximumBy\" rel=\"nofollow\">maximumBy</a></li>\n</ul>\n\n<p>I will append my full solution in an hour or so but you should really try it out yourself first.</p>\n\n<h2>solutions (don't read if you are still trying)</h2>\n\n<p>ok this is how you can <em>patch</em>  your solution:</p>\n\n<pre><code>maxSseq_hlp :: Int -&gt; Int -&gt; [Sseq] -&gt; Int\nmaxSseq_hlp curmax prevmax [] = max curmax prevmax\nmaxSseq_hlp curmax prevmax ((S x):xs) = maxSseq_hlp (curmax+1) prevmax (x:xs)\nmaxSseq_hlp curmax prevmax (E:xs) = maxSseq_hlp 0 (max curmax prevmax) xs\n</code></pre>\n\n<p>and this is what I would advise if you need to find the <em>max. length element</em>:</p>\n\n<pre><code>import Data.List (maximumBy)\nimport Data.Ord (comparing)\n\nlen :: Sseq -&gt; Int\nlen E = 0\nlen (S x) = 1 + len x\n\nmaxSseq :: [Sseq] -&gt; Sseq\nmaxSseq = maximumBy (comparing len)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4689872, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-zVwayj_UwuQ/AAAAAAAAAAI/AAAAAAAAIRk/21USL0Zz0mk/photo.jpg?sz=128", "display_name": "Massimiliano Martella", "link": "https://stackoverflow.com/users/4689872/massimiliano-martella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 29409296, "answer_count": 1, "score": 0, "last_activity_date": 1427970568, "creation_date": 1427966018, "question_id": 29409196, "link": "https://stackoverflow.com/questions/29409196/haskell-recursive-data-and-pattern-matching", "title": "Haskell, recursive data and pattern matching", "body": "<p><br>\nis the first time that I work with the recursive <code>data</code>.\nI can not solve this problem:</p>\n\n<pre><code>data Sseq = S Sseq | E deriving (Show)\n\ntestElem = (S, S, E, S)\n\nmaxSseq_hlp :: Int -&gt; Int -&gt; [SSeq] -&gt; Int\nmaxSseq_hlp curmax prevmax [] = max curmax prevmax\nmaxSseq_hlp curmax prevmax ((S x):xs) = maxSSeq_hlp (curmax+1) prevmax xs\nmaxSseq_hlp curmax prevmax (E:xs) = maxSSeq_hlp 0 (max curmax prevmax) xs\n\nmaxSseq :: [SSeq] -&gt; Int\nmaxSseq list = maxSseq_hlp 0 0 list\n</code></pre>\n\n<p>The function maxSseq should return the longest sequence S in a list testElem, using an auxiliary function that remembers the S counted in the previous sequences, but gives me the following error</p>\n\n<pre><code>Couldn't match expected type `[Sseq]'\n            with actual type `(Sseq -&gt; Sseq,\n                               Sseq -&gt; Sseq,\n                               Sseq,\n                               Sseq -&gt; Sseq)'\nIn the first argument of `maxSseq', namely `testElem'\nIn the expression: maxSseq testElem\nIn an equation for `it': it = maxSseq testElem\n</code></pre>\n\n<p>I do not understand where is the problem, can you help me please?</p>\n"}, {"tags": ["haskell", "types", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1427965273, "post_id": 29408950, "comment_id": 46991474, "body": "What is <code>A : t</code>? That&#39;s not the same as <code>term :: type-sig</code> right?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1427965431, "post_id": 29408950, "comment_id": 46991547, "body": "<code>A</code> is an uppercase letter and so refers to a constructor, so it can&#39;t be a member of a type class. Technicalities, technicalities..."}], "tags": [], "owner": {"reputation": 7240, "user_id": 327201, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0ee53216660fae93d26f8dcaba3945a0?s=128&d=identicon&r=PG", "display_name": "Ramon Snir", "link": "https://stackoverflow.com/users/327201/ramon-snir"}, "is_accepted": false, "score": 1, "last_activity_date": 1427965462, "last_edit_date": 1427965462, "creation_date": 1427965237, "answer_id": 29408950, "question_id": 29408861, "link": "https://stackoverflow.com/questions/29408861/haskell-constructing-an-class-constrained-abstract-data-type-like-numbers/29408950#29408950", "title": "Haskell: Constructing an class constrained abstract data type like numbers", "body": "<pre><code>class Alphabet t where\n    a :: t\n\ninstance Alphabet Int where\n    a = 1\n\nx = a\n\nghci&gt; :t x\nghci&gt; Alphabet t =&gt; t\n</code></pre>\n\n<p>This is just how typeclasses work :)</p>\n"}, {"comments": [{"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1427965466, "post_id": 29409000, "comment_id": 46991570, "body": "So I can use <code>a</code> without even declaring it as a data constructor?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1427965526, "post_id": 29409000, "comment_id": 46991616, "body": "Its appearance in the <code>class</code> definition is a declaration. . . although for it to mean something, you&#39;ll have to define at least one instance of <code>Alphabet</code>."}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1427965566, "post_id": 29409000, "comment_id": 46991638, "body": "Why can&#39;t I use a capital <code>A</code>? Yes I get it&#39;s reserved for data constructors, but this <code>A</code> looks like a data constructor!"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 1, "creation_date": 1427965733, "post_id": 29409000, "comment_id": 46991714, "body": "It may look like one but it is not.  You cannot pattern match on <code>a</code> for example.   We could declare <code>instance Alphabet (Int -&gt; Int) where a = id; b = (+1)</code> and then these would surely not be data constructors."}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1427965771, "post_id": 29409000, "comment_id": 46991736, "body": "I see. What if I were to use Template Haskell? Would it be possible then?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1427965805, "post_id": 29409000, "comment_id": 46991754, "body": "Uh... I don&#39;t see what that has to do with it.  New question maybe?  What are you trying to do?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1427965850, "post_id": 29409000, "comment_id": 46991775, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/74325/discussion-between-luqui-and-cmcdragonkai\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 5, "last_activity_date": 1427965387, "creation_date": 1427965387, "answer_id": 29409000, "question_id": 29408861, "link": "https://stackoverflow.com/questions/29408861/haskell-constructing-an-class-constrained-abstract-data-type-like-numbers/29409000#29409000", "title": "Haskell: Constructing an class constrained abstract data type like numbers", "body": "<p>Numbers are special.  The class <code>Num</code> has a <code>fromInteger</code> method which implements the interpretation of numbers. So when you see <code>1729</code>, it's short for <code>fromInteger 1729</code>, where that second <code>1729</code> is the literal <code>Integer</code>.  You can't create such a magical interpretation yourself for things other than numbers (and strings, given the <code>OverloadedStrings</code> extension).</p>\n\n<p>That said, if the alphabet you are interested in is finite, you can do this using the usual typeclass machinery, as long as you follow the syntactical rules of the language (e.g. variables must start with lowercase letters):</p>\n\n<pre><code>class Alphabet t where\n    a :: t\n    b :: t\n    ...\n</code></pre>\n\n<p>Now</p>\n\n<pre><code>ghci&gt; :t a\na :: (Alphabet t) =&gt; t\n</code></pre>\n"}], "owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "accepted_answer_id": 29409000, "answer_count": 2, "score": 1, "last_activity_date": 1427965462, "creation_date": 1427964958, "question_id": 29408861, "link": "https://stackoverflow.com/questions/29408861/haskell-constructing-an-class-constrained-abstract-data-type-like-numbers", "title": "Haskell: Constructing an class constrained abstract data type like numbers", "body": "<p>When I create a number like:</p>\n\n<pre><code>x = 1\ny = 2\nz = 3\n</code></pre>\n\n<p>The type of these variables is like so:</p>\n\n<pre><code>ghci&gt; :t x\nghci&gt; Num a =&gt; a\n</code></pre>\n\n<p>This makes me think that 1 is a \"data constructor\" which constructs not a type, nor a type constructor, but any type that is constrained by <code>Num</code> class. This allows me to further clarify to the compiler which of the <code>Num a</code> that I want by running <code>x :: Int</code> or <code>x :: Integer</code>.</p>\n\n<p>I tried finding out how this is done in the docs, but no luck.</p>\n\n<p>So the question is, how would one be able to create a similar data type? In other words, how can I create a set of data constructors similar to <code>1,2,3,4,5...</code> that creates a value of type <code>MyOwnClass a =&gt; a</code>, where <code>MyOwnClass</code> is any arbitrary class that I created myself?</p>\n\n<p>For example:</p>\n\n<pre><code>x = A\ny = \u0434\nz = \u03a8\n\nghci&gt; :t x\nghci&gt; Alphabet a =&gt; a\n</code></pre>\n"}, {"tags": ["haskell", "zooming", "haskell-lens", "newtype"], "comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1427960436, "post_id": 29407289, "comment_id": 46989227, "body": "This is  essentially a duplicate of <a href=\"http://stackoverflow.com/questions/29188217/lens-zoom-ambiguous-variable\">this question</a>. I hesitate to vote duplicate though because this question is clearer than the other one."}], "answers": [{"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": true, "score": 4, "last_activity_date": 1428071156, "creation_date": 1428071156, "answer_id": 29434042, "question_id": 29407289, "link": "https://stackoverflow.com/questions/29407289/lens-zooming-newtype/29434042#29434042", "title": "Lens: zooming newtype", "body": "<p>I'd suggest to make state of <code>Awesome</code> explicit:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell, GeneralizedNewtypeDeriving, TypeFamilies,\n    FlexibleInstances, FunctionalDependencies #-}\nimport Control.Applicative\nimport Control.Monad.Error\nimport Control.Monad.State\nimport Control.Lens\nimport Control.Lens.Zoom\nimport Control.Lens.Internal.Zoom\n\ndata AwesomeState = AwesomeState\n    { _someRecord :: String\n    -- ...\n    }\n\n$(makeLenses ''AwesomeState)\n\nnewtype Awesome s a = Awesome (StateT s (ErrorT String IO) a)\n  deriving ( Functor, Applicative, Monad\n           , MonadIO, MonadError String\n           , MonadState s)\n</code></pre>\n\n<p>Then you can define <code>Zoom</code> instance for it as follows:</p>\n\n<pre><code>type instance Zoomed (Awesome s) = Focusing (ErrorT String IO)\n\ninstance Zoom (Awesome s) (Awesome t) s t where\n    zoom l (Awesome m) = Awesome (zoom l m)\n</code></pre>\n\n<p>Then you'll have</p>\n\n<pre><code>zoom someRecord :: Awesome String a -&gt; Awesome AwesomeState a\n</code></pre>\n"}], "owner": {"reputation": 550, "user_id": 3809223, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a86c2d7227577450956bbbe1ea6662d8?s=128&d=identicon&r=PG&f=1", "display_name": "ksaveljev", "link": "https://stackoverflow.com/users/3809223/ksaveljev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 724, "favorite_count": 1, "accepted_answer_id": 29434042, "answer_count": 1, "score": 5, "last_activity_date": 1428071156, "creation_date": 1427959499, "question_id": 29407289, "link": "https://stackoverflow.com/questions/29407289/lens-zooming-newtype", "title": "Lens: zooming newtype", "body": "<p>I'm interested in getting a <em>zooming</em> functionality for my monad transformer stack which is defined the following way:</p>\n\n<pre><code>newtype Awesome a = Awesome (StateT AwesomeState (ExceptT B.ByteString IO) a)\n  deriving (Functor, Applicative, Monad\n           , MonadIO, MonadError B.ByteString\n           , MonadState AwesomeState)\n</code></pre>\n\n<p>My <em>AwesomeState</em> is deeply nested record, so using zoom would greatly help me in updating some of the fields. But the problem is that zoom doesn't work out of the box for my newtype. </p>\n\n<pre><code>Couldn't match type \u2018Control.Lens.Internal.Zoom.Zoomed Awesome\u2019 \nwith \u2018Control.Lens.Internal.Zoom.Zoomed m0\u2019\n</code></pre>\n\n<p>I found an example of how to make a custom newtype RWST instance of Zoom but trying to adapt it to my newtype gave me no results</p>\n\n<p>The RWST example can be found here: <a href=\"http://lpaste.net/87737\" rel=\"noreferrer\">http://lpaste.net/87737</a></p>\n\n<p>Is there a way I could start using zoom with my monad transformer stack? What would I need to do in order to achieve that? If I should implement the Zoomed/Zoom like in RWST example then I need a pointer of how to do that because I tried and failed to do so.</p>\n"}]