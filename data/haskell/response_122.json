[{"tags": ["haskell", "recursion", "xmonad"], "owner": {"reputation": 93, "user_id": 6747500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D4bGc.png?s=128&g=1", "display_name": "ThinkRedstone", "link": "https://stackoverflow.com/users/6747500/thinkredstone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 556, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1494450200, "creation_date": 1494449881, "last_edit_date": 1494450200, "question_id": 43902625, "link": "https://stackoverflow.com/questions/43902625/creating-a-layout-per-workspace-in-xmonad-with-a-list-of-layouts-or-how-to-cre", "title": "Creating a layout per workspace in xmonad with a list of layouts (or: how to create a recursive data type automatically)", "body": "<p>The basic idea is this: I have a list of workspaces, each with its own unique layout. I want to create the main layout hook from all those specific layouts, without writing <code>onWorkspace \"1\" (Layout Full)</code> and chaining them all manually, with something like </p>\n\n<pre><code>layouts = onWorkspace \"1\" layout1 $ onWorkspace \"2\" layout2 ... $ Layout Full --last layout is the default\n</code></pre>\n\n<p>The reason this is tricky is the return type of <code>onWorkspace \"a\" layout</code> - it returns <code>LayoutClass l Window=&gt; PerWorkspace Layout l Window</code></p>\n\n<p>Now, the PerWorkspace described above stands the type constrain of <code>LayoutClass l Window</code>, combining it with something like <code>foldl ($) (Layout Full)</code> wont work because it creates the recursive data <code>LayoutClass l Window=&gt; PerWorkspace Layout (LayoutClass l Window=&gt; PerWorkspace Layout l Window) Window</code>, with a layer for each workspace. </p>\n\n<p>So my question is this- given an array of <code>LayoutClass l Window=&gt; PerWorkspace Layout l Window</code>, how can I chain them into <code>LayoutClass l Window=&gt; PerWorkspace Layout (LayoutClass l Window=&gt; PerWorkspace Layout l Window) Window</code> however deep it need to be and then apply them the final, default layout?</p>\n\n<p>My attempt so far: </p>\n\n<pre><code>layouts = foldr ($) (Layout Full) $ map (\\w -&gt; onWorkspace (name w) (layout w)) myworkspaces\n</code></pre>\n\n<p>throws in compilation:</p>\n\n<pre><code>xmonad.hs:23:37: error:\n\u2022 Couldn't match type \u2018PerWorkspace Layout Layout Window\u2019\n                 with \u2018Layout Window\u2019\n  Expected type: [Layout Window -&gt; Layout Window]\n    Actual type: [Layout Window -&gt; PerWorkspace Layout Layout Window]\n\u2022 In the second argument of \u2018($)\u2019, namely\n    \u2018map (\\ w -&gt; onWorkspace (name w) (layout w)) myworkspaces\u2019\n  In the expression:\n    foldr ($) (Layout Full)\n    $ map (\\ w -&gt; onWorkspace (name w) (layout w)) myworkspaces\n  In an equation for \u2018layouts\u2019:\n      layouts\n        = foldr ($) (Layout Full)\n          $ map (\\ w -&gt; onWorkspace (name w) (layout w)) myworkspaces\n</code></pre>\n"}, {"tags": ["haskell", "traversable"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1494442717, "post_id": 43900340, "comment_id": 74835223, "body": "That&#39;s impossible in a general case, since the output of the applied function doesn&#39;t have to be same type as the input. So intermediate result might be something like <code>[&quot;Foo&quot;, 2, 3]</code>. You should reformulate your requirement."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1494442786, "post_id": 43900340, "comment_id": 74835274, "body": "@EugeneSh. I think it&#39;s implicit that the <code>(+1)</code> function must be an endo, otherwise it&#39;s impossible, as you explained."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 4, "creation_date": 1494444788, "post_id": 43900340, "comment_id": 74836450, "body": "This is a job for &quot;Clowns and Jokers&quot;. One might choose to illustrate intermediate states more flexibly and precisely. E.g., [([],(1,2),[2,3]),([2],(2,3),[3]), ([2,3],(3,4),[])], where each element of the list of states has the corresponding element of the input &quot;in focus&quot;, we see the outputs we already have on the left, the inputs we have yet to visit on the right, and the before-and-after pair for the element in focus. For such structures, the mapped function need not be an endo."}, {"owner": {"reputation": 2663, "user_id": 482696, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ece6abdd9b9420799ee7764dd5e89119?s=128&d=identicon&r=PG", "display_name": "Danny Navarro", "link": "https://stackoverflow.com/users/482696/danny-navarro"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1494445442, "post_id": 43900340, "comment_id": 74836793, "body": "@pigworker That&#39;s precisely what I&#39;m looking for. I also have to perform some actions with <b>side-effects</b> on the element under focus before moving on. Is there a an nice implementation of &quot;Clowns and Jokers&quot; in some Haskell package?"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 3, "creation_date": 1494451903, "post_id": 43900340, "comment_id": 74840006, "body": "I haven&#39;t seen one. The literate source code for the paper is eminently googleable. Some helpful person took a copy, here <a href=\"https://github.com/mak/course-haskell/blob/master/zipppers/CJ.lhs\" rel=\"nofollow noreferrer\">github.com/mak/course-haskell/blob/master/zipppers/CJ.lhs</a> which is just as well as I can&#39;t find mine."}, {"owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "edited": false, "score": 0, "creation_date": 1494461551, "post_id": 43900340, "comment_id": 74842869, "body": "An implementation of <code>Clown</code> and <code>Joker</code> can be found in <a href=\"http://hackage.haskell.org/package/bifunctors\" rel=\"nofollow noreferrer\">bifunctors</a> by Edward A. Kmett."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2663, "user_id": 482696, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ece6abdd9b9420799ee7764dd5e89119?s=128&d=identicon&r=PG", "display_name": "Danny Navarro", "link": "https://stackoverflow.com/users/482696/danny-navarro"}, "edited": false, "score": 0, "creation_date": 1494446775, "post_id": 43900656, "comment_id": 74837501, "body": "@DannyNavarro Yes, I agree -- I saw your last edit which clarified that. My solution is too specific as it is."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1494446239, "last_edit_date": 1494446239, "creation_date": 1494442583, "answer_id": 43900656, "question_id": 43900340, "link": "https://stackoverflow.com/questions/43900340/mapping-while-showing-intermediate-states/43900656#43900656", "title": "Mapping while showing intermediate states", "body": "<p>On lists, I'd use the following. Feel free to discard the first element, if not wanted.</p>\n\n<pre><code>&gt; let mymap f [] = [[]] ; mymap f ys@(x:xs) = ys : map (f x:) (mymap f xs)\n&gt; mymap (+1) [1,2,3]\n[[1,2,3],[2,2,3],[2,3,3],[2,3,4]]\n</code></pre>\n\n<p>This can also work on <code>Foldable</code>, of course, after one uses <code>toList</code> to convert the foldable to a list. One might still want a better implementation that would avoid that step, though, especially if we want to preserve the original foldable type, and not just obtain a list.</p>\n"}, {"comments": [{"owner": {"reputation": 2663, "user_id": 482696, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ece6abdd9b9420799ee7764dd5e89119?s=128&d=identicon&r=PG", "display_name": "Danny Navarro", "link": "https://stackoverflow.com/users/482696/danny-navarro"}, "edited": false, "score": 0, "creation_date": 1494444995, "post_id": 43901057, "comment_id": 74836559, "body": "Unfortunately I can&#39;t rely on length in my real world problem. I can&#39;t use anything that is <code>List</code> specific."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 2663, "user_id": 482696, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ece6abdd9b9420799ee7764dd5e89119?s=128&d=identicon&r=PG", "display_name": "Danny Navarro", "link": "https://stackoverflow.com/users/482696/danny-navarro"}, "edited": false, "score": 0, "creation_date": 1494445709, "post_id": 43901057, "comment_id": 74836950, "body": "@DannyNavarro <code>length :: Foldable t =&gt; t a -&gt; Int</code>"}, {"owner": {"reputation": 2663, "user_id": 482696, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ece6abdd9b9420799ee7764dd5e89119?s=128&d=identicon&r=PG", "display_name": "Danny Navarro", "link": "https://stackoverflow.com/users/482696/danny-navarro"}, "edited": false, "score": 0, "creation_date": 1494446446, "post_id": 43901057, "comment_id": 74837338, "body": "I didn&#39;t realize <code>length</code> is now implemented in terms of <code>Foldable</code>. That&#39;s very nice. I still think I can&#39;t apply it to my problem but it&#39;s worth exploring this approach."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 2663, "user_id": 482696, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ece6abdd9b9420799ee7764dd5e89119?s=128&d=identicon&r=PG", "display_name": "Danny Navarro", "link": "https://stackoverflow.com/users/482696/danny-navarro"}, "edited": false, "score": 0, "creation_date": 1494447638, "post_id": 43901057, "comment_id": 74837918, "body": "@DannyNavarro From what I can glean from your comments, it seems like you want to perform a side effect each time you map one of the elements? It&#39;s very simple to generalise my function for <code>f :: a -&gt; m a</code>: use the state monad <i>transformer</i> over <code>m</code> and just <code>lift</code> your action when you map it. I&#39;ll edit my answer when I get off the train"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1494447790, "post_id": 43901057, "comment_id": 74837998, "body": "PS it pays to specify your actual problem in the question. If you ask a question about a somewhat-similar-but-different problem you&#39;ll get answers (like this one!) that answer your question correctly but still fail to address your real-world needs. <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\" title=\"what is the xy problem\">meta.stackexchange.com/questions/66377/what-is-the-xy-proble&zwnj;&#8203;m</a>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1494448694, "post_id": 43901057, "comment_id": 74838463, "body": "PPS. An alternative approach: Observe that at the end of this process you&#39;ve applied <code>f</code> to each element of the traversable exactly once. You could traverse the whole traversable with <code>f</code> once, to do the side effects, and then put the list of results back in the input traversable by adapting the code above and/or something like <a href=\"http://stackoverflow.com/q/41522422/1523776\">this</a>"}, {"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 0, "creation_date": 1494490088, "post_id": 43901057, "comment_id": 74852982, "body": "@BenjaminHodgson Saying something is not list-specific because it uses <code>Foldable</code> is a bit silly. Every function using <code>Foldable</code> can be factored into a list-specific function and uses of <code>toList</code>. The <code>Foldable</code> class simply corresponds to some arbitrary, distinguished conversion to lists."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 0, "creation_date": 1494504261, "post_id": 43901057, "comment_id": 74862856, "body": "@DerekElkins <a href=\"http://stackoverflow.com/questions/42521811/why-is-haskell-list-not-a-type-class/42522630#42522630\">I know what <code>Foldable</code> does</a>. The questioneer was asking for a function which worked on any traversable, as opposed to lists specifically. He didn&#39;t realise that <code>length</code> now works on any foldable, he thought it was a list function."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 2, "last_activity_date": 1494447346, "last_edit_date": 1494447346, "creation_date": 1494443980, "answer_id": 43901057, "question_id": 43900340, "link": "https://stackoverflow.com/questions/43900340/mapping-while-showing-intermediate-states/43901057#43901057", "title": "Mapping while showing intermediate states", "body": "<p>I just called it <code>func</code>, per your question, because I couldn't think of a better name.</p>\n\n<pre><code>import Control.Monad.State\n\nfunc f t = [evalState (traverse update t) n | n &lt;- [0..length t - 1]]\n    where update x = do\n            n &lt;- get\n            let y = if n == 0 then f x else x\n            put (n-1)\n            return y\n</code></pre>\n\n<p>The idea is that <code>update</code> counts down from <code>n</code>, and when it reaches 0 we apply <code>f</code>. We keep <code>n</code> in the state monad so that <code>traverse</code> can plumb <code>n</code> through as you walk across the traversable.</p>\n\n<pre><code>ghci&gt; func (+1) [1,1,1]\n[[2,1,1],[1,2,1],[1,1,2]]\n</code></pre>\n\n<p>You could probably save a few keystrokes using <code>mapAccumL</code>, a HOF which captures the pattern of traversing in the state monad.</p>\n"}, {"comments": [{"owner": {"reputation": 2663, "user_id": 482696, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ece6abdd9b9420799ee7764dd5e89119?s=128&d=identicon&r=PG", "display_name": "Danny Navarro", "link": "https://stackoverflow.com/users/482696/danny-navarro"}, "edited": false, "score": 0, "creation_date": 1494507353, "post_id": 43903272, "comment_id": 74865185, "body": "In the end I&#39;m going to use something similar to this because it matches more closely what I really needed. However I&#39;m marking @K. A. Buhr answer as accepted because, for the example I provided, it works very well."}], "tags": [], "owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "is_accepted": false, "score": 1, "last_activity_date": 1494453417, "last_edit_date": 1495540959, "creation_date": 1494452980, "answer_id": 43903272, "question_id": 43900340, "link": "https://stackoverflow.com/questions/43900340/mapping-while-showing-intermediate-states/43903272#43903272", "title": "Mapping while showing intermediate states", "body": "<p>This sounds a little like a zipper without a focus; maybe something like this:</p>\n\n<pre><code>data Zippy a b = Zippy { accum :: [b] -&gt; [b], rest :: [a] }\n\nmapZippy :: (a -&gt; b) -&gt; [a] -&gt; [Zippy a b]\nmapZippy f = go id where\n  go a [] = []\n  go a (x:xs) = Zippy b xs : go b xs where\n    b = a . (f x :)\n\ninstance (Show a, Show b) =&gt; Show (Zippy a b) where\n  show (Zippy xs ys) = show (xs [], ys)\n\n\nmapZippy succ [1,2,3]\n-- [([2],[2,3]),([2,3],[3]),([2,3,4],[])]\n</code></pre>\n\n<p>(using difference lists here for efficiency's sake)</p>\n\n<p>To convert to a fold looks a little like a <a href=\"https://stackoverflow.com/a/13317563/4892417\">paramorphism</a>:</p>\n\n<pre><code>para :: (a -&gt; [a] -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\npara f b [] = b\npara f b (x:xs) = f x xs (para f b xs)\n\nmapZippy :: (a -&gt; b) -&gt; [a] -&gt; [Zippy a b]\nmapZippy f xs = para g (const []) xs id where\n  g e zs r d = Zippy nd zs : r nd where\n    nd = d . (f e:)\n</code></pre>\n\n<p>For arbitrary traversals, there's a cool time-travelling state transformer called <a href=\"https://hackage.haskell.org/package/tardis-0.4.1.0/docs/Control-Monad-Tardis.html\" rel=\"nofollow noreferrer\">Tardis</a> that lets you pass state forwards and backwards:</p>\n\n<pre><code>mapZippy :: Traversable t =&gt; (a -&gt; b) -&gt; t a -&gt; t (Zippy a b)\nmapZippy f = flip evalTardis ([],id) . traverse g where\n  g x = do\n    modifyBackwards (x:)\n    modifyForwards (. (f x:))\n    Zippy &lt;$&gt; getPast &lt;*&gt; getFuture\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1494504648, "post_id": 43905353, "comment_id": 74863155, "body": "Ah, you&#39;re absolutely right, I did misread the question. This is the right answer. I think the code is a bit more complex than it needs to be, though. You don&#39;t need the <code>indexed</code> infrastructure wherein you label every element and then go back over them to compute the result: you can keep the counting-down-index idea of my answer and just change the <code>== 0</code> to <code>&gt;= 0</code>, applying <code>f</code> to every element before the target index, rather than just the single element itself."}, {"owner": {"reputation": 2663, "user_id": 482696, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ece6abdd9b9420799ee7764dd5e89119?s=128&d=identicon&r=PG", "display_name": "Danny Navarro", "link": "https://stackoverflow.com/users/482696/danny-navarro"}, "edited": false, "score": 0, "creation_date": 1494506777, "post_id": 43905353, "comment_id": 74864760, "body": "I&#39;d specialize the second signature to something like:  <code>(a -&gt; IO a) -&gt; [a] -&gt; IO [a]</code> but it&#39;s alright, I can take it from here."}, {"owner": {"reputation": 2663, "user_id": 482696, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ece6abdd9b9420799ee7764dd5e89119?s=128&d=identicon&r=PG", "display_name": "Danny Navarro", "link": "https://stackoverflow.com/users/482696/danny-navarro"}, "edited": false, "score": 0, "creation_date": 1494507343, "post_id": 43905353, "comment_id": 74865176, "body": "Thanks for the name <code>scanMap</code>, that&#39;s a perfect fit for the function in question."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 3, "last_activity_date": 1494468487, "creation_date": 1494468487, "answer_id": 43905353, "question_id": 43900340, "link": "https://stackoverflow.com/questions/43900340/mapping-while-showing-intermediate-states/43905353#43905353", "title": "Mapping while showing intermediate states", "body": "<p>It looks like @Benjamin Hodgson misread your question and thought you wanted <code>f</code> applied to a single element in each partial result.  Because of this, you've ended up thinking his approach doesn't apply to your problem, but I think it does.  Consider the following variation:</p>\n\n<pre><code>import Control.Monad.State\n\nindexed :: (Traversable t) =&gt; t a -&gt; (t (Int, a), Int)\nindexed t = runState (traverse addIndex t) 0\n  where addIndex x = state (\\k -&gt; ((k, x), k+1))\n\nscanMap :: (Traversable t) =&gt; (a -&gt; a) -&gt; t a -&gt; [t a]\nscanMap f t =\n  let (ti, n) = indexed (fmap (\\x -&gt; (x, f x)) t)\n      partial i = fmap (\\(k, (x, y)) -&gt; if k &lt; i then y else x) ti\n  in  map partial [1..n]\n</code></pre>\n\n<p>Here, <code>indexed</code> operates in the state monad to add an incrementing index to elements of a traversable object (and gets the length \"for free\", whatever that means):</p>\n\n<pre><code>&gt; indexed ['a','b','c']\n([(0,'a'),(1,'b'),(2,'c')],3)\n</code></pre>\n\n<p>and, again, as Ben pointed out, it could also be written using <code>mapAccumL</code>:</p>\n\n<pre><code>indexed = swap . mapAccumL (\\k x -&gt; (k+1, (k, x))) 0\n</code></pre>\n\n<p>Then, <code>scanMap</code> takes the traversable object, fmaps it to a similar structure of before/after pairs, uses <code>indexed</code> to index it, and applies a sequence of <code>partial</code> functions, where <code>partial i</code> selects \"afters\" for the first <code>i</code> elements and \"befores\" for the rest.</p>\n\n<pre><code>&gt; scanMap (*2) [1,2,3]\n[[2,2,3],[2,4,3],[2,4,6]]\n</code></pre>\n\n<p>As for generalizing this from lists to something else, I can't figure out exactly what you're trying to do with your second signature:</p>\n\n<pre><code>func :: (Traversable t, Applicative f) =&gt; (a -&gt; f a) -&gt; t a -&gt; f (t a)\n</code></pre>\n\n<p>because if you specialize this to a list you get:</p>\n\n<pre><code>func' :: (Traversable t) =&gt; (a -&gt; [a]) -&gt; t a -&gt; [t a]\n</code></pre>\n\n<p>and it's not at all clear what you'd want this to do here.</p>\n"}], "owner": {"reputation": 2663, "user_id": 482696, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ece6abdd9b9420799ee7764dd5e89119?s=128&d=identicon&r=PG", "display_name": "Danny Navarro", "link": "https://stackoverflow.com/users/482696/danny-navarro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 43905353, "answer_count": 4, "score": 6, "last_activity_date": 1494468487, "creation_date": 1494441477, "last_edit_date": 1494443602, "question_id": 43900340, "link": "https://stackoverflow.com/questions/43900340/mapping-while-showing-intermediate-states", "title": "Mapping while showing intermediate states", "body": "<p>I need a function that does this:</p>\n\n<pre><code>&gt;&gt;&gt; func (+1) [1,2,3]\n[[2,2,3],[2,3,3],[2,3,4]]\n</code></pre>\n\n<p>My real case is more complex, but this example shows the gist of the problem. The main difference is that in reality using indexes would be infeasible. The <code>List</code> should be a <code>Traversable</code> or <code>Foldable</code>.</p>\n\n<p><strong>EDIT</strong>: This should be the signature of the function:</p>\n\n<pre><code>func :: Traversable t =&gt; (a -&gt; a) -&gt; t a -&gt; [t a]\n</code></pre>\n\n<p>And closer to what I really want is the same signature to <code>traverse</code> but can't figure out the function I have to use, to get the desired result.</p>\n\n<pre><code>func :: (Traversable t, Applicative f) :: (a -&gt; f a) -&gt; t a -&gt; f (t a)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1494438985, "post_id": 43899090, "comment_id": 74833065, "body": "There is <code>Data.List.Split</code> package containing <code>splitOn</code> function. Unfortunately it is not standard (hence I don&#39;t provide it as an answer), but might be good enough for you."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1781434"}, "edited": false, "score": 3, "creation_date": 1494438771, "post_id": 43899518, "comment_id": 74832940, "body": "That&#39;s not Haskell?"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 2, "creation_date": 1494439483, "post_id": 43899518, "comment_id": 74833332, "body": "Need to write a parser first :)"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1494447634, "post_id": 43899518, "comment_id": 74837913, "body": "also it does not produce the list as in the given example"}], "tags": [], "owner": {"reputation": 69, "user_id": 7978960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb820e9a92d1020024120530f520d588?s=128&d=identicon&r=PG&f=1", "display_name": "Harish Kumar", "link": "https://stackoverflow.com/users/7978960/harish-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1494438609, "creation_date": 1494438609, "answer_id": 43899518, "question_id": 43899090, "link": "https://stackoverflow.com/questions/43899090/remove-numbers-from-a-string-haskell/43899518#43899518", "title": "remove numbers from a string haskell", "body": "<p>Below line of code will split the string whenever it finds number</p>\n\n<p>String[] strArr= str.split(\"[0-9]\");</p>\n"}, {"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1494439376, "post_id": 43899668, "comment_id": 74833272, "body": "If one has the <code>Split</code> package, he can use <code>splitOn</code>."}, {"owner": {"reputation": 47, "user_id": 7699349, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/366e6c514b0f542fe75e20e7222e115f?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/7699349/bob"}, "edited": false, "score": 0, "creation_date": 1494439977, "post_id": 43899668, "comment_id": 74833613, "body": "Even I have imported Data.List.Split it&#39;s not working...But If I want to made a function like : words::String-&gt; [String] how can I define for any string."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1494440592, "last_edit_date": 1494440592, "creation_date": 1494439244, "answer_id": 43899668, "question_id": 43899090, "link": "https://stackoverflow.com/questions/43899090/remove-numbers-from-a-string-haskell/43899668#43899668", "title": "remove numbers from a string haskell", "body": "<pre><code>&gt; import Data.List.Split\n&gt; split (dropDelims . dropBlanks $ oneOf \" 0123456789\") \"I go 25abc tomorrow 100!\"\n[\"I\",\"go\",\"abc\",\"tomorrow\",\"!\"]\n</code></pre>\n\n<p>with <code>words</code> a two step approach will work</p>\n\n<pre><code>&gt; words $ map (\\x -&gt; if x `elem` ['a'..'z']++['A'..'Z'] then x else ' ') \"I go 25abc tomorrow 100!\"\n[\"I\",\"go\",\"abc\",\"tomorrow\"]\n</code></pre>\n\n<p>here I changed the definition of filter to only alpha chars, if not matches your needs you can reverse the if condition by defining the filtered out chars.</p>\n\n<p>By importing <code>Data.Char(isAlpha)</code> you can change </p>\n\n<pre><code>x `elem` ['a'..'z']++['A'..'Z'] \n</code></pre>\n\n<p>to <code>isAlpha x</code></p>\n"}, {"tags": [], "owner": {"reputation": 4681, "user_id": 1264328, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/786f8275d9fa334bc27630e0fc7f0d22?s=128&d=identicon&r=PG", "display_name": "bwroga", "link": "https://stackoverflow.com/users/1264328/bwroga"}, "is_accepted": false, "score": 1, "last_activity_date": 1494442596, "creation_date": 1494442596, "answer_id": 43900662, "question_id": 43899090, "link": "https://stackoverflow.com/questions/43899090/remove-numbers-from-a-string-haskell/43900662#43900662", "title": "remove numbers from a string haskell", "body": "<p>You could define a recursive function like this:</p>\n\n<pre><code>import Data.Char\n\nsplit :: String -&gt; [String]\nsplit [] = []\nsplit s =\n  let -- Remove non alphabetic characters from front of list\n      s' = dropWhile (not . isAlpha) s\n      -- Split the list at the point where the first non-alphabetic\n      -- character appears\n      (xs,ys) = span isAlpha s'\n      -- Recursively call split on the second list, while prepending \n      -- the first list.\n  in  xs:(split ys)\n</code></pre>\n\n<p>Here is what happens with your test string through the recursive calls:</p>\n\n<pre><code>s  = \"I go 25abc tomorrow 100!\"\ns' = \"I go 25abc tomorrow 100!\"\nxs = \"I\"\nys = \" go 25abc tomorrow 100!\"\n\ns  = \" go 25abc tomorrow 100!\"\ns' = \"go 25abc tomorrow 100!\"\nxs = \"go\"\nys = \" 25abc tomorrow 100!\"\n\ns  = \" 25abc tomorrow 100!\"\ns' = \"abc tomorrow 100!\"\nxs = \"abc\"\nys = \" tomorrow 100!\"\n\ns  = \" tomorrow 100!\"\ns' = \"tomorrow 100!\"\nxs = \"tomorrow\"\nys = \" 100!\"\n\ns  = \" 100!\"\ns' = \"\"\nxs = \"\"\nys = \"\"\n</code></pre>\n\n<p>Note that this will split the word <code>\"abc4def\"</code> into <code>[\"abc\", \"def\"]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1494455079, "creation_date": 1494455079, "answer_id": 43903637, "question_id": 43899090, "link": "https://stackoverflow.com/questions/43899090/remove-numbers-from-a-string-haskell/43903637#43903637", "title": "remove numbers from a string haskell", "body": "<p>The following should do it.</p>\n\n<pre><code>splitWithoutNumbers :: String -&gt; [String]\nsplitWithoutNumbers = map removeNumbers.words\n                      where \n                      removeNumbers \"\"     = \"\"\n                      removeNumbers (s:ss) | isNumber s = removeNumbers ss\n                                           | otherwise  = s : removeNumbers ss\n\n*Main&gt; splitWithoutNumbers \"I go 25abc tomorrow 100!\"\n[\"I\",\"go\",\"abc\",\"tomorrow\",\"!\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13376, "user_id": 873025, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/d8rRW.jpg?s=128&g=1", "display_name": "Snps", "link": "https://stackoverflow.com/users/873025/snps"}, "is_accepted": false, "score": 0, "last_activity_date": 1494457912, "creation_date": 1494457912, "answer_id": 43904055, "question_id": 43899090, "link": "https://stackoverflow.com/questions/43899090/remove-numbers-from-a-string-haskell/43904055#43904055", "title": "remove numbers from a string haskell", "body": "<pre><code>import Data.Char\nimport Control.Monad\nremove = words . filter (liftM2 (||) isAlpha isSpace)\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7699349, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/366e6c514b0f542fe75e20e7222e115f?s=128&d=identicon&r=PG", "display_name": "Bob", "link": "https://stackoverflow.com/users/7699349/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1666, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1494457912, "creation_date": 1494437118, "last_edit_date": 1494447583, "question_id": 43899090, "link": "https://stackoverflow.com/questions/43899090/remove-numbers-from-a-string-haskell", "title": "remove numbers from a string haskell", "body": "<p>Let be a string alphanumeric and I want to split it when he founds a number.</p>\n\n<pre><code>remove xs = [ x | x &lt;- xs, not (x `elem` \",.?!-:;\\\"\\'0123456789\")]\n</code></pre>\n\n<p>I started by those numbers and somne punctuation but I how can I split the string, so I give the string <code>\"I go 25abc tomorrow 100!\"-&gt;[\"I\",\"go\",\"abc\",\"tomorrow\"]</code> !</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1494430482, "post_id": 43896822, "comment_id": 74827950, "body": "<code>data Probability = P a</code> doesn&#39;t make sense. Either choose a concrete, fixed type for the implementation, i.e. <code>data Probability = P Double</code>, or make the implementation a parameter, i.e. <code>data Probability a = P a</code>. Theoretically it is also possible to \u201centomb\u201d a type variable in a concrete, unparameterised container (<i>existential type</i>), but I&#39;m quite sure this is not a good idea for what you want. \u2014 And BTW, you should probably make that a <code>newtype</code> instead of <code>data</code>, for performance."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 6, "creation_date": 1494431114, "post_id": 43896822, "comment_id": 74828364, "body": "&quot;How do I do bounds-checking at compile-time for a type that is not easily represented in terms of Peano numbers (like Double)?&quot; In fact, the answer to this is completely independent of whether your type is easily representable as a Peano number. The answer is: reimplement your type (like Double) and all the operations you care about at the type level. (Good luck with that! I already know that&#39;s more man-years of effort than I&#39;m willing to put in for a few points on StackOverflow.)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494431804, "post_id": 43896822, "comment_id": 74828798, "body": "Sometimes one can enforce constraints in the type system (see e.g. Okasaki) but, in general, this is not always feasible, at least not without starting a research project on that precise goal. Such a large effort would better be spent on improving the type system, e.g. by adding refinement types, which could help to move more constraints into the type system."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1494434993, "post_id": 43896822, "comment_id": 74830697, "body": "Have you looked at <a href=\"http://stackoverflow.com/questions/41743056/how-to-limit-a-int-field-to-a-range-of-values/41749649#41749649\" title=\"how to limit a int field to a range of values\">stackoverflow.com/questions/41743056/&hellip;</a> ?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1494435103, "post_id": 43896822, "comment_id": 74830757, "body": "Notice what you are asking for requires lots of proof work across the uses of your <code>Probability</code> type.  For example, you can&#39;t simply say <code>newProbability = old1 + old2</code> without first proving that those two total less than or equal to <code>1</code>."}, {"owner": {"reputation": 670, "user_id": 7781818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/13f5392f913a0f47fab3e6719bda4b08?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7781818/chris"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1494436016, "post_id": 43896822, "comment_id": 74831287, "body": "@leftaroundabout Thanks, overlooked that (as I said, new to Haskell...) going to edit."}, {"owner": {"reputation": 670, "user_id": 7781818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/13f5392f913a0f47fab3e6719bda4b08?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7781818/chris"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494436261, "post_id": 43896822, "comment_id": 74831442, "body": "@DanielWagner OK, the answer &quot;No there is no way to do this easily/automated&quot; would be perfectly acceptable to me. If you want you can elaborate on your comment in an answer. I was just wondering about it and given what you said I would agree that its probably not worth it. Can you estimate if and how much this might gain in performance?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494437264, "post_id": 43896822, "comment_id": 74832018, "body": "@Chris You&#39;ve got it backwards. This is going to lose big in performance -- probably a 100x slowdown or worse."}, {"owner": {"reputation": 670, "user_id": 7781818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/13f5392f913a0f47fab3e6719bda4b08?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7781818/chris"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494447831, "post_id": 43896822, "comment_id": 74838019, "body": "@DanielWagner Thanks for the nice explanations. So your advice is &quot;Do not mess with type-level constraints but working with &#39;smart-constructors&#39; should do fine&quot;. Is that about a fair summary?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1494450242, "post_id": 43896822, "comment_id": 74839239, "body": "@Chris Yes, I would say in Haskell smart constructors are much lighter-weight in development time and runtime. Additionally, though they require a little bit of (non-machine-checked) careful attention to module boundaries, after that is done they do provide most of the benefits a purely type-level solution would."}], "answers": [{"comments": [{"owner": {"reputation": 670, "user_id": 7781818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/13f5392f913a0f47fab3e6719bda4b08?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7781818/chris"}, "edited": false, "score": 0, "creation_date": 1494447625, "post_id": 43901165, "comment_id": 74837909, "body": "thanks for the detailed answer, the probabilities was just an example... I assume there is a nice package to handle probabilities in a satisfactory way. There are just so many things you might want to represent like distances and so on that are bounded but not enumerable."}], "tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": false, "score": 1, "last_activity_date": 1494444349, "creation_date": 1494444349, "answer_id": 43901165, "question_id": 43896822, "link": "https://stackoverflow.com/questions/43896822/how-to-do-bounds-checking-in-haskell-at-compile-time/43901165#43901165", "title": "How to do bounds-checking in haskell at compile-time?", "body": "<p><em>Interpreting your question as <strong>\"What is the best way to represent probability such that invalid states are not representable\"</strong>, and riffing on that. I'm not an expert and don't know if this will help you.</em></p>\n\n<hr>\n\n<p>Let's assume (maybe incorrectly) you are originally computing probabilities from samples. Your <code>successes</code> and <code>tries</code> are both integers in memory. Let's even assume they are arbitrary precision (in haskell <code>Integer</code>).</p>\n\n<p>Except for the fact that they can be computed quickly, IEEE floating point is not a good way to represent probability (see <a href=\"http://funcall.blogspot.com/2008/07/probability-and-floating-point.html\" rel=\"nofollow noreferrer\">here</a>): </p>\n\n<ul>\n<li>they become less dense as you move from 0 to 1.0, and so if you care about precision you cannot freely transform between the <em>probability of a thing happening and it not happening</em></li>\n<li>it's wasteful: most representable values lie outside your 0 - 1 range</li>\n</ul>\n\n<p>From the blog post I linked above, we learn that working with odds instead of probability improves the situation (we double the number of useful values), and in particular <em>log-odds</em> solves the first issue above by \"stretching the dense regions of floating point numbers and compressing the sparse regions.\"</p>\n\n<h2>Odds in log space</h2>\n\n<p><em>Most info related to log-odds I learned in <a href=\"https://dl.dropboxusercontent.com/u/34547557/log-probability.pdf\" rel=\"nofollow noreferrer\">this nice write-up</a> byt Brian Lee and Jacob Sanders</em></p>\n\n<p><em>log-odds</em> is simply the logarithm to some base of the odds (so we use <code>logOdds</code> where we'd use <code>/</code> if we wanted probability). We can play around with it in ghci and get an intuition pretty quickly:</p>\n\n<pre><code>Prelude&gt; let logOdds successes tries = logBase 10 ( successes / (tries - successes))\nPrelude&gt; logOdds 1 2\n0.0\nPrelude&gt; logOdds 1 10\n-0.9542425094393249\nPrelude&gt; logOdds 5 1000\n-2.2988530764097064\nPrelude&gt; logOdds 995 1000\n2.2988530764097064\nPrelude&gt; logOdds 99995 100000\n4.301008280396999\nPrelude&gt; logOdds 9999995 10000000\n6.3010297785166856\n</code></pre>\n\n<p>We can see the whole float domain is useful now, and we can convert between <em>likelihood</em> and <em>unlikelihood</em> without losing precision. There are also arguments that it's easier to make decisions based on intuition with these numbers. </p>\n\n<p>So <code>log-odds</code> is representation isomorphic to probability where invalid states are not representable. We can convert back with </p>\n\n<pre><code>Prelude&gt; toProbabilty lgOdds = (1 - (1 / (1 + (10**lgOdds))))\nPrelude&gt; toProbabilty 2.2988530764097064\n0.995\n</code></pre>\n\n<h3>Working with log-probability</h3>\n\n<p>I'm not sure how convenient this is or what you're trying to do with your probabilities. The link above mentions that log-odds works naturally in the context of Bayes theorem.</p>\n\n<p>But I wanted to elaborate on this, because <em>log-odds</em> is an instance of a general technique I generally hear called \"working in log space\" which can be very helpful when trying to do calculations where you might get very large or very small values. The idea is to use the log laws to transform your calculation, to lower multiplications and divisions to additions and subtractions.</p>\n\n<p>I'm out of time and will try to come back to this later, but observe</p>\n\n<pre><code>odds successes tries = successes / (tries - successes)\nodds successes tries = 10 ** (logBase 10 ( successes / (tries - successes)))\nodds successes tries = 10 ** (logBase 10 successes - logBase 10 (tries - successes)\n</code></pre>\n\n<p>my goal if I had more time being to show hopefully how a ratio representation of probability can be used for some calculations you might be interested in, without losing precision.</p>\n\n<h2>conclusion</h2>\n\n<p>Part of my point of this answer is that we don't usually need to do type-level computation to make invalid states unrepresentable. When we return <code>Either Foo Bar</code> from a function we're doing this. </p>\n\n<p>Another example in a library I wrote I originally had a comment that the user should only pass on <code>Int</code> that was a power of two, otherwise error. Instead I changed the function to take the power of two directly.</p>\n"}], "owner": {"reputation": 670, "user_id": 7781818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/13f5392f913a0f47fab3e6719bda4b08?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7781818/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1494444349, "creation_date": 1494430005, "last_edit_date": 1495542870, "question_id": 43896822, "link": "https://stackoverflow.com/questions/43896822/how-to-do-bounds-checking-in-haskell-at-compile-time", "title": "How to do bounds-checking in haskell at compile-time?", "body": "<p>I am rather new to Haskell and I was wondering how one would go about enforcing bounds using the type-system. After reading <a href=\"https://stackoverflow.com/questions/7302735/how-to-create-a-type-bounded-within-a-certain-range\">this question</a> and checking out the linked article on <a href=\"https://wiki.haskell.org/Smart_constructors\" rel=\"nofollow noreferrer\">smart constructors</a> I think I get how you could generate a bounded type and generate a constructor for it  like in the example:</p>\n\n<pre><code>data Probability a = P a deriving (Show, Ord, Eq)\n</code></pre>\n\n<p>I read in <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses\" rel=\"nofollow noreferrer\">learn you a Haskell for great good</a>, that you should </p>\n\n<blockquote>\n  <p>never add typeclass constraints in data declarations</p>\n</blockquote>\n\n<p>so no type-constraints at this point...</p>\n\n<pre><code>instance Bounded Probability where\n  minBound = P 0\n  maxBound = P 1     \n\nsmartP :: (Floating a) =&gt; a -&gt; Probability\nsmartP x = assert (0 &lt;= x &amp;&amp; x &lt;= 1) $ P x\n</code></pre>\n\n<p>What I am wondering now is if and how it would be possible to do the bounds-check at compile-time for a type that is not easily represented in terms of <a href=\"https://wiki.haskell.org/Peano_numbers\" rel=\"nofollow noreferrer\">Peano numbers</a> (like Double...). And maybe if possible, how one would go about finding an encoding for non-enumerable but bounded types.</p>\n\n<p>Furthermore: Probabilities are numbers, and I would like them to behave like numbers (have + - * etc. work on them as you would expect). Is it possible to achieve this behavior by making <code>Probability</code> part of the <code>Number</code> type-class (via deriving or some other way that doesn't involve coding all the functions by hand in the obvious way)? </p>\n\n<p>Thanks a lot for any explanations.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1494430029, "post_id": 43896683, "comment_id": 74827634, "body": "Use a <code>fib</code> function that returns an infinite list of Fibonacci numbers (you can look it up online). Then use <code>sum (take n fib)</code>"}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "edited": false, "score": 1, "creation_date": 1494430106, "post_id": 43896683, "comment_id": 74827686, "body": "This was answered here a few moments ago: <a href=\"http://stackoverflow.com/questions/43883290/how-does-haskell-compute-this-enormous-number-instantly/43893466#43893466\" title=\"how does haskell compute this enormous number instantly\">stackoverflow.com/questions/43883290/&hellip;</a>"}, {"owner": {"reputation": 16071, "user_id": 751484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c752a87779402b14b7cc55a24ca7a18c?s=128&d=identicon&r=PG", "display_name": "Jonathan M", "link": "https://stackoverflow.com/users/751484/jonathan-m"}, "edited": false, "score": 1, "creation_date": 1494430140, "post_id": 43896683, "comment_id": 74827717, "body": "Do you know that <code>sum(Fib(1)..Fib(n)) = Fib(n+2) -1</code> ?"}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "reply_to_user": {"reputation": 16071, "user_id": 751484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c752a87779402b14b7cc55a24ca7a18c?s=128&d=identicon&r=PG", "display_name": "Jonathan M", "link": "https://stackoverflow.com/users/751484/jonathan-m"}, "edited": false, "score": 0, "creation_date": 1494430584, "post_id": 43896683, "comment_id": 74828011, "body": "@Jonathan M: no I didn&#39;t know :) thank you"}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1494430627, "post_id": 43896683, "comment_id": 74828038, "body": "@4castle: I&#39;m not allowed to used &quot;take&quot;, I can use just Type A - Basic functions"}], "answers": [{"comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494431144, "post_id": 43897014, "comment_id": 74828389, "body": "One last hint. <code>sumDouble n = sum (map double [1..n])</code>"}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494431697, "post_id": 43897014, "comment_id": 74828720, "body": "I can&#39;t understand what sumDouble has to do with the sum of first n Fibonacci number. Anyway..thank you."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 1, "creation_date": 1494432056, "post_id": 43897014, "comment_id": 74828958, "body": "@Madalina It&#39;s a hint that Cirdec is providing to you. It&#39;s very close to what you want, except it uses a doubling function instead. Anything more than that would be giving the solution away. (This is why Cirdec wrote &quot;one last hint&quot;.)"}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494433714, "post_id": 43897014, "comment_id": 74829918, "body": "@chi: Thank you. it works but if I&#39;m not allowed to use map, i defined map&#39; instead. I will post the answer. Thanks again all"}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 2, "last_activity_date": 1494430500, "creation_date": 1494430500, "answer_id": 43897014, "question_id": 43896683, "link": "https://stackoverflow.com/questions/43896683/sum-of-first-n-fibonacci-numbers-haskell/43897014#43897014", "title": "Sum of first n fibonacci numbers haskell", "body": "<p>The first <code>n</code> numbers are <code>[1 .. n]</code>. For example, in ghci</p>\n\n<pre><code>Prelude&gt; [1..7]\n[1,2,3,4,5,6,7]\n</code></pre>\n\n<p>You can <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:map\" rel=\"nofollow noreferrer\"><code>map</code></a> a function onto a list, applying that function to each element in the list, and returning the resulting list. For example</p>\n\n<pre><code>Prelude&gt; double x = x+x\nPrelude&gt; map double [1..7]\n[2,4,6,8,10,12,14]\n</code></pre>\n\n<p>You can do the same thing with <code>fib</code>, <code>map</code>ing it onto the first <code>n</code> numbers. If you want to do this for large <code>n</code> you'll need a more efficient implementation of <code>fib</code>.</p>\n\n<p>You can <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:sum\" rel=\"nofollow noreferrer\"><code>sum</code></a> the elements in a list. For example</p>\n\n<pre><code>Prelude&gt; sum [1,3,7]\n11\n</code></pre>\n\n<p>If you put these three ideas together you can <code>sum</code> the result of <code>fib</code> for the first <code>n</code> numbers.</p>\n"}, {"comments": [{"owner": {"reputation": 4601, "user_id": 2976077, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6zEyL.jpg?s=128&g=1", "display_name": "milo526", "link": "https://stackoverflow.com/users/2976077/milo526"}, "edited": false, "score": 0, "creation_date": 1494441100, "post_id": 43898112, "comment_id": 74834226, "body": "While this code snippet may be the solution, <a href=\"//meta.stackexchange.com/questions/114762/explaining-entirely-%E2%80%8C%E2%80%8Bcode-based-answers\">including an explanation</a> really helps to improve the quality of your post. Remember that you are answering the question for readers in the future, and those people might not know the reasons for your code suggestion."}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "reply_to_user": {"reputation": 4601, "user_id": 2976077, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/6zEyL.jpg?s=128&g=1", "display_name": "milo526", "link": "https://stackoverflow.com/users/2976077/milo526"}, "edited": false, "score": 0, "creation_date": 1494489880, "post_id": 43898112, "comment_id": 74852852, "body": "@milo526 I&#39;ve added some explanations"}], "tags": [], "owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "is_accepted": false, "score": 1, "last_activity_date": 1494489857, "last_edit_date": 1494489857, "creation_date": 1494433746, "answer_id": 43898112, "question_id": 43896683, "link": "https://stackoverflow.com/questions/43896683/sum-of-first-n-fibonacci-numbers-haskell/43898112#43898112", "title": "Sum of first n fibonacci numbers haskell", "body": "<p>fib finds the n'th fibonacci number </p>\n\n<pre><code>fib :: Int -&gt; Int\nfib 0 = 0\nfib 1 = 1\nfib x = fib (x-1) + fib (x-2)\n</code></pre>\n\n<p>map' is the implemantation of standard map function ( I wasn't allowed to use it) </p>\n\n<pre><code>map' :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmap' _ [] = []\nmap' f (x:xs) = f x : map' f xs\n</code></pre>\n\n<p>sumFib calculates the sum of first n fibonnaci numbers.</p>\n\n<pre><code>sumFib :: Int -&gt; Int \nsumFib x = sum (map' fib [1..x])\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494489935, "post_id": 43902942, "comment_id": 74852889, "body": "Thank you, thing is that I cannot use theese functions, I was supposed the basic ones."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 2, "last_activity_date": 1494451361, "creation_date": 1494451361, "answer_id": 43902942, "question_id": 43896683, "link": "https://stackoverflow.com/questions/43896683/sum-of-first-n-fibonacci-numbers-haskell/43902942#43902942", "title": "Sum of first n fibonacci numbers haskell", "body": "<p>Another good option would be to generate a lazy function to provide us a list of Fibonacci numbers indefinitely as many as we need. While we can achieve this with a lot of recursive trick, i believe the series generating function of Haskell, namely <code>unfoldr</code> is the ideal one. The following code will beautifully generate us a list of as many of Fibonacci numbers as wee need lazily.</p>\n\n<pre><code>fibs :: [Integer]\nfibs = unfoldr (\\(f,s) -&gt; Just (f,(s,f+s))) (0,1)\n</code></pre>\n\n<p>Now all we have to do is to get the sum of the Fibonacci numbers up to a given count. At this point the <code>take</code> function comes handy. <code>take</code> will take the first <code>n</code> items of a list. Then all we need to do is to apply the <code>sum</code> function to the resulting list.</p>\n\n<pre><code>fibs :: [Integer]\nfibs = unfoldr (\\(f,s) -&gt; Just (f,(s,f+s))) (0,1)\n\nsumNFibs :: Int -&gt; Integer\nsumNFibs = sum . (flip take) fibs\n\n*Main&gt; sumNFibs 10\n88\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 7274406, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eD1BUGNxXss/AAAAAAAAAAI/AAAAAAAAAGg/NKfGCuOtXS0/photo.jpg?sz=128", "display_name": "G&#214;KAY G&#214;K", "link": "https://stackoverflow.com/users/7274406/g%c3%96kay-g%c3%96k"}, "is_accepted": false, "score": 0, "last_activity_date": 1527426610, "creation_date": 1527426610, "answer_id": 50552497, "question_id": 43896683, "link": "https://stackoverflow.com/questions/43896683/sum-of-first-n-fibonacci-numbers-haskell/50552497#50552497", "title": "Sum of first n fibonacci numbers haskell", "body": "<pre><code>fibo 0=0\nfibo 1=1\nfibo n=fibo(n-2)+fibo(n-1)\nfibosum n=sum [fibo i | i&lt;-[0..n-1]]\n</code></pre>\n\n<p>This code calculate the sum of first n fibonacci numbers. fibo function is calculate fibonacci numbers.</p>\n"}], "owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 800, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1527426610, "creation_date": 1494429655, "question_id": 43896683, "link": "https://stackoverflow.com/questions/43896683/sum-of-first-n-fibonacci-numbers-haskell", "title": "Sum of first n fibonacci numbers haskell", "body": "<p>I have tu calculate the sum of first n fibonacci numbers. fib function returns the nth fibonnaci number. But i dont know how to sum only the first n numbers ( n given number )</p>\n\n<pre><code>fib :: Int -&gt; Int\nfib 0 = 0\nfib 1 = 1\nfib x = fib (x-1) + fib (x-2)\n\nsumFib :: Int -&gt; Int \nsumFib x = if x == fib x then x+fib x else fib x\n</code></pre>\n"}, {"tags": ["haskell", "parsec"], "answers": [{"comments": [{"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1548543104, "post_id": 43891865, "comment_id": 95579885, "body": "From my understanding, it seems it isn&#39;t possible because &quot;Parsec can&#39;t handle left-recursive grammars&quot; (<a href=\"https://stackoverflow.com/a/43299434/1663462\">stackoverflow.com/a/43299434/1663462</a>)."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1548581473, "post_id": 43891865, "comment_id": 95585668, "body": "@ChrisStryczynski you&#39;re correct. But it&#39;s possible to change your grammar in a such way that it&#39;s still equivalent to its left-recursive version but doesn&#39;t contain left recursion."}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 4, "last_activity_date": 1503131442, "last_edit_date": 1503131442, "creation_date": 1494417535, "answer_id": 43891865, "question_id": 43891738, "link": "https://stackoverflow.com/questions/43891738/why-does-this-parsec-parser-enter-an-infinite-loop/43891865#43891865", "title": "Why does this Parsec parser enter an infinite loop?", "body": "<p>Problem is really in infinite recursion. Your <code>ast</code> parser calls <code>operation</code> parser first. But then <code>operation</code> parser calls <code>ast</code> back again. And so on. <code>&lt;*&gt;</code> operator for parsing also runs parsers. Explanation of difference from <code>&lt;|&gt;</code> in very informal manner: <code>&lt;*&gt;</code> runs parsers in sequence one by one whether <code>&lt;|&gt;</code> runs first parser and only if it fails runs second.</p>\n\n<pre><code>operation = Operation &lt;$&gt; ast &lt;*&gt; operator &lt;*&gt; ast\nast       = operation &lt;|&gt; number &lt;|&gt; identifier\n</code></pre>\n\n<p>Basically, even with rearranging parsers your approach won't work. See this answer on similar question for explanation: <a href=\"https://stackoverflow.com/questions/43294378/megaparsec-not-able-to-parse-arithmeitc-string/43299434#43299434\">Megaparsec: Not able to parse arithmetic string</a></p>\n"}], "owner": {"reputation": 1722, "user_id": 1593986, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8b55a5d33dee71102db716c72e166974?s=128&d=identicon&r=PG", "display_name": "vidi", "link": "https://stackoverflow.com/users/1593986/vidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 0, "accepted_answer_id": 43891865, "answer_count": 1, "score": 2, "last_activity_date": 1503131442, "creation_date": 1494417180, "question_id": 43891738, "link": "https://stackoverflow.com/questions/43891738/why-does-this-parsec-parser-enter-an-infinite-loop", "title": "Why does this Parsec parser enter an infinite loop?", "body": "<p>The following parser enters an infinite loop for any input.</p>\n\n<pre><code>data Ast\n    = Number Int\n    | Identifier String\n    | Operation Ast BinOp Ast\n    deriving (Show, Eq)\n\ndata BinOp = Plus | Minus\n    deriving (Show, Eq, Enum)\n\nnumber = Number &lt;$&gt; read &lt;$&gt; many1 digit\n\nidentifier = Identifier &lt;$&gt; many1 letter\n\noperator = choice $ mkParser &lt;$&gt; [(Plus, '+'), (Minus, '-')]\n  where mkParser (f, c) = f &lt;$ char c\n\noperation = Operation &lt;$&gt; ast &lt;*&gt; operator &lt;*&gt; ast\n\nast :: Parser Ast\nast = operation &lt;|&gt; number &lt;|&gt; identifier\n</code></pre>\n\n<p>The problem is somewhere in the operation parser. I assume it's related to the alternate parsing but I don't understand it.</p>\n\n<p>Can you explain what the problem is?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "types", "compiler-construction", "ghc"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1494415395, "post_id": 43890914, "comment_id": 74815941, "body": "Types are erased by compilation. The RTS knows nothing about types, it only implements the STG machine (now in eval/apply style) which is an efficient technique for handling closures, thunks, etc. The RTS also implements GC, and some FFI to interface with the C level."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1494415558, "post_id": 43890914, "comment_id": 74816058, "body": "Apart for the above, I think everything is in Haskell. You can&#39;t compile GHC without a previous GHC, just as you can&#39;t compile GCC without a previous GCC. I guess very early versions of GHC were bootstrap-pable from C, or from some other Haskell compiler/interpreter which was in turn bootstrap-pable."}, {"owner": {"reputation": 945, "user_id": 2899420, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33ce7901ec7cd1195561a930201ae56b?s=128&d=identicon&r=PG&f=1", "display_name": "Leonid", "link": "https://stackoverflow.com/users/2899420/leonid"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494415766, "post_id": 43890914, "comment_id": 74816227, "body": "So, everything (for example type inference) is implemented in Haskell. Then STG receives low-level representation of evaluations and just performs it without any type checks, operating with values only?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1494421625, "post_id": 43890914, "comment_id": 74820847, "body": "Yes, STG does not perform type checks. In many statically-typed programming languages, types are checked at compile time only, and then can be discarded (erased) so that at runtime there is no overhead due to types. In GHC, the static type checker is implemented in Haskell."}, {"owner": {"reputation": 9089, "user_id": 293147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/247ce1ecd6cce2377ff3194386362392?s=128&d=identicon&r=PG", "display_name": "SK-logic", "link": "https://stackoverflow.com/users/293147/sk-logic"}, "edited": false, "score": 3, "creation_date": 1494426206, "post_id": 43890914, "comment_id": 74824530, "body": "If you really want to see a Haskell type system implemented in C for whatever reason, there is one in Hugs98 (see <code>src&#47;type.c</code>)."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1494427942, "post_id": 43890914, "comment_id": 74825982, "body": "Well, one could probably compile an unregistered GHC and use that unregistered GHC to compile GHC to C. But I don&#39;t think that&#39;s going to be pretty."}, {"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 0, "creation_date": 1494454088, "post_id": 43890914, "comment_id": 74840868, "body": "Another resource you may find helpful, but doesn&#39;t directly answer your question:   GHC has a ton of complexity for a variety of reasons (historical, experimental, performance, ...) that gets in the way of learning how it works.  Stephen Diehl is blogging about writing a toy implementation of the basics of Haskell, from first principles, with the goal of learning.  <a href=\"http://dev.stephendiehl.com/fun/\" rel=\"nofollow noreferrer\">http://dev.stephendiehl.com/fun/</a>"}], "answers": [{"comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1494511584, "post_id": 43904208, "comment_id": 74868707, "body": "GHC can be built with flags that tell it to create very unoptimized C programs instead of executables. This is how it&#39;s bootstrapped on new platforms these days."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 2, "last_activity_date": 1494459117, "creation_date": 1494459117, "answer_id": 43904208, "question_id": 43890914, "link": "https://stackoverflow.com/questions/43890914/ghc-internals-is-there-c-implementation-of-the-type-system/43904208#43904208", "title": "GHC internals: is there C implementation of the type system?", "body": "<p>As others have noted in the comments, GHC is written almost entirely\nin Haskell (plus select GHC extensions) and is intended to be compiled with itself.  In fact, the only program in the world that can compile the GHC compiler is the GHC compiler!  In particular,\nparsing and type inference are implemented in Haskell code, and you\nwon't find a C implementation hidden in there anywhere.</p>\n\n<p>The best source for understanding the internal structure of the\ncompiler (and what's implemented how) is the <a href=\"https://ghc.haskell.org/trac/ghc\" rel=\"nofollow noreferrer\">GHC Developer Wiki</a>\nand specifically the \"GHC Commentary\" link.  If you have a fair bit of spare time, the <a href=\"https://ghc.haskell.org/trac/ghc/wiki/AboutVideos\" rel=\"nofollow noreferrer\">video\nseries</a> from the\nPortland 2006 GHC Hackathon is absolutely fascinating.</p>\n\n<p>Note that the idea of a compiler being written in the language it\ncompiles is not unusual.  Many compilers are \"self-hosting\" meaning\nthat they are written in the language they compile and are intended to\ncompile themselves.  See, for example, this question on another Stack\nExchange sister site: <a href=\"https://softwareengineering.stackexchange.com/questions/263651/why-are-self-hosting-compilers-considered-a-rite-of-passage-for-new-languages\">Why are self-hosting compilers considered a\nrite of passage for new languages?</a>, or simply Google for\n\"self-hosting compiler\"</p>\n\n<p>As you say, this is \"tricky\", because you need a way to get the\nprocess started.  Some approaches are:</p>\n\n<ul>\n<li><p>You can write the first compiler in a different language that\nalready has a compiler (or write it in assembly language); then,\nonce you have a running compiler, you can port it to the same\nlanguage it compiles.  According to <a href=\"https://www.quora.com/What-language-was-the-first-C-compiler-written-in\" rel=\"nofollow noreferrer\">this Quora answer</a>, the\nfirst C compiler was written this way.  It was written in \"NewB\"\nwhose compiler was written in \"B\", a self-hosting compiler that\nhad originally been written in assembly and then rewritten in\nitself.</p></li>\n<li><p>If the language is popular enough to have another compiler, write\nthe compiler in its own language and compile it in phases, first\nwith the other compiler, then with itself (as compiled by the\nother compiler), then again with itself (as compiled by itself).\nThe last two compiler executables can be compared as a sort of\nmassive test that the compiler is correct.  The Gnu C Compiler can\nbe compiled this way (and this certainly used to be the standard way to install it from source, using the vendor's [inferior!] C compiler to get started).</p></li>\n<li><p>If an interpreter written in another language already exists or is\neasy to write, the compiler can be run by the interpreter to\ncompile its own source code, and thereafter the compiled compiler\ncan be used to compile itself.  <a href=\"ftp://publications.ai.mit.edu/ai-publications/pdf/AIM-039.pdf\" rel=\"nofollow noreferrer\">The first LISP compiler</a> is\nclaimed to be the first compiler to bootstrap itself this way.</p></li>\n</ul>\n\n<p>The bootstrapping process can often be simplified by writing the compiler (at least initially) in a restricted core of the language, even though the compiler itself is capable of compiling the full language.  Then, a sub-par existing compiler or a simplified bootstrapping compiler or interpreter can get the process started.</p>\n\n<p>According to <a href=\"https://en.wikipedia.org/wiki/Glasgow_Haskell_Compiler\" rel=\"nofollow noreferrer\">the Wikipedia entry for GHC</a>, the original GHC compiler was written in 1989 in Lazy ML, then rewritten in Haskell later the same year.  These days, new versions of GHC with all their shiny new features are compiled on older versions of GHC.</p>\n\n<p>The situation for the Python interpreter is a little different.  An\ninterpreter can be written in the language it interprets, of course,\nand there are many examples in the Lisp world of writing Lisp\ninterpreters in Lisp (for fun, or in developing a new Lisp dialect, or\nbecause you're <a href=\"http://www-formal.stanford.edu/jmc/recursive.html\" rel=\"nofollow noreferrer\">inventing Lisp</a>), but it can't be interpreters all\nthe way down, so eventually you'd need either a compiler or an\ninterpreter implemented in another language.  As a result, most\ninterpreters aren't self-hosting: the mainstream interpreters for\nPython, Ruby, and PHP are written in C.  (Though, PyPy is an alternate\nimplementation of the Python interpreter that's written in Python,\nso...)</p>\n"}], "owner": {"reputation": 945, "user_id": 2899420, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33ce7901ec7cd1195561a930201ae56b?s=128&d=identicon&r=PG&f=1", "display_name": "Leonid", "link": "https://stackoverflow.com/users/2899420/leonid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "accepted_answer_id": 43904208, "answer_count": 1, "score": 2, "last_activity_date": 1494459117, "creation_date": 1494415012, "question_id": 43890914, "link": "https://stackoverflow.com/questions/43890914/ghc-internals-is-there-c-implementation-of-the-type-system", "title": "GHC internals: is there C implementation of the type system?", "body": "<p>I'm looking into internals of <a href=\"https://github.com/ghc/ghc\" rel=\"nofollow noreferrer\">GHC</a> and I find all the parsing and type system written completely in Haskell. Low-level core of the language is provided by <a href=\"https://github.com/ghc/ghc/tree/master/rts\" rel=\"nofollow noreferrer\">RTS</a>. The question is which one of the following is true?</p>\n\n<ul>\n<li>RTS contains C implementation of the type system and other basic parts of Haskell (I didn't find it, RTS is mainly GC and threading)</li>\n<li>Everything is implemented in Haskell itself. But it seems quite tricky because building GHC already requires GHC. </li>\n</ul>\n\n<p>Could you explain development logic of the compiler? For example <a href=\"https://github.com/python/cpython\" rel=\"nofollow noreferrer\">Python</a> internals provide an opaque implementation of everything in C.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494414776, "post_id": 43890455, "comment_id": 74815448, "body": "With difference do you mean the <i>absolute value</i> of the difference? Do <code>(2,4)</code> and <code>(4,2)</code> both map on <code>2</code>?"}, {"owner": {"reputation": 878, "user_id": 1274978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7560667a7ae35741ddd3d4dfc97ccf37?s=128&d=identicon&r=PG", "display_name": "Titou", "link": "https://stackoverflow.com/users/1274978/titou"}, "edited": false, "score": 0, "creation_date": 1494421600, "post_id": 43890455, "comment_id": 74820817, "body": "@Madalina please validate the answer of Willem if it does solve your problem. It is important for others to know whether an answer has been accepted or not"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494416165, "post_id": 43890872, "comment_id": 74816496, "body": "Thank you, so in this case i need a help function. Thank you  again"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 1, "creation_date": 1494416246, "post_id": 43890872, "comment_id": 74816550, "body": "@Madalina: you do not <i>need</i> a help function in the sense that it is a hard requirement, it only makes it easier if you solve separate problems with separate functions, structures, etc."}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494423234, "post_id": 43890872, "comment_id": 74822160, "body": "Can I ask you something that it&#39;s quite similar? I&#39;m not sure if I understood very well :)"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494423934, "post_id": 43890872, "comment_id": 74822731, "body": "@Madalina: feel free to ask"}, {"owner": {"reputation": 1367, "user_id": 1160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc61c1b2045efa54375188bdb6a33945?s=128&d=identicon&r=PG", "display_name": "Jedai", "link": "https://stackoverflow.com/users/1160885/jedai"}, "edited": false, "score": 0, "creation_date": 1494424825, "post_id": 43890872, "comment_id": 74823427, "body": "Instead of <code>[ diff_or_max x x2 | (x:x2:_) &lt;- tails xs ]</code>, you can also use <code>zipWith diff_or_max xs (tail xs)</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1367, "user_id": 1160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc61c1b2045efa54375188bdb6a33945?s=128&d=identicon&r=PG", "display_name": "Jedai", "link": "https://stackoverflow.com/users/1160885/jedai"}, "edited": false, "score": 0, "creation_date": 1494424935, "post_id": 43890872, "comment_id": 74823505, "body": "@Jedai: yeah indeed. I had the idea to minimize the &quot;difference&quot; between the question and the answer (for instance by not introducing much more functions). But evidently there can be more elegant ways."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1494414910, "creation_date": 1494414910, "answer_id": 43890872, "question_id": 43890455, "link": "https://stackoverflow.com/questions/43890455/haskell-calculate-the-product-of-a-list-of-integers-like-this/43890872#43890872", "title": "Haskell , calculate the product of a list of integers like this:", "body": "<p>There are two problems that arise here:</p>\n\n<ul>\n<li>obtaining every two consecutive numbers; and</li>\n<li>calculating the difference or the maximum.</li>\n</ul>\n\n<p>My guess is that it is better to resolve this problems separately. The second can best be resolved by using a separate function: <code>diff_or_max</code> for instance:</p>\n\n<pre><code>diff_or_max :: (Num a, Ord a) =&gt; a -&gt; a -&gt; a\ndiff_or_max x y | x &gt;= 0 &amp;&amp; y &gt;= 0 = abs (x-y)\n                | otherwise = max x y\n</code></pre>\n\n<p>The first problem could be solved by using the <code>tails</code> function of the <code>Data.List</code> module:</p>\n\n<pre><code>import Data.List(tails)\n\nspecial_prod :: (Num a, Ord a) =&gt; [a] -&gt; a\nspecial_prod xs = product [ diff_or_max x x2 | (x:x2:_) &lt;- tails xs ]\n</code></pre>\n\n<p>This yields:</p>\n\n<pre><code>*Main Data.List&gt; special_prod [7,5,4, -3,2] \n16\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1494427100, "creation_date": 1494413785, "last_edit_date": 1494415173, "question_id": 43890455, "link": "https://stackoverflow.com/questions/43890455/haskell-calculate-the-product-of-a-list-of-integers-like-this", "title": "Haskell , calculate the product of a list of integers like this:", "body": "<p>My task is:</p>\n\n<blockquote>\n  <p>For a list of numbers, calculate the product of the difference between\n  two consecutive elements if the elements are positive or the maximum\n  of the elements, otherwise.</p>\n</blockquote>\n\n<p>I can use only list comprehension.</p>\n\n<p>Example: <code>prod [7,5,4, -3,2] == 2 * 1 * 4 * 2 == 16</code></p>\n\n<pre><code>prod :: [Int] -&gt; Int\nprod xs = product [ x | x &lt;- xs, x &gt; 0 ]\n</code></pre>\n\n<p>I don't know how to take the next character to make the difference if they are positive numbers. Can someone please guide me a little?</p>\n"}, {"tags": ["haskell", "reflection", "typeclass", "instances", "automatic-differentiation"], "comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1494418137, "post_id": 43890029, "comment_id": 74818023, "body": "<code>ad</code> package uses a lot of magic underhood and a lot of custom type classes. Not actually about <code>ad</code> but you can watch this video about designing <code>AutomaticDifferentiation</code> library: <a href=\"https://www.youtube.com/watch?v=q1DUKEOUoxA&amp;t=4322s\" rel=\"nofollow noreferrer\">youtube.com/watch?v=q1DUKEOUoxA&amp;t=4322s</a>"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1494423669, "post_id": 43890029, "comment_id": 74822513, "body": "Note that to get <code>recip (1 - x * x) * 1</code>, you had to apply <code>diff atanh</code> to <code>x</code>. The simple <code>x</code> is unassuming, but it&#39;s the core of the magic you see here."}], "answers": [{"comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1494436846, "post_id": 43894734, "comment_id": 74831780, "body": "It&#39;s worth noting explicitly that the Debug.SimpleReflect module is where the <code>x</code> comes from in the example."}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": true, "score": 3, "last_activity_date": 1494426049, "last_edit_date": 1494426049, "creation_date": 1494424833, "answer_id": 43894734, "question_id": 43890029, "link": "https://stackoverflow.com/questions/43890029/ad-reflection-how-does-it-work/43894734#43894734", "title": "AD Reflection - How does it work?", "body": "<p>It has nothing to do with the AD package, actually, and everything to do with the <code>x</code> in <code>diff atanh x</code>.</p>\n\n<p>To see this, let's define our own AST type</p>\n\n<pre><code>data AST = AST :+ AST\n         | AST :* AST\n         | AST :- AST\n         | Negate AST\n         | Abs AST\n         | Signum AST\n         | FromInteger Integer\n         | Variable String\n</code></pre>\n\n<p>We can define a <code>Num</code> instance for this type</p>\n\n<pre><code>instance Num (AST) where\n  (+) = (:+)\n  (*) = (:*)\n  (-) = (:-)\n  negate = Negate\n  abs = Abs\n  signum = Signum\n  fromInteger = FromInteger\n</code></pre>\n\n<p>And a <code>Show</code> instance</p>\n\n<pre><code>instance Show (AST) where\n  showsPrec p (a :+ b) = showParen (p &gt; 6) (showsPrec 6 a . showString \" + \" . showsPrec 6 b)\n  showsPrec p (a :* b) = showParen (p &gt; 7) (showsPrec 7 a . showString \" * \" . showsPrec 7 b)\n  showsPrec p (a :- b) = showParen (p &gt; 6) (showsPrec 6 a . showString \" - \" . showsPrec 7 b)\n  showsPrec p (Negate a) = showParen (p &gt;= 10) (showString \"negate \" . showsPrec 10 a)\n  showsPrec p (Abs a) = showParen (p &gt;= 10) (showString \"abs \" . showsPrec 10 a)\n  showsPrec p (Signum a) = showParen (p &gt;= 10) (showString \"signum \" . showsPrec 10 a)\n  showsPrec p (FromInteger n) = showsPrec p n\n  showsPrec _ (Variable v) = showString v\n</code></pre>\n\n<p>So now if we define a function:</p>\n\n<pre><code>f :: Num a =&gt; a -&gt; a\nf a = a ^ 2\n</code></pre>\n\n<p>and an AST variable:</p>\n\n<pre><code>x :: AST\nx = Variable \"x\"\n</code></pre>\n\n<p>We can run the function to produce either integer values or AST values:</p>\n\n<pre><code>\u03bb f 5\n25\n\u03bb f x\nx * x\n</code></pre>\n\n<p>If we wanted to be able to use our AST type with your function <code>f :: Floating a =&gt; a -&gt; a; f x = x^2</code>, we'd need to extend its definition to allow us to implement <code>Floating (AST)</code>.</p>\n"}], "owner": {"reputation": 2173, "user_id": 3794544, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/94226e756a1e68dd797037f11dc2102a?s=128&d=identicon&r=PG&f=1", "display_name": "user47376", "link": "https://stackoverflow.com/users/3794544/user47376"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 43894734, "answer_count": 1, "score": 0, "last_activity_date": 1494432148, "creation_date": 1494412594, "last_edit_date": 1494432148, "question_id": 43890029, "link": "https://stackoverflow.com/questions/43890029/ad-reflection-how-does-it-work", "title": "AD Reflection - How does it work?", "body": "<p>I have seen the <code>ad</code> package and i understand how it does automatic differentiation by providing a different instance of the <code>class Floating</code> and then implementing the rules of derivatives.</p>\n\n<p>But in the example</p>\n\n<pre><code>Prelude Debug.SimpleReflect Numeric.AD&gt; diff atanh x\nrecip (1 - x * x) * 1\n</code></pre>\n\n<p>We see that it can represent <strong>functions</strong> as <code>AST</code>s and show them as a string with variable names.</p>\n\n<p>I wonder how they did that, because when i write:</p>\n\n<pre><code>f :: Floating a =&gt; a -&gt; a\nf x = x^2\n</code></pre>\n\n<p>No matter what instance I provide, i will get a <strong>function</strong> <code>f :: Something -&gt; Something</code>\nand not a representation like <code>f :: AST</code>, or <code>f :: String</code></p>\n\n<p>The instance cannot \"know\" what the parameters are.</p>\n\n<p>How they are able to do it ?</p>\n"}, {"tags": ["haskell", "types", "instance", "type-parameter"], "answers": [{"comments": [{"owner": {"reputation": 704, "user_id": 7488960, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9e6e6f85903b38fb8e826f97ede366a8?s=128&d=identicon&r=PG&f=1", "display_name": "Akash", "link": "https://stackoverflow.com/users/7488960/akash"}, "edited": false, "score": 1, "creation_date": 1494410776, "post_id": 43889237, "comment_id": 74812594, "body": "Thanks, great help !"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1494412488, "last_edit_date": 1494412488, "creation_date": 1494410517, "answer_id": 43889237, "question_id": 43888968, "link": "https://stackoverflow.com/questions/43888968/why-parameterised-data-type-declaration-in-haskell/43889237#43889237", "title": "Why parameterised data type declaration in Haskell?", "body": "<p>I don't know how familiar you are with imperative programming languages like Java, but I will assume that you are familiar with <em>generics</em>. Now your defintion of <code>Q</code> would be - more or less - equivalent to something in Java like:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>public class Q {\n\n    private Integer field1;\n    private Integer field2;\n    private Integer field3;\n    private Integer field4;\n\n    public Q (Integer field1, Integer field2, Integer field3, Integer field4) {\n        this.field1 = field1;\n        this.field2 = field2;\n        this.field3 = field3;\n        this.field4 = field4;\n    }\n\n}\n</code></pre>\n\n<p>(yeah I know <code>Integer</code> in Java is not equivalent to <code>Integer</code> in Haskell, but that's not an issue here).</p>\n\n<p>Now this thus limits us to working with <code>int</code>s. A problem might occur what to do in case we want a <em>quaternion</em> with <code>double</code>s, or <code>Car</code>s. So that won't work very effectively.</p>\n\n<p>The original definition of <code>Quad</code> however would be something in Java like:</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>public class Quad<b>&lt;A&gt;</b> {\n\n    private <b>A</b> field1;\n    private <b>A</b> field2;\n    private <b>A</b> field3;\n    private <b>A</b> field4;\n\n    public Quad (<b>A</b> field1, <b>A</b> field2, <b>A</b> field3, <b>A</b> field4) {\n        this.field1 = field1;\n        this.field2 = field2;\n        this.field3 = field3;\n        this.field4 = field4;\n    }\n\n}</code></pre>\n\n<p>So you can work with a <code>Quad&lt;Integer&gt;</code> which is - more or less - equivalent to the above definition of <code>Q</code>. But I can easily work with <code>Quad&lt;Double&gt;</code> and <code>Quad&lt;Car&gt;</code> to construct quaternions of doubles, cars, horses,...</p>\n\n<p>Now you might think that a quaternion of horses does not make any sense. Quaternions are usually indeed specified over numbers. But there are several data structures to represent numbers: <code>Integer</code>s can - as the name suggest - only represent integral values. Perhaps you want to allow <code>Double</code>s as well. Furthermore <code>Integer</code> can represent <em>all</em> integral values (until the memory is exhausted). Although that's of course a nice feature, it comes with a cost: performance. It usually takes more time to do computations on <code>Integer</code>s (even if they have the <em>same</em> value). So if you want to boost performance, you may look for <code>Quad Int16</code> for instance.</p>\n\n<p>By using a type parameter you allow yourself a form of flexibility: you do not have to define a data type that looks almost the same as another one.</p>\n\n<p>Furthermore you can define - like the Youtube lessons shows - type instances where you put constraints on the <code>a</code>. So for all <code>Quad a</code>s where <code>a</code> can be <code>show</code>ed, then you can show the <code>Quad a</code>. You can also put constraints on functions. Say for instance you want to provide a way to calculate the sum of the \"elements\" of the quad. You can define:\n</p>\n\n<pre><code>sumquad :: <b>Num a =&gt;</b> Quad a -> a\nsumquad (Q x y z t) = x + y + z + t</code></pre>\n\n<p>So now you have defined a <code>sumquad</code> function for <em>all</em> <code>Quad a</code> types where <code>a</code> is an instance of the <code>Num</code> typeclass (and thus supports addition). If we would work with <code>Q</code>, there should be a <code>sumquadQ</code> for <code>Q</code>, a <code>sumquadQDouble</code> for <code>QDouble</code> (a hypothetical <code>data QDouble = QDouble Double Double Double Double</code>), etc. So it would require a large amount of work and would result in less elegant code.</p>\n"}, {"tags": [], "owner": {"reputation": 3946, "user_id": 1261166, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vL1Ud.jpg?s=128&g=1", "display_name": "Viktor Mellgren", "link": "https://stackoverflow.com/users/1261166/viktor-mellgren"}, "is_accepted": false, "score": 3, "last_activity_date": 1494411063, "creation_date": 1494411063, "answer_id": 43889463, "question_id": 43888968, "link": "https://stackoverflow.com/questions/43888968/why-parameterised-data-type-declaration-in-haskell/43889463#43889463", "title": "Why parameterised data type declaration in Haskell?", "body": "<p><code>Quad a a a a</code> allows you to create a quad containing any type whereas <code>Q Integer Integer Integer Integer</code> only allows Integers.</p>\n\n<p>So it depends on what your quad should be able to store. If you only store Integers maybe it should be called IntegerQuad. One reason might be that you want to implement a function like</p>\n\n<pre><code>--collapse :: Q -&gt; Integer\ncollapse Q(a,b,c,d) = a+b+c+d\n</code></pre>\n\n<p>Which you cant do with a unless (+) is specified.</p>\n\n<p>In Haskell I believe that you should go as abstract as you can since that gives you the most flexibility and the most likely that you can reuse other functions.</p>\n"}], "owner": {"reputation": 704, "user_id": 7488960, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9e6e6f85903b38fb8e826f97ede366a8?s=128&d=identicon&r=PG&f=1", "display_name": "Akash", "link": "https://stackoverflow.com/users/7488960/akash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 43889237, "answer_count": 2, "score": 3, "last_activity_date": 1494412749, "creation_date": 1494409821, "last_edit_date": 1494412749, "question_id": 43888968, "link": "https://stackoverflow.com/questions/43888968/why-parameterised-data-type-declaration-in-haskell", "title": "Why parameterised data type declaration in Haskell?", "body": "<p>I went through a you-tube video and learnt that the person declared a new data type using parameterised data type as :</p>\n\n<pre><code>data Quad a = Quad a a a a\ninstance  (Show a) =&gt; Show (Quad a) where\nshow (Quad a b c d) = (show a) ++ \" \" ++  -- code continues for printing\n</code></pre>\n\n<p>My doubt is why do we need the first line of the code. I did something like this and it still works.\nMy code :</p>\n\n<pre><code>data Q = Q Integer Integer Integer Integer \ninstance  Show Q where\nshow (Q a b c d) = (show a)++\" \" ++ --code continues for printing\n</code></pre>\n\n<p>What is the use of the first line namely <code>data Quad a = Quad a a a a</code> , when instead we can do it by my method as shown just above ? Please Help. Thanks in advance !</p>\n"}, {"tags": ["haskell", "monad-transformers", "state-monad", "newtype"], "answers": [{"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1494436344, "post_id": 43892210, "comment_id": 74831496, "body": "You clearly understand monads, so monad transformers are not a big jump. A monad transformer is a type function which takes a monad and returns a new monad, typically adding some features such as error handling or state. Since a monad is a type function which takes a type and returns a type, <code>m :: * -&gt; *</code>, transformers must have a kind of <code>t :: (* -&gt; *) -&gt; (* -&gt; *)</code>, also known as <code>t :: (* -&gt; *) -&gt; * -&gt; *</code>. So a monad transformer has two type parameters: a monad and a regular type"}], "tags": [], "owner": {"reputation": 255, "user_id": 1788453, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f438272f4e0a03a70f300301da669e62?s=128&d=identicon&r=PG", "display_name": "Patrik", "link": "https://stackoverflow.com/users/1788453/patrik"}, "is_accepted": true, "score": 1, "last_activity_date": 1494418458, "creation_date": 1494418458, "answer_id": 43892210, "question_id": 43888644, "link": "https://stackoverflow.com/questions/43888644/hiding-nested-state-transformers-with-newtype-in-haskell/43892210#43892210", "title": "Hiding nested state transformers with newtype in haskell", "body": "<p>I think I figured it out. If i changed <code>mainGame</code> like so:</p>\n\n<pre><code>mainGame :: Game ()\nmainGame = do\n   liftIO $ print \"Inside game\"\n   s &lt;- gets\n   n &lt;- Game . lift $ randoms 10 :: (Rng [Int])\n   put s ++ n\n</code></pre>\n\n<p>It works as expected. And looking at the definition of MonadTrans lift it would seem like thats what im missing. So makeing a Game instance of MonadTrans would solve my problem.</p>\n\n<p>so doing the following changes to the <code>Game</code> type:</p>\n\n<pre><code>newtype GameT m a {\n    runG :: StateT GameS m a\n} deriving (Applicative, Functor, Monad, MonadIO, MonadState, MonadTrans GameS)\ntype Game = GameT Rng\n</code></pre>\n\n<p>will let me do what I want. I'm still no quite sure why i have to make <code>GameT</code> with the signature <code>GameT m a</code> to be able to make an instance of <code>MonadTrans</code>, struggeling with the types here, maybe some one can chimn in on that.</p>\n"}], "owner": {"reputation": 255, "user_id": 1788453, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f438272f4e0a03a70f300301da669e62?s=128&d=identicon&r=PG", "display_name": "Patrik", "link": "https://stackoverflow.com/users/1788453/patrik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "accepted_answer_id": 43892210, "answer_count": 1, "score": 0, "last_activity_date": 1494418458, "creation_date": 1494408847, "last_edit_date": 1494411380, "question_id": 43888644, "link": "https://stackoverflow.com/questions/43888644/hiding-nested-state-transformers-with-newtype-in-haskell", "title": "Hiding nested state transformers with newtype in haskell", "body": "<p>I'm not sure what I want to accomplish is sane or not (please be nice). But i had an idea for a small game, the game will need to have some state and the state is updated with some random component (otherwise it would be kind of boring). Seeing as the StdGen is also some kind of state i started modelling my program like this</p>\n\n<pre><code>import Control.Monad.State\nimport qualified System.Random as R\ntype Rng = StateT StdGen IO\n\nrandom :: (Random a) =&gt; Rng a\nrandom = state R.random\n\nrandoms :: (Random a) =&gt; Int -&gt; Rng [a]\nrandoms n = replicateM n random\n\ntype GameS = [Int]-- not important right now\n\ntype Game = StateT GameS Rng\n\nmainGame :: Game ()\nmainGame = do\n    s &lt;- gets\n    n &lt;- lift $ randoms 10 :: (Rng [Int]) \n    put s ++ n\n\nmainRng :: Rng ()\nmainRng = do\n    liftIO $ \"Inside Rng!\"\n    -- here do stuff that has to do with game setup and so on dependent on rng\n    runStateT mainGame [1,2,3,4]\n\n\nmain :: IO ()\nmain = do\n    g &lt;- R.newStdGen\n    runStateT mainRng g\n</code></pre>\n\n<p>Alright that worked! So let's try and hide some of our details behind a newtype.</p>\n\n<pre><code>-- change type aliases for Game and Rng to newtype\nnewtype Rng a {\n   runR :: StateT R.StdGen IO a\n} deriving (Applicative, Functor, Monad, MonadIO, MonadState R.StdGen)\n\nnewtype Game a {\n   runG :: StateT GameS Rng a\n} deriving (Applicative, Functor, Monad, MonadIO, MonadState GameS)\n\n-- and create a expose newRun functions\nrunRng :: Rng a -&gt; IO (a, R.StdGen)\nrunRng k = do\n    g &lt;- R.newStdGen\n    runStateT (runR k) g\n\nrunGame :: Game a -&gt; Rng (a, GameS)\nrunGame k = let initial = [1,2,3]\n             in runStateT (runG k) initial\n\n-- mainGame as before\nmainGame :: Game ()\nmainGame = do\n   liftIO $ print \"Inside game\"\n   s &lt;- gets\n   n &lt;- lift $ randoms 10 :: (Rng [Int])\n   put s ++ n\n\nmain :: IO ()\nmain = do\n    final &lt;- runRng $ do\n        liftIO $ print \"Inside rng moand\"\n        runGame mainGame\n    print $ show final\n</code></pre>\n\n<p>This works to a point. Inside <code>mainGame</code> i can do liftIO and all the state operations except when i try to <code>lift</code> to get some random numbers i get a error <code>couldn't match type 't0 Rng' with 'Game'</code></p>\n\n<p>Do i somehow need to implement <code>MonadTrans</code> for my <code>Game</code> and <code>Rng</code> types?</p>\n\n<p>Any help with thid would be great!</p>\n"}, {"tags": ["haskell", "recursion", "tuples"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1494401786, "post_id": 43886003, "comment_id": 74806675, "body": "There are several things off here. First of all, your &quot;array&quot; (which is a list) will always contain the <i>same</i> type. You cannot have <code>[0,1,&#39;a&#39;,3]</code>, since <code>&#39;a&#39;</code> is not an <code>Int</code>. Next, you return a list or a tuple, but their types differ, so that&#39;s not possible either. And last, but not least, the types <code>(a,b)</code> and <code>(a,(a,b))</code> differ, unless <code>b ~ (a,b)</code> and therefore infinite. You would have to use a <code>data InPair a = Stop | InPair a (InPair a)</code> to create that, but now you&#39;re back to a list. Are you looking for type-level inhomogeneous lists?"}, {"owner": {"reputation": 115, "user_id": 7023386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd5e89ee901aec1665f6fdb51fca710?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Kilkelly", "link": "https://stackoverflow.com/users/7023386/thomas-kilkelly"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1494402688, "post_id": 43886003, "comment_id": 74807202, "body": "My bad, my head wasn&#39;t on straight when writing the question. I&#39;ve edited it to be more correct. The list&#39;s items are all supposed to be of the same type. Your comment about b~(a,b) was more where I was looking towards. I don&#39;t know how to define a function that returns an infinite type (is that what they are called?).  I&#39;ll also have a look at type-level inhomogeneous lists"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1494403626, "post_id": 43886003, "comment_id": 74807765, "body": "Even with the edit, you still return <code>(a, ())</code> and <code>[(a, \u2026)]</code>. You return a list or a tuple, but those are different types. This seems like a XY problem. What do you actually want to do?"}, {"owner": {"reputation": 115, "user_id": 7023386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd5e89ee901aec1665f6fdb51fca710?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Kilkelly", "link": "https://stackoverflow.com/users/7023386/thomas-kilkelly"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1494404591, "post_id": 43886003, "comment_id": 74808383, "body": "Bugger. I mean to only return tuples -- I&#39;ve edited it again. Sorry for messing up so terribly. It isn&#39;t actually an XY problem, I do want to know how to go through tuples with recursion (i.e. finding proper typing for tupfunc) -- I just horrifically butchered my attempted SSCCE implementation."}, {"owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "edited": false, "score": 1, "creation_date": 1494404939, "post_id": 43886003, "comment_id": 74808623, "body": "you want variable-length tuples, unfortunately haskell doesn&#39;t support that, that&#39;s why <code>fst</code> function works only on pairs even though it should work with any tuple regardless of size"}, {"owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "edited": false, "score": 0, "creation_date": 1494405030, "post_id": 43886003, "comment_id": 74808683, "body": "and Thomas is right, it&#39;s an XY problem unless you&#39;re just trying things, if there is a real problem post it, probably you&#39;ll want to return a list instead of tuples"}, {"owner": {"reputation": 115, "user_id": 7023386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd5e89ee901aec1665f6fdb51fca710?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Kilkelly", "link": "https://stackoverflow.com/users/7023386/thomas-kilkelly"}, "edited": false, "score": 0, "creation_date": 1494405269, "post_id": 43886003, "comment_id": 74808826, "body": "Hmm...you&#39;re right. There is a real problem but it&#39;s a large part of an assignment so I don&#39;t think it&#39;s really appropriate to post it here. Thanks for the help though!"}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 1, "last_activity_date": 1494425683, "creation_date": 1494425683, "answer_id": 43895091, "question_id": 43886003, "link": "https://stackoverflow.com/questions/43886003/recursion-with-tuple-types/43895091#43895091", "title": "Recursion with tuple types", "body": "<p>This is not possible unless you have type-level informations about the length of the list. Imagining a variant of lists called <code>Vector</code> in which that where the case, you could do the following:</p>\n\n<pre><code>{-# LANGUAGE GADTs, PolyKinds, DataKinds, TypeFamilies, TypeOperators #-}\n\n-- | Peano natural numbers\ndata Nat = Z | S Nat\n\n-- Just for convenience...\ntype N0 = Z\ntype N1 = S N0\ntype N2 = S N1\ntype N3 = S N2\ntype N4 = S N3\ntype N5 = S N4\ntype N6 = S N5\ntype N7 = S N6\ntype N8 = S N7\ntype N9 = S N8\n\n-- | Equivalent to a list, but carries information about its length with it\ndata Vector (n :: Nat) a where\n  Nil    :: Vector Z a\n  (:-)   :: a -&gt; Vector n a -&gt; Vector (S n) a\n\ninfixr 5 :-\n</code></pre>\n\n<p>Now, we can define a type family that converts a number into its appropriate nested tuple:</p>\n\n<pre><code>type family NestedTuple (n :: Nat) (a :: *) where\n  NestedTuple Z     a = ()\n  NestedTuple (S n) a = (a, NestedTuple n a)\n</code></pre>\n\n<p>And finally we can define a function that converts <code>Vector n a</code> to its nested tuple form.</p>\n\n<pre><code>toList :: Vector n a -&gt; NestedTuple n a\ntoList Nil = ()\ntoList (x :- xs) = (x, toList xs)\n</code></pre>\n\n<p>You can test this out at GHCi:</p>\n\n<pre><code>ghci&gt; :set -XFlexibleContexts\nghci&gt; toList (\"foo\" :- \"bar\" :- \"baz\" :- Nil)\n(\"foo\",(\"bar\",(\"baz\",())))\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 7023386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbd5e89ee901aec1665f6fdb51fca710?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Kilkelly", "link": "https://stackoverflow.com/users/7023386/thomas-kilkelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 43895091, "answer_count": 1, "score": 0, "last_activity_date": 1581311338, "creation_date": 1494401128, "last_edit_date": 1581311338, "question_id": 43886003, "link": "https://stackoverflow.com/questions/43886003/recursion-with-tuple-types", "title": "Recursion with tuple types", "body": "<p>I've been struggling with a function that is supposed to return a nested tuple. Specifically, the typing of the function is giving me a lot of issues. A simplified version is below:</p>\n\n<pre><code>tupfnc :: ?????\ntupfnc [a] = (a,()) --\ntupfnc (a:as) = (a,tupfnc as)\n</code></pre>\n\n<p>The idea is to take in an list of items (say <code>[0,1,5,3]</code>) and nest them into a tuple like this: <code>(0,(1,(5,(3,()))))</code>.</p>\n\n<p>My inital thought was to go with a declaration like so:</p>\n\n<pre><code>tupfnc :: [a] -&gt; (a,b)\n</code></pre>\n\n<p>However, the third line (of this example) throws this error: </p>\n\n<pre><code>Solver.hs:56:17: error:\n    \u2022 Couldn't match expected type \u2018(a, b)\u2019\n                  with actual type \u2018[(a, (a, b0))]\u2019\n    \u2022 In the expression: [(a, tupfnc as)]\n      In an equation for \u2018tupfnc\u2019: tupfnc (a : as) = [(a, tupfnc as)]\n    \u2022 Relevant bindings include\n        as :: [a] \n        a :: a \n        tupfnc :: [a] -&gt; (a, b) \n</code></pre>\n"}, {"tags": ["haskell", "recursion"], "answers": [{"comments": [{"owner": {"reputation": 704, "user_id": 7488960, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9e6e6f85903b38fb8e826f97ede366a8?s=128&d=identicon&r=PG&f=1", "display_name": "Akash", "link": "https://stackoverflow.com/users/7488960/akash"}, "edited": false, "score": 0, "creation_date": 1494399040, "post_id": 43885178, "comment_id": 74804991, "body": "Thank you so much !! It was really helpful !"}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 1, "last_activity_date": 1494398296, "creation_date": 1494398296, "answer_id": 43885178, "question_id": 43884930, "link": "https://stackoverflow.com/questions/43884930/error-parsing-in-haskell-code/43885178#43885178", "title": "error parsing in haskell code", "body": "<p><code>value = value + 1</code> isn\u2019t a valid statement in a <code>do</code> block. The only valid statements are:</p>\n\n<ul>\n<li><p>A variable binding: <code>let pattern = expression</code></p></li>\n<li><p>A monadic binding: <code>pattern &lt;- expression</code></p></li>\n<li><p>An expression that evaluates to a monadic action</p></li>\n</ul>\n\n<p>However, you don\u2019t need a <code>do</code> block because you don\u2019t need monadic side effects to implement this function. Furthermore, <code>return</code> isn\u2019t like <code>return</code> in an imperative language\u2014it\u2019s not a keyword that returns from the current function, but a function that creates an action that returns a value. It looks like your intent with <code>value = value + 1</code> was to mutate <code>value</code>, but there are no mutable variables in Haskell. (There are mutable reference types such as <code>IORef</code>, but you don\u2019t need them here.)</p>\n\n<p>So one solution is to simply use an expression:</p>\n\n<pre><code>divideBy :: (Ord a, Num a) =&gt; a -&gt; a -&gt; a\ndivideBy _ 0 = 0\ndivideBy num den\n    | num - den &gt;= 0 = 1 + divideBy (num - den) den\n    | otherwise = 0\n</code></pre>\n\n<p>This says exactly what it means: the quotient of <code>num</code> and <code>den</code> is <code>0</code> if <code>den</code> is <code>0</code>; if <code>num - den &gt;= 0</code>, then it\u2019s 1 more than the quotient of <code>num - den</code> and <code>den</code>; otherwise it\u2019s <code>0</code>.</p>\n"}], "owner": {"reputation": 704, "user_id": 7488960, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/9e6e6f85903b38fb8e826f97ede366a8?s=128&d=identicon&r=PG&f=1", "display_name": "Akash", "link": "https://stackoverflow.com/users/7488960/akash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 43885178, "answer_count": 1, "score": 0, "last_activity_date": 1494398296, "creation_date": 1494397384, "question_id": 43884930, "link": "https://stackoverflow.com/questions/43884930/error-parsing-in-haskell-code", "title": "error parsing in haskell code", "body": "<p>My haskell code goes as follows :</p>\n\n<pre><code>module Lain where\nlet value = 0 \ndivideBy ::(Ord a, Num a)=&gt;a -&gt; a -&gt; a\ndivideBy _ 0 = 0\ndivideBy num den\n    | (num - den) &gt;= 0 = do \n        value = value + 1\n        return divideBy (num-den) den\n    | otherwise = value\n</code></pre>\n\n<p>The error goes on loading the haskell Lain.hs file is : </p>\n\n<p><code>app/Lain.hs:18:1: error:\n    parse error (possibly incorrect indentation or mismatched brackets)\nFailed, modules loaded: none.</code></p>\n\n<p>Not able to interpret where I am going wrong, seems to me more of a logical mistake. My code wants to print the quotient given numerator and denominator. Please help as to what is exactly my mistake. Thanks in advance.</p>\n"}, {"tags": ["haskell", "currying", "dependent-type"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1494393822, "post_id": 43883830, "comment_id": 74802798, "body": "Could you please add a brief summary and/or example of the technique you refer to, so that your question becomes self-contained?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1494425031, "post_id": 43883830, "comment_id": 74823581, "body": "Maybe the authors were thinking of tuples defined recursively (as they are in some languages)? I could see that working out very well."}, {"owner": {"reputation": 146, "user_id": 1550375, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6ea6ef70d794d7206278a4d3c75194f9?s=128&d=identicon&r=PG", "display_name": "Bassam", "link": "https://stackoverflow.com/users/1550375/bassam"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494436604, "post_id": 43883830, "comment_id": 74831661, "body": "thanks @duplode. I included a link to the summary paper and put more information."}, {"owner": {"reputation": 582, "user_id": 5236247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/X84Js.png?s=128&g=1", "display_name": "Adowrath", "link": "https://stackoverflow.com/users/5236247/adowrath"}, "edited": false, "score": 0, "creation_date": 1579660778, "post_id": 43883830, "comment_id": 105837107, "body": "Maybe they mean the same definition of uncurry as was provided <a href=\"https://ro-che.info/articles/2013-01-29-generic-uncurry\" rel=\"nofollow noreferrer\">here</a>, so the signature would be <code>(a1 -&gt; a2 -&gt; ... -&gt; an -&gt; b) -&gt; ((...(a1, a2), ...), an) -&gt; b</code> instead?"}], "owner": {"reputation": 146, "user_id": 1550375, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/6ea6ef70d794d7206278a4d3c75194f9?s=128&d=identicon&r=PG", "display_name": "Bassam", "link": "https://stackoverflow.com/users/1550375/bassam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1494426274, "creation_date": 1494391942, "last_edit_date": 1494426274, "question_id": 43883830, "link": "https://stackoverflow.com/questions/43883830/how-to-make-curry-and-uncurry-dependent-types", "title": "How to make Curry and Uncurry dependent types?", "body": "<p>I was reading a paper by Fridlender and Indrika titled \"<a href=\"http://www.brics.dk/RS/01/10/BRICS-RS-01-10.pdf\" rel=\"nofollow noreferrer\">Do we need dependent types?</a>\"</p>\n\n<p>In the conclusion, it said that \"The same technique can be applied to\nother functions like liftM, zip, unzip, curry, uncurry, and taut\"</p>\n\n<p>For ZipWith, the authors defined (&lt;&lt;)</p>\n\n<pre><code>(&lt;&lt;) :: [a -&gt; b] -&gt; [a] -&gt; [b]\n(f:fs) &lt;&lt; (a:as) = f a : (fs &lt;&lt; as)\n_&lt;&lt;_=[]\n</code></pre>\n\n<p>then defined zipWith as </p>\n\n<pre><code>(repeat f) &lt;&lt; as1 &lt;&lt; as2 &lt;&lt; .. &lt;&lt; asn\n</code></pre>\n\n<p>they then improved it by using a successor function</p>\n\n<pre><code>succ :: ([b] -&gt; c) -&gt; [a -&gt; b] -&gt; [a] -&gt; c\nsucc = \\n fs as -&gt; n (fs &lt;&lt; as)\n</code></pre>\n\n<p>where the numerals are </p>\n\n<pre><code>zero = id\none = succ zero :: [a -&gt; b] -&gt; [a] -&gt; [b]\ntwo = succ one  :: [a -&gt; b -&gt; c] -&gt; [a] -&gt; [b] -&gt; [c]\n</code></pre>\n\n<p>and so on ..</p>\n\n<p>finally the dependant type zipWith becomes</p>\n\n<pre><code>zipWith :: ([a] -&gt; b) -&gt; a -&gt; b\nzipWith n f = n (repeat f)\n</code></pre>\n\n<p>where n is a numeral</p>\n\n<p>But, I am struggling with applying the same technique to curry and uncurry. I can't see how we can manipulate variant size tuples to expand or shrink in size by adding or removing elements respectively. Haskell does not provide such operations. For example, uncurry should have the following type\nuncurry :: (a1 -> a2 -> .. -> an -> b) -> (a1,a2,..,an) -> b</p>\n\n<p>How can we have curry and uncurry as dependent types in Haskell?</p>\n"}, {"tags": ["haskell", "pandoc", "txt2tags"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1494393972, "post_id": 43883679, "comment_id": 74802857, "body": "According to the <a href=\"http://pandoc.org/MANUAL.html#general-options\" rel=\"nofollow noreferrer\">Pandoc User&#39;s Guide</a>, the option for the txt2tags format is <code>t2t</code>, and not <code>txt2tags</code>."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494414899, "post_id": 43883679, "comment_id": 74815539, "body": "That is also showing same error. I had tried that too."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494431986, "post_id": 43883679, "comment_id": 74828911, "body": "txt2tags support was added in Pandoc 1.13, released in August 2014 (cf. <a href=\"https://hackage.haskell.org/package/pandoc-1.13/changelog\" rel=\"nofollow noreferrer\">that version&#39;s changelog</a>), while Debian Stable <a href=\"https://packages.debian.org/jessie/pandoc\" rel=\"nofollow noreferrer\">currently carries 1.12.4</a>. (The latest version of Pandoc, by the way, is 1.19.2.1.)"}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494434057, "post_id": 43883679, "comment_id": 74830155, "body": "How can I install the latest version?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494434875, "post_id": 43883679, "comment_id": 74830627, "body": "As mentioned by the <a href=\"http://pandoc.org/installing.html\" rel=\"nofollow noreferrer\">Installing page in Pandoc&#39;s site</a>, you can get an updated .deb from <a href=\"https://github.com/jgm/pandoc/releases/tag/1.19.2.1\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494435673, "post_id": 43883679, "comment_id": 74831100, "body": "Are there many dependencies? You should enter all this information as an answer."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494437565, "post_id": 43883679, "comment_id": 74832204, "body": "&quot;Are there many dependencies?&quot; -- Probably no more than for the regular Debian Stable package."}], "owner": {"reputation": 20623, "user_id": 3522130, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f83ceae9da7eb5d15dba167d1ff9357e?s=128&d=identicon&r=PG&f=1", "display_name": "rnso", "link": "https://stackoverflow.com/users/3522130/rnso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494417354, "creation_date": 1494391061, "last_edit_date": 1494417354, "question_id": 43883679, "link": "https://stackoverflow.com/questions/43883679/not-able-to-convert-txt2tags-file-using-pandoc", "title": "Not able to convert txt2tags file using pandoc", "body": "<p>The pandoc information page lists txt2tags as one of the file formats that it can read and use: <a href=\"http://pandoc.org/\" rel=\"nofollow noreferrer\">http://pandoc.org/</a></p>\n\n<p>I am trying following command to convert a t2t file: </p>\n\n<pre><code>$ pandoc article.t2t -f txt2tags -t html -s -o article.html\n</code></pre>\n\n<p>But I get following error: </p>\n\n<pre><code>pandoc: Unknown reader: txt2tags\n</code></pre>\n\n<p>Same error comes if I try <code>-f t2t</code> rather than <code>-f txt2tags</code>. </p>\n\n<p>I found <a href=\"https://hackage.haskell.org/package/pandoc-1.19.2.1/docs/Text-Pandoc-Readers-Txt2Tags.html\" rel=\"nofollow noreferrer\">this site for reader</a> but how do I install it? It is not there in Stable Debian repository. Thanks for your help.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494390577, "post_id": 43883290, "comment_id": 74801693, "body": "(1) Integer is just an arbitrary precision integer type. There probably is something equivalent available for the other languages you are using. (2) Three hints: (a) Is it really instantaneous? (b) How fast do Fibonacci numbers grow? (c) How many values you are actually summing in each case?"}, {"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1494393981, "post_id": 43883290, "comment_id": 74802861, "body": "The complexity of the algorithm is O(log(n)). That&#39;s why it is so fast."}], "answers": [{"comments": [{"owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "edited": false, "score": 1, "creation_date": 1494458024, "post_id": 43883544, "comment_id": 74842113, "body": "My tail-recursive Scala solution is probably about as good as it gets, but its problem was using the wrong types. My Python solution is not very efficient. Thanks for your answer."}], "tags": [], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "is_accepted": true, "score": 7, "last_activity_date": 1494394277, "last_edit_date": 1494394277, "creation_date": 1494390212, "answer_id": 43883544, "question_id": 43883290, "link": "https://stackoverflow.com/questions/43883290/how-does-haskell-compute-this-enormous-number-instantly/43883544#43883544", "title": "How does Haskell compute this enormous number instantly?", "body": "<p>It's likely nothing to do with Haskell in particular but the algorithm you're using for the other solutions.</p>\n\n<p>As fibonacci numbers grow quite quickly (they get 1.6x larger on average each step), there's not that many fibonacci numbers less than 40000000000000000000000000000000, probably less than 100.</p>\n\n<p>A computer adding less than 100 numbers of this size (which isn't particularly big) should take microseconds. </p>\n\n<p>I'm not sure what your other implementations look like, but a common mistake is to write the Fibonacci function like this:</p>\n\n<pre><code>fib 0 = 0\nfib 1 = 1\nfib n = fib (n-1) + fib (n-2)\n</code></pre>\n\n<p>This is terrible, as <code>fib n</code> calls <code>fib (n-1)</code>, which then calls <code>fib (n-2)</code>, and returns the answer to <code>fib n</code>. But then you have to go an calculate <code>fib (n-2)</code> again because you haven't saved the answer.</p>\n\n<p>A better implementation of <code>fib</code> in Haskell (or indeed any other language) is like the following:</p>\n\n<pre><code>fib 0 = 0\nfib n = fib' 0 1 n\n\nfib' _ curr 1 = curr\nfib' last curr n = fib' curr (last+curr) (n-1)\n</code></pre>\n\n<p>Notice that each <code>fib'</code> call only makes one recursive all, not two. What I've written above is roughly what <code>0 : 1 : zipWith (+) fibs (tail fibs)</code> is doing, but the above code is a bit messier but probably also easier to translate into other languages.</p>\n"}, {"comments": [{"owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "edited": false, "score": 0, "creation_date": 1494457400, "post_id": 43883567, "comment_id": 74841958, "body": "Makes sense. Thanks for your answer, and for showing me this cool ghci command!"}], "tags": [], "owner": {"reputation": 3790, "user_id": 805875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bbd9ac04d56f955c822cb28b5ab72fda?s=128&d=identicon&r=PG", "display_name": "nobody", "link": "https://stackoverflow.com/users/805875/nobody"}, "is_accepted": false, "score": 4, "last_activity_date": 1494390348, "creation_date": 1494390348, "answer_id": 43883567, "question_id": 43883290, "link": "https://stackoverflow.com/questions/43883290/how-does-haskell-compute-this-enormous-number-instantly/43883567#43883567", "title": "How does Haskell compute this enormous number instantly?", "body": "<p>The answers should be correct.</p>\n\n<p>You can <code>:set +s</code> to make ghci print memory/time information.</p>\n\n<p>Running your tests again, you can see that it's actually using more and more memory:</p>\n\n<pre><code>Prelude&gt; :set +s\nPrelude&gt; :{\nPrelude| fibs = 0 : 1 : zipWith (+) fibs (tail fibs)\nPrelude| f :: Integer -&gt; Integer\nPrelude| f n =\nPrelude|   let evenFib = filter (\\n -&gt; n `mod` 2 == 0) fibs\nPrelude|   in sum (takeWhile (&lt;n) evenFib)\nPrelude| :}\n(0.14 secs, 0 bytes)\nPrelude&gt; f 40000000\n19544084\n(0.02 secs, 83,440 bytes)\nPrelude&gt; f 40000000\n19544084\n(0.01 secs, 83,200 bytes)\nPrelude&gt; f 400000000000\n478361013020\n(0.01 secs, 94,800 bytes)\nPrelude&gt; f 40000000000000000000000000000000\n13049874051046942401006156573274\n(0.01 secs, 149,400 bytes)\nPrelude&gt; f 2370498572349582734598273495872349587234958723948752394857\n2805750129675962215536656398462489370528480907433875715844\n(0.01 secs, 225,488 bytes)\n</code></pre>\n\n<p>And to understand why it's so fast, take a look at the start of <code>evenFib</code></p>\n\n<pre><code>Prelude&gt; sequence_ $ map (putStrLn . show) $ take 20 $ filter ((== 0) . (flip mod 2)) $ fibs\n0\n2\n8\n34\n144\n610\n2584\n10946\n46368\n196418\n832040\n3524578\n14930352\n63245986\n267914296\n1134903170\n4807526976\n20365011074\n86267571272\n365435296162\n(0.02 secs, 203,472 bytes)\n</code></pre>\n\n<p>The numbers are growing <em>fast</em>, so there really isn't much work to do.</p>\n"}, {"comments": [{"owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "edited": false, "score": 2, "creation_date": 1494457444, "post_id": 43893466, "comment_id": 74841971, "body": "This is awesome. Thanks for showing me your implementation. I love Haskell."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1494434555, "last_edit_date": 1494434555, "creation_date": 1494421729, "answer_id": 43893466, "question_id": 43883290, "link": "https://stackoverflow.com/questions/43883290/how-does-haskell-compute-this-enormous-number-instantly/43893466#43893466", "title": "How does Haskell compute this enormous number instantly?", "body": "<p>As mentioned in the other answers it's pretty quick. While it's already quick i still have a more efficient approach relying on laziness.</p>\n\n<p>For jobs like generating Fibonacci series i believe <code>unfoldr</code> is the ideal tool and then all we need to do is to use <code>foldr1</code> to get the result. In this example <code>foldr1</code> embodies the functionality of <code>takeWhile</code> and <code>filter</code> and do the same job in a single pass. So lazy unfold and fold, O(n) only.</p>\n\n<pre><code>fibs :: [Integer]\nfibs = unfoldr (\\(f,s) -&gt; Just (f,(s,f+s))) (0,1)\n\nsumEvenFibsUpto :: Integer -&gt; Integer\nsumEvenFibsUpto n =  foldr1 (\\ x y -&gt; if x &lt; n then if x `rem` 2 == 0 then x + y\n                                                                      else y\n                                               else 0) fibs\n\n*Main&gt; sumEvenFibsUpto 2370498572349582734598273495872349587234958723948752394857\n2805750129675962215536656398462489370528480907433875715844\n(0.01 secs, 324,392 bytes)\n</code></pre>\n"}], "owner": {"reputation": 4113, "user_id": 4601931, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4785004388498e25bc6794fe1d9d4a38?s=128&d=identicon&r=PG&f=1", "display_name": "user4601931", "link": "https://stackoverflow.com/users/4601931/user4601931"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 43883544, "answer_count": 3, "score": 4, "last_activity_date": 1494434555, "creation_date": 1494388143, "question_id": 43883290, "link": "https://stackoverflow.com/questions/43883290/how-does-haskell-compute-this-enormous-number-instantly", "title": "How does Haskell compute this enormous number instantly?", "body": "<p>I am beginning to learn Haskell, and one of the things I like to do when I'm learning a new language is to do <a href=\"https://projecteuler.net/\" rel=\"nofollow noreferrer\">Project Euler</a> problems as a supplement to my main reference material.</p>\n\n<p>I have come up with the following solution to the second problem of finding the sum of the even Fibonacci numbers less than four million:</p>\n\n<pre><code>fibs = 0 : 1 : zipWith (+) fibs (tail fibs)\nf :: Integer -&gt; Integer\nf n =\n  let evenFib = filter (\\n -&gt; n `mod` 2 == 0) fibs\n  in sum (takeWhile (&lt;n) evenFib)\n</code></pre>\n\n<p>This works great; <code>f 4000000</code> returns the correct answer.  It does so instantly.  Curious, I started typing in larger and larger numbers...</p>\n\n<pre><code>Prelude&gt; f 40000000\n19544084\nPrelude&gt; f 400000000000\n478361013020\nPrelude&gt; f 40000000000000000000000000000000\n13049874051046942401006156573274\nPrelude&gt; f 2370498572349582734598273495872349587234958723948752394857\n2805750129675962215536656398462489370528480907433875715844\n</code></pre>\n\n<p>Each of these values is returned immediately.  I have no way of guaranteeing the veracity of the last two answers, because my implementations in other languages don't work for numbers this large.</p>\n\n<p>So, my question is, what is Haskell doing here?  How is it returning these values instantaneously (whether they're actually correct or not)?  Furthermore, are these answers indeed correct, or is Haskell just making stuff up?  </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 1835, "user_id": 1337806, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/ff032a1a9ace832d80ad4cf65ccf8567?s=128&d=identicon&r=PG", "display_name": "sam boosalis", "link": "https://stackoverflow.com/users/1337806/sam-boosalis"}, "is_accepted": false, "score": 1, "last_activity_date": 1494384902, "creation_date": 1494384902, "answer_id": 43882865, "question_id": 43882725, "link": "https://stackoverflow.com/questions/43882725/type-family-equivalent-of-eq/43882865#43882865", "title": "Type Family Equivalent of `Eq`?", "body": "<p>Try adding <code>DataKinds</code> As a language extension (i.e. to the top of the file under a \"language\" pragma) as the error message suggests.</p>\n\n<p>I haven't watched the talk, but iiuc, <code>Defined</code> is just <code>Bool</code>, where <code>Yes</code> is <code>True</code>. So if you enable DataKinds, you can just use <code>IsEq a ~ 'True</code> (and the apostrophe before True just means \"this is a type\").</p>\n\n<p>Some background: what this extension does is \"raise\" every value of any algebraic datatypes (i.e. Declared with <code>data</code>, but not <code>GADTs</code>, iiuc) into its own type; and then raises each type into its own kind (a \"kind\" in Haskell is the \"type of types\"), i.e. not of \"kind *\" (pronounced \"kind star\"), which is the kind of normal Haskell values that exist at runtime. </p>\n\n<p>btw:</p>\n\n<p><code>[Bool] :: *</code> means that \"a list of liens is a type\". and <code>[] :: * -&gt; *</code> means that the type constructor for lists has kind \"type to type\", i.e. \"once you give List a single type, you get back a type\". </p>\n"}, {"comments": [{"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1494438984, "post_id": 43882997, "comment_id": 74833063, "body": "Thanks for this helpful answer, Alec! Could you please say a bit more as to what <code>IsEq a ~ Yes</code> means? Also, it appears to me that the <code>:kind! IsEq [Int]</code> is a type level computation. Does that mean that applying <code>IsEq</code> to an actual value, e.g. <code>[1,2,3]</code>, does not make sense?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1494454020, "post_id": 43882997, "comment_id": 74840847, "body": "@KevinMeredith <code>IsEq a ~ Yes</code> is an equality constraint - it holds only if the LHS and RHS are equal. Here, we want to define the constraint <code>Eq a</code> to hold iff <code>IsEq a</code> and <code>Yes</code> are the equal. And yes applying <code>IsEq</code> to an actual value like <code>[1,2,3]</code> makes no sense - <code>IsEq</code> is a type family (a limited type-level function), not a (value-level) function."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 6, "last_activity_date": 1494385827, "creation_date": 1494385827, "answer_id": 43882997, "question_id": 43882725, "link": "https://stackoverflow.com/questions/43882725/type-family-equivalent-of-eq/43882997#43882997", "title": "Type Family Equivalent of `Eq`?", "body": "<p>This is kind of neat, glad to have stumbled across this. For the interested, <a href=\"http://www.itu.dk/people/paba/pubs/files/serrano15haskell-slides.pdf\" rel=\"noreferrer\">here</a> is the slide deck and <a href=\"https://dspace.library.uu.nl/bitstream/handle/1874/320701/p129_serrano.pdf?sequence=1&amp;isAllowed=y\" rel=\"noreferrer\">here</a> is the paper. This is a usual case of needing some language extensions.</p>\n\n<pre><code>{-# LANGUAGE DataKinds, TypeFamilies, TypeOperators, ConstraintKinds #-}\n\ndata Defined = Yes | No\n\ntype family IsEq (a :: *) :: Defined\n\ntype Eq a = IsEq a ~ Yes\n</code></pre>\n\n<p>Then, the \"implementation\" of this are instances like</p>\n\n<pre><code>type instance IsEq () = Yes      -- '()' is an instance of 'Eq'\ntype instance IsEq Int = Yes     -- 'Int' is an instance of 'Eq'\ntype instance IsEq [a] = IsEq a  -- '[a]' is an instance of 'Eq' is 'a' is\n</code></pre>\n\n<p>You can \"try\" them out at GHCi:</p>\n\n<pre><code>ghci&gt; :kind! IsEq [Int]\nIsEq [Int] :: Defined\n= Yes\n</code></pre>\n\n<p>But the paper and slide deck doesn't really worry too much about actually providing an equality function. (It mentions storing it in a field of <code>Yes</code>). So, why is this interesting if it isn't even ready to provide class methods? Because</p>\n\n<ul>\n<li>it makes for a better mechanism than overlapping classes</li>\n<li>backtracking search is easier than with typeclasses</li>\n<li>it makes it possible to fail early with nice error message (encoded as a field in the <code>No</code> constructor)</li>\n</ul>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 2, "accepted_answer_id": 43882997, "answer_count": 2, "score": 3, "last_activity_date": 1494385827, "creation_date": 1494383794, "question_id": 43882725, "link": "https://stackoverflow.com/questions/43882725/type-family-equivalent-of-eq", "title": "Type Family Equivalent of `Eq`?", "body": "<p><a href=\"https://www.youtube.com/watch?v=WjJdwL-VjXg&amp;t=398s\" rel=\"nofollow noreferrer\">Type Families with Class</a> shows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/O7n2g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O7n2g.png\" alt=\"enter image description here\"></a></p>\n\n<p>As I incompletely understand, this slide shows 2 ways of implementing <code>Eq</code>: via a type class or type family.</p>\n\n<p>I'm familiar with type classes and thus implemented <code>MyEq</code>:</p>\n\n<pre><code>class MyEq a where \n    eq :: a -&gt; a -&gt; Bool\n</code></pre>\n\n<p>But, when I tried to define the <code>type family</code> version, it failed to compile:</p>\n\n<pre><code>data Defined = Yes | No\n\ntype family IsEq (a :: *) :: Defined    \n</code></pre>\n\n<p>due to:</p>\n\n<pre><code>TypeEq.hs:30:30: error:\n    \u2022 Type constructor \u2018Defined\u2019 cannot be used here\n        (Perhaps you intended to use DataKinds)\n    \u2022 In the kind \u2018Defined\u2019\n</code></pre>\n\n<p>Please explain how to implement the <code>type family</code> version of the <code>Eq</code> type class.\nAlso, it'd be helpful, please, to show an implementation of such a <code>type family</code> instance (if that's even the right word).</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 4, "creation_date": 1494373225, "post_id": 43881431, "comment_id": 74797778, "body": "Give a guess.   How many arguments does it take?  What do you think each argument means?  What do you think the type variables <code>u</code> and <code>a</code> represent?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1494373491, "post_id": 43881431, "comment_id": 74797844, "body": "<code>Tree a</code> has two constructors, having some types (which ones?). <code>u-&gt;u-&gt;u</code> and <code>a-&gt;u</code> are two functions, having related types to the constructor types. This is not a coincidence."}, {"owner": {"reputation": 31, "user_id": 4443206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qcvhw.jpg?s=128&g=1", "display_name": "Mina", "link": "https://stackoverflow.com/users/4443206/mina"}, "edited": false, "score": 0, "creation_date": 1494373661, "post_id": 43881431, "comment_id": 74797872, "body": "I am sorry English isn&#39;t my first language and I don&#39;t do guessing. As far as I can tell <code>(u -&gt; u -&gt; u)</code> is for the tree but I am unsure on what the <code>(a -&gt; u)</code> bit means"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1494373783, "post_id": 43881431, "comment_id": 74797900, "body": "When analyzing type signatures, think about what they <b>are</b> not what they <b>are for</b>. For example, what is <code>(u -&gt; u -&gt; u)</code>? Because of the <code>-&gt;</code> this just looks like a function, right? Also, it has nothing to do with <code>Tree a</code> because the type variables <code>a</code> and <code>u</code> are different."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1494373954, "post_id": 43881431, "comment_id": 74797941, "body": "p.s. You should answer try to the questions in luqui&#39;s comment."}, {"owner": {"reputation": 31, "user_id": 4443206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qcvhw.jpg?s=128&g=1", "display_name": "Mina", "link": "https://stackoverflow.com/users/4443206/mina"}, "edited": false, "score": 4, "creation_date": 1494374760, "post_id": 43881431, "comment_id": 74798112, "body": "<code>(u -&gt; u -&gt; u)</code> corresponds to the tree&#39;s branch and <code>(a -&gt; u)</code> corresponds to the tip, is that correct?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1494375103, "post_id": 43881431, "comment_id": 74798173, "body": "Yes, that&#39;s correct! So, the first function argument specifies &quot;what to do&quot; on branches, and the second function argument &quot;what to do&quot; on tips, roughly. Try to define the fold by induction on the tree argument, and you&#39;ll see there&#39;s only one reasonable way to make everything fit together."}, {"owner": {"reputation": 31, "user_id": 4443206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qcvhw.jpg?s=128&g=1", "display_name": "Mina", "link": "https://stackoverflow.com/users/4443206/mina"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494376190, "post_id": 43881431, "comment_id": 74798422, "body": "@chi Sorry I can&#39;t understand exactly what you mean by &quot;define the fold by induction on the tree argument&quot;, could you please explain that?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1494376821, "post_id": 43881431, "comment_id": 74798568, "body": "@Mina, it just means to define <code>foldT</code> by pattern matching on the constructors of the tree, possibly using <code>foldT</code> recursively."}], "answers": [{"tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 2, "last_activity_date": 1494403920, "last_edit_date": 1494403920, "creation_date": 1494403231, "answer_id": 43886688, "question_id": 43881431, "link": "https://stackoverflow.com/questions/43881431/haskell-type-declaration-explaining-the-fold/43886688#43886688", "title": "Haskell type declaration explaining the fold?", "body": "<p>It might be easier to break it up into small parts. </p>\n\n<p>In pseudo-Haskell, the signature is</p>\n\n<pre><code>foldT :: some-function-x -&gt; some-function-y -&gt; Tree a -&gt; u\n</code></pre>\n\n<p>and the name is <code>foldT</code>, therefore probably something \"summarizing\" all of the tree in a single result. It's also safe to guess that <code>Tree a</code> indicates a tree whose nodes' values are of type <code>a</code>.</p>\n\n<p>So <code>foldT</code> takes <code>some-function-x</code>, <code>some-function-y</code>, a <code>Tree a</code>, and summarizes the <code>Tree a</code> by a  <code>u</code>.</p>\n\n<p>How would we go about summarizing a tree? Presumably, we could recurse down to each leaf, and summarize each <code>a</code> value we encounter by a <code>u</code>. Backtracking in the recursion, an internal node now sees only <code>u</code> value in its descendants (and possibly itself), and it must summarize them to a single <code>u</code>.</p>\n\n<p>Indeed, <code>some-function-x</code> has the type <code>(u -&gt; u -&gt; u)</code>, that is, a function used by internal nodes to summarize two <code>u</code> values, and <code>some-function-y</code> has the type <code>(a -&gt; u)</code>, that is a function summarizing a node value by a <code>u</code> value.</p>\n\n<hr>\n\n<p><strong>Example</strong></p>\n\n<p>Suppose <code>a</code> is <code>String</code>, and so the tree is a tree of <code>String</code>s. Furthermore, the purpose of the fold is to \"summarize\" the tree by calculating the total length of the strings stored in it. Then </p>\n\n<ul>\n<li><p><code>u</code> could be <code>Int</code></p>\n\n<ul>\n<li><p><code>some-function-y</code> could be <a href=\"https://www.haskell.org/hoogle/?hoogle=length\" rel=\"nofollow noreferrer\"><code>length</code></a> - it summarizes individual strings.</p></li>\n<li><p><code>some-function-x</code> could be <code>(+)</code> - it summarizes two summaries into a single one.</p></li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 4443206, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qcvhw.jpg?s=128&g=1", "display_name": "Mina", "link": "https://stackoverflow.com/users/4443206/mina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 43886688, "answer_count": 1, "score": 2, "last_activity_date": 1494403920, "creation_date": 1494373162, "question_id": 43881431, "link": "https://stackoverflow.com/questions/43881431/haskell-type-declaration-explaining-the-fold", "title": "Haskell type declaration explaining the fold?", "body": "<p>I am new to the Haskell and currently studying about fold and unfold and their type declarations. I am struggling to understand what this type declaration means:</p>\n\n<pre><code>foldT :: (u -&gt; u -&gt; u) -&gt; (a -&gt; u) -&gt; Tree a -&gt; u\n</code></pre>\n\n<p>Any help would be highly appreciated!</p>\n"}, {"tags": ["haskell", "binary-tree", "fold"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494371913, "post_id": 43881237, "comment_id": 74797451, "body": "What error message are you getting?  And what do you think the error message means?"}, {"owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494372153, "post_id": 43881237, "comment_id": 74797503, "body": "I have updated my question to include the error message, it&#39;s got to be a problem with the types but I&#39;m unsure on how to approach solving it"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494372216, "post_id": 43881237, "comment_id": 74797524, "body": "Now make a guess as to what the error message means.  It&#39;s pointing you to a specific section of your code -- what could be wrong?  Post your guess.  (Showing effort like this both helps you figure it out and endears people to help you since it shows you have put thought into it)"}, {"owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494372376, "post_id": 43881237, "comment_id": 74797566, "body": "This isn&#39;t homework, it&#39;s exam revision"}, {"owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494377394, "post_id": 43881237, "comment_id": 74798695, "body": "so I&#39;m guessing that the lambda function is wrong as it&#39;s not compatible with <code>foldT</code>?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494379955, "post_id": 43881237, "comment_id": 74799248, "body": "right!  The <code>(u -&gt; u -&gt; u)</code> function takes two arguments and you&#39;ve given a lambda with three arguments.  How might you fix this?  Hint: What type is <code>u</code>?  (it&#39;s the same as the return type of your function <code>inorderT</code>)"}, {"owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494381423, "post_id": 43881237, "comment_id": 74799581, "body": "okay, so the type of  <code>u</code> is <code>Node</code>? I know this doesn&#39;t work but is it any closer: <code>foldT (\\x r -&gt; [x]: [r]) []</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "is_accepted": false, "score": 0, "last_activity_date": 1494384593, "creation_date": 1494384593, "answer_id": 43882823, "question_id": 43881237, "link": "https://stackoverflow.com/questions/43881237/doing-an-in-order-traversal-on-a-binary-tree-in-haskell-using-a-fold/43882823#43882823", "title": "Doing an in-order traversal on a binary tree in Haskell using a fold", "body": "<p>I have reconstructed the tree data type from the foldT definition. Check out it is not in the <code>Node a (Tree a) (Tree a)</code> form commonly used, so your  <code>(\\x l r -&gt; l ++ x ++ r)</code> is wrong.</p>\n\n<p>Check your code, and later see if this is what you need:</p>\n\n<pre><code>data Tree a = Tip a | Node (Tree a) (Tree a)\n\nfoldT :: (u -&gt; u -&gt; u) -&gt; (a -&gt; u) -&gt; Tree a -&gt; u\nfoldT f g (Tip a)    = g a\nfoldT f g (Node l r) = f (foldT f g l) (foldT f g r)\n\ninorderT :: Tree a -&gt; [a]\ninorderT = foldT (\\l r -&gt; l ++ r) (\\x -&gt; [x])\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 459, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1494384593, "creation_date": 1494371762, "last_edit_date": 1494372102, "question_id": 43881237, "link": "https://stackoverflow.com/questions/43881237/doing-an-in-order-traversal-on-a-binary-tree-in-haskell-using-a-fold", "title": "Doing an in-order traversal on a binary tree in Haskell using a fold", "body": "<p>I'm trying to implement an in-order traversal function using a modified version of fold in Haskell:</p>\n\n<pre><code>foldT :: (u -&gt; u -&gt; u) -&gt; (a -&gt; u) -&gt; Tree a -&gt; u\nfoldT f g (Tip a) = g a\nfoldT f g (Node l r) = f (foldT f g l) (foldT f g r)\n</code></pre>\n\n<p>But I'm getting stuck with how to implement the function, my attempt is:</p>\n\n<pre><code>inorderT :: Ord a =&gt; Tree a -&gt; [a]\ninorderT = foldT (\\x l r -&gt; l ++ x ++ r) []\n</code></pre>\n\n<p>Any help is greatly appreciated!</p>\n\n<p>Error messages:</p>\n\n<pre><code>Couldn't match expected type \u2018[a]\u2019 with actual type \u2018[a] -&gt; [a]\u2019\n\u2022 In the first argument of \u2018foldT\u2019, namely\n    \u2018(\\ x l r -&gt; l ++ x ++ r)\u2019\n  In the expression: foldT (\\ x l r -&gt; l ++ x ++ r) []\n  In an equation for \u2018inorderT\u2019:\n      inorderT = foldT (\\ x l r -&gt; l ++ x ++ r) []\n\u2022 Relevant bindings include\n    inorderT :: Tree a -&gt; [a]\n</code></pre>\n"}, {"tags": ["haskell", "abstract-syntax-tree", "recursion-schemes"], "answers": [{"tags": [], "owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "is_accepted": true, "score": 2, "last_activity_date": 1494376121, "creation_date": 1494376121, "answer_id": 43881801, "question_id": 43880957, "link": "https://stackoverflow.com/questions/43880957/factoring-out-recursion-in-a-complex-ast/43881801#43881801", "title": "Factoring out recursion in a complex AST", "body": "<p>If you've gone through the effort of to separate out the recursion in your data type, then you can just derive <code>Functor</code> and you're done. You don't need any fancy features to get the recursion scheme. (As a side note, there's no reason to parameterize the <code>Lit</code> data type.)</p>\n\n<p>The fold is:</p>\n\n<pre><code>newtype Fix f = In { out :: f (Fix f) }\n\ngfold :: (Functor f) =&gt; (f a -&gt; a) -&gt; Fix f -&gt; a\ngfold alg = alg . fmap (gfold alg) . out\n</code></pre>\n\n<p>To specify the algebra (the <code>alg</code> parameter), you need to do a case analysis against <code>ExprF</code>, but the alternative would be to have the fold have a dozen or more parameters: one for each data constructor. That wouldn't really save you much typing and would be much harder to read.  If you want (and this may require rank-2 types in general), you can package all those parameters up into a record and then you could use record update to update \"pre-made\" records that provide \"default\" behavior in various circumstances.  There's an old paper <a href=\"http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.36.627\" rel=\"nofollow noreferrer\">Dealing with Large Bananas</a> that takes an approach like this. What I'm suggesting, to be clear, is just wrapping the <code>gfold</code> function above with a function that takes a record, and passes in an algebra that will do the case analysis and call the appropriate field of the record for each case.</p>\n\n<p>Of course, you could use GHC Generics or <a href=\"https://hackage.haskell.org/packages/#cat:Generics\" rel=\"nofollow noreferrer\">the various \"generic/polytypic\" programming libraries</a> like Scrap Your Boilerplate instead of this. You are basically recreating what they do.</p>\n"}], "owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 1, "accepted_answer_id": 43881801, "answer_count": 1, "score": 2, "last_activity_date": 1494376121, "creation_date": 1494369728, "last_edit_date": 1494372581, "question_id": 43880957, "link": "https://stackoverflow.com/questions/43880957/factoring-out-recursion-in-a-complex-ast", "title": "Factoring out recursion in a complex AST", "body": "<p>For a side project I am working on I currently have to deal with an abstract syntax tree and transform it according to rules (the specifics are unimportant).</p>\n\n<p>The AST itself is nontrivial, meaning it has subexpressions which are restricted to some types only. (e.g. the operator <code>A</code> must take an argument which is of type <code>B</code> only, not any <code>Expr</code>. A drastically simplified reduced version of my datatype looks like this:</p>\n\n<pre><code>data Expr  = List [Expr]\n           | Strange Str\n           | Literal Lit\ndata Str   = A Expr\n           | B Expr\n           | C Lit\n           | D String\n           | E [Expr]\ndata Lit   = Int Int\n           | String String\n</code></pre>\n\n<p>My goal is to factor out the explicit recursion and rely on recursion schemes instead, as demonstrated in <a href=\"https://www.schoolofhaskell.com/user/bartosz/understanding-algebras\" rel=\"nofollow noreferrer\">these</a> <a href=\"http://blog.sumtypeofway.com/an-introduction-to-recursion-schemes/\" rel=\"nofollow noreferrer\">two</a> excellent blog posts, which provide very powerful general-purpose tools to operate on my AST. Applying the necessary factoring, we end up with:</p>\n\n<pre><code>data ExprF a = List [a]\n             | Strange (StrF a)\n             | Literal (LitF a)\ndata StrF a  = A a\n             | B a\n             | C (LitF a)\n             | D String\n             | E [a]\ndata LitF a  = Int Int\n             | String String\n</code></pre>\n\n<p>If I didn't mess up, <code>type Expr = Fix ExprF</code> should now be isomorphic to the previously defined <code>Expr</code>.</p>\n\n<p>However, writing <code>cata</code> for these cases becomes rather tedious, as I have to pattern match <code>B a :: StrF a</code> inside of an <code>Str :: ExprF a</code> for <code>cata</code> to be well-typed. For the entire original AST this is unfeasible.</p>\n\n<p>I stumbled upon <a href=\"http://www.timphilipwilliams.com/posts/2013-01-16-fixing-gadts.html\" rel=\"nofollow noreferrer\">fixing GADTs</a>, which seems to me like it is a solution to my problem, however the user-unfriendly interface of the duplicated higher-order type classes etc. is quite the unneccessary boilerplate.</p>\n\n<p>So, to sum up my questions:</p>\n\n<ol>\n<li>Is rewriting the AST as a GADT the correct way to go about this?</li>\n<li>If yes, how could I transform the example into a well-working version? On a second note, is there better support for higher kinded <code>Functor</code>s in GHC now?</li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1494365060, "post_id": 43880083, "comment_id": 74795184, "body": "You need to include what errors you&#39;re getting."}, {"owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1494365233, "post_id": 43880083, "comment_id": 74795267, "body": "sorry, I&#39;ve now updated"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1494365313, "post_id": 43880083, "comment_id": 74795311, "body": "Well, firstly you should have a type signature for <code>select</code> so it&#39;s not forced to infer the type. That alone should make the errors a little clearer."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1494365388, "post_id": 43880083, "comment_id": 74795349, "body": "And unfold doesn&#39;t return a Maybe, does it? I thought it just returned a list."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494365804, "post_id": 43880083, "comment_id": 74795529, "body": "<code>min</code> has two arguments, <code>minimum</code> has one argument (a list)."}, {"owner": {"reputation": 69864, "user_id": 444991, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c57f597182ae324d8eb33b935f7d38af?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/444991/matt"}, "edited": false, "score": 0, "creation_date": 1496870285, "post_id": 43880083, "comment_id": 75844304, "body": "Please do not edit your question such that it invalidates existing answers. Instead, create a new question."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494366422, "post_id": 43880216, "comment_id": 74795784, "body": "sorry, realised that I wasn&#39;t meant to include that type declaration as I knew it was wrong. have updated my code and have new error messages"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494366660, "post_id": 43880216, "comment_id": 74795852, "body": "@Sophie Add proper signatures to both functions. It&#39;s saying it can&#39;t properly figure out what types you intend since there are many possible overloads. <code>minimum</code> requires that it&#39;s argument be a list of orderable elements, but you haven&#39;t specified that. Add a <code>Ord</code> type constraint to <code>select</code>."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494366775, "post_id": 43880216, "comment_id": 74795893, "body": "Really, the signature should be one of the first things you write. You need to know what types your function takes a returns. Once you that written, all other errors become much more obvious."}, {"owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494366921, "post_id": 43880216, "comment_id": 74795950, "body": "Sorry but <code>select</code> isn&#39;t a separate function, <code>select</code> is within the function <code>unfoldSort</code>"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494367010, "post_id": 43880216, "comment_id": 74795988, "body": "@Sophie If the code you posted is your real code, then <code>select</code> is in fact a separate function. Even if it was defined in a where/let binding though, you can still add a type signature"}, {"owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494367253, "post_id": 43880216, "comment_id": 74796069, "body": "I really don&#39;t think that <code>select</code> is a separate function. If it is, can you explain to me how my code defines <code>select</code> as a separate function to <code>unfoldSort</code> please?"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494367434, "post_id": 43880216, "comment_id": 74796143, "body": "@Sophie <code>unfoldSort = unfoldr select</code> defines the <code>unfoldSort</code> function. <code>select [] = Nothing</code> and the line below it define <code>select</code>. Where&#39;s the confusion stemming from?"}, {"owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494367707, "post_id": 43880216, "comment_id": 74796243, "body": "Okay, so this is what happens when I add in the type signature:  <code>Could not deduce (Ord a0)       from the context: Ord a         bound by the type signature for:                    select :: Ord a =&gt; [t] -&gt; [t]         at &#47;Users&#47;Sophie&#47;Desktop&#47;ReasoningAboutFunctionalPrograms&#47;13032&zwnj;&#8203;046.hs:470:11-29       The type variable \u2018a0\u2019 is ambiguous     \u2022 In the ambiguity check for \u2018select\u2019       To defer the ambiguity check to use sites, enable AllowAmbiguousTypes       In the type signature:         select :: Ord a =&gt; [t] -&gt; [t]</code>"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494367958, "post_id": 43880216, "comment_id": 74796319, "body": "@Sophie You added a type constraint but you&#39;re never using it. <code>select</code> should accept a list of orderables, since that&#39;s what <code>minimum</code> requires. In your signature, you declared the type constraint, then used <code>t</code> instead."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494368023, "post_id": 43880216, "comment_id": 74796338, "body": "@Sophie And please update the question with your code and errors. It&#39;s very hard to read in the comments."}, {"owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494368557, "post_id": 43880216, "comment_id": 74796483, "body": "I have updated, also aware the type declarations are wrong (I am struggling with understanding them fully as I&#39;m still learning Haskell), and the unfoldr type declarations are now really confusing me"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494368723, "post_id": 43880216, "comment_id": 74796550, "body": "@Sophie I hate to say this, but it might be a good idea to take a step back. To use Haskell, you <i>really</i> need to have a good grasp of its type system. You may find that it&#39;s more beneficial to write some simpler programs first. Write simple functions with different signatures until you have a good grasp. If you look on my profile, I have my email address posted. You can email me there I&#39;d you want general help. This question is becoming increasingly offtopic for the site though."}, {"owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494369321, "post_id": 43880216, "comment_id": 74796712, "body": "I&#39;d say I know enough about types, I had just made a small mistake and now have my code working."}], "tags": [], "owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "is_accepted": false, "score": 2, "last_activity_date": 1494365984, "last_edit_date": 1494365984, "creation_date": 1494365623, "answer_id": 43880216, "question_id": 43880083, "link": "https://stackoverflow.com/questions/43880083/selection-sort-in-haskell-using-unfoldr/43880216#43880216", "title": "Selection Sort in Haskell using unfoldr", "body": "<p>You're saying that <code>unfoldSort</code> returns a <code>Maybe</code> when you say:</p>\n\n<pre><code>unfoldSort :: t -&gt; Maybe (t, t)\n</code></pre>\n\n<p>but is that really true? Note that the return type of <code>unfoldSort</code> <em>must</em> be the same as the return type of <code>unfoldr</code> since you're just returning whatever it gives you.</p>\n\n<p><code>unfoldr</code> has the signature:</p>\n\n<pre><code>unfoldr :: (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]\n</code></pre>\n\n<p>Note it returns a list, not a <code>Maybe</code>, which means your <code>unfoldSort</code> must also just return a list. </p>\n\n<p>Change your signature so it returns a list, not a <code>Maybe</code>. </p>\n"}], "owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496870273, "creation_date": 1494364984, "last_edit_date": 1496870273, "question_id": 43880083, "link": "https://stackoverflow.com/questions/43880083/selection-sort-in-haskell-using-unfoldr", "title": "Selection Sort in Haskell using unfoldr", "body": "<p>I'm trying to implement a selection sort in Haskell using <code>unfoldr</code> but my function keeps throwing type errors and I'm unsure how to fix it.</p>\n\n<p>My code for the selection sort:</p>\n\n<pre><code>unfoldSort = unfoldr select\nselect [] = Nothing\nselect xs = Just (m, delete m xs)\n   where m = minimum xs\n</code></pre>\n\n<p>This is the error message I get:</p>\n\n<pre><code>\u2022 Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018select\u2019\n  prevents the constraint \u2018(Ord a0)\u2019 from being solved.\n  Relevant bindings include\n    unfoldSort :: [a0] -&gt; [a0]\n  Probable fix: use a type annotation to specify what \u2018a0\u2019 should be.\n  These potential instances exist:\n    instance (Ord b, Ord a) =&gt; Ord (Either a b)\n      -- Defined in \u2018Data.Either\u2019\n    instance Ord Ordering -- Defined in \u2018GHC.Classes\u2019\n    instance Ord Integer\n      -- Defined in \u2018integer-gmp-1.0.0.1:GHC.Integer.Type\u2019\n    ...plus 23 others\n    ...plus 38 instances involving out-of-scope types\n    (use -fprint-potential-instances to see them all)\n\u2022 In the first argument of \u2018unfoldr\u2019, namely \u2018select\u2019\n  In the expression: unfoldr select\n  In an equation for \u2018unfoldSort\u2019: unfoldSort = unfoldr select\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 3, "creation_date": 1494358924, "post_id": 43878543, "comment_id": 74792014, "body": "Are you trying to define <code>inorderFold</code> using <code>foldB</code>? If so, you just need <code>inorderFold = foldB (\\c l r -&gt; l ++ [c] ++ r) []</code>"}, {"owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1494360142, "post_id": 43878543, "comment_id": 74792718, "body": "thanks, code is working now"}], "owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 350, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1494358763, "creation_date": 1494358763, "question_id": 43878543, "link": "https://stackoverflow.com/questions/43878543/in-order-traversal-of-binary-trees-using-fold-in-haskell", "title": "In-order traversal of binary trees using fold in Haskell", "body": "<p>I'm trying to programme an in-order traversal of a binary tree in Haskell using a fold - which I've defined as:</p>\n\n<pre><code>foldB :: (x -&gt; u -&gt; u -&gt; u) -&gt; u -&gt; BTree x -&gt; u\nfoldB f a Nil = a\nfoldB f a (BNode x l r) = f x (foldB f a l) (foldB f a r)\n</code></pre>\n\n<p>I've defined an in-order traversal of a binary tree:</p>\n\n<pre><code>inorder :: Ord a =&gt; BTree a -&gt; [a]\ninorder Nil = []\ninorder (BNode a x y) = inorder x ++ [a] ++ inorder y\n</code></pre>\n\n<p>But I can't seem to get them both to work together:</p>\n\n<pre><code>inorderFold :: Ord a =&gt; BTree a -&gt; [a]\ninorderFold = foldB inorder []\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1494374207, "post_id": 43880913, "comment_id": 74797977, "body": "When you write <code>((==) Red)</code>, the inner parentheses are now redundant right? (I am asking for my own sake since I am relatively new to Haskell.)"}, {"owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1494376061, "post_id": 43880913, "comment_id": 74798394, "body": "@Code-Apprentice No they are not redundant. Rather, removing the parentheses uses a special syntax feature called operator sections. <code>(==) Red</code> is equivalent to <code>(Red ==)</code> (a left-section). <code>(== Red)</code> is equivalent to <code>\\x -&gt; x == Red</code> or <code>flip (==) Red</code>. To go from <code>(==) Red</code> to <code>(== Red)</code> directly we have to realise that <code>==</code> is symmetric. If you do that, then <code>((==) Red)</code> becomes <code>((== Red))</code> and then clearly a set of parentheses is redundant."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1494376181, "post_id": 43880913, "comment_id": 74798420, "body": "So <code>((==) Red)</code> is partial function application which applies the function <code>(==)</code> to the argument <code>Red</code>. In this particular case since <code>(==)</code> is symmetric, we get the same behavior if you remove the inner parentheses and use a section. However, in general, the parentheses might be necessary for a non-symmetric operator. Is that correct?"}, {"owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1494376518, "post_id": 43880913, "comment_id": 74798486, "body": "That is true but it is a strange way to say the parentheses are redundant. Usually we are talking about precedence when we say that. For example, <code>1 + (2 * 3)</code> has redundant parentheses because <code>*</code> precedes <code>+</code>. Your case is different because by removing the parentheses we are actually using a completely different notation."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1494376886, "post_id": 43880913, "comment_id": 74798585, "body": "I see. In the example <code>1+(2*3)</code>, the parse tree is the same with or without the parentheses. However, <code>((==) Red)</code> parses differently when the inner parentheses are removed. Thanks for helping me to understand this."}], "tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": false, "score": 1, "last_activity_date": 1494369496, "creation_date": 1494369496, "answer_id": 43880913, "question_id": 43878528, "link": "https://stackoverflow.com/questions/43878528/check-and-see-if-all-elements-of-a-list-match-a-parameter/43880913#43880913", "title": "Check and see if all elements of a list match a parameter", "body": "<p>There are many mistakes and misunderstandings here. I recommend reading any of the <a href=\"https://wiki.haskell.org/Learning_Haskell\" rel=\"nofollow noreferrer\">introductory Haskell materials</a> to strengthen your basic understanding of the language. I will answer the question directly nonetheless.</p>\n\n<p><code>generateboard</code> looks great.</p>\n\n<p>You are right to think <code>all :: Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool</code> will help us define <code>allRed</code>. If the type is confusing you can instead think of it as <code>(a -&gt; Bool) -&gt; [a] -&gt; Bool</code>. <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:all\" rel=\"nofollow noreferrer\">The documentation says</a>:</p>\n\n<blockquote>\n  <p>Determines whether all elements of the [list] satisfy the predicate.</p>\n</blockquote>\n\n<p>To use <code>all</code> we need a predicate (a function) with type <code>a -&gt; Bool</code> and a list of type <code>[a]</code>. We know what the predicate needs to be:</p>\n\n<pre><code>\\x -&gt; x == Red\n</code></pre>\n\n<p>Another way to write this is:</p>\n\n<pre><code>(==) Red\n</code></pre>\n\n<p>The predicate has type <code>Color -&gt; Bool</code> and so our list must then have type <code>[Color]</code>. However, we have a list of type <code>[[Color]]</code>. There are two ways I can see to go about this.</p>\n\n<p>The simpler idea is to observe that the board structure is irrelevant if all we care about is the cells. Therefore, we can flatten the structure with <code>concat :: [[a]] -&gt; [a]</code>. Then our solution is thus:</p>\n\n<pre><code>allRed xs = all ((==) Red) (concat xs)\n</code></pre>\n\n<p>Which is also written:</p>\n\n<pre><code>allRed = all ((==) Red) . concat\n</code></pre>\n\n<p>Another solution is to observe that if all rows are red then the whole board must be red. This solution is:</p>\n\n<pre><code>allRed xs = all (all ((==) Red)) xs\n</code></pre>\n\n<p>Which is also written:</p>\n\n<pre><code>allRed = all (all ((==) Red))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 1, "last_activity_date": 1494369616, "creation_date": 1494369616, "answer_id": 43880940, "question_id": 43878528, "link": "https://stackoverflow.com/questions/43878528/check-and-see-if-all-elements-of-a-list-match-a-parameter/43880940#43880940", "title": "Check and see if all elements of a list match a parameter", "body": "<p>First, the <code>all</code> function:</p>\n\n<pre><code>all :: (a -&gt; Bool) -&gt; [a] -&gt; Bool\nall p xs = ...\n</code></pre>\n\n<p>takes a function <code>p</code> representing a property and a list <code>xs</code> and tests if <code>p x</code> is true (i.e., if <code>x</code> has property <code>p</code>) for every element <code>x</code> of <code>xs</code>.  (For example, <code>all even [2,4,7]</code> checks if all elements of the given list are even, and it returns <code>False</code> because <code>even 7</code> equals <code>False</code>.)  So, to use <code>all</code>, you need <em>two arguments</em> -- a list of items to check, and a function that checks one item.</p>\n\n<p>Second, when faced with the problem of processing a data structure in Haskell (in this case <code>[[Color]]</code>), an excellent rule of thumb is to the deconstruct the structure from the outside in, using one function for each level of structure.  You have an (outer) list of (inner) lists of colors, so start with the outer list, the list of rows.</p>\n\n<p>How would you write a function that checks if <em>all</em> the rows in the outer list satisfy the property that they \"contain only red colors\"?  Or, to put it more simply, how would you write this function using <code>all</code> if you already had a helper function <code>redRow</code> that expressed the property of a row having only red colors?</p>\n\n<pre><code>redRow :: [Color] -&gt; Bool\nredRow row = ...\n</code></pre>\n\n<p>If you can write <code>allRed board</code> using <code>all</code>, <code>board</code>, and <code>redRow</code>, you'll have reduced the problem to writing the definition of <code>redRow</code>, which operates on a simpler data structure, an (inner) list of colors.</p>\n\n<p>To write <code>redRow</code>, you should likewise be able to use <code>all</code> again with a function expressing the property of a color being red:</p>\n\n<pre><code>isRed :: Color -&gt; Bool\nisRed col = ...\n</code></pre>\n\n<p>(or using an equivalent lambda or \"section\" directly).</p>\n\n<p>In this case, another approach is possible, too -- you could use <code>concat</code> to \"flatten\" the outer and inner list together and then tackle the easier problem of checking if all colors in a big long list are red.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6059507"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 960, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495306660, "creation_date": 1494358728, "last_edit_date": 1495306660, "question_id": 43878528, "link": "https://stackoverflow.com/questions/43878528/check-and-see-if-all-elements-of-a-list-match-a-parameter", "title": "Check and see if all elements of a list match a parameter", "body": "<p>I want to make a function that checks to see if each row of the board for the  <a href=\"http://mathcs.pugetsound.edu/~tmullen/pages/bertspel/\" rel=\"nofollow noreferrer\">Bert Bos puzzle</a> is red one row at a time, but conceptually I'm having a hard time with this. Initially I make the board with all blue squares, but once the squares have been flipped with a flip function, the allRed function should be able to tell if the row is all red or not.  Each row is represented by a list of colors, either Blue or Red</p>\n\n<p>I know I should be using the <code>all</code> function, but I'm having some problems actually writing it out for my situation</p>\n\n<p>Here is what I have so far: </p>\n\n<pre><code>generateboard :: Int -&gt; [[Color]]\ngenerateboard n = replicate n (replicate n Blue)\n\n\nallRed :: [[Color]] -&gt; Bool\nlet board = generateboard\nallRed board = []\nallRed board = all ([x:_ | x &lt;- board, x == Red]) \n  allRed board \n</code></pre>\n"}, {"tags": ["haskell", "arrows"], "comments": [{"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1494351617, "post_id": 43874282, "comment_id": 74787810, "body": "<code>id . x = x = x . id</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494352794, "post_id": 43874282, "comment_id": 74788426, "body": "I think the last <code>((id . g) x)</code> in the teaser is correct but misleading, it should read <code>((g . id) x)</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494354650, "post_id": 43874282, "comment_id": 74789496, "body": "Also keep in mind that by <code>(g . f)</code> the teaser means multivalued composition, which differs from plain Haskell composition operator <code>(.)</code>. Multivalued composition is something like <code>\\x -&gt; f x &gt;&gt;= g</code> or <code>concatMap g . f</code>. This surely does not help understanding it."}], "owner": {"reputation": 249, "user_id": 4643591, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206103105435558/picture?type=large", "display_name": "Marius Catalin", "link": "https://stackoverflow.com/users/4643591/marius-catalin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1494344754, "creation_date": 1494344611, "last_edit_date": 1494344754, "question_id": 43874282, "link": "https://stackoverflow.com/questions/43874282/arrows-tutorial-teaser", "title": "Arrows tutorial teaser", "body": "<p>I can't understand the code from the <a href=\"https://wiki.haskell.org/Arrow_tutorial#A_Teaser\" rel=\"nofollow noreferrer\">teaser in the HaskellWiki arrows tutorial</a>:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    let\n        prepend x = arr (x ++)\n        append  x = arr (++ x)\n        withId  t = returnA &lt;+&gt; t\n        xform = (withId $ prepend \"&lt;\") &gt;&gt;&gt;\n                (withId $ append \"&gt;\") &gt;&gt;&gt;\n                (withId $ ((prepend \"!\") &gt;&gt;&gt; (append \"!\")))\n        xs = [\"test\", \"foobar\"] &gt;&gt;= (runKleisli xform)\n    mapM_ putStrLn xs\n</code></pre>\n\n<p>where</p>\n\n<pre><code>   (withId f) &gt;&gt;&gt; (withId g) =\n   (returnA &lt;+&gt; f) &gt;&gt;&gt; (returnA &lt;+&gt; g) =\n   ((arr id) &lt;+&gt; f) &gt;&gt;&gt; ((arr id) &lt;+&gt; g)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>   ((id . id) x) ++ ((id . f) x) ++ ((id . g) x) ++ ((g . f) x) =\n   x ++ (f x) ++ (g x) ++ ((g . f) x)\n</code></pre>\n\n<p>In the last two lines I can't figure out where exactly the distributive proprieties of composition (.) come from</p>\n"}, {"tags": ["haskell", "haskell-spock"], "answers": [{"comments": [{"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "reply_to_user": {"reputation": 2795, "user_id": 7978068, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/374ccc08f4ce2a4b5f59a0551a5eadee?s=128&d=identicon&r=PG&f=1", "display_name": "Jodimoro", "link": "https://stackoverflow.com/users/7978068/jodimoro"}, "edited": false, "score": 0, "creation_date": 1494420341, "post_id": 43878856, "comment_id": 74819730, "body": "I understood your question, just thought you are on the wrong way. If you still want to persist, you can access the <code>HashMap</code> value using <code>let myVal = (a :: Object) ! &quot;some_key&quot;</code> for example."}], "tags": [], "owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "is_accepted": false, "score": 0, "last_activity_date": 1494359932, "creation_date": 1494359932, "answer_id": 43878856, "question_id": 43873697, "link": "https://stackoverflow.com/questions/43873697/how-to-create-actionctxt-in-spock/43878856#43878856", "title": "How to create &quot;ActionCtxT&quot; in Spock?", "body": "<pre><code>jsonBody' :: (MonadIO m, FromJSON a) =&gt; ActionCtxT ctx m a\n</code></pre>\n\n<p><code>jsonBody'</code> gives you way to parse the body of the request using an Aeson <code>FromJSON</code> instance.</p>\n\n<p>It's usually easier to use Aeson by mapping your JSON data to a custom data type, and then providing a <code>FromJSON</code> instance for that data type.</p>\n\n<p>Paraphrasing the example you can find in the Aeson documentation,\nIf your JSON looks like this :</p>\n\n<pre><code> { \"name\": \"Joe\", \"age\": 12 }\n</code></pre>\n\n<p>Then you can create a data type :</p>\n\n<pre><code>data Person = Person {\n      name :: Text\n    , age  :: Int\n    } deriving Show\n</code></pre>\n\n<p>and manually create the FromJSON instance:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\ninstance FromJSON Person where\n    parseJSON (Object v) = Person &lt;$&gt;\n                           v .: \"name\" &lt;*&gt;\n                           v .: \"age\"\n    -- A non-Object value is of the wrong type, so fail.\n    parseJSON _          = empty\n</code></pre>\n\n<p>Your could alternatively automatically derive the FromJSON instance from your data type.</p>\n"}], "owner": {"reputation": 2795, "user_id": 7978068, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/374ccc08f4ce2a4b5f59a0551a5eadee?s=128&d=identicon&r=PG&f=1", "display_name": "Jodimoro", "link": "https://stackoverflow.com/users/7978068/jodimoro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494359932, "creation_date": 1494343025, "question_id": 43873697, "link": "https://stackoverflow.com/questions/43873697/how-to-create-actionctxt-in-spock", "title": "How to create &quot;ActionCtxT&quot; in Spock?", "body": "<p>I want to extract a value from a json object. And I have this:</p>\n\n<pre><code>    post \"/test\" $ do\n        a &lt;- jsonBody'\n        let b = show (a :: Object) -- works well\n        myVal &lt;- (a :: Object) .: \"some_key\" -- error\n        text \"test123\"\n</code></pre>\n\n<p>And the error:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018aeson-1.0.2.1:Data.Aeson.Types.Internal.Parser\u2019\n                     with \u2018ActionCtxT () (WebStateM () MySession MyAppState)\u2019\n      Expected type: ActionCtxT () (WebStateM () MySession MyAppState) a0\n        Actual type: aeson-1.0.2.1:Data.Aeson.Types.Internal.Parser a0\n    \u2022 In a stmt of a 'do' block:\n        myVal &lt;- (a :: Aeson.Object) Aeson..: \"some_key\"\n</code></pre>\n\n<p>I know what it means: the line with myVal must return something of type ActionCtxT as well as all other lines. Or a pure value. Thus, how to fix it? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1494340348, "post_id": 43872546, "comment_id": 74780446, "body": "Related/possible duplicate of <a href=\"http://stackoverflow.com/questions/357956/explanation-of-tying-the-knot\" title=\"explanation of tying the knot\">stackoverflow.com/questions/357956/&hellip;</a>"}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1494340356, "post_id": 43872546, "comment_id": 74780454, "body": "Also see: <a href=\"https://wiki.haskell.org/Tying_the_Knot\" rel=\"nofollow noreferrer\">wiki.haskell.org/Tying_the_Knot</a>"}, {"owner": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 0, "creation_date": 1494340373, "post_id": 43872546, "comment_id": 74780466, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/11280924/how-does-the-failure-function-used-in-kmp-algorithm-work\">How does the Failure function used in KMP algorithm work?</a>"}], "owner": {"reputation": 269, "user_id": 1084637, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/745239e23061d746727436ec06e5dd2e?s=128&d=identicon&r=PG", "display_name": "asp5", "link": "https://stackoverflow.com/users/1084637/asp5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496680478, "creation_date": 1494340070, "last_edit_date": 1496680478, "question_id": 43872546, "link": "https://stackoverflow.com/questions/43872546/kmp-substring-search-haskell", "title": "KMP substring search Haskell", "body": "<p>This needs to be marked a dup of \"<a href=\"https://stackoverflow.com/questions/16694306/knuth-morris-pratt-algorithm-in-haskell\">this</a>\". if anyone can close this by marking it a dup would be great. Thanks.</p>\n\n<p>After implementing KMP in C++ (imperative style), I'm now trying to implement it in Haskell. I came across this <a href=\"https://www.twanvl.nl/blog/haskell/Knuth-Morris-Pratt-in-Haskell\" rel=\"nofollow noreferrer\">post</a>. I would like to understand how the \"pre-processing\" step of KMP is being done. </p>\n\n<pre><code>makeTable' []     failure = KMP True failure\nmakeTable' (x:xs) failure = KMP False test\n   where  test  c = if c == x then success else failure c\n          success = makeTable' xs (next (failure x))\n</code></pre>\n\n<p>I'm not able to understand how the table is being built. Especially with <code>table</code> being defined by calling it self <code>(const table)</code>. Where are the values of the table being carried? </p>\n\n<pre><code>makeTable :: Eq a =&gt; [a] -&gt; KMP a\nmakeTable xs = table\n   where table = makeTable' xs (const table)\n</code></pre>\n\n<p>Appreciate any help with understanding this. Please give me any pointers to read up on, that will be helpful in understanding this piece of Haskell code.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["list", "haskell", "polymorphism"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1494336879, "post_id": 43871225, "comment_id": 74777783, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/33446759/understanding-haskells-rankntypes\">Understanding Haskell&#39;s RankNTypes</a>"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1494340539, "post_id": 43871225, "comment_id": 74780610, "body": "Turn on <code>RankNTypes</code> and add the following type signature: <code>sum :: Num b =&gt; (forall a. [a] -&gt; b) -&gt; [c] -&gt; [d] -&gt; b</code>. Now, <code>sum length [1,2] [&#39;a&#39;,&#39;b&#39;]</code> returns <code>2</code>."}, {"owner": {"reputation": 8555, "user_id": 638028, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/xj2Hg.png?s=128&g=1", "display_name": "Klitos Kyriacou", "link": "https://stackoverflow.com/users/638028/klitos-kyriacou"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1494341046, "post_id": 43871225, "comment_id": 74780998, "body": "@Alec why 2? Shouldn&#39;t it be 4?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 0, "creation_date": 1494342016, "post_id": 43871225, "comment_id": 74781744, "body": "@AmiTavory You are calling <code>putStrLn :: String -&gt; IO ()</code> instead of <code>print :: Show a =&gt; a -&gt; IO ()</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 8555, "user_id": 638028, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/xj2Hg.png?s=128&g=1", "display_name": "Klitos Kyriacou", "link": "https://stackoverflow.com/users/638028/klitos-kyriacou"}, "edited": false, "score": 0, "creation_date": 1494342024, "post_id": 43871225, "comment_id": 74781750, "body": "@KlitosKyriacou Apologies, yes."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1494344895, "post_id": 43871225, "comment_id": 74783801, "body": "@Alec Right you are. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 23, "user_id": 7986473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e49a289483decf6afcbca54f5407aa1f?s=128&d=identicon&r=PG&f=1", "display_name": "figasso", "link": "https://stackoverflow.com/users/7986473/figasso"}, "edited": false, "score": 0, "creation_date": 1494358622, "post_id": 43873449, "comment_id": 74791846, "body": "@figasso No problem. Feel free to accept the answer if it solved your problem."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1494378441, "post_id": 43873449, "comment_id": 74798922, "body": "It&#39;s worth noting that this doesn&#39;t work in general, for example if your function was <code>map succ</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1494378574, "post_id": 43873449, "comment_id": 74798953, "body": "@Clinton would you care to elaborate what <code>succ</code> would have to be? I&#39;m not sure I understand..."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1494378649, "post_id": 43873449, "comment_id": 74798969, "body": "The enum succ, but it actually doesn&#39;t work in your case, I&#39;ll detail in an answer below."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 5, "last_activity_date": 1494342383, "creation_date": 1494342383, "answer_id": 43873449, "question_id": 43871225, "link": "https://stackoverflow.com/questions/43871225/haskell-calling-a-function-with-different-types-of-lists/43873449#43873449", "title": "haskell: calling a function with different types of lists", "body": "<p>May as well flesh out my comment in an answer. The usual signature one may be tempted to give is</p>\n\n<pre><code>sum :: Num b =&gt; ([a] -&gt; b) -&gt; [a] -&gt; [a] -&gt; b\nsum f l1 l2 = f l1 + f l2\n</code></pre>\n\n<p>The problem here is that the two lists must have the same type, which must be the input type of the function. The solution is to tell GHC that the function actually has the more general type <code>forall a. [a] -&gt; b</code>, which means that we can pick multiple possibly <em>different</em> <code>a</code> instantiations and they all produce the same <code>b</code>.</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\nsum' :: Num b =&gt; (forall a. [a] -&gt; b) -&gt; [c] -&gt; [d] -&gt; b\nsum' f l1 l2 = f l1 + f l2\n\nmain = print $ sum' length [1,2] ['a','b']\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494380251, "post_id": 43882245, "comment_id": 74799288, "body": "Regular <code>length</code> works, because <code>b</code> is chosen by the caller, so we can very well choose it to be <code>Int</code>"}], "tags": [], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "is_accepted": false, "score": 1, "last_activity_date": 1494381157, "last_edit_date": 1495540026, "creation_date": 1494379967, "answer_id": 43882245, "question_id": 43871225, "link": "https://stackoverflow.com/questions/43871225/haskell-calling-a-function-with-different-types-of-lists/43882245#43882245", "title": "haskell: calling a function with different types of lists", "body": "<p>There's no general way to do this at the moment unfortunately. You could try like this <a href=\"https://stackoverflow.com/a/43873449\">previous answer</a> suggested as follows: </p>\n\n<pre><code>sum' :: Num b =&gt; (forall a. [a] -&gt; b) -&gt; [c] -&gt; [d] -&gt; b\nsum' f l1 l2 = f l1 + f l2\n</code></pre>\n\n<p>And whilst this works with <code>length</code>, it doesn't really work with much else.</p>\n\n<p>The issue is that the type signature in this answer <code>Num b =&gt; forall a. [a] -&gt; b</code>. That means your function must work for all types of lists, and the only sensible function from <code>Num b =&gt; forall a. [a] -&gt; b</code> is <code>length</code>. If you think there's another feel free to give me an example, but I suspect all the other examples are either variations of length or silly ones that return a constant. </p>\n\n<p>And if <code>length</code> is the only sensible argument for <code>sum'</code>, then it's silly to define <code>sum'</code>, you might as well define <code>sumLength</code> like follows</p>\n\n<pre><code>sumLength :: Num b =&gt; [c] -&gt; [d] -&gt; b\nsumLength l1 l2 = genericLength l1 + genericLength l2\n</code></pre>\n\n<p>Indeed, lets define the following:</p>\n\n<pre><code>g :: Enum a =&gt; [a] -&gt; Int\ng = (foldl' 0 (+)) . (map fromEnum)\n</code></pre>\n\n<p>This is a weird probably useless function, but it does something non-trivial. It converts all the values to their <code>Enum</code> <code>int</code> representation and sums them and spits out an Integer.</p>\n\n<p>So <code>sum' g l1 l2</code> should work, but it doesn't. To get this to work, you'd have to define a new function:</p>\n\n<pre><code>sum'' :: Enum c, Enum d =&gt; (Enum a =&gt; forall a. [a]) -&gt; [c] -&gt; [d] -&gt; Int\nsum'' f l1 l2 = f l1 + f l2\n</code></pre>\n\n<p>And indeed, too use any function with different constraints, you'll have to define a new version of <code>sum</code>. </p>\n\n<p>So really, no, there's no way to answer your question similarly.</p>\n\n<p>I recognised this problem and created the package <a href=\"https://hackage.haskell.org/package/polydata-0.1.0.0/docs/Data-Poly.html\" rel=\"nofollow noreferrer\">polydata</a>, which you can check out on hackage (needs some clearer documentation I admit).</p>\n\n<p>It does allow you to make functions which accept polymorphic functions that you can apply to different types, like so:</p>\n\n<pre><code>g :: (c (a -&gt; a'), c (b -&gt; b')) =&gt; Poly c -&gt; (a, b) -&gt; (a' -&gt; b')\ng f (x,y) = (getPoly f x, getPoly f y)\n</code></pre>\n\n<p>Which is very similar to your example.</p>\n\n<p><code>c</code> in the above is a constraint, and looking at the type of <code>g</code> should help you understand what's happening. </p>\n\n<p>Unfortunately, you can't just pass an ordinary function to <code>g</code>, you have to pass one wrapped in a <code>Poly</code>, which is non trivial as you don't get type inference for the <code>Poly</code> constraint (any ideas on how to make this nicer appreciated).</p>\n\n<p>But if you've just got one or a few functions that need this polymorphic behaviour, I wouldn't bother with <code>Poly</code>. But for example, you're finding this issue coming up a lot (I found it came up a lot in unit testing, which is what inspired the creation of my package), then you might find <a href=\"https://hackage.haskell.org/package/polydata-0.1.0.0/docs/Data-Poly.html\" rel=\"nofollow noreferrer\">polydata</a> useful. </p>\n\n<p>There's also <a href=\"https://hackage.haskell.org/package/heterolist\" rel=\"nofollow noreferrer\">heterolist</a>, which I created as an extension to polydata allows you to create lists of mixed types and say, map over them in a type safe way. You might find that useful.</p>\n"}], "owner": {"reputation": 23, "user_id": 7986473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e49a289483decf6afcbca54f5407aa1f?s=128&d=identicon&r=PG&f=1", "display_name": "figasso", "link": "https://stackoverflow.com/users/7986473/figasso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 1, "accepted_answer_id": 43873449, "answer_count": 2, "score": 2, "last_activity_date": 1494381157, "creation_date": 1494336512, "last_edit_date": 1494373974, "question_id": 43871225, "link": "https://stackoverflow.com/questions/43871225/haskell-calling-a-function-with-different-types-of-lists", "title": "haskell: calling a function with different types of lists", "body": "<p>I have a function:</p>\n\n<pre><code>sum f l1 l2 = (f l1) + (f l2)\n</code></pre>\n\n<p>How to correct this function to be working when called with different types of lists? eg:</p>\n\n<p><code>sum length [1,2] ['a','b']</code></p>\n"}, {"tags": ["json", "haskell", "aeson", "haskell-wai", "haskell-spock"], "answers": [{"comments": [{"owner": {"reputation": 2795, "user_id": 7978068, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/374ccc08f4ce2a4b5f59a0551a5eadee?s=128&d=identicon&r=PG&f=1", "display_name": "Jodimoro", "link": "https://stackoverflow.com/users/7978068/jodimoro"}, "edited": false, "score": 0, "creation_date": 1494338047, "post_id": 43871069, "comment_id": 74778727, "body": "I don&#39;t want to use the extension, how to archive that without it?"}, {"owner": {"reputation": 2795, "user_id": 7978068, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/374ccc08f4ce2a4b5f59a0551a5eadee?s=128&d=identicon&r=PG&f=1", "display_name": "Jodimoro", "link": "https://stackoverflow.com/users/7978068/jodimoro"}, "edited": false, "score": 0, "creation_date": 1494338364, "post_id": 43871069, "comment_id": 74778966, "body": "using &quot;a&quot; doesn&#39;t help."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 2795, "user_id": 7978068, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/374ccc08f4ce2a4b5f59a0551a5eadee?s=128&d=identicon&r=PG&f=1", "display_name": "Jodimoro", "link": "https://stackoverflow.com/users/7978068/jodimoro"}, "edited": false, "score": 0, "creation_date": 1494338938, "post_id": 43871069, "comment_id": 74779381, "body": "<code>ScopedTypeVariables</code> is totally harmless, universally supported, and a useful thing for everyday Haskell programming regardless. Here I don&#39;t even make use of that extension anyway, just use it to lift a somewhat arbitrary syntactic restriction. \u2014 But as I said: if you <i>use</i> <code>a</code> (actually use it as a value, not just feed it to <code>show</code> \u2013 i.e., it must occur in a <i>monomorphic position</i>) then you don&#39;t need any explicit signature, either. Alternatively, you can use it in a polymorphic spot like <code>show</code> but give a signature there: <code>show (a :: Aeson.Object)</code>. That doesn&#39;t need <code>ScopedTypeVariables</code>."}, {"owner": {"reputation": 2795, "user_id": 7978068, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/374ccc08f4ce2a4b5f59a0551a5eadee?s=128&d=identicon&r=PG&f=1", "display_name": "Jodimoro", "link": "https://stackoverflow.com/users/7978068/jodimoro"}, "edited": false, "score": 0, "creation_date": 1494339001, "post_id": 43871069, "comment_id": 74779444, "body": "I don&#39;t want to use the extension, how to archive that without it?"}, {"owner": {"reputation": 2795, "user_id": 7978068, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/374ccc08f4ce2a4b5f59a0551a5eadee?s=128&d=identicon&r=PG&f=1", "display_name": "Jodimoro", "link": "https://stackoverflow.com/users/7978068/jodimoro"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1494342414, "post_id": 43871069, "comment_id": 74782032, "body": "@ThomasM.DuBuisson, ok. How can I extract a value from it? I&#39;ve tried <code>.:</code> like this <code>myVal &lt;- (a :: Object) .: &quot;some_key&quot; </code> but it caused typed mismatch because it required the type <code>\u2018ActionCtxT ctx0 m0\u2019</code> to return on each line inside the <code>do</code>"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1494336131, "creation_date": 1494336131, "answer_id": 43871069, "question_id": 43870605, "link": "https://stackoverflow.com/questions/43870605/unable-to-fix-ambiguous-type-variable-in-aeson-and-spock/43871069#43871069", "title": "Unable to fix &quot;Ambiguous type variable&quot; in Aeson and Spock", "body": "<p><code>a &lt;- jsonBody' :: Aeson.Object</code> gives <code>Aeson.Object</code> as the signature to <code>jsonBody'</code>. But that doesn't work: <code>jsonBody'</code> is not a value but an <em>action</em> from which such a value is obtained! You probably want to give that signature to <code>a</code>.</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeSignatures #-}\n\npost \"/test\" $ do\n    a :: Aeson.Object &lt;- jsonBody'\n    text \"test\"\n</code></pre>\n\n<p>Really, you probably don't need anything like that though \u2013 just make sure you actually <em>use</em> <code>a</code>, then the compiler will probably be able to figure out its type on its own!</p>\n"}], "owner": {"reputation": 2795, "user_id": 7978068, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/374ccc08f4ce2a4b5f59a0551a5eadee?s=128&d=identicon&r=PG&f=1", "display_name": "Jodimoro", "link": "https://stackoverflow.com/users/7978068/jodimoro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494338340, "creation_date": 1494334968, "last_edit_date": 1494338340, "question_id": 43870605, "link": "https://stackoverflow.com/questions/43870605/unable-to-fix-ambiguous-type-variable-in-aeson-and-spock", "title": "Unable to fix &quot;Ambiguous type variable&quot; in Aeson and Spock", "body": "<p>I have a Spock application where I have this:</p>\n\n<pre><code>    post \"/test\" $ do\n        a &lt;- jsonBody'\n        text \"test\"\n</code></pre>\n\n<p>It throws an exception:</p>\n\n<pre><code>\u2022 Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018jsonBody'\u2019\n      prevents the constraint \u2018(Aeson.FromJSON a0)\u2019 from being solved.\n      Probable fix: use a type annotation to specify what \u2018a0\u2019 should be.\n      These potential instances exist:\n        instance Aeson.FromJSON Aeson.DotNetTime\n</code></pre>\n\n<p>thus I've tried solving it like this:</p>\n\n<pre><code>post \"/test\" $ do\n        a &lt;- jsonBody' :: Aeson.Object\n        text \"test\" \n</code></pre>\n\n<p>but have had no luck:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018ActionCtxT\n                             () (WebStateM () MySession MyAppState) ()\u2019\n                     with \u2018unordered-containers-0.2.8.0:Data.HashMap.Base.HashMap\n                             T.Text b0\u2019\n      Expected type: hvect-0.4.0.0:Data.HVect.HVectElim\n                       '[] (SpockActionCtx () () MySession MyAppState ())\n        Actual type: unordered-containers-0.2.8.0:Data.HashMap.Base.HashMap\n                       T.Text b0\n</code></pre>\n\n<p>How to fix it?</p>\n\n<p>update:</p>\n\n<p>this doesn't fix the problem:</p>\n\n<pre><code>        a &lt;- jsonBody' :: Aeson.Object\n        --a :: Aeson.Object &lt;- jsonBody'\n        let b = show a -- using a\n        text \"fdsfd\" \n</code></pre>\n"}, {"tags": ["list", "haskell", "design-patterns", "pattern-matching", "matching"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494338093, "post_id": 43869933, "comment_id": 74778762, "body": "Hint: you can nest patterns. If you have a list of pairs, you can use <code>f ((a,b):xs) = ...</code>. For a list of lists, use a similar pattern (you can use <code>:</code> twice). Remember to catch all the possible cases."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7972990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ae4713bf5bdc5bc58e43a6ee45621d7?s=128&d=identicon&r=PG&f=1", "display_name": "programmer", "link": "https://stackoverflow.com/users/7972990/programmer"}, "edited": false, "score": 0, "creation_date": 1494334131, "post_id": 43870202, "comment_id": 74775648, "body": "Thanks! I will try it! ^^"}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 2, "last_activity_date": 1494333924, "creation_date": 1494333924, "answer_id": 43870202, "question_id": 43869933, "link": "https://stackoverflow.com/questions/43869933/list-of-lists-in-haskell-how-can-i-seperate-the-first-element-of-every-list-wi/43870202#43870202", "title": "list of lists in Haskell - How can I seperate the first element of every list without map", "body": "<p>Look at definitions of <code>map</code> and <code>head</code> functions. And then just copy implementations, combining both functions in one. To make it easier, you can just copy <code>map</code>, replacing function, passed to <code>map</code> with <code>head</code> and then use your own <code>head</code>. You can use <code>case &lt;expr&gt; of ...</code> expression to not implement your own head as a separate function. After doing all this stuff, you can probably refactor your function to make it more elegant.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7972990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ae4713bf5bdc5bc58e43a6ee45621d7?s=128&d=identicon&r=PG&f=1", "display_name": "programmer", "link": "https://stackoverflow.com/users/7972990/programmer"}, "edited": false, "score": 0, "creation_date": 1494345822, "post_id": 43871084, "comment_id": 74784397, "body": "Thats very good!!! I&#39;m a noob in Haskell. Can you explain me the part &quot;/= []&quot; Is this a helpfunction? Can I write this comment in a new function?"}, {"owner": {"reputation": 1162, "user_id": 3645051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/NZ2gR.jpg?s=128&g=1", "display_name": "Will Gl&#252;ck", "link": "https://stackoverflow.com/users/3645051/will-gl%c3%bcck"}, "reply_to_user": {"reputation": 11, "user_id": 7972990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ae4713bf5bdc5bc58e43a6ee45621d7?s=128&d=identicon&r=PG&f=1", "display_name": "programmer", "link": "https://stackoverflow.com/users/7972990/programmer"}, "edited": false, "score": 0, "creation_date": 1494353054, "post_id": 43871084, "comment_id": 74788572, "body": "It&#39;s just a validation. I&#39;m checking if the current inner list is not empty, because head throw a error if the list is empty. If you want to put this validation in a separated function you can do something like this: <code>firstItemOfEveryList xxs = [head xs | xs &lt;- xxs, validateList xs] where validateList x = x &#47;= []</code>, or declare another function in the global scope as well"}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 1, "creation_date": 1494353368, "post_id": 43871084, "comment_id": 74788750, "body": "You shouldn&#39;t need any of <i>those</i> constraints, only <code>Eq a</code>. And if you replace <code>xs &#47;= []</code> by <code>not (null xs)</code>, you won&#39;t need that either."}, {"owner": {"reputation": 1162, "user_id": 3645051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/NZ2gR.jpg?s=128&g=1", "display_name": "Will Gl&#252;ck", "link": "https://stackoverflow.com/users/3645051/will-gl%c3%bcck"}, "edited": false, "score": 0, "creation_date": 1494353744, "post_id": 43871084, "comment_id": 74788958, "body": "Thanks for the tips Alexey. Just fixed the answer. I&#39;m still a little lost when dealing with Haskell Typeclasses."}], "tags": [], "owner": {"reputation": 1162, "user_id": 3645051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/NZ2gR.jpg?s=128&g=1", "display_name": "Will Gl&#252;ck", "link": "https://stackoverflow.com/users/3645051/will-gl%c3%bcck"}, "is_accepted": false, "score": 1, "last_activity_date": 1494353953, "last_edit_date": 1494353953, "creation_date": 1494336160, "answer_id": 43871084, "question_id": 43869933, "link": "https://stackoverflow.com/questions/43869933/list-of-lists-in-haskell-how-can-i-seperate-the-first-element-of-every-list-wi/43871084#43871084", "title": "list of lists in Haskell - How can I seperate the first element of every list without map", "body": "<p>I'm new to Haskell but this is what I managed to create here.</p>\n\n<p>I used list comprehension and pattern matching.</p>\n\n<pre><code>--Type definition. Not mandatory but recommended.\nfirstItemOfEveryList :: [[a]] -&gt; [a]\n--First pattern. If the list is empty return a empty list.\nfirstItemOfEveryList [] = [] \n--Catch all pattern. Receive a list of lists (xxs). For every inner list (xs &lt;- xxs) call the head method (head xs), but only when the inner list is not null or empty (not(null xs).\nfirstItemOfEveryList xxs = [head xs | xs &lt;- xxs, not(null xs)]\n</code></pre>\n\n<p>The empty list pattern is a little bit unnecessary, as it just gives the same result that the last catch. Hope it helps.</p>\n"}, {"comments": [{"owner": {"reputation": 1162, "user_id": 3645051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/NZ2gR.jpg?s=128&g=1", "display_name": "Will Gl&#252;ck", "link": "https://stackoverflow.com/users/3645051/will-gl%c3%bcck"}, "edited": false, "score": 0, "creation_date": 1494354363, "post_id": 43877139, "comment_id": 74789334, "body": "Is there a way to add some empty list validation for the inner lists using patterns? I didn&#39;t manage to do so."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "reply_to_user": {"reputation": 1162, "user_id": 3645051, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/NZ2gR.jpg?s=128&g=1", "display_name": "Will Gl&#252;ck", "link": "https://stackoverflow.com/users/3645051/will-gl%c3%bcck"}, "edited": false, "score": 1, "creation_date": 1494354571, "post_id": 43877139, "comment_id": 74789451, "body": "it should fail, since there is no first element.  If you want to ignore empty sublists, you can add provision for that <code>firsts [[]] = []</code>"}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1494353841, "creation_date": 1494353841, "answer_id": 43877139, "question_id": 43869933, "link": "https://stackoverflow.com/questions/43869933/list-of-lists-in-haskell-how-can-i-seperate-the-first-element-of-every-list-wi/43877139#43877139", "title": "list of lists in Haskell - How can I seperate the first element of every list without map", "body": "<pre><code>firsts [] = []\nfirsts [(x:xs)] = [x]\nfirsts ((x:xs):xss) = x: firsts xss\n\n\n&gt; firsts [[1,2,3], [7,6,8], [0,3,4]]\n[1,7,0]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "is_accepted": false, "score": 1, "last_activity_date": 1494355881, "creation_date": 1494355881, "answer_id": 43877729, "question_id": 43869933, "link": "https://stackoverflow.com/questions/43869933/list-of-lists-in-haskell-how-can-i-seperate-the-first-element-of-every-list-wi/43877729#43877729", "title": "list of lists in Haskell - How can I seperate the first element of every list without map", "body": "<p>Another answer using nested pattern matching:</p>\n\n<pre><code>firsts :: [[a]] -&gt; [a]\nfirsts      []      = []\nfirsts   ([]:xss)   = error \"sublist is empty\"\nfirsts ((x:xs):xss) = x:firsts xss\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7972990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ae4713bf5bdc5bc58e43a6ee45621d7?s=128&d=identicon&r=PG&f=1", "display_name": "programmer", "link": "https://stackoverflow.com/users/7972990/programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3143, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1533961575, "creation_date": 1494333105, "question_id": 43869933, "link": "https://stackoverflow.com/questions/43869933/list-of-lists-in-haskell-how-can-i-seperate-the-first-element-of-every-list-wi", "title": "list of lists in Haskell - How can I seperate the first element of every list without map", "body": "<p>for example:\nMy list of lists in Haskell is:</p>\n\n<p>[[1,2,3], [7,6,8], [0,3,4]]</p>\n\n<p>I need all first element of ervery list in list.</p>\n\n<p>How can I get the output [1,7,4] without \"map\"?\nI need a solution with pattern-matching, not this:\nlist x = map head x</p>\n"}, {"tags": ["list", "haskell", "functional-programming", "stack"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 7, "creation_date": 1494330829, "post_id": 43869062, "comment_id": 74773236, "body": "For me a Stack is more the &quot;interface&quot;: you can implement a stack with an array, linked list, etc. The Haskell list, is a linked list, which is a concrete datastructure. So in that perspective &quot;list&quot; says more what it <i>is</i>, whereas &quot;Stack&quot; more says what it <i>does</i>. But of course it&#39;s all a matter of &quot;what&#39;s in a name?&quot; and &quot;how do you define things&quot;."}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494331203, "post_id": 43869062, "comment_id": 74773507, "body": "If you were starting from scratch, what naming would you think better reflect the type constructed?: <code>Stack a = Empty | Cons a (Stack a)</code> or <code>List a = Empty | Cons a (List a)</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1494331620, "post_id": 43869062, "comment_id": 74773831, "body": "I would go for <code>List</code>. But as said before, it is all a matter on what you think a list/stack is. If I look on wikipedia a stack seems to be described as an <i>abstract</i> data type. So there are several <i>ways</i> to implement it. Now a list is also an <i>abstract</i> data type. So perhaps a more rigorous form would be <code>LinkedList</code>. But of course it is not very convenient to work with such names. This comment is of course not an answer as to what the historical reasons were (I don&#39;t know)."}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494332601, "post_id": 43869062, "comment_id": 74774539, "body": "Futhermore, Wikipedia, when describing abstract definition of List, says <b>These axioms are equivalent to those of the abstract stack data type.</b>. So, in some point in history (Lisp creation, maybe), someone chose to name it List instead of Stack"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1494337915, "post_id": 43869062, "comment_id": 74778610, "body": "I guess it comes from &quot;linked list&quot; and &quot;Lisp cons-lists&quot;. Also, &quot;stack&quot; sounds weird in most contexts. E.g. &quot;read the numbers from file into a stack, then compute the sum of the stack, finally compute the product of the stack&quot; seems to imply 0) that every element of the file is pushed, 1) that the sum is computed from the last element to the first, 2) that the stack is so consumed in the process, 3) that the product can no longer be computed since the stack is gone. Also, I&#39;d expect a <code>map</code> operation on a stack to reverse it, or to require two passes."}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1494339177, "post_id": 43869062, "comment_id": 74779579, "body": "I agree with you that &quot;stack&quot; sounds weird, but that is due to we are used to think that stacks are mutable data structures different from our loved list. If you implement your example, you will deconstruct your list in the very same way a stack works."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1494347102, "post_id": 43869062, "comment_id": 74785223, "body": "@Nykros: not entirely. Usually the way I have been taught what a stack is, is that the <i>top</i> is accessible, but the underlying parts are not necessarily accessible (without popping the top). So in order to calculate the sum, you should consume the top. The &quot;interface&quot; of a stack is usually push/pop(/peek). With these functions you cannot both calculate an aggregate of the stack and keeping it intact. Of course you can use a second stack to buffer the elements and then &quot;restore&quot; the original stack."}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494348043, "post_id": 43869062, "comment_id": 74785816, "body": "Sorry @WillemVanOnsem, but I&#39;m unable to find the difference between a sum of list and a sum of a stack:  <code>sumList xs = if (isEmpty xs) then 0 else head xs + sumList (tail xs)</code> or  <code>sumStack st = if (isEmptyS st) then 0 else (top st) + sumStack (top st)</code>  Quoting wikipedia: <b>In many implementations, a stack has more operations than &quot;push&quot; and &quot;pop&quot;. An example is &quot;top of stack&quot;, or &quot;peek&quot;, which observes the top-most element without removing it from the stack. Since this can be done with a &quot;pop&quot; and a &quot;push&quot; with the same data, it is not essential</b>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1494348231, "post_id": 43869062, "comment_id": 74785912, "body": "@Nykros: yes peek is indeed a simple push and pop and requires <i>O(1)</i> memory. But obtaining the <i>i</i>-th element cannot be done without constructing an additional collection (given you only have push/pop/peek) to store at least <i>O(i)</i> elements.  The reaon why your <code>sumStack</code> works is of course because data structure are immutable in Haskell. But by using a Stack like in C++/Java you cannot do that."}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494349575, "post_id": 43869062, "comment_id": 74786645, "body": "I narrowed the scope of my question from the very begining to Haskell&#39;s (Miranda, KRC, Gofer) list because this statement is not true in mutable data structures.  If Haskell&#39;s list are really stacks, why they chose to call them list?  I&#39;m almost sure it was more fancy to call them lists and not stacks, but I want to know for sure.  Anyway, the community is supporting your view @WillemVanOnsem. I&#39;m been downvoted and your comments are upvoted."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494349716, "post_id": 43869062, "comment_id": 74786726, "body": "@Nykros: look I did not downvoted you (and furthermore I&#39;m <i>not</i> saying that your arguments are worthless/don&#39;t make any sense) ;). It is also good to sometimes think about these thinks. It was only an opinion why a computer scientist would probably name it list and not stack."}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "edited": false, "score": 1, "creation_date": 1494350306, "post_id": 43869062, "comment_id": 74787088, "body": "Thank you, you are very kind."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1494352773, "post_id": 43869062, "comment_id": 74788411, "body": "For the historical reasons specifically I think @chi is exactly right: they are lists because they are the direct equivalent to Lisp cons-lists. Why are they called lists in Lisp? 1) It isn&#39;t much younger than concept of stack itself, and I wouldn&#39;t be surprised if &quot;immutable stack&quot; would be considered a contradiction at the time; 2) Lisp code is itself famously represented as nested lists, but I don&#39;t think thinking of it as a stack is useful."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1494352782, "post_id": 43869062, "comment_id": 74788423, "body": "Beyond this, laziness adds another problem: you <i>don&#39;t</i> need to already have a &quot;stack&quot; before &quot;pushing&quot; something on it."}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1494802530, "post_id": 43869062, "comment_id": 74969067, "body": "I have been reading the John McCarthy 1960&#39; paper <a href=\"http://www-formal.stanford.edu/jmc/recursive.pdf\" rel=\"nofollow noreferrer\">link</a> and he clearly meant to use linked list in the IBM 704 LISP implementation.   It is easy to say now &quot;hey! Haskel&#39;s lists behaves like a (inmutable) stacks!&quot; having the advantage of almost 60 years of development in computer science.   If any of the commenters would elaborate an answer I will be glad to accept it.  I have enjoyed your input very much."}], "owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494337362, "creation_date": 1494330681, "last_edit_date": 1494337362, "question_id": 43869062, "link": "https://stackoverflow.com/questions/43869062/what-are-the-historical-reasons-that-haskells-is-named-list-and-not-stack", "title": "What are the historical reasons that Haskell&#39;s [] is named List and not Stack", "body": "<p>The behavior of Haskel's list is much better characterized as a stack (<code>empty=[]</code>, <code>isEmpty=isEmpty</code>, <code>top=head</code>, <code>pop= tail</code>, <code>push=(:)</code>) than a  list.</p>\n\n<p>Common immutable list operations (<code>length</code>, <code>get</code>) are <em>O(n)</em> and defined using the previous mentioned operations.</p>\n\n<p>What are the historical reasons to name this type a List and not a Stack?</p>\n"}, {"tags": ["performance", "haskell", "optimization", "nearest-neighbor", "stream-fusion"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 1, "creation_date": 1494327441, "post_id": 43866663, "comment_id": 74770879, "body": "Does the performance stay fast if you run the <code>-O</code> version after running the <code>-O2</code> version? It&#39;s possible you&#39;re seeing the difference between loading the files from disk and retrieving them from the operating system&#39;s page cache."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1494327654, "post_id": 43866663, "comment_id": 74771038, "body": "I doubt that&#39;s the difference, due to the difference in allocation rate and bytes allocated. The -O2 version is probably allocating fewer intermediate objects. If you want to see the difference the best thing to do is view the compiled core (described in the linked article)."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 1, "creation_date": 1494330174, "post_id": 43866663, "comment_id": 74772792, "body": "@Cirdec The difference is due to <code>-fspec-constr</code>. Without actual data to reproduce this its hard to generate some profiles, but in the end the inlined <code>vector</code> code needs <code>-fspec-constr</code> to get the last bit of performance."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1494330297, "post_id": 43866663, "comment_id": 74772865, "body": "Also, OP, depending on your use case, you want to <code>{-# INLINE #-}</code> your functions. Note that this happens already to <code>calculateL1Distance</code> with <code>-O</code>, it&#39;s just a remark when you start to split those functions into other modules."}, {"owner": {"reputation": 231, "user_id": 2091724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/333a4c952bd041cd832ac2684927650b?s=128&d=identicon&r=PG", "display_name": "Oliver Gerlach", "link": "https://stackoverflow.com/users/2091724/oliver-gerlach"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1494336409, "post_id": 43866663, "comment_id": 74777389, "body": "@Cirdec: I tried looking at the Core. However, it is quite tough to get into it.Could not even find calculateL1Distance in it. Quess it is inlined."}, {"owner": {"reputation": 231, "user_id": 2091724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/333a4c952bd041cd832ac2684927650b?s=128&d=identicon&r=PG", "display_name": "Oliver Gerlach", "link": "https://stackoverflow.com/users/2091724/oliver-gerlach"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1494336414, "post_id": 43866663, "comment_id": 74777392, "body": "@Zeta: I read up about -fspec-constr (<a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/using-optimisation.html\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/latest/docs/html/users_guide/&hellip;</a>). This kind of optimization definitely makes sense. Thank you so much. Interesting read! As for the data. It can be found here: <a href=\"https://www.cs.toronto.edu/~kriz/cifar-10-binary.tar.gz\" rel=\"nofollow noreferrer\">cs.toronto.edu/~kriz/cifar-10-binary.tar.gz</a>"}], "owner": {"reputation": 231, "user_id": 2091724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/333a4c952bd041cd832ac2684927650b?s=128&d=identicon&r=PG", "display_name": "Oliver Gerlach", "link": "https://stackoverflow.com/users/2091724/oliver-gerlach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 2, "answer_count": 0, "score": 10, "last_activity_date": 1494323735, "creation_date": 1494323735, "question_id": 43866663, "link": "https://stackoverflow.com/questions/43866663/why-does-o2-have-such-a-big-impact-on-a-simple-l1-distance-calculator-in-haskel", "title": "Why does -O2 have such a big impact on a simple L1 distance calculator in Haskell?", "body": "<p>I have implemented a simple L1 distance calculator using Haskell. Since I am interested in performance I used unboxed vectors to store the images to compare.</p>\n\n<pre><code>calculateL1Distance :: LabeledImage -&gt; LabeledImage -&gt; Int\ncalculateL1Distance reference test = \n            let\n              substractPixels :: Int -&gt; Int -&gt; Int\n              substractPixels a b = abs $ a - b\n              diff f = Vec.sum $ Vec.zipWith substractPixels (f reference) (f test)\n            in\n              diff pixels\n</code></pre>\n\n<p>From what I know (I am very new to Haskell) stream fusion should make this code run as a simple loop. So it should be fast. However, performance turned out to be low when compiled with</p>\n\n<pre><code>ghc -O -fforce-recomp -rtsopts -o test .\\performance.hs\n</code></pre>\n\n<p>The program took around 60sec:</p>\n\n<pre><code> 198,871,911,896 bytes allocated in the heap\n   1,804,017,536 bytes copied during GC\n     254,900,000 bytes maximum residency (14 sample(s))\n       9,020,888 bytes maximum slop\n             579 MB total memory in use (0 MB lost due to fragmentation)\n\n                                     Tot time (elapsed)  Avg pause  Max pause\n  Gen  0     378010 colls,     0 par    2.312s   2.949s     0.0000s    0.0063s\n  Gen  1        14 colls,     0 par    0.562s   0.755s     0.0539s    0.2118s\n\n  INIT    time    0.000s  (  0.005s elapsed)\n  MUT     time   58.297s  ( 64.380s elapsed)\n  GC      time    2.875s  (  3.704s elapsed)\n  EXIT    time    0.016s  (  0.088s elapsed)\n  Total   time   61.188s  ( 68.176s elapsed)\n\n  %GC     time       4.7%  (5.4% elapsed)\n\n  Alloc rate    3,411,364,878 bytes per MUT second\n\n  Productivity  95.3% of total user, 94.6% of total elapsed\n</code></pre>\n\n<p>However, the performance drastically increased when compiling with</p>\n\n<pre><code>ghc -O2 -fforce-recomp -rtsopts -o test .\\performance.hs\n</code></pre>\n\n<p>The runtime dropped to around 13sec:</p>\n\n<pre><code>   2,261,672,056 bytes allocated in the heap\n   1,571,668,904 bytes copied during GC\n     241,064,192 bytes maximum residency (12 sample(s))\n       8,839,048 bytes maximum slop\n             544 MB total memory in use (0 MB lost due to fragmentation)\n\n                                     Tot time (elapsed)  Avg pause  Max pause\n  Gen  0      2951 colls,     0 par    1.828s   1.927s     0.0007s    0.0059s\n  Gen  1        12 colls,     0 par    0.516s   0.688s     0.0573s    0.2019s\n\n  INIT    time    0.000s  (  0.005s elapsed)\n  MUT     time   10.484s  ( 16.598s elapsed)\n  GC      time    2.344s  (  2.615s elapsed)\n  EXIT    time    0.000s  (  0.105s elapsed)\n  Total   time   12.828s  ( 19.324s elapsed)\n\n  %GC     time      18.3%  (13.5% elapsed)\n\n  Alloc rate    215,718,348 bytes per MUT second\n\n  Productivity  81.7% of total user, 86.4% of total elapsed\n</code></pre>\n\n<p>The effect is even stronger when using larger parts of the image sets, due to image loading taking a smaller part of the runtime. According to HaskellWiki there is effectively nearly no difference between -O and -O2 (<a href=\"https://wiki.haskell.org/Performance/GHC\" rel=\"noreferrer\">https://wiki.haskell.org/Performance/GHC</a>). However, I observe a huge effect. I am wondering if I am missing something. Is there any optimization I should do to my code that the compiler (GHC) is doing when compiling with -O2? If yes, what does he do? From what I read, the main performance improvement comes from stream fusion and from me the function looks like stream fusion can be applied.</p>\n\n<p>For reference, here is the complete example for my test program.</p>\n\n<pre><code>import Data.List\nimport Data.Word\nimport qualified Data.ByteString as ByteStr\nimport qualified Data.ByteString.Char8 as ByteStrCh8\nimport qualified Data.Vector.Unboxed as Vec\n\ndata LabeledImage = LabeledImage {\n       labelIdx :: Int\n     , pixels :: Vec.Vector Int\n} deriving (Eq)\n\nextractLabeledImages :: ByteStr.ByteString -&gt; [LabeledImage] -&gt; [LabeledImage]\nextractLabeledImages source images\n      | ByteStr.length source &gt;= imgLength =\n                    let\n                      (label,trailData) = ByteStr.splitAt labelBytes source\n                      (rgbData,remainingData) = ByteStr.splitAt colorBytes trailData\n                      numLabel = fromIntegral (ByteStr.head label)\n                      pixelValues = Vec.generate (ByteStr.length rgbData) (fromIntegral . ByteStr.index rgbData)\n                    in\n                      extractLabeledImages remainingData (images ++ [LabeledImage numLabel pixelValues])\n      | otherwise = images\n      where\n        labelBytes = 1\n        colorBytes = 3072\n        imgLength = labelBytes + colorBytes\n\ncalculateL1Distance :: LabeledImage -&gt; LabeledImage -&gt; Int\ncalculateL1Distance reference test = \n            let\n              substractPixels :: Int -&gt; Int -&gt; Int\n              substractPixels a b = abs $ a - b\n              diff f = Vec.sum $ Vec.zipWith substractPixels (f reference) (f test)\n            in\n              diff pixels\n\nmain = do\n       batch1Raw &lt;- ByteStr.readFile \"M:\\\\Documents\\\\StanfordCNN\\\\cifar10\\\\data_batch_1.bin\"\n       testBatchRaw &lt;- ByteStr.readFile \"M:\\\\Documents\\\\StanfordCNN\\\\cifar10\\\\test_batch.bin\"\n\n       let referenceImages = take 1000 $ extractLabeledImages batch1Raw []\n       let testImages = take 1000 $ extractLabeledImages testBatchRaw []\n\n       putStrLn \"Created image sets. Starting tests.\"\n       let results = [calculateL1Distance referenceImage testImage | referenceImage &lt;- referenceImages, testImage &lt;- testImages ]\n       ByteStr.writeFile \"M:\\\\Documents\\\\StanfordCNN\\\\results.txt\" (ByteStrCh8.pack $ show results)\n</code></pre>\n"}, {"tags": ["haskell", "input", "split"], "answers": [{"tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 1, "last_activity_date": 1494319655, "last_edit_date": 1494319655, "creation_date": 1494318405, "answer_id": 43864763, "question_id": 43864586, "link": "https://stackoverflow.com/questions/43864586/how-to-print-a-group-of-words-with-each-words-length-in-haskell/43864763#43864763", "title": "How to print a group of words with each words length in Haskell", "body": "<p>If you run this code (on its own source code):</p>\n\n<pre><code>main = do                                                                                                                                                                                               \n    contents &lt;- readFile \"words.hs\"\n    print $ [(w, length w) | w &lt;- words contents]\n</code></pre>\n\n<p>You get</p>\n\n<pre><code>[(\"main\",4),(\"=\",1),(\"do\",2),(\"contents\",8),(\"&lt;-\",2),(\"readFile\",8),(\"\\\"words.hs\\\"\",10),(\"print\",5),(\"$\",1),(\"[(w,\",4),(\"length\",6),(\"w)\",2),(\"|\",1),(\"w\",1),(\"&lt;-\",2),(\"words\",5),(\"contents]\",9)]\n</code></pre>\n\n<p>Of course, you can format the output:</p>\n\n<pre><code>main = do  \n    contents &lt;- readFile \"words.hs\"\n    putStr $ unlines [w ++ \": \" ++ show (length w) | w &lt;- words contents]                                                              \n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 7984871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e8ec6b3a36339d43c281417ed0f19f2?s=128&d=identicon&r=PG&f=1", "display_name": "J.Tmr", "link": "https://stackoverflow.com/users/7984871/j-tmr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 43864763, "answer_count": 1, "score": 2, "last_activity_date": 1494319655, "creation_date": 1494317809, "last_edit_date": 1494318140, "question_id": 43864586, "link": "https://stackoverflow.com/questions/43864586/how-to-print-a-group-of-words-with-each-words-length-in-haskell", "title": "How to print a group of words with each words length in Haskell", "body": "<p>I'm trying to print a group of words and each words length in Haskell. The words are within a .txt file so first I have to get the contents into Haskell and then I split them into single words, so I did this so far:</p>\n\n<pre><code>main =\n       do\n          textdat &lt;- openFile \"palindrom.txt\" ReadMode\n          inhalt &lt;- hGetContents textdat\n          winhalt &lt;- return (words inhalt)\n          print winhalt\n          putStrLn \"has the length \"\n          print (length winhalt)\n</code></pre>\n\n<p>palindrom.txt is the .txt file im taking the words from.  with openFile and hGetContents, I assigned the content of the .txt to \"inhalt\". \"winhalt\" is the content split up into words with the \"words\"-fuction.\nNow im Getting this result:</p>\n\n<pre><code>\"wordexample1\"\"wordexample2\"\"wordexample3\"...\"wordexample45\"\nhas the length\n45\n</code></pre>\n\n<p>(45 is the amount of words in the .txt file)</p>\n\n<p>How can I split the sequence of words into single words so I can get and print the length of each word respectively?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "edited": false, "score": 0, "creation_date": 1494319925, "post_id": 43864739, "comment_id": 74765709, "body": "But the underscore variable is not being used on the RHS?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "edited": false, "score": 0, "creation_date": 1494324796, "post_id": 43864739, "comment_id": 74769111, "body": "@andro In your specific example, it doesn&#39;t matter. And using <code>_</code> is equivalent to <code>_var</code>. But in general, they differ."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 1, "last_activity_date": 1494318348, "creation_date": 1494318348, "answer_id": 43864739, "question_id": 43864572, "link": "https://stackoverflow.com/questions/43864572/haskell-wildcard-symbol-usage/43864739#43864739", "title": "Haskell wildcard symbol usage", "body": "<p>If you don't use the <code>_</code> prefix, you will get warning when compiling:</p>\n\n<pre><code>gcc -Wall test.hs:\n\ntest.hs:21:18: Warning: Defined but not used: \u2018m\u2019\n\ntest.hs:23:11: Warning: Defined but not used: \u2018m1\u2019\n\ntest.hs:24:18: Warning: Defined but not used: \u2018m2\u2019\n</code></pre>\n\n<p>You can use <code>_</code> to avoid the warnings. So, <code>_var</code> is used to give a name to the variable and to avoid warning. You can do something like this:</p>\n\n<pre><code>Justa m1 *&gt; _m      = _m\n</code></pre>\n\n<p>But with wildcards, you cannot do something like this:</p>\n\n<pre><code>Just m1 *&gt; _ = _\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "is_accepted": true, "score": 3, "last_activity_date": 1494322244, "creation_date": 1494322244, "answer_id": 43866145, "question_id": 43864572, "link": "https://stackoverflow.com/questions/43864572/haskell-wildcard-symbol-usage/43866145#43866145", "title": "Haskell wildcard symbol usage", "body": "<p>You're right that <code>_</code> is a wildcard.  What you see here are just variables with names beginning with <code>_</code>; there's no special syntax.  Both <code>_</code> and variables match any value, but <code>_</code> signals that you're ignoring that value.  Consequently, GHC will warn you if you define a variable and don't use it, which comes in handy.  But what if you want to document <em>what</em> you're ignoring, without being warned that you're ignoring it?  Well, <code>_</code> is just another word character in Haskell, so you can begin a variable name with it.  And GHC will assume that any <code>_</code>-initial variable names you defined are <em>intended</em> to be unused, and refrain from warning you about them.</p>\n\n<p>Thus, in</p>\n\n<pre><code>Just f  &lt;*&gt; m  = fmap f m\nNothing &lt;*&gt; _m = Nothing\n</code></pre>\n\n<p>The <code>_m</code> is used to be clear that it's the same thing as the <code>m</code> above, but isn't being used.  If we replaced it with <code>_</code>, that might be less clear.  And if we replaced it with <code>m</code>, we'd get a warning:</p>\n\n<pre><code>\u2026: warning: [-Wunused-matches]\n    Defined but not used: \u2018m\u2019\n</code></pre>\n\n<hr>\n\n<p>In general, <code>_</code> is only a little bit special in Haskell pattern matches.  Besides the \"no warnings\" property above (which doesn't change what the program does, only the compiler messages), matching against <code>_</code> is almost exactly like matching against any other variable.  There are only two differences:</p>\n\n<ol>\n<li><p>You can match against multiple <code>_</code>s at once.</p>\n\n<pre><code>star1, star2 :: a -&gt; b -&gt; Char\nstar1 _ _ = '*'\nstar2 x y = '*'\n-- ILLEGAL:\n-- star3 x x = '*'\n</code></pre>\n\n<p>Every <code>_</code> is distinct \u2013 two underscores are not the same thing as each other.  However, when we match against variables, all the variables we match against have to be distinct; you can't match against \"x\" twice.  (You can sort of think of <code>_</code> as a variable whose name is different each time.)</p></li>\n<li><p>You can't use <code>_</code> in expressions, only in patterns.</p>\n\n<pre><code>id2 :: a -&gt; a\n-- ILLEGAL:\n-- id1 _ = _\nid2 x = x\n</code></pre>\n\n<p>Because <code>_</code> doesn't \"remember\" what it matched against, as we saw above, you can never use it in an expression.  It's only ever a pattern.</p></li>\n</ol>\n"}], "owner": {"reputation": 831, "user_id": 2198297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1c9129d47811254fac68d8561c9a50c?s=128&d=identicon&r=PG", "display_name": "andro", "link": "https://stackoverflow.com/users/2198297/andro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 640, "favorite_count": 1, "accepted_answer_id": 43866145, "answer_count": 2, "score": 4, "last_activity_date": 1494322244, "creation_date": 1494317755, "question_id": 43864572, "link": "https://stackoverflow.com/questions/43864572/haskell-wildcard-symbol-usage", "title": "Haskell wildcard symbol usage", "body": "<p>In the source code for the Applicative instance for Maybe we have:</p>\n\n<pre><code>instance Applicative Maybe where\npure = Just\n\nJust f  &lt;*&gt; m       = fmap f m\nNothing &lt;*&gt; _m      = Nothing\n\nJust _m1 *&gt; m2      = m2\nNothing  *&gt; _m2     = Nothing\n</code></pre>\n\n<p>I had thought that '_' is used as a wildcard in patterns. What is the meaning here therefore of '_m' and '_m2' values? Is this a GHC coding convention? Is there some performance advantage to not using _?</p>\n"}, {"tags": ["haskell", "haskell-wai", "haskell-spock"], "answers": [{"tags": [], "owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "is_accepted": false, "score": 1, "last_activity_date": 1494356402, "creation_date": 1494356402, "answer_id": 43877888, "question_id": 43862270, "link": "https://stackoverflow.com/questions/43862270/capturing-parameters-from-a-post-request-in-spock/43877888#43877888", "title": "Capturing parameters from a POST request in Spock", "body": "<p>You can use the same  <code>param'</code> or <code>param</code> functions.\nFrom the documentation : </p>\n\n<blockquote>\n  <p>Read a request param. Spock looks POST variables first and then in GET\n  variable</p>\n</blockquote>\n"}], "owner": {"reputation": 2795, "user_id": 7978068, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/374ccc08f4ce2a4b5f59a0551a5eadee?s=128&d=identicon&r=PG&f=1", "display_name": "Jodimoro", "link": "https://stackoverflow.com/users/7978068/jodimoro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1494356402, "creation_date": 1494309961, "question_id": 43862270, "link": "https://stackoverflow.com/questions/43862270/capturing-parameters-from-a-post-request-in-spock", "title": "Capturing parameters from a POST request in Spock", "body": "<p>In the documentation of Spock, here <a href=\"https://www.spock.li/2015/04/19/type-safe_routing.html\" rel=\"nofollow noreferrer\">https://www.spock.li/2015/04/19/type-safe_routing.html</a>, it only describes how to capture parameters from a get request. I need to capture ones from a post. How can I do that?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1494307891, "post_id": 43861783, "comment_id": 74758845, "body": "Sounds like vault <a href=\"https://www.stackage.org/package/vault\" rel=\"nofollow noreferrer\">stackage.org/package/vault</a>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 8, "creation_date": 1494313202, "post_id": 43861783, "comment_id": 74761521, "body": "Also consider a <a href=\"https://hackage.haskell.org/package/dependent-map\" rel=\"nofollow noreferrer\"><code>dependent-map</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 860, "user_id": 1078730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114275b1f78cddd07b1e481382193d20?s=128&d=identicon&r=PG", "display_name": "Ganesh Bhambarkar", "link": "https://stackoverflow.com/users/1078730/ganesh-bhambarkar"}, "edited": false, "score": 3, "creation_date": 1494317274, "post_id": 43862181, "comment_id": 74764015, "body": "This will not work for me because for one map, the <code>a</code> is fixed. I want the <code>a</code> to be different for different keys. I think <code>dependent-map</code> will work for me."}], "tags": [], "owner": {"reputation": 1, "user_id": 5165894, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-48ex5OMUYSE/AAAAAAAAAAI/AAAAAAAAAD8/fgHf9gMdANE/photo.jpg?sz=128", "display_name": "Chris Parks", "link": "https://stackoverflow.com/users/5165894/chris-parks"}, "is_accepted": false, "score": 0, "last_activity_date": 1494309649, "creation_date": 1494309649, "answer_id": 43862181, "question_id": 43861783, "link": "https://stackoverflow.com/questions/43861783/haskell-map-where-type-of-key-determines-type-of-value/43862181#43862181", "title": "Haskell Map where type of key determines type of value", "body": "<p>You can use a type synonym to bind <code>a</code> so that it must be the same for your <code>KeyType</code> and <code>ValType</code>:</p>\n\n<pre><code>type MapFor a = Map (KeyType a) (ValType a)\n</code></pre>\n\n<p>Now you can use <code>MapFor a</code> (for some specific <code>a</code>) anywhere you would've used <code>Map (KeyType a) (ValType a)</code>.</p>\n"}], "owner": {"reputation": 860, "user_id": 1078730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114275b1f78cddd07b1e481382193d20?s=128&d=identicon&r=PG", "display_name": "Ganesh Bhambarkar", "link": "https://stackoverflow.com/users/1078730/ganesh-bhambarkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1494309649, "creation_date": 1494307602, "question_id": 43861783, "link": "https://stackoverflow.com/questions/43861783/haskell-map-where-type-of-key-determines-type-of-value", "title": "Haskell Map where type of key determines type of value", "body": "<p>Is there a way to use Data.Map in such a way that the type of value depends upon the type of key? I need to ensure that I am never inserting wrong typed value in the map.</p>\n\n<p>for example:\nLet's say I have types <code>KeyType a</code> and <code>ValType a</code>\nthen Map should have type similar to</p>\n\n<p><code>Map (KeyType a) (ValType a)</code></p>\n\n<p>But this obviously does not work because <code>a</code> is not bound.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1494278493, "post_id": 43857243, "comment_id": 74750739, "body": "Well, <code>foldr</code> takes a two-argument function, and <code>bubble</code> is only a one-argument function."}, {"owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1494279159, "post_id": 43857243, "comment_id": 74751000, "body": "okay, I don&#39;t understand how I could change bubble to be a two-argument function"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1494281327, "post_id": 43857243, "comment_id": 74751746, "body": "You should post the error messages and what specifically you don&#39;t understand about them. Also open ghci and do <code>:t foldr</code> and think carefully about what the arguments all do and hoe they line up with the ones you&#39;ve supplied"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494286995, "post_id": 43857243, "comment_id": 74753366, "body": "@Sophie For what it&#39;s worth, I think the reaction &quot;how can I change <code>bubble</code>&quot; is a dangerous one, because it is too narrow. You definitely need to change some part of the code, but just looking at two pieces that don&#39;t fit together and arbitrarily choosing one to cram into the hole left by the other one seems unwise. I encourage you to try to write <code>bubbleSorting</code> with manual recursion first, and then try to spot any recursive patterns only afterwards."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1494311328, "post_id": 43857243, "comment_id": 74760481, "body": "for any <code>f1 x</code> you can always define <code>f2 x y = f1 x</code>, or <code>f2 x y = f1 y</code>."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1494287190, "post_id": 43858061, "comment_id": 74753403, "body": "There is a logic error, but not only in <code>bubble</code> (assuming we want to actually perform a bubblesort): bubble-sort doesn&#39;t have the shape of a <code>foldr</code>, but of an <code>iterate</code> or similar."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494288967, "post_id": 43858061, "comment_id": 74753834, "body": "@Daniel Wagner I believe <code>bubbleSort</code> should take &quot;at most&quot; length many repetitions of an internal recursive function (<code>bubble</code> here) and if implemented by <code>foldr</code> might even turn out to be more efficient since it won&#39;t need to make a recursive call if <code>x &lt; y</code> anymore as the rest would already be sorted."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1494294918, "post_id": 43858061, "comment_id": 74755107, "body": "The sort described in this post is an insertion sort. If your algorithm doesn&#39;t consist of many passes of swapping adjacent inversions, it&#39;s not a bubble sort."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1494297521, "post_id": 43858061, "comment_id": 74755748, "body": "@Carl It&#39;s only insertion sort because it&#39;s built up incrementally from <code>foldr</code>. As long as <code>bubble</code> is unnecessarily in the <code>otherwise</code> branch it keeps swapping adjacent inversions (there aren&#39;t any) past the item bubbling up from the beginning of the list. This consists of many passes of swapping adjacent inversions and <i>still isn&#39;t bubble sort</i>. The difference between insertion sort and bubble sort is which items are included in each pass. Insertion sort excludes the first items from the early passes; bubble sort excludes the last items from the late passes."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1494297609, "post_id": 43858061, "comment_id": 74755765, "body": "@Carl Insertion sort can terminate early on each pass, improving its best case running time. Bubble sort can terminate early on the number of passes performed."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494311146, "post_id": 43858061, "comment_id": 74760392, "body": "@DanielWagner exactly. though <code>iterate f x !! n = foldr g x [1..n]</code> with some <code>g</code>."}, {"owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494341442, "post_id": 43858061, "comment_id": 74781284, "body": "@Cirdec Given if I changed the signature it would be an insertion sort, I defined <code>bubble&#39;</code> and I have now got a working programme - thanks"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1494344733, "post_id": 43858061, "comment_id": 74783697, "body": "@WillNess Sure. But, e.g., <code>dropWhile (uncurry (&#47;=)) . ap zip tail . iterate f</code> doesn&#39;t seem like it has a corresponding <code>foldr</code> form."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494361103, "post_id": 43858061, "comment_id": 74793193, "body": "@DanielWagner not very &quot;natural&quot; one, but it can be &quot;faked&quot; with <code>ap zip tail $ let {g i r x | x&#47;= y = r y | otherwise = repeat x where y = f x} in foldr g undefined [1..] x</code>. a natural would be an unfold, <code>unfoldr (\\x -&gt; [(x,y) | let y=f x, y&#47;=x])</code> (with MonadComprehensions for brevity); though there might be an off-by-one error there."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 2, "last_activity_date": 1494281911, "last_edit_date": 1494281911, "creation_date": 1494281603, "answer_id": 43858061, "question_id": 43857243, "link": "https://stackoverflow.com/questions/43857243/implementing-bubble-sort-using-foldr-haskell/43858061#43858061", "title": "implementing bubble sort using foldr haskell", "body": "<p>Your <code>bubble</code> function approximately inserts <code>x</code> into the sorted list <code>y:xs</code>. If we change the first pattern match from <code>[x]</code> to the equivalent <code>(x:[])</code> you can see that <code>bubble</code> always takes a value <code>x</code> and a remainder of the list (the list it's being inserted into), either <code>[]</code> or <code>y:xs</code>.</p>\n\n<pre><code>bubble :: (Ord a) =&gt; [a] -&gt; [a]\nbubble (x:[]) = [x]\nbubble (x:y:xs)\n   | x &gt; y = y : x:xs\n   | otherwise = x : bubble (y:xs)\n</code></pre>\n\n<p>This can be converted into a function that takes two arguments by removing the <code>:</code> constructor between <code>x</code> and the list it's being inserted into.</p>\n\n<pre><code>bubble :: (Ord a) =&gt; a -&gt; [a] -&gt; [a]\nbubble x [] = [x]\nbubble x (y:xs)\n   | x &gt; y = y : x:xs\n   | otherwise = x : bubble y xs\n</code></pre>\n\n<p>This is nice; it makes <code>bubble</code> a total function. It's no longer undefined on <code>[]</code> and is compatible with <code>foldr</code>.</p>\n\n<p>There's still a logic error in <code>bubble</code>. I suggest you try <code>bubbleSorting [10,9..1]</code>. You might be surprised by the result.</p>\n\n<hr>\n\n<p>If you don't want to change the signature of <code>bubble</code> you can instead define <code>bubble' x ys = bubble (x:ys)</code> and use <code>bubble'</code> in <code>foldr</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1494310703, "post_id": 43858933, "comment_id": 74760159, "body": "the bubble in bubble sort goes all the way through. your <code>bubble</code> performs an insertion into what it assumes to be a sorted list."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1494287605, "creation_date": 1494287605, "answer_id": 43858933, "question_id": 43857243, "link": "https://stackoverflow.com/questions/43857243/implementing-bubble-sort-using-foldr-haskell/43858933#43858933", "title": "implementing bubble sort using foldr haskell", "body": "<p>I guess you may implement the <code>bubbleSort</code> function with <code>foldr</code> as follows;</p>\n\n<pre><code>bubbleSort :: Ord a =&gt; [a] -&gt; [a]\nbubbleSort xs = foldr bubble [] xs\n                where\n                bubble x []     = [x]\n                bubble x (y:ys) | x &lt; y     = x:y:ys\n                                | otherwise = y:bubble x ys\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 902, "favorite_count": 0, "accepted_answer_id": 43858061, "answer_count": 2, "score": 0, "last_activity_date": 1494287605, "creation_date": 1494277478, "question_id": 43857243, "link": "https://stackoverflow.com/questions/43857243/implementing-bubble-sort-using-foldr-haskell", "title": "implementing bubble sort using foldr haskell", "body": "<p>I am trying to implement bubble sort using foldr but I keep getting error messages saying types not matching and I'm not understanding why.\nHere's my code:</p>\n\n<pre><code>bubble :: (Ord a) =&gt; [a] -&gt; [a]\nbubble [x] = [x]\nbubble (x:y:xs)\n   | x &gt; y = y : x:xs\n   | otherwise = x : bubble (y:xs)\n\nbubbleSorting :: (Ord a) =&gt; [a] -&gt; [a]\nbubbleSorting = foldr bubble []\n</code></pre>\n"}, {"tags": ["haskell", "persistent"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1494275780, "post_id": 43856794, "comment_id": 74749470, "body": "You could use the <a href=\"https://hackage.haskell.org/package/persistent-template-2.5.2/docs/Database-Persist-TH.html#v:derivePersistField\" rel=\"nofollow noreferrer\"><code>derivePersistField</code></a> Template Haskell function to derive the necessary instances for <code>persistent</code> to serialize and unserialize it."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 1, "last_activity_date": 1494310255, "creation_date": 1494310255, "answer_id": 43862334, "question_id": 43856794, "link": "https://stackoverflow.com/questions/43856794/mapping-haskell-type-to-postgres-database-with-persistent/43862334#43862334", "title": "Mapping Haskell type to Postgres database with Persistent", "body": "<p>What @Alexis king has said, is correct. You have to do\n<code>derivePersistField \"Status\"</code> to create appropriate\n<code>PersistField</code> instances.</p>\n\n<p>But you also have to derive the Show and Read instances of your\nsum type:</p>\n\n<pre><code>data Status = FirstViewed | Reviewed | Learned deriving (Show, Read, Eq)\n</code></pre>\n\n<p>Show and Read instances are needed because <code>derivePersistField</code>\nuses it to perform appropriate conversion when storing and\nretrieving from the database. Also the sum type has to be defined\nin a separate file because of stage restriction. You may also\nwant to look on the chapter of\n<a href=\"http://www.yesodweb.com/book/persistent\" rel=\"nofollow noreferrer\">peristent</a> where this\nis well documented.</p>\n"}], "owner": {"reputation": 234, "user_id": 6475907, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-xQd4dCvGOmg/AAAAAAAAAAI/AAAAAAAAABo/WuJS4WB_RNg/photo.jpg?sz=128", "display_name": "WellTyped", "link": "https://stackoverflow.com/users/6475907/welltyped"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 43862334, "answer_count": 1, "score": 1, "last_activity_date": 1494310255, "creation_date": 1494275538, "last_edit_date": 1494275987, "question_id": 43856794, "link": "https://stackoverflow.com/questions/43856794/mapping-haskell-type-to-postgres-database-with-persistent", "title": "Mapping Haskell type to Postgres database with Persistent", "body": "<p>I have a Haskell <code>Status</code> type:</p>\n\n<pre><code>data Status = FirstViewed | Reviewed | Learned\n</code></pre>\n\n<p>How can I map this data to Persistent Postgres database?</p>\n\n<pre><code>share [mkPersist sqlSettings, mkMigrate \"migrateAll\"] [persistLowerCase|\nVocabulary sql=vocabulary\n   word Text\n   date UTCTime\n   status Status\n   deriving Show\n|]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1494269980, "post_id": 43855292, "comment_id": 74746263, "body": "How is it not working? What error message do you get?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1494270041, "post_id": 43855292, "comment_id": 74746301, "body": "<code>div 42 0 == 0</code> looks quite wrong! And the recursive case looks wrong as well."}, {"owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494270444, "post_id": 43855292, "comment_id": 74746515, "body": "no error message, just got an infinite loop"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 2, "creation_date": 1494271658, "post_id": 43855292, "comment_id": 74747258, "body": "Your theory is that <code>4 &#47; 2</code> is equal to <code>4 &#47; (2 - 1) - 4</code> ? I am interested to know how people come to make mistakes in programming languages. Can you describe to me how it is you came to the conclusion that <code>div m n</code> is equal to <code>div m (n-1) - m</code> ?"}, {"owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "edited": false, "score": 0, "creation_date": 1494273024, "post_id": 43855292, "comment_id": 74747992, "body": "I tried to do the opposite of the multiply function, no wonder it wasn&#39;t working"}], "answers": [{"comments": [{"owner": {"reputation": 66, "user_id": 7954509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc539b417a3a7adb3ef62c0841bfa70f?s=128&d=identicon&r=PG&f=1", "display_name": "GrainOfSalt", "link": "https://stackoverflow.com/users/7954509/grainofsalt"}, "edited": false, "score": 0, "creation_date": 1494271095, "post_id": 43855511, "comment_id": 74746929, "body": "If you can&#39;t figure out how this should work, post an updated version of your code and I will take a look and walk you through the algorithm in more detail."}], "tags": [], "owner": {"reputation": 66, "user_id": 7954509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc539b417a3a7adb3ef62c0841bfa70f?s=128&d=identicon&r=PG&f=1", "display_name": "GrainOfSalt", "link": "https://stackoverflow.com/users/7954509/grainofsalt"}, "is_accepted": true, "score": 2, "last_activity_date": 1494270639, "creation_date": 1494270639, "answer_id": 43855511, "question_id": 43855292, "link": "https://stackoverflow.com/questions/43855292/implementing-the-library-function-div-in-haskell/43855511#43855511", "title": "Implementing the library function `div` in Haskell", "body": "<p>Are you supposed to handle the divide by 0 case? If so, then make a separate case for it. </p>\n\n<p>The base case for the division algorithm should be when a &lt; b. What should the algorithm spit out if say you have 4 / 7? \nThe recursive case should handle when a >= b. This should get you started for defining the div function on Natural numbers.</p>\n"}], "owner": {"reputation": 63, "user_id": 3019775, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c4d426512bdeed1206485530c34028d8?s=128&d=identicon&r=PG&f=1", "display_name": "newbie", "link": "https://stackoverflow.com/users/3019775/newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "accepted_answer_id": 43855511, "answer_count": 1, "score": 0, "last_activity_date": 1494270999, "creation_date": 1494269897, "question_id": 43855292, "link": "https://stackoverflow.com/questions/43855292/implementing-the-library-function-div-in-haskell", "title": "Implementing the library function `div` in Haskell", "body": "<p>I'm trying to implement my own version of the library function <code>div</code> in Haskell. Here's my solution to the problem but it is not working the way I hoped and I'm not sure how else I can implement it. Any help will be highly appreciated!</p>\n\n<pre><code>div' :: Int -&gt; Int -&gt; Int\ndiv' m n \n  |  n == 0     = 0\n  |  n &gt; 0      = div' m (n-1) - m\n</code></pre>\n"}, {"tags": ["haskell", "generic-programming"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1494284131, "post_id": 43855273, "comment_id": 74752610, "body": "Why three identical classes?"}, {"owner": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1494343652, "post_id": 43855273, "comment_id": 74782931, "body": "My logic was <code>HasSimpleParser</code> for primitive data types, <code>Parsable</code> for records with only fields that are primitive data types and <code>GenericallyParsable</code> for composite data types."}], "answers": [{"comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1494279376, "post_id": 43857293, "comment_id": 74751090, "body": "Gist with full example: <a href=\"https://gist.github.com/danidiaz/2a2ddb5dc120718012eced28200b56d5\" rel=\"nofollow noreferrer\">gist.github.com/danidiaz/2a2ddb5dc120718012eced28200b56d5</a>"}, {"owner": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "edited": false, "score": 0, "creation_date": 1494284762, "post_id": 43857293, "comment_id": 74752779, "body": "thanks a bunch. Let me play with the gist a little bit and come back to you if I end up with more questions!"}, {"owner": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "edited": false, "score": 0, "creation_date": 1494342889, "post_id": 43857293, "comment_id": 74782381, "body": "Works like a charm! Thank you very much. Though there is another tiny complication that needs to be taken care of: What about lists in the record? For example, <code>data C = Bool [Int]</code>? And possibly even more  complicated: <code>data D = [C] Double</code>? I guess I need sth. like <code>instance (HasParser c) =&gt; HasParser [c]</code> but I&#39;m not able to come up with the implementation."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "edited": false, "score": 0, "creation_date": 1494362393, "post_id": 43857293, "comment_id": 74793904, "body": "@user2812201 It depends on the type of your parser and on how lists are serialized (extra <code>\\NUL</code>?). Does your parser have an <code>Alternative</code> instance? If so, perhaps you could write something like megaparsec&#39;s <code>manyTill :: Alternative m =&gt; m a -&gt; m end -&gt; m [a]</code>"}, {"owner": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "edited": false, "score": 0, "creation_date": 1494364215, "post_id": 43857293, "comment_id": 74794819, "body": "my <code>String</code>, <code>Bool</code>, <code>Double</code> etc all end with a &#39;\\NUL&#39;. Is it possible to use <code>manyTill</code> or <code>many</code> combinators?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "edited": false, "score": 0, "creation_date": 1494364326, "post_id": 43857293, "comment_id": 74794867, "body": "@user2812201 On the wire, what differentiaties a list of two ints from a register with two int fields?"}, {"owner": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "edited": false, "score": 0, "creation_date": 1494364687, "post_id": 43857293, "comment_id": 74795031, "body": "Here is a little backgroud: I need to parse a stream of responses from the server. In the stream, every response is preceded by an id, which is an integer. I just parse the id first and then call the corresponding parser. So I guess the answer to your question is nothing differentiates the two responses, and I have to keep track by hand."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 2, "last_activity_date": 1494279935, "last_edit_date": 1494279935, "creation_date": 1494277729, "answer_id": 43857293, "question_id": 43855273, "link": "https://stackoverflow.com/questions/43855273/build-more-advanced-generic-parser/43857293#43857293", "title": "Build more advanced generic parser", "body": "<p>I think the <code>GenericallyParsable</code> typeclass is not necessary.</p>\n\n<p>Just define a <code>HasSimpleParser</code> instance for <code>A</code> that piggybacks on <code>Parsable</code>:</p>\n\n<pre><code>instance HasSimpleParser A where\n    getSimpleParser = getParser \n</code></pre>\n\n<p>If you end up declaring many instances of this type for your records, you can streamline it a little using <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#default-method-signatures\" rel=\"nofollow noreferrer\"><code>{-# language DefaultSignatures #-}</code></a> and changing the definition of <code>HasSimpleParser</code> to</p>\n\n<pre><code>class HasSimpleParser c where\n    getSimpleParser :: Parser c\n    default getSimpleParser :: Parsable c =&gt; Parser c\n    getSimpleParser = getParser\n</code></pre>\n\n<p>Now in the record instances you would only have to write:</p>\n\n<pre><code>instance HasSimpleParser A\n</code></pre>\n\n<hr>\n\n<p>In fact, perhaps even the distinction between <code>HasSimpleParser</code> and <code>Parsable</code> in unnecessary. A single <code>HasParser</code> typeclass with instances for both basic and composite types would be enough. The default implementation would use generics-sop and require a <code>(Generic r, Code r ~ '[xs], All HasParser xs)</code> constraint.</p>\n\n<pre><code>class HasParser c where\n    getParser :: Parser c\n    default getParser :: (Generic c, Code c ~ '[xs], All HasParser xs) =&gt; Parser c\n    getParser = ...generics-sop code here...\n</code></pre>\n"}], "owner": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1494279935, "creation_date": 1494269838, "last_edit_date": 1495540484, "question_id": 43855273, "link": "https://stackoverflow.com/questions/43855273/build-more-advanced-generic-parser", "title": "Build more advanced generic parser", "body": "<p>ok, here is a continuation of my previous question <a href=\"https://stackoverflow.com/questions/42583838/generically-build-parsers-from-custom-data-types/42586193#42586193\">(Generically) Build Parsers from custom data types?</a>. I took the advice and decided to build my parsers with generic-sop and all was going fine until now. </p>\n\n<p>I need to expand my implementation a little bit so more complicated situations can be dealt with. Namely, consider these two <code>data</code> definitions, where <code>B</code> is built on top of <code>A</code>:</p>\n\n<pre><code>data A = A String Int\n\ndata B = B A Double\n</code></pre>\n\n<p>In order to generically parse all <code>data</code> structures, I define the following <code>class</code>:</p>\n\n<pre><code>class HasSimpleParser f where\n  getSimpleParser :: Parser f\n\nclass Parsable f where\n  getParser :: Parser f\n\nclass GenericallyParsable f where\n  getGenericParser :: Parser f\n</code></pre>\n\n<p>The primitive types such as <code>Int, String, Double</code> etc can be made into instances of <code>HasSimpleParser</code> easily. Then I make data structure such as <code>A</code> an instance of <code>Parsable</code> by doing</p>\n\n<pre><code>instance (Generic r, Code r ~ '[xs], All HasSimpleParser xs) =&gt; Parsable r where\n  getParser = to . SOP. Z &lt;$&gt; hsequence (hcpure (Proxy @HasSimpleParser) getSimpleParser)\n</code></pre>\n\n<p>I introduce the class <code>GenericallyParsable</code> to parse data structure like <code>B</code>. So I do the following:</p>\n\n<pre><code> instance (Generic r, Code r ~ '[xs], All Parsable xs) =&gt; GenericallyParsable r where\n  getGenericParser = to . SOP. Z &lt;$&gt; hsequence (hcpure (Proxy @Parsable) getParser)\n</code></pre>\n\n<p>The last pieces of the puzzle are the parsing functions:</p>\n\n<pre><code>parseA :: InputStream ByteString -&gt; IO A\nparseA = parseFromStream (getGenericParser @A)\n\nparseB :: InputStream ByteString -&gt; IO B\nparseB = parseFromStream (getGenericParser @B)\n</code></pre>\n\n<p>However, the code won't compile and I got the following error:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018'['[Char, [Char]]]\u2019 with \u2018'[]\u2019\n    arising from a use of \u2018getGenericParser\u2019\n\u2022 In the first argument of \u2018parseFromStream\u2019, namely\n    \u2018(getGenericParser @A)\u2019\n  In the expression: parseFromStream (getGenericParser @A)\n  In an equation for \u2018parseA\u2019:\n      parseA = parseFromStream (getGenericParser @A)\n</code></pre>\n\n<p>So how should I modify the code to work? </p>\n"}, {"tags": ["haskell", "bit-shift", "fold", "rijndael", "bitwise-xor"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494267555, "post_id": 43854309, "comment_id": 74744952, "body": "What is the result you are looking for? Only <code>q2</code>, or all <code>qi</code>s?"}, {"owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494267618, "post_id": 43854309, "comment_id": 74744986, "body": "I only require q2."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 3, "creation_date": 1494267652, "post_id": 43854309, "comment_id": 74745010, "body": "I\u2019m not sure I understand what the problem is from the code you posted. Are you trying to use something other than <code>1</code>, <code>2</code>, <code>4</code> as the shift amount? Because what you wrote can be translated as a simple left fold, no? <code>sbox q = foldl&#39; (\\ q&#39; i -&gt; q&#39; `xor` shiftL q&#39; i) q [1, 2, 4]</code>"}, {"owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "edited": false, "score": 0, "creation_date": 1494267939, "post_id": 43854309, "comment_id": 74745171, "body": "Thank you, that works. But what I really wanted was the simple: <code>foldl&#39; (xor . shiftL) q</code>, which would work if it weren&#39;t for the <code>Int</code> that <code>shiftL</code> demands."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1494267955, "post_id": 43854309, "comment_id": 74745183, "body": "The <code>Bits</code> typeclass represents bitvectors with bitwise operations. Instances of <code>Bits</code> are not necessarily meant to be interpreted as integers. On the other hand, <code>Int</code> is very common as a type of indices of a vector. Hence, <code>shiftL</code> accepts an <code>Int</code>."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1494268094, "post_id": 43854309, "comment_id": 74745263, "body": "<code>xor . shiftL = \\q -&gt; xor (shiftL q)</code> wouldn&#39;t type check."}, {"owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "edited": false, "score": 0, "creation_date": 1494268395, "post_id": 43854309, "comment_id": 74745438, "body": "Thank you everyone, I guess I was just looking for a way to force the <code>Int</code> to accept <code>Bits</code>, since, though they&#39;re not always meant to represent integers, they certainly always can. But I&#39;ll live with it; I like what Jon Purdy wrote."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1494278695, "post_id": 43854309, "comment_id": 74750830, "body": "@sacheie: The problem with <code>xor . shiftL</code> isn\u2019t the mismatch between <code>Bits a =&gt; a</code> and <code>Int</code>, but rather the fact that it\u2019s not implicitly lifted over multiple arguments; to get the behaviour of <code>\\ q -&gt; xor q . shiftL q</code> point-free, you could use the <code>(a -&gt;)</code> applicative to write <code>liftA2 (.) xor shiftL</code>, or arrows to write <code>xor &amp;&amp;&amp; shiftL &gt;&gt;&gt; uncurry (.)</code>, but neither is very readable."}, {"owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "edited": false, "score": 0, "creation_date": 1494513396, "post_id": 43854309, "comment_id": 74870184, "body": "Thanks a lot Jon - the version with liftA2 was exactly what I was looking for. I guess readability is a matter of taste; I&#39;m not a big fan of lambda expressions."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1494267934, "creation_date": 1494267934, "answer_id": 43854775, "question_id": 43854309, "link": "https://stackoverflow.com/questions/43854309/how-to-work-around-haskells-int-shift-argument-in-a-fold-using-xor/43854775#43854775", "title": "How to work around Haskell&#39;s Int shift argument in a fold using xor?", "body": "<p><code>foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b</code> iteratively applies a function starting with a <code>b</code> to a list of <code>a</code>s until the list is exhausted and then returns the result. In this case our <code>a</code>s can be the <em>shift lengths</em>. So <code>1</code>, <code>2</code>, <code>4</code>. We can construct such a list with <code>iterate :: (a -&gt; a) -&gt; a -&gt; [a]</code>. Indeed:</p>\n\n<pre><code>powers2 = iterate (2*) 1\n</code></pre>\n\n<p>Now we can feed that list to <code>foldl</code>. The function <code>foldl</code> performs is <code>\\qi s -&gt; xor qi (shiftL qi s)</code>. So the complete function would be:</p>\n\n<pre><code>qn :: (Num a, Foldable t, Bits [a]) =&gt; Int -&gt; r -&gt; t Int -&gt; [a]\nqn n q = foldl (\\qi s -&gt; xor qi (shiftL qi s)) q $ take n $ iterate (2*) 1\n</code></pre>\n\n<p>So if we call <code>qn 3 q</code> we perform the function three times on <code>q</code> and thus obtain the <code>q2</code> in your example. For example:</p>\n\n<pre><code>Prelude Data.Bits&gt; qn 3 15\n1285\n</code></pre>\n\n<p>Since:</p>\n\n<pre><code>q           = 0000 0000 1111\nshiftL q  1 = 0000 0001 1110\n              --------------\nq0          = 0000 0001 0001\nshiftL q0 2 = 0000 0100 0100\n              --------------\nq1          = 0000 0101 0101\nshiftL q1 4 = 0101 0101 0000\n              --------------\nq2          = 0101 0000 0101\n</code></pre>\n\n<p>which is the binary equivalent of 1285.</p>\n"}, {"tags": [], "owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "is_accepted": true, "score": 0, "last_activity_date": 1494513503, "creation_date": 1494513503, "answer_id": 43918579, "question_id": 43854309, "link": "https://stackoverflow.com/questions/43854309/how-to-work-around-haskells-int-shift-argument-in-a-fold-using-xor/43918579#43918579", "title": "How to work around Haskell&#39;s Int shift argument in a fold using xor?", "body": "<p>Jon Purdy inferred what I should have stated clearly - I wanted a point-free function to pass to fold, and he provided one: <code>liftA2 (.) xor shiftL</code>.</p>\n"}], "owner": {"reputation": 726, "user_id": 1241445, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/sAWfj.png?s=128&g=1", "display_name": "sacheie", "link": "https://stackoverflow.com/users/1241445/sacheie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 43918579, "answer_count": 2, "score": 1, "last_activity_date": 1494513503, "creation_date": 1494266202, "last_edit_date": 1494268352, "question_id": 43854309, "link": "https://stackoverflow.com/questions/43854309/how-to-work-around-haskells-int-shift-argument-in-a-fold-using-xor", "title": "How to work around Haskell&#39;s Int shift argument in a fold using xor?", "body": "<p>I have some code (generating the Rijndael S-box, for fun) that looks like this:</p>\n\n<pre><code>q0 = q  \u2295  shiftL q  1\nq1 = q0 \u2295  shiftL q0 2\nq2 = q1 \u2295  shiftL q1 4\n</code></pre>\n\n<p>It seems kind of silly - wouldn't it be the perfect situation for a fold? But I can't use a fold because <code>shiftL</code> requires an <code>Int</code> for the distance to shift, and of course <code>xor</code> requires <code>Bits</code>.</p>\n\n<p>It seems awkward to me that a function meant to operate on <code>Bits</code> won't accept <code>Bits</code> for all its arguments. I'd be curious to hear the rational for that, but I'm more eager to know if there's any elegant way to achieve the fold I want.</p>\n"}, {"tags": ["haskell", "nix"], "comments": [{"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1565394873, "post_id": 43854235, "comment_id": 101353808, "body": "Not sure why question should be any different for Nix: <a href=\"https://stackoverflow.com/questions/36953396/how-to-list-the-installed-packages-in-cabal\" title=\"how to list the installed packages in cabal\">stackoverflow.com/questions/36953396/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "edited": false, "score": 0, "creation_date": 1494619822, "post_id": 43937339, "comment_id": 74924266, "body": "From your command <code>nix-store -q --references $out</code> I get a result of 11 lines. One very interesting line is <code>&#47;nix&#47;store&#47;34h4mj588w6q0q18izpxrc4wc0wqbfl4-ghc-8.0.2-with-p&zwnj;&#8203;ackages</code>, an other interesting line is <code>&#47;nix&#47;store&#47;knbj6a7b3ra8zawy1jmlvahmr8x7rxnd-ghcjs-0.2.0-with&zwnj;&#8203;-packages</code>. My interest is to know what is exactly behind <i>with-packages</i>. What are all these packages and their versions?"}, {"owner": {"reputation": 2585, "user_id": 1190453, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8bc78ac3f1246f30c55f3339c3e7586f?s=128&d=identicon&r=PG", "display_name": "danbst", "link": "https://stackoverflow.com/users/1190453/danbst"}, "reply_to_user": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "edited": false, "score": 0, "creation_date": 1494622526, "post_id": 43937339, "comment_id": 74925499, "body": "try to run <code>nix-store -q --references </code> for ghc-with-packages line"}, {"owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "edited": false, "score": 0, "creation_date": 1494692720, "post_id": 43937339, "comment_id": 74942012, "body": "Yes, the command <code>nix-store -q --references &#47;nix&#47;store&#47;34h4mj588w6q0q18izpxrc4wc0wqbfl4-ghc-8.0.2-with-p&zwnj;&#8203;ackages</code> generates an interesting list. Thanks!"}], "tags": [], "owner": {"reputation": 2585, "user_id": 1190453, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8bc78ac3f1246f30c55f3339c3e7586f?s=128&d=identicon&r=PG", "display_name": "danbst", "link": "https://stackoverflow.com/users/1190453/danbst"}, "is_accepted": true, "score": 3, "last_activity_date": 1494590627, "creation_date": 1494590627, "answer_id": 43937339, "question_id": 43854235, "link": "https://stackoverflow.com/questions/43854235/nix-shell-how-to-list-the-installed-haskell-package-versions/43937339#43937339", "title": "Nix shell: How to list the installed Haskell package versions", "body": "<p>You can try to <code>nix-store -q --references $out</code> after you entered the shell. This will, however, mix both haskell and non-haskell dependencies in output. </p>\n\n<p>This is a complete example with filter applied:</p>\n\n<p><code>\n  $ nix-store -q --references $out \\\n    | while read p; do du -a $p | grep -q ghc &amp;&amp; echo $p; done\n</code></p>\n"}], "owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1072, "favorite_count": 1, "accepted_answer_id": 43937339, "answer_count": 1, "score": 4, "last_activity_date": 1494590627, "creation_date": 1494265985, "question_id": 43854235, "link": "https://stackoverflow.com/questions/43854235/nix-shell-how-to-list-the-installed-haskell-package-versions", "title": "Nix shell: How to list the installed Haskell package versions", "body": "<p>As a <em>non-nix'er</em> I installed the newest version of <a href=\"https://github.com/reflex-frp/reflex-platform\" rel=\"nofollow noreferrer\">https://github.com/reflex-frp/reflex-platform</a>. I think working in this nix-shell is a nice experience.</p>\n\n<p>Now I want to know which Haskell packages in which versions are installed and used in this shell. After some googling I found a <em>nix-env</em> command in the following form:</p>\n\n<p><code>nix-env -f '&lt;nixpkgs&gt;' -qaPA haskellPackages|grep reflex-dom</code></p>\n\n<p>This command gives me the version of reflex-dom as <em>reflex-dom-0.3</em>. But I know from <a href=\"https://github.com/reflex-frp/reflex-dom/blob/develop/reflex-dom/default.nix\" rel=\"nofollow noreferrer\">here</a> that in my nix shell I use the newest version <em>0.4</em> of reflex-dom. So I assume the above command just lists the available Hackage packages.</p>\n\n<p>What is the correct <em>nix-env -q</em> command to get only the installed Haskell packages and its versions?. </p>\n\n<p>(I played with the --installed option, however I never got something back)</p>\n"}, {"tags": ["haskell", "web-crawler"], "answers": [{"comments": [{"owner": {"reputation": 234, "user_id": 6475907, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-xQd4dCvGOmg/AAAAAAAAAAI/AAAAAAAAABo/WuJS4WB_RNg/photo.jpg?sz=128", "display_name": "WellTyped", "link": "https://stackoverflow.com/users/6475907/welltyped"}, "edited": false, "score": 0, "creation_date": 1494267701, "post_id": 43854494, "comment_id": 74745030, "body": "Apart from the customized user agent string, is there anything else I should simulate?"}], "tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": true, "score": 2, "last_activity_date": 1494266837, "creation_date": 1494266837, "answer_id": 43854494, "question_id": 43853789, "link": "https://stackoverflow.com/questions/43853789/haskell-http-client-set-user-agent-string/43854494#43854494", "title": "Haskell http-client set User Agent String", "body": "<p>User agent is a <a href=\"https://tools.ietf.org/html/rfc1945#page-46\" rel=\"nofollow noreferrer\">HTTP header</a>, so you just use an API for setting headers. E.g. <a href=\"http://hackage.haskell.org/package/http-client-0.5.6.1/docs/Network-HTTP-Client.html#v:requestHeaders\" rel=\"nofollow noreferrer\"><code>requestHeaders</code></a> in <code>http-client</code> (note that it is a setter, so you can use it as <code>request{requestHeaders=blah}</code>)</p>\n"}], "owner": {"reputation": 234, "user_id": 6475907, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-xQd4dCvGOmg/AAAAAAAAAAI/AAAAAAAAABo/WuJS4WB_RNg/photo.jpg?sz=128", "display_name": "WellTyped", "link": "https://stackoverflow.com/users/6475907/welltyped"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 43854494, "answer_count": 1, "score": 0, "last_activity_date": 1494266837, "creation_date": 1494264565, "question_id": 43853789, "link": "https://stackoverflow.com/questions/43853789/haskell-http-client-set-user-agent-string", "title": "Haskell http-client set User Agent String", "body": "<p>I'm writing a web crawler in Haskell with Scalpel.\nBasic code are:</p>\n\n<pre><code>Main :: IO ()\nMain = do\n  request &lt;- parseRequest weblink\n  p &lt;- httpLBS request &gt;&gt;= return . getResponseBody\n\n  result &lt;- do\n    r &lt;- return $ scrapeStringLike (L8.unpack p) torrentS\n    return . fromJust $ r\n\n  -- append\n  mapM_ putStrLn $ result\n</code></pre>\n\n<p>The target website doesn't return the results. I suppose it checks the user agent string and respond differently to a real browser and a crawler.</p>\n\n<p>So how should I customize the User Agent String in <code>http-client</code>?\nor <code>wreq?</code></p>\n"}, {"tags": ["user-interface", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 1367, "user_id": 1160885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc61c1b2045efa54375188bdb6a33945?s=128&d=identicon&r=PG", "display_name": "Jedai", "link": "https://stackoverflow.com/users/1160885/jedai"}, "edited": false, "score": 0, "creation_date": 1494270880, "post_id": 43852185, "comment_id": 74746781, "body": "This exact thing was provided in the thread you reference. Your question is thus pretty vague... Do you want more in depth explanations ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1494274734, "post_id": 43852185, "comment_id": 74748909, "body": "Slow progress is more or less to be expected. When one is used to one programming language paradigm, and moves to a different one, a significant effort is required. I&#39;d guess that moving from imperative&amp;procedural to imperative&amp;OOP is easier than, say, imperative&amp;OOP to functional, especially to pure functional like Haskell. Yet, precisely because it&#39;s so different, it&#39;s worth learning."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 7150642, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153854821602676/picture?type=large", "display_name": "Talal Zahid", "link": "https://stackoverflow.com/users/7150642/talal-zahid"}, "edited": false, "score": 1, "creation_date": 1494783099, "post_id": 43861386, "comment_id": 74963704, "body": "Thanks. This helped a lot"}], "tags": [], "owner": {"reputation": 532, "user_id": 660339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ba401042a68ed65c16f73c8cf3a15287?s=128&d=identicon&r=PG", "display_name": "Ivan Perez", "link": "https://stackoverflow.com/users/660339/ivan-perez"}, "is_accepted": true, "score": 0, "last_activity_date": 1494305553, "last_edit_date": 1495541411, "creation_date": 1494305553, "answer_id": 43861386, "question_id": 43852185, "link": "https://stackoverflow.com/questions/43852185/user-interface-and-menu-in-haskell/43861386#43861386", "title": "User-interface and Menu in Haskell", "body": "<p>Based on <a href=\"https://stackoverflow.com/a/38553473/660339\">this answer</a>, I've created this:</p>\n\n<pre><code>import System.IO (stdin, hSetEcho, hSetBuffering, BufferMode(NoBuffering), hReady)\nimport Control.Monad (when)\n\ngetKey = reverse &lt;$&gt; getKey' \"\"\n  where getKey' chars = do\n          char &lt;- getChar\n          more &lt;- hReady stdin\n          (if more then getKey' else return) (char:chars)\n\n-- Simple menu controller\nmain = do\n  hSetBuffering stdin NoBuffering\n  hSetEcho stdin False\n  key &lt;- getKey\n  when (key /= \"\\ESC\") $ do\n    case key of\n      \"w\"     -&gt; putStrLn \"\u2191\"\n      \"s\"     -&gt; putStrLn \"\u2193\"\n      \"d\"     -&gt; putStrLn \"\u2192\"\n      \"a\"     -&gt; putStrLn \"\u2190\"\n      \"\\n\"    -&gt; putStrLn \"\u2386\"\n      \"\\DEL\"  -&gt; putStrLn \"\u238b\"\n      _       -&gt; return ()\n    main\n</code></pre>\n\n<p>[<a href=\"https://stackoverflow.com/a/38553473/660339\">1</a>] also shows how to detect arrow key presses, which is cool! Changing the line buffering of stdin is important.</p>\n\n<p>You'll probably want your application loop to have some initial application state, and pass it around as an argument.</p>\n"}], "owner": {"reputation": 123, "user_id": 7150642, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10153854821602676/picture?type=large", "display_name": "Talal Zahid", "link": "https://stackoverflow.com/users/7150642/talal-zahid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 1, "accepted_answer_id": 43861386, "answer_count": 1, "score": 1, "last_activity_date": 1494305553, "creation_date": 1494259105, "last_edit_date": 1495540043, "question_id": 43852185, "link": "https://stackoverflow.com/questions/43852185/user-interface-and-menu-in-haskell", "title": "User-interface and Menu in Haskell", "body": "<p>I am creating social network in haskell based on graphs. The problem is that I want to create a user interface for people to interact. This user interface should consists of text that shows what the options are and based on key inputs, users can search the database and perform actions on the data set.</p>\n\n<p>What I have already done:</p>\n\n<p>-Explored this thread \"<a href=\"https://stackoverflow.com/questions/2799588/simple-text-menu-in-haskell\">Simple text menu in Haskell</a>\"</p>\n\n<p>-Installed packages such as haskelline</p>\n\n<p>Problem is that I have just started learning Haskell and the progress has been damn slow compared to my experience with other languages, so I havent benefitted from the above resources to an extent that has solved my problem.</p>\n\n<p>Would someone be kind enough to share a template consisting of a CL interface menu screen. That asks users to press keys mapped for different functions. Then after output, goes back to the main menu. </p>\n\n<p>Here is an example of what my functions look like.</p>\n\n<pre><code>isFriend :: Node -&gt; Node -&gt; [Edge] -&gt; Bool\nisFriend _ _ [] = False\nisFriend a b (x:xs)\n | edgeCompare a b x == True = True\n | otherwise = isFriend a b xs\n</code></pre>\n\n<p>So the menu could say \"press I\" to search for friends, that would prompt the user to enter a name. This would run my function with the argument inputted by the user.</p>\n\n<p>Thank you :)</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1494282137, "post_id": 43855592, "comment_id": 74752011, "body": "Could you explain what sorts of measures must be taken to ensure that the array doesn&#39;t accidentally point to any thunks outside the region? Speaking of which, I&#39;m wondering if GHC Core should recognize a primitive array type that can only contain forced values (as though each element were marked with a <code>!</code>). The runtime representation would be the same, but there&#39;d be no risk of double forcing."}, {"owner": {"reputation": 5267, "user_id": 1102851, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e1866c32c13460429d2f9ba066949bc?s=128&d=identicon&r=PG", "display_name": "bgamari", "link": "https://stackoverflow.com/users/1102851/bgamari"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1494297931, "post_id": 43855592, "comment_id": 74755856, "body": "I&#39;ve added notes on the matter near the end."}, {"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "edited": false, "score": 0, "creation_date": 1494462392, "post_id": 43855592, "comment_id": 74843033, "body": "It would be nice if there was a good way to validate that nothing had actually gone awry. Even if <code>swapArray</code> had been misdefined (eg, by being insufficiently strict with the result of <code>readArray#</code>), this example would probably still work. We wouldn&#39;t see any problems until a GC ran and then something in the compact was pointing to a garbage address. Even then, it might take several GCs before a segfault happens. It seems like it would be nice to have a primop that could check that a compact was still valid. Granted, for people not trying to do weird stuff, this primop would be worthless."}, {"owner": {"reputation": 5267, "user_id": 1102851, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e1866c32c13460429d2f9ba066949bc?s=128&d=identicon&r=PG", "display_name": "bgamari", "link": "https://stackoverflow.com/users/1102851/bgamari"}, "edited": false, "score": 0, "creation_date": 1494472970, "post_id": 43855592, "comment_id": 74845409, "body": "Indeed it would be nice if there were a better way to test things like this; locally I tested this with much higher values of <code>n</code> than I cited here to ensure that there was plenty of opportunities for the garbage collector to run wild. That being said, this method is obviously far from perfect."}, {"owner": {"reputation": 5267, "user_id": 1102851, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e1866c32c13460429d2f9ba066949bc?s=128&d=identicon&r=PG", "display_name": "bgamari", "link": "https://stackoverflow.com/users/1102851/bgamari"}, "edited": false, "score": 0, "creation_date": 1494473050, "post_id": 43855592, "comment_id": 74845431, "body": "I should mention that the debug RTS also supports a number of sanity checks (enabled with the <code>+RTS -D</code> flags) which can catch some classes of issues. I don&#39;t know off hand what bugs, if any, they would catch in the above example, however."}, {"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "edited": false, "score": 0, "creation_date": 1494508379, "post_id": 43855592, "comment_id": 74866026, "body": "@bgamari Thanks. I&#39;ll look into the sanity checks. Also, I realized that there&#39;s something in your answer that doesn&#39;t totally click in my mind. When someone calls <code>unsafeFreezeArray#</code>, it seems like they would end up with an immutable value that can point to younger generations. It <a href=\"https://ghc.haskell.org/trac/ghc/browser/ghc/compiler/codeGen/StgCmmPrim.hs#L384\" rel=\"nofollow noreferrer\">doesn&#39;t seem like</a> GHC changes the frozen array to be in generation 0, so I don&#39;t understand how this works with garbage collection."}, {"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "edited": false, "score": 0, "creation_date": 1494509214, "post_id": 43855592, "comment_id": 74866730, "body": "nevermind, just found out about <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Rts/Storage/GC/EagerPromotion\" rel=\"nofollow noreferrer\">eager promotion</a>, which answers my question."}], "tags": [], "owner": {"reputation": 5267, "user_id": 1102851, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e1866c32c13460429d2f9ba066949bc?s=128&d=identicon&r=PG", "display_name": "bgamari", "link": "https://stackoverflow.com/users/1102851/bgamari"}, "is_accepted": true, "score": 11, "last_activity_date": 1494297926, "last_edit_date": 1494297926, "creation_date": 1494270897, "answer_id": 43855592, "question_id": 43851375, "link": "https://stackoverflow.com/questions/43851375/mutable-array-in-ghc-compact-region/43855592#43855592", "title": "Mutable Array in GHC Compact Region", "body": "<p>This is an interesting idea and while it's a all quite subtle, I believe you can get away with it.</p>\n\n<p>As you point out, the garbage collector needs to track which arrays are mutable as they may contain references to objects residing in younger generations than that of the array itself. Objects on this list will serve as roots when collecting younger generations.</p>\n\n<p>To see why, imagine that you allocate (in the nursery, generation 0) a mutable array with some pointers to other newly-allocated heap objects. On garbage collection, both the array and its contents will be moved to generation 1, meaning that it won't need to be traversed when we scavenge for generation 0.</p>\n\n<p>Now imagine that we allocate a new heap object in generation 0 and mutate an array element to reference it. Now consider what happens when we garbage collect the nursery: if we look only at references within generation 0, we will mistakenly conclude that our newly allocated object is dead. This is obviously wrong: our new object is live via its reference from the array in generation 1.</p>\n\n<p>For this reason, we must maintain a mutable object list for each generation, which we will scavenge as roots when we collect younger generations.</p>\n\n<p>However, as your intuition suggested, this should be unnecessary in a compact region as we shouldn't be scavenging the region's contents anyways. Moreover, since the heap representation of <code>MutableArray#</code> and <code>Array#</code> are identical (other than the info table pointer), your use of <code>unsafeCoerce#</code> should be fine.</p>\n\n<p>All of this is naturally contingent on carefully preserving the closure invariant that compact regions obey. This requires that all computation eventually reduce to some sort of lookup in the region. Strictly speaking even this isn't quite enough as Haskell's semantics don't guarantee that a copy won't be produced, but in the case of GHC Haskell this shouldn't be a problem.</p>\n\n<h1>An Example</h1>\n\n<p>Here's a small playground that I used to test this.</p>\n\n<pre><code>{-# LANGUAGE MagicHash #-}\n{-# LANGUAGE UnboxedTuples #-}\n{-# LANGUAGE BangPatterns #-}\n\nimport GHC.IO\nimport GHC.Compact\nimport GHC.Exts hiding (toList)\n\ndata Wombat = Wombat String deriving Show\n\nn = 10000\n\nwombats :: [Wombat]\nwombats = take n $ cycle $ map Wombat [ \"harry\", \"jerry\", \"carry\", \"larry\", \"fred\" ]\n\nmain :: IO ()\nmain = do\n    c &lt;- fromListM (length wombats) wombats &gt;&gt;= compact\n    let arr = getCompact c\n    flip mapM_ [1..n-1] $ \\i -&gt; do\n        swapMutArray i ((i+2) `mod` n) arr\n    mapM_ print (toList arr)\n    return ()\n\n(!) :: MutArray a -&gt; Int -&gt; a\n(!) (MutArray a) (I# n) =\n    case indexArray# a n of\n      (# x #) -&gt; x\n\ndata MutArray a = MutArray (Array# a)\n\ngetMutArray :: MutArray a -&gt; MutableArray# s a\ngetMutArray (MutArray arr) = unsafeCoerce# arr\n\nfromListM :: Int -&gt; [a] -&gt; IO (MutArray a)\nfromListM = \\n@(I# n#) xs -&gt;\n    IO $ \\s0 -&gt; case newArray# n# x0 s0 of\n                  (# s1, arr #) -&gt; unIO (go arr (n-1) xs) s1\n  where\n    x0 = error \"hi\"\n    go arr (-1) [] = IO $ \\s0 -&gt; case unsafeFreezeArray# arr s0 of\n                                   (# s1, arr' #) -&gt; (# s1, MutArray arr' #)\n    go arr n@(I# n#) (x:xs) = do\n        IO $ \\s0 -&gt; case writeArray# arr n# x s0 of s1 -&gt; (# s1, () #)\n        go arr (n-1) xs\n    go _ _ _ = error \"uh oh\"\n\ntoList :: Show a =&gt; MutArray a -&gt; [a]\ntoList arr@(MutArray arr#) = go 0\n  where\n    !len = I# (sizeofArray# arr#)\n    go n\n      | n == len = []\n      | otherwise = (arr ! n) : go (n + 1)\n\nwriteMutArray :: Int -&gt; a -&gt; MutArray a -&gt; IO ()\nwriteMutArray (I# i) x arr =\n    IO $ \\s0 -&gt; case writeArray# (getMutArray arr) i x s0 of s1 -&gt; (# s1, () #)\n\nswapMutArray :: Int -&gt; Int -&gt; MutArray a -&gt; IO ()\nswapMutArray m@(I# m#) n@(I# n#) arr = do\n    !x &lt;- IO $ readArray# (getMutArray arr) m#\n    !y &lt;- IO $ readArray# (getMutArray arr) n#\n    writeMutArray n x arr\n    writeMutArray m y arr\n</code></pre>\n"}], "owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1171, "favorite_count": 4, "accepted_answer_id": 43855592, "answer_count": 1, "score": 16, "last_activity_date": 1494510780, "creation_date": 1494256777, "last_edit_date": 1494510780, "question_id": 43851375, "link": "https://stackoverflow.com/questions/43851375/mutable-array-in-ghc-compact-region", "title": "Mutable Array in GHC Compact Region", "body": "<p>I'm trying to figure out if it's possible to put a <code>MutableArray#</code> in\na compact region. Doing this is explicitly discouraged by <a href=\"https://ghc.haskell.org/trac/ghc/ticket/13508\" rel=\"nofollow noreferrer\">ghc devs</a>\nand by <a href=\"https://downloads.haskell.org/~ghc/master/libraries/html/compact/Data-Compact.html\" rel=\"nofollow noreferrer\">the documentation</a>\nbecause it allows users to point to something outside of the <code>Compact</code>.\nThat aside, I'm still interested in trying to do this, with the understanding\nthat I would be responsible for ensuring that the array only point to things\ninside the same <code>Compact</code>.</p>\n\n<p>My line of thinking was to add an <code>Array#</code> to a compact region and then\nattempt to thaw it using <code>unsafeThawArray#</code>:</p>\n\n<pre><code>unsafeThawArray# :: Array# a -&gt; State# s -&gt; (#State# s, MutableArray# s a#)\n</code></pre>\n\n<p>I should then be able to use <code>writeArray#</code>, provided that (a) everything I\nwrite into the <code>MutableArray#</code> is in the same compact region and (b) I\nevaluate everything to WHNF with <code>seq</code> before writing it to the array. I think this would be safe. I do have one concern based on the \n<a href=\"https://ghc.haskell.org/trac/ghc/browser/ghc/rts/PrimOps.cmm#L261\" rel=\"nofollow noreferrer\">stg_unsafeThawArrayzh commentary</a>:</p>\n\n<blockquote>\n  <p>A MUT_ARR_PTRS lives on the mutable list, but a MUT_ARR_PTRS_FROZEN normally doesn't...</p>\n</blockquote>\n\n<p>I don't understand the internals of GHC well, but here is my understanding of the comment:\nThere is something called the mutable list, which has a bunch of mutable arrays and\nis occassionally scan by the GC. For my purposes, this is problematic, since it means\nthat <code>unsafeThawArray#</code> will cause the GC to start scanning things in a compact region.\nThat's not good. But, maybe my understanding is wrong, which would be great.</p>\n\n<p>If <code>unsafeThawArray#</code> cannot do what I need, I was thinking that <code>unsafeCoerce#</code> would\ndo it, but I again I'd like to hear from someone knowledgeable on this subject. Thanks and let me know if I can clarify anything.</p>\n\n<p>EDIT: Just a comment for future readers. After thinking about this more, I realized that using <code>SmallArray#</code> instead of <code>Array#</code> would be better. It should make writes faster. Compare the code for <a href=\"https://ghc.haskell.org/trac/ghc/browser/ghc/compiler/codeGen/StgCmmPrim.hs#L1381\" rel=\"nofollow noreferrer\">writing to MutableArray#</a> with the code for <a href=\"https://ghc.haskell.org/trac/ghc/browser/ghc/compiler/codeGen/StgCmmPrim.hs#L2089\" rel=\"nofollow noreferrer\">writing to SmallMutableArray#</a>. The card table that <code>MutableArray#</code> keeps updated is worthless when everything is on the compact heap since it's never going to get scanned anyway.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 23557, "user_id": 12266, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6a2a454191fa75d4114ed05836a0b924?s=128&d=identicon&r=PG", "display_name": "Andrew Jaffe", "link": "https://stackoverflow.com/users/12266/andrew-jaffe"}, "edited": false, "score": 0, "creation_date": 1494256627, "post_id": 43851207, "comment_id": 74738365, "body": "You can build this up from two separate functions: the first one actually does the merge, and the second one takes the sum. However, combining these (by &quot;composition&quot;) should be done in a functional way: <code>f(g(x))</code> as math functions, or <code>f g x</code> in Haskell. Note, also, that the type of the sum is not <code>[a]</code>, but <code>a</code>, and also that <code>return</code> does not mean what you think it means in Haskell."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1494256671, "post_id": 43851207, "comment_id": 74738398, "body": "also, <code>return</code> is not what you it is in Haskell."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 2, "creation_date": 1494256680, "post_id": 43851207, "comment_id": 74738404, "body": "<a href=\"http://stackoverflow.com/questions/15323927/whats-so-special-about-return-keyword\"><code>return</code></a> doesn&#39;t mean what you think it does"}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1583939112, "post_id": 43851351, "comment_id": 107281818, "body": "also, <code>sum . map sum</code>. :)"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 6, "last_activity_date": 1494260019, "last_edit_date": 1494260019, "creation_date": 1494256720, "answer_id": 43851351, "question_id": 43851207, "link": "https://stackoverflow.com/questions/43851207/how-to-do-multiple-actions-in-this-haskell-list-function/43851351#43851351", "title": "How to do multiple actions in this Haskell list function?", "body": "<p>right now the only thing you get is a compile time error, complaining about multiple errors in your code - I guess the best thing would be to read a bit about haskell syntax (e.g. <a href=\"http://learnyouahaskell.com\" rel=\"nofollow noreferrer\">http://learnyouahaskell.com</a>)</p>\n\n<pre><code>merge :: [[a]] -&gt; [a]\n</code></pre>\n\n<p>You have to add a typeclass constraint, so you can add the elements of a list - right now you say your function works on all possible elements you can and cannot think of.</p>\n\n<pre><code>merge:: Num a =&gt; [[a]] -&gt; [a]\n</code></pre>\n\n<p>to sum after the \"merging\" you have to declare an intermediate variable if you want to write it like you started.</p>\n\n<pre><code>merge xss = let tmp = foldr (++) [] xss\n            in sum tmp\n</code></pre>\n\n<p>or you can write it a bit shorter</p>\n\n<pre><code>merge xs = sum $ concat xs\n</code></pre>\n\n<p>or pointfree if you want to even shorter</p>\n\n<pre><code>merge = sum . concat\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1494293173, "post_id": 43859567, "comment_id": 74754744, "body": "(I&#39;m aware there is an existing answer with many suggestions; however, none of those directly show the asker how to write the code s/he appeared to be trying to write, without any other changes)"}], "tags": [], "owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "is_accepted": false, "score": 1, "last_activity_date": 1494293103, "creation_date": 1494293103, "answer_id": 43859567, "question_id": 43851207, "link": "https://stackoverflow.com/questions/43851207/how-to-do-multiple-actions-in-this-haskell-list-function/43859567#43859567", "title": "How to do multiple actions in this Haskell list function?", "body": "<p>You want to call <code>foldr</code> with some arguments, and then call <code>sum</code> with the result of <code>foldr</code>.</p>\n\n<p>You can do that easily by writing:</p>\n\n<pre><code>merge xss = sum (foldr (++) [] xss)\n</code></pre>\n\n<p>You do not need to write multiple \"statements\".</p>\n"}], "owner": {"reputation": 175, "user_id": 7137698, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/73a2bcd04ae13a5ea09112f4bbc6cd4c?s=128&d=identicon&r=PG&f=1", "display_name": "Anil ", "link": "https://stackoverflow.com/users/7137698/anil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 753, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1494293103, "creation_date": 1494256340, "question_id": 43851207, "link": "https://stackoverflow.com/questions/43851207/how-to-do-multiple-actions-in-this-haskell-list-function", "title": "How to do multiple actions in this Haskell list function?", "body": "<p>I am coming from Python and it is quite hard for me to learn Haskell. For example I got this function which will merge lists. So the first thing is merging the lists then I want to return the sum of the merged list. How is the correct syntax?</p>\n\n<pre><code>merge:: [[a]] -&gt; [a]\nmerge xss = foldr (++) [] xss\n            return sum []\n</code></pre>\n\n<p>This piece of code will only work if I remove the last line. But I want to return the sum of the merged lists.</p>\n"}, {"tags": ["parsing", "haskell", "input", "greatest-common-divisor"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1494256168, "post_id": 43850946, "comment_id": 74738035, "body": "wild guess - are you mixing tabs and spaces? - turn on <code>-Wall</code> -there should be a warning then about that or do a search and replace <code>s&#47;\\t&#47;    &#47;g</code> just to be sure"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1494256318, "post_id": 43850946, "comment_id": 74738139, "body": "I put it in a file + a <code>where gcd = undefined</code> and it compiled w/o any problems"}], "answers": [{"tags": [], "owner": {"reputation": 732, "user_id": 4036668, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/uXyvB.jpg?s=128&g=1", "display_name": "Anton Savelyev", "link": "https://stackoverflow.com/users/4036668/anton-savelyev"}, "is_accepted": false, "score": 2, "last_activity_date": 1494271380, "creation_date": 1494271380, "answer_id": 43855747, "question_id": 43850946, "link": "https://stackoverflow.com/questions/43850946/haskell-error-parse-error-on-input/43855747#43855747", "title": "haskell error parse error on input &#39;|&#39;", "body": "<p>On the last line, gcd needs to be applied on 2 arguments. You are only applying it to one -> (mod a b). Also, as others mentioned, you are probably mixing up your spaces and tabs. I recommend only using spaces.</p>\n\n<p>One more thing, when defining the GCD function, it was probably intended for you NOT to use the predefined gcd function in your implementation.</p>\n"}], "owner": {"reputation": 3, "user_id": 7981376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/857b322490bb7127d34d1348e773dde5?s=128&d=identicon&r=PG&f=1", "display_name": "RickRilled", "link": "https://stackoverflow.com/users/7981376/rickrilled"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 406, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494271380, "creation_date": 1494255527, "question_id": 43850946, "link": "https://stackoverflow.com/questions/43850946/haskell-error-parse-error-on-input", "title": "haskell error parse error on input &#39;|&#39;", "body": "<p>I'm trying to write a Greatest Common Divisor function in haskell. This is what I have so far:</p>\n\n<pre><code>gcd1 :: Int -&gt; Int -&gt; Int\ngcd1 a b\n    | a == 0 = b\n    | b == 0 = a\n    | otherwise = gcd (mod a b)\n</code></pre>\n\n<p>When I try to compile, I get that error. I've read about how haskell uses white space to determine where a functions declaration starts and where the body begins, but I keep trying with different amount of spaces and get the same error. Is there something I'm missing?</p>\n"}, {"tags": ["haskell", "stm"], "comments": [{"owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 0, "creation_date": 1494253178, "post_id": 43849619, "comment_id": 74735981, "body": "Why do you want to restore async exceptions here? If <code>requestPostSTM</code> allocates resource, then it should be executed with async exceptions masked. Note that <code>atomically</code> is interruptable."}, {"owner": {"reputation": 970, "user_id": 6464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0403a2339c5e4ae8cc7e22ddf3cf300d?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/6464/anton"}, "reply_to_user": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 0, "creation_date": 1494253489, "post_id": 43849619, "comment_id": 74736186, "body": "<code>requestPostSTM</code> internally writes to a bounded chan and might retry. Maybe that&#39;s just my perfectionism, but it seems legit to allow aborting that transaction by an async exception."}, {"owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "edited": false, "score": 1, "creation_date": 1494255830, "post_id": 43849619, "comment_id": 74737805, "body": "<code>STM</code> action, that retries, will be aborted by async exception, if any, even if async exceptions are masked, see <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Exception.html#g:13\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.9.1.0/docs/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 970, "user_id": 6464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0403a2339c5e4ae8cc7e22ddf3cf300d?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/6464/anton"}, "edited": false, "score": 0, "creation_date": 1494266224, "post_id": 43851257, "comment_id": 74744143, "body": "Somehow I missed the whole concept of interruptible actions. This solves my problem, thanks!"}], "tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": true, "score": 2, "last_activity_date": 1494257015, "last_edit_date": 1494257015, "creation_date": 1494256482, "answer_id": 43851257, "question_id": 43849619, "link": "https://stackoverflow.com/questions/43849619/unmask-async-exceptions-in-stm-transaction/43851257#43851257", "title": "Unmask async exceptions in STM transaction", "body": "<p>It is better to call <code>requestPostSTM</code> with async exceptions masked. All <code>STM</code> actions, that retries, are <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Exception.html#g:13\" rel=\"nofollow noreferrer\">interruptible</a>, so they will be aborted in case of async exception, yet exception can't arrive in unexpected point. The rule is: if your action allocates resource (i.e. something, that should be deallocated), then you should run it with async exceptions masked, and rely on interruptible actions to abort the action at some known points (or pull async exceptions with <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Exception.html#v:allowInterrupt\" rel=\"nofollow noreferrer\"><code>allowInterrupt</code></a> manually).</p>\n"}], "owner": {"reputation": 970, "user_id": 6464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0403a2339c5e4ae8cc7e22ddf3cf300d?s=128&d=identicon&r=PG", "display_name": "Anton", "link": "https://stackoverflow.com/users/6464/anton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 43851257, "answer_count": 1, "score": 1, "last_activity_date": 1494257015, "creation_date": 1494251846, "question_id": 43849619, "link": "https://stackoverflow.com/questions/43849619/unmask-async-exceptions-in-stm-transaction", "title": "Unmask async exceptions in STM transaction", "body": "<p>I have a function that posts a request to an STM channel and then blocks the thread waiting for that request's completion. If my blocked thread is terminated by an async exception then I want to post a cancellation request to that STM channel. It currently looks like this:</p>\n\n<pre><code>runRequest channel request = mask $ \\restore -&gt; do\n  (reqId, resultVar) &lt;- restore . atomically $ requestPostSTM channel request\n  onException\n    (restore . atomically $ do\n      maybeResult &lt;- readTVar resultVar\n      case maybeResult of\n        Just x -&gt; return x\n        Nothing -&gt; retry)\n    (atomically $ requestCancelSTM channel reqId)\n</code></pre>\n\n<p>This is almost what I need, but there is a small possibility that async exception would arrive right after <code>requestPostSTM</code> transaction succeeds, but still before we exit <code>restore</code> block. If this happens, then I will have my request posted, but wouldn't be able to post a cancellation for it.</p>\n\n<p>Ideally I would like to change the second line to something like</p>\n\n<pre><code>  (reqId, resultVar) &lt;- atomically . restore $ requestPostSTM channel request\n</code></pre>\n\n<p>This way I would be sure that no async exception could sneak in after I have <code>requestPostSTM</code> transaction commited. But this, of course, doesn't compile because <code>restore</code> is <code>IO a -&gt; IO a</code>, not <code>STM a -&gt; STM a</code>.</p>\n\n<p>Is there any way I could unmask async exceptions only for duration of my STM transaction? Or maybe another way to have a guarantee that either an async exception arrives and my first STM transaction aborts or my first STM transaction commits and no async exception could terminate my thread until I install a handler for it with <code>onException</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1494237327, "post_id": 43844648, "comment_id": 74725115, "body": "What error do you get?"}, {"owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "reply_to_user": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1494237746, "post_id": 43844648, "comment_id": 74725398, "body": "soemthing very Long:"}, {"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1494237786, "post_id": 43844648, "comment_id": 74725428, "body": "Please include it in the question text (use the <a href=\"http://stackoverflow.com/posts/43844648/edit\">edit</a> button)."}, {"owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "reply_to_user": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1494237832, "post_id": 43844648, "comment_id": 74725458, "body": "* Couldn&#39;t match type <code>[Char]&#39; with </code>[a] -&gt; [a]&#39;       Expected type: ([a] -&gt; [a]) -&gt; [Char] -&gt; [Char]         Actual type: [Char] -&gt; [Char]     * Relevant bindings include         f2 :: ([a] -&gt; [a]) -&gt; [Char] -&gt; [Char9     * Couldn&#39;t match type <code>[Char]&#39; with </code>Char&#39;       Expected type: [Char]         Actual type: [[Char]]     * In the expression: x : f2 tail x   In the expression:         if elem &#39;?&#39; x then &quot;F:&quot; ++ head x : f2 tail x else x : f2 tail x       In an equation for `f2&#39;:           f2 x             = if elem &#39;?&#39; x then &quot;F:&quot; ++ head x : f2 tail x else x : f2 tail x"}, {"owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "reply_to_user": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1494237858, "post_id": 43844648, "comment_id": 74725472, "body": "I dont really understand what it say"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1494244158, "post_id": 43844648, "comment_id": 74729444, "body": "the code you gave will not produce the error from your comments - it will just complain about <code>[Char]</code> vs <code>Char</code> and it&#39;s easy to see why, as you have <code>elem &#39;?&#39; x</code> =&gt; <code>x ~ [Char]</code> but then <code>&quot;F:&quot; ++ head x</code> =&gt; <code>x ~ [[Char]]</code> and now the type checker cannot unify <code>Char</code> with <code>[Char]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 1, "last_activity_date": 1494243435, "last_edit_date": 1494243435, "creation_date": 1494243009, "answer_id": 43846533, "question_id": 43844648, "link": "https://stackoverflow.com/questions/43844648/rewrite-code-without-pattern/43846533#43846533", "title": "rewrite Code without pattern", "body": "<h3>remark:</h3>\n\n<p>I think your <em>task</em>/<em>exercise</em> is to rewrite this using a <em>higher-order function</em> - in this case it seems to be a simple <code>map</code>:</p>\n\n<pre><code>f2 = map check\n  where\n    check xs =\n      if elem '?' xs\n      then \"F:\" ++ xs\n      else xs\n</code></pre>\n\n<hr>\n\n<h3>but just in case here is how to fix yours:</h3>\n\n<pre><code>f2 [] = []\nf2 xss =\n  if elem '?' (head xss)\n  then [\"F:\" ++ head xss] : f2 (tail xss)\n  else [head xss] : f2 (tail xss)\n</code></pre>\n\n<p>changes are:</p>\n\n<ul>\n<li><code>f2 [] = []</code> not <code>= 0</code></li>\n<li><code>elem '?' x</code> to <code>elem '?' head x</code></li>\n<li><code>else (x : ...</code> to <code>else [head x] ..</code></li>\n<li>also renamed <code>x</code> into <code>xss</code> to indicate that it's a list of lists</li>\n</ul>\n\n<hr>\n\n<p>basically all I did was replace <code>head xss</code> in where there pattern matching one had <code>x</code> and <code>tail xss</code> where it had <code>xs</code></p>\n"}], "owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494243435, "creation_date": 1494237248, "question_id": 43844648, "link": "https://stackoverflow.com/questions/43844648/rewrite-code-without-pattern", "title": "rewrite Code without pattern", "body": "<p>How Can I rewrite this Code without pattern Matching: </p>\n\n<pre><code>    data StringList = NilSL\n        | ConsSL String StringList\n\n    f2 [] = []\n    f2 (x:xs) = if elem '?' x then [\"F:\" ++ x] : f2 (xs) else [x] : f2 (xs)\n</code></pre>\n\n<p>I already write something like this, but I only get an error. </p>\n\n<pre><code>    import Data.Char\n\n    data StringList = NilSL\n        | ConsSL String StringList\n\n    f2 [] = 0 \n    f2 x = if elem '?' x then [\"F:\" ++ (head x)] : f2 (tail x) else (x : f2 (tail x)\n</code></pre>\n\n<p>What is wrong here?\nThank you for your help :) </p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1494227707, "post_id": 43841573, "comment_id": 74719564, "body": "Try doing: <code>stack upgrade --binary-only</code>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1494227887, "post_id": 43841573, "comment_id": 74719671, "body": "This sounds like the Sierra upgrade issue. Sibi&#39;s suggestion should deal with it. For details, cf. <a href=\"http://stackoverflow.com/q/41531416/2751851\">this question</a>, as well as Stack issue <a href=\"https://github.com/commercialhaskell/stack/issues/2577\" rel=\"nofollow noreferrer\">#2577</a> and its duplicate <a href=\"https://github.com/commercialhaskell/stack/issues/2841\" rel=\"nofollow noreferrer\">#2841</a>. (N.B.: I don&#39;t use OS X, and only know the issue secondhand.)"}, {"owner": {"reputation": 45252, "user_id": 326389, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d2c037ce48d12bd88ec6529f9bb39f0a?s=128&d=identicon&r=PG", "display_name": "at.", "link": "https://stackoverflow.com/users/326389/at"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1494277203, "post_id": 43841573, "comment_id": 74750205, "body": "@Sibi - <code>--binary-only</code> didn&#39;t work for me unfortunately, doesn&#39;t seem to be a recognized option. I posted the result in the question as it didn&#39;t format nicely in this comment."}], "owner": {"reputation": 45252, "user_id": 326389, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d2c037ce48d12bd88ec6529f9bb39f0a?s=128&d=identicon&r=PG", "display_name": "at.", "link": "https://stackoverflow.com/users/326389/at"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1494277335, "creation_date": 1494226778, "last_edit_date": 1494277335, "question_id": 43841573, "link": "https://stackoverflow.com/questions/43841573/haskell-tool-stack-upgrade-not-working", "title": "Haskell tool stack upgrade not working", "body": "<p>I'm trying to upgrade <code>stack</code> on my MacBook from v1.2.0 to the latest v1.4.0. When I try <code>stack upgrade</code> it ends with the following error. How can I get this to work?</p>\n\n<pre><code>stack-1.4.0: build\nPreprocessing library stack-1.4.0...\n[  1 of 124] Compiling Text.PrettyPrint.Leijen.Extended ( src/Text/PrettyPrint/Leijen/Extended.hs, .stack-work/dist/x86_64-osx/Cabal-1.22.5.0/build/Text/PrettyPrint/Leijen/Extended.o )\n[  2 of 124] Compiling Hackage.Security.Client.Repository.HttpLib.HttpClient ( src/Hackage/Security/Client/Repository/HttpLib/HttpClient.hs, .stack-work/dist/x86_64-osx/Cabal-1.22.5.0/build/Hackage/Security/Client/Repository/HttpLib/HttpClient.o )\n[  3 of 124] Compiling Stack.Options.ScriptParser ( src/Stack/Options/ScriptParser.hs, .stack-work/dist/x86_64-osx/Cabal-1.22.5.0/build/Stack/Options/ScriptParser.o )\n[  4 of 124] Compiling Stack.Ghci.Script ( src/Stack/Ghci/Script.hs, .stack-work/dist/x86_64-osx/Cabal-1.22.5.0/build/Stack/Ghci/Script.o )\n[  5 of 124] Compiling Stack.FileWatch  ( src/Stack/FileWatch.hs, .stack-work/dist/x86_64-osx/Cabal-1.22.5.0/build/Stack/FileWatch.o )\n[  6 of 124] Compiling System.Process.PagerEditor ( src/System/Process/PagerEditor.hs, .stack-work/dist/x86_64-osx/Cabal-1.22.5.0/build/System/Process/PagerEditor.o )\n[  7 of 124] Compiling System.Process.Log ( src/System/Process/Log.hs, .stack-work/dist/x86_64-osx/Cabal-1.22.5.0/build/System/Process/Log.o )\n[  8 of 124] Compiling Paths_stack      ( .stack-work/dist/x86_64-osx/Cabal-1.22.5.0/build/autogen/Paths_stack.hs, .stack-work/dist/x86_64-osx/Cabal-1.22.5.0/build/Paths_stack.o )\n[  9 of 124] Compiling Path.Find        ( src/Path/Find.hs, .stack-work/dist/x86_64-osx/Cabal-1.22.5.0/build/Path/Find.o )\n[ 10 of 124] Compiling Path.Extra       ( src/Path/Extra.hs, .stack-work/dist/x86_64-osx/Cabal-1.22.5.0/build/Path/Extra.o )\n[ 11 of 124] Compiling System.Process.Read ( src/System/Process/Read.hs, .stack-work/dist/x86_64-osx/Cabal-1.22.5.0/build/System/Process/Read.o )\nghc: panic! (the 'impossible' happened)\n  (GHC version 7.10.3 for x86_64-apple-darwin):\n        Loading temp shared object failed: dlopen(/var/folders/x3/y7dgvx7j0lx1clp5vsrlt3p40000gn/T/ghc61111_0/libghc_68.dylib, 5): no suitable image found.  Did find:\n        /var/folders/x3/y7dgvx7j0lx1clp5vsrlt3p40000gn/T/ghc61111_0/libghc_68.dylib: malformed mach-o: load commands size (49368) &gt; 32768\n\nPlease report this as a GHC bug:  http://www.haskell.org/ghc/reportabug\n\nCompleted 26 action(s).\n\n--  While building package stack-1.4.0 using:\n      /private/var/folders/x3/y7dgvx7j0lx1clp5vsrlt3p40000gn/T/stack-upgrade57904/stack-1.4.0/.stack-work/dist/x86_64-osx/Cabal-1.22.5.0/setup/setup --builddir=.stack-work/dist/x86_64-osx/Cabal-1.22.5.0 build lib:stack exe:stack --ghc-options \" -ddump-hi -ddump-to-file\"\n    Process exited with code: ExitFailure 1\n</code></pre>\n\n<p><strong>Update</strong>: @Sibi suggested I try <code>stack upgrade --binary-only</code>:</p>\n\n<pre><code>$ stack upgrade --binary-only\nInvalid option `--binary-only'\n\nUsage: stack upgrade [--git] [--git-repo ARG] [--help]\n  Upgrade to the latest stack (experimental)\n</code></pre>\n"}, {"tags": ["haskell", "data-structures", "stack", "recursive-datastructures"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494223655, "post_id": 43840774, "comment_id": 74717519, "body": "<a href=\"https://en.wikipedia.org/wiki/Stack_(abstract_data_type)#Applications\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Stack_(abstract_data_type)#Application&zwnj;&#8203;s</a>"}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494378212, "post_id": 43840774, "comment_id": 74798871, "body": "@luqui I have edited the question. Would you please check it?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494379850, "post_id": 43840774, "comment_id": 74799229, "body": "what would you like me to check?  Is something not working as intended?"}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494380228, "post_id": 43840774, "comment_id": 74799281, "body": "@luqui You put my question on hold. I have edited it to follow the site guidelines. I would like it to be resumed."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494380405, "post_id": 43840774, "comment_id": 74799325, "body": "Oh I see. The problem remains.  You have given some apparently working code, so there&#39;s no specific question about the code, and the question you have asked, which is the same question as before (examples of problems solved with stacks) is still too broad."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494380430, "post_id": 43840774, "comment_id": 74799337, "body": "Also, what exactly are you asking for that is not covered in the wikipedia page and the answer given?  Do you just want more people&#39;s opinions?"}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494381737, "post_id": 43840774, "comment_id": 74799637, "body": "No, I want more problems/exercises without baggage. I don&#39;t want to explain what are context free grammars, trees, search strategies, and so on in order to use stacks in some meaningful way."}, {"owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1494804624, "post_id": 43840774, "comment_id": 74969457, "body": "@duplode, I tried to delete the question but SO didn&#39;t allowed me. I still belive that It is a valid question, so I have edited the question again to narrow the search, in order to lift the [close tag]."}], "answers": [{"tags": [], "owner": {"reputation": 13895, "user_id": 1162233, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e3Eil.jpg?s=128&g=1", "display_name": "Kaidul", "link": "https://stackoverflow.com/users/1162233/kaidul"}, "is_accepted": false, "score": 2, "last_activity_date": 1494349952, "last_edit_date": 1494349952, "creation_date": 1494223714, "answer_id": 43840847, "question_id": 43840774, "link": "https://stackoverflow.com/questions/43840774/searching-for-simple-problems-naturally-solved-using-stacks/43840847#43840847", "title": "Searching for simple problems naturally solved using stacks", "body": "<p>Though this question is too broad, I am going to give some other applications. Some of other common applications are -</p>\n\n<ol>\n<li>Parsing</li>\n<li>Recursive Function</li>\n<li>Calling Function</li>\n<li>Expression Evaluation</li>\n<li>Expression Conversion\n\n<ul>\n<li>Infix to Postfix</li>\n<li>Infix to Prefix</li>\n<li>Postfix to Infix</li>\n<li>Prefix to Infix</li>\n</ul></li>\n<li>Towers of Hanoi</li>\n</ol>\n\n<p>Some details can be found <a href=\"https://en.wikipedia.org/wiki/Stack_(abstract_data_type)#Applications\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 403, "user_id": 6872977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Da7XT.jpg?s=128&g=1", "display_name": "Rom&#225;n Garc&#237;a", "link": "https://stackoverflow.com/users/6872977/rom%c3%a1n-garc%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "closed_date": 1494224414, "answer_count": 1, "score": 0, "last_activity_date": 1494804221, "creation_date": 1494223346, "last_edit_date": 1494804221, "question_id": 43840774, "link": "https://stackoverflow.com/questions/43840774/searching-for-simple-problems-naturally-solved-using-stacks", "closed_reason": "Needs more focus", "title": "Searching for simple problems naturally solved using stacks", "body": "<p>I would like to know about simple problems that can be naturally solved using stacks with the usual interface (<code>emptyS</code>, <code>isEmptyS</code>, <code>push</code>, <code>pop</code>, <code>top</code>).</p>\n\n<p>The complexity asociated to the context of the problem should be null. I can't touch topics like parsing, compiling or search algorithms at this moment. This discards many classical examples.</p>\n\n<p>The most beautiful example I found so far is checking for balanced parenthesis in strings. In very few lines, without any other background, the exercise shows the utility of the data structure:</p>\n\n<p>Another good example is procesing a string where the asterisk means to pop an item from the stack and a letter means to push it into the stack. The function must return the stack after the operations described in the string are applied to an empty stack.</p>\n\n<p>If you can share some others problems, I will apreciate it very much.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["haskell", "monad-transformers"], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1494227868, "post_id": 43840589, "comment_id": 74719661, "body": "If you expand the types without the <code>newtype</code> constructors, you find they both unroll to <code>r -&gt; Maybe a</code>, which is a good hint that they might be the same.  But there are some cases where the monad operators will have different behavior even though they have the same type, e.g. <code>ListT (State s)</code> vs <code>StateT s []</code>.  (This is because <code>ListT</code> is kind of broken... but that makes it a good example in cases like this!)"}, {"owner": {"reputation": 677, "user_id": 4379906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8bfb9836f54ce1972b614cfdb13bbdde?s=128&d=identicon&r=PG&f=1", "display_name": "kbridge4096", "link": "https://stackoverflow.com/users/4379906/kbridge4096"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1494231725, "post_id": 43840589, "comment_id": 74721720, "body": "I found that <code>ReaderT Maybe</code> and <code>MaybeT Reader</code> is really a special pair. And what make a pair like this is the same &quot;inner shape&quot; (the remain things after geting rid of all type constructors and lambdas(<code>\\a -&gt;</code>) of a monad value). By the way, for a logged computation which may fails, <code>MaybeT Writer</code> and <code>WriterT Maybe</code> are different: the former will fails with <code>(Nothing, &quot;first N lines of log&quot;)</code>, while the latter with only <code>Nothing</code>."}], "tags": [], "owner": {"reputation": 677, "user_id": 4379906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8bfb9836f54ce1972b614cfdb13bbdde?s=128&d=identicon&r=PG&f=1", "display_name": "kbridge4096", "link": "https://stackoverflow.com/users/4379906/kbridge4096"}, "is_accepted": true, "score": 5, "last_activity_date": 1494223547, "last_edit_date": 1494223547, "creation_date": 1494222554, "answer_id": 43840589, "question_id": 43840588, "link": "https://stackoverflow.com/questions/43840588/use-readert-maybe-or-maybet-reader/43840589#43840589", "title": "Use ReaderT Maybe or MaybeT Reader?", "body": "<p>Finally I figure it out. Both of them are OK.</p>\n\n<p>Assume every config item's value is just an Int.</p>\n\n<p>The <code>ReaderT ConfigMap Maybe Int</code> will have a value like:</p>\n\n<pre><code>ReaderT (\\r -&gt; Just 123)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>ReaderT (\\r -&gt; Nothing)\n</code></pre>\n\n<p>The <code>MaybeT (Reader ConfigMap) Int</code> will have a value like:</p>\n\n<pre><code>MaybeT (Reader (\\r -&gt; Just 123))\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>MaybeT (Reader (\\r -&gt; Nothing))\n</code></pre>\n\n<p>With either, we can first do some read, then decide whether we should continue according whether the read returns a <code>Nothing</code>. The values have different outer shapes but the same functionality.</p>\n\n<p>My little demo here:</p>\n\n<pre><code>import qualified Data.Map as M\nimport Control.Monad\nimport Control.Monad.Reader\nimport Control.Monad.Trans\nimport Control.Monad.Trans.Maybe\n\ntype Config = M.Map String Int\n\ngetConfig :: String -&gt; MaybeT (Reader Config) Int\ngetConfig key = MaybeT $ do\n  m &lt;- ask\n  return $ M.lookup key m\n\nreadAll :: Config -&gt; Maybe (Int, Int)\nreadAll m =\n  let r = runMaybeT $ do\n      a &lt;- getConfig \"a\"\n      b &lt;- getConfig \"b\"\n      return (a, b)\n  in runReader r m\n\nmain :: IO ()\nmain = do\n  putStrLn $ show (readAll $ M.fromList [(\"x\", 3), (\"b\", 4)])\n</code></pre>\n\n<p>My second demo:</p>\n\n<pre><code>import qualified Data.Map as M\nimport Control.Monad\nimport Control.Monad.Reader\nimport Control.Monad.Trans\nimport Control.Monad.Trans.Maybe\n\ntype Config = M.Map String Int\n\ngetConfig :: String -&gt; ReaderT Config Maybe Int\ngetConfig key = ReaderT $ \\r -&gt; M.lookup key r\n\nreadAll :: Config -&gt; Maybe (Int, Int)\nreadAll m =\n  let r = runReaderT $ do\n      a &lt;- getConfig \"a\"\n      b &lt;- getConfig \"b\"\n      return (a, b)\n  in r m\n\nmain :: IO ()\nmain = do\n  putStrLn $ show (readAll $ M.fromList [(\"a\", 3), (\"b\", 4)])\n</code></pre>\n"}], "owner": {"reputation": 677, "user_id": 4379906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8bfb9836f54ce1972b614cfdb13bbdde?s=128&d=identicon&r=PG&f=1", "display_name": "kbridge4096", "link": "https://stackoverflow.com/users/4379906/kbridge4096"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 1, "accepted_answer_id": 43840589, "answer_count": 1, "score": 5, "last_activity_date": 1494223547, "creation_date": 1494222554, "question_id": 43840588, "link": "https://stackoverflow.com/questions/43840588/use-readert-maybe-or-maybet-reader", "title": "Use ReaderT Maybe or MaybeT Reader?", "body": "<p>I want to write a haskell program reading config and do something. The config is a <code>Data.Map</code> and will be injected into a Reader. And when we can't find a config item, the reading should be interrupted. Just stopped, no error messages are required. So I just want a Maybe monad(not Either monad).</p>\n\n<p>The problem is, how should I stack the two monads, <code>ReaderT Maybe</code> or <code>MaybeT Reader</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1494220636, "post_id": 43840192, "comment_id": 74716403, "body": "<code>ReaderT.ask</code> is the <code>ask</code> from the qualified import of <code>ReaderT</code>. The <code>ask</code> being referred to is <a href=\"https://hackage.haskell.org/package/transformers-0.5.4.0/docs/Control-Monad-Trans-Reader.html#v:ask\" rel=\"nofollow noreferrer\">this one</a>."}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 3, "last_activity_date": 1494222257, "creation_date": 1494222257, "answer_id": 43840521, "question_id": 43840192, "link": "https://stackoverflow.com/questions/43840192/whats-the-monadreaders-instance-defined-mean/43840521#43840521", "title": "what&#39;s the MonadReader&#39;s Instance defined mean?", "body": "<p>The second <code>ask</code> isn't from any instance at all. It's a normal function defined in <a href=\"https://hackage.haskell.org/package/transformers-0.5.4.0/docs/Control-Monad-Trans-Reader.html#v:ask\" rel=\"nofollow noreferrer\"><code>Control.Monad.Trans.Reader</code></a> (and its type is <code>Monad m =&gt; ReaderT r m r</code>).</p>\n\n<p>It's like doing the following:</p>\n\n<pre><code>data Color = Red | Green | Blue\n\nmyShow :: Color -&gt; String\nmyShow c = case c of\n    Red   -&gt; \"(red)\"\n    Green -&gt; \"(green)\"\n    Blue  -&gt; \"(blue)\"\n\ninstance Show Color where\n    show = myShow\n</code></pre>\n\n<p>Here <code>myShow</code> plays the role of <code>ReaderT.ask</code> as a separate function.</p>\n"}], "owner": {"reputation": 5756, "user_id": 1436450, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/49ade21b14846e41684616c6e7209db3?s=128&d=identicon&r=PG", "display_name": "Chinaxing", "link": "https://stackoverflow.com/users/1436450/chinaxing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 43840521, "answer_count": 1, "score": 1, "last_activity_date": 1494222257, "creation_date": 1494220404, "question_id": 43840192, "link": "https://stackoverflow.com/questions/43840192/whats-the-monadreaders-instance-defined-mean", "title": "what&#39;s the MonadReader&#39;s Instance defined mean?", "body": "<p>The <code>MonadReader</code>'s Instance <code>MonadReader r (ReaderT rm)</code> was defined as following :</p>\n\n<pre><code>instance Monad m =&gt; MonadReader r (ReaderT r m) where\n    ask = ReaderT.ask\n    local = ReaderT.local\n    reader = ReaderT.reader\n</code></pre>\n\n<p>in <code>ask = ReaderT.ask</code>, the second ask is what MonadReader Instance ?</p>\n\n<p>Thank you very much:)</p>\n"}, {"tags": ["haskell", "opengl"], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 455232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7523d392f17e1fc3863e3edadc1bd8e9?s=128&d=identicon&r=PG", "display_name": "Lokathor", "link": "https://stackoverflow.com/users/455232/lokathor"}, "edited": false, "score": 0, "creation_date": 1494226062, "post_id": 43840223, "comment_id": 74718668, "body": "How very strange. I got shader compile/link errors at first and then they went away with revisions but I kept not seeing the triangle. Some sort of  difference in how the driver reports errors perhaps? I figured it had to be something I did when trying to convert C to Haskell, but this is also my first time using anything from Foreign so I wasn&#39;t clear where things had gone off the rails."}, {"owner": {"reputation": 149158, "user_id": 524368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/oZ8Up.png?s=128&g=1", "display_name": "datenwolf", "link": "https://stackoverflow.com/users/524368/datenwolf"}, "edited": false, "score": 2, "creation_date": 1494229862, "post_id": 43840223, "comment_id": 74720680, "body": "The whole &quot;splitting the shader source into lines&quot; business is messed up anyway. Just pass it as one single long string. <code>glShaderSource</code> being able to take multiple source strings that are concatenated internally is to allow for easy reuse of shader building blocks that are required throughout multiple source. Like for example if one has a certain set of uniforms that are to be specified for vertex and fragment shaders or in multiple shaders."}, {"owner": {"reputation": 605, "user_id": 455232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7523d392f17e1fc3863e3edadc1bd8e9?s=128&d=identicon&r=PG", "display_name": "Lokathor", "link": "https://stackoverflow.com/users/455232/lokathor"}, "edited": false, "score": 0, "creation_date": 1494254814, "post_id": 43840223, "comment_id": 74737109, "body": "Yeah I&#39;ve never really used C++, and it was unclear how those literals were being shoved directly together. I&#39;ll simplify it down to &quot;getSrcPointers :: String -&gt; IO (Ptr (Ptr GLchar), Ptr GLint)&quot; for now, and I can make it process a [String] later when I need to. Seems like there&#39;s going to be a lot of small places to make the whole gl process more ergonomic."}, {"owner": {"reputation": 1454, "user_id": 1683902, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2d00f9a657d663d31fde89af0b2e6851?s=128&d=identicon&r=PG", "display_name": "Ian Young", "link": "https://stackoverflow.com/users/1683902/ian-young"}, "edited": false, "score": 0, "creation_date": 1494321253, "post_id": 43840223, "comment_id": 74766636, "body": "I&#39;ll add this: <code>&quot;color = vec4(1.0f, 0.5f, 0.2f, 1.0f);\\n&quot;,</code> You don&#39;t need the <code>f</code> to denote floating point number in a shader. They use single precision by default."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 3, "last_activity_date": 1494220602, "creation_date": 1494220602, "answer_id": 43840223, "question_id": 43839540, "link": "https://stackoverflow.com/questions/43839540/why-doesnt-this-opengl-example-draw-the-triangle/43840223#43840223", "title": "Why doesn&#39;t this OpenGL example draw the triangle?", "body": "<p>Note that when I compile and run your program, I get shader compile and program link errors.  Specifically, I get errors:</p>\n\n<pre><code>Vertex Shader Compile Error:\n0:1(18): error: syntax error, unexpected $end\n\nFragment Shader Compile Error:\n0:1(18): error: syntax error, unexpected $end\n</code></pre>\n\n<p>and there are link errors too, of course.</p>\n\n<p>On closer inspection, your <code>glShaderSource</code> calls are flawed.  Though they are passing arrays of line pointers and line lengths for six lines per shader, the line count argument is <code>1</code>.  If I modify the last line of <code>getSrcPointer</code> to return the line count:</p>\n\n<pre><code>return (linesPtrsPtr,lengthsPtr, (fromIntegral.length) linesLengths)\n</code></pre>\n\n<p>and then pass this count to the <code>glShaderSource</code> calls in each case:</p>\n\n<pre><code>(linesPtrsPtr,lengthsPtr,count) &lt;- getSrcPointer vertexShaderSource\nglShaderSource vertexShader count linesPtrsPtr lengthsPtr\n...\n(linesPtrsPtr,lengthsPtr,count) &lt;- getSrcPointer fragmentShaderSource\nglShaderSource fragmentShader count linesPtrsPtr lengthsPtr\n</code></pre>\n\n<p>then your program works fine.</p>\n\n<p>Happy triangling!</p>\n"}], "owner": {"reputation": 605, "user_id": 455232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7523d392f17e1fc3863e3edadc1bd8e9?s=128&d=identicon&r=PG", "display_name": "Lokathor", "link": "https://stackoverflow.com/users/455232/lokathor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 43840223, "answer_count": 1, "score": 0, "last_activity_date": 1494220602, "creation_date": 1494215998, "last_edit_date": 1494217615, "question_id": 43839540, "link": "https://stackoverflow.com/questions/43839540/why-doesnt-this-opengl-example-draw-the-triangle", "title": "Why doesn&#39;t this OpenGL example draw the triangle?", "body": "<p>I'm trying to get a basic \"draw a triangle on the screen\" <a href=\"https://learnopengl.com/code_viewer.php?code=getting-started/hellotriangle\" rel=\"nofollow noreferrer\">example</a> working, but in Haskell with the gl and GLFW-b packages.</p>\n\n<p>My code is <a href=\"https://github.com/Lokathor/learnopengl/blob/7c6a2335affaaf5a01a9eceab9806f980ef05778/app/Lesson02.hs\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<pre><code>-- https://learnopengl.com/#!Getting-started/Hello-Triangle\n\n-- stuff from base\nimport Control.Monad (when, mapM)\nimport Foreign -- includes Ptr and Marshal, among other things.\n\n-- we qualify these names so we can tell what's from GLFW\nimport qualified Graphics.UI.GLFW as GLFW\n\n-- gl funcs all already have \"gl\" in their name\nimport Graphics.GL\n\nwidth = 800 :: Int\n\nheight = 600 :: Int\n\nvertexShaderSource = [\n    \"#version 330 core\\n\",\n    \"layout (location = 0) in vec3 position;\\n\",\n    \"void main()\\n\",\n    \"{\\n\",\n    \"gl_Position = vec4(position.x, position.y, position.z, 1.0);\\n\",\n    \"}\\n\"]\n\nfragmentShaderSource = [\n    \"#version 330 core\\n\",\n    \"out vec4 color;\\n\",\n    \"void main()\\n\",\n    \"{\\n\",\n    \"color = vec4(1.0f, 0.5f, 0.2f, 1.0f);\\n\",\n    \"}\\n\"]\n\ngetSrcPointer :: [String] -&gt; IO (Ptr (Ptr GLchar), Ptr GLint)\ngetSrcPointer sourceLines = do\n    let glcharLines = map (map (fromIntegral.fromEnum)) sourceLines\n    let linesLengths = map (fromIntegral.length) glcharLines\n    linesPtrs &lt;- mapM newArray glcharLines\n    linesPtrsPtr &lt;- newArray linesPtrs\n    lengthsPtr &lt;- newArray linesLengths\n    return (linesPtrsPtr,lengthsPtr)\n\n-- type KeyCallback = Window -&gt; Key -&gt; Int -&gt; KeyState -&gt; ModifierKeys -&gt; IO ()\ncallback :: GLFW.KeyCallback\ncallback window key scanCode keyState modKeys = do\n    putStrLn (show key)\n    when (key == GLFW.Key'Escape &amp;&amp; keyState == GLFW.KeyState'Pressed)\n        (GLFW.setWindowShouldClose window True)\n\nmain :: IO ()\nmain = do\n    -- init GLFW and set the appropriate options\n    _ &lt;- GLFW.init\n    GLFW.windowHint (GLFW.WindowHint'ContextVersionMajor 3)\n    GLFW.windowHint (GLFW.WindowHint'ContextVersionMinor 3)\n    GLFW.windowHint (GLFW.WindowHint'OpenGLProfile GLFW.OpenGLProfile'Core)\n    GLFW.windowHint (GLFW.WindowHint'Resizable False)\n    -- create our window\n    maybeWindow &lt;- GLFW.createWindow width height \"Lesson 02\" Nothing Nothing\n    case maybeWindow of\n        Nothing -&gt; do\n            -- somehow we failed. Nothing to do but report that and quit.\n            putStrLn \"Failed to create a GLFW window!\"\n            GLFW.terminate\n        Just window -&gt; do\n            -- set our context and callback\n            GLFW.makeContextCurrent (Just window)\n            GLFW.setKeyCallback window (Just callback)\n\n            -- define the viewport dimensions\n            (frameWidth,frameHeight) &lt;- GLFW.getFramebufferSize window\n            glViewport 0 0 (fromIntegral frameWidth) (fromIntegral frameHeight)\n\n            -- build and compile our shader program.\n            successP &lt;- malloc\n\n            -- vertex shader\n            vertexShader &lt;- glCreateShader GL_VERTEX_SHADER\n            (linesPtrsPtr,lengthsPtr) &lt;- getSrcPointer vertexShaderSource\n            glShaderSource vertexShader 1 linesPtrsPtr lengthsPtr\n            glCompileShader vertexShader\n            -- check for compilation errors\n            glGetShaderiv vertexShader GL_COMPILE_STATUS successP\n            success &lt;- peek successP\n            when (success == 0) $ do\n                putStrLn \"Vertex Shader Compile Error:\"\n                let infoLength = 512\n                resultP &lt;- malloc\n                infoLog &lt;- mallocArray (fromIntegral infoLength)\n                glGetShaderInfoLog vertexShader (fromIntegral infoLength) resultP infoLog\n                result &lt;- fromIntegral &lt;$&gt; peek resultP\n                logBytes &lt;- peekArray result infoLog\n                putStrLn (map (toEnum.fromEnum) logBytes)\n\n            -- fragment shader\n            fragmentShader &lt;- glCreateShader GL_FRAGMENT_SHADER\n            (linesPtrsPtr,lengthsPtr) &lt;- getSrcPointer fragmentShaderSource\n            glShaderSource fragmentShader 1 linesPtrsPtr lengthsPtr\n            glCompileShader fragmentShader\n            -- check for compilation errors\n            glGetShaderiv fragmentShader GL_COMPILE_STATUS successP\n            success &lt;- peek successP\n            when (success == 0) $ do\n                putStrLn \"Fragment Shader Compile Error:\"\n                let infoLength = 512\n                resultP &lt;- malloc\n                infoLog &lt;- mallocArray (fromIntegral infoLength)\n                glGetShaderInfoLog fragmentShader (fromIntegral infoLength) resultP infoLog\n                result &lt;- fromIntegral &lt;$&gt; peek resultP\n                logBytes &lt;- peekArray result infoLog\n                putStrLn (map (toEnum.fromEnum) logBytes)\n\n            -- link up the shaders\n            shaderProgram &lt;- glCreateProgram\n            glAttachShader shaderProgram vertexShader\n            glAttachShader shaderProgram fragmentShader\n            glLinkProgram shaderProgram\n            -- check for linking errors\n            glGetProgramiv shaderProgram GL_LINK_STATUS successP\n            success &lt;- peek successP\n            when (success == 0) $ do\n                putStrLn \"Program Linking Error:\"\n                let infoLength = 512\n                resultP &lt;- malloc\n                infoLog &lt;- mallocArray (fromIntegral infoLength)\n                glGetProgramInfoLog shaderProgram (fromIntegral infoLength) resultP infoLog\n                result &lt;- fromIntegral &lt;$&gt; peek resultP\n                logBytes &lt;- peekArray result infoLog\n                putStrLn (map (toEnum.fromEnum) logBytes)\n\n            -- cleanup the sub-programs now that our complete shader program is ready\n            glDeleteShader vertexShader\n            glDeleteShader fragmentShader\n\n            -- setup vertex data and attribute pointers\n            verticesP &lt;- newArray ([\n                -0.5, -0.5, 0.0, -- Left  \n                0.5, -0.5, 0.0, -- Right \n                0.0,  0.5, 0.0  -- Top\n                ] :: [GLfloat])\n            let verticesSize = fromIntegral $ sizeOf (0.0 :: GLfloat) * 9\n            vboP &lt;- malloc :: IO (Ptr GLuint)\n            vaoP &lt;- malloc :: IO (Ptr GLuint)\n            glGenVertexArrays 1 vaoP\n            glGenBuffers 1 vboP\n            -- Bind the Vertex Array Object first, then bind and set vertex buffer(s) and attribute pointer(s).\n            vao &lt;- peek vaoP\n            glBindVertexArray vao\n            vbo &lt;- peek vboP\n            glBindBuffer GL_ARRAY_BUFFER vbo\n            glBufferData GL_ARRAY_BUFFER verticesSize (castPtr verticesP) GL_STATIC_DRAW\n            let threeFloats = fromIntegral $ sizeOf (0.0::GLfloat) * 3\n            glVertexAttribPointer 0 3 GL_FLOAT GL_FALSE threeFloats nullPtr\n            glEnableVertexAttribArray 0\n            -- Note that this is allowed, the call to glVertexAttribPointer\n            -- registered VBO as the currently bound vertex buffer object so\n            -- afterwards we can safely unbind\n            glBindBuffer GL_ARRAY_BUFFER 0\n            -- Unbind VAO (it's always a good thing to unbind any buffer/array\n            -- to prevent strange bugs)\n            glBindVertexArray 0\n\n            -- \"game loop\"\n            let loop :: IO ()\n                loop = do\n                    shouldClose &lt;- GLFW.windowShouldClose window\n                    if shouldClose\n                        then return ()\n                        else do\n                            -- event poll\n                            GLFW.pollEvents\n\n                            -- clear the screen\n                            glClearColor 0.2 0.3 0.3 1.0\n                            glClear GL_COLOR_BUFFER_BIT\n                            -- draw a triangle\n                            glUseProgram shaderProgram\n                            glBindVertexArray vao\n                            glDrawArrays GL_TRIANGLES 0 3\n                            glBindVertexArray 0\n\n                            -- swap buffers and go again\n                            GLFW.swapBuffers window\n                            loop\n            loop\n\n            -- clean up the gl resources\n            glDeleteVertexArrays 1 vaoP\n            glDeleteBuffers 1 vboP\n            -- clean up the GLFW resources\n            GLFW.terminate\n</code></pre>\n\n<p>It compiles and runs without any reported errors, but it only shows the clear color; the triangle isn't drawn at all.</p>\n"}, {"tags": ["haskell", "pattern-synonyms"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1494207665, "post_id": 43838550, "comment_id": 74713451, "body": "I don\u2019t understand what this question is asking at all."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1494208041, "post_id": 43838550, "comment_id": 74713512, "body": "See the edit with the clarification."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 1, "creation_date": 1494208123, "post_id": 43838550, "comment_id": 74713522, "body": "So you want a pattern, <code>BinOp</code>, that matches any of <code>Add</code>, <code>Sub</code>, or <code>Mult</code>, and binds <code>op</code> to one of <code>AddOp</code>, <code>SubOp</code>, or <code>MultOp</code>?"}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1494208171, "post_id": 43838550, "comment_id": 74713533, "body": "Yes that would be lovely! Especially if the exhaustiveness checker understands what&#39;s happening."}], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 9, "last_activity_date": 1494212429, "creation_date": 1494212429, "answer_id": 43839121, "question_id": 43838550, "link": "https://stackoverflow.com/questions/43838550/using-viewpatterns-and-patternsynonyms-to-simply-pattern-matches/43839121#43839121", "title": "Using ViewPatterns and PatternSynonyms to simply pattern matches", "body": "<h2>View pattern</h2>\n\n<pre><code>asBinOp (Add a b) = Just (AddOp, a, b)\nasBinOp (Sub a b) = Just (SubOp, a, b)\nasBinOp (Mul a b) = Just (MulOp, a, b)\nasBinOp _ = Nothing\n\nprettyPrint (asBinOp -&gt; Just (op, x, y)) = prettyPrint x ++ showOp op ++ prettyPrint y\n</code></pre>\n\n<h2>... + Pattern synonym</h2>\n\n<pre><code>pattern BinOp :: BinOpT -&gt; Expr t -&gt; Expr t -&gt; Expr t\npattern BinOp op a b &lt;- (asBinOp -&gt; Just (op, a, b)) where\n  BinOp AddOp a b = Add a b\n  BinOp SubOp a b = Sub a b\n  BinOp MulOp a b = Mul a b\n\nprettyPrint (BinOp op x y) = prettyPrint x ++ showOp op ++ prettyPrint y\n</code></pre>\n\n<p>In GHC 8.2, you can satisfy the exhaustiveness checker with this pragma:</p>\n\n<pre><code>{-# COMPLETE BinOp, Negate, Abs, Scalar #-}\n</code></pre>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "accepted_answer_id": 43839121, "answer_count": 1, "score": 2, "last_activity_date": 1494212429, "creation_date": 1494207539, "last_edit_date": 1494207976, "question_id": 43838550, "link": "https://stackoverflow.com/questions/43838550/using-viewpatterns-and-patternsynonyms-to-simply-pattern-matches", "title": "Using ViewPatterns and PatternSynonyms to simply pattern matches", "body": "<p>Lets say I have a GADT for a language like so (my actual language is much more complex, about 50 constructors, but this is a simplified example):</p>\n\n<pre><code>data Expr t where\n  Add :: Expr t -&gt; Expr t -&gt; Expr t\n  Sub :: Expr t -&gt; Expr t -&gt; Expr t\n  Mult :: Expr t -&gt; Expr t -&gt; Expr t\n  Negate :: Expr t -&gt; Expr t\n  Abs :: Expr t -&gt; Expr t\n  Scalar :: t -&gt; Expr t\n</code></pre>\n\n<p>Now lets define another datatype like so:</p>\n\n<pre><code>data BinOpT = AddOp | SubOp | MultOp\n</code></pre>\n\n<p>Also, lets say I've got the following function:</p>\n\n<pre><code>stringBinOp :: BinOpT -&gt; String\nstringBinOp AddOp = \"+\"\nstringBinOp SubOp = \"-\"\nstringBinOp MultOp = \"*\"\n</code></pre>\n\n<p>Also, lets define the following type:</p>\n\n<pre><code>data BinOp t = BinOp BinOpT (Expr t) (Expr t)\n</code></pre>\n\n<p>Now I want to define a pretty printing function like so:</p>\n\n<pre><code>prettyPrint :: Show t =&gt; Expr t -&gt; String\nprettyPrint (BinOp op x y) = prettyPrint x ++ showOp op ++ prettyPrint y\nprettyPrint (Negate x) = \"-\" ++ prettyPrint x\nprettyPrint (Abs x) = \"abs(\" ++ prettyPrint x ++ \")\"\nprettyPrint (Scalar x) = show x\n</code></pre>\n\n<p>Note that this is not valid, as <code>BinOp</code> is not a constructor of <code>Expr t</code>.</p>\n\n<p>Of course I could redefine <code>Expr t</code> like so:</p>\n\n<pre><code>data Expr t where\n  BinOp :: BinOp -&gt; Expr t -&gt; Expr t -&gt; Expr t\n  Negate :: Expr t -&gt; Expr t\n  Abs :: Expr t -&gt; Expr t\n  Scalar :: t -&gt; Expr t\n</code></pre>\n\n<p>And that would work fine, but I'd rather not do this. It makes other code that uses this a little uglier, and also I think it will be slightly more inefficient in terms of space and time, and you've got to match against two constructors instead of one, which means two case statements (hence jump tables) instead of one. </p>\n\n<p>I suspect I can use a combination of the following two GHC extensions to achieve what I'm trying to do cleanly, namely:</p>\n\n<pre><code>{-# LANGUAGE ViewPatterns #-}\n{-# LANGUAGE PatternSynonyms #-}\n</code></pre>\n\n<p>But I'm not quite exactly sure how to best do this. A simple example for this code would be helpful (I can then apply it to the more complex language I'm dealing with). </p>\n\n<p>Many imaginary bonus points will be awarded if the solution will compile without warnings for missing pattern matches. I understand GHC 8.2 may be helpful in this regard, so a GHC 8.2 example with it's extensions to exhaustiveness checking will be fine, although a pre GHC 8.2 solution with passes the exhaustiveness checker will be even better. </p>\n\n<p><strong>Clarification:</strong></p>\n\n<p>What I'm actually asking is how can I do something like this:</p>\n\n<pre><code>prettyPrint :: Show t =&gt; Expr t -&gt; String\nprettyPrint (BinOp op x y) = prettyPrint x ++ showOp op ++ prettyPrint y\nprettyPrint (Negate x) = \"-\" ++ prettyPrint x\nprettyPrint (Abs x) = \"abs(\" ++ prettyPrint x ++ \")\"\nprettyPrint (Scalar x) = show x\n</code></pre>\n\n<p>Whilst keeping the definition of <code>Expr t</code> like so:</p>\n\n<pre><code>data Expr t where\n  Add :: Expr t -&gt; Expr t -&gt; Expr t\n  Sub :: Expr t -&gt; Expr t -&gt; Expr t\n  Mult :: Expr t -&gt; Expr t -&gt; Expr t\n  Negate :: Expr t -&gt; Expr t\n  Abs :: Expr t -&gt; Expr t\n  Scalar :: t -&gt; Expr t\n</code></pre>\n\n<p>The important line is:</p>\n\n<pre><code>prettyPrint (BinOp op x y) = prettyPrint x ++ showOp op ++ prettyPrint y\n</code></pre>\n\n<p>Which won't compile as <code>BinOp</code> is not a constructor of <code>Expr t</code>. I want like this line that does compile, as I don't want to do this everywhere:</p>\n\n<pre><code>prettyPrint (Add x y) = ...\nprettyPrint (Sub x y) = ...\nprettyPrint (Mult x y) = ...\n</code></pre>\n\n<p>Because that means a lot of code duplication as lots of functions will use <code>Expr t</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494199980, "post_id": 43835656, "comment_id": 74712047, "body": "Supplementary reading: <a href=\"https://two-wrongs.com/haskell-time-library-tutorial\" rel=\"nofollow noreferrer\">two-wrongs.com/haskell-time-library-tutorial</a>"}, {"owner": {"reputation": 127, "user_id": 6748751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/879942233f1a467b2e158869153da800?s=128&d=identicon&r=PG&f=1", "display_name": "BinaryHexer", "link": "https://stackoverflow.com/users/6748751/binaryhexer"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494218996, "post_id": 43835656, "comment_id": 74715910, "body": "@duplode I had already read that before asking this question, the main issue that tutorial does not cover is using timezones that are not derived from your machine, which IMHO is the most practical use, and I realize it&#39;s not the author&#39;s fault, Haskell time library simply does not provide a way of getting <code>TimeZone</code> other than that of the machine. Which if you ask me is really stupid."}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 6748751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/879942233f1a467b2e158869153da800?s=128&d=identicon&r=PG&f=1", "display_name": "BinaryHexer", "link": "https://stackoverflow.com/users/6748751/binaryhexer"}, "edited": false, "score": 0, "creation_date": 1494220548, "post_id": 43837250, "comment_id": 74716379, "body": "thanks! this does the work, but I wonder if there was better documentation, maybe I wouldn&#39;t have needed to ask this question. Documentation on hackage is next to useless with zero examples, is there something like this <a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\">golang time package</a> for haskell (in terms of documentation and examples)?   Also can you also give example for the Date.Time.Format?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 127, "user_id": 6748751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/879942233f1a467b2e158869153da800?s=128&d=identicon&r=PG&f=1", "display_name": "BinaryHexer", "link": "https://stackoverflow.com/users/6748751/binaryhexer"}, "edited": false, "score": 0, "creation_date": 1494222023, "post_id": 43837250, "comment_id": 74716846, "body": "The link @duplode gives above looks like it provides good documentation.  To translate numeric month and day of week to text, you can use the <code>defaultTimeLocale</code> value directly:   for example, <code>fst (months defaultTimeLocale !! 5)</code> and <code>fst (wDays defaultTimeLocale !! 1)</code> give full names or use <code>snd</code> instead of <code>fst</code> to get abbreviated names.  More complex time formatting is possible, too, with the <code>formatTime</code> function:  (e.g., <code>formatTime defaultTimeLocale &quot;%A, %B %-e at %-H hours, %-M minutes&quot; &lt;$&gt; getCurrentTime</code>)."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 7, "last_activity_date": 1494196453, "last_edit_date": 1494196453, "creation_date": 1494195049, "answer_id": 43837250, "question_id": 43835656, "link": "https://stackoverflow.com/questions/43835656/simpler-way-to-deal-with-time-and-date/43837250#43837250", "title": "Simpler way to deal with Time and Date?", "body": "<p><em>Edit:</em> Fixed to use <code>timezone-olson</code> / <code>timezone-series</code> for correct timezone processing.</p>\n\n<p>You should be able to do almost everything with the <code>time</code> package, except that proper timezone processing will require <code>timezone-olson</code> and <code>timezone-series</code> packages on Linux systems; I'm not sure how to do it on Windows systems.  Maybe someone else has a better way.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>module Time where\n\nimport Data.Time                             -- package \"time\"\nimport Data.Time.Calendar.WeekDate           -- package \"time\"\nimport Data.Time.LocalTime.TimeZone.Olson    -- package \"timezone-olson\"\nimport Data.Time.LocalTime.TimeZone.Series   -- package \"timezone-series\"\n\n-- |POSIX-specific timezone lookup\nlookupTimeZone :: String -&gt; IO TimeZoneSeries\nlookupTimeZone tz =\n  getTimeZoneSeriesFromOlsonFile (\"/usr/share/zoneinfo/\" ++ tz)\n\ndata MyTime = MyTime\n  { year :: Integer\n  , month :: Int\n  , week :: Int\n  , dayOfMonth :: Int\n  , dayOfWeek :: Int\n  , hour :: Int\n  , minutes :: Int\n  , seconds :: Int\n  } deriving (Show)\n\ngetMyTime :: TimeZoneSeries -&gt; UTCTime -&gt; MyTime\ngetMyTime tz t =\n  let LocalTime day (TimeOfDay hh mm ss) = utcToLocalTime' tz t\n      (yr, mn, dom) = toGregorian day\n      (_,  wk, dow) = toWeekDate day\n  in MyTime yr mn wk dom dow hh mm (round ss)\n\nmain :: IO ()\nmain = do\n  currentTime &lt;- getCurrentTime\n  -- Note: if you want time in local timezone, use:\n  -- tz &lt;- getTimeZoneSeriesFromOlsonFile \"/etc/localtime\"\n  tz &lt;- lookupTimeZone \"Asia/Tokyo\"\n  print $ getMyTime tz currentTime\n</code></pre>\n\n<p>A few cautionary notes:</p>\n\n<ul>\n<li><code>lookupTimeZone</code> will throw an exception if it can't find the timezone file at <code>/usr/share/zoneinfo/your/timezone</code></li>\n<li>If by \"week\", you meant \"week of the year\", you may want to consult the documentation for <code>toWeekDate</code> to see exactly how that's defined.</li>\n<li>If you want months or days in string format, you can use the functions in <code>Data.Time.Format</code> (still in the <code>time</code> package) to format them in the current (or some other) locale.</li>\n</ul>\n"}], "owner": {"reputation": 127, "user_id": 6748751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/879942233f1a467b2e158869153da800?s=128&d=identicon&r=PG&f=1", "display_name": "BinaryHexer", "link": "https://stackoverflow.com/users/6748751/binaryhexer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 0, "accepted_answer_id": 43837250, "answer_count": 1, "score": 4, "last_activity_date": 1494196453, "creation_date": 1494184880, "question_id": 43835656, "link": "https://stackoverflow.com/questions/43835656/simpler-way-to-deal-with-time-and-date", "title": "Simpler way to deal with Time and Date?", "body": "<p>So I am trying to learn Haskell, so I am sorry if this has already been asked, but I could not find a question that properly answered my doubts.</p>\n\n<p>So my question is given <code>UTCTime</code> what is the easiest and straightforward way of getting the following:</p>\n\n<ul>\n<li>Year</li>\n<li>Month</li>\n<li>Week</li>\n<li>Date (Eg: 24)</li>\n<li>Day (Eg: Monday)</li>\n<li>Hour</li>\n<li>Minutes</li>\n<li>Seconds</li>\n</ul>\n\n<p>Also if there is convenient way of converting <code>UTCTime</code> to some local time using just <code>Asia/Tokyo</code> or similar strings.</p>\n\n<p>I couldn't find a single library that gave all of these features and got confused and to be quite honest irritated that I need to convert between different types and use multiple libraries to achieve the above. Maybe I was not looking properly.</p>\n\n<p>My effort so far:</p>\n\n<pre><code>import Data.Time\n\n-- Difference between JST and UTC in seconds\n-- JST is 9 hours ahead of UTC\nutcJSTDiff :: Int\nutcJSTDiff = 32400\n\ngetHour :: UTCTime -&gt; Int\ngetHour time = todHour (timeToTimeOfDay (utctDayTime time))\n\ngetMinutes :: UTCTime -&gt; Int\ngetMinutes time = todMin (timeToTimeOfDay (utctDayTime time))\n\nisReminderHour :: Int -&gt; Bool\nisReminderHour hour\n    | hour == morningReminderHour || hour == eveningReminderHour = True\n    | otherwise = False\n\nisReminderMins :: Int -&gt; Bool\nisReminderMins mins\n    | mins &lt;= reminderMinuteLimit = True\n    | otherwise = False\n\ntimeforReminder :: UTCTime -&gt; Bool\ntimeforReminder time\n    | isReminderHour (getHour time) &amp;&amp; isReminderMins (getMinutes time) = True\n    | otherwise = False\n\nutcToJST :: UTCTime -&gt; UTCTime\nutcToJST = addUTCTime (realToFrac utcJSTDiff)\n\nmain :: IO()\nmain = do\n    currentTime &lt;- getCurrentTime\n    let jstTime = utcToJST currentTime\n    if timeforReminder jstTime\n        then action1\n        else action2\n</code></pre>\n"}, {"tags": ["haskell", "concurrency", "monads", "state-monad"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1494197374, "post_id": 43835585, "comment_id": 74711521, "body": "Based on your description, you&#39;ve already written some code to try to solve this problem, so you should include that code - it will do leagues more to explain what you hope to accomplish than a wall of text."}, {"owner": {"reputation": 1078, "user_id": 2584427, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/8190dcf4b994b0a5f0edd8d3cc4e0859?s=128&d=identicon&r=PG", "display_name": "Louis Tran", "link": "https://stackoverflow.com/users/2584427/louis-tran"}, "edited": false, "score": 0, "creation_date": 1606203068, "post_id": 43835585, "comment_id": 114883923, "body": "I&#39;m working on this problem too. Is it possible for you to share the code?"}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 2, "last_activity_date": 1494206001, "creation_date": 1494206001, "answer_id": 43838377, "question_id": 43835585, "link": "https://stackoverflow.com/questions/43835585/message-passing-concurrency-in-haskell-with-multiple-senders-and-receivers/43838377#43838377", "title": "Message passing concurrency in Haskell with multiple senders and receivers", "body": "<p>Wow, you already have a typeclass, two instances, and a state monad, and you haven't even settled on the types of your MVars!  Things are getting complicated.</p>\n\n<p>I worry that you may be falling into the Haskell-as-Java trap, where you've come up with an object-oriented solution in your head, and you're now trying to translate that directly into Haskell, thinking about your dancers as stateful objects with shared methods wrapped up in a \"class\", etc., etc.</p>\n\n<p>I would suggest a different approach.  Dancers aren't \"things\"; they're tasks.  Implement them as straightforward functions and use argument passing and recursion in place of \"state\", as is typical for idiomatic Haskell.</p>\n\n<p><strong>Spoilers follow,</strong> but here is a simple way to define a \"follower\" that has an <code>id</code>, responds to requests via a pair of request/response MVars, and maintains a dance card using a recursive core loop.  Note that the <code>Follower</code> data type isn't supposed to be a \"follower object\" (e.g., it has no dance card); it's just a convenient way of documenting the return value from <code>follower</code> which serves as a \"handle\" for identifying and communicating with the follower task:</p>\n\n<pre><code>type LeaderId = Int\ntype FollowerId = Int\ntype Dance = Int\n\n-- |A dance card for a follower with a list of dance/leader pairs.\ndata Card = Card { getCard :: [(Dance, LeaderId)] } deriving (Show)\nemptyCard = Card []\n\n-- |Follower handle giving its id and request/response MVars\ndata Follower =\n  Follower { followerId :: FollowerId\n           , request :: MVar (Dance, LeaderId)\n           , response :: MVar Bool\n           }\n\n-- |Create a new follower task with given id.\nfollower :: FollowerId -&gt; IO Follower\nfollower followerId_ = do\n  req &lt;- newEmptyMVar\n  res &lt;- newEmptyMVar\n  let loop (Card xs) = do\n        -- get next request\n        (dance, leaderId_) &lt;- takeMVar req\n        case lookup dance xs of\n          -- if dance is free and we haven't danced too often w/ this leader\n          Nothing | length (filter ((==leaderId_) . snd) xs) &lt; 2\n                    -- then say yes and update dance card\n                    -&gt; do putMVar res True\n                          loop (Card $ (dance, leaderId_) : xs)\n          -- otherwise, refuse\n          _         -&gt; do putMVar res False\n                          loop (Card xs)\n  forkIO $ loop emptyCard\n  return $ Follower followerId_ req res\n</code></pre>\n\n<p>You can create and test out a couple of followers by asking them to dance:</p>\n\n<pre><code>&gt; f1 &lt;- follower 1   -- follower #1\n&gt; f2 &lt;- follower 2   -- follower #2\n&gt; putMVar (request f1) (1, 10) -- dance #1 w/ leader #10\n&gt; takeMVar (response f1)\nTrue                           -- hooray!\n&gt; putMVar (request f1) (1, 14) -- dance #1 w/ leader #14\n&gt; takeMVar (response f1)\nFalse                          -- wah! dance is taken\n&gt; putMVar (request f2) (1, 14) -- try different follower\n&gt; takeMVar (response f2)\nTrue                           -- hooray!\n&gt;\n</code></pre>\n\n<p>Note that these particular followers can neither be queried for their dance cards nor told to exit their infinite loops.  You don't need that for this application (we only need the dance cards from the leaders and don't care if there are a bunch of stuck lightweight threads when we get the answer), but you could always add a couple of MVars if you did.</p>\n\n<p>Similarly, you should be able to implement a leader as a function with a simple recursive core loop.  Note that, if the leader tries to just fill its dance card in order, it doesn't actually need to keep track of the dance card as it goes -- the final dance card (and \"core loop\") is just a <code>mapM</code> over trying to fill dance slots 1 to 8.</p>\n\n<p>How do you provide the leaders with the ability to request dances from followers?  Well, create the full set of followers first and pass a list of follower handles (<code>[Follower]</code>) as an argument to the <code>leader</code> creation function.  How do you get dance cards back from the leaders?  The <code>leader</code> function should return an MVar for the card, and the <code>main</code> function can <code>mapM takeMVar leadersDanceCards</code> to get the full list of dance cards.</p>\n"}], "owner": {"reputation": 63, "user_id": 7817065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3857f4980e19b45dae3ebf6c2e4071f1?s=128&d=identicon&r=PG&f=1", "display_name": "78t66", "link": "https://stackoverflow.com/users/7817065/78t66"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 43838377, "answer_count": 1, "score": 1, "last_activity_date": 1562819705, "creation_date": 1494184478, "last_edit_date": 1562819705, "question_id": 43835585, "link": "https://stackoverflow.com/questions/43835585/message-passing-concurrency-in-haskell-with-multiple-senders-and-receivers", "title": "Message passing concurrency in Haskell with multiple senders and receivers", "body": "<p>I am trying to solve a problem involving multiple senders and receivers, and would like some feedback on whether my approach is on the right track.</p>\n\n<p>Problem: We have N leaders and M followers, who must all be represented by individual threads. Everyone is a dancer, and has an associated \"dance card\" with the names of 8 different dances. each leader must ask a follower if they can dance a specific dance. Followers wait for invitations from leaders and accept only if they are not already dancing that dance and if they have not agreed to dance with this leader for 2 other dances. If the leaders hears back that their invite was accepted, they move on trying to secure a match for the next dance. Otherwise, they continue trying to find a match for the same dance. At the end, the leaders \"dance card\" is printed with each dance and the ID of the follower with whom they are dancing that dance.</p>\n\n<p>Approach: I have created two functions: leader and follower. In main, I use forkIO to call leader n times and follower m times. However, I'm running into the issue of how I will keep state (specifically the dancecard). I was thinking of creating a type class \"Dancer\" and then two instances of it : Leader and Follower. Each leader and each follower would have a unique ID (anything from 1 to N or M). Each would also need an mvar to serve as its own personal mailbox . Leaders would somehow need to \"get\" a follower's mvar in order to put something in it so that that same follower can take it out and respond yes or no to the invite. Regarding the dancecard, I think it would it be best to incorporate the state monad. For example, when a leader invites a follower to a dance, a follower should be able to look at their dancecard and verify that they don't already have a partner for that dance.</p>\n"}, {"tags": ["arrays", "haskell", "multidimensional-array", "type-level-computation", "tensor"], "comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1494171465, "post_id": 43833191, "comment_id": 74703386, "body": "You may look into <a href=\"https://hackage.haskell.org/package/fixed-list-0.1.6/docs/Data-FixedList.html\" rel=\"nofollow noreferrer\">Data.FixedList</a> library to define a type depending on lists with fixed length."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 2, "creation_date": 1494172461, "post_id": 43833191, "comment_id": 74703729, "body": "Some possibly relevant links: <a href=\"https://blog.jle.im/entry/practical-dependent-types-in-haskell-1.html\" rel=\"nofollow noreferrer\">blog.jle.im/entry/practical-dependent-types-in-haskell-1.htm&zwnj;&#8203;l</a> <a href=\"https://blog.jle.im/entry/practical-dependent-types-in-haskell-2.html\" rel=\"nofollow noreferrer\">blog.jle.im/entry/practical-dependent-types-in-haskell-2.htm&zwnj;&#8203;l</a> <a href=\"https://www.reddit.com/r/haskell/comments/67f4mw/naperian_tensors/\" rel=\"nofollow noreferrer\">reddit.com/r/haskell/comments/67f4mw/naperian_tensors</a> Also the vector-sized package <a href=\"http://hackage.haskell.org/package/vector-sized\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/vector-sized</a>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1494241794, "post_id": 43833191, "comment_id": 74727837, "body": "Please also check out Mike Izbicki&#39;s work on the <a href=\"http://hackage.haskell.org/package/subhask-0.1.1.0/docs/SubHask-Algebra-Vector.html\" rel=\"nofollow noreferrer\">linear-algebra part of <code>subhask</code></a> (he does a lot of machine learning etc., so this might be relevant if you want to go in the direction of TensorFlow), and my <a href=\"http://hackage.haskell.org/package/linearmap-category-0.3.2.0/docs/Math-LinearMap-Category.html#g:5\" rel=\"nofollow noreferrer\">linearmap-category</a> (which defines tensors in a completely basis-agnostic way, and never talks about <i>dimensions</i> but about <i>vector spaces</i> \u2013 these can also be infinite-dimensional)."}], "answers": [{"comments": [{"owner": {"reputation": 2173, "user_id": 3794544, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/94226e756a1e68dd797037f11dc2102a?s=128&d=identicon&r=PG&f=1", "display_name": "user47376", "link": "https://stackoverflow.com/users/3794544/user47376"}, "edited": false, "score": 0, "creation_date": 1494238514, "post_id": 43839117, "comment_id": 74725881, "body": "Awesome answer! thx, But could we go one step further in the abstraction? let&#39;s say i want to have multiple implementation of tensor data structures and operations, could this approach work with a type class?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 2173, "user_id": 3794544, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/94226e756a1e68dd797037f11dc2102a?s=128&d=identicon&r=PG&f=1", "display_name": "user47376", "link": "https://stackoverflow.com/users/3794544/user47376"}, "edited": false, "score": 0, "creation_date": 1494269599, "post_id": 43839117, "comment_id": 74746039, "body": "@user47376 Your edit changes the question a fair bit. :) Yes, it is possible to make this type-class based instead of GADT-based. That approach turns out to be pretty hairy. I instead recommend you try annotating <code>Vector</code> and <code>Tensor</code> with a type to specify its runtime representation (see how <code>repa</code> does this for <a href=\"https://hackage.haskell.org/package/repa-3.4.1.2/docs/Data-Array-Repa.html#t:Array\" rel=\"nofollow noreferrer\">its <code>Array</code> type</a> - more information on the possible representations is at the top of the linked page)."}, {"owner": {"reputation": 2173, "user_id": 3794544, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/94226e756a1e68dd797037f11dc2102a?s=128&d=identicon&r=PG&f=1", "display_name": "user47376", "link": "https://stackoverflow.com/users/3794544/user47376"}, "edited": false, "score": 0, "creation_date": 1494285092, "post_id": 43839117, "comment_id": 74752857, "body": "What do you mean by that? Run time type information makes it not type safe, the whole point is to make the compiler check the correctness of the dimensions, or am I missing your point ?"}, {"owner": {"reputation": 2173, "user_id": 3794544, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/94226e756a1e68dd797037f11dc2102a?s=128&d=identicon&r=PG&f=1", "display_name": "user47376", "link": "https://stackoverflow.com/users/3794544/user47376"}, "edited": false, "score": 0, "creation_date": 1494285689, "post_id": 43839117, "comment_id": 74753015, "body": "What makes the type class implementation &quot;hairy&quot;? Is it really so difficult to go from: <code>zero :: Tensor &#39;[3,5,4]</code> to <code>zero :: Tensor &#39;[3,5,4] a =&gt; a</code>"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 2173, "user_id": 3794544, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/94226e756a1e68dd797037f11dc2102a?s=128&d=identicon&r=PG&f=1", "display_name": "user47376", "link": "https://stackoverflow.com/users/3794544/user47376"}, "edited": false, "score": 0, "creation_date": 1494288161, "post_id": 43839117, "comment_id": 74753638, "body": "@user47376 repa has type encoded information that tells you what the underlying representation is - delayed, unboxed, etc. The hairiness is that you end up defining multiple data types for what were otherwise just disjuncts of the GADT."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 3, "last_activity_date": 1494213656, "last_edit_date": 1494213656, "creation_date": 1494212387, "answer_id": 43839117, "question_id": 43833191, "link": "https://stackoverflow.com/questions/43833191/type-level-programming-to-represent-multidimensional-arrays-tensors/43839117#43839117", "title": "Type level programming to represent multidimensional arrays (Tensors)", "body": "<p>Here is one way (<a href=\"https://gist.github.com/harpocrates/adfccb491f9b1df19426566003c6e1a5\" rel=\"nofollow noreferrer\">here is a complete Gist</a>). We stick to using Peano numbers instead of GHC's type level <code>Nat</code> just because induction works better on them.</p>\n\n<pre><code>{-# LANGUAGE GADTs, PolyKinds, DataKinds, TypeOperators, FlexibleInstances, FlexibleContexts #-}\n\nimport Data.Foldable\nimport Text.PrettyPrint.HughesPJClass\n\ndata Nat = Z | S Nat\n\n-- Some type synonyms that simplify uses of 'Nat'\ntype N0 = Z\ntype N1 = S N0\ntype N2 = S N1\ntype N3 = S N2\ntype N4 = S N3\ntype N5 = S N4\ntype N6 = S N5\ntype N7 = S N6\ntype N8 = S N7\ntype N9 = S N8\n\n-- Similar to lists, but indexed over their length\ndata Vector (dim :: Nat) a where\n  Nil    :: Vector Z a\n  (:-)   :: a -&gt; Vector n a -&gt; Vector (S n) a\n\ninfixr 5 :-\n\ndata Tensor (dim :: [Nat]) a where\n  Scalar :: a -&gt; Tensor '[] a\n  Tensor :: Vector d (Tensor ds a) -&gt; Tensor (d : ds) a\n</code></pre>\n\n<p>To display these types, we'll use the <code>pretty</code> package (which comes with GHC already).</p>\n\n<pre><code>instance (Foldable (Vector n), Pretty a) =&gt; Pretty (Vector n a) where\n  pPrint = braces . sep . punctuate (text \",\") . map pPrint . toList\n\ninstance Pretty a =&gt; Pretty (Tensor '[] a) where\n  pPrint (Scalar x) = pPrint x\n\ninstance (Pretty (Tensor ds a), Pretty a, Foldable (Vector d)) =&gt; Pretty (Tensor (d : ds) a) where\n  pPrint (Tensor xs) = pPrint xs\n</code></pre>\n\n<p>Then here are instances of <code>Foldable</code> for our datatypes (nothing surprising here - I'm including this only because you need it for the <code>Pretty</code> instances to compile):</p>\n\n<pre><code>instance Foldable (Vector Z) where\n  foldMap f Nil = mempty\n\ninstance Foldable (Vector n) =&gt; Foldable (Vector (S n)) where\n  foldMap f (x :- xs) = f x `mappend` foldMap f xs\n\n\ninstance Foldable (Tensor '[]) where\n  foldMap f (Scalar x) = f x\n\ninstance (Foldable (Vector d), Foldable (Tensor ds)) =&gt; Foldable (Tensor (d : ds)) where\n  foldMap f (Tensor xs) = foldMap (foldMap f) xs\n</code></pre>\n\n<p>Finally, the part that answers your question: we can define <code>Applicative (Vector n)</code> and <code>Applicative (Tensor ds)</code> similar to how <code>Applicative ZipList</code> is defined (except <code>pure</code> doesn't return and empty list - it returns a list of the right length).</p>\n\n<pre><code>instance Applicative (Vector Z) where\n  pure _ = Nil\n  Nil &lt;*&gt; Nil = Nil\n\ninstance Applicative (Vector n) =&gt; Applicative (Vector (S n)) where\n  pure x = x :- pure x\n  (x :- xs) &lt;*&gt; (y :- ys) = x y :- (xs &lt;*&gt; ys)\n\n\ninstance Applicative (Tensor '[]) where\n  pure = Scalar\n  Scalar x &lt;*&gt; Scalar y = Scalar (x y)\n\ninstance (Applicative (Vector d), Applicative (Tensor ds)) =&gt; Applicative (Tensor (d : ds)) where\n  pure x = Tensor (pure (pure x))\n  Tensor xs &lt;*&gt; Tensor ys = Tensor ((&lt;*&gt;) &lt;$&gt; xs &lt;*&gt; ys)\n</code></pre>\n\n<p>Then, in GHCi, it is pretty trivial to make your <code>zero</code> function:</p>\n\n<pre><code>ghci&gt; :set -XDataKinds\nghci&gt; zero = pure 0\nghci&gt; pPrint (zero :: Tensor [N5,N3,N2] Integer)\n{{{0, 0}, {0, 0}, {0, 0}},\n {{0, 0}, {0, 0}, {0, 0}},\n {{0, 0}, {0, 0}, {0, 0}},\n {{0, 0}, {0, 0}, {0, 0}},\n {{0, 0}, {0, 0}, {0, 0}}}\n</code></pre>\n"}], "owner": {"reputation": 2173, "user_id": 3794544, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/94226e756a1e68dd797037f11dc2102a?s=128&d=identicon&r=PG&f=1", "display_name": "user47376", "link": "https://stackoverflow.com/users/3794544/user47376"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 3, "accepted_answer_id": 43839117, "answer_count": 1, "score": 3, "last_activity_date": 1494242915, "creation_date": 1494170449, "last_edit_date": 1494242915, "question_id": 43833191, "link": "https://stackoverflow.com/questions/43833191/type-level-programming-to-represent-multidimensional-arrays-tensors", "title": "Type level programming to represent multidimensional arrays (Tensors)", "body": "<p>I would like to have a type to represent multidimensional arrays (Tensors) in a type safe way. so I could write for example: <code>zero :: Tensor (5,3,2) Integer</code>\nthat would represent a multidimensional array that has 5 element , each of which has 3 elements each of which have 2 elements, where all elements are <code>Integer</code>s</p>\n\n<p>How would you define this type using type level programming?</p>\n\n<p><strong>Edit</strong>:</p>\n\n<p>After the wonderful answer by Alec, Which implemented this using <code>GADT</code>s, </p>\n\n<p>I wonder if you could take this a step further, and support multiple implementations of a <code>class Tensor</code> and of the operations on tensors and serialization of tensors</p>\n\n<p>such that you could have for example:</p>\n\n<ul>\n<li><code>GPU</code> or <code>CPU</code> implementations using <code>C</code></li>\n<li>pure <code>Haskell</code> implementations</li>\n<li>implementation that only prints the graph of computation and does not compute anything</li>\n<li>implementation which caches results on disk</li>\n<li>parallel or distributed computation</li>\n<li>etc...</li>\n</ul>\n\n<p>All type safe and easy to use.</p>\n\n<p>My intention is to make a library in Haskell much like <code>tensor-flow</code> but type-safe and much more extensible, using <a href=\"https://en.wikipedia.org/wiki/Automatic_differentiation\" rel=\"nofollow noreferrer\">automatic differentiation</a> (<a href=\"https://hackage.haskell.org/package/ad\" rel=\"nofollow noreferrer\">ad library</a>), and <a href=\"https://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic\" rel=\"nofollow noreferrer\">exact real arithmetic</a> (<a href=\"https://hackage.haskell.org/package/exact-real\" rel=\"nofollow noreferrer\">exact-real library</a>)</p>\n\n<p>I think a functional language like <code>Haskell</code> is much more appropriate for these things (for all things in my opinion) than the python ecosystem which sprouted somehow.</p>\n\n<ul>\n<li>Haskell is purely functional, much more sutible for computational programming than python</li>\n<li>Haskell is much more efficient than python and can be compiled to binary</li>\n<li>Haskell's laziness (arguably) removes the need to optimize the computation graph, and makes code much simpler that way</li>\n<li>much more powerful abstractions in Haskell</li>\n</ul>\n\n<p>Although i see the potential, i'm just not well versed enough (or smart enough) for this type-level programming, so i don't know how to implement such a thing in Haskell and get it to compile. </p>\n\n<p>That's where I need your help.</p>\n"}, {"tags": ["haskell", "data-kinds"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1494196876, "post_id": 43831769, "comment_id": 74711405, "body": "You can&#39;t - if you want to be very pedantic, then <code>=&gt;</code> has kind <code>Constraint -&gt; Type -&gt; Type</code>, so the rhs would have to be a type. For simple testing like it seems you are trying to do, wrapping the rhs in <code>Proxy</code> is the correct thing to do (in practice, you cannot make use of your <code>F</code> type family without employing some type whose kind is <code>Nat -&gt; Type</code>). <code>kind!</code> does not solve constraints - it just normalizes types (try e.g. <code>:kind! (1 ~ 2) =&gt; ()</code> - nothing happens. but <code>:t () :: (1 ~ 2) =&gt; ()</code> gives a type error) - this is completely unrelated, however."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1494202455, "post_id": 43831769, "comment_id": 74712497, "body": "Types that aren&#39;t in kind <code>*</code> (or kind <code>#</code>) are not inhabited, so you cannot ever have a value of that type (which, I imagine, is a big part of why that sort of thing is automatically rejected)."}], "owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1494162785, "creation_date": 1494161914, "last_edit_date": 1494162681, "question_id": 43831769, "link": "https://stackoverflow.com/questions/43831769/using-a-a-lifted-data-type-on-the-right-of-in-ghci", "title": "Using a a lifted data type on the right of =&gt; in ghci", "body": "<p>Consider the following code</p>\n\n<pre><code>{-# LANGUAGE ConstraintKinds #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE DataKinds #-}\nmodule Test () where\n\ntype C x = x ~ 1\ntype family F x = r where\n  F 0 = 0\n  F 1 = 2\n  F 2 = 4\n</code></pre>\n\n<p>I am trying to convince gchi to solve <code>:kind! forall x . C x =&gt; F x</code>\ninto <code>2</code>. But it looks like I can only use Type kinded stuff on the\nright of <code>=&gt;</code>. Is there a way to get around that? In particular I get</p>\n\n<pre><code>&lt;interactive&gt;:1:20: error:\n    \u2022 Expected a type, but \u2018F x\u2019 has kind \u2018GHC.Types.Nat\u2019\n    \u2022 In the type \u2018forall x. C x =&gt; F x\u2019\n</code></pre>\n\n<p>EDIT: wrapping it in proxy does not seem to work:</p>\n\n<pre><code>:kind! (forall x . C x =&gt; Proxy (F x))\n(forall x . C x =&gt; Proxy (F x)) :: *\n= C x =&gt; Proxy (F x)\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 7122314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f690d41d4687cba4052df317f819c09?s=128&d=identicon&r=PG&f=1", "display_name": "Kai D", "link": "https://stackoverflow.com/users/7122314/kai-d"}, "edited": false, "score": 0, "creation_date": 1494162638, "post_id": 43831828, "comment_id": 74700613, "body": "I&#39;m with you up to what would be the equivalent to (b -&gt; c) in my question but I don&#39;t understand why the type expression doesn&#39;t just end there. Why do I need to the next two, in my case -&gt; a -&gt; c ?"}, {"owner": {"reputation": 9898, "user_id": 116546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/967bbcaf95419a577f2443cd31658216?s=128&d=identicon&r=PG", "display_name": "drdaeman", "link": "https://stackoverflow.com/users/116546/drdaeman"}, "reply_to_user": {"reputation": 133, "user_id": 7122314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f690d41d4687cba4052df317f819c09?s=128&d=identicon&r=PG&f=1", "display_name": "Kai D", "link": "https://stackoverflow.com/users/7122314/kai-d"}, "edited": false, "score": 1, "creation_date": 1494162834, "post_id": 43831828, "comment_id": 74700647, "body": "@KaiD because type expressions cover return values. <code>a -&gt; c</code> (<code>\u03b1 -&gt; \u03b4</code>) is a type of what <code>f2</code> returns."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1494162261, "creation_date": 1494162261, "answer_id": 43831828, "question_id": 43831640, "link": "https://stackoverflow.com/questions/43831640/understanding-the-haskell-type-of-this-expression/43831828#43831828", "title": "Understanding the Haskell type of this expression", "body": "<p>I find these \u201cdetermine the type of such and such expression\u201d generally a bit backwards. Types should always come first: you want to program a solution to some task, you formulate the problem description as a type signature. <em>Then</em> you go ahead and actually write an implementation.</p>\n\n<p>In this case, you'd start with the problem: I have three functions <code>f</code>, <code>g</code> and <code>h</code>, and a value of type that I can pass to <code>f</code>. Furthermore, the functions have pairwise matching result/argument type. Hence the signature</p>\n\n<pre><code>f2 :: (\u03b1 -&gt; \u03b2) -&gt; (\u03b2 -&gt; \u03b3) -&gt; (\u03b3 -&gt; \u03b4) -&gt; \u03b1 -&gt; \u03b4\n</code></pre>\n\n<p>You could now go on and implement this in explicit-pointed form, i.e.</p>\n\n<pre><code>f2 f g h x = h (g (f x))\n</code></pre>\n\n<p>which is still quite brief. After all, it's quite a simple task!</p>\n\n<p>But in Haskell you can make it even shorter, by using the standard composition operator <code>.</code>. The fact that the final implementation is so extremely short is basically just down to the fact that <code>f2</code> does essentially the same thing as <code>.</code>, just twice. So this isn't more surprising than if you have a very complex task with a complicated type signature, but discover some library that contains a function which does almost that exact task. Obviously, invoking that ready-build function will give you a much shorter implementation than the task complexity would suggest, but the complexity is merely deferred to the library function.</p>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 7122314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f690d41d4687cba4052df317f819c09?s=128&d=identicon&r=PG&f=1", "display_name": "Kai D", "link": "https://stackoverflow.com/users/7122314/kai-d"}, "edited": false, "score": 0, "creation_date": 1494162916, "post_id": 43831869, "comment_id": 74700668, "body": "The 4th point is what is confusing me, I understand up until there. Specifically I don&#39;t get &quot;takes in whatever f does and returns whatever h returns,&quot;"}, {"owner": {"reputation": 133, "user_id": 7122314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f690d41d4687cba4052df317f819c09?s=128&d=identicon&r=PG&f=1", "display_name": "Kai D", "link": "https://stackoverflow.com/users/7122314/kai-d"}, "edited": false, "score": 0, "creation_date": 1494163306, "post_id": 43831869, "comment_id": 74700796, "body": "Okay I stared at it a little longer and I now understand why d, or c in the example I gave, would be there but I&#39;m still a bit confused about why a has to be there."}, {"owner": {"reputation": 9898, "user_id": 116546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/967bbcaf95419a577f2443cd31658216?s=128&d=identicon&r=PG", "display_name": "drdaeman", "link": "https://stackoverflow.com/users/116546/drdaeman"}, "reply_to_user": {"reputation": 133, "user_id": 7122314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f690d41d4687cba4052df317f819c09?s=128&d=identicon&r=PG&f=1", "display_name": "Kai D", "link": "https://stackoverflow.com/users/7122314/kai-d"}, "edited": false, "score": 1, "creation_date": 1494163415, "post_id": 43831869, "comment_id": 74700827, "body": "@KaiD: consider a slightly simpler example <code>f3 f g = f . g</code>, which would have a type <code>f3 :: (a -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c</code>. It takes two functions (<code>f</code> and <code>g</code>), and produces a new one. In the <code>a -&gt; c</code> part, it says that the input type of the produced function will be <code>a</code> - the same type that <code>f</code> takes in. And the return type is <code>d</code>, the same as <code>g</code> returns. For example, if <code>f</code> takes a string and returns an integer, and <code>g</code> takes an integer and returns a boolean then the result of <code>f3</code> must take a string and return a boolean - this is what the type declaration says. Makes sense?"}, {"owner": {"reputation": 9898, "user_id": 116546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/967bbcaf95419a577f2443cd31658216?s=128&d=identicon&r=PG", "display_name": "drdaeman", "link": "https://stackoverflow.com/users/116546/drdaeman"}, "reply_to_user": {"reputation": 133, "user_id": 7122314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f690d41d4687cba4052df317f819c09?s=128&d=identicon&r=PG&f=1", "display_name": "Kai D", "link": "https://stackoverflow.com/users/7122314/kai-d"}, "edited": false, "score": 0, "creation_date": 1494163546, "post_id": 43831869, "comment_id": 74700871, "body": "@KaiD because with a function composition, your result type is a function. <code>d</code> (<code>c</code> in your example) is only a result type of that function."}, {"owner": {"reputation": 9898, "user_id": 116546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/967bbcaf95419a577f2443cd31658216?s=128&d=identicon&r=PG", "display_name": "drdaeman", "link": "https://stackoverflow.com/users/116546/drdaeman"}, "reply_to_user": {"reputation": 133, "user_id": 7122314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f690d41d4687cba4052df317f819c09?s=128&d=identicon&r=PG&f=1", "display_name": "Kai D", "link": "https://stackoverflow.com/users/7122314/kai-d"}, "edited": false, "score": 0, "creation_date": 1494164043, "post_id": 43831869, "comment_id": 74701038, "body": "@KaiD Just a suggestion. Check out <a href=\"http://learnyouahaskell.com/higher-order-functions\" rel=\"nofollow noreferrer\">learnyouahaskell.com/higher-order-functions</a>. It&#39;s about the same stuff (functions, taking functions and returning other functions) so the explanations and examples from there may be helpful."}, {"owner": {"reputation": 133, "user_id": 7122314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f690d41d4687cba4052df317f819c09?s=128&d=identicon&r=PG&f=1", "display_name": "Kai D", "link": "https://stackoverflow.com/users/7122314/kai-d"}, "edited": false, "score": 0, "creation_date": 1494165808, "post_id": 43831869, "comment_id": 74701568, "body": "Thanks, I&#39;ll have a look."}], "tags": [], "owner": {"reputation": 9898, "user_id": 116546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/967bbcaf95419a577f2443cd31658216?s=128&d=identicon&r=PG", "display_name": "drdaeman", "link": "https://stackoverflow.com/users/116546/drdaeman"}, "is_accepted": true, "score": 3, "last_activity_date": 1494162465, "creation_date": 1494162465, "answer_id": 43831869, "question_id": 43831640, "link": "https://stackoverflow.com/questions/43831640/understanding-the-haskell-type-of-this-expression/43831869#43831869", "title": "Understanding the Haskell type of this expression", "body": "<p>Why do you think it's complicated? It's just a function that takes three functions (of matching types) and returns a new one.</p>\n\n<p>I've renamed <code>b1</code> to <code>b</code> and updated other names, for consistency. So here is a slightly edited version:</p>\n\n<blockquote>\n  <p><code>f2 :: (a -&gt; b) -&gt; (b -&gt; c) -&gt; (c -&gt; d) -&gt; a -&gt; d</code></p>\n</blockquote>\n\n<ul>\n<li>Here, <code>f2</code> takes <code>f</code> which has type <code>a -&gt; b</code>. Meaning, it's a function, with some input of some type <code>a</code> (<code>a</code> can be just anything, no restrictions here) and some return value of type <code>b</code>.</li>\n<li>Then <code>f2</code> takes <code>g</code> which input's type must match <code>f</code>'s output, so it's <code>b -&gt; c</code>. It cannot be, like, <code>e -&gt; c</code> (where <code>e</code> is something different from <code>b</code>), or the code won't make sense as it won't be possible to compose <code>f . g</code>.</li>\n<li>And exactly the same goes for the third argument, <code>h</code>, with type <code>c -&gt; d</code>.</li>\n<li>The result of function composition (what <code>f2</code> returns) is a new function that takes in whatever <code>f</code> does and returns whatever <code>h</code> returns, so it's <code>a -&gt; d</code>. With this we've covered the whole type definition.</li>\n</ul>\n\n<p>Basically, it's a relatively long definition, but I think it's of a very simple nature.</p>\n"}], "owner": {"reputation": 133, "user_id": 7122314, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f690d41d4687cba4052df317f819c09?s=128&d=identicon&r=PG&f=1", "display_name": "Kai D", "link": "https://stackoverflow.com/users/7122314/kai-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 43831869, "answer_count": 2, "score": 0, "last_activity_date": 1494164369, "creation_date": 1494161256, "question_id": 43831640, "link": "https://stackoverflow.com/questions/43831640/understanding-the-haskell-type-of-this-expression", "title": "Understanding the Haskell type of this expression", "body": "<p>I was doing a Haskell types exercise and this one has stumped me. The provided expression is:</p>\n\n<pre><code>f2 f g h = h.g.f\n</code></pre>\n\n<p>And the type for f2 is apparently:</p>\n\n<pre><code>f2 :: (a -&gt; b1) -&gt; (b1 -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c\n</code></pre>\n\n<p>This seems overly complicated for such a short expression. Can someone explain why this makes sense as the type?</p>\n"}, {"tags": ["haskell", "windows-7"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1494151581, "post_id": 43830057, "comment_id": 74697627, "body": "Try writing <code>hSetBuffering stdout NoBuffering</code> before <code>putStrLn &quot;Start</code> ?"}, {"owner": {"reputation": 155, "user_id": 5329573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28db297df0023a9aa729261e8c6bc447?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Allen", "link": "https://stackoverflow.com/users/5329573/aaron-allen"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1494152963, "post_id": 43830057, "comment_id": 74698021, "body": "Thanks, it worked."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494153300, "post_id": 43830057, "comment_id": 74698113, "body": "@duplode : I think this is a better duplicate: <a href=\"http://stackoverflow.com/questions/13190314/haskell-do-monad-io-happens-out-of-order\" title=\"haskell do monad io happens out of order\">stackoverflow.com/questions/13190314/&hellip;</a>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1494153421, "post_id": 43830057, "comment_id": 74698144, "body": "@Sibi I added it to the list; thanks."}], "owner": {"reputation": 155, "user_id": 5329573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28db297df0023a9aa729261e8c6bc447?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Allen", "link": "https://stackoverflow.com/users/5329573/aaron-allen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 206, "favorite_count": 0, "closed_date": 1494153155, "answer_count": 0, "score": 1, "last_activity_date": 1494153396, "creation_date": 1494150476, "question_id": 43830057, "link": "https://stackoverflow.com/questions/43830057/haskell-io-output-not-printed-until-program-exits", "closed_reason": "Duplicate", "title": "Haskell IO - Output not printed until program exits", "body": "<p>If I write a program like:</p>\n\n<pre><code>main = do\n    putStrLn \"Start\"\n    i &lt;- getLine\n    putStrLn $ \"Exit \" ++ i\n</code></pre>\n\n<p>When I run it, the output is not given until execution finishes, It just waits for input and then all the output is given at once instead of the first string being printed before the input prompt occurs. </p>\n\n<p>I've tried compiling the program and running in cygwin, also tried using the <code>runhaskell</code> command. I'm on windows 7.</p>\n\n<p>Does anyone know what the problem could be?</p>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1494184819, "post_id": 43829932, "comment_id": 74707915, "body": "You should give your functions type signatures, post the error messages you get, and why you don&#39;t understand the error message. In this case it looks like you wrote <code>duplicate [(x,_):xs]</code> when you meant <code>duplicate ((x,_):xs)</code> for one thing. Open ghci and type things like <code>:t elem</code>, <code>:t [0]</code>, etc. while you&#39;re developing"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 6917467, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d2aa2193b4faf2f3a08b1faa9ec4aea?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine Boutabia", "link": "https://stackoverflow.com/users/6917467/yassine-boutabia"}, "edited": false, "score": 0, "creation_date": 1494157479, "post_id": 43830374, "comment_id": 74699205, "body": "Thank you @Ami Tavory that did the job nicely."}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": false, "score": 1, "last_activity_date": 1494152733, "creation_date": 1494152733, "answer_id": 43830374, "question_id": 43829932, "link": "https://stackoverflow.com/questions/43829932/how-drop-first-occurence-of-tuple-based-on-similar-key-value-in-haskell-using-pa/43830374#43830374", "title": "How drop first occurence of tuple based on similar key value in Haskell using pattern matching?", "body": "<p>For a relatively simple yet inefficient (quadratic time) solution, you could do the following:</p>\n\n<pre><code>removeFirstDuplicate :: Eq a =&gt; [(a, b)] -&gt; [(a, b)]                                                                                                                                                    \nremoveFirstDuplicate [] = []\nremoveFirstDuplicate (hd@(x, _):tl) =\n    let\n        rest = removeFirstDuplicate tl\n    in\n        if x `elem` (map rest tl) then rest else hd:rest\n</code></pre>\n\n<p>It says that removing the first duplicate of an empty list is the empty list. Removing the first duplicate of a tuple with a <code>fst</code> <code>x</code> entails removing the first duplicates of the tail, then either appending the first tuple to the result or not, based on whether it's in the tail.</p>\n\n<hr>\n\n<p>Full code:</p>\n\n<pre><code>removeFirstDuplicate :: Eq a =&gt; [(a, b)] -&gt; [(a, b)]\nremoveFirstDuplicate [] = []\nremoveFirstDuplicate xs@(hd@(x, _):tl) =\n    let\n        rest = removeFirstDuplicate tl\n    in\n        if x `elem` (map fst rest) then rest else hd:rest                                                                                                                                               \n\n\nmain =\n    let\n        l = [(1, 'a'), (2, 'b'), (1, 'c'), (1, 'd'), (2, 'f')]\n    in\n        do\n            putStrLn $ show $ removeFirstDuplicate l\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ ghc duplicates.hs &amp;&amp; ./duplicates \n[(1,'d'),(2,'f')]\n</code></pre>\n\n<hr>\n\n<p>Of course, it should be possible to solve it in linear time imperatively, or in <em>&Theta;(n log(n))</em> with a balanced tree: First iterate over the tuples, and map each <code>fst</code> item to the last index where it appears. Then iterate again, and retain only tuples whose <code>fst</code> item is at the index recorded as last.</p>\n"}, {"comments": [{"owner": {"reputation": 109, "user_id": 6917467, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d2aa2193b4faf2f3a08b1faa9ec4aea?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine Boutabia", "link": "https://stackoverflow.com/users/6917467/yassine-boutabia"}, "edited": false, "score": 0, "creation_date": 1494157309, "post_id": 43830859, "comment_id": 74699172, "body": "Thank you @Redu it that close to what I&#39;m looking for."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 109, "user_id": 6917467, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d2aa2193b4faf2f3a08b1faa9ec4aea?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine Boutabia", "link": "https://stackoverflow.com/users/6917467/yassine-boutabia"}, "edited": false, "score": 0, "creation_date": 1494160823, "post_id": 43830859, "comment_id": 74700099, "body": "You are welcome. BTW I have also added a more efficient code to my answer."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": true, "score": 1, "last_activity_date": 1494160761, "last_edit_date": 1494160761, "creation_date": 1494156048, "answer_id": 43830859, "question_id": 43829932, "link": "https://stackoverflow.com/questions/43829932/how-drop-first-occurence-of-tuple-based-on-similar-key-value-in-haskell-using-pa/43830859#43830859", "title": "How drop first occurence of tuple based on similar key value in Haskell using pattern matching?", "body": "<p>I am new to Haskell so please correct me if i am wrong. In this type of problem my JavaScript instincts tell me to use a Map or Hash. However when i check the <code>Data.Map</code> library i have noticed that it's a tree implementation and lookups are like O(log n). So i thought it might be similar in performance if i use <code>sortOn</code> instead. Any further info on this is highly appreciated.</p>\n\n<p>So my solution would be;</p>\n\n<pre><code>dropFirstDupe :: (Ord a, Eq a) =&gt; [(a,b)] -&gt; [(a,b)]\ndropFirstDupe []  = []\ndropFirstDupe [t] = [t]\ndropFirstDupe ts  | fst t1 == fst t2 = dropFirstDupe (t2:tr)\n                  | otherwise        = t1 : dropFirstDupe (t2:tr)\n                  where (t1:t2:tr)   = sortOn fst ts\n\n*Main&gt; dropFirstDupe [(1,2),(3,6),(8,7),(1,5),(3,3),(7,9)]\n[(1,5),(3,3),(7,9),(8,7)]\n</code></pre>\n\n<p>Note: If there exists more than 2 duplicates then it will keep the last one.</p>\n\n<p>Well on a second thought i guess in the above snippet I am running the <code>sortOn</code> function in every turn of the recursion which is totally unnecessary. So a more efficient version of the above code should be;</p>\n\n<pre><code>dropFirstDupe :: (Ord a, Eq a) =&gt; [(a,b)] -&gt; [(a,b)]\ndropFirstDupe []  = []\ndropFirstDupe ts  = dfd (sortOn fst ts)\n                    where dfd [t]        = [t]\n                          dfd (t1:t2:tr) | fst t1 == fst t2 = dfd (t2:tr)\n                                         | otherwise        = t1 : dfd (t2:tr)\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 6917467, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d2aa2193b4faf2f3a08b1faa9ec4aea?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine Boutabia", "link": "https://stackoverflow.com/users/6917467/yassine-boutabia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 43830859, "answer_count": 2, "score": 1, "last_activity_date": 1494160761, "creation_date": 1494149470, "last_edit_date": 1494156833, "question_id": 43829932, "link": "https://stackoverflow.com/questions/43829932/how-drop-first-occurence-of-tuple-based-on-similar-key-value-in-haskell-using-pa", "title": "How drop first occurence of tuple based on similar key value in Haskell using pattern matching?", "body": "<p>I'm trying to drop the first occurence of tuple based on first value of tuple.\nmy plan is to go through the list of tuples and see if the key is present in the rest of the list, if it is there then return the rest of the list and look for other duplicates otherwise add the element to returned list.</p>\n\n<pre><code>duplicate [(x,_):xs]= if (elem (x,_) xs ) \n                      then xs \n                      else x ++ duplicate xs \n</code></pre>\n\n<p>I hope this makes sense, and thank you for any help.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 1556, "user_id": 1392943, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/606e0a60eca298e29ce56b5544de4950?s=128&d=identicon&r=PG&f=1", "display_name": "Kamel", "link": "https://stackoverflow.com/users/1392943/kamel"}, "is_accepted": false, "score": 0, "last_activity_date": 1494225735, "creation_date": 1494225735, "answer_id": 43841306, "question_id": 43829630, "link": "https://stackoverflow.com/questions/43829630/how-to-print-a-fractional-x-without-decimal-point-if-and-only-if-x-is-integral/43841306#43841306", "title": "How to print a Fractional x without decimal point if and only if x is Integral?", "body": "<p>How about the following?</p>\n\n<pre><code>printFrac :: (Show a, RealFrac a) =&gt; a -&gt; IO ()\nprintFrac x\n  | a == 0 = print b\n  | otherwise = print x\n  where (b, a) = properFraction x\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>\u03bb&gt; printFrac 1.0\n1\n\u03bb&gt; printFrac 1.1\n1.1\n\u03bb&gt; printFrac 1\n1\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6998714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/662001fc95dd224902b4d5cfffc86e73?s=128&d=identicon&r=PG", "display_name": "user2958647", "link": "https://stackoverflow.com/users/6998714/user2958647"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494225735, "creation_date": 1494147375, "last_edit_date": 1494148576, "question_id": 43829630, "link": "https://stackoverflow.com/questions/43829630/how-to-print-a-fractional-x-without-decimal-point-if-and-only-if-x-is-integral", "title": "How to print a Fractional x without decimal point if and only if x is Integral?", "body": "<p>In Haskell how to print a Fractional x without decimal point if and only if x is Integral? Please improve my code below:</p>\n\n<pre><code>printFrac :: (Show a, RealFrac a) =&gt; a -&gt; IO ()\nprintFrac x = if x==fromIntegral (round x) then print (round x) else print x\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1494144789, "post_id": 43829239, "comment_id": 74695814, "body": "Be more specific. &quot;Can someone help me&quot; is a yes/no question."}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1494144864, "post_id": 43829239, "comment_id": 74695835, "body": "well, i need to write this function but I don&#39;t even know from where to start. I&#39;ve specifed that I&#39;ve just started to learn haskell :)"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1494144944, "post_id": 43829239, "comment_id": 74695854, "body": "So you want someone to teach you Haskell from scratch? That&#39;s too broad for SO."}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1494145061, "post_id": 43829239, "comment_id": 74695878, "body": "I don&#39;t expect someone to teach me from scratch..I asked this question in order to find a start point..I know a few things, but i don&#39;t have any idea about this one."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1494145131, "post_id": 43829239, "comment_id": 74695895, "body": "Do you know how to check whether <code>x</code> is divisible by <code>y</code>? Do you know how list comprehensions work?"}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1494145284, "post_id": 43829239, "comment_id": 74695938, "body": "I wrote a function that checks if a number is isdivided  and replace it, but it;s for int..it&#39;s not for a string"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1494145308, "post_id": 43829239, "comment_id": 74695951, "body": "What&#39;s <code>isDivided</code>?"}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1494145436, "post_id": 43829239, "comment_id": 74695978, "body": "I suppose that i should write another function that check if a number is divisible by n, I&#39;m trying to figure it how, until then..i ve just call it. Hope I didn&#39;t said something stupid :)"}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1494145685, "post_id": 43829239, "comment_id": 74696041, "body": "isDivisible I think I can replace with  x <code>rem</code> N == 0"}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 1, "last_activity_date": 1494145682, "creation_date": 1494145682, "answer_id": 43829392, "question_id": 43829239, "link": "https://stackoverflow.com/questions/43829239/haskell-replace-specific-characthers-of-a-string/43829392#43829392", "title": "Haskell replace specific characthers of a string", "body": "<p>Your approach is basically correct. If you change the type signature:</p>\n\n<pre><code>replace :: Char -&gt; Int -&gt; String -&gt; String\n</code></pre>\n\n<p>and add another argument:</p>\n\n<pre><code>replace y d xs = [ if isDivisible i d then y else x | (i,x) &lt;- zip [0..] xs ]\n</code></pre>\n\n<p>then you're almost done. You just have to write <code>isDivisible</code>.</p>\n"}], "owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494145958, "creation_date": 1494144650, "last_edit_date": 1494145215, "question_id": 43829239, "link": "https://stackoverflow.com/questions/43829239/haskell-replace-specific-characthers-of-a-string", "title": "Haskell replace specific characthers of a string", "body": "<p>I've just started to learn haskell so this might be a really simple question..but here it is:\nI have a string, a charachter C and a number N. I need to write a function that replaces all the characthers from the position of the string that are divided by N with characther C. \nI must use list comprehension and only Base Function or Library function.</p>\n\n<pre><code> replace::Char-&gt;Int-&gt;String-&gt;String \n</code></pre>\n\n<p>Can someone please help me?</p>\n\n<pre><code>replace :: Int -&gt; [Int] -&gt; [Int]\nreplace y xs = [ if isDivided i then y else x | (i,x) &lt;- zip [0..] xs ]\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 790, "user_id": 334632, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SL2Mb.jpg?s=128&g=1", "display_name": "Joe Hillenbrand", "link": "https://stackoverflow.com/users/334632/joe-hillenbrand"}, "edited": false, "score": 0, "creation_date": 1494147669, "post_id": 43829231, "comment_id": 74696566, "body": "&quot;it reports errors about mismatched versions&quot; Can you post the errors?"}], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 1, "last_activity_date": 1494158723, "creation_date": 1494158723, "answer_id": 43831263, "question_id": 43829231, "link": "https://stackoverflow.com/questions/43829231/how-to-use-a-specific-branch-of-llvm-general-with-stack/43831263#43831263", "title": "how to use a specific branch of llvm-general with stack", "body": "<p>Your <code>.cabal</code> does not list <code>llvm-general</code> and <code>llvm-general-pure</code> as dependencies, hence why <code>LLVM.General.AST</code> is not being found.</p>\n\n<p>Moreover, your <code>stack.yaml</code> is pointing to <code>master</code>, so <code>stack</code> will only see version 3.5. <code>stack</code> doesn't know anything about version 3.9 if it's not in the <code>stack.yaml</code> file. Either:</p>\n\n<ul>\n<li>change the commit to <code>ec1ad5bd2112e7f64dbb43441b5e2075cf6ad8e</code>;</li>\n<li><p>or, if you have the branch cloned locally, you can replace the whole <code>location</code> field corresponding to the repository with</p>\n\n<pre><code>- location: 'path/to/llvm-general'\n  extra-dep: true\n- location: 'path/to/llvm-general-pure'\n  extra-dep: true\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 43831263, "answer_count": 1, "score": 0, "last_activity_date": 1494158723, "creation_date": 1494144613, "last_edit_date": 1494144718, "question_id": 43829231, "link": "https://stackoverflow.com/questions/43829231/how-to-use-a-specific-branch-of-llvm-general-with-stack", "title": "how to use a specific branch of llvm-general with stack", "body": "<p>In one of my projects I want to use <code>llvm-general</code> and <code>llvm-general-pure</code> but I want to use the llvm-3.9 branch which works with llvm 3.9, the latest version of these libraries on hackage are for llvm 3.5.  </p>\n\n<p>My project is a stack project, this is what I have in stack.yaml :  </p>\n\n<pre><code>resolver: nightly-2017-05-01       \npackages:\n- '.'\n- location:\n     git: https://github.com/bscarlet/llvm-general.git     \n     commit: 61fd03639063283e7dc617698265cc883baf0eec\n  subdirs:\n     - llvm-general\n     - llvm-general-pure\n  extra-dep: true    \n</code></pre>\n\n<p>All other options are left to default.    </p>\n\n<p>This is my project.cabal :  </p>\n\n<pre><code>name:                compiler-final\nversion:             0.1.0.0    \ncategory:            Compiler\nbuild-type:          Simple\n-- extra-source-files:\ncabal-version:       &gt;=1.10\n\nlibrary\n  hs-source-dirs:      src\n  exposed-modules:     Lexer,Parser,ParserTestData,CodeGen\n  other-modules:       Prelude,StateTUtil\n  ghc-options:         -Wall -dcore-lint -fhpc -XNoImplicitPrelude -fobject-code\n  build-depends:       base-noprelude &gt;= 4.7 &amp;&amp; &lt; 5 , megaparsec &lt; 6 , transformers &lt; 1, unordered-containers &lt; 1 , hashable &lt; 2\n                       ,classy-prelude , either &lt; 5 , mono-traversable &lt; 2 , logfloat &lt; 0.14 , text\n  default-language:    Haskell2010\n  default-extensions:  OverloadedStrings\n\nexecutable compiler-final-exe\n  hs-source-dirs:      app\n  main-is:             Main.hs\n  ghc-options:         -threaded -rtsopts -XNoImplicitPrelude -with-rtsopts=-N -fobject-code\n  build-depends:       base\n                     , compiler-final\n  default-language:    Haskell2010\n  default-extensions:  OverloadedStrings\n\ntest-suite compiler-final-test\n  type:                exitcode-stdio-1.0\n  hs-source-dirs:      test\n  other-modules:       LexerSpec , ParserSpec\n  main-is:             Spec.hs\n  build-depends:       base\n                       , compiler-final, megaparsec &lt; 6 , hspec &lt; 3,hspec-megaparsec &gt;= 0.3,unordered-containers &lt; 1\n                       ,hashable,transformers &lt; 1,text,bytestring , mtl, text\n  ghc-options:         -threaded -rtsopts -with-rtsopts=-N -fhpc -Wall -XNoImplicitPrelude -fobject-code\n  default-language:    Haskell2010\n  default-extensions:  OverloadedStrings\nBenchmark compiler-final-bench\n  type:                exitcode-stdio-1.0\n  hs-source-dirs:      bench\n  main-is:             Bench.hs\n  other-modules:       ParserBench\n  build-depends:       base,compiler-final,megaparsec &lt; 6 ,unordered-containers &lt; 1,QuickCheck&lt;3\n                       ,hashable\n  ghc-options:         -rtsopts -auto-all -caf-all -fforce-recomp -fobject-code\n  default-language:    Haskell2010\n</code></pre>\n\n<p>Unfortunately in CodeGen.hs this simple import statement doesn't compile :  <code>import LLVM.General.AST</code>, it says it didn't find the module.  </p>\n\n<p>Now I have llvm-general branch 3.9 installed globally through <code>cabal install</code> and I can access it with <code>ghci -package</code>(not <code>stack ghci</code>) and the above module exists.  </p>\n\n<p>I tried adding <code>llvm-general</code> and <code>llvm-general-pure</code> to my dependencies list with version <code>3.9.0.0</code> but stack seems to try to install version <code>3.5</code> because it reports errors about mismatched versions.  </p>\n\n<p>So how to achieve what I want ? </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 751, "user_id": 7092612, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f2c7e756b5d374d5dc5d9ed2b99dbc07?s=128&d=identicon&r=PG&f=1", "display_name": "wrek", "link": "https://stackoverflow.com/users/7092612/wrek"}, "edited": false, "score": 0, "creation_date": 1494133558, "post_id": 43828018, "comment_id": 74693540, "body": "so, it is equivalent as <code>addNat (Succ n) Zero = Succ n</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 751, "user_id": 7092612, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f2c7e756b5d374d5dc5d9ed2b99dbc07?s=128&d=identicon&r=PG&f=1", "display_name": "wrek", "link": "https://stackoverflow.com/users/7092612/wrek"}, "edited": false, "score": 1, "creation_date": 1494133669, "post_id": 43828018, "comment_id": 74693558, "body": "@wrek It is semantically equivalent, though GHC and other compilers may do something slightly different with that code. Specifically, with <code>addNat n@(Succ _) Zero = n</code>, GHC will not allocate a new <code>Nat</code>, whereas with <code>addNat (Succ n) Zero = Succ n</code>, GHC may (especially at low optimization levels) destruct the first argument and construct a <i>new</i> <code>Nat</code> with the same meaning as the old one."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1494133451, "creation_date": 1494133451, "answer_id": 43828018, "question_id": 43827995, "link": "https://stackoverflow.com/questions/43827995/haskell-operator-confusion/43828018#43828018", "title": "Haskell @ operator confusion", "body": "<p>If <code>name</code> is a variable name, and <code>pat</code> is a pattern, then <code>name@pat</code> is a pattern that matches exactly when <code>pat</code> does, and also binds <code>name</code> to the value that matched <code>pat</code>. So:</p>\n\n<pre><code>addNat n@(Succ _) Zero = n\n</code></pre>\n\n<p>says \"if the first argument is a <code>Succ</code> and the second is a <code>Zero</code>, then return the first argument\".</p>\n"}], "owner": {"reputation": 751, "user_id": 7092612, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f2c7e756b5d374d5dc5d9ed2b99dbc07?s=128&d=identicon&r=PG&f=1", "display_name": "wrek", "link": "https://stackoverflow.com/users/7092612/wrek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "closed_date": 1494133914, "accepted_answer_id": 43828018, "answer_count": 1, "score": 0, "last_activity_date": 1494133873, "creation_date": 1494133274, "last_edit_date": 1494133873, "question_id": 43827995, "link": "https://stackoverflow.com/questions/43827995/haskell-operator-confusion", "closed_reason": "Duplicate", "title": "Haskell @ operator confusion", "body": "<pre><code>data Nat = Zero | Succ Nat \n       deriving (Eq, Show)\n\n-- Add two Natural number\naddNat :: Nat -&gt; Nat -&gt; Nat \naddNat Zero Zero         = Zero\naddNat Zero n@(Succ _)   = n\naddNat n@(Succ _) Zero   = n\naddNat (Succ x) (Succ y) = Succ (Succ (addNat x y))\n</code></pre>\n\n<p>I am confuse about the @ operator in Haskell function. </p>\n\n<p>I am wondering what does <code>addNat Zero n@(Succ _)   = n</code> means? </p>\n\n<p>Does it mean that <code>addNat Zero Succ b = Succ b</code>?</p>\n"}, {"tags": ["haskell", "ghc", "constraint-kinds"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1494134202, "post_id": 43827374, "comment_id": 74693633, "body": "When you say &quot;derive X from Y&quot;, I&#39;d rather say &quot;derive Y from X&quot;. In your first example, we have that <code>Integral t</code> implies <code>Num t</code>, and not the other way around. GHC has to extract a <code>Num</code> dictionary from the passed <code>Integral</code> one. And similarly for the other cases you mention below."}], "answers": [{"tags": [], "owner": {"reputation": 11412, "user_id": 617159, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc43cf2d76ce0981a21c0e5a817f96f5?s=128&d=identicon&r=PG", "display_name": "Lambda Fairy", "link": "https://stackoverflow.com/users/617159/lambda-fairy"}, "is_accepted": true, "score": 7, "last_activity_date": 1494133752, "last_edit_date": 1494133752, "creation_date": 1494133373, "answer_id": 43828008, "question_id": 43827374, "link": "https://stackoverflow.com/questions/43827374/constraining-constraints/43828008#43828008", "title": "Constraining constraints", "body": "<p>The <a href=\"https://hackage.haskell.org/package/constraints\" rel=\"noreferrer\"><code>constraints</code></a> package provides a solution to this problem, via its <code>:-</code> (\"entails\") type:</p>\n\n<pre><code>{-# LANGUAGE ConstraintKinds #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE TypeOperators #-}\n\nimport GHC.Exts\n\ndata Dict :: Constraint -&gt; * where\n    Dict :: a =&gt; Dict a\n\nnewtype a :- b = Sub (a =&gt; Dict b)\ninfixr 9 :-\n\ng, g' :: c2 a =&gt; c2 a :- c1 a -&gt; (forall b. c1 b =&gt; b) -&gt; a\ng (Sub Dict) x = x\n</code></pre>\n\n<p>Then, by passing in an appropriate witness, we can recover the original example:</p>\n\n<pre><code>integralImpliesNum :: Integral a :- Num a\nintegralImpliesNum = Sub Dict\n\nf :: Integral a =&gt; (forall b. Num b =&gt; b) -&gt; a\nf = g integralImpliesNum\n</code></pre>\n\n<p>In fact, this <code>g</code> is merely a flipped and specialized version of the <code>\\\\</code> operator:</p>\n\n<pre><code>(\\\\) :: a =&gt; (b =&gt; r) -&gt; (a :- b) -&gt; r\nr \\\\ Sub Dict = r\ninfixl 1 \\\\\n\ng' = flip (\\\\)\n</code></pre>\n\n<p>If you have the time, Edward Kmett's talk <a href=\"https://www.youtube.com/watch?v=hIZxTQP1ifo&amp;t=2700s\" rel=\"noreferrer\">\"Type Classes vs the World\"</a> is a great introduction to how this all works.</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "accepted_answer_id": 43828008, "answer_count": 1, "score": 6, "last_activity_date": 1494133752, "creation_date": 1494125749, "last_edit_date": 1494131142, "question_id": 43827374, "link": "https://stackoverflow.com/questions/43827374/constraining-constraints", "title": "Constraining constraints", "body": "<p>I can write the following:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE UndecidableInstances #-}\n{-# LANGUAGE ConstraintKinds #-}\n\nf :: Integral a =&gt; (forall b. Num b =&gt; b) -&gt; a\nf = id\n</code></pre>\n\n<p>And all is good. Presumably GHC can derive <code>Integral</code> from <code>Num</code> so all is well.</p>\n\n<p>I can be a bit tricker, yet I'm still fine:</p>\n\n<pre><code>class Integral x =&gt; MyIntegral x\ninstance Integral x =&gt; MyIntegral x\n\nclass Num x =&gt; MyNum x\ninstance Num x =&gt; MyNum x\n\nf' :: MyIntegral a =&gt; (forall b. MyNum b =&gt; b) -&gt; a\nf' = id\n</code></pre>\n\n<p>So lets say I want to generalise this, like so:</p>\n\n<pre><code>g :: c2 a =&gt; (forall b. c1 b =&gt; b) -&gt; a\ng = id\n</code></pre>\n\n<p>Now obviously this will spit the dummy, because GHC can not derive <code>c2</code> from <code>c1</code>, as <code>c2</code> is not constrained.</p>\n\n<p>What do I need to add to the type signature of <code>g</code> to say that \"you can derive <code>c2</code> from <code>c1</code>\"? </p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 10, "creation_date": 1494095216, "post_id": 43823946, "comment_id": 74686082, "body": "Why not just <code>fnl list = [head list, last list]</code>?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 5, "creation_date": 1494095727, "post_id": 43823946, "comment_id": 74686236, "body": "Note you are working with lists, and not arrays."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 1, "creation_date": 1494100269, "post_id": 43823946, "comment_id": 74687562, "body": "@Michail that&#39;s an answer, as long as you add some additional explanation."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1494103959, "post_id": 43823946, "comment_id": 74688578, "body": "BTW, the code you posted does not give you only the last element of a list, try e.g. <code>fnl [1,3,1,5,1]</code> which results in <code>[1,1,1]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "is_accepted": true, "score": 0, "last_activity_date": 1494152333, "creation_date": 1494152333, "answer_id": 43830307, "question_id": 43823946, "link": "https://stackoverflow.com/questions/43823946/how-to-make-a-new-list-from-a-lists-first-and-last-item-haskell/43830307#43830307", "title": "How to make a new list from a lists first and last item Haskell?", "body": "<p>The simplest solution would be</p>\n\n<pre><code>fnl list = [head list, last list]\n</code></pre>\n\n<p><code>head</code> gives you the first element of a list, <code>last</code> gives the last one. This way you can avoid both indexing into the list (which generally should be avoided, especially if you have an option of using Prelude functions, as in this case) and getting its length.</p>\n"}], "owner": {"reputation": 1232, "user_id": 7453707, "user_type": "registered", "accept_rate": 72, "profile_image": "https://lh4.googleusercontent.com/-ga6gJDP75pc/AAAAAAAAAAI/AAAAAAAAAO0/pIEgPij3PqU/photo.jpg?sz=128", "display_name": "ShocKwav3_", "link": "https://stackoverflow.com/users/7453707/shockwav3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 43830307, "answer_count": 1, "score": 0, "last_activity_date": 1494152333, "creation_date": 1494095098, "last_edit_date": 1494101147, "question_id": 43823946, "link": "https://stackoverflow.com/questions/43823946/how-to-make-a-new-list-from-a-lists-first-and-last-item-haskell", "title": "How to make a new list from a lists first and last item Haskell?", "body": "<p>I have this code:</p>\n\n<pre><code>fnl list = [x | x &lt;- list, x==list!!((length list)-1)]\n</code></pre>\n\n<p>which gives me the last item of an array. How can i improve this to get the first item also?</p>\n"}, {"tags": ["string", "haskell", "compiler-construction"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1494095932, "post_id": 43823721, "comment_id": 74686297, "body": "Do you have anything against using an existing lexer like <a href=\"https://www.haskell.org/alex/\" rel=\"nofollow noreferrer\">Alex</a>? What about using a parsing library (like <code>megaparsec</code>, <code>attoparsec</code>, etc.)?"}, {"owner": {"reputation": 25, "user_id": 6176148, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-7jQJvlbIrxQ/AAAAAAAAAAI/AAAAAAAAALk/Dr8zUZBnu7I/photo.jpg?sz=128", "display_name": "Louis Hu", "link": "https://stackoverflow.com/users/6176148/louis-hu"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1494096238, "post_id": 43823721, "comment_id": 74686387, "body": "Yes, I do this more for the learning experience and get a better grasp on Haskell."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 2, "last_activity_date": 1494098690, "creation_date": 1494098690, "answer_id": 43824553, "question_id": 43823721, "link": "https://stackoverflow.com/questions/43823721/tokenize-a-string-into-a-list-of-strings-dependent-on-set-of-rules/43824553#43824553", "title": "Tokenize a string into a list of strings, dependent on set of rules", "body": "<p>You should probably define a a token data type (<code>data Token = ...</code>) if you are worried about efficiency. That said, here is a minimal tokenizer that does roughly what you are looking for. It works (tail) recursively, munching off a token (or whitespace) for every recursive call.</p>\n\n<p>I've chosen to discard whitespace instead of making it into a token.</p>\n\n<pre><code>import Data.Char\n\ntokenize :: String -&gt; [String]\ntokenize \"\" = []\ntokenize (c:cs)\n  | isSpace c = tokenize cs\n  | isAlpha c = let (i,cs') = span isAlphaNum cs in (c : i) : tokenize cs'\n  | isDigit c = let (n,cs') = span isDigit cs\n                in case cs' of\n                     ('.':cs'') -&gt; let (m,cs''') = span isDigit cs''\n                                   in (c : n ++ \".\" ++ m) : tokenize cs'''\n                     _ -&gt; (c : n) : tokenize cs'\n  | c `elem` \"+/*-()\" = [c] : tokenize cs\n  | otherwise = error $ \"unexpected character \" ++ show c\n</code></pre>\n\n<p>Here is in action:</p>\n\n<pre><code>ghci&gt; tokenize \"( (23.5+age) \u2217 (20.99+adres))\"\n[\"(\",\"(\",\"23.5\",\"+\",\"age\",\")\",\"*\",\"(\",\"20.99\",\"+\",\"adres\",\")\",\")\"]\n</code></pre>\n\n<p>That said: I <em>strongly</em> recommend you either write a parsing monad (something like <code>data Parser a = Parser { runParser :: String -&gt; Maybe (a,String) }</code>) so that you can write your parser monadically, or use an existing library/tool (see Alex and <code>megaparsec</code> in particular)</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 6176148, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-7jQJvlbIrxQ/AAAAAAAAAAI/AAAAAAAAALk/Dr8zUZBnu7I/photo.jpg?sz=128", "display_name": "Louis Hu", "link": "https://stackoverflow.com/users/6176148/louis-hu"}, "edited": false, "score": 0, "creation_date": 1494410646, "post_id": 43849528, "comment_id": 74812488, "body": "Hello, thanks for your message, it greatly helped me, but I cannot find what is missing in the tokenize function. And I don&#39;t understand how you use reverse for everything. Things are in the wrong order."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 25, "user_id": 6176148, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-7jQJvlbIrxQ/AAAAAAAAAAI/AAAAAAAAALk/Dr8zUZBnu7I/photo.jpg?sz=128", "display_name": "Louis Hu", "link": "https://stackoverflow.com/users/6176148/louis-hu"}, "edited": false, "score": 0, "creation_date": 1494463488, "post_id": 43849528, "comment_id": 74843258, "body": "@LouisHu: I accidentally wrote <code>foldl&#39; step StartState</code> when I meant <code>foldl&#39; step (StartState, [])</code>\u2014the initial list of tokens is empty. Instead of <code>snd</code>, which ignores the final state, you could write a function such as <code>end :: (State, [Token]) -&gt; [Token]</code> which defines what to do when the end of the string is reached in each state, e.g.: <code>end (NameState name, tokens) = reverse name : tokens</code>. I use <code>reverse</code> because, when accumulating characters/tokens, it\u2019s more efficient to <i>prepend</i> to a list (<code>x : xs</code>) than to append (<code>xs ++ [x]</code>), but you can use the latter if you find it clearer."}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 0, "last_activity_date": 1494463008, "last_edit_date": 1494463008, "creation_date": 1494251614, "answer_id": 43849528, "question_id": 43823721, "link": "https://stackoverflow.com/questions/43823721/tokenize-a-string-into-a-list-of-strings-dependent-on-set-of-rules/43849528#43849528", "title": "Tokenize a string into a list of strings, dependent on set of rules", "body": "<p>A good way to represent a state machine is with a fold. Here\u2019s the type of <code>foldl'</code> from <code>Data.List</code>, a <em>strict left fold</em>:</p>\n\n<pre><code>foldl' :: Foldable t =&gt; (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b\n</code></pre>\n\n<p>This type is pretty general, so it may help to see it specialised, with <code>t ~ []</code> and <code>a ~ Char</code>:</p>\n\n<pre><code>foldl' :: (b -&gt; Char -&gt; b) -&gt; b -&gt; [Char] -&gt; b\n</code></pre>\n\n<p>(Also recall that <code>type String = [Char]</code>.)</p>\n\n<p>So <code>foldl' step start input</code> will run the <code>step</code> function on each character of the <code>input</code>, beginning from the <code>start</code> state, and return the final state. We can introduce a type representing the possible states of the machine, as you started to do in your question:</p>\n\n<pre><code>data State\n  = StartState\n  | NameState String\n  | IntegerState String\n  | DecimalState String\n  | OperatorState String\n  | \u2026\n</code></pre>\n\n<p>However, our <code>step</code> function can\u2019t just be of type <code>State -&gt; Char -&gt; State</code>, because we <em>also</em> want to accumulate a list of tokens as output. We can just use a pair of the state and the accumulator:</p>\n\n<pre><code>step :: (State, [Token]) -&gt; Char -&gt; (State, [Token])\n</code></pre>\n\n<p>(For the sake of simplicity, I\u2019ll assume <code>type Token = String</code>, but in reality you would probably want to use an algebraic data type, e.g., <code>data Token = LeftParen | RightParen | Name String | Integer Int | \u2026</code>.)</p>\n\n<p>So the basic structure so far is:</p>\n\n<pre><code>import Data.Char\nimport Data.List (foldl')\n\ndata State = \u2026\n\ntokenize :: String -&gt; [Token]\ntokenize input = reverse $ snd $ foldl' step (StartState, []) input\n  where\n    step :: (State, [Token]) -&gt; Char -&gt; (State, [Token])\n</code></pre>\n\n<p>(We use <code>reverse</code> at the end because we\u2019ll be accumulating tokens by prepending them to the list (O(1)) rather than appending (O(n)).)</p>\n\n<p>Now you can proceed by simply filling in the cases\u2014<code>step</code> defines the transitions between states in the machine. When we want to emit a token, we return a new list of tokens:</p>\n\n<pre><code>step (StartState, tokens) '(' = (StartState, \"(\" : tokens)\nstep (StartState, tokens) ')' = (StartState, \")\" : tokens)\n</code></pre>\n\n<p>And when we want to perform state transitions, we return a new state:</p>\n\n<pre><code>step (StartState, tokens) char\n\n  -- Whitespace is ignored, looping back to the start state.\n  | isSpace char = (StartState, tokens)\n\n  -- Letters cause a transition to the \u201cname\u201d state.\n  | isLetter char = (NameState [char], tokens)\n\n  -- Digits, to the \u201cinteger\u201d state.\n  | isDigit char = (IntegerState [char], tokens)\n\n  -- And so on.\n  | char `elem` \"+-*/^\" = (OperatorState [char], tokens)\n  | \u2026\n</code></pre>\n\n<p>Then it\u2019s just a matter of implementing the transitions for all the other states. To make this easier, turning on <code>-Wall</code> will produce warnings about cases you haven\u2019t handled.</p>\n\n<p>For example, here\u2019s how you might implement the <code>NameState</code> transitions:</p>\n\n<pre><code>step (NameState name, tokens) char\n  | isLetter char || isDigit char = (NameState (char : name), tokens)\n  | otherwise = step (StartState, reverse name : tokens) char\n</code></pre>\n\n<p>When we get a letter or digit, we accumulate it in the <code>NameState</code>; when we get something else, we emit the token and return to the <code>StartState</code>. But note that we don\u2019t simply say <code>otherwise = (StartState, reverse name : tokens)</code>, because this would discard the character! Instead we <em>retry</em> the current character in the new state by calling <code>step</code> again.</p>\n\n<p>I\u2019ll leave it to you to figure out how to handle the end of the input; hint: there\u2019s something we\u2019ve forgotten to check after the fold is complete.</p>\n\n<p>This approach is rather limited; if you want to add monadic effects, such as reporting parse errors with <code>Either String [Token]</code>, then you may find it unwieldy. At that point, I would recommend looking into how monadic parsing libraries work.</p>\n"}], "owner": {"reputation": 25, "user_id": 6176148, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-7jQJvlbIrxQ/AAAAAAAAAAI/AAAAAAAAALk/Dr8zUZBnu7I/photo.jpg?sz=128", "display_name": "Louis Hu", "link": "https://stackoverflow.com/users/6176148/louis-hu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 739, "favorite_count": 0, "accepted_answer_id": 43849528, "answer_count": 2, "score": 0, "last_activity_date": 1494463008, "creation_date": 1494093619, "last_edit_date": 1494095580, "question_id": 43823721, "link": "https://stackoverflow.com/questions/43823721/tokenize-a-string-into-a-list-of-strings-dependent-on-set-of-rules", "title": "Tokenize a string into a list of strings, dependent on set of rules", "body": "<p>I have a string that needs to be tokenized into a list with the following rules:</p>\n\n<ul>\n<li>The '(' and ')' brackets</li>\n<li>A number with a possible decimal point</li>\n<li>Operators (+, / , *, >=, etc.)</li>\n<li>An identifier that starts with a letter and rest of the string can be letters or numbers</li>\n</ul>\n\n<p>To do this I have created the above rules as finite state machines in Haskell code:</p>\n\n<pre><code>data FsaState = R | Q -- start state: Q; success state R;\n  deriving Show\n</code></pre>\n\n<p>Input:</p>\n\n<pre><code>tokenize \u201c( (23.5+age) \u2217 (20.99+adres))\u201d\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[ \u201c(\u201d, \u201c \u201d, \u201c(\u201d, \u201c23.5\u201d, \u201c+\u201d, \u201cage\u201d, \u201c)\u201d, \u201c \u201d, \u201c\u2217\u201d, \u201c \u201d, \u201c(\u201d, \u201c20.99\u201d, \u201c+\u201d, \u201cadres\u201d, \u201c)\u201d, \u201c)\u201d ]\n</code></pre>\n\n<p>(maybe filter out the strings with only whitespace)</p>\n\n<p>How should I begin? I am stuck in the imperative mindset as Haskell is not my main language.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 148712, "user_id": 19750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b41b2620da0b1e630715e0c91a0b03?s=128&d=identicon&r=PG", "display_name": "Josh Lee", "link": "https://stackoverflow.com/users/19750/josh-lee"}, "edited": false, "score": 1, "creation_date": 1494083508, "post_id": 43822016, "comment_id": 74682325, "body": "How would the recursive solution look? How would the list comprehension be different?"}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "reply_to_user": {"reputation": 148712, "user_id": 19750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b41b2620da0b1e630715e0c91a0b03?s=128&d=identicon&r=PG", "display_name": "Josh Lee", "link": "https://stackoverflow.com/users/19750/josh-lee"}, "edited": false, "score": 0, "creation_date": 1494083676, "post_id": 43822016, "comment_id": 74682398, "body": "@Josh Lee I would make a function that search all the vowels in a string, something like: charfound::Char-&gt;String-&gt;Bool   charFound c(x:xs)  | c==x=True |otherwise=charFoundc XS"}, {"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "reply_to_user": {"reputation": 148712, "user_id": 19750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b41b2620da0b1e630715e0c91a0b03?s=128&d=identicon&r=PG", "display_name": "Josh Lee", "link": "https://stackoverflow.com/users/19750/josh-lee"}, "edited": false, "score": 0, "creation_date": 1494083841, "post_id": 43822016, "comment_id": 74682461, "body": "@ Josh Lee  But I&#39;m not an Haskell expert..I&#39;ve just started to learn. Can you please help me?"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494084297, "post_id": 43822119, "comment_id": 74682633, "body": "Thank you but I don&#39;t understand what this does :"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494084500, "post_id": 43822119, "comment_id": 74682711, "body": "@Madalina Added and explanation"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494084513, "post_id": 43822119, "comment_id": 74682717, "body": "@Madalina Try to literally read the code (and I don&#39;t mean that in a rude way). Reading it plainly from left to right, it says &quot;all e&#39;s are not elements of a list of vowels&quot;."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1494084686, "post_id": 43822119, "comment_id": 74682772, "body": "@Carcigenicate It seems to me an equivalent formulation, though, no? If there are no lowercase vowels, then, by definition, all vowels are uppercase (including the case that this is  trivially true, since there are none)."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1494084729, "post_id": 43822119, "comment_id": 74682783, "body": "@AmiTavory Nvm, I think you&#39;re right. Sorry, tired :/"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "edited": false, "score": 0, "creation_date": 1494084904, "post_id": 43822119, "comment_id": 74682829, "body": "@Madalina He&#39;s right, this would do what you want. If there aren&#39;t any lowercase vowels in the string, all the vowels must be uppercase. I didn&#39;t think it through thoroughly when I posted my other comment."}, {"owner": {"reputation": 15119, "user_id": 8182118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d321a0bcd7b3d7831b54d1d9b5b70f60?s=128&d=identicon&r=PG", "display_name": "Masklinn", "link": "https://stackoverflow.com/users/8182118/masklinn"}, "edited": false, "score": 1, "creation_date": 1580197226, "post_id": 43822119, "comment_id": 106008395, "body": "@AmiTavory the snippet is only half-pointfree, since it has <code>e</code>. The pointfree version would be some line noise along the lines of <code>check = all $ flip notElem &quot;aeiou&quot;</code>."}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": false, "score": 4, "last_activity_date": 1494084628, "last_edit_date": 1494084628, "creation_date": 1494084102, "answer_id": 43822119, "question_id": 43822016, "link": "https://stackoverflow.com/questions/43822016/function-that-checks-if-all-vowels-in-a-string-are-capital-letters/43822119#43822119", "title": "Function that checks if all vowels in a string are capital letters", "body": "<p>You can use <a href=\"http://zvon.org/other/haskell/Outputprelude/notElem_f.html\" rel=\"nofollow noreferrer\"><code>notElem</code></a>, and <a href=\"http://zvon.org/other/haskell/Outputprelude/all_f.html\" rel=\"nofollow noreferrer\"><code>all</code></a>, like this:</p>\n\n<pre><code>check :: String -&gt; Bool\ncheck = all (\\e -&gt; e `notElem` ['a', 'e', 'i', 'o', 'u'])     \n</code></pre>\n\n<p>Here is an explanation:</p>\n\n<ul>\n<li><p><code>(\\e -&gt; e notElem ['a', 'e', 'i', 'o', 'u'])</code> is a function that takes <code>e</code>, and returns whether it is not an element of the lowercase vowels.</p></li>\n<li><p><code>all</code> takes a. a predicate that transforms elements to booleans, and b. an array of these elements, and returns whether the predicate is true for all elements of the array.          </p></li>\n</ul>\n\n<p>Another thing that might help is to note that this is written using <a href=\"https://wiki.haskell.org/Pointfree\" rel=\"nofollow noreferrer\">point-free notation</a>, but it is equivalent to</p>\n\n<pre><code>check s = all (\\e -&gt; e `notElem` ['a', 'e', 'i', 'o', 'u']) s\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6006621, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/b25c69b44e45f14a3619c6ad0c668b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/6006621/madalina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1580193264, "creation_date": 1494083425, "last_edit_date": 1580193264, "question_id": 43822016, "link": "https://stackoverflow.com/questions/43822016/function-that-checks-if-all-vowels-in-a-string-are-capital-letters", "title": "Function that checks if all vowels in a string are capital letters", "body": "<pre><code>Check::String-&gt;Bool\nCheck = undefined\n</code></pre>\n\n<p>I can use only list comprehension and I can use only Base Functions and Library functions. I know how to do it recursively only, like this:</p>\n\n<pre><code>charfound::Char-&gt;String-&gt;Bool\ncharFound c(x:xs) | c==x=True\n                  |otherwise=charFoundc XS\n</code></pre>\n"}, {"tags": ["haskell", "functional-dependencies", "type-families"], "comments": [{"owner": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "edited": false, "score": 0, "creation_date": 1494131403, "post_id": 43821747, "comment_id": 74693169, "body": "Here is a very relevant related post: <a href=\"http://stackoverflow.com/questions/34645745/can-i-magic-up-type-equality-from-a-functional-dependency\" title=\"can i magic up type equality from a functional dependency\">stackoverflow.com/questions/34645745/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "edited": false, "score": 0, "creation_date": 1494088639, "post_id": 43822757, "comment_id": 74684023, "body": "But is it possible to create the instances for <code>C&#39;</code> given instances for <code>C</code> (from an external library), without manually having to enumerate them?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "edited": false, "score": 0, "creation_date": 1494088985, "post_id": 43822757, "comment_id": 74684143, "body": "Why do you want to do that? Can&#39;t you just write functions with a <code>C</code> constraint?"}, {"owner": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "edited": false, "score": 0, "creation_date": 1494089664, "post_id": 43822757, "comment_id": 74684357, "body": "One part because it should be possible, the functional dependency contains all the information needed for the type family. As far as I know they are equivalent, so it should be possible to convert between them. The other part is that I&#39;m doing some strange wrestling with the type checker and believe that getting a <code>*</code> kind instead of a constraint (<code>forall a. A a b =&gt; a</code> vs <code>A&#39; a</code>) will show the compiler that I&#39;m not actually giving it a polymorphic value."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "edited": false, "score": 0, "creation_date": 1494089778, "post_id": 43822757, "comment_id": 74684400, "body": "@Hjulle Sounds like an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a> and probably warrants a separate question. In practice you can probably use a <code>newtype</code>, such as <code>newtype Wrapped a b = Wrapped { unWrap :: a }</code>, but the form that would take probably depends on what the class does exactly."}, {"owner": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "edited": false, "score": 0, "creation_date": 1494090087, "post_id": 43822757, "comment_id": 74684505, "body": "I still want an answer to this question. As I said, one part is because I believe that it should be possible and wonder if it is. Is this the wrong forum for such questions?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "edited": false, "score": 1, "creation_date": 1494090899, "post_id": 43822757, "comment_id": 74684770, "body": "@Hjulle It is possible but you have to use a newtype, as I said. See my edited answer"}, {"owner": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "edited": false, "score": 0, "creation_date": 1494090907, "post_id": 43822757, "comment_id": 74684775, "body": "Btw, overlapping instances should not be a problem, since I&#39;m defining the class myself and I am not planning to add any other instances than that one."}, {"owner": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1494091831, "post_id": 43822757, "comment_id": 74685061, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/143576/discussion-between-hjulle-and-benjamin-hodgson\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "edited": false, "score": 0, "creation_date": 1494131953, "post_id": 43822757, "comment_id": 74693255, "body": "Now that I think of it, wouldn&#39;t the wrapped instance <code>instance C a b =&gt; C&#39; (Wrap a b) where B (Wrap a b) = b</code> correspond to <code>class C a b | a b -&gt; b</code> (which is equivalent to <code>class C a b</code>) rather than <code>class C a b | a -&gt; b</code>? You can&#39;t recover the fundep instance from a wrapped instance of <code>C&#39;</code>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "edited": false, "score": 1, "creation_date": 1494156027, "post_id": 43822757, "comment_id": 74698792, "body": "@Hjulle I don&#39;t quite follow you. <code>Wrap</code> packages an instance of <code>C</code> into an instance of <code>C&#39;</code>. You don&#39;t need to do any work to go back the other way because there&#39;s already an instance of <code>C a b</code>. The fundep ensures that there can only be one instance of <code>C&#39;</code> for <code>Wrap</code> for a given <code>a</code>, namely <code>Wrap a b</code>."}, {"owner": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "edited": false, "score": 0, "creation_date": 1494161841, "post_id": 43822757, "comment_id": 74700383, "body": "Aha, yes of course. I was thinking that it was the associated class that should enforce the dependency, but since we know that we have the FunDep class, the dependency is enforced that way."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 3, "last_activity_date": 1494091293, "last_edit_date": 1495540957, "creation_date": 1494087804, "answer_id": 43822757, "question_id": 43821747, "link": "https://stackoverflow.com/questions/43821747/converting-functional-dependency-class-to-type-family-instances/43822757#43822757", "title": "Converting Functional Dependency class to Type Family instances", "body": "<p>Don't overthink it.</p>\n\n<pre><code>class C a b | a -&gt; b\ninstance C T U\n</code></pre>\n\n<p>roughly translates into</p>\n\n<pre><code>class C' a where\n    type B a\ninstance C' T where\n    type B T = U\n</code></pre>\n\n<p>They're semantically somewhat different, even though they behave in a similar way. <code>C</code> is a two-parameter class, but its second parameter is uniquely determined by its first. <code>C'</code> is a one-parameter class with an associated type. Associated types are interpreted as top-level axioms for FC's coercion system whereas fundeps basically just affect unification.</p>\n\n<p>It is possible to convert between the two styles, but you have to use a <code>newtype</code> to bind the variables in the <code>type</code> equation.</p>\n\n<pre><code>newtype WrappedB a = WrappedB { unwrapB :: B a }\ninstance C' a =&gt; C a (WrappedB a)  -- you can't use a type synonym family in an instance\n\nnewtype Wrap a b = Wrap { unWrap :: a }\ninstance C a b =&gt; C' (Wrap a b) where\n    type B (Wrap a b) = b  -- b needs to be bound on the LHS of this equation\n</code></pre>\n\n<p>In general I <a href=\"https://stackoverflow.com/a/43720240/1523776\">don't advise</a> writing the sort of generic instance you've attempted in your question, because such instances have a tendency to be overlapping.</p>\n\n<p>Functional dependencies are <a href=\"https://typesandkinds.wordpress.com/2015/09/09/what-are-type-families/\" rel=\"nofollow noreferrer\">less, um, weird</a> than type families, though. All other things being equal I tend to prefer a fundep.</p>\n"}], "owner": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 2, "accepted_answer_id": 43822757, "answer_count": 1, "score": 4, "last_activity_date": 1494091293, "creation_date": 1494081718, "last_edit_date": 1494088919, "question_id": 43821747, "link": "https://stackoverflow.com/questions/43821747/converting-functional-dependency-class-to-type-family-instances", "title": "Converting Functional Dependency class to Type Family instances", "body": "<p>Is it possible to create type family instances from a fundep class? For example, let's say that I have the class</p>\n\n<pre><code>class A a b | a -&gt; b\n</code></pre>\n\n<p>with some instances (imported an external library) and want to create all corresponding instances for the type family</p>\n\n<pre><code>type family A' a :: *\n</code></pre>\n\n<p>such that <code>A' a ~ b</code> iff <code>A a b</code>, without having to manually copy and modify the instances from the external source.</p>\n\n<p>How would I do that (if it is possible)?</p>\n\n<hr>\n\n<p>My most promising attempt so far, </p>\n\n<pre><code>class A' a where\n    type A'_b a :: *\n\ninstance forall a b. A a b =&gt; A' a where\n    type A'_b a = b\n</code></pre>\n\n<p>gives the error message</p>\n\n<pre><code>    The RHS of an associated type declaration mentions \u2018b\u2019\n      All such variables must be bound on the LHS\n</code></pre>\n\n<p>So, my guess is that the answer is no? :/</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494072019, "post_id": 43819927, "comment_id": 74678763, "body": "The complexity of <i>O(n)</i>?? <i>O(n)</i> is a complexity class."}, {"owner": {"reputation": 1, "user_id": 7900854, "user_type": "registered", "profile_image": "https://graph.facebook.com/1893746254170638/picture?type=large", "display_name": "Ada", "link": "https://stackoverflow.com/users/7900854/ada"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1494072247, "post_id": 43819927, "comment_id": 74678818, "body": "the function O(n) time complexity"}, {"owner": {"reputation": 936, "user_id": 4884579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0fca1fac3b94fed8f0291116e9b4ef6?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4884579/erik"}, "edited": false, "score": 0, "creation_date": 1494072780, "post_id": 43819927, "comment_id": 74678974, "body": "The comparison is a constant time operation done <code>n</code> times (because of your use of <code>map</code>), so the <code>ask</code> function runs in O(n) (aka linear time)."}, {"owner": {"reputation": 1, "user_id": 7900854, "user_type": "registered", "profile_image": "https://graph.facebook.com/1893746254170638/picture?type=large", "display_name": "Ada", "link": "https://stackoverflow.com/users/7900854/ada"}, "edited": false, "score": 0, "creation_date": 1494072838, "post_id": 43819927, "comment_id": 74678998, "body": "Yea,but how could I get  it? I am the beginner,I did not konw how to get the complexity.If I have O(n),O(n2)and O(n5)."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1494072927, "post_id": 43819927, "comment_id": 74679024, "body": "what do you mean by &quot;code for it&quot;?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1494072998, "post_id": 43819927, "comment_id": 74679045, "body": "btw: are you sure you want <code>map</code>? seems like a job for <code>filter</code> (does not change the complexity though)"}, {"owner": {"reputation": 1, "user_id": 7900854, "user_type": "registered", "profile_image": "https://graph.facebook.com/1893746254170638/picture?type=large", "display_name": "Ada", "link": "https://stackoverflow.com/users/7900854/ada"}, "edited": false, "score": 0, "creation_date": 1494073033, "post_id": 43819927, "comment_id": 74679058, "body": "To write the code in Haskell to get the result and the graph"}, {"owner": {"reputation": 1, "user_id": 7900854, "user_type": "registered", "profile_image": "https://graph.facebook.com/1893746254170638/picture?type=large", "display_name": "Ada", "link": "https://stackoverflow.com/users/7900854/ada"}, "edited": false, "score": 0, "creation_date": 1494073066, "post_id": 43819927, "comment_id": 74679073, "body": "Yea it&#39;s filter"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1494073089, "post_id": 43819927, "comment_id": 74679080, "body": "you can see it like this: <code>map</code>  will look at every element in the list - if the <i>looking</i> takes constant time <code>c</code> and you have <code>n</code> elements you get <code>n*c</code> time - and since you usually want complexity as a function of the length of the list you have <code>O(n)</code> here (just look up the definition - it&#39;s trivial in this case)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1494073156, "post_id": 43819927, "comment_id": 74679097, "body": "oh - you want some kind of experiment? For small lists like this you cannot really measure runtime in a meaningful way"}, {"owner": {"reputation": 1, "user_id": 7900854, "user_type": "registered", "profile_image": "https://graph.facebook.com/1893746254170638/picture?type=large", "display_name": "Ada", "link": "https://stackoverflow.com/users/7900854/ada"}, "edited": false, "score": 0, "creation_date": 1494073352, "post_id": 43819927, "comment_id": 74679158, "body": "Yea,but if I only want to get the result by the length of list 2,5,10.O(n) is same like 2,5,10?And If I do trans2 db = concat (map (&#40;x,y,z) -&gt; concat (map(&#40;x&#39;,y&#39;,z&#39;) -&gt; if (z==x&#39;) then [] else [(x,y ++ &quot;.&quot; ++ y&#39;,z&#39;)] else []) db)) db )    How can I calculate the O(n)?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7900854, "user_type": "registered", "profile_image": "https://graph.facebook.com/1893746254170638/picture?type=large", "display_name": "Ada", "link": "https://stackoverflow.com/users/7900854/ada"}, "edited": false, "score": 0, "creation_date": 1494085097, "post_id": 43822223, "comment_id": 74682898, "body": "It&#39;s means that if there are 5 sublists in db,the complexity is 5? However, if I take the other operation such as inverse the list and combine with the others ,how can I calculate the complexity?TKS."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 1, "user_id": 7900854, "user_type": "registered", "profile_image": "https://graph.facebook.com/1893746254170638/picture?type=large", "display_name": "Ada", "link": "https://stackoverflow.com/users/7900854/ada"}, "edited": false, "score": 0, "creation_date": 1494085279, "post_id": 43822223, "comment_id": 74682964, "body": "No, because <code>5</code> is not a complexity class.  You keep trying to reduce the answer to a single number, which is itself a misunderstanding."}, {"owner": {"reputation": 1, "user_id": 7900854, "user_type": "registered", "profile_image": "https://graph.facebook.com/1893746254170638/picture?type=large", "display_name": "Ada", "link": "https://stackoverflow.com/users/7900854/ada"}, "edited": false, "score": 0, "creation_date": 1494085789, "post_id": 43822223, "comment_id": 74683131, "body": "It means that the time complexity is depend on the length of list."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 1, "last_activity_date": 1494084703, "creation_date": 1494084703, "answer_id": 43822223, "question_id": 43819927, "link": "https://stackoverflow.com/questions/43819927/how-to-find-time-complexity-of-this-program/43822223#43822223", "title": "How to find time complexity of this program?", "body": "<p>The question is unclear and I expect it will soon be closed.  Briefly.</p>\n\n<p>O(n) <em>is</em> a complexity.  If you know O(n) and you wanted complexity then you're done.</p>\n\n<p>The length of the list (2, 5, 10, what have you) is not a factor in the complexity in this case since the length is what the <code>n</code> is representing.</p>\n\n<p>There is no code that will calculate the complexity of the algorithm automatically.  It is a manual analysis.</p>\n"}], "owner": {"reputation": 1, "user_id": 7900854, "user_type": "registered", "profile_image": "https://graph.facebook.com/1893746254170638/picture?type=large", "display_name": "Ada", "link": "https://stackoverflow.com/users/7900854/ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 1, "closed_date": 1494095944, "answer_count": 1, "score": -2, "last_activity_date": 1494158591, "creation_date": 1494070190, "last_edit_date": 1494158591, "question_id": 43819927, "link": "https://stackoverflow.com/questions/43819927/how-to-find-time-complexity-of-this-program", "closed_reason": "Needs details or clarity", "title": "How to find time complexity of this program?", "body": "<p>I have a data list.</p>\n\n<pre><code>db = [(\"Ada\",\"works\", \"IBM\")\n  ,(\"Alice\",\"director\", \"Ada\")\n  ,(\"Tom\",\"works\", \"IBM\")\n  ,(\"Tommy\",\"director\", \"Tom\")\n ,(\"IBM\",\"isat\",     \"CA\")\n ,(\"CA\",\"in\",       \"USA\")\n ]\nask db = map (\\(x,y,z) -&gt; (z == \"IBM\")) db \n</code></pre>\n\n<p>How to calculate the complexity of O(n)\uff1f\nIf I want to get the result by the length of list 2,5,10.O(n) is same like 2,5,10?And If I do </p>\n\n<pre><code>trans2 db = concat (map ((x,y,z) -&gt; concat (map((x',y',z') -&gt; if (z==x') then [] else [(x,y ++ \".\" ++ y',z')] else []) db)) db ) \n</code></pre>\n\n<p>How can I calculate the O(n)? The runtime of program? The timming complexity</p>\n"}, {"tags": ["function", "haskell", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "is_accepted": false, "score": 4, "last_activity_date": 1494066413, "creation_date": 1494066413, "answer_id": 43819315, "question_id": 43819233, "link": "https://stackoverflow.com/questions/43819233/what-is-wrong-with-this-haskell-list-code/43819315#43819315", "title": "What is wrong with this Haskell list code?", "body": "<p>The expression</p>\n\n<pre><code>[\"xx\"] ++ x : replaceElement xs\n</code></pre>\n\n<p>is actually parsed as</p>\n\n<pre><code>[\"xx\"] ++ (x : replaceElement xs)\n</code></pre>\n\n<p>which does just what you described: inserts <code>\"xx\"</code> into the resulting list. What you want to do instead, is:</p>\n\n<pre><code>(\"xx\" ++ x) : replaceElement xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1494066734, "last_edit_date": 1494066734, "creation_date": 1494066424, "answer_id": 43819318, "question_id": 43819233, "link": "https://stackoverflow.com/questions/43819233/what-is-wrong-with-this-haskell-list-code/43819318#43819318", "title": "What is wrong with this Haskell list code?", "body": "<p>The crucial thing is how <code>[\"xx\"] ++ x : replaceElement xs</code> is parsed. This is determined by the <em>fixities</em> of the operators:</p>\n\n<pre><code>GHCi, version 7.10.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :info :\n-- ...\ninfixr 5 :\nPrelude&gt; :i ++\n(++) :: [a] -&gt; [a] -&gt; [a]   -- Defined in \u2018GHC.Base\u2019\ninfixr 5 ++\n</code></pre>\n\n<p>So, both <code>:</code> and <code>++</code> are <em>right-associative</em> operators, with the same precedence. Right-associative means, <code>a : b : c</code> is parsed as <code>a : (b : c)</code>, instead of <code>(a : b) : c</code> (as would be the case for left-associative <code>infixl</code>). Due to the equal precedence, this still holds if you mix <code>:</code> and <code>++</code>, i.s.</p>\n\n<pre><code>[\"xx\"] ++ x : replaceElement xs  \u2261  [\"xx\"] ++ (x : replaceElement xs)\n</code></pre>\n\n<p>IOW, you're just prepending <code>[\"xx\"]</code> to the whole result, but the individual elements never get in contact with <code>\"xx\"</code>. To achieve that, you need to group <code>\"xx\"</code> with <code>x</code>. The extra brackets are unnecessary then (in fact these could have tipped you off: wrapping <code>\"xs\"</code> in an extra layer means you're not working of the string-level anymore as intended, but on the list-of-string level).</p>\n\n<hr>\n\n<p>A better alternative would of course be to not do any manual recursion: you're simply applying the same operation to all elements of a list; that's what <code>map</code> is there for:</p>\n\n<pre><code>replaceElement = map $ \\x -&gt; if '!'`elem`x\n                              then \"xx\"++x\n                              else x\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1494079712, "creation_date": 1494079712, "answer_id": 43821416, "question_id": 43819233, "link": "https://stackoverflow.com/questions/43819233/what-is-wrong-with-this-haskell-list-code/43821416#43821416", "title": "What is wrong with this Haskell list code?", "body": "<p>You may also use <code>map</code> with a helper function like;</p>\n\n<pre><code>addxx :: [String] -&gt; [String]\naddxx = map checkBang\n        where checkBang s | last s == '!' = \"xx\" ++ s\n                          | otherwise     = s\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 7137698, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/73a2bcd04ae13a5ea09112f4bbc6cd4c?s=128&d=identicon&r=PG&f=1", "display_name": "Anil ", "link": "https://stackoverflow.com/users/7137698/anil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1494079712, "creation_date": 1494065907, "question_id": 43819233, "link": "https://stackoverflow.com/questions/43819233/what-is-wrong-with-this-haskell-list-code", "title": "What is wrong with this Haskell list code?", "body": "<p>Here is an example of what I wanted to do.</p>\n\n<pre><code>let b = [\"this\",\"is\",\"a\",\"test!\"]\n\n\"xx\" ++ (b!!3)\n</code></pre>\n\n<p>This will give me \"xxtest!\"</p>\n\n<p>Basically if the list contains any string with an exclamation mark then \"xx\" will be added to this specific string. My questions is how to implement this into a correct function.</p>\n\n<p>Currently I got this</p>\n\n<pre><code>replaceElement [] = []\nreplaceElement (x:xs) =\n      if '!' `elem` x\n      then [\"xx\"] ++ x : replaceElement xs\n      else x: replaceElement xs\n</code></pre>\n\n<p>But this function will just add \"xx\" into list as an element, it won't be added to the specific string in the list. How can I use \"xx\" ++ (b!!x) where x is the position of the string with an exclamation mark.</p>\n"}, {"tags": ["haskell", "io", "ncurses"], "answers": [{"comments": [{"owner": {"reputation": 543, "user_id": 561236, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/66cc743f31a1717d366644441deacd0e?s=128&d=identicon&r=PG", "display_name": "liminal18", "link": "https://stackoverflow.com/users/561236/liminal18"}, "edited": false, "score": 0, "creation_date": 1494064307, "post_id": 43819007, "comment_id": 74676582, "body": "hey thaks I will give that a shot. not sure if I can do IO [TerrianType] becasue the IO comes from the random Int but will try"}, {"owner": {"reputation": 543, "user_id": 561236, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/66cc743f31a1717d366644441deacd0e?s=128&d=identicon&r=PG", "display_name": "liminal18", "link": "https://stackoverflow.com/users/561236/liminal18"}, "edited": false, "score": 0, "creation_date": 1494064461, "post_id": 43819007, "comment_id": 74676632, "body": "Yeah: Couldn&#39;t match expected type \u2018IO Terrian\u2019                   with actual type \u2018[IO TerrianType]\u2019     \u2022 In the expression: take (n1 * n2) $ repeat getRandomTerrian"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 543, "user_id": 561236, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/66cc743f31a1717d366644441deacd0e?s=128&d=identicon&r=PG", "display_name": "liminal18", "link": "https://stackoverflow.com/users/561236/liminal18"}, "edited": false, "score": 1, "creation_date": 1494071610, "post_id": 43819007, "comment_id": 74678635, "body": "@liminal18 Note that we have <code>sequence :: [IO a] -&gt; IO [a]</code> which can convert one into the other. Probably there are better ways to do it, but this is a basic way, at least."}, {"owner": {"reputation": 543, "user_id": 561236, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/66cc743f31a1717d366644441deacd0e?s=128&d=identicon&r=PG", "display_name": "liminal18", "link": "https://stackoverflow.com/users/561236/liminal18"}, "edited": false, "score": 0, "creation_date": 1494071692, "post_id": 43819007, "comment_id": 74678666, "body": "Yeah I ended up using replicateM on the random function to compile a list of int then constructing my TerrainType list. Is working thanks"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1494064223, "creation_date": 1494064223, "answer_id": 43819007, "question_id": 43818836, "link": "https://stackoverflow.com/questions/43818836/using-io-with-ncurses/43819007#43819007", "title": "Using IO with Ncurses", "body": "<p>I think you are confusing <code>[IO TerrianType]</code> and <code>IO [TerrianType]</code>.</p>\n\n<p>In your code you produce a <code>[IO TerrianType]</code>, which is a list of IO actions. When you <code>mapM</code> over that, you have to <em>run</em> the actions if you want to access their <code>TerrianType</code> and print it.</p>\n\n<p>So, you probably need something like</p>\n\n<pre><code>drawShow :: (IO TerrianType) -&gt; IO ()\ndrawShow a = a &gt;&gt;= drawString . show\n</code></pre>\n\n<p>However, I do wonder if <code>[IO TerrianType]</code> is the right thing to begin with. Instead of using</p>\n\n<pre><code>constructTerrian :: Int -&gt; Int -&gt; [IO TerrianType]\n</code></pre>\n\n<p>as you are doing now, you probably should move to</p>\n\n<pre><code>constructTerrian :: Int -&gt; Int -&gt; IO [TerrianType]\n</code></pre>\n\n<p>and change the code accordingly. The first code does not compute the random values, but only returns a list of IO actions which will roll the random values. Maybe you instead want to roll them now, and produce a list of values, as the second type implies.</p>\n"}], "owner": {"reputation": 543, "user_id": 561236, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/66cc743f31a1717d366644441deacd0e?s=128&d=identicon&r=PG", "display_name": "liminal18", "link": "https://stackoverflow.com/users/561236/liminal18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 43819007, "answer_count": 1, "score": 0, "last_activity_date": 1494095759, "creation_date": 1494062878, "last_edit_date": 1494095759, "question_id": 43818836, "link": "https://stackoverflow.com/questions/43818836/using-io-with-ncurses", "title": "Using IO with Ncurses", "body": "<p>I am trying to use UI.NCurses</p>\n\n<p><a href=\"https://john-millikin.com/software/haskell-ncurses/reference/haskell-ncurses/latest/\" rel=\"nofollow noreferrer\">https://john-millikin.com/software/haskell-ncurses/reference/haskell-ncurses/latest/</a></p>\n\n<p>for some simple path finding lessons\nThe issue is I have a random Int which of course returns an IO Int\nwhich then means I have an IO TerrianType which then leads to an array of IO TerrianType</p>\n\n<p>the issue is I need to resolve these in main so they can be printed to the screen using drawString. I am including the code below:</p>\n\n<pre><code>module Main where\n  2   import UI.NCurses\n  3   import Control.Monad\n  4   import Control.Monad.IO.Class\n  5   import System.Random\n  6 \n  7   -- Tutorials\n  8   -- working on several path findng algorithims\n  9   -- http://www.redblobgames.com/pathfinding/a-star/introduction.html\n 10 \n 11   -- | The 'Compass' data type provides breadcrumbs from the goal to the start. \n 12   data Compass = N | S | E | W deriving (Show, Eq)\n 13 \n 14   -- | 'Cartogram' is a structure of compass directions that mirrors the terrian.\n 15   type Cartogram = [Compass]\n 16 \n 17   -- | 'TerrianType' determines how hard a cell is to traverse.\n 18   data TerrianType = Sand | Forest | Goal deriving (Show, Eq)\n 19 \n 20   -- | 'Terrian' is a collection of TerrianTypes with a single goal.\n 21   type Terrian = [IO TerrianType]\n 22 \n 23   -- | 'roll' gets a random int from 1 to the parameter\n 24   roll :: Int -&gt; IO Int\n 25   roll m\n 26     | m &lt;= 0 = getStdRandom (randomR (1,1))\n 27     | m &gt; 0 = getStdRandom (randomR (1,m)) \n 28 \n 29   -- | 'getRandomTerrian' gets a random TerrianType \n 30   getRandomTerrian :: IO TerrianType\n 31   getRandomTerrian = do\n 32     r &lt;- roll 3\n 33     case r of\n 34       1 -&gt; return Forest\n 35       2 -&gt; return Sand\n 36       3 -&gt; return Goal\n 37       _ -&gt; return Sand\n 38 \n 39   -- | 'constructTerrian' constructs a Terrian array of random TerrianTypes\n 40   constructTerrian :: Int -&gt; Int -&gt; Terrian\n 41   constructTerrian n1 n2 = take (n1 * n2) $ repeat getRandomTerrian\n 42 \n 43   drawShow a = (drawString . show) a\n 44  \n 45   --showString :: t -&gt; String\n 46   --showString t = show t\n 47 \n 48   main :: IO ()\n 49   main = do\n 50     runCurses $ do\n 51       setEcho False\n 52       w &lt;- defaultWindow\n 53       updateWindow w $ do\n 54         moveCursor 1 1\n 55         mapM drawShow (constructTerrian 5 5)\n 56       render\n 57       waitFor w (\\ev -&gt; ev == EventCharacter 'q' || ev == EventCharacter 'Q')58 \n 59   waitFor :: Window -&gt; (Event -&gt; Bool) -&gt; Curses ()\n 60   waitFor w p = loop where\n 61     loop = do\n 62       ev &lt;- getEvent w Nothing\n 63       case ev of\n 64         Nothing -&gt; loop\n 65         Just ev' -&gt; if p ev' then return () else loop\n\n \u2022 No instance for (Show (IO TerrianType))\n        arising from a use of \u2018drawShow\u2019\n \u2022 In the first argument of \u2018mapM\u2019, namely \u2018drawShow\u2019\n      In a stmt of a 'do' block: mapM drawShow (constructTerrian 5 5)\n      In the second argument of \u2018($)\u2019, namely\n        \u2018do { moveCursor 1 1;\n              mapM drawShow (constructTerrian 5 5) }\u2019\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494218701, "post_id": 43818701, "comment_id": 74715841, "body": "I cannot reproduce case #1: <code>stack build</code> on your project rebuilds <i>b</i> after any change, regardless of whether the version number has changed. As far as my understanding goes, this is expected behaviour: if you list a local directory as a package location, <i>stack</i> will treat it as part of the project proper, and not as a pinned dependency -- note that there is no version number or commit hash pinning <i>a</i> in <i>b</i>&#39;s stack.yaml. (By the way, I suggest you add both stack.yaml files to your question, in order to make the relationship between the packages easier to grasp.)"}, {"owner": {"reputation": 1479, "user_id": 855443, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d880e98c9fffc6253f3868babc99b8c1?s=128&d=identicon&r=PG", "display_name": "user855443", "link": "https://stackoverflow.com/users/855443/user855443"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494233437, "post_id": 43818701, "comment_id": 74722650, "body": "strange - i just checked: <code>stack build</code> in a, <code>stack build</code> in b - both compile. Change in <code>thirdFunction</code> the argument type to <code>String</code>, <code>stack build</code> in a goes ok. <code>stack build</code> in b should fail (wrong type) but succeeds. What is different to your procedure?"}, {"owner": {"reputation": 1479, "user_id": 855443, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d880e98c9fffc6253f3868babc99b8c1?s=128&d=identicon&r=PG", "display_name": "user855443", "link": "https://stackoverflow.com/users/855443/user855443"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494245107, "post_id": 43818701, "comment_id": 74730095, "body": "I tried again with a fresh clone. it worked as @duplode describes once. For the next  changes in a, b compiles when a is changed and it should fail. when running b, it produces the result as expected from the previous state of a. What could be the cause? Where to look further?"}, {"owner": {"reputation": 1479, "user_id": 855443, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d880e98c9fffc6253f3868babc99b8c1?s=128&d=identicon&r=PG", "display_name": "user855443", "link": "https://stackoverflow.com/users/855443/user855443"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494263643, "post_id": 43818701, "comment_id": 74742718, "body": "I did (on a different computer): clone repository. open two terminals for a and b, <code>stack build</code> in each; everything ok. edit <code>LibA.hs</code>, add a function <code>secondFunc</code> wtih no argument. <code>stack build</code> in terminal a. then call function <code>secondFunc</code> in <code>Main.hs</code> in <code>b&#47;app</code>. save and <code>stack build</code> in b. Error is <code>variable not in scope</code> (and a was not accessed). Then bumb the version of a.cabal and do <code>stack build</code> again. No error, a is mentioned during the stack build of b (this demonstrates that no ordinary error in code exists).  is this only on my computers (all of them so) and not reproducable?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494282993, "post_id": 43818701, "comment_id": 74752261, "body": "[1/2] (1) There was one difference in the steps I followed: I didn&#39;t use <code>stack build</code> in the <code>a</code> directory, only in <code>b</code> (which triggers a rebuild of <i>a</i> if necessary). Doing <code>stack build</code> in <code>a</code> beforehand seems to lead to the unexpected usage of the old version that you describe. That doesn&#39;t seem right -- I wonder if there are bug reports related to that. (2) Fortunately, I believe there is an easy workaround: always work from the <code>b</code> directory and, if you want to build/test/etc. only the <i>a</i> package, specify that when calling <i>stack</i> with, for instance, <code>stack build a</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494283006, "post_id": 43818701, "comment_id": 74752264, "body": "[2/2] (3) As for the version numbers, it really shouldn&#39;t be necessary to bump version numbers on every change (it would be terribly impractical and inconvenient). I suggest abandoning that part of your question, in particular because it can affect the other results we are trying to see."}], "answers": [{"tags": [], "owner": {"reputation": 1479, "user_id": 855443, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d880e98c9fffc6253f3868babc99b8c1?s=128&d=identicon&r=PG", "display_name": "user855443", "link": "https://stackoverflow.com/users/855443/user855443"}, "is_accepted": false, "score": 0, "last_activity_date": 1494314775, "creation_date": 1494314775, "answer_id": 43863691, "question_id": 43818701, "link": "https://stackoverflow.com/questions/43818701/how-to-force-stack-to-use-newer-version-of-local-package/43863691#43863691", "title": "how to force stack to use newer version of local package", "body": "<p>It seems to be a bug and I reported it. \nThe workaround is, as described by @duplode, to do <code>stack build</code> only in one project or to use the <code>--force-dirty</code> flag when <code>stack-build</code>.</p>\n\n<p>The problem is seemingly caused by behavior of cabal, which reuses an ID even when the content of a package has changed. A fix was included in stack 1.4.0. (see stack issues #2904 #3047), but it appears this was not effective in all cases.</p>\n"}], "owner": {"reputation": 1479, "user_id": 855443, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d880e98c9fffc6253f3868babc99b8c1?s=128&d=identicon&r=PG", "display_name": "user855443", "link": "https://stackoverflow.com/users/855443/user855443"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 299, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494314775, "creation_date": 1494061867, "last_edit_date": 1494233275, "question_id": 43818701, "link": "https://stackoverflow.com/questions/43818701/how-to-force-stack-to-use-newer-version-of-local-package", "title": "how to force stack to use newer version of local package", "body": "<p>I have a package A which is build with stack producing a library. The library is used in package B (i.e. A is a dependent package listed in B's cabal file). B is build with stack as well. Consider the four cases of changes in A and use of solver on B: </p>\n\n<p>1 - When A changes then B continues to use the old state of A - this   follows the guarantee of stack that a compilation always works the same way and is not influenced by changes in other programs. </p>\n\n<p>2 - If the package A has a new version number, then stack build on A followed by stack build B does silently use the new version. I think this is wrong, as it violates the guarantee; it should continue to use the old version.</p>\n\n<p>3 - If package A changes without a new version number and solver is run on B, packages B continues using the old state. I think this is wrong; after running solver, the guarantee does not apply and the new state should be used.</p>\n\n<p>4 - if package A changes with a new version number and solver is run on B then B uses the new version. This is is correct.</p>\n\n<p>I cannot understand this behavior and how version numbers and solver interact. How to control the use of a new state of a without each time bump the version number up?  Changing version numbers all the time is inconvenient if two packages are worked on in parallel; it should be sufficient to run solver to bring the changes from A into B and without running solver, the package should always recompile, independent of changes in other packages.</p>\n\n<p>For development, I wish there were an (additional) flag I could use in case 2 to set for stack to build always using the newest state of the dependent packages silently (as if there would be a new version, without bumping the version number up).</p>\n\n<p>Do I misunderstand the guarantee of stack build or misunderstand the behavior of stack? The code I used to test is simplistic and is on <code>github: git@github.com:andrewufrank/test-depProj.git</code>.</p>\n\n<p>The question is related to previous questions I asked regarding atoms or leksahs behavior in multi-project development. I found that the issue is essentially a question of the behavior of <code>stack build</code> and must be clarified for <code>stack build</code> first. </p>\n\n<p>For clarification the stack.yam of A</p>\n\n<pre><code>flags: {}\nextra-package-dbs: []\npackages:\n- .\nextra-deps: []\nresolver: lts-8.13\n</code></pre>\n\n<p>and for B</p>\n\n<pre><code>flags: {}\nextra-package-dbs: []\npackages:\n- .\n- ../a\nextra-deps: []\nresolver: lts-8.13\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 3, "creation_date": 1494018493, "post_id": 43813303, "comment_id": 74666956, "body": "In the future, you can find functions easier by using <a href=\"https://www.haskell.org/hoogle/?hoogle=%28a+-%3E+Maybe+b%29+-%3E+%5Ba%5D+-%3E+Maybe+%5Bb%5D\" rel=\"nofollow noreferrer\">Hoogle</a>. Searching the type signature of your desired function found <code>mapM</code>, <code>forM</code>, and <code>traverse</code> immediately."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7970147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36708580a149d48ff5fc87c3395c2818?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/7970147/bob"}, "edited": false, "score": 0, "creation_date": 1494454356, "post_id": 43813446, "comment_id": 74840959, "body": "This answer was most relevant to my needs."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 33, "user_id": 7970147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36708580a149d48ff5fc87c3395c2818?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/7970147/bob"}, "edited": false, "score": 0, "creation_date": 1494482074, "post_id": 43813446, "comment_id": 74848197, "body": "Just a small remark: historically, <code>mapM</code> existed first. <code>traverse</code> came later. And <code>Applicative m =&gt; Monad m</code> came also later. Since the Applicative/Monad proposal and the Foldable/Traversable proposal you can exchange <code>mapM</code> and <code>traverse</code>. Nowadays, unless one specified another variant, <code>mapM = traverse</code>."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 7, "last_activity_date": 1494482702, "last_edit_date": 1494482702, "creation_date": 1494016839, "answer_id": 43813446, "question_id": 43813303, "link": "https://stackoverflow.com/questions/43813303/looking-for-the-name-of-a-special-map-function/43813446#43813446", "title": "Looking for the name of a special map function", "body": "<p>The Haskell report calls it <code>sequence . map f</code>, also called <code>mapM f</code>. Nowadays you can call it <code>traverse f</code> (GHC 7.10+).</p>\n\n<h1>Map and sequence</h1>\n\n<p>Let us think about the type of your function:</p>\n\n<pre><code>withList :: (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe [b]\n</code></pre>\n\n<p>The canonical function for mapping a list to another one is <code>map</code>, so we can use that as starting point:</p>\n\n<pre><code>withListNotYet :: (a -&gt; Maybe b) -&gt; [a] -&gt; [Maybe b]\nwithListNotYet f xs = map f xs\n</code></pre>\n\n<p>Now we have a list of <code>Maybe b</code>, but we want to get the <code>Maybe</code> outside. This is essentially what <code>sequence</code> does:</p>\n\n<pre><code>sequence :: Monad m =&gt; [m a] -&gt; m [a]\nsequence []     = return []\nsequence (x:xs) = do\n  y  &lt;- x\n  ys &lt;- sequence xs\n  return (y : ys)\n</code></pre>\n\n<p>Since <code>Maybe</code> is an instance of <code>Monad</code>, we can use <code>sequence</code> after <code>withListNotYet</code> and end up with our implementation for <code>withList</code>:</p>\n\n<pre><code>withList f xs = sequence (map f xs)\n</code></pre>\n\n<p>Since this is a common operation, it has has a name: <code>mapM</code>:</p>\n\n<pre><code>withList f xs = mapM f xs\n-- or\nwithList = mapM\n</code></pre>\n\n<h1>Traversable</h1>\n\n<p>During the <a href=\"https://wiki.haskell.org/Foldable_Traversable_In_Prelude\" rel=\"nofollow noreferrer\">\"burning bridges proposal\"</a>, <code>mapM</code>'s type changed from </p>\n\n<pre><code>mapM     :: Monad m                        =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]\n</code></pre>\n\n<p>to</p>\n\n<pre><code>mapM     :: (Monad m, Traversable t)       =&gt; (a -&gt; m b) -&gt; t a -&gt; m (t b)\n</code></pre>\n\n<p>There was already a similar function at that time, called <code>traverse</code>:</p>\n\n<pre><code>traverse :: (Applicative f, Traversable t) =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)\n</code></pre>\n\n<p>As you can see, the type signature is very similar. The same GHC version that changed <code>mapM</code>'s type also made <code>Applicative</code> a base class of <code>Monad</code>, see <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Migration/7.10#base-4.8.0.0\" rel=\"nofollow noreferrer\">Functor-Applicative-Monad-Proposal</a>. So nowadays you can usually use <code>traverse</code> or <code>mapM</code>. The former is the younger, more general variant, while the latter is the older, historical variant.</p>\n\n<p>And if you have a look at the <code>Traversable</code> class, you will notice that <code>mapM = traverse</code> by default.</p>\n"}, {"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 12, "last_activity_date": 1494017343, "creation_date": 1494017343, "answer_id": 43813536, "question_id": 43813303, "link": "https://stackoverflow.com/questions/43813303/looking-for-the-name-of-a-special-map-function/43813536#43813536", "title": "Looking for the name of a special map function", "body": "<p>This is <code>traverse</code> defined in the <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Traversable.html\" rel=\"noreferrer\"><code>Traversable</code></a> class:</p>\n\n<pre><code>traverse :: Traversable t, Applicative f =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b) \n</code></pre>\n\n<p>in your example <code>t</code> is list and <code>f</code> is <code>Maybe</code> e.g.</p>\n\n<pre><code>traverse (\\x -&gt; if x &lt; 5 then Just x else Nothing) [1,2,3]\n&gt; Just [1,2,3]\n\ntraverse (\\x -&gt; if x &lt; 5 then Just x else Nothing) [1,2,3, 9]\n&gt; Nothing\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 5, "last_activity_date": 1494020024, "last_edit_date": 1494020024, "creation_date": 1494018118, "answer_id": 43813676, "question_id": 43813303, "link": "https://stackoverflow.com/questions/43813303/looking-for-the-name-of-a-special-map-function/43813676#43813676", "title": "Looking for the name of a special map function", "body": "<p>The function is called <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Traversable.html#v:traverse\" rel=\"nofollow noreferrer\"><code>traverse</code></a>, from <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Traversable.html\" rel=\"nofollow noreferrer\"><code>Data.Traversable</code></a>.</p>\n\n<p>The type might surprise at first because it is quite abstract: </p>\n\n<p><code>traverse :: (Applicative f,Traversable t) =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)</code></p>\n\n<hr>\n\n<p><code>Applicative</code> and <code>Traversable</code> are two interfaces (<em>typeclasses</em> in Haskell terms). </p>\n\n<ul>\n<li><p>The <code>Applicative</code> abstracts over the <em>effects</em> we want to perform. In your case it is failure (<code>Maybe</code>) but it could also be failure-with-cause (<code>Either</code>), input/ouput (<code>IO</code>), concurrent input/ouput (<a href=\"http://hackage.haskell.org/package/async-2.1.1.1/docs/Control-Concurrent-Async.html#t:Concurrently\" rel=\"nofollow noreferrer\"><code>Concurrently</code></a>) and many others.</p></li>\n<li><p>The <code>Traversable</code> abstracts over the <em>type</em> of container. In your case it is a list (<code>[]</code>). But other containers are also <code>Traversable</code>: finite containers that have a shape independent of its own values. <a href=\"http://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-Tree.html\" rel=\"nofollow noreferrer\">Trees</a> and <a href=\"http://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-Map-Strict.html#g:2\" rel=\"nofollow noreferrer\">Maps</a> are examples. (<a href=\"http://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-Set.html#t:Set\" rel=\"nofollow noreferrer\">Sets</a> are <em>not</em> an example, because their \"shape\" depends on their values: changing all the elements into the same value will reduce the size of the set.)</p></li>\n</ul>\n\n<p><code>Traversable</code> is a interface for containers that support \"internal iteration\". It's basically the <code>forEach</code> of other languages. But it also provides you with a result container <em>of the same shape as the original</em> which holds the transformed values.</p>\n\n<p>If you don't care for the transformed container, the related <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Foldable.html#v:traverse_\" rel=\"nofollow noreferrer\"><code>traverse_</code></a> function discards the result and is only executed for the effects.</p>\n\n<p>The <code>mapM</code> function is a synonym for <code>traverse</code> that exists for historical reasons.</p>\n"}, {"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1494038344, "post_id": 43813971, "comment_id": 74671455, "body": "This is good advice, but probably belongs as a comment with a link to <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">Hoogle</a>. I personally prefer <a href=\"http://hayoo.fh-wedel.de\" rel=\"nofollow noreferrer\">Hayoo</a> and <a href=\"https://www.stackage.org\" rel=\"nofollow noreferrer\">Stackage</a> which have the same functionality."}, {"owner": {"reputation": 33, "user_id": 7970147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36708580a149d48ff5fc87c3395c2818?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/7970147/bob"}, "edited": false, "score": 0, "creation_date": 1494348582, "post_id": 43813971, "comment_id": 74786105, "body": "Thanks, this is very useful to know."}], "tags": [], "owner": {"reputation": 196, "user_id": 4900124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/036d10222e906cc1979840aab4751023?s=128&d=identicon&r=PG&f=1", "display_name": "Love T&#228;tting", "link": "https://stackoverflow.com/users/4900124/love-t%c3%a4tting"}, "is_accepted": false, "score": 2, "last_activity_date": 1494019581, "creation_date": 1494019581, "answer_id": 43813971, "question_id": 43813303, "link": "https://stackoverflow.com/questions/43813303/looking-for-the-name-of-a-special-map-function/43813971#43813971", "title": "Looking for the name of a special map function", "body": "<p>These are all really good answers. I just want to add to the board that you can find this information much faster with hoogle. If you know what you are looking for good enought that you can produce the type signature for your sought after expression, hoogle will search for it. It is smart enough to understand type variables etc (ie it doesn't matter if you write T and U as you did, or a and b as is common in Haskell). </p>\n\n<p>Taking your example verbatim, <code>[T] -&gt; (T -&gt; Maybe U) -&gt; Maybe [U]</code>, you will find among others traverse and mapM, both of which have been mentioned by other peers. Happy hoogling!</p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1494075804, "creation_date": 1494075804, "answer_id": 43820796, "question_id": 43813303, "link": "https://stackoverflow.com/questions/43813303/looking-for-the-name-of-a-special-map-function/43820796#43820796", "title": "Looking for the name of a special map function", "body": "<p>While <code>Data.Traverable.traverse</code> seems to be the right answer, You may also implement a similar functionality by yourself.</p>\n\n<pre><code>isJust :: Maybe a -&gt; Bool\nisJust (Just _) = True\nisJust _        = False\n\nwithList :: (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe [b]\nwithList f xs | all isJust js = Just (map (\\(Just x) -&gt; x) js)\n              | otherwise     = Nothing\n              where js = map f xs\n\n*Main&gt; withList (\\xs -&gt; if all (&lt;10) xs then (Just (sum xs)) else Nothing) [[1,2,3],[4,5,6],[7,8,9]] \nJust [6,15,24]\n*Main&gt; withList (\\xs -&gt; if all (&lt;9) xs then (Just (sum xs)) else Nothing) [[1,2,3],[4,5,6],[7,8,9]]\nNothing\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7970147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36708580a149d48ff5fc87c3395c2818?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/7970147/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 43813446, "answer_count": 5, "score": 3, "last_activity_date": 1494482702, "creation_date": 1494016165, "question_id": 43813303, "link": "https://stackoverflow.com/questions/43813303/looking-for-the-name-of-a-special-map-function", "title": "Looking for the name of a special map function", "body": "<p>I'm new to Haskell and looking for the name of a function (or generally, the name of the concept) that acts as such:</p>\n\n<p>The function takes two arguments:<br>\n1. A list of elements [T]<br>\n2. A function that takes a T, and returns a Maybe U.</p>\n\n<p>The function's output is as follows:<br>\nIf all elements in the list map to Some U, then return Some [U].<br>\nOtherwise, return None.  </p>\n\n<p>i.e. if any of the mapped values are null, then return null, otherwise just return the mapped values.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1494014826, "post_id": 43812932, "comment_id": 74665375, "body": "Your issue is just that GHCi doesn&#39;t expect multi-line definitions unless you use one of the features mentioned in the suggested question. Alternatively, if you load the definitions from a source file they will work just fine."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494024621, "post_id": 43812932, "comment_id": 74668968, "body": "Additionally, you probably meant <code>u == x</code> rather than <code>x == y</code>."}], "owner": {"reputation": 9700, "user_id": 257530, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/30e3d6214c397f9d5f1b4470da44c958?s=128&d=identicon&r=PG", "display_name": "oneat", "link": "https://stackoverflow.com/users/257530/oneat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "closed_date": 1494014625, "answer_count": 0, "score": 1, "last_activity_date": 1494014523, "creation_date": 1494014523, "question_id": 43812932, "link": "https://stackoverflow.com/questions/43812932/constructor-of-the-same-name-as-recursive-data-type", "closed_reason": "Duplicate", "title": "Constructor of the same name as recursive data type", "body": "<p>I am trying to achieve simple switch function for learning purposes:</p>\n\n<p>As far as I went was:</p>\n\n<pre><code>Prelude&gt; data Case a b = Case a b (Case a b) | Default deriving Show\nPrelude&gt; let switch Default = Nothing\nPrelude&gt; let switch u (Case x y z) = if (x == y) then y else (switch u z)\n</code></pre>\n\n<p>And it should behave like</p>\n\n<pre><code>switch 2 Case 1 2 $ Case 2 3 $ Case 3 4 $ Default\n</code></pre>\n\n<p>returns 3</p>\n\n<pre><code>switch 6 Case 1 2 $ Case 2 3 $ Case 3 4 $ Default\n</code></pre>\n\n<p>returns Nothing</p>\n\n<p>When I try to invoke it though i get:</p>\n\n<pre><code>Prelude&gt; switch 1 (Case 1 2 Default)\n*** Exception: &lt;interactive&gt;:11:5-30: Non-exhaustive patterns in function switch\n</code></pre>\n\n<p>I'm wondering if by using (Case a b) Haskell will get to understand that a b are type bearers not value. Is there possible without aliasing the time for </p>\n\n<pre><code>data Casy a b = Case a b (Casy a b) | Default deriving Show\n</code></pre>\n\n<p>to get this example to work?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 8861, "user_id": 148260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567454e026a83d9ef6218474a720be7e?s=128&d=identicon&r=PG", "display_name": "Steve Trout", "link": "https://stackoverflow.com/users/148260/steve-trout"}, "edited": false, "score": 0, "creation_date": 1494010272, "post_id": 43811461, "comment_id": 74663163, "body": "Can you use a newer GHC (&gt;=7.10)? It looks like that package wasn&#39;t tested with older versions. Upgrading would be easier than editing it to make it compile."}, {"owner": {"reputation": 378, "user_id": 3038705, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0a2cdc42fe3492d2b635618a940ffcc8?s=128&d=identicon&r=PG&f=1", "display_name": "Trailing Dots", "link": "https://stackoverflow.com/users/3038705/trailing-dots"}, "reply_to_user": {"reputation": 8861, "user_id": 148260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567454e026a83d9ef6218474a720be7e?s=128&d=identicon&r=PG", "display_name": "Steve Trout", "link": "https://stackoverflow.com/users/148260/steve-trout"}, "edited": false, "score": 0, "creation_date": 1494089366, "post_id": 43811461, "comment_id": 74684268, "body": "Yes, upgrading works. I updated to a ghc 8.0.2. I had some problems with the transaction lock, but I just rebooted and it cleared up."}], "answers": [{"comments": [{"owner": {"reputation": 378, "user_id": 3038705, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0a2cdc42fe3492d2b635618a940ffcc8?s=128&d=identicon&r=PG&f=1", "display_name": "Trailing Dots", "link": "https://stackoverflow.com/users/3038705/trailing-dots"}, "edited": false, "score": 0, "creation_date": 1494021214, "post_id": 43812289, "comment_id": 74667936, "body": "Yes, this works. I updated to a ghc 7.6.3. I had some problems with the transaction lock, but I just rebooted and it cleared up. I hope that in the future I can repay you kind attention by helping others.  :) ;)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 378, "user_id": 3038705, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0a2cdc42fe3492d2b635618a940ffcc8?s=128&d=identicon&r=PG&f=1", "display_name": "Trailing Dots", "link": "https://stackoverflow.com/users/3038705/trailing-dots"}, "edited": false, "score": 0, "creation_date": 1494022846, "post_id": 43812289, "comment_id": 74668452, "body": "@TrailingDots Glad it helped! Just one thing about your comment: perhaps you meant you installed a newer GHC (such as the current 8.0.2), as 7.6.3 is what you had before?"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 1, "last_activity_date": 1494012006, "last_edit_date": 1494012006, "creation_date": 1494011699, "answer_id": 43812289, "question_id": 43811461, "link": "https://stackoverflow.com/questions/43811461/craft3e-cabal-install-not-in-scope-applicative/43812289#43812289", "title": "Craft3e: cabal install not in scope: Applicative", "body": "<p>You have three options:</p>\n\n<ol>\n<li><p>Install <a href=\"https://hackage.haskell.org/package/Craft3e-0.1.0.10\" rel=\"nofollow noreferrer\">an older version of the <em>Craft3e</em> package</a>, with e.g. <code>cabal unpack Craft3e-0.1.0.10</code>.</p></li>\n<li><p>Find <a href=\"https://hackage.haskell.org/package/Craft3e-0.1.1.0/src/Calculator/CalcParseLib.hs\" rel=\"nofollow noreferrer\"><code>Calculator/CalcParseLib.hs</code></a> in the source files you have downloaded with <code>cabal unpack</code> and add a...</p>\n\n<pre><code>import Control.Applicative\n</code></pre>\n\n<p>... line next to the other <code>import</code> lines at the beginning. I suspect you will have to do the same with other modules, if the same error shows up elsewhere after you do this change, and there might be other issues of a similar nature.</p></li>\n<li><p>Install a newer version of GHC (7.6.3 is from 2013). Though the default CentOS repositories won't offer that, there are other options, such as an unofficial Fedora repository and a manual installation. See <a href=\"https://www.haskell.org/downloads/linux\" rel=\"nofollow noreferrer\">this page</a> for instructions.</p></li>\n</ol>\n\n<p>#3 is the definitive solution. If you just want to get started with the book right now, though, you can go for #1 and leave the reinstall for later.</p>\n\n<hr>\n\n<p>For the sake of reference, here is a brief explanation of the problem (I will use some unfamiliar terms, but you will soon enough learn about them as you study Haskell). There is an important type class called <code>Applicative</code> which, for historical reasons, wasn't as well integrated with the rest of the core libraries as it should be. This situation was corrected in GHC 7.10, which both included <code>Applicative</code> in the Prelude (the module which is imported by default in Haskell programs) and made it necessary to add <code>Applicative</code> instances in a number of places where they were missing. The code in the  <em>Craft3e</em> package was updated so that these <code>Applicative</code> instances were in place (cf. <a href=\"http://www.haskellcraft.com/craft3e/Blog/Entries/2016/9/1_Updating_the_code_in_hackage.html\" rel=\"nofollow noreferrer\">this entry in the book's blog</a>), but the <code>import Control.Applicative</code> line, which would be necessary to make the updated code work in older GHCs that do not have <code>Applicative</code> in the Prelude, wasn't added, leading to the error that you are seeing.</p>\n"}], "owner": {"reputation": 378, "user_id": 3038705, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0a2cdc42fe3492d2b635618a940ffcc8?s=128&d=identicon&r=PG&f=1", "display_name": "Trailing Dots", "link": "https://stackoverflow.com/users/3038705/trailing-dots"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1494012006, "creation_date": 1494008329, "question_id": 43811461, "link": "https://stackoverflow.com/questions/43811461/craft3e-cabal-install-not-in-scope-applicative", "title": "Craft3e: cabal install not in scope: Applicative", "body": "<p>I am attempting to install the code for \"Haskell: The Craft of Functional Programming\", 3rd edition.</p>\n\n<p>I'm using GHCi, version 7.6.3 on Centos version 7.</p>\n\n<p>Then:</p>\n\n<pre><code>cabal unpack Craft3e\ncd Craft3e-0.1.1.0/\ncabal install\n...\n[29 of 67] Compiling CalcParseLib     ( Calculator/CalcParseLib.hs,    dist/build/CalcParseLib.o )\nCalculator/CalcParseLib.hs:132:10:\nNot in scope: type constructor or class `Applicative'\nFailed to install Craft3e-0.1.1.0\ncabal: Error: some packages failed to install:\nCraft3e-0.1.1.0 failed during the building phase. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>I have attempted this installation multiple times, but cannot\novercome this error.</p>\n\n<p>Could I use something other than \"cabal install\"?</p>\n\n<p>I have plenty to learn about Haskell before I get to this example,\nbut it would be great to know the installation is fine!  :)</p>\n"}, {"tags": ["haskell", "https", "haskell-wai", "haskell-warp", "haskell-spock"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7970078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/889869a40a3b5bb607a3492b9e172706?s=128&d=identicon&r=PG&f=1", "display_name": "Ramiradi", "link": "https://stackoverflow.com/users/7970078/ramiradi"}, "edited": false, "score": 0, "creation_date": 1494015786, "post_id": 43811677, "comment_id": 74665800, "body": "how . .exactly?"}], "tags": [], "owner": {"reputation": 1178, "user_id": 1667161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233658d12fabd9d72b04d0a6916f6389?s=128&d=identicon&r=PG", "display_name": "liminalisht", "link": "https://stackoverflow.com/users/1667161/liminalisht"}, "is_accepted": false, "score": 1, "last_activity_date": 1494009166, "creation_date": 1494009166, "answer_id": 43811677, "question_id": 43810302, "link": "https://stackoverflow.com/questions/43810302/spock-or-wai-warp-and-https/43811677#43811677", "title": "Spock or Wai/Warp and HTTPS", "body": "<p>Use the <code>runTLS</code> fn from <code>warp-tls</code> <a href=\"https://hackage.haskell.org/package/warp-tls-3.2.3/docs/Network-Wai-Handler-WarpTLS.html\" rel=\"nofollow noreferrer\">here</a>. </p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7970078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/889869a40a3b5bb607a3492b9e172706?s=128&d=identicon&r=PG&f=1", "display_name": "Ramiradi", "link": "https://stackoverflow.com/users/7970078/ramiradi"}, "edited": false, "score": 0, "creation_date": 1494041237, "post_id": 43813907, "comment_id": 74671855, "body": "that doesn&#39;t compile"}, {"owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "reply_to_user": {"reputation": 1, "user_id": 7970078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/889869a40a3b5bb607a3492b9e172706?s=128&d=identicon&r=PG&f=1", "display_name": "Ramiradi", "link": "https://stackoverflow.com/users/7970078/ramiradi"}, "edited": false, "score": 1, "creation_date": 1494046474, "post_id": 43813907, "comment_id": 74672635, "body": "@Ramiradi What&#39;s the error message?"}], "tags": [], "owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "is_accepted": false, "score": 1, "last_activity_date": 1494019280, "creation_date": 1494019280, "answer_id": 43813907, "question_id": 43810302, "link": "https://stackoverflow.com/questions/43810302/spock-or-wai-warp-and-https/43813907#43813907", "title": "Spock or Wai/Warp and HTTPS", "body": "<p>I haven't used Spock, but how about this?</p>\n\n<p><pre>\nspockCfg &lt;- <a href=\"https://hackage.haskell.org/package/Spock-0.12.0.0/docs/Web-Spock-Config.html#v:defaultSpockCfg\" rel=\"nofollow noreferrer\">defaultSpockCfg</a> () PCNoDatabase ()\napp &lt;- <a href=\"https://hackage.haskell.org/package/Spock-0.12.0.0/docs/Web-Spock.html#v:spockAsApp\" rel=\"nofollow noreferrer\">spockAsApp</a> (<a href=\"https://hackage.haskell.org/package/Spock-0.12.0.0/docs/Web-Spock.html#v:spock\" rel=\"nofollow noreferrer\">spock</a> spockCfg yourAppMonad)\n<a href=\"https://hackage.haskell.org/package/warp-tls-3.2.3/docs/Network-Wai-Handler-WarpTLS.html#v:runTLS\" rel=\"nofollow noreferrer\">runTLS</a> <a href=\"https://hackage.haskell.org/package/warp-tls-3.2.3/docs/Network-Wai-Handler-WarpTLS.html#v:defaultTlsSettings\" rel=\"nofollow noreferrer\">defaultTlsSettings</a> (<a href=\"https://hackage.haskell.org/package/warp-tls-3.2.3/docs/Network-Wai-Handler-WarpTLS.html#v:tlsSettings\" rel=\"nofollow noreferrer\">tlsSettings</a> \"cert.pem\" \"privkey.pem\") app\n</pre></p>\n"}], "owner": {"reputation": 1, "user_id": 7970078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/889869a40a3b5bb607a3492b9e172706?s=128&d=identicon&r=PG&f=1", "display_name": "Ramiradi", "link": "https://stackoverflow.com/users/7970078/ramiradi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "closed_date": 1494086390, "answer_count": 2, "score": -1, "last_activity_date": 1494019280, "creation_date": 1494003700, "question_id": 43810302, "link": "https://stackoverflow.com/questions/43810302/spock-or-wai-warp-and-https", "closed_reason": "Needs more focus", "title": "Spock or Wai/Warp and HTTPS", "body": "<p>I have a Spock web site which must be available via HTTPS. How can I setup it up properly for that? I think it should be the same way as for Wai/Warp, but still there's no information which is up to date. </p>\n"}, {"tags": ["function", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1493996400, "post_id": 43808146, "comment_id": 74655299, "body": "What error are you facing and where are you stuck ?"}, {"owner": {"reputation": 175, "user_id": 7137698, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/73a2bcd04ae13a5ea09112f4bbc6cd4c?s=128&d=identicon&r=PG&f=1", "display_name": "Anil ", "link": "https://stackoverflow.com/users/7137698/anil"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1493996733, "post_id": 43808146, "comment_id": 74655554, "body": "I would like to know how to implement the sum function into my function. sum[xs] doesn&#39;t work"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1493997514, "post_id": 43808146, "comment_id": 74656073, "body": "<code>&quot;444333&quot;</code> is just syntactic sugar for <code>[&#39;4&#39;, &#39;4&#39;, &#39;4&#39;, &#39;3&#39;, &#39;3&#39;, &#39;3&#39;]</code>. (The <code>OverloadedString</code> extension complicates that a little.)"}], "answers": [{"tags": [], "owner": {"reputation": 1131, "user_id": 7189154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/10210252620692683/picture?type=large", "display_name": "Sylvain Attoumani", "link": "https://stackoverflow.com/users/7189154/sylvain-attoumani"}, "is_accepted": false, "score": 0, "last_activity_date": 1493997121, "creation_date": 1493997121, "answer_id": 43808414, "question_id": 43808146, "link": "https://stackoverflow.com/questions/43808146/how-to-integrate-a-sum-function-into-my-haskell-function/43808414#43808414", "title": "How to integrate a sum function into my Haskell function?", "body": "<p>If you use map and read it should works great</p>\n\n<pre><code>funct l = map(\\x -&gt;read [x]::Int) l\n\nsum funct(\"444333\") = 21\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1493999816, "post_id": 43808421, "comment_id": 74657534, "body": "Also consider <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Char.html#v:digitToInt\" rel=\"nofollow noreferrer\"><code>digitToInt</code></a>"}], "tags": [], "owner": {"reputation": 2334, "user_id": 2397162, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/665b976c79d0c9c842b131a2df510c3c?s=128&d=identicon&r=PG", "display_name": "niceman", "link": "https://stackoverflow.com/users/2397162/niceman"}, "is_accepted": false, "score": 2, "last_activity_date": 1494017693, "last_edit_date": 1494017693, "creation_date": 1493997149, "answer_id": 43808421, "question_id": 43808146, "link": "https://stackoverflow.com/questions/43808146/how-to-integrate-a-sum-function-into-my-haskell-function/43808421#43808421", "title": "How to integrate a sum function into my Haskell function?", "body": "<p>Your <code>replaceString</code> already returns a List of characters but I guess you want to obtain a list of numbers, the answer is just to replace <code>'3'</code> and <code>'4'</code> with <code>3</code> and <code>4</code> :), so it will become like this :  </p>\n\n<pre><code>replaceString [] = []\nreplaceString (x:xs) = (if x `elem` ['0'..'9']\n                       then 3\n                       else 4) : replaceString xs\n</code></pre>\n\n<p>Notice that we don't need to repeat <code>: replaceString xs</code> :) .  </p>\n\n<p>Alternatively if you want to convert a list of digit characters into a list of numbers you could get character's \"ordinal\" and subtract 48 from it, in haskell the character's ordinal can be obtained by <code>fromEnum char</code>, with replaceString putting <code>'3'</code> and <code>'4'</code>(instead of numbers), we can define a function like this :  </p>\n\n<pre><code>convertToDigits numstr = map ((48 -) . fromEnum) numstr\n</code></pre>\n\n<p>By the way your original function doesn't convert any other character into 4 but only alphabetic characets, so for <code>foo21!</code> the result would be <code>44433!</code> and you wouldn't want to sum that, if you want to filter digits I suggest you filter the string from non-alphanumeric characters before even calling <code>replaceString</code>.</p>\n\n<h2>Edit :</h2>\n\n<p>As Thomas pointed out, you can replace <code>(48 -) . fromEnum</code> with <code>digitToInt</code> (needs to be imported from <code>Data.Char</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1493998971, "creation_date": 1493998971, "answer_id": 43808946, "question_id": 43808146, "link": "https://stackoverflow.com/questions/43808146/how-to-integrate-a-sum-function-into-my-haskell-function/43808946#43808946", "title": "How to integrate a sum function into my Haskell function?", "body": "<p>This could also be done by foldl as follows;</p>\n\n<pre><code>import Data.Char\ngetsum :: String -&gt; Int\ngetsum = foldl helper 0\n         where helper n c | isLetter c = n + 3\n                          | isNumber c = n + 4\n                          | otherwise  = n\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 7137698, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/73a2bcd04ae13a5ea09112f4bbc6cd4c?s=128&d=identicon&r=PG&f=1", "display_name": "Anil ", "link": "https://stackoverflow.com/users/7137698/anil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1494017693, "creation_date": 1493996346, "question_id": 43808146, "link": "https://stackoverflow.com/questions/43808146/how-to-integrate-a-sum-function-into-my-haskell-function", "title": "How to integrate a sum function into my Haskell function?", "body": "<p>My function will replace will any number in the string to 3 and any character to 4. For example \"foo123\" will be replaced to \"444333\". My question is how do I convert the \"444333\" into list in order to use the sum function. \"444333\" -> [4,4,4,3,3,3] -> sum [4,4,4,3,3,3] = 21</p>\n\n<p>This my code </p>\n\n<pre><code>replaceString [] = []\nreplaceString (x:xs) =\n      if x `elem` ['0'..'9']\n      then '3' :replaceString xs\n      else if x `elem` ['a'..'z']\n      then '4' : replaceString xs\n      else x : replaceString xs\n</code></pre>\n"}, {"tags": ["scala", "haskell", "existential-type", "subtyping"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 2, "creation_date": 1493998214, "post_id": 43807643, "comment_id": 74656543, "body": "Existentials help when interfacing with Java wildcards and raw types: <a href=\"http://typelevel.org/blog/2015/02/26/rawtypes.html\" rel=\"nofollow noreferrer\">typelevel.org/blog/2015/02/26/rawtypes.html</a> See also the section on existential types of this interview: <a href=\"http://www.artima.com/scalazine/articles/scalas_type_system.html\" rel=\"nofollow noreferrer\">artima.com/scalazine/articles/scalas_type_system.html</a>"}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1494001780, "post_id": 43807643, "comment_id": 74658677, "body": "many thanks ! that explains a lot !"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1494008869, "post_id": 43807643, "comment_id": 74662439, "body": "Out of curiosity, doesn&#39;t something like Coyoneda work far better with existentials?"}], "answers": [{"comments": [{"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1494065967, "post_id": 43812196, "comment_id": 74677028, "body": "hmmm.... i dont even get this.... how does this even work ? why does the second not compile ? what is the type of <code>y</code> ? isn&#39;t this a compiler bug ?"}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1494069950, "post_id": 43812196, "comment_id": 74678120, "body": "1. Because you can&#39;t put a <code>String</code> into an <code>Array</code> of unknown type. 2. The type of <code>y</code> is <code>Array[_]</code>, as it says. 3. Of course it isn&#39;t a compiler bug, why would you think so?"}, {"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1494124892, "post_id": 43812196, "comment_id": 74692251, "body": "So if the type of y is <code>Array[_]</code> then how is it possible to assign to it an <code>Array</code> of <code>Double</code>s ? How is <code>Array[_]</code> even useful ? I noticed already two compiler bugs in the last few daysa as I was experimenting with existentials."}], "tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 2, "last_activity_date": 1494011274, "creation_date": 1494011274, "answer_id": 43812196, "question_id": 43807643, "link": "https://stackoverflow.com/questions/43807643/what-are-the-use-cases-of-existentials-in-scala-if-there-is-subtyping/43812196#43812196", "title": "what are the use cases of existentials in Scala if there is subtyping?", "body": "<p>Consider e.g. <code>Array[_]</code>. It isn't at all the same as <code>Array[Any]</code>, e.g.</p>\n\n<pre><code>val x: Array[Any] = new Array[Any](5)\nx(0) = \"\" // legal\nval y: Array[_] = new Array[Double](5)\ny(0) = \"\" // illegal\n</code></pre>\n\n<blockquote>\n  <p>EDIT: Existentials are useful for defining higher kinded types (Functor, Monad, etc), that I understand, but besides them, is there any other meaningful use case ?</p>\n</blockquote>\n\n<p>No. <code>F[_]</code> in <code>Functor[F[_]]</code> <em>looks</em> the same as an existential, but isn't one at all.</p>\n"}, {"comments": [{"owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1494065833, "post_id": 43813295, "comment_id": 74676991, "body": "interesting, how does this solution compare to f bounded polymorphism ? wouldn&#39;t that be another way of doing the same ?"}, {"owner": {"reputation": 3701, "user_id": 5385041, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1732264277003217/picture?type=large", "display_name": "simpadjo", "link": "https://stackoverflow.com/users/5385041/simpadjo"}, "reply_to_user": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "edited": false, "score": 0, "creation_date": 1494067851, "post_id": 43813295, "comment_id": 74677519, "body": "I haven&#39;t seen examples of F-bounded polymorphism that I liked. Googlable examples about Ordering violate separation of concerns. Of course existentials is not a killer feature since Martin Odersky removed it in Dotty. I think it can be emulated with typeclasses."}], "tags": [], "owner": {"reputation": 3701, "user_id": 5385041, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1732264277003217/picture?type=large", "display_name": "simpadjo", "link": "https://stackoverflow.com/users/5385041/simpadjo"}, "is_accepted": false, "score": 3, "last_activity_date": 1494016125, "creation_date": 1494016125, "answer_id": 43813295, "question_id": 43807643, "link": "https://stackoverflow.com/questions/43807643/what-are-the-use-cases-of-existentials-in-scala-if-there-is-subtyping/43813295#43813295", "title": "what are the use cases of existentials in Scala if there is subtyping?", "body": "<p>Example of existentials from my working project: </p>\n\n<p>Implementing type safe parameter storage</p>\n\n<pre><code>trait Parameter[T] // T is a type of a value related to this parameter\n\ntrait ParameterStorage {\n   def getValue[T](p: Parameter[T]): Option[T]\n}\n\n//implementation\ntype ParamAndValue = (Parameter[T], T) forSome { type T; }\n\n//initialize storage with pairs of parameters and values\nclass StorageImpl(pairs: ParamAndValue*) { \n   ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "is_accepted": false, "score": 0, "last_activity_date": 1504395450, "last_edit_date": 1504395450, "creation_date": 1494305221, "answer_id": 43861330, "question_id": 43807643, "link": "https://stackoverflow.com/questions/43807643/what-are-the-use-cases-of-existentials-in-scala-if-there-is-subtyping/43861330#43861330", "title": "what are the use cases of existentials in Scala if there is subtyping?", "body": "<p>Here is an example that came up just right now:</p>\n\n<pre><code>object Test{\n  trait Entity\n  case class SEntity() extends Entity\n  case class RefVal[T&lt;:Entity](a:T)\n  def g(o:RefVal[Entity])= ???\n  def g2(o:RefVal[_&lt;:Entity])= ???\n  g(RefVal[SEntity](a=SEntity())) // does not compile\n  g2(RefVal[SEntity](a=SEntity())) // does compile\n\n}\n</code></pre>\n\n<p>If I want to avoid making RefVal covariant then I need to use existentials here. </p>\n\n<p>In other words, existentials are useful to set covariance in a more fine grained resolution, for example on the method level as shown above as opposed to globally setting RefVal covariant by declaring it as <code>RefVal[+T&lt;:Entity]</code>.</p>\n\n<p>EDIT2:</p>\n\n<p>Here is some other useful usage of existentials:</p>\n\n<pre><code>object Existentials_List extends App {\n\n  class A[T]\n\n  class J\n\n  class C1() extends J\n\n  class C2() extends J\n\n  class Z\n\n  val l: Set[A[_ &lt;: J]] = Set()\n\n  val l2: Set[A[_ &lt;: J]] = l + new A[J]   \n  val l3: Set[A[_ &lt;: J]] = l + new A[C1]   \n  val l4: Set[A[_ &lt;: J]] = l + new A[Z] // does not compile\n\n}\n</code></pre>\n\n<p>Other possibility would have been to make  <code>class A[+T]</code> and just do <code>Set[A[J]]</code> but that can make a lot of things messy, the covariant + annotation can infect large part of the code where non of that covariant stuff matters at all. So keeping things invariant and using existentials at one place (in the collection where the objects are stored), might be a simpler solution than littering the code with covariance annotations.</p>\n"}], "owner": {"reputation": 18456, "user_id": 1198559, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/bOjLe.png?s=128&g=1", "display_name": "jhegedus", "link": "https://stackoverflow.com/users/1198559/jhegedus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1504395450, "creation_date": 1493994849, "question_id": 43807643, "link": "https://stackoverflow.com/questions/43807643/what-are-the-use-cases-of-existentials-in-scala-if-there-is-subtyping", "title": "what are the use cases of existentials in Scala if there is subtyping?", "body": "<p>Is there any meaningful reason why existentials exist in Scala if Scala has also subtyping?</p>\n\n<p>For example in Haskell existentials can be used for heterogenous <a href=\"https://wiki.haskell.org/Heterogenous_collections\" rel=\"nofollow noreferrer\">lists</a> but in Scala heterogeneous lists can be created just by using subtyping. </p>\n\n<p>This makes me wonder why would anyone ever want to use existentials if there is subtyping in Scala ? Is there any use case for existentials that cannot be more conviniently solved by subtyping ? I am not sure there is. Any counterexamples ?</p>\n\n<p>EDIT: Existentials are useful for defining higher kinded types (Functor, Monad, etc), that I understand, but besides them, is there any other meaningful use case ?</p>\n"}, {"tags": ["function", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 1131, "user_id": 7189154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/10210252620692683/picture?type=large", "display_name": "Sylvain Attoumani", "link": "https://stackoverflow.com/users/7189154/sylvain-attoumani"}, "edited": false, "score": 0, "creation_date": 1493989881, "post_id": 43805843, "comment_id": 74650636, "body": "what do you have with that ?"}, {"owner": {"reputation": 2417, "user_id": 1071526, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fXuba.png?s=128&g=1", "display_name": "mfeineis", "link": "https://stackoverflow.com/users/1071526/mfeineis"}, "edited": false, "score": 1, "creation_date": 1493990315, "post_id": 43805843, "comment_id": 74650928, "body": "That shouldn&#39;t even compile, you&#39;re trying to compare x to a list so Haskell will assume that you want to match on a list. <a href=\"http://stackoverflow.com/questions/14880299/how-can-i-replace-a-substring-of-a-string-with-another-in-haskell-without-using\">Possibible duplicate</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1131, "user_id": 7189154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/10210252620692683/picture?type=large", "display_name": "Sylvain Attoumani", "link": "https://stackoverflow.com/users/7189154/sylvain-attoumani"}, "is_accepted": false, "score": 2, "last_activity_date": 1493992307, "last_edit_date": 1493992307, "creation_date": 1493990719, "answer_id": 43806172, "question_id": 43805843, "link": "https://stackoverflow.com/questions/43805843/where-is-the-mistake-in-this-replacing-function-in-haskell/43806172#43806172", "title": "Where is the mistake in this replacing function in Haskell?", "body": "<p><code>==</code>  only tests if x is equal to the list, which it is not. You have to use the function <code>elem</code> which takes as its parameter one element and a list of element, and returns <code>true</code> if the element is in the list. So your code will be:</p>\n\n<pre><code>replace [] = []\nreplace (x:xs) =\n    if elem x ['0'..'9']\n    then '7' : replace xs\n    else x : replace xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 6, "last_activity_date": 1493994782, "last_edit_date": 1493994782, "creation_date": 1493990749, "answer_id": 43806184, "question_id": 43805843, "link": "https://stackoverflow.com/questions/43805843/where-is-the-mistake-in-this-replacing-function-in-haskell/43806184#43806184", "title": "Where is the mistake in this replacing function in Haskell?", "body": "<p><code>==</code> does not test if <code>x</code> is an element of the list; it checks if <code>x</code> is <em>equal</em> to the list. Use the <code>elem</code> function instead.</p>\n\n<pre><code>replace [] = []\nreplace (x:xs) =\n    if x `elem` ['0'..'9']\n    then '7' : replace xs\n    else x : replace xs\n</code></pre>\n\n<p><code>if</code> is a pure expression that can be used anywhere another expression can be used, so you don't need to repeat the recursive call to <code>xs</code>:</p>\n\n<pre><code>replace [] = []\nreplace (x:xs) = (if x `elem` ['0'..'9'] then '7' else x) : replace xs\n</code></pre>\n\n<p>Finally, you can just use <code>map</code> instead of using explicit recursion.</p>\n\n<pre><code>replace xs = map (\\x -&gt; if x `elem` ['0'..'9'] then '7' else x) xs\n</code></pre>\n\n<p>or just</p>\n\n<pre><code>replace = map (\\x -&gt; if x `elem` ['0'..'9'] then '7' else x)\n</code></pre>\n\n<hr>\n\n<p>You may want to use <code>Data.Char.isDigit</code> instead:</p>\n\n<pre><code>import Data.Char\nreplace = map (\\x -&gt; if isDigit x then '7' else x)\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 7137698, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/73a2bcd04ae13a5ea09112f4bbc6cd4c?s=128&d=identicon&r=PG&f=1", "display_name": "Anil ", "link": "https://stackoverflow.com/users/7137698/anil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1493994782, "creation_date": 1493989800, "question_id": 43805843, "link": "https://stackoverflow.com/questions/43805843/where-is-the-mistake-in-this-replacing-function-in-haskell", "title": "Where is the mistake in this replacing function in Haskell?", "body": "<p>I want to write a function which takes a string and replaces any number in the string with 7. For example \"foo123\" will be replaced to \"foo777\"</p>\n\n<p>This is my function.</p>\n\n<pre><code>replace [] = []\nreplace (x:xs) =\n    if x == ['0'..'9']\n    then '7' : replace xs\n    else x : replace xs\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1493988895, "post_id": 43805522, "comment_id": 74649970, "body": "Just a heads up, don&#39;t use backticks for larger pieces of code. Indent it by 4 spaces to format larger bits nicely."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1493988966, "post_id": 43805522, "comment_id": 74650024, "body": "And what&#39;s your question? All you&#39;ve done is state your end goal, and show some almost complete code."}, {"owner": {"reputation": 148712, "user_id": 19750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b41b2620da0b1e630715e0c91a0b03?s=128&d=identicon&r=PG", "display_name": "Josh Lee", "link": "https://stackoverflow.com/users/19750/josh-lee"}, "edited": false, "score": 3, "creation_date": 1493989239, "post_id": 43805522, "comment_id": 74650218, "body": "You could write <code>Either Int (Either String Bool)</code>, but you shouldn&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 418, "user_id": 6106932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fe6348cb3a1f3b9a7afd420777c587a?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad Iordache", "link": "https://stackoverflow.com/users/6106932/vlad-iordache"}, "edited": false, "score": 0, "creation_date": 1493990022, "post_id": 43805642, "comment_id": 74650741, "body": "Yes, that is not exactly what I was looking for, but I&#39;m starting to understand that what I am looking for may not be possible in Haskell. I mean I was trying to do it without those auxiliary constructors, then use some function to know which of those I am trying to return (kind of isType()). Thank you, I will proceed to implement your solution."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 418, "user_id": 6106932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fe6348cb3a1f3b9a7afd420777c587a?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad Iordache", "link": "https://stackoverflow.com/users/6106932/vlad-iordache"}, "edited": false, "score": 1, "creation_date": 1493995036, "post_id": 43805642, "comment_id": 74654376, "body": "@VladIordache indeed, Haskell&#39;s unions are <a href=\"https://en.wikipedia.org/wiki/Tagged_union\" rel=\"nofollow noreferrer\">tagged</a>."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 5, "last_activity_date": 1493989169, "creation_date": 1493989169, "answer_id": 43805642, "question_id": 43805522, "link": "https://stackoverflow.com/questions/43805522/type-of-many-types-in-haskell/43805642#43805642", "title": "&quot;Type of many types&quot; in Haskell", "body": "<p>You defined a type with three constructors that each take 0 arguments. So <code>Int x</code> wouldn't be a valid pattern for your type, it would just be <code>Int -&gt; true</code>. Of course this also means that you can't store any values in your type, so it doesn't do what you want it to.</p>\n\n<p>What you want is something like this:</p>\n\n<pre><code>data Rets = IntRet Int | StringRet String | BoolRet Bool\n</code></pre>\n\n<p>This defines three constructors named <code>IntRet</code>, <code>StringRet</code> and <code>BoolRet</code>, which take an <code>Int</code>, <code>String</code> and <code>Bool</code> respectively. This way you can construct values using <code>IntRet 42</code>, <code>BoolRet True</code> etc. and then pattern match them as <code>IntRet x</code> and so on.</p>\n"}], "owner": {"reputation": 418, "user_id": 6106932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1fe6348cb3a1f3b9a7afd420777c587a?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad Iordache", "link": "https://stackoverflow.com/users/6106932/vlad-iordache"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 43805642, "answer_count": 1, "score": 1, "last_activity_date": 1493989169, "creation_date": 1493988800, "last_edit_date": 1493988885, "question_id": 43805522, "link": "https://stackoverflow.com/questions/43805522/type-of-many-types-in-haskell", "title": "&quot;Type of many types&quot; in Haskell", "body": "<p>I'm totally new to functional programming and Haskell, so I am not sure I asked the question properly or if it makes sense, but I decided to try since I haven't found anything helpful. I'm basically trying to implement a function that can return an <code>Int</code>, a <code>String</code>, or a List. I know I can use <code>Either</code> to return one of two types, but I want to return one of three or more. I tried defining a new type, but I got stuck. </p>\n\n<pre><code>data Rets = Int | String | Bool\n\ncheckInt :: Rets -&gt; Bool\ncheck x = case x of\n    Int x -&gt; True\n</code></pre>\n\n<p><code>checkInt</code> should return <code>True</code> if given an <code>Int</code>, it is just for testing but I included it anyway. </p>\n\n<p>I'm aware that my question is a mess, so I would be thankful for any kind of explanation. Thanks in advance!</p>\n"}, {"tags": ["haskell", "hunit"], "answers": [{"comments": [{"owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "edited": false, "score": 0, "creation_date": 1493992271, "post_id": 43806318, "comment_id": 74652370, "body": "This is great thank you!! Will try all these suggestions carefully as I expect to learn a lot from the exercise."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 4, "last_activity_date": 1493991410, "last_edit_date": 1493991410, "creation_date": 1493991101, "answer_id": 43806318, "question_id": 43805402, "link": "https://stackoverflow.com/questions/43805402/pattern-for-generic-unit-test-of-type-class-instance-implementations-in-haskell/43806318#43806318", "title": "Pattern for generic unit test of type class instance implementations in Haskell", "body": "<h2>Proxy</h2>\n\n<p>The current most common way of making a function polymorphic in an \"internal\" type is to pass a <code>Proxy</code>. <code>Proxy</code> has a single nullary constructor like <code>()</code>, but its type carries a phantom type. This avoids having to pass <code>undefined</code> or dummy values. <code>Data.Proxy.asProxyTypeOf</code> can then be used as an annotation.</p>\n\n<pre><code>tests :: M a =&gt; Proxy a -&gt; Test\ntests a = TestCase (assertEqual \"foo\" (foo (cons 0 `asProxyTypeOf` a)) \"foo\")\n</code></pre>\n\n<h2>proxy</h2>\n\n<p>We can also generalize that type, as the <code>Proxy</code> is not actually being needed as a value. It's just a way of making a type variable non-ambiguous. You need to redefine <code>asProxyTypeOf</code> though. This is mostly a matter of style compared to the previous one. Being able to use more values as potential proxies can make some code more concise, sometimes at the cost of readability. </p>\n\n<pre><code>-- proxy is a type variable of kind * -&gt; *\ntests :: M a =&gt; proxy a -&gt; Test\ntests a = TestCase (assertEqual \"foo\" (foo (cons 0 `asProxyTypeOf` a)) \"foo\")\n  where\n    asProxyTypeOf :: a -&gt; proxy a -&gt; a\n    asProxyTypeOf = const\n</code></pre>\n\n<h2>Scoped type variables</h2>\n\n<p>The function <code>asProxyTypeOf</code>, or your <code>(==)</code> trick are really a product of the inability to refer to a type variable from a signature. This is in fact allowed by the <code>ScopedTypeVariables</code>+<code>RankNTypes</code> extensions.</p>\n\n<p>Explicit quantification brings the variable <code>a</code> into scope in the body of the function.</p>\n\n<pre><code>tests :: forall a proxy. M a =&gt; proxy a -&gt; Test\ntests _ = TestCase (assertEqual \"foo\" (foo (cons 0 :: a)) \"foo\")  -- the \"a\" bound by the top-level signature.\n</code></pre>\n\n<p>Without the <code>ScopedTypeVariables</code> extension, <code>cons 0 :: a</code> would be interpreted as <code>cons 0 :: forall a. a</code> instead.</p>\n\n<p>Here's how you use these functions:</p>\n\n<pre><code>main = runTestTT $ TestList\n  [ tests (Proxy :: Proxy A)\n  , tests (Proxy :: Proxy B)\n  ]\n</code></pre>\n\n<h2>Type applications</h2>\n\n<p>Since GHC 8, the <code>AllowAmbiguousTypes</code>+<code>TypeApplications</code> extensions make the <code>Proxy</code> argument unnecessary.</p>\n\n<pre><code>tests :: forall a. M a =&gt; Test\ntests = TestCase (assertEqual \"foo\" (foo (cons 0 :: a)) \"foo\")  -- the \"a\" bound by the top-level signature.\n\nmain = runTestTT $ TestList\n  [ tests @A\n  , tests @B\n  ]\n</code></pre>\n"}], "owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 1, "accepted_answer_id": 43806318, "answer_count": 1, "score": 2, "last_activity_date": 1494070395, "creation_date": 1493988481, "last_edit_date": 1494070395, "question_id": 43805402, "link": "https://stackoverflow.com/questions/43805402/pattern-for-generic-unit-test-of-type-class-instance-implementations-in-haskell", "title": "Pattern for generic unit test of type class instance implementations in Haskell", "body": "<p>I was wondering if there was a known pattern for writing generic unit test code whose purpose it is to check (as a black box) the various instance (implementation of) a type class. For example:</p>\n\n<pre><code>import Test.HUnit\n\nclass M a where\nfoo :: a -&gt; String\ncons :: Int -&gt; a     -- some constructor\n\ndata A = A Int\ndata B = B Int\n\ninstance M A where\n  foo _ = \"foo\"\n  cons  = A\n\ninstance M B where\n  foo _ = \"bar\"     -- implementation error\n  cons  = B \n</code></pre>\n\n<p>I would like to write a function <code>tests</code> returning a <code>Test</code> with some way of specifying to <code>tests</code> the particular instance to which the code applies. I was thinking adding <code>tests</code>to the definition of the class with a default implementation (ignoring the coupling issue between testing code and actual code for now), but I can't simply have <code>tests :: Test</code>, and even if I try <code>tests:: a -&gt; Test</code> (so having to artificially pass a concrete element of the given type to call the function), I cannot figure out how to refer to <code>cons</code> and <code>foo</code> inside the code (type annotations like <code>(cons 0) :: a</code> won't do).</p>\n\n<p>Assuming I have <code>class (Eq a) =&gt; M a where ...</code> instead, with types <code>A</code> and <code>B</code> deriving <code>Eq</code>, I could trick the compiler with something like (added to the definition of <code>M</code>):</p>\n\n<pre><code>tests :: a -&gt; Test\ntests x = let \n            y = (cons 0)\n            z = (x == y)       -- compiler now knows y :: a\n          in\n            TestCase (assertEqual \"foo\" (foo y)  \"foo\")\n\nmain = do\n  runTestTT $ TestList\n   [ tests (A 0)\n   , tests (B 0)\n   ]\n</code></pre>\n\n<p>But this is all very ugly to me. Any suggestion is warmly welcome</p>\n"}, {"tags": ["haskell", "syntax", "typeclass"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1493986553, "post_id": 43804668, "comment_id": 74648370, "body": "Note: this question is, just <a href=\"https://stackoverflow.com/questions/35855170/why-shouldnt-i-mix-tabs-and-spaces\">like my other one</a>, intended to be a minimal generic variant of one of the more frequently asked Haskell questions."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 6, "last_activity_date": 1493986419, "creation_date": 1493986419, "answer_id": 43804669, "question_id": 43804668, "link": "https://stackoverflow.com/questions/43804668/why-do-i-get-an-ambiguous-occurrence-error-when-i-define-an-instance/43804669#43804669", "title": "Why do I get an ambiguous occurrence error when I define an instance?", "body": "<p><strong>TL;DR:</strong> Indent your instance bindings.</p>\n\n<hr>\n\n<p>Enable warnings and you will notice that you didn't implement the <em>instance operation</em> <code>show</code>, but instead a <em>new</em> function with the same name:</p>\n\n<pre><code>Foo.hs:3:10: Warning:\n    No explicit implementation for\n      either `showsPrec' or `Prelude.show'\n    In the instance declaration for `Show Foo'\n</code></pre>\n\n<p>Therefore there are now two <code>show</code>s. <code>Main.show</code> (the one you've just accidentally defined) and <code>Prelude.show</code> (the one by the class you've wanted to use).</p>\n\n<p>We can verify that by looking at their types (although we need to fully qualify their names):</p>\n\n<pre><code>ghci&gt; :t Main.show\nMain.show :: Foo -&gt; [Char]\nghci&gt; :t Prelude.show\nPrelude.show :: Show a =&gt; a -&gt; String\n</code></pre>\n\n<p>That's because your <code>where</code> bindings need to be indented, just like you would indent them in a usual function. Even a single space is enough:</p>\n\n<pre><code>instance Show Foo where\n show Foo = \"Foo\"\n</code></pre>\n\n<p>Remember, Haskell uses whitespace to delimit blocks. Just ask yourself: when would the <code>where</code> stop otherwise?</p>\n"}], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 1, "accepted_answer_id": 43804669, "answer_count": 1, "score": 3, "last_activity_date": 1493987528, "creation_date": 1493986419, "last_edit_date": 1493987528, "question_id": 43804668, "link": "https://stackoverflow.com/questions/43804668/why-do-i-get-an-ambiguous-occurrence-error-when-i-define-an-instance", "title": "Why do I get an ambiguous occurrence error when I define an instance?", "body": "<p>I have a type <code>Foo</code> and want to make it an instance of <code>Show</code>, so that I can use it in GHCi:</p>\n\n<pre><code>data Foo = Foo\n\ninstance Show Foo where\nshow Foo = \"Foo\"\n</code></pre>\n\n<p>However, when I try to use it, I get an ambiguous occurrence error:</p>\n\n<pre><code>ghci&gt; show Foo\n&lt;interactive&gt;:4:1:\n    Ambiguous occurrence `show'\n    It could refer to either `Main.show', defined at Foo.hs:4:1\n                          or `Prelude.show',\n                             imported from `Prelude' at Foo.hs:1:1\n                             (and originally defined in `GHC.Show')\n</code></pre>\n\n<p>Why? I just defined the function that belongs to a typeclass, didn't I?</p>\n"}, {"tags": ["haskell", "foldable"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1493989989, "post_id": 43803992, "comment_id": 74650716, "body": "&quot;why that&#39;s a warning and not an error I don&#39;t know&quot; -- good point. Maybe it&#39;s because every method has a default definition? Usually, through, such defaults are mutually recursive, and will simply diverge unless the user defines some method. E.g. <code>Eq</code> has both  <code>==,&#47;=</code> defaulted, but requires at least one of those to be defined to work properly."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1493990126, "post_id": 43803992, "comment_id": 74650810, "body": "@chi It looks like it&#39;s always a warning, even when the missing functions don&#39;t have a default implementation. <code>instance Functor Foo where {}</code> produces a warning only. I&#39;m sure there must be a good reason for it..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494025375, "post_id": 43803992, "comment_id": 74669155, "body": "@BenjaminHodgson I&#39;m not sure whether you&#39;d call it a &quot;good&quot; reason, but occasionally you want to use an ill-thought-out class (<code>Num</code>, I&#39;m looking at you...) even though some of the methods don&#39;t make complete sense for your type. Having a default default implementation (that was not a typo -- it is a default implementation written for you by the compiler) that calls <code>error</code> is kind of convenient in that situation."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494025474, "post_id": 43803992, "comment_id": 74669183, "body": "@DanielWagner But then again, if you decide you want to call <code>error</code> then doing so explicitly is not so painful"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1494025743, "post_id": 43803992, "comment_id": 74669269, "body": "@BenjaminHodgson Indeed. I wouldn&#39;t upgrade my judgment above &quot;kind of convenient&quot;. =)"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 4, "last_activity_date": 1494018445, "last_edit_date": 1494018445, "creation_date": 1493984216, "answer_id": 43803992, "question_id": 43803944, "link": "https://stackoverflow.com/questions/43803944/ambiguous-occurrence-foldmap/43803992#43803992", "title": "Ambiguous occurrence \u2018foldMap\u2019", "body": "<p>You just need to indent your <code>fold</code> and <code>foldMap</code> declarations so they're part of the <code>instance</code>.</p>\n\n<pre><code>instance Foldable Tree where\n    --fold :: Monoid a =&gt; Tree a -&gt; a\n    fold (Leaf x) = x\n    fold (Node l r) = fold l `mappend` fold r\n\n    --foldMap :: Monoid b =&gt; (a -&gt; b) -&gt; Tree a -&gt; b\n    foldMap f (Leaf x) = f x\n    foldMap f (Node l r) = foldMap f l `mappend` foldMap f r\n</code></pre>\n\n<p>When you had them un-indented, the machine saw an empty <code>instance</code> declaration and two unrelated top-level functions called <code>fold</code> and <code>foldMap</code>. The empty instance was the source of the \"No explicit implementation\" error (why that's a warning and not an error I don't know). The \"ambiguous occurrence\" error was because the compiler couldn't tell whether the recursive calls to <code>foldMap</code> were referring to the implicitly imported <code>Prelude.foldMap</code> or to the <code>Main.foldMap</code> in your code.</p>\n"}], "owner": {"reputation": 1678, "user_id": 1201889, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9715f2889b4829f4ca2d8b0ea618001b?s=128&d=identicon&r=PG", "display_name": "Laurence", "link": "https://stackoverflow.com/users/1201889/laurence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 43803992, "answer_count": 1, "score": 1, "last_activity_date": 1494018445, "creation_date": 1493984086, "last_edit_date": 1493996973, "question_id": 43803944, "link": "https://stackoverflow.com/questions/43803944/ambiguous-occurrence-foldmap", "title": "Ambiguous occurrence \u2018foldMap\u2019", "body": "<p>I am implementing Foldable for the following data structure:</p>\n\n<pre><code>data Tree a = Leaf a | Node (Tree a) (Tree a) deriving Show\n</code></pre>\n\n<p>When I implement fold and foldMap:</p>\n\n<pre><code>instance Foldable Tree where \n\n--fold :: Monoid a =&gt; Tree a -&gt; a\nfold (Leaf x) = x\nfold (Node l r) = fold l `mappend` fold r\n\n--foldMap :: Monoid b =&gt; (a -&gt; b) -&gt; Tree a -&gt; b \nfoldMap f (Leaf x) = f x\nfoldMap f (Node l r) = foldMap f l `mappend` foldMap f r\n</code></pre>\n\n<p>I will get the following error:</p>\n\n<pre><code>    Ambiguous occurrence \u2018foldMap\u2019\n    It could refer to either \u2018Main.foldMap\u2019,\n                             defined at Chapterh14.hs:57:1\n                          or \u2018Prelude.foldMap\u2019,\n                             imported from \u2018Prelude\u2019 at Chapterh14.hs:1:1\n                             (and originally defined in \u2018Data.Foldable\u2019)\n\nChapterh14.hs:58:46:\n    Ambiguous occurrence \u2018foldMap\u2019\n    It could refer to either \u2018Main.foldMap\u2019,\n                             defined at Chapterh14.hs:57:1\n                          or \u2018Prelude.foldMap\u2019,\n                             imported from \u2018Prelude\u2019 at Chapterh14.hs:1:1\n                             (and originally defined in \u2018Data.Foldable\u2019)\n\nChapterh14.hs:71:13:\n    Ambiguous occurrence \u2018foldMap\u2019\n    It could refer to either \u2018Main.foldMap\u2019,\n                             defined at Chapterh14.hs:57:1\n                          or \u2018Prelude.foldMap\u2019,\n                             imported from \u2018Prelude\u2019 at Chapterh14.hs:1:1\n                             (and originally defined in \u2018Data.Foldable\u2019)\n</code></pre>\n\n<p>When I remove the definition of foldMap I will get the following warning:</p>\n\n<pre><code>    No explicit implementation for\n      either \u2018foldMap\u2019 or \u2018foldr\u2019\n    In the instance declaration for \u2018Foldable Tree\u2019\nOk, modules loaded: Main.\n</code></pre>\n\n<p>When I implement the function I will get the error that it is already there, but when I do not implement the function I will get a warning that the function is missing? What am I doing wrong?</p>\n"}, {"tags": ["haskell", "web-routes-boomerang"], "answers": [{"comments": [{"owner": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "edited": false, "score": 0, "creation_date": 1494000102, "post_id": 43806944, "comment_id": 74657698, "body": "Perfect. Thank you :)"}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 1, "last_activity_date": 1493992745, "creation_date": 1493992745, "answer_id": 43806944, "question_id": 43803875, "link": "https://stackoverflow.com/questions/43803875/haskell-boomerang-compilation-error/43806944#43806944", "title": "Haskell Boomerang Compilation Error", "body": "<p>Boomerangs should be polymorphic.</p>\n\n<pre><code>messageTypeP :: StringBoomerang r (MessageType :- r)\n\naisP :: StringBoomerang r (AIS :- r)\n</code></pre>\n\n<p>The interpretation is that <code>r</code> is a stack of types, and boomerangs pop/push types from/into it. Setting <code>r</code> to <code>()</code> forces the input stack to be empty, which hurts the reusability of these boomerangs.</p>\n"}], "owner": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 43806944, "answer_count": 1, "score": 0, "last_activity_date": 1493992745, "creation_date": 1493983891, "question_id": 43803875, "link": "https://stackoverflow.com/questions/43803875/haskell-boomerang-compilation-error", "title": "Haskell Boomerang Compilation Error", "body": "<p>So I thought I'd have some fun parsing some AIS data with Boomerang, and I'm stumbling at the first hurdle. The compilation errors are baffling. Seeing as I've parse similar things in Boomerang before I'm stuck trying to solve this.</p>\n\n<p>The library is simple. I define some basic types and their parser/grammar:</p>\n\n<pre><code>import           Control.Category      (id, (.))\nimport           Control.Monad         (forever)\nimport           Prelude               hiding (id, (.))\nimport           System.IO             (hFlush, stdout)\nimport           Text.Boomerang\nimport           Text.Boomerang.String\nimport           Text.Boomerang.TH\n\ndata MessageType = AIVDM | AIVDO deriving (Enum, Eq, Show)\n\ndata AIS = AIS {\n              msgType :: MessageType\n          } deriving (Eq, Show)\n\n$(makeBoomerangs ''MessageType)\n$(makeBoomerangs ''AIS)\n\nmessageTypeP :: StringBoomerang () (MessageType :- ())\nmessageTypeP = rAIVDM . \"!AIVDM\" &lt;&gt; rAIVDO . \"!AIVDO\"\n\naisP :: StringBoomerang () (AIS :- ())\naisP = rAIS . messageTypeP . lit \",\"\n</code></pre>\n\n<p>I now wish to support the sentence count value, which comes after the message type; I add an <code>Int</code> to <code>AIS</code>:</p>\n\n<pre><code>data AIS = AIS {\n              msgType :: MessageType, sCount :: Int\n          } deriving (Eq, Show)\n</code></pre>\n\n<p>and change the parser/printer:</p>\n\n<pre><code>aisP :: StringBoomerang () (AIS :- ())\naisP = rAIS . messageTypeP . lit \",\" . int\n</code></pre>\n\n<p>but it fails to compile:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018()\u2019 with \u2018Int :- ()\u2019\n  Expected type: Boomerang\n                   StringError String () (MessageType :- (Int :- ()))\n    Actual type: Boomerang StringError String () (MessageType :- ())\n\u2022 In the second argument of \u2018(.)\u2019, namely\n    \u2018messageTypeP . lit \",\" . int\u2019\n  In the expression: rAIS . messageTypeP . lit \",\" . int\n  In an equation for \u2018aisP\u2019:\n      aisP = rAIS . messageTypeP . lit \",\" . int\n</code></pre>\n\n<p>Ouch. Help, please?</p>\n"}, {"tags": ["linux", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 1479, "user_id": 855443, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d880e98c9fffc6253f3868babc99b8c1?s=128&d=identicon&r=PG", "display_name": "user855443", "link": "https://stackoverflow.com/users/855443/user855443"}, "edited": false, "score": 0, "creation_date": 1493998529, "post_id": 43803920, "comment_id": 74656740, "body": "thank you very much for the enlightenment. I read the discussion you refer to and am not satisfied with the solution - especially as it is not widely communicated that and make people check their own code for hours."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 4, "last_activity_date": 1493984023, "creation_date": 1493984023, "answer_id": 43803920, "question_id": 43803372, "link": "https://stackoverflow.com/questions/43803372/readfile-throws-permission-denied-for-readable-file/43803920#43803920", "title": "readFile throws &quot;permission denied&quot; for readable file", "body": "<p>This is not a Haskell issue, but is a Linux specific thing. Even though it shows that you have the permission to read, it won't allow:</p>\n\n<pre><code>~ $ ls -lh /proc/1/task/1/maps\n-r--r--r-- 1 root root 0 May  5 16:56 /proc/1/task/1/maps\n~ $ cat /proc/1/task/1/maps\ncat: /proc/1/task/1/maps: Permission denied\n</code></pre>\n\n<p>The files inside <code>/proc</code> are kernel related and they have special cases in it. You can read <a href=\"https://groups.google.com/forum/#!topic/comp.os.linux.development.system/RAPRvAocEtU\" rel=\"nofollow noreferrer\">this\ndiscussion</a>\nto get more details on this.</p>\n"}], "owner": {"reputation": 1479, "user_id": 855443, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d880e98c9fffc6253f3868babc99b8c1?s=128&d=identicon&r=PG", "display_name": "user855443", "link": "https://stackoverflow.com/users/855443/user855443"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 43803920, "answer_count": 1, "score": 1, "last_activity_date": 1493984309, "creation_date": 1493982327, "last_edit_date": 1493984309, "question_id": 43803372, "link": "https://stackoverflow.com/questions/43803372/readfile-throws-permission-denied-for-readable-file", "title": "readFile throws &quot;permission denied&quot; for readable file", "body": "<p>I try to read all files from my disk and fail with a specific file.\nWhat can impede reading a file when it is a regular file and is readable (both checked in the code and with <code>stat</code>)?</p>\n\n<pre><code>stat \"/proc/1/task/1/maps\"\n  File: /proc/1/task/1/maps\n  Size: 0           Blocks: 0          IO Block: 1024   regular empty file\nDevice: 4h/4d   Inode: 209680      Links: 1\nAccess: (0444/-r--r--r--)  Uid: (    0/    root)   Gid: (    0/    root)\nAccess: 2017-05-05 11:34:57.840873751 +0200\nModify: 2017-05-05 11:34:57.840873751 +0200\nChange: 2017-05-05 11:34:57.840873751 +0200\n Birth: -\n</code></pre>\n\n<p>The code is </p>\n\n<pre><code>module Main  \n\nimport System.Posix.Files\n\nmain = do \n         putStrLn \"tets_maps - trying to read file /proc/1/task/1/maps\" \n         let fn = \"/proc/1/task/1/maps\" :: FilePath \n         status &lt;- getSymbolicLinkStatus fn\n         readable &lt;-  fileAccess  fn  True  False  False   \n         putStrLn  \"tets_maps - status regularFiel and readable\"\n         putStrLn .         show . isRegularFile $ status \n         putStrLn  . show $ readable \n\n         res1 :: String  &lt;-  readFile  fn \n         putStrLn \"tets_maps - result\" \n</code></pre>\n\n<p>The output is : </p>\n\n<pre><code>readProblem: /pro`c/1/task/1/maps: openFile: permission denied (Permission denied)`\n</code></pre>\n\n<p>Why a <code>permission denied</code> when testing before that the file has read access? I am aware that the file has size 0 (is emtpy) and I expect an empty string back, but not an error. \nWhat do I not consider? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1493981024, "post_id": 43802828, "comment_id": 74644972, "body": "What should the function do? Can you provide an example? What is its type? <code>iterate</code> looks wrong for this, but it&#39;s hard to suggest what to use without knowing what the function should do. It might be <code>foldl</code> or <code>scanl</code> or some variant."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1493981132, "post_id": 43802828, "comment_id": 74645029, "body": "Do you want to compare the fourth element with the result of the second comparison, and so on, so that the final result is just one element?"}, {"owner": {"reputation": 922, "user_id": 2923589, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba91f50d535333744c2d5ddb1ce05412?s=128&d=identicon&r=PG&f=1", "display_name": "Tamas Koos", "link": "https://stackoverflow.com/users/2923589/tamas-koos"}, "edited": false, "score": 0, "creation_date": 1493981229, "post_id": 43802828, "comment_id": 74645071, "body": "Yes. That is exactly what I want to do."}], "answers": [{"tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 1, "last_activity_date": 1493982196, "creation_date": 1493982196, "answer_id": 43803335, "question_id": 43802828, "link": "https://stackoverflow.com/questions/43802828/function-on-previous-result/43803335#43803335", "title": "Function on previous result", "body": "<blockquote>\n  <p>have a function that a should run on a list. First, I have to compare the first two elements in the list with the function, then compare the third element with the result of the first comparison and so on, so that the result is just one element.</p>\n</blockquote>\n\n<p>IIUC, that is exactly what <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-List.html#v:foldl1\" rel=\"nofollow noreferrer\"><code>foldl1</code></a> does. E.g., if \"comparison\" is difference, then</p>\n\n<pre><code>Prelude Data.List&gt; let l = [1, 2, 3]\nPrelude Data.List&gt; foldl1 (-) l\n-4\n</code></pre>\n\n<p>\"compares\" 1 and 2, then \"compares\" the result with 3, so it is <em>1 - 2 - 3 = -4</em>.</p>\n"}], "owner": {"reputation": 922, "user_id": 2923589, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba91f50d535333744c2d5ddb1ce05412?s=128&d=identicon&r=PG&f=1", "display_name": "Tamas Koos", "link": "https://stackoverflow.com/users/2923589/tamas-koos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 43803335, "answer_count": 1, "score": 1, "last_activity_date": 1493982196, "creation_date": 1493980707, "last_edit_date": 1493981565, "question_id": 43802828, "link": "https://stackoverflow.com/questions/43802828/function-on-previous-result", "title": "Function on previous result", "body": "<p>I have  a function that a should run on a list. First, I have to compare the first two elements in the list  with the function, then compare the third element with the result of the first comparison and so on, so that the result is just one element. I feel like I should use iterate, but I couldn't make it work. How can I do this?</p>\n\n<pre><code>combineOption :: Cell -&gt; Cell -&gt; Cell\ncombineOption 'f' 'f' = 'f'\ncombineOption 'e' 'e' = 'e'\ncombineOption _ _ = 'u'\n\ncombineRow :: [Cell] -&gt; [Cell] -&gt; [Cell]\ncombineRow [] [] = []\ncombineRow l k = [ combineOption (l !! i) (k !! i) | i &lt;- [0..(length(l)-1)] ]\n\ncombineLineOptions :: [[Cell]] -&gt; [Cell]\ncombineLineOptions l = iterate ...                         &lt;==================\n</code></pre>\n\n<p>where type Cell     = Char</p>\n"}, {"tags": ["multithreading", "haskell", "channel"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1493974914, "post_id": 43800560, "comment_id": 74641078, "body": "Maybe wrap your data in another type, e.g. <code>data Message a = WorkPackage a | Done</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": true, "score": 3, "last_activity_date": 1493981336, "creation_date": 1493981336, "answer_id": 43803040, "question_id": 43800560, "link": "https://stackoverflow.com/questions/43800560/how-to-stop-threads-once-there-is-no-more-data-in-chan-to-process/43803040#43803040", "title": "How to stop threads, once there is no more data in Chan to process?", "body": "<p>You can design your channel on base <code>Chan</code> like this:</p>\n\n<pre><code>newtype MChan a = MChan (Chan (Maybe a))\n\nnewMChan :: IO (MChan a)\nnewMChan = MChan &lt;$&gt; newChan\n\ncloseMChan :: MChan a -&gt; IO ()\ncloseMChan (MChan c) = writeChan c Nothing\n\nwriteMChan :: MChan a -&gt; a -&gt; IO ()\nwriteMChan (MChan c) = writeChan c . Just\n\nreadMChan :: MChan a -&gt; IO (Maybe a)\nreadMChan (MChan c) = readChan c\n</code></pre>\n\n<p>So, you can close channel and consumer will be get Nothing and it will be signal for stop thread.</p>\n"}], "owner": {"reputation": 5861, "user_id": 3042117, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ec10c58136fc12bf83fe45001d672?s=128&d=identicon&r=PG", "display_name": "Iter Ator", "link": "https://stackoverflow.com/users/3042117/iter-ator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 43803040, "answer_count": 1, "score": 1, "last_activity_date": 1493981336, "creation_date": 1493974419, "last_edit_date": 1493976445, "question_id": 43800560, "link": "https://stackoverflow.com/questions/43800560/how-to-stop-threads-once-there-is-no-more-data-in-chan-to-process", "title": "How to stop threads, once there is no more data in Chan to process?", "body": "<p>I would like to use <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Concurrent-Chan.html\" rel=\"nofollow noreferrer\">Control.Concurrent.Chan</a>. There is a large list, which is split up into smaller lists by the provider. It writes this chunks to the channel. Then the consumers read these chunks from the channel and process them.</p>\n\n<p>How is it possible to close the forks and return the result, once there is no more data to provide and consume?</p>\n\n<p>With <code>TChan</code> it is possible to check if the channel is empty. But I would like to learn, how to use simple <code>Chan</code></p>\n\n<p>Most of the example codes I find simply uses <code>forever $ getLine ...</code>, and start it from main, where it is not an issue, if a fork is not finished, because once the main ends, the forks will also end. I haven't found a good consumer-provider example yet, from which I could understand, how to work with Chans</p>\n"}, {"tags": ["string", "algorithm", "haskell", "functional-programming", "string-algorithm"], "comments": [{"owner": {"reputation": 3946, "user_id": 1261166, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vL1Ud.jpg?s=128&g=1", "display_name": "Viktor Mellgren", "link": "https://stackoverflow.com/users/1261166/viktor-mellgren"}, "edited": false, "score": 0, "creation_date": 1493984799, "post_id": 43800468, "comment_id": 74647286, "body": "Can you reproduce the issue with a smaller test case?"}, {"owner": {"reputation": 11, "user_id": 7967699, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153258285921656/picture?type=large", "display_name": "Fredrik Nyberg", "link": "https://stackoverflow.com/users/7967699/fredrik-nyberg"}, "reply_to_user": {"reputation": 3946, "user_id": 1261166, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vL1Ud.jpg?s=128&g=1", "display_name": "Viktor Mellgren", "link": "https://stackoverflow.com/users/1261166/viktor-mellgren"}, "edited": false, "score": 0, "creation_date": 1493988745, "post_id": 43800468, "comment_id": 74649878, "body": "I solved it now. The issue was that I tried to apply similarityScore to the list. If I instead do <code>code maximaBy (uncurry totalScore) $match++xSpacematch++ySpacematch </code> it works"}, {"owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "edited": false, "score": 0, "creation_date": 1493994168, "post_id": 43800468, "comment_id": 74653819, "body": "Put this one up to CodeReview.SE. E.g. <code>map (uncurry f) (zip x y)</code> should be <code>zipWith f x y</code>."}], "owner": {"reputation": 11, "user_id": 7967699, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153258285921656/picture?type=large", "display_name": "Fredrik Nyberg", "link": "https://stackoverflow.com/users/7967699/fredrik-nyberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 497, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1493990927, "creation_date": 1493974109, "last_edit_date": 1493990927, "question_id": 43800468, "link": "https://stackoverflow.com/questions/43800468/string-alignment-in-haskell", "title": "String Alignment in haskell", "body": "<p>I'm working on an assignment in Haskell.\nThe assignment is to give the optimal alignment of two strings given scores for word matches, misses and gap insertions. \nHere is our code so far. The first step is to make it work using brute force and later we will implement with memoization. However, we are stuck at the current spot. </p>\n\n<p>Our optAlignment function is not working properly. With the example input \n\"writers\" \"vintner\" the optimal alignments returned should be:</p>\n\n<pre><code>[(\"writ-ers\",\"vintner-\"), (\"wri-t-ers\",\"-vintner-\"), (\"wri-t-ers\",\"v-intner-\")]\n</code></pre>\n\n<p>but we get </p>\n\n<pre><code>[(\"writers\",\"vintner\"),(\"writ-ers\",\"vintner-\"),(\"writ-ers\",\"v-intner\"),(\"wri-ters\",\"v-intner\"),(\"wri-t-ers\",\"v-intner-\"),(\"writ-ers\",\"-vintner\"),(\"wri-ters\",\"-vintner\"),(\"wri-t-ers\",\"-vintner-\")]\n</code></pre>\n\n<p>So the correct alternatives are there but also a few more. We have made a function totalScore which shows that some of the alternatives we get are not optimal (obviously). But we have spent 2 hours now trying to figure it out but have made no progress. The code also takes several minutes to run which makes it kinda hard to bug check.</p>\n\n<p>So we would really like some help with figuring out which parts are wrong in our code.</p>\n\n<pre><code>-- String Alignment assignment\n\nscoreMatch = 0\nscoreMismatch = -1\nscoreSpace = -1\n\ntype AlignmentType = (String,String)\n\noptAlignments :: String -&gt; String -&gt; [AlignmentType]\noptAlignments [][] = [(\"\",\"\")]\noptAlignments (x:xs) [] = attachHeads x '-' (optAlignments xs \"\")\noptAlignments [] (y:ys) = attachHeads '-' y (optAlignments \"\" ys)\noptAlignments (x:xs) (y:ys) = maximaBy (uncurry similarityScore) $match++xSpacematch++ySpacematch\n    where match = attachHeads x y $optAlignments xs ys\n          xSpacematch = attachHeads x '-' $optAlignments xs (y:ys)\n          ySpacematch = attachHeads '-' y $optAlignments (x:xs) ys\n\n\n\nsimilarityScore :: String -&gt; String -&gt; Int\nsimilarityScore [][] = 0\nsimilarityScore xs [] = scoreSpace * length xs\nsimilarityScore [] ys = scoreSpace * length ys\nsimilarityScore (x:xs) (y:ys) = max match $max xSpacematch ySpacematch\n    where match = similarityScore xs ys + score x y\n          xSpacematch = similarityScore xs (y:ys) + score x '-'\n          ySpacematch = similarityScore (x:xs) ys + score '-' y\n\n\n\nscore :: Char -&gt; Char -&gt; Int  \nscore x '-' = scoreSpace\nscore '-' y = scoreSpace\nscore x y\n    | x == y = scoreMatch\n    | otherwise = scoreMismatch\n\n-- attachHeads functions attaches the two arguments to the front of each list in the tuple\nattachHeads :: a -&gt; a -&gt; [([a],[a])] -&gt; [([a],[a])] \nattachHeads h1 h2 aList = [(h1:xs,h2:ys) | (xs,ys) &lt;- aList]\n\nmaximaBy :: Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a] \nmaximaBy valueFcn xs = [a| a &lt;- xs, valueFcn a == maxVal ] \n    where maxVal = maximum $map valueFcn xs\n\ntotalScore x y = sum $map (uncurry score) (zip x y)\n--map (uncurry totalScore)\n\n--outputOptAlignments string1 string2\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1493981190, "post_id": 43800363, "comment_id": 74645051, "body": "What is your question."}, {"owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1493981321, "post_id": 43800363, "comment_id": 74645118, "body": "something in the Code was wrong so i get an error. how i can write another coder or what have i to Change in this ode so i get what i want to?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1493989402, "post_id": 43800363, "comment_id": 74650325, "body": "Start by writing the type for <code>f2</code>"}, {"owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "edited": false, "score": 0, "creation_date": 1493990403, "post_id": 43800363, "comment_id": 74650995, "body": "My probelm was with this &quot;elem&quot; I have to us for this Code. How I use elem and can append a string before the string where this question mark was?"}, {"owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "edited": false, "score": 0, "creation_date": 1494154774, "post_id": 43800363, "comment_id": 74698480, "body": "I know, i only want to know how I can use it, an example that I can see what i made wrong."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "edited": false, "score": 0, "creation_date": 1493995875, "post_id": 43807777, "comment_id": 74654958, "body": "Thanks a lot :)) I understans everything you explai here"}], "tags": [], "owner": {"reputation": 1131, "user_id": 7189154, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/10210252620692683/picture?type=large", "display_name": "Sylvain Attoumani", "link": "https://stackoverflow.com/users/7189154/sylvain-attoumani"}, "is_accepted": true, "score": 0, "last_activity_date": 1493995226, "creation_date": 1493995226, "answer_id": 43807777, "question_id": 43800363, "link": "https://stackoverflow.com/questions/43800363/can-i-use-lookup-for-elem-in-a-list-full-strings/43807777#43807777", "title": "Can I use lookup for elem in a list full strings", "body": "<p>First of all you put an empty argument to your function.</p>\n\n<p>Then you don't have to write if(smthg == true) but just if(smthg). </p>\n\n<p>Then you have to use recursivity. Write [\"F :\" ++ x] (x bing a [char] use ++ instead of ':' ) </p>\n\n<p>you concat that with recursive (f2(xs)). Finally f2 [] = [] when you finish your list</p>\n\n<pre><code>import Data.Char\n\ndata StringList = NilSL\n    | ConsSL String StringList\n\nf2 [] = []\nf2 (x:xs) = if elem '?' x then [\"F:\" ++ x] : f2 (xs) else [x] : f2 (xs)\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7912261, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5585c0760c84cb22c42eb568d96f084b?s=128&d=identicon&r=PG&f=1", "display_name": "Tikotakatok", "link": "https://stackoverflow.com/users/7912261/tikotakatok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 43807777, "answer_count": 1, "score": -3, "last_activity_date": 1493995226, "creation_date": 1493973799, "question_id": 43800363, "link": "https://stackoverflow.com/questions/43800363/can-i-use-lookup-for-elem-in-a-list-full-strings", "title": "Can I use lookup for elem in a list full strings", "body": "<p>A function that receives a list of strings and any string that contains a question mark, appends the string of : For example to [ \"1 1?\",\"2.\",\"ab?\",\"c.\"] result [\"F:1 1?\",\"2.\",\"F:ab?\",\"c.\" \"] are calculated.</p>\n\n<pre><code>    import Data.Char\n\n    data StringList = NilSL\n            | ConsSL String StringList\n\n    f2 [] = if elem \"?\" [] == True then \"F:\" : [] else False\n</code></pre>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1493972943, "post_id": 43800007, "comment_id": 74639875, "body": "<code>renderPage :: String -&gt; IO String</code>"}, {"owner": {"reputation": 4001, "user_id": 1668057, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/FxrbB.jpg?s=128&g=1", "display_name": "ljs.dev", "link": "https://stackoverflow.com/users/1668057/ljs-dev"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1493973101, "post_id": 43800007, "comment_id": 74639975, "body": "no such luck <code>Expected type: String Actual type: IO String</code>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1493973148, "post_id": 43800007, "comment_id": 74639999, "body": "You removed the most important part of the error message: The file name / line number. Where does the new error occur?"}, {"owner": {"reputation": 4001, "user_id": 1668057, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/FxrbB.jpg?s=128&g=1", "display_name": "ljs.dev", "link": "https://stackoverflow.com/users/1668057/ljs-dev"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1493973231, "post_id": 43800007, "comment_id": 74640044, "body": "ah, I see<code>Main.hs:222:29 linesOfText = lines pageOutput </code>  Would you like to change comment to answer so I may accept?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1493973289, "post_id": 43800007, "comment_id": 74640078, "body": "That probably means you wrote <code>let pageOutput = renderPage url</code> instead of <code>pageOutput &lt;- renderPage url</code>."}, {"owner": {"reputation": 4001, "user_id": 1668057, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/FxrbB.jpg?s=128&g=1", "display_name": "ljs.dev", "link": "https://stackoverflow.com/users/1668057/ljs-dev"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1493973696, "post_id": 43800007, "comment_id": 74640338, "body": "I&#39;ve tried it in a few places over the past week, but that func dec should keep me moving on, thanks! btw, the <code>vty &lt;- ask </code> line within <code>do</code> seems to prevent me from placing the <code>pageOutput &lt;- renderPage url</code>, but I&#39;ll continue digging that on my own or place another question when I get stuck"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1493973881, "post_id": 43800007, "comment_id": 74640443, "body": "<code>ask</code> sounds like you&#39;re in some kind of <code>ReaderT</code> environment. It&#39;s possible <code>pageOutput &lt;- liftIO (renderPage url)</code> will work."}], "answers": [{"comments": [{"owner": {"reputation": 4001, "user_id": 1668057, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/FxrbB.jpg?s=128&g=1", "display_name": "ljs.dev", "link": "https://stackoverflow.com/users/1668057/ljs-dev"}, "edited": false, "score": 0, "creation_date": 1493975424, "post_id": 43800441, "comment_id": 74641382, "body": "Sincere thanks for the answer/comments. It&#39;s both daunting and fun to take on Haskell as a n00b. I didn&#39;t have the confidence to write this question a week ago."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 4001, "user_id": 1668057, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/FxrbB.jpg?s=128&g=1", "display_name": "ljs.dev", "link": "https://stackoverflow.com/users/1668057/ljs-dev"}, "edited": false, "score": 1, "creation_date": 1493975948, "post_id": 43800441, "comment_id": 74641709, "body": "@LeonStafford: GIT GUD! Err, I mean, you&#39;re welcome. There&#39;s usually no harm in asking a question, as long as it&#39;s complete. By the way, <code>ask</code> has usually the type <code>Monad m =&gt; ReaderT r m r</code>, so you need to transform <code>ReaderT r IO a</code> back to <code>IO a</code>. That&#39;s usually done with <code>runReaderT</code>. But feel free to ask another question."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 3, "last_activity_date": 1493974863, "last_edit_date": 1493974863, "creation_date": 1493974038, "answer_id": 43800441, "question_id": 43800007, "link": "https://stackoverflow.com/questions/43800007/convert-function-which-putstrlnd-to-return-string/43800441#43800441", "title": "Convert function which putStrLn&#39;d to return string", "body": "<p>The nice thing about Haskell is that you can do that step by step, mostly without fearing that you get completely different behaviour. First of all, we move the content of <code>main</code> into a new function:</p>\n\n<pre><code>renderPage :: IO ()\nrenderPage = do\n    response &lt;- simpleHttp \"https://leonstafford.github.io\"\n\n    let body = decodeUtf8 ( response )\n    let bodyAsString = unpack ( body )\n\n    putStrLn $ htmlToPlainText bodyAsString\n\n\nmain :: IO ()\nmain = renderPage\n</code></pre>\n\n<p>Next, we add the <code>url</code> as argument:</p>\n\n<pre><code>renderPage :: String -&gt; IO ()\nrenderPage url = do\n    response &lt;- simpleHttp url\n\n    let body = decodeUtf8 ( response )\n    let bodyAsString = unpack ( body )\n\n    putStrLn $ htmlToPlainText bodyAsString\n\nmain :: IO ()\nmain = renderPage \"https://leonstafford.github.io\"\n</code></pre>\n\n<p>And last, but not least, we move <code>putStrLn</code> into <code>main</code> and use <code>return</code> in <code>renderPage</code>:</p>\n\n<pre><code>renderPage :: String -&gt; IO String\nrenderPage url = do\n    response &lt;- simpleHttp url\n\n    let body = decodeUtf8 ( response )\n    let bodyAsString = unpack ( body )\n\n    return $ htmlToPlainText bodyAsString\n\nmain :: IO ()\nmain = renderPage \"https://leonstafford.github.io\" &gt;&gt;= putStrLn\n</code></pre>\n\n<p>Those steps (move into new function, add arguments, move functionality out) were pretty small. So when you encounter a problem like this, don't be afraid to do some inbetween steps.</p>\n\n<p>Note that <code>IO</code> always stays with <code>renderPage</code>, since <code>simpleHttp</code> uses <code>IO</code>. There is no way to get rid of <code>IO</code> once you have it somewhere in a function. But the functionality of <code>renderPage</code> can be re-used, since</p>\n\n<pre><code>renderPage :: String -&gt; IO String\nrenderPage = fmap (htmlToPlainText . unpack . decodeUtf8) . simpleHttp\n</code></pre>\n\n<p>and therefore:</p>\n\n<pre><code>utf8ToPlainText :: ByteString -&gt; String\nutf8ToPlainText = htmlToPlainText . unpack . decodeUtf8\n\nrenderPage :: String -&gt; IO String\nrenderPage = fmap utf8ToPlainText . simpleHttp\n</code></pre>\n"}], "owner": {"reputation": 4001, "user_id": 1668057, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/FxrbB.jpg?s=128&g=1", "display_name": "ljs.dev", "link": "https://stackoverflow.com/users/1668057/ljs-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493974863, "creation_date": 1493972536, "last_edit_date": 1493973110, "question_id": 43800007, "link": "https://stackoverflow.com/questions/43800007/convert-function-which-putstrlnd-to-return-string", "title": "Convert function which putStrLn&#39;d to return string", "body": "<p>In a <a href=\"https://github.com/leonstafford/pandoctest/blob/master/Main.hs\" rel=\"nofollow noreferrer\">standalone working script</a>, I have a function returning <code>IO ()</code> as such:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    response &lt;- simpleHttp \"https://leonstafford.github.io\"\n\n    let body = decodeUtf8 ( response )\n    let bodyAsString = unpack ( body )\n\n    putStrLn $ htmlToPlainText bodyAsString\n</code></pre>\n\n<p>I'm now trying to utilise same function in <a href=\"https://github.com/leonstafford/cli-rss-reader/blob/feature/pandoc-render-article/Main.hs\" rel=\"nofollow noreferrer\">this existing script</a>, but struggling with the common <code>Couldn't match type \u2018[Char]\u2019 with \u2018Char\u2019</code>:</p>\n\n<pre><code>renderPage :: String -&gt; String\nrenderPage url = do\n    response &lt;- simpleHttp url\n\n    let body = decodeUtf8 ( response )\n        bodyAsString = unpack ( body )\n        articleAsPlainText = htmlToPlainText bodyAsString\n    return articleAsPlainText\n</code></pre>\n\n<p>I have been fiddling with it off and on for about a week and hope I've been able to define the issue enough in the title, so as it may not be yet another <code>can't match expected types</code> post, though am pretty sure it is just that. </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 5, "last_activity_date": 1493949309, "creation_date": 1493949309, "answer_id": 43795287, "question_id": 43795264, "link": "https://stackoverflow.com/questions/43795264/non-type-variable-argument-when-checking-the-inferred-type-in-haskell/43795287#43795287", "title": "Non type-variable argument when checking the inferred type in Haskell", "body": "<p>It shouldn't be possible that when you call a function with two different arguments <em>of the same type</em> one will raise a <em>type</em> error and the other will pass.  So something else is going on here.</p>\n\n<p>In particular, </p>\n\n<pre><code>myDrop -2 [1,2,3]\n</code></pre>\n\n<p>isn't interpreted the way you expect.   It's interpreted like this</p>\n\n<pre><code>myDrop - (2 [1,2,3])\n</code></pre>\n\n<p>that is, subtracting the number <code>2</code> called (as a function) with the list <code>[1,2,3]</code> as its argument from <code>myDrop</code>.  In other words, utter nonsense.  That's why the type error is so weird looking.</p>\n\n<p>In Haskell negative constants require parentheses:</p>\n\n<pre><code>myDrop (-2) [1,2,3]\n</code></pre>\n"}], "owner": {"reputation": 4406, "user_id": 3741571, "user_type": "registered", "accept_rate": 2, "profile_image": "https://i.stack.imgur.com/0WXuV.jpg?s=128&g=1", "display_name": "chenzhongpu", "link": "https://stackoverflow.com/users/3741571/chenzhongpu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1493949309, "creation_date": 1493949128, "question_id": 43795264, "link": "https://stackoverflow.com/questions/43795264/non-type-variable-argument-when-checking-the-inferred-type-in-haskell", "title": "Non type-variable argument when checking the inferred type in Haskell", "body": "<p>I am new to Haskell. I implement the <code>drop</code> on my own.</p>\n\n<pre><code>myDrop n xs = if n &lt;= 0 || null xs\n              then xs\n              else myDrop (n - 1) (tail xs)\n</code></pre>\n\n<p>But I call it when <code>n &lt; 0</code>, for example, <code>myDrop -2 [1, 2, 3]</code>. It will raise an error:</p>\n\n<pre><code>&lt;interactive&gt;:23:1: error:\n    \u2022 Non type-variable argument\n        in the constraint: Num ([t] -&gt; t1 -&gt; [a] -&gt; [a])\n      (Use FlexibleContexts to permit this)\n    \u2022 When checking the inferred type\n        it :: forall t a t1.\n              (Num ([t] -&gt; t1 -&gt; [a] -&gt; [a]), Num (t1 -&gt; [a] -&gt; [a]), Num t,\n               Num t1, Ord t1) =&gt;\n              t1 -&gt; [a] -&gt; [a]\n</code></pre>\n"}, {"tags": ["haskell", "compilation", "linker", "ghc"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 1, "creation_date": 1493942808, "post_id": 43794488, "comment_id": 74629740, "body": "<a href=\"https://downloads.haskell.org/~ghc/7.0.3/docs/html/users_guide/separate-compilation.html#id532516\" rel=\"nofollow noreferrer\">This</a> may be the flag you&#39;re looking for."}, {"owner": {"reputation": 180, "user_id": 4096377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/obCZ2.jpg?s=128&g=1", "display_name": "Culex", "link": "https://stackoverflow.com/users/4096377/culex"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1493943602, "post_id": 43794488, "comment_id": 74629913, "body": "That is useful, but not what I&#39;m looking for. The files still get autodeleted when using the tmpdir flag. The main thing I&#39;m looking for is more insight to the origin of the ghc_1.c file (of course, evaluation of its contents might yield some clues. I&#39;ll try and disallow file deletion within the tmpdir sometime soon here)"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1493944181, "post_id": 43794488, "comment_id": 74630031, "body": "Have you tried ignoring them?  I&#39;m linking a project manually (albeit embedded -- so I wrote my own main in C++) and it&#39;s working fine, I haven&#39;t had to worry about this tmp stuff."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1493945785, "post_id": 43794488, "comment_id": 74630425, "body": "@Culex I think you are looking at the wrong flag - you probably want <code>-keep-tmp-files</code>, which, as the flag name would imply, will cause GHC to not delete temporary files. You can redirect them as well, but that is a seperate concern."}, {"owner": {"reputation": 180, "user_id": 4096377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/obCZ2.jpg?s=128&g=1", "display_name": "Culex", "link": "https://stackoverflow.com/users/4096377/culex"}, "edited": false, "score": 0, "creation_date": 1494603471, "post_id": 43794488, "comment_id": 74915499, "body": "Thanks so much for the helpful input! I can manage linking manually, and I will be using the <code>-keep-tmp-files</code> flag to examine file contents eventually here. I am still curious about the nature of the files though. I&#39;ll edit the question to clarify that."}], "owner": {"reputation": 180, "user_id": 4096377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/obCZ2.jpg?s=128&g=1", "display_name": "Culex", "link": "https://stackoverflow.com/users/4096377/culex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1493944103, "creation_date": 1493942348, "last_edit_date": 1493944103, "question_id": 43794488, "link": "https://stackoverflow.com/questions/43794488/purpose-and-origin-of-temporary-o-files-generated-by-ghc", "title": "Purpose and origin of temporary .o files generated by GHC", "body": "<p>As a part of developing my understanding of GHC, I would like to be able manually link GHC generated assembly against the GHC rts  (and other necessary libraries) to produce a runnable file.<br>\nSpecifically...<br>\nI have a file <code>helloworld.hs</code> whose contents are simply</p>\n\n<pre><code>main = putStrLn \"Hello, World! again\"\n</code></pre>\n\n<p>If I run <code>ghc -c -o helloworld.o  helloworld.hs</code> to generate assembly.\nI would like to know how to manually link <code>helloworld.o</code><br>\nIf I run <code>ghc -o runnable helloworld.o -v3</code> to see how ghc accomplishes this (with verbose output) I see this.</p>\n\n<pre><code>Glasgow Haskell Compiler, Version 7.10.3, stage 2 booted by GHC version 7.10.3\nUsing binary package database: /usr/lib/ghc/package.conf.d/package.cache\nwired-in package ghc-prim mapped to ghc-prim-0.4.0.0-6cdc86811872333585fa98756aa7c51e\nwired-in package integer-gmp mapped to integer-gmp-1.0.0.0-3c8c40657a9870f5c33be17496806d8d\nwired-in package base mapped to base-4.8.2.0-0d6d1084fbc041e1cded9228e80e264d\nwired-in package rts mapped to builtin_rts\nwired-in package template-haskell mapped to template-haskell-2.10.0.0-3c4cb52230f347282af9b2817f013181\nwired-in package ghc mapped to ghc-7.10.3-624693c6aa854116c707bc7b4d0d7cb6\nwired-in package dph-seq not found.\nwired-in package dph-par not found.\nHsc static flags: \nCreated temporary directory: /tmp/ghc54ce_0\n*** C Compiler:\n/usr/bin/gcc -fno-stack-protector -DTABLES_NEXT_TO_CODE -c /tmp/ghc54ce_0/ghc_1.c -o /tmp/ghc54ce_0/ghc_2.o -I/usr/lib/ghc/include\n*** C Compiler:\n/usr/bin/gcc -fno-stack-protector -DTABLES_NEXT_TO_CODE -c /tmp/ghc54ce_0/ghc_4.s -o /tmp/ghc54ce_0/ghc_5.o -I/usr/lib/ghc/include\n*** Linker:\n/usr/bin/gcc -fno-stack-protector -DTABLES_NEXT_TO_CODE '-Wl,--hash-size=31' -Wl,--reduce-memory-overheads -Wl,--no-as-needed -o final helloworld.o -L/usr/lib/ghc/base_HQfYBxpPvuw8OunzQu6JGM -L/usr/lib/ghc/integ_2aU3IZNMF9a7mQ0OzsZ0dS -L/usr/lib/ghc/ghcpr_8TmvWUcS1U1IKHT0levwg3 -L/usr/lib/ghc/rts /tmp/ghc54ce_0/ghc_2.o /tmp/ghc54ce_0/ghc_5.o -Wl,-u,ghczmprim_GHCziTypes_Izh_static_info -Wl,-u,ghczmprim_GHCziTypes_Czh_static_info -Wl,-u,ghczmprim_GHCziTypes_Fzh_static_info -Wl,-u,ghczmprim_GHCziTypes_Dzh_static_info -Wl,-u,base_GHCziPtr_Ptr_static_info -Wl,-u,ghczmprim_GHCziTypes_Wzh_static_info -Wl,-u,base_GHCziInt_I8zh_static_info -Wl,-u,base_GHCziInt_I16zh_static_info -Wl,-u,base_GHCziInt_I32zh_static_info -Wl,-u,base_GHCziInt_I64zh_static_info -Wl,-u,base_GHCziWord_W8zh_static_info -Wl,-u,base_GHCziWord_W16zh_static_info -Wl,-u,base_GHCziWord_W32zh_static_info -Wl,-u,base_GHCziWord_W64zh_static_info -Wl,-u,base_GHCziStable_StablePtr_static_info -Wl,-u,ghczmprim_GHCziTypes_Izh_con_info -Wl,-u,ghczmprim_GHCziTypes_Czh_con_info -Wl,-u,ghczmprim_GHCziTypes_Fzh_con_info -Wl,-u,ghczmprim_GHCziTypes_Dzh_con_info -Wl,-u,base_GHCziPtr_Ptr_con_info -Wl,-u,base_GHCziPtr_FunPtr_con_info -Wl,-u,base_GHCziStable_StablePtr_con_info -Wl,-u,ghczmprim_GHCziTypes_False_closure -Wl,-u,ghczmprim_GHCziTypes_True_closure -Wl,-u,base_GHCziPack_unpackCString_closure -Wl,-u,base_GHCziIOziException_stackOverflow_closure -Wl,-u,base_GHCziIOziException_heapOverflow_closure -Wl,-u,base_ControlziExceptionziBase_nonTermination_closure -Wl,-u,base_GHCziIOziException_blockedIndefinitelyOnMVar_closure -Wl,-u,base_GHCziIOziException_blockedIndefinitelyOnSTM_closure -Wl,-u,base_GHCziIOziException_allocationLimitExceeded_closure -Wl,-u,base_ControlziExceptionziBase_nestedAtomically_closure -Wl,-u,base_GHCziEventziThread_blockedOnBadFD_closure -Wl,-u,base_GHCziWeak_runFinalizzerBatch_closure -Wl,-u,base_GHCziTopHandler_flushStdHandles_closure -Wl,-u,base_GHCziTopHandler_runIO_closure -Wl,-u,base_GHCziTopHandler_runNonIO_closure -Wl,-u,base_GHCziConcziIO_ensureIOManagerIsRunning_closure -Wl,-u,base_GHCziConcziIO_ioManagerCapabilitiesChanged_closure -Wl,-u,base_GHCziConcziSync_runSparks_closure -Wl,-u,base_GHCziConcziSignal_runHandlersPtr_closure -lHSbase-4.8.2.0-HQfYBxpPvuw8OunzQu6JGM -lHSinteger-gmp-1.0.0.0-2aU3IZNMF9a7mQ0OzsZ0dS -lHSghc-prim-0.4.0.0-8TmvWUcS1U1IKHT0levwg3 -lHSrts -lgmp -lm -lrt -ldl -lffi\n*** Deleting temp files:\nDeleting: /tmp/ghc54ce_0/ghc_7.rsp /tmp/ghc54ce_0/ghc_6.rsp /tmp/ghc54ce_0/ghc_5.o /tmp/ghc54ce_0/ghc_4.s /tmp/ghc54ce_0/ghc_3.rsp /tmp/ghc54ce_0/ghc_2.o /tmp/ghc54ce_0/ghc_1.c\n*** Deleting temp dirs:\nDeleting: /tmp/ghc54ce_0\n</code></pre>\n\n<p>I cannot simply use a similar call to gcc to link helloworld.o myself. If you look at the output above, gcc actually creates <code>/tmp/ghc54ce_0</code> which ends up holding seven different temporary files. Two of these files are object files that the code is linked against.<br>\nI'm having a hard time finding where the initial <code>/tmp/ghc54ce_0/ghc_1.c</code> is coming from. I'm also curious why this part of the process is necessary (i.e. what is being generated that could not be contained in a static library that isn't already in helloworld.o).<br>\nAny direct information, or good leads on where to find answers would be appreciated!</p>\n"}, {"tags": ["list", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1493927527, "post_id": 43791675, "comment_id": 74623957, "body": "What do you mean with&quot;sit between 127 and 32&quot;. What should happen if it is <i>not between</i> these bounds?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1493927564, "post_id": 43791675, "comment_id": 74623981, "body": "Let n=253, and observe that your first clause doesn&#39;t appear to do what you want. There are similar problems with the second clause. Why are you adding 32?"}, {"owner": {"reputation": 91, "user_id": 4834795, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/qA5rx.jpg?s=128&g=1", "display_name": "Ben Moore", "link": "https://stackoverflow.com/users/4834795/ben-moore"}, "edited": false, "score": 1, "creation_date": 1493927643, "post_id": 43791675, "comment_id": 74624039, "body": "If it&#39;s not between these bounds I want it to loop back around, so if the int is 128 I want it to be 32 and if the int is 31 i want it to be 127."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1493927744, "post_id": 43791675, "comment_id": 74624101, "body": "Your algorithm is wrong.  The mod should be by the width of the window, not the maximum value.   <code>result = input `mod` window + minimum where window = maximum - mimimum</code>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 5, "creation_date": 1493927848, "post_id": 43791675, "comment_id": 74624159, "body": "(Meta suggestion: in future questions, don&#39;t say just &quot;it&#39;s not working&quot;. Tell us what you expect to happen, and how your results fail to match that, from the start.)"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1493928665, "last_edit_date": 1493928665, "creation_date": 1493927818, "answer_id": 43791783, "question_id": 43791675, "link": "https://stackoverflow.com/questions/43791675/how-to-set-limits-on-each-individual-int/43791783#43791783", "title": "How to set limits on each individual Int", "body": "<p>Based on your comment, you want to transform <code>Int</code>s that are <em>not</em> in the 32-127 range by applying a modulo transformation. Therefore we can first implement a <code>helper</code> function:</p>\n\n<pre><code>helper x = 32 + mod (x-32) (128-32)\n</code></pre>\n\n<p>This results in:</p>\n\n<pre><code>Prelude&gt; helper 31\n127\nPrelude&gt; helper 32\n32\nPrelude&gt; helper 127\n127\nPrelude&gt; helper 128\n32\n</code></pre>\n\n<p>Next our function <code>limitList</code> is only a <code>map</code>ping with that helper:</p>\n\n<pre><code>limitList = map helper\n    where helper x = 32 + mod (x-32) (128-32)\n</code></pre>\n\n<p>This generates:</p>\n\n<pre><code>Prelude&gt; limitList [1,4..256]\n[97,100,103,106,109,112,115,118,121,124,127,34,37,40,43,46,49,52,55,58,61,64,67,70,73,76,79,82,85,88,91,94,97,100,103,106,109,112,115,118,121,124,127,34,37,40,43,46,49,52,55,58,61,64,67,70,73,76,79,82,85,88,91,94,97,100,103,106,109,112,115,118,121,124,127,34,37,40,43,46,49,52,55,58,61,64]\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 4834795, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/qA5rx.jpg?s=128&g=1", "display_name": "Ben Moore", "link": "https://stackoverflow.com/users/4834795/ben-moore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 43791783, "answer_count": 1, "score": 2, "last_activity_date": 1493935168, "creation_date": 1493927394, "last_edit_date": 1493935168, "question_id": 43791675, "link": "https://stackoverflow.com/questions/43791675/how-to-set-limits-on-each-individual-int", "title": "How to set limits on each individual Int", "body": "<p>I'm trying to change a list of <code>Int</code>s in Haskell to make keep them within specific limits, but it doesn't seem to be working. I'm trying to make every int in the list sit between 32 and 127 but it's not working, could anyone explain why this isn't working?</p>\n\n<pre><code>limit :: Int -&gt; Int\nlimit n | n &gt; 127  = n `mod` 127 + 32\n        | n &lt; 32 = n  + 127 - 32\n        | otherwise = n\n\nlimitList :: [Int] -&gt; [Int]\nlimitList [] = []\nlimitList (x:xs) = [limit x] ++ limitList xs\n</code></pre>\n"}, {"tags": ["haskell", "monads", "read-eval-print-loop", "ghci"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1493924012, "post_id": 43790376, "comment_id": 74621919, "body": "Write a parser for your language and run your own REPL?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1493931609, "post_id": 43790376, "comment_id": 74626111, "body": "You certainly can&#39;t do this for arbitrary monads. What if the monad in question was <code>data Proxy a = Proxy</code>? What would you print when someone runs a <code>Proxy</code> computation at the prompt?"}, {"owner": {"reputation": 1413, "user_id": 235170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/008e1a809d4bfff794790c7cf51bcbba?s=128&d=identicon&r=PG", "display_name": "Andreas Vinter-Hviid", "link": "https://stackoverflow.com/users/235170/andreas-vinter-hviid"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1494161056, "post_id": 43790376, "comment_id": 74700162, "body": "@Zeta That is something I have thought about, but then it would no longer be an <i>embedded</i> DSL. Sometimes that is what you want, and I asked this question to see if it was possible to use an embedded DSL from the REPL."}], "answers": [{"tags": [], "owner": {"reputation": 8861, "user_id": 148260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567454e026a83d9ef6218474a720be7e?s=128&d=identicon&r=PG", "display_name": "Steve Trout", "link": "https://stackoverflow.com/users/148260/steve-trout"}, "is_accepted": true, "score": 3, "last_activity_date": 1493931030, "last_edit_date": 1493931030, "creation_date": 1493926575, "answer_id": 43791432, "question_id": 43790376, "link": "https://stackoverflow.com/questions/43790376/using-a-monadic-edsl-from-the-repl/43791432#43791432", "title": "Using a Monadic eDSL from the REPL", "body": "<p>To an extent.</p>\n\n<p>I don't believe it can be done for arbitrary Monads/instruction sets, but here's something that would work for your example. I'm using <a href=\"http://hackage.haskell.org/package/operational\" rel=\"nofollow noreferrer\">operational</a> with an IORef to back the REPL state.</p>\n\n<pre><code>data DSLInstruction a where\n    Push :: Int -&gt; DSLInstruction ()\n    Pop :: DSLInstruction Int\n\ntype DSL a = Program DSLInstruction a\n\npush :: Int -&gt; DSL ()\npush n = singleton (Push n)\n\npop :: DSL Int\npop = singleton Pop\n\n-- runDslState :: DSL a -&gt; State [Int] a\n-- runDslState = ...\n\nrunDslIO :: IORef [Int] -&gt; DSL a -&gt; IO a\nrunDslIO ref m = case view m of\n    Return a -&gt; return a\n    Push n :&gt;&gt;= k -&gt; do\n        modifyIORef ref (n :)\n        runDslIO ref (k ())\n    Pop :&gt;&gt;= k -&gt; do\n        n &lt;- atomicModifyIORef ref (\\(n : ns) -&gt; (ns, n))\n        runDslIO ref (k n)\n\nreplSession :: [Int] -&gt; IO (Int -&gt; IO (), IO Int)\nreplSession initial = do\n    ref &lt;- newIORef initial\n    let pushIO n = runDslIO ref (push n)\n        popIO = runDslIO ref pop\n    (pushIO, popIO)\n</code></pre>\n\n<p>Then you can use it like:</p>\n\n<pre><code>&gt; (push, pop) &lt;- replSession [] -- this shadows the DSL push/pop definitions\n&gt; push 10\n&gt; pop\n10\n&gt; push 100\n</code></pre>\n\n<p>It should be straightforward to use this technique for State/Reader/Writer/IO-based DSLs. I don't expect it to work for everything though.</p>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 5, "last_activity_date": 1493935058, "last_edit_date": 1493935058, "creation_date": 1493933105, "answer_id": 43793007, "question_id": 43790376, "link": "https://stackoverflow.com/questions/43790376/using-a-monadic-edsl-from-the-repl/43793007#43793007", "title": "Using a Monadic eDSL from the REPL", "body": "<p>Another possibility is to re-simulate the whole history each time you do anything.  This will work for any pure monad.  Here's an extemporaneous library for it:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\nimport Data.IORef\nimport Data.Proxy\n\nnewtype REPL m f = REPL { run :: forall a. m a -&gt; IO (f a) }\n\nnewREPL :: (Monad m) =&gt; Proxy m -&gt; (forall a. m a -&gt; f a) -&gt; IO (REPL m f)\nnewREPL _ runM = do\n    accum &lt;- newIORef (return ())\n    return $ REPL (\\nextAction -&gt; do\n        actions &lt;- readIORef accum\n        writeIORef accum (actions &gt;&gt; nextAction &gt;&gt; return ())\n        return (runM (actions &gt;&gt; nextAction)))\n</code></pre>\n\n<p>Basically, it stores all the actions run thus far in an <code>IORef</code>, and each time you do something it adds to the list of actions and runs it from the top. </p>\n\n<p>To create a repl, use <code>newREPL</code>, passing it a <code>Proxy</code> for the monad and a \"run\" function that gets you out of the monad.  The reason the run function has type <code>m a -&gt; f a</code> instead of <code>m a -&gt; a</code> is so that you can include extra information in the output -- for example, you might want to view the current state, too, in which case you could use an <code>f</code> like:</p>\n\n<pre><code>data StateOutput a = StateOutput a [Int]\n    deriving (Show)\n</code></pre>\n\n<p>But I have just used it with <a href=\"https://hackage.haskell.org/package/transformers-0.2.2.1/docs/Data-Functor-Identity.html\" rel=\"noreferrer\"><code>Identity</code></a> which does nothing special.</p>\n\n<p>The <code>Proxy</code> argument is so that ghci's defaulting doesn't bite us when we create a new repl instance. </p>\n\n<p>Here's how you use it:</p>\n\n<pre><code>&gt;&gt;&gt; repl &lt;- newREPL (Proxy :: Proxy DSL) (\\m -&gt; Identity (evalState m []))\n&gt;&gt;&gt; run repl $ push 1\nIdentity ()\n&gt;&gt;&gt; run repl $ push 2\nIdentity ()\n&gt;&gt;&gt; run repl $ pop\nIdentity 2\n&gt;&gt;&gt; run repl $ pop\nIdentity 1\n</code></pre>\n\n<p>If the extra <code>Identity</code> line noise bothers you, you could use your own functor:</p>\n\n<pre><code>newtype LineOutput a = LineOutput a\ninstance (Show a) =&gt; Show (LineOutput a) where\n    show (LineOutput x) = show x\n</code></pre>\n\n<p>There was one small change I had to make -- I had to change</p>\n\n<pre><code>type DSL a = State [Int] a\n</code></pre>\n\n<p>to</p>\n\n<pre><code>type DSL = State [Int]\n</code></pre>\n\n<p>because you can't use type synonyms that are not fully applied, like when I said <code>Proxy :: DSL</code>.  The latter, I think, is more idiomatic anyway.</p>\n"}], "owner": {"reputation": 1413, "user_id": 235170, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/008e1a809d4bfff794790c7cf51bcbba?s=128&d=identicon&r=PG", "display_name": "Andreas Vinter-Hviid", "link": "https://stackoverflow.com/users/235170/andreas-vinter-hviid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 1, "accepted_answer_id": 43791432, "answer_count": 2, "score": 5, "last_activity_date": 1493935058, "creation_date": 1493922838, "question_id": 43790376, "link": "https://stackoverflow.com/questions/43790376/using-a-monadic-edsl-from-the-repl", "title": "Using a Monadic eDSL from the REPL", "body": "<p>Say I have created myself an embedded domain specific language in Haskell using a monad. For example a simple language that lets you push and pop values on a stack, implemented using the state monad:</p>\n\n<pre><code>type DSL a = State [Int] a\n\npush :: Int -&gt; DSL ()\npop :: DSL Int\n</code></pre>\n\n<p>Now I can write small stack manipulation programs using do notation:</p>\n\n<pre><code>program = do\n    push 10\n    push 20\n    a &lt;- pop\n    push (5*a)\n    return a\n</code></pre>\n\n<p>However, I would really like to use my DSL interactively from a REPL (GHCi in particular, willing to use other if it would help).</p>\n\n<p>Unfortunately having a session like:</p>\n\n<pre><code>&gt;push 10\n&gt;pop\n10\n&gt;push 100\n</code></pre>\n\n<p>Does not immediately work, which is probably rather reasonable. However I really think being able to do something with a similar feel to that would be cool. The way the state monad work does not lend itself easily to this. You need to build up your <code>DSL a</code> type and then evaluate it.</p>\n\n<p>Is there a way to do something like this. Incrementally using a monad in the REPL?</p>\n\n<p>I have been looking at things like <a href=\"http://hackage.haskell.org/package/operational\" rel=\"noreferrer\">operational</a>, <a href=\"https://hackage.haskell.org/package/MonadPrompt\" rel=\"noreferrer\">MonadPrompt</a>, and <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Cont.html\" rel=\"noreferrer\">MonadCont</a> which I sort of get the feeling maybe could be used to do something like this. Unfortunately none of the examples I have seen addresses this particular problem.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1493920569, "post_id": 43789646, "comment_id": 74620038, "body": "the lsh package was commented out of the .cabal file. I removed the comment, and am faced with the same problem. Try doing a git pull to see change."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1493937020, "post_id": 43789646, "comment_id": 74628239, "body": "I don&#39;t know what&#39;s wrong here now. It&#39;s a mystery for me. But I noticed that you have double <code>packages</code> elements. Try remove both <code>packages</code> and add only this: <a href=\"http://lpaste.net/6027187186263130112\" rel=\"nofollow noreferrer\">lpaste.net/6027187186263130112</a> It finds <code>lsh</code> package now for me. Also don&#39;t forget to <code>stack clean</code> before, it may help sometimes."}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 5, "last_activity_date": 1575582408, "last_edit_date": 1575582408, "creation_date": 1493920217, "answer_id": 43789646, "question_id": 43789271, "link": "https://stackoverflow.com/questions/43789271/stack-yaml-not-pulling-in-dependency-from-github/43789646#43789646", "title": "stack.yaml not pulling in dependency from github", "body": "<p>The problem is syntax. You added some extra spaces before <code>extra-dep</code>. Place this in <code>stack.yaml</code>. With this, your project builds on my machine.</p>\n\n<pre><code>- location:\n    git: https://github.com/TwitterFriends/lsh.git\n    commit: 57d57f4209e56f526c0eca023907015935c26071\n  extra-dep: true\n</code></pre>\n\n<p><strong>UPDATE:</strong> <em>(17 Dec 2017)</em></p>\n\n<p>Since <code>stack-1.6.1</code> syntax of adding github dependency is changed. You need to add your github dependency into <code>extra-deps</code> field. Something like this:</p>\n\n<pre><code>resolver: lts-9.17\npackages: [.]\n\nextra-deps:\n- fmt-0.5.0.0\n- git: https://github.com/TwitterFriends/lsh.git\n  commit: 57d57f4209e56f526c0eca023907015935c26071\n</code></pre>\n\n<p><strong>UPDATE:</strong> <em>(5 Dec 2019)</em></p>\n\n<p>In <code>stack-2.1.3</code> you can specify GitHub dependencies in <code>extra-deps</code> with even shorter syntax:</p>\n\n<pre><code>extra-deps:\n- github: TwitterFriends/lsh\n  commit: 57d57f4209e56f526c0eca023907015935c26071\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1178, "user_id": 1667161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233658d12fabd9d72b04d0a6916f6389?s=128&d=identicon&r=PG", "display_name": "liminalisht", "link": "https://stackoverflow.com/users/1667161/liminalisht"}, "is_accepted": false, "score": 1, "last_activity_date": 1493945110, "creation_date": 1493945110, "answer_id": 43794807, "question_id": 43789271, "link": "https://stackoverflow.com/questions/43789271/stack-yaml-not-pulling-in-dependency-from-github/43794807#43794807", "title": "stack.yaml not pulling in dependency from github", "body": "<p>It looks like the problem you're facing is due to a syntax error in the lines in your <code>stack.yaml</code> file directly preceding those you posted in the question.</p>\n\n<p>When I visited your repo and checked out the whole <code>stack.yaml</code> file, I saw this:</p>\n\n<pre><code>resolver: lts-8.13\n\n# User packages to be built.\n# Various formats can be used as shown in the example below.\n# \npackages:\n\n# - https://example.com/foo/bar/baz-0.0.2.tar.gz\n- location:\n    git: https://github.com/TwitterFriends/lsh.git\n    commit: 57d57f4209e56f526c0eca023907015935c26071\n  extra-dep: true\n</code></pre>\n\n<p>This <code>packages:</code> line doesn't look right, especially given that later in the file you have:</p>\n\n<pre><code>packages:\n- '.'\n</code></pre>\n\n<p>So my best guess would be that the <code>stack.yaml</code> file isn't getting parsed correctly, so it can't find the library b/c it doesn't know it should grab it from that location.</p>\n"}], "owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 604, "favorite_count": 0, "accepted_answer_id": 43789646, "answer_count": 2, "score": 3, "last_activity_date": 1575582408, "creation_date": 1493918857, "question_id": 43789271, "link": "https://stackoverflow.com/questions/43789271/stack-yaml-not-pulling-in-dependency-from-github", "title": "stack.yaml not pulling in dependency from github", "body": "<p>Here's the stack.yaml stanza</p>\n\n<p>packages:</p>\n\n<pre><code>- location:\n   git: https://github.com/TwitterFriends/lsh.git\n   commit: 57d57f4209e56f526c0eca023907015935c26071\n   extra-dep: true\n</code></pre>\n\n<p>I add the package to cabal file</p>\n\n<p>get error when I try to build</p>\n\n<pre><code>While constructing the BuildPlan the following exceptions were encountered:\n\n--  While attempting to add dependency,\n    Could not find package lsh in known packages\n</code></pre>\n\n<p>What am I doing wrong?</p>\n\n<p>Current project found here</p>\n\n<p><a href=\"https://github.com/TwitterFriends/twitter-friend-server\" rel=\"nofollow noreferrer\">https://github.com/TwitterFriends/twitter-friend-server</a></p>\n"}, {"tags": ["haskell", "haskell-wai", "haskell-warp", "haskell-spock"], "answers": [{"tags": [], "owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "is_accepted": false, "score": 1, "last_activity_date": 1493924081, "creation_date": 1493924081, "answer_id": 43790756, "question_id": 43788127, "link": "https://stackoverflow.com/questions/43788127/creating-a-route-for-static-assets-or-images-in-hasekll-spock/43790756#43790756", "title": "Creating a route for static assets or images in Hasekll Spock", "body": "<p>Something I like to do is to use the <code>wai-middleware-static</code> middleware to serve a static directory :</p>\n\n<pre><code>app :: SpockM () MySession MyAppState ()\napp = do\n    middleware $ staticPolicy (addBase \"static\")\n    ...\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 7905648, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c376072a422d4c9983c0808f56ca8300?s=128&d=identicon&r=PG&f=1", "display_name": "user7905648", "link": "https://stackoverflow.com/users/7905648/user7905648"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493924081, "creation_date": 1493914708, "question_id": 43788127, "link": "https://stackoverflow.com/questions/43788127/creating-a-route-for-static-assets-or-images-in-hasekll-spock", "title": "Creating a route for static assets or images in Hasekll Spock", "body": "<p>I have this basic Spock application taken from its website:</p>\n\n<pre><code>main :: IO ()\nmain =\n    do ref &lt;- newIORef 0\n       spockCfg &lt;- defaultSpockCfg EmptySession PCNoDatabase (DummyAppState ref)\n       runSpock 8080 (spock spockCfg app)\n\napp :: SpockM () MySession MyAppState ()\napp =\n    do get root $\n           text \"Hello World!\"\n       get -- ??? route for \"/img/\"???\n</code></pre>\n\n<p>I have an html page which I can return like this:</p>\n\n<p>However, an html page contains a some \"img\" tags. How do I need to create a route so that the images resolves? Say, the images are location in the folder \"img\".</p>\n"}, {"tags": ["haskell", "proof", "induction"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1493914432, "post_id": 43787633, "comment_id": 74616554, "body": "List comprehensions are defined in terms of <code>filter</code> so you probably can&#39;t use them in the proof without resirting to circular reasoning. Where did your get your version of the definition? Try the &quot;official&quot; one found in  Hackage."}, {"owner": {"reputation": 1247, "user_id": 3485629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640b2583577ec470ac273b27f78025d5?s=128&d=identicon&r=PG", "display_name": "basile-henry", "link": "https://stackoverflow.com/users/3485629/basile-henry"}, "edited": false, "score": 1, "creation_date": 1493915155, "post_id": 43787633, "comment_id": 74616991, "body": "Here is the <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/src/GHC.List.html#filter\" rel=\"nofollow noreferrer\">source code for filter</a>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1493916428, "post_id": 43787633, "comment_id": 74617719, "body": "In order to reason about a function like <code>filter</code>, you must perform another case split in your inductive case - <code>filter p (x:xs)</code> becomes split into <code>(p x =&gt; filter p (x:xs) = x : filter p xs) &#47;\\ (not (p x) =&gt; filter p (x:xs) = filter p xs)</code>. Since you have <code>filter p . filter q</code> you will need to split this into four cases - then you will see the four cases correspond exactly to the logic table for <code>and</code>, and this is the crux of the proof (everything else is boring fluff). Reasoning about a list comprehension version of <code>filter</code> is much harder than just doing the case split."}, {"owner": {"reputation": 444, "user_id": 4919289, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0YH_c0fuzko/AAAAAAAAAAI/AAAAAAAAEDQ/skefb3qTJ38/photo.jpg?sz=128", "display_name": "Edison Lo", "link": "https://stackoverflow.com/users/4919289/edison-lo"}, "edited": false, "score": 0, "creation_date": 1493917342, "post_id": 43787633, "comment_id": 74618237, "body": "Thank you for the source code link and the way to do the induction"}], "owner": {"reputation": 444, "user_id": 4919289, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0YH_c0fuzko/AAAAAAAAAAI/AAAAAAAAEDQ/skefb3qTJ38/photo.jpg?sz=128", "display_name": "Edison Lo", "link": "https://stackoverflow.com/users/4919289/edison-lo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493913579, "creation_date": 1493913204, "last_edit_date": 1493913579, "question_id": 43787633, "link": "https://stackoverflow.com/questions/43787633/structural-induction-proof-on-filter-infix-on-filter", "title": "Structural induction proof on filter infix on filter", "body": "<p>I am trying to prove the following:</p>\n\n<pre><code>filter p . filter q = filter (and p q)\n\nwhere \n\nand p q x = p x &amp;&amp; q x\n</code></pre>\n\n<p>here is my try, but i am not sure if it is correct, can anyone give me some ideas?</p>\n\n<pre><code>Induction of list xs\nBase case xs = []\n(filter p . filter q) xs \n= {definition of .}\nfilter p ( filter q xs )\n= {xs = []}\nfilter p ( filter q [] )\n= {definition of filter}\nfilter p []\n= {definition of filter}\n[]\n= {xs = []}\nfilter (and p q) []\n= {definition of filter}\n= []\n\nInductive case:\n\n(filter p . filter q) xs\n= {definition of .}\nfilter p ( filter q xs)\n= {definition of filter}\nfilter p [ x | x&lt;-xs, q x]\n= {definition of filter}\n[ y | y &lt;- [ x | x&lt;-xs, q x], p y]\n= {definition of list} -- i am not sure if it is correct as well\n[ x | &lt;- xs, (p x) &amp;&amp; (q x)]\n= {definition of and p q x = p x &amp;&amp; q x}\n[ x | x&lt;-xs, and p q x ]\n= {definition of filter}\nfilter (and p q) xs\n</code></pre>\n\n<p>The inductive case is the point i struggled, filter can be implemented by foldr and also list comprehension, but if i use the list comprehension,\nit is ok to be a inductive case?</p>\n"}, {"tags": ["haskell", "shake-build-system"], "comments": [{"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1493908457, "post_id": 43785543, "comment_id": 74612034, "body": "You have strange build rules. (2) dosn&#39;t build <code>out</code>. (3) rule, instead of building an <code>out</code>, asks for it on input (need [out])."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1493908559, "post_id": 43785543, "comment_id": 74612105, "body": "I thought I might have a bit of a misunderstanding - If I build <code>out</code> - how  is the name of <code>out</code> determined? I thought <code>out</code> is the out-put of the pattern match on the lhs"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1493909136, "post_id": 43785543, "comment_id": 74612553, "body": "The build rule (2) can build any file witch file path has extension &quot;.1&quot;. It&#39;s mean that if some one call <code>need [&quot;xxx.1&quot;]</code> then will be run (2) build rule with <code>out = &quot;xxx.1&quot;</code>. If, for example, in the build rule (2) you need file with extension &quot;.2&quot;, you can write: <code>need [out -&lt;.&gt; &quot;.2&quot;]</code>, after this it will be accessed."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1493909314, "post_id": 43785543, "comment_id": 74612680, "body": "AAAH now I got it! and what about <code>action</code>s - are they wildcard rules and run every time I call shake"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1493909442, "post_id": 43785543, "comment_id": 74612779, "body": "Yes. And <code>want</code> defined like this: <code>want = action . need</code>"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 1, "creation_date": 1493909710, "post_id": 43785543, "comment_id": 74612993, "body": "do you <code>action . need</code> to make your comments in answer? I would accept it."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1493909874, "post_id": 43785543, "comment_id": 74613127, "body": "Well, I&#39;ll try to sum up."}], "answers": [{"tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": true, "score": 1, "last_activity_date": 1493911182, "last_edit_date": 1493911182, "creation_date": 1493910852, "answer_id": 43786799, "question_id": 43785543, "link": "https://stackoverflow.com/questions/43785543/shake-does-not-recognize-wether-to-build-a-rule-always-builds-a-rule-even-if-it/43786799#43786799", "title": "Shake does not recognize wether to build a rule/always builds a rule even if it shouldn&#39;t", "body": "<p>First of all, <code>pat %&gt; act</code> mean that you create the file-build-rule, which will be run for any file path witch will be accepted with the pattern <code>pat</code>. It's mean that if some one call <code>need [foo]</code> and <code>pat ?== foo</code> then will be run the action <code>act</code> with argument <code>foo</code>. So, the action <code>act</code> should to try build <code>foo</code>.</p>\n\n<p>Secondly, about <code>action</code>, as wrote in the documentation:</p>\n\n<blockquote>\n  <p>The action will be run in every build execution (unless withoutActions is used).</p>\n</blockquote>\n\n<p>And <code>wand</code> defined like this: <code>want = action . need</code>.</p>\n\n<p>For example, I redesign your example with some assumptions about dependencies between your files. Namely, foo.3 need foo.2, foo.2 need foo.1 and foo.1 already exists (it's source).</p>\n\n<pre><code>wanted = \"foo.3\"\nmain = shake shakeOptions $ do\n    want [wanted]\n\n    \"*.3\" %&gt; \\out -&gt; do                      \n        putNormal out\n        need [out -&lt;.&gt; \".2\"]\n        unit $ cmd Shell \"touch\" out\n\n    \"*.2\" %&gt; \\out -&gt; do\n        putNormal out\n        need [out -&lt;.&gt; \".1\"]\n        unit $ cmd Shell \"touch\" out\n</code></pre>\n"}], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 43786799, "answer_count": 1, "score": 1, "last_activity_date": 1493911182, "creation_date": 1493907750, "last_edit_date": 1495541401, "question_id": 43785543, "link": "https://stackoverflow.com/questions/43785543/shake-does-not-recognize-wether-to-build-a-rule-always-builds-a-rule-even-if-it", "title": "Shake does not recognize wether to build a rule/always builds a rule even if it shouldn&#39;t", "body": "<p>I have a project where I use shake to generate a bunch of reports based on input-files, and run as a restful webservice. One reason why I chose Shake is that is should not rebuild anything if input-files have not changed (e.g. based on Digest, configurable via <code>shakeOptions</code>).</p>\n\n<p>I noticed that the processes would run even if I had just built them and no file change had happened in between runs. So I tried a simple example it should simulate the process of one of my builds</p>\n\n<pre><code>import           Control.Monad.IO.Class\nimport           Development.Shake\n\nwanted = \"foo.3\"\n\nmain = shake shakeOptions $ do\n  want [wanted]                                       -- (1)\n  \"*.1\" %&gt; \\out -&gt; do                                 -- (2)\n    liftIO $ putStrLn out\n    unit $ cmd Shell \"touch\" \"foo.2\"\n\n  \"*.2\" %&gt; \\out -&gt; do need [out]                      -- (3)\n                      unit $ cmd \"touch\" wanted\n\n  action $ unit $ cmd Shell \"touch\" wanted            -- (4)\n</code></pre>\n\n<p>while the <code>%&gt;</code> rules never run - the <code>action</code> rule is always done.</p>\n\n<p>If I comment out (4) and create a file \"foo.1\" manually - the rule (1) is failing because it does not figure out that (2) -> (3) can build the result.</p>\n\n<p>If on the other hand I comment out (2) and (3) and leave (4) - the rule runs even if \"foo.3\" exists and has been \"built\" by shake before.</p>\n\n<p>I am using shake-0.15.11 in combination with shake - using <code>shake runhaskell Main.hs --package shake</code> or <code>shake exec -- testshake</code> does not make any difference. Compiler is GHC-8.0.2. All of this is done on a Linux (Mint).</p>\n\n<p>I read <a href=\"https://stackoverflow.com/questions/19469233\">How does Shake decide whether to rebuild a target?</a> - from which I gathered that shake rebuilds stuff only if either the input-file(s) or the output-file change (where change is determined by the <code>shakeOptions</code> configuration)</p>\n"}]