[{"tags": ["select", "go", "channel"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1471849568, "last_edit_date": 1592644375, "creation_date": 1456357936, "answer_id": 35615600, "question_id": 35615326, "link": "https://stackoverflow.com/questions/35615326/select-with-channel-channel/35615600#35615600", "title": "select with channel &lt;- &lt;- channel", "body": "<p><code>a &lt;- &lt;- b</code> is the same as <code>a&lt;- (&lt;-b)</code>, because the <code>&lt;-</code> operator associates with the leftmost <code>chan</code> possible.</p>\n<p>So the <code>select</code> has a <code>case</code> with a send operation (in the form of <code>a&lt;- (something)</code>). And what happens here is that the right-hand-side expression of the send statement (the value to be sent) is evaluated first - which is <code>&lt;-b</code>. But this will block forever (because no one is sending anything on <code>b</code>), so:</p>\n<blockquote>\n<p>fatal error: all goroutines are asleep - deadlock!</p>\n</blockquote>\n<p>Relevant section form the <a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"nofollow noreferrer\"><strong>Spec: Select statements:</strong></a></p>\n<blockquote>\n<p>Execution of a &quot;select&quot; statement proceeds in several steps:</p>\n<ol>\n<li><p>For all the cases in the statement, the channel operands of receive operations and the channel and right-hand-side expressions of send statements are evaluated exactly once, in source order, upon entering the &quot;select&quot; statement. The result is a set of channels to receive from or send to, and the corresponding values to send. Any side effects in that evaluation will occur irrespective of which (if any) communication operation is selected to proceed. Expressions on the left-hand side of a RecvStmt with a short variable declaration or assignment are not yet evaluated.</p>\n</li>\n<li><p>If one or more of the communications can proceed, a single one that can proceed is chosen via a uniform pseudo-random selection. Otherwise, if there is a default case, that case is chosen. If there is no default case, the &quot;select&quot; statement blocks until at least one of the communications can proceed.</p>\n</li>\n<li><p>...</p>\n</li>\n</ol>\n</blockquote>\n<p>So if <code>default</code> is present, the <code>select</code> does prevent blocking if none of the communications can proceed in <strong>step 2</strong>, but your code gets stuck in <strong>step 1</strong>.</p>\n<hr />\n<p><strong>Just to be complete,</strong> if there would be a goroutine that would send a value on <code>b</code>, then evaluation of <code>&lt;- b</code> would not block, so the execution of <code>select</code> would not stuck in step 2, and you would see the expected <code>&quot;select worked as naively expected&quot;</code> (because receiving from <code>a</code> could still not proceed therefore <code>default</code> would be chosen):</p>\n<pre><code>go func() { b &lt;- 1 }()\n\nselect {\n    // ...\n}\n</code></pre>\n<p>Try it on the <a href=\"http://play.golang.org/p/3sV7mGsIzU\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 53, "user_id": 5977350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b1711517e385432ad306d494791c45f?s=128&d=identicon&r=PG&f=1", "display_name": "DizietEmblessSma", "link": "https://stackoverflow.com/users/5977350/dizietemblesssma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 35615600, "answer_count": 1, "score": 5, "last_activity_date": 1471849568, "creation_date": 1456356513, "question_id": 35615326, "link": "https://stackoverflow.com/questions/35615326/select-with-channel-channel", "title": "select with channel &lt;- &lt;- channel", "body": "<p>I am curious why the following does not work. In general <code>select</code> with a <code>default:</code> prevents deadlock, but not in this case:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main () {\n    a := make(chan int)\n    b := make(chan int)\n\n    select {\n    case a &lt;- &lt;- b:\n        fmt.Println(\"this is impossible\")\n    default:\n        fmt.Println(\"select worked as naively expected\")\n    }\n}\n</code></pre>\n\n<p>Obviously it doesn't like the <code>&lt;- &lt;-</code> but I'm wondering what's going on behind the surface here. In other situations <code>&lt;- &lt;-</code> is allowed (though perhaps not recommended).</p>\n"}, {"tags": ["go", "mocking", "printf", "gomock"], "answers": [{"tags": [], "owner": {"reputation": 906, "user_id": 1342660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87b4c045277546c0023b18aae7915ac3?s=128&d=identicon&r=PG", "display_name": "Denzel", "link": "https://stackoverflow.com/users/1342660/denzel"}, "is_accepted": false, "score": 2, "last_activity_date": 1456361643, "creation_date": 1456361643, "answer_id": 35616232, "question_id": 35612500, "link": "https://stackoverflow.com/questions/35612500/golang-how-to-mock-interface-arguents-using-gomock/35616232#35616232", "title": "Golang: how to mock ...interface{} arguents using gomock", "body": "<p>Not possible with the current version of gomock. Maybe you can extend it, and send a pull request in. To understand why it's not possible, you have to look at the mock generated for variadic functions.</p>\n\n<p>To do that, let's look at the examples in gomock's repository, specifically <a href=\"https://github.com/rafrombrc/gomock/blob/9dcd4b2cd01be60f9fbabacce2a6ae1ed21ea48f/sample/user.go\" rel=\"nofollow\">./sample/mock_user/user.go</a> and <a href=\"https://github.com/rafrombrc/gomock/blob/9dcd4b2cd01be60f9fbabacce2a6ae1ed21ea48f/sample/mock_user/mock_user.go\" rel=\"nofollow\">./sample/mock_user/mock_user.go</a>.</p>\n\n<h3>Generated Mock</h3>\n\n<p>You'll see a function in the <em>Index</em> inteface called <em>Ellip</em>, which is like your <em>Printf</em> function:</p>\n\n<pre><code>type Index interface {\n    // ...\n    Ellip(fmt string, args ...interface{})\n    // ...\n}\n</code></pre>\n\n<p>Now, here's what the mocked function looks like for <em>Ellip</em>:</p>\n\n<pre><code>func (_m *MockIndex) Ellip(_param0 string, _param1 ...interface{}) {\n    _s := []interface{}{_param0}\n    for _, _x := range _param1 {\n        _s = append(_s, _x)\n    }\n    _m.ctrl.Call(_m, \"Ellip\", _s...)\n}\n</code></pre>\n\n<p>Notice anything odd? Well, gomock is creating a slice of interfaces, <strong>_s</strong>, initialized with the first parameter. Then it appends the variadic parameters to that slice of interfaces, <strong>_s</strong>.</p>\n\n<p>So, to be clear, it doesn't just append the variadic parameter, <strong>_param1</strong>, to the slice. Each individual variadic from <strong>_param1</strong> is appended to the new slice, by iterating through it.</p>\n\n<p>This means that the slice of variadic parameters is not preserved. It's broken out.</p>\n"}], "owner": {"reputation": 41, "user_id": 3904614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d0a0780a21d417b70994c7f8072295e?s=128&d=identicon&r=PG&f=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/3904614/zack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2399, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1456361643, "creation_date": 1456345976, "question_id": 35612500, "link": "https://stackoverflow.com/questions/35612500/golang-how-to-mock-interface-arguents-using-gomock", "title": "Golang: how to mock ...interface{} arguents using gomock", "body": "<p>I have a <code>Printer</code> interface that uses the standard go <code>Printf</code> function signature:</p>\n\n<pre><code>type Printer interface {\n    Printf(format string, tokens ...interface{})\n}\n</code></pre>\n\n<p>I would like to be able to mock this interface using <a href=\"https://github.com/golang/mock\" rel=\"nofollow\">gomock</a>, but I'm not sure how setup the <code>tokens ...interface{}</code> argument properly. </p>\n\n<p>I expected that <code>Printf(gomock.Any(), gomock.Any())</code> would cover all potential cases (since <code>tokens</code> compiles to <code>[]interface{}</code>), but it appears you need to setup an explicit call for N number of tokens:</p>\n\n<pre><code>// no tokens\nmockPrinter.EXPECT().\n    Printf(gomock.Any()).\n    AnyTimes()\n\n// 1 token\nmockPrinter.EXPECT().\n    Printf(gomock.Any(), gomock.Any()).\n    AnyTimes()\n\n// 2 tokens\nmockPrinter.EXPECT().\n    Printf(gomock.Any(), gomock.Any(), gomock.Any()).\n    AnyTimes()\n\n// ... up to N tokens\n</code></pre>\n\n<p>Does anyone know of a better way to do this?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 5976738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/062f7eb1dc52440dc3272a6b143e737d?s=128&d=identicon&r=PG", "display_name": "user5976738", "link": "https://stackoverflow.com/users/5976738/user5976738"}, "edited": false, "score": 0, "creation_date": 1456346598, "post_id": 35612633, "comment_id": 58909229, "body": "Thanks.  I edited my question to show why I&#39;m using index (and you answered while I was in the middle of it).  The key has a slash in it.  This puts a wrinkle in my plans."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 65, "user_id": 5976738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/062f7eb1dc52440dc3272a6b143e737d?s=128&d=identicon&r=PG", "display_name": "user5976738", "link": "https://stackoverflow.com/users/5976738/user5976738"}, "edited": false, "score": 0, "creation_date": 1456347431, "post_id": 35612633, "comment_id": 58909723, "body": "@user5976738: see my updated answer for a workaround"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 2, "last_activity_date": 1619080895, "last_edit_date": 1619080895, "creation_date": 1456346459, "answer_id": 35612633, "question_id": 35612456, "link": "https://stackoverflow.com/questions/35612456/how-to-use-golang-template-missingkey-option/35612633#35612633", "title": "How to use golang template missingkey option?", "body": "<p>The <code>missingkey</code> option does not work with <code>index</code>. You will only get the desired result when you access the map using <code>.&lt;field-name&gt;</code>:</p>\n<pre><code>t, err := template.New(&quot;t1&quot;).Option(&quot;missingkey=error&quot;).Parse(`{{.foo}}`)\nerr = t.Execute(os.Stdout, d)\n</code></pre>\n<p>You can get around this by defining your own index function that returns an error when a key is missing:</p>\n<pre><code>package main\n\nimport (\n    &quot;errors&quot;\n    &quot;fmt&quot;\n    &quot;os&quot;\n    &quot;text/template&quot;\n)\n\nfunc lookup(m map[string]interface{}, key string) (interface{}, error) {\n    val, ok := m[key]\n    if !ok {\n        return nil, errors.New(&quot;missing key &quot; + key)\n    }\n    return val, nil\n}\n\nfunc main() {\n    d := map[string]interface{}{\n        &quot;/foo/bar&quot;: 34,\n    }\n    fns := template.FuncMap{\n        &quot;lookup&quot;: lookup,\n    }\n    t, err := template.New(&quot;t1&quot;).Funcs(fns).Parse(`{{ lookup . &quot;/foo/baz&quot; }}`)\n    if err != nil {\n        fmt.Printf(&quot;ERROR 1: %q\\n&quot;, err)\n    }\n    err = t.Execute(os.Stdout, d)\n    if err != nil {\n        fmt.Printf(&quot;ERROR 2: %q\\n&quot;, err)\n    }\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/0_ZZ2Pwa1uZ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/0_ZZ2Pwa1uZ</a></p>\n"}, {"tags": [], "owner": {"reputation": 769, "user_id": 2647655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qGHOi.png?s=128&g=1", "display_name": "kataras", "link": "https://stackoverflow.com/users/2647655/kataras"}, "is_accepted": false, "score": 0, "last_activity_date": 1577312291, "creation_date": 1577312291, "answer_id": 59482221, "question_id": 35612456, "link": "https://stackoverflow.com/questions/35612456/how-to-use-golang-template-missingkey-option/59482221#59482221", "title": "How to use golang template missingkey option?", "body": "<p>Hello @user5976738 and all.</p>\n\n<p>I have a different solution for that problem which <strong>does not require a template function at all</strong> and it uses the <code>text/template/parse</code> package.</p>\n\n<p>This workaround may be very useful for some of you. <strong>Example</strong> of usage:</p>\n\n<pre><code>if missingKeys, ok := IsMissingKeys(err); ok{\n   for _, key := range missingKeys{ println(key) }\n}\n</code></pre>\n\n<p>Source Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"strings\"\n    \"strconv\"\n    \"text/template\"\n    templateparse \"text/template/parse\"\n)\n\ntype errMissingKeys struct {\n    Keys         []string\n    TemplateName string\n}\n\nfunc (err errMissingKeys) Error() string {\n    return fmt.Sprintf(\"template: %s: map has no entry for keys: %s\", err.TemplateName, strings.Join(err.Keys, \", \"))\n}\n\n// IsMissingKeys reports whether an \"err\" is caused by template missing keys.\n//\n// Usage:\n// if missingKeys, ok := IsMissingKeys(err); ok{\n//     for _, key := range missingKeys{ println(key) }\n// }\nfunc IsMissingKeys(err error) ([]string, bool) {\n    if err != nil {\n        if v, ok := err.(errMissingKeys); ok {\n            return v.Keys, true\n        }\n    }\n\n    return nil, false\n}\n\nfunc main() {\n    data := map[string]interface{}{\n        \"bar\": 34,\n    }\n\n    tmpl, err := template.New(\"myTemplate\").Option(\"missingkey=error\").Parse(`{{.baz}} {{.other}}`)\n    if err != nil {\n        fmt.Println(err.Error())\n        os.Exit(1)\n    }\n\n    err = tmpl.Execute(os.Stdout, data)\n    if err != nil {\n        if strings.Contains(err.Error(), \"map has no entry for key \") {\n            // Check if a field is not a \"data\" match,\n            // which will lead on execute error on first undefined (missingkey=error).\n            // So collect all these keys so we can have a typed error with all unknown keys listed.\n            var missingKeys []string\n            for _, n := range tmpl.Root.Nodes {\n                if n.Type() == templateparse.NodeAction {\n                    key := strings.TrimFunc(n.String(), func(r rune) bool {\n                        return r == '{' || r == '}' || r == ' ' || r == '.'\n                    })\n\n                    if key == \"\" {\n                        continue\n                    }\n\n                    if _, ok := data[key]; !ok {\n                        missingKeys = append(missingKeys, strconv.Quote(key))\n                    }\n                }\n            }\n\n            // if just one then keep the original error which contains the full context,\n            // else set to custom error type which will keep the missing keys for caller's further use.\n            if len(missingKeys) &gt; 1 {\n                err = errMissingKeys{TemplateName: tmpl.Name(), Keys: missingKeys}\n            }\n        }\n        fmt.Println(err.Error())\n        os.Exit(1)\n    }\n}\n</code></pre>\n\n<p>Playground link: <a href=\"https://play.golang.org/p/JMwBpU2KyP2\" rel=\"nofollow noreferrer\">https://play.golang.org/p/JMwBpU2KyP2</a></p>\n\n<p>Best Regards, Gerasimos Maropoulos - Creator of <a href=\"https://iris-go.com\" rel=\"nofollow noreferrer\">https://iris-go.com</a></p>\n"}], "owner": {"reputation": 65, "user_id": 5976738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/062f7eb1dc52440dc3272a6b143e737d?s=128&d=identicon&r=PG", "display_name": "user5976738", "link": "https://stackoverflow.com/users/5976738/user5976738"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2035, "favorite_count": 0, "accepted_answer_id": 35612633, "answer_count": 2, "score": 5, "last_activity_date": 1619080895, "creation_date": 1456345808, "last_edit_date": 1456346493, "question_id": 35612456, "link": "https://stackoverflow.com/questions/35612456/how-to-use-golang-template-missingkey-option", "title": "How to use golang template missingkey option?", "body": "<p>I would expect </p>\n\n<pre><code>t, err := template.New(\"t1\").Option(\"missingkey=error\").Parse(\"{{index . \\\"/foo/bar\\\"}}\")        \nerr = t.Execute(os.Stdout, d)\n</code></pre>\n\n<p>to return an error if the map 'd' doesn't have a key '/foo/bar', but everything is just fine.  Am I missing something?</p>\n\n<p>Here's the go playground:\n<a href=\"http://play.golang.org/p/Oqg1Dy4h1k\" rel=\"nofollow\">http://play.golang.org/p/Oqg1Dy4h1k</a></p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1456345087, "post_id": 35612144, "comment_id": 58908365, "body": "Can you update with the value of <code>query</code>? You make it sound like you can copy and paste it&#39;s value into mysql workbench and have it work. I&#39;m sure based on the way args work that is in fact not that case and based on the error I would guess the query you&#39;re running in mysql workbench simply is not what results from this logic."}], "answers": [{"comments": [{"owner": {"reputation": 10946, "user_id": 1259261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a105607c3fd93df0d386c6d6a6b4aad?s=128&d=identicon&r=PG", "display_name": "Daniel Robinson", "link": "https://stackoverflow.com/users/1259261/daniel-robinson"}, "edited": false, "score": 0, "creation_date": 1456351837, "post_id": 35612427, "comment_id": 58912138, "body": "thanks for the suggestion I tried updating my connection string to <code>&quot;usr:pwd@tcp(localhost:3306)&#47;my_db?parseTime=true&amp;loc=UTC&amp;mu&zwnj;&#8203;ltiStatements=true&quot;</code> but with no change in the result, still the same error."}, {"owner": {"reputation": 4742, "user_id": 1335189, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f98526aa898553a64cc6bfb6c0815f4b?s=128&d=identicon&r=PG", "display_name": "JorgeeFG", "link": "https://stackoverflow.com/users/1335189/jorgeefg"}, "edited": false, "score": 0, "creation_date": 1570847217, "post_id": 35612427, "comment_id": 103055373, "body": "Thanks for this. No warning errors about this, I am starting to hate Go"}, {"owner": {"reputation": 39969, "user_id": 1385845, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8c83a83d31eb49749a3ed04ecdf41c7?s=128&d=identicon&r=PG", "display_name": "Chad Grant", "link": "https://stackoverflow.com/users/1385845/chad-grant"}, "edited": false, "score": 0, "creation_date": 1576999191, "post_id": 35612427, "comment_id": 105068020, "body": "this has nothing to do with sql injection btw"}], "tags": [], "owner": {"reputation": 9308, "user_id": 235700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ab02b76dcfedbe47d2b7335a6277f3?s=128&d=identicon&r=PG", "display_name": "slugonamission", "link": "https://stackoverflow.com/users/235700/slugonamission"}, "is_accepted": false, "score": 2, "last_activity_date": 1456345726, "creation_date": 1456345726, "answer_id": 35612427, "question_id": 35612144, "link": "https://stackoverflow.com/questions/35612144/mysql-complains-at-syntax-from-go-driver/35612427#35612427", "title": "mysql complains at syntax from go driver", "body": "<p><code>go-sql-driver</code>, by default, does not allow you to have multiple statements in one query (as you are doing by chaining together multiple <code>CALL</code> statements like that) due to the security implications if an attacker manages to perform SQL injection (for example, by injecting <code>0 OR 0; DROP TABLE foo</code>).</p>\n\n<p>To allow this, you must explicitly enable it by passing <code>multiStatements</code> parameter when connecting to the database, e.g.</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"user:password@/dbname?multiStatements=True\")\n</code></pre>\n\n<p>Source: <a href=\"https://github.com/go-sql-driver/mysql#multistatements\" rel=\"nofollow\">https://github.com/go-sql-driver/mysql#multistatements</a></p>\n"}, {"tags": [], "owner": {"reputation": 10946, "user_id": 1259261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a105607c3fd93df0d386c6d6a6b4aad?s=128&d=identicon&r=PG", "display_name": "Daniel Robinson", "link": "https://stackoverflow.com/users/1259261/daniel-robinson"}, "is_accepted": false, "score": 0, "last_activity_date": 1456389997, "creation_date": 1456389997, "answer_id": 35622325, "question_id": 35612144, "link": "https://stackoverflow.com/questions/35612144/mysql-complains-at-syntax-from-go-driver/35622325#35622325", "title": "mysql complains at syntax from go driver", "body": "<p>I have fixed the proc call by doing some manual string interpolation for the parameters instead of using the correct <code>?</code> way of doing it:</p>\n\n<pre><code>bulkSetStatus := func(docVers []*_documentVersion) error {\n    if len(docVers) &gt; 0 {\n        query := strings.Repeat(\"CALL documentVersionSetStatus(%q, %q); \", len(docVers))\n        args := make([]interface{}, 0, len(docVers)*2)\n        for _, docVer := range docVers {\n            args = append(args, docVer.Id, docVer.Status)\n        }\n        _, err := db.Exec(fmt.Sprintf(query, args...))\n        return err\n    }\n    return nil\n}\n</code></pre>\n\n<p>so I swap out the <code>?</code> for <code>%q</code> and us <code>fmt.Sprintf</code> to inject the parameters, I should note that slugonamission's answer is partially correct, I did need to add the connection string parameter <code>multiStatements=true</code> in order to get this to work with my other changes. I will log an issue on the github repo it looks like there may be some param interpolation issue when there is more than one statement, I think the error was happening because the mysql db was trying to run the script with <code>?</code> literals in it.</p>\n"}], "owner": {"reputation": 10946, "user_id": 1259261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a105607c3fd93df0d386c6d6a6b4aad?s=128&d=identicon&r=PG", "display_name": "Daniel Robinson", "link": "https://stackoverflow.com/users/1259261/daniel-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456849922, "creation_date": 1456344896, "last_edit_date": 1456351525, "question_id": 35612144, "link": "https://stackoverflow.com/questions/35612144/mysql-complains-at-syntax-from-go-driver", "title": "mysql complains at syntax from go driver", "body": "<p>I'm using the github.com/go-sql-driver/mysql and mysql 5.7.10. I have a function:</p>\n\n<pre><code>bulkSetStatus := func(docVers []*_documentVersion) error {\n    if len(docVers) &gt; 0 {\n        query := strings.Repeat(\"CALL documentVersionSetStatus(?, ?); \", len(docVers))\n        args := make([]interface{}, 0, len(docVers)*2)\n        for _, docVer := range docVers {\n            args = append(args, docVer.Id, docVer.Status)\n        }\n        _, err := db.Exec(query, args...)\n        return err\n    }\n    return nil\n}\n</code></pre>\n\n<p>which works if <code>len(docVers) == 1</code> but when there are more, resulting in multiple <code>CALL</code>s to the stored procedure, it errors:</p>\n\n<blockquote>\n  <p>Error 1064: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CALL documentVersionSetStatus(?, ?)' at line 1</p>\n</blockquote>\n\n<p>I have also tried a newline character between each call but I get the same error. If I run this in mysql workbench with multiple <code>CALL</code>s to this procedure it works fine, I'm not sure what is wrong with the syntax here.</p>\n\n<p>I have logged out the exact full text with the arguments and it is as expected:</p>\n\n<pre><code>CALL documentVersionSetStatus(\"9c71cac14a134e7abbc4725997d90d2b\", \"inprogress\"); CALL documentVersionSetStatus(\"beb65318da96406fa92990426a279efa\", \"inprogress\");\n</code></pre>\n"}, {"tags": ["pointers", "go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1482834309, "last_edit_date": 1482834309, "creation_date": 1456340007, "answer_id": 35610607, "question_id": 35609903, "link": "https://stackoverflow.com/questions/35609903/dereferencing-pointers-in-a-golang-text-template/35610607#35610607", "title": "Dereferencing pointers in a golang text/template", "body": "<p>One way is to register a custom function which dereferences the pointer, so you can compare the result to whatever you want to or do anything else with it.</p>\n\n<p>For example:</p>\n\n<pre><code>func main() {\n    t := template.Must(template.New(\"\").Funcs(template.FuncMap{\n        \"Deref\": func(i *int) int { return *i },\n    }).Parse(src))\n    i := 5\n    m := map[string]interface{}{\"ID\": &amp;i}\n    if err := t.Execute(os.Stdout, m); err != nil {\n        fmt.Println(err)\n    }\n}\n\nconst src = `{{if eq 5 (Deref .ID)}}It's five.{{else}}Not five: {{.ID}}{{end}}`\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>It's five.\n</code></pre>\n\n<p>Alternatively you could use a different custom function which would take a pointer and a non-pointer, and do the comparision, e.g.:</p>\n\n<pre><code>    \"Cmp\":   func(i *int, j int) bool { return *i == j },\n</code></pre>\n\n<p>And calling it from the template:</p>\n\n<pre><code>{{if Cmp .ID 5}}It's five.{{else}}Not five: {{.ID}}{{end}}\n</code></pre>\n\n<p>Output is the same. Try these on the <a href=\"http://play.golang.org/p/334xnBtr59\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4524, "favorite_count": 4, "accepted_answer_id": 35610607, "answer_count": 1, "score": 10, "last_activity_date": 1560510453, "creation_date": 1456337727, "last_edit_date": 1560510453, "question_id": 35609903, "link": "https://stackoverflow.com/questions/35609903/dereferencing-pointers-in-a-golang-text-template", "title": "Dereferencing pointers in a golang text/template", "body": "<p>Inside a golang <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow\">template</a> when simply outputting values it seems that pointers are automatically dereferenced. When <code>.ID</code> is a pointer to an <code>int</code>,</p>\n\n<p><code>{{.ID}}</code> outputs <code>5</code></p>\n\n<p>But when I try to use it in a pipeline, <code>{{if eq .ID 5}}</code> I get an error.</p>\n\n<p><code>executing \"mytemplate\" at &lt;eq .ID 5&gt;: error calling eq: invalid type for comparison</code></p>\n\n<p>How do I do a dereference of a pointer inside a template pipeline?</p>\n"}, {"tags": ["go", "abstract-syntax-tree"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1456337109, "post_id": 35609633, "comment_id": 58903660, "body": "Can you post the code you have now?"}, {"owner": {"reputation": 962, "user_id": 4504720, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ace526e1e08e475c20f8448be16a950e?s=128&d=identicon&r=PG&f=1", "display_name": "Random Guy", "link": "https://stackoverflow.com/users/4504720/random-guy"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1456338042, "post_id": 35609633, "comment_id": 58904185, "body": "@evanmcdonnal I&#39;m just using ast.Inspect to find Expr statements but I have no idea what should I do to remove them"}, {"owner": {"reputation": 604, "user_id": 854911, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-302baaBxp8Q/AAAAAAAAAAI/AAAAAAAAABA/-K5SxmEim-A/photo.jpg?sz=128", "display_name": "struct", "link": "https://stackoverflow.com/users/854911/struct"}, "edited": false, "score": 0, "creation_date": 1456340130, "post_id": 35609633, "comment_id": 58905466, "body": "<code>ast.Node</code> has <code>Pos()</code> and <code>End()</code> methods which return an abstract position (convert it into something more helpful with <code>fset.Position</code>). Would it be acceptable to use those to determine a range of characters to remove from the file, remove them, write the file to disk and then re-read it?"}, {"owner": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "edited": false, "score": 0, "creation_date": 1456340151, "post_id": 35609633, "comment_id": 58905484, "body": "Have you tried <code>ast.FilterFile()</code>?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "edited": false, "score": 0, "creation_date": 1456342231, "post_id": 35609633, "comment_id": 58906678, "body": "See the ast.Filter* functions as mentioned by @kichik. If the existing functions don&#39;t meet your needs, then use them as starting point for your own filter."}], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 3509351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4ad7c3bbe2d8a693729a60f645c9d45?s=128&d=identicon&r=PG&f=1", "display_name": "pawanrawal", "link": "https://stackoverflow.com/users/3509351/pawanrawal"}, "is_accepted": false, "score": 0, "last_activity_date": 1559017088, "creation_date": 1559017088, "answer_id": 56334932, "question_id": 35609633, "link": "https://stackoverflow.com/questions/35609633/delete-node-from-ast-in-go/56334932#56334932", "title": "Delete node from AST in Go", "body": "<p>You can try the <a href=\"https://godoc.org/golang.org/x/tools/go/ast/astutil#Cursor.Delete\" rel=\"nofollow noreferrer\">astutil</a> package. See the delete example in the tests at <a href=\"https://github.com/golang/tools/blob/master/go/ast/astutil/rewrite_test.go#L123\" rel=\"nofollow noreferrer\">rewrite_test.go</a>.</p>\n"}], "owner": {"reputation": 962, "user_id": 4504720, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ace526e1e08e475c20f8448be16a950e?s=128&d=identicon&r=PG&f=1", "display_name": "Random Guy", "link": "https://stackoverflow.com/users/4504720/random-guy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 665, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1559017088, "creation_date": 1456336867, "last_edit_date": 1456337904, "question_id": 35609633, "link": "https://stackoverflow.com/questions/35609633/delete-node-from-ast-in-go", "title": "Delete node from AST in Go", "body": "<p>Is there any way to delete specific type node from AST? (for example, i want to delete all Expr Statements) Or maybe there is a way to replace it with empty ast.Expr node? </p>\n\n<p>I didnt find any documentation about it so any help would be appreciated. Thanks in advance!</p>\n\n<p>UPD:</p>\n\n<pre><code>func find_node(file *ast.File) {\n\n    ast.Inspect(file, func(node ast.Node) bool {\n\n        switch x := node.(type) {\n\n        case *ast.ExprStmt:\n\n           var e ast.Expr\n           e = x.X\n\n           fmt.Printf(\"Expression found: %s\\n\", e)\n\n        }\n\n    return true\n})\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["windows", "go", "windows-services"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1456336431, "post_id": 35605238, "comment_id": 58903237, "body": "In addition to the @GKV&#39;s answer: you have to understand that a Windows service is a complicated beast which is supposed to be called in a special way and do a lot of processing once started (and moreover, any executable tihing--be it an EXE or DLL--might host any number of Windows services, and many OS-provided services are run like that.)"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1456336509, "post_id": 35605238, "comment_id": 58903281, "body": "A low-tech solution would be wrapping your application via <code>srvany</code> or <code>nssm</code> (google them, if you wish) -- which basically turn a normal (regular) Windows application into a Windows service. I&#39;d still follow the @GKV&#39;s advice."}, {"owner": {"reputation": 311, "user_id": 3481046, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/76ca1ada418b4a060f96ac0f87a79cc0?s=128&d=identicon&r=PG&f=1", "display_name": "Abinash Kumar", "link": "https://stackoverflow.com/users/3481046/abinash-kumar"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1456378354, "post_id": 35605238, "comment_id": 58920931, "body": "@kostix I have already tried using nssm but the result is same. I get the same 1053 error."}], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 3481046, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/76ca1ada418b4a060f96ac0f87a79cc0?s=128&d=identicon&r=PG&f=1", "display_name": "Abinash Kumar", "link": "https://stackoverflow.com/users/3481046/abinash-kumar"}, "edited": false, "score": 0, "creation_date": 1456378265, "post_id": 35607787, "comment_id": 58920906, "body": "Thank you for answering the question. I have read about the package <a href=\"https://github.com/kardianos/service\" rel=\"nofollow noreferrer\">kardianos/service</a>&quot; and a similar package too &quot;<a href=\"https://godoc.org/golang.org/x/sys/windows/svc\" rel=\"nofollow noreferrer\">svc</a>&quot;. But my doubt is that &quot;What will be the code flow, since i need to bundle the exe in my installer?? Do i need to start the exe and then create a service for the same exe??&quot;."}, {"owner": {"reputation": 595, "user_id": 5443590, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8c3c26c54f6d700cd85d73e1f0cc4b5f?s=128&d=identicon&r=PG&f=1", "display_name": "GKV", "link": "https://stackoverflow.com/users/5443590/gkv"}, "reply_to_user": {"reputation": 311, "user_id": 3481046, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/76ca1ada418b4a060f96ac0f87a79cc0?s=128&d=identicon&r=PG&f=1", "display_name": "Abinash Kumar", "link": "https://stackoverflow.com/users/3481046/abinash-kumar"}, "edited": false, "score": 0, "creation_date": 1456382882, "post_id": 35607787, "comment_id": 58922986, "body": "you should keep the above code(in your main.go),when you install the .exe,using installer it will automatically start your service ."}], "tags": [], "owner": {"reputation": 595, "user_id": 5443590, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8c3c26c54f6d700cd85d73e1f0cc4b5f?s=128&d=identicon&r=PG&f=1", "display_name": "GKV", "link": "https://stackoverflow.com/users/5443590/gkv"}, "is_accepted": true, "score": 18, "last_activity_date": 1456334449, "last_edit_date": 1456334449, "creation_date": 1456331637, "answer_id": 35607787, "question_id": 35605238, "link": "https://stackoverflow.com/questions/35605238/cannot-start-golang-application-exe-as-a-windows-services/35607787#35607787", "title": "Cannot start golang application exe as a windows services", "body": "<p>Go has a library for creating services in windows.\nPlease check this library <a href=\"http://github.com/kardianos/service\" rel=\"noreferrer\">github.com/kardianos/service</a>. </p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"github.com/kardianos/service\"\n)\n\nvar logger service.Logger\n\ntype program struct{}\n\nfunc (p *program) Start(s service.Service) error {\n    // Start should not block. Do the actual work async.\n    go p.run()\n    return nil\n}\nfunc (p *program) run() {\n    // Do work here\n}\nfunc (p *program) Stop(s service.Service) error {\n    // Stop should not block. Return with a few seconds.\n    return nil\n}\n\nfunc main() {\n    svcConfig := &amp;service.Config{\n        Name:        \"GoServiceExampleSimple\",\n        DisplayName: \"Go Service Example\",\n        Description: \"This is an example Go service.\",\n    }\n\n    prg := &amp;program{}\n    s, err := service.New(prg, svcConfig)\n    if err != nil {\n        log.Fatal(err)\n    }\n    logger, err = s.Logger(nil)\n    if err != nil {\n        log.Fatal(err)\n    }\n    err = s.Run()\n    if err != nil {\n        logger.Error(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 3481046, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/76ca1ada418b4a060f96ac0f87a79cc0?s=128&d=identicon&r=PG&f=1", "display_name": "Abinash Kumar", "link": "https://stackoverflow.com/users/3481046/abinash-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10637, "favorite_count": 3, "accepted_answer_id": 35607787, "answer_count": 1, "score": 11, "last_activity_date": 1456334449, "creation_date": 1456325094, "question_id": 35605238, "link": "https://stackoverflow.com/questions/35605238/cannot-start-golang-application-exe-as-a-windows-services", "title": "Cannot start golang application exe as a windows services", "body": "<p>I have a application with golang as the backend. \nI can create a service using the sc and nssm as below :\n<code>sc create TestService binpath=C:\\User\\sds\\Desktop\\test.exe\nnssm install TestService C:\\User\\sds\\Desktop\\test.exe</code></p>\n\n<p>The services are created successfully but it doesn not get started. It gives <strong>startup timeout error</strong> while starting the service.</p>\n\n<p>I need to start the application from windows services.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["sql", "json", "go"], "answers": [{"tags": [], "owner": {"reputation": 3875, "user_id": 2520738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8b9e3bb134ffcf49330f7886f1484a?s=128&d=identicon&r=PG", "display_name": "sturrockad", "link": "https://stackoverflow.com/users/2520738/sturrockad"}, "is_accepted": true, "score": 3, "last_activity_date": 1456326132, "creation_date": 1456326132, "answer_id": 35605657, "question_id": 35605149, "link": "https://stackoverflow.com/questions/35605149/golang-server-send-json-with-sql-query-result-that-has-variable-number-of-colum/35605657#35605657", "title": "Golang server: send JSON with SQL query result that has variable number of columns", "body": "<p>The first problem is here:</p>\n\n<p><code>for i := range ints {\n    vals[i] = &amp;ints[i] // Copy references into the slice\n}</code></p>\n\n<p>This is you setting values that are meant to be RawBytes as pointers to interfaces.</p>\n\n<p>Before I explain what that's meant to be doing I'll see if I can explain what the general idea is here.</p>\n\n<p>So normally when getting the response from SQL in Go you'd have a slice with each column and type (id int, name string, ...) so you can then read each SQL record into this slice and each column will be mapped to the value of the same type.</p>\n\n<p>For cases like yours where you will have more variety in the response from SQL and need Go to handle it, you'd do this:</p>\n\n<p><code>for i := range ints {\n    ints[i] = &amp;vals[i] // Copy references into the slice\n}</code> </p>\n\n<p>What this is saying is each of your <code>interface</code> values holds a pointer to the <code>vals</code> array that will hold the response from SQL. (In my examples I use [][]byte instead of RawBytes so value in  <code>vals</code> would be a slice of byte values from SQL.)</p>\n\n<p>You'd then do:</p>\n\n<p><code>err := rows.Scan(ints...)</code></p>\n\n<p>Since <code>interface</code> can evaluate to any type, when the <code>ints</code> array becomes populated  it will accept any value then update the position in vals array based on the pointer with the value from SQL as a RawBytes type.</p>\n\n<p>HTH</p>\n"}], "owner": {"reputation": 1040, "user_id": 5081185, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/yQ8Wl.jpg?s=128&g=1", "display_name": "Mat&#250;\u0161 \u010congr&#225;dy", "link": "https://stackoverflow.com/users/5081185/mat%c3%ba%c5%a1-%c4%8congr%c3%a1dy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 566, "favorite_count": 0, "accepted_answer_id": 35605657, "answer_count": 1, "score": 1, "last_activity_date": 1456326132, "creation_date": 1456324875, "last_edit_date": 1456325777, "question_id": 35605149, "link": "https://stackoverflow.com/questions/35605149/golang-server-send-json-with-sql-query-result-that-has-variable-number-of-colum", "title": "Golang server: send JSON with SQL query result that has variable number of columns", "body": "<p>I'm creating a little implementation of RESTful API with Go server.</p>\n\n<p>I'm extracting query parameters from URL (I know it's not safe, I'll try to fix this later on, but if you have any recommendations even on this topic, they would be helpful).</p>\n\n<p>I have table name, desired columns and some conditions saved in 3 sring variables.\nI'm using this query:</p>\n\n<pre><code>rows, _ := db.Query(fmt.Sprintf(\"SELECT %s FROM %s WHERE %s\", columns, table, conditions))\n</code></pre>\n\n<p>I want to send the query result back to my frontend, as JSON. I have variable number of unknown columns, so I can't do it \"standard\" way. \nOne solution I can think of is to build a JSON string \"manually\" from from query result and rows.Columns().</p>\n\n<p>But I'd like to do this in a more sofisticated way using something like variadic interface and stuff like that. The problem is, even after trying a lot, I still dont understand how it works.</p>\n\n<p>I tried using following code</p>\n\n<pre><code>cols, err := rows.Columns()             // Get the column names; remember to check err\nvals := make([]sql.RawBytes, len(cols)) // Allocate enough values\nints := make([]interface{}, len(cols))  // Make a slice of []interface{}\nfor i := range ints {\n    vals[i] = &amp;ints[i] // Copy references into the slice\n}\nfor rows.Next() {\n    err := rows.Scan(vals...)\n    // Now you can check each element of vals for nil-ness,\n    // and you can use type introspection and type assertions\n    // to fetch the column into a typed variable.\n}\n</code></pre>\n\n<p>from <a href=\"https://github.com/mindreframer/golang-stuff/tree/master/github.com/VividCortex/go-database-sql-tutorial\" rel=\"nofollow\">this tutorial</a> but it doesn't work, I'm getting errors like </p>\n\n<p><code>cannot use &amp;ints[i] (type *interface {}) as type sql.RawBytes in assignment</code></p>\n\n<p>And even if it'd work, I dont understand it.</p>\n\n<p>Does anyone have a good solution for this? Some explanation would be great aswell.</p>\n\n<p>Thanks a lot.</p>\n"}, {"tags": ["pointers", "go", "struct"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1456323724, "post_id": 35604356, "comment_id": 58893865, "body": "The decoder has to follow pointers, and allocate internal pointers as needed. The result of this is it will follow multiple levels of pointers. What exactly is the question beyond what answer you&#39;ve already provided?"}, {"owner": {"reputation": 29724, "user_id": 93995, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/35752f1794d9a5f8ab8fe8edf272f0cc?s=128&d=identicon&r=PG", "display_name": "George Armhold", "link": "https://stackoverflow.com/users/93995/george-armhold"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456329087, "post_id": 35604356, "comment_id": 58897688, "body": "I tried to flesh it out a bit more."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1456329922, "post_id": 35604356, "comment_id": 58898360, "body": ":) it <a href=\"https://play.golang.org/p/YJPAvmMwqW\" rel=\"nofollow noreferrer\">does not stop</a> at one level extra"}], "answers": [{"comments": [{"owner": {"reputation": 29724, "user_id": 93995, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/35752f1794d9a5f8ab8fe8edf272f0cc?s=128&d=identicon&r=PG", "display_name": "George Armhold", "link": "https://stackoverflow.com/users/93995/george-armhold"}, "edited": false, "score": 0, "creation_date": 1456330597, "post_id": 35607026, "comment_id": 58898886, "body": "Your example makes it very clear what&#39;s going on, thank you. I just feel somewhat misled by the line in the doc that says &quot;into the value pointed at by the pointer&quot;."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 8, "last_activity_date": 1456410724, "last_edit_date": 1456410724, "creation_date": 1456329793, "answer_id": 35607026, "question_id": 35604356, "link": "https://stackoverflow.com/questions/35604356/json-unmarshal-accepts-a-pointer-to-a-pointer/35607026#35607026", "title": "json.Unmarshal() accepts a pointer to a pointer", "body": "<p>The json package has no reason to \"stop at a pointer\", since a pointer means nothing in json. It has to keep walking the tree in order to find a value to write. Since the json package is going to allow unmarshaling the same value into <code>Type</code> or <code>*Type</code>, it stands to reason that it should be able to unmarshal that into <code>**Type</code>, which is also a valid type in Go.</p>\n\n<p>For a example, if <code>Person</code> were defined using pointers to differentiate between nil and zero values, and you were unmarshaling into a slice of <code>[]*Person</code>, the json package needs to follow those pointers, and allocate values if necessary. The same applies if a field in Person were defined as a <code>**string</code>.</p>\n\n<pre><code>type Person struct {\n    Name **string\n    Age  *int\n}\n\ntype People []*Person\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/vLq0nJPG5M\" rel=\"noreferrer\">http://play.golang.org/p/vLq0nJPG5M</a></p>\n"}, {"tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": false, "score": 1, "last_activity_date": 1456333514, "last_edit_date": 1456333514, "creation_date": 1456332705, "answer_id": 35608210, "question_id": 35604356, "link": "https://stackoverflow.com/questions/35604356/json-unmarshal-accepts-a-pointer-to-a-pointer/35608210#35608210", "title": "json.Unmarshal() accepts a pointer to a pointer", "body": "<p>The <code>json.Unmarshal</code> implementation takes multiple indirection into account. Check the source <a href=\"https://golang.org/src/encoding/json/decode.go\" rel=\"nofollow\">here</a>, in particular the <code>decodeState.indirect</code> method:</p>\n\n<pre><code>// indirect walks down v allocating pointers as needed,\n// until it gets to a non-pointer.\n// if it encounters an Unmarshaler, indirect stops and returns that.\n// if decodingNull is true, indirect stops at the last pointer so it can be set to nil.\nfunc (d *decodeState) indirect(v reflect.Value, decodingNull bool) (Unmarshaler, encoding.TextUnmarshaler, reflect.Value) {\n    // If v is a named type and is addressable,\n    // start with its address, so that if the type has pointer methods,\n    // we find them.\n    if v.Kind() != reflect.Ptr &amp;&amp; v.Type().Name() != \"\" &amp;&amp; v.CanAddr() {\n        v = v.Addr()\n    }\n    for {\n        if v.Kind() == reflect.Interface &amp;&amp; !v.IsNil() {\n            e := v.Elem()\n            if e.Kind() == reflect.Ptr &amp;&amp; !e.IsNil() &amp;&amp; (!decodingNull || e.Elem().Kind() == reflect.Ptr) {\n                v = e\n                continue\n            }\n        }\n\n        if v.Kind() != reflect.Ptr {\n            break\n        }\n        //and so on\n    }\nreturn nil, nil, v\n</code></pre>\n\n<p>The same method is called when unmarshaling arrays:</p>\n\n<pre><code>func (d *decodeState) array(v reflect.Value) {\n    u, ut, pv := d.indirect(v, false)\n    //...\n</code></pre>\n\n<p>That would have me believe that go can handle double indirection just fine. If nothing else, the json package source is a great example of what the <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow\">reflect package</a> is all about.</p>\n\n<p>In short, values are checked, if the decoder is dealing with pointers, it will use reflection to work out how many levels of indirection there are, and determine what type the target has/is. The place to start from in the decode source is this: <code>func (d *decodeState) unmarshal(v interface{}) (err error) {</code>, from that point on, it's pretty self-explanatory.</p>\n"}, {"tags": [], "owner": {"reputation": 6641, "user_id": 121725, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/149e29e5d24dde5c8ec5a146c4594348?s=128&d=identicon&r=PG", "display_name": "cerberos", "link": "https://stackoverflow.com/users/121725/cerberos"}, "is_accepted": false, "score": 0, "last_activity_date": 1539343494, "creation_date": 1539343494, "answer_id": 52778525, "question_id": 35604356, "link": "https://stackoverflow.com/questions/35604356/json-unmarshal-accepts-a-pointer-to-a-pointer/52778525#52778525", "title": "json.Unmarshal() accepts a pointer to a pointer", "body": "<p>As other answers have said, pointers are followed.</p>\n\n<p>A little weird that this errors (nil pointer), but makes sense when you think about it.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n)\n\ntype MyStruct struct {\n    A string `json:\"a\"`\n}\n\nfunc main() {\n    data := []byte(`{\"a\":\"foo\"}`)\n    var a *MyStruct\n    err := json.Unmarshal(data, a)  // nil ptr\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(a)\n}\n</code></pre>\n\n<p>But this doesn't error (pointer to nil pointer).</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n)\n\ntype MyStruct struct {\n    A string `json:\"a\"`\n}\n\nfunc main() {\n    data := []byte(`{\"a\":\"foo\"}`)\n    var a *MyStruct\n    err := json.Unmarshal(data, &amp;a) // **MyStruct, ptr to nil ptr\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(a)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/eI8jqWZOmGW\" rel=\"nofollow noreferrer\">https://play.golang.org/p/eI8jqWZOmGW</a></p>\n"}], "owner": {"reputation": 29724, "user_id": 93995, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/35752f1794d9a5f8ab8fe8edf272f0cc?s=128&d=identicon&r=PG", "display_name": "George Armhold", "link": "https://stackoverflow.com/users/93995/george-armhold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3869, "favorite_count": 5, "accepted_answer_id": 35607026, "answer_count": 3, "score": 6, "last_activity_date": 1539343494, "creation_date": 1456322780, "last_edit_date": 1456327272, "question_id": 35604356, "link": "https://stackoverflow.com/questions/35604356/json-unmarshal-accepts-a-pointer-to-a-pointer", "title": "json.Unmarshal() accepts a pointer to a pointer", "body": "<p>I noticed, quite by accident, that I can successfully pass both a pointer to a struct, and a pointer to a pointer to a struct to <code>json.Unmarshal()</code>, and both work just fine:</p>\n\n<pre><code>package main\n\nimport (\n    \"testing\"\n    \"encoding/json\"\n)\n\ntype Person struct {\n    Name string\n    Age  int\n}\n\nfunc TestMarshaling(t *testing.T) {\n    foo := &amp;Person{Name: \"bob\", Age: 23}\n\n    // marshal it to bytes\n    b, err := json.Marshal(foo)\n    if err != nil {\n        t.Error(err)\n    }\n\n    bar := &amp;Person{}             // pointer to new, empty struct\n    err = json.Unmarshal(b, bar) // unmarshal to bar, which is a *Person\n    if err != nil {\n        t.Error(err)\n    }\n    testBob(t, bar)  // ok\n\n    bar = &amp;Person{}               // pointer to new, empty struct\n    err = json.Unmarshal(b, &amp;bar) // wait a minute, passing in a **Person, yet it still works?\n    if err != nil {\n        t.Error(err)\n    }\n    testBob(t, bar) // ok\n}\n\nfunc testBob(t *testing.T, person *Person) {\n    if person.Name != \"bob\" || person.Age != 23 {\n        t.Error(\"not equal\")\n    }\n}\n</code></pre>\n\n<p>I was really surprised that the second one (unmarshal to <code>**Person</code>) worked. </p>\n\n<p>What's going on in <code>json.Unmarshal()</code>? Is it dereferencing the pointers until it finds a struct?</p>\n\n<p>The documentation offers:</p>\n\n<blockquote>\n  <p>To unmarshal JSON into a pointer, Unmarshal first handles the case of\n  the JSON being the JSON literal null.  In that case, Unmarshal sets\n  the pointer to nil.  Otherwise, Unmarshal unmarshals the JSON into the\n  value pointed at by the pointer</p>\n</blockquote>\n\n<p>It seems to be doing a bit more than that. What's really going on?</p>\n\n<p><strong>Fleshing out my question more</strong>: how does it know to automatically dereference my pointer to a pointer? The documentation says it will unmarshal \"into the value pointed at by the pointer\". Since the value of my pointer is in fact another pointer, and has no Name/Age fields, I expected it to stop there.</p>\n\n<p>To be clear: I'm not saying there's a bug or misfeature in <code>Unmarshal()</code>; I'm trying to satisfy my astonishment that it works at all when given a ptr-to-ptr, and avoid any potential pitfalls in my use of it.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1456340165, "post_id": 35604138, "comment_id": 58905488, "body": "What is the error or output from your go app?"}, {"owner": {"reputation": 925, "user_id": 94416, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c6bdec5132fd3906e89001ad195df15b?s=128&d=identicon&r=PG", "display_name": "Chadit", "link": "https://stackoverflow.com/users/94416/chadit"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456342716, "post_id": 35604138, "comment_id": 58906948, "body": "I only get an error when I try to start the service... it is &quot;could not start service: the service did not response to the start or control request in a timely fashion.&quot;  if I run in debug or install/remove it works fine"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1456342986, "post_id": 35604138, "comment_id": 58907096, "body": "You need to find the error that happens when you start the service. For example, is there a permissions problem reading a config file?"}, {"owner": {"reputation": 925, "user_id": 94416, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c6bdec5132fd3906e89001ad195df15b?s=128&d=identicon&r=PG", "display_name": "Chadit", "link": "https://stackoverflow.com/users/94416/chadit"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456513895, "post_id": 35604138, "comment_id": 58999873, "body": "I am still working on it with no luck :(  everything I add to a fun Init on the main.go results in this error  &quot;**** service failed to start due to the following error: The service did not respond to the start or control request in a timely fashion.&quot;  I am very new to go, so besides elog and log I am not sure what else to do to find the issue."}], "answers": [{"tags": [], "owner": {"reputation": 925, "user_id": 94416, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c6bdec5132fd3906e89001ad195df15b?s=128&d=identicon&r=PG", "display_name": "Chadit", "link": "https://stackoverflow.com/users/94416/chadit"}, "is_accepted": false, "score": 1, "last_activity_date": 1456534562, "creation_date": 1456534562, "answer_id": 35664376, "question_id": 35604138, "link": "https://stackoverflow.com/questions/35604138/golang-windows-service-package-initialize-settings/35664376#35664376", "title": "golang windows service package initialize settings", "body": "<p>@JimB thank you.  that was it, </p>\n\n<p>running in debug it looks in the folder that the exe is in, \nwhen running in service it looks in the system32 folder.  </p>\n\n<p>I installed github.com/kardianos/osext \nand used the func ExecutableFolder() to get back to the main folder of the exe file.  Which then allowed it to find my config file and load.</p>\n"}], "owner": {"reputation": 925, "user_id": 94416, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c6bdec5132fd3906e89001ad195df15b?s=128&d=identicon&r=PG", "display_name": "Chadit", "link": "https://stackoverflow.com/users/94416/chadit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 851, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456534562, "creation_date": 1456322164, "question_id": 35604138, "link": "https://stackoverflow.com/questions/35604138/golang-windows-service-package-initialize-settings", "title": "golang windows service package initialize settings", "body": "<p>I am trying to create a golang windows service utilizing this package</p>\n\n<pre><code>godoc.org/golang.org/x/sys/windows/svc\n</code></pre>\n\n<p>Everything works great until I add an init func to initialize settings. The service then fails to start.  I am attempting to load config.json via this package</p>\n\n<pre><code>github.com/spf13/viper\n</code></pre>\n\n<p>The error I get then is:</p>\n\n<p>could not start service: the service did not response to the start or control request in a timely fashion.</p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1456324648, "post_id": 35604064, "comment_id": 58894591, "body": "Further, if <code>ExecuteTemplate</code> encounters an error when writing, it has already written the status code and response headers. <code>http.Error</code> can&#39;t change them. You can work around this by executing into a buffer first and then writing out to the response (<a href=\"http://elithrar.github.io/article/approximating-html-template-inheritance/#error-handling\" rel=\"nofollow noreferrer\">see here for a how-to</a>)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1456322384, "last_edit_date": 1456322384, "creation_date": 1456321912, "answer_id": 35604064, "question_id": 35603131, "link": "https://stackoverflow.com/questions/35603131/multiple-response-writeheader-calls/35604064#35604064", "title": "Multiple response.WriteHeader calls", "body": "<p>The root problem is that you pass a slice of <code>Chnl</code> to the template:</p>\n\n<pre><code>var result  []models.Chnl\n// ...\nrenderTemplate(w, \"edit\", \"base\", result)\n</code></pre>\n\n<p>And inside <code>renderTemplate()</code> param value of <code>viewModel</code> will be <code>result</code>.</p>\n\n<p>And in your templates you refer to fields of the dot like if it would be a <code>Chnl</code> value and not a slice of it: <code>{{.Title}}</code>. So the first attempt to resolve it will fail.</p>\n\n<p>Logging the errors is useful, so change your logging to also print the actual error, not just a generic error:</p>\n\n<pre><code>log.Printf(\"Temlate error here: %v\", err)\n</code></pre>\n\n<p>Which results in:</p>\n\n<blockquote>\n  <p>2016/02/24 14:57:09 Temlate error here: template: edit.html:4:30: executing \"body\" at &lt;.Title>: can't evaluate field Title in type []main.Chnl</p>\n</blockquote>\n\n<p>I think you just want to pass 1 <code>Chnl</code> value and not a slice of them. In <code>EditNote()</code>:</p>\n\n<pre><code>if len(result) &gt; 0 {\n    renderTemplate(w, \"edit\", \"base\", result[0])\n}\n</code></pre>\n\n<p>Next, know that <a href=\"https://golang.org/pkg/net/http/#Error\" rel=\"nofollow\"><code>http.Error()</code></a> writes content to the response. This means you cannot write further header values to the response. Usually when you call <code>http.Error()</code> in your handler, you should return without doing anything with the response:</p>\n\n<pre><code>if !ok {\n    http.Error(w, \"The template does not exist.\", http.StatusInternalServerError)\n    return // NOTE THIS RETURN\n}\n</code></pre>\n\n<p>Similarly, after all your <code>http.Error()</code> call insert a <code>return</code>. You may do some cleanup, but response should not be touched after <code>http.Error()</code>.</p>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1090, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1500204099, "creation_date": 1456319345, "last_edit_date": 1500204099, "question_id": 35603131, "link": "https://stackoverflow.com/questions/35603131/multiple-response-writeheader-calls", "title": "Multiple response.WriteHeader calls", "body": "<p>I am new to go and have difficulty rendring templates. </p>\n\n<p>Here is my functions that are to generate template:</p>\n\n<p>base.html</p>\n\n<pre><code>//Render templates for the given name, template definition and data object\nfunc renderTemplate(w http.ResponseWriter, name string, template string, viewModel interface{}) {\n    // Ensure the template exists in the map.\n    tmpl, ok := templates[name]\n    if !ok {\n        http.Error(w, \"The template does not exist.\", http.StatusInternalServerError)\n    }\n    err := tmpl.ExecuteTemplate(w, template, viewModel)\n    if err != nil {\n    log.Printf(\"temlate error here\")\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    }\n}\n\n\n func EditNote(w http.ResponseWriter, r *http.Request) {\n    //var viewModel models.EditChnl\n    vars := mux.Vars(r)\n    //ch := bson.M{\"id\": \"Ale\"}\n    title := vars[\"title\"]\n    log.Printf(\"%v\\n\", title)\n    session, err := mgo.Dial(\"localhost\")\n    if err != nil {\n      panic(err)\n    }\n        defer session.Close()\n        session.SetMode(mgo.Monotonic, true)\n        c := session.DB(\"tlgdb\").C(\"chnls\")\n        log.Printf(\"title is %s \\n\", title)\n        var result  []models.Chnl\n        err = c.Find(bson.M{\"title\": \"xxx\"}).All(&amp;result)\n        log.Printf(\"%v\\n\", result)\n\n        if err != nil {\n          log.Printf(\"doc not found\")\n          log.Fatal(err)\n          return\n        }\n    renderTemplate(w, \"edit\", \"base\", result)\n}\n</code></pre>\n\n<p>And here are the templates:</p>\n\n<pre><code>{{define \"base\"}}\n&lt;html&gt;\n  &lt;head&gt;\n    {{template \"head\" .}}\n  &lt;/head&gt;\n  &lt;body&gt;\n\n    {{template \"body\" .}}\n\n  &lt;/body&gt;\n&lt;/html&gt;\n{{end}}\n</code></pre>\n\n<p>edit.thml</p>\n\n<pre><code>{{define \"head\"}}&lt;title&gt;Edit Note&lt;/title&gt;{{end}}\n{{define \"body\"}}\n&lt;h1&gt;Edit Note&lt;/h1&gt;\n&lt;form action=\"/chnls/update/{{.Title}}\" method=\"post\"&gt;\n&lt;p&gt;Title:&lt;br&gt; &lt;input type=\"text\" value=\"{{.Title}}\" name=\"title\"&gt;&lt;/p&gt;\n&lt;p&gt;Description:&lt;br&gt; &lt;textarea rows=\"4\" cols=\"50\" name=\"description\"&gt;{{.Description}}&lt;/textarea&gt; &lt;/p&gt;\n&lt;p&gt;&lt;input type=\"submit\" value=\"submit\"/&gt;&lt;/p&gt;\n&lt;/form&gt;\n{{end}}\n</code></pre>\n\n<p>The objects to render are:</p>\n\n<pre><code>type Chnl struct {\n    Id    bson.ObjectId `json:\"id\"  bson:\"_id,omitempty\"`\n    Title       string\n    Description string\n    CreatedOn   time.Time\n    Creator     string\n    Visits  int\n    Score       int\n}\n</code></pre>\n\n<p>The object that I'm trying to render exists in mongodb and I can print it out in console:</p>\n\n<pre><code>[{ObjectIdHex(\"56cc4493bc54f4245cb4d36b\") sometitle blabla 2016-02-23 12:37:55.972 +0100 CET blabla 0 0}]\n</code></pre>\n\n<p>However I get this error:</p>\n\n<pre><code>temlate error here\nhttp: multiple response.WriteHeader calls\n</code></pre>\n\n<p>I'm wondering what is wrong here and how to fix it?</p>\n"}, {"tags": ["go", "concurrency", "deadlock", "channel"], "answers": [{"tags": [], "owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "is_accepted": true, "score": 1, "last_activity_date": 1456317843, "creation_date": 1456317843, "answer_id": 35602585, "question_id": 35602060, "link": "https://stackoverflow.com/questions/35602060/how-can-i-have-one-buffered-channel-and-multiple-readers-without-producing-a-dea/35602585#35602585", "title": "How can I have one buffered channel and multiple readers without producing a deadlock?", "body": "<p>You should to close channel before <code>wg.Wait</code>.<br>\nAll your receivers are waiting for data from channel. That's why you have deadlock.<br>\nYou can close channel at <code>defer</code> statement of <code>sender</code> function.<br>\nAlso you need to <code>wg.Done()</code> if the first attempt of receiving from channel was unsuccessful (because channel already closed)</p>\n\n<p><a href=\"http://play.golang.org/p/qdEIEfY-kl\" rel=\"nofollow\">http://play.golang.org/p/qdEIEfY-kl</a></p>\n"}, {"tags": [], "owner": {"reputation": 1183, "user_id": 2959387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459784500061e41da68ed5af11f92183?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Thakkar", "link": "https://stackoverflow.com/users/2959387/prashant-thakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1456318857, "creation_date": 1456318857, "answer_id": 35602931, "question_id": 35602060, "link": "https://stackoverflow.com/questions/35602060/how-can-i-have-one-buffered-channel-and-multiple-readers-without-producing-a-dea/35602931#35602931", "title": "How can I have one buffered channel and multiple readers without producing a deadlock?", "body": "<p>There are couple of things:</p>\n\n<ol>\n<li>You need to close the channel once sender is completed.</li>\n<li>In receiver, range over channel</li>\n<li>Don't need to add 1 to wait group and call Done in sender</li>\n</ol>\n\n<p>Please refer to <a href=\"http://play.golang.org/p/vz39RY6WA7\" rel=\"nofollow\">http://play.golang.org/p/vz39RY6WA7</a></p>\n"}], "owner": {"reputation": 111, "user_id": 5160937, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-CTaThgLXQ6Y/AAAAAAAAAAI/AAAAAAAAADE/kxPAFcOgtFM/photo.jpg?sz=128", "display_name": "Vinay Sawant", "link": "https://stackoverflow.com/users/5160937/vinay-sawant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 1, "accepted_answer_id": 35602585, "answer_count": 2, "score": 1, "last_activity_date": 1456319176, "creation_date": 1456316386, "last_edit_date": 1456319176, "question_id": 35602060, "link": "https://stackoverflow.com/questions/35602060/how-can-i-have-one-buffered-channel-and-multiple-readers-without-producing-a-dea", "title": "How can I have one buffered channel and multiple readers without producing a deadlock?", "body": "<blockquote>\n  <p>FATAL Error All go routines are asleep. Deadlock.</p>\n</blockquote>\n\n<p>This is what I tried. I am calling <code>wg.Done()</code>. What is missing?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n    \"sync\"\n)\n\nfunc sender(wg *sync.WaitGroup, cs chan int) {\n    defer wg.Done()\n    for i := 0; i &lt; 2; i++ {\n        fmt.Println(i)\n        cs &lt;- i\n    }\n}\n\nfunc reciever(wg *sync.WaitGroup, cs chan int) {\n    x, ok := &lt;-cs\n    for ok {\n        fmt.Println(\"Retrieved\" + strconv.Itoa(x))\n        x, ok = &lt;-cs\n        if !ok {\n            wg.Done()\n            break\n        }\n    }\n}\n\nfunc main() {\n    wg := &amp;sync.WaitGroup{}\n    cs := make(chan int, 1000)\n    wg.Add(1)\n    go sender(wg, cs)\n    for i := 1; i &lt; 30; i++ {\n        wg.Add(1)\n        go reciever(wg, cs)\n    }\n    wg.Wait()\n    close(cs)\n}\n</code></pre>\n"}, {"tags": ["pointers", "go", "struct"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1456310562, "post_id": 35599597, "comment_id": 58884364, "body": "<i>&quot;everytime when I then try to use this function I get this error and the program crashes&quot;</i> You should probably include the calling code in your question."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1456311193, "post_id": 35599597, "comment_id": 58884764, "body": "Probably you are calling <code>Message</code> on a nil bot which is basically the same as calling a method on a null object e.g. in Java. So this has nothing to do with pointers, &amp; and * but you forgot to properly build a bot before invoking methods on it."}], "answers": [{"comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1456311365, "post_id": 35600061, "comment_id": 58884871, "body": "Couldn&#39;t the error be a result of <code>fmt.Fprintf(bot.conn</code> in <code>Message</code> on a <code>Bot</code> that he thought he had connected, but actually didn&#39;t because of how <code>Connect</code> is written?"}, {"owner": {"reputation": 1282, "user_id": 3648229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6b730f6984c01d9409a83abacb234580?s=128&d=identicon&r=PG", "display_name": "gempir", "link": "https://stackoverflow.com/users/3648229/gempir"}, "edited": false, "score": 0, "creation_date": 1456311749, "post_id": 35600061, "comment_id": 58885181, "body": "I have removed newBot() from the connect function because it didn&#39;t make much sense to me to create a new instance there.  And the connection still works but the conn seems to be empty for when I call Message()"}, {"owner": {"reputation": 38917, "user_id": 445210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b689cc1d73c4f1e7378d045a54abcca?s=128&d=identicon&r=PG", "display_name": "Herman Schaaf", "link": "https://stackoverflow.com/users/445210/herman-schaaf"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1456311838, "post_id": 35600061, "comment_id": 58885250, "body": "@Michael I&#39;m speculating a bit with the error, but yeah, my best guess it&#39;s because something is being called on an uninstantiated bot. Could be <code>bot.conn</code>, as you said"}, {"owner": {"reputation": 1282, "user_id": 3648229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6b730f6984c01d9409a83abacb234580?s=128&d=identicon&r=PG", "display_name": "gempir", "link": "https://stackoverflow.com/users/3648229/gempir"}, "edited": false, "score": 0, "creation_date": 1456312147, "post_id": 35600061, "comment_id": 58885494, "body": "I&#39;ve updated my question with the solution. Thank you very much guys. Really fast and good help"}], "tags": [], "owner": {"reputation": 38917, "user_id": 445210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b689cc1d73c4f1e7378d045a54abcca?s=128&d=identicon&r=PG", "display_name": "Herman Schaaf", "link": "https://stackoverflow.com/users/445210/herman-schaaf"}, "is_accepted": true, "score": 4, "last_activity_date": 1456311146, "creation_date": 1456311146, "answer_id": 35600061, "question_id": 35599597, "link": "https://stackoverflow.com/questions/35599597/structs-in-go-and-working-with-pointers/35600061#35600061", "title": "Structs in go and working with pointers", "body": "<p>The issue here seems to be with the <code>Connect</code> method, and not really with pointers in particular:</p>\n\n<pre><code>func (bot *Bot) Connect() (conn net.Conn, err error) {\n    ircbot := NewBot()\n    conn, err = net.Dial(\"tcp\", bot.server+\":\"+bot.port)\n    // irc connection...\n    return bot.conn, nil\n}\n</code></pre>\n\n<p>The method is defined to be on (a pointer to the) Bot struct, but it  creates a new <code>Bot</code>, on this line:</p>\n\n<pre><code>ircbot := NewBot()\n</code></pre>\n\n<p>and then proceeds to use the one the method is defined on (called <code>bot</code>, not <code>ircbot</code>). If you choose to keep it so that there are separate <code>NewBot</code> and <code>Connect</code> functions (which is fine), then you should change it so that <code>Connect</code> actually uses an instantiated <code>*Bot</code>:</p>\n\n<pre><code>func (bot *Bot) Connect() (conn net.Conn, err error) {\n    conn, err = net.Dial(\"tcp\", bot.server+\":\"+bot.port)\n    // irc connection...\n    return bot.conn, nil\n}\n</code></pre>\n\n<p>and call it with something like this:</p>\n\n<pre><code>bot := NewBot()\nconn, err := bot.Connect()\n</code></pre>\n\n<p>The error,</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n</code></pre>\n\n<p>is probably because you are accessing <code>bot</code> in the <code>Connect</code> method (e.g. in <code>bot.server</code>) but it has not been defined, and the pointer is nil.</p>\n"}], "owner": {"reputation": 1282, "user_id": 3648229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6b730f6984c01d9409a83abacb234580?s=128&d=identicon&r=PG", "display_name": "gempir", "link": "https://stackoverflow.com/users/3648229/gempir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 35600061, "answer_count": 1, "score": 0, "last_activity_date": 1456312115, "creation_date": 1456309914, "last_edit_date": 1456312115, "question_id": 35599597, "link": "https://stackoverflow.com/questions/35599597/structs-in-go-and-working-with-pointers", "title": "Structs in go and working with pointers", "body": "<p>I am trying my hand on my first go program which is supposed to be a very simple IRC bot. </p>\n\n<p>I have the part of the connections etc done but I am confused with structs and pointers such. The structs are new to me coming from languages that use classes.</p>\n\n<p>I have this struct and the constructor for it:</p>\n\n<pre><code>type Bot struct {\n    server  string\n    port    string\n    nick    string\n    channel string\n    pass    string\n    conn    net.Conn\n}\n\n// NewBot main config\nfunc NewBot() *Bot {\n    return &amp;Bot{\n        server:  \"irc.twitch.tv\",\n        port:    \"6667\",\n        nick:    \"username\",\n        channel: \"#channel\",\n        pass:    \"password123\",\n        conn:    nil,\n    }\n}\n</code></pre>\n\n<p>My connect() method looks like this </p>\n\n<pre><code>func (bot *Bot) Connect() (conn net.Conn, err error) {\n    ircbot := NewBot()\n    conn, err = net.Dial(\"tcp\", bot.server+\":\"+bot.port)\n    // irc connection...\n    return bot.conn, nil\n}\n</code></pre>\n\n<p>Everything of that works fine the problem I am having is with another method to my struct named Message. It's just supposed to send a message. Looks like this: </p>\n\n<pre><code>// Message to send a message\nfunc (bot *Bot) Message(message string) {\n    if message == \"\" {\n        return\n    }\n    fmt.Printf(\"Bot: \" + message + \"\\n\")\n    fmt.Fprintf(bot.conn, \"PRIVMSG \"+bot.channel+\" :\"+message+\"\\r\\n\")\n}\n</code></pre>\n\n<p>everytime when I then try to use this function I get this error and the program crashes</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xc0000005 code=0x0 addr=0x20 pc=0x463d73]\n</code></pre>\n\n<p>I'm unsure about how to use the &amp; and * signs correctly to achieve what I want to do. </p>\n\n<p>I thought a goroutine is something that is for multithreading and is done by saying \"go [do something]\" but I don't use that anywhere.</p>\n\n<p>Edit:\n<strong>Solution</strong></p>\n\n<p>Thanks I found the solution! For those interested: \nI created a new instance of Bot in the place where I called the Message() function which resulted in an empty conn. </p>\n\n<p>This was the important bit, I stupidly didn't post here. handle() wasn't even a method of Bot which is even more stupid of me.</p>\n\n<pre><code>func handle(line string) {\n    ircbot := NewBot();\n    // get username, message etc...\n    ircbot .CmdInterpreter(username[1], usermessage)\n}\n</code></pre>\n\n<p>and this is the correct way:</p>\n\n<pre><code>func (bot *Bot) handle(line string) {\n    // get username, message etc...\n    bot.CmdInterpreter(username[1], usermessage)\n}\n</code></pre>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1456308632, "post_id": 35599050, "comment_id": 58882913, "body": "I don&#39;t think so. You cannot send any more headers. If you did specify a Content-Length upfront, at least that should make it clear that the response was incomplete. Otherwise the client has to infer that from the content itself."}], "answers": [{"tags": [], "owner": {"reputation": 27763, "user_id": 550618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dbbc19034f22896982dd7acee33ab26?s=128&d=identicon&r=PG", "display_name": "regilero", "link": "https://stackoverflow.com/users/550618/regilero"}, "is_accepted": true, "score": 2, "last_activity_date": 1456311696, "creation_date": 1456311696, "answer_id": 35600271, "question_id": 35599050, "link": "https://stackoverflow.com/questions/35599050/correct-way-to-notify-http-client-of-error-after-partial-response-has-been-sent/35600271#35600271", "title": "Correct way to notify http client of error after partial response has been sent in golang http", "body": "<p>I'm afraid you'll have to add a protocol upon the protocol.\nLike using ajax, sending short json responses with your own OK/Continue/Abort status messages.</p>\n\n<p>There is nothing in HTTP to handle that (there is something with the 100-Continue in client to server, badly implmented and not made for server to client), unless maybe sending chunked responses and never sending the last chunk (so the whole response will timeout).</p>\n\n<p>With the ajax solution you'll also be able to start showing the results before the end.</p>\n\n<p>Managing you own chunks upon HTTp is usually the simpliest solution, see for exampe the file uploaders, they will split files in chunks using js and recompose the file server-side.</p>\n\n<p>Trying to manage all the mess that a reverse proxy or a proxy could inject in your big HTTP messages communications (think that until recently Nginx reverse proxy would not stream responses, and use a buffered message).</p>\n"}], "owner": {"reputation": 3236, "user_id": 84262, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/4da91f318709a6f62705f0dd33826e14?s=128&d=identicon&r=PG", "display_name": "Nick Sonneveld", "link": "https://stackoverflow.com/users/84262/nick-sonneveld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 0, "accepted_answer_id": 35600271, "answer_count": 1, "score": 1, "last_activity_date": 1456311696, "creation_date": 1456308499, "question_id": 35599050, "link": "https://stackoverflow.com/questions/35599050/correct-way-to-notify-http-client-of-error-after-partial-response-has-been-sent", "title": "Correct way to notify http client of error after partial response has been sent in golang http", "body": "<p>What is the correct behaviour for an http server if an error occurs while writing a streaming response to the client. The client has already received status code 200 so it thinks it is okay. Can the server still terminate the connection in such a way to notify the client that an error occurred or should it return something in the response body?</p>\n\n<p>I am streaming many rows from a database so I would prefer not to batch before sending to client.</p>\n\n<p>An example in golang:</p>\n\n<pre><code>func streamingHandler(s ServerSettings, db *sql.DB) http.Handler {\n\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n\n        w.Header().Set(\"Content-Type\", \"application/json-seq\")\n\n        w.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n\n        _, err = fmt.Fprintf(w, \"\\u001E[1,2,3]\\n\", item)\n\n        if err != nil {\n            http.Error(w, err.Error(), 500)\n            return\n        }\n\n        _, err = fmt.Fprintf(w, \"\\u001E[1,2,3]\\n\", item)\n\n        //  the error could be from Fprintf or a database error.\n\n        //  What happens if error occurs here.. the client has already received header and some response\n\n        if err != nil {\n            http.Error(w, err.Error(), 500)\n            return\n        }\n        ... \n        etc\n    })\n\n}\n</code></pre>\n"}, {"tags": ["json", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "edited": false, "score": 0, "creation_date": 1456306306, "post_id": 35598102, "comment_id": 58881210, "body": "Preferably you would log the <code>string(rawdata)</code>  instead of <code>data</code>. Json can easily be parsed and it is also quite readable."}, {"owner": {"reputation": 127, "user_id": 1215033, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c34326c9e14969b65e37b7d388ad061?s=128&d=identicon&r=PG", "display_name": "aspirant75", "link": "https://stackoverflow.com/users/1215033/aspirant75"}, "reply_to_user": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "edited": false, "score": 0, "creation_date": 1456355033, "post_id": 35598102, "comment_id": 58913614, "body": "I would like response data into struct type. Like below answer."}, {"owner": {"reputation": 6953, "user_id": 4541045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfffa01cff641ad93fa459b26d3cdb4?s=128&d=identicon&r=PG&f=1", "display_name": "ti7", "link": "https://stackoverflow.com/users/4541045/ti7"}, "edited": false, "score": 0, "creation_date": 1474265453, "post_id": 35598102, "comment_id": 66443134, "body": "If an answer answered your question, please mark it as the answer."}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 1215033, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c34326c9e14969b65e37b7d388ad061?s=128&d=identicon&r=PG", "display_name": "aspirant75", "link": "https://stackoverflow.com/users/1215033/aspirant75"}, "edited": false, "score": 0, "creation_date": 1456366183, "post_id": 35599969, "comment_id": 58917101, "body": "I did a test as your reply. But it prints none -&quot; &lt;nil&gt; {[{0  } {0  } {0  }]} &quot;"}, {"owner": {"reputation": 127, "user_id": 1215033, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c34326c9e14969b65e37b7d388ad061?s=128&d=identicon&r=PG", "display_name": "aspirant75", "link": "https://stackoverflow.com/users/1215033/aspirant75"}, "edited": false, "score": 0, "creation_date": 1456381786, "post_id": 35599969, "comment_id": 58922454, "body": "I did a test successfully. The problem was due to Naming. I named struct field UpperCase like Id, Guid, Name. Thanks for your help."}], "tags": [], "owner": {"reputation": 623, "user_id": 5615224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7bea88308ec27975167f216eb8f998e?s=128&d=identicon&r=PG&f=1", "display_name": "sfault", "link": "https://stackoverflow.com/users/5615224/sfault"}, "is_accepted": false, "score": 0, "last_activity_date": 1456312832, "last_edit_date": 1456312832, "creation_date": 1456310882, "answer_id": 35599969, "question_id": 35598102, "link": "https://stackoverflow.com/questions/35598102/golang-type-conversion-interface-to-struct/35599969#35599969", "title": "golang type conversion. interface to struct", "body": "<p>You are getting an Array, Unmarshal it using the <code>encoding/json</code> package.</p>\n\n<pre><code>type ResultStruct struct {\n    id int      `json:\"id\"`\n    guid string `json:\"guid\"`\n    name string `json:\"name\"`\n}\ntype Result struct {\n    Data []ResultStruct `json:\"data\"`\n}\n\nresponse := httpClient.Do(request)\nvar data Result\ndecErr := json.NewDecoder(response.body).Decode(&amp;data)\nfmt.Println(decErr, data)\n</code></pre>\n\n<p>This should Unmarshal the data into array.</p>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 1215033, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c34326c9e14969b65e37b7d388ad061?s=128&d=identicon&r=PG", "display_name": "aspirant75", "link": "https://stackoverflow.com/users/1215033/aspirant75"}, "edited": false, "score": 0, "creation_date": 1456388750, "post_id": 35621053, "comment_id": 58926007, "body": "Thanks for your kind explanation. Now i got it."}], "tags": [], "owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "is_accepted": false, "score": 2, "last_activity_date": 1456386105, "last_edit_date": 1456386105, "creation_date": 1456385738, "answer_id": 35621053, "question_id": 35598102, "link": "https://stackoverflow.com/questions/35598102/golang-type-conversion-interface-to-struct/35621053#35621053", "title": "golang type conversion. interface to struct", "body": "<p>It is a common mistake for new Go programmers.</p>\n\n<p>Because of language design, <code>json.Unmarshal</code> can only marshal into <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow\"><em>exported</em></a> fields.</p>\n\n<p>Simply capitalize the first letter of each field name to export them. Optionally you may add field tags to tell json.Marshal what key-name to use. This is only needed if you are going to use <code>json.Marshal</code>.</p>\n\n<pre><code>type ResultStruct struct{\n    Id   int    `json:\"id\"`\n    Guid string `json:\"guid\"`\n    Name string `json:\"name\"`\n}\n</code></pre>\n\n<p>To quote the <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow\"><code>encoding/json</code> package</a>:</p>\n\n<blockquote>\n  <p>To unmarshal JSON into a struct, Unmarshal matches incoming object\n  keys to the keys used by Marshal (either the struct field name or its\n  tag), preferring an exact match but also accepting a case-insensitive\n  match. <em>Unmarshal will only set exported fields of the struct.</em></p>\n</blockquote>\n"}], "owner": {"reputation": 127, "user_id": 1215033, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c34326c9e14969b65e37b7d388ad061?s=128&d=identicon&r=PG", "display_name": "aspirant75", "link": "https://stackoverflow.com/users/1215033/aspirant75"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3349, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1474274043, "creation_date": 1456305986, "last_edit_date": 1474274043, "question_id": 35598102, "link": "https://stackoverflow.com/questions/35598102/golang-type-conversion-interface-to-struct", "title": "golang type conversion. interface to struct", "body": "<p>I am not used to <code>golang</code>. </p>\n\n<p>When I requested, I got the below log.</p>\n\n<p>I would like to parse the log and store into <code>struct</code> type.</p>\n\n<p>Someone lets me know how to do?</p>\n\n<p>Thanks in advance.</p>\n\n<h2>for example :</h2>\n\n<pre><code>type ResultStruct struct{\n    id int\n    guid string\n    name string\n}\n\nfor k, v := range data {\n    fmt.Print(v.id) fmt.Print(v.guid) fmt.Print(v.name)\n}\n</code></pre>\n\n<p><strong>[log]</strong></p>\n\n<blockquote>\n  <p>data: [map[id:90001 guid:a name:test1] map[guid:b name:test2 id:90002] map[name:test3 id:90003 guid:c]]</p>\n</blockquote>\n\n<p><b>[source]</b></p>\n\n<pre><code>response := httpClient.Do(request)\nvar data interface{}\nrawdata, err := ioutil.ReadAll(response.body)\njson.Unmarshal(rawdata, &amp;data)\nfmt.Println(\"data :\", data)\n</code></pre>\n"}, {"tags": ["go", "compilation"], "answers": [{"tags": [], "owner": {"reputation": 806, "user_id": 2547389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f943f94b1bfe169a3291c5b94b7f938a?s=128&d=identicon&r=PG", "display_name": "wlredeye", "link": "https://stackoverflow.com/users/2547389/wlredeye"}, "is_accepted": false, "score": 3, "last_activity_date": 1456303150, "last_edit_date": 1456303150, "creation_date": 1456302722, "answer_id": 35596968, "question_id": 35596415, "link": "https://stackoverflow.com/questions/35596415/can-i-control-static-or-dynamic-library-linking-while-compilation-does-each-cre/35596968#35596968", "title": "Can I control static or dynamic library linking while compilation? Does each create diff. binary sizes?", "body": "<p>By default Go uses static linking so everything (your code and packages sources) compiles in one big binary.</p>\n\n<p>Since Go 1.5 released you can compile Go shared library using <code>-buildmode=shared</code> option for <code>go build</code> or <code>go install</code>. Then you can compile your app binary with <code>-linkshared</code> flag. Details can be found <a href=\"https://golang.org/s/execmodes\" rel=\"nofollow\">here</a>.</p>\n\n<p>Ofcourse, if you link packages dynamically your binary size will be less than with static linking, but total application size will not be reduced because you just \"put your code in other place\".\nSo dynamic linking makes sense only if you need to share the same packages between different apps.</p>\n"}], "owner": {"reputation": 5000, "user_id": 829796, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/ZNyzI.png?s=128&g=1", "display_name": "securecurve", "link": "https://stackoverflow.com/users/829796/securecurve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1030, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1610824388, "creation_date": 1456300913, "last_edit_date": 1610824388, "question_id": 35596415, "link": "https://stackoverflow.com/questions/35596415/can-i-control-static-or-dynamic-library-linking-while-compilation-does-each-cre", "title": "Can I control static or dynamic library linking while compilation? Does each create diff. binary sizes?", "body": "<p>In one of the Go seminars, the lecturer said that when he compiled the Go application, statically linked, the size of the resulting binary was about 600 MB big, but when he compiled the same app with static linking, the resulting binary turned into 10 MB.</p>\n\n<p>I'm not sure what he is talking about, can dynamic vs. static linking during compilation make that difference in space of binary, and do I have control over that?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "edited": false, "score": 0, "creation_date": 1456304308, "post_id": 35596483, "comment_id": 58879820, "body": "&quot;You must specify ProcessItemMinimal when creating a struct literal&quot; how to do that? Getting an error &quot;unknown ProcessItem field &#39;ProcessItemMinimal&#39; in struct literal&quot;"}], "tags": [], "owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "is_accepted": true, "score": 2, "last_activity_date": 1456301747, "last_edit_date": 1456301747, "creation_date": 1456301143, "answer_id": 35596483, "question_id": 35596164, "link": "https://stackoverflow.com/questions/35596164/how-to-access-golang-struct-array-inside-another-struct/35596483#35596483", "title": "How to access golang Struct Array inside another Struct?", "body": "<p>If you are looking for setting the data using <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow\">composite struct literals</a>, it can be done like this:</p>\n\n<pre><code>company.Process = []ProcessItem{\n    ProcessItem{\n        ProcessItemMinimal: ProcessItemMinimal{\n            Process_name: \"Enquiry\",\n            Processtype:  0,\n        },\n        Sortorder: 0,\n    },\n    ProcessItem{\n        ProcessItemMinimal: ProcessItemMinimal{\n            Process_name: \"Converted\",\n            Processtype:  1,\n        },\n        Sortorder: 1,\n    },\n}\n</code></pre>\n\n<p>You must specify <code>ProcessItemMinimal</code> when creating a struct literal because, as <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow\">the Specification</a> says:</p>\n\n<blockquote>\n  <p>Promoted fields act like ordinary fields of a struct except that they\n  cannot be used as field names in composite literals of the struct.</p>\n</blockquote>\n"}], "owner": {"reputation": 1570, "user_id": 5850449, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/7bVFD.jpg?s=128&g=1", "display_name": "Arjun Ajith", "link": "https://stackoverflow.com/users/5850449/arjun-ajith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 35596483, "answer_count": 1, "score": 0, "last_activity_date": 1456301747, "creation_date": 1456300026, "question_id": 35596164, "link": "https://stackoverflow.com/questions/35596164/how-to-access-golang-struct-array-inside-another-struct", "title": "How to access golang Struct Array inside another Struct?", "body": "<p>How can I access the fields of a Struct Array which is inside another Struct?</p>\n\n<p>My Structs as follows:-</p>\n\n<pre><code>type Company struct {\nId              bson.ObjectId `bson:\"_id,omitempty\"`\nCompany_name    string\nAdmin           UserMinimal\nProcess         []ProcessItem\n}\n\ntype ProcessItemMinimal  struct {\nId              bson.ObjectId `bson:\"_id,omitempty\"`\nProcess_name    string\nProcesstype     int64   \n}\n\ntype ProcessItem  struct{\nProcessItemMinimal  `bson:\",inline\"`\nSortorder           int64   \n}\n</code></pre>\n\n<p>I need to store some data in []ProcessItem inside Company struct.\nThe data will be like this. </p>\n\n<pre><code>ProcessItem[0]=Process_name:\"Enquiry\",Processtype:0,Sortorder:0}\nProcessItem[1]=Process_name:\"Converted\",Processtype:1,Sortorder:1}\nProcessItem[2]={Process_name:\"Enquiry\",Processtype:1,Sortorder:2}\n</code></pre>\n"}, {"tags": ["go", "interface", "queue"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1614700612, "last_edit_date": 1614700612, "creation_date": 1456299517, "answer_id": 35596017, "question_id": 35595810, "link": "https://stackoverflow.com/questions/35595810/using-interfaces-to-create-a-queue-for-arbitrary-types/35596017#35596017", "title": "Using Interfaces to Create a Queue for Arbitrary Types", "body": "<p>Don't use pointer to an interface type, just the interface type.</p>\n<p><code>Queuable</code> is an interface type, so everywhere in your code where you used <code>*Queuable</code>, change it to <code>Queuable</code>. For example:</p>\n<pre><code>type Queuable interface {\n    Next() Queuable\n}\n\ntype Node struct {\n    value interface{}\n    next  Queuable\n}\n\n// Next gets the next object\nfunc (n *Node) Next() Queuable {\n    return n.next\n}\n\n...\n</code></pre>\n<p>In Go a value of interface type stores a pair: the concrete value assigned to the variable, and that value's type descriptor.</p>\n<p>More about interface's internals: <a href=\"http://blog.golang.org/laws-of-reflection#TOC_3.\" rel=\"nofollow noreferrer\">The Laws of Reflection #The representation of an interface</a></p>\n<p>So you almost never need a pointer to interface. An interface contains a key-value pair where the key may be a pointer. The rare case when a pointer to interface makes sense is if you want to modify the value of a variable of interface type passed to another function.</p>\n<p>In your example the type <code>*Job</code> implements <code>Queuable</code> because it has a method with receiver type <code>*Job</code>, and so everywhere where a value of <code>Queuable</code> is required, a value of <code>*Job</code> can be used (and an implicit interface value of type <code>Queuable</code> will be created and used).</p>\n<p><strong>Getting back to your example:</strong></p>\n<p>Your <code>Queuable</code> only defines a method to get the next element in the queue, but not one to enqueue it which will make this solution lose flexibility. A single <code>Next()</code> method only describes that it is <em>&quot;queued&quot;</em> but it is not (necessarily) <em>&quot;queuable&quot;</em>.</p>\n<p>To be <em>queuable</em> I would also add another method: <code>SetNext(Queuable)</code></p>\n<pre><code>type Queuable interface {\n    Next() Queuable\n    SetNext(Queuable)\n}\n</code></pre>\n<p>Its implementation on <code>Node</code> can be for example:</p>\n<pre><code>func (n *Node) SetNext(q Queuable) { n.next = q }\n</code></pre>\n<p>Try it on the <a href=\"http://play.golang.org/p/2RCRpV_NBX\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n<p>Also note that there is some code duplication in <code>Node</code> and <code>Job</code>, being the <code>next</code> field and <code>Next()</code> and <code>SetNext()</code> methods. We could create a base node implementation, e.g.:</p>\n<pre><code>type Base struct {\n    next Queuable\n}\n\nfunc (b *Base) Next() Queuable     { return b.next }\nfunc (b *Base) SetNext(q Queuable) { b.next = q }\n</code></pre>\n<p>And now you can embed this <code>Base</code> type in your concrete <code>Node</code> and <code>Job</code> implementations which will &quot;inherit&quot; the <code>next</code> field and <code>Next()</code> and <code>SetNext()</code> methods, so you don't have to define any of these on the <code>Node</code> and <code>Job</code> types.</p>\n<p>This is the full implementation of <code>Node</code> and <code>Job</code>, nothing else is required:</p>\n<pre><code>type Node struct {\n    *Base\n    value interface{}\n}\n\ntype Job struct {\n    *Base\n    instruction string\n}\n</code></pre>\n<p>Try this on the <a href=\"http://play.golang.org/p/Fv9HbYJyhQ\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 9243, "user_id": 1318181, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1ZfAE.png?s=128&g=1", "display_name": "kylieCatt", "link": "https://stackoverflow.com/users/1318181/kyliecatt"}, "edited": false, "score": 0, "creation_date": 1456336705, "post_id": 35596447, "comment_id": 58903418, "body": "Excellent answer as well. This clarified pointers and interfaces for me as well as how they interact."}, {"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "reply_to_user": {"reputation": 9243, "user_id": 1318181, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1ZfAE.png?s=128&g=1", "display_name": "kylieCatt", "link": "https://stackoverflow.com/users/1318181/kyliecatt"}, "edited": false, "score": 0, "creation_date": 1456344926, "post_id": 35596447, "comment_id": 58908259, "body": "No problem, glad that my answer was helpful for you."}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 1, "last_activity_date": 1456301017, "creation_date": 1456301017, "answer_id": 35596447, "question_id": 35595810, "link": "https://stackoverflow.com/questions/35595810/using-interfaces-to-create-a-queue-for-arbitrary-types/35596447#35596447", "title": "Using Interfaces to Create a Queue for Arbitrary Types", "body": "<p><strong>Never use a pointer to an interface type, this is already a pointer!</strong></p>\n\n<p>So to make the code to work change the <code>*Queuable</code> as <code>Queuable</code>.</p>\n\n<pre><code>type Node struct {\n    value interface{}\n    next  Queuable\n}\n\n// Next gets the next object\nfunc (n *Node) Next() Queuable {\n    return n.next\n}\n\n// Job - A job for the queue\ntype Job struct {\n    instruction string\n    next        Queuable\n}\n</code></pre>\n\n<p>However you can use a method receiver as pointer, depending of the struct complexity. Although if the used struct type is simple, you can define the method to use the struct value, this way allocating a new address in memory. If you use the method receiver as a pointer it will reference the address already occupied by the struct in memory. </p>\n\n<p>The rule about pointers vs. values for receivers is that value methods can be invoked on pointers and values, but pointer methods can only be invoked on pointers.</p>\n\n<p>This rule arises because pointer methods can modify the receiver; invoking them on a value would cause the method to receive a copy of the value, so any modifications would be discarded. The language therefore disallows this mistake.</p>\n\n<p>The rule of thumb is that for consistency is better to stick either with method definition as a pointer or method definition as a value along the whole interface implementation.</p>\n"}], "owner": {"reputation": 9243, "user_id": 1318181, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1ZfAE.png?s=128&g=1", "display_name": "kylieCatt", "link": "https://stackoverflow.com/users/1318181/kyliecatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 2, "accepted_answer_id": 35596017, "answer_count": 2, "score": 2, "last_activity_date": 1614700612, "creation_date": 1456298827, "question_id": 35595810, "link": "https://stackoverflow.com/questions/35595810/using-interfaces-to-create-a-queue-for-arbitrary-types", "title": "Using Interfaces to Create a Queue for Arbitrary Types", "body": "<p>As an exercise for learning Go I am writing a basic Queue data structure. I started learning about interfaces yesterday I thought it would be cool to try and use them for this exercise. What I am trying to accomplish is to have a <code>Queue</code> that can accept any type that implements this interface:</p>\n\n<pre><code>type Queuable interface {\n  Next() *Queuable  // This is probably not right\n}\n</code></pre>\n\n<p>Basically what I want is to be able to add any type that has a <code>Next()</code> method to my <code>Queue</code>. So what I tried was:</p>\n\n<pre><code>type Node struct {\n    value interface{}\n    next  *Queuable\n}\n\n// Next gets the next object\nfunc (n *Node) Next() *Queuable {\n    return n.next\n}\n\n// Job - A job for the queue\ntype Job struct {\n    instruction string\n    next        *Queuable\n}\n\n// Next gets the next object\nfunc (j *Job) Next() *Queuable {\n    return j.next\n}\n\n// Queue ...\ntype Queue struct {\n    head *Queuable\n    size int\n}\n</code></pre>\n\n<p>And my methods looking like:</p>\n\n<pre><code>func (q *Queue) Enqueue(node *Queuable) {\n    ...\n}\n\n// Dequeue - Remove a Queueable form the Queue\nfunc (q *Queue) Dequeue() *Queuable {\n  result := q.head\n  q.head = q.head.Next()\n  q.size--\n  return result\n}\n</code></pre>\n\n<p>I'm getting a ton of these errors (basically on any line with an assignment):</p>\n\n<pre><code>current.Next undefined (type *Queuable is pointer to interface, not interface)\n</code></pre>\n\n<p>So ultimately what I would like to do would be:</p>\n\n<pre><code>func main() {\n  queue := NewQueue()  // Helper function not pictured\n  job := &amp;Job{\"some instructions\", nil}\n  node := &amp;Node{5, nil}\n  queue.Enqueue(node)  // queue = [node]\n  queue.Enqueue(job) // queue = [node, job]\n  queue.Dequeue() // node\n  queue.Dequeue() // job\n}\n</code></pre>\n"}, {"tags": ["cookies", "go"], "comments": [{"owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "edited": false, "score": 0, "creation_date": 1456381280, "post_id": 35593920, "comment_id": 58922207, "body": "accounts.google.com doesn&#39;t return anything either."}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 2, "last_activity_date": 1456296118, "creation_date": 1456296118, "answer_id": 35595045, "question_id": 35593920, "link": "https://stackoverflow.com/questions/35593920/how-to-view-the-contents-of-a-cookiejar-in-golang/35595045#35595045", "title": "How to view the contents of a cookieJar in Golang?", "body": "<p>Unfortunately not, the cookie jar in the std library is completely opaque and can be queried via (non-wildcard) URLs only.</p>\n"}, {"tags": [], "owner": {"reputation": 16376, "user_id": 2009616, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/oiCJA.jpg?s=128&g=1", "display_name": "isedev", "link": "https://stackoverflow.com/users/2009616/isedev"}, "is_accepted": false, "score": 0, "last_activity_date": 1586986614, "creation_date": 1586986614, "answer_id": 61239039, "question_id": 35593920, "link": "https://stackoverflow.com/questions/35593920/how-to-view-the-contents-of-a-cookiejar-in-golang/61239039#61239039", "title": "How to view the contents of a cookieJar in Golang?", "body": "<p>Although Volker is technically correct in the sense that the <code>net/http/cookiejar</code> implementation is opaque, the <code>http.Client.Jar</code> field is an interface (<code>http.Client.CookieJar</code>).</p>\n\n<p>So it is possible to define and use an implementation that provides a list function or exposes a map of URL to cookies. Such an implementation should be based on the std library's implementation to leverage the security features it implements.</p>\n\n<p>If there's any interest, I might provide some sample code.</p>\n"}], "owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1625, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1586986614, "creation_date": 1456291486, "last_edit_date": 1456381229, "question_id": 35593920, "link": "https://stackoverflow.com/questions/35593920/how-to-view-the-contents-of-a-cookiejar-in-golang", "title": "How to view the contents of a cookieJar in Golang?", "body": "<p>I'm trying to view the contents of a cookieJar response from a request to google:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"net/http/cookiejar\"\n    \"net/url\"\n)\n\nfunc main() {\n\n    jar, err := cookiejar.New(nil)\n    if err != nil {\n        log.Fatal(err)\n    }\n    client := http.Client{Jar: jar}\n    resp, err := client.Get(\"https://accounts.google.com/ServiceLogin?continue=https%3A%2F%2Fwww.youtube.com%2Fsignin%3Ffeature%3Dsign_in_button%26hl%3Den%26action_handle_signin%3Dtrue%26next%3D%252F%26app%3Ddesktop&amp;service=youtube&amp;sacu=1&amp;passive=1209600&amp;ignoreShadow=0&amp;acui=0#identifier\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(resp.Cookies())\n\n    s := \".google.com\"\n    u, err := url.Parse(s)\n    fmt.Println(client.Jar.Cookies(u))\n\n}\n</code></pre>\n\n<p>The response is a blank array but I can see that there are cookies being set. How do I view the contents of a cookieJar in Golang?</p>\n"}, {"tags": ["go", "mplayer"], "answers": [{"tags": [], "owner": {"reputation": 58, "user_id": 2392335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8687c3e87a26a9878db0cfe4ac52f6?s=128&d=identicon&r=PG", "display_name": "Cameron Wong", "link": "https://stackoverflow.com/users/2392335/cameron-wong"}, "is_accepted": true, "score": 0, "last_activity_date": 1456301947, "creation_date": 1456301947, "answer_id": 35596743, "question_id": 35591888, "link": "https://stackoverflow.com/questions/35591888/mplayer-fail-to-get-stdin-stream-from-golang/35596743#35596743", "title": "mplayer fail to get stdin stream from golang", "body": "<p>Sorry, it's my fault. I get the stdout pipe of mplayer somewhere for debug. However, the code hangs there because there is no output. I found this with godebug.</p>\n"}], "owner": {"reputation": 58, "user_id": 2392335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef8687c3e87a26a9878db0cfe4ac52f6?s=128&d=identicon&r=PG", "display_name": "Cameron Wong", "link": "https://stackoverflow.com/users/2392335/cameron-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "accepted_answer_id": 35596743, "answer_count": 1, "score": 0, "last_activity_date": 1456301947, "creation_date": 1456279220, "question_id": 35591888, "link": "https://stackoverflow.com/questions/35591888/mplayer-fail-to-get-stdin-stream-from-golang", "title": "mplayer fail to get stdin stream from golang", "body": "<p>I want to write a simple command line m3u8 player for Linux. (Let me know if there already one.)</p>\n\n<p>There are several ts file urls in m3u8 file. m3u8 file is dynamically changed from network. Usually, one ts file has only a few seconds. So I need to download m3u8 file and ts files in it again and again. Then I use mplayer to play the stream continuesly. I suppose this is a network radio.</p>\n\n<p>Here is what I have done:</p>\n\n<p>First, I lauch mplayer process and get the stdin:</p>\n\n<pre><code>mplayer_cmd := exec.Command(\"sh\", \"-c\", \"mplayer -msglevel all=9 -cache 80 -\")\nmplayer_writer, mplayer_err := mplayer_cmd.StdinPipe()\n</code></pre>\n\n<p>Then, I get m3u8 file and ts urls in it and wget content of ts file and write it to stdin of mplayer. And I do this step again and again:</p>\n\n<pre><code>out, err = exec.Command(\"sh\", \"-c\", \"wget \" + m3u8_url + \" -qO - | grep '.ts'\").Output()\n...\nout, err = exec.Command(\"sh\", \"-c\", \"wget \" + ts_url + \" -qO -\").Output()\n...\nn, err = mplayer_writer.Write(out)\nfmt.Println(\"wrote \", n)\n</code></pre>\n\n<p>No sound come out from mplayer. Comparing to a successful running from command line, there is such related error messsage:</p>\n\n<pre><code>Cache empty, consider increasing -cache and/or -cache-min. [performance issue]\n</code></pre>\n\n<p>A suspect info is that - mplayer fork a child process when lauch. Will stdin/stdout pipe broken in this situation?</p>\n\n<pre><code> | |       \\-+- 03027 hgneng mplayer -msglevel all=9 -cache 80 -\n | |         \\--- 03033 hgneng mplayer -msglevel all=9 -cache 80 -\n</code></pre>\n"}, {"tags": ["database", "postgresql", "go"], "comments": [{"owner": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "edited": false, "score": 0, "creation_date": 1456279100, "post_id": 35591781, "comment_id": 58869917, "body": "What does <code>err2</code> contain? You should print that too."}, {"owner": {"reputation": 93, "user_id": 5885918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85aa543562ef572d8f3f18cefb084494?s=128&d=identicon&r=PG&f=1", "display_name": "Bran S", "link": "https://stackoverflow.com/users/5885918/bran-s"}, "reply_to_user": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "edited": false, "score": 0, "creation_date": 1456279371, "post_id": 35591781, "comment_id": 58870011, "body": "it told &quot;SSL is not enabled on the server&quot;, so I did sslmode=disable and now  Ping goes through. The problem is, it still doesn&#39;t add a row into the table. How can I check the list of tables or something like this to make sure that I&#39;m in a right database?"}, {"owner": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "edited": false, "score": 0, "creation_date": 1456279460, "post_id": 35591781, "comment_id": 58870044, "body": "Shouldn&#39;t you be using <code>Exec()</code> for that?"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1456279842, "post_id": 35591781, "comment_id": 58870163, "body": "QueryRow is correct (due to returning clause)... what error is Scan returning?"}, {"owner": {"reputation": 93, "user_id": 5885918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85aa543562ef572d8f3f18cefb084494?s=128&d=identicon&r=PG&f=1", "display_name": "Bran S", "link": "https://stackoverflow.com/users/5885918/bran-s"}, "edited": false, "score": 0, "creation_date": 1456280298, "post_id": 35591781, "comment_id": 58870311, "body": "Scan is returning 0 and I don&#39;t see any rows added to the test_table"}, {"owner": {"reputation": 38917, "user_id": 445210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b689cc1d73c4f1e7378d045a54abcca?s=128&d=identicon&r=PG", "display_name": "Herman Schaaf", "link": "https://stackoverflow.com/users/445210/herman-schaaf"}, "edited": false, "score": 0, "creation_date": 1456280342, "post_id": 35591781, "comment_id": 58870323, "body": "There seems to be an extra parenthesis in the <code>INSERT INTO</code> query after <code>something</code>"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1456289050, "post_id": 35591781, "comment_id": 58872854, "body": "also, Scan doesn&#39;t return a number.  it returns an error, I&#39;d bet that you are seeing an error about the extra paren.  <a href=\"https://golang.org/pkg/database/sql/#Row.Scan\" rel=\"nofollow noreferrer\">golang.org/pkg/database/sql/#Row.Scan</a>"}], "answers": [{"tags": [], "owner": {"reputation": 38917, "user_id": 445210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b689cc1d73c4f1e7378d045a54abcca?s=128&d=identicon&r=PG", "display_name": "Herman Schaaf", "link": "https://stackoverflow.com/users/445210/herman-schaaf"}, "is_accepted": true, "score": 5, "last_activity_date": 1456280830, "creation_date": 1456280830, "answer_id": 35592142, "question_id": 35591781, "link": "https://stackoverflow.com/questions/35591781/go-open-local-postgres-connection/35592142#35592142", "title": "GO open local postgres connection", "body": "<p>In situations like these, it pays to go through the following checklist:</p>\n\n<ul>\n<li>can you connect to the server using the same arguments provided to the go server? I.e. can you run <code>psql -U user -p 5432 -h localhost test</code> ?</li>\n<li>are you printing all errors? In the question, <code>err2</code> should be printed, as it contains critical information about what's going on. <code>Scan</code> also returns an error that is not being saved to a variable or printed. If it were, you might have seen the syntax problem in your query.</li>\n<li>can you you run the query in the SQL shell? (<code>psql</code>) If not, fix the query first before continuing.</li>\n</ul>\n"}], "owner": {"reputation": 93, "user_id": 5885918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85aa543562ef572d8f3f18cefb084494?s=128&d=identicon&r=PG&f=1", "display_name": "Bran S", "link": "https://stackoverflow.com/users/5885918/bran-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1026, "favorite_count": 0, "accepted_answer_id": 35592142, "answer_count": 1, "score": 0, "last_activity_date": 1456280830, "creation_date": 1456278425, "question_id": 35591781, "link": "https://stackoverflow.com/questions/35591781/go-open-local-postgres-connection", "title": "GO open local postgres connection", "body": "<p>My postgres is running locally on Mac on a port 5432</p>\n\n<p>It has database on it named <code>test</code>, and this database has one table in it called <code>test_table</code></p>\n\n<p>I'm trying to connect to it using GO.</p>\n\n<p>Imports:</p>\n\n<pre><code> \"database/sql\"\n _ \"github.com/lib/pq\"\n</code></pre>\n\n<p>Main:</p>\n\n<pre><code>db, err := sql.Open(\"postgres\", \"postgres://user:@localhost:5432/test\")\nif err != nil {\n    log.Println(err)\n}\ndefer db.Close()\n\nif err2 := db.Ping(); err2 != nil {\n fmt.Println(\"Failed to keep connection alive\")\n}\n\ndb.QueryRow(\"INSERT INTO test.test_table (name) VALUES (`something`)) RETURNING id\").Scan(&amp;id)\n\nfmt.Println(id)\n</code></pre>\n\n<p>To test the connection I'm running Ping and also try to Insert one line into test_table. But it returns me:</p>\n\n<pre><code>Failed to keep connection alive\n0\n</code></pre>\n\n<p>How can I fix the problem?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 3, "creation_date": 1456275761, "post_id": 35591301, "comment_id": 58868859, "body": "It&#39;s recommended and discussed here: <a href=\"https://golang.org/doc/effective_go.html#commentary\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#commentary</a>"}, {"owner": {"reputation": 199, "user_id": 4052566, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/cRNUL.jpg?s=128&g=1", "display_name": "Tobin", "link": "https://stackoverflow.com/users/4052566/tobin"}, "edited": false, "score": 0, "creation_date": 1456280736, "post_id": 35591301, "comment_id": 58870461, "body": "Correct. <a href=\"https://en.wikipedia.org/wiki/Single_source_of_truth\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Single_source_of_truth</a>"}], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1456282246, "post_id": 35591436, "comment_id": 58870897, "body": "<code>golint</code> can also aid with checking documentation style."}], "tags": [], "owner": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "is_accepted": true, "score": 5, "last_activity_date": 1456277832, "last_edit_date": 1456277832, "creation_date": 1456276225, "answer_id": 35591436, "question_id": 35591301, "link": "https://stackoverflow.com/questions/35591301/function-name-in-comment/35591436#35591436", "title": "Function name in comment", "body": "<p>TL;DR it makes grepping easier.</p>\n\n<p>Quoting from <a href=\"https://golang.org/doc/effective_go.html#commentary\" rel=\"nofollow\">https://golang.org/doc/effective_go.html#commentary</a> referred to by @twotwotwo:</p>\n\n<blockquote>\n  <p>Doc comments work best as complete sentences, which allow a wide\n  variety of automated presentations. The first sentence should be a\n  one-sentence summary that starts with the name being declared.</p>\n  \n  <p>...</p>\n  \n  <p>If the name always begins the comment, the output of godoc can\n  usefully be run through grep. Imagine you couldn't remember the name\n  \"Compile\" but were looking for the parsing function for regular\n  expressions, so you ran the command,</p>\n</blockquote>\n\n<pre><code>$ godoc regexp | grep parse\n</code></pre>\n\n<blockquote>\n  <p>If all the doc comments in the package\n  began, \"This function...\", grep wouldn't help you remember the name.\n  But because the package starts each doc comment with the name, you'd\n  see something like this, which recalls the word you're looking for.</p>\n</blockquote>\n\n<pre><code>$ godoc regexp | grep parse\n    Compile parses a regular expression and returns, if successful, a Regexp\n    parsed. It simplifies safe initialization of global variables holding\n    cannot be parsed. It simplifies safe initialization of global variables $\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 4052566, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/cRNUL.jpg?s=128&g=1", "display_name": "Tobin", "link": "https://stackoverflow.com/users/4052566/tobin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "accepted_answer_id": 35591436, "answer_count": 1, "score": 1, "last_activity_date": 1456280771, "creation_date": 1456275397, "last_edit_date": 1456280771, "question_id": 35591301, "link": "https://stackoverflow.com/questions/35591301/function-name-in-comment", "title": "Function name in comment", "body": "<p>Why do Go programmers put the name of the function as the first word of the function comment? This is a technical question please not a religious one.</p>\n\n<p>As an example</p>\n\n<pre><code>// addOptions adds options s to opt\nfunc addOptions(s string, opt interface{}) (string, error) {\n....\n</code></pre>\n\n<p>Dose this not violate the SPOT (Single Point Of Truth) principle? </p>\n\n<p>I am asking because I am sure there is a very good reason.</p>\n\n<p>That is how it is done in 'The GO Programming Language' (Alan A. A. Donovan and Brian W. Kernighan). Also it was done like that in 'The C Programming Language' (Dennis M. Ritchie and Brian W. Kernighan) back in 1988. If it has lasted this long it seems there must be a good reason?</p>\n\n<p>The SPOT  principle is attributed to Kernighan by Eric S. Raymond in 'The Art of UNIX Programming'.</p>\n"}, {"tags": ["go", "psutil"], "comments": [{"owner": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "edited": false, "score": 1, "creation_date": 1456277204, "post_id": 35591107, "comment_id": 58869298, "body": "Do you want it to be platform agnostic? If it&#39;s just for Linux, you can settle for reading <code>&#47;proc&#47;cpuinfo</code> or even running <code>lscpu</code> itself."}], "answers": [{"comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1456289397, "post_id": 35593102, "comment_id": 58872968, "body": "you can also just read /proc/cpuinfo, which might be a little more straight forward than running a command line tool and parsing its output"}, {"owner": {"reputation": 1354, "user_id": 645755, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cbd603044ab96572516f1651dd06428c?s=128&d=identicon&r=PG", "display_name": "dtoux", "link": "https://stackoverflow.com/users/645755/dtoux"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1557596519, "post_id": 35593102, "comment_id": 98821675, "body": "@DavidBudworth <code>lscpu</code> exists because it is an impossible task for us mere mortals to reliably render the content of <code>&#47;proc&#47;cpuinfo</code> across all platforms and CPU models."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1557794800, "post_id": 35593102, "comment_id": 98875679, "body": "I&#39;d think that <code>lscpu</code>&#39;s output would be more likely to change than the kernel&#39;s <code>&#47;proc&#47;cpuinfo</code> given that a kernel change would break tons of tools.   But, maybe there&#39;s also a ton of stuff parsing <code>lscpu</code> output, so it&#39;s stable as well"}], "tags": [], "owner": {"reputation": 446, "user_id": 2608693, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NdTTB.jpg?s=128&g=1", "display_name": "tbenz9", "link": "https://stackoverflow.com/users/2608693/tbenz9"}, "is_accepted": false, "score": 3, "last_activity_date": 1456287069, "creation_date": 1456287069, "answer_id": 35593102, "question_id": 35591107, "link": "https://stackoverflow.com/questions/35591107/return-number-of-cpu-sockets-cores-and-threads-in-golang/35593102#35593102", "title": "Return number of CPU sockets, Cores, and Threads in Golang", "body": "<p>I ended up figuring it out, see below:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os/exec\"\n    \"strconv\"\n    \"strings\"\n)\n\ntype CPUInfo struct {\n    Sockets        int32 `json:\"sockets\"`\n    CoresPerSocket int32 `json:\"cores_per_socket\"`\n    ThreadsPerCore int32 `json:\"threads_per_core\"`\n}\n\nfunc main() {\n    out, _ := exec.Command(\"lscpu\").Output()\n    outstring := strings.TrimSpace(string(out))\n    lines := strings.Split(outstring, \"\\n\")\n    c := CPUInfo{}\n\n    for _, line := range lines {\n        fields := strings.Split(line, \":\")\n        if len(fields) &lt; 2 {\n            continue\n        }\n        key := strings.TrimSpace(fields[0])\n        value := strings.TrimSpace(fields[1])\n\n        switch key {\n        case \"Socket(s)\":\n            t, _ := strconv.Atoi(value)\n            c.Sockets = int32(t)\n        case \"Core(s) per socket\":\n            t, _ := strconv.Atoi(value)\n            c.CoresPerSocket = int32(t)\n        case \"Thread(s) per core\":\n            t, _ := strconv.Atoi(value)\n            c.ThreadsPerCore = int32(t)\n        }\n    }\n\n    CPUInfoJSON, _ := json.MarshalIndent(c, \"\", \"  \")\n    fmt.Println(string(CPUInfoJSON))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>tbenz9@ubuntu-dev: go run socket.go \n{\n  \"sockets\": 1,\n  \"cores_per_socket\": 2,\n  \"threads_per_core\": 2\n}\n</code></pre>\n"}], "owner": {"reputation": 446, "user_id": 2608693, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NdTTB.jpg?s=128&g=1", "display_name": "tbenz9", "link": "https://stackoverflow.com/users/2608693/tbenz9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1586, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1456287069, "creation_date": 1456274181, "last_edit_date": 1456274736, "question_id": 35591107, "link": "https://stackoverflow.com/questions/35591107/return-number-of-cpu-sockets-cores-and-threads-in-golang", "title": "Return number of CPU sockets, Cores, and Threads in Golang", "body": "<p>Using Golang I'm trying to find/write a function that would return the number of CPU Sockets, Cores per socket, and Threads per core a Linux system.  For example, a server might have 2 CPUs each with 4 cores, with hyperthreading, it could handle 8 threads per CPU.</p>\n\n<p>Sample Output:</p>\n\n<pre><code>{\n  \"CPUSockets\": \"2\",\n  \"CoresPerSocket\": \"4\",\n  \"ThreadsPerCore\": \"2\"\n}\n</code></pre>\n\n<p><strong>Question:</strong>  Do you know of any Go Package or pseudo code that could provide this information?</p>\n\n<p><strong>Note:</strong> I've looked at various go implementations of psutil but I can't find one that returns the number of sockets or distinguishes between Cores and Threads.  The data I want is very easily accessible by running <code>lscpu</code> but I don't know how to access that using Go.</p>\n"}, {"tags": ["go", "pkcs#12", "pkcs#8"], "comments": [{"owner": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "edited": false, "score": 0, "creation_date": 1456271609, "post_id": 35590600, "comment_id": 58867482, "body": "Why would you want to do that every single time? Isn&#39;t it enough to convert the certificate once and always use the converted format from there?"}, {"owner": {"reputation": 4352, "user_id": 1641535, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d027dff15e133ea9edd84c34e49f868?s=128&d=identicon&r=PG", "display_name": "Orr", "link": "https://stackoverflow.com/users/1641535/orr"}, "reply_to_user": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "edited": false, "score": 0, "creation_date": 1456294978, "post_id": 35590600, "comment_id": 58875061, "body": "Sure, I won&#39;t do the conversion each time. But do you know how to do it?"}, {"owner": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "edited": false, "score": 0, "creation_date": 1456295075, "post_id": 35590600, "comment_id": 58875104, "body": "Why do you need to do it in go after you have already done it in the command line?"}, {"owner": {"reputation": 4352, "user_id": 1641535, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d027dff15e133ea9edd84c34e49f868?s=128&d=identicon&r=PG", "display_name": "Orr", "link": "https://stackoverflow.com/users/1641535/orr"}, "reply_to_user": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "edited": false, "score": 0, "creation_date": 1456297846, "post_id": 35590600, "comment_id": 58876391, "body": "Sorry, I understand your comment now. I need to be able to do it programtically to many apps, through our golang web server"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1456334912, "post_id": 35590600, "comment_id": 58902233, "body": "Since you&#39;re asking, it appears you googled for <code>golang+&quot;pkcs#8&quot;</code> and found <a href=\"https://godoc.org/github.com/youmark/pkcs8\" rel=\"nofollow noreferrer\">this package</a> then googled for <code>golang+&quot;pkcs#12&quot;</code> and found <a href=\"https://godoc.org/golang.org/x/crypto/pkcs12\" rel=\"nofollow noreferrer\">this package</a>, you then tried to make them work together and failed, right? Then what exactly did not work?"}, {"owner": {"reputation": 4352, "user_id": 1641535, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d027dff15e133ea9edd84c34e49f868?s=128&d=identicon&r=PG", "display_name": "Orr", "link": "https://stackoverflow.com/users/1641535/orr"}, "edited": false, "score": 0, "creation_date": 1456352769, "post_id": 35590600, "comment_id": 58912620, "body": "I&#39;ve put my current code in the question, in EDIT"}], "answers": [{"comments": [{"owner": {"reputation": 795, "user_id": 3479043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xGd30.png?s=128&g=1", "display_name": "xh3b4sd", "link": "https://stackoverflow.com/users/3479043/xh3b4sd"}, "edited": false, "score": 0, "creation_date": 1475595392, "post_id": 35714144, "comment_id": 67000769, "body": "How to do that the other way around? Here you split the pkcs12 container into the private and public key it contains. I would like to do it the other way around in go. Creating the pkcs12 container using the public and the private key. The equivalent <code>openssl</code> command looks like this: <code>openssl pkcs12 -export -clcerts -inkey input.key -in input.crt -out output.p12 -name &quot;foo&quot;</code>. How to do that in go?"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "reply_to_user": {"reputation": 795, "user_id": 3479043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xGd30.png?s=128&g=1", "display_name": "xh3b4sd", "link": "https://stackoverflow.com/users/3479043/xh3b4sd"}, "edited": false, "score": 0, "creation_date": 1475718677, "post_id": 35714144, "comment_id": 67059090, "body": "@xh3b4sd encoding isn&#39;t implemented in go as far as I know. Is PEM a possible alternative for you? <i>A simpler, alternative format to PKCS #12 is PEM which just lists the certificates and possibly private keys as Base 64 strings in a text file</i> <a href=\"https://en.wikipedia.org/wiki/PKCS_12\" rel=\"nofollow noreferrer\">wikipedia</a>.  Or possibly run the export in openssl as an external command?"}, {"owner": {"reputation": 795, "user_id": 3479043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xGd30.png?s=128&g=1", "display_name": "xh3b4sd", "link": "https://stackoverflow.com/users/3479043/xh3b4sd"}, "edited": false, "score": 0, "creation_date": 1475745127, "post_id": 35714144, "comment_id": 67069916, "body": "I already have PEM encoded certificates. I want to use these to create pkcs12 containers which you can add to your browser. I also found out that write support for pkcs12 containers is not supported in go. See <a href=\"https://github.com/golang/go/issues/10621#issuecomment-251427487\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/10621#issuecomment-251427487</a>"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1475785897, "post_id": 35714144, "comment_id": 67095749, "body": "Can you concatenate the PEM files and import that into your browser?"}], "tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": true, "score": 5, "last_activity_date": 1456803018, "creation_date": 1456803018, "answer_id": 35714144, "question_id": 35590600, "link": "https://stackoverflow.com/questions/35590600/how-do-i-extract-the-private-key-from-a-pkcs12-container-and-save-it-in-pkcs8/35714144#35714144", "title": "How do I extract the private key from a PKCS#12 container and save it in PKCS#8 format?", "body": "<p>I think you're there. You've converted the key to PKCS#8 format, but it's displaying as gibberish because it's printed in binary DER form. The key just needs to be encoded in pem format.</p>\n\n<p>One way to test this is by creating your own pkcs#12 file containing a <a href=\"https://golang.org/src/crypto/tls/generate_cert.go\" rel=\"noreferrer\">self signed certificate &amp; key</a>. A benefit is you can vary the expiry duration to exercise your certificate expiry error handling:</p>\n\n<pre><code>go run generate_cert.go -ca -duration 30m -host gooble.com\n</code></pre>\n\n<p>It generates key.pem and cert.pem. Combine key &amp; cert:</p>\n\n<pre><code>cat key.pem cert.pem &gt; both.pem\n</code></pre>\n\n<p>Bundle into pkcs#12:</p>\n\n<pre><code>openssl pkcs12 -export -in both.pem -out bundle.12 -nodes -password pass:123456\n</code></pre>\n\n<p>Here bundle.12 is a pkcs#12 file in binary DER form containing a certificate and private key, protected by a password.</p>\n\n<p>Run the go program (see source below) to extract the certificate and key:</p>\n\n<pre><code>go run pk.go -in bundle.12 -outkey key8.pem -outcert outcert.pem -password 123456\n</code></pre>\n\n<p>The extracted certificate is identical to the original certificate. The extracted private key is similar to the original private key, but now in pkcs#8 format.</p>\n\n<p>You can extract the original rsa key from the pkcs8 file. The original key.pem is identical to key.final.pem:</p>\n\n<pre><code>openssl rsa -in key8.pem -out key.final.pem\n</code></pre>\n\n<p>You could also verify the extracted pkcs#8 private key has the same modulus as the original certificate:</p>\n\n<pre><code>openssl x509 -in cert.pem -noout -modulus\nModulus=AEB5770C4DA8D...05E12398BE1\n\nopenssl rsa -in key8.pem -noout -modulus\nModulus=AEB5770C4DA8D...05E12398BE1\n</code></pre>\n\n<p>Note that the extracted pkcs#8 private key is unencrypted; that may not be what you want depending on how the key's going to be used.</p>\n\n<p>Here's a slightly modified version of the go program (pk.go):</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/x509\"\n    \"encoding/pem\"\n    \"errors\"\n    \"flag\"\n    \"github.com/youmark/pkcs8\"\n    \"golang.org/x/crypto/pkcs12\"\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n)\n\nvar (\n    in       = flag.String(\"in\", \"\", \"pkcs#12 input file (private key and certificate only)\")\n    password = flag.String(\"password\", \"\", \"to unlock the pkcs#12 bundle\")\n    outkey   = flag.String(\"outkey\", \"\", \"output filename of private key in pkcs#8 PEM format\")\n    outcert  = flag.String(\"outcert\", \"\", \"output filename of certificate in PEM format\")\n)\n\nfunc main() {\n    flag.Parse()\n\n    if *in == \"\" || *password == \"\" || *outkey == \"\" || *outcert == \"\" {\n        flag.Usage()\n        os.Exit(1)\n    }\n\n    data, err := ioutil.ReadFile(*in)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    privateKey, certificate, err := pkcs12.Decode(data, *password)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    if err := verify(certificate); err != nil {\n        log.Fatal(err)\n    }\n\n    keyBytes, err := pkcs8.ConvertPrivateKeyToPKCS8(privateKey)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    //could write private key as binary DER encoded (instead of pem below)\n    //_, err = ioutil.WriteFile(*outkey,keyBytes,0644)\n\n    //write private key as pem\n    keyFile, err := os.Create(*outkey)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer keyFile.Close()\n    err = pem.Encode(keyFile, &amp;pem.Block{Type: \"PRIVATE KEY\", Bytes: keyBytes})\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    certFile, err := os.Create(*outcert)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer certFile.Close()\n    err = pem.Encode(certFile, &amp;pem.Block{Type: \"CERTIFICATE\", Bytes: certificate.Raw})\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n\n// verify checks if a certificate has expired\nfunc verify(cert *x509.Certificate) error {\n    _, err := cert.Verify(x509.VerifyOptions{})\n    if err == nil {\n        return nil\n    }\n\n    switch e := err.(type) {\n    case x509.CertificateInvalidError:\n        switch e.Reason {\n        case x509.Expired:\n            return ErrExpired\n        default:\n            return err\n        }\n    case x509.UnknownAuthorityError:\n        // Apple cert isn't in the cert pool\n        // ignoring this error\n        return nil\n    default:\n        return err\n    }\n}\n\n// Certificate errors\nvar (\n    ErrExpired = errors.New(\"certificate has expired or is not yet valid\")\n)\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 4352, "user_id": 1641535, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0d027dff15e133ea9edd84c34e49f868?s=128&d=identicon&r=PG", "display_name": "Orr", "link": "https://stackoverflow.com/users/1641535/orr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6911, "favorite_count": 2, "accepted_answer_id": 35714144, "answer_count": 1, "score": 3, "last_activity_date": 1456803018, "creation_date": 1456271349, "last_edit_date": 1456352743, "question_id": 35590600, "link": "https://stackoverflow.com/questions/35590600/how-do-i-extract-the-private-key-from-a-pkcs12-container-and-save-it-in-pkcs8", "title": "How do I extract the private key from a PKCS#12 container and save it in PKCS#8 format?", "body": "<p>I want to be able to send iOS <em>APNS</em> push notifications using <em>AWS SNS</em> with the aws <strong>golang</strong> SDK. I've created a p12 file following this instructions: <a href=\"https://support-aws.s3.amazonaws.com/Exporting-APNS-Cert-Keychain-Mac.pdf\" rel=\"nofollow\">https://support-aws.s3.amazonaws.com/Exporting-APNS-Cert-Keychain-Mac.pdf</a>\nnow in order to get the private key and cert I need to implement the following openssl equivalent commands:</p>\n\n<pre><code>openssl pkcs12 -in MyCertificates.p12 -out MyCer.pem -clcerts -nokeys\nopenssl pkcs12 -in MyCertificates.p12 -out MyKey.pem -nocerts -nodes\nopenssl pkcs8 -topk8 -inform pem -in MyKey.pem -outform pem -nocrypt -out MyKeyCorrectFormat.pem\n</code></pre>\n\n<p>I can't find a way to do this in <strong>golang</strong>, any help will be appreciated. What seems to be the issue is converting the private key to pkcs8 format.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>This is what I have been trying to do (in order to compile you need to change the first import in github.com/youmark/pkcs8 to golang.org/x/crypto/pbkdf2) :</p>\n\n<pre><code>import (\n\"golang.org/x/crypto/pkcs12\"\n\"io/ioutil\"\n\"fmt\"\n\"encoding/pem\"\n\"github.com/aws/aws-sdk-go/service/sns\"\n\"github.com/aws/aws-sdk-go/aws/session\"\n\"github.com/aws/aws-sdk-go/aws\"\n\"crypto/x509\"\n\"crypto/rsa\"\n\"errors\"\n\"github.com/youmark/pkcs8\"\n)\nfunc main()  {\nb, err:= ioutil.ReadFile(\"myP12File.p12\")\nif err!=nil {\n    fmt.Println(err)\n    return\n}\npassword := \"123456\"\n_, pKey , err := Decode(b,password)\npKeyPkcs8, err := pkcs8.ConvertPrivateKeyToPKCS8(pKey,passwordBytes)\nif err!=nil {\n    fmt.Println(err)\n}\nfmt.Println(string(pKeyPkcs8))\n}\n// Decode and verify an in memory .p12 certificate (DER binary format).\nfunc Decode(p12 []byte, password string) (*x509.Certificate,       *rsa.PrivateKey, error) {\n// decode an x509.Certificate to verify\nprivateKey, cert, err := pkcs12.Decode(p12, password)\nif err != nil {\n    return nil, nil, err\n}\nif err := verify(cert); err != nil {\n    return nil, nil, err\n}\n\n// assert that private key is RSA\npriv, ok := privateKey.(*rsa.PrivateKey)\nif !ok {\n    return nil, nil, errors.New(\"expected RSA private key type\")\n}\nreturn cert, priv, nil\n}\n\n// verify checks if a certificate has expired\nfunc verify(cert *x509.Certificate) error {\n_, err := cert.Verify(x509.VerifyOptions{})\nif err == nil {\n    return nil\n}\n\nswitch e := err.(type) {\ncase x509.CertificateInvalidError:\n    switch e.Reason {\n    case x509.Expired:\n        return ErrExpired\n    default:\n        return err\n    }\ncase x509.UnknownAuthorityError:\n    // Apple cert isn't in the cert pool\n    // ignoring this error\n    return nil\ndefault:\n    return err\n}\n}\n\n// Certificate errors\nvar (\n ErrExpired = errors.New(\"certificate has expired or is not yet valid\")\n)\n</code></pre>\n\n<p>What I get when printing the converted key is gibberish, so I guess there is something wrong with my decoding process somewhere.</p>\n"}, {"tags": ["json", "parsing", "go"], "comments": [{"owner": {"reputation": 58628, "user_id": 227267, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b03410a67ad6b9cf3fce7b0bf45084c8?s=128&d=identicon&r=PG", "display_name": "Matti Virkkunen", "link": "https://stackoverflow.com/users/227267/matti-virkkunen"}, "edited": false, "score": 0, "creation_date": 1456266771, "post_id": 35589541, "comment_id": 58865457, "body": "Your JSON is a bit weird - any reason why you have each property in a separate object?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1456266912, "post_id": 35589541, "comment_id": 58865525, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/35202961/how-to-parse-the-json-array-in-golang\">How to parse the json array in golang?</a>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1456268323, "post_id": 35589541, "comment_id": 58866152, "body": "Modify your code to get the error from <code>json.Unmarshal()</code> and print it so you can see what went wrong. You have a number of problems though, firstly, none of the properties on <code>Client</code> are exported meaning they can&#39;t be assigned to."}, {"owner": {"reputation": 809, "user_id": 4571943, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f29b880ba43211bd4f2f586d09e3cc42?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkull", "link": "https://stackoverflow.com/users/4571943/darkskull"}, "reply_to_user": {"reputation": 58628, "user_id": 227267, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b03410a67ad6b9cf3fce7b0bf45084c8?s=128&d=identicon&r=PG", "display_name": "Matti Virkkunen", "link": "https://stackoverflow.com/users/227267/matti-virkkunen"}, "edited": false, "score": 0, "creation_date": 1456341888, "post_id": 35589541, "comment_id": 58906472, "body": "@MattiVirkkunen no reason... I&#39;m very new to the Go language and the parsing in general. Please, could you show me the right sintax? Thank you."}, {"owner": {"reputation": 58628, "user_id": 227267, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b03410a67ad6b9cf3fce7b0bf45084c8?s=128&d=identicon&r=PG", "display_name": "Matti Virkkunen", "link": "https://stackoverflow.com/users/227267/matti-virkkunen"}, "edited": false, "score": 0, "creation_date": 1456344654, "post_id": 35589541, "comment_id": 58908102, "body": "@DarkSkull: I think something like <code>{&quot;Client&quot;: [ {&quot;host&quot;: &quot;192.168.1.2&quot;, &quot;key&quot;: &quot;foo&quot;, &quot;secret&quot;: &quot;bar&quot; }, { &quot;host&quot;: &quot;192...&quot; } ] }</code> would make more sense in most cases. Note how all the properties are inside one set of <code>{}</code> making them part of the same object."}, {"owner": {"reputation": 809, "user_id": 4571943, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f29b880ba43211bd4f2f586d09e3cc42?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkull", "link": "https://stackoverflow.com/users/4571943/darkskull"}, "reply_to_user": {"reputation": 58628, "user_id": 227267, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b03410a67ad6b9cf3fce7b0bf45084c8?s=128&d=identicon&r=PG", "display_name": "Matti Virkkunen", "link": "https://stackoverflow.com/users/227267/matti-virkkunen"}, "edited": false, "score": 0, "creation_date": 1456344973, "post_id": 35589541, "comment_id": 58908282, "body": "@MattiVirkkunen Ok thanks! But now, how can I access every single information?"}, {"owner": {"reputation": 58628, "user_id": 227267, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b03410a67ad6b9cf3fce7b0bf45084c8?s=128&d=identicon&r=PG", "display_name": "Matti Virkkunen", "link": "https://stackoverflow.com/users/227267/matti-virkkunen"}, "edited": false, "score": 0, "creation_date": 1456345095, "post_id": 35589541, "comment_id": 58908371, "body": "@DarkSkull: I don&#39;t use go myself so you&#39;ll have to look at the actual answers."}, {"owner": {"reputation": 809, "user_id": 4571943, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f29b880ba43211bd4f2f586d09e3cc42?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkull", "link": "https://stackoverflow.com/users/4571943/darkskull"}, "edited": false, "score": 0, "creation_date": 1456755238, "post_id": 35589541, "comment_id": 59079779, "body": "please, vote up my solution and my question... I have a low score, so I can&#39;t vote up other users."}], "answers": [{"comments": [{"owner": {"reputation": 809, "user_id": 4571943, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f29b880ba43211bd4f2f586d09e3cc42?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkull", "link": "https://stackoverflow.com/users/4571943/darkskull"}, "edited": false, "score": 0, "creation_date": 1456343137, "post_id": 35590084, "comment_id": 58907190, "body": "Thank you @Matt, it works but could you tell me how I can access a single information of the json? If I want to know the user of the first client, how can I access this item? This <code>conf.Client[0].host</code> does still not works."}, {"owner": {"reputation": 41, "user_id": 5154031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/955ya.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5154031/matt"}, "reply_to_user": {"reputation": 809, "user_id": 4571943, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f29b880ba43211bd4f2f586d09e3cc42?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkull", "link": "https://stackoverflow.com/users/4571943/darkskull"}, "edited": false, "score": 0, "creation_date": 1456432292, "post_id": 35590084, "comment_id": 58956846, "body": "@DarkSkull You need to capitalize &quot;Host&quot;: e.g <a href=\"https://play.golang.org/p/dlhHAijeoX\" rel=\"nofollow noreferrer\">play.golang.org/p/dlhHAijeoX</a>"}], "tags": [], "owner": {"reputation": 41, "user_id": 5154031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/955ya.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5154031/matt"}, "is_accepted": false, "score": 4, "last_activity_date": 1456269000, "creation_date": 1456269000, "answer_id": 35590084, "question_id": 35589541, "link": "https://stackoverflow.com/questions/35589541/error-with-json-parsing-in-golang/35590084#35590084", "title": "Error with JSON parsing in Golang", "body": "<p>Three things to fix:</p>\n\n<ul>\n<li>json.Unmarshal requires the struct fields to be capitalized to be exported or they are ignored</li>\n<li>You need the <code>json:\"&lt;name&gt;\"</code> specifier after the fields so the unmarshal knows the struct field to json mapping</li>\n<li>Your json was making multiple clients with one field filled in instead of one client with all the fields filled in</li>\n</ul>\n\n<p>See example: <a href=\"https://play.golang.org/p/oY7SppWNDC\" rel=\"nofollow\">https://play.golang.org/p/oY7SppWNDC</a></p>\n"}, {"comments": [{"owner": {"reputation": 809, "user_id": 4571943, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f29b880ba43211bd4f2f586d09e3cc42?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkull", "link": "https://stackoverflow.com/users/4571943/darkskull"}, "edited": false, "score": 0, "creation_date": 1456343391, "post_id": 35602678, "comment_id": 58907348, "body": "I have to do this without external library"}], "tags": [], "owner": {"reputation": 135, "user_id": 3841436, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/100000631286631/picture?type=large", "display_name": "Vinay Sawant", "link": "https://stackoverflow.com/users/3841436/vinay-sawant"}, "is_accepted": false, "score": 0, "last_activity_date": 1456318120, "creation_date": 1456318120, "answer_id": 35602678, "question_id": 35589541, "link": "https://stackoverflow.com/questions/35589541/error-with-json-parsing-in-golang/35602678#35602678", "title": "Error with JSON parsing in Golang", "body": "<p>Use <a href=\"https://github.com/Jeffail/gabs\" rel=\"nofollow\">https://github.com/Jeffail/gabs</a>\ngabs library for easy manipulation of JSON</p>\n\n<pre><code>import \"github.com/Jeffail/gabs\"\n\njsonParsed, err := gabs.ParseJSON([]byte(`{\n\"outter\":{\n    \"inner\":{\n        \"value1\":10,\n        \"value2\":22\n    },\n    \"alsoInner\":{\n        \"value1\":20\n    }\n   }\n }`))\n\nvar value float64\nvar ok bool\n\nvalue, ok = jsonParsed.Path(\"outter.inner.value1\").Data().(float64)\n// value == 10.0, ok == true\n\nvalue, ok = jsonParsed.Search(\"outter\", \"inner\", \"value1\").Data().(float64)\n// value == 10.0, ok == true\n\nvalue, ok = jsonParsed.Path(\"does.not.exist\").Data().(float64)\n// value == 0.0, ok == false\n\nexists := jsonParsed.Exists(\"outter\", \"inner\", \"value1\")\n// exists == true\n\nexists := jsonParsed.Exists(\"does\", \"not\", \"exist\")\n// exists == false\n\nexists := jsonParsed.ExistsP(\"does.not.exist\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 809, "user_id": 4571943, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f29b880ba43211bd4f2f586d09e3cc42?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkull", "link": "https://stackoverflow.com/users/4571943/darkskull"}, "is_accepted": true, "score": 1, "last_activity_date": 1456348898, "creation_date": 1456348898, "answer_id": 35613379, "question_id": 35589541, "link": "https://stackoverflow.com/questions/35589541/error-with-json-parsing-in-golang/35613379#35613379", "title": "Error with JSON parsing in Golang", "body": "<p>Here, it is the solution to my problem:\n    package main</p>\n\n<pre><code>import (\n  \"fmt\"\n  \"io/ioutil\"\n  \"encoding/json\"\n)\n\ntype Client struct {\n  Host     string `json:\"host\"`\n  Key      string `json:\"apikey\"`\n  Secret  string `json:\"secret\"`\n  Username string `json:\"username\"`\n  Password string `json:\"password\"`\n}\n\ntype Config struct {\n  Client Client `json:\"Client\"`\n}\n\nfunc main(){\n  jsonmsg, err := ioutil.ReadFile(\"conf2.json\")\n\n  conf := new(Config)\n  err = json.Unmarshal([]byte(jsonmsg), &amp;conf)\n  if err != nil {\n    fmt.Print(\"Error:\", err)\n  }\n  fmt.Printf(\"%+v\\n%+v\\n%+v\\n%+v\\n%+v\\n\", conf.Client.Host, conf.Client.Key, conf.Client.Secret, conf.Client.Username,conf.Client.Password)\n}\n</code></pre>\n"}], "owner": {"reputation": 809, "user_id": 4571943, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f29b880ba43211bd4f2f586d09e3cc42?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkull", "link": "https://stackoverflow.com/users/4571943/darkskull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1305, "favorite_count": 0, "accepted_answer_id": 35613379, "answer_count": 3, "score": -1, "last_activity_date": 1456348898, "creation_date": 1456266575, "question_id": 35589541, "link": "https://stackoverflow.com/questions/35589541/error-with-json-parsing-in-golang", "title": "Error with JSON parsing in Golang", "body": "<p>I develop this code:</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"encoding/json\"\n)\n\ntype Client struct{\n    host string\n    key string\n    secrete string\n    username string\n    password string\n}\n\ntype Config struct{\n    Client []Client\n}\n\nfunc main(){\n    content, err := ioutil.ReadFile(\"conf2.json\")\n    if err!=nil{\n        fmt.Print(\"Error:\",err)\n    }\n    var conf Config\n    err=json.Unmarshal(content, &amp;conf)\n    if err!=nil{\n        fmt.Print(\"Error:\",err)\n    }\n    json.Unmarshal(content, &amp;conf)\n    fmt.Println(conf.Client[0].host)\n}\n</code></pre>\n\n<p>to parse and print the first host detail from my json, that looks like this:</p>\n\n<blockquote>\n  <p>{\n        \"Client\" :\n        [\n            {\"host\":\"192.168.1.2\"},<br>\n            {\"key\":\"abcdf\"},\n            {\"secrete\":\"9F6w\"},\n            {\"username\":\"user\"},\n            {\"password\":\"password\"}\n        ]\n      }</p>\n</blockquote>\n\n<p>But I got an empty string. Could someone know the reason?</p>\n"}, {"tags": ["go", "benchmarking"], "answers": [{"comments": [{"owner": {"reputation": 540, "user_id": 3219492, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f0af3798a845ad28aebe81b64e58d98?s=128&d=identicon&r=PG&f=1", "display_name": "user3219492", "link": "https://stackoverflow.com/users/3219492/user3219492"}, "edited": false, "score": 0, "creation_date": 1501875907, "post_id": 35588683, "comment_id": 77990166, "body": "Is that B/op the allocations, made in stake frame or in heap? Or is it what the memory amount that GO GC has to clean?"}, {"owner": {"reputation": 1409, "user_id": 5117552, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71a2ae84018279b9286caa4922297a6d?s=128&d=identicon&r=PG", "display_name": "Ryan Lyu", "link": "https://stackoverflow.com/users/5117552/ryan-lyu"}, "edited": false, "score": 1, "creation_date": 1561948829, "post_id": 35588683, "comment_id": 100211301, "body": "Is there a formal documentation to explain these metrics?"}, {"owner": {"reputation": 1409, "user_id": 5117552, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71a2ae84018279b9286caa4922297a6d?s=128&d=identicon&r=PG", "display_name": "Ryan Lyu", "link": "https://stackoverflow.com/users/5117552/ryan-lyu"}, "edited": false, "score": 0, "creation_date": 1561956105, "post_id": 35588683, "comment_id": 100212306, "body": "What does <code>memory allocation</code> mean? Does that mean <code>set a value for a variable</code>?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 1409, "user_id": 5117552, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71a2ae84018279b9286caa4922297a6d?s=128&d=identicon&r=PG", "display_name": "Ryan Lyu", "link": "https://stackoverflow.com/users/5117552/ryan-lyu"}, "edited": false, "score": 0, "creation_date": 1561981507, "post_id": 35588683, "comment_id": 100222304, "body": "@RyanLv: No, it means memory was <i>allocated</i>, not modified. Setting a value for a variable just modifies the contents of pre-allocated memory."}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "reply_to_user": {"reputation": 1409, "user_id": 5117552, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/71a2ae84018279b9286caa4922297a6d?s=128&d=identicon&r=PG", "display_name": "Ryan Lyu", "link": "https://stackoverflow.com/users/5117552/ryan-lyu"}, "edited": false, "score": 3, "creation_date": 1572082860, "post_id": 35588683, "comment_id": 103456584, "body": "@RyanLv memory allocation means getting more memory from the operating system. Doing so reduces the available memory to your and other programs in your system."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 53, "last_activity_date": 1456263394, "creation_date": 1456263394, "answer_id": 35588683, "question_id": 35588474, "link": "https://stackoverflow.com/questions/35588474/what-does-allocs-op-and-b-op-mean-in-go-benchmark/35588683#35588683", "title": "What does allocs/op and B/op mean in go benchmark?", "body": "<p><code>allocs/op</code> means how many distinct memory allocations occurred per op (single iteration). </p>\n\n<p><code>B/op</code> is how many bytes were allocated per op.</p>\n"}], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9944, "favorite_count": 8, "accepted_answer_id": 35588683, "answer_count": 1, "score": 44, "last_activity_date": 1579623618, "creation_date": 1456262686, "question_id": 35588474, "link": "https://stackoverflow.com/questions/35588474/what-does-allocs-op-and-b-op-mean-in-go-benchmark", "title": "What does allocs/op and B/op mean in go benchmark?", "body": "<p>When I run my benchmarks with <code>go test -v -bench=. -benchmem</code>, I see the following results.</p>\n\n<pre><code>f1     10000        120860 ns/op        2433 B/op         28 allocs/op\nf2     10000        120288 ns/op        2288 B/op         26 allocs/op\n</code></pre>\n\n<p>Based on my understanding:</p>\n\n<ol>\n<li><code>10000</code> is the number of iterations <code>for i := 0; i &lt; b.N; i++ {</code>.  </li>\n<li><code>XXX ns/op</code> is approximate time it took for one iteration to complete</li>\n</ol>\n\n<p>But even after <a href=\"https://golang.org/pkg/testing/\">reading the docs</a>, I can not find out what <code>B/op</code> and <code>allocs/op</code> mean.</p>\n\n<hr>\n\n<p>My guess is that allocs/op has something to do with garbage collection and memory allocation (the less the better).</p>\n\n<p>Can anyone give a nice explanation of the meaning of these values. Also it would be nice to know why do the go up and main steps to reduce them (I realize this is test specific, but may be there are some universal hints that work in many cases)</p>\n"}, {"tags": ["gcc", "assembly", "go", "package", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 126, "user_id": 1246431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4254d4b6c9eebe54fecd792d2a0314f6?s=128&d=identicon&r=PG", "display_name": "bgeyts668", "link": "https://stackoverflow.com/users/1246431/bgeyts668"}, "edited": false, "score": 0, "creation_date": 1456260312, "post_id": 35587638, "comment_id": 58861966, "body": "Oh wow, I saw this page a dozen of times, but I never noticed the part about .s files. I guess the only way to avoid this feature is to split packages..."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1456259733, "creation_date": 1456259733, "answer_id": 35587638, "question_id": 35587395, "link": "https://stackoverflow.com/questions/35587395/assembler-used-by-golang-when-building-with-and-without-cgo/35587638#35587638", "title": "Assembler used by golang when building with and without cgo", "body": "<p>Yes, it's in the <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow\">cgo documentation</a></p>\n\n<blockquote>\n  <p>When the Go tool sees that one or more Go files use the special import\n  \"C\", it will look for other non-Go files in the directory and compile\n  them as part of the Go package. Any .c, .s, or .S files will be\n  compiled with the C compiler. Any .cc, .cpp, or .cxx files will be\n  compiled with the C++ compiler. Any .h, .hh, .hpp, or .hxx files will\n  not be compiled separately, but, if these header files are changed,\n  the C and C++ files will be recompiled. The default C and C++\n  compilers may be changed by the CC and CXX environment variables,\n  respectively; those environment variables may include command line\n  options.</p>\n</blockquote>\n"}], "owner": {"reputation": 126, "user_id": 1246431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4254d4b6c9eebe54fecd792d2a0314f6?s=128&d=identicon&r=PG", "display_name": "bgeyts668", "link": "https://stackoverflow.com/users/1246431/bgeyts668"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 35587638, "answer_count": 1, "score": 0, "last_activity_date": 1456259733, "creation_date": 1456258966, "question_id": 35587395, "link": "https://stackoverflow.com/questions/35587395/assembler-used-by-golang-when-building-with-and-without-cgo", "title": "Assembler used by golang when building with and without cgo", "body": "<p>Let's say I have a golang package, which contains some assembly code:</p>\n\n<pre><code> demopkg/\n   source1.go\n   source2.go\n   asm_amd64.s\n</code></pre>\n\n<p>If I try to build it using <code>go build</code>, toolchain will use <code>go tool asm</code> to assemble the *.s files.</p>\n\n<p>But if I add Cgo to the mixture, by putting a single <code>import \"C\"</code> into any of the sources, go will switch to gcc assembler.</p>\n\n<p>I can see it by executing <code>go build -n</code>. Calls to the <code>/usr/local/go/pkg/tool/linux_amd64/asm</code> from the first case get replaced by calls to <code>gcc</code>. Besides that, it starts complaining about broken syntax.</p>\n\n<p>Is this behaviour documented, so I can rely on it for the maintaining of my package? Can I force <code>go build</code> to use one exact assembler?</p>\n"}, {"tags": ["go", "cryptography", "hmac"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1456251810, "post_id": 35584879, "comment_id": 58857022, "body": "Why are you base64 encoding hex encodings, which just makes them even longer?"}], "answers": [{"tags": [], "owner": {"reputation": 225, "user_id": 1507342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5165ad3df4cd59728ea24317698f15bc?s=128&d=identicon&r=PG&f=1", "display_name": "d1str0", "link": "https://stackoverflow.com/users/1507342/d1str0"}, "is_accepted": false, "score": 2, "last_activity_date": 1456251190, "creation_date": 1456251190, "answer_id": 35585092, "question_id": 35584879, "link": "https://stackoverflow.com/questions/35584879/why-does-go-generate-hmac-hashes-different-than-php-and-javascript/35585092#35585092", "title": "Why does Go generate hmac hashes different than PHP and JavaScript?", "body": "<p>Your PHP function works differently than the Go function.</p>\n\n<p>From the PHP documentation:</p>\n\n<blockquote>\n  <p>Returns a string containing the calculated message digest as lowercase\n  hexits unless raw_output is set to true in which case the raw binary\n  representation of the message digest is returned. Returns FALSE when\n  algo is unknown.</p>\n</blockquote>\n\n<p>So in this case, Go is encoding the raw bytes returned from the HMAC sum. In PHP (and I assume JS), you are b64 encoding a hex string returned from the hmac.</p>\n\n<p>To achieve the same results in go, encode the []byte in hex, then base64 encode it.</p>\n\n<p>Generally, however, it is best practice to operate on bytes, not an encoding of bytes. If you <em>have</em> to conform to a previous design, go ahead, but otherwise you should be using the raw_output option allowed in the PHP function and you should end up with the same results.</p>\n"}, {"comments": [{"owner": {"reputation": 304, "user_id": 369867, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7581c54a4d5211290eedfc40d6d319fb?s=128&d=identicon&r=PG", "display_name": "Danniel Magno", "link": "https://stackoverflow.com/users/369867/danniel-magno"}, "edited": false, "score": 0, "creation_date": 1456252755, "post_id": 35585314, "comment_id": 58857569, "body": "Thank you, form your explanation I understood the problem."}], "tags": [], "owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "is_accepted": true, "score": 4, "last_activity_date": 1501529547, "last_edit_date": 1501529547, "creation_date": 1456252032, "answer_id": 35585314, "question_id": 35584879, "link": "https://stackoverflow.com/questions/35584879/why-does-go-generate-hmac-hashes-different-than-php-and-javascript/35585314#35585314", "title": "Why does Go generate hmac hashes different than PHP and JavaScript?", "body": "<p>The problem is that both your PHP and JavaScript codes do this: <code>Base64(Hex(Hmac(key, msg)))</code>. You really don't need the double encoding.</p>\n\n<p>In PHP you can simply request <code>raw_encoding</code> instead of hex:</p>\n\n<pre><code>$macSum = hash_hmac('sha256', $data, 'secret'<b>, true</b>);</code></pre>\n\n<p>and in CryptoJS, you have to encode directly to Base64 instead of encoding to hex and then using <code>btoa()</code> with:</p>\n\n<pre><code>var data64 = mac.toString(CryptoJS.enc.Base64);\n</code></pre>\n\n<p>For that, you will need to include the enc-base64.js component.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"true\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code snippet-currently-hidden\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var data = 'My name is Danniel';\r\n  \r\nvar mac = CryptoJS.HmacSHA256(data, 'secret');\r\nvar macSum = mac.toString();\r\nvar data64 = mac.toString(CryptoJS.enc.Base64)\r\ndocument.write('mac: ' + macSum + ' | b64: ' + data64);\r\n\r\nvar data64 = btoa('My name is Danniel')\r\ndocument.write('&lt;br&gt;b64: ' + data64);</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;script src=\"https://cdn.rawgit.com/CryptoStore/crypto-js/3.1.2/build/rollups/hmac-sha256.js\"&gt;&lt;/script&gt;\r\n  &lt;script src=\"https://cdn.rawgit.com/CryptoStore/crypto-js/3.1.2/build/components/enc-base64.js\"&gt;&lt;/script&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 304, "user_id": 369867, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7581c54a4d5211290eedfc40d6d319fb?s=128&d=identicon&r=PG", "display_name": "Danniel Magno", "link": "https://stackoverflow.com/users/369867/danniel-magno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 879, "favorite_count": 3, "accepted_answer_id": 35585314, "answer_count": 2, "score": 1, "last_activity_date": 1501529547, "creation_date": 1456250480, "last_edit_date": 1456252650, "question_id": 35584879, "link": "https://stackoverflow.com/questions/35584879/why-does-go-generate-hmac-hashes-different-than-php-and-javascript", "title": "Why does Go generate hmac hashes different than PHP and JavaScript?", "body": "<p>I'm starting to code in Go and I tried to do an simple request validation, by checking the signature sent by the client. At the first look everything was fine, but after a few tests validating real requests I found that Go is generating an awkward hash.</p>\n\n<p>To prove the inconsistency between the Go backend and the JavaScript signature, I developed an PHP version of the same sign method, and it gave me identical results of the JavaScript version, so my expectation was right.</p>\n\n<p>I've developed one sample test to each language: <a href=\"http://play.golang.org/p/bR6ugqGMpQ\" rel=\"nofollow\">Go</a>, <a href=\"http://www.tehplayground.com/#LwkaREfWp\" rel=\"nofollow\">PHP</a> and <a href=\"http://jsbin.com/zeyaqu/edit?html,console\" rel=\"nofollow\">JavaScript</a>.</p>\n\n<p>So, to achieve the same results of PHP and JavaScript in Go, what should I do?</p>\n\n<hr>\n\n<h2>Go</h2>\n\n<pre><code>package main\n\nimport (\n    \"crypto/hmac\"\n    \"crypto/sha256\"\n    \"encoding/base64\"\n    \"fmt\"\n)\n\nfunc main() {\n    data := \"My name is Danniel\"\n\n    mac := hmac.New(sha256.New, []byte(\"secret\"))\n    mac.Write([]byte(data))\n\n    macSum := mac.Sum(nil)\n    data64 := base64.StdEncoding.EncodeToString(macSum)\n    fmt.Println(fmt.Sprintf(\"mac: %s | b64: %s\", macSum, data64))\n\n    data64 = base64.StdEncoding.EncodeToString([]byte(\"My name is Danniel\"))\n    fmt.Println(fmt.Sprintf(\"b64: %s\", data64))\n}\n</code></pre>\n\n<h3>Output</h3>\n\n<pre><code>mac: 6\ufffd\ufffdq\ufffd\ufffd0\ufffd\uf8ee\ufffd5\u0439\ufffd\ufffd|\ufffd\ufffdG\ufffd#0\ufffd\ufffdih | b64: NqzRcf/FMLPvo678NdC58JB8lgOFR+wjMNQDDwSkaWg=\nb64: TXkgbmFtZSBpcyBEYW5uaWVs\n</code></pre>\n\n<hr>\n\n<h2>PHP</h2>\n\n<pre><code>$data = 'My name is Danniel';\n\n$macSum = hash_hmac('sha256', $data, 'secret');\n$data64 = base64_encode($macSum);\necho sprintf('mac: %s | b64: %s', $macSum, $data64) . \"\\n\";\n\n$data64 = base64_encode('My name is Danniel');\necho sprintf('b64: %s', $data64) . \"\\n\";\n</code></pre>\n\n<h3>Output</h3>\n\n<pre><code>mac: 36acd171ffc530b3efa3aefc35d0b9f0907c96038547ec2330d4030f04a46968 | b64: MzZhY2QxNzFmZmM1MzBiM2VmYTNhZWZjMzVkMGI5ZjA5MDdjOTYwMzg1NDdlYzIzMzBkNDAzMGYwNGE0Njk2OA==\nb64: TXkgbmFtZSBpcyBEYW5uaWVs\n</code></pre>\n\n<hr>\n\n<h2>JavaScript</h2>\n\n<pre><code>var data = 'My name is Danniel';\n\nvar mac = CryptoJS.HmacSHA256(data, 'secret');\nvar macSum = mac.toString();\nvar data64 = btoa(macSum)\nconsole.log('mac: ' + macSum + ' | b64: ' + data64);\n\nvar data64 = btoa('My name is Danniel')\nconsole.log('b64: ' + data64);\n</code></pre>\n\n<h3>Output</h3>\n\n<pre><code>\"mac: 36acd171ffc530b3efa3aefc35d0b9f0907c96038547ec2330d4030f04a46968 | b64: MzZhY2QxNzFmZmM1MzBiM2VmYTNhZWZjMzVkMGI5ZjA5MDdjOTYwMzg1NDdlYzIzMzBkNDAzMGYwNGE0Njk2OA==\"\n\"b64: TXkgbmFtZSBpcyBEYW5uaWVs\"\n</code></pre>\n"}, {"tags": ["linux", "go", "server", "raspberry-pi", "debian"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1456248102, "post_id": 35583853, "comment_id": 58854759, "body": "You should log the error returned from<code>http.ListenAndServe</code>, which can be helpful if there&#39;s trouble starting the server."}, {"owner": {"reputation": 526, "user_id": 2557094, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZaxTo.png?s=128&g=1", "display_name": "79-madms", "link": "https://stackoverflow.com/users/2557094/79-madms"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456249719, "post_id": 35583853, "comment_id": 58855815, "body": "Will do. I&#39;ll make the modification and report back if it helps me pinpoint the problem. Thanks for the idea!"}, {"owner": {"reputation": 526, "user_id": 2557094, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZaxTo.png?s=128&g=1", "display_name": "79-madms", "link": "https://stackoverflow.com/users/2557094/79-madms"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456279698, "post_id": 35583853, "comment_id": 58870118, "body": "As a followup, I spent a good hour trying to figure out how to log to a text file via http.ListenAndServe, but the documentation on http isn&#39;t especially useful for this, and I&#39;m very new to Go. So if I&#39;m able to figure out how to log to a text file and if it helps me troubleshoot, I&#39;ll update."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1456286663, "post_id": 35583853, "comment_id": 58872179, "body": "Supervisord and systemd are the go-to for managing services: <a href=\"http://elithrar.github.io/article/running-go-applications-in-the-background/\" rel=\"nofollow noreferrer\">elithrar.github.io/article/&hellip;</a>"}, {"owner": {"reputation": 526, "user_id": 2557094, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZaxTo.png?s=128&g=1", "display_name": "79-madms", "link": "https://stackoverflow.com/users/2557094/79-madms"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1456343976, "post_id": 35583853, "comment_id": 58907692, "body": "@elithrar Brilliant! Supervisord solved the problem completely in record time. The server survives reboots and has been running without issue. If you&#39;d like to &quot;answer&quot; this question, I&#39;ll mark yours as the answer; I&#39;ll otherwise give you credit and provide a short explanation myself."}], "answers": [{"comments": [{"owner": {"reputation": 526, "user_id": 2557094, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZaxTo.png?s=128&g=1", "display_name": "79-madms", "link": "https://stackoverflow.com/users/2557094/79-madms"}, "edited": false, "score": 0, "creation_date": 1456412746, "post_id": 35618610, "comment_id": 58943325, "body": "Your article was both clear and extremely helpful, and Supervisor solved my problem completely. Thank you! Just for my own curiosity, though, do you happen to have any idea why daemonization of the server failed? It happened with both the Go server and an effectively identical server in Python, and it didn&#39;t seem to have anything to do with the network interface not being up, as stopping and restarting the service (when the network was most definitely up) had no effect. It also made no difference which user I ran the daemon as."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 526, "user_id": 2557094, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZaxTo.png?s=128&g=1", "display_name": "79-madms", "link": "https://stackoverflow.com/users/2557094/79-madms"}, "edited": false, "score": 0, "creation_date": 1456413178, "post_id": 35618610, "comment_id": 58943689, "body": "It&#39;s hard to tell: what port was your service running on? Which user? It&#39;s also possible that (if init.d is forking your program) that you&#39;re running into this issue: <a href=\"https://github.com/golang/go/issues/227\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/227</a> (can&#39;t fork/daemon() Go programs). Which OS is this init file on?"}, {"owner": {"reputation": 526, "user_id": 2557094, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZaxTo.png?s=128&g=1", "display_name": "79-madms", "link": "https://stackoverflow.com/users/2557094/79-madms"}, "edited": false, "score": 0, "creation_date": 1456429286, "post_id": 35618610, "comment_id": 58955037, "body": "I experimented with various ports, but none of them was below the range that has to be invoked by root. I also experimented with different users, including root. The OS was Jessie (Debian), running on a Raspberry Pi 2. The thing that still sticks out to me is that this happened to an identical HTTP server I wrote in Python. Don&#39;t trouble yourself if the problem isn&#39;t immediately obvious; I&#39;d just like to learn what I was doing wrong."}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 2, "last_activity_date": 1456375835, "creation_date": 1456375835, "answer_id": 35618610, "question_id": 35583853, "link": "https://stackoverflow.com/questions/35583853/how-do-i-run-a-simple-go-server-as-a-daemon-in-debian/35618610#35618610", "title": "How do I run a simple Go server as a daemon in Debian?", "body": "<p>Supervisor is a good fit here, and can automatically capture and rotate logs written to stdout, restart on crash and manage ports/permissions.</p>\n\n<p>Here's what an example configuration would look like for a Go web service:</p>\n\n<pre><code># where 'mygoapp' is the name of your application\n$ sudo vim /etc/supervisor/conf.d/mygoapp.conf \n\n[program:yourapp]\ncommand=/home/yourappuser/bin/yourapp # the location of your app\nautostart=true\nautorestart=true\nstartretries=10\nuser=yourappuser # the user your app should run as (i.e. *not* root!)\ndirectory=/srv/www/yourapp.com/ # where your application runs from\nenvironment=APP_SETTINGS=\"/srv/www/yourapp.com/prod.toml\" # environmental variables\nredirect_stderr=true\nstdout_logfile=/var/log/supervisor/yourapp.log # the name of the log file.\nstdout_logfile_maxbytes=50MB\nstdout_logfile_backups=10\n</code></pre>\n\n<p>I wrote an article[<a href=\"http://elithrar.github.io/article/running-go-applications-in-the-background/\" rel=\"nofollow\">1</a>] that takes you through the steps, but the <a href=\"http://supervisord.org/configuration.html\" rel=\"nofollow\">Supervisor documentation</a> is extremely comprehensive.</p>\n\n<p>Similarly, Debian systems also use systemd[<a href=\"https://www.digitalocean.com/community/tutorials/understanding-systemd-units-and-unit-files\" rel=\"nofollow\">2</a>], which can achieve this as well.</p>\n"}], "owner": {"reputation": 526, "user_id": 2557094, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZaxTo.png?s=128&g=1", "display_name": "79-madms", "link": "https://stackoverflow.com/users/2557094/79-madms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2118, "favorite_count": 1, "accepted_answer_id": 35618610, "answer_count": 1, "score": 2, "last_activity_date": 1456375835, "creation_date": 1456247463, "last_edit_date": 1456342460, "question_id": 35583853, "link": "https://stackoverflow.com/questions/35583853/how-do-i-run-a-simple-go-server-as-a-daemon-in-debian", "title": "How do I run a simple Go server as a daemon in Debian?", "body": "<p>I recently wrote a simple server in Go:</p>\n\n<pre><code>package main\nimport (\n    \"net/http\"\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":****\", nil)\n    }\n\nfunc handler(output http.ResponseWriter, input *http.Request) {\n\n    instruction := \"Instructed to \" + input.URL.Path[1:] + \".\"\n\n    fmt.Printf(instruction)\n\n    if input.URL.Path[1:] == \"********\" {\n\n            *************\n            *************\n            *************                \n\n            if err != nil {\n                    fmt.Println(\"There was a problem executing the script.\")\n                    }\n            } else {\n\n            fmt.Println(\" I'm unfamiliar with this instruction.\")\n            }\n\n    }\n</code></pre>\n\n<p>It works perfectly well if compiled and then executed by <strong>./go_http_server &amp;</strong>.</p>\n\n<p>The problem is that it doesn't survive reboots. So after some reading, I attempted to daemonize it by placing a script in /etc/init.d:</p>\n\n<pre><code>#!/bin/sh\n\n### BEGIN INIT INFO\n# Provides:          myservice\n# Required-Start:    $remote_fs $syslog\n# Required-Stop:     $remote_fs $syslog\n# Default-Start:     2 3 4 5\n# Default-Stop:      0 1 6\n# Short-Description: Put a short description of the service here\n# Description:       Put a long description of the service here\n### END INIT INFO\n\n# Change the next 3 lines to suit where you install your script and what you want to call it\nDIR=/****/****\nDAEMON=$DIR/go_http_server\nDAEMON_NAME=*********\n\n# Add any command line options for your daemon here\nDAEMON_OPTS=\"\"\n\n# This next line determines what user the script runs as.\n# Root generally not recommended but necessary if you are using the Raspberry Pi GPIO from Python.\nDAEMON_USER=*****\n\n# The process ID of the script when it runs is stored here:\nPIDFILE=/var/run/$DAEMON_NAME.pid\n\n. /lib/lsb/init-functions\n\ndo_start () {\n    log_daemon_msg \"Starting system $DAEMON_NAME daemon\"\n    start-stop-daemon --start --background --pidfile $PIDFILE --make-pidfile --user $DAEMON_USER --chuid $DAEMON_USER --startas $DAEMON -- $DAEMON_OPTS\n    log_end_msg $?\n}\ndo_stop () {\n    log_daemon_msg \"Stopping system $DAEMON_NAME daemon\"\n    start-stop-daemon --stop --pidfile $PIDFILE --retry 10\n    log_end_msg $?\n}\n\ncase \"$1\" in\n\n    start|stop)\n        do_${1}\n        ;;\n\n    restart|reload|force-reload)\n        do_stop\n        do_start\n        ;;\n\n    status)\n        status_of_proc \"$DAEMON_NAME\" \"$DAEMON\" &amp;&amp; exit 0 || exit $?\n</code></pre>\n\n<p>...then running <strong>update-rc.d go_http_server defaults</strong>, and poof! It runs on boot, as verified by <strong>ps -ef | grep go_http_server</strong>.</p>\n\n<p>But it doesn't receive GET requests while running as a service. Thinking it might be running before the network interface was up, I tried <strong>service  go_http_server stop</strong>, followed by <strong>service go_http_server start</strong>; still refused to receive GET requests. Stopping the service again and then executing <strong>./go_http_server &amp;</strong> makes the server function correctly once more.</p>\n\n<p>I've been Googling this on and off for a couple days now. Either my search queries suck, or this isn't an obvious problem. How do I daemonize my Go server?</p>\n\n<hr>\n\n<p>EDIT: The exact same thing happens with a server I wrote in Python: it works as it should when executed using <strong>./python_server.py</strong>, but--if started as service--HTTP requests are ignored. Both files have been made executable, and it doesn't matter if the daemon user is root or any other user. Not sure if this helps, but I thought it might be relevant.</p>\n"}, {"tags": ["go", "rabbitmq"], "answers": [{"comments": [{"owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "edited": false, "score": 0, "creation_date": 1456248572, "post_id": 35584188, "comment_id": 58855065, "body": "That&#39;s my problem, I don&#39;t know what type I&#39;m getting, &quot;under&quot; the string. So the secound option is not good. About the first one, how can I convert the <code>map[string]interface{}</code>  if I dont know what key to use? @JimB"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "edited": false, "score": 0, "creation_date": 1456250199, "post_id": 35584188, "comment_id": 58856090, "body": "@darthydarth: What you do you mean &quot;under the string&quot;? In the map? play.golang.org/p/0zZ8fsmO17"}, {"owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "edited": false, "score": 0, "creation_date": 1456256552, "post_id": 35584188, "comment_id": 58859795, "body": "EDIT: Sorry just commented now before looking at your playground solution. That is exactly what I was missing! thank you!  Please post it as an solution for others and I&#39;ll up-vote. Thanks again @JimB"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "edited": false, "score": 1, "creation_date": 1456257542, "post_id": 35584188, "comment_id": 58860396, "body": "@darthydarth: You&#39;re not getting a struct, you can only get one of those 6 default types when unmarshaling into an <code>interface{}</code>, and you can&#39;t assert an interface to a type that it isn&#39;t. Take the data out of the map you&#39;re getting and create a new struct of the type you want."}, {"owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "edited": false, "score": 0, "creation_date": 1456258237, "post_id": 35584188, "comment_id": 58860793, "body": "Yes I understand that. I was missing the part about using range... If add your soulution to my original code I can assert  back to the new instances of the original structs. I think..."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "edited": false, "score": 1, "creation_date": 1456258467, "post_id": 35584188, "comment_id": 58860914, "body": "@darthydarth: a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a> only asserts that in interface contains a specific type; you can&#39;t change the type it contains. The range statement doesn&#39;t change anything, it was just an easy way to display the contents of the map."}, {"owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "edited": false, "score": 0, "creation_date": 1456263641, "post_id": 35584188, "comment_id": 58863797, "body": "JimB: Perfect thanks, after trying different things in the play ground I think this is the best solution to this, Thanks!"}, {"owner": {"reputation": 447, "user_id": 776896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f590ff1e6f4dab2937b0d27a59be828a?s=128&d=identicon&r=PG", "display_name": "the_real_one", "link": "https://stackoverflow.com/users/776896/the-real-one"}, "edited": false, "score": 0, "creation_date": 1547951167, "post_id": 35584188, "comment_id": 95368831, "body": "It seems that this method entirely depends on a field in one of the structs. Is there another way possibly - I cannot think of anything BUT that?"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 37, "last_activity_date": 1456499955, "last_edit_date": 1456499955, "creation_date": 1456248409, "answer_id": 35584188, "question_id": 35583735, "link": "https://stackoverflow.com/questions/35583735/unmarshaling-into-an-interface-and-then-performing-type-assertion/35584188#35584188", "title": "Unmarshaling Into an Interface{} and Then Performing Type Assertion", "body": "<p>The default types that the <code>json</code> package Unmarshals into are shown in the <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"noreferrer\"><code>Unmarshal</code> function documentation</a></p>\n\n<pre><code>bool, for JSON booleans\nfloat64, for JSON numbers\nstring, for JSON strings\n[]interface{}, for JSON arrays\nmap[string]interface{}, for JSON objects\nnil for JSON null\n</code></pre>\n\n<p>Since you're unmarshaling into an <code>interface{}</code>, the returned types will only be from that set. The <code>json</code> package doesn't know about <code>Something1</code> and <code>Something2</code>. You either need to convert from the <code>map[string]interface{}</code> that the json object is being unmarshaled into, or unmarshal directly into the struct type you want.</p>\n\n<p>If you don't want to do unpack the data from a generic interface, or somehow tag the data so you know what type to expect, you could iteratively take the json and try to unmarshal it into each type you want.</p>\n\n<p>You can even pack those into a wrapper struct to do the unmarshaling for you:</p>\n\n<pre><code>type Something1 struct {\n    Thing      string `json:\"thing\"`\n    OtherThing int64  `json:\"other_thing\"`\n}\n\ntype Something2 struct {\n    Croc  int  `json:\"croc\"`\n    Odile bool `json:\"odile\"`\n}\n\ntype Unpacker struct {\n    Data       interface{}\n}\n\nfunc (u *Unpacker) UnmarshalJSON(b []byte) error {\n    smth1 := &amp;Something1{}\n    err := json.Unmarshal(b, smth1)\n\n    // no error, but we also need to make sure we unmarshaled something\n    if err == nil &amp;&amp; smth1.Thing != \"\" {\n        u.Data = smth1\n        return nil\n    }\n\n    // abort if we have an error other than the wrong type\n    if _, ok := err.(*json.UnmarshalTypeError); err != nil &amp;&amp; !ok {\n        return err\n    }\n\n    smth2 := &amp;Something2{}\n    err = json.Unmarshal(b, smth2)\n    if err != nil {\n        return err\n    }\n\n    u.Data = smth2\n    return nil\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/Trwd6IShDW\" rel=\"noreferrer\">http://play.golang.org/p/Trwd6IShDW</a></p>\n"}, {"comments": [{"owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "edited": false, "score": 0, "creation_date": 1456259007, "post_id": 35587004, "comment_id": 58861211, "body": "Liked the first solution, its exactly as you named it...but still will do the job perfectly. The second one is not that practical because in real life I have a very large struct constructed out of lots of other complex structs used by many places in the program so building a struct just to name the transferred main struct seems wrong to me  and not pretty at all."}, {"owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "reply_to_user": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "edited": false, "score": 1, "creation_date": 1456259306, "post_id": 35587004, "comment_id": 58861380, "body": "@darthydarth  This &quot;wrapper struct&quot; will just be used for sending and receiving data. You can still use the original structs in the program. I think it&#39;s the better solution, but you are of course free to choose what fit&#39;s your case best."}, {"owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "edited": false, "score": 0, "creation_date": 1456260377, "post_id": 35587004, "comment_id": 58862003, "body": "I do agree in a way, yet it still looks weird to me specifying the type in a string. I mite be wrong about that. Still, thanks for both solutions- upvoted"}, {"owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "reply_to_user": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "edited": false, "score": 2, "creation_date": 1456261100, "post_id": 35587004, "comment_id": 58862413, "body": "@darthydarth The <code>Type</code> could be anything that qualifies as an identifier (e.g. distinct int values). It looks weird because it really is just a hack to get around the limitations of json."}, {"owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "edited": false, "score": 0, "creation_date": 1456261629, "post_id": 35587004, "comment_id": 58862679, "body": "yep a hack indeed, it&#39;s ok, I just really hate adding to many objects to a type if its not necessary. In this guess you are right"}, {"owner": {"reputation": 58775, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "edited": false, "score": 0, "creation_date": 1506839713, "post_id": 35587004, "comment_id": 79973845, "body": "Great answer, <code>json.RawMessage</code> is exactly the right solution for this type of problem."}], "tags": [], "owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "is_accepted": false, "score": 16, "last_activity_date": 1456261120, "last_edit_date": 1456261120, "creation_date": 1456257500, "answer_id": 35587004, "question_id": 35583735, "link": "https://stackoverflow.com/questions/35583735/unmarshaling-into-an-interface-and-then-performing-type-assertion/35587004#35587004", "title": "Unmarshaling Into an Interface{} and Then Performing Type Assertion", "body": "<p>You have encountered a typical json vs typed language problem! \nSince json is untyped and schemaless, it is not possible to infer what data is \"under the string\" without actually decoding it.</p>\n\n<p>So your only option is to unmarshal into an <code>interface{}</code> which always produces a <code>map[string]interface{}</code>. You could do some reflection magic here to build the final struct, but that's a lot of manual work and error prone.\nHere are some possible solutions:</p>\n\n<h2>Quick 'n' dirty</h2>\n\n<p>Let the <code>json</code> package do the reflection stuff. Attempt to unmarshal into every expected type:</p>\n\n<pre><code>func typeAssert(msg string) {\n\n var thing1 Something1\n\n err := json.Unmarshal([]byte(msg), &amp;thing1)\n if err == nil{\n    // do something with thing1\n    return\n }    \n\n var thing2 Something2\n\n err = json.Unmarshal([]byte(msg), &amp;thing2)\n if err == nil{\n    // do something with thing2\n    return\n }    \n\n //handle unsupported type\n\n}\n</code></pre>\n\n<h2>Build your own \"type system\" on top of json</h2>\n\n<p>Defer the encoding until you know what's inside. Use this struct as an intermediate representation of your data:</p>\n\n<pre><code>type TypedJson struct{\n  Type string \n  Data json.RawMessage\n}\n</code></pre>\n\n<p>Marshal: </p>\n\n<pre><code>thing := Something1{\"asd\",123}\ntempJson, _ := json.Marshal(thing)\n\ntypedThing := TypedJson{\"something1\", tempJson}\nfinalJson, _ := json.Marshal(typedThing)\n</code></pre>\n\n<p>Unmarshal:</p>\n\n<pre><code>func typeAssert(msg string) {\n\n  var input TypedJson  \n  json.Unmarshal([]byte(msg), &amp;input)\n\n  switch input.Type{\n  case \"something1\":\n    var thing Something1\n    json.Unmarshal(input.Data, &amp;thing)\n    queueStatsRes(thing)   \n   case \"something2\":\n    var thing Something2\n    json.Unmarshal(input.Data, &amp;thing)\n    queueStatsRes(thing)\n  default:\n    //handle unsupported type\n}\n</code></pre>\n\n<h2>Use a typed serialization format</h2>\n\n<ul>\n<li>Go's own <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"noreferrer\">gob</a> encoding</li>\n<li><a href=\"https://github.com/golang/protobuf\" rel=\"noreferrer\">Protocol Buffers</a></li>\n<li>and many more...</li>\n</ul>\n"}], "owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38278, "favorite_count": 6, "accepted_answer_id": 35584188, "answer_count": 2, "score": 38, "last_activity_date": 1456499955, "creation_date": 1456247142, "question_id": 35583735, "link": "https://stackoverflow.com/questions/35583735/unmarshaling-into-an-interface-and-then-performing-type-assertion", "title": "Unmarshaling Into an Interface{} and Then Performing Type Assertion", "body": "<p>I get a <code>string</code> through a rabbitmq message system. Before sending,</p>\n\n<p>I use <code>json.Marshal</code>, convert the outcome to <code>string</code> and send through \nrabbitmq.</p>\n\n<p>The structs that I convert and send can be: (changed the names and the size of the structs but it should not matter)</p>\n\n<pre><code>type Somthing1 struct{\n   Thing        string    `json:\"thing\"`\n   OtherThing   int64     `json:\"other_thing\"`\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>type Somthing2 struct{\n   Croc        int       `json:\"croc\"`\n   Odile       bool      `json:\"odile\"`\n}\n</code></pre>\n\n<p>The message goes through perfectly as a <code>string</code> and is printed \non the other side (some server)</p>\n\n<p>Up until now everything works.\nNow I'm trying to convert them back into their structs and assert the types. </p>\n\n<p>first attempt is by:</p>\n\n<pre><code>func typeAssert(msg string) {\n\n var input interface{}\n\n json.Unmarshal([]byte(msg), &amp;input)\n\n switch input.(type){\n case Somthing1:\n    job := Somthing1{}\n    job = input.(Somthing1)\n    queueResults(job)\n\n  case Somthing2:\n    stats := Somthing2{}\n    stats = input.(Somthing2)\n    queueStatsRes(stats)\n default:\n}\n</code></pre>\n\n<p>This does not work. When Printing the type of <code>input</code> after Unmarshaling\nit I get <code>map[string]interface{}</code> (?!?)</p>\n\n<p>and even stranger than that, the map key is the string I got and the map value is empty.</p>\n\n<p>I did some other attempts like:</p>\n\n<pre><code> func typeAssert(msg string) {\n\n  var input interface{}\n\n  json.Unmarshal([]byte(msg), &amp;input)\n\n  switch v := input.(type){\n  case Somthing1:\n    v = input.(Somthing1)\n    queueResults(v)\n\n   case Somthing2:\n    v = input.(Somthing2)\n    queueStatsRes(v)\n  default:\n}\n</code></pre>\n\n<p>and also tried writing the switch like was explained in this answer:\n<a href=\"http://Golang:%20cannot%20type%20switch%20on%20non-interface%20value\" rel=\"noreferrer\">Golang: cannot type switch on non-interface value</a></p>\n\n<pre><code>switch v := interface{}(input).(type)\n</code></pre>\n\n<p>still with no success...</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["logging", "go", "google-compute-engine", "google-kubernetes-engine", "google-cloud-logging"], "answers": [{"comments": [{"owner": {"reputation": 436, "user_id": 709371, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/08feb796de11a745a9d0d35674544b03?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/709371/michael"}, "edited": false, "score": 0, "creation_date": 1456843384, "post_id": 35638659, "comment_id": 59126427, "body": "Thank you!  Is there any documentation for what can be added to the JSON log? Eg what is the key for the actual message, or flags."}, {"owner": {"reputation": 10802, "user_id": 1925481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f67189b5e857901a302b0049f210b80b?s=128&d=identicon&r=PG", "display_name": "Alex Robinson", "link": "https://stackoverflow.com/users/1925481/alex-robinson"}, "reply_to_user": {"reputation": 436, "user_id": 709371, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/08feb796de11a745a9d0d35674544b03?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/709371/michael"}, "edited": false, "score": 2, "creation_date": 1456854244, "post_id": 35638659, "comment_id": 59134344, "body": "It doesn&#39;t appear to be well-documented at all, sorry. The special fields are only really &quot;severity&quot; for log severity and &quot;message&quot; for the actual log message. The code itself is the place I got this from: <a href=\"https://github.com/GoogleCloudPlatform/fluent-plugin-google-cloud/blob/master/lib/fluent/plugin/out_google_cloud.rb\" rel=\"nofollow noreferrer\">github.com/GoogleCloudPlatform/fluent-plugin-google-cloud/bl&zwnj;&#8203;ob/&hellip;</a>"}, {"owner": {"reputation": 2432, "user_id": 4507, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0f600e4994c90f449bb8b0f206b153ac?s=128&d=identicon&r=PG", "display_name": "Martin McNulty", "link": "https://stackoverflow.com/users/4507/martin-mcnulty"}, "edited": false, "score": 0, "creation_date": 1498497719, "post_id": 35638659, "comment_id": 76511390, "body": "This seems to have stopped working since upgrading nodes to &gt;= 1.6. The whole JSON object now appears un-parsed under <code>textPayload</code> :-("}, {"owner": {"reputation": 2432, "user_id": 4507, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0f600e4994c90f449bb8b0f206b153ac?s=128&d=identicon&r=PG", "display_name": "Martin McNulty", "link": "https://stackoverflow.com/users/4507/martin-mcnulty"}, "edited": false, "score": 0, "creation_date": 1498564461, "post_id": 35638659, "comment_id": 76539670, "body": "The issue I mentioned in my previous comment is this one, which looks like it will be fixed soon :) <a href=\"https://github.com/kubernetes/kubernetes/issues/48108\" rel=\"nofollow noreferrer\">github.com/kubernetes/kubernetes/issues/48108</a>"}], "tags": [], "owner": {"reputation": 10802, "user_id": 1925481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f67189b5e857901a302b0049f210b80b?s=128&d=identicon&r=PG", "display_name": "Alex Robinson", "link": "https://stackoverflow.com/users/1925481/alex-robinson"}, "is_accepted": true, "score": 7, "last_activity_date": 1456435524, "creation_date": 1456435524, "answer_id": 35638659, "question_id": 35582153, "link": "https://stackoverflow.com/questions/35582153/logging-to-the-google-cloud-in-google-container-compute-engine-with-go/35638659#35638659", "title": "Logging to the Google Cloud in Google Container/Compute Engine with Go", "body": "<p>There are a couple things you can do depending on how ambitious you're feeling.</p>\n\n<p>The easiest option would likely be to switch your logging format to be JSON. The google-fluentd agent will automatically parse the JSON for you, exporting each message's structured data to the cloud logging API. It will automatically grab severity information if a <code>severity</code> field is in the JSON, and using JSON can keep it from breaking on (escaped) newlines in your messages.</p>\n\n<p>The tougher (but more flexible) option would be to get the client library that you found working. I'm not sure whether it's the same as the one you linked to, but I believe <a href=\"https://github.com/google/google-api-go-client/blob/master/logging/v2beta1/logging-gen.go\" rel=\"noreferrer\">this is the most recent one</a>. If you can give more context about the problems you had, I can help or wrangle someone from the cloud logging team to help.</p>\n"}, {"tags": [], "owner": {"reputation": 489, "user_id": 8244338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0QUan.jpg?s=128&g=1", "display_name": "Israel", "link": "https://stackoverflow.com/users/8244338/israel"}, "is_accepted": false, "score": 0, "last_activity_date": 1608041365, "creation_date": 1608041365, "answer_id": 65307564, "question_id": 35582153, "link": "https://stackoverflow.com/questions/35582153/logging-to-the-google-cloud-in-google-container-compute-engine-with-go/65307564#65307564", "title": "Logging to the Google Cloud in Google Container/Compute Engine with Go", "body": "<p>I used custom logging class and instead of log every message I saved them in a variable, and send it after the server response - so I finally have in google cloud only one logging for every request with a very long textPayload.</p>\n<p>The custom logging class looks something like this:</p>\n<pre><code>class CustomLogging {\n   \n    messages = &quot;&quot;;\n\n    log(message) {\n        this.messages += '\\n' + message;\n    }\n\n    sendLogs(message) {\n        console.log(this.messages);\n    }\n\n}\n</code></pre>\n<p>Every request log look like this:</p>\n<p><a href=\"https://i.stack.imgur.com/X4vsc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X4vsc.png\" alt=\"enter image description here\" /></a></p>\n"}], "owner": {"reputation": 436, "user_id": 709371, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/08feb796de11a745a9d0d35674544b03?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/709371/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1201, "favorite_count": 1, "accepted_answer_id": 35638659, "answer_count": 2, "score": 7, "last_activity_date": 1608041365, "creation_date": 1456242972, "last_edit_date": 1456243286, "question_id": 35582153, "link": "https://stackoverflow.com/questions/35582153/logging-to-the-google-cloud-in-google-container-compute-engine-with-go", "title": "Logging to the Google Cloud in Google Container/Compute Engine with Go", "body": "<p>I have a GKE application with 20 nodes running Go. I would like to consolidate all the logs to view in the Google Developers Console log viewer, but I am having 2 problems. I can't get severity filtering, and each newline in my log message starts a new log entry in the viewer (problematic with newlines in the log).</p>\n\n<p>I have the google-fluent-d setup so all stdout gets logged in the cloud, and I have made use of log.Lshortfile, call depth and log.Logger.Output to get filename and line number from the \"log\" library.</p>\n\n<p>I've looked at this library: \"google.golang.org/cloud/logging\" but I am having trouble getting it to work.</p>\n\n<p>Is there a library somewhere or an example of the best way to write logs in GKE and GCE?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456242394, "post_id": 35581762, "comment_id": 58850553, "body": "Print the working directory of your app when it starts. You need to make sure that the relative path to <code>public</code> is <code>.&#47;public</code> (even better, don&#39;t rely on a relative path)"}, {"owner": {"reputation": 806, "user_id": 2547389, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f943f94b1bfe169a3291c5b94b7f938a?s=128&d=identicon&r=PG", "display_name": "wlredeye", "link": "https://stackoverflow.com/users/2547389/wlredeye"}, "edited": false, "score": 6, "creation_date": 1456242670, "post_id": 35581762, "comment_id": 58850750, "body": "you running server on 8181 port, but visting 8081?"}, {"owner": {"reputation": 490, "user_id": 3310759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/409b69c3ae7b431fc16129ccdadae9cd?s=128&d=identicon&r=PG", "display_name": "driusan", "link": "https://stackoverflow.com/users/3310759/driusan"}, "edited": false, "score": 0, "creation_date": 1456244431, "post_id": 35581762, "comment_id": 58852147, "body": "Since your URL path isn&#39;t the same as the local path, you need to use StripPrefix. See the example in the godocs: <a href=\"https://golang.org/pkg/net/http/#example_FileServer_stripPrefix\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#example_FileServer_stripPrefix</a>"}, {"owner": {"reputation": 5976, "user_id": 295480, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764660d78a93b3e757b781fa57ce32?s=128&d=identicon&r=PG", "display_name": "LDJ", "link": "https://stackoverflow.com/users/295480/ldj"}, "edited": false, "score": 0, "creation_date": 1456297661, "post_id": 35581762, "comment_id": 58876295, "body": "@wiredeye: Apologies, that was me just playing about changing port numbers <i>in case</i> there was a problem with a given port.Fixed in post now and I&#39;m definitely hitting the same port as I&#39;m listening on (else I wouldn&#39;t get a 404 being returned)"}, {"owner": {"reputation": 5976, "user_id": 295480, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764660d78a93b3e757b781fa57ce32?s=128&d=identicon&r=PG", "display_name": "LDJ", "link": "https://stackoverflow.com/users/295480/ldj"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456297713, "post_id": 35581762, "comment_id": 58876327, "body": "@JimB: I tried logging os.Getwd() but that doesn&#39;t return anything. Can you provide an example please so I can understand what I&#39;m doing wrong"}, {"owner": {"reputation": 5976, "user_id": 295480, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764660d78a93b3e757b781fa57ce32?s=128&d=identicon&r=PG", "display_name": "LDJ", "link": "https://stackoverflow.com/users/295480/ldj"}, "reply_to_user": {"reputation": 490, "user_id": 3310759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/409b69c3ae7b431fc16129ccdadae9cd?s=128&d=identicon&r=PG", "display_name": "driusan", "link": "https://stackoverflow.com/users/3310759/driusan"}, "edited": false, "score": 0, "creation_date": 1456297836, "post_id": 35581762, "comment_id": 58876387, "body": "@driusan: Didn&#39;t seem to help: mux.Handle(&quot;/&quot;, http.StripPrefix(&quot;/public&quot;, fs))"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456322172, "post_id": 35581762, "comment_id": 58892685, "body": "@LDJ: <code>os.Getwd</code> must return <i>something</i>. The process has a working directory, or you&#39;re getting some sort of OS error. Regardless, giving the pull path to <code>public</code> will show whether that&#39;s the issue or not."}], "owner": {"reputation": 5976, "user_id": 295480, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/50764660d78a93b3e757b781fa57ce32?s=128&d=identicon&r=PG", "display_name": "LDJ", "link": "https://stackoverflow.com/users/295480/ldj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1456296392, "creation_date": 1456241897, "last_edit_date": 1456296392, "question_id": 35581762, "link": "https://stackoverflow.com/questions/35581762/static-file-go-web-app-always-returns-404", "title": "Static file Go web app always returns 404", "body": "<p>I have a very basic Go web app which is simply supposed to serve static files from a public sub-folder:</p>\n\n<pre><code>package main\n\nimport (\n\"net/http\"\n)\n\nfunc main() {\n    mux := http.NewServeMux()\n    fs := http.FileServer(http.Dir(\"public\"))\n    mux.Handle(\"/\", fs)\n    http.ListenAndServe(\":8181\", mux)\n}\n</code></pre>\n\n<p>If I run the app (go run main.go) it starts, but when I visit </p>\n\n<pre><code>localhost:8181/readme.txt\n</code></pre>\n\n<p>or</p>\n\n<pre><code>localhost:8181/index.html\n</code></pre>\n\n<p>both of which exist within the public sub folder, I get a 404 error returned. Nothing is logged (that I know of), but I\u2019m at odds to understand why it is not being served.</p>\n\n<p>Any suggestions welcomed.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["google-app-engine", "go", "asana", "asana-api", "asana-connect"], "answers": [{"comments": [{"owner": {"reputation": 2022, "user_id": 2752896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6HtSo.jpg?s=128&g=1", "display_name": "Nikhil Maheshwari", "link": "https://stackoverflow.com/users/2752896/nikhil-maheshwari"}, "edited": false, "score": 0, "creation_date": 1456243096, "post_id": 35581816, "comment_id": 58851090, "body": "But  raw := r.URL.String() is fetching only api/redirect.asana, I need complete url to be fetched for this code to work."}, {"owner": {"reputation": 2022, "user_id": 2752896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6HtSo.jpg?s=128&g=1", "display_name": "Nikhil Maheshwari", "link": "https://stackoverflow.com/users/2752896/nikhil-maheshwari"}, "edited": false, "score": 0, "creation_date": 1456243490, "post_id": 35581816, "comment_id": 58851387, "body": "Your code is working only when I am changing # to ?. I think we are back to zero. In case of ? even r.FormValue(&quot;access_token&quot;) is sufficient."}, {"owner": {"reputation": 2022, "user_id": 2752896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6HtSo.jpg?s=128&g=1", "display_name": "Nikhil Maheshwari", "link": "https://stackoverflow.com/users/2752896/nikhil-maheshwari"}, "edited": false, "score": 0, "creation_date": 1456244392, "post_id": 35581816, "comment_id": 58852109, "body": "Even r.URL.Fragment is blank so rest code will not work."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2022, "user_id": 2752896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6HtSo.jpg?s=128&g=1", "display_name": "Nikhil Maheshwari", "link": "https://stackoverflow.com/users/2752896/nikhil-maheshwari"}, "edited": false, "score": 0, "creation_date": 1456246149, "post_id": 35581816, "comment_id": 58853393, "body": "@NikhilMaheshwari Fragments are not sent over to the server. See edited answer. I also cleaned up my comments."}, {"owner": {"reputation": 2022, "user_id": 2752896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6HtSo.jpg?s=128&g=1", "display_name": "Nikhil Maheshwari", "link": "https://stackoverflow.com/users/2752896/nikhil-maheshwari"}, "edited": false, "score": 0, "creation_date": 1456246177, "post_id": 35581816, "comment_id": 58853417, "body": "I was doing it manually, just to test how my handler will behave if its a ? instead of #, no way to change otherwise. As long as I can&#39;t get URL parameters, I can not do it. Thanks for the informative link in the answer but  I don&#39;t have control over the URL as it&#39;s a redirect URL from ASANA."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2022, "user_id": 2752896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6HtSo.jpg?s=128&g=1", "display_name": "Nikhil Maheshwari", "link": "https://stackoverflow.com/users/2752896/nikhil-maheshwari"}, "edited": false, "score": 0, "creation_date": 1456246285, "post_id": 35581816, "comment_id": 58853484, "body": "In that case, my very first answer stands. You can&#39;t test it from your browser, because the browser won&#39;t send the fragment. If it is coming from another server, you will most likely have it. Please test it in prod environment."}, {"owner": {"reputation": 2022, "user_id": 2752896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6HtSo.jpg?s=128&g=1", "display_name": "Nikhil Maheshwari", "link": "https://stackoverflow.com/users/2752896/nikhil-maheshwari"}, "edited": false, "score": 0, "creation_date": 1456246583, "post_id": 35581816, "comment_id": 58853701, "body": "I can only change the redirect URL in my app in ASANA but ASANA is sending the access token by appending #access_token=.... to it."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2022, "user_id": 2752896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6HtSo.jpg?s=128&g=1", "display_name": "Nikhil Maheshwari", "link": "https://stackoverflow.com/users/2752896/nikhil-maheshwari"}, "edited": false, "score": 0, "creation_date": 1456249715, "post_id": 35581816, "comment_id": 58855811, "body": "@NikhilMaheshwari I reworked the answer. I included my original parsing code, also included code that you can use to test it (since you can&#39;t test it from browsers)."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1456250000, "last_edit_date": 1456250000, "creation_date": 1456242042, "answer_id": 35581816, "question_id": 35581468, "link": "https://stackoverflow.com/questions/35581468/fetching-asna-redirect-url-parameter-on-google-app-engine-in-golang/35581816#35581816", "title": "Fetching asna redirect url parameter on google app engine in golang", "body": "<p>The reason why <a href=\"https://golang.org/pkg/net/http/#Request.FormValue\" rel=\"nofollow\"><code>r.FormValue()</code></a> does not get it is because URL parameters are separated by <code>?</code> but in your URL it is not.</p>\n\n<p>The <code>#</code> is used to separate a fragment for references, so your <code>access_token</code> should be in <code>r.URL.Fragment</code>... but it won't.</p>\n\n<h2>You can't test it from the browser</h2>\n\n<p>Fragments are not sent over to the server, fragments are for the browsers. There was an issue covering this: </p>\n\n<p><a href=\"https://github.com/golang/go/issues/3805\" rel=\"nofollow\">net/http: document fields set in Request.URL in handler #3805</a></p>\n\n<p>It is also included in the doc of <a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow\"><code>http.Request</code></a>:</p>\n\n<blockquote>\n  <p>For server requests the URL is parsed from the URI supplied on the Request-Line as stored in RequestURI. <strong>For most requests, fields other than Path and RawQuery will be empty. (See RFC 2616, Section 5.1.2)</strong></p>\n</blockquote>\n\n<h2>Code to get it from the request</h2>\n\n<p>If a non-browser client does send it as part of the request path, you can use simple <code>string</code> operations to get the token value: it is the part after the <code>=</code> character. You can use <a href=\"https://golang.org/pkg/strings/#Split\" rel=\"nofollow\"><code>strings.Index()</code></a> to find the <code>\"=\"</code>:</p>\n\n<pre><code>raw := r.URL.Path\nif idx := strings.Index(raw, \"=\"); idx &gt;= 0 &amp;&amp; idx &lt; len(raw)-1 {\n    token := raw[idx+1:]\n    fmt.Fprintln(w, \"Token:\", token)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Token: 123456789\n</code></pre>\n\n<p>As an alternative solution you can also use <a href=\"https://golang.org/pkg/strings/#Index\" rel=\"nofollow\"><code>strings.Split()</code></a> to split it by <code>\"=\"</code>, 2nd element will be the value of the token:</p>\n\n<pre><code>parts := strings.Split(r.URL.Path, \"=\")\nfmt.Fprintln(w, \"Parts:\", parts)\nif len(parts) == 2 {\n    fmt.Fprintln(w, \"Token:\", parts[1])\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[/api/redirect.asana#access_token 123456789]\nToken: 123456789\n</code></pre>\n\n<h2>Code to test it</h2>\n\n<p>Here is a code using <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow\"><code>net/http</code></a> to call your server that will send a path being <code>\"/api/redirect.asana#access_token=123456789\"</code>, and it will print the response body to the standard output (console):</p>\n\n<pre><code>c := &amp;http.Client{}\nreq, err := http.NewRequest(\"GET\", \"http://localhost:8080/\", nil)\nif err != nil {\n    panic(err)\n}\nreq.URL.Path = \"/api/redirect.asana#access_token=123456789\"\nresp, err := c.Do(req)\nif err != nil {\n    panic(err)\n}\ndefer resp.Body.Close()\nio.Copy(os.Stdout, resp.Body)\n</code></pre>\n"}], "owner": {"reputation": 2022, "user_id": 2752896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6HtSo.jpg?s=128&g=1", "display_name": "Nikhil Maheshwari", "link": "https://stackoverflow.com/users/2752896/nikhil-maheshwari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456250000, "creation_date": 1456241164, "question_id": 35581468, "link": "https://stackoverflow.com/questions/35581468/fetching-asna-redirect-url-parameter-on-google-app-engine-in-golang", "title": "Fetching asna redirect url parameter on google app engine in golang", "body": "<p>My asana oauth redirect URL is something like</p>\n\n<p><strong><a href=\"https://testapp.appspot.com/api/redirect.asana#access_token=123456789\" rel=\"nofollow\">https://testapp.appspot.com/api/redirect.asana#access_token=123456789</a></strong></p>\n\n<p>I am not sure how to fetch access_token now.</p>\n\n<p><strong>Note :</strong> <em>if I am changing ? to # then its working fine by using r.FormValue(\"access_token\").</em></p>\n"}, {"tags": ["go", "casting"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1456233381, "post_id": 35578509, "comment_id": 58843540, "body": "&quot;I&#39;m getting an error.&quot; What error?"}, {"owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "edited": false, "score": 2, "creation_date": 1456236312, "post_id": 35578509, "comment_id": 58845774, "body": "Just to be clear on the terminology, the only <i>aliases</i> in Go are <code>byte</code> for <code>uint8</code> and <code>rune</code> for <code>int32</code>. When you define a new type, it&#39;s a <i>new type</i>."}], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 5, "last_activity_date": 1456239490, "last_edit_date": 1456239490, "creation_date": 1456233548, "answer_id": 35578673, "question_id": 35578509, "link": "https://stackoverflow.com/questions/35578509/alias-conversions/35578673#35578673", "title": "Alias conversions", "body": "<p><s>I don't know what error you are getting, but</s> this expression is wrong:</p>\n\n<pre><code>func Auth(key string, secret string) *AccessToken {\n...\n    var token oauth.AccessToken = AuthorizeToken(...)\n    return AccessToken(*token)\n}\n</code></pre>\n\n<p>it's saying \"take the pointer-value of <code>token</code> (which is not a pointer at all, meaning it's a syntax error), cast that as <code>AccessToken</code> and return it\". But the function returns a <strong>pointer to</strong> AccessToken, not a value, so this is invalid.</p>\n\n<p>If you are returning a pointer to your <code>AccessToken</code> type, the code should be more along the lines of:</p>\n\n<pre><code>func Auth(key string, secret string) *AccessToken {\n...\n    token := AccessToken(AuthorizeToken(...))\n    return &amp;token\n}\n</code></pre>\n"}], "owner": {"reputation": 630, "user_id": 225329, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/mTyGz.jpg?s=128&g=1", "display_name": "Alexander Stavonin", "link": "https://stackoverflow.com/users/225329/alexander-stavonin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 35578673, "answer_count": 1, "score": 0, "last_activity_date": 1456239490, "creation_date": 1456233066, "last_edit_date": 1456233548, "question_id": 35578509, "link": "https://stackoverflow.com/questions/35578509/alias-conversions", "title": "Alias conversions", "body": "<p>I have <code>struct AccessToken</code> as a part of external library and I use that library in my own. I'd like to return a value of this type but I do not see any reasons why my internal implementation should be visible from outside. Type alias looks great for this.</p>\n\n<pre><code>type AccessToken oauth.AccessToken\n</code></pre>\n\n<p>But I'm getting an error when trying to do next:</p>\n\n<pre><code>func Auth(key string, secret string) *AccessToken {\n...\n    var token oauth.AccessToken = AuthorizeToken(...)\n    return AccessToken(*token)\n}\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>cannot use AccessToken(*accessToken) (type AccessToken) as type *AccessToken in return argument\n</code></pre>\n\n<p>It's clear that I can just copy structures field by fiend. But is there any way to use aliases?</p>\n"}, {"tags": ["go", "structure", "packages"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1456228899, "post_id": 35576337, "comment_id": 58840482, "body": "There is no need to separate stuff into it&#39;s own package. Ask yourself: What actual benefit results from this split? And now compare to the costs."}, {"owner": {"reputation": 339, "user_id": 5968101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dd1b28f0ce7ee473795e152f367b25c?s=128&d=identicon&r=PG", "display_name": "ElieLie", "link": "https://stackoverflow.com/users/5968101/elielie"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1456230728, "post_id": 35576337, "comment_id": 58841711, "body": "The objective is to re-use some of these packages in others programs than <code>main</code>."}], "answers": [{"comments": [{"owner": {"reputation": 339, "user_id": 5968101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dd1b28f0ce7ee473795e152f367b25c?s=128&d=identicon&r=PG", "display_name": "ElieLie", "link": "https://stackoverflow.com/users/5968101/elielie"}, "edited": false, "score": 1, "creation_date": 1456229723, "post_id": 35576591, "comment_id": 58841053, "body": "Ok, so you recommend me to create a package of structures ,e.g <code>model</code>.  Thank you for this answer, I hope it&#39;s a good practice in Go."}, {"owner": {"reputation": 5730, "user_id": 2704500, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/100556a196f1f860a0b08e8c3519152f?s=128&d=identicon&r=PG&f=1", "display_name": "pandaadb", "link": "https://stackoverflow.com/users/2704500/pandaadb"}, "edited": false, "score": 3, "creation_date": 1576081021, "post_id": 35576591, "comment_id": 104784850, "body": "As far as I know (and been told on IRC), go discourages from creating model packages. See: <a href=\"https://medium.com/@benbjohnson/standard-package-layout-7cdbc8391fc1\" rel=\"nofollow noreferrer\">medium.com/@benbjohnson/standard-package-layout-7cdbc8391fc1</a> and <a href=\"https://rakyll.org/style-packages/\" rel=\"nofollow noreferrer\">rakyll.org/style-packages</a> for just two examples"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 21, "last_activity_date": 1456229625, "last_edit_date": 1456229625, "creation_date": 1456227620, "answer_id": 35576591, "question_id": 35576337, "link": "https://stackoverflow.com/questions/35576337/is-there-an-efficient-way-to-share-structure-between-golang-packages/35576591#35576591", "title": "Is there an efficient way to share structure between golang packages?", "body": "<p>Don't link files across packages, that's bad practice. For one, the code will be duplicated. For another, identifiers will be duplicated meaning to denote the same entities (e.g. type or function), but they will be distinct. E.g. if linked and <code>structs.go</code> would contain a <code>type Response</code> definition, you would have 2 distinct types <code>server.Response</code> and <code>routines.Response</code> giving just more confusion.</p>\n\n<p>One solution would be to put <code>structs.go</code> into its own package, e.g. <code>model</code>, and all other packages relying on it can import it (e.g. your <code>main</code>, <code>server</code> and <code>routines</code>).</p>\n\n<p>In a theoretical example: if package <code>A</code> imports package <code>B</code> and <code>structs.go</code> would be needed in both, then it could also be added to package <code>B</code>. If there would be a package <code>C</code> needing only <code>structs.go</code>, then again it would be wiser to create its own package <code>model</code> (so package <code>C</code> doesn't need to import / know about package <code>B</code>, only the new <code>model</code> package).</p>\n\n<p>Also if noone else will use your package and it is not too complex, it might not worth the hassle to organize it into multiple packages.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6346338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e58edfa222f8c3645e664e0be1d6c45c?s=128&d=identicon&r=PG", "display_name": "Thomas H&#246;henleitner", "link": "https://stackoverflow.com/users/6346338/thomas-h%c3%b6henleitner"}, "is_accepted": false, "score": 0, "last_activity_date": 1598627278, "creation_date": 1598627278, "answer_id": 63636447, "question_id": 35576337, "link": "https://stackoverflow.com/questions/35576337/is-there-an-efficient-way-to-share-structure-between-golang-packages/63636447#63636447", "title": "Is there an efficient way to share structure between golang packages?", "body": "<p>It is possible to define a type in one package only and to use it in other packages this way:</p>\n<pre><code>package one\ntype A struct{ B int }\n</code></pre>\n<p>Variant 1:</p>\n<pre><code>package two\n. import &quot;one&quot;\nvar name A\n</code></pre>\n<p>Variant 2:</p>\n<pre><code>package two\nimport &quot;one&quot;\ntype A = one.A\nvar name A\n</code></pre>\n<p>I would prefer variant 2.</p>\n"}], "owner": {"reputation": 339, "user_id": 5968101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dd1b28f0ce7ee473795e152f367b25c?s=128&d=identicon&r=PG", "display_name": "ElieLie", "link": "https://stackoverflow.com/users/5968101/elielie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7348, "favorite_count": 3, "accepted_answer_id": 35576591, "answer_count": 2, "score": 22, "last_activity_date": 1598627278, "creation_date": 1456226893, "question_id": 35576337, "link": "https://stackoverflow.com/questions/35576337/is-there-an-efficient-way-to-share-structure-between-golang-packages", "title": "Is there an efficient way to share structure between golang packages?", "body": "<p>I have a short program in Go with the following files part of it.\nProgram directory structure:</p>\n\n<pre><code>myprogram/\n    main.go\n    server.go\n    routines.go\n    structs.go\n</code></pre>\n\n<p>These different files contain different function. The <code>structs.go</code> file contains a list of structure type defined, and used in several files of my program. What I want to do, now is to split my program into package like in this example :</p>\n\n<pre><code>main/\n    main.go // the main program\nserver/\n    server.go // a package imported in main\nroutines/\n    routines.go // a package imported in main\n</code></pre>\n\n<p>My problem, is that I do not know where to put <code>structs.go</code> because it contains structures used in several package, as in the 'main.go' code.</p>\n\n<p>How to share efficiently this <code>structs.go</code> file ? Should I include it (via a symlink to the file) in each of the package I defined, i.e <code>server</code>and <code>routines</code> and also in main ?</p>\n\n<p>My method may be awkward because I'm a beginner in Go, and in programming generally. </p>\n"}, {"tags": ["go", "installation", "packages"], "comments": [{"owner": {"reputation": 623, "user_id": 5615224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7bea88308ec27975167f216eb8f998e?s=128&d=identicon&r=PG&f=1", "display_name": "sfault", "link": "https://stackoverflow.com/users/5615224/sfault"}, "edited": false, "score": 0, "creation_date": 1456227085, "post_id": 35575699, "comment_id": 58839225, "body": "do you mean as library?"}, {"owner": {"reputation": 623, "user_id": 5615224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7bea88308ec27975167f216eb8f998e?s=128&d=identicon&r=PG&f=1", "display_name": "sfault", "link": "https://stackoverflow.com/users/5615224/sfault"}, "edited": false, "score": 1, "creation_date": 1456234366, "post_id": 35575699, "comment_id": 58844290, "body": "this stack question might help <a href=\"http://stackoverflow.com/questions/19431296/building-and-linking-dynamically-from-a-go-binary\">building-and-linking-dynamically-from-a-go-binary</a>"}, {"owner": {"reputation": 623, "user_id": 5615224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7bea88308ec27975167f216eb8f998e?s=128&d=identicon&r=PG&f=1", "display_name": "sfault", "link": "https://stackoverflow.com/users/5615224/sfault"}, "edited": false, "score": 0, "creation_date": 1456234580, "post_id": 35575699, "comment_id": 58844436, "body": "it seems support is limited, on mac it gives following error <code>-buildmode=shared not supported on darwin&#47;amd64</code>"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1456236178, "post_id": 35575699, "comment_id": 58845673, "body": "tldr: no, and it is a good thing. Best thing is to create a service that does the generic things and call that."}], "owner": {"reputation": 439, "user_id": 2424276, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/14b57849c70f78693780d986c9d98d2c?s=128&d=identicon&r=PG", "display_name": "user2424276", "link": "https://stackoverflow.com/users/2424276/user2424276"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 657, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1456240680, "creation_date": 1456225220, "last_edit_date": 1456240680, "question_id": 35575699, "link": "https://stackoverflow.com/questions/35575699/golang-package-systemwide-installation", "title": "Golang Package Systemwide Installation", "body": "<p>Is it possible to install a Golang package system-wide and not need the source code afterwards in order to compile programs that use it? </p>\n\n<p>More particularly, having just the pkg/linux_amd64_dynlink/ directory with, for example, libstringutil.so stringutil.a and stringutil.shlibname files, how can I compile a simple hello.go that imports stringutil?</p>\n"}, {"tags": ["arrays", "json", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1456220323, "post_id": 35573744, "comment_id": 58834436, "body": "Has been asked a million times. You have to export the fields of the struct you&#39;re marshalling into."}, {"owner": {"reputation": 3, "user_id": 5157950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb41a7b002b0d1eac707e54bd641b76f?s=128&d=identicon&r=PG&f=1", "display_name": "Cihan Alp", "link": "https://stackoverflow.com/users/5157950/cihan-alp"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1456220620, "post_id": 35573744, "comment_id": 58834661, "body": "omg! ty sir that mistake take my time horribly. I examined other questions about this but i thougth i was doing everything right sorry for my inattention"}], "owner": {"reputation": 3, "user_id": 5157950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb41a7b002b0d1eac707e54bd641b76f?s=128&d=identicon&r=PG&f=1", "display_name": "Cihan Alp", "link": "https://stackoverflow.com/users/5157950/cihan-alp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "closed_date": 1456220282, "answer_count": 0, "score": 0, "last_activity_date": 1456220234, "creation_date": 1456220138, "question_id": 35573744, "link": "https://stackoverflow.com/questions/35573744/golang-json-array-empty-result", "closed_reason": "Duplicate", "title": "golang json array empty result", "body": "<p>What im doing wrong? I tried tons of way but i get always empty array. Here is my code:</p>\n\n<pre><code>type Switches struct {\n    switches []SwitchInfo\n}\n\ntype SwitchInfo struct {\n    IP        string\n    Community string\n}\n\nfunc main() {\n    file, e := ioutil.ReadFile(\"./config.json\")\n\n    if e != nil {\n        fmt.Printf(\"File error: %v\\n\", e)\n        os.Exit(1)\n    }\n\n    fmt.Printf(\"%s\\n\", file)\n\n    var jsonObject Switches\n\n    err := json.Unmarshal(file, &amp;jsonObject)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"Results: %v\\n\", jsonObject)\n\n}\n</code></pre>\n\n<p>And this is my json file</p>\n\n<pre><code>{\"switches\":\n[\n    {\n    \"IP\" : \"1.1.1.1\",\n    \"Community\" : \"asdfg\"\n    },\n    {\n    \"IP\" :\"1.1.1.1\",\n    \"Community\" : \"asdf\"\n    }\n]\n}\n</code></pre>\n\n<p>I checked my json file it is valid. I think i have problem with my structs. Ty for your help.</p>\n"}, {"tags": ["github", "go", "package"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1456212149, "post_id": 35571079, "comment_id": 58829742, "body": "Why don&#39;t you want to use &#39;go get&#39;?"}], "answers": [{"tags": [], "owner": {"reputation": 82, "user_id": 2133846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f126eb59387d563ffcf3d686b8e11f3?s=128&d=identicon&r=PG&f=1", "display_name": "Jaehoon", "link": "https://stackoverflow.com/users/2133846/jaehoon"}, "is_accepted": false, "score": 0, "last_activity_date": 1456212226, "creation_date": 1456212226, "answer_id": 35571220, "question_id": 35571079, "link": "https://stackoverflow.com/questions/35571079/go-how-to-import-package-from-github-and-build-without-go-get/35571220#35571220", "title": "Go, how to import package from github and build without go get", "body": "<p>If your project is up to the repository, such as github,\nWhen the initial \"go install\" will be \"go get\" even as packageX.</p>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 3, "last_activity_date": 1456212380, "creation_date": 1456212380, "answer_id": 35571261, "question_id": 35571079, "link": "https://stackoverflow.com/questions/35571079/go-how-to-import-package-from-github-and-build-without-go-get/35571261#35571261", "title": "Go, how to import package from github and build without go get", "body": "<p>If you don't want to add your go project  dependency to the global GOPATH, you can vendor it. (go 1.6+ recommended: see \"<a href=\"https://tip.golang.org/cmd/go/#hdr-Vendor_Directories\" rel=\"nofollow\">Vendor Directories</a>\")</p>\n\n<p>Go to the package which uses that import, and add it as a submodule in a vendor sub-folder.</p>\n\n<pre><code>cd GOPATH/src/myproject/mypackage\ngit submodule add -- https://github.com/&lt;user&gt;/&lt;repo&gt; vendor/github.com/&lt;user&gt;/&lt;repo&gt;\ncd vendor/github.com/&lt;user&gt;/&lt;repo&gt;\ngo install\ncd ../../../..\ngo install\n</code></pre>\n\n<p>Note: that repo might have itself other dependencies, that you would need to add in a similar fashion (in the same vendor folder)</p>\n"}], "owner": {"reputation": 29, "user_id": 5950054, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bMpLm_Wn3kE/AAAAAAAAAAI/AAAAAAAAACU/5veM0WiXyAc/photo.jpg?sz=128", "display_name": "Slavomir Polak", "link": "https://stackoverflow.com/users/5950054/slavomir-polak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2039, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1456214909, "creation_date": 1456211757, "last_edit_date": 1456214909, "question_id": 35571079, "link": "https://stackoverflow.com/questions/35571079/go-how-to-import-package-from-github-and-build-without-go-get", "title": "Go, how to import package from github and build without go get", "body": "<p>I need to import external package from github \u201c<code>github.com/xy/packageX</code>\u201d to <code>MyProject/src/myProjcet.go</code>. So I added import \u201c<code>github.com/xy/packageX</code>\u201d to <code>myProject.go</code>. If I run go build, I get:</p>\n\n<pre><code>myProject.go:9:2: import \u201cgithub.com/xy/packageX\u201d: cannot find package\n</code></pre>\n\n<p>So I have to run <code>go get</code>, and then <code>go build</code>.<br>\nIs there a way, how it can be built without using of <code>go get</code>? Or should I download it to <code>MyProject/pkg</code> and added this link to <code>myProject.go</code>? I am on Xubuntu 14.04.</p>\n"}, {"tags": ["go", "visual-studio-code"], "answers": [{"comments": [{"owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "edited": false, "score": 1, "creation_date": 1456213352, "post_id": 35571145, "comment_id": 58830307, "body": "Thank you very much. Actually I was using this plugin, but I didn&#39;t find the options to set before asking this question. ` &quot;go.formatOnSave&quot;: true` did the trick. I think the default setting should be <code>true</code> instead of <code>false</code>."}, {"owner": {"reputation": 136, "user_id": 2736641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5316d692cc603c3ad2df0f03869bb96b?s=128&d=identicon&r=PG", "display_name": "UziMonkey", "link": "https://stackoverflow.com/users/2736641/uzimonkey"}, "edited": false, "score": 0, "creation_date": 1456214009, "post_id": 35571145, "comment_id": 58830655, "body": "Another thing you should look at is changing &quot;go.formatTool&quot; from &quot;go fmt&quot; to &quot;goimports&quot; (and installing goimports).  Having it manage your imports is very handy (though use with caution, double-check it&#39;s importing the right thing)."}], "tags": [], "owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "is_accepted": true, "score": 20, "last_activity_date": 1616432419, "last_edit_date": 1616432419, "creation_date": 1456211981, "answer_id": 35571145, "question_id": 35571033, "link": "https://stackoverflow.com/questions/35571033/how-to-set-vscode-format-golang-code-on-save/35571145#35571145", "title": "How to set vscode format golang code on save?", "body": "<p>You should install this plugin: <a href=\"https://github.com/golang/vscode-go\" rel=\"nofollow noreferrer\">https://github.com/golang/vscode-go</a>. One of the options is to set &quot;auto format&quot; on save: <code>go.formatOnSave&quot;: false</code>. It uses the Golang tooling for formatting.</p>\n"}, {"tags": [], "owner": {"reputation": 849, "user_id": 1061409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UFj16.jpg?s=128&g=1", "display_name": "Vu Truong", "link": "https://stackoverflow.com/users/1061409/vu-truong"}, "is_accepted": false, "score": 12, "last_activity_date": 1557889333, "creation_date": 1557889333, "answer_id": 56141204, "question_id": 35571033, "link": "https://stackoverflow.com/questions/35571033/how-to-set-vscode-format-golang-code-on-save/56141204#56141204", "title": "How to set vscode format golang code on save?", "body": "<p>From my visual code version, i cannot use config go.formatOnSave\": false.</p>\n\n<p>Then I can turn them off in settings as below:</p>\n\n<ul>\n<li>Build (Turn off using go.buildOnSave setting)</li>\n<li>Lint (Turn off using    go.lintOnSave setting)</li>\n<li>Vet (Turn off using go.vetOnSave setting)</li>\n<li>Format (Turn off by adding the below in your settings):\n\n<blockquote>\n<pre><code>\"[go]\": {\n    \"editor.formatOnSave\": false \n}\n</code></pre>\n</blockquote></li>\n</ul>\n"}], "owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26721, "favorite_count": 4, "accepted_answer_id": 35571145, "answer_count": 2, "score": 19, "last_activity_date": 1616432419, "creation_date": 1456211551, "question_id": 35571033, "link": "https://stackoverflow.com/questions/35571033/how-to-set-vscode-format-golang-code-on-save", "title": "How to set vscode format golang code on save?", "body": "<p>I'm using <code>vscode</code> with <code>Go</code> extensions to edit <code>golang</code> source code. Each time I want to format code, I have to press <code>Ctrl-Shift-i</code> on <code>linux</code>, <code>Shift-Alt-F</code> on <code>Windows</code>, or <code>Ctrl-Shift-p</code> and type <code>format</code>. Is it possible to set format on save, that is, when I press <code>ctrl-s</code>, it format the code automatically using <code>go.fmt</code> (or something alike)?</p>\n"}, {"tags": ["go", "signals", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 4756148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a081ce92e08708f85c3aa6a322583d?s=128&d=identicon&r=PG&f=1", "display_name": "Yong Feng", "link": "https://stackoverflow.com/users/4756148/yong-feng"}, "is_accepted": false, "score": 0, "last_activity_date": 1456288986, "creation_date": 1456288986, "answer_id": 35593428, "question_id": 35570265, "link": "https://stackoverflow.com/questions/35570265/sigsuspend-does-not-return-when-being-called-by-a-golang-program-via-cgo/35593428#35593428", "title": "sigsuspend does not return when being called by a golang program via cgo", "body": "<p>The root cause is that in a multiple-thread program, to allow sigsuspend return, we have to block all the other threads with specified signal. However in golang, we cannot configure the sigmask of management threads of golang.</p>\n\n<p>Please refer to following link for detail info</p>\n\n<p><a href=\"https://groups.google.com/forum/#!topic/golang-nuts/sYo0iGfkVRg\" rel=\"nofollow\">https://groups.google.com/forum/#!topic/golang-nuts/sYo0iGfkVRg</a></p>\n"}], "owner": {"reputation": 81, "user_id": 4756148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79a081ce92e08708f85c3aa6a322583d?s=128&d=identicon&r=PG&f=1", "display_name": "Yong Feng", "link": "https://stackoverflow.com/users/4756148/yong-feng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456288986, "creation_date": 1456208442, "last_edit_date": 1495540232, "question_id": 35570265, "link": "https://stackoverflow.com/questions/35570265/sigsuspend-does-not-return-when-being-called-by-a-golang-program-via-cgo", "title": "sigsuspend does not return when being called by a golang program via cgo", "body": "<p>I am working on a project with golang. The project calls C API of LSF (A job scheduler <a href=\"https://en.wikipedia.org/wiki/Platform_LSF\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Platform_LSF</a>). Some of the APIs call sigsuspend() when communicating with LSF system. </p>\n\n<p>During test, I found those APIs never return. But they work fine when being called by a C program. Therefore I write a simple test program as follows (based on <a href=\"https://stackoverflow.com/questions/30219751/golang-get-signal-origin\">Go: Get signal origin</a> :-))</p>\n\n<p>The test program confirmed my finding. It prints \"before sigsuspend\" and \"Sent by xxxx\", but never prints \"after sigsuspend\".</p>\n\n<p>Can anyone throw light on it? How to make those APIs work in a golang program just like being called by a C program?</p>\n\n<pre><code>package main\n\n/*\n#include &lt;stdio.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;string.h&gt;\n\nstruct sigaction old_action;\nvoid handler(int signum, siginfo_t *info, void *context) {\n    printf(\"Sent by %d\\n\", info-&gt;si_pid);\n}\n\nvoid test() {\n    sigset_t pauseMask;\n    struct sigaction action;\n\n    sigaction(SIGUSR1, NULL, &amp;action);\n    memset(&amp;action, 0, sizeof action);\n    sigfillset(&amp;action.sa_mask);\n    action.sa_sigaction = handler;\n    action.sa_flags = SA_SIGINFO | SA_ONSTACK;\n    sigaction(SIGUSR1, &amp;action, &amp;old_action);\n    sigemptyset(&amp;pauseMask);\n    printf(\"before sigsuspend \\n\");\n    sigsuspend(&amp;pauseMask);\n    printf(\"after sigsuspend \\n\");\n}\n*/\nimport \"C\"\n\nimport (\n    \"os\"\n    \"syscall\"\n    \"time\"\n)\n\n/* https://stackoverflow.com/questions/30219751/golang-get-signal-origin */\nfunc main() {\n    go C.test()\n    pid := os.Getpid()\n    for {\n        syscall.Kill(pid, syscall.SIGUSR1)\n        time.Sleep(time.Second * 5)\n    }\n}\n</code></pre>\n\n<p>Thanks</p>\n\n<p>Yong</p>\n"}, {"tags": ["go", "command-line"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1456206849, "post_id": 35568993, "comment_id": 58827384, "body": "From the outside only, e.g. via <code>head</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456236404, "post_id": 35568993, "comment_id": 58845857, "body": "see: <a href=\"https://groups.google.com/d/topic/golang-nuts/KubsC2vYcXg/discussion\" rel=\"nofollow noreferrer\">groups.google.com/d/topic/golang-nuts/KubsC2vYcXg/discussion</a>"}, {"owner": {"reputation": 967, "user_id": 5105392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1019878568022717/picture?type=large", "display_name": "Harry", "link": "https://stackoverflow.com/users/5105392/harry"}, "edited": false, "score": 0, "creation_date": 1456308491, "post_id": 35568993, "comment_id": 58882796, "body": "Yes, I posted that message on google group. And I got good solution. Thanks,"}], "answers": [{"comments": [{"owner": {"reputation": 967, "user_id": 5105392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1019878568022717/picture?type=large", "display_name": "Harry", "link": "https://stackoverflow.com/users/5105392/harry"}, "edited": false, "score": 0, "creation_date": 1456308592, "post_id": 35570031, "comment_id": 58882878, "body": "I got it, it&#39;d be helpful for me!! I try it! Thanks a lot!"}], "tags": [], "owner": {"reputation": 906, "user_id": 1342660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87b4c045277546c0023b18aae7915ac3?s=128&d=identicon&r=PG", "display_name": "Denzel", "link": "https://stackoverflow.com/users/1342660/denzel"}, "is_accepted": true, "score": 3, "last_activity_date": 1456207435, "creation_date": 1456207435, "answer_id": 35570031, "question_id": 35568993, "link": "https://stackoverflow.com/questions/35568993/golang-how-to-restrict-ammount-of-command-line-output/35570031#35570031", "title": "(Golang) How to restrict ammount of command line output", "body": "<p>Two solutions come to mind. You can pick what works for you.</p>\n\n<ol>\n<li>Panicparse</li>\n</ol>\n\n<p>Marc-Antoine Ruel -- fantastic developer -- created <a href=\"https://github.com/maruel/panicparse\" rel=\"nofollow\">panicparse</a>. Run your program, assign <em>stderr</em> to <em>stdout</em>, pipe that into panicparse, and you're good to go.</p>\n\n<pre><code>go run example.go 2&gt;&amp;1 | pp\n</code></pre>\n\n<p>Panicparse will deduplicate and dedensify the output >50% while also making it far more readable.</p>\n\n<p>Check out the screenshots in the README.</p>\n\n<ol start=\"2\">\n<li><em>Head</em></li>\n</ol>\n\n<p>If the information you're looking for is always at the top of the stacktrace, then maybe it's just a simple case of piping the output to <em>head</em>.</p>\n\n<p>We want to run our program; allowing it to output to <em>stdout</em>/terminal like normal, but we want to limit the amount of information the panic displays with <em>head</em>. Remember, panics are written to <em>stderr</em>. So piping <em>stderr</em> to a process substitution should work on most systems:</p>\n\n<pre><code>go run example.go 2&gt; &gt;(head)\n</code></pre>\n"}], "owner": {"reputation": 967, "user_id": 5105392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1019878568022717/picture?type=large", "display_name": "Harry", "link": "https://stackoverflow.com/users/5105392/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 35570031, "answer_count": 1, "score": 0, "last_activity_date": 1456207435, "creation_date": 1456202585, "question_id": 35568993, "link": "https://stackoverflow.com/questions/35568993/golang-how-to-restrict-ammount-of-command-line-output", "title": "(Golang) How to restrict ammount of command line output", "body": "<p>During executing something golang application, display of command line is overflowed by error messages \nwhen something panic occured.\nProvided there were lots of goroutine running, it could'be appeared.</p>\n\n<p>However, information I want to know is just a few lines from top of output.\nHow can I restrict that feature I desire?</p>\n\n<p>Thank you.</p>\n\n<p>Harry</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3383, "user_id": 21435, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/vl2cz.jpg?s=128&g=1", "display_name": "Bruno Rijsman", "link": "https://stackoverflow.com/users/21435/bruno-rijsman"}, "edited": false, "score": 0, "creation_date": 1456198544, "post_id": 35568334, "comment_id": 58824399, "body": "Ignore the function name &quot;primesLessThan&quot;"}, {"owner": {"reputation": 934, "user_id": 3239666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638873245dd9cdc579bf551818c11fb3?s=128&d=identicon&r=PG&f=1", "display_name": "GarMan", "link": "https://stackoverflow.com/users/3239666/garman"}, "edited": false, "score": 1, "creation_date": 1456243902, "post_id": 35568334, "comment_id": 58851715, "body": "replace one = two to one.Set(*two)"}], "answers": [{"comments": [{"owner": {"reputation": 3383, "user_id": 21435, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/vl2cz.jpg?s=128&g=1", "display_name": "Bruno Rijsman", "link": "https://stackoverflow.com/users/21435/bruno-rijsman"}, "edited": false, "score": 0, "creation_date": 1456203970, "post_id": 35568524, "comment_id": 58826212, "body": "Apologies for my newbie Go questions.  Why is &quot;[]big.Int&quot; a slice of pointers?  I would have expected it to be a slice of big.Int values.  If I wanted a slice of pointers I would have said &quot;[]*big.Int&quot;.  I know I have it wrong, just trying to understand to logic of Go."}, {"owner": {"reputation": 225, "user_id": 1507342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5165ad3df4cd59728ea24317698f15bc?s=128&d=identicon&r=PG&f=1", "display_name": "d1str0", "link": "https://stackoverflow.com/users/1507342/d1str0"}, "reply_to_user": {"reputation": 3383, "user_id": 21435, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/vl2cz.jpg?s=128&g=1", "display_name": "Bruno Rijsman", "link": "https://stackoverflow.com/users/21435/bruno-rijsman"}, "edited": false, "score": 0, "creation_date": 1456204245, "post_id": 35568524, "comment_id": 58826323, "body": "A big.Int is an object, not a standard value. Thus it&#39;s a pointer. The go docs are good at explaining pointers. Try effective go."}, {"owner": {"reputation": 934, "user_id": 3239666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638873245dd9cdc579bf551818c11fb3?s=128&d=identicon&r=PG&f=1", "display_name": "GarMan", "link": "https://stackoverflow.com/users/3239666/garman"}, "edited": false, "score": 3, "creation_date": 1456207166, "post_id": 35568524, "comment_id": 58827512, "body": "This is incorrect, []big.Int is not an array of pointers, it&#39;s an array of structs. The structs themselves happen to contain a pointer and when the structs are copied the data they point to is not copied. This is a side effect of the contents of big.Int and not a misunderstanding by Cayle."}, {"owner": {"reputation": 225, "user_id": 1507342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5165ad3df4cd59728ea24317698f15bc?s=128&d=identicon&r=PG&f=1", "display_name": "d1str0", "link": "https://stackoverflow.com/users/1507342/d1str0"}, "reply_to_user": {"reputation": 934, "user_id": 3239666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638873245dd9cdc579bf551818c11fb3?s=128&d=identicon&r=PG&f=1", "display_name": "GarMan", "link": "https://stackoverflow.com/users/3239666/garman"}, "edited": false, "score": 0, "creation_date": 1456208692, "post_id": 35568524, "comment_id": 58828140, "body": "@GarMan your answer is much more accurate than mine. I will edit mine so it is not wrong."}, {"owner": {"reputation": 3383, "user_id": 21435, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/vl2cz.jpg?s=128&g=1", "display_name": "Bruno Rijsman", "link": "https://stackoverflow.com/users/21435/bruno-rijsman"}, "reply_to_user": {"reputation": 934, "user_id": 3239666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638873245dd9cdc579bf551818c11fb3?s=128&d=identicon&r=PG&f=1", "display_name": "GarMan", "link": "https://stackoverflow.com/users/3239666/garman"}, "edited": false, "score": 0, "creation_date": 1456231138, "post_id": 35568524, "comment_id": 58842014, "body": "@GarMan Is it normal in Go to have shallow copy semantics when you copy an object?  Does Go not have something similar to a C++ copy constructor that would allow deep copy semantics to be implemented?  Being used to C++, doing shallow copies for objects seems dangerous to me and it seems to &quot;leak&quot; details about the internal implementation of the object."}], "tags": [], "owner": {"reputation": 225, "user_id": 1507342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5165ad3df4cd59728ea24317698f15bc?s=128&d=identicon&r=PG&f=1", "display_name": "d1str0", "link": "https://stackoverflow.com/users/1507342/d1str0"}, "is_accepted": false, "score": -2, "last_activity_date": 1456208938, "last_edit_date": 1456208938, "creation_date": 1456199701, "answer_id": 35568524, "question_id": 35568334, "link": "https://stackoverflow.com/questions/35568334/appending-big-int-in-loop-to-slice-unexpected-result/35568524#35568524", "title": "Appending big.Int in loop to slice unexpected result", "body": "<p><em>What we see...</em> Your primes []big.Int is acting like an array of pointers. By storing i in each slot of primes you are essentially storing the exact same pointer in each spot. That's why it's printing 5 four times.</p>\n\n<p><em>Why we see this...</em> Due to the internals of big.Int, each strict object of big.Int has an internal slice. Slices are implemented as pointers because they are really just fancy arrays. So, while you may have a big.Int object, the object has a pointer to a slice. </p>\n\n<p>When copying a big.Int object you are copying this internal slice pointer. </p>\n\n<p>@GarMan is right and I also agree it has to do with shallow vs. deep copies. </p>\n"}, {"comments": [{"owner": {"reputation": 3383, "user_id": 21435, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/vl2cz.jpg?s=128&g=1", "display_name": "Bruno Rijsman", "link": "https://stackoverflow.com/users/21435/bruno-rijsman"}, "edited": false, "score": 0, "creation_date": 1456234459, "post_id": 35569924, "comment_id": 58844343, "body": "What is the proper / recommended way to create a deep copy of a big.Int?  The only &quot;constructor&quot; I see in the documentation (<a href=\"https://golang.org/pkg/math/big/\" rel=\"nofollow noreferrer\">golang.org/pkg/math/big</a>) is NewInt which takes an int64 argument.  I don&#39;t see a &quot;copy constructor&quot; which takes a big.Int argument.  Maybe my thinking is too polluted by years of C++."}, {"owner": {"reputation": 934, "user_id": 3239666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638873245dd9cdc579bf551818c11fb3?s=128&d=identicon&r=PG&f=1", "display_name": "GarMan", "link": "https://stackoverflow.com/users/3239666/garman"}, "reply_to_user": {"reputation": 3383, "user_id": 21435, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/vl2cz.jpg?s=128&g=1", "display_name": "Bruno Rijsman", "link": "https://stackoverflow.com/users/21435/bruno-rijsman"}, "edited": false, "score": 0, "creation_date": 1456243792, "post_id": 35569924, "comment_id": 58851627, "body": "Unfortunately in golang there is no standard deepcopy solution, The correct way to solve this specific is to use the interface to big.Int and not try to treat it like a single value. Instead of <code>=</code> use <a href=\"https://golang.org/pkg/math/big/#Int.Set\" rel=\"nofollow noreferrer\">golang.org/pkg/math/big/#Int.Set</a> , In your original example you could have just created a new one inside the for loop scope, called <code>Set</code> on it and appended that. I added an example to that in my answer. Please accept the answer if it answers all your questions."}], "tags": [], "owner": {"reputation": 934, "user_id": 3239666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638873245dd9cdc579bf551818c11fb3?s=128&d=identicon&r=PG&f=1", "display_name": "GarMan", "link": "https://stackoverflow.com/users/3239666/garman"}, "is_accepted": true, "score": 3, "last_activity_date": 1456243845, "last_edit_date": 1456243845, "creation_date": 1456207004, "answer_id": 35569924, "question_id": 35568334, "link": "https://stackoverflow.com/questions/35568334/appending-big-int-in-loop-to-slice-unexpected-result/35569924#35569924", "title": "Appending big.Int in loop to slice unexpected result", "body": "<p>It's because of the way the object stores its internal data.</p>\n\n<p>Take this example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype foo struct {\n    value int\n}\n\nfunc bar() (r []foo) {\n    var f foo\n    for i := 0; i &lt; 5; i++ {\n        f.value = i\n        r = append(r, f)\n    }\n    return\n}\n\nfunc main() {\n    for _, v := range bar() {\n        fmt.Println(v)\n    }\n}\n</code></pre>\n\n<p>The output will be the expected</p>\n\n<pre><code>{0}\n{1}\n{2}\n{3}\n{4}\n</code></pre>\n\n<p>The issue in your example is that big.Int stores its value in a slice, and slices are pointers. So when a copy of a big.Int is created, the new copy contains a new pointer to the same slice in memory. A shallow copies is created rather than a deep copy.</p>\n\n<p>See <a href=\"https://golang.org/src/math/big/int.go?s=388:468#L8\" rel=\"nofollow\">https://golang.org/src/math/big/int.go?s=388:468#L8</a> for how <code>bit.Int</code> is declared, then see <a href=\"https://golang.org/src/math/big/nat.go#L25\" rel=\"nofollow\">https://golang.org/src/math/big/nat.go#L25</a> for how <code>nat</code> is declared.</p>\n\n<p>Here is a solution that uses big.Int</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc primesLessThan(n *big.Int) (primes []big.Int) {\n    var one big.Int\n    one.SetInt64(1)\n    var i big.Int\n    i.SetInt64(1)\n    for i.Cmp(n) &lt; 0 {\n        var result big.Int\n        result.Set(&amp;i)\n        fmt.Println(result.String())\n        primes = append(primes, result)\n        i.Add(&amp;i, &amp;one)\n    }\n    return\n}\n\nfunc main() {\n    primes := primesLessThan(big.NewInt(5))\n    for _, p := range primes {\n        fmt.Println(p.String())\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8663175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fc5cf58fae9981c528af0ed4372f187?s=128&d=identicon&r=PG", "display_name": "Florent Gallaire", "link": "https://stackoverflow.com/users/8663175/florent-gallaire"}, "is_accepted": false, "score": 0, "last_activity_date": 1506665139, "last_edit_date": 1506665139, "creation_date": 1506222523, "answer_id": 46386203, "question_id": 35568334, "link": "https://stackoverflow.com/questions/35568334/appending-big-int-in-loop-to-slice-unexpected-result/46386203#46386203", "title": "Appending big.Int in loop to slice unexpected result", "body": "<p>The @GarMan solution is fine but you can do simpler doing the string conversion at the <code>append()</code> level for <code>primes []string</code>:</p>\n\n<pre><code>primes = append(primes, i.String())\n</code></pre>\n"}], "owner": {"reputation": 3383, "user_id": 21435, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/vl2cz.jpg?s=128&g=1", "display_name": "Bruno Rijsman", "link": "https://stackoverflow.com/users/21435/bruno-rijsman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 0, "accepted_answer_id": 35569924, "answer_count": 3, "score": 1, "last_activity_date": 1576232950, "creation_date": 1456198498, "last_edit_date": 1576232950, "question_id": 35568334, "link": "https://stackoverflow.com/questions/35568334/appending-big-int-in-loop-to-slice-unexpected-result", "title": "Appending big.Int in loop to slice unexpected result", "body": "<p>The following Go program produces 1,2,3,4 in followed by 5,5,5,5.  I was expecting 1,2,3,4 in both cases.  What am I doing wrong?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc primesLessThan(n *big.Int) (primes []big.Int) {\n    var one big.Int\n    one.SetInt64(1)\n    var i big.Int\n    i.SetInt64(1)\n    for i.Cmp(n) &lt; 0 {\n        fmt.Println(i.String())\n        primes = append(primes, i)\n        i.Add(&amp;i, &amp;one)\n    }\n    return\n}\n\nfunc main() {\n    primes := primesLessThan(big.NewInt(5))\n    for _, p := range primes {\n        fmt.Println(p.String())\n    }\n}\n</code></pre>\n\n<p>Update: the following code snippet illustrates the unexpected side effects of the shallow copy described in the responses.  The output of the following snippet is 3, 3</p>\n\n<pre><code>one := big.NewInt(1)\ntwo := big.NewInt(2)\n\none = two // Shallow copy. Question: how do I do a deep copy?\n\none.SetInt64(3) // Side-effect: also changes two\n\nfmt.Println(one.String())\nfmt.Println(two.String())\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1456194969, "creation_date": 1456194969, "answer_id": 35567754, "question_id": 35567723, "link": "https://stackoverflow.com/questions/35567723/decoding-a-slice-of-maps-from-a-json-string-in-golang/35567754#35567754", "title": "Decoding a slice of maps from a JSON string in Golang", "body": "<p>Use []map[string]string:</p>\n\n<pre><code>type Response struct {\n    Page   int      `json:\"page\"`\n    Fruits []string `json:\"fruits\"`\n    Activities []map[string]string `json:\"activities\"`\n}\n</code></pre>\n\n<p><kbd><a href=\"http://play.golang.org/p/Wd5RvK2XR9\" rel=\"nofollow\">playground example</a></kbd></p>\n\n<p>Always check and handle errors. \nThe example JSON has a syntax error which is corrected in the playground example. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 1208851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cb72bdbc3ce916bfc08737e15f88c7b?s=128&d=identicon&r=PG", "display_name": "Maciek.Z", "link": "https://stackoverflow.com/users/1208851/maciek-z"}, "is_accepted": false, "score": 0, "last_activity_date": 1497740571, "creation_date": 1497740571, "answer_id": 44610203, "question_id": 35567723, "link": "https://stackoverflow.com/questions/35567723/decoding-a-slice-of-maps-from-a-json-string-in-golang/44610203#44610203", "title": "Decoding a slice of maps from a JSON string in Golang", "body": "<p>I know this is an old one, but i've recently written utility for generating exact go type from json input and in similar case you could give it a spin: <a href=\"https://github.com/m-zajac/json2go\" rel=\"nofollow noreferrer\">https://github.com/m-zajac/json2go</a></p>\n\n<p>For this particular example it generates from json:</p>\n\n<pre><code>{\"page\": 1, \"fruits\": [\"apple\", \"peach\"], \"activities\": [{\"name\": \"running\"}, {\"name\": \"swimming\"}]}\n</code></pre>\n\n<p>go type:</p>\n\n<pre><code>type Object struct {\n    Activities  []struct {\n        Name string `json:\"name\"`\n    }   `json:\"activities\"`\n    Fruits  []string    `json:\"fruits\"`\n    Page    int     `json:\"page\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 6700, "user_id": 1322427, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4c9d4aea3902debf993433deaa42b7dc?s=128&d=identicon&r=PG", "display_name": "SeanPlusPlus", "link": "https://stackoverflow.com/users/1322427/seanplusplus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3307, "favorite_count": 0, "accepted_answer_id": 35567754, "answer_count": 2, "score": 1, "last_activity_date": 1497740571, "creation_date": 1456194717, "question_id": 35567723, "link": "https://stackoverflow.com/questions/35567723/decoding-a-slice-of-maps-from-a-json-string-in-golang", "title": "Decoding a slice of maps from a JSON string in Golang", "body": "<p>Following the <a href=\"https://gobyexample.com/json\" rel=\"nofollow\">Go by Example: JSON tutorial</a>, I see how to work with a basic JSON string:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    )\n\ntype Response struct {\n    Page   int      `json:\"page\"`\n    Fruits []string `json:\"fruits\"`\n}\n\nfunc main() {\n    str := `{\"page\": 1, \"fruits\": [\"apple\", \"peach\"]}`\n    res := Response{}\n    json.Unmarshal([]byte(str), &amp;res)\n    fmt.Println(res.Page)\n    fmt.Println(res.Fruits)\n}\n\n// the output looks good here:\n// 1\n// [apple peach]\n</code></pre>\n\n<p>I would like to add some complexity to the <code>str</code> data object that I am decoding.</p>\n\n<p>Namely, I would like to add a key with a slice of maps as its value:</p>\n\n<pre><code>\"activities\": [{\"name\": \"running\"}, {\"name\", \"swimming\"}]\n</code></pre>\n\n<p>My script now looks like below example, however, for the life of me, I can not figure out what the correct syntax is in the <code>Response</code> struct in order to get at the values in <code>activities</code>. I know that this syntax isn't correct: <code>Activities []string ...</code> but can not hack my way towards a solution that captures the data I want to display.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    )\n\ntype Response struct {\n    Page   int      `json:\"page\"`\n    Fruits []string `json:\"fruits\"`\n    Activities []string `json:\"activities\"`\n}\n\nfunc main() {\n    str := `{\"page\": 1, \"fruits\": [\"apple\", \"peach\"], \"activities\": [{\"name\": \"running\"}, {\"name\", \"swimming\"}]}`\n    res := Response{}\n    json.Unmarshal([]byte(str), &amp;res)\n    fmt.Println(res.Page)\n    fmt.Println(res.Fruits)\n    fmt.Println(res.Activities)\n}\n\n// the script basically craps out here and returns:\n// 0\n// []\n// []\n</code></pre>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["go", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "is_accepted": true, "score": 0, "last_activity_date": 1456201651, "creation_date": 1456201651, "answer_id": 35568844, "question_id": 35567028, "link": "https://stackoverflow.com/questions/35567028/passing-string-to-win32-function-with-cgo/35568844#35568844", "title": "passing string to win32 function with cgo", "body": "<p>Try explicitly casting it:</p>\n\n<pre><code>name := C.CString(\"vds\")\nC.OpenService(scm, (*C.CHAR)(unsafe.Pointer(name)), C&gt;DWORD(C.SC_MANAGER_ALL_ACCESS))\n</code></pre>\n"}], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 35568844, "answer_count": 1, "score": 0, "last_activity_date": 1456201651, "creation_date": 1456190108, "question_id": 35567028, "link": "https://stackoverflow.com/questions/35567028/passing-string-to-win32-function-with-cgo", "title": "passing string to win32 function with cgo", "body": "<p>I try this</p>\n\n<pre><code>name := C.CString(\"vds\")\nC.OpenService(scm, (name), C.DWORD(C.SC_MANAGER_ALL_ACCESS))\n</code></pre>\n\n<p>but it wont compile</p>\n\n<pre><code>.\\test.go:28: cannot use name (type *C.char) as type *C.CHAR in argument to _Cfunc_OpenService\n</code></pre>\n\n<p>I tried looking for similar things (sqlite for example) but they seem to use this same idiom, but it compiles</p>\n"}, {"tags": ["unit-testing", "google-app-engine", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1456218495, "post_id": 35566754, "comment_id": 58833161, "body": "Do you have the <code>*_test.go</code> files in the working directory when running <code>goapp test</code>?"}, {"owner": {"reputation": 8208, "user_id": 41742, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f45066b1408b3df9b2f48a7e53aa59a7?s=128&d=identicon&r=PG&f=1", "display_name": "Curyous", "link": "https://stackoverflow.com/users/41742/curyous"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1456269735, "post_id": 35566754, "comment_id": 58866752, "body": "The test files were in subfolders, but when I put a dummy test in the working directory it runs the dummy test fine. Put your comment in an answer and I will mark it as correct."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1456270213, "creation_date": 1456270213, "answer_id": 35590375, "question_id": 35566754, "link": "https://stackoverflow.com/questions/35566754/main-main-not-defined-error-when-running-goapp-test/35590375#35590375", "title": "main.main not defined error when running goapp test", "body": "<p><code>goapp test</code> without any parameters will run unit tests that are in the current / working directory.</p>\n\n<p>So before running tests, navigate to the folder containing the <code>*_test.go</code> files, then run <code>goapp test</code>.</p>\n\n<p>More about testing can be found here: <a href=\"https://cloud.google.com/appengine/docs/go/tools/localunittesting/\" rel=\"nofollow\">Local Unit Testing for Go</a></p>\n\n<p>And of course by running</p>\n\n<pre><code>goapp help test\n</code></pre>\n"}], "owner": {"reputation": 8208, "user_id": 41742, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f45066b1408b3df9b2f48a7e53aa59a7?s=128&d=identicon&r=PG&f=1", "display_name": "Curyous", "link": "https://stackoverflow.com/users/41742/curyous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 775, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1456270213, "creation_date": 1456188385, "question_id": 35566754, "link": "https://stackoverflow.com/questions/35566754/main-main-not-defined-error-when-running-goapp-test", "title": "main.main not defined error when running goapp test", "body": "<p>In my Google App Engine Go project, when I run <code>goapp test</code>, I get the following errors:</p>\n\n<pre><code>runtime.main_main: main.main: not defined\nruntime.main_main: undefined: main.main\n</code></pre>\n\n<p>Since it's a not a normal go app, but a Google App Engine one, it doesn't have a main.main(), so what do I need to do to get the tests running?</p>\n"}, {"tags": ["go", "emacs", "autocomplete", "ide", "elisp"], "answers": [{"tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": false, "score": 0, "last_activity_date": 1456189087, "creation_date": 1456189087, "answer_id": 35566882, "question_id": 35565945, "link": "https://stackoverflow.com/questions/35565945/emacs-auto-complete-for-go-language/35566882#35566882", "title": "emacs auto complete for go language", "body": "<p>You need only <code>company</code> package. <code>company-go</code> is not required. The following config works for me:</p>\n\n<pre><code>  ;; enable company mode for autocompletion\n  (add-hook 'go-mode-hook (lambda ()\n                            (set (make-local-variable 'company-backends) '(company-go))\n                            (company-mode)))\n</code></pre>\n\n<p>Flycheck is also highly recommended (go support works out of the box):</p>\n\n<pre><code>  ;; enable flycheck\n  (add-hook 'go-mode-hook 'flycheck-mode)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1519, "user_id": 506016, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b2ef6443a54b6be94a1c522b67b661a?s=128&d=identicon&r=PG&f=1", "display_name": "MondayPaper", "link": "https://stackoverflow.com/users/506016/mondaypaper"}, "edited": false, "score": 0, "creation_date": 1481032723, "post_id": 35572665, "comment_id": 69202755, "body": "What package is &#39;cl?"}], "tags": [], "owner": {"reputation": 2788, "user_id": 1204781, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3650412926f7e278e072076551b541b7?s=128&d=identicon&r=PG", "display_name": "sudeepdino008", "link": "https://stackoverflow.com/users/1204781/sudeepdino008"}, "is_accepted": false, "score": 0, "last_activity_date": 1456216985, "creation_date": 1456216985, "answer_id": 35572665, "question_id": 35565945, "link": "https://stackoverflow.com/questions/35565945/emacs-auto-complete-for-go-language/35572665#35572665", "title": "emacs auto complete for go language", "body": "<p>Adding <code>(require 'cl)</code> at the start solved the problem.</p>\n"}], "owner": {"reputation": 2788, "user_id": 1204781, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3650412926f7e278e072076551b541b7?s=128&d=identicon&r=PG", "display_name": "sudeepdino008", "link": "https://stackoverflow.com/users/1204781/sudeepdino008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1187, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1456216985, "creation_date": 1456183667, "last_edit_date": 1456216951, "question_id": 35565945, "link": "https://stackoverflow.com/questions/35565945/emacs-auto-complete-for-go-language", "title": "emacs auto complete for go language", "body": "<p>I have been trying to combine <strong>company mode</strong> and <strong>gocode</strong> to setup auto complete in emacs. I have followed this <a href=\"https://github.com/nsf/gocode/tree/master/emacs-company\" rel=\"nofollow\">link</a>. But the result is not what is mentioned in gocode's github page. The menu doesn't appear on its own and the function declaration is not displayed in mini-buffer.</p>\n\n<p>This is my .emacs file (gocode and company mode setup is at last):</p>\n\n<pre><code>                                                     ;(invert-face 'default)   ;;weird with nw mode\n                                                     ;(blink-cursor-mode 0)\n(load-file \"/home/sudeep/.emacs.d/shortcuts.el\")\n;; (defadvice ido-find-file (after find-file-sudo activate)\n;;   \"Find file as root if necessary.\"\n;;   (unless (and buffer-file-name\n;;                (file-writable-p buffer-file-name))\n;;     (find-alternate-file (concat \"/sudo:root@localhost:\" buffer-file-name))))\n                                                     ;(setq debug-on-error t)\n\n(setq custom-file \"/home/sudeep/.emacs.d/custom.el\")\n(load custom-file 'noerror)\n\n(iswitchb-mode 1)\n                                                     ;disables scroll bar\n(if (fboundp 'scroll-bar-mode) (scroll-bar-mode -1))\n(menu-bar-mode -1)\n(tool-bar-mode -1)\n\n\n(add-to-list 'auto-mode-alist '(\"\\\\.h\\\\'\" . c++-mode))    ;.h files are treated as c files instaed of c++ in emacs. Remove it!\n\n;; -- laoding images in org mode\n;; enable image mode first\n(setq-default iimage-mode t)\n\n\n;Splitted window switching with C-ESC\n\n(global-set-key (kbd \"&lt;C-escape&gt;\") 'other-window)\n;     \n\n;hiding code(hiding the contents of a function)C-c @ C-h and C-c @ C-s\n\n\n(add-hook 'c++-mode-common-hook #'hs-minor-mode)\n(add-hook 'c-mode-common-hook #'hs-minor-mode)\n(add-hook 'python-mode-common-hook #'hs-minor-mode)\n(add-hook 'elisp-mode-common-hook #'hs-minor-mode)\n(add-hook 'java-mode-common-hook #'hs-minor-mode)\n\n\n(blink-cursor-mode -1)\n\n;miscellaneous\n(setq max-mini-window-height .70)\n(which-function-mode)\n\n\n\n\n(setq locale-coding-system 'utf-8)\n(set-terminal-coding-system 'utf-8-unix)\n(set-keyboard-coding-system 'utf-8)\n(set-selection-coding-system 'utf-8)\n(prefer-coding-system 'utf-8)\n\n\n\n\n;; (load-file \"~/.emacs.d/tabbar.el\")\n;; (require 'cl)\n;; (when (require 'tabbar nil t)\n;;   (setq tabbar-buffer-groups-function\n;;        (lambda (b) (list \"All Buffers\")))\n;;   (setq tabbar-buffer-list-function\n;;        (lambda ()\n;;           (remove-if\n;;            (lambda(buffer)\n;;               (find (aref (buffer-name buffer) 0) \" *\"))\n;;            (buffer-list))))\n;;   (tabbar-mode))\n\n;; (setq tabbar-buffer-groups-function\n;;      (lambda ()\n;;        (list \"All\")))\n;; (require 'tabbar)\n;; (tabbar-mode 1)\n;; (global-set-key [(C-S-iso-lefttab)] 'tabbar-backward)\n;; (global-set-key (kbd \"C-&lt;tab&gt;\") 'tabbar-forward)\n\n\n\n                                                     ;bookmarks\n(global-set-key (kbd \"C-c C-z\") 'bookmark-set)\n(global-set-key (kbd \"C-c C-j\") 'bookmark-jump)\n(global-set-key (kbd \"C-c C-q\") 'bookmark-delete)\n;(global-set-key (kbd \"C-!\") 'gtags-pop-stack)\n\n(defadvice bookmark-jump (after bookmark-jump activate)\n  (let ((latest (bookmark-get-bookmark bookmark)))\n    (setq bookmark-alist (delq latest bookmark-alist))\n    (add-to-list 'bookmark-alist latest)))\n\n(display-time-mode 1)\n\n;highlighting  todo,fixme, bug\n\n(add-hook 'prog-mode-common-hook\n             (lambda ()\n                (font-lock-add-keywords nil\n                                                '((\"\\\\&lt;\\\\(FIXME\\\\|TODO\\\\|BUG\\\\):\" 1 font-lock-warning-face t)))))\n\n\n;; (load-file \"/home/sudeep/.emacs.d/sr-speedbar.el\")\n;; (require 'sr-speedbar)\n;; (make-face 'speedbar-face)\n;; ;(set-face-font 'speedbar-face \"8\")\n;; (setq speedbar-mode-hook '(lambda () (buffer-face-set 'speedbar-face)))\n\n\n;; (speedbar-add-supported-extension \".c\")\n;; (speedbar-add-supported-extension \".c++\")\n;; (speedbar-add-supported-extension \".s\")\n;; (speedbar-add-supported-extension \".asm\")\n;; (speedbar-add-supported-extension \".java\")\n;; (speedbar-add-supported-extension \".py\")\n\n(setq c-default-style \"linux\"\n        c-basic-offset 3)\n\n                                                     ;indentation customization(replacing tabs by 4 spaces)\n(setq-default c-basic-offset 3\n                  tab-width 3\n                  indent-tabs-mode t)\n\n\n(defun dos2unix ()\n  \"Replace DOS eolns CR LF with Unix eolns CR\"\n  (interactive)\n    (goto-char (point-min))\n      (while (search-forward \"\\r\" nil t) (replace-match \"\")))\n\n\n;(set-face-attribute 'default nil :height 105)\n\n(setq url-proxy-services\n   '((\"no_proxy\" . \"^\\\\(localhost\\\\|10.*\\\\)\")\n     (\"http\" . \"10.3.100.207:8080\")\n     (\"https\" . \"10.3.100.207:8080\")\n      (\"ftp\" . \"10.3.100.207:8080\")\n      (\"socks\" . \"10.3.100.207:8080\")))\n\n\n\n(require 'package)\n(setq package-archives '((\"gnu\" . \"http://elpa.gnu.org/packages/\")\n                         (\"marmalade\" . \"http://marmalade-repo.org/packages/\")\n                         (\"melpa\" . \"http://melpa.milkbox.net/packages/\")\n                                 (\"elpa\" . \"http://tromey.com/elpa/\")))\n(package-initialize)\n(when (not package-archive-contents)\n  (package-refresh-contents))\n(add-to-list 'load-path \"/home/sudeep/.emacs.d/\")\n\n\n\n(defun djcb-opacity-modify (&amp;optional dec)\n  \"modify the transparency of the emacs frame; if DEC is t,\n    decrease the transparency, otherwise increase it in 10%-steps\"\n  (let* ((alpha-or-nil (frame-parameter nil 'alpha)) ; nil before setting\n          (oldalpha (if alpha-or-nil alpha-or-nil 100))\n          (newalpha (if dec (- oldalpha 10) (+ oldalpha 10))))\n    (when (and (&gt;= newalpha frame-alpha-lower-limit) (&lt;= newalpha 100))\n      (modify-frame-parameters nil (list (cons 'alpha newalpha))))))\n\n ;; C-8 will increase opacity (== decrease transparency)\n ;; C-9 will decrease opacity (== increase transparency\n ;; C-0 will returns the state to normal\n(global-set-key (kbd \"C-8\") '(lambda()(interactive)(djcb-opacity-modify)))\n(global-set-key (kbd \"C-9\") '(lambda()(interactive)(djcb-opacity-modify t)))\n(global-set-key (kbd \"C-0\") '(lambda()(interactive)\n                               (modify-frame-parameters nil `((alpha . 10)))))\n\n\n\n(setq large-file-warning-threshold 100000000)\n\n\n;(add-to-list 'custom-theme-load-path \"~/.emacs.d/themes\")\n;(load-theme 'junio t)\n;(load-theme 'zenburn t)\n\n;(load-file \"~/.emacs.d/arjen-theme.el\")\n\n                                                     ;(load-file \"~/.emacs.d/sanityinc-tomorrow-night-theme.el\")\n                                                     ;(set-background-color \"black\")\n                                                     ;(require 'color-theme-sanityinc-tomorrow)\n                                                     ;(load-theme 'color-theme-sanityinc-tomorrow-black t)\n                                                     ;(load-theme 'sanityinc-solarized-dark)\n\n\n(defun electric-pair ()\n  \"If at end of line, insert character pair without surrounding spaces.\n   Otherwise, just insert the typed character.\"\n  (interactive)\n  (if (eolp) (let (parens-require-spaces) (insert-pair)) \n    (self-insert-command 1)))\n\n(add-hook 'js-mode-hook\n             (lambda ()\n                (define-key js-mode-map \"(\" 'electric-pair)\n                (define-key js-mode-map \"[\" 'electric-pair)\n                (define-key js-mode-map \"{\" 'electric-pair)))\n\n\n\n;;js2-mode setup\n                                                     ;(semantic-mode)\n                                                     ;(require 'icicles)\n                                                     ;(icy-mode t)\n\n\n;; (add-to-list 'load-path \"/home/sudeep/.emacs.d/elpa/auto-complete-20160107.8/\")  ; Load the default configuration\n;; (require 'auto-complete-config)   ; Make sure we can find the dictionaries\n;; (add-to-list 'ac-dictionary-directories \"/home/sudeep/.emacs.d/elpa/auto-complete-20160107.8/dict\")          ; Usedictionaries by default\n;; (setq-default ac-sources (add-to-list 'ac-sources 'ac-source-dictionary))\n;; (global-auto-complete-mode t)\n;;                                                   ; Start auto-completion after 2 characters of a word\n;; (setq ac-auto-start 2)\n;;                                                   ; case sensitivity is important when finding matches\n;; (setq ac-ignore-case nil)\n\n;;                                                   ;(autoload 'js2-mode \"js2\" nil t) \n\n;; (ac-config-default)\n\n;; (set-default 'ac-sources\n;;               '(ac-source-abbrev\n;;                  ac-source-dictionary\n;;                  ac-source-yasnippet\n;;                  ac-source-words-in-buffer\n;;                  ac-source-words-in-same-mode-buffers\n;;                  ac-source-semantic))\n\n;; (dolist (m '(c-mode c++-mode java-mode go-mode))\n;;   (add-to-list 'ac-modes m))\n\n;; (global-auto-complete-mode t)\n;; ;;yasnippet\n;; (add-to-list 'load-path\n;;               \"~/.emacs.d/plugins/yasnippet\")\n;; (require 'yasnippet)\n;;                                                   ;(yas-global-mode 1)\n\n(add-to-list 'auto-mode-alist '(\"\\\\.js$\" . js2-mode))\n\n(js2-imenu-extras-mode)\n\n\n;; yes or no becomes y or n\n(defalias 'yes-or-no-p 'y-or-n-p)\n\n;; ;;yasnippet\n;; (yas-global-mode 1)\n\n;; ;; auto-complete\n;; (require 'auto-complete-config)\n;; (add-to-list 'ac-dictionary-directories \"~/.emacs.d/elpa/auto-complete/dict\")\n\n;; (set-default 'ac-sources\n;;              '(ac-source-abbrev\n;;                ac-source-dictionary\n;;                ac-source-yasnippet\n;;                ac-source-words-in-buffer\n;;                ac-source-words-in-same-mode-buffers\n;;                ac-source-semantic))\n\n;; (ac-config-default)\n\n;; (dolist (m '(c-mode c++-mode java-mode emacs-lisp-mode))\n;;   (add-to-list 'ac-modes m))\n\n;; (global-auto-complete-mode t)\n\n\n\n\n\n(global-aggressive-indent-mode 1)\n(add-to-list 'aggressive-indent-excluded-modes 'html-mode)\n(ido-mode 1)\n\n\n;;go-mode\n                                                     ;(require 'go-autocomplete)\n\n\n(require 'company)                                   ; load company mode\n                                                     ;(require 'company-go)                                                  ; load company mode go backend\n(add-hook 'go-mode-hook (lambda ()\n                                  (set (make-local-variable 'company-backends) '(company-go))\n                                  (company-mode)))\n(setq company-tooltip-limit 20)                      ; bigger popup window\n(setq company-idle-delay .1)                         ; decrease delay before autocompletion popup shows\n(setq company-echo-delay 0)                          ; remove annoying blinking\n(setq company-begin-commands '(self-insert-command)) ; start autocompletion only after typing\n\n(global-company-mode)\n\n;; (eval-after-load \"go-mode\"\n;;   '(progn\n;;      (flycheck-declare-checker go-gofmt\n;;                                       \"A Go syntax and style checker using the gofmt utility.\"\n;;                                       :command '(\"gofmt\" source-inplace)\n;;                                       :error-patterns '((\"^\\\\(?1:.*\\\\):\\\\(?2:[0-9]+\\\\):\\\\(?3:[0-9]+\\\\): \\\\(?4:.*\\\\)$\" error))\n;;                                       :modes 'go-mode)\n;;      (add-to-list 'flycheck-checkers 'go-gofmt)))\n                                                     ;(ac-go-expand-arguments-into-snippets)\n                                                     ;(add-hook 'go-mode-hook 'flycheck-mode)\n</code></pre>\n\n<p>Please help me to understand and fix the missing stuff.</p>\n\n<p>Here is the debug message when I execute <code>company-complete</code> after typing some letters:</p>\n\n<pre><code>Debugger entered--Lisp error: (error \"GOCODE PANIC: Please check your code by \\\"go build\\\"\")\n  signal(error (\"GOCODE PANIC: Please check your code by \\\"go build\\\"\"))\n  error(\"GOCODE PANIC: Please check your code by \\\"go build\\\"\")\n  company-go--candidates()\n  company-go(candidates #(\"Clien\" 0 5 (fontified t)))\n  apply(company-go (candidates #(\"Clien\" 0 5 (fontified t))))\n  #[0 \"\\302 !\\203\\303   \\300\\\"\\207\\303\\304  \\300#\\207\" [(candidates #(\"Clien\" 0 5 (fontified t))) company-backend functionp apply company--multi-backend-adapter] 4 \"\\n\\n(fn)\"]()\n  company-call-backend-raw(candidates #(\"Clien\" 0 5 (fontified t)))\n  apply(company-call-backend-raw (candidates #(\"Clien\" 0 5 (fontified t))))\n  company--force-sync(company-call-backend-raw (candidates #(\"Clien\" 0 5 (fontified t))) company-go)\n  company-call-backend(candidates #(\"Clien\" 0 5 (fontified t)))\n  company--fetch-candidates(#(\"Clien\" 0 5 (fontified t)))\n  company-calculate-candidates(#(\"Clien\" 0 5 (fontified t)))\n  #[0 \"\\n\\203   \\nC\\202\\n\\211\\205\\233\\211@\\3009\\204\\306!\\203&lt;9\\2036\\307N\\310=\\2046\\307N?\\205@\\311!\\205@\\312!\\202@\\313\\312\\\"\\240\\210\\300@\\203\\224\\314\\300@!\\203\\216\\315\\300@!\\211\\301\\316\\f!\\240\\210\\301@:\\204w\n\\203i\\317\\320!\\210\\301@\\310=\\203\\216\\321\\322!\\210\\202\\216\n\\203\\300@\\323\\301@!\\210\\324\\325\\326 \\\"\\210\\327\\330!\\210\\331\\332\\301@\\\"\\210A\\266\\202\\202\\n\\207\" [((#(\"Clien\" 0 5 (fontified t)) . t)) (nil) company-backend company-backends company-prefix company--manual-action functionp company-init t company-init-backend prefix company--multi-backend-adapter company--good-prefix-p company--prefix-str company-calculate-candidates message \"No completion found\" company-cancel unique company-update-candidates run-hook-with-args company-completion-started-hook company-explicit-action-p company-call-frontends show throw --cl-block-nil-- company--manual-prefix] 6 \"\\n\\n(fn)\"]()\n  funcall(#[0 \"\\n\\203   \\nC\\202\\n\\211\\205\\233\\211@\\3009\\204\\306!\\203&lt;9\\2036\\307N\\310=\\2046\\307N?\\205@\\311!\\205@\\312!\\202@\\313\\312\\\"\\240\\210\\300@\\203\\224\\314\\300@!\\203\\216\\315\\300@!\\211\\301\\316\\f!\\240\\210\\301@:\\204w\n\\203i\\317\\320!\\210\\301@\\310=\\203\\216\\321\\322!\\210\\202\\216\n\\203\\300@\\323\\301@!\\210\\324\\325\\326 \\\"\\210\\327\\330!\\210\\331\\332\\301@\\\"\\210A\\266\\202\\202\\n\\207\" [((#(\"Clien\" 0 5 (fontified t)) . t)) (nil) company-backend company-backends company-prefix company--manual-action functionp company-init t company-init-backend prefix company--multi-backend-adapter company--good-prefix-p company--prefix-str company-calculate-candidates message \"No completion found\" company-cancel unique company-update-candidates run-hook-with-args company-completion-started-hook company-explicit-action-p company-call-frontends show throw --cl-block-nil-- company--manual-prefix] 6 \"\\n\\n(fn)\"])\n  company--begin-new()\n  company--perform()\n  #[0 \"\\301 \\210\\207\" [company-candidates company--perform] 1 \"\\n\\n(fn)\"]()\n  company-auto-begin()\n  company-manual-begin()\n  company-complete()\n  call-interactively(company-complete record nil)\n  command-execute(company-complete record)\n  execute-extended-command(nil \"company-complete\")\n  call-interactively(execute-extended-command nil nil)\n</code></pre>\n\n<p><strong>EDIT</strong>\nAdding <code>(require 'cl)</code> at the start solved the problem. </p>\n"}, {"tags": ["templates", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1456183923, "post_id": 35565915, "comment_id": 58820275, "body": "I suggest <a href=\"https://godoc.org/go/format#Source\" rel=\"nofollow noreferrer\">formatting the output from the template</a> instead of tweaking the template to create Go code in canonical format.  Formatting the template output will get the whitespace right, align the field tags, etc, etc.  See <a href=\"http://stackoverflow.com/questions/34126083/is-it-possible-to-use-gofmt-on-templates-that-are-designed-to-be-used-with-go-ge/34126322#34126322\">this answer</a> for more info."}], "answers": [{"tags": [], "owner": {"reputation": 679, "user_id": 2888403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9ffa065886a8362661b8f85b2a7156a?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/2888403/david"}, "is_accepted": false, "score": 12, "last_activity_date": 1498763173, "creation_date": 1498763173, "answer_id": 44833096, "question_id": 35565915, "link": "https://stackoverflow.com/questions/35565915/golang-template-range-newline-removal/44833096#44833096", "title": "Golang template range newline removal", "body": "<p>Its mostly on playing with the trailing slash, try </p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"text/template\"\n)\n\ntype myGreetings struct {\n    Greet []string\n}\n\nfunc main() {\n    const txt = `\n{\n        {{- range $index, $word := .Greet}}\n  Hello {{$word -}}!!!\n        {{- end}}\n}\n`\n    greetText := myGreetings{\n        Greet: []string{\"World\", \"Universe\", \"Gophers\"},\n    }\n    t := template.Must(template.New(\"Text\").Parse(string(txt)))\n    t.Execute(os.Stdout, greetText)\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/eGm3d3IJPp\" rel=\"noreferrer\">https://play.golang.org/p/eGm3d3IJPp</a></p>\n\n<p>Output:</p>\n\n<pre><code>{\n  Hello World!!!\n  Hello Universe!!!\n  Hello Gophers!!!\n}\n</code></pre>\n"}], "owner": {"reputation": 1303, "user_id": 779404, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1312959fa177c836dc5ecee589dc487f?s=128&d=identicon&r=PG", "display_name": "b0xxed1n", "link": "https://stackoverflow.com/users/779404/b0xxed1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10679, "favorite_count": 2, "answer_count": 1, "score": 8, "last_activity_date": 1498763173, "creation_date": 1456183485, "question_id": 35565915, "link": "https://stackoverflow.com/questions/35565915/golang-template-range-newline-removal", "title": "Golang template range newline removal", "body": "<p>I'm trying to figure out how I can remove the new lines in my template that are put there by the {{range}} and {{end}}. I get the following output without any of the \"-\" tags:</p>\n\n<pre><code>type {{makeGoTableName .TableName}} struct {\n  {{range $key, $value := .TableData}}\n    {{makeGoColName $value.ColName}} {{$value.ColType}} `db:\"{{makeDBColName $value.ColName}}\",json:\"{{$value.ColName}}\"`\n  {{end}}\n}\n</code></pre>\n\n<p>Results in:</p>\n\n<pre><code>type Dogs struct {\n\n  ID int64 `db:\"id\",json:\"id\"`\n\n  DogNumber int64 `db:\"dog_number\",json:\"dog_number\"`\n\n}\n</code></pre>\n\n<p>If I add the - tags like so, I can get it close to desirable but it breaks the indentation of the final closing brace:</p>\n\n<pre><code>type {{makeGoTableName .TableName}} struct {\n  {{range $key, $value := .TableData -}}\n    {{makeGoColName $value.ColName}} {{$value.ColType}} `db:\"{{makeDBColName $value.ColName}}\",json:\"{{$value.ColName}}\"`\n  {{end -}}\n}\n</code></pre>\n\n<p>Results in:</p>\n\n<pre><code>type Dogs struct {\n  ID int64 `db:\"id\",json:\"id\"`\n  DogNumber int64 `db:\"dog_number\",json:\"dog_number\"`\n  }\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["http", "go", "go-http"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1456172124, "post_id": 35562820, "comment_id": 58814053, "body": "The <code>*bufio.ReadWriter</code> is buffer IO for the underlying <code>net.Conn</code>. Are you asking <i>why</i> you would use buffered Reads?"}, {"owner": {"reputation": 253, "user_id": 5719160, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/abd92cbc314012f263ee283c0fe8f323?s=128&d=identicon&r=PG&f=1", "display_name": "Kim Byer", "link": "https://stackoverflow.com/users/5719160/kim-byer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456172406, "post_id": 35562820, "comment_id": 58814221, "body": "Ahh I see. No I was just confused why there is two ways of getting the same data... :) thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1456172151, "post_id": 35562951, "comment_id": 58814073, "body": "There is a difference between buffered and unbuffered IO."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456172534, "post_id": 35562951, "comment_id": 58814281, "body": "Ok, but you only corrected the first statement. Even if you&#39;re &quot;only going to use Read() and Write()&quot;, you still will often want buffered IO."}, {"owner": {"reputation": 225, "user_id": 1507342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5165ad3df4cd59728ea24317698f15bc?s=128&d=identicon&r=PG&f=1", "display_name": "d1str0", "link": "https://stackoverflow.com/users/1507342/d1str0"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456172682, "post_id": 35562951, "comment_id": 58814369, "body": "Buffered IO is optional so I clarified that just now."}], "tags": [], "owner": {"reputation": 225, "user_id": 1507342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5165ad3df4cd59728ea24317698f15bc?s=128&d=identicon&r=PG&f=1", "display_name": "d1str0", "link": "https://stackoverflow.com/users/1507342/d1str0"}, "is_accepted": false, "score": -1, "last_activity_date": 1456172663, "last_edit_date": 1456172663, "creation_date": 1456172109, "answer_id": 35562951, "question_id": 35562820, "link": "https://stackoverflow.com/questions/35562820/golang-hijack-arguments/35562951#35562951", "title": "Golang - Hijack Arguments", "body": "<p>Their difference is buffered IO.</p>\n\n<p>net.Conn implements Read() and Write() thus implementing io.Reader and io.Writer. This is why bufio can wrap it up as a <em>buffered</em> ReadWriter and further implement functions on top using those two methods in a buffered manner.</p>\n\n<p>If you only want to use Read() and Write(), you can just stick with net.Conn, otherwise you can take advantage for the buffered ReadWriter methods.</p>\n\n<p>See <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow\">https://golang.org/pkg/io/#Reader</a> and <a href=\"https://golang.org/pkg/io/#Writer\" rel=\"nofollow\">https://golang.org/pkg/io/#Writer</a></p>\n"}, {"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1456174861, "post_id": 35563384, "comment_id": 58815648, "body": "If the protocol is such that the client must wait for a response from the server before writing data after the HTTP request header, then the server application can ignore the bufio wrapper after <a href=\"https://godoc.org/bufio#Reader.Buffered\" rel=\"nofollow noreferrer\">checking for a client error</a>. The websocket protocol is an example of where this can be done."}, {"owner": {"reputation": 253, "user_id": 5719160, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/abd92cbc314012f263ee283c0fe8f323?s=128&d=identicon&r=PG&f=1", "display_name": "Kim Byer", "link": "https://stackoverflow.com/users/5719160/kim-byer"}, "edited": false, "score": 0, "creation_date": 1456179567, "post_id": 35563384, "comment_id": 58818375, "body": "Thanks a lot guys! I&#39;m new to go and people like you encourage me to not give up! I really appreciate it! Thanks again!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1456175392, "last_edit_date": 1456175392, "creation_date": 1456173652, "answer_id": 35563384, "question_id": 35562820, "link": "https://stackoverflow.com/questions/35562820/golang-hijack-arguments/35563384#35563384", "title": "Golang - Hijack Arguments", "body": "<p><code>net.Conn.Read</code> and <code>*bufio.ReadWriter.Read</code> both read from the same connection, but the latter is buffered. The <code>Hijack</code> method in the standard \"net/http\" package directly returns the <code>net.Conn</code> wrapped in a <code>bufio.ReadWriter</code>, using the same <code>*bufio.Reader</code> that was already allocated for the http request. </p>\n\n<p>It's possible that there is still data buffered in the <code>bufio.Reader</code> which you may miss when reading directly from the network connection. If you want to use the <code>net.Conn</code> directly, you should check if there is buffered data already with <a href=\"https://godoc.org/bufio#Reader.Buffered\" rel=\"nofollow\"><code>Reader.Buffered</code></a>, and handle that according to the protocol being used.</p>\n\n<p>In general, you should prefer to use <code>bufio.ReadWriter</code>, as it will be more efficient for non-optimally sized reads and writes to the network. </p>\n\n<p>The  <code>net.Conn</code> is still needed to handle the Read and Write deadlines, to close the <code>net.Conn</code> when you're done, and for any other network-specific activities. </p>\n"}], "owner": {"reputation": 253, "user_id": 5719160, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/abd92cbc314012f263ee283c0fe8f323?s=128&d=identicon&r=PG&f=1", "display_name": "Kim Byer", "link": "https://stackoverflow.com/users/5719160/kim-byer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 35563384, "answer_count": 2, "score": 4, "last_activity_date": 1531913376, "creation_date": 1456171621, "last_edit_date": 1531913376, "question_id": 35562820, "link": "https://stackoverflow.com/questions/35562820/golang-hijack-arguments", "title": "Golang - Hijack Arguments", "body": "<p>When using <a href=\"https://golang.org/pkg/net/http/#Hijacker\" rel=\"nofollow\">Hijack()</a> with a <code>http.ResponseWriter</code> instance</p>\n\n<blockquote>\n  <p>Hijack() (net.Conn, *bufio.ReadWriter, error)</p>\n</blockquote>\n\n<p>What is the difference between reading from the <code>net.Conn</code> and the <code>*bufio.ReadWriter</code>?</p>\n"}, {"tags": ["go", "slice", "channel"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1456167760, "post_id": 35561721, "comment_id": 58811605, "body": "What is the type of the channel  &lt;-client.Outgoing? Show the code that sends to the channel.  Note that the code <code>asdf := append(header, e...)</code> writes to the backing array of input."}], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 1167741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf35c1cb67665b1d9cde2cf851716a3e?s=128&d=identicon&r=PG&f=1", "display_name": "stihl", "link": "https://stackoverflow.com/users/1167741/stihl"}, "edited": false, "score": 0, "creation_date": 1456168938, "post_id": 35561849, "comment_id": 58812293, "body": "Ah, did not realize that. Thanks! That fixed it."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1456168633, "last_edit_date": 1456168633, "creation_date": 1456168159, "answer_id": 35561849, "question_id": 35561721, "link": "https://stackoverflow.com/questions/35561721/append-slice-in-go-routine/35561849#35561849", "title": "Append slice in go routine", "body": "<p>The slices <code>temp</code> and <code>input</code> share the same backing array. Modifications through one slice are visible through the other. The line containing \"INPUT END7\" is not the same as the line with \"INPUT END1\" because the backing array of the slices is modified on this line:</p>\n\n<pre><code>asdf := append(header, e...)\n</code></pre>\n\n<p>You can copy the backing array using this line of code:</p>\n\n<pre><code>temp := append([]byte(nil), input...)\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 1167741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf35c1cb67665b1d9cde2cf851716a3e?s=128&d=identicon&r=PG&f=1", "display_name": "stihl", "link": "https://stackoverflow.com/users/1167741/stihl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 35561849, "answer_count": 1, "score": 0, "last_activity_date": 1456168633, "creation_date": 1456167671, "last_edit_date": 1456167917, "question_id": 35561721, "link": "https://stackoverflow.com/questions/35561721/append-slice-in-go-routine", "title": "Append slice in go routine", "body": "<p>I am trying to teach myself Go. I have written a simple client / server app that has some encryption and very simple packet structure. </p>\n\n<p>I have a go routine for listening and then sending data to each client connected.  In my function that sends data to each client i'm appending a message to a header but its doing some strange behavior. </p>\n\n<pre><code>func ClientSender(client *Client) {\nfor {\n    input := &lt;-client.Outgoing                             //TODO add cleanup quit bool\n    for _, clientz := range RoomList[client.Room].Clients { //TODO rename to client connections = ClientList\n        temp := input\n        dbgMsg.Printf(\"RAW SENDER: % x\", input)\n        dbgMsg.Printf(\"INPUT END1: % x\", input)\n        dbgMsg.Printf(\"AES KEY % x\\n\", clientz.AES_Key)\n        dbgMsg.Printf(\"INPUT END2: % x\", input)\n        dbgMsg.Printf(\"pre ecnryp: % x\\n\", input[30:])\n        dbgMsg.Printf(\"INPUT END3: % x\", input)\n        encPayload := input[30:]\n        dbgMsg.Printf(\"INPUT END4: % x\", input)\n        header := input[:30]\n        dbgMsg.Printf(\"INPUT END5: % x\", input)\n        e,_ := barrenoid.Encrypt(clientz.AES_Key, encPayload)\n        dbgMsg.Printf(\"INPUT END6: % x\", input)\n        dbgMsg.Printf(\"header: % x\\n\", input[:30])\n        dbgMsg.Printf(\"payload: % x\\n\", input[30:])\n        dbgMsg.Printf(\"encrypt: % x\\n\", e)\n        dbgMsg.Printf(\"TEMP: % x\\n\", temp)\n        asdf := append(header, e...)\n        dbgMsg.Printf(\"SENDING: % x\", asdf)\n        //_, err := clientz.Conn.Write(payload)\n        //chkError(err)\n        input = temp\n        dbgMsg.Printf(\"INPUT END7: % x\", input)\n    }\n}\n}\n</code></pre>\n\n<p>The value of \"input\" get changed and i cant figure out why. here is output from the above code:</p>\n\n<pre><code>INFO:   2016/02/22 10:47:38 RAW SENDER: 0d ae 00 00 00 00 56 cb 57 ca 41 6e 6f 6e 79 6d 6f 75 73 00 00 00 00 00 00 00 00 00 00 00 0a\n\nINFO:   2016/02/22 10:47:38 INPUT END1: 0d ae 00 00 00 00 56 cb 57 ca 41 6e 6f 6e 79 6d 6f 75 73 00 00 00 00 00 00 00 00 00 00 00 0a\nINFO:   2016/02/22 10:47:38 AES KEY 06 89 c9 d7 ad ec 4a d0 33 bf fa ab 6e 05 cd 51 87 8b f0 ad 60 a8 36 47 ca 8f 7a f8 b8 6f 1c ce\nINFO:   2016/02/22 10:47:38 INPUT END2: 0d ae 00 00 00 00 56 cb 57 ca 41 6e 6f 6e 79 6d 6f 75 73 00 00 00 00 00 00 00 00 00 00 00 0a\nINFO:   2016/02/22 10:47:38 pre ecnryp: 0a\nINFO:   2016/02/22 10:47:38 INPUT END3: 0d ae 00 00 00 00 56 cb 57 ca 41 6e 6f 6e 79 6d 6f 75 73 00 00 00 00 00 00 00 00 00 00 00 0a\nINFO:   2016/02/22 10:47:38 INPUT END4: 0d ae 00 00 00 00 56 cb 57 ca 41 6e 6f 6e 79 6d 6f 75 73 00 00 00 00 00 00 00 00 00 00 00 0a\nINFO:   2016/02/22 10:47:38 INPUT END5: 0d ae 00 00 00 00 56 cb 57 ca 41 6e 6f 6e 79 6d 6f 75 73 00 00 00 00 00 00 00 00 00 00 00 0a\nINFO:   2016/02/22 10:47:38 INPUT END6: 0d ae 00 00 00 00 56 cb 57 ca 41 6e 6f 6e 79 6d 6f 75 73 00 00 00 00 00 00 00 00 00 00 00 0a\nINFO:   2016/02/22 10:47:38 header: 0d ae 00 00 00 00 56 cb 57 ca 41 6e 6f 6e 79 6d 6f 75 73 00 00 00 00 00 00 00 00 00 00 00\nINFO:   2016/02/22 10:47:38 payload: 0a\nINFO:   2016/02/22 10:47:38 encrypt: ***c8*** 7e ff f9 f5 c3 ce 1e 1d 44 91 b7 fb 09 5d e0 7e\nINFO:   2016/02/22 10:47:38 TEMP: 0d ae 00 00 00 00 56 cb 57 ca 41 6e 6f 6e 79 6d 6f 75 73 00 00 00 00 00 00 00 00 00 00 00 0a\nINFO:   2016/02/22 10:47:38 SENDING: 0d ae 00 00 00 00 56 cb 57 ca 41 6e 6f 6e 79 6d 6f 75 73 00 00 00 00 00 00 00 00 00 00 00 c8 7e ff f9 f5 c3 ce 1e 1d 44 91 b7 fb 09 5d e0 7e\nINFO:   2016/02/22 10:47:38 INPUT END7: 0d ae 00 00 00 00 56 cb 57 ca 41 6e 6f 6e 79 6d 6f 75 73 00 00 00 00 00 00 00 00 00 00 00 ***c8***\n</code></pre>\n\n<p>I cant figure out why the line containing \"INPUT END7\" is not equal the the \"input\" value.</p>\n\n<p>The last byte is ALWAYS equal to the first byte in \"encrypted\"output...</p>\n\n<p>Here is code that sends slice to channel:</p>\n\n<pre><code>func ClientReader(client *Client) {\n//Main Read loop\nfor {\n    bytesRead, buffer := client.Read()\n\n    if bytesRead &lt; HEADERSIZE {\n        //client.Outgoing &lt;- protocolPacker(0x0D, 0xAE, []byte(\"\"), []byte(\"Minimum header not recieved.\"))\n        client.Close()\n        break // Connection to host is broken\n    }\n\n    //dbgMsg.Printf(\"RAW RECIEVED % x\", buffer)\n    cmdBit, encryptionByte, ts, payload := protocolParser(buffer)\n    dbgMsg.Printf(\"CMDBIT: % x, ENCBIT: % x, TS: % d, PAYLOAD: % x\", cmdBit, encryptionByte, ts, payload)\n\n\n    if encryptionByte == 0xAE {\n        payload, _ = barrenoid.Decrypt(client.AES_Key, payload)\n        dbgMsg.Printf(\"Decrypted payload % x\\n\", payload)\n    } else if encryptionByte == 0x00 {\n        // no need to decrypt\n    } else {\n        //bad packet reject\n    }\n\n    if cmdBit == 0x0D{\n        //payload, _ = barrenoid.Encrypt(client.AES_Key, payload)\n        client.Outgoing &lt;- protocolPacker(0x0D, 0xAE, []byte(client.Name), payload)\n    } else if cmdBit == 0x1C {\n        client.Name = string(payload)\n    } else {\n        //bad packet reject\n        //client.Outgoing &lt;- protocolPacker(0x0D, 0xAE, []byte(client.Name), []byte(\"Unknown command bit.\"))\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456168150, "post_id": 35561719, "comment_id": 58811852, "body": "<a href=\"https://golang.org/pkg/strings/#Replace\" rel=\"nofollow noreferrer\"><code>strings.Replace</code></a> takes 4 arguments. Are you looking for <a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"nofollow noreferrer\"><code>fmt.Sprintf</code></a>?"}, {"owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456168278, "post_id": 35561719, "comment_id": 58811918, "body": "yes that was the issue thank you @JimB"}], "answers": [{"comments": [{"owner": {"reputation": 38917, "user_id": 445210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b689cc1d73c4f1e7378d045a54abcca?s=128&d=identicon&r=PG", "display_name": "Herman Schaaf", "link": "https://stackoverflow.com/users/445210/herman-schaaf"}, "edited": false, "score": 0, "creation_date": 1456168677, "post_id": 35561925, "comment_id": 58812171, "body": "Not quite sure what the downvote was for."}], "tags": [], "owner": {"reputation": 38917, "user_id": 445210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b689cc1d73c4f1e7378d045a54abcca?s=128&d=identicon&r=PG", "display_name": "Herman Schaaf", "link": "https://stackoverflow.com/users/445210/herman-schaaf"}, "is_accepted": true, "score": 2, "last_activity_date": 1456168737, "last_edit_date": 1456168737, "creation_date": 1456168431, "answer_id": 35561925, "question_id": 35561719, "link": "https://stackoverflow.com/questions/35561719/replace-string-with-variable-for-golang-proxy/35561925#35561925", "title": "Replace string with variable for golang proxy", "body": "<p>Firstly, url.Parse returns two variables, a URL and an error, as per the <a href=\"https://golang.org/pkg/net/url/#Parse\" rel=\"nofollow\">docs here</a>. </p>\n\n<p>Secondly, instead of <code>strings.Replace</code> you probably meant to use <code>fmt.Sprintf(\"%v\", RandomProxyAddress())</code>, assuming <code>RandomProxyAddress()</code> returns a string, or something that formats into the string you want. So all in all, you should have:</p>\n\n<pre><code>addr := fmt.Sprintf(\"%v\", RandomProxyAddress())\nproxyURL, err := url.Parse(addr)\nif err != nil {\n    log.Println(err)\n}\n</code></pre>\n\n<p>That said, the <code>fmt.Sprintf</code> would be unnecessary if <code>RandomProxyAddress()</code> already returns a string. <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow\">Check the docs for <code>fmt</code> and <code>fmt.Sprintf</code></a>. And if you really did mean to use <code>strings.Replace</code>, notice that it <a href=\"https://golang.org/pkg/strings/#Replace\" rel=\"nofollow\">requires four arguments</a>, not two.</p>\n"}], "owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 784, "favorite_count": 0, "closed_date": 1457321732, "accepted_answer_id": 35561925, "answer_count": 1, "score": -3, "last_activity_date": 1456168737, "creation_date": 1456167667, "question_id": 35561719, "link": "https://stackoverflow.com/questions/35561719/replace-string-with-variable-for-golang-proxy", "closed_reason": "Not suitable for this site", "title": "Replace string with variable for golang proxy", "body": "<p>I'm trying to use the http proxy code here </p>\n\n<pre><code>proxyUrl := url.Parse(strings.Replace(\"%v\", RandomProxyAddress()))\nhttp.DefaultTransport = &amp;http.Transport{Proxy: http.ProxyURL(proxyUrl)}\n</code></pre>\n\n<p>Tells me there are too many arguments  in the url.Parse</p>\n\n<p>But when I try </p>\n\n<pre><code>proxyUrl := url.Parse(RandomProxyAddress())\nhttp.DefaultTransport = &amp;http.Transport{Proxy: http.ProxyURL(proxyUrl)}\n</code></pre>\n\n<p>I get <code>./main.go:138: multiple-value url.Parse() in single-value context</code></p>\n\n<p>When I tried a string replace it also tells me too many varibles.  Not sure how to get my proxy to work with the url.Parse</p>\n"}, {"tags": ["go", "opengl-es", "game-engine", "gomobile"], "answers": [{"tags": [], "owner": {"reputation": 876, "user_id": 2305723, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/23e6e73c52938ec01c706097cf4e8943?s=128&d=identicon&r=PG", "display_name": "efel", "link": "https://stackoverflow.com/users/2305723/efel"}, "is_accepted": false, "score": 2, "last_activity_date": 1461069988, "last_edit_date": 1461069988, "creation_date": 1460995011, "answer_id": 36698885, "question_id": 35560316, "link": "https://stackoverflow.com/questions/35560316/golang-crossplatform-game-engine-using-mobile-pkg/36698885#36698885", "title": "Golang crossplatform game engine using mobile pkg?", "body": "<p>Last time i tried gomobile opengl on windows, it didnt work. I was only able to compile for android. Maybe this bug is fixed now, not sure.. </p>\n\n<p>However; for cross platform you could simply use gomobile for mobile platforms and create an interface for generic opengl on desktop and you would seamlessly have both. Just abstract out the interface between regular opengl and gomobile opengl es.</p>\n\n<p>update:</p>\n\n<p>actually just tried to run the \"basic\" example using go run and it worked on windows. So the bug must of been fixed.  So in your response, yes it is possible to use go mobile x for cross platform mobile + desktop:</p>\n\n<p><a href=\"https://github.com/golang/mobile/blob/master/example/basic/main.go\" rel=\"nofollow\">https://github.com/golang/mobile/blob/master/example/basic/main.go</a></p>\n\n<p>However; audio does NOT compile on windows due to linux specific Open AL libraries. If you look at the build flags, darwin, linux only, no windows.</p>\n"}], "owner": {"reputation": 139, "user_id": 2858862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62db143c642826a2d12a88d9d9dec5c9?s=128&d=identicon&r=PG", "display_name": "Billy Ninja", "link": "https://stackoverflow.com/users/2858862/billy-ninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 925, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1461069988, "creation_date": 1456162972, "question_id": 35560316, "link": "https://stackoverflow.com/questions/35560316/golang-crossplatform-game-engine-using-mobile-pkg", "title": "Golang crossplatform game engine using mobile pkg?", "body": "<p>Is it possible to create a crossplatform (mobile + destkop) game engine using the Go mobile package resources? Or it is somehow tied to gomobile and mobile architectures?</p>\n\n<p>The first problem is the fact that glsprite and other rendering packages I would be using are built on top of OpenGL <strong>ES</strong>, so I would have to ignore everything that is <code>gl</code> and use only more generic packages like <a href=\"https://godoc.org/golang.org/x/mobile/exp/sprite/portable\" rel=\"nofollow\">https://godoc.org/golang.org/x/mobile/exp/sprite/portable</a>? Or I could still use glsprite near-seamlessly when targeting mobile?</p>\n\n<p>Theorically audio should cross-compile fine with <a href=\"https://godoc.org/golang.org/x/mobile/exp/audio\" rel=\"nofollow\">https://godoc.org/golang.org/x/mobile/exp/audio</a>?</p>\n\n<p>Is it doable/viable? Or too much hassle?</p>\n"}, {"tags": ["go", "io"], "answers": [{"comments": [{"owner": {"reputation": 495, "user_id": 1950663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nBJeA.png?s=128&g=1", "display_name": "CoppolaEmilio", "link": "https://stackoverflow.com/users/1950663/coppolaemilio"}, "edited": false, "score": 0, "creation_date": 1456160516, "post_id": 35558965, "comment_id": 58807192, "body": "Thanks for the quick reply, but how can I set flags to <code>ioutil.ReadFile(fileName)</code> ?"}, {"owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "reply_to_user": {"reputation": 495, "user_id": 1950663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nBJeA.png?s=128&g=1", "display_name": "CoppolaEmilio", "link": "https://stackoverflow.com/users/1950663/coppolaemilio"}, "edited": false, "score": 1, "creation_date": 1456161310, "post_id": 35558965, "comment_id": 58807761, "body": "@CoppolaEmilio You can&#39;t pass flags to ioutil.ReadFile, but you could just use os.OpenFile with ioutil.ReadAll"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 495, "user_id": 1950663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nBJeA.png?s=128&g=1", "display_name": "CoppolaEmilio", "link": "https://stackoverflow.com/users/1950663/coppolaemilio"}, "edited": false, "score": 1, "creation_date": 1456161324, "post_id": 35558965, "comment_id": 58807776, "body": "@CoppolaEmilio: you don&#39;t. <code>ioutil.ReadFile</code> is just a convenience function to call <code>os.Open</code> and <code>iotuil.ReadAll</code>. If you need more control, you create your own similar function."}, {"owner": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "edited": false, "score": 2, "creation_date": 1496641003, "post_id": 35558965, "comment_id": 75726126, "body": "Doesn&#39;t this leak a file descriptor?"}, {"owner": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "edited": false, "score": 2, "creation_date": 1496641229, "post_id": 35558965, "comment_id": 75726197, "body": "Ah, never mind, according to <a href=\"https://stackoverflow.com/a/8595507/476074\">stackoverflow.com/a/8595507/476074</a> they are closed automatically."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "edited": false, "score": 0, "creation_date": 1505415956, "post_id": 35558965, "comment_id": 79416719, "body": "@AndreKR: If you&#39;re worried about &quot;leaking&quot; file descriptors, you can&#39;t depend on the finalizer because finalizers are never guaranteed to run, but you should be closing the file anyway. Using <code>os.O_CREATE</code> to open a file and create it if it doesn&#39;t exist has nothing to do with making sure you call &quot;Close&quot;"}, {"owner": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "edited": false, "score": 0, "creation_date": 1505416507, "post_id": 35558965, "comment_id": 79416994, "body": "Seems you are right, if there&#39;s no memory pressure it might never be GC&#39;d. In that case I think the answer to &quot;how to create an empty file&quot; should include the call to <code>Close()</code>."}, {"owner": {"reputation": 897, "user_id": 6191970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fecdd0e2681f2f4d65f9dea79742af9?s=128&d=identicon&r=PG&f=1", "display_name": "Ace.C", "link": "https://stackoverflow.com/users/6191970/ace-c"}, "edited": false, "score": 0, "creation_date": 1526342194, "post_id": 35558965, "comment_id": 87697235, "body": "Can this be used to create directories?"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 49, "last_activity_date": 1456159088, "creation_date": 1456159088, "answer_id": 35558965, "question_id": 35558787, "link": "https://stackoverflow.com/questions/35558787/create-an-empty-text-file/35558965#35558965", "title": "Create an empty text file", "body": "<p>Don't try to check the existence first, since you then have a race if the file is created at the same time. You can open the file with the <code>O_CREATE</code> flag to create it if it doesn't exist:</p>\n\n<pre><code>os.OpenFile(name, os.O_RDONLY|os.O_CREATE, 0666)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": false, "score": 5, "last_activity_date": 1587985415, "last_edit_date": 1587985415, "creation_date": 1575467123, "answer_id": 59177482, "question_id": 35558787, "link": "https://stackoverflow.com/questions/35558787/create-an-empty-text-file/59177482#59177482", "title": "Create an empty text file", "body": "<p>Just trying to improve the excellent accepted answer.</p>\n\n<p>It's a good idea to check for errors and to <code>Close()</code> the opened file, since file descriptors are a limited resource. You can run out of file descriptors much sooner than a GC runs, and on Windows you can run into file sharing violations.</p>\n\n<pre><code>func TouchFile(name string) error {\n    file, err := os.OpenFile(name, os.O_RDONLY|os.O_CREATE, 0644)\n    if err != nil {\n        return err\n    }\n    return file.Close()\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1549, "user_id": 13631587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c4714de792628cb0aa0a4e39cf6eaa1?s=128&d=identicon&r=PG", "display_name": "Jon Nickles", "link": "https://stackoverflow.com/users/13631587/jon-nickles"}, "edited": false, "score": 0, "creation_date": 1618536836, "post_id": 67067241, "comment_id": 118637210, "body": "The code does not handle the case where some other process creates the file between the call to os.Stat and the call to os.Create."}], "tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1618273703, "creation_date": 1618273703, "answer_id": 67067241, "question_id": 35558787, "link": "https://stackoverflow.com/questions/35558787/create-an-empty-text-file/67067241#67067241", "title": "Create an empty text file", "body": "<p>The <code>OpenFile</code> function is the best way to do this, but here is another option:</p>\n<pre><code>package main\nimport &quot;os&quot;\n\nfunc create(name string) (*os.File, error) {\n   _, e := os.Stat(name)\n   if e == nil { return nil, os.ErrExist }\n   return os.Create(name)\n}\n\nfunc main() {\n   f, e := create(&quot;file.txt&quot;)\n   if os.IsExist(e) {\n      println(&quot;Exist&quot;)\n   } else if e != nil {\n      panic(e)\n   }\n   f.Close()\n}\n</code></pre>\n<p><a href=\"https://golang.org/pkg/os#ErrExist\" rel=\"nofollow noreferrer\">https://golang.org/pkg/os#ErrExist</a></p>\n"}], "owner": {"reputation": 495, "user_id": 1950663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nBJeA.png?s=128&g=1", "display_name": "CoppolaEmilio", "link": "https://stackoverflow.com/users/1950663/coppolaemilio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22499, "favorite_count": 4, "accepted_answer_id": 35558965, "answer_count": 3, "score": 16, "last_activity_date": 1618273703, "creation_date": 1456158509, "question_id": 35558787, "link": "https://stackoverflow.com/questions/35558787/create-an-empty-text-file", "title": "Create an empty text file", "body": "<p>I've been reading and googling all over but I can't seem to find this simple answer. </p>\n\n<p>I have a function that reads a file, but if the files doesn't exists it panics. What I want to do is a function that before reading, checks if the files exists, and if not, it creates an empty file. Here is what I have.</p>\n\n<pre><code>func exists(path string) (bool, error) {\n    _, err := os.Stat(path)\n    if err == nil {\n        return true, nil\n    }\n    if os.IsNotExist(err) {\n        return false, nil\n    }\n    return true, err\n}\n</code></pre>\n"}, {"tags": ["go", "oauth-2.0"], "answers": [{"comments": [{"owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 0, "creation_date": 1456164234, "post_id": 35558869, "comment_id": 58809601, "body": "thing I&#39;m confused about though is the &quot;track it until...&quot; part. Assuming that there could be multiple simultaneous requests, can&#39;t really set it as a global variable. Are you suggesting to add/delete from database rows or something?"}, {"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "reply_to_user": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 0, "creation_date": 1456165433, "post_id": 35558869, "comment_id": 58810303, "body": "You could use a <code>map[string]user.Identifier</code> where for each request you store your state along with the user identifier: <code>m[state] = userId</code>. When a callback arrives, look up the user identifier in your map and associate the received access token with it. Afterwards delete the key from the map. You will probably want to use some form of expiring cache to delete states that haven&#39;t been callbacked in a while."}, {"owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 0, "creation_date": 1456170908, "post_id": 35558869, "comment_id": 58813413, "body": "got it - so yeah, same idea as db but doesn&#39;t need to be ironclad, like memcached?"}, {"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "reply_to_user": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 0, "creation_date": 1456173188, "post_id": 35558869, "comment_id": 58814666, "body": "memcached, redis, etc. Or if the callback always goes to the same instance that the request was made from, you can even do that in memory in go."}, {"owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 0, "creation_date": 1456233375, "post_id": 35558869, "comment_id": 58843534, "body": "appengine, so memcache it is! :)"}, {"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "reply_to_user": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 1, "creation_date": 1456233883, "post_id": 35558869, "comment_id": 58843953, "body": "Don&#39;t forget to expire stale states after some time. Something like 5 min should be more than enough."}], "tags": [], "owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "is_accepted": true, "score": 1, "last_activity_date": 1456159349, "last_edit_date": 1456159349, "creation_date": 1456158765, "answer_id": 35558869, "question_id": 35558166, "link": "https://stackoverflow.com/questions/35558166/when-to-randomize-auth-code-state-in-oauth2/35558869#35558869", "title": "When to randomize auth code/state in oauth2?", "body": "<blockquote>\n  <p>state</p>\n  \n  <p>RECOMMENDED.  An opaque value used by the client to maintain\n     state between the request and callback.  The authorization\n     server includes this value when redirecting the user-agent back\n     to the client.  The parameter SHOULD be used for preventing\n     cross-site request forgery as described in Section 10.12.</p>\n  \n  <p><a href=\"http://tools.ietf.org/html/rfc6749\" rel=\"nofollow\">RFC 6749</a></p>\n</blockquote>\n\n<p>You use <code>state</code> to identify that the callback from the authorization server matches the request sent. If there wasn't <code>state</code> a attacker could just call your callback url with a random access token that you didn't request. With <code>state</code> you know that the called callback is in response to the request you made.</p>\n\n<p>So you randomize <code>state</code> per request that you sent and track it until you receive the matching callback. It can be anything you want as long as it can't be guessed.</p>\n\n<p>A simple approach would be leveraging <code>rand.Reader</code> and base64 encoding the result:</p>\n\n<pre><code>func state(n int) (string, error) {\n    data := make([]byte, n)\n    if _, err := io.ReadFull(rand.Reader, data); err != nil {\n        return \"\", err\n    }\n    return base64.StdEncoding.EncodeToString(data), nil\n}\n</code></pre>\n"}], "owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 934, "favorite_count": 0, "accepted_answer_id": 35558869, "answer_count": 1, "score": 1, "last_activity_date": 1456159349, "creation_date": 1456156780, "question_id": 35558166, "link": "https://stackoverflow.com/questions/35558166/when-to-randomize-auth-code-state-in-oauth2", "title": "When to randomize auth code/state in oauth2?", "body": "<p>According to the docs at <a href=\"https://www.godoc.org/golang.org/x/oauth2#Config.AuthCodeURL\" rel=\"nofollow\">https://www.godoc.org/golang.org/x/oauth2#Config.AuthCodeURL</a> </p>\n\n<blockquote>\n  <p>...State is a token to protect the user from CSRF attacks. You must always provide a non-zero string...</p>\n</blockquote>\n\n<p>and at <a href=\"http://tools.ietf.org/html/rfc6749#section-10.12\" rel=\"nofollow\">http://tools.ietf.org/html/rfc6749#section-10.12</a></p>\n\n<blockquote>\n  <p>...any request sent to the redirection URI endpoint to include a value that binds the request...</p>\n</blockquote>\n\n<p>Yet this is specifically at the part in the flow when there is no session data, i.e. the user has not logged in and the auth code is only generated upon showing the anonymous page.</p>\n\n<p>How then can this value be randomized and compared upon callback? Is it a static value randomized per server?</p>\n"}, {"tags": ["json", "go", "struct", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 381, "user_id": 3213604, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/46a017c4501ae00ae10dcf4c1f373665?s=128&d=identicon&r=PG&f=1", "display_name": "user3213604", "link": "https://stackoverflow.com/users/3213604/user3213604"}, "edited": false, "score": 0, "creation_date": 1456157629, "post_id": 35558133, "comment_id": 58805082, "body": "The error i get is: &#39;Cannot unmarshal number into Go value of type string&#39;  should I use an array of map of string to X instead?  (trying that code)... Will comment here whether it works."}, {"owner": {"reputation": 381, "user_id": 3213604, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/46a017c4501ae00ae10dcf4c1f373665?s=128&d=identicon&r=PG&f=1", "display_name": "user3213604", "link": "https://stackoverflow.com/users/3213604/user3213604"}, "edited": false, "score": 0, "creation_date": 1456158316, "post_id": 35558133, "comment_id": 58805578, "body": "My error was related to the structure X =&gt; which contained a few &#39;numbers&#39; instead of strings&#39; and hence the failures.  The map solution you provided @MuffinTop, works exactly as expected.  Thank you."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 381, "user_id": 3213604, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/46a017c4501ae00ae10dcf4c1f373665?s=128&d=identicon&r=PG&f=1", "display_name": "user3213604", "link": "https://stackoverflow.com/users/3213604/user3213604"}, "edited": false, "score": 0, "creation_date": 1456158898, "post_id": 35558133, "comment_id": 58805998, "body": "If the JSON contains numbers, then declare the corresponding struct fields using a numeric type (int, float64, ...)."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1456156707, "creation_date": 1456156707, "answer_id": 35558133, "question_id": 35558039, "link": "https://stackoverflow.com/questions/35558039/how-to-unmarshal-json-with-dynamic-key-which-cant-be-captured-as-a-json-in-st/35558133#35558133", "title": "How to Unmarshal jSON with dynamic key which can&#39;t be captured as a `json` in struct: GOlang", "body": "<p>Use a map:</p>\n\n<pre><code>var m map[string]X\nerr := json.Unmarshal([]byte(jsnStr), &amp;m)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/LgjMCMPr1N\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 381, "user_id": 3213604, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/46a017c4501ae00ae10dcf4c1f373665?s=128&d=identicon&r=PG&f=1", "display_name": "user3213604", "link": "https://stackoverflow.com/users/3213604/user3213604"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1858, "favorite_count": 1, "closed_date": 1562744690, "accepted_answer_id": 35558133, "answer_count": 1, "score": 3, "last_activity_date": 1456156707, "creation_date": 1456156427, "question_id": 35558039, "link": "https://stackoverflow.com/questions/35558039/how-to-unmarshal-json-with-dynamic-key-which-cant-be-captured-as-a-json-in-st", "closed_reason": "Duplicate", "title": "How to Unmarshal jSON with dynamic key which can&#39;t be captured as a `json` in struct: GOlang", "body": "<p>I have this struct defined:</p>\n\n<pre><code>type X struct {\n A string `json:\"a_known_string\"`\n B string `json:\"b_known_string\"`\n}\n</code></pre>\n\n<p>This sample JSON:</p>\n\n<p>jsnStr := [read in from a file and printed out to confirm]</p>\n\n<p>It is:</p>\n\n<pre><code>{\n \"any string\" : {\n   \"a_known_string\" : \"some value\",\n   \"b_known_string\" : \"another value\" \n }\n}\n</code></pre>\n\n<p>If it was just the struct, I could:</p>\n\n<pre><code>var x X\nerr := json.Unmarshal(jsnStr, &amp;x)\n</code></pre>\n\n<p>But I need to capture that 'any string'.\nHow do I do that please?</p>\n"}, {"tags": ["go", "automated-tests", "http2"], "comments": [{"owner": {"reputation": 4222, "user_id": 2072269, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/xNPjb.png?s=128&g=1", "display_name": "muru", "link": "https://stackoverflow.com/users/2072269/muru"}, "edited": false, "score": 1, "creation_date": 1456156269, "post_id": 35557891, "comment_id": 58804113, "body": "If you&#39;re on go 1.6, support for HTTP/2 to is transparently added to <code>net&#47;http</code> for HTTPS (and, I suppose, consequently to <code>net&#47;http&#47;httptest</code> too)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456156715, "post_id": 35557891, "comment_id": 58804468, "body": "What exactly do you want to do? What are you testing? Like muru said, httptest uses the http package."}, {"owner": {"reputation": 136, "user_id": 2632893, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PHgQM.png?s=128&g=1", "display_name": "Johnson", "link": "https://stackoverflow.com/users/2632893/johnson"}, "edited": false, "score": 1, "creation_date": 1456193455, "post_id": 35557891, "comment_id": 58823024, "body": "Following may help you.<a href=\"http://stackoverflow.com/questions/16154999/how-to-test-http-calls-in-go-using-httptest\">How to test http calls in go using httptest</a>"}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1460219964, "post_id": 35557891, "comment_id": 60644475, "body": "This <a href=\"https://github.com/jochasinga/relay\" rel=\"nofollow noreferrer\">package</a> is built on top of <code>httptest</code> and may interest you."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1461719407, "post_id": 35557891, "comment_id": 61323169, "body": "you are using http, not testing http implements."}], "answers": [{"tags": [], "owner": {"reputation": 3753, "user_id": 451641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811b28e7b085e2e493fd32c5913a1ae8?s=128&d=identicon&r=PG", "display_name": "Frederik Deweerdt", "link": "https://stackoverflow.com/users/451641/frederik-deweerdt"}, "is_accepted": false, "score": 0, "last_activity_date": 1479706962, "creation_date": 1479706962, "answer_id": 40713481, "question_id": 35557891, "link": "https://stackoverflow.com/questions/35557891/can-httptest-be-used-to-test-http-2/40713481#40713481", "title": "Can httptest be used to test HTTP/2?", "body": "<p><a href=\"https://github.com/summerwind/h2spec\" rel=\"nofollow noreferrer\">https://github.com/summerwind/h2spec</a> is a go program that tests whether a server implementation conforms to RFC 7540. It allows to craft individual HTTP/2 frames such as:</p>\n\n<pre><code>    settings := http2.Setting{http2.SettingInitialWindowSize, 0}\n    http2Conn.fr.WriteSettings(settings)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>    var hp http2.HeadersFrameParam\n    hp.StreamID = 1\n    hp.EndStream = false\n    hp.EndHeaders = true\n    hp.BlockFragment = http2Conn.EncodeHeader(hdrs)\n    http2Conn.fr.WriteHeaders(hp)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21084, "user_id": 170931, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WA698.png?s=128&g=1", "display_name": "Just a learner", "link": "https://stackoverflow.com/users/170931/just-a-learner"}, "edited": false, "score": 0, "creation_date": 1545420207, "post_id": 52195424, "comment_id": 94626566, "body": "Do you know if BurpSuite does the same way?"}, {"owner": {"reputation": 119030, "user_id": 16940, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/7fc2db839382b30434539fbc967c498e?s=128&d=identicon&r=PG", "display_name": "Simon_Weaver", "link": "https://stackoverflow.com/users/16940/simon-weaver"}, "reply_to_user": {"reputation": 21084, "user_id": 170931, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WA698.png?s=128&g=1", "display_name": "Just a learner", "link": "https://stackoverflow.com/users/170931/just-a-learner"}, "edited": false, "score": 1, "creation_date": 1545420385, "post_id": 52195424, "comment_id": 94626626, "body": "I\u2019ve never heard of it but I\u2019d imagine anything in between would do the same unless it explicitly says it can handle it. I\u2019d imagine maybe someday fiddler would add http/2 debugging functionality (if they haven\u2019t already). Also everything will still work except for the server push and single connection. So just disable it during testing and use the browser\u2019s network tab to verify push is working."}, {"owner": {"reputation": 21084, "user_id": 170931, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/WA698.png?s=128&g=1", "display_name": "Just a learner", "link": "https://stackoverflow.com/users/170931/just-a-learner"}, "edited": false, "score": 0, "creation_date": 1545420446, "post_id": 52195424, "comment_id": 94626640, "body": "Thanks for the explanation."}], "tags": [], "owner": {"reputation": 119030, "user_id": 16940, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/7fc2db839382b30434539fbc967c498e?s=128&d=identicon&r=PG", "display_name": "Simon_Weaver", "link": "https://stackoverflow.com/users/16940/simon-weaver"}, "is_accepted": false, "score": 1, "last_activity_date": 1536198817, "last_edit_date": 1592644375, "creation_date": 1536198817, "answer_id": 52195424, "question_id": 35557891, "link": "https://stackoverflow.com/questions/35557891/can-httptest-be-used-to-test-http-2/52195424#52195424", "title": "Can httptest be used to test HTTP/2?", "body": "<h3>General testing tip (to avoid frustration)!</h3>\n<p>Don't use Fiddler to test it, it gets in between your browser and the server and breaks the HTTP2 connection.</p>\n<p>No HTTP2 - no push.</p>\n"}], "owner": {"reputation": 1324, "user_id": 1784001, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/446ed58618bcd7c524db204d3e6f89d7?s=128&d=identicon&r=PG", "display_name": "otisonoza", "link": "https://stackoverflow.com/users/1784001/otisonoza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 1, "answer_count": 2, "score": 13, "last_activity_date": 1536198817, "creation_date": 1456155967, "last_edit_date": 1456756241, "question_id": 35557891, "link": "https://stackoverflow.com/questions/35557891/can-httptest-be-used-to-test-http-2", "title": "Can httptest be used to test HTTP/2?", "body": "<p>I'm wondering if <a href=\"https://golang.org/pkg/net/http/httptest/\">this</a> (httptest) package can be used to test HTTP/2 specific features.<br>\nCan anyone point me to some examples maybe?</p>\n\n<p>I'm aware of the tool <a href=\"https://godoc.org/golang.org/x/net/http2/h2i\">h2i</a>, but it's an interactive tool.<br>\nI'm looking for something which is programmable.</p>\n\n<p><strong>EDIT</strong>:<br>\nWhat I'm really looking for is a tool, where for example I can initiate a server push and test it on the client side.<br>\nSo, using this package, how do I have access to the underlying HTTP/2 stuff it uses by default?</p>\n\n<p><strong>EDIT 2:</strong><br>\nFound some examples in the nghttp2 source:\n<a href=\"https://github.com/tatsuhiro-t/nghttp2/tree/master/integration-tests\">https://github.com/tatsuhiro-t/nghttp2/tree/master/integration-tests</a></p>\n\n<p><strong>EDIT 3:</strong>\nFor me it looks like that the package net/http2 isn't meant to be used directly by anyone. I'll experiment with <a href=\"https://github.com/grpc/grpc-go/blob/master/transport/http2_client.go\">this</a> one.</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 4222, "user_id": 2072269, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/xNPjb.png?s=128&g=1", "display_name": "muru", "link": "https://stackoverflow.com/users/2072269/muru"}, "edited": false, "score": 3, "creation_date": 1456152987, "post_id": 35556717, "comment_id": 58801371, "body": "Did you mean <code>models.Horse</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 0, "creation_date": 1456153372, "post_id": 35556788, "comment_id": 58801670, "body": "You are right. Thanks for the tip. BTW, is there any way to use bare <code>Horse</code> in the imported file to avoid attaching <code>models.</code> to it each time?"}, {"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "reply_to_user": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 0, "creation_date": 1456153650, "post_id": 35556788, "comment_id": 58801904, "body": "Only if they are in the same package. But i see you are grouping your stuff by functionality (i.e. controllers go into package controllers, models into package models, etc.). Why not group by feature? So <code>Horse</code> and your horse controller are both in the package <code>horse</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 2, "creation_date": 1456153792, "post_id": 35556788, "comment_id": 58802024, "body": "@Karlom: you can use <code>.</code> import name to bring all the identifiers into the same namespace, but don&#39;t do that -- it&#39;s generally accepted to be bad practice."}, {"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 0, "creation_date": 1456153818, "post_id": 35556788, "comment_id": 58802047, "body": "Well, I&#39;m trying to forge the app into  a MVC pattern, but apparently it needs lots of plumbing..."}, {"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456153878, "post_id": 35556788, "comment_id": 58802106, "body": "@JimB is correct, there is a way. But don&#39;t use it."}, {"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "reply_to_user": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 0, "creation_date": 1456154129, "post_id": 35556788, "comment_id": 58802317, "body": "@Karlom Even when you use a MVC pattern there is no reason to group by functionality instead of feature."}, {"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 0, "creation_date": 1456154477, "post_id": 35556788, "comment_id": 58802637, "body": "@Danilo, not sure how to follow your suggestion. When I use <code>horse</code> instead of both <code>controllers</code> and <code>models</code> I get  cannot find package &quot;horseapp/horse&quot; in any of ...$GOROOT...$GOPATH). So I guess you suggest each package to be a self contained MVC. right?"}, {"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "reply_to_user": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 0, "creation_date": 1456154614, "post_id": 35556788, "comment_id": 58802743, "body": "@Karlom: yes. Put your horse controller and your horse model in the same folder. Call the package horse. Do that for each feature you have. That way everything related to one feature is in the same folder/package."}], "tags": [], "owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "is_accepted": true, "score": 2, "last_activity_date": 1456153023, "creation_date": 1456153023, "answer_id": 35556788, "question_id": 35556717, "link": "https://stackoverflow.com/questions/35556717/imported-struct-from-other-package-is-undefined/35556788#35556788", "title": "Imported struct from other package is undefined", "body": "<p>Use </p>\n\n<pre><code>var horseStore = make(map[string]models.Horse)\n</code></pre>\n\n<p>When accessing an identifier from another package you will always have to prefix it with the packages name and a dot: <code>package.Identifier</code></p>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1145, "favorite_count": 0, "accepted_answer_id": 35556788, "answer_count": 1, "score": 0, "last_activity_date": 1456153023, "creation_date": 1456152855, "question_id": 35556717, "link": "https://stackoverflow.com/questions/35556717/imported-struct-from-other-package-is-undefined", "title": "Imported struct from other package is undefined", "body": "<p>Here is my noobish problem. I have this struct in my <code>models/model.go</code></p>\n\n<pre><code>    package models\n\n    import (\n      \"time\"\n      \"gopkg.in/mgo.v2/bson\"\n\n    )\n\n    type Horse struct {\n        Id    bson.ObjectId `bson:\"_id,omitempty\"`\n        Title       string\n        Description string\n        CreatedOn   time.Time\n        Creator     string\n        Visits  int\n        Score       int\n\n    }\n</code></pre>\n\n<p>And in my <code>controllers/crud.go</code> I'm trying to use <code>Horse</code> struct</p>\n\n<pre><code>package controllers\n\nimport (\n  \"html/template\"\n  \"log\"\n  \"net/http\"\n  \"horseapp/models\"\n)\n[...]\nvar horseStore = make(map[string]Horse) //This raises undefined error\n</code></pre>\n\n<p>But I get <code>undefined: Horse</code> when I <code>go install horseapp</code>.</p>\n\n<p>What is wrong here and how to fix it?</p>\n"}, {"tags": ["hash", "go", "bcrypt"], "comments": [{"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 0, "creation_date": 1456151882, "post_id": 35556253, "comment_id": 58800544, "body": "Could you provide an example of the contents of <code>user.Password</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456151883, "post_id": 35556253, "comment_id": 58800545, "body": "Have you compared the bytes from the DB to ensure it&#39;s getting updated properly, and not modified in any way?"}, {"owner": {"reputation": 6480, "user_id": 1152182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Sp4wK.jpg?s=128&g=1", "display_name": "Melih Mucuk", "link": "https://stackoverflow.com/users/1152182/melih-mucuk"}, "reply_to_user": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 0, "creation_date": 1456152188, "post_id": 35556253, "comment_id": 58800746, "body": "for example, here is hashed password from db <code>$2a$10$rqHJJTHsxMbtX&#47;5ZjG1mFuWyYbUDW1PLbfwQRN0uChwes38c&#47;0m3e</code>&zwnj;&#8203;, this generated from <code>123456</code>. Then I compare hashed password and plain password which is <code>123456</code> @Danilo @JimB"}, {"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 0, "creation_date": 1456152446, "post_id": 35556253, "comment_id": 58800948, "body": "That hash doesn&#39;t work for me either."}, {"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 1, "creation_date": 1456152749, "post_id": 35556253, "comment_id": 58801192, "body": "<code>Register</code> takes a pointer to <code>User</code>, however when calling <code>i.DB.Create</code> you are using a pointer to a pointer. Is that on purpose?"}, {"owner": {"reputation": 225, "user_id": 1507342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5165ad3df4cd59728ea24317698f15bc?s=128&d=identicon&r=PG&f=1", "display_name": "d1str0", "link": "https://stackoverflow.com/users/1507342/d1str0"}, "edited": false, "score": 0, "creation_date": 1456166408, "post_id": 35556253, "comment_id": 58810838, "body": "<a href=\"https://gist.github.com/701012f1adc5c18b3076\" rel=\"nofollow noreferrer\">gist.github.com/701012f1adc5c18b3076</a> This works for me. Maybe your initial hash is bad for some reason."}, {"owner": {"reputation": 21225, "user_id": 575765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/877fab7e16fb4639a88aa48496b5e8cb?s=128&d=identicon&r=PG", "display_name": "martinstoeckli", "link": "https://stackoverflow.com/users/575765/martinstoeckli"}, "edited": false, "score": 0, "creation_date": 1456418560, "post_id": 35556253, "comment_id": 58948094, "body": "An often done mistake is the size of the database field, it should be <code>varchar(60)</code> or bigger to be future proof. The hash you provided looks ok, is it really extracted from the database? Another thing to check for are preceeding or trailing white spaces in the password."}, {"owner": {"reputation": 6480, "user_id": 1152182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Sp4wK.jpg?s=128&g=1", "display_name": "Melih Mucuk", "link": "https://stackoverflow.com/users/1152182/melih-mucuk"}, "reply_to_user": {"reputation": 21225, "user_id": 575765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/877fab7e16fb4639a88aa48496b5e8cb?s=128&d=identicon&r=PG", "display_name": "martinstoeckli", "link": "https://stackoverflow.com/users/575765/martinstoeckli"}, "edited": false, "score": 0, "creation_date": 1456418763, "post_id": 35556253, "comment_id": 58948236, "body": "size of db field is <code>varchar(255)</code> and there aren&#39;t whitespaces in the password. @martinstoeckli"}, {"owner": {"reputation": 21225, "user_id": 575765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/877fab7e16fb4639a88aa48496b5e8cb?s=128&d=identicon&r=PG", "display_name": "martinstoeckli", "link": "https://stackoverflow.com/users/575765/martinstoeckli"}, "edited": false, "score": 0, "creation_date": 1456419086, "post_id": 35556253, "comment_id": 58948464, "body": "Did you generate a new user since? The provided hash does not match the password <code>123456</code>."}, {"owner": {"reputation": 6480, "user_id": 1152182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Sp4wK.jpg?s=128&g=1", "display_name": "Melih Mucuk", "link": "https://stackoverflow.com/users/1152182/melih-mucuk"}, "edited": false, "score": 0, "creation_date": 1456420495, "post_id": 35556253, "comment_id": 58949487, "body": "yes, thats the problem. I registred new user with <code>123456</code> then user cannot login with this password."}, {"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 0, "creation_date": 1456701403, "post_id": 35556253, "comment_id": 59056914, "body": "@MelihMucuk the hash you provided <code>$2a$10$rqHJJTHsxMbtX&#47;5ZjG1mFuWyYbUDW1PLbfwQRN0uChwes38c&#47;0m3e</code> actually matches an empty password! When you are calling <code>Register</code> are you sure that <code>user.Password</code> contains the actual password before you feed it to <code>encryptPassword</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2312578"}, "edited": false, "score": 1, "creation_date": 1487620285, "post_id": 35556253, "comment_id": 71856915, "body": "Note for everyone reading this. I had a similar problem. Don&#39;t compare the hashed password from the DB with the HASH of the password. Compare it with the plain password. The interface of []byte and []byte was confusing me."}], "answers": [{"comments": [{"owner": {"reputation": 6480, "user_id": 1152182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Sp4wK.jpg?s=128&g=1", "display_name": "Melih Mucuk", "link": "https://stackoverflow.com/users/1152182/melih-mucuk"}, "edited": false, "score": 0, "creation_date": 1456729862, "post_id": 35690283, "comment_id": 59064596, "body": "<code>user.Password</code> comes from db, so it&#39;s already hashed password."}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "reply_to_user": {"reputation": 6480, "user_id": 1152182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Sp4wK.jpg?s=128&g=1", "display_name": "Melih Mucuk", "link": "https://stackoverflow.com/users/1152182/melih-mucuk"}, "edited": false, "score": 0, "creation_date": 1456752890, "post_id": 35690283, "comment_id": 59078128, "body": "@MelihMucuk are you sure it&#39;s bashing the right thing? Did you try to log what the value is before it gets hashed?"}], "tags": [], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "is_accepted": false, "score": 3, "last_activity_date": 1456706950, "creation_date": 1456706950, "answer_id": 35690283, "question_id": 35556253, "link": "https://stackoverflow.com/questions/35556253/crypto-bcrypt-hashedpassword-is-not-the-hash-of-the-given-password/35690283#35690283", "title": "crypto/bcrypt: hashedPassword is not the hash of the given password", "body": "<p>I cannot tell which is which, but in your compare function, ensure that you have the variables in the right place.</p>\n\n<pre><code>bcrypt.CompareHashAndPassword([]byte(user.Password), []byte(password))\n           Must be the already hashed PW ^              ^ Plain Text Password to compare\n</code></pre>\n\n<p>Also ensure you're actually getting something to hash, you could be getting a blank password but not realizing it because the hash will still look full.</p>\n"}, {"comments": [{"owner": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "edited": false, "score": 0, "creation_date": 1456793417, "post_id": 35702686, "comment_id": 59102048, "body": "Yes, you can verify this easily with <code>fmt.Println(bcrypt.CompareHashAndPassword([]byte(&quot;$2a$10$rqH&zwnj;&#8203;JJTHsxMbtX&#47;5ZjG1mFuW&zwnj;&#8203;yYbUDW1PLbfwQRN0uChw&zwnj;&#8203;es38c&#47;0m3e&quot;), []byte{}))</code> which just prints <code>nil</code>. You should add a check to <code>encryptPassword</code> to make sure this doesn&#39;t happen."}], "tags": [], "owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "is_accepted": false, "score": 8, "last_activity_date": 1456757835, "creation_date": 1456757835, "answer_id": 35702686, "question_id": 35556253, "link": "https://stackoverflow.com/questions/35556253/crypto-bcrypt-hashedpassword-is-not-the-hash-of-the-given-password/35702686#35702686", "title": "crypto/bcrypt: hashedPassword is not the hash of the given password", "body": "<p>My bet is that <code>user.Password</code> is empty in your <code>Register</code> function before you pass it to <code>encryptPassword</code> thus leading to hashes on empty passwords like the one you provided (<code>$2a$10$rqHJJTHsxMbtX/5ZjG1mFuWyYbUDW1PLbfwQRN0uChwes38c/0m3e</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 165, "user_id": 6637798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5ab7afc2c4d819ee7c80b5aaca7662c?s=128&d=identicon&r=PG&f=1", "display_name": "howard", "link": "https://stackoverflow.com/users/6637798/howard"}, "is_accepted": false, "score": 1, "last_activity_date": 1613274992, "creation_date": 1613274992, "answer_id": 66192322, "question_id": 35556253, "link": "https://stackoverflow.com/questions/35556253/crypto-bcrypt-hashedpassword-is-not-the-hash-of-the-given-password/66192322#66192322", "title": "crypto/bcrypt: hashedPassword is not the hash of the given password", "body": "<p>My mistake was thinking that it compared two bcrypt hashedpasswords, rather than a hashedpassword and your unencrypted password converted to binary -- hope that helps someone out there!</p>\n"}], "owner": {"reputation": 6480, "user_id": 1152182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Sp4wK.jpg?s=128&g=1", "display_name": "Melih Mucuk", "link": "https://stackoverflow.com/users/1152182/melih-mucuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2915, "favorite_count": 0, "answer_count": 3, "score": 11, "last_activity_date": 1613274992, "creation_date": 1456151523, "last_edit_date": 1456183334, "question_id": 35556253, "link": "https://stackoverflow.com/questions/35556253/crypto-bcrypt-hashedpassword-is-not-the-hash-of-the-given-password", "title": "crypto/bcrypt: hashedPassword is not the hash of the given password", "body": "<p>I encrypt user's password and save to db. Then to user login, compare hashed password and plain password, I'm getting <code>crypto/bcrypt: hashedPassword is not the hash of the given password</code> error. Whats wrong ?</p>\n\n<pre><code>func encryptPassword(password string) (string, error) {\n    bytePass := []byte(password)\n    hashedPassword, err := bcrypt.GenerateFromPassword(bytePass, bcrypt.DefaultCost)\n    if err != nil {\n        log.Printf(\"ERROR:EncryptPassword: %s\", err.Error())\n    }\n    return string(hashedPassword), err\n}\n\nfunc (i *Impl) Register(user User) bool {\n    hashedPass, err := encryptPassword(user.Password)\n    if err != nil {\n        return false\n    }\n\n    user.Password = hashedPass\n\n    if err := i.DB.Create(&amp;user).Error; err != nil {\n        log.Printf(\"ERROR:Register: %s\", err.Error())\n        return false\n    }\n    return true\n}\n\nfunc (i *Impl) Login(email string, password string) (User, error) {\n    var user User\n    i.DB.Where(\"email = ?\", email).First(&amp;user)   \n\n    err := bcrypt.CompareHashAndPassword([]byte(user.Password), []byte(password))\n    if err != nil {\n        log.Printf(\"ERROR:Login: %s\", err.Error())\n        return User{}, err\n    }\n\n    return user, err\n}\n</code></pre>\n"}, {"tags": ["windows", "macos", "logging", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1456150770, "post_id": 35555692, "comment_id": 58799808, "body": "1. Your assumption <i>is</i> wrong, log.Printf does not do any &quot;Windows magic&quot; and terminates lines with the appropriate \\n. 2. Just use some normal program on Windows to read the logfile, &quot;normal&quot; in the sense that it displays \\n as line endings (e.g. Notepad++) and keep away from broken stuff which requires \\r\\n as a line ending. Nothing is wrong with log.Printf or your code."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1456150803, "post_id": 35555692, "comment_id": 58799841, "body": "the <code>log</code> and <code>fmt</code> packages don&#39;t change line ending by platform (BTW, <code>\\r</code> alone was really only used on old macs and a few other long gone systems). It&#39;s better to use a text editor that is capable of reading files without the carriage return."}, {"owner": {"reputation": 2038, "user_id": 1034658, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d3fc5887a2f39f2e0c8989d39ce5e6f9?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/1034658/bharat"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1456159641, "post_id": 35555692, "comment_id": 58806543, "body": "@volker, Thank you.  I installed Notepad++ and it reads my log file fine.  Out with Notepad and in with Notepad++.  I have been away from Windows for a long time, so am a bit rusty on it."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1456171209, "last_edit_date": 1456171209, "creation_date": 1456151622, "answer_id": 35556287, "question_id": 35555692, "link": "https://stackoverflow.com/questions/35555692/cross-platform-logging-in-golang/35556287#35556287", "title": "cross platform logging in Golang", "body": "<p>As noted, the <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow\"><code>fmt</code></a> package always uses <code>\\n</code> as the newline \"sequence\" regardless of the OS (on Windows too). The <a href=\"https://golang.org/pkg/log/\" rel=\"nofollow\"><code>log</code></a> package uses <code>fmt</code> under the hood, so the same applies to <code>log</code> too. When functions that do not end with <code>...ln()</code> are called (e.g. <code>log.Printf()</code>), a <code>\\n</code> will be printed explicitly as documented at <a href=\"https://golang.org/pkg/log/#Logger.Output\" rel=\"nofollow\"><code>Logger.Output()</code></a> (to which <code>log.Printf()</code> forwards to).</p>\n\n<p>Just deal with <code>\\n</code> as the newline. If you do need to print <code>\\r\\n</code>, you have to handle that manually by appending a <code>\\r</code> character at the end of the format string, e.g.:</p>\n\n<pre><code>log.Printf(\"This will be terminated by CR+LF\\r\") // \\n is appended automatically\n</code></pre>\n\n<p>You may create a wrapper function for it:</p>\n\n<pre><code>func winprintf(format string, a ...interface{}) {\n    log.Printf(format+\"\\r\", a...)\n}\n</code></pre>\n\n<p>Note that this however will only print <code>\\r\\n</code> at the end of the log entry; but if you use <code>\\n</code> inside the format string or the arguments are <code>string</code>s (or will result in a <code>string</code> by calling their <code>String()</code> method) containing <code>\\n</code>, those will not turn into <code>\\r\\n</code> automatically. You may use <a href=\"https://golang.org/pkg/strings/#Replace\" rel=\"nofollow\"><code>strings.Replace()</code></a> to handle those too.</p>\n"}], "owner": {"reputation": 2038, "user_id": 1034658, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d3fc5887a2f39f2e0c8989d39ce5e6f9?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/1034658/bharat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1058, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1456171209, "creation_date": 1456149949, "question_id": 35555692, "link": "https://stackoverflow.com/questions/35555692/cross-platform-logging-in-golang", "title": "cross platform logging in Golang", "body": "<p>I am developing a Go program on a Mac which has Parallels installed with Windows so that I can test on both platforms.  My program works well.  I can compile a Windows \".exe\" file on my Mac and run it from Windows and it works well except the log file.</p>\n\n<p>I have set the logger to write its output to a file like so:</p>\n\n<pre><code>log.SetOutput(projectsLog)\n</code></pre>\n\n<p>Where projectsLog is declare above it as shown below:</p>\n\n<pre><code>projectsLog *os.File\n</code></pre>\n\n<p>I am using log.Printf statements since I want formatted output.  An example is shown below:</p>\n\n<pre><code>log.Printf(\"Error: wrong Hra Class value %s in row %v for project/path %s\", hraClass, (rowNum + 1), testDir)\n</code></pre>\n\n<p>This is working great on Mac.  Each line using log.Printf is logged on a separate line, but on Windows the line breaks do not show and I get one lines without line breaks.  I am well aware of \"\\r\" and \"\\r\\n\" difference between unix and windows.  But I thought that log.Printf will behave appropriately based on the platform it is run on?</p>\n\n<p>If my assumption is wrong then what are some of the options that I have to make sure that the log file is readable on Windows?  If I can, I do not want to pass flags, e.g., -platform windows or some such thing.  Can this be handled in a transparent manner?</p>\n"}, {"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 4, "creation_date": 1456143983, "post_id": 35552868, "comment_id": 58795086, "body": "Why aren&#39;t you using the default json decoder from the standard library? It does everything for you already."}], "answers": [{"tags": [], "owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "is_accepted": false, "score": 3, "last_activity_date": 1456145440, "creation_date": 1456145440, "answer_id": 35554189, "question_id": 35552868, "link": "https://stackoverflow.com/questions/35552868/how-to-set-array-value-to-a-field-in-golang-using-reflect/35554189#35554189", "title": "How to set array value to a field in golang using reflect?", "body": "<p>You can use the json package for that (it uses reflect internally):</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Config struct {\n    Address []string\n    Name    string\n}\n\nvar someJson = []byte(`{\n   \"Address\": [\"xx.xx.xx.xx\",\"xx.xx.xx.xx\"],\n   \"Name\":\"Name\"\n}`)\n\nfunc main() {\n    var config Config\n    err := json.Unmarshal(someJson, &amp;config)\n    if err != nil {\n        fmt.Println(\"error: \", err)\n    }\n    fmt.Printf(\"%v\", config)\n}\n</code></pre>\n"}], "owner": {"reputation": 2432, "user_id": 1089226, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/06a2bf4d1a7d9eed5a2ed61c7440c2bf?s=128&d=identicon&r=PG", "display_name": "Poppy", "link": "https://stackoverflow.com/users/1089226/poppy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 858, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456145440, "creation_date": 1456141793, "question_id": 35552868, "link": "https://stackoverflow.com/questions/35552868/how-to-set-array-value-to-a-field-in-golang-using-reflect", "title": "How to set array value to a field in golang using reflect?", "body": "<p>I have a Struct with following fields </p>\n\n<pre><code>type Config struct {\n        Address[]string\n        Name string\n}\n</code></pre>\n\n<p>I am reading the values for this Config from a file in JSON format </p>\n\n<pre><code>{\n   \"Address\": [\"xx.xx.xx.xx\",\"xx.xx.xx.xx\"],\n   \"Name\":\"Name\"\n}\n</code></pre>\n\n<p>I have used Reflect to identify the type and set its value to Config.I am able to set the value of Name field using \n<strong>func (v Value) SetString(x string)</strong> which is an inbuilt method in reflect. Is there a way to set []string values directly to a field? Please help.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1456138820, "post_id": 35551634, "comment_id": 58791802, "body": "It&#39;s not too clear what you aim to resolve. Can you reformulate your question?"}, {"owner": {"reputation": 23, "user_id": 5168928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d0b441e299dcef5040efd150815abf77?s=128&d=identicon&r=PG&f=1", "display_name": "Brucea", "link": "https://stackoverflow.com/users/5168928/brucea"}, "reply_to_user": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1456139326, "post_id": 35551634, "comment_id": 58792111, "body": "i need a function to get balances of 2 btc addresses, or to use this libraries <a href=\"https://gowalker.org/github.com/GeertJohan/btcwallet\" rel=\"nofollow noreferrer\">gowalker.org/github.com/GeertJohan/btcwallet</a>"}, {"owner": {"reputation": 23, "user_id": 5168928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d0b441e299dcef5040efd150815abf77?s=128&d=identicon&r=PG&f=1", "display_name": "Brucea", "link": "https://stackoverflow.com/users/5168928/brucea"}, "reply_to_user": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1456139352, "post_id": 35551634, "comment_id": 58792129, "body": "<code>func GetAddressBalance(icmd btcjson.Cmd) (interface{}, *btcjson.Error) func GetAddressesByAccount(icmd btcjson.Cmd) (interface{}, *btcjson.Error) func GetBalance(icmd btcjson.Cmd) (interface{}, *btcjson.Error) </code>"}], "answers": [{"tags": [], "owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "is_accepted": true, "score": 0, "last_activity_date": 1456150700, "creation_date": 1456150700, "answer_id": 35555949, "question_id": 35551634, "link": "https://stackoverflow.com/questions/35551634/find-btc-balance-for-an-address-in-go/35555949#35555949", "title": "Find BTC balance for an address in Go", "body": "<p>You were on the right track. The api returns a json. This can be unmarshalled into a struct (<code>Address</code>). That way you can access everything returned by the api. Do not forget to always check for error codes! Replace <code>some_address</code> with an actual address to get the balance.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc main() {\n    a, err := getAddress(\"some_address\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Println(\"Balance:\", a.Balance)\n}\n\ntype Address struct {\n    Hash                string\n    Balance             int\n    Received            int\n    Send                int\n    UnconfirmedBalance  int `json:\"unconfirmed_balance\"`\n    UnconfirmedReceived int `json:\"unconfirmed_received\"`\n    UnconfirmedSent     int `json:\"unconfirmed_sent\"`\n}\n\nfunc getAddress(addr string) (*Address, error) {\n    resp, err := http.Get(\"https://bitcoin.toshi.io/api/v0/addresses/\" + addr)\n    if err != nil {\n        return nil, err\n    }\n    defer resp.Body.Close()\n\n    if resp.StatusCode != http.StatusOK {\n        return nil, fmt.Errorf(\"Error: %v\", http.StatusText(resp.StatusCode))\n    }\n\n    var address Address\n    decoder := json.NewDecoder(resp.Body)\n    if err := decoder.Decode(&amp;address); err != nil {\n        return nil, err\n    }\n\n    return &amp;address, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5168928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d0b441e299dcef5040efd150815abf77?s=128&d=identicon&r=PG&f=1", "display_name": "Brucea", "link": "https://stackoverflow.com/users/5168928/brucea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1018, "favorite_count": 0, "accepted_answer_id": 35555949, "answer_count": 1, "score": 1, "last_activity_date": 1456150700, "creation_date": 1456138095, "last_edit_date": 1456145835, "question_id": 35551634, "link": "https://stackoverflow.com/questions/35551634/find-btc-balance-for-an-address-in-go", "title": "Find BTC balance for an address in Go", "body": "<p>I need to correct and transform a function, to checking 2 addresses of btc balance, like (addr and addr1 ), and the return is json value, i need to specify im not know very well golang.. need help!</p>\n\n<pre><code>func balance(addr) {\n    var url = \"https://bitcoin.toshi.io/api/v0/addresses/\" + addr\n    response, _ := http.Get(url)\n    defer response.Body.Close()\n    contents, _ := ioutil.ReadAll(response.Body)\n    return contents\n}\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>i need a function to get balances of 2 btc addresses, or to use this libraries <a href=\"https://gowalker.org/github.com/GeertJohan/btcwallet\" rel=\"nofollow\">btcwallet</a>.</p>\n\n<pre><code>func GetAddressBalance(icmd btcjson.Cmd) (interface{}, *btcjson.Error) \nfunc GetAddressesByAccount(icmd btcjson.Cmd) (interface{}, *btcjson.Error) \nfunc GetBalance(icmd btcjson.Cmd) (interface{}, *btcjson.Error) \n</code></pre>\n"}, {"tags": ["templates", "go", "go-templates"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1456135324, "post_id": 35550326, "comment_id": 58789559, "body": "You need to add the functions (i.e. calling <code>t.Funcs</code>) before parsing with <code>ParseFiles</code>. To do this get a fresh template via <code>New()</code>, then add your funcs than parse the files into it. (Untested)"}], "answers": [{"comments": [{"owner": {"reputation": 1303, "user_id": 779404, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1312959fa177c836dc5ecee589dc487f?s=128&d=identicon&r=PG", "display_name": "b0xxed1n", "link": "https://stackoverflow.com/users/779404/b0xxed1n"}, "edited": false, "score": 2, "creation_date": 1456136318, "post_id": 35550730, "comment_id": 58790184, "body": "Thank you, that was very clear. I&#39;m not getting any errors now, but strangely there&#39;s no output. I outputted it to a bytes.Buffer to test that it is indeed empty, and the bytes.Buffer is also empty. Any idea why that might be, or how I can debug this when I have no output or errors?"}, {"owner": {"reputation": 764, "user_id": 1398066, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213b36a51eaf5c87bf8a7db78176770b?s=128&d=identicon&r=PG", "display_name": "P&#233;ter Szakszon", "link": "https://stackoverflow.com/users/1398066/p%c3%a9ter-szakszon"}, "edited": false, "score": 8, "creation_date": 1490551364, "post_id": 35550730, "comment_id": 73150470, "body": "Pass the &quot;struct.tpl&quot; string to the <code>New</code> function. From the doc: Since the templates created by ParseFiles are named by the base names of the argument files, t should usually have the name of one of the (base) names of the files. If it does not, depending on t&#39;s contents before calling ParseFiles, t.Execute may fail. In that case use t.ExecuteTemplate to execute a valid template."}, {"owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "reply_to_user": {"reputation": 764, "user_id": 1398066, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/213b36a51eaf5c87bf8a7db78176770b?s=128&d=identicon&r=PG", "display_name": "P&#233;ter Szakszon", "link": "https://stackoverflow.com/users/1398066/p%c3%a9ter-szakszon"}, "edited": false, "score": 3, "creation_date": 1544205274, "post_id": 35550730, "comment_id": 94206727, "body": "@P&#233;terSzakszon your comment is actually required. Otherwise, you&#39;ll get an error that <code>template: : &quot;&quot; is an incomplete or empty template</code>"}, {"owner": {"reputation": 79, "user_id": 5586782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae344cddf183e5f9659d8c73490bb6d5?s=128&d=identicon&r=PG", "display_name": "gumelaragum", "link": "https://stackoverflow.com/users/5586782/gumelaragum"}, "edited": false, "score": 0, "creation_date": 1604213267, "post_id": 35550730, "comment_id": 114274357, "body": "<code>template.New(&quot;&quot;)</code>, &quot;&quot; need to be defined, if not this will make error <code>template: : &quot;&quot; is an incomplete or empty template</code>, and the Name must equal to filename"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 79, "user_id": 5586782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae344cddf183e5f9659d8c73490bb6d5?s=128&d=identicon&r=PG", "display_name": "gumelaragum", "link": "https://stackoverflow.com/users/5586782/gumelaragum"}, "edited": false, "score": 0, "creation_date": 1604222039, "post_id": 35550730, "comment_id": 114275906, "body": "@gumelaragum Yes, if you parse the template text from a <code>string</code>. But in my examples I don&#39;t do that, I call <code>Template.ParseFiles()</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 16, "last_activity_date": 1523380687, "last_edit_date": 1523380687, "creation_date": 1456135423, "answer_id": 35550730, "question_id": 35550326, "link": "https://stackoverflow.com/questions/35550326/golang-templates-and-passing-funcs-to-template/35550730#35550730", "title": "Golang templates (and passing funcs to template)", "body": "<p>Custom functions need to be registered before parsing the templates, else the parser would not be able to tell whether an identifier is a valid function name or not. Templates are designed to be statically analyzable, and this is a requirement to that.</p>\n\n<p>You can first create a new, undefined template with <a href=\"https://golang.org/pkg/text/template/#New\" rel=\"noreferrer\"><code>template.New()</code></a>, and besides the <a href=\"https://golang.org/pkg/text/template/#ParseFiles\" rel=\"noreferrer\"><code>template.ParseFiles()</code></a> <em>function</em>, the <a href=\"https://golang.org/pkg/text/template/#Template\" rel=\"noreferrer\"><code>template.Template</code></a> type (returned by <code>New()</code>) also has a <a href=\"https://golang.org/pkg/text/template/#Template.ParseFiles\" rel=\"noreferrer\"><code>Template.ParseFiles()</code></a> <em>method</em>, you can call that.</p>\n\n<p>Something like this:</p>\n\n<pre><code>t, err := template.New(\"\").Funcs(template.FuncMap{\n    \"makeGoName\": makeGoName,\n    \"makeDBName\": makeDBName,\n}).ParseFiles(\"templates/struct.tpl\")\n</code></pre>\n\n<p>Note that the <code>template.ParseFiles()</code> function also calls <code>template.New()</code> under the hood, passing the name of the first file as the template name.</p>\n\n<p>Also <a href=\"https://golang.org/pkg/text/template/#Template.Execute\" rel=\"noreferrer\"><code>Template.Execute()</code></a> returns an <a href=\"https://golang.org/pkg/builtin/#error\" rel=\"noreferrer\"><code>error</code></a>, print that to see if no output is generated, e.g.:</p>\n\n<pre><code>if err := t.Execute(os.Stdout, data); err != nil {\n    fmt.Println(err)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1267, "user_id": 10463261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5f36968922a93930e4ae8259f8cacaf?s=128&d=identicon&r=PG", "display_name": "Daniel Morell", "link": "https://stackoverflow.com/users/10463261/daniel-morell"}, "is_accepted": false, "score": 1, "last_activity_date": 1598139463, "creation_date": 1598139463, "answer_id": 63542081, "question_id": 35550326, "link": "https://stackoverflow.com/questions/35550326/golang-templates-and-passing-funcs-to-template/63542081#63542081", "title": "Golang templates (and passing funcs to template)", "body": "<p>When registering custom functions for your template and using <code>ParseFiles()</code> you need to specify the name of the template when instantiating it and executing it. You also need to call <code>ParseFiles()</code> after you call <code>Funcs()</code>.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>// Create a named template with custom functions\nt, err := template.New(&quot;struct.tpl&quot;).Funcs(template.FuncMap{\n    &quot;makeGoName&quot;: makeGoName,\n    &quot;makeDBName&quot;: makeDBName,\n}).ParseFiles(&quot;templates/struct.tpl&quot;) // Parse the template file\nif err != nil {\n    errorQuit(err)\n}\n\n// Execute the named template\nerr = t.ExecuteTemplate(os.Stdout, &quot;struct.tpl&quot;, data)\nif err != nil {\n    errorQuit(err)\n}\n</code></pre>\n<p>When working with named templates the name is the filename without the directory path e.g. <code>struct.tpl</code> not <code>templates/struct.tpl</code>. So the name in <code>New()</code> and <code>ExecuteTemplate()</code> should be the string <code>struct.tpl</code>.</p>\n"}], "owner": {"reputation": 1303, "user_id": 779404, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1312959fa177c836dc5ecee589dc487f?s=128&d=identicon&r=PG", "display_name": "b0xxed1n", "link": "https://stackoverflow.com/users/779404/b0xxed1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8789, "favorite_count": 1, "accepted_answer_id": 35550730, "answer_count": 2, "score": 9, "last_activity_date": 1598139463, "creation_date": 1456134309, "last_edit_date": 1517220252, "question_id": 35550326, "link": "https://stackoverflow.com/questions/35550326/golang-templates-and-passing-funcs-to-template", "title": "Golang templates (and passing funcs to template)", "body": "<p>I'm getting an error when I try and access a function I'm passing to my template: </p>\n\n<pre><code>Error: template: struct.tpl:3: function \"makeGoName\" not defined\n</code></pre>\n\n<p>Can anyone please let me know what I'm doing wrong?</p>\n\n<p>Template file (struct.tpl):</p>\n\n<pre><code>type {{.data.tableName}} struct {\n  {{range $key, $value := .data.tableData}}\n  {{makeGoName $value.colName}} {{$value.colType}} `db:\"{{makeDBName $value.dbColName}},json:\"{{$value.dbColName}}\"`\n  {{end}}\n}\n</code></pre>\n\n<p>Calling file:</p>\n\n<pre><code>type tplData struct {\n    tableName string\n    tableData interface{}\n}\n\nfunc doStuff() {\n    t, err := template.ParseFiles(\"templates/struct.tpl\")\n    if err != nil {\n        errorQuit(err)\n    }\n\n    t = t.Funcs(template.FuncMap{\n        \"makeGoName\": makeGoName,\n        \"makeDBName\": makeDBName,\n    })\n\n    data := tplData{\n        tableName: tableName,\n        tableData: tableInfo,\n    }\n\n    t.Execute(os.Stdout, data)\n}\n\nfunc makeGoName(name string) string {\n    return name\n}\n\nfunc makeDBName(name string) string {\n    return name\n}\n</code></pre>\n\n<p>This is for a program that generates struct boilerplate code (in case anyone is wondering why I'm doing that in my template).</p>\n"}, {"tags": ["http", "go", "server"], "comments": [{"owner": {"reputation": 7731, "user_id": 1614378, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/lOzxR.png?s=128&g=1", "display_name": "dieter", "link": "https://stackoverflow.com/users/1614378/dieter"}, "edited": false, "score": 2, "creation_date": 1456134311, "post_id": 35550189, "comment_id": 58788877, "body": "print the request uri to see additional requests sent from your browser."}, {"owner": {"reputation": 358, "user_id": 7296857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda7320a4b822f1f388b5996f6f4f00c?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/7296857/user"}, "edited": false, "score": 0, "creation_date": 1542630249, "post_id": 35550189, "comment_id": 93624809, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/33432192/handlefunc-being-called-twice\">HandleFunc being called twice</a>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 13, "last_activity_date": 1460461016, "last_edit_date": 1460461016, "creation_date": 1456134032, "answer_id": 35550225, "question_id": 35550189, "link": "https://stackoverflow.com/questions/35550189/why-this-simple-web-server-is-called-even-number-times/35550225#35550225", "title": "Why this simple web server is called even number times?", "body": "<p>It is because every incoming request is routed to your <code>HelloWorld()</code> handler function, and the browser makes multiple calls under the hood, specifically to <code>/favicon.ico</code>.</p>\n\n<p>And since your web server does not send back a valid favicon, it will request it again when you refresh the page in the browser.</p>\n\n<p>Try it with Chrome: open the Developer tools (<kbd>CTRL+SHIFT+I</kbd>), and choose the \"Network\" tab. Hit refresh, and you will see 2 new entries:</p>\n\n<pre><code>Name          Status   Type\n--------------------------------------------------------\nlocalhost     200      document\nfavicon.ico   200      text/plain\n</code></pre>\n\n<p>Since your counter starts with <code>0</code> (default value for type <code>int</code>), you increment it once and you send back <code>1</code>. Then the request for <code>favicon.ico</code> increments it again (<code>2</code>), but the result is not displayed. Then if you refresh, it gets incremented again to <code>3</code> and you send that back, etc.</p>\n\n<p>Also note that multiple goroutines can serve requests concurrently, so your solution has a race. You should synchronize access to the <code>calls</code> variable, or use the <a href=\"https://golang.org/pkg/sync/atomic/\" rel=\"noreferrer\"><code>sync/atomic</code></a> package to increment the counter safely, for example:</p>\n\n<pre><code>var calls int64\n\nfunc HelloWorld(w http.ResponseWriter, r *http.Request) {\n    count := atomic.AddInt64(&amp;calls, 1)\n    fmt.Fprintf(w, \"You've called me %d times\", count)\n}\n</code></pre>\n\n<p>A simple \"fix\" to achieve what you want would be to check the request path, and if it is not the root <code>\"/\"</code>, don't increment, e.g.:</p>\n\n<pre><code>func HelloWorld(w http.ResponseWriter, r *http.Request) {\n    if r.URL.Path != \"/\" {\n        return\n    }\n    count := atomic.AddInt64(&amp;calls, 1)\n    fmt.Fprintf(w, \"You've called me %d times\", count)\n}\n</code></pre>\n\n<p>You may also choose to only exclude requests for <code>favicon.ico</code>, e.g.:</p>\n\n<pre><code>if r.URL.Path == \"/favicon.ico\" {\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 6591, "user_id": 2185472, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/05ef4480505adfa05516719b865e22aa?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2185472/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 1, "accepted_answer_id": 35550225, "answer_count": 1, "score": 11, "last_activity_date": 1460461016, "creation_date": 1456133940, "last_edit_date": 1456135558, "question_id": 35550189, "link": "https://stackoverflow.com/questions/35550189/why-this-simple-web-server-is-called-even-number-times", "title": "Why this simple web server is called even number times?", "body": "<p>I'm trying to learn Go web programming, and here is a simple web server: it prints out the times being called.</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"net/http\"\n)\n\nvar calls int\n\n// HelloWorld print the times being called.\nfunc HelloWorld(w http.ResponseWriter, r *http.Request){\n    calls++\n    fmt.Fprintf(w, \"You've called me %d times\", calls)\n}\n\nfunc main() {\n  fmt.Printf(\"Started server at http://localhost%v.\\n\", 5000)\n  http.HandleFunc(\"/\", HelloWorld)\n  http.ListenAndServe(\":5000\", nil)\n}\n</code></pre>\n\n<p>When I refresh the page, I got:</p>\n\n<pre><code>You've called me 1 times\nYou've called me 3 times\nYou've called me 5 times\n....\n</code></pre>\n\n<p>Question: Why it is 1, 3, 5 times, rather than 1,2,3...? What's the order of the function <code>HelloWorld</code> being called?</p>\n"}, {"tags": ["go", "nested", "return-value"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1456132912, "last_edit_date": 1456132912, "creation_date": 1456126836, "answer_id": 35548183, "question_id": 35548073, "link": "https://stackoverflow.com/questions/35548073/avoid-nesting-from-conjunction-with-function-that-returns-2-values-in-go/35548183#35548183", "title": "Avoid nesting from conjunction with function that returns 2 values in go?", "body": "<p>With a helper function, you can.</p>\n\n<p>Create a helper function which returns the second <code>bool</code> return value, e.g.:</p>\n\n<pre><code>func check(dummy interface{}, ok bool) bool {\n    return ok\n}\n</code></pre>\n\n<p>And using it:</p>\n\n<pre><code>if check(f()) &amp;&amp; check(g()) &amp;&amp; h() &amp;&amp; check(i()) {\n    doStuff()\n}\n</code></pre>\n\n<p>Note that this is equivalent to the original code because the <code>&amp;&amp;</code> operator is evaluated from left to right and it is using <a href=\"https://en.wikipedia.org/wiki/Short-circuit_evaluation\" rel=\"nofollow\">short-circuit evaluation</a>: if any of the operands evaluate to <code>false</code>, further operands (functions) will not be called.</p>\n\n<p>This <code>check()</code> function works for all functions that return 2 values and the 2nd is of type <code>bool</code> (because any value can be assigned to a variable of type <code>interface{}</code>).</p>\n\n<p><strong>This is covered in the <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow\">Spec: Calls</a>:</strong></p>\n\n<blockquote>\n  <p>As a special case, if the return values of a function or method <code>g</code> are equal in number and individually assignable to the parameters of another function or method <code>f</code>, then the call <code>f(g(parameters_of_g))</code> will invoke <code>f</code> after binding the return values of <code>g</code> to the parameters of <code>f</code> in order. The call of <code>f</code> must contain no parameters other than the call of <code>g</code>, and <code>g</code> must have at least one return value. If <code>f</code> has a final <code>...</code> parameter, it is assigned the return values of <code>g</code> that remain after assignment of regular parameters.</p>\n</blockquote>\n\n<p>Note: since the first parameter in <code>check()</code> is not used, we can even use the blank identifier when naming it which will make it obvious that we don't use that parameter:</p>\n\n<pre><code>func check(_ interface{}, ok bool) bool {\n    return ok\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1456136282, "post_id": 35548465, "comment_id": 58790168, "body": "The asker specifically said he can&#39;t return early in his case."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1456128427, "last_edit_date": 1456128427, "creation_date": 1456127911, "answer_id": 35548465, "question_id": 35548073, "link": "https://stackoverflow.com/questions/35548073/avoid-nesting-from-conjunction-with-function-that-returns-2-values-in-go/35548465#35548465", "title": "Avoid nesting from conjunction with function that returns 2 values in go?", "body": "<p>Avoid deep nesting or long conditionals running off the right side of the page with a function. For example,</p>\n\n<pre><code>package main\n\nfunc f() (int, bool) { return 1, true }\n\nfunc g() (int, bool) { return 1, true }\n\nfunc h() bool { return true }\n\nfunc i() (int, bool) { return 1, true }\n\nfunc doStuff(f, g, i int) int { return f + g + i }\n\nfunc andDoStuff() {\n    ff, ok := f()\n    if !ok {\n        return\n    }\n    gg, ok := g()\n    if !ok {\n        return\n    }\n    if ok := h(); !ok {\n        return\n    }\n    ii, ok := i()\n    if !ok {\n        return\n    }\n    doStuff(ff, gg, ii)\n\n}\n\nfunc main() {\n    andDoStuff()\n}\n</code></pre>\n"}], "owner": {"reputation": 15027, "user_id": 1276460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a37bb44988e76c03e735ea8d2c13768b?s=128&d=identicon&r=PG", "display_name": "John Hoffman", "link": "https://stackoverflow.com/users/1276460/john-hoffman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 1, "accepted_answer_id": 35548183, "answer_count": 2, "score": 2, "last_activity_date": 1456136547, "creation_date": 1456126413, "last_edit_date": 1456136547, "question_id": 35548073, "link": "https://stackoverflow.com/questions/35548073/avoid-nesting-from-conjunction-with-function-that-returns-2-values-in-go", "title": "Avoid nesting from conjunction with function that returns 2 values in go?", "body": "<p>Here, I have a conjunction expression involving some functions that return 2 values:</p>\n\n<pre><code>if _, ok := f(); ok {\n  if _, ok := g(); !ok {\n    if h() {\n      if _, ok := i(); ok {\n        doStuff()\n      }\n    }\n  }\n}\n</code></pre>\n\n<p>Could I somehow avoid the nesting? Instead of nesting, could I write this as an expression in one line (I can't quite break or return early in this case)?</p>\n"}, {"tags": ["go", "iterator", "channel"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1456128245, "post_id": 35547964, "comment_id": 58785282, "body": "Why do you want to avoid a nested loop? And what would be the return type if <code>Iter()</code> takes a <code>depth</code> argument?"}, {"owner": {"reputation": 43489, "user_id": 568109, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2hthl.gif?s=128&g=1", "display_name": "user568109", "link": "https://stackoverflow.com/users/568109/user568109"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1456128575, "post_id": 35547964, "comment_id": 58785455, "body": "@icza nested loop doesnt let me write a generic iterator of depth d? I am fine with string with ints joined by ,"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1456128756, "post_id": 35547964, "comment_id": 58785547, "body": "@user568109: Early experiments using goroutine iterators  in the Go standard library were abandoned. Why do you want to do it?"}, {"owner": {"reputation": 43489, "user_id": 568109, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2hthl.gif?s=128&g=1", "display_name": "user568109", "link": "https://stackoverflow.com/users/568109/user568109"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1456129426, "post_id": 35547964, "comment_id": 58785905, "body": "@peterSO I just wanted a way to compose iterations without recursion. Iterators are what I could think of."}], "answers": [{"comments": [{"owner": {"reputation": 43489, "user_id": 568109, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2hthl.gif?s=128&g=1", "display_name": "user568109", "link": "https://stackoverflow.com/users/568109/user568109"}, "edited": false, "score": 0, "creation_date": 1456129434, "post_id": 35548653, "comment_id": 58785911, "body": "Works. This is what I was looking for. I did nt know the terminology is called pipelining."}], "tags": [], "owner": {"reputation": 8433, "user_id": 2667536, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/UfmAF.png?s=128&g=1", "display_name": "Derlin", "link": "https://stackoverflow.com/users/2667536/derlin"}, "is_accepted": true, "score": 2, "last_activity_date": 1456128652, "creation_date": 1456128652, "answer_id": 35548653, "question_id": 35547964, "link": "https://stackoverflow.com/questions/35547964/writing-a-nested-iterator-of-depth-d/35548653#35548653", "title": "Writing a nested iterator of depth d", "body": "<p>I don't know if it is possible to avoid nested loops, but one solution is to use a pipeline of channels. For example:</p>\n\n<pre><code>const ITER_N = 60\n\n// ----------------\n\nfunc _goFunc1(out chan string) {\n    for i := 1; i &lt; ITER_N; i++ {\n        out &lt;- fmt.Sprintf(\"%d\", i)\n    }\n    close(out)\n}\n\nfunc _goFuncN(in chan string, out chan string) {\n    for j := range in {\n        for i := 1; i &lt; ITER_N; i++ {\n            out &lt;- fmt.Sprintf(\"%s,%d\", j, i)\n        }\n    }\n    close(out)\n}\n\n// ----------------\n\n// create the pipeline\nfunc IterDepth(d int) chan string {\n    c1 := make(chan string)\n    go _goFunc1(c1)\n\n    var c2 chan string\n    for ; d &gt; 1; d-- {\n        c2 = make(chan string)\n        go _goFuncN(c1, c2)\n        c1 = c2\n\n    }\n    return c1\n}\n</code></pre>\n\n<p>You can test it with: </p>\n\n<pre><code>func main() {\n    c := IterDepth(2)\n\n    for i := range c {\n        fmt.Println(i)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "is_accepted": false, "score": 1, "last_activity_date": 1456133546, "creation_date": 1456133546, "answer_id": 35550058, "question_id": 35547964, "link": "https://stackoverflow.com/questions/35547964/writing-a-nested-iterator-of-depth-d/35550058#35550058", "title": "Writing a nested iterator of depth d", "body": "<p>I usually implement iterators using closures. Multiple dimensions don't make the problem much harder. Here's one example of how to do this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc iter(min, max, depth int) func() ([]int, bool) {\n    s := make([]int, depth)\n    for i := range s { \n        s[i] = min \n    }   \n    s[0] = min - 1 \n    return func() ([]int, bool) {\n        s[0]++\n        for i := 0; i &lt; depth-1; i++ {\n            if s[i] &gt;= max {\n                s[i] = min \n                s[i+1]++\n            }   \n        }   \n        if s[depth-1] &gt;= max {\n            return nil, false\n        }   \n        return s, true\n    }   \n}   \n\nfunc main() {\n    // Three dimensions, ranging between [1,4)\n    i := iter(1, 4, 3)\n    for s, ok := i(); ok; s, ok = i() {\n        fmt.Println(s)\n    }   \n\n}\n</code></pre>\n\n<p>Try it out on the <a href=\"http://play.golang.org/p/CkYDnIl-Wl\" rel=\"nofollow\">Playground</a>.</p>\n\n<p>It'd be a simple change for example to give arguments as a single int slice instead, so that you could have per-dimension limits, if such a thing were necessary.</p>\n"}], "owner": {"reputation": 43489, "user_id": 568109, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2hthl.gif?s=128&g=1", "display_name": "user568109", "link": "https://stackoverflow.com/users/568109/user568109"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "accepted_answer_id": 35548653, "answer_count": 2, "score": 1, "last_activity_date": 1456133546, "creation_date": 1456126061, "question_id": 35547964, "link": "https://stackoverflow.com/questions/35547964/writing-a-nested-iterator-of-depth-d", "title": "Writing a nested iterator of depth d", "body": "<p>How to realize a nested iterator that takes a depth argument. A simple iterator would be when depth = 1. it is a simple iterator which runs like a simple for loop.</p>\n\n<pre><code>func Iter () chan int {\n    ch := make(chan int);\n    go func () {\n        for i := 1; i &lt; 60; i++ {\n            ch &lt;- i\n        }\n        close(ch)\n    } ();\n    return ch\n}\n</code></pre>\n\n<p>Output is <code>1,2,3...59</code></p>\n\n<p>For depth = 2 Output would be <code>\"1,1\" \"1,2\" ... \"1,59\" \"2,1\" ... \"59,59\"</code></p>\n\n<p>For depth = 3 Output would be <code>\"1,1,1\" ... \"59,59,59</code>\"</p>\n\n<p>I want to avoid a nested for loop. What is the solution here ?</p>\n"}, {"tags": ["go", "middleware", "negroni"], "answers": [{"tags": [], "owner": {"reputation": 183, "user_id": 2030114, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/56e62c4b0427c86a45ca8fd1300022c3?s=128&d=identicon&r=PG", "display_name": "Vikas Verma", "link": "https://stackoverflow.com/users/2030114/vikas-verma"}, "is_accepted": true, "score": 0, "last_activity_date": 1456231141, "creation_date": 1456231141, "answer_id": 35577832, "question_id": 35547051, "link": "https://stackoverflow.com/questions/35547051/different-middleware-for-different-routes-in-negroni/35577832#35577832", "title": "Different middleware for different routes in negroni", "body": "<p>So, the issue with the above implementation is that BaseRouter.Handle() method take a <strong>path</strong> and not a <strong>path_matcher/template</strong> so all the url's which has path_length more than one were not working.</p>\n\n<p>I figured out two ways to achieve what I needed:<br>\n<strong><em>First approach</em></strong>   </p>\n\n<pre><code>// Create a rootRouter\nvar rootRouter *mux.Router = mux.NewRouter()\n\n// Create as many subRouter you want with some prefix\nvar appsBasePath string = \"/apps\"\nvar adminBasePath string = \"/admin\"\nupRouter := rootRouter.PathPrefix(appsBasePath).Subrouter()\napRouter := rootRouter.PathPrefix(adminBasePath).Subrouter()\n\n// Register all the paths and mention middleware specifically for all of them\n// Here middleware is a method with signature as\n// func middleware( http.Handler) http.HandlerFunc {}\n\nupRouter.Path(\"/test\").Methods(\"POST\").Handler(middleware(http.HandlerFunc(func(w http.ResponseWriter, req *http.Request){\n    fmt.Fprintf(w, \"Welcome to the home page!\")\n})))\n\nn := negroni.New(middleware.NewLogger()) // attached other common middleware here\nn.UseHandler(rootRouter)\nn.Run(\":8080\")\n</code></pre>\n\n<p><strong><em>Second approach</em></strong><br>\nThis is extension/solution of the original issue in the question</p>\n\n<pre><code>// Replace BaseRouter.handle() as below\n// as PathPrefix takes a template so it won't have issue that we were facing  \n\nBaseRouter.PathPrefix(UserBasePath).Handler(nUserPath)  \n</code></pre>\n\n<p>Thing to remember here is that within negroni <code>nUserPath</code> RequestContext of the middleware attached will be different from that of the actual router's HandlerMethod</p>\n\n<p>Note:<br>\nBy path length I mean something like this -- /abc or /abc/ has path_length=1 and /abc/xyz has path_length=2  </p>\n"}], "owner": {"reputation": 183, "user_id": 2030114, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/56e62c4b0427c86a45ca8fd1300022c3?s=128&d=identicon&r=PG", "display_name": "Vikas Verma", "link": "https://stackoverflow.com/users/2030114/vikas-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 859, "favorite_count": 0, "accepted_answer_id": 35577832, "answer_count": 1, "score": 0, "last_activity_date": 1456231141, "creation_date": 1456122339, "last_edit_date": 1495541751, "question_id": 35547051, "link": "https://stackoverflow.com/questions/35547051/different-middleware-for-different-routes-in-negroni", "title": "Different middleware for different routes in negroni", "body": "<p>I want to have different middleware for different path. My current implementation is from this <a href=\"https://groups.google.com/forum/#!topic/negroni-users/guXGTNGGLRU\" rel=\"nofollow noreferrer\">link</a>  </p>\n\n<pre><code>UserRouter := mux.NewRouter().StrictSlash(true)\nAdminRouter := mux.NewRouter().StrictSlash(true)\n\nRouter.HandleFunc(\"/apps/{app_name}/xyz\", Handler).Methods(\"GET\")\n</code></pre>\n\n<p>I created three different routers, so that I can assosiate them with different path and middleware  </p>\n\n<pre><code>nUserPath := negroni.New(middleware.NewAuthMiddleWare())\nnUserPath.UseHandler(UserRouter)\n\nnAdminPath := negroni.New()\nnAdminPath.UseHandler(AdminRouter)\n</code></pre>\n\n<p>I created two different negroni instances and passed them the respective routers. As I wanted all this to run part of the same application on the same port so I created a Wrapper Router and negroni instance and associated them with the existing like below  </p>\n\n<pre><code>BaseRouter := mux.NewRouter().StrictSlash(true)\nBaseRouter.Handle(UserBasePath,nUserPath) // UserBasePath is `/apps`\nBaseRouter.Handle(HealthCheck,nUserPath)  // HealthCheck is `/health`\nBaseRouter.Handle(AdminBasePath,nAdminPath) // AdminBasePath is `/Admin`\n\nn := negroni.New(middleware.NewLogger()) // attached other common middleware here\nn.UseHandler(router.BaseRouter)\nn.Run(\":8080\")\n</code></pre>\n\n<p>Issues faced in this approach:<br>\nWhen I run <code>/health</code> it runs properly but when I run <code>/apps/{app_name}/something</code> I get a <code>404: Not Found</code></p>\n\n<p>Note : I went through other approaches mentioned in below link but they don't satisfy my need.  </p>\n\n<h2>- <a href=\"https://stackoverflow.com/questions/28418168/route-specific-middlewares-with-negroni\">Route-specific Middlewares with Negroni</a></h2>\n"}, {"tags": ["go", "identity"], "comments": [{"owner": {"reputation": 1592, "user_id": 618951, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/b867e8993ce4bf8205315e4a2e45e418?s=128&d=identicon&r=PG", "display_name": "RisingSun", "link": "https://stackoverflow.com/users/618951/risingsun"}, "edited": false, "score": 2, "creation_date": 1456117727, "post_id": 35546054, "comment_id": 58780957, "body": "compare pointers perhaps?"}], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1456119011, "post_id": 35546338, "comment_id": 58781372, "body": "On the application to linked lists specifically: the standard <a href=\"https://golang.org/src/container/list/list.go\" rel=\"nofollow noreferrer\"><code>container&#47;list</code></a> is a doubly-linked list so doesn&#39;t have exactly the same situation as asker, but it uses pointer comparisons, in, e.g. its <code>func Next()</code>."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 5, "last_activity_date": 1456118832, "creation_date": 1456118832, "answer_id": 35546338, "question_id": 35546054, "link": "https://stackoverflow.com/questions/35546054/golang-equivalent-of-is-operator-in-python/35546338#35546338", "title": "Golang Equivalent of `is` Operator in Python", "body": "<p>What you're talking about would require the use of pointers in Go. In your Python code, foo, bar, and baz contain references to objects, so you can talk about whether two of them refer to the same underlying object. In your Go code, a, b, and c are variables of type Test. If you declared them as pointers to Test (*Test), you would see something different. Try this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Test struct {\n    x int\n}\n\nfunc main() {\n    // a, b, and c are pointers to type Test\n    a := &amp;Test{5}\n    b := &amp;Test{5}\n    c := a\n\n    fmt.Println(\"a == b\", a == b)     // a and b point to different objects\n    fmt.Println(\"a == c\", a == c)     // a and c point to the same object\n    fmt.Println(\"*a == *b\", *a == *b) // The values of the objects pointed to by a and b are the same\n}\n</code></pre>\n"}], "owner": {"reputation": 9243, "user_id": 1318181, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/1ZfAE.png?s=128&g=1", "display_name": "kylieCatt", "link": "https://stackoverflow.com/users/1318181/kyliecatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 587, "favorite_count": 1, "accepted_answer_id": 35546338, "answer_count": 1, "score": 0, "last_activity_date": 1456118832, "creation_date": 1456117033, "question_id": 35546054, "link": "https://stackoverflow.com/questions/35546054/golang-equivalent-of-is-operator-in-python", "title": "Golang Equivalent of `is` Operator in Python", "body": "<p>I'm a Python developer who is learning Go and am writing a simple singly linked list implementation as an exercise. I had done this a few years ago in Python and am duplicating now in Go. </p>\n\n<p>One of the methods in the assignment (I did this initially in school) was <code>remove(node)</code>: remove a given node form the list. In Python I did this using the <code>is</code> operator. Something like this:</p>\n\n<pre><code>def remove(self, node):\n     element = self.head\n     prev = None\n     while element:\n         if element is node:\n             remove node form list...\n         prev = element\n         element = element.next\n</code></pre>\n\n<p>In Python the <code>is</code> operator checks identity. So for example</p>\n\n<pre><code>&gt;&gt;&gt; class Foo(object):\n...     def __init__(self, x):\n...         self.x = x\n... \n&gt;&gt;&gt; foo = Foo(5)\n&gt;&gt;&gt; bar = Foo(5)\n&gt;&gt;&gt; baz = foo\n&gt;&gt;&gt; foo is baz\nTrue\n&gt;&gt;&gt; foo is bar\nFalse\n</code></pre>\n\n<p>Even though the values on the instances <code>foo</code> and <code>bar</code> are the same they are not the same object, as we see here:</p>\n\n<pre><code>&gt;&gt;&gt; id(foo)\n139725093837712\n&gt;&gt;&gt; id(bar)\n139725093837904\n</code></pre>\n\n<p>However <code>foo</code> and <code>baz</code> are the same object:</p>\n\n<pre><code>&gt;&gt;&gt; id(foo)\n139725093837712\n&gt;&gt;&gt; id(baz)\n139725093837712\n</code></pre>\n\n<p>How would I go about doing the same thing in Go? The equality operator, <code>==</code>, just checks that the values are the same:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Test struct {\n    x int\n}\n\nfunc main() {\n  a := Test{5}\n  b := Test{5}\n  c := Test{6}\n\n  fmt.Println(\"a == b\", a == b)\n  fmt.Println(\"a == c \", a == c)\n  fmt.Println(\"b == c \", a == c)\n}\n</code></pre>\n\n<p>Which outputs:</p>\n\n<pre><code>a == b true\na == c  false\nb == c  false\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/Dhm5fSt58B\" rel=\"nofollow\">Playground link</a></p>\n\n<p><code>a</code> and <code>b</code> have the same value but are not the same object. Is there a way to check for identity in Go similar to Python? Or is is there a package available for it or some way to roll an identity checking function myself?</p>\n"}, {"tags": ["go", "stat", "plan-9"], "answers": [{"tags": [], "owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "is_accepted": true, "score": 5, "last_activity_date": 1456133047, "creation_date": 1456133047, "answer_id": 35549881, "question_id": 35545178, "link": "https://stackoverflow.com/questions/35545178/where-is-stat-t-defined-for-plan9/35549881#35549881", "title": "Where is Stat_t defined for plan9?", "body": "<p>TL;DR: It's the <a href=\"https://golang.org/src/syscall/dir_plan9.go#L25\" rel=\"noreferrer\"><code>*syscall.Dir</code></a> type. Read on for details.</p>\n\n<p>The source for <code>os.Stat</code> on Plan9 is <a href=\"https://golang.org/src/os/file_plan9.go#L162\" rel=\"noreferrer\">here</a>. It calls <code>dirstat</code>, which is defined <a href=\"https://golang.org/src/os/stat_plan9.go?#L44\" rel=\"noreferrer\">here</a>. It feeds the return value of <code>dirstat</code> into <code>fileInfoFromStat</code>, which is defined in the same file <a href=\"https://golang.org/src/os/stat_plan9.go?#L20\" rel=\"noreferrer\">here</a>.</p>\n\n<p>In the case of paths (as opposed to <code>*File</code> objects), <code>dirstat</code> just calls <a href=\"https://golang.org/src/syscall/syscall_plan9.go#L337\" rel=\"noreferrer\"><code>syscall.Stat</code></a>, which is basically just a thin wrapper around <a href=\"https://golang.org/src/syscall/zsyscall_plan9_amd64.go#L105\" rel=\"noreferrer\"><code>stat</code></a>. <code>syscall.Stat</code> expects a byte buffer to be able to write into. This buffer is processed a bit (see <code>dirstat</code> for details), and then fed into <a href=\"https://golang.org/src/syscall/dir_plan9.go#L98\" rel=\"noreferrer\"><code>syscall.UnmarshalDir</code></a>, which is where the magic happens. The documentation states that it \"decodes a single 9P stat message\" from a buffer and returns a <a href=\"https://golang.org/src/syscall/dir_plan9.go#L25\" rel=\"noreferrer\"><code>*syscall.Dir</code></a>.</p>\n\n<p><code>dirstat</code> then passes this <code>*syscall.Dir</code> to <code>fileInfoFromStat</code>, which is what processes it into a <code>FileInfo</code>. It's this <code>*syscall.Dir</code> value that is obtained through the <code>Sys()</code> method on the <code>FileInfo</code> object.</p>\n"}], "owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 1, "accepted_answer_id": 35549881, "answer_count": 1, "score": 3, "last_activity_date": 1456133047, "creation_date": 1456110423, "question_id": 35545178, "link": "https://stackoverflow.com/questions/35545178/where-is-stat-t-defined-for-plan9", "title": "Where is Stat_t defined for plan9?", "body": "<p>In the <code>plan9</code> specific Go code for <code>syscall</code>, there is no <code>Stat_t</code> like with other <code>GOOS</code>. Where is <code>Stat_t</code>, or its equivalent defined?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 55, "user_id": 1212025, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4WBeC.jpg?s=128&g=1", "display_name": "Felipe Le&#241;ero", "link": "https://stackoverflow.com/users/1212025/felipe-le%c3%b1ero"}, "edited": false, "score": 0, "creation_date": 1456120556, "post_id": 35545070, "comment_id": 58781867, "body": "I did a more deeply read about the way the data was being sent to my service, the data is following a PHP only structure using the name=myArray[index].val structure, but that cant be parsed using the http lib in golang, so I could make a parser to handle this kind of structure, or change the html, js to do it with a proper structure."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 1212025, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4WBeC.jpg?s=128&g=1", "display_name": "Felipe Le&#241;ero", "link": "https://stackoverflow.com/users/1212025/felipe-le%c3%b1ero"}, "edited": false, "score": 1, "creation_date": 1456120774, "post_id": 35545570, "comment_id": 58781937, "body": "Thanks @DrJosh9000, it seems that the problem is the structure itself, we thought that the PHP structure could be parsed with the default libraries of golang, but no, so we decided to rewrite the form that sends the data."}, {"owner": {"reputation": 24641, "user_id": 285694, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6af708e77a9683635ee600ced1bdac00?s=128&d=identicon&r=PG", "display_name": "BadPirate", "link": "https://stackoverflow.com/users/285694/badpirate"}, "edited": false, "score": 0, "creation_date": 1476212979, "post_id": 35545570, "comment_id": 67248456, "body": "This doesn&#39;t seem to work if you are using Gin Gonic ... <code>context.Request.PostForm</code> seems to always be an empty map[] even after calling <code>context.Request.ParseForm()</code> any familiarity with this?"}], "tags": [], "owner": {"reputation": 603, "user_id": 953747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79b9d6e746738b77cdbaa957ec250da0?s=128&d=identicon&r=PG", "display_name": "DrJosh9000", "link": "https://stackoverflow.com/users/953747/drjosh9000"}, "is_accepted": false, "score": 0, "last_activity_date": 1456113358, "creation_date": 1456113358, "answer_id": 35545570, "question_id": 35545070, "link": "https://stackoverflow.com/questions/35545070/how-to-iterate-through-an-array-value-in-postform/35545570#35545570", "title": "How to iterate through an Array Value in PostForm?", "body": "<p>It looks like the keys of your form are <code>\"myArray[0].val1\"</code>, <code>\"myArray[0].val2\"</code>, and so on.</p>\n\n<p>Try:</p>\n\n<pre><code>r.ParseForm()\nfor k, v := range r.PostForm {\n    for i, value := range v {\n        // Do something with the i-th value for key k.\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 1212025, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4WBeC.jpg?s=128&g=1", "display_name": "Felipe Le&#241;ero", "link": "https://stackoverflow.com/users/1212025/felipe-le%c3%b1ero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 354, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1456113358, "creation_date": 1456109651, "last_edit_date": 1456110045, "question_id": 35545070, "link": "https://stackoverflow.com/questions/35545070/how-to-iterate-through-an-array-value-in-postform", "title": "How to iterate through an Array Value in PostForm?", "body": "<p>I've been trying to read the values contained in an array sent by a Post Submit in a website.</p>\n\n<p>Printing the r.PostForm data returns this map:</p>\n\n<pre><code>map[myArray[0].val1:[foo1] myArray[0].val2:[foo2] myArray[1].val1:[foo1] myArray[1].val2:[foo2]]\n</code></pre>\n\n<p>How can we manipulate the data? I already tried something like this:</p>\n\n<pre><code>func request(r http.ResponseWriter, w *http.Request){\n    r.ParseForm()\n    for key, array := range r.PostForm[\"myArray\"] {\n        // Do something with the val1 and val2 values.\n    }\n}\n</code></pre>\n\n<p>But this didn't work and I hadn't found any solution in the web.</p>\n\n<p>Is possible to read an array contained in Post data using a basic solution?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1324, "user_id": 490790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/FobZX.jpg?s=128&g=1", "display_name": "SeedyROM", "link": "https://stackoverflow.com/users/490790/seedyrom"}, "edited": false, "score": 0, "creation_date": 1577532328, "post_id": 35544914, "comment_id": 105192867, "body": "As a go beginner coming from tons of other languages a few of these nuances have been really hard for me to pinpoint / ask questions about. This really helped me get a better idea of how go deals with packages! Thank you so much"}], "tags": [], "owner": {"reputation": 38917, "user_id": 445210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b689cc1d73c4f1e7378d045a54abcca?s=128&d=identicon&r=PG", "display_name": "Herman Schaaf", "link": "https://stackoverflow.com/users/445210/herman-schaaf"}, "is_accepted": true, "score": 6, "last_activity_date": 1456110496, "last_edit_date": 1456110496, "creation_date": 1456108404, "answer_id": 35544914, "question_id": 35544843, "link": "https://stackoverflow.com/questions/35544843/how-to-make-go-build-work-with-nested-directories/35544914#35544914", "title": "How to make go build work with nested directories", "body": "<p>Generally speaking, your directory name should match the package name. So if you define</p>\n\n<pre><code>package saysHi\n</code></pre>\n\n<p>and want to import it with </p>\n\n<p><code>import \"mylibs/hi/saysHi\"</code></p>\n\n<p>you should place it in a structure like this:</p>\n\n<ul>\n<li>mylibs</li>\n<li><ul>\n<li>hi</li>\n</ul></li>\n<li><ul>\n<li><ul>\n<li>saysHi</li>\n</ul></li>\n</ul></li>\n<li><ul>\n<li><ul>\n<li><ul>\n<li>saysHi.go</li>\n</ul></li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>The name of the <code>.go</code> file(s) inside the package makes no difference to the import path, so you could call the <code>.go</code> file anything you like. </p>\n\n<p>To explain it a bit further, the import path you use should be the name of the directory containing the package. But, if you define a different package name inside that directory, you should use that name to access the package inside the code. This can be confusing, so it's best to avoid it until you understand where it's best used (hint: package versioning). </p>\n\n<p>It gets confusing, so for example, if you had your package in the path</p>\n\n<ul>\n<li>mylibs</li>\n<li><ul>\n<li>hi</li>\n</ul></li>\n<li><ul>\n<li><ul>\n<li>saysHi.go</li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>And inside <code>saysHi.go</code> defined, </p>\n\n<pre><code>package saysHi\n</code></pre>\n\n<p>Then in test.go you will import it with</p>\n\n<pre><code>import \"mylibs/hi\"\n</code></pre>\n\n<p>And use it with</p>\n\n<pre><code>saysHi.SayHi()\n</code></pre>\n\n<p>Notice how you import it with the final directory being <code>hi</code>, but use it with the name <code>saysHi</code>. </p>\n\n<h3>Final note</h3>\n\n<p>Just in case you didn't know the following: your test file is called <code>test.go</code>, and that's fine, if it's just as an example, and not an actual test file for <code>saysHi.go</code>. But if it is/were a file containing tests for <code>saysHi.go</code>, then the accepted Go standard is to name the file <code>saysHi_test.go</code> and place it inside the same package alongside <code>saysHi.go</code>.</p>\n\n<h3>One more final note</h3>\n\n<p>I mentioned how you are allowed to choose a different package name from the directory name. But there is actually a way to write the code so that it's less confusing:</p>\n\n<pre><code> import (\n    saysHi \"mylibs/hi\"\n )\n</code></pre>\n\n<p>Would import it from the <code>mylibs/hi</code> directory, and make a note of the fact that it should be used with <code>saysHi</code>, so readers of your code understand that without having to go look at the <code>mylibs/hi</code> code. </p>\n"}], "owner": {"reputation": 213, "user_id": 4284830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4476adca6a0305cea586d7e710083e35?s=128&d=identicon&r=PG", "display_name": "testing", "link": "https://stackoverflow.com/users/4284830/testing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 999, "favorite_count": 0, "accepted_answer_id": 35544914, "answer_count": 1, "score": 0, "last_activity_date": 1456110496, "creation_date": 1456107883, "question_id": 35544843, "link": "https://stackoverflow.com/questions/35544843/how-to-make-go-build-work-with-nested-directories", "title": "How to make go build work with nested directories", "body": "<p>In the process of learning go I was playing around with making my own libraries. Here is what I did: in my $GOPATH/src I have two folders: <code>mylibs</code> and <code>test</code>. The <code>test</code> folder has a file called <code>test.go</code> which contains</p>\n\n<pre><code>package test\n\nimport \"mylibs/hi/saysHi\"\n\nfunc main() {\n    saysHi.SayHi()\n}\n</code></pre>\n\n<p>The <code>mylibs</code> folder contains another folder called <code>hi</code>, which has a file called <code>saysHi.go</code> containing:</p>\n\n<pre><code>package saysHi\n\nimport \"fmt\"\n\nfunc SayHi() {\n    fmt.Printf(\"Hi\\n\")\n}\n</code></pre>\n\n<p>So the directory structure looks like this:</p>\n\n<ul>\n<li>GOPATH/src</li>\n<li><ul>\n<li>test</li>\n</ul></li>\n<li><ul>\n<li><ul>\n<li>test.go</li>\n</ul></li>\n</ul></li>\n<li><ul>\n<li>mylibs</li>\n</ul></li>\n<li><ul>\n<li><ul>\n<li>hi</li>\n</ul></li>\n</ul></li>\n<li><ul>\n<li><ul>\n<li><ul>\n<li>saysHi.go</li>\n</ul></li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>The problem is that when I try to compile <code>test</code> it complains saying</p>\n\n<pre><code>cannot find package \"mylibs/hi/saysHi\" in any of: \n    [...]\n    $GOPATH/src/mylibs/hi/saysHi (from $GOPATH)\n</code></pre>\n\n<p>I have deliberately made the directory structure deeper than necessary. If I make a simpler directory structure where I place <code>saysHi.go</code> in <code>$GOPATH/saysHi/saysHi.go</code> then it works.</p>\n\n<p>But I don't see a reason for why this wouldn't work. Any ideas?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "edited": false, "score": 0, "creation_date": 1456104568, "post_id": 35544345, "comment_id": 58777593, "body": "the accepted answer linked to does not work....<a href=\"http://play.golang.org/p/jANhmUA_Gw\" rel=\"nofollow noreferrer\">play.golang.org/p/jANhmUA_Gw</a>"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 2, "creation_date": 1456105100, "post_id": 35544345, "comment_id": 58777719, "body": "Both operands need to be the same type. Example: <a href=\"https://play.golang.org/p/E4RLQEDIWo\" rel=\"nofollow noreferrer\">play.golang.org/p/E4RLQEDIWo</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1456108176, "post_id": 35544345, "comment_id": 58778441, "body": "put that as an answer and I&#39;ll accept."}], "owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "closed_date": 1456104392, "answer_count": 0, "score": 2, "last_activity_date": 1456103951, "creation_date": 1456103951, "question_id": 35544345, "link": "https://stackoverflow.com/questions/35544345/why-cant-i-sleep-for-a-calculated-integer", "closed_reason": "Duplicate", "title": "Why can&#39;t I sleep for a calculated integer?", "body": "<p>I am trying to calculate a time to sleep but am stuck. I can sleep for 10 seconds:</p>\n\n<pre><code>time.Sleep(10 * time.Second)\n</code></pre>\n\n<p>However, I try the following:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"time\"\n    \"reflect\"\n)\n\nfunc main() {\n    n := time.Now()\n    remaining := 10 - int(time.Since(n).Seconds())\n    log.Println(reflect.TypeOf(10), reflect.TypeOf(remaining))\n    //time.Sleep(10 * time.Second)\n    time.Sleep(remaining * time.Second)\n}\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>invalid operation: remaining * time.Second (mismatched types int and time.Duration)\n</code></pre>\n\n<p>remaining is an int, just as 10 is an int. What gives?</p>\n\n<p><a href=\"http://play.golang.org/p/qzvoJ_FPHq\" rel=\"nofollow\">My playground</a></p>\n"}, {"tags": ["go", "queue", "threadpool"], "answers": [{"comments": [{"owner": {"reputation": 9005, "user_id": 337504, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f365e5b3587387ed67c9c747288874e2?s=128&d=identicon&r=PG", "display_name": "Mustafa", "link": "https://stackoverflow.com/users/337504/mustafa"}, "edited": false, "score": 0, "creation_date": 1456098719, "post_id": 35543638, "comment_id": 58776172, "body": "Yeah, you are absoultely right, and seperating <code>wg.Add(1)</code> to there actually makes more sense and correct."}, {"owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "edited": false, "score": 0, "creation_date": 1456098864, "post_id": 35543638, "comment_id": 58776208, "body": "Actually, calling it once with <code>wg.Add(10)</code> makes even more sense ;)"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1456098350, "creation_date": 1456098350, "answer_id": 35543638, "question_id": 35543545, "link": "https://stackoverflow.com/questions/35543545/implementing-a-job-worker-pool-in-go/35543638#35543638", "title": "Implementing a job worker pool in Go", "body": "<p>Call wg.Add outside of the goroutine and pass a pointer to the wait group.</p>\n\n<p>If Add is called from inside the goroutine, it's possible for the main goroutine to call Wait before the goroutines get a chance to run.  If Add has not been called, then Wait will return immediately.</p>\n\n<p>Pass a pointer to the goroutine. Otherwise, the goroutines use their own copy of the wait group.</p>\n\n<pre><code>func jobWorker(id int, jobs &lt;-chan string, wg *sync.WaitGroup) {\n\n    defer wg.Done()\n\n    for job := range jobs {\n        item := ParseItem(job)\n        item.SaveItem()\n        MarkJobCompleted(item.ID)\n        log.Println(\"Saved\", item.Title)\n    }\n}\n\n// ProcessJobs processes the jobs from the list and deletes them\nfunc ProcessJobs() {\n\n    jobs := make(chan string)\n\n    list := GetJobs()\n    // Start workers\n    var wg sync.WaitGroup\n    for w := 0; w &lt; 10; w++ {\n        wg.Add(1)\n        go jobWorker(w, jobs, &amp;wg)\n    }\n\n    for _, url := range list {\n        jobs &lt;- url\n    }\n\n    close(jobs)\n    wg.Wait()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "is_accepted": false, "score": 1, "last_activity_date": 1456098363, "creation_date": 1456098363, "answer_id": 35543640, "question_id": 35543545, "link": "https://stackoverflow.com/questions/35543545/implementing-a-job-worker-pool-in-go/35543640#35543640", "title": "Implementing a job worker pool in Go", "body": "<p>You need to pass a pointer to the waitgroup, or else every job receives it's own copy. </p>\n\n<pre><code>func jobWorker(id int, jobs &lt;-chan string, wg *sync.WaitGroup) {\n    wg.Add(1)\n    defer wg.Done()\n\n    for job := range jobs {\n        item := ParseItem(job)\n        item.SaveItem()\n        MarkJobCompleted(item.ID)\n        log.Println(\"Saved\", item.Title)\n    }\n}\n\n// ProcessJobs processes the jobs from the list and deletes them\nfunc ProcessJobs() {\n\n    jobs := make(chan string)\n\n    list := GetJobs()\n    // Start workers\n    var wg sync.WaitGroup\n    for w := 0; w &lt; 10; w++ {\n        go jobWorker(w, jobs, &amp;wg)\n    }\n\n    for _, url := range list {\n        jobs &lt;- url\n    }\n\n    close(jobs)\n    wg.Wait()\n}\n</code></pre>\n\n<p>See the difference here: <a href=\"http://play.golang.org/p/xa4UtM97qL\" rel=\"nofollow\">without pointer</a>, <a href=\"http://play.golang.org/p/vYjPuIT2VN\" rel=\"nofollow\">with pointer</a>.</p>\n"}], "owner": {"reputation": 9005, "user_id": 337504, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f365e5b3587387ed67c9c747288874e2?s=128&d=identicon&r=PG", "display_name": "Mustafa", "link": "https://stackoverflow.com/users/337504/mustafa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 35543638, "answer_count": 2, "score": 0, "last_activity_date": 1456098363, "creation_date": 1456097737, "question_id": 35543545, "link": "https://stackoverflow.com/questions/35543545/implementing-a-job-worker-pool-in-go", "title": "Implementing a job worker pool in Go", "body": "<p>Since Go does not have generics, all the premade solutions use type casting which I do not like very much. I also want to implement it on my own and tried the following code. However, sometimes it does not wait for all goroutines, am I closing the jobs channel prematurely? I do not have anything to fetch from them. I might have used a pseudo output channel too and waited to fetch the exact amount from them however I believe the following code should work too. What am I missing?</p>\n\n<pre><code>func jobWorker(id int, jobs &lt;-chan string, wg sync.WaitGroup) {\n    wg.Add(1)\n    defer wg.Done()\n\n    for job := range jobs {\n        item := ParseItem(job)\n        item.SaveItem()\n        MarkJobCompleted(item.ID)\n        log.Println(\"Saved\", item.Title)\n    }\n}\n\n// ProcessJobs processes the jobs from the list and deletes them\nfunc ProcessJobs() {\n\n    jobs := make(chan string)\n\n    list := GetJobs()\n    // Start workers\n    var wg sync.WaitGroup\n    for w := 0; w &lt; 10; w++ {\n        go jobWorker(w, jobs, wg)\n    }\n\n    for _, url := range list {\n        jobs &lt;- url\n    }\n\n    close(jobs)\n    wg.Wait()\n}\n</code></pre>\n"}, {"tags": ["go", "symlink"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 13, "last_activity_date": 1456087842, "creation_date": 1456087842, "answer_id": 35541862, "question_id": 35541589, "link": "https://stackoverflow.com/questions/35541589/creating-a-relative-symbolic-link-through-the-os-package/35541862#35541862", "title": "Creating a relative symbolic link through the os package", "body": "<p>Don't include the absolute path to <code>symtarget.txt</code> when calling <a href=\"https://godoc.org/os#Symlink\" rel=\"noreferrer\"><code>os.Symlink</code></a>; only use it when writing to the file:</p>\n\n<pre><code>package main \n\nimport (\n    \"io/ioutil\"\n    \"os\"\n    \"path/filepath\"\n)\n\nfunc main() {\n    path := \"/tmp/rolfl/symexample\"\n    target := \"symtarget.txt\"\n    os.MkdirAll(path, 0755)\n    ioutil.WriteFile(filepath.Join(path, \"symtarget.txt\"), []byte(\"Hello\\n\"), 0644)\n    symlink := filepath.Join(path, \"symlink\")\n    os.Symlink(target, symlink)\n}\n</code></pre>\n"}], "owner": {"reputation": 16811, "user_id": 1305253, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/455f776955f148ffad8174a9b69aa4ba?s=128&d=identicon&r=PG", "display_name": "rolfl", "link": "https://stackoverflow.com/users/1305253/rolfl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7471, "favorite_count": 3, "accepted_answer_id": 35541862, "answer_count": 1, "score": 10, "last_activity_date": 1456087842, "creation_date": 1456086357, "question_id": 35541589, "link": "https://stackoverflow.com/questions/35541589/creating-a-relative-symbolic-link-through-the-os-package", "title": "Creating a relative symbolic link through the os package", "body": "<p>I would like to create a relative symbolic link in go using the os package.</p>\n\n<p>os already <a href=\"https://golang.org/pkg/os/#Symlink\" rel=\"noreferrer\">contains the function: <code>os.SymLink(oldname, newname string)</code></a>, but it cannot create relative symlinks.</p>\n\n<p>For example, if I run the following:</p>\n\n<pre><code>package main \n\nimport (\n    \"io/ioutil\"\n    \"os\"\n    \"path/filepath\"\n)\n\nfunc main() {\n    path := \"/tmp/rolfl/symexample\"\n    target := filepath.Join(path, \"symtarget.txt\")\n    os.MkdirAll(path, 0755)\n    ioutil.WriteFile(target, []byte(\"Hello\\n\"), 0644)\n    symlink := filepath.Join(path, \"symlink\")\n    os.Symlink(target, symlink)\n}\n</code></pre>\n\n<p>it creates the following in my filesystem:</p>\n\n<pre><code>$ ls -la /tmp/rolfl/symexample\ntotal 12\ndrwxr-xr-x 2 rolf rolf 4096 Feb 21 15:21 .\ndrwxr-xr-x 3 rolf rolf 4096 Feb 21 15:21 ..\nlrwxrwxrwx 1 rolf rolf   35 Feb 21 15:21 symlink -&gt; /tmp/rolfl/symexample/symtarget.txt\n-rw-r--r-- 1 rolf rolf    6 Feb 21 15:21 symtarget.txt\n</code></pre>\n\n<p>How can I use golang to create the relative symlink that looks like:</p>\n\n<pre><code>$ ln -s symtarget.txt symrelative\n$ ls -la\ntotal 12\ndrwxr-xr-x 2 rolf rolf 4096 Feb 21 15:23 .\ndrwxr-xr-x 3 rolf rolf 4096 Feb 21 15:21 ..\nlrwxrwxrwx 1 rolf rolf   35 Feb 21 15:21 symlink -&gt; /tmp/rolfl/symexample/symtarget.txt\nlrwxrwxrwx 1 rolf rolf   13 Feb 21 15:23 symrelative -&gt; symtarget.txt\n-rw-r--r-- 1 rolf rolf    6 Feb 21 15:21 symtarget.txt\n</code></pre>\n\n<p>I want something that's like the <code>symrelative</code> above.</p>\n\n<p>Do I have to resort to <code>os/exec</code>:</p>\n\n<pre><code>cmd := exec.Command(\"ln\", \"-s\", \"symtarget.txt\", \"symlink\")\ncmd.Dir = \"/tmp/rolfl/symexample\"\ncmd.CombinedOutput()\n</code></pre>\n"}, {"tags": ["go", "cryptography", "private-key", "pem"], "comments": [{"owner": {"reputation": 623, "user_id": 5615224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7bea88308ec27975167f216eb8f998e?s=128&d=identicon&r=PG&f=1", "display_name": "sfault", "link": "https://stackoverflow.com/users/5615224/sfault"}, "edited": false, "score": 0, "creation_date": 1456075109, "post_id": 35539083, "comment_id": 58767111, "body": "try using <code>crypto&#47;sha1</code> package"}, {"owner": {"reputation": 2042, "user_id": 1864771, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ijkG3.jpg?s=128&g=1", "display_name": "Ostad", "link": "https://stackoverflow.com/users/1864771/ostad"}, "reply_to_user": {"reputation": 623, "user_id": 5615224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7bea88308ec27975167f216eb8f998e?s=128&d=identicon&r=PG&f=1", "display_name": "sfault", "link": "https://stackoverflow.com/users/5615224/sfault"}, "edited": false, "score": 0, "creation_date": 1456075970, "post_id": 35539083, "comment_id": 58767467, "body": "@sfault If I&#39;m not making any mistake <code>crypto&#47;sha1</code> package only generate sha1 from array bytes so how should I sign data with pem?"}], "answers": [{"comments": [{"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 1, "creation_date": 1456082877, "post_id": 35540093, "comment_id": 58770351, "body": "Why not just <code>sha1.Sum([]byte(&quot;hello&quot;))</code>?"}, {"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "reply_to_user": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 1, "creation_date": 1456083837, "post_id": 35540093, "comment_id": 58770724, "body": "@Danilo yes, your suggestion is logical but <code>sha1.Sum</code> returns <code>[20]byte</code> <i>array</i> and <code>SignPKCS1v15</code> requires <code>[]byte</code> <i>slice</i> so we will need to use like <code>sum[:]</code> to convert <i>array to slice</i> and I&#39;m not sure if this is simpler to read and understand for someone new."}, {"owner": {"reputation": 3137, "user_id": 2525941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e687ea39a9115c22147d1aaed68a888?s=128&d=identicon&r=PG", "display_name": "Danilo", "link": "https://stackoverflow.com/users/2525941/danilo"}, "edited": false, "score": 0, "creation_date": 1456084052, "post_id": 35540093, "comment_id": 58770797, "body": "Hmm, i don&#39;t really know whats simpler to read. When seeing <code>h.Sum(nil)</code> you would need to read the doc to figure out whats actually happening, its not really self explaining."}, {"owner": {"reputation": 2042, "user_id": 1864771, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ijkG3.jpg?s=128&g=1", "display_name": "Ostad", "link": "https://stackoverflow.com/users/1864771/ostad"}, "edited": false, "score": 0, "creation_date": 1456092556, "post_id": 35540093, "comment_id": 58774187, "body": "@Bearburger Thanks but <code>x509.ParsePKCS1PrivateKey(p.Bytes)</code> return error:  <code>asn1: structure error: tags don&#39;t match (2 vs {class:0 tag:16 length:13 isCompound:true}) {optional:false explicit:false application:false defaultValue:&lt;nil&gt; tag:&lt;nil&gt; stringType:0 timeType:0 set:false omitEmpty:false}</code> I checked that with your key and it&#39;s work however my private key works in both C# and Nodejs but not with this code!! any Idea? Here&#39;s the keys: <a href=\"https://gist.github.com/moostad/ea4a8cd0433c248f9d40\" rel=\"nofollow noreferrer\">gist.github.com/moostad/ea4a8cd0433c248f9d40</a>"}, {"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "reply_to_user": {"reputation": 2042, "user_id": 1864771, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ijkG3.jpg?s=128&g=1", "display_name": "Ostad", "link": "https://stackoverflow.com/users/1864771/ostad"}, "edited": false, "score": 2, "creation_date": 1456095450, "post_id": 35540093, "comment_id": 58775191, "body": "@Ostad looks like this is <a href=\"https://github.com/golang/go/issues/6650\" rel=\"nofollow noreferrer\">known bug</a> I&#39;m not cryptobraphy expert but the way around this is to convert your key with <code>openssl rsa -in key.key -out rsakey.key</code> command. Maybe you should ask in <a href=\"http://crypto.stackexchange.com/\">crypto.stackexchange.com</a> what is the difference between these keys."}, {"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "reply_to_user": {"reputation": 2042, "user_id": 1864771, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ijkG3.jpg?s=128&g=1", "display_name": "Ostad", "link": "https://stackoverflow.com/users/1864771/ostad"}, "edited": false, "score": 0, "creation_date": 1456095584, "post_id": 35540093, "comment_id": 58775229, "body": "@Ostad also there is discussion <a href=\"https://groups.google.com/forum/#!msg/golang-nuts/ZZ1Wt9d268Q/gQGh6e-wGAAJ\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!msg/golang-nuts/ZZ1Wt9d268Q/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": true, "score": 6, "last_activity_date": 1456097939, "last_edit_date": 1456097939, "creation_date": 1456079163, "answer_id": 35540093, "question_id": 35539083, "link": "https://stackoverflow.com/questions/35539083/how-get-sha1-rsa-signed-of-bytes-in-go/35540093#35540093", "title": "How get SHA1 RSA signed of bytes in Go?", "body": "<p><strong>C# code</strong></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Security.Cryptography;\nusing System.Text;\nusing System.Threading.Tasks;\n\nnamespace RSASHA1\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            RSACryptoServiceProvider rsa = new RSACryptoServiceProvider();\n            rsa.FromXmlString(\"&lt;RSAKeyValue&gt;&lt;Modulus&gt;n9t+R7Zmn4VLaWmixLnUkxfQmwDHqRmtlC3mR0YJ9ntUpqLPIkbZgGbuCM8jzmt3kTs4UIufzxQfim1v8avBYDkijxKRN4/g2juS9IqmWjvdV4CrxfTVGXudiuzeqI3wzoaHY4BmMdhmOA46GV6pifAVeQnJb6Hp6/F9bwi1kFE=&lt;/Modulus&gt;&lt;Exponent&gt;AQAB&lt;/Exponent&gt;&lt;P&gt;+ow3plgxHR5BcBApdHu93bLQJHD+DbcUV6qKSHMfQNosjDb6IiPUd6kfHI34DIldot6ooI+AUqZYIqW57J7llw==&lt;/P&gt;&lt;Q&gt;o1YL/4UkELk5nmU30NA7gLmnZm+bynt9rR2yjkU55SP60tqO5/72aXak/RrSih1BC6WfJxEr2OLMWud6t8wGVw==&lt;/Q&gt;&lt;DP&gt;U8vXxPPUIVgALNnK86F7RA3NHZMI9U9ZJ2TrcQXH2yndIlw01nxDUG4o8KTu5EqBHbr4jRLRqVLnQVdKUsBmKw==&lt;/DP&gt;&lt;DQ&gt;XeJJxzeaQVqWOetoJ8hpS1ZrWD/yxnIxDN6zEX/NBV6m/6fM2KD+tiQSNcHDHswt5Snvzx7ZmzLRz7aaHSdSxQ==&lt;/DQ&gt;&lt;InverseQ&gt;j/DPSjRS09ephgGgiSBFcpxDc+54n6Fo2M2zLhMj/lBoO8klbNPB4YlwFHJjEh9EpbLB1Zwi7XjL2weFX2Ws+g==&lt;/InverseQ&gt;&lt;D&gt;HRtdMfePVgpyQb5fSczAXQwgCqkosaygQ3PcEyw4ki3AqxrH9mjKH6weOXJmBabhvYr35QqXTaBPYegtUubALda87T7cviK1rCPN18vv+eU4MT9TADQyj9HeYvp7fUfjEfaIaf/QpAXwSRrF/n9CsM1ef4aZX4XFd2uv2SH7yVU=&lt;/D&gt;&lt;/RSAKeyValue&gt;\");\n            byte[] signMain = rsa.SignData(Encoding.UTF8.GetBytes(\"hello\"), new SHA1CryptoServiceProvider());\n            StringBuilder hex = new StringBuilder(signMain.Length * 2);\n            foreach (byte b in signMain) hex.AppendFormat(\"{0:x2}\", b);\n            Console.Write(hex.ToString());\n            Console.ReadLine();\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Go code for keys generated in OpenSSL &lt; 1.0 and OpenSSL >= 1.0</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/pem\"\n    \"fmt\"\n    \"crypto/sha1\"\n    \"crypto/rsa\"\n    \"crypto/rand\"\n    \"crypto/x509\"\n    \"crypto\"\n    \"encoding/hex\"\n)\n\nvar openssl_10_key string = `-----BEGIN PRIVATE KEY-----\nMIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBAMipwvuAvELnymqg2cdNTX+Df341aT6iZC/5qSv+U2a6tr/sqoIRd4Hi5TQFB0yPcbqL5NhIz8CjrA7k7WROH6F10OKfhPgyxBxRARLSqfVdflFb9WF3BlJeOgHti8j24a38gUsqx42nkbLJM6tmlYqSOSZWR3jPx7ZuqgSNO+G5AgMBAAECgYAGXKN+HjTzZhS1ae4dphmSTmGVzcaAohAzf5XZrp5UTN0lNP3e69DYwSnR8WR4cx/NWBWxHPXa1+Jiz01B3dw3NgdcK9YhheDJEzBjMV8kizqTV2GrwGrc04JI/77uBZdj8bUx3pIhwWOK6ShmhveuPE8Q3EfeZ5g+yKvkF4YTNQJBAPhyENG0qp36VWLyHC4tY7j35tTjYuhTNDsmPI/BNYaSIGzGGfKZweAouUsetk3BQe4fgDHdU+wT+uvArvUPua8CQQDOw8A8K44qUuNLnUUhbTpK0MNXNxA25oOwHHTCqFQLxarZGKj7KqBYiT4bR9TesvfXz2IpvvMOf4UWs57aBL0XAkEArTEnFGkzf0lheMZ6ap5tpCX8nm+dJYPLJ2iyUyxHGfaH8AvxTrNs+cypzvor7+xG/66p+RjnRe1vwCTkUiWSNQJBAMqNhaLsYEciED0hAnoukO59+P9Vl/LQe61pExEm6b7mk+o9eD0lkxNoz4jWI7lOxfGK3fVbdKx9TBnjOPkHr10CQBW22VQhzg75LsrqNeiVGMDXRtlPueSICfxYxXCiDVc0SLi9RpCGo8fsiB+Uk9ENnLk6/vW1/H9IqtS7rQbNy64=\n-----END PRIVATE KEY-----`\n\nvar openssl_09_key string = `-----BEGIN RSA PRIVATE KEY-----\nMIICXQIBAAKBgQDIqcL7gLxC58pqoNnHTU1/g39+NWk+omQv+akr/lNmura/7KqCEXeB4uU0BQdMj3G6i+TYSM/Ao6wO5O1kTh+hddDin4T4MsQcUQES0qn1XX5RW/VhdwZSXjoB7YvI9uGt/IFLKseNp5GyyTOrZpWKkjkmVkd4z8e2bqoEjTvhuQIDAQABAoGABlyjfh4082YUtWnuHaYZkk5hlc3GgKIQM3+V2a6eVEzdJTT93uvQ2MEp0fFkeHMfzVgVsRz12tfiYs9NQd3cNzYHXCvWIYXgyRMwYzFfJIs6k1dhq8Bq3NOCSP++7gWXY/G1Md6SIcFjiukoZob3rjxPENxH3meYPsir5BeGEzUCQQD4chDRtKqd+lVi8hwuLWO49+bU42LoUzQ7JjyPwTWGkiBsxhnymcHgKLlLHrZNwUHuH4Ax3VPsE/rrwK71D7mvAkEAzsPAPCuOKlLjS51FIW06StDDVzcQNuaDsBx0wqhUC8Wq2Rio+yqgWIk+G0fU3rL3189iKb7zDn+FFrOe2gS9FwJBAK0xJxRpM39JYXjGemqebaQl/J5vnSWDyydoslMsRxn2h/AL8U6zbPnMqc76K+/sRv+uqfkY50Xtb8Ak5FIlkjUCQQDKjYWi7GBHIhA9IQJ6LpDuffj/VZfy0HutaRMRJum+5pPqPXg9JZMTaM+I1iO5TsXxit31W3SsfUwZ4zj5B69dAkAVttlUIc4O+S7K6jXolRjA10bZT7nkiAn8WMVwog1XNEi4vUaQhqPH7IgflJPRDZy5Ov71tfx/SKrUu60Gzcuu\n-----END RSA PRIVATE KEY-----`\n\nfunc main() {\n    h := sha1.New()\n    h.Write([]byte(\"hello\"))\n    sum := h.Sum(nil)\n\n    // For RSA keys generated with OpenSSL &lt; 1.0\n    pem09, _ := pem.Decode([]byte(openssl_09_key))\n    privateKey09, _ := x509.ParsePKCS1PrivateKey(pem09.Bytes)\n    sig, _ := rsa.SignPKCS1v15(rand.Reader, privateKey09, crypto.SHA1, sum)\n    fmt.Println(\"OpenSSL &lt; 1.0\", hex.EncodeToString(sig))\n\n    // For RSA keys generated with OpenSSL &gt;= 1.0\n    pem10, _ := pem.Decode([]byte(openssl_10_key))\n    privateKey10I, _ := x509.ParsePKCS8PrivateKey(pem10.Bytes)\n    privateKey10 := privateKey10I.(*rsa.PrivateKey)\n    sig, _ = rsa.SignPKCS1v15(rand.Reader, privateKey10, crypto.SHA1, sum)\n    fmt.Println(\"OpenSSL &gt;= 1.0\", hex.EncodeToString(sig))\n}\n</code></pre>\n"}], "owner": {"reputation": 2042, "user_id": 1864771, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ijkG3.jpg?s=128&g=1", "display_name": "Ostad", "link": "https://stackoverflow.com/users/1864771/ostad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1372, "favorite_count": 0, "accepted_answer_id": 35540093, "answer_count": 1, "score": 5, "last_activity_date": 1456439649, "creation_date": 1456074261, "last_edit_date": 1456439649, "question_id": 35539083, "link": "https://stackoverflow.com/questions/35539083/how-get-sha1-rsa-signed-of-bytes-in-go", "title": "How get SHA1 RSA signed of bytes in Go?", "body": "<p>I'm new in Go and having hard time to figure it out how crypto package works.</p>\n\n<p>Basicly I need to sign a string with pem key and get sha1 of that like the equivalent code in C# in below.</p>\n\n<p>Thanks</p>\n\n<pre><code>RSACryptoServiceProvider rsa = new RSACryptoServiceProvider(); \nrsa.FromXmlString(\u201c&lt;RSAKeyValue&gt;&lt;Modulus&gt;oQRshGhLf2Fh...\u201d);\nbyte[] signMain = rsa.SignData(Encoding.UTF8.GetBytes(data), new SHA1CryptoServiceProvider());\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-bigtable"], "comments": [{"owner": {"reputation": 6972, "user_id": 738710, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ca1feddf2040d79ad8ec24d3f0a623c1?s=128&d=identicon&r=PG", "display_name": "Les Vogel - Google DevRel", "link": "https://stackoverflow.com/users/738710/les-vogel-google-devrel"}, "edited": false, "score": 0, "creation_date": 1456079873, "post_id": 35538279, "comment_id": 58769025, "body": "Try using <code>gcloud beta app run app.yaml</code>.  I&#39;ll ask the author to comment on this tomorrow."}, {"owner": {"reputation": 336, "user_id": 861693, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/81fd77e9430cb29127a36f9287f69a0f?s=128&d=identicon&r=PG", "display_name": "jamescharlesworth", "link": "https://stackoverflow.com/users/861693/jamescharlesworth"}, "reply_to_user": {"reputation": 6972, "user_id": 738710, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ca1feddf2040d79ad8ec24d3f0a623c1?s=128&d=identicon&r=PG", "display_name": "Les Vogel - Google DevRel", "link": "https://stackoverflow.com/users/738710/les-vogel-google-devrel"}, "edited": false, "score": 0, "creation_date": 1456086972, "post_id": 35538279, "comment_id": 58771973, "body": "Thanks, but that gives the same response."}, {"owner": {"reputation": 6972, "user_id": 738710, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ca1feddf2040d79ad8ec24d3f0a623c1?s=128&d=identicon&r=PG", "display_name": "Les Vogel - Google DevRel", "link": "https://stackoverflow.com/users/738710/les-vogel-google-devrel"}, "edited": false, "score": 0, "creation_date": 1456091994, "post_id": 35538279, "comment_id": 58773938, "body": "I&#39;ve sent him an email asking him to respond here."}], "answers": [{"tags": [], "owner": {"reputation": 1536, "user_id": 5317173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZglzG.png?s=128&g=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/5317173/nicholas"}, "is_accepted": true, "score": 1, "last_activity_date": 1472045088, "last_edit_date": 1472045088, "creation_date": 1470949565, "answer_id": 38906150, "question_id": 35538279, "link": "https://stackoverflow.com/questions/35538279/error-gcloud-preview-app-invalid-choice-run/38906150#38906150", "title": "ERROR: (gcloud.preview.app) Invalid choice: &#39;run&#39;", "body": "<p><code>app run</code> is no longer part of the gcloud SDK as can be seen under all the possible command trees:</p>\n\n<ul>\n<li><a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/\" rel=\"nofollow\"><code>gcloud alpha</code></a> has no <code>app</code> command group</li>\n<li><a href=\"https://cloud.google.com/sdk/gcloud/reference/app/\" rel=\"nofollow\"><code>gcloud app</code></a> has no <code>run</code> command</li>\n<li><a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/app/\" rel=\"nofollow\"><code>gcloud beta</code></a> has no <code>run</code> command</li>\n<li><a href=\"https://cloud.google.com/sdk/gcloud/reference/preview/\" rel=\"nofollow\"><code>gcloud preview app</code></a> has no <code>app</code> command group</li>\n</ul>\n\n<p>This was removed with <a href=\"https://cloud.google.com/sdk/release_notes#9200_2016113\" rel=\"nofollow\">version 92.0.0</a> released on January 13, 2016.  That changelog recommends using <code>dev_appserver.py</code> instead.  An example can be found in <a href=\"https://cloud.google.com/appengine/docs/go/tools/using-local-server\" rel=\"nofollow\">Running the local development server</a>.</p>\n\n<pre><code>&gt; dev_appserver.py src/github.com/jamescharlesworth/bigtable-hello\n</code></pre>\n\n<p>Other flags and options can be found in <code>dev_appserver.py</code>'s documentation in <a href=\"https://cloud.google.com/appengine/docs/go/tools/local-devserver-command\" rel=\"nofollow\">Local Development Server Options</a>.</p>\n"}], "owner": {"reputation": 336, "user_id": 861693, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/81fd77e9430cb29127a36f9287f69a0f?s=128&d=identicon&r=PG", "display_name": "jamescharlesworth", "link": "https://stackoverflow.com/users/861693/jamescharlesworth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1797, "favorite_count": 0, "accepted_answer_id": 38906150, "answer_count": 1, "score": 2, "last_activity_date": 1472045088, "creation_date": 1456070074, "last_edit_date": 1467859870, "question_id": 35538279, "link": "https://stackoverflow.com/questions/35538279/error-gcloud-preview-app-invalid-choice-run", "title": "ERROR: (gcloud.preview.app) Invalid choice: &#39;run&#39;", "body": "<p>I'm trying to get the <a href=\"https://github.com/GoogleCloudPlatform/gcloud-golang/tree/master/examples/bigtable/bigtable-hello\" rel=\"nofollow noreferrer\">golang hello-world bigtable example</a> running locally locally and running into this issue. When I run <code>gcloud preview app run app.yaml</code> from the <code>bigtable-hello</code> directory, I get the following error:</p>\n\n<blockquote>\n  <p>\u279c  bigtable-hello  gcloud preview app run app.yaml\n  Usage: gcloud\n  preview app [optional flags]    group may be<br>\n  modules   command may be         deploy | gen-config</p>\n  \n  <p><em>(BETA)</em> This set of commands allows you to deploy your app, manage your existing deployments, and also run your app locally.  These\n  commands replace their equivalents in the appcfg tool.</p>\n  \n  <p>global flags:   Run <code>gcloud -h</code> for a description of flags available\n  to all commands.</p>\n  \n  <p>command groups:   modules                <em>(BETA)</em> View and manage your\n  App Engine modules.</p>\n  \n  <p>commands:   deploy                 <em>(BETA)</em> Deploy the local code\n  and/or configuration of\n                           your app to App Engine.   gen-config             <em>(BETA)</em> Generate missing configuration files for a\n                           source directory.</p>\n  \n  <p>ERROR: (gcloud.preview.app) Invalid choice: 'run'.</p>\n  \n  <p>Valid choices are [deploy, gen-config, gen-repo-info-file, instances,\n  modules, services, versions].</p>\n</blockquote>\n\n<p>I've put the demo files into my local go directory like below:\n<a href=\"https://i.stack.imgur.com/Prf4p.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Prf4p.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": true, "score": 4, "last_activity_date": 1456075910, "creation_date": 1456075910, "answer_id": 35539438, "question_id": 35538037, "link": "https://stackoverflow.com/questions/35538037/find-mgo-document-if-array-contains-matching-value/35539438#35539438", "title": "Find mgo document if array contains matching value", "body": "<p>Maybe I'm wrong but <code>Id</code> is defined as <code>bson.ObjectId</code> and you are querying it as string. Try to replace</p>\n\n<pre><code>err := repo.collection.Find(bson.M{\"_id\": user, \"artists\": bson.M{\"$in\": []bson.ObjectId{bson.ObjectIdHex(artist)}}}).One(&amp;userData)\n</code></pre>\n\n<p>with </p>\n\n<pre><code>err := repo.collection.Find(bson.M{\"_id\": bson.ObjectIdHex(user), \"artists\": bson.M{\"$in\": []bson.ObjectId{bson.ObjectIdHex(artist)}}}).One(&amp;userData)\n</code></pre>\n"}], "owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5497, "favorite_count": 0, "accepted_answer_id": 35539438, "answer_count": 1, "score": 1, "last_activity_date": 1456075910, "creation_date": 1456068815, "question_id": 35538037, "link": "https://stackoverflow.com/questions/35538037/find-mgo-document-if-array-contains-matching-value", "title": "Find mgo document if array contains matching value", "body": "<p>I have the following function in my API in order to check a user owns a related document</p>\n\n<pre><code>type User struct {\n    Id          bson.ObjectId   `bson:\"_id,omitempty\" json:\"id\"`\n    Name        string          `form:\"name\" bson:\"name,omitempty\" json:\"name,omitempty\"`\n    Password    string          `form:\"password\" bson:\"password,omitempty\" json:\"-\" binding:\"required\"`\n    Email       string          `form:\"email\" bson:\"email,omitempty\" json:\"email\" binding:\"required\"`\n    Artists     []bson.ObjectId `form:\"artists\" bson:\"artists,omitempty\" json:\"artists\" inline`\n    ContentFeed []bson.ObjectId `form:\"content_feed\" bson:\"content_feed,omitempty\" json:\"content_feed\" inline`\n    Location    string          `form:\"user_location\" bson:\"user_location,omitempty\" json:\"user_location,omitempty\"`\n    TopTracks   []bson.ObjectId `form:\"top_tracks\" bson:\"top_tracks\" json:\"top_tracks\" inline`\n    Avatar      string          `form:\"avatar\" bson:\"avatar,omitempty\" json:\"avatar,omitempty\"`\n    BgImg       string          `form:\"bg_img\" bson:\"bg_img,omitempty\" json:\"bg_img,omitempty\"`\n}\n\n// Get artist\n// This doesn't actual get the full artist object, this just checks that\n// the artist id given is stores against the given users list of artists\nfunc (repo *UserRepo) GetArtist(user string, artist string) (bool, error) {\n    userData := &amp;User{}\n    fmt.Println(user)\n    err := repo.collection.Find(bson.M{\"_id\": user, \"artists\": bson.M{\"$in\": []bson.ObjectId{bson.ObjectIdHex(artist)}}}).One(&amp;userData)\n\n    if err != nil {\n        fmt.Println(err)\n        return false, err\n    }\n\n    return true, err\n}\n</code></pre>\n\n<p>However it returns an error which prints 'not found', despite giving it two ID's which definitely exist and are related when I inspect the list of artist id's for that given user. </p>\n"}, {"tags": ["multithreading", "asynchronous", "go", "io"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1456067828, "post_id": 35537794, "comment_id": 58764330, "body": "There&#39;s no clean way to cancel a read from stdin. The usual way to do this is to just leave the read, and ignore any further input."}, {"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1456091050, "post_id": 35537794, "comment_id": 58773554, "body": "Why not use a io.ReadCloser ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456104339, "post_id": 35537794, "comment_id": 58777538, "body": "0x434d53: there&#39;s no way to interrupt a Read on stdin, even with a Close method."}], "owner": {"reputation": 105, "user_id": 1472065, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/df2ecedb97852e160fbcaa9f1ffab1a9?s=128&d=identicon&r=PG", "display_name": "user1472065", "link": "https://stackoverflow.com/users/1472065/user1472065"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1456069646, "creation_date": 1456067401, "last_edit_date": 1456069646, "question_id": 35537794, "link": "https://stackoverflow.com/questions/35537794/cancelling-input-read-from-io-reader-after-time-limit", "title": "Cancelling input read from io.Reader After Time Limit", "body": "<p>I am wondering how to cancel an input read after a timer expires. I am currently reading from input with</p>\n\n<pre><code>fmt.Fscanln(reader, &amp;var)\n</code></pre>\n\n<p>I have a channel that will be filled with a value as soon as the timer expires. I currently have the scan happening on a different go routine. This way, the function that scan's will return when it runs out of time. </p>\n\n<p>The problem is if the <code>io.Reader</code> passed to <code>fmt.Fscanln</code> is reading from <code>stdin</code>, it will still wait for input after its goroutine is over. Is there a way to cancel the read if time expires?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["if-statement", "reflection", "go", "types"], "answers": [{"comments": [{"owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "edited": false, "score": 1, "creation_date": 1456065238, "post_id": 35537378, "comment_id": 58763337, "body": "Third option: <code>if reflect.TypeOf(tst).Name() == &quot;string&quot;</code>"}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1456070305, "post_id": 35537378, "comment_id": 58765301, "body": "For your last point, wouldn&#39;t type check only work if <code>tst</code> was of interface type?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1456071333, "post_id": 35537378, "comment_id": 58765709, "body": "@Akavall yes but I&#39;m assuming it&#39;s already an interface type if we&#39;re doing this sort of checks"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 2, "last_activity_date": 1456065059, "creation_date": 1456065059, "answer_id": 35537378, "question_id": 35537094, "link": "https://stackoverflow.com/questions/35537094/turn-reflect-into-comparable-data/35537378#35537378", "title": "turn reflect into comparable data", "body": "<p>Two simple options:</p>\n\n<p>use <code>Kind</code>: </p>\n\n<pre><code>if reflect.TypeOf(tst).Kind() == reflect.String {\n    fmt.Println(\"It's a string!\")\n}\n</code></pre>\n\n<p>use <code>TypeOf</code> another string:</p>\n\n<pre><code>if reflect.TypeOf(tst) == reflect.TypeOf(\"\") {\n    fmt.Println(\"It's a string!\")\n}\n</code></pre>\n\n<p>However, personally I'd prefer a type switch or type check (i.e. <code>if _, ok := tst.(string); ok {...}</code></p>\n"}], "owner": {"reputation": 227, "user_id": 5956807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/75aeaea59178a778b256c7435a652fd5?s=128&d=identicon&r=PG", "display_name": "XXXX", "link": "https://stackoverflow.com/users/5956807/xxxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 35537378, "answer_count": 1, "score": 2, "last_activity_date": 1456065059, "creation_date": 1456063543, "question_id": 35537094, "link": "https://stackoverflow.com/questions/35537094/turn-reflect-into-comparable-data", "title": "turn reflect into comparable data", "body": "<p>I want to be able to compare the type of an object using <code>reflect</code>. Here is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    tst := \"cat\"\n    if reflect.TypeOf(tst) == string {\n        fmt.Println(\"It's a string!\")\n    }\n\n}\n</code></pre>\n\n<p>This gives me an error <code>type string is not an expression</code>. How can I fix this <strong>only using reflect</strong>? (no type switches, etc.)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9002, "user_id": 4509510, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mpfsBKz4Yjk/AAAAAAAAAAI/AAAAAAAAAGU/cLLwAFfWdUM/photo.jpg?sz=128", "display_name": "JesusTinoco", "link": "https://stackoverflow.com/users/4509510/jesustinoco"}, "edited": false, "score": 2, "creation_date": 1456057458, "post_id": 35535635, "comment_id": 58760687, "body": "You can find in the following link some approaches to get the function name: <a href=\"http://stackoverflow.com/questions/10742749/get-name-of-function-using-google-gos-reflection\" title=\"get name of function using google gos reflection\">stackoverflow.com/questions/10742749/&hellip;</a>"}, {"owner": {"reputation": 22099, "user_id": 828366, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/V8V1N.jpg?s=128&g=1", "display_name": "Francesco Casula", "link": "https://stackoverflow.com/users/828366/francesco-casula"}, "edited": false, "score": 1, "creation_date": 1526451242, "post_id": 35535635, "comment_id": 87743353, "body": "You should consider changing the accepted answer as it seems there&#39;s a new way of doing this."}], "answers": [{"comments": [{"owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "edited": false, "score": 0, "creation_date": 1456110546, "post_id": 35542124, "comment_id": 58779055, "body": "Nice one. My method was to inspect the call tree, but your is much less prone to error, and will work from routines not rooted in Test callstack. <a href=\"https://github.com/anacrolix/missinggo/blob/master/testing.go#L12\" rel=\"nofollow noreferrer\">github.com/anacrolix/missinggo/blob/master/testing.go#L12</a>"}], "tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": true, "score": 4, "last_activity_date": 1456089182, "creation_date": 1456089182, "answer_id": 35542124, "question_id": 35535635, "link": "https://stackoverflow.com/questions/35535635/get-the-name-of-the-currently-executing-testing-test/35542124#35542124", "title": "Get the name of the currently executing testing test?", "body": "<p>This is an interesting question. When you define a test, you pass around a struct that represents the test itself:</p>\n\n<pre><code>func TestSomething(t *testing.T) {\n</code></pre>\n\n<p><code>testing.T</code> is defined as follows:</p>\n\n<pre><code>type T struct {\n    common\n    name          string    // Name of test.\n    startParallel chan bool // Parallel tests will wait on this.\n}\n</code></pre>\n\n<p>So the struct <code>t</code> has the name of the test in a field called <code>name</code>. However, for some reason, the name is not exported and there is no public accessor that will return it. Therefore, you can't access it directly.</p>\n\n<p>There is a workaround. You can use the <code>reflect</code> package to access the unexported <code>name</code> and get the test name from <code>t</code>:</p>\n\n<pre><code>v := reflect.ValueOf(*t)\nname := v.FieldByName(\"name\")\n\n// name == \"TestSomething\"\n</code></pre>\n\n<p>I'm not sure if this is the best approach, but I was not able to find another reasonable solution to access <code>name</code> from the testing package.</p>\n"}, {"comments": [{"owner": {"reputation": 5465, "user_id": 2101290, "user_type": "registered", "accept_rate": 8, "profile_image": "https://i.stack.imgur.com/0zaN0.jpg?s=128&g=1", "display_name": "Balaji Boggaram Ramanarayan", "link": "https://stackoverflow.com/users/2101290/balaji-boggaram-ramanarayan"}, "edited": false, "score": 0, "creation_date": 1525469546, "post_id": 46544196, "comment_id": 87384090, "body": "What the he* is this ?"}], "tags": [], "owner": {"reputation": 1755, "user_id": 5598992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nxbrw.png?s=128&g=1", "display_name": "Sagi Forbes", "link": "https://stackoverflow.com/users/5598992/sagi-forbes"}, "is_accepted": false, "score": -2, "last_activity_date": 1507032246, "creation_date": 1507032246, "answer_id": 46544196, "question_id": 35535635, "link": "https://stackoverflow.com/questions/35535635/get-the-name-of-the-currently-executing-testing-test/46544196#46544196", "title": "Get the name of the currently executing testing test?", "body": "<p>The above answer is great. However, it <strong>does</strong> require an implementation on your part. In case you just need the name of the method do the following:</p>\n\n<p>Lets say that <code>t</code> is defined as: <code>t *testing.T</code> and you are running from a function called: <code>TestNetworkProbe</code>\nThen calling:</p>\n\n<pre><code>t.Log(\"Pass\",t)\n</code></pre>\n\n<p>Will produce (Scroll a little to the right and you shell find...)</p>\n\n<pre><code>Pass &amp;{{{{0 0} 0 0 0 0} [] false false false {63642628359 332863663 0x9bdec0} 0 0xc82008e090 0xc82006a300} TestNetworkProbe false 0xc82006a240}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1079, "user_id": 813503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474a8742d5971d0152fdb2da28b40ce9?s=128&d=identicon&r=PG", "display_name": "emptyflash", "link": "https://stackoverflow.com/users/813503/emptyflash"}, "edited": false, "score": 1, "creation_date": 1526258550, "post_id": 49815040, "comment_id": 87659502, "body": "Seems like this might be new? Either way this should be the excepted answer now."}], "tags": [], "owner": {"reputation": 22099, "user_id": 828366, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/V8V1N.jpg?s=128&g=1", "display_name": "Francesco Casula", "link": "https://stackoverflow.com/users/828366/francesco-casula"}, "is_accepted": false, "score": 14, "last_activity_date": 1587539806, "last_edit_date": 1587539806, "creation_date": 1523615785, "answer_id": 49815040, "question_id": 35535635, "link": "https://stackoverflow.com/questions/35535635/get-the-name-of-the-currently-executing-testing-test/49815040#49815040", "title": "Get the name of the currently executing testing test?", "body": "<p>Just use the <code>Name()</code> method:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func TestSomethingReallyCool(t *testing.T) {\n    t.Logf(\"Test name is %s\", t.Name())\n}\n</code></pre>\n\n<p>Here's the <a href=\"https://golang.org/pkg/testing/#B.Name\" rel=\"noreferrer\">docs</a> and here's the <a href=\"https://github.com/golang/go/blob/release-branch.go1.14/src/testing/testing.go#L591\" rel=\"noreferrer\">code</a>.</p>\n"}], "owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2461, "favorite_count": 2, "accepted_answer_id": 35542124, "answer_count": 3, "score": 7, "last_activity_date": 1587539806, "creation_date": 1456054870, "last_edit_date": 1556641002, "question_id": 35535635, "link": "https://stackoverflow.com/questions/35535635/get-the-name-of-the-currently-executing-testing-test", "title": "Get the name of the currently executing testing test?", "body": "<p>In Go, how would I get the name of the currently executing test, the function name starting with <code>Test</code>, of the current test without passing it in manually?</p>\n"}, {"tags": ["variables", "go"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5507746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5ecfe042edf4c40475eede37bab39a?s=128&d=identicon&r=PG&f=1", "display_name": "sup3rs3nior", "link": "https://stackoverflow.com/users/5507746/sup3rs3nior"}, "edited": false, "score": 0, "creation_date": 1456114246, "post_id": 35534141, "comment_id": 58779961, "body": "Thank you, I definitely didn&#39;t mean to re-initialize pageID. What about offset, err :=... since err is a new variable? Will go assume that I&#39;m only initializing err since offset already exists and I need the value later on?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11, "user_id": 5507746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5ecfe042edf4c40475eede37bab39a?s=128&d=identicon&r=PG&f=1", "display_name": "sup3rs3nior", "link": "https://stackoverflow.com/users/5507746/sup3rs3nior"}, "edited": false, "score": 0, "creation_date": 1456125600, "post_id": 35534141, "comment_id": 58783977, "body": "@sup3rs3nior It will create 2 new variables, because <code>offset</code> was declared in the containing block. But read the <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">spec</a>, because using short variable declaration where 1 variable is new and 1 variable already exists which it was declared in the <i>same</i> block, that is a <i>redeclaration</i> which will only assign a new value to the existing one."}, {"owner": {"reputation": 11, "user_id": 5507746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5ecfe042edf4c40475eede37bab39a?s=128&d=identicon&r=PG&f=1", "display_name": "sup3rs3nior", "link": "https://stackoverflow.com/users/5507746/sup3rs3nior"}, "edited": false, "score": 0, "creation_date": 1456169663, "post_id": 35534141, "comment_id": 58812691, "body": "I&#39;m not sure if I should or shouldn&#39;t use the short variable declaration. If I use it, I get variable initialized and not used, if I don&#39;t, I get undefined. <a href=\"http://play.golang.org/p/WsQ1m_4ReK\" rel=\"nofollow noreferrer\">play.golang.org/p/WsQ1m_4ReK</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11, "user_id": 5507746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5ecfe042edf4c40475eede37bab39a?s=128&d=identicon&r=PG&f=1", "display_name": "sup3rs3nior", "link": "https://stackoverflow.com/users/5507746/sup3rs3nior"}, "edited": false, "score": 0, "creation_date": 1456170702, "post_id": 35534141, "comment_id": 58813283, "body": "@sup3rs3nior Since you want the value to be visible after the block, you can&#39;t / musn&#39;t use short variable declaration. So you have to use assignment <code>=</code>. But assignment requires all variable to be declared prior. So before calling <code>loader()</code>, declare the <code>err</code> variable, e.g. <code>var err string</code>. See working example: <a href=\"http://play.golang.org/p/F9IZQW-7qH\" rel=\"nofollow noreferrer\">play.golang.org/p/F9IZQW-7qH</a>"}, {"owner": {"reputation": 11, "user_id": 5507746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5ecfe042edf4c40475eede37bab39a?s=128&d=identicon&r=PG&f=1", "display_name": "sup3rs3nior", "link": "https://stackoverflow.com/users/5507746/sup3rs3nior"}, "edited": false, "score": 0, "creation_date": 1456170902, "post_id": 35534141, "comment_id": 58813409, "body": "I&#39;m a little worried that the first time I&#39;ve ever seen an err initialized before getting a value is in my code. Do you think that&#39;s an indicator that I&#39;m doing something wrong?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11, "user_id": 5507746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5ecfe042edf4c40475eede37bab39a?s=128&d=identicon&r=PG&f=1", "display_name": "sup3rs3nior", "link": "https://stackoverflow.com/users/5507746/sup3rs3nior"}, "edited": false, "score": 0, "creation_date": 1456171330, "post_id": 35534141, "comment_id": 58813651, "body": "@sup3rs3nior Not particularly in the last example you showed here. When this is the exact situation (you assign in a block after which you need the value) it is common that a variable needs to be declared first before calling a function having multi-return values."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1471850136, "last_edit_date": 1471850136, "creation_date": 1456044810, "answer_id": 35534141, "question_id": 35533960, "link": "https://stackoverflow.com/questions/35533960/how-do-i-create-a-variable-in-go-only-if-a-condition-is-true/35534141#35534141", "title": "How do I create a variable in go only if a condition is true?", "body": "<p>If you declare a variable before an <code>if</code> statement and you use it inside the <code>if</code> block, it doesn't matter what the condition evaluates to, it is not a compile time error.</p>\n\n<p>The error in you case is that you don't use the declared variable inside the <code>if</code> block. Your code:</p>\n\n<pre><code>var pageID string\nvar offset int\nif len(r.URL.Path) &gt; len(\"/page/\") {\n    pageID := r.URL.Path[len(\"/page/\"):]\n    offset, err := strconv.Atoi(pageID)\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>Inside the <code>if</code> you are not assigning to the previously declared <code>pageID</code>, but you are using <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow\">short variable declaration</a> <code>:=</code> which creates a new variable, shadowing the one created in the outer block, and it is in effect only at the end of the <code>if</code> block (its scope ends at the end of the innermost containing block).</p>\n\n<p>Solution is (what you most likely wanted to) simply use assignment <code>=</code> (which assigns value to the existing variable):</p>\n\n<pre><code>    pageID = r.URL.Path[len(\"/page/\"):]\n</code></pre>\n\n<hr>\n\n<p>To make it understand, see this example:</p>\n\n<pre><code>i := 1\nfmt.Println(\"Outer:\", i)\n{\n    i := 2 // Short var decl: creates a new i, shadowing the outer\n    fmt.Println(\"Inner:\", i)\n}\nfmt.Println(\"Outer again:\", i)\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/u1CUUWA3DJ\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>Outer: 1\nInner: 2\nOuter again: 1\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5507746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5ecfe042edf4c40475eede37bab39a?s=128&d=identicon&r=PG&f=1", "display_name": "sup3rs3nior", "link": "https://stackoverflow.com/users/5507746/sup3rs3nior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 35534141, "answer_count": 1, "score": 0, "last_activity_date": 1471850136, "creation_date": 1456043387, "last_edit_date": 1456045307, "question_id": 35533960, "link": "https://stackoverflow.com/questions/35533960/how-do-i-create-a-variable-in-go-only-if-a-condition-is-true", "title": "How do I create a variable in go only if a condition is true?", "body": "<p>If I create a variable inside an if block, I can't use it later on. If I create a variable before the if block and the if block evaluates to false, I get a \"variable created and not used\" error.</p>\n\n<p>I'm certain that this is by design and I'm trying to do something I shouldn't, but the logic behind what I'm trying to do makes sense to me. If there is page info in the url, I want to use it in a sql statement later on, but if there isn't page info in the url, then I don't need those variables.</p>\n\n<p><a href=\"http://pastebin.com/QqwpdM1d\" rel=\"nofollow\">http://pastebin.com/QqwpdM1d</a></p>\n\n<p>Edit: here's the code:</p>\n\n<pre><code>var pageID string\nvar offset int\nif len(r.URL.Path) &gt; len(\"/page/\") {\n    pageID := r.URL.Path[len(\"/page/\"):]\n    offset, err := strconv.Atoi(pageID)\n    if err != nil {\n        log.Fatal(err)\n    }\n}\nconn := \"...\"\ndb, err := sql.Open(\"mysql\", conn)\ndefer db.Close()\nif err != nil {\n    log.Fatal(err)\n}\nvar rows *sql.Rows\nif offset != 0 {\n    // ...\n}\n</code></pre>\n"}, {"tags": ["string", "pointers", "reflection", "go", "struct"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1510649433, "last_edit_date": 1510649433, "creation_date": 1456049206, "answer_id": 35534762, "question_id": 35533837, "link": "https://stackoverflow.com/questions/35533837/how-to-set-a-struct-member-that-is-a-pointer-to-a-string-using-reflection-in-go/35534762#35534762", "title": "How to set a struct member that is a pointer to a string using reflection in Go", "body": "<p><a href=\"https://golang.org/pkg/reflect/#Value.SetPointer\" rel=\"nofollow noreferrer\"><code>Value.SetPointer()</code></a> can only be used if the value's kind is <code>reflect.UnsafePointer</code> (as reported by <a href=\"https://golang.org/pkg/reflect/#Value.Kind\" rel=\"nofollow noreferrer\"><code>Value.Kind()</code></a>), but yours is <code>reflect.Ptr</code> so <code>SetPointer()</code> will panic (as documented).</p>\n\n<p>Simply use the <a href=\"https://golang.org/pkg/reflect/#Value.Set\" rel=\"nofollow noreferrer\"><code>Value.Set()</code></a> method to change the value of the struct field (it being pointer or not, doesn't matter). It expects an argument of type <a href=\"https://golang.org/pkg/reflect/#Value\" rel=\"nofollow noreferrer\"><code>reflect.Value</code></a> which you can obtain by calling <a href=\"https://golang.org/pkg/reflect/#ValueOf\" rel=\"nofollow noreferrer\"><code>reflect.ValueOf()</code></a>, and simply pass the address of the parameter <code>value</code>:</p>\n\n<pre><code>fld.Set(reflect.ValueOf(&amp;value))\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>type Config struct {\n    SolutionStackName *string\n}\n\nc := new(Config)\nfmt.Println(c.SolutionStackName)\ncheckConfig2(c, \"SolutionStackName\", \"teststring\")\nfmt.Println(*c.SolutionStackName)\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/OPDI13RBQ4\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>&lt;nil&gt;\nteststring\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 5737452, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/17e1cbf59bde9523ef8a433fbe774cad?s=128&d=identicon&r=PG&f=1", "display_name": "desi Joe", "link": "https://stackoverflow.com/users/5737452/desi-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4194, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1510649433, "creation_date": 1456042540, "last_edit_date": 1456049583, "question_id": 35533837, "link": "https://stackoverflow.com/questions/35533837/how-to-set-a-struct-member-that-is-a-pointer-to-a-string-using-reflection-in-go", "title": "How to set a struct member that is a pointer to a string using reflection in Go", "body": "<p>I am trying to use reflection to set a pointer. <code>elasticbeanstalk.CreateEnvironmentInput</code> has a field <code>SolutionStackName</code> which is of type <code>*string</code>. I am getting the following error when I try to set any value:</p>\n\n<pre><code>panic: reflect: call of reflect.Value.SetPointer on ptr Value\n</code></pre>\n\n<p>Here is my code: </p>\n\n<pre><code>    ...\nnewEnvCnf := new(elasticbeanstalk.CreateEnvironmentInput)\ncheckConfig2(newEnvCnf, \"SolutionStackName\", \"teststring\")\n    ...\nfunc checkConfig2(cnf interface{}, key string, value string) bool {\n    log.Infof(\"key %v, value %s\", key, value)\n\n    v := reflect.ValueOf(cnf).Elem()\n    fld := v.FieldByName(key)\n\n    if fld.IsValid() {\n        if fld.IsNil() &amp;&amp; fld.CanSet() {\n            fld.SetPointer(unsafe.Pointer(aws.String(value)))\n//aws.String returns a pointer\n\n...\n</code></pre>\n\n<p>Here is the log output</p>\n\n<pre><code>time=\"2016-02-20T23:54:52-08:00\" level=info msg=\"key [SolutionStackName], value teststring\" \n    panic: reflect: call of reflect.Value.SetPointer on ptr Value [recovered]\n        panic: reflect: call of reflect.Value.SetPointer on ptr Value\n</code></pre>\n"}, {"tags": ["json", "go", "yaml", "viper-go"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 2, "creation_date": 1456033939, "post_id": 35532732, "comment_id": 58754773, "body": "I don&#39;t know the answer to the second question, but the answer to the first is that the YAML in your question <i>is</i> the correct way to represent the JSON in your question. I don&#39;t know why the linked site is giving the &quot;Unable to parse&quot; error, but here&#39;s another site that has no trouble parsing it: <a href=\"http://yaml-online-parser.appspot.com/\" rel=\"nofollow noreferrer\">yaml-online-parser.appspot.com</a>"}, {"owner": {"reputation": 225, "user_id": 1507342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5165ad3df4cd59728ea24317698f15bc?s=128&d=identicon&r=PG&f=1", "display_name": "d1str0", "link": "https://stackoverflow.com/users/1507342/d1str0"}, "edited": false, "score": 0, "creation_date": 1456051122, "post_id": 35532732, "comment_id": 58758740, "body": "Your second question is very vague. Did you try anything yourself? If so, what? Did you not try anything? What documentation are you looking at? This readme has examples: <a href=\"https://github.com/spf13/viper/blob/master/README.md\" rel=\"nofollow noreferrer\">github.com/spf13/viper/blob/master/README.md</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": true, "score": 1, "last_activity_date": 1456051844, "creation_date": 1456051844, "answer_id": 35535166, "question_id": 35532732, "link": "https://stackoverflow.com/questions/35532732/converting-json-object-array-to-yaml/35535166#35535166", "title": "Converting JSON object array to YAML", "body": "<p>Code is ugly but looks like this library does not like nested arrays of objects.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"github.com/spf13/viper\"\n)\n\nfunc main() {\n    viper.SetConfigType(\"yaml\")\n    var yamlExample = []byte(`---\n  siteidparam: \"lid\"\n  sites:\n    -\n      name: \"default\"\n      routingmethod:\n        method: \"urlparam\"\n        siteid: \"default\"\n        urlpath: \"default\"\n    -\n      name: \"csqcentral\"\n      routingmethod:\n        method: \"urlparam\"\n        siteid: \"capitolsquare\"\n        urlpath: \"csq\"`)\n\n    viper.ReadConfig(bytes.NewReader(yamlExample))\n\n    fmt.Printf(\"%s\\n\", viper.GetString(\"siteidparam\"))\n\n    sites := viper.Get(\"sites\").([]interface{})\n    for i, _ := range sites {\n        site := sites[i].(map[interface{}]interface{})\n        fmt.Printf(\"%s\\n\", site[\"name\"])\n        routingmethod := site[\"routingmethod\"].(map[interface{}]interface{})\n        fmt.Printf(\"  %s\\n\", routingmethod[\"method\"])\n        fmt.Printf(\"  %s\\n\", routingmethod[\"siteid\"])\n        fmt.Printf(\"  %s\\n\", routingmethod[\"urlpath\"])\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1456083374, "post_id": 35535180, "comment_id": 58770561, "body": "OP&#39;s YAML was perfectly valid. Removing the leading indentation does not make it more valid. If there are YAML parsers that consider indentation at the &quot;root&quot; level invalid, those parsers don&#39;t comply with the YAML spec."}], "tags": [], "owner": {"reputation": 9002, "user_id": 4509510, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mpfsBKz4Yjk/AAAAAAAAAAI/AAAAAAAAAGU/cLLwAFfWdUM/photo.jpg?sz=128", "display_name": "JesusTinoco", "link": "https://stackoverflow.com/users/4509510/jesustinoco"}, "is_accepted": false, "score": 1, "last_activity_date": 1456051939, "creation_date": 1456051939, "answer_id": 35535180, "question_id": 35532732, "link": "https://stackoverflow.com/questions/35532732/converting-json-object-array-to-yaml/35535180#35535180", "title": "Converting JSON object array to YAML", "body": "<p>The issue with parsing your YAML to JSON is that it has two spaces in each items. It should be like this:</p>\n\n<pre><code>---\nsiteidparam: \"lid\"\nsites: \n  - \n    name: \"default\"\n    routingmethod: \n      method: \"urlparam\"\n      siteid: \"default\"\n      urlpath: \"default\"\n  - \n    name: \"csqcentral\"\n    routingmethod: \n      method: \"urlparam\"\n      siteid: \"capitolsquare\"\n      urlpath: \"csq\"\n</code></pre>\n\n<p>About your second question find below a simple snippet about how to achive that:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"github.com/spf13/viper\"\n)\n\nfunc main() {\n    viper.SetConfigType(\"yaml\") // or viper.SetConfigType(\"YAML\")\n    var yamlExample2 = []byte(`\n---\nsiteidparam: \"lid\"\nsites:\n  -\n    name: \"default\"\n    routingmethod:\n      method: \"urlparam\"\n      siteid: \"default\"\n      urlpath: \"default\"\n  -\n    name: \"csqcentral\"\n    routingmethod:\n      method: \"urlparam\"\n      siteid: \"capitolsquare\"\n      urlpath: \"csq\"\n`)\n    viper.ReadConfig(bytes.NewBuffer(yamlExample2))\n    fmt.Println(viper.Get(`sites`))\n}\n</code></pre>\n"}], "owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1711, "favorite_count": 1, "accepted_answer_id": 35535166, "answer_count": 2, "score": 0, "last_activity_date": 1456051939, "creation_date": 1456033161, "question_id": 35532732, "link": "https://stackoverflow.com/questions/35532732/converting-json-object-array-to-yaml", "title": "Converting JSON object array to YAML", "body": "<p>I have the following json which needs to convert to YAML</p>\n\n<pre><code>{\n  \"siteidparam\": \"lid\",\n  \"sites\": [\n    {\n      \"name\": \"default\",\n      \"routingmethod\": {\n        \"method\": \"urlparam\",\n        \"siteid\": \"default\",\n        \"urlpath\": \"default\"\n      }\n    },\n    {\n      \"name\": \"csqcentral\",\n      \"routingmethod\": {\n        \"method\": \"urlparam\",\n        \"siteid\": \"capitolsquare\",\n        \"urlpath\": \"csq\"\n      }\n    }\n  ]\n}\n</code></pre>\n\n<p>I used <a href=\"http://jsontoyaml.com/\" rel=\"nofollow\">online JSON to YAML converter</a> and it gave the following output,</p>\n\n<pre><code>---\n  siteidparam: \"lid\"\n  sites: \n    - \n      name: \"default\"\n      routingmethod: \n        method: \"urlparam\"\n        siteid: \"default\"\n        urlpath: \"default\"\n    - \n      name: \"csqcentral\"\n      routingmethod: \n        method: \"urlparam\"\n        siteid: \"capitolsquare\"\n        urlpath: \"csq\"\n</code></pre>\n\n<p>when I tried to convert the same generated YAML back to json <a href=\"http://yamltojson.com/\" rel=\"nofollow\">from the online service</a>, it gives \"Unable to parse\" exception.</p>\n\n<p>1.) what is the correct way of representing above kind of jsons in YAML? </p>\n\n<p>I want to read this kind of YAML inside my golang program. For that I'm using spf13/viper library, but I couldn't find any method which is able to decode this king of array objects.</p>\n\n<p>2.) How to read this kind of YAML in golang using viper? Sample code would help.</p>\n"}, {"tags": ["csv", "go", "strconv"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1456031665, "post_id": 35532414, "comment_id": 58754407, "body": "The one thing I noticed is that you&#39;re not converting stat[0] to a time.Time. You can do that with time.Parse() or time.ParseInLocation(). Do you have any specific questions?"}], "answers": [{"tags": [], "owner": {"reputation": 60, "user_id": 3681487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97754d23d40bbe7dce50f3424991b697?s=128&d=identicon&r=PG", "display_name": "Jordan", "link": "https://stackoverflow.com/users/3681487/jordan"}, "is_accepted": true, "score": 1, "last_activity_date": 1456032273, "creation_date": 1456032273, "answer_id": 35532640, "question_id": 35532414, "link": "https://stackoverflow.com/questions/35532414/read-csv-string-into-list-of-custom-objects-go-language/35532640#35532640", "title": "Read CSV String Into List of Custom Objects Go Language", "body": "<p>There's a few things that I notice right off the bat:</p>\n\n<ul>\n<li><p>You're not using a <code>time.Time</code> object to send to your <code>yahooInfoObj</code> struct. You're sending a string</p></li>\n<li><p>You're calling functions that return multiple values in a \"single value context\". This means that you are just expecting to ignore the second value, but to Go this is an error in your coding. You'll have to explicitly set these values.</p></li>\n<li><p>You're not checking multiple errors. Always check errors - it'll prevent \"gotchas\" in the future.</p></li>\n</ul>\n\n<p>It's not perfect, but here's a seemingly working playground: <a href=\"https://play.golang.org/p/idQFFVjS-X\" rel=\"nofollow\">https://play.golang.org/p/idQFFVjS-X</a></p>\n"}], "owner": {"reputation": 1041, "user_id": 2382635, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4c4f067f9ab766d64ebd6c2e1bedbf64?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2382635/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 35532640, "answer_count": 1, "score": 0, "last_activity_date": 1456032273, "creation_date": 1456029761, "question_id": 35532414, "link": "https://stackoverflow.com/questions/35532414/read-csv-string-into-list-of-custom-objects-go-language", "title": "Read CSV String Into List of Custom Objects Go Language", "body": "<p>I am trying to read a string of data from a csv file and parse the data into a list of custom objects. The main issue that I am having is converting the data to the correct datatype within the loop.</p>\n\n<p>Here is my custom object:</p>\n\n<pre><code>type yahooInfoObj struct {\n    date time.Time\n    open float32\n    high float32\n    low float32\n    close float32\n    volume int\n    adjClose float32\n}\n</code></pre>\n\n<p>Here is my function that gets the data and attempts to parse it:</p>\n\n<pre><code>func getSingleCompanyData(search searchObj) []yahooInfoObj {\n    searchQuery := buildYahooFinanceDataQueryString(search)\n    data := getRequest(searchQuery)\n\n    r := csv.NewReader(strings.NewReader(data))\n    var stats []yahooInfoObj\n\n    // Read csv file\n    result, _ := r.ReadAll()\n\n    //loop through each returned stat (line)\n    for i := range result {\n        //skip the first entry due to column names being returned\n        if i != 0{\n            stat := result[i]\n            stats = append(stats, yahooInfoObj{stat[0],strconv.ParseFloat(stat[1],32),strconv.ParseFloat(stat[2],32),strconv.ParseFloat(stat[3],32),strconv.ParseFloat(stat[4],32),strconv.Atoi(stat[5]),strconv.ParseFloat(stat[6],32)})\n        }\n    }\n\n    return stats\n}\n</code></pre>\n\n<p>Here is some sample data of which would be returned and placed in the data variable:</p>\n\n<pre><code>Date,Open,High,Low,Close,Volume,Adj Close\n2010-12-31,31.219999,31.33,30.93,31.299999,11716300,29.517661\n2010-12-30,31.450001,31.58,31.209999,31.290001,12989400,29.508232\n2010-12-29,31.530001,31.690001,31.42,31.50,9769000,29.706273\n2010-12-28,31.66,31.76,31.41,31.57,9736000,29.772287\n</code></pre>\n\n<p>I am new to the go language and would really appreciate any advice. Thanks in advance!</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1456047573, "post_id": 35531668, "comment_id": 58757649, "body": "Your &quot;More&quot; info sounds like your filters should work on interfaces while the JSON decoding happens completely on material structs which sounds reasonable and you do not need to JSON decode into interfaces. Maybe you should show real code as I cannot see any difficulty here: What is wrong implementing the methods your structs need to have to conform to an interface?"}], "answers": [{"comments": [{"owner": {"reputation": 10776, "user_id": 749477, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6845c6b2318e02258cc1dc56fe620482?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/749477/derek"}, "edited": false, "score": 0, "creation_date": 1456026388, "post_id": 35531961, "comment_id": 58753490, "body": "added more info to my question. Really appreciate your answer."}], "tags": [], "owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "is_accepted": false, "score": 2, "last_activity_date": 1456025557, "creation_date": 1456025557, "answer_id": 35531961, "question_id": 35531668, "link": "https://stackoverflow.com/questions/35531668/creating-an-interface-for-a-json-struct-in-golang/35531961#35531961", "title": "Creating an interface for a JSON struct in golang", "body": "<p>Interfaces in Go specify <em>behaviour</em>, but you're trying to use them to describe <em>data</em>. This is why you're finding your approach to be difficult - and it's also why it's probably the wrong approach.</p>\n\n<p>It's difficult to give a more specific answer without knowing what you're really trying to achieve, but if you, for example, want to be able to have functions that can read specific named fields from different struct types, you'll probably want to define one struct to describe this data and then embed that struct into other struct types.</p>\n\n<p>Something like this might fit your needs:</p>\n\n<pre><code>type Person struct {\n    FirstName string `json:\"firstName\"`\n}\n\ntype User struct {\n    Person\n    // other User-specific fields\n}\n\ntype Admin struct {\n    Person\n    // other Admin-specific fields\n}\n\nfunc Harass(p Person) { }\n\nfunc main() {\n    user := User{Person{\"Frank\"}}\n    Harass(user.Person)\n    admin := Admin{Person{\"Angelina\"}}\n    Harass(admin.Person)\n}\n</code></pre>\n"}], "owner": {"reputation": 10776, "user_id": 749477, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6845c6b2318e02258cc1dc56fe620482?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/749477/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456026366, "creation_date": 1456022439, "last_edit_date": 1456026366, "question_id": 35531668, "link": "https://stackoverflow.com/questions/35531668/creating-an-interface-for-a-json-struct-in-golang", "title": "Creating an interface for a JSON struct in golang", "body": "<p>Say I have a <code>struct</code> that I bind <code>json</code> param data to like</p>\n\n<pre><code>type User struct {\n  FirstName string `json:\"firstName\"`\n}\n</code></pre>\n\n<p>The attribute <code>FirstName</code> has to be capitalized so that the <code>json</code> values can be binded to the struct.</p>\n\n<p>But I also want to create an <code>interface</code> to accept any <code>struct</code> that has a <code>FirstName</code> like attribute.  Since <code>FirstName</code> is already capitalized and taken, I have to name the method something else.</p>\n\n<pre><code>type NameInterface interface {\n    FirstName() string // nope\n    FirstNameValue() string // maybe?\n}\n</code></pre>\n\n<p>But it seems really weird to have to add a helper function for each attribute on all my <code>json</code> <code>struct</code>s just so they can work with an <code>interface</code>.  Is there something I'm misunderstanding or a programming pattern I'm missing?  What is the best way to get a <code>json</code> <code>struct</code> to work with <code>interfaces</code> in <code>go</code>?</p>\n\n<p>More (what I am trying to do):</p>\n\n<p>I want to parse <code>json</code> params that are coming from my <code>controllers</code> into <code>structs</code>.  And then pass that <code>struct</code> data into <code>filters</code> which then run <code>sql</code> commands to filter data based on the params data.  I wanted to use <code>interfaces</code> so I can pass in <code>structs</code> created from different sources into my <code>filters</code>.</p>\n"}, {"tags": ["mongodb", "go", "struct", "bson", "mgo"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1456141575, "post_id": 35530914, "comment_id": 58793451, "body": "Is there a special reason not to use a struct?"}, {"owner": {"reputation": 25, "user_id": 5076622, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d233a55e0265ca344016e6c28bddd9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5076622/sohail-shaikh"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1456142642, "post_id": 35530914, "comment_id": 58794181, "body": "Is it can achieve with nested struct @Markus W Mahlberg"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1456142734, "post_id": 35530914, "comment_id": 58794234, "body": "Of course. ;) I do it all the day."}, {"owner": {"reputation": 25, "user_id": 5076622, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d233a55e0265ca344016e6c28bddd9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5076622/sohail-shaikh"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1456142816, "post_id": 35530914, "comment_id": 58794274, "body": "Will u please give me a demo"}, {"owner": {"reputation": 25, "user_id": 5076622, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d233a55e0265ca344016e6c28bddd9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5076622/sohail-shaikh"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1456208372, "post_id": 35530914, "comment_id": 58828014, "body": "@Markus W Mahlberg waiting for your answer ... Help me please I&#39;m very badly stuck with this."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1456236522, "post_id": 35530914, "comment_id": 58845935, "body": "take a look at <a href=\"https://gist.github.com/border/3489566\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 25, "user_id": 5076622, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d233a55e0265ca344016e6c28bddd9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5076622/sohail-shaikh"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1456240426, "post_id": 35530914, "comment_id": 58848920, "body": "@RickyA Do you know how to type assert  []bson.M to simple map or string? Or is it possible to create struct dynamically ?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 1, "creation_date": 1456303378, "post_id": 35530914, "comment_id": 58879257, "body": "I wrote a demo below, but I have a few things to note. a) @RickyA gave you a useful link. If you had read it properly, you would have had your solution. b) You are talking to peers, asking for something. &quot;Not helpful&quot; is even dumb for what you want to achieve. If you had described in which way the link wasn&#39;t helpful, maybe somebody would have had the motivation to help you further. c) Your example data is syntactically incorrect. Next time, please add a <a href=\"http://www.stackoverflow.com/help/mcve\">minimal, complete and verifiable example</a>."}, {"owner": {"reputation": 25, "user_id": 5076622, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d233a55e0265ca344016e6c28bddd9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5076622/sohail-shaikh"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1456311454, "post_id": 35530914, "comment_id": 58884948, "body": "I apologise to you both, i&#39;m new with go and mongo, i was frustrated that i could not able to do this, and that is my college project, and i need to submit it tomorrow.. thanks for your help @RickyA and Markus W Mahlberg and sorry once again it will never happen again."}], "answers": [{"comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1456312016, "post_id": 35597129, "comment_id": 58885398, "body": "hat off for the amount of effort you have thrown this cause."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1456317434, "post_id": 35597129, "comment_id": 58889324, "body": "@RickyA Thank you, Sir. Let&#39;s call it a finger exercise?"}], "tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": true, "score": 4, "last_activity_date": 1456303172, "creation_date": 1456303172, "answer_id": 35597129, "question_id": 35530914, "link": "https://stackoverflow.com/questions/35530914/how-to-retrieve-bson-m-type-of-map/35597129#35597129", "title": "How to retrieve []bson.M type of map", "body": "<p>I'll provide you with a general example to help you understand, since SO is not a free coding service, but a platform where peers help each other to take a grasp on the problem.</p>\n\n<p>My approach is not to use <strong><code>bson.M</code></strong> at all for the returned value. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n)\n\ntype Baz struct {\n    Date  time.Time\n    Value int\n}\n\ntype Bar struct {\n    Name string\n    Baz  []Baz\n}\n\ntype Foo struct {\n    Owner  string\n    hidden int\n    Bar    Bar\n}\n\nconst (\n    ds   = \"localhost:27017\"\n    db   = \"test\"\n    coll = \"nestdemo\"\n)\n\nfunc main() {\n\n    o := Foo{\n        Owner:  \"me\",\n        hidden: 1,\n        Bar: Bar{\n            Name: \"funky\",\n            Baz: []Baz{\n                Baz{Date: time.Now(), Value: 42},\n            },\n        },\n    }\n\n    // CHECK ERRORS in production environments\n    conn, _ := mgo.Dial(ds)\n    defer conn.Close()\n\n    c := conn.DB(db).C(coll)\n    c.Insert(o)\n\n    l := &amp;Foo{}\n\n    c.Find(bson.M{\"owner\": \"me\"}).One(l)\n\n    fmt.Printf(\"Loaded data: %+v\\n\", l)\n    fmt.Printf(\n        \"You got your answer to life, the universe and all the rest at %s: %d\\n\",\n        l.Bar.Baz[0].Date.Format(time.Kitchen), l.Bar.Baz[0].Value,\n    )\n}\n</code></pre>\n\n<p>You can run this program on you local machine (with the constants adjusted as needed), which should give you an output looking like this:</p>\n\n<pre><code>$ go run main.go \nLoaded data: &amp;{Owner:me hidden:0 Bar:{Name:funky Baz:[{Date:2016-02-24 09:00:06.471 +0100 CET Value:42}]}}\nYou got your answer to life, the universe and all the rest at 9:00AM: 42\n</code></pre>\n\n<p>The entry in the according collection should read something like this:</p>\n\n<pre><code>{\n  \"_id\" : ObjectId(\"56cd6306538ba56563bdab76\"),\n  \"owner\" : \"me\",\n  \"bar\" : {\n    \"name\" : \"funky\",\n    \"baz\" : [\n      {\n        \"date\" : ISODate(\"2016-02-24T08:00:06.471Z\"),\n        \"value\" : 42\n      }\n    ]\n  }\n}\n</code></pre>\n\n<p>A few things are to note here.</p>\n\n<ol>\n<li>I didn't need a single character in my struct definitions to have the structs marshaled to and marshaled from BSON. It was done automagically by mgo <a href=\"https://godoc.org/labix.org/v2/mgo/bson#Marshal\" rel=\"nofollow\">according to the rules described in the docs</a>. However, you <em>can</em> customize the behavior of the (un-)marshaling, as described there.</li>\n<li>Unexported fields (<strong><code>hidden</code></strong> in this example) take their zero value upon unmarshalling \u2013 keep that in mind, it can bite you in the neck.</li>\n<li>There is no need to use <strong><code>bson.M</code></strong> to handle your data, which makes life a lot easier \u2013 no manual type conversions, for example.</li>\n</ol>\n\n<p>In summary: All you need to do is to create a struct your data can be unmarhaled into. Then you can access the various fields as usual, without string fiddling and alike. That's bit of work, but a rather trivial one, as you can see.</p>\n\n<p><strong>Note:</strong> The data model you have shown is both syntactically and conceptually incorrect. Setting aside the former for now: It is a very bad practice to have values as keys, as shown in the <strong><code>group</code></strong> subdoc. This will always force you to deal with string parsing back and forth, making your life with MongoDB as complicated as it can get as a developer.</p>\n\n<p>My above suggestion assumes you will correct that into something like:</p>\n\n<pre><code>{\n\u2026\n  groups:[\n    {grp_id: 1, grp_name: \"grp\"},\n    {grp_id: 2, grp_name: \"secondGrp\"}\n  ]\n\u2026\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5076622, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d233a55e0265ca344016e6c28bddd9a0?s=128&d=identicon&r=PG&f=1", "display_name": "Sohail Shaikh", "link": "https://stackoverflow.com/users/5076622/sohail-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5646, "favorite_count": 0, "accepted_answer_id": 35597129, "answer_count": 1, "score": 2, "last_activity_date": 1456303172, "creation_date": 1456015381, "last_edit_date": 1456302664, "question_id": 35530914, "link": "https://stackoverflow.com/questions/35530914/how-to-retrieve-bson-m-type-of-map", "title": "How to retrieve []bson.M type of map", "body": "<p>How to retrieve multidimensional []bson.M type of map </p>\n\n<p>The data in mongo is like</p>\n\n<pre><code>\"taskData\" : { \n    \"createdOn\" : ISODate(\"2016-02-20T21:23:11.903Z\"), \n    \"Task_content\" : \"@bob\", \n    \"Priority\" : \"2\", \n    \"owner_Uname\" : \"alice\"\n}\n</code></pre>\n\n<p>The code through which i tried to access it </p>\n\n<pre><code>var n []bson.M\n e := collection.Find(bson.M{\"users.\"+strconv.Itoa(j)+\".user_name\" :   r.FormValue(\"value[userName]\")}).Select(bson.M{\"taskData.owner_Uname\":1,\"_id\":0}).All(&amp;n)\nif e != nil {\n   fmt.Println(\"Error : \",e)\n}else{\n   fmt.Println(n[0][\"taskData\"])\n}\n</code></pre>\n\n<p>getting output like this </p>\n\n<pre><code>map[owner_Uname:alice]\n</code></pre>\n\n<p>I need to access this resultant string with another query.\nIt is a interface i tried to convert it to simple map \n<code>newMap :=n[0][\"taskData\"].(map[string]interface{})</code>but it gives me an runtime error <code>interface conversion: interface {} is bson.M, not map[string]interface {}</code></p>\n\n<pre><code>result := rawData{}\nerr := collection.Find(bson.M{\"user_name\":n[0][\"taskData\"][\"owner_Uname\"]}).All(&amp;result)\n</code></pre>\n\n<p>Now I want to use it in above query ...\nKindly help me out. Thanks in advance </p>\n\n<p>Edit :-\nThe data in mongo is like</p>\n\n<pre><code>{\n   \"_id\" : ObjectId(\"56bf128f5a9a6a0ebfdd5075\"),\n     \"deadLine\" : {\n       \"Start_time\" : ISODate(\"2016-05-24T00:00:00Z\"),\n       \"End_time\" : ISODate(\"2016-05-29T00:00:00Z\")\n     },\n   },\n   \"taskData\" : { \n       \"createdOn\" : ISODate(\"2016-02-20T21:23:11.903Z\"), \n       \"Task_content\" : \"@bob\", \n       \"Priority\" : \"2\", \n       \"owner_Uname\" : \"alice\"\n   },\n   \"group\" : {\n      \"1\" : {\n        \"grp_name\" : \"grp\"\n       },\n      \"2\" : {\n        \"grp_name\" : \"secondGrp\"\n       }\n    }\n</code></pre>\n\n<p>That will work me too if it is done with nested struct or map in struct </p>\n"}, {"tags": ["asynchronous", "go", "clojure", "primes"], "comments": [{"owner": {"reputation": 6000, "user_id": 1492584, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/0Kb6C.png?s=128&g=1", "display_name": "Chris Murphy", "link": "https://stackoverflow.com/users/1492584/chris-murphy"}, "edited": false, "score": 0, "creation_date": 1456010320, "post_id": 35530133, "comment_id": 58750076, "body": "I just looked at my own core.async code and it has lots of <code>&lt;!</code> and <code>&gt;!</code> but no <code>&lt;&lt;!</code> or <code>&gt;&gt;!</code>. I think it is best to send and receive between channels from within go blocks rather than outside them."}, {"owner": {"reputation": 19058, "user_id": 329063, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/212795ae6e40df4aeb12bf1ed842651a?s=128&d=identicon&r=PG", "display_name": "glts", "link": "https://stackoverflow.com/users/329063/glts"}, "edited": false, "score": 2, "creation_date": 1456011307, "post_id": 35530133, "comment_id": 58750331, "body": "<code>go</code> is a macro. If you want to take advantage of goroutine-like behaviour in <code>go</code> blocks you must use <code>&lt;!</code> and <code>&gt;!</code>, and they must be visible to the <code>go</code> macro (that is you mustn&#39;t extract these operations into separate functions)."}, {"owner": {"reputation": 2229, "user_id": 484529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rp6uy.png?s=128&g=1", "display_name": "ijt", "link": "https://stackoverflow.com/users/484529/ijt"}, "edited": false, "score": 0, "creation_date": 1456035041, "post_id": 35530133, "comment_id": 58754958, "body": "This works, thank you! Can one of you post your reply as an answer so I can mark it as the solution? Here&#39;s the new version: <a href=\"https://gist.github.com/ijt/577fb9e11aaf8bf14e75\" rel=\"nofollow noreferrer\">gist.github.com/ijt/577fb9e11aaf8bf14e75</a> ."}, {"owner": {"reputation": 4440, "user_id": 684167, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/58d9ceeb42a3ae04cd8a0a60f072e014?s=128&d=identicon&r=PG", "display_name": "ClojureMostly", "link": "https://stackoverflow.com/users/684167/clojuremostly"}, "edited": false, "score": 2, "creation_date": 1456039397, "post_id": 35530133, "comment_id": 58755834, "body": "The <code>core.async</code> dispatcher runs on <code>42+2*CPU_CORES</code> threads. And the number of primes less than or equal to 227 is exactly 49. (I&#39;m guessing you have 4 CPU cores?). This shows how you dry up all core.async threads."}, {"owner": {"reputation": 2229, "user_id": 484529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rp6uy.png?s=128&g=1", "display_name": "ijt", "link": "https://stackoverflow.com/users/484529/ijt"}, "edited": false, "score": 0, "creation_date": 1456043549, "post_id": 35530133, "comment_id": 58756722, "body": "Hi Andre, yes, my laptop has 4 cores."}], "answers": [{"comments": [{"owner": {"reputation": 2229, "user_id": 484529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rp6uy.png?s=128&g=1", "display_name": "ijt", "link": "https://stackoverflow.com/users/484529/ijt"}, "edited": false, "score": 0, "creation_date": 1456088419, "post_id": 35534892, "comment_id": 58772551, "body": "This would probably be good to include as a core.async example."}], "tags": [], "owner": {"reputation": 19058, "user_id": 329063, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/212795ae6e40df4aeb12bf1ed842651a?s=128&d=identicon&r=PG", "display_name": "glts", "link": "https://stackoverflow.com/users/329063/glts"}, "is_accepted": true, "score": 2, "last_activity_date": 1456050069, "creation_date": 1456050069, "answer_id": 35534892, "question_id": 35530133, "link": "https://stackoverflow.com/questions/35530133/why-cant-clojures-async-library-handle-the-go-prime-sieve/35534892#35534892", "title": "Why can&#39;t Clojure&#39;s async library handle the Go prime sieve?", "body": "<p><code>go</code> is a macro. If you want to take advantage of goroutine-like behaviour in go blocks you must use <code>&lt;!</code> and <code>&gt;!</code>, and they must be visible to the <code>go</code> macro (that is you mustn't extract these operations into separate functions).</p>\n\n<p>This literal translation of the program at <a href=\"https://golang.org/doc/play/sieve.go\" rel=\"nofollow\">https://golang.org/doc/play/sieve.go</a> seems to work fine, also with a larger <code>i</code> in the main loop:</p>\n\n<pre><code>(require '[clojure.core.async :refer [&lt;! &lt;!! &gt;! chan go]])\n\n(defn go-generate [ch]\n  (go (doseq [i (iterate inc 2)]\n        (&gt;! ch i))))\n\n(defn go-filter [in out prime]\n  (go (while true\n        (let [i (&lt;! in)]\n          (if-not (zero? (rem i prime))\n            (&gt;! out i))))))\n\n(defn main []\n  (let [ch (chan)]\n    (go-generate ch)\n    (loop [i 10 ch ch]\n      (if (pos? i)\n        (let [prime (&lt;!! ch)]\n          (println prime)\n          (let [ch1 (chan)]\n            (go-filter ch ch1 prime)\n            (recur (dec i) ch1)))))))\n</code></pre>\n"}], "owner": {"reputation": 2229, "user_id": 484529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rp6uy.png?s=128&g=1", "display_name": "ijt", "link": "https://stackoverflow.com/users/484529/ijt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 35534892, "answer_count": 1, "score": 1, "last_activity_date": 1456050069, "creation_date": 1456008989, "question_id": 35530133, "link": "https://stackoverflow.com/questions/35530133/why-cant-clojures-async-library-handle-the-go-prime-sieve", "title": "Why can&#39;t Clojure&#39;s async library handle the Go prime sieve?", "body": "<p>To try out the async library in Clojure, I translated the prime sieve example from Go. Running in the REPL, it successfully printed out the prime numbers up to 227 and then stopped. I hit Ctrl-C and tried running it again but it wouldn't print out any more numbers. Is there a way to get Clojure to handle this, or is the async library just not ready for it yet?</p>\n\n<pre><code>;; A concurrent prime sieve translated from\n;; https://golang.org/doc/play/sieve.go\n\n(require '[clojure.core.async :as async :refer [&lt;!! &gt;!! chan go]])\n\n(defn generate\n  [ch]\n  \"Sends the sequence 2, 3, 4, ... to channel 'ch'.\"\n  (doseq [i (drop 2 (range))]\n    (&gt;!! ch i)))\n\n(defn filter-multiples\n  [in-chan out-chan prime]\n  \"Copies the values from 'in-chan' to 'out-chan', removing\n  multiples of 'prime'.\"\n  (while true\n    ;; Receive value from 'in-chan'.\n    (let [i (&lt;!! in-chan)]\n      (if (not= 0 (mod i prime))\n        ;; Send 'i' to 'out-chan'.\n        (&gt;!! out-chan i)))))\n\n(defn main\n  []\n  \"The prime sieve: Daisy-chain filter-multiples processes.\"\n  (let [ch (chan)]\n    (go (generate ch))\n    (loop [ch ch]\n      (let [prime (&lt;!! ch)]\n        (println prime)\n        (let [ch1 (chan)]\n          (go (filter-multiples ch ch1 prime))\n          (recur ch1))))))\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 3166558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040bab2c7605bd44d7eb8fe6460d9d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Conner H", "link": "https://stackoverflow.com/users/3166558/conner-h"}, "edited": false, "score": 0, "creation_date": 1456003221, "post_id": 35528855, "comment_id": 58747840, "body": "Thanks so much for the example!  I think I see what you mean, where my handlers can write specific 4xx and 5xx errors for the routes according to the app logic, right?  My concern though would be the errors generated from the net/http package itself and just keeping everything consistent with a single error page.  Where exactly would I have <code>&amp;Interceptor{origWriter: nil}</code> so I can replace nil with the actual <code>http.ResponseWriter</code>?  I&#39;m thinking it would go in the <code>ServeHTTP</code> function for my own <code>http.Handler</code>, but not sure how this would look (or if that&#39;s correct).  Thanks again!"}, {"owner": {"reputation": 317, "user_id": 3166558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040bab2c7605bd44d7eb8fe6460d9d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Conner H", "link": "https://stackoverflow.com/users/3166558/conner-h"}, "edited": false, "score": 0, "creation_date": 1456003717, "post_id": 35528855, "comment_id": 58748014, "body": "Could you show it being used in <code>main()</code> with a simple <code>http.Handle</code> call like  <code>http.Handle(&quot;&#47;test&quot;, InterceptHandler)</code>  (if that&#39;s the right way)?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 317, "user_id": 3166558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040bab2c7605bd44d7eb8fe6460d9d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Conner H", "link": "https://stackoverflow.com/users/3166558/conner-h"}, "edited": false, "score": 0, "creation_date": 1456009378, "post_id": 35528855, "comment_id": 58749834, "body": "@eclipse1121 Wrap your entire mux with some middleware that replaces the default ResponseWriter with the InterceptWriter - <a href=\"http://play.golang.org/p/esiiY7p-CC\" rel=\"nofollow noreferrer\">play.golang.org/p/esiiY7p-CC</a>"}, {"owner": {"reputation": 317, "user_id": 3166558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040bab2c7605bd44d7eb8fe6460d9d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Conner H", "link": "https://stackoverflow.com/users/3166558/conner-h"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1456011072, "post_id": 35528855, "comment_id": 58750271, "body": "@elithrar thanks! I tried implementing it as you show with a slight change (no mux just an http.Handle) here, <a href=\"http://play.golang.org/p/EtpAa7KYOn\" rel=\"nofollow noreferrer\">http://play.golang.org/p/EtpAa7KYOn</a>, but it doesn&#39;t seem to work when trying to catch a 404 error.  I&#39;m starting to wonder, how is ServeHTTP implemented?  If the net/http package raises an error and never calls the ServeHTTP handlers for various routes when an error occurs, then is it impossible to catch them before they&#39;re written without essentially creating a custom server?  Also thank you for your blog, it&#39;s been helpful!"}, {"owner": {"reputation": 317, "user_id": 3166558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040bab2c7605bd44d7eb8fe6460d9d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Conner H", "link": "https://stackoverflow.com/users/3166558/conner-h"}, "edited": false, "score": 0, "creation_date": 1456011202, "post_id": 35528855, "comment_id": 58750306, "body": "also in that code, the <code>&#47;test</code> route loads but the &#39;Testing&#39; text is never sent to the browser."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1456012575, "post_id": 35528855, "comment_id": 58750629, "body": "David&#39;s answer has a slight error: it doesn&#39;t write when <code>i.overridden</code> is false. It should be the other way around. See here: <a href=\"http://play.golang.org/p/kKmMBDjMq8\" rel=\"nofollow noreferrer\">play.golang.org/p/kKmMBDjMq8</a> - if you want to avoid having to wrap every single handler, then create a <code>mux := http.NewServeMux()</code> and wrap that (only)."}, {"owner": {"reputation": 317, "user_id": 3166558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040bab2c7605bd44d7eb8fe6460d9d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Conner H", "link": "https://stackoverflow.com/users/3166558/conner-h"}, "edited": false, "score": 0, "creation_date": 1456014222, "post_id": 35528855, "comment_id": 58751047, "body": "Ok cool I see the fix you did for the text not showing.  I also see how the <code>BadHandler</code> works, however this is still what I would consider an application generated error response vs Interceptor catching all error responses, outside of what&#39;s defined in my handlers.  For instance, browsing to <code>&#47;bad</code> shows the <code>Custom 403 message</code> error, but browsing to <code>&#47;notfound</code> shows the standard <code>404 page not found</code> instead of the <code>Custom 404 message</code> one."}, {"owner": {"reputation": 317, "user_id": 3166558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040bab2c7605bd44d7eb8fe6460d9d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Conner H", "link": "https://stackoverflow.com/users/3166558/conner-h"}, "edited": false, "score": 0, "creation_date": 1456015966, "post_id": 35528855, "comment_id": 58751448, "body": "Is it just impossible to catch errors created from outside of your own <code>ServeHTTP</code> handler?  My goal is to just have 100% coverage of all errors so a standard error page can be shown.  For example, outside of rewriting the net/http package, how would you catch <a href=\"https://golang.org/src/net/http/server.go#L1430\" rel=\"nofollow noreferrer\">this error</a>?  The <code>timeoutHandler</code> struct in <a href=\"https://golang.org/src/net/http/server.go#L2328\" rel=\"nofollow noreferrer\">server.go</a> seems like a good example - they define a <code>ServeHTTP</code> function and that&#39;s what sends the 503 code if appropriate.  Should I only worry about 4xx and 5xx errors in my app logic then?"}, {"owner": {"reputation": 317, "user_id": 3166558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040bab2c7605bd44d7eb8fe6460d9d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Conner H", "link": "https://stackoverflow.com/users/3166558/conner-h"}, "edited": false, "score": 0, "creation_date": 1456016130, "post_id": 35528855, "comment_id": 58751486, "body": "Also if that&#39;s the case, seems like the net/http package should offer some handler for all errors it can generate that can be written to the browser, so showing a custom error page becomes trivial."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1456022213, "post_id": 35528855, "comment_id": 58752666, "body": "You <i>can</i> catch 404 errors - like I said, if you wrap the entire <code>ServeMux</code> you can intercept anything. The problem with using the default mux (which is what the <code>nil</code> in ListenAndServe means) is that the 404 never hits your handlers in the first place, and you don&#39;t get to catch it. This will intercept 404&#39;s: <a href=\"http://play.golang.org/p/KZMBVCQ9MT\" rel=\"nofollow noreferrer\">play.golang.org/p/KZMBVCQ9MT</a>"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1456022275, "post_id": 35528855, "comment_id": 58752678, "body": "... and here&#39;s an article I wrote on how to do this with custom handler types as well, so you can <code>return CustomErrorType</code> from your handlers and determine what to show/render: <a href=\"http://elithrar.github.io/article/http-handler-error-handling-revisited/\" rel=\"nofollow noreferrer\">elithrar.github.io/article/&hellip;</a>"}, {"owner": {"reputation": 317, "user_id": 3166558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040bab2c7605bd44d7eb8fe6460d9d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Conner H", "link": "https://stackoverflow.com/users/3166558/conner-h"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1456026617, "post_id": 35528855, "comment_id": 58753531, "body": "@elithrar awesome, thank you!  I tested and it works for the 404 error.  Was wondering if you could elaborate further?  Looking at the server.go source with what you pointed out about the default mux, can you tell me if I&#39;m understanding this correctly?  Looks like the <code>http.Server</code> struct has a <code>http.Handler</code> embedded which defaults to <code>http.DefaultServeMux</code> if nil on creation (created via exported <code>ListenAndServe</code> function).  I&#39;m thinking this code would only work then for errors written using the writer, i.e. <a href=\"https://golang.org/src/net/http/server.go#L1430\" rel=\"nofollow noreferrer\">this</a> won&#39;t be intercepted?"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 4, "last_activity_date": 1456027370, "last_edit_date": 1456027370, "creation_date": 1456001529, "answer_id": 35528855, "question_id": 35528330, "link": "https://stackoverflow.com/questions/35528330/overriding-responsewriter-interface-to-catch-http-errors/35528855#35528855", "title": "Overriding ResponseWriter interface to catch HTTP errors", "body": "<p>The mux libraries only have a means of setting the not found handler as a means of giving you a way to intercept requests where the mux can't resolve the URL to it's known mappings.</p>\n\n<p>For example, you do:</p>\n\n<pre><code>mux.Handle(\"/foo\",fooFunc)\nmux.Handle(\"/bar\",barFunc)\n</code></pre>\n\n<p>But the client accesses <code>/baz</code> to which the mux has no mapping.</p>\n\n<p>They do not actually intercept a 404 going to the client, they just invoke the not found handler when it runs in to this problem.</p>\n\n<p>Also, if your /foo handler sends a 404 response, the not found does not get invoked.</p>\n\n<p>If you want custom pages for various return responses from your mapped URLs, simply make the various handlers write the correct response.</p>\n\n<p>If you don't control that logic (ie: the framwork is writing something and has no means to override), then you may want to intercept all requests and override the http.ResposeWriter with response code detection logic.</p>\n\n<p>Here's an example interceptor that basically does what you want.  On <a href=\"http://play.golang.org/p/kKmMBDjMq8\" rel=\"nofollow\">Play</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n)\nimport \"net/http\"\n\ntype Interceptor struct {\n    origWriter http.ResponseWriter\n    overridden bool\n}\n\nfunc (i *Interceptor) WriteHeader(rc int) {\n    switch rc {\n    case 500:\n        http.Error(i.origWriter, \"Custom 500 message / content\", 500)\n    case 404:\n        http.Error(i.origWriter, \"Custom 404 message\", 404)\n    case 403:\n        i.origWriter.WriteHeader(403)\n        fmt.Fprintln(i.origWriter, \"Custom 403 message\")\n    default:\n        i.origWriter.WriteHeader(rc)\n        return\n    }\n    // if the default case didn't execute (and return) we must have overridden the output\n    i.overridden = true\n    log.Println(i.overridden)\n}\n\nfunc (i *Interceptor) Write(b []byte) (int, error) {\n    if !i.overridden {\n        return i.origWriter.Write(b)\n    }\n\n    // Return nothing if we've overriden the response.\n    return 0, nil\n}\n\nfunc (i *Interceptor) Header() http.Header {\n    return i.origWriter.Header()\n}\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 3166558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/040bab2c7605bd44d7eb8fe6460d9d8e?s=128&d=identicon&r=PG&f=1", "display_name": "Conner H", "link": "https://stackoverflow.com/users/3166558/conner-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2651, "favorite_count": 1, "accepted_answer_id": 35528855, "answer_count": 1, "score": 3, "last_activity_date": 1456174004, "creation_date": 1455998501, "last_edit_date": 1456174004, "question_id": 35528330, "link": "https://stackoverflow.com/questions/35528330/overriding-responsewriter-interface-to-catch-http-errors", "title": "Overriding ResponseWriter interface to catch HTTP errors", "body": "<p>I'm coding a web application in Go, and while various mux libraries provide a way to set a custom 404 error handler, there's nothing for other 4xx and 5xx error codes.</p>\n\n<p>One suggestion is to override the WriteHeader method in the ResponseWriter interface and check the status code, but I'm confused as to how this would actually be written (the overriding of ResponseWriter methods, before outputting).  One possible example can be found from the <a href=\"https://github.com/codegangsta/negroni/blob/c7477ad8e330bef55bf1ebe300cf8aa67c492d1b/negroni.go#L73\" rel=\"nofollow\">negroni package</a>.</p>\n\n<p>Would this be the correct way to serve a custom template for 4xx and 5xx errors?  Could anyone provide an example of how this could be implemented?</p>\n\n<h1><strong>Update</strong></h1>\n\n<p>Big thanks to David and elithrar for their responses and code.  The <code>Interceptor</code> struct that David coded can be used in a wrapper for the server mux, as elithrar shows in the comments.  For those looking for further explanation as to why and how this works, <a href=\"https://astaxie.gitbooks.io/build-web-application-with-golang/content/en/03.3.html\" rel=\"nofollow\">this section from astaxie's book</a> gives some very good info on the workings of the net/http package, along with viewing the <a href=\"https://golang.org/src/net/http/server.go\" rel=\"nofollow\">server.go source code</a> from the net/http package.</p>\n"}, {"tags": ["python", "go", "cmd", "exec", "external"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1455998784, "post_id": 35528180, "comment_id": 58746224, "body": "Do the examples in the docs help? <a href=\"https://golang.org/pkg/os/exec/\" rel=\"nofollow noreferrer\">golang.org/pkg/os/exec</a>"}, {"owner": {"reputation": 1, "user_id": 3101965, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001669197034/picture?type=large", "display_name": "Zsolt Bokor", "link": "https://stackoverflow.com/users/3101965/zsolt-bokor"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456000253, "post_id": 35528180, "comment_id": 58746714, "body": "nope, unfortunately I searched everywhere for some info but I can&#39;t run that Python script from Go"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1456000413, "post_id": 35528180, "comment_id": 58746773, "body": "If following the documentation doesn&#39;t help, you need to show what you&#39;ve tried that isn&#39;t working, what the error is, and what you expect to happen. Otherwise we&#39;re just rewriting the same examples from the docs."}, {"owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "edited": false, "score": 0, "creation_date": 1456001021, "post_id": 35528180, "comment_id": 58746985, "body": "You seem to be using windows - are those paths correctly escaped?"}], "answers": [{"tags": [], "owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "is_accepted": false, "score": 3, "last_activity_date": 1456001177, "last_edit_date": 1456001177, "creation_date": 1456000843, "answer_id": 35528744, "question_id": 35528180, "link": "https://stackoverflow.com/questions/35528180/how-to-run-external-python-script-in-golang/35528744#35528744", "title": "How to run external Python script in Golang?", "body": "<p>If examples from doc are not helpful, maybe this will make it easier for you.</p>\n\n<p>test.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n    log.Println(os.Args)\n    if len(os.Args) == 1 {\n        return\n    }\n    cmd := exec.Command(os.Args[1], os.Args[2:]...)\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    log.Println(cmd.Run())\n}\n</code></pre>\n\n<p>test.py:</p>\n\n<pre><code>import sys\nprint sys.argv\n</code></pre>\n\n<p>usage:</p>\n\n<pre><code>$ go run test.go python test.py 1 two 3 four\n2016/02/20 21:45:42 [/tmp/go-build772613382/command-line-arguments/_obj/exe/test python test.py 1 two 3 four]\n['test.py', '1', 'two', '3', 'four']\n2016/02/20 21:45:42 &lt;nil&gt;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3101965, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001669197034/picture?type=large", "display_name": "Zsolt Bokor", "link": "https://stackoverflow.com/users/3101965/zsolt-bokor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5835, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456001177, "creation_date": 1455997600, "question_id": 35528180, "link": "https://stackoverflow.com/questions/35528180/how-to-run-external-python-script-in-golang", "title": "How to run external Python script in Golang?", "body": "<p>I would like to run an external Python script that gets 4 arguments. If I would like to run the Python script in cmd it would look like this: python Required\\Python\\screenshot.py-master\\screenshot.py --nojs -thumb <a href=\"http://google.com/\" rel=\"nofollow\">http://google.com/</a> Required\\Images\\Screenshots\\google.jpg\nSo, I would like to run this command from Go.\nHow could I implement this?\nThanks.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 4, "creation_date": 1455987579, "post_id": 35525714, "comment_id": 58741805, "body": "The purpose of interfaces is not to protect programmers from mistakes but to express functionality. You can debate the merits if implicit interfaces in go (I personally like them) but this is not a relevant argument IMO."}], "answers": [{"comments": [{"owner": {"reputation": 459, "user_id": 2558332, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3ad196d654f8d45d1eeda465995969ee?s=128&d=identicon&r=PG&f=1", "display_name": "tanapoln", "link": "https://stackoverflow.com/users/2558332/tanapoln"}, "edited": false, "score": 0, "creation_date": 1456071812, "post_id": 35527423, "comment_id": 58765916, "body": "Could you please explain more about the advantages of this practice, which to start writing some code and see some pattern then write interface later + refactor VS design interface first and let someone to implement that interface to make things work?"}], "tags": [], "owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "is_accepted": false, "score": 2, "last_activity_date": 1456168754, "last_edit_date": 1456168754, "creation_date": 1455993573, "answer_id": 35527423, "question_id": 35525714, "link": "https://stackoverflow.com/questions/35525714/why-go-design-not-to-mark-as-error-when-assign-a-variable-to-whatever-interface/35527423#35527423", "title": "Why Go design not to mark as error when assign a variable to whatever interface that has same signature", "body": "<p>One advantage of \"implicitly satisfied\" interfaces (ones where types don't need to explicitly declare that they implement them) is that interfaces can be created after the fact. You can see several types that have a method in common, perhaps in different packages, and decide to write a function that can accept any of them by calling for a new interface that specifies that method.</p>\n\n<p>Also, Go's approach to interfaces lets you write an abstraction of the behavior of a type in an existing package, without modifying the original package. The first example that comes to my mind is the File interface in the net/http package:</p>\n\n<pre><code>type File interface {\n    io.Closer\n    io.Reader\n    io.Seeker\n    Readdir(count int) ([]os.FileInfo, error)\n    Stat() (os.FileInfo, error)\n}\n</code></pre>\n\n<p>It represents a file that can by served by an http.FileServer. Normally it is an os.File, but it could be anything that fulfills the interface. For example, I think someone has made an implementation that serves files out of a zip archive.</p>\n\n<p>Since the net/http package is defined in the standard library, it might have been possible to explicitly declare that os.File implements http.File\u2014but it would have made the os package depend on the net/http package. This is a circular dependency, because net/http depends on os.</p>\n\n<p>In an inheritance-based language, someone who was trying to do this would probably just give up on using an interface, and make http.FileServer require that all files be subclasses of os.File. But this would be a pain, because they wouldn't need any of the implementation of an os.File; they would just be inheriting from it to satisfy the type system.</p>\n\n<p>The example in the OP works because of a poorly-chosen method name. It is not at all clear what a Square's calculate method should return. Its area? Its perimeter? Its diagonal? If the method were named CalculateArea, which would be the idiomatic name for the single method in an interface named AreaCalculator, it would not be possible to confuse an AreaCalculator and a MathExpression.</p>\n"}, {"tags": [], "owner": {"reputation": 1903, "user_id": 1549474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2766dac2718e51b8c5f4f021c8e740c4?s=128&d=identicon&r=PG", "display_name": "tumdum", "link": "https://stackoverflow.com/users/1549474/tumdum"}, "is_accepted": false, "score": 1, "last_activity_date": 1456054775, "last_edit_date": 1456054775, "creation_date": 1456000093, "answer_id": 35528606, "question_id": 35525714, "link": "https://stackoverflow.com/questions/35525714/why-go-design-not-to-mark-as-error-when-assign-a-variable-to-whatever-interface/35528606#35528606", "title": "Why Go design not to mark as error when assign a variable to whatever interface that has same signature", "body": "<p>One benefit of this approach is inversion of dependencies. In typical languages with static type systems, you have source level dependency from implementation to interface. Which means you can't deploy them separately. With implicit interfaces you have no source level dependency and implementation module can be deployed/developed/build without module containing interface. This gives you flexibility usually reserved for dynamic type systems.</p>\n"}, {"tags": [], "owner": {"reputation": 2745, "user_id": 1268294, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/qymw2.jpg?s=128&g=1", "display_name": "Pawe\u0142 Adamski", "link": "https://stackoverflow.com/users/1268294/pawe%c5%82-adamski"}, "is_accepted": false, "score": 1, "last_activity_date": 1456002386, "creation_date": 1456002386, "answer_id": 35529019, "question_id": 35525714, "link": "https://stackoverflow.com/questions/35525714/why-go-design-not-to-mark-as-error-when-assign-a-variable-to-whatever-interface/35529019#35529019", "title": "Why Go design not to mark as error when assign a variable to whatever interface that has same signature", "body": "<p>Go uses implicit interfaces, it means that type implements interface if it has all functions required by interface. Note that you don't have to declare in code that type implements interface (as in Java). </p>\n\n<p>Such language design have good and bad consequences:</p>\n\n<ul>\n<li>type can implement interface by accident (this happened in your example). Actually it happens very rarely so IMO it is not a big problem.</li>\n<li>without interface declaration in code you don't know which interfaces your type implements. This problem can be solved by using good IDEs.</li>\n<li>you can easily create adapters and similar design patterns</li>\n<li>you can easily create mocks</li>\n<li>more readable code (type declaration is very simple in go)</li>\n</ul>\n"}], "owner": {"reputation": 459, "user_id": 2558332, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3ad196d654f8d45d1eeda465995969ee?s=128&d=identicon&r=PG&f=1", "display_name": "tanapoln", "link": "https://stackoverflow.com/users/2558332/tanapoln"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1456168754, "creation_date": 1455984930, "last_edit_date": 1455985924, "question_id": 35525714, "link": "https://stackoverflow.com/questions/35525714/why-go-design-not-to-mark-as-error-when-assign-a-variable-to-whatever-interface", "title": "Why Go design not to mark as error when assign a variable to whatever interface that has same signature", "body": "<p>I'm just start learning Go, most of my background came from Java, Ruby.</p>\n\n<p>I just wonder that, from my example, why Go language designer intentionally design to not specify an interface type when implement an interface. So that if someone accidentally try to assign an object to an interface that match a signature but doesn't intend to implement that interface, that would lead to be a bug and cannot be catch at a compile time.</p>\n\n<p>You can try at this: <a href=\"https://play.golang.org/p/1N0kg7m4eE\" rel=\"nofollow\">https://play.golang.org/p/1N0kg7m4eE</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype MathExpression interface {\n    calculate() float64\n}\n\ntype AreaCalculator interface {\n    calculate() float64\n}\n\ntype Square struct {\n    width, height float64\n}\n\n//This implementation intend to implement AreaCalculator interface\nfunc (s Square) calculate() float64 {\n    return s.width * s.height\n}\n\nfunc main() {\n    //Suppose that a developer got this object from \n    //somewhere without a knowledge that object is a Square struct\n    mysteryStruct := Square{width: 4, height: 3}\n    var areaCalculator AreaCalculator = mysteryStruct\n    fmt.Println(\"Area of something:\", areaCalculator.calculate())\n\n    var mathExpression MathExpression = mysteryStruct\n    fmt.Println(\"This should not work:\", mathExpression.calculate())\n}\n</code></pre>\n"}, {"tags": ["git", "heroku", "go", "push", "buildpack"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1455981020, "post_id": 35524704, "comment_id": 58739452, "body": "Procfile contents? What does the root of your git repo look like?"}, {"owner": {"reputation": 41, "user_id": 5955573, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FfLKk1U1zQI/AAAAAAAAAAI/AAAAAAAAAE0/DLYBoTyo8D4/photo.jpg?sz=128", "display_name": "Adrian", "link": "https://stackoverflow.com/users/5955573/adrian"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1456056149, "post_id": 35524704, "comment_id": 58760263, "body": "Procfile contains <code>web: gweet</code> rest of repo as per:<a href=\"https://github.com/skorokithakis/gweet\" rel=\"nofollow noreferrer\">link</a>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5955573, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FfLKk1U1zQI/AAAAAAAAAAI/AAAAAAAAAE0/DLYBoTyo8D4/photo.jpg?sz=128", "display_name": "Adrian", "link": "https://stackoverflow.com/users/5955573/adrian"}, "edited": false, "score": 0, "creation_date": 1456006619, "post_id": 35527387, "comment_id": 58749048, "body": "Thanks @David, that&#39;s firmly pointed me in the right direction but now I&#39;ve go to work out what the GO &quot;vendoring  experiment&quot; flag is about because <code>godep save -r .&#47;...</code> is complaining about it."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1456008457, "post_id": 35527387, "comment_id": 58749562, "body": "Do you have Go 1.6 and the latest godep?"}, {"owner": {"reputation": 41, "user_id": 5955573, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FfLKk1U1zQI/AAAAAAAAAAI/AAAAAAAAAE0/DLYBoTyo8D4/photo.jpg?sz=128", "display_name": "Adrian", "link": "https://stackoverflow.com/users/5955573/adrian"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1456056307, "post_id": 35527387, "comment_id": 58760309, "body": "Hi @elithrar, yes Go 1.6 and latest godep."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1456067245, "post_id": 35527387, "comment_id": 58764083, "body": "vendor experiment was for 1.5, if you are on 1.6, just do &quot;godep save&quot; it will create Godeps/Godeps.json (this is what heroku keys off of)  and a vendor/... tree of your external dependencies.  Which is a good practice so you don&#39;t get surprise library upgrades on a heroku deploy."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1456067331, "post_id": 35527387, "comment_id": 58764122, "body": "also, probably dont want to use -r, re-writing the imports will just make future upgrades harder.  that&#39;s probably why it is complaining"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 6, "last_activity_date": 1455993402, "creation_date": 1455993402, "answer_id": 35527387, "question_id": 35524704, "link": "https://stackoverflow.com/questions/35524704/how-to-get-heroku-to-detect-go-buildpack/35527387#35527387", "title": "How to get Heroku to detect GO buildpack", "body": "<p>According to <a href=\"https://devcenter.heroku.com/articles/go-support\" rel=\"noreferrer\">the documentation</a>, the go buildpack requires <a href=\"https://github.com/tools/godep\" rel=\"noreferrer\">Godep</a> in order to know how to build and deploy your app.</p>\n\n<p>Do a <code>godep save</code> and commit that before pushing to Heroku.</p>\n"}], "owner": {"reputation": 41, "user_id": 5955573, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FfLKk1U1zQI/AAAAAAAAAAI/AAAAAAAAAE0/DLYBoTyo8D4/photo.jpg?sz=128", "display_name": "Adrian", "link": "https://stackoverflow.com/users/5955573/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1265, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1455993402, "creation_date": 1455979001, "last_edit_date": 1455983040, "question_id": 35524704, "link": "https://stackoverflow.com/questions/35524704/how-to-get-heroku-to-detect-go-buildpack", "title": "How to get Heroku to detect GO buildpack", "body": "<p>In attempting to deploy my own GO app using <code>git push heroku master</code> I get the error <code>Push rejected, failed to detect set buildpack heroku/go</code></p>\n\n<p>Because the error is quite specific about failure to detect a buildpack I tried manually setting it with the command <code>heroku buildpacks:set heroku/go</code>\nThe response however was <code>! Thebuildpack heroku/go is already set on your app.</code></p>\n\n<p>Despite this push attempts continue to produce the same error <code>Push rejected, failed to detect set buildpack heroku/go</code></p>\n\n<p>It seems like the error message is leading me astray, what else might be wrong? Following my research here, I made sure that there is a Procfile in the app folder and I was able to successfully follow all the steps for deploying the Heroku GO example beforehand.</p>\n"}, {"tags": ["go", "binary", "byte", "bytearray"], "comments": [{"owner": {"reputation": 236, "user_id": 5663486, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELiJC.png?s=128&g=1", "display_name": "zelcon", "link": "https://stackoverflow.com/users/5663486/zelcon"}, "reply_to_user": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "edited": false, "score": 0, "creation_date": 1455965070, "post_id": 35522025, "comment_id": 58734151, "body": "the spec says <code>byte</code> is ``alias for uint8&#39;&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 236, "user_id": 5663486, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELiJC.png?s=128&g=1", "display_name": "zelcon", "link": "https://stackoverflow.com/users/5663486/zelcon"}, "edited": false, "score": 0, "creation_date": 1455966253, "post_id": 35522108, "comment_id": 58734550, "body": "this &quot;problem&quot; of mine started because a database wouldn&#39;t let me insert the hex value in a size-limited field; your answer also answers that question!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1455965498, "last_edit_date": 1455965498, "creation_date": 1455965004, "answer_id": 35522108, "question_id": 35522025, "link": "https://stackoverflow.com/questions/35522025/why-is-golang-not-giving-me-8-bytes-when-i-said-8/35522108#35522108", "title": "Why is Golang not giving me 8 bytes when I said 8?", "body": "<p>1 byte = 8 bits.</p>\n\n<p>Your output: <code>0x015f82a975f9752b</code>. That is exactly 8 bytes.</p>\n\n<p>1 byte can be displayed as 2 hex digits (1 hex digit contains 4 bits, so 1 byte = 8 bits = 2 hex digits).</p>\n\n<p>When you present it as binary:</p>\n\n<pre><code>binary:    0001 0101 1111 1000 0010 1010 1001 0111 0101 1111 1001 0111 0101 0010 1011\nhex:         1 |  5 |  f |  8 |  2 |  a |  9 |  7 |  5 |  f |  9 |  7 |  5 |  2 |  b |\nbyte idx:  7.  |    6.   |    5.   |    4.   |    3.   |    2.   |    1.   |    0.   |\n</code></pre>\n\n<p>That is 60 bits because the first 4 bits are 0 and not printed. 64 bits = 8 bytes.</p>\n"}], "owner": {"reputation": 236, "user_id": 5663486, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELiJC.png?s=128&g=1", "display_name": "zelcon", "link": "https://stackoverflow.com/users/5663486/zelcon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 35522108, "answer_count": 1, "score": 0, "last_activity_date": 1455965729, "creation_date": 1455964556, "last_edit_date": 1455965729, "question_id": 35522025, "link": "https://stackoverflow.com/questions/35522025/why-is-golang-not-giving-me-8-bytes-when-i-said-8", "title": "Why is Golang not giving me 8 bytes when I said 8?", "body": "<p>I thought <code>x := make([]byte, N)</code> was supposed to define a slice of N bytes. I'm getting 0x015f82a975f9752b as the output for that, which in base 2 is:</p>\n\n<p>0001 0101 1111 1000 0010 1010 1001 0111 0101 1111 1001 0111 0101 0010 1011</p>\n\n<p>Not 8. <strong>What am I missing?</strong></p>\n\n<p>See the <code>genSalt()</code> function below and its output.</p>\n\n<pre><code>package main\n\nimport (\n  \"crypto/rand\"\n  \"crypto/sha256\"\n  \"fmt\"\n  \"golang.org/x/crypto/pbkdf2\"\n  \"log\"\n)\n\n// generate a salt with N random bytes\nfunc genSalt() []byte {\n  ret := make([]byte, 8) // N == 8 (..right?)\n  _, err := rand.Read(ret)\n  if err != nil {\n    log.Fatal(err)\n  }\n  return ret\n}\n\n// pbkdf2 with sha256\n// returns sha256.Size == 32 bytes\nfunc hashPassword(cleartext, salt []byte) []byte {\n  return pbkdf2.Key([]byte(cleartext), salt, 4096, sha256.Size, sha256.New)\n}\n\nfunc main() {\n  password := \"GNUsNotUnixItsWorse\"\n  salt := genSalt()\n  hashed := hashPassword([]byte(password), salt)\n\n  fmt.Printf(\"sha256: %x\\n\", hashed)\n  fmt.Printf(\"salt: %x\\n\", salt)\n  fmt.Println(\"len(salt)\", len(salt),\n    \"\\nlen(hashed)\", len(hashed))\n\n  // OUTPUT (sample):\n  // sha256: b9c314c8fb8d183fb8773b8b2e2b2b991927915adeba44eb51c8fe6f9e13ee09\n  // salt: 015f82a975f9752b\n  // len(salt) 8 \n  // len(hashed) 32\n}\n</code></pre>\n\n<p>For some reason, this won't work in Go Playground, so just run it locally.</p>\n\n<p>(Sorry if this is a retarded question; I'm sleep deprived.)</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 3547, "user_id": 546750, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5e663c9fc0ebe46af81b8a49d5e2aa91?s=128&d=identicon&r=PG", "display_name": "ahmy", "link": "https://stackoverflow.com/users/546750/ahmy"}, "edited": false, "score": 0, "creation_date": 1455969107, "post_id": 35521571, "comment_id": 58735409, "body": "I believe you don&#39;t need <code>json:&quot;URLs&quot;</code> because the field name is already exported and the same. But to make it more readable sure."}, {"owner": {"reputation": 1023, "user_id": 1780261, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/lQx1P.jpg?s=128&g=1", "display_name": "codeaperature", "link": "https://stackoverflow.com/users/1780261/codeaperature"}, "edited": false, "score": 0, "creation_date": 1455989302, "post_id": 35521571, "comment_id": 58742525, "body": "The changes suggested by bearburger were implemented. The results are similar. I am using the suggested structure and I am now using <code>$ curl -H &quot;Content-Type: application&#47;json&quot; -X POST -d &#39;{&quot;urls&quot;:[&quot;http:&#47;&#47;www.indeed.com&#47;viewjob?jk=9388f66529358f6a&zwnj;&#8203;&quot;, &quot;http:&#47;&#47;www.indeed.com&#47;viewjob?jk=53e937ef73c0c808&quot;]}&#39; http:&#47;&#47;localhost:8888&#47;post</code> for my request. For ahmy&#39;s comment, I reqlize I probably don&#39;t need to add <code>json:&quot;urls&quot;</code> - I&#39;m adding this in case I decide to change to &#39;unmatched and not the same names&#39;."}, {"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "reply_to_user": {"reputation": 1023, "user_id": 1780261, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/lQx1P.jpg?s=128&g=1", "display_name": "codeaperature", "link": "https://stackoverflow.com/users/1780261/codeaperature"}, "edited": false, "score": 0, "creation_date": 1455990503, "post_id": 35521571, "comment_id": 58742993, "body": "@StephanWarren <code>urls    []string</code> should be <code>Urls    []string</code> to be properly parsed as JSON. Here is example <a href=\"http://play.golang.org/p/tP4FE8Gf3x\" rel=\"nofollow noreferrer\">play.golang.org/p/tP4FE8Gf3x</a> <a href=\"http://stackoverflow.com/questions/21825322/why-golang-cannot-generate-json-from-struct-with-front-lowercase-character\">Here</a> you can read explaination why you should use upper-case for field names."}], "tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": true, "score": 1, "last_activity_date": 1455961838, "creation_date": 1455961838, "answer_id": 35521571, "question_id": 35521356, "link": "https://stackoverflow.com/questions/35521356/representing-a-golang-structure-given-a-json-structure/35521571#35521571", "title": "Representing a Golang Structure Given a JSON structure", "body": "<p>Your JSON is invalid if it is really equal to</p>\n\n<pre><code>{[\"http://www.jobs.com/job?jk=9388f66529358f6a\",\"http://www.job.com/job?jk=53e937ef73c0c808\"]}\n</code></pre>\n\n<p>So your <code>uList.URIs</code> is empty. You could check for parsing error <code>json.Unmarshal</code> result.</p>\n\n<p>Proper JSON for your model should look like</p>\n\n<pre><code>[\"http://www.jobs.com/job?jk=9388f66529358f6a\",\"http://www.job.com/job?jk=53e937ef73c0c808\"]\n</code></pre>\n\n<p>with struct like</p>\n\n<pre><code>type URLs []string\n</code></pre>\n\n<p>or</p>\n\n<pre><code>{\"URLs\": [\"http://www.jobs.com/job?jk=9388f66529358f6a\",\"http://www.job.com/job?jk=53e937ef73c0c808\"]}\n</code></pre>\n\n<p>with struct like</p>\n\n<pre><code>type requestNodeType struct {\n    URLs []string `json:\"URLs\"`\n}\n</code></pre>\n\n<p>Also you can replace <code>json.Unmarshal([]byte(string(x)), &amp;uList)</code> with <code>json.Unmarshal(x, &amp;uList)</code> as <code>x</code> is already <code>[]byte</code>.</p>\n"}], "owner": {"reputation": 1023, "user_id": 1780261, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/lQx1P.jpg?s=128&g=1", "display_name": "codeaperature", "link": "https://stackoverflow.com/users/1780261/codeaperature"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 35521571, "answer_count": 1, "score": 0, "last_activity_date": 1455989004, "creation_date": 1455960499, "last_edit_date": 1455989004, "question_id": 35521356, "link": "https://stackoverflow.com/questions/35521356/representing-a-golang-structure-given-a-json-structure", "title": "Representing a Golang Structure Given a JSON structure", "body": "<pre><code>type requestNodeType struct {\n// edited: added the last part\n    urls    []string  `json:\"urls\"` \n}\n</code></pre>\n\n<p>... some more code ... then a part where I set the gin router context ...\nc ->>> *gin.Context</p>\n\n<p>and then ...</p>\n\n<pre><code>x, _ := ioutil.ReadAll(c.Request.Body)\nfmt.Printf(\"crb2 = %s\\n\", string(x))\nuList := requestNodeType{}\njson.Unmarshal(x, &amp;uList)\n// edited: updated prints for clarity \nfmt.Printf(\"json1 = %+v, %T - %p\\n\", uList, uList, uList )\nfmt.Printf(\"json2 = %+v, %T - %p\\n\", uList.urls, uList.urls, uList.urls )\nfmt.Printf(\"json3 = %+v, %T - %p\\n\", uList.urls[0], uList.urls[0], uList.urls[0] )\n</code></pre>\n\n<p>gives me an output of:</p>\n\n<pre><code>crb2 = {\"urls\":[\"http://www.indeed.com/viewjob?jk=9388f66529358f6a\", \"http://www.indeed.com/viewjob?jk=53e937ef73c0c808\"]}\njson1 = {urls:[]}, main.requestNodeType - %!p(main.requestNodeType={[]})\njson2 = [], []string - 0x0\n2016/02/20 09:10:39 Panic recovery -&gt; runtime error: index out of range\n</code></pre>\n\n<p>How can I represent this structure properly or fix my code?</p>\n\n<p>Or even better, an idea to get c.BindJSON(&amp;uList) to work for Gin ...?</p>\n"}, {"tags": ["email", "go", "smtp"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1455956893, "post_id": 35520804, "comment_id": 58731736, "body": "You need an SMTP server <i>somewhere</i>. Any server/service (e.g. Mandrill) will enforce some kind of quotas to prevent spam and maintain reputation. You could run a server locally, or your own, but you will find that most mail won&#39;t be delivered due to lack of sender reputation."}, {"owner": {"reputation": 5339, "user_id": 314310, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9c74f9c66df98052bef13864bffcd09c?s=128&d=identicon&r=PG", "display_name": "Anindya Chatterjee", "link": "https://stackoverflow.com/users/314310/anindya-chatterjee"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1455957254, "post_id": 35520804, "comment_id": 58731832, "body": "The down voter, I don&#39;t understand the reason for down vote. Can you clarify what is wrong with the question?"}, {"owner": {"reputation": 5339, "user_id": 314310, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9c74f9c66df98052bef13864bffcd09c?s=128&d=identicon&r=PG", "display_name": "Anindya Chatterjee", "link": "https://stackoverflow.com/users/314310/anindya-chatterjee"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1455957369, "post_id": 35520804, "comment_id": 58731861, "body": "@elithrar, I am not currently worrying about reputations and all. Anyway I am not going to send the mail to public email domain. I just need to know how the objective can be achieved in golang"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1455968012, "post_id": 35520804, "comment_id": 58735085, "body": "Oh, after writing my answer I actually &quot;got it&quot; that your question is not technical but rather political. Well, the answer then is &quot;no&quot;: your mail will still be needed to be sent through <i>some</i> SMTP server unless you&#39;re using some mail service exposing non-SMTP API, but I doubt that that will somehow make it possible to overcome quota limitations of <i>that</i> service. So basically the answer is &quot;rent a VPS and run a real MTA there&quot;."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1456053857, "post_id": 35520804, "comment_id": 58759568, "body": "I disagree. Of course it is possible to send mails without an SMTP server on the sender side: Take the email address, find the according MX, contact it directly and (try to) send the mail. Will it be accepted? Most likely not. Does this method work? It sure does. That&#39;s what MTAs do."}, {"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1515988019, "post_id": 35520804, "comment_id": 83496021, "body": "the other way is to do an MX domain lookup and connect to server you see in the result - it&#39;s a little more coplicated than that see RFC5321 section 5.1"}, {"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1529233652, "post_id": 35520804, "comment_id": 88791983, "body": "answer is no, so to create your own SMTP server on your own VPS get yourself a machine and your own domain then install this repo <a href=\"https://github.com/tomav/docker-mailserver\" rel=\"nofollow noreferrer\">github.com/tomav/docker-mailserver</a>   in my experience its the path of least resistance ... the repo has decent docs and a helpful support community"}], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": false, "score": 1, "last_activity_date": 1455962835, "creation_date": 1455962835, "answer_id": 35521711, "question_id": 35520804, "link": "https://stackoverflow.com/questions/35520804/how-to-send-emails-in-golang-without-any-smtp-server/35521711#35521711", "title": "How to send emails in golang without any smtp server", "body": "<p>Your question looks like - can I show webpages to users without a web-server? Yes you can if you are able to write your own web-server.</p>\n\n<p>Can you write SMTP server on Go? Yes. Google shows few solutions for \"golang smtp server\" query. So I'm pretty sure you can integrate SMTP server functional into your application.</p>\n\n<p>But as commenters said - most part of your messages (if not all) would go directly to spam folder on most part of services.</p>\n"}, {"comments": [{"owner": {"reputation": 1222, "user_id": 5806017, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TXRib.jpg?s=128&g=1", "display_name": "Garvit Jain", "link": "https://stackoverflow.com/users/5806017/garvit-jain"}, "edited": false, "score": 0, "creation_date": 1524289895, "post_id": 35521846, "comment_id": 86922077, "body": "I&#39;m using exim <code>cmd := exec.Command(&quot;&#47;usr&#47;sbin&#47;exim&quot;, &quot;-t&quot;)</code> but I&#39;m not receiving any mail on bcc <code>m.SetHeader(&quot;Bcc&quot;, &quot;heisGarvit@gmail.com&quot;)</code> , however I receive mail on &quot;To&quot; set to different email address in the same email. Also I just checked All &quot;Cc&quot; are getting mails"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 1222, "user_id": 5806017, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TXRib.jpg?s=128&g=1", "display_name": "Garvit Jain", "link": "https://stackoverflow.com/users/5806017/garvit-jain"}, "edited": false, "score": 0, "creation_date": 1524394211, "post_id": 35521846, "comment_id": 86946034, "body": "@GarvitJain I fail to see how is this related to the essence of the OP&#39;s question and my answer to it. Care to post a constructive question to <a href=\"https://superuser.com/questions/tagged/exim\">superuser.com/questions/tagged/exim</a> ?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 1222, "user_id": 5806017, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TXRib.jpg?s=128&g=1", "display_name": "Garvit Jain", "link": "https://stackoverflow.com/users/5806017/garvit-jain"}, "edited": false, "score": 0, "creation_date": 1524394580, "post_id": 35521846, "comment_id": 86946115, "body": "@garvit-jain, my comment above was destined to you; sorry, it&#39;s hard to properly refer to a person while typing on a smartphone."}, {"owner": {"reputation": 1222, "user_id": 5806017, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TXRib.jpg?s=128&g=1", "display_name": "Garvit Jain", "link": "https://stackoverflow.com/users/5806017/garvit-jain"}, "edited": false, "score": 1, "creation_date": 1524464060, "post_id": 35521846, "comment_id": 86964810, "body": "I&#39;ve posted the question : <a href=\"https://stackoverflow.com/questions/49974478/send-emails-in-go-through-exim-without-smtp\" title=\"send emails in go through exim without smtp\">stackoverflow.com/questions/49974478/&hellip;</a>"}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 13, "last_activity_date": 1538012270, "last_edit_date": 1538012270, "creation_date": 1455963620, "answer_id": 35521846, "question_id": 35520804, "link": "https://stackoverflow.com/questions/35520804/how-to-send-emails-in-golang-without-any-smtp-server/35521846#35521846", "title": "How to send emails in golang without any smtp server", "body": "<p>There is only one way to send an e-mail message without directly communicating with an SMTP server: delegate this action to some other program.</p>\n\n<p>What program to pick, is an open and wide question in itself because there are lots of programs which are able to send mails.</p>\n\n<p>On the other hand, if we talk about POSIX systems such as GNU/Linux- or *BSD-based operating systems, they <em>usually</em> come with the binary <code>/usr/sbin/sendmail</code> or, sometimes, <code>/usr/bin/sendmail</code> which is either provided by the real <a href=\"http://www.sendmail.org\" rel=\"noreferrer\">Sendmail</a> package or by another <a href=\"https://www.wikipedia.org/wiki/Mail_Transfer_Agent\" rel=\"noreferrer\">MTA</a> which exist in abundance&mdash;ranging from full-blown MTAs such as <a href=\"http://www.postfix.org\" rel=\"noreferrer\">Postfix</a> or <a href=\"http://www.exim.org\" rel=\"noreferrer\">Exim</a> to narrow-scoped \"null-clients\" such as <code>ssmtp</code> or <code>nullmailer</code>.</p>\n\n<p>This program is usually called with the <code>-t</code> command-line option which makes it read the addresses of the message recipients from the <code>To</code> headers of the mail message itself.</p>\n\n<p>Basically calling <code>/usr/sbin/sendmail -t</code> and piping the full message's text to its standard input is what <a href=\"http://php.net/manual/en/function.mail.php\" rel=\"noreferrer\">PHP's <code>mail()</code> function</a> does, FWIW.</p>\n\n<p>While you can do this call directly using the <code>os/exec</code>, <code>net/mail</code> and <code>net/textproto</code> standard packages, the popular <a href=\"https://github.com/go-gomail/gomail\" rel=\"noreferrer\"><code>gomail</code></a> package provides a simpler way to do that: its <code>Message</code> type provides the <code>WriteTo()</code> method which is able to write to a running Sendmail instance, like this (copied from a real program of mine):</p>\n\n<pre><code>const sendmail = \"/usr/sbin/sendmail\"\n\nfunc submitMail(m *gomail.Message) (err error) {\n    cmd := exec.Command(sendmail, \"-t\")\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n\n    pw, err := cmd.StdinPipe()\n    if err != nil {\n        return\n    }\n\n    err = cmd.Start()\n    if err != nil {\n        return\n    }\n\n    var errs [3]error\n    _, errs[0] = m.WriteTo(pw)\n    errs[1] = pw.Close()\n    errs[2] = cmd.Wait()\n    for _, err = range errs {\n        if err != nil {\n            return\n        }\n    }\n    return\n}\n</code></pre>\n\n<p>Actually, relying on MTA to deliver your mails has an advantage is that full-blown MTAs support mail queuing: that is, if an MTA is unable to send your message right away (say, due to a network outage etc) so it will save the message in a special directory and will then periodically try delivering it again and again until that succeeds or a (usually huge, like 4-5 days) timeout expires.</p>\n"}], "owner": {"reputation": 5339, "user_id": 314310, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/9c74f9c66df98052bef13864bffcd09c?s=128&d=identicon&r=PG", "display_name": "Anindya Chatterjee", "link": "https://stackoverflow.com/users/314310/anindya-chatterjee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8156, "favorite_count": 4, "closed_date": 1455982191, "accepted_answer_id": 35521846, "answer_count": 2, "score": 4, "last_activity_date": 1538012270, "creation_date": 1455956614, "question_id": 35520804, "link": "https://stackoverflow.com/questions/35520804/how-to-send-emails-in-golang-without-any-smtp-server", "closed_reason": "Needs more focus", "title": "How to send emails in golang without any smtp server", "body": "<p>I want to send bulk mail from a server application written in golang. I just don't want to use any third-party smtp server to avoid usage quota limitations. </p>\n\n<p>How can I send email without a smtp server? Is smtp package in standard library can help me? All example I see using the smtp package requires a third-party smtp server to send email.</p>\n"}, {"tags": ["go", "escaping", "unicode-escapes", "rune"], "answers": [{"tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 9, "last_activity_date": 1455945653, "creation_date": 1455945653, "answer_id": 35519469, "question_id": 35519106, "link": "https://stackoverflow.com/questions/35519106/how-to-decode-a-string-containing-backslash-encoded-unicode-characters/35519469#35519469", "title": "How to decode a string containing backslash-encoded Unicode characters?", "body": "<p>You can use <a href=\"https://golang.org/pkg/strconv/#Unquote\" rel=\"noreferrer\"><code>strconv.Unquote</code></a> for this:</p>\n\n<pre><code>u := `M\\u00fcnchen`\ns, err := strconv.Unquote(`\"` + u + `\"`)\nif err != nil {\n    // ..\n}\nfmt.Printf(\"%v\\n\", s)\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>M\u00fcnchen\n</code></pre>\n"}], "owner": {"reputation": 16583, "user_id": 913867, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/hUicX.jpg?s=128&g=1", "display_name": "Daniele B", "link": "https://stackoverflow.com/users/913867/daniele-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2078, "favorite_count": 0, "accepted_answer_id": 35519469, "answer_count": 1, "score": 4, "last_activity_date": 1455971191, "creation_date": 1455942385, "last_edit_date": 1455971191, "question_id": 35519106, "link": "https://stackoverflow.com/questions/35519106/how-to-decode-a-string-containing-backslash-encoded-unicode-characters", "title": "How to decode a string containing backslash-encoded Unicode characters?", "body": "<p>I have a string stored as <code>a</code>:</p>\n\n<pre><code>a := `M\\u00fcnchen`\nfmt.Println(a)  // prints \"M\\u00fcnchen\"\nb := \"M\\u00fcnchen\"\nfmt.Println(b)  // prints \"M\u00fcnchen\"\n</code></pre>\n\n<p>Is there a way I can convert <code>a</code> into <code>b</code> ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1455949701, "post_id": 35518548, "comment_id": 58730085, "body": "Note that this is extremely uncommon and you won&#39;t find a lot of Go code that does this in the wild."}], "answers": [{"comments": [{"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "edited": false, "score": 0, "creation_date": 1455937685, "post_id": 35518637, "comment_id": 58727649, "body": "Well, I stand corrected, I should have read the spec with more attention. Thanks!"}, {"owner": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "reply_to_user": {"reputation": 4567, "user_id": 1318734, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/S3JJ2.gif?s=128&g=1", "display_name": "rofls", "link": "https://stackoverflow.com/users/1318734/rofls"}, "edited": false, "score": 1, "creation_date": 1455958912, "post_id": 35518637, "comment_id": 58732277, "body": "@rofls: Really, ready to quit Go over this? If this is such an important feature for you and you plan to use it often, I highly recommend you rethink how you approach programming, because importing other packages into your local namespace is something you should generally avoid. Remember that you can always give local names to imported identifiers for convenience, e.g. <code>var now = time.Now</code>."}, {"owner": {"reputation": 4567, "user_id": 1318734, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/S3JJ2.gif?s=128&g=1", "display_name": "rofls", "link": "https://stackoverflow.com/users/1318734/rofls"}, "reply_to_user": {"reputation": 3070, "user_id": 3566064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494d9fad1c8b66110f8dbadaf9607212?s=128&d=identicon&r=PG&f=1", "display_name": "LemurFromTheId", "link": "https://stackoverflow.com/users/3566064/lemurfromtheid"}, "edited": false, "score": 1, "creation_date": 1455959558, "post_id": 35518637, "comment_id": 58732460, "body": "Thanks @Aedolon, but I was just kidding about quitting Go. I&#39;m only using it in one place, and I understand it&#39;s pretty bad practice in general."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1455938857, "last_edit_date": 1455938857, "creation_date": 1455937589, "answer_id": 35518637, "question_id": 35518548, "link": "https://stackoverflow.com/questions/35518548/load-package-contents-without-using-their-name-afterwards/35518637#35518637", "title": "Load package contents without using their name afterwards", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Import_declarations\" rel=\"nofollow\">Import declarations</a></p>\n  \n  <p>If an explicit period (.) appears instead of a name, all the package's\n  exported identifiers declared in that package's package block will be\n  declared in the importing source file's file block and must be\n  accessed without a qualifier.</p>\n</blockquote>\n\n<p>Use a period (.) instead of a name. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    . \"time\"\n)\n\nfunc main() {\n    fmt.Println(Now()) // time.Now()\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2009-11-10 23:00:00 +0000 UTC\n</code></pre>\n"}], "owner": {"reputation": 4567, "user_id": 1318734, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/S3JJ2.gif?s=128&g=1", "display_name": "rofls", "link": "https://stackoverflow.com/users/1318734/rofls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 1, "accepted_answer_id": 35518637, "answer_count": 1, "score": 2, "last_activity_date": 1455938857, "creation_date": 1455936755, "last_edit_date": 1455938432, "question_id": 35518548, "link": "https://stackoverflow.com/questions/35518548/load-package-contents-without-using-their-name-afterwards", "title": "Load package contents without using their name afterwards", "body": "<p>Is there a way to load the contents of a package in go without needing to use the package name? For example, in Python you can do:</p>\n\n<pre><code>from somepackage import *\n# access function from somepackage foo\nfoo()\n</code></pre>\n\n<p>I would like to do that in Go. I tried:</p>\n\n<pre><code>import _ \"path/to/my/package\"\n</code></pre>\n\n<p>but it didn't work. I'm having trouble articulating myself to find the solution online, if there is one.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15898, "user_id": 1155000, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8213d9cd920e864ce8ff1fdeefe4db5?s=128&d=identicon&r=PG", "display_name": "Daniel Kamil Kozar", "link": "https://stackoverflow.com/users/1155000/daniel-kamil-kozar"}, "edited": false, "score": 1, "creation_date": 1455933831, "post_id": 35518251, "comment_id": 58726932, "body": "<a href=\"https://go.googlesource.com/go/+/weekly.2009-11-06\" rel=\"nofollow noreferrer\">This is the oldest tag that appears in their git repo</a>"}, {"owner": {"reputation": 3002, "user_id": 2528907, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/i2N9j.png?s=128&g=1", "display_name": "George Chondrompilas", "link": "https://stackoverflow.com/users/2528907/george-chondrompilas"}, "edited": false, "score": 1, "creation_date": 1455933943, "post_id": 35518251, "comment_id": 58726951, "body": "What about searching <a href=\"https://github.com/golang/go/search?l=c\" rel=\"nofollow noreferrer\">here</a>?"}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 1, "creation_date": 1455966795, "post_id": 35518251, "comment_id": 58734707, "body": "The old compilers didn&#39;t translate Go programs to C, so the old versions won&#39;t necessarily help you answer that question any better than the new ones.  In both cases you have a program that converts Go source code to object files."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 9, "last_activity_date": 1455934996, "last_edit_date": 1455934996, "creation_date": 1455933969, "answer_id": 35518280, "question_id": 35518251, "link": "https://stackoverflow.com/questions/35518251/where-can-i-get-the-c-version-of-go-lang-source-code/35518280#35518280", "title": "Where can I get the C VERSION of go-lang source code?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/doc/go1.5\" rel=\"noreferrer\">Go 1.5 Release Notes</a></p>\n  \n  <p>The compiler and runtime are now written entirely in Go (with a little\n  assembler). C is no longer involved in the implementation, and so the\n  C compiler that was once necessary for building the distribution is\n  gone.</p>\n</blockquote>\n\n<p>Therefore, check out the <a href=\"https://go.googlesource.com/go\" rel=\"noreferrer\">source code</a> for previous release: <code>release-branch.go1.4</code>.</p>\n\n<p>For example,</p>\n\n<pre><code>git clone https://go.googlesource.com/go --branch release-branch.go1.4 --single-branch go1.4\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2139, "user_id": 1566267, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/587e35626fc8fa2bfd9af27216d2c16b?s=128&d=identicon&r=PG", "display_name": "John_West", "link": "https://stackoverflow.com/users/1566267/john-west"}, "is_accepted": false, "score": 0, "last_activity_date": 1455934174, "creation_date": 1455934174, "answer_id": 35518290, "question_id": 35518251, "link": "https://stackoverflow.com/questions/35518251/where-can-i-get-the-c-version-of-go-lang-source-code/35518290#35518290", "title": "Where can I get the C VERSION of go-lang source code?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/doc/devel/pre_go1.html\" rel=\"nofollow\">The r56 release was the first stable release</a> and corresponds to weekly.2011-03-07.1.</p>\n</blockquote>\n\n<p><a href=\"https://github.com/golang/go/releases/tag/release.r56\" rel=\"nofollow\">The code is on github</a>. It includes <code>C</code>, <code>bash</code>, <code>go</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 0, "last_activity_date": 1455934352, "creation_date": 1455934352, "answer_id": 35518310, "question_id": 35518251, "link": "https://stackoverflow.com/questions/35518251/where-can-i-get-the-c-version-of-go-lang-source-code/35518310#35518310", "title": "Where can I get the C VERSION of go-lang source code?", "body": "<p>I use Go 1.4.2 to bootstrap newer Go versions. I did a Go 1.6 build just this week.</p>\n\n<p>It looks like there is a Go 1.4.3 available here: <a href=\"https://storage.googleapis.com/golang/go1.4.3.src.tar.gz\" rel=\"nofollow\">https://storage.googleapis.com/golang/go1.4.3.src.tar.gz</a></p>\n"}], "owner": {"reputation": 346, "user_id": 4476748, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9411f33f09008556e0b6b5323f78fc35?s=128&d=identicon&r=PG&f=1", "display_name": "fding", "link": "https://stackoverflow.com/users/4476748/fding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1153, "favorite_count": 1, "accepted_answer_id": 35518280, "answer_count": 3, "score": 6, "last_activity_date": 1455934996, "creation_date": 1455933633, "question_id": 35518251, "link": "https://stackoverflow.com/questions/35518251/where-can-i-get-the-c-version-of-go-lang-source-code", "title": "Where can I get the C VERSION of go-lang source code?", "body": "<p>As I know, go-lang is <strong>written by C at the beginning</strong>, and now it is written by itself. I want to figure out some fundamental implementations of go-lang, such as multi-return-value-of-function, which probably use structure I guess.</p>\n\n<p>But now the go-lang version of go-lang source code has conceal these details, so where can I get the <strong>C version of go-lang source code (history version)</strong>? I've checked golang.org, nothing found.</p>\n\n<p>Thanks. </p>\n"}, {"tags": ["go", "syntax", "scope", "pug"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1455928606, "post_id": 35517552, "comment_id": 58725748, "body": "If you have a language-specific question, it&#39;s typically better to add a tag for that language. It brings it to the attention of those who monitor that tag, getting you help sooner from those who are knowledgeable. It also makes it available to future readers who are searching for language-specific information to find in a search. Can you <a href=\"https://stackoverflow.com/posts/35517552/edit\">edit</a> and add one? You might make the title question appear less like asking for speculation or opinion; it usually helps as well."}, {"owner": {"reputation": 518, "user_id": 5813225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4f05e2c4ff75c55a8f233f80050ebf1a?s=128&d=identicon&r=PG&f=1", "display_name": "cfatt10", "link": "https://stackoverflow.com/users/5813225/cfatt10"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1455928746, "post_id": 35517552, "comment_id": 58725784, "body": "I added tags for Go and Jade, but as far as I know the creators of Jade are unaffiliated with this project"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1455929033, "post_id": 35517552, "comment_id": 58725842, "body": "Who said anything about affiliations? Your question is asking a (somewhat opinion seeking) question about the language design and how to deal with a situation, which others familiar with Go or Jade might be able to answer even if they&#39;re not the <i>creators of Jade</i>. Thanks for listening to half of what I said, anyway. :-)"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1455929532, "post_id": 35517552, "comment_id": 58725961, "body": "Sounds like an implementation error. golang&#39;s if blocks can see their enclosing scope."}, {"owner": {"reputation": 2445, "user_id": 1505341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XpLu.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/1505341/kerem"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1455946727, "post_id": 35517552, "comment_id": 58729411, "body": "Wish there was an option to vote for &quot;Convert to community approved answer&quot; for these unanswered lonely questions. @Adam&#39;s comment would be such an example."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 2445, "user_id": 1505341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XpLu.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/1505341/kerem"}, "edited": false, "score": 0, "creation_date": 1455994300, "post_id": 35517552, "comment_id": 58744493, "body": "@mass Although I appreciate the support, my comment isn&#39;t an answer worth having."}], "answers": [{"comments": [{"owner": {"reputation": 518, "user_id": 5813225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4f05e2c4ff75c55a8f233f80050ebf1a?s=128&d=identicon&r=PG&f=1", "display_name": "cfatt10", "link": "https://stackoverflow.com/users/5813225/cfatt10"}, "edited": false, "score": 0, "creation_date": 1456002828, "post_id": 35520615, "comment_id": 58747706, "body": "Thanks for the extensive answer! It appears the problem was that $index and $headshot were switched around. I think the error it was throwing, combined with the documentation for the node.js version (see the syntax here <a href=\"http://jade-lang.com/reference/iteration/\" rel=\"nofollow noreferrer\">jade-lang.com/reference/iteration</a> ) misled me."}], "tags": [], "owner": {"reputation": 38917, "user_id": 445210, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9b689cc1d73c4f1e7378d045a54abcca?s=128&d=identicon&r=PG", "display_name": "Herman Schaaf", "link": "https://stackoverflow.com/users/445210/herman-schaaf"}, "is_accepted": true, "score": 2, "last_activity_date": 1455954922, "creation_date": 1455954922, "answer_id": 35520615, "question_id": 35517552, "link": "https://stackoverflow.com/questions/35517552/variable-not-accessible-inside-if-statement-language-design/35520615#35520615", "title": "Variable not accessible inside if statement. Language design?", "body": "<p>First off, Go's <code>if</code> blocks have access to variables in their enclosing scope. If this is failing in your example, it must be because of an implementation error either in your code or the library you are using. </p>\n\n<p>Next, let's fix some problems in the posted code:</p>\n\n<pre><code>each $headshot, index in $cause.Headshots\n</code></pre>\n\n<p>The order should be reversed--index goes first--and let's be consistent with the use of <code>$</code> to indicate variables:</p>\n\n<pre><code>each $i, $headshot in $cause.Headshots\n</code></pre>\n\n<p>With that cleared up, here is a full demo script:</p>\n\n<h3>templates/home.jade</h3>\n\n<pre><code>html\n    body\n        each $i, $headshot in Cause.Headshots\n            if $i == 0\n                img.img-circle.headshot(src=\"/public/images/ellipse.png\")\n            else\n                img.img-circle.headshot(src=$headshot)\n</code></pre>\n\n<h3>demo.go</h3>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"os\"\n\n    \"github.com/go-floki/jade\"\n)\n\nfunc main() {\n    w := bufio.NewWriter(os.Stdout)\n    // compile templates\n    templates, err := jade.CompileDir(\"./templates\", jade.DefaultDirOptions, jade.Options{})\n    if err != nil {\n        panic(err)\n    }\n\n    // then render some template\n    tpl := templates[\"home\"]\n    tpl.Execute(w, map[string]interface{}{\n        \"Cause\": map[string]interface{}{\n            \"Headshots\": []string{\"one\", \"two\"},\n        },\n    })\n    w.Flush()\n}\n</code></pre>\n\n<p>This code works for me, the output is:</p>\n\n<pre><code>&lt;html&gt;&lt;body&gt;&lt;img class=\"img-circle headshot\" src=\"/public/images/ellipse.png\" /&gt;&lt;img class=\"img-circle headshot\" src=\"two\" /&gt;&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<p>So my only conclusion is that there must be something else going on in your example. It could be a bug in the library, but I would first check the following things:</p>\n\n<ul>\n<li>is there a mixture of spaces and tabs in the jade file? This could cause scope confusion</li>\n<li>does the example I posted above also give you an error? If so,\n\n<ul>\n<li>are you using the latest version of the Jade library?</li>\n<li>is your Go version up to date?</li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 518, "user_id": 5813225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4f05e2c4ff75c55a8f233f80050ebf1a?s=128&d=identicon&r=PG&f=1", "display_name": "cfatt10", "link": "https://stackoverflow.com/users/5813225/cfatt10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 35520615, "answer_count": 1, "score": 0, "last_activity_date": 1455954922, "creation_date": 1455928265, "last_edit_date": 1455929462, "question_id": 35517552, "link": "https://stackoverflow.com/questions/35517552/variable-not-accessible-inside-if-statement-language-design", "title": "Variable not accessible inside if statement. Language design?", "body": "<p>So I'm working with an implementation of the Jade templating language for Go (see <a href=\"https://github.com/go-floki/jade\" rel=\"nofollow\">https://github.com/go-floki/jade</a>) and I'm running into an interesting \"feature\" of the language. The code below works as expected, placing and <code>img</code> element for every headshot.</p>\n\n<pre><code>each $headshot in $object.Headshots\n    img.img-circle.headshot(src=$headshot)\n</code></pre>\n\n<p>I then wanted to change it so on the sixth element the image source would be a preset image. However, when I run this code I get an error</p>\n\n<pre><code>each $headshot, index in $cause.Headshots\n    if index == 6\n        img.img-circle.headshot(src=\"/public/images/ellipse.png\")\n    else\n        img.img-circle.headshot(src=$headshot)\n</code></pre>\n\n<p>Specifically <code>undefined variable $headshot</code>. It seems that <code>$headshot</code> does not exist within the scope of the <code>if</code> statement. This isn't the first time I've run into this behavior using this implementation and it's frustrating to try to work around. The trouble that it takes made me wonder, is there possibly a reason the language works this way?</p>\n\n<p>Additionally, can anyone think of a way to work around the \"feature\" in this case? The best I can come up with is to change it later client-side with Javascript.</p>\n"}, {"tags": ["function", "go", "trigonometry"], "comments": [{"owner": {"reputation": 1483, "user_id": 1069760, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/a8da1816d58fdd81c172bc8d160c5072?s=128&d=identicon&r=PG", "display_name": "nikdeapen", "link": "https://stackoverflow.com/users/1069760/nikdeapen"}, "edited": false, "score": 0, "creation_date": 1455923636, "post_id": 35516647, "comment_id": 58724149, "body": "As far as I can tell its just a rounding error in the library.  The source code is here: <a href=\"https://golang.org/src/math/sin.go?h=math\" rel=\"nofollow noreferrer\">golang.org/src/math/sin.go?h=math</a>"}, {"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "edited": false, "score": 1, "creation_date": 1455923743, "post_id": 35516647, "comment_id": 58724192, "body": "<a href=\"https://github.com/golang/go/issues/3004\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/3004</a>"}], "answers": [{"tags": [], "owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "is_accepted": false, "score": 7, "last_activity_date": 1455923598, "creation_date": 1455923598, "answer_id": 35516795, "question_id": 35516647, "link": "https://stackoverflow.com/questions/35516647/is-there-a-solution-to-fixed-cos-math-function-in-golang/35516795#35516795", "title": "Is there a solution to fixed cos math function in golang", "body": "<p>The <a href=\"https://www.google.com/search?q=cos(pi+%2F+2)\">cosine of pi / 2 is <em>zero</em></a>.</p>\n\n<p>What you're seeing is just a slight floating point inaccuracy. It's correctly returning \"almost zero\".</p>\n\n<p>See: <a href=\"https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\">What Every Computer Scientist Should Know About Floating-Point Arithmetic</a>.</p>\n"}], "owner": {"reputation": 29, "user_id": 5953645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ccad15c45be3f57708919e3b0bb221c?s=128&d=identicon&r=PG&f=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/5953645/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1455923598, "creation_date": 1455922914, "question_id": 35516647, "link": "https://stackoverflow.com/questions/35516647/is-there-a-solution-to-fixed-cos-math-function-in-golang", "title": "Is there a solution to fixed cos math function in golang", "body": "<p>I am trying to use cos function from math API in golang, but for some reason the function is returning an incorrect value. Is there a known solution for this problem?</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>    fmt.Println(\"cos(pi/2):\", math.Cos(math.Pi / 2))\n    fmt.Println(\"sen(pi/2):\", math.Sin(math.Pi / 2))\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<p>cos(pi/2): 6.123233995736757e-17</p>\n\n<p>sen(pi/2): 1</p>\n"}, {"tags": ["date", "datetime", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1455920876, "post_id": 35516120, "comment_id": 58723051, "body": "What about the <code>Month()</code>, <code>Day()</code> and <code>Year()</code> methods on <code>time.Time</code>?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1455922938, "post_id": 35516120, "comment_id": 58723893, "body": "@JimB: That&#39;s expensive. Use <a href=\"https://golang.org/pkg/time/#Time.Date\" rel=\"nofollow noreferrer\">func (Time) Date</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1455924168, "post_id": 35516120, "comment_id": 58724357, "body": "@peterSO, yeah, I didn&#39;t check the docs myself ;)"}], "answers": [{"comments": [{"owner": {"reputation": 1817, "user_id": 3788671, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f0cb8a038eabc074f749fc7cb05b8d09?s=128&d=identicon&r=PG&f=1", "display_name": "user3788671", "link": "https://stackoverflow.com/users/3788671/user3788671"}, "edited": false, "score": 0, "creation_date": 1455921008, "post_id": 35516279, "comment_id": 58723104, "body": "That&#39;s what i am looking for. Thanks, sorry for the bad question."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 1817, "user_id": 3788671, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f0cb8a038eabc074f749fc7cb05b8d09?s=128&d=identicon&r=PG&f=1", "display_name": "user3788671", "link": "https://stackoverflow.com/users/3788671/user3788671"}, "edited": false, "score": 0, "creation_date": 1455921052, "post_id": 35516279, "comment_id": 58723121, "body": "@user3788671 that&#39;s nbd. It may be obvious for people familiar with the package/type but if it&#39;s not on SO already then there is value in asking it."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 7, "last_activity_date": 1582177475, "last_edit_date": 1582177475, "creation_date": 1455920955, "answer_id": 35516279, "question_id": 35516120, "link": "https://stackoverflow.com/questions/35516120/get-day-month-and-year-from-time-in-go-language/35516279#35516279", "title": "Get Day, Month, and Year from Time in Go Language", "body": "<p>All the methods you're looking for exist on the <code>time.Time</code> type. You can just do;</p>\n\n<pre><code>year := fromDate.Year()\nmonth := fromDate.Month()\nday := fromDate.Day()\n</code></pre>\n\n<p>EDIT:\nI suppose it would be more concise to use time.Date like so;</p>\n\n<pre><code>year, month, day := fromDate.Date()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": false, "score": 8, "last_activity_date": 1455921166, "creation_date": 1455921166, "answer_id": 35516319, "question_id": 35516120, "link": "https://stackoverflow.com/questions/35516120/get-day-month-and-year-from-time-in-go-language/35516319#35516319", "title": "Get Day, Month, and Year from Time in Go Language", "body": "<p>The <code>time</code> type also has <a href=\"https://golang.org/pkg/time/#Time.Date\"><code>Date()</code></a> method which returns the year, month and day of the time in single call.</p>\n"}, {"tags": [], "owner": {"reputation": 1074, "user_id": 9363929, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FS1lH1f5mjo/AAAAAAAAAAI/AAAAAAAAAAc/xLut-sRzp-0/photo.jpg?sz=128", "display_name": "miqrc", "link": "https://stackoverflow.com/users/9363929/miqrc"}, "is_accepted": false, "score": 1, "last_activity_date": 1577194364, "creation_date": 1577194364, "answer_id": 59469590, "question_id": 35516120, "link": "https://stackoverflow.com/questions/35516120/get-day-month-and-year-from-time-in-go-language/59469590#59469590", "title": "Get Day, Month, and Year from Time in Go Language", "body": "<p>With the accepted method, if you need the month <strong>number</strong> you can simply cast the Month object to int since it's an enum:</p>\n\n<pre><code>year, month, day := time.Now().Date()\nlog.Printf(\"%v-%v-%v\", year, int(month), day)\n</code></pre>\n"}], "owner": {"reputation": 1817, "user_id": 3788671, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f0cb8a038eabc074f749fc7cb05b8d09?s=128&d=identicon&r=PG&f=1", "display_name": "user3788671", "link": "https://stackoverflow.com/users/3788671/user3788671"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6577, "favorite_count": 0, "accepted_answer_id": 35516279, "answer_count": 3, "score": 6, "last_activity_date": 1582177475, "creation_date": 1455920263, "question_id": 35516120, "link": "https://stackoverflow.com/questions/35516120/get-day-month-and-year-from-time-in-go-language", "title": "Get Day, Month, and Year from Time in Go Language", "body": "<p>I have an object like this:</p>\n\n<pre><code>type searchObj struct {\n    symbol string\n    dataType string\n    fromDate time.Time\n    toDate time.Time\n}\n</code></pre>\n\n<p>I want to be able to parse out the day, month, and year from the fromDate and the toDate. How can I do this? Is there a better type to use like (Date) because I do not need the time piece of it?</p>\n\n<p>so I want to be able to pass a date like this 02/19/2016 and be able to get data.Day = 19, date.Month = 02, date.Year = 2016.</p>\n\n<p>I was trying something like this:</p>\n\n<pre><code>search.fromDate.Date.Month\nsearch.fromDate.Date.Day\nsearch.fromDate.Date.Year\n</code></pre>\n\n<p>This is an example of what I am currently using to create the searchObj:</p>\n\n<pre><code>time.Date(2009, time.November, 10, 23, 0, 0, 0, time.UTC)\n</code></pre>\n\n<p>I am new to Go and thank you for the help!</p>\n"}, {"tags": ["azure", "go", "azure-web-app-service", "kudu"], "answers": [{"comments": [{"owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "edited": false, "score": 0, "creation_date": 1455922536, "post_id": 35516470, "comment_id": 58723752, "body": "When receiving this the first time I did a rm -rf on deployments and on repository, I just tried to deploy on a fresh web app and I&#39;m getting same error, for some reasons the dependencies are not seen from the /vendor folder"}, {"owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "edited": false, "score": 0, "creation_date": 1455923005, "post_id": 35516470, "comment_id": 58723926, "body": "it is trying to clone the vendored dependency remote: # cd .; git clone <a href=\"https://github.com/org/mypkg\" rel=\"nofollow noreferrer\">github.com/org/mypkg</a>  . Even if GO15VENDOREXPERIMENT=1 I don&#39;t get what I&#39;m doing wrong"}, {"owner": {"reputation": 3417, "user_id": 5463877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e88da9f0b09bd7ddb86d1336e75980fd?s=128&d=identicon&r=PG", "display_name": "Xiaomin Wu", "link": "https://stackoverflow.com/users/5463877/xiaomin-wu"}, "edited": false, "score": 0, "creation_date": 1455929922, "post_id": 35516470, "comment_id": 58726059, "body": "can you try to clean up the cache as what David mention and try again?  also will be good to do a diff of all the environment variable since you mention you have another Go app is working, to see what are the difference. (to get environment variable, simple run &quot;set&quot; on debug console)"}, {"owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "edited": false, "score": 0, "creation_date": 1455960567, "post_id": 35516470, "comment_id": 58732739, "body": "Xiaomin Wu yes I removed cache in Tools, did the SET to make sure GO15VENDOREXPERIMENT was there (it is), removed .deployment/deploy.cmd from local than push. Kudu is automatically seeing a Nodejs deployment (probably due to package.json, so it&#39;s not seeing the main.go or take Node by default in order of importance]. So I re-cleared the cache on deployments/Tools, removed web.config on server, added the deploy.cmd from deployments/tools from a working Go app I have on Azure, so I guess the issue was that even after a reset the deploymentCacheKey was always reset to a Node deploy"}, {"owner": {"reputation": 3417, "user_id": 5463877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e88da9f0b09bd7ddb86d1336e75980fd?s=128&d=identicon&r=PG", "display_name": "Xiaomin Wu", "link": "https://stackoverflow.com/users/5463877/xiaomin-wu"}, "edited": false, "score": 0, "creation_date": 1456165074, "post_id": 35516470, "comment_id": 58810095, "body": "right, if you have package.json file there, nodejs project resolver will be take over than go project resolver, since go project resolver was introduced after nodejs project resolver."}], "tags": [], "owner": {"reputation": 40200, "user_id": 111888, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3c4e7f8b11f8b8c1d77ebb70678097b4?s=128&d=identicon&r=PG", "display_name": "David Ebbo", "link": "https://stackoverflow.com/users/111888/david-ebbo"}, "is_accepted": true, "score": 7, "last_activity_date": 1455921871, "creation_date": 1455921871, "answer_id": 35516470, "question_id": 35515920, "link": "https://stackoverflow.com/questions/35515920/how-to-reset-kudu-cached-deployment-on-azure/35516470#35516470", "title": "How to reset Kudu cached deployment on Azure", "body": "<p>Not sure what caused that state, but try the following:</p>\n\n<ul>\n<li>Go to <a href=\"https://github.com/projectkudu/kudu/wiki/Kudu-console\" rel=\"noreferrer\">Kudu Console</a></li>\n<li>Got into the <code>D:\\home\\site\\deployments\\tools</code> folder</li>\n<li>Delete <code>deploy.cmd</code> and <code>deploymentCacheKey</code></li>\n<li>Try depoying</li>\n</ul>\n"}], "owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2739, "favorite_count": 0, "accepted_answer_id": 35516470, "answer_count": 1, "score": 4, "last_activity_date": 1455922944, "creation_date": 1455919446, "last_edit_date": 1455922944, "question_id": 35515920, "link": "https://stackoverflow.com/questions/35515920/how-to-reset-kudu-cached-deployment-on-azure", "title": "How to reset Kudu cached deployment on Azure", "body": "<p>I previously had a Node app on Azure Web App that is now a Go app. Problem is when I deploy I get this from Kudu:</p>\n\n<p><code>Using cached version of deployment script (command: 'azure -y --no-dot-deployment -r \"D:\\home\\site\\repository\" -o \"D:\\home\\site\\deployments\\tools\" --node --sitePath \"D:\\home\\site\\repository\"').</code></p>\n\n<p>This obviously complains later that no server/app.js file are found.</p>\n\n<p>So I tried generating a deployment script for my app with <code>azure site deploymentscript --go</code>.</p>\n\n<p>Even though I have the GO15VENDOREXPERIMENT=1 in the app's settings it was complaining about dependencies. All my dependencies are vendored in the /vendor folder.</p>\n\n<p>I than set this variable inside the <code>deploy.cmd</code> file that were generated by the <code>azure site deploymentscript</code> command.</p>\n\n<p>Still it's complaining that one dependencies is not there. Note that now it is searching into the local vendor tree, but the dependencies is there, I can see it in the Github repo and I see it locally as well.</p>\n\n<p>I have other Go apps that deployed just fine with vendored dependencies on Azure, but this one, was a Node app previously is simply not working at all.</p>\n\n<p>I even tried to comment the dependencies getter from the <code>deploy.cmd</code>, since all are local this steps is not required. But even that did not work, because the <code>go build</code> failed complaining about the dependency not being there. It's on the vendor folder and <code>GO15VENDOREEXPERIMENT</code> is set to 1 in the cmd file and in the app application settings.</p>\n\n<p>So what are my option here?</p>\n\n<p>How can I tell Kudu to use a Go default deployment, maybe the one from Azure will work, since my other app do not have local <code>.deployement</code> and <code>deploy.cmd</code> files.</p>\n\n<p>Edit</p>\n\n<p>I just did a test deploy to a completely new Azure web app, and the app is detected as a Node app by default. I would guess it's due to the presence of a package.json at the root, I also have a main.go that has <code>package main</code> as package name.</p>\n\n<p>So maybe it's just the <code>deploy.cmd</code> that is generated by <code>azure site deploymentscript</code> that is not up-to-date or something? (I updated my verison of the azure-cli just FYI, since at first I did not had the --go flag).</p>\n\n<p>Just for completeness here's the output of Kudu when deploying on a freshly created app, getting same error as the Node one:</p>\n\n<p><code>\nremote: Resolving dependencies\nremote: # cd .; git clone https://github.com/org/mypkg D:\\local\\Temp\\8d3397e1e014401\\gopath\\src\\github.com\\org\\mypkg\nremote: Building Go app to produce exe file\nremote: Cloning into 'D:\\local\\Temp\\8d3397e1e014401\\gopath\\src\\github.com\\org\\mypkg'...\nremote: fatal: could not read Username for 'https://github.com': Bad file descriptor\nremote: package github.com/org/pkg/lib: exit status 128\nremote: azureapp\\main.go:3:8: cannot find package \"github.com/org/pkg/lib\" in any of:\nremote:         D:\\local\\Temp\\8d3397e1e014401\\gopath\\src\\azureapp\\vendor\\github.com\\org\\pkg\\lib (vendor tree)\nremote: Copy files for deployment\nremote:         D:\\Program Files\\Go\\1.5.3\\src\\github.com\\org\\pkg\\lib (from $GOROOT)\nremote:         D:\\local\\Temp\\8d3397e1e014401\\gopath\\src\\github.com\\org\\pkg\\lib (from $GOPATH)\nremote: KuduSync.NET from: 'D:\\home\\site\\repository' to: 'D:\\home\\site\\wwwroot'\nremote: Could Not Find D:\\home\\site\\repository\\azureapp.exe\nremote: Copy web.config\nremote: web.config already existed. Skip\nremote: Finished successfully.\nremote: Running post deployment command(s)...\nremote: Deployment successful.\n</code></p>\n\n<p>Why is it trying to clone the library, this line here [second line] is probably what cause the entire issue:</p>\n\n<p><code>remote: # cd .; git clone https://github.com/org/mypkg</code></p>\n\n<p>Why if <code>SET GO15VENDOREXPERIMENT=1</code> is set it is trying to clone the dependency? It's not doing that on my other Go app.</p>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1455918850, "post_id": 35515449, "comment_id": 58722089, "body": "Are you OK with unmarshalling the object or is it a requirement that you print it when it is still a profobuf message? Also are you using this package? <a href=\"https://github.com/golang/protobuf\" rel=\"nofollow noreferrer\">github.com/golang/protobuf</a>"}, {"owner": {"reputation": 4478, "user_id": 557406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99836456ec6d87389df32d2cdcf8d825?s=128&d=identicon&r=PG", "display_name": "Charles L.", "link": "https://stackoverflow.com/users/557406/charles-l"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1455920128, "post_id": 35515449, "comment_id": 58722709, "body": "Yes, I have it unmarshalled (a proto.Message object, not a string/byte[]).  I&#39;d prefer to use a proto.Message, but it&#39;s not a requirement.  I am using that library."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1455924960, "post_id": 35515449, "comment_id": 58724612, "body": "Wish I could give you an answer because I&#39;m sure it&#39;s possible but I just haven&#39;t used the package in about a year now and don&#39;t have the time to dig through it&#39;s source."}, {"owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "edited": false, "score": 0, "creation_date": 1455925308, "post_id": 35515449, "comment_id": 58724739, "body": "Which protobuf implementation are you using?"}, {"owner": {"reputation": 4478, "user_id": 557406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99836456ec6d87389df32d2cdcf8d825?s=128&d=identicon&r=PG", "display_name": "Charles L.", "link": "https://stackoverflow.com/users/557406/charles-l"}, "edited": false, "score": 0, "creation_date": 1455926356, "post_id": 35515449, "comment_id": 58725059, "body": "<a href=\"https://github.com/golang/protobuf\" rel=\"nofollow noreferrer\">github.com/golang/protobuf</a> - also updated the question"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1455992227, "post_id": 35515449, "comment_id": 58743652, "body": "I am using the grpc lib, and that also automagicly creates json marshalers. Maybe that is helpful?"}], "answers": [{"tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": false, "score": 3, "last_activity_date": 1455944153, "creation_date": 1455944153, "answer_id": 35519285, "question_id": 35515449, "link": "https://stackoverflow.com/questions/35515449/does-golang-provide-an-easy-way-to-output-human-readable-protobuf/35519285#35519285", "title": "Does golang provide an easy way to output human readable protobuf", "body": "<p>You can use the <a href=\"https://godoc.org/github.com/golang/protobuf/proto#TextMarshaler\" rel=\"nofollow\">TextMarshaler</a>. With a slightly modified example proto:</p>\n\n<pre><code>p := &amp;example.Test{\n    Label: proto.String(\"this\"),\n    Reps:  []int64{4, 3, 2, 1},\n    InnerTest: &amp;example.Test_InnerTest{\n        InnerLabel: proto.String(\"is the end\"),\n    },\n}\n\nt := proto.TextMarshaler{}\nt.Marshal(os.Stdout, p)\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>label: \"this\"\nreps: 4\nreps: 3\nreps: 2\nreps: 1\ninner_test: &lt;\n  inner_label: \"is the end\"\n&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 206, "user_id": 5582265, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-v_0CFdsGtLw/AAAAAAAAAAI/AAAAAAAAP-c/Kt5J6EIys38/photo.jpg?sz=128", "display_name": "Pascal Corpet", "link": "https://stackoverflow.com/users/5582265/pascal-corpet"}, "is_accepted": true, "score": 14, "last_activity_date": 1456090085, "creation_date": 1456090085, "answer_id": 35542308, "question_id": 35515449, "link": "https://stackoverflow.com/questions/35515449/does-golang-provide-an-easy-way-to-output-human-readable-protobuf/35542308#35542308", "title": "Does golang provide an easy way to output human readable protobuf", "body": "<p>I believe you're looking for <a href=\"https://godoc.org/github.com/golang/protobuf/proto#MarshalTextString\" rel=\"noreferrer\">proto.MarshalTextString</a>.</p>\n\n<pre><code>p := &amp;example.Test{\n  Label: proto.String(\"this\"),\n  Reps:  []int64{4, 3, 2, 1},\n  InnerTest: &amp;example.Test_InnerTest{\n    InnerLabel: proto.String(\"is the end\"),\n  },\n}\n\nfmt.Println(proto.MarshalTextString(p))\n</code></pre>\n\n<p>You can see an example in the Go package <a href=\"https://github.com/golang/protobuf/blob/master/proto/text_test.go#L430\" rel=\"noreferrer\">test</a>.</p>\n"}], "owner": {"reputation": 4478, "user_id": 557406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99836456ec6d87389df32d2cdcf8d825?s=128&d=identicon&r=PG", "display_name": "Charles L.", "link": "https://stackoverflow.com/users/557406/charles-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6886, "favorite_count": 1, "accepted_answer_id": 35542308, "answer_count": 2, "score": 6, "last_activity_date": 1456090085, "creation_date": 1455917585, "last_edit_date": 1455926347, "question_id": 35515449, "link": "https://stackoverflow.com/questions/35515449/does-golang-provide-an-easy-way-to-output-human-readable-protobuf", "title": "Does golang provide an easy way to output human readable protobuf", "body": "<p>Is there a good way to get a human readable string representation of protobuf objects in golang?  Something equivalent to <a href=\"https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.message#Message.DebugString\" rel=\"noreferrer\">https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.message#Message.DebugString</a>?</p>\n\n<p>I am using <a href=\"https://github.com/golang/protobuf\" rel=\"noreferrer\">https://github.com/golang/protobuf</a>.</p>\n"}]