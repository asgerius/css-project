[{"tags": ["go", "rethinkdb"], "answers": [{"comments": [{"owner": {"reputation": 554, "user_id": 595810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3772bef568ee12d860832bb2fa113745?s=128&d=identicon&r=PG", "display_name": "Daniel Cannon", "link": "https://stackoverflow.com/users/595810/daniel-cannon"}, "edited": false, "score": 1, "creation_date": 1473965148, "post_id": 39517866, "comment_id": 66352269, "body": "Thanks @dalanmiller! That looks like it should work, there were a couple of very small Go syntax errors (I have submitted an edit which addresses these) but I think it should answer @Fantasim&#39;s question."}, {"owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "edited": false, "score": 0, "creation_date": 1473966769, "post_id": 39517866, "comment_id": 66353045, "body": "I had previously seen or and and function , but I did not realize it worked like that, thanks a lot!"}], "tags": [], "owner": {"reputation": 2867, "user_id": 1076057, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/h2k2g.jpg?s=128&g=1", "display_name": "dalanmiller", "link": "https://stackoverflow.com/users/1076057/dalanmiller"}, "is_accepted": true, "score": 2, "last_activity_date": 1473968384, "last_edit_date": 1473968384, "creation_date": 1473963658, "answer_id": 39517866, "question_id": 39498797, "link": "https://stackoverflow.com/questions/39498797/two-filters-with-an-or-condition-on-rethinkdb/39517866#39517866", "title": "Two filters with an OR-condition on RethinkDB", "body": "<p>I'm going to summon @daniel-cannon here but I think this is what you're looking for and will vastly simplify this query and reduce it to just a single query. But just two tips: </p>\n\n<ul>\n<li><code>r.And</code> and <code>r.Or</code> and their two use cases are very much your friends for doing some tricky logical conditions. \n\n<ul>\n<li><a href=\"https://www.rethinkdb.com/api/javascript/#and\" rel=\"nofollow\">https://www.rethinkdb.com/api/javascript/#and</a></li>\n<li><a href=\"https://www.rethinkdb.com/api/javascript/#or\" rel=\"nofollow\">https://www.rethinkdb.com/api/javascript/#or</a></li>\n</ul></li>\n<li>You can provide anonymous functions to <code>.Filter</code> to do things that would be kind of ugly with the simplified <code>r.Row</code> pattern. </li>\n</ul>\n\n<pre class=\"lang-golang prettyprint-override\"><code>r.Table(\"talks\").Filter(func(talk r.Term) r.Term {\n    return r.Or(\n        r.And(talk.Field(\"UserIdX\").Eq(UserIdX), talk.Field(\"UserIdX\").Eq(UserIdY)),\n        r.And(talk.Field(\"UserIdY\").Eq(UserIdX), talk.Field(\"UserIdX\").Eq(UserIdY)),\n    )\n}).Run(api.Sess)\n</code></pre>\n\n<p>I hope this helps! </p>\n"}], "owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 983, "favorite_count": 2, "accepted_answer_id": 39517866, "answer_count": 1, "score": 2, "last_activity_date": 1473968384, "creation_date": 1473883496, "last_edit_date": 1473894853, "question_id": 39498797, "link": "https://stackoverflow.com/questions/39498797/two-filters-with-an-or-condition-on-rethinkdb", "title": "Two filters with an OR-condition on RethinkDB", "body": "<p>I've a struct : </p>\n\n<pre><code>type Talk struct {\n    Id string `gorethink:\"id,omitempty\"`\n    MatchId string\n    UserIdX string\n    UserIdY string\n    UserNameX string\n    UserNameY string\n    CreatedAt time.Time\n}\n</code></pre>\n\n<p>My current <code>Talk</code> struct looks like this:</p>\n\n<pre><code>{\n    \"CreatedAt\": Wed Sep 14 2016 21:36:26 GMT+02:00 ,\n    \"MatchId\":  \"172d51fa-438b-49a5-bbe5-422377f09336\" ,\n    \"UserIdX\":  \"acc4e0b6-d33b-4755-9c0a-ae5309c2ba75\" ,\n    \"UserIdY\":  \"03f76d8b-ed6a-4c0f-9cde-27b17c9e7cdb\" ,\n    \"UserNameX\":  \"Barbara\" ,\n    \"UserNameY\":  \"Louis\" ,\n    \"id\":  \"ead3f1b0-b242-4c6d-8027-a59572b58649\"\n}\n</code></pre>\n\n<p>How can I retrieve a talk, with a single query, where: </p>\n\n<blockquote>\n  <p>(UserIdX == talk.UserIdX AND UserIdY == talk.UserIdY) OR (UserIdX ==\n  talk.UserIdY AND UserIdY == talk.UserIdX)</p>\n</blockquote>\n\n<p>I actually do it like the following:</p>\n\n<pre><code>func (talk *Talk) GetTalkByUsersId() bool {\n    talk1 := new(Talk)\n    talk2 := new(Talk)\n\n    curs, _ :=  r.Table(\"Talks\").\n                Filter(r.Row.Field(\"UserIdX\").Eq(talk.UserIdX)).\n                Filter(r.Row.Field(\"UserIdY\").Eq(talk.UserIdY)).\n                Run(api.Sess)\n\n    curs2, _ :=  r.Table(\"Talks\").\n                Filter(r.Row.Field(\"UserIdX\").Eq(talk.UserIdY)).\n                Filter(r.Row.Field(\"UserIdY\").Eq(talk.UserIdX)).\n                Run(api.Sess)\n\n    curs.One(&amp;talk1)\n    curs2.One(&amp;talk2)\n    if talk1.Id == \"\" &amp;&amp; talk2.Id == \"\" {\n        return false\n    }\n    if talk1.Id != \"\" {\n        talk.copyTalk(talk1)\n    } else {\n        talk.copyTalk(talk2)\n    }\n    return true\n}\n</code></pre>\n\n<p>How can I get this to work in a much simpler way?</p>\n"}, {"tags": ["go", "ffmpeg"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1473875424, "post_id": 39496572, "comment_id": 66310926, "body": "a pipe is a shell construct, not a command argument, see <a href=\"http://stackoverflow.com/a/10953142/32880\">stackoverflow.com/a/10953142/32880</a>"}], "answers": [{"tags": [], "owner": {"reputation": 472, "user_id": 2064183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9d0065dda5ffd11d5c0f516fc2bce5?s=128&d=identicon&r=PG", "display_name": "Kyaw Myint Thein", "link": "https://stackoverflow.com/users/2064183/kyaw-myint-thein"}, "is_accepted": false, "score": 4, "last_activity_date": 1473923191, "creation_date": 1473923191, "answer_id": 39504925, "question_id": 39496572, "link": "https://stackoverflow.com/questions/39496572/running-command-with-pipe-in-golang-exec/39504925#39504925", "title": "Running command with pipe in Golang exec", "body": "<p>I think this will help you.</p>\n\n<pre><code>     cmd := \"phantomjs runner.js | ffmpeg -y -c:v png -f image2pipe -r 25 -t 10  -i - -c:v libx264 -pix_fmt yuv420p -movflags +faststart dragon.mp4\"\n     output, err := exec.Command(\"bash\",\"-c\",cmd).Output()\n     if err != nil {\n            return fmt.Sprintf(\"Failed to execute command: %s\", cmd)\n     }\n     fmt.Println(string(output))\n</code></pre>\n"}], "owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3384, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473923191, "creation_date": 1473874813, "question_id": 39496572, "link": "https://stackoverflow.com/questions/39496572/running-command-with-pipe-in-golang-exec", "title": "Running command with pipe in Golang exec", "body": "<p>I am trying to get the example from <a href=\"http://mindthecode.com/recording-a-website-with-phantomjs-and-ffmpeg/\" rel=\"nofollow\">here</a> working to record a webpage with phantomjs and pipe the stdout, which are images, to the ffmpeg command to create the video. The command stated that you need to run is:</p>\n\n<pre><code>phantomjs runner.js | ffmpeg -y -c:v png -f image2pipe -r 25 -t 10  -i - -c:v libx264 -pix_fmt yuv420p -movflags +faststart dragon.mp4\n</code></pre>\n\n<p>If I run a similar version of that command directly in the terminal, I can get it working just fine. The issue is that I need to run the above command through the Golang <a href=\"https://golang.org/pkg/os/exec/\" rel=\"nofollow\">os/exec</a> package. With the:</p>\n\n<pre><code>cmd := exec.Command(parts[0], parts[1:]...)\n</code></pre>\n\n<p>method, the first parameter is the base executable of the command being executed and it is not honoring the pipe. I would like to get this working in one command so I don't have to write all the images to files and then run a second ffmpeg command to read from all of those images. Any suggestions? </p>\n"}, {"tags": ["memory", "go", "slice", "allocation", "is-empty"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1473872209, "post_id": 39495877, "comment_id": 66309225, "body": "Your last example does nothing, as <code>example.s</code> is already a nil slice of the correct type. You don&#39;t need to do anything in this case."}, {"owner": {"reputation": 149, "user_id": 4532360, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/306e56e14d4a795ced280d1c1c36d67b?s=128&d=identicon&r=PG&f=1", "display_name": "ryebread", "link": "https://stackoverflow.com/users/4532360/ryebread"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1473872644, "post_id": 39495877, "comment_id": 66309457, "body": "sorry - edited my question. still true?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1473873001, "post_id": 39495877, "comment_id": 66309649, "body": "I got what you meant even though the code was invalid. <code>e.s</code> and <code>s</code> are both <code>nil</code>, so all you are doing is assigning <code>e.s = nil</code> which does nothing. <code>e.s</code> is already the correct type, so there&#39;s nothing you need to do."}, {"owner": {"reputation": 750, "user_id": 2809739, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ymnxe.jpg?s=128&g=1", "display_name": "Sachin Nambiar Nalavattanon", "link": "https://stackoverflow.com/users/2809739/sachin-nambiar-nalavattanon"}, "edited": false, "score": 0, "creation_date": 1473873058, "post_id": 39495877, "comment_id": 66309671, "body": "<a href=\"https://play.golang.org/p/9C_bnsrIeU\" rel=\"nofollow noreferrer\">play.golang.org/p/9C_bnsrIeU</a>"}, {"owner": {"reputation": 149, "user_id": 4532360, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/306e56e14d4a795ced280d1c1c36d67b?s=128&d=identicon&r=PG&f=1", "display_name": "ryebread", "link": "https://stackoverflow.com/users/4532360/ryebread"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1473873505, "post_id": 39495877, "comment_id": 66309911, "body": "awesome, thanks @JimB"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1473873824, "creation_date": 1473873824, "answer_id": 39496318, "question_id": 39495877, "link": "https://stackoverflow.com/questions/39495877/go-initialize-an-empty-slice/39496318#39496318", "title": "Go - initialize an empty slice", "body": "<p><code>example.s</code> is already declared, so there's nothing you need to do.</p>\n\n<pre><code>e := &amp;example{}\ne.s = append(e.s, \"val\")\nfmt.Println(e.s)\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 4532360, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/306e56e14d4a795ced280d1c1c36d67b?s=128&d=identicon&r=PG&f=1", "display_name": "ryebread", "link": "https://stackoverflow.com/users/4532360/ryebread"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1041, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473873824, "creation_date": 1473872078, "last_edit_date": 1473872436, "question_id": 39495877, "link": "https://stackoverflow.com/questions/39495877/go-initialize-an-empty-slice", "title": "Go - initialize an empty slice", "body": "<p>To declare an empty slice, I know that you should prefer</p>\n\n<pre><code>var t []string\n</code></pre>\n\n<p>over</p>\n\n<pre><code>t := []string{}\n</code></pre>\n\n<p>as it doesn't allocate unecessary memory (<a href=\"https://github.com/golang/go/wiki/CodeReviewComments#declaring-empty-slices\" rel=\"nofollow\">https://github.com/golang/go/wiki/CodeReviewComments#declaring-empty-slices</a>). Does this still apply if I have</p>\n\n<pre><code>type example struct {\n    s []string\n}\ne := &amp;example{}\n</code></pre>\n\n<p>i.e. would it be better to use</p>\n\n<pre><code>e.s = []string{}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var s []string\ne.s = s\n</code></pre>\n"}, {"tags": ["go", "goroutine", "grpc"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1473865414, "post_id": 39493692, "comment_id": 66305050, "body": "They are the same. Can you show an example of exactly what you&#39;re doing?"}, {"owner": {"reputation": 151, "user_id": 4253860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62e10c624393be984cd61ba56e4e425?s=128&d=identicon&r=PG&f=1", "display_name": "v1ct0r", "link": "https://stackoverflow.com/users/4253860/v1ct0r"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1473866140, "post_id": 39493692, "comment_id": 66305569, "body": "@JimB Thanks for replying. I have included the example link and the modified code."}, {"owner": {"reputation": 151, "user_id": 4253860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62e10c624393be984cd61ba56e4e425?s=128&d=identicon&r=PG&f=1", "display_name": "v1ct0r", "link": "https://stackoverflow.com/users/4253860/v1ct0r"}, "edited": false, "score": 0, "creation_date": 1473866211, "post_id": 39493692, "comment_id": 66305616, "body": "@Amd It&#39;s go1.7 linux/amd64"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1473866346, "post_id": 39493692, "comment_id": 66305701, "body": "You have a busy loop in main. Don&#39;t do that."}, {"owner": {"reputation": 151, "user_id": 4253860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62e10c624393be984cd61ba56e4e425?s=128&d=identicon&r=PG&f=1", "display_name": "v1ct0r", "link": "https://stackoverflow.com/users/4253860/v1ct0r"}, "edited": false, "score": 0, "creation_date": 1473866546, "post_id": 39493692, "comment_id": 66305840, "body": "@JimBI put some sleep code, and it doesn&#39;t stuck any more. Could you tell me the reason?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1473866725, "post_id": 39493692, "comment_id": 66305964, "body": "A busy loop is always a mistake. There&#39;s no reason to spin a cpu at 100% just to block. Don&#39;t use a for loop at all, wait on something that blocks. There&#39;s no reason for the goroutine in this example, just call that code inline. If you really need to block without any operations, you can use an empty <code>select{}</code>, but it&#39;s not really needed in general."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 4253860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62e10c624393be984cd61ba56e4e425?s=128&d=identicon&r=PG&f=1", "display_name": "v1ct0r", "link": "https://stackoverflow.com/users/4253860/v1ct0r"}, "edited": false, "score": 1, "creation_date": 1473877170, "post_id": 39495038, "comment_id": 66311794, "body": "Thanks for your thorough explanation!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 6, "last_activity_date": 1473871955, "last_edit_date": 1473871955, "creation_date": 1473869124, "answer_id": 39495038, "question_id": 39493692, "link": "https://stackoverflow.com/questions/39493692/difference-between-the-main-goroutine-and-spawned-goroutines-of-a-go-program/39495038#39495038", "title": "Difference between the main goroutine and spawned goroutines of a Go program", "body": "<p>Why is a Goroutine\u2019s stack infinite:</p>\n\n<blockquote>\n  <p>One of the key features of Goroutines is their cost; they are cheap to\n  create in terms of initial memory footprint (as opposed to the 1 to 8\n  megabytes with a traditional POSIX thread) and their stack grows and\n  shrinks as necessary. This allows a Goroutine to start with a single\n  4096 byte stack which grows and shrinks as needed without the risk of\n  ever running out.</p>\n  \n  <p>There is however one detail I have withheld until now, which links the\n  accidental use of a recursive function to a serious case of memory\n  exhaustion for your operating system, and that is, when new stack\n  pages are needed, they are allocated from the heap.</p>\n  \n  <p>As your infinite function continues to call itself, new stack pages\n  are allocated from the heap, permitting the function to continue to\n  call itself over and over again. Fairly quickly the size of the heap\n  will exceed the amount of free physical memory in your machine, at\n  which point swapping will soon make your machine unusable.</p>\n  \n  <p>The size of the heap available to Go programs depends on a lot of\n  things, including the architecture of your CPU and your operating\n  system, but it generally represents an amount of memory that exceeds\n  the physical memory of your machine, so your machine is likely to swap\n  heavily before your program ever exhausts its heap.</p>\n</blockquote>\n\n<p>ref: <a href=\"http://dave.cheney.net/2013/06/02/why-is-a-goroutines-stack-infinite\" rel=\"noreferrer\">http://dave.cheney.net/2013/06/02/why-is-a-goroutines-stack-infinite</a></p>\n\n<hr>\n\n<p>Empty loop:</p>\n\n<pre><code>for{\n}\n</code></pre>\n\n<p>uses 100% of a CPU Core, to wait for some operation depending to the use case you may use:<br>\n - <code>sync.WaitGroup</code> like <a href=\"https://play.golang.org/p/eHXwoJCme5\" rel=\"noreferrer\">this</a><br>\n - <code>select {}</code> like <a href=\"https://play.golang.org/p/2c3FTew-59\" rel=\"noreferrer\">this</a><br>\n - channels<br>\n - <code>time.Sleep</code>  </p>\n\n<hr>\n\n<blockquote>\n  <p>Is it because spawned goroutines stack size is very small (2Kbytes),\n  and the main goroutine's much larger?</p>\n</blockquote>\n\n<p>No, you may try these two samples to see the stack limit of goroutines are the same:<br>\none main goroutine on <a href=\"https://play.golang.org/p/XzZsmGLgIp\" rel=\"noreferrer\">The Go Playground</a>,<br>\ntry second goroutine on <a href=\"https://play.golang.org/p/eHXwoJCme5\" rel=\"noreferrer\">The Go Playground</a>:  </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nvar wg sync.WaitGroup\n\nfunc main() {\n    wg.Add(1)\n    go run()\n    wg.Wait()\n}\nfunc run() {\n    s := &amp;S{a: 1, b: 2}\n    fmt.Println(s)\n    wg.Done()\n}\n\ntype S struct {\n    a, b int\n}\n\n// String implements the fmt.Stringer interface\nfunc (s *S) String() string {\n    return fmt.Sprintf(\"%s\", s) // Sprintf will call s.String()\n}\n</code></pre>\n\n<p>both outputs are the same on the Go Playground:</p>\n\n<pre><code>runtime: goroutine stack exceeds 250_000_000-byte limit\nfatal error: stack overflow\n</code></pre>\n\n<p>outputs on a PC with <code>8 GB</code> RAM:</p>\n\n<pre><code>runtime: goroutine stack exceeds 1_000_000_000-byte limit\nfatal error: stack overflow\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 4253860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d62e10c624393be984cd61ba56e4e425?s=128&d=identicon&r=PG&f=1", "display_name": "v1ct0r", "link": "https://stackoverflow.com/users/4253860/v1ct0r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3446, "favorite_count": 4, "answer_count": 1, "score": 4, "last_activity_date": 1473871955, "creation_date": 1473865073, "last_edit_date": 1473869672, "question_id": 39493692, "link": "https://stackoverflow.com/questions/39493692/difference-between-the-main-goroutine-and-spawned-goroutines-of-a-go-program", "title": "Difference between the main goroutine and spawned goroutines of a Go program", "body": "<p>When creating a server using <code>gRPC</code>, if I start the <code>gRPC</code> server in the main process, it can deal with as many as requests (thousands) from clients. However, if I start the server as a goroutine, it can only handle some requests (hundreds) and after get stuck. I have tested and confirmed this with a very simple example, google.golang.org/grpc/examples/helloworld.</p>\n\n<p>Is it because spawned goroutines stack size is very small (2Kbytes), and the main goroutine's much larger? What's the difference between the main goroutine and spawned goroutines?</p>\n\n<p>Example <a href=\"https://github.com/grpc/grpc-go/tree/master/examples/helloworld\" rel=\"nofollow\">link</a>. Modified parts of the example as follows.</p>\n\n<p><strong>greeter_server/main.go</strong></p>\n\n<pre><code>func main() {\n    go func() {\n        lis, err := net.Listen(\"tcp\", port)\n        if err != nil {\n            log.Fatalf(\"failed to listen: %v\", err)\n        }   \n        s := grpc.NewServer()\n        pb.RegisterGreeterServer(s, &amp;server{})\n        s.Serve(lis)\n    }() \n\n    for {\n    }   \n}\n</code></pre>\n\n<p><strong>greeter_client/main.go</strong></p>\n\n<pre><code>func main() {\n    // Set up a connection to the server.\n    for i := 0; i &lt; 500; i++ {\n        conn, err := grpc.Dial(address, grpc.WithInsecure())\n        if err != nil {\n            log.Fatalf(\"did not connect: %v\", err)\n        }\n        defer conn.Close()\n        c := pb.NewGreeterClient(conn)\n\n        for i := 0; i &lt; 500; i++ {\n            // Contact the server and print out its response.\n            name := defaultName\n            if len(os.Args) &gt; 1 {\n                name = os.Args[1]\n            }\n            r, err := c.SayHello(context.Background(), &amp;pb.HelloRequest{Name: name})\n            if err != nil {\n                log.Fatalf(\"could not greet: %v\", err)\n            }\n            log.Printf(\"%d's Greeting: %s\", i, r.Message)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "edited": false, "score": 0, "creation_date": 1473862614, "post_id": 39492633, "comment_id": 66303009, "body": "Thanks I tried this and I noticed that 1468540800 results into <code>2016-07-14 19:00:00 -0500 CDT</code> while if I try to verify at <a href=\"http://www.unixtimestamp.com/index.php\" rel=\"nofollow noreferrer\">unixtimestamp.com/index.php</a> it shows me date as 2016-07-15 any reason why?"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "edited": false, "score": 1, "creation_date": 1473862756, "post_id": 39492633, "comment_id": 66303107, "body": "@love2code time zones. The &quot;-0500&quot; you got should be a pretty good hint."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1473862277, "creation_date": 1473862277, "answer_id": 39492633, "question_id": 39492556, "link": "https://stackoverflow.com/questions/39492556/how-to-extract-unix-timestamp-and-get-date/39492633#39492633", "title": "How to extract unix timestamp and get date", "body": "<p>Use <a href=\"https://golang.org/pkg/time/#Unix\" rel=\"nofollow\"><code>time.Unix</code></a> with nanoseconds set to 0.</p>\n\n<pre><code>t := time.Unix(int64(x), 0)\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/PpOv8Xm-CS\" rel=\"nofollow\">https://play.golang.org/p/PpOv8Xm-CS</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6830192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e286d1974ca7e282d7cc263af7802e6e?s=128&d=identicon&r=PG&f=1", "display_name": "amrita", "link": "https://stackoverflow.com/users/6830192/amrita"}, "is_accepted": false, "score": -3, "last_activity_date": 1473862302, "creation_date": 1473862302, "answer_id": 39492643, "question_id": 39492556, "link": "https://stackoverflow.com/questions/39492556/how-to-extract-unix-timestamp-and-get-date/39492643#39492643", "title": "How to extract unix timestamp and get date", "body": "<pre><code>$timestamp=1468540800;\necho gmdate(\"Y-m-d\", $timestamp);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "edited": false, "score": 0, "creation_date": 1473862709, "post_id": 39492654, "comment_id": 66303074, "body": "Thanks I tried this and I noticed that 1468540800 results into <code>2016-07-14 19:00:00 -0500 CDT</code> while if I try to verify at <a href=\"http://www.unixtimestamp.com/index.php\" rel=\"nofollow noreferrer\">unixtimestamp.com/index.php</a> it shows me date as 2016-07-15 any reason why?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "reply_to_user": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "edited": false, "score": 0, "creation_date": 1473863971, "post_id": 39492654, "comment_id": 66304001, "body": "@love2code Print out the time as UTC insted of your local timezone. e.g. <code>fmt.Println(newtime.UTC())</code>"}], "tags": [], "owner": {"reputation": 1851, "user_id": 3045568, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5e2fdfebcbb631532bb9ff994639b5fe?s=128&d=identicon&r=PG&f=1", "display_name": "Techidiot", "link": "https://stackoverflow.com/users/3045568/techidiot"}, "is_accepted": false, "score": 1, "last_activity_date": 1473862347, "creation_date": 1473862347, "answer_id": 39492654, "question_id": 39492556, "link": "https://stackoverflow.com/questions/39492556/how-to-extract-unix-timestamp-and-get-date/39492654#39492654", "title": "How to extract unix timestamp and get date", "body": "<p>You can use strconv.ParseInt() for parsing to int64 in combination with time.Unix.</p>\n\n<pre><code>myTime,errOr := strconv.ParseInt(x, 10, 64)\n    if errOr != nil {\n        panic(errOr)\n    }\n    newTime := time.Unix(myTime, 0)\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 3, "last_activity_date": 1473863177, "last_edit_date": 1473863177, "creation_date": 1473862863, "answer_id": 39492847, "question_id": 39492556, "link": "https://stackoverflow.com/questions/39492556/how-to-extract-unix-timestamp-and-get-date/39492847#39492847", "title": "How to extract unix timestamp and get date", "body": "<p>You may use <code>t := time.Unix(int64(x), 0)</code> with location set to local time.<br>\nOr use <code>t := time.Unix(int64(x), 0).UTC()</code> with the location set to UTC.</p>\n\n<p>You may use <code>t.Format(\"2006-01-02\")</code> to format,\nCode (try on <a href=\"https://play.golang.org/p/Br4S-JlE1Z\" rel=\"nofollow\">The Go Playground</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    x := 1468540800\n    t := time.Unix(int64(x), 0).UTC() //UTC returns t with the location set to UTC.\n    fmt.Println(t.Format(\"2006-01-02\"))\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>2016-07-15\n</code></pre>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1987, "favorite_count": 2, "accepted_answer_id": 39492847, "answer_count": 4, "score": 2, "last_activity_date": 1473863177, "creation_date": 1473862071, "last_edit_date": 1473863031, "question_id": 39492556, "link": "https://stackoverflow.com/questions/39492556/how-to-extract-unix-timestamp-and-get-date", "title": "How to extract unix timestamp and get date", "body": "<p>I have an integer </p>\n\n<pre><code>x := 1468540800\n</code></pre>\n\n<p>I want to fetch the date out of this unix timestamp in Golang. I have tried <code>time.ParseDuration</code> but looks like that's not the correct way to extract date out of this. Converstion should happen like this <a href=\"http://www.unixtimestamp.com/index.php\" rel=\"nofollow\">http://www.unixtimestamp.com/index.php</a><br>\nI intend to convert into in ISO 8601 format may be. I want string like <code>2016-09-14</code>.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1474359050, "post_id": 39492900, "comment_id": 66486965, "body": "I&#39;m pretty sure Printf doesn&#39;t use reflection, and use type assertion instead [<a href=\"https://golang.org/ref/spec#Type_assertions]\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Type_assertions]</a> which would be efficient when using interfaces. My current assumption is that the critical point is converting none interface values to interface values. The answer of @Simo Endre provides an explanation why it is slow. It is not only due to the potentially required heap allocations.  It&#39;s because of the methods lookup."}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1545693055, "post_id": 39492900, "comment_id": 94679280, "body": "Passing arguments by copy doesn&#39;t mean that it does allocation. Those are mostly passed through the preallocated stack memory, unless shared through a pointer."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1473863027, "creation_date": 1473863027, "answer_id": 39492900, "question_id": 39492539, "link": "https://stackoverflow.com/questions/39492539/go-implicit-conversion-to-interface-does-memory-allocation/39492900#39492900", "title": "Go implicit conversion to interface does memory allocation?", "body": "<p>Go passes arguments copy_by_value, so it does memory allocation anyway. You always should better avoid using interface{} if possible. In described case your function will need to reflect arguments to use them. Reflection is quite expensive operation that's why <code>fmt.Printf()</code> is so slow.</p>\n"}, {"comments": [{"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1474358506, "post_id": 39493013, "comment_id": 66486618, "body": "Your answer is not clear enough. If I pass an interface as argument to a variadic function, a simple reference copy is performed. That is cheap. But if I pass another value like an integer or a slice for instance, a conversion to an interface data structure must take place. Would this interface data structure be allocated on the heap or on the stack ? Heap allocation has usually a significant performance penalty. I however followed your advise in the last paragraph and got rid of the variadic API."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1474376385, "post_id": 39493013, "comment_id": 66498236, "body": "@chmike: there no such thing as a &quot;reference copy&quot; in Go. Everything in Go is a value, and everything is passed by value. A variadic argument has <i>nothing</i> do to with interfaces, it&#39;s simply syntactic sugar around a slice and adding it to this conversation only confuses the issue. If you pass an interface to an interface argument, the interface value is copied which is 2 words. These are stack allocated when possible if they don&#39;t escape (go has essentially unlimited stack)."}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1474382714, "post_id": 39493013, "comment_id": 66502898, "body": "There is a misunderstanding. I referred to the two pointers in the interface value as the references. The two pointers are indeed copied on the stack. If the argument is not an interface it has to be converted to an interface. My question was of course considering the case when the argument to a variadic function of <code>[]interface{}</code> type is not an interface and needs to be converted to an interface. My main concern was about base types like <code>int</code> or <code>string</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 0, "creation_date": 1474384012, "post_id": 39493013, "comment_id": 66503721, "body": "@chmike: I was trying to address the 2 interface questions, &quot;Does this conversion imply memory allocation&quot; - no it does not, because it&#39;s stack allocated if the value doesn&#39;t escape;  &quot;Is this conversion fast?&quot; -- it&#39;s just a copy and and 2 pointers. What you do with the interface in the function makes orders of magnitude more difference than the time it takes to copy the value into the interface argument (on my system an <code>interface{}</code> argument takes about 3ns more to call than a singe word value, provided the arguments all fit in a single cache line)."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1473864305, "last_edit_date": 1473864305, "creation_date": 1473863339, "answer_id": 39493013, "question_id": 39492539, "link": "https://stackoverflow.com/questions/39492539/go-implicit-conversion-to-interface-does-memory-allocation/39493013#39493013", "title": "Go implicit conversion to interface does memory allocation?", "body": "<p>Converting to an <code>interface{}</code> is a separate concept from variadic arguments which are contained in a slice and can be of any type. However these are all probably free in the sense of allocations as long as they don't escape to the heap (in the GC toolchain).</p>\n\n<p>The excess allocations you would see from <code>fmt</code> functions like <code>Printf</code> are going to be from reflection rather than from the use of <code>interface{}</code> or variadic arguments.</p>\n\n<p>If you're concerned with efficiency though, avoiding indirection will always be more efficient than not, so using the correct value types will yield more efficient code. The difference can be minimal though, so benchmark the code first before concerning yourself with minor optimizations.</p>\n"}, {"comments": [{"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "edited": false, "score": 1, "creation_date": 1474359216, "post_id": 39493143, "comment_id": 66487066, "body": "I gave you the answer because the cited text explains why converting a value to an interface might be &quot;expensive&quot; and should be avoided. This conversion is not free."}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": true, "score": 6, "last_activity_date": 1473863642, "creation_date": 1473863642, "answer_id": 39493143, "question_id": 39492539, "link": "https://stackoverflow.com/questions/39492539/go-implicit-conversion-to-interface-does-memory-allocation/39493143#39493143", "title": "Go implicit conversion to interface does memory allocation?", "body": "<p>The best explanation i found about the interface memory allocation in Go is still this article from Rus Cox, one of the core Go programmer. It's well worth to read it.</p>\n\n<p><strong><a href=\"http://research.swtch.com/interfaces\" rel=\"noreferrer\">http://research.swtch.com/interfaces</a></strong></p>\n\n<p>I picked up some of the most interesting parts:</p>\n\n<blockquote>\n  <p>Values stored in interfaces might be arbitrarily large, but only one\n  word is dedicated to holding the value in the interface structure, so\n  the assignment allocates a chunk of memory on the heap and records the\n  pointer in the one-word slot. </p>\n  \n  <p>...</p>\n  \n  <p>Calling fmt.Printf(), the Go compiler generates code that calls the\n  appropriate function pointer from the itable, passing the interface\n  value's data word as the function's first (in this example, only)\n  argument.</p>\n  \n  <p>Go's dynamic type conversions mean that it isn't reasonable for the\n  compiler or linker to precompute all possible itables: there are too\n  many (interface type, concrete type) pairs, and most won't be needed.\n  Instead, the compiler generates a type description structure for each\n  concrete type like Binary or int or func(map[int]string). Among other\n  metadata, the type description structure contains a list of the\n  methods implemented by that type. </p>\n  \n  <p>...</p>\n  \n  <p>The interface runtime computes the itable by looking for each method\n  listed in the interface type's method table in the concrete type's\n  method table. The runtime caches the itable after generating it, so\n  that this correspondence need only be computed once.</p>\n  \n  <p>...</p>\n  \n  <p>If the interface type involved is empty\u2014it has no methods\u2014then the\n  itable serves no purpose except to hold the pointer to the original\n  type. In this case, the itable can be dropped and the value can point\n  at the type directly.</p>\n</blockquote>\n\n<p>Because Go has the hint of static typing to go along with the dynamic method lookups, it can move the lookups back from the call sites to the point when the value is stored in the interface.</p>\n"}], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2132, "favorite_count": 2, "accepted_answer_id": 39493143, "answer_count": 3, "score": 4, "last_activity_date": 1473864305, "creation_date": 1473862020, "last_edit_date": 1473862526, "question_id": 39492539, "link": "https://stackoverflow.com/questions/39492539/go-implicit-conversion-to-interface-does-memory-allocation", "title": "Go implicit conversion to interface does memory allocation?", "body": "<p>When defining a function with variadic arguments of type <code>interface{}</code> (e.g. <code>Printf</code>), the arguments are apparently implicitly converted to interface instances. </p>\n\n<p>Does this conversion imply memory allocation? Is this conversion fast? When concerned by code efficiency, should I avoid using variadic functions?</p>\n"}, {"tags": ["postgresql", "go", "go-gorm"], "comments": [{"owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "edited": false, "score": 0, "creation_date": 1473874561, "post_id": 39492468, "comment_id": 66310506, "body": "That&#39;s because Go time.Time is actually a date. Currently I don&#39;t see a way to use PostgreSQL Time properly. If you aren&#39;t querying by it, I would suggest to use a simple string. Otherwise, store it as a full date."}, {"owner": {"reputation": 1347, "user_id": 1559202, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3dabf6305a8fd64f9c020d2257263fbb?s=128&d=identicon&r=PG", "display_name": "John Kenn", "link": "https://stackoverflow.com/users/1559202/john-kenn"}, "reply_to_user": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "edited": false, "score": 0, "creation_date": 1473900442, "post_id": 39492468, "comment_id": 66320689, "body": "@AlexeySoshin I already tried to store it as a full date but it&#39;s giving me this error: <code>pq: R:&quot;DateTimeParseError&quot; S:&quot;ERROR&quot; C:&quot;22008&quot; M:&quot;date&#47;time field value out of range: \\&quot;0000-01-01T21:00:00Z\\&quot;&quot; F:&quot;datetime.c&quot; L:&quot;3540&quot;</code>"}, {"owner": {"reputation": 14370, "user_id": 2095534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d3c704aafdd6b320be07e0fc21964b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil Gosciminski", "link": "https://stackoverflow.com/users/2095534/kamil-gosciminski"}, "edited": false, "score": 1, "creation_date": 1473970167, "post_id": 39492468, "comment_id": 66354793, "body": "As a workaround I&#39;d suggest adding some dummy date like 2099-01-01 and you could then store your time and query on it properly having this in mind."}], "answers": [{"tags": [], "owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "is_accepted": true, "score": 5, "last_activity_date": 1473969948, "creation_date": 1473969948, "answer_id": 39519483, "question_id": 39492468, "link": "https://stackoverflow.com/questions/39492468/how-to-save-time-in-the-database-in-go-when-using-gorm-and-postgresql/39519483#39519483", "title": "How to save time in the database in Go when using GORM and Postgresql?", "body": "<p>Investigated this issue further. Currently, there's no support in GORM for any Date/Time types except <code>timestamp with time zone</code></p>\n\n<p>See this part of code from <a href=\"https://github.com/jinzhu/gorm/blob/master/dialect_postgres.go#L60\" rel=\"noreferrer\">dialect_postgres.go</a>:</p>\n\n<pre><code>case reflect.Struct:\n   if _, ok := dataValue.Interface().(time.Time); ok {\n      sqlType = \"timestamp with time zone\"\n}\n</code></pre>\n\n<p>So basically I see two options for you:</p>\n\n<p>Either use <code>varchar(10)</code> in DB, and <code>string</code> in Go, an simply save it as \"9:00 PM\" (where 10 is some number that suits you)</p>\n\n<p>Or use <code>timestamp with time zone</code> in DB, <code>time.Time</code> in Go, and format your date part as a constant date, 01/01/1970, for example:</p>\n\n<pre><code>time.Parse(\"2006-01-02 3:04PM\", \"1970-01-01 9:00PM\")\n</code></pre>\n\n<p>In that case you'll have to omit the date part in your presentation, but if you plan to select by date range, that could work better for you.</p>\n"}, {"tags": [], "owner": {"reputation": 1506, "user_id": 8689709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd57855e7bff23fbca35abc8ddc0073?s=128&d=identicon&r=PG", "display_name": "Bill Zelenko", "link": "https://stackoverflow.com/users/8689709/bill-zelenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1565631452, "creation_date": 1565631452, "answer_id": 57465762, "question_id": 39492468, "link": "https://stackoverflow.com/questions/39492468/how-to-save-time-in-the-database-in-go-when-using-gorm-and-postgresql/57465762#57465762", "title": "How to save time in the database in Go when using GORM and Postgresql?", "body": "<p>When updating the <code>DATETIME</code> field in SQL, the Go string must be in this format: <code>time.Now().Format(time.RFC3339)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 6970, "user_id": 7623856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bab5bf7bb88056bdeaf4b26d2bfce16?s=128&d=identicon&r=PG&f=1", "display_name": "Belayer", "link": "https://stackoverflow.com/users/7623856/belayer"}, "is_accepted": false, "score": 0, "last_activity_date": 1565667558, "creation_date": 1565667558, "answer_id": 57470826, "question_id": 39492468, "link": "https://stackoverflow.com/questions/39492468/how-to-save-time-in-the-database-in-go-when-using-gorm-and-postgresql/57470826#57470826", "title": "How to save time in the database in Go when using GORM and Postgresql?", "body": "<p>From Postgres perspective the error stems from there being no year 0000. If you don't the date you may just be able to add 1 year to the converted timestamp giving '0001-01-01T21:00:00+00' which is a valid Postgres timestamp.</p>\n\n<pre><code>select '0000-01-01T21:00:00+00'::timestamptz at time zone 'UTC' \nERROR:  date/time field value out of range: \"0000-01-01T21:00:00+00\"\n</code></pre>\n\n<p>Gives he same error. And just as a demonstration 1 day before 0001-01-01 gives:</p>\n\n<pre><code>select '0001-01-01T21:00:00+00'::timestamptz at time zone 'UTC' - interval '1 day' \"day_before_1/1/1\";\n--day_before_1/1/1\n--0001-12-31 21:00:00 BC\n</code></pre>\n"}], "owner": {"reputation": 1347, "user_id": 1559202, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3dabf6305a8fd64f9c020d2257263fbb?s=128&d=identicon&r=PG", "display_name": "John Kenn", "link": "https://stackoverflow.com/users/1559202/john-kenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14810, "favorite_count": 0, "accepted_answer_id": 39519483, "answer_count": 3, "score": 3, "last_activity_date": 1565667558, "creation_date": 1473861772, "question_id": 39492468, "link": "https://stackoverflow.com/questions/39492468/how-to-save-time-in-the-database-in-go-when-using-gorm-and-postgresql", "title": "How to save time in the database in Go when using GORM and Postgresql?", "body": "<p>I'm currently parsing a time string and saving it to the db (Postgresql):</p>\n\n<pre><code>event.Time, _ := time.Parse(\"3:04 PM\", \"9:00 PM\")\n// value of event.Time now is: 0000-01-01 21:00:00 +0000 UTC\ndb.Create(&amp;event)\n</code></pre>\n\n<p>It's giving me this error: <code>pq: R:\"DateTimeParseError\" S:\"ERROR\" C:\"22008\" M:\"date/time field value out of range: \\\"0000-01-01T21:00:00Z\\\"\" F:\"datetime.c\" L:\"3540\"</code></p>\n\n<p><code>event.Time\ufeff\u2060\u2060\u2060\u2060</code>'s type is <code>time.Time</code>.</p>\n\n<p>I also tried setting <code>event.Time</code>'s type to string and using time data type in postgresql:</p>\n\n<pre><code>type Event struct {\n  Time string `gorm:\"type:time\n}\n</code></pre>\n\n<p>But now I'm getting an error when fetching records in the db:</p>\n\n<pre><code>sql: Scan error on column index 4: unsupported driver -&gt; Scan pair: time.Time -&gt; *string\n</code></pre>\n"}, {"tags": ["go", "struct", "import"], "comments": [{"owner": {"reputation": 1054, "user_id": 3478959, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b52236406c4b6e4fa0bb619db556cf14?s=128&d=identicon&r=PG&f=1", "display_name": "Lev", "link": "https://stackoverflow.com/users/3478959/lev"}, "edited": false, "score": 0, "creation_date": 1502897592, "post_id": 39491435, "comment_id": 78393392, "body": "<code>func (c models.Category) Update() { &#47;&#47; do something here }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 7543, "user_id": 1794051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc6d765eadabca02bdd7b44d6504720?s=128&d=identicon&r=PG", "display_name": "val", "link": "https://stackoverflow.com/users/1794051/val"}, "is_accepted": false, "score": 4, "last_activity_date": 1473859362, "creation_date": 1473859362, "answer_id": 39491635, "question_id": 39491435, "link": "https://stackoverflow.com/questions/39491435/how-to-import-structs-from-another-package-in-go/39491635#39491635", "title": "How to import structs from another package in Go", "body": "<p>You need to fully qualify your names: don't use <code>Category</code>, but use <code>models.Category</code>. The <a href=\"https://golang.org/ref/spec#Import_declarations\" rel=\"nofollow\">doc</a> there should get you started. You can do:</p>\n\n<pre><code>import \"fmt\"\n\nfunc main() {\n    fmt.Println(\"Hello\")\n}\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>import f \"fmt\"\n\nfunc main() {\n    f.Println(\"Hello\")\n}\n</code></pre>\n\n<p>Or ditch the qualification entirely (however, this is considered poor style: being able to see, at a glance, where some structure or function comes from is very handy when looking at code):</p>\n\n<pre><code>import . \"fmt\"\n\nfunc main() {\n    // Where does that come from ? Hard to know without \n    // intimate knowledge of the package\n    Println(\"Hello\")\n}\n</code></pre>\n\n<p>One last thing you can do is to 'typedef' your remote structure for easier use locally:</p>\n\n<pre><code>import \"website.com/Owner/blog/app/models\"\n\ntype Category models.Category\n</code></pre>\n\n<p>Note however that it create a <a href=\"https://golang.org/ref/spec#Types\" rel=\"nofollow\">new type</a>, although with the same underlying type.</p>\n"}], "owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8758, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473859362, "creation_date": 1473858865, "question_id": 39491435, "link": "https://stackoverflow.com/questions/39491435/how-to-import-structs-from-another-package-in-go", "title": "How to import structs from another package in Go", "body": "<p>I am trying to import the following struct into a separate package in Golang</p>\n\n<pre><code>package models\ntype Category struct {\n    Title string\n    Description string\n    Parent *Category\n    ParentId int\n}\n</code></pre>\n\n<p>into <code>package controllers</code> as follows</p>\n\n<pre><code>import(\n\"website.com/Owner/blog/app/models\"\n)\nfunc (c Category) Update(){\n   //do something here\n}\n</code></pre>\n\n<p>However, I get the error <code>unresolved type Category</code>\nHow should I go about importing a struct into a separate package with Go?</p>\n"}, {"tags": ["oop", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 2, "creation_date": 1473870068, "post_id": 39490975, "comment_id": 66308017, "body": "<a href=\"https://godoc.org/github.com/shirou/gopsutil/cpu#Times\" rel=\"nofollow noreferrer\">cpu#Times</a> returns <code>([]TimesStat, error)</code> so <code>getCpuTime()</code> should return <code>[]cpu.TimeStat</code>. I can&#39;t make such a small edit since its a two character insertion."}, {"owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "reply_to_user": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 0, "creation_date": 1473870409, "post_id": 39490975, "comment_id": 66308206, "body": "changed with comment, Thanks @algrebe!"}], "tags": [], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "is_accepted": true, "score": 7, "last_activity_date": 1473870335, "last_edit_date": 1473870335, "creation_date": 1473857644, "answer_id": 39490975, "question_id": 39490907, "link": "https://stackoverflow.com/questions/39490907/returning-a-struct-in-golang/39490975#39490975", "title": "Returning a struct in Golang", "body": "<p>you need to include the package name before the type, like so:</p>\n\n<pre><code>func getCpuTime() []cpu.TimesStat { // with package name before type\n    ct, _ := cpu.Times(false)\n\n    return ct\n}\n</code></pre>\n\n<p>since that is a slice of <code>cpu.TimesStat</code>, you probably want to add an index in the calling function or change the function to just return a single <code>cpu.TimesStat</code>. (thanks to @algrebre)</p>\n"}], "owner": {"reputation": 952, "user_id": 2091965, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/1c1285c630291af3766d5b8c6cd80a15?s=128&d=identicon&r=PG", "display_name": "eignhpants", "link": "https://stackoverflow.com/users/2091965/eignhpants"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4785, "favorite_count": 0, "accepted_answer_id": 39490975, "answer_count": 1, "score": 1, "last_activity_date": 1473870335, "creation_date": 1473857413, "question_id": 39490907, "link": "https://stackoverflow.com/questions/39490907/returning-a-struct-in-golang", "title": "Returning a struct in Golang", "body": "<p>I'm just starting with Golang and I am very confused about interacting with other packages and using structs. Right now I am simply trying to return the a struct generated by a method in the gopsutil library. Specifically the return of the following function: <a href=\"https://godoc.org/github.com/shirou/gopsutil/cpu#Times\" rel=\"nofollow\" title=\"godoc link\">enter link description here</a></p>\n\n<p>My code for this is the following:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/shirou/gopsutil/cpu\"\n\n)\n\nfunc main() {\n\n    cpu_times = getCpuTime()\n    fmt.Println(cpu_times)\n\n}\n\nfunc getCpuTime() TimesStat {\n    ct, _ := cpu.Times(false)\n\n    return ct\n}\n</code></pre>\n\n<p>This returns <code>TimesStat</code> as undefined. I tried returning a few different syntactical variations, however the only return value I have found that compiles is <code>interface{}</code>, which gets me the struct inside of brackets (eg <code>[{values...}]</code>) and that led to some other problems. I can't seem to find any examples of what I am trying to do. Any help appreciated thanks.</p>\n"}, {"tags": ["go", "go-gin"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 12, "last_activity_date": 1473854239, "last_edit_date": 1473854239, "creation_date": 1473853734, "answer_id": 39489688, "question_id": 39489175, "link": "https://stackoverflow.com/questions/39489175/how-to-define-a-go-gin-route-with-an-id-in-the-middle/39489688#39489688", "title": "How to define a go-gin route with an id in the middle", "body": "<p>You may use <code>userid := c.Param(\"userid\")</code>, like this working sample:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n\n    \"github.com/gin-gonic/gin\"\n)\n\nfunc main() {\n    router := gin.Default()\n\n    router.GET(\"/user/:userid/status\", func(c *gin.Context) {\n        userid := c.Param(\"userid\") \n        message := \"userid is \" + userid\n        c.String(http.StatusOK, message)\n        fmt.Println(message)\n    })\n\n    router.Run(\":8080\")\n}\n</code></pre>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4301, "favorite_count": 0, "accepted_answer_id": 39489688, "answer_count": 1, "score": 3, "last_activity_date": 1473855370, "creation_date": 1473852149, "last_edit_date": 1473855370, "question_id": 39489175, "link": "https://stackoverflow.com/questions/39489175/how-to-define-a-go-gin-route-with-an-id-in-the-middle", "title": "How to define a go-gin route with an id in the middle", "body": "<p>I want to define a route </p>\n\n<pre><code>/user/{userid}/status\n</code></pre>\n\n<p>How can I define this kind of route and intercept the userid in handler. Something like this</p>\n\n<pre><code> r.GET(\"/user/{userid}/status\", userStatus)\n</code></pre>\n\n<p>How can read the userid variable in my Go code in such case?</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 2, "creation_date": 1473849295, "post_id": 39488210, "comment_id": 66294339, "body": "Maybe <code>`(?s)\\((.*)\\)`</code> is all you need."}, {"owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1473849914, "post_id": 39488210, "comment_id": 66294666, "body": "thanks it worked, how would you now remove the outer brackets <code>[( ... )]</code>"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1473850007, "post_id": 39488210, "comment_id": 66294707, "body": "Why remove them? Just access the first submatch."}, {"owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1473850229, "post_id": 39488210, "comment_id": 66294841, "body": "Makes sense , thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 3, "last_activity_date": 1473850263, "creation_date": 1473850263, "answer_id": 39488596, "question_id": 39488210, "link": "https://stackoverflow.com/questions/39488210/how-to-get-everything-within-brackets-in-golang-with-regex/39488596#39488596", "title": "How to get everything within brackets in golang with regex", "body": "<p>All you need is to find the first <code>(</code>, then match any characters up to the last <code>)</code> with</p>\n\n<pre><code>`(?s)\\((.*)\\)`\n</code></pre>\n\n<p><strong>Details</strong>:</p>\n\n<ul>\n<li><code>(?s)</code> - allow <code>.</code> to match any character, including a newline</li>\n<li><code>\\(</code> -  a literal <code>(</code> char</li>\n<li><code>(.*)</code> - Submatch 1 capturing any zero or more characters</li>\n<li><code>\\)</code> - a literal <code>)</code> symbol.</li>\n</ul>\n\n<p>See the <a href=\"https://play.golang.org/p/GLTxOv5ck2\" rel=\"nofollow\">Go demo</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    s := `Categories\n(// = outside bracket\nPersonID int,\nLastName varchar(255),\nFirstName varchar(255),\nAddress varchar(255),\nCity varchar(255)\n)//=outside bracket`\n    re := regexp.MustCompile(`(?s)\\((.*)\\)`)\n\n    m := re.FindAllStringSubmatch(s,-1)\n    fmt.Printf(\"Capture value: %s\", m[0][1])\n}\n</code></pre>\n"}], "owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2609, "favorite_count": 0, "accepted_answer_id": 39488596, "answer_count": 1, "score": 2, "last_activity_date": 1473850789, "creation_date": 1473849127, "last_edit_date": 1473850789, "question_id": 39488210, "link": "https://stackoverflow.com/questions/39488210/how-to-get-everything-within-brackets-in-golang-with-regex", "title": "How to get everything within brackets in golang with regex", "body": "<p>I am trying to get everything within the outside brackets of the following sql statement in golang regular expressions.</p>\n\n<pre><code>Categories\n(// = outside bracket\nPersonID int,\nLastName varchar(255),\nFirstName varchar(255),\nAddress varchar(255),\nCity varchar(255)\n)//=outside bracket\n</code></pre>\n\n<p>how would I use regex to only identify the outer brackets and return everything in between the outside brackets?</p>\n"}, {"tags": ["http", "go", "https", "proxy"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1473859549, "post_id": 39487798, "comment_id": 66300768, "body": "You also don&#39;t need the &#39;Proxy-Connection: keep-alive&#39; header. It&#39;s redundant with &quot;Connection&quot;, and only needed by old HTTP/1.0 proxies."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6830306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/002626e8e9359437fcfa1062b4465059?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/6830306/harry"}, "edited": false, "score": 0, "creation_date": 1473858979, "post_id": 39491370, "comment_id": 66300388, "body": "I cannot thank you enough for this. Well explained and is a very simple solution."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1473858704, "creation_date": 1473858704, "answer_id": 39491370, "question_id": 39487798, "link": "https://stackoverflow.com/questions/39487798/why-does-an-http-client-in-go-return-unauthorized-via-a-proxy-when-making-an-htt/39491370#39491370", "title": "Why does an http client in Go return Unauthorized via a proxy when making an https request?", "body": "<p>You are setting a header on the <code>http.Request</code> that is being sent to the upstream server, not the proxy. You can set basic auth in the proxy <code>*url.URL</code>:</p>\n\n<pre><code>proxyURL, _ := url.Parse(\"http://127.0.0.1:8080\")\nproxyURL.User = url.UserPassword(\"username\", \"password\")\n\nclient := &amp;http.Client{\n    Transport: &amp;http.Transport{\n        Proxy: http.ProxyURL(proxyURL),\n    },\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6830306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/002626e8e9359437fcfa1062b4465059?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/6830306/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 39491370, "answer_count": 1, "score": 0, "last_activity_date": 1473858704, "creation_date": 1473847712, "question_id": 39487798, "link": "https://stackoverflow.com/questions/39487798/why-does-an-http-client-in-go-return-unauthorized-via-a-proxy-when-making-an-htt", "title": "Why does an http client in Go return Unauthorized via a proxy when making an https request?", "body": "<p>I've been trying to make a GET request from a client I've been working on in Go, via a proxy.</p>\n\n<p>The curl equivalent may look a bit like this:</p>\n\n<p><code>curl -v -x example.proxy.com:8080 -U username:password 'https://example.com'</code></p>\n\n<p>While something like this will work, the equivalent in Go does not seem to, here's an example:</p>\n\n<pre><code>auth := \"username:password\"\n\nbasic := \"Basic \" + base64.StdEncoding.EncodeToString([]byte(auth))\n\nproxyURL, _ := url.Parse(\"http://example.proxy.com:8080\")\nurl, _ := url.Parse(\"https://example.com\")\n\ntransport := &amp;http.Transport{\n    Proxy: http.ProxyURL(proxyURL),\n}\nclient := &amp;http.Client{\n    Transport: transport,\n}\n\nrequest, _ := http.NewRequest(\"GET\", url.String(), nil)\nrequest.Header.Add(\"Proxy-Authorization\", basic)\nrequest.Header.Add(\"Proxy-Connection\", \"Keep-Alive\")\n\nresponse, _ := client.Do(request)\n</code></pre>\n\n<p>The only difference between the two is that the curl command will be successful when making requests to both http and https urls, the Go code will work over http, but in the example above (<code>https://example.com</code>, or any other https URL), this will return a status of Unauthorized.</p>\n\n<p>I feel like I'm missing something really obvious here, but can't seem to get to the bottom of it.</p>\n"}, {"tags": ["go", "go-reflect"], "answers": [{"tags": [], "owner": {"reputation": 7065, "user_id": 4275413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/diRiJ.png?s=128&g=1", "display_name": "Jakumi", "link": "https://stackoverflow.com/users/4275413/jakumi"}, "is_accepted": false, "score": 0, "last_activity_date": 1473852076, "last_edit_date": 1473852076, "creation_date": 1473847623, "answer_id": 39487768, "question_id": 39487543, "link": "https://stackoverflow.com/questions/39487543/golang-convert-list-objects-to-string/39487768#39487768", "title": "Golang convert list objects to string", "body": "<p>Well the clean solution would be to use an interface, since go doesn't support classic inheritance, so something like <code>[]parentclass</code> can't work. Interfaces however can only describe functions not a common field, so you have to implement a Getter (essentially).</p>\n\n<pre><code>// GetBankCoder provides a function that gives the BankCode\ntype GetBankCoder interface {\n    getBankCode() string\n}\n\n// implement GetBankCoder for A (and indirectly for B)\nfunc (a A) getBankCode() string {\n    return a.BankCode\n}\n</code></pre>\n\n<p>and make your <code>getBankCodes</code> work on that interface type, notice the parameter of the function as well as the statement inside the loop:</p>\n\n<pre><code>func getBankCodes(data []GetBankCoder) []string {  // &lt;-- changed\n    res := make([]string, len(data))\n    for i := 0; i &lt; len(data); i++ {\n        res[i] = data[i].getBankCode()             // &lt;-- changed\n    }\n    return res        \n}\n</code></pre>\n\n<p>There are other solutions where the function parameter is of <code>interface{}</code> type and then reflection is used to assure you can actually do <code>.BankCode</code>, but I don't like those, as they are not adding more clarity either.</p>\n\n<p>... However, I couldn't get the golang playground to make this work correctly without putting it into a <code>[]GetBankCoder</code> var first, before giving it to the function. </p>\n\n<pre><code>banks := make([]GetBankCoder, 0)\nbanks = append(banks, A{ BankCode: \"ABC\", BankName: \"ABC Bank\"})\ngetBankCodes(banks)\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 0, "last_activity_date": 1473861948, "last_edit_date": 1473861948, "creation_date": 1473848836, "answer_id": 39488123, "question_id": 39487543, "link": "https://stackoverflow.com/questions/39487543/golang-convert-list-objects-to-string/39488123#39488123", "title": "Golang convert list objects to string", "body": "<p>You may use one common function like so:</p>\n\n<pre><code>func BankCodes(data interface{}) []string {\n    if reflect.TypeOf(data).Kind() != reflect.Slice {\n        panic(\"err: data is not slice\")\n    }\n    slice := reflect.Indirect(reflect.ValueOf(data))\n    res := make([]string, slice.Len())\n    for i := 0; i &lt; slice.Len(); i++ {\n        a := slice.Index(i).Interface().(BankCoder)\n        res[i] = a.Bankcode()\n    }\n    return res\n}\n</code></pre>\n\n<hr>\n\n<p>Code (try on <a href=\"https://play.golang.org/p/_KTq5Jyn6D\" rel=\"nofollow\">The Go Playground</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    bs := []B{B{A{\"BC1\", \"BN\"}, \"e\"}, B{A{\"BC2\", \"BN\"}, \"e\"}}\n    strs := BankCodes(bs)\n    fmt.Println(strs)\n\n    as := []A{A{\"AC1\", \"BN\"}, A{\"AC2\", \"BN\"}}\n    strs2 := BankCodes(as)\n    fmt.Println(strs2)\n\n}\n\nfunc BankCodes(data interface{}) []string {\n    if reflect.TypeOf(data).Kind() != reflect.Slice {\n        panic(\"err: data is not slice\")\n    }\n    slice := reflect.Indirect(reflect.ValueOf(data))\n    res := make([]string, slice.Len())\n    for i := 0; i &lt; slice.Len(); i++ {\n        a := slice.Index(i).Interface().(BankCoder)\n        res[i] = a.Bankcode()\n    }\n    return res\n}\n\ntype A struct {\n    BankCode string `json:\"bankCode\"`\n    BankName string `json:\"bankName\"`\n}\n\ntype B struct {\n    A\n    extra string `json:\" extra\"`\n}\ntype BankCoder interface {\n    Bankcode() string\n}\n\nfunc (a A) Bankcode() string {\n    return a.BankCode\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6540988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdffd230e609c80d677b87c83e030c0f?s=128&d=identicon&r=PG&f=1", "display_name": "star zhang", "link": "https://stackoverflow.com/users/6540988/star-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2682, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473861948, "creation_date": 1473846964, "last_edit_date": 1473849641, "question_id": 39487543, "link": "https://stackoverflow.com/questions/39487543/golang-convert-list-objects-to-string", "title": "Golang convert list objects to string", "body": "<p>I have two structs:</p>\n\n<pre><code>type A struct {\n    BankCode           string `json:\"bankCode\"`\n    BankName           string `json:\"bankName\"`\n}\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>type B struct {\n    A \n    extra           string `json:\" extra\"`\n}\n</code></pre>\n\n<p>And two slices:<br>\n<code>listsA []A</code> and <code>listsB []B</code>\nI want to get <code>bankCodes</code> from <code>listA</code> and <code>listB</code>. <code>bankcodes</code> only contains <code>bankcodes</code>. It is a <code>[]string</code></p>\n\n<p>It will be so easy as using two function.</p>\n\n<pre><code>func getBankCodes(data []A) []string {\n    res := make([]string, len(data))\n    for i := 0; i &lt; len(data); i++ {\n        res[i] = data[i].BankCode\n    }\n    return res\n}\n\nfunc getBankCodes(data []B) []string {\n    res := make([]string, len(data))\n    for i := 0; i &lt; len(data); i++ {\n        res[i] = data[i].BankCode\n    }\n    return res\n}\n</code></pre>\n\n<p>How to use one common function ?</p>\n"}, {"tags": ["http", "go", "struct", "query-parameters"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1473844880, "post_id": 39486740, "comment_id": 66291685, "body": "That&#39;s the solution. Pick out each parameter from the request, assign it to the proper member of your struct."}, {"owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1473844948, "post_id": 39486740, "comment_id": 66291727, "body": "@nos what if I have a lot of paraeters?"}, {"owner": {"reputation": 4366, "user_id": 176478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a10b460f85d3d8b9702782bf6dd72307?s=128&d=identicon&r=PG", "display_name": "dmportella", "link": "https://stackoverflow.com/users/176478/dmportella"}, "edited": false, "score": 0, "creation_date": 1473846099, "post_id": 39486740, "comment_id": 66292437, "body": "you should use the net/url package parse request deals with all of this"}], "answers": [{"comments": [{"owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "edited": false, "score": 0, "creation_date": 1473854237, "post_id": 39487875, "comment_id": 66297243, "body": "Thank you, I am using your first solution but I am getting the default values of the elements inside Filter structure I am passing the parameters in the url query for example: localhost:8000/example?offset=1&amp;limit=2 then I get the default values when printing filter"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "edited": false, "score": 0, "creation_date": 1473855402, "post_id": 39487875, "comment_id": 66297989, "body": "@user6638204 Sorry, that was a &quot;typo&quot;, it should be <code>r.Form</code>. Fixed. Please try with that."}, {"owner": {"reputation": 177, "user_id": 3056912, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hbQht.jpg?s=128&g=1", "display_name": "xild", "link": "https://stackoverflow.com/users/3056912/xild"}, "edited": false, "score": 0, "creation_date": 1485448729, "post_id": 39487875, "comment_id": 70938951, "body": "Even after all this time.. other approach if you are using echolab frameworks to server endpoints:  <a href=\"https://echo.labstack.com/guide/request\" rel=\"nofollow noreferrer\">echo.labstack.com/guide/request</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 13, "last_activity_date": 1473855380, "last_edit_date": 1495535358, "creation_date": 1473847995, "answer_id": 39487875, "question_id": 39486740, "link": "https://stackoverflow.com/questions/39486740/how-to-get-all-get-request-query-parameters-into-a-structure-in-go/39487875#39487875", "title": "How to get all GET request query parameters into a structure in Go?", "body": "<h2>Using gorilla's <code>schema</code> package</h2>\n\n<p>The <a href=\"http://www.gorillatoolkit.org/pkg/schema\" rel=\"noreferrer\"><code>github.com/gorilla/schema</code></a> package was invented exactly for this.</p>\n\n<p>You can use <a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go/30889373#30889373\">struct tags</a> to tell how to map URL parameters to struct fields, the <code>schema</code> package looks for the <code>\"schema\"</code> tag keys.</p>\n\n<p>Using it:</p>\n\n<pre><code>import \"github.com/gorilla/schema\"\n\ntype Filter struct {\n    Offset int64  `schema:\"offset\"`\n    Limit  int64  `schema:\"limit\"`\n    SortBy string `schema:\"sortby\"`\n    Asc    bool   `schema:\"asc\"`\n\n    //User specific filters\n    Username   string `schema:\"username\"`\n    First_Name string `schema:\"first_name\"`\n    Last_Name  string `schema:\"last_name\"`\n    Status     string `schema:\"status\"`\n}\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n    if err := r.ParseForm(); err != nil {\n        // Handle error\n    }\n\n    filter := new(Filter)\n    if err := schema.NewDecoder().Decode(filter, r.Form); err != nil {\n        // Handle error\n    }\n\n    // Do something with filter\n    fmt.Printf(\"%+v\", filter)\n}\n</code></pre>\n\n<h2>Marshaling and unmarshaling using <code>json</code></h2>\n\n<p>Note that the <code>schema</code> package will also try to convert parameter values to the type of the field.</p>\n\n<p>If the struct would only contain fields of <code>[]string</code> type (or you're willing to make that compromise), you can do that without the <code>schema</code> package.</p>\n\n<p><a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"noreferrer\"><code>Request.Form</code></a> is a <code>map</code>, mapping from <code>string</code> to <code>[]string</code> (as one parameter may be listed multiple times in the URL:</p>\n\n<pre><code>Form url.Values\n</code></pre>\n\n<p>And <a href=\"https://golang.org/pkg/net/url/#Values\" rel=\"noreferrer\"><code>url.Values</code></a>:</p>\n\n<pre><code>type Values map[string][]string\n</code></pre>\n\n<p>So for example if your <code>Filter</code> struct would look like this:</p>\n\n<pre><code>type Filter struct {\n    Offset []string `json:\"offset\"`\n    Limit  []string `json:\"limit\"`\n    SortBy []string `json:\"sortby\"`\n    // ..other fields\n}\n</code></pre>\n\n<p>You could simply use the <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"noreferrer\"><code>json</code></a> package to marshal <code>r.Form</code>, then unmarshal it into your struct:</p>\n\n<pre><code>func MyHandler(w http.ResponseWriter, r *http.Request) {\n    if err := r.ParseForm(); err != nil {\n        // Handle error\n    }\n    data, err := json.Marshal(r.Form)\n    if err != nil {\n        // Handle error\n    }\n    filter := new(Fiter)\n    if err = json.Unmarshal(data, filter); err != nil {\n        // Handle error\n    }\n    fmt.Printf(\"%+v\", filter)\n}\n</code></pre>\n\n<p>This solution handles if multiple values are provided for the same parameter name. If you don't care about multiple values and you just want one, you first have to \"transform\" <code>r.Form</code> to a <code>map</code> with single <code>string</code> values instead of <code>[]string</code>.</p>\n\n<p>This is how it could look like:</p>\n\n<pre><code>type Filter struct {\n    Offset string `json:\"offset\"`\n    Limit  string `json:\"limit\"`\n    SortBy string `json:\"sortby\"`\n    // ..other fields\n}\n\n// Transformation from map[string][]string to map[string]string:\nm := map[string]string{}\nfor k, v := range r.Form {\n    m[k] = v[0]\n}\n</code></pre>\n\n<p>And then you can marshal <code>m</code> and unmarshal into it into the <code>Filter</code> struct the same way.</p>\n"}, {"tags": [], "owner": {"reputation": 2447, "user_id": 6315366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1308330302516639/picture?type=large", "display_name": "Alongkorn Chetasumon", "link": "https://stackoverflow.com/users/6315366/alongkorn-chetasumon"}, "is_accepted": false, "score": 0, "last_activity_date": 1605523496, "creation_date": 1605523496, "answer_id": 64856540, "question_id": 39486740, "link": "https://stackoverflow.com/questions/39486740/how-to-get-all-get-request-query-parameters-into-a-structure-in-go/64856540#64856540", "title": "How to get all GET request query parameters into a structure in Go?", "body": "<p>For <code>Echo</code> framework, you can bind a query string to a structure like this sample code.</p>\n<pre><code>type Filter struct {\n    Offset int64  `query:&quot;offset&quot;`\n    Limit  int64  `query:&quot;limit&quot;`\n    SortBy string `query:&quot;sortby&quot;`\n    Asc    bool   `query:&quot;asc&quot;`\n\n    //User specific filters\n    Username   string `query:&quot;username&quot;`\n    First_Name string `query:&quot;first_name&quot;`\n    Last_Name  string `query:&quot;last_name&quot;`\n    Status     string `query:&quot;status&quot;`\n}\n\nquery := new(Filter)\nif err := c.Bind(query); err != nil {\n    // handle error here\n}\n</code></pre>\n"}], "owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15308, "favorite_count": 1, "accepted_answer_id": 39487875, "answer_count": 2, "score": 8, "last_activity_date": 1605523496, "creation_date": 1473844687, "last_edit_date": 1473848242, "question_id": 39486740, "link": "https://stackoverflow.com/questions/39486740/how-to-get-all-get-request-query-parameters-into-a-structure-in-go", "title": "How to get all GET request query parameters into a structure in Go?", "body": "<p>Hi I want to transform get query parameters into a structure in Go, for example I have this structure:</p>\n\n<pre><code>type Filter struct {\n    Offset int64  `json:\"offset\"`\n    Limit  int64  `json:\"limit\"`\n    SortBy string `json:\"sortby\"`\n    Asc    bool   `json:\"asc\"`\n\n    //User specific filters\n    Username   string `json:\"username\"`\n    First_Name string `json:\"first_name\"`\n    Last_Name  string `json:\"last_name\"`\n    Status     string `json:\"status\"`\n}\n</code></pre>\n\n<p>And I have the optional parameters that the user can specify when sending a get request which are <code>Offset</code>, <code>Limit</code>, <code>SortBy</code>, <code>Asc</code>, <code>Username</code>, <code>First_Name</code>, <code>Last_Name</code>, <code>Status</code>.</p>\n\n<p>If those parameters were sent in the body then I would do this:</p>\n\n<pre><code>b, err := ioutil.ReadAll(r.Body)\nif err != nil {\n\n    log.WithFields(logFields).Errorf(\"Reading Body Message:failed:%v\", err)\n\n    return\n}\n\nvar filter Filter\nerr = json.Unmarshal(b, &amp;filter)\n</code></pre>\n\n<p>But I can't send body in a <code>GET</code> request so what is the solution instead of getting each parameter alone and then putting them into a structure?</p>\n"}, {"tags": ["go", "docker"], "answers": [{"comments": [{"owner": {"reputation": 11533, "user_id": 1022177, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/BDTjr.jpg?s=128&g=1", "display_name": "Myles McDonnell", "link": "https://stackoverflow.com/users/1022177/myles-mcdonnell"}, "edited": false, "score": 1, "creation_date": 1473950001, "post_id": 39497651, "comment_id": 66343399, "body": "I don&#39;t understand why this would explain why I get different results depending on the base image used? Please see my update for details. thanks"}, {"owner": {"reputation": 1505, "user_id": 1704733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf423695f1d5008a3fa18f8aaecefc27?s=128&d=identicon&r=PG", "display_name": "Tamir Daniely", "link": "https://stackoverflow.com/users/1704733/tamir-daniely"}, "edited": false, "score": 0, "creation_date": 1528967261, "post_id": 39497651, "comment_id": 88710097, "body": "Has to be a low level difference between weezy &amp; trusty. The docker facilities themselves are non blocking. You shouldn&#39;t even flush it manually in real scenarios because that will blow up IO. I guess some component in trusty is faking synchronous behavior over the actual buffered device. Probably a compatibility thing."}], "tags": [], "owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "is_accepted": false, "score": 1, "last_activity_date": 1473879094, "creation_date": 1473879094, "answer_id": 39497651, "question_id": 39486327, "link": "https://stackoverflow.com/questions/39486327/stdout-being-buffered-in-docker-container/39497651#39497651", "title": "stdout being buffered in docker container", "body": "<p>Is this what you're asking?</p>\n\n<blockquote>\n  <p>Why am I seeing my output in chunks? Is it being buffered and flushed somewhere?</p>\n</blockquote>\n\n<p>Yes. Your Docker container is running on a <a href=\"https://docs.docker.com/engine/understanding-docker/\" rel=\"nofollow\">Docker engine</a> (possibly wrapped by a <a href=\"https://docs.docker.com/machine/overview/\" rel=\"nofollow\">Docker machine</a>) and your commands are being run from a client. Even if your engine is installed locally and you're running your container in interactive mode, the commands you're entering and the output you're seeing are still basically the results of HTTP requests against <code>localhost</code>. (Or Unix Socket or TTY communications.) (I'm simplifying.) Docker is routing I/O through your network drivers, i.e. its stdout has to be flushed to a (virtual?) network connection, and then the client flushes <em>that</em> to your stdout.</p>\n\n<p>In background mode, the engine captures stdout and (<a href=\"https://docs.docker.com/engine/admin/logging/overview/\" rel=\"nofollow\">by default</a>) writes to a file. The <code>docker logs</code> command sends a request from your client to the engine, and the engine responds by reading back the contents of that file.</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 4456832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db6f7df8a16e6029e16d68b27285e83?s=128&d=identicon&r=PG&f=1", "display_name": "Konstantin", "link": "https://stackoverflow.com/users/4456832/konstantin"}, "is_accepted": false, "score": 4, "last_activity_date": 1480600463, "creation_date": 1480600463, "answer_id": 40912462, "question_id": 39486327, "link": "https://stackoverflow.com/questions/39486327/stdout-being-buffered-in-docker-container/40912462#40912462", "title": "stdout being buffered in docker container", "body": "<p>I faced same issue and looks like root cause is \"stdout buffering\".\nYou can start reading <a href=\"http://www.pixelbeat.org/programming/stdio_buffering/\" rel=\"nofollow noreferrer\">http://www.pixelbeat.org/programming/stdio_buffering/</a> and google in case of any additional question.\nI failed to resolve it by \"stdbuf\" or any linux/app settings and changed source code of the console app I want to dockerize to proceed with file flush on each write.</p>\n\n<p>(my configuration is strange because of a lot of reason, but it is: the app has configured log output to the file named \"/dev/stdout\" and it performs file_flush on each log write and docker can show messages in real time on \"docker logs -f XXXXX\") </p>\n"}], "owner": {"reputation": 11533, "user_id": 1022177, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/BDTjr.jpg?s=128&g=1", "display_name": "Myles McDonnell", "link": "https://stackoverflow.com/users/1022177/myles-mcdonnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5508, "favorite_count": 4, "answer_count": 2, "score": 7, "last_activity_date": 1480600463, "creation_date": 1473843324, "last_edit_date": 1474018834, "question_id": 39486327, "link": "https://stackoverflow.com/questions/39486327/stdout-being-buffered-in-docker-container", "title": "stdout being buffered in docker container", "body": "<p>I'm not entirely sure what is going on here but it appears that stdout is being buffered when I run my code in a container, but not if I run it on the host or on OSX.</p>\n\n<p><a href=\"https://github.com/myles-mcdonnell/procwrap/blob/master/procwrap.go\" rel=\"noreferrer\">https://github.com/myles-mcdonnell/procwrap/blob/master/procwrap.go</a></p>\n\n<p>The relevant piece (modified for brevity):</p>\n\n<pre><code>    cmd := exec.Command(\"ping\", \"127.0.0.1\")\n\n    logger := &amp;lumberjack.Logger{\n        Filename:   conf.LogFile,\n        MaxSize:    conf.MaxLogSizeMb,\n        MaxBackups: conf.MaxLogBackups,\n        MaxAge:     conf.MaxLogAgeDays,\n    }\n\n    cmd.Stdout = io.MultiWriter(os.Stdout, logger)  \n\n    err := cmd.Run()\n</code></pre>\n\n<p>Running in a container the sub process runs fine but I only see output (to stdout and the log file) at intervals, like a buffer is being flushed.  Run it outside of a container and it outputs as it is generated. I'm using go 1.6.3.  I see the same behaviour running the container interactively and in the background.</p>\n\n<p>Docker version:</p>\n\n<pre><code>Client:\n Version:      1.10.3\n API version:  1.22\n Go version:   go1.5.3\n Git commit:   20f81dd\n Built:        Thu Mar 10 21:49:11 2016\n OS/Arch:      darwin/amd64\n\nServer:\n Version:      1.12.0\n API version:  1.24\n Go version:   go1.6.3\n Git commit:   8eab29e\n Built:        Thu Jul 28 23:54:00 2016\n OS/Arch:      linux/amd64\n</code></pre>\n\n<p>======= UPDATE ======</p>\n\n<p>I'm seeing different behaviour based on the base image.  Running procwrap on a debian:wheezy base I get buffered output.  Doing the same on ubuntu:trusty it's synchronous.  Dockerfiles below, simply execute 'docker run {image_name}' on each to observe.  Run procwrap on a wheezy VM (no docker involved) does not buffer the output.</p>\n\n<p>TRUSTY:</p>\n\n<pre><code>FROM ubuntu:trusty\nRUN apt-get update\nRUN apt-get install -y curl\nRUN apt-get install -y git\nRUN curl -O https://storage.googleapis.com/golang/go1.6.3.linux-amd64.tar.gz\nRUN tar -xvf go1.6.3.linux-amd64.tar.gz\nRUN mv go /usr/local\nENV GOROOT=/usr/local/go\nRUN mkdir -p /go/src/github.com/myles-mcdonnell\nENV GOPATH=/go\nENV PATH=$PATH:$GOPATH/bin:$GOROOT/bin\nRUN go get github.com/myles-mcdonnell/procwrap\nWORKDIR /go/src/github.com/myles-mcdonnell/procwrap\nCMD procwrap -v\n</code></pre>\n\n<p>WHEEZY:</p>\n\n<pre><code>FROM debian:wheezy\nRUN apt-get update\nRUN apt-get install -y curl\nRUN apt-get install -y git\nRUN curl -O https://storage.googleapis.com/golang/go1.6.3.linux-amd64.tar.gz\nRUN tar -xvf go1.6.3.linux-amd64.tar.gz\nRUN mv go /usr/local\nENV GOROOT=/usr/local/go\nRUN mkdir -p /go/src/github.com/myles-mcdonnell\nENV GOPATH=/go\nENV PATH=$PATH:$GOPATH/bin:$GOROOT/bin\nRUN go get github.com/myles-mcdonnell/procwrap\nWORKDIR /go/src/github.com/myles-mcdonnell/procwrap\nCMD procwrap -v\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 750, "user_id": 2809739, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ymnxe.jpg?s=128&g=1", "display_name": "Sachin Nambiar Nalavattanon", "link": "https://stackoverflow.com/users/2809739/sachin-nambiar-nalavattanon"}, "edited": false, "score": 0, "creation_date": 1473829226, "post_id": 39482668, "comment_id": 66284165, "body": "Can you make a sample <a href=\"https://play.golang.org/\" rel=\"nofollow noreferrer\">play.golang.org</a>? Similar to your&#39;s, <a href=\"https://play.golang.org/p/64LCjbg6pI\" rel=\"nofollow noreferrer\">play.golang.org/p/64LCjbg6pI</a> works fine."}, {"owner": {"reputation": 27, "user_id": 6586806, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8c510235133135d68628fb13d8581ad?s=128&d=identicon&r=PG&f=1", "display_name": "user6586806", "link": "https://stackoverflow.com/users/6586806/user6586806"}, "reply_to_user": {"reputation": 750, "user_id": 2809739, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ymnxe.jpg?s=128&g=1", "display_name": "Sachin Nambiar Nalavattanon", "link": "https://stackoverflow.com/users/2809739/sachin-nambiar-nalavattanon"}, "edited": false, "score": 0, "creation_date": 1473830057, "post_id": 39482668, "comment_id": 66284401, "body": "I cannot do http requests in the playground"}, {"owner": {"reputation": 750, "user_id": 2809739, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ymnxe.jpg?s=128&g=1", "display_name": "Sachin Nambiar Nalavattanon", "link": "https://stackoverflow.com/users/2809739/sachin-nambiar-nalavattanon"}, "edited": false, "score": 3, "creation_date": 1473830239, "post_id": 39482668, "comment_id": 66284462, "body": "Create a <code>Minimal, Complete, and Verifiable example</code>, <code>Minimal \u2013 Use as little code as possible that still produces the same problem</code>"}, {"owner": {"reputation": 750, "user_id": 2809739, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ymnxe.jpg?s=128&g=1", "display_name": "Sachin Nambiar Nalavattanon", "link": "https://stackoverflow.com/users/2809739/sachin-nambiar-nalavattanon"}, "edited": false, "score": 1, "creation_date": 1473831575, "post_id": 39482668, "comment_id": 66284849, "body": "For your case, the varialbe <code>jsonData </code> should have exact structure as <code>body </code>. You could use <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">mholt.github.io/json-to-go</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1189, "user_id": 3931609, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/4n2cW.jpg?s=128&g=1", "display_name": "Kul", "link": "https://stackoverflow.com/users/3931609/kul"}, "is_accepted": false, "score": 0, "last_activity_date": 1473831468, "creation_date": 1473831468, "answer_id": 39483133, "question_id": 39482668, "link": "https://stackoverflow.com/questions/39482668/how-can-i-properly-unmarshal-json-into-a-defined-struct/39483133#39483133", "title": "How can I properly UnMarshal json into a defined struct", "body": "<blockquote>\n  <p>it seems the format is {\"id\":\"value\",...} rather than [{\"id\", \"value\"}, {}...]</p>\n</blockquote>\n\n<p>Try replacing</p>\n\n<pre><code>var jsonData [] parsed\n</code></pre>\n\n<p>with</p>\n\n<pre><code>var jsonData parsed\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6586806, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8c510235133135d68628fb13d8581ad?s=128&d=identicon&r=PG&f=1", "display_name": "user6586806", "link": "https://stackoverflow.com/users/6586806/user6586806"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1473831468, "creation_date": 1473828592, "last_edit_date": 1473829130, "question_id": 39482668, "link": "https://stackoverflow.com/questions/39482668/how-can-i-properly-unmarshal-json-into-a-defined-struct", "title": "How can I properly UnMarshal json into a defined struct", "body": "<p>I get the error \"cannot unmarshal object into Go value of type []main.parsed\" when I try this</p>\n\n<pre><code>package main\n\nimport {...}\ntype parsed struct {\n        Title string  `json:\"title,string,omitempty\"`\n}\n\nfunc Function (args [] String) string {\n\nvar jsonData [] parsed\n    body, err := ioutil.ReadAll(resp.Body)\n        if err!= nil {\n                return \"\"\n        }        \n    err = json.Unmarshal([]byte(body), &amp;jsonData)\n        if err!= nil {\n                return \"\"\n        }\n    fmt.Println(jsonData)\n}\n</code></pre>\n"}, {"tags": ["html", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1473825854, "post_id": 39482138, "comment_id": 66283371, "body": "Split the string into parts and handle the parts differently."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 1, "creation_date": 1473831704, "post_id": 39482138, "comment_id": 66284897, "body": "@kristen : It is helpful if you add some sample inputs and desired outputs to your Question"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1473876106, "post_id": 39482138, "comment_id": 66311262, "body": "How do you intend to differentiate what you want escaped, and what you don&#39;t?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1473880457, "post_id": 39482138, "comment_id": 66313543, "body": "As @Volker states you split the string into parts &amp; handle the parts differently....I just don&#39;t know how to handle each part..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1473888877, "post_id": 39482138, "comment_id": 66317522, "body": "@Volker: can you be more specific?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1473912927, "post_id": 39482138, "comment_id": 66323308, "body": "Well, you split <code>s</code> at the appropriate location, maybe my finding a &quot;split index&quot; and doing <code>e, u := s[:i], s[i+1:]</code> and wrap <code>s</code> in <code>template.HTML</code> before passing both <code>e</code> and <code>s</code> to a template for execution (which will encode <code>e</code> and keep <code>s</code>)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "edited": false, "score": 0, "creation_date": 1473961148, "post_id": 39482138, "comment_id": 66350084, "body": "I think it&#39;s a bit more involved than that. You&#39;d have to ensure that e only contains text characters and no html or other unsafe characters."}], "owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1474229594, "creation_date": 1473824344, "last_edit_date": 1474229594, "question_id": 39482138, "link": "https://stackoverflow.com/questions/39482138/partial-unescape-html-string", "title": "Partial unescape html string", "body": "<p>I have webapp. Go html template will escape all unsafe tag. Is there way to selectively escape a string? For instance, Google.com will highlight your search query and wrap it with <code>&lt;em&gt;</code> tag while all other html &amp; javascript gets escaped. <a href=\"https://play.golang.org/p/Y5cvDCl4ad\" rel=\"nofollow\">I have this</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"html/template\"\n)\n\nfunc main() {\n    s := \"&lt;i&gt;This should be escaped&lt;/i&gt;&lt;strong&gt;This should be in bold&lt;/strong&gt;.\"\n    h := template.HTMLEscaper(s)\n    fmt.Println(h)\n}\n</code></pre>\n\n<p>Right now everything gets escaped. I am aware you can do a template function with template.HTML(mystring) but how do I do that for part of a string?</p>\n\n<p>thx!</p>\n\n<p>EDIT:\nI would like the final string to be:</p>\n\n<pre><code>&amp;lt;i&amp;gt;This should be escaped&amp;lt;/i&amp;gt;&lt;strong&gt;This should be in bold&lt;/strong&gt;.\n</code></pre>\n\n<p>To be clear, I have tried creating a template function to highlight matches...the html I add gets escaped in the actual template ;(</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 50474, "user_id": 6680611, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wRJqu.png?s=128&g=1", "display_name": "cartant", "link": "https://stackoverflow.com/users/6680611/cartant"}, "edited": false, "score": 0, "creation_date": 1473822583, "post_id": 39481826, "comment_id": 66282667, "body": "This question would be more appropriate on <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1473841161, "post_id": 39481826, "comment_id": 66289487, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/22892120/how-to-generate-a-random-string-of-a-fixed-length-in-golang\">How to generate a random string of a fixed length in golang?</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 9, "last_activity_date": 1473827312, "last_edit_date": 1495542809, "creation_date": 1473827312, "answer_id": 39482484, "question_id": 39481826, "link": "https://stackoverflow.com/questions/39481826/generate-6-digit-verification-code-with-golang/39482484#39482484", "title": "Generate 6-digit Verification Code with Golang?", "body": "<p>You may use \"crypto/rand\" package: which implements a cryptographically secure pseudorandom number generator. (try on <a href=\"https://play.golang.org/p/QJ08lYgT3a\" rel=\"noreferrer\">The Go Playground</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/rand\"\n    \"fmt\"\n    \"io\"\n)\n\nfunc main() {\n    for i := 0; i &lt; 3; i++ {\n        fmt.Println(EncodeToString(6))\n    }\n}\n\nfunc EncodeToString(max int) string {\n    b := make([]byte, max)\n    n, err := io.ReadAtLeast(rand.Reader, b, max)\n    if n != max {\n        panic(err)\n    }\n    for i := 0; i &lt; len(b); i++ {\n        b[i] = table[int(b[i])%len(table)]\n    }\n    return string(b)\n}\n\nvar table = [...]byte{'1', '2', '3', '4', '5', '6', '7', '8', '9', '0'}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>640166\n195174\n221966\n</code></pre>\n\n<p>And see: <a href=\"https://stackoverflow.com/questions/22892120/how-to-generate-a-random-string-of-a-fixed-length-in-golang\">How to generate a random string of a fixed length in golang?</a></p>\n"}, {"tags": [], "owner": {"reputation": 24435, "user_id": 3191896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVtnn.png?s=128&g=1", "display_name": "Jossef Harush", "link": "https://stackoverflow.com/users/3191896/jossef-harush"}, "is_accepted": false, "score": 5, "last_activity_date": 1588621229, "creation_date": 1588621229, "answer_id": 61600241, "question_id": 39481826, "link": "https://stackoverflow.com/questions/39481826/generate-6-digit-verification-code-with-golang/61600241#61600241", "title": "Generate 6-digit Verification Code with Golang?", "body": "<p>I've forked user6169399's answer, using <code>crypto/rand</code> with const string and small modifications, this is the result:</p>\n\n<pre><code>import (\n    \"crypto/rand\"\n)\n\nconst otpChars = \"1234567890\"\n\nfunc GenerateOTP(length int) (string, error) {\n    buffer := make([]byte, length)\n    _, err := rand.Read(buffer)\n    if err != nil {\n        return \"\", err\n    }\n\n    otpCharsLength := len(otpChars)\n    for i := 0; i &lt; length; i++ {\n        buffer[i] = otpChars[int(buffer[i])%otpCharsLength]\n    }\n\n    return string(buffer), nil\n}\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 6211801, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ODZ83.jpg?s=128&g=1", "display_name": "fishu", "link": "https://stackoverflow.com/users/6211801/fishu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5739, "favorite_count": 6, "accepted_answer_id": 39482484, "answer_count": 2, "score": 4, "last_activity_date": 1588621229, "creation_date": 1473821856, "last_edit_date": 1473827544, "question_id": 39481826, "link": "https://stackoverflow.com/questions/39481826/generate-6-digit-verification-code-with-golang", "title": "Generate 6-digit Verification Code with Golang?", "body": "<p>Generate 6-digit code for phone verification,\nThe following is a very simple approach that I have used</p>\n\n<pre><code>package main\n\nimport ( \n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)        \n\nvar randowCodes = [...]byte{\n    '1', '2', '3', '4', '5', '6', '7', '8', '9', '0',\n}        \n\nfunc main() {\n    var r *rand.Rand = rand.New(rand.NewSource(time.Now().UnixNano()))\n\n    for i := 0; i &lt; 3; i++ {\n        var pwd []byte = make([]byte, 6)\n\n        for j := 0; j &lt; 6; j++ {\n            index := r.Int() % len(randowCodes)\n\n            pwd[j] = randowCodes[index]\n        }\n\n        fmt.Printf(\"%s\\n\", string(pwd))                                                                  \n    }    \n} \n</code></pre>\n\n<p>Do you have a better way to do this\uff1f</p>\n"}, {"tags": ["testing", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1473819801, "post_id": 39481085, "comment_id": 66282105, "body": "The example should run and report an error as written.  There&#39;s no need to specify the .go file: <code>go test</code>  will run the examples in the current directory.  Is the example in a _test.go file?"}, {"owner": {"reputation": 967, "user_id": 5105392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1019878568022717/picture?type=large", "display_name": "Harry", "link": "https://stackoverflow.com/users/5105392/harry"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1473820900, "post_id": 39481085, "comment_id": 66282327, "body": "Yes, this example code is included in _test.go file."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1473860057, "post_id": 39481085, "comment_id": 66301148, "body": "The file or function isn&#39;t being included for some reason. Please make a complete standalone example so others can verify the problem."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1473899691, "post_id": 39501471, "comment_id": 66320553, "body": "Ah, that&#39;s a bug. it will be fixed in go1.8"}, {"owner": {"reputation": 120, "user_id": 5810411, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10153925102124917/picture?type=large", "display_name": "Arthur Silva", "link": "https://stackoverflow.com/users/5810411/arthur-silva"}, "edited": false, "score": 0, "creation_date": 1515672286, "post_id": 39501471, "comment_id": 83394167, "body": "exactly what i just said :D"}], "tags": [], "owner": {"reputation": 967, "user_id": 5105392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1019878568022717/picture?type=large", "display_name": "Harry", "link": "https://stackoverflow.com/users/5105392/harry"}, "is_accepted": true, "score": 1, "last_activity_date": 1473898754, "creation_date": 1473898754, "answer_id": 39501471, "question_id": 39481085, "link": "https://stackoverflow.com/questions/39481085/how-example-can-be-run-in-test/39501471#39501471", "title": "How example can be run in test?", "body": "<p>After this post, I found it.</p>\n\n<p>My xxx_test.go file didn't include Testxxx func at all.\nxxx_test.go fires need it at least one.\nAfter adding Testxxx func besides Example, example code worked!</p>\n\n<p>Thanks!!</p>\n"}], "owner": {"reputation": 967, "user_id": 5105392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1019878568022717/picture?type=large", "display_name": "Harry", "link": "https://stackoverflow.com/users/5105392/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 39501471, "answer_count": 1, "score": 1, "last_activity_date": 1473898821, "creation_date": 1473815294, "last_edit_date": 1473898821, "question_id": 39481085, "link": "https://stackoverflow.com/questions/39481085/how-example-can-be-run-in-test", "title": "How example can be run in test?", "body": "<p>I'm trying to run example in test.\nHowever after running, warning is shown.\n<code>\ntesting: warning: no tests to run\n</code></p>\n\n<p>This example code includes comment <code>// Output comment.</code></p>\n\n<pre><code>func ExampleMethod1() {\n    fmt.Printf(\"result: %x\", Method1())\n    // Output: xxxx\n}\n</code></pre>\n\n<p>What is wrong? When running test, I executed like this.\n<code>go test -v xxxx_test.go</code></p>\n\n<p>Thanks.</p>\n\n<p>Harry</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1473797700, "post_id": 39478181, "comment_id": 66275805, "body": "You could have just assigned the file as the command&#39;s Stdout and avoided the pipe and copy goroutine (in which you were losing your read/write errors),"}], "answers": [{"comments": [{"owner": {"reputation": 1187, "user_id": 1044083, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/547896085/picture?type=large", "display_name": "Dean", "link": "https://stackoverflow.com/users/1044083/dean"}, "edited": false, "score": 0, "creation_date": 1473838264, "post_id": 39478248, "comment_id": 66287861, "body": "Short and sweet! Thanks"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 11, "last_activity_date": 1473805819, "last_edit_date": 1473805819, "creation_date": 1473797506, "answer_id": 39478248, "question_id": 39478181, "link": "https://stackoverflow.com/questions/39478181/how-to-get-output-from-stdout-into-a-string-in-golang/39478248#39478248", "title": "How to get output from stdout into a string in golang", "body": "<p>You don't need the pipe, writer, goroutine, etc. Just use <a href=\"https://golang.org/pkg/os/exec/#Cmd.Output\" rel=\"noreferrer\">Cmd.Output</a></p>\n\n<pre><code>out, err := exec.Command(\"ls\",\"lh\").Output()\n</code></pre>\n\n<p>You can convert the output <code>[]byte</code> to a <code>string</code> as needed with <code>string(out)</code></p>\n"}, {"tags": [], "owner": {"reputation": 16322, "user_id": 215969, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a50a54d4d142661b7b2ac1e6dce80da?s=128&d=identicon&r=PG", "display_name": "Ilia Choly", "link": "https://stackoverflow.com/users/215969/ilia-choly"}, "is_accepted": false, "score": 4, "last_activity_date": 1473798067, "creation_date": 1473798067, "answer_id": 39478392, "question_id": 39478181, "link": "https://stackoverflow.com/questions/39478181/how-to-get-output-from-stdout-into-a-string-in-golang/39478392#39478392", "title": "How to get output from stdout into a string in golang", "body": "<p>You can set the file as the command's <code>stdout</code></p>\n\n<pre><code>f, err := os.Create(\"./out.txt\")\nif err != nil {\n    panic(err)\n}\ndefer f.Close()\n\ncmd := exec.Command(\"ls\", \"-lh\")\ncmd.Stdout = f\ncmd.Stderr = os.Stderr\n\nif err := cmd.Run(); err != nil {\n    panic(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 1187, "user_id": 1044083, "user_type": "registered", "accept_rate": 81, "profile_image": "https://graph.facebook.com/547896085/picture?type=large", "display_name": "Dean", "link": "https://stackoverflow.com/users/1044083/dean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5903, "favorite_count": 1, "accepted_answer_id": 39478248, "answer_count": 2, "score": 3, "last_activity_date": 1473805819, "creation_date": 1473797152, "question_id": 39478181, "link": "https://stackoverflow.com/questions/39478181/how-to-get-output-from-stdout-into-a-string-in-golang", "title": "How to get output from stdout into a string in golang", "body": "<p>I have the following code which outputs data from stdout to a file:</p>\n\n<pre><code>cmd := exec.Command(\"ls\",\"lh\")\noutfile, err := os.Create(\"./out.txt\")\nif err != nil {\n    panic(err)\n}\ndefer outfile.Close()\n\nstdoutPipe, err := cmd.StdoutPipe()\nif err != nil {\n    panic(err)\n}\n\nwriter := bufio.NewWriter(outfile)\ndefer writer.Flush()\n\nerr = cmd.Start()\nif err != nil {\n    panic(err)\n}\n\ngo io.Copy(writer, stdoutPipe)\ncmd.Wait()\n</code></pre>\n\n<p>I need to get the output from stdout into a string value instead of a file. How do I achieve that?</p>\n\n<p>Is there perhaps another function that will allow me to change the io.Copy line to go io.Copy(myStringVariable, stdoutPipe) as I need to read the output of the command and apply some processing to it?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1473785708, "post_id": 39474955, "comment_id": 66269753, "body": "From your code I can&#39;t see why <code>handler.Success = true</code> isn&#39;t inside <code>BaseHandler</code>&#39;s <code>Execute</code>."}, {"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 0, "creation_date": 1473785770, "post_id": 39474955, "comment_id": 66269776, "body": "You could make the interface BaseHandler also have a <code>SetSuccess()</code> if it has to be able to do that as well."}, {"owner": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1473785859, "post_id": 39474955, "comment_id": 66269826, "body": "@Ainar-G : It could. But it&#39;s half the job, it still won&#39;t call <code>Handler</code>&#39;s <code>Execute</code>."}, {"owner": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "reply_to_user": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 0, "creation_date": 1473785926, "post_id": 39474955, "comment_id": 66269850, "body": "@algrebe : but then, I still have to duplicate the <code>SetSuccess</code> logic in all types, haven&#39;t I?"}, {"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 0, "creation_date": 1473785997, "post_id": 39474955, "comment_id": 66269885, "body": "@OlivierElMekki they could embed the success struct which has the function SetSuccess"}, {"owner": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "reply_to_user": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 0, "creation_date": 1473786149, "post_id": 39474955, "comment_id": 66269962, "body": "@algrebe: I&#39;m not sure to see how it allows to share code. Could you provide an example, by any chance?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1473786322, "post_id": 39474955, "comment_id": 66270058, "body": "@OlivierElMekki If it&#39;s in <code>Execute</code>, you could just do this: <a href=\"https://play.golang.org/p/iDo2BQ6N5D\" rel=\"nofollow noreferrer\">play.golang.org/p/iDo2BQ6N5D</a>."}, {"owner": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1473786586, "post_id": 39474955, "comment_id": 66270192, "body": "@Ainar-G Oh, I see. Indeed, if I can abstract out field setting, then I can work with interfaces. Thanks! Could you write that as a answer, so I can accept it?"}, {"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 1, "creation_date": 1473786595, "post_id": 39474955, "comment_id": 66270195, "body": "@OlivierElMekki I hope this works. Dont hate on the struct name lol :P <a href=\"https://play.golang.org/p/jflmT-LpJy\" rel=\"nofollow noreferrer\">play.golang.org/p/jflmT-LpJy</a>"}, {"owner": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "reply_to_user": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 0, "creation_date": 1473786887, "post_id": 39474955, "comment_id": 66270330, "body": "@algrebe thanks! Actually, it&#39;s quite the same idea that Ainar-G &#39;s one: interface + embed to abstract out field setting. Sorry I can&#39;t accept two answers, both are the good one :) (and np for struct names ;) )"}, {"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 1, "creation_date": 1473787077, "post_id": 39474955, "comment_id": 66270424, "body": "@OlivierElMekki no problem. I&#39;ve kept mine there just for an alternate solution."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1473786737, "creation_date": 1473786737, "answer_id": 39475556, "question_id": 39474955, "link": "https://stackoverflow.com/questions/39474955/writing-a-function-that-can-manipulate-several-similar-types/39475556#39475556", "title": "Writing a function that can manipulate several similar types", "body": "<p><code>handler.Success = true</code> feels like it belongs within <code>Execute</code>. Thus, you could define an interface and make <code>Init</code> a function on this interface, while embedding the interface in \"children\":</p>\n\n<pre><code>type Handler interface {\n    Execute()\n}\n\nfunc Init(handler Handler) {\n    handler.Execute()\n}\n\ntype BaseHandler struct {\n    Success bool\n}\n\nfunc (handler *BaseHandler) Execute() {\n    handler.Success = true\n    fmt.Println(\"success: true\")\n}\n\ntype MyHandler struct {\n    Handler\n    Message string\n}\n\nfunc (handler *MyHandler) Execute() {\n    fmt.Println(\"I do some work before\")\n    handler.Handler.Execute()\n    fmt.Println(\"I do some work after\")\n}\n\nfunc main() {\n    handler := &amp;MyHandler{&amp;BaseHandler{}, \"foo\"}\n    Init(handler)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/iDo2BQ6N5D\" rel=\"nofollow\">https://play.golang.org/p/iDo2BQ6N5D</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "edited": false, "score": 0, "creation_date": 1473787072, "post_id": 39475611, "comment_id": 66270421, "body": "Both answers solve my problem, sorry StackOverflow does not allow to set several good answers!"}], "tags": [], "owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "is_accepted": false, "score": 1, "last_activity_date": 1473787138, "last_edit_date": 1473787138, "creation_date": 1473786945, "answer_id": 39475611, "question_id": 39474955, "link": "https://stackoverflow.com/questions/39474955/writing-a-function-that-can-manipulate-several-similar-types/39475611#39475611", "title": "Writing a function that can manipulate several similar types", "body": "<p>Seems like you need init to be able to set success and execute something.</p>\n\n<p>TL;DR Heres the playground link <a href=\"https://play.golang.org/p/jflmT-LpJy\" rel=\"nofollow\">https://play.golang.org/p/jflmT-LpJy</a></p>\n\n<p>So, using interfaces, I'd create the following</p>\n\n<pre><code>type SuccessableExecutable interface {\n    SetSuccess()\n    Execute()\n}\n\nfunc Init(se SuccessableExecutable) {\n    se.SetSuccess()\n    se.Execute()\n}\n</code></pre>\n\n<p>Now, you'd like SetSuccess to be reusable across the many types. For this I'd create a struct which could be embedded in all those types</p>\n\n<pre><code>type Successable struct {\n    success bool\n}\n\nfunc (s *Successable) SetSuccess() {\n    s.success = True\n}\n</code></pre>\n\n<p>Embedding this automatically gives you access to <code>SetSuccess</code> so any struct that has the <code>Execute</code> and embeds this, will also be a <code>SuccessableExecutable</code>.</p>\n\n<p>Putting it together, we have </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Successable struct {\n    success bool\n}\n\nfunc (s *Successable) SetSuccess() {\n    s.success = true\n}\n\ntype SuccessableExecutable interface {\n    SetSuccess()\n    Execute()\n}\n\ntype BaseHandler struct {\n    Message string\n    Successable\n}\n\nfunc (b *BaseHandler) Execute() {\n    fmt.Printf(\"%s\\n\", b.Message);\n}\n\nfunc Init(se SuccessableExecutable) {\n    se.SetSuccess()\n    se.Execute()\n}\n\nfunc main() {\n        bh := &amp;BaseHandler{ Message: \"hello\" }\n        fmt.Printf(\"%+v\\n\", bh)\n        Init(bh)\n        fmt.Printf(\"%+v\\n\", bh)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "edited": false, "score": 0, "creation_date": 1474136431, "post_id": 39478160, "comment_id": 66412277, "body": "Thanks! I see there are a lot of different ways for the same solution :) Thanks for the note on pointer and interfaces, it&#39;s indeed something I&#39;ve been bitten a lot by."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 1, "last_activity_date": 1473797058, "creation_date": 1473797058, "answer_id": 39478160, "question_id": 39474955, "link": "https://stackoverflow.com/questions/39474955/writing-a-function-that-can-manipulate-several-similar-types/39478160#39478160", "title": "Writing a function that can manipulate several similar types", "body": "<p>Try embedding an interface:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype BaseHandler struct {\n    Success  bool\n    Executer // embedded, so BaseHandler inherits the method\n}\n\ntype Executer interface {\n    Execute()\n}\n\nfunc (h *BaseHandler) Init() {\n    h.Success = true\n    h.Execute()\n}\n\n// I will have many different types doing the same kind of work,\n// with their own specific fields and functions\ntype StringHandler struct {\n    Message string\n}\n\nfunc (h *StringHandler) Execute() {\n    fmt.Println(h.Message)\n}\n\ntype IntHandler struct {\n    Value int\n}\n\nfunc (h *IntHandler) Execute() {\n    fmt.Println(h.Value)\n}\n\nfunc main() {\n    stringHandler := BaseHandler{Executer: &amp;StringHandler{\"Hello\"}}\n    intHandler := BaseHandler{Executer: &amp;IntHandler{42}}\n    DoInit(stringHandler)\n    DoInit(intHandler)\n}\n\n// These are just to prove you can pass it around as the struct\nfunc DoInit(h BaseHandler) {\n    h.Init()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/aGZMnuoBh_\" rel=\"nofollow\">https://play.golang.org/p/aGZMnuoBh_</a></p>\n\n<p>This lets Success be tracked within the base handler, but the actual implementation of Execute can be dynamically filled by whatever type you want (so long as it fulfills that interface).</p>\n\n<p>Personally, I like to take it another step further, and pass around the interface-embedding-struct as another interface (either the same as embedded, since a structure automatically implements all interfaces that it embeds, or as another interface with other or additional methods).</p>\n\n<p>Also, a related word of caution: I always recommend passing pointers into interfaces when you're doing something like this.  It's an interesting quirk of Go that an interface storing a pointer can access both the pointer and value receiver methods of that stored type, but an interface storing a value directly (even though the interface will in most cases <em>still</em> store a pointer to the value) can only access the value receiver methods.  For example: <a href=\"https://play.golang.org/p/6qOYhol_y_\" rel=\"nofollow\">https://play.golang.org/p/6qOYhol_y_</a></p>\n"}], "owner": {"reputation": 7427, "user_id": 1268771, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VF3zM.png?s=128&g=1", "display_name": "kik", "link": "https://stackoverflow.com/users/1268771/kik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 39475556, "answer_count": 3, "score": 1, "last_activity_date": 1473797058, "creation_date": 1473784468, "last_edit_date": 1473785707, "question_id": 39474955, "link": "https://stackoverflow.com/questions/39474955/writing-a-function-that-can-manipulate-several-similar-types", "title": "Writing a function that can manipulate several similar types", "body": "<p>I'm trying to make several types that can call the same function to perform a few common operations, without needing to duplicate them for each type. Let's call those types handlers.</p>\n\n<p>The idea is that I can have a CreateHandler, a ListHandler, etc, and a function that will do default operations for those handlers, let's say, set the \"Success\" field to true and call the \"Execute\" function on the handler. I keep those examples simple to make them easy to read, but in real case there would be way more common operations.</p>\n\n<p>I've tried 3 different approaches, to no avail: using a base type and embed it, using an interface implemented by types and using an empty interface as parameter.</p>\n\n<h2>Base type embedded</h2>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype BaseHandler struct {\n  Success bool\n}\n\nfunc ( handler *BaseHandler ) Init() {\n  handler.Success = true\n  handler.Execute()\n}\n\nfunc ( handler *BaseHandler ) Execute() {\n}\n\n\n\n// I will have many different types doing the same kind of work,\n// with their own specific fields and functions\ntype MyHandler struct {\n  BaseHandler\n  Message string\n}\n\nfunc ( handler *MyHandler ) Execute() {\n  fmt.Println( \"I'm never called\" )\n}\n\nfunc main() {\n  handler := MyHandler{}\n  handler.Init()\n}\n</code></pre>\n\n<p>This won't work because the <code>Execute</code> function called is the one from <code>BaseHandler</code>, not from <code>MyHandler</code>. Same problem if the <code>Init</code> method has no receiver and takes a <code>*BaseHandler</code> as parameter.</p>\n\n<h2>interface implemented by types</h2>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype BaseHandler interface {\n  Execute()\n}\n\nfunc Init( handler BaseHandler ) {\n  handler.Success = true\n  handler.Execute()\n}\n\ntype MyHandler struct {\n  Success bool\n  Message string\n}\n\nfunc ( handler *MyHandler ) Execute() {\n  fmt.Println( \"I'm never called\" )\n}\n\nfunc main() {\n  handler := MyHandler{}\n  Init( handler )\n}\n</code></pre>\n\n<p>This will fail to compile because of first line of <code>Init</code> function, saying that the <code>BaseHandler</code> interface does not have a <code>Success</code> field.</p>\n\n<h2>empty interface as parameter</h2>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc Init( handler interface{} ) {\n  handler.Success = true\n  handler.Execute()\n}\n\n\ntype MyHandler struct {\n  Success bool\n  Message string\n}\n\nfunc ( handler *MyHandler ) Execute() {\n  fmt.Println( \"I'm never called\" )\n}\n\nfunc main() {\n  handler := MyHandler{}\n  Init( handler )\n}\n</code></pre>\n\n<p>This will fail to compile on first line of <code>Init</code> saying that <code>interface{}</code> has no <code>Success</code> field. I can't do type assertion there, because it would mean listing all the types which can go there, and there may be a lot.</p>\n\n<h2>Question</h2>\n\n<p>So here is my question: how do you write shared code, that can set fields and call functions from similar types?</p>\n"}, {"tags": ["go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1473797205, "post_id": 39474991, "comment_id": 66275592, "body": "Well, if we&#39;re being technical, strings are <i>essentially</i> slices.  They are freely convertable to <code>[]byte</code> and back.  The only functional difference is that slices are immutable, and their slice header structure is a machine word smaller because their cap and len are by definition equal."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1473799081, "post_id": 39474991, "comment_id": 66276415, "body": "@Kaedys Adding a single <code>string</code> value was just an example, I could&#39;ve just used an <code>int</code> too. And if we&#39;re at it: a <code>string</code> is a read-only slice of bytes <i>in effect</i>, but it is not a slice. The language spec allows to treat it similar to a slice in many cases, but still <code>reflect.TypeOf(&quot;abc&quot;).Kind() == reflect.Slice</code> is <code>false</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 11, "last_activity_date": 1524134233, "last_edit_date": 1524134233, "creation_date": 1473784579, "answer_id": 39474991, "question_id": 39474715, "link": "https://stackoverflow.com/questions/39474715/slice-of-slices-with-different-types-in-golang/39474991#39474991", "title": "Slice of slices with different types in golang", "body": "<p>It works as expected, you're just using wrong syntax. The element type of the slice is <code>interface{}</code>, so a <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"noreferrer\">composite literal</a> to initialize it should look like <code>[]interface{}{ ... }</code>, like in this example:</p>\n\n<pre><code>featureVector := []interface{}{[]int{1, 2}, []float64{1.2, 2.2}, []string{\"a\", \"b\"}}\n</code></pre>\n\n<p>And you can treat it like any other slice:</p>\n\n<pre><code>featureVector = append(featureVector, []byte{'x', 'y'})\nfmt.Printf(\"%#v\", featureVector)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/RPy5RWkIrb\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[]interface{}{[]int{1, 2}, []float64{1.2, 2.2}, []string{\"a\", \"b\"}, []uint8{0x78, 0x79}}\n</code></pre>\n\n<p>But know that since the element type is <code>interface{}</code>, nothing prevents anybody to append a non-slice:</p>\n\n<pre><code>featureVector = append(featureVector, \"abc\") // OK\n</code></pre>\n\n<p>This also applies to the <code>map</code> solution.</p>\n"}], "owner": {"reputation": 2449, "user_id": 4313927, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/568720341/picture?type=large", "display_name": "Nicky Feller", "link": "https://stackoverflow.com/users/4313927/nicky-feller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11025, "favorite_count": 0, "accepted_answer_id": 39474991, "answer_count": 1, "score": 12, "last_activity_date": 1570895177, "creation_date": 1473783519, "last_edit_date": 1570895177, "question_id": 39474715, "link": "https://stackoverflow.com/questions/39474715/slice-of-slices-with-different-types-in-golang", "title": "Slice of slices with different types in golang", "body": "<p>Context: I want to use the slice data structure in golang to make a 2-D feature vector. This feature vector should be a slice that consists of slices of different types, sometimes strings, int, float64 etc.</p>\n\n<p>As of yet, I can achieve this with a map (below), is there a way to implement this with a slice?</p>\n\n<pre><code>map := make(map[int]interface{}}\n</code></pre>\n\n<p>What should be more like:</p>\n\n<pre><code>featureVector := []interface{[]int, []float64, []string ...}\n</code></pre>\n"}, {"tags": ["go", "compilation", "thrift"], "answers": [{"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 1, "last_activity_date": 1473798177, "creation_date": 1473798177, "answer_id": 39478414, "question_id": 39474687, "link": "https://stackoverflow.com/questions/39474687/thrift-compiler0-9-3-generates-function-thrift-prependerror-which-is-undefined/39478414#39478414", "title": "Thrift Compiler(0.9.3) Generates Function thrift.PrependError Which is Undefined In Thrift Package", "body": "<p>Prepend error was added in Thrift 0.9.3, and is present in the current codebase:</p>\n\n<p><a href=\"https://github.com/apache/thrift/blob/53dd39833a08ce33582e5ff31fa18bb4735d6731/lib/go/thrift/exception.go\" rel=\"nofollow\">https://github.com/apache/thrift/blob/53dd39833a08ce33582e5ff31fa18bb4735d6731/lib/go/thrift/exception.go</a></p>\n\n<p><a href=\"https://github.com/apache/thrift/commit/527b6d9c86a7e5cde14cbb09a0e3103be0791c3a#diff-d28b48f0840fec65d4a9ece357194970R32\" rel=\"nofollow\">https://github.com/apache/thrift/commit/527b6d9c86a7e5cde14cbb09a0e3103be0791c3a#diff-d28b48f0840fec65d4a9ece357194970R32</a></p>\n\n<p>If it isn't being found in your local library, you need to update your local (or vendored) version of Thrift.</p>\n\n<p>Remember, your thrift generator binary (in <code>/usr/local/bin/thrift</code>) can be a different version than the package you have in your <code>$GOPATH</code>.  Always make sure you update the two together.</p>\n"}, {"tags": [], "owner": {"reputation": 12067, "user_id": 499466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc0612ec9a2b6af96500cc6e4bfdc7c?s=128&d=identicon&r=PG", "display_name": "JensG", "link": "https://stackoverflow.com/users/499466/jensg"}, "is_accepted": false, "score": 1, "last_activity_date": 1473933746, "last_edit_date": 1473933746, "creation_date": 1473806129, "answer_id": 39479976, "question_id": 39474687, "link": "https://stackoverflow.com/questions/39474687/thrift-compiler0-9-3-generates-function-thrift-prependerror-which-is-undefined/39479976#39479976", "title": "Thrift Compiler(0.9.3) Generates Function thrift.PrependError Which is Undefined In Thrift Package", "body": "<blockquote>\n  <p>Should I use thrift compiler (0.9.2)?</p>\n</blockquote>\n\n<p>You should make sure and double-check <strong>that the version of the Thrift compiler matches the version of the Thrift library</strong> being used. The code generated by the Thrift compiler and the library code depend on each other, they are two pieces of the same puzzle. It does not matter what Thrift version you are using, as long as you are consistent.</p>\n\n<p>Aside from that, the curent stable is 0.9.3, this is also the recommended version.</p>\n"}], "owner": {"reputation": 141, "user_id": 3721292, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/64ad8586eb0d834812870a940c1c869f?s=128&d=identicon&r=PG&f=1", "display_name": "yskyj", "link": "https://stackoverflow.com/users/3721292/yskyj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 0, "accepted_answer_id": 39478414, "answer_count": 2, "score": 0, "last_activity_date": 1473933746, "creation_date": 1473783450, "last_edit_date": 1473802817, "question_id": 39474687, "link": "https://stackoverflow.com/questions/39474687/thrift-compiler0-9-3-generates-function-thrift-prependerror-which-is-undefined", "title": "Thrift Compiler(0.9.3) Generates Function thrift.PrependError Which is Undefined In Thrift Package", "body": "<p>I use <code>thrift</code> compiler (0.9.3) to generate gen-go folder, while the compiler generates a function <code>thrift.PrependError</code> which can't be found in <code>thrift</code> package (<code>git.apache.org/thrift.git/lib/go/thrift</code>). </p>\n\n<p>Should I use <code>thrift</code> compiler (0.9.2)?</p>\n"}, {"tags": ["go", "closures", "anonymous-function"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1473784785, "post_id": 39474647, "comment_id": 66269284, "body": "Can you make a standalone example (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)? What do you expect to happen, and what exactly are you seeing?"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 498660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b99b468b4bb0312235a1edf524b6e3c?s=128&d=identicon&r=PG", "display_name": "user498660", "link": "https://stackoverflow.com/users/498660/user498660"}, "is_accepted": true, "score": 0, "last_activity_date": 1473790779, "last_edit_date": 1473790779, "creation_date": 1473789810, "answer_id": 39476368, "question_id": 39474647, "link": "https://stackoverflow.com/questions/39474647/golang-anonymous-function-in-loop-issues-with-values-passed-as-arguments/39476368#39476368", "title": "Golang anonymous function in loop - issues with values passed as arguments", "body": "<p>In writing out the requested example I think I realized what my problem was. The various go routines were clobbering each others TTL settings when attempting to share the socket.</p>\n\n<p>Question withdrawn ;)</p>\n\n<p>Edit: To clarify, the right value was in fact being passed to the routines in either case. It was an underlying sharing of resources that was the problem.</p>\n"}], "owner": {"reputation": 21, "user_id": 498660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b99b468b4bb0312235a1edf524b6e3c?s=128&d=identicon&r=PG", "display_name": "user498660", "link": "https://stackoverflow.com/users/498660/user498660"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 760, "favorite_count": 0, "accepted_answer_id": 39476368, "answer_count": 1, "score": 0, "last_activity_date": 1473790779, "creation_date": 1473783285, "question_id": 39474647, "link": "https://stackoverflow.com/questions/39474647/golang-anonymous-function-in-loop-issues-with-values-passed-as-arguments", "title": "Golang anonymous function in loop - issues with values passed as arguments", "body": "<p>I had read various pages such as <a href=\"https://github.com/golang/go/wiki/CommonMistakes\" rel=\"nofollow\">https://github.com/golang/go/wiki/CommonMistakes</a> which outlined the issues with using closures and goroutines in a loop. As such I wrote my original loops as follows:</p>\n\n<pre><code>for outstanding &lt; threads {\n    ttl += 1;\n    outstanding += 1;\n    go func (ttl int, results chan Result) {\n        results &lt;- pw.SendTTL(ttl, dest)\n        results &lt;- pw.Recv(3)\n    }(ttl, results)\n}\n</code></pre>\n\n<p>Passing the changing TTL as an argument to the anonymous function. I ended up getting a random assortment of values over the range. Say if I was expecting 1-5 I'd get a couple 1's, a couple 3's, maybe a 4.</p>\n\n<p>So I tried the following, in case there was something about specifically using the variable instantiated by the loop. Yes I know I'm sort of abusing the for loop here...</p>\n\n<pre><code>for i := ttl; outstanding &lt; threads; i++ {\n    go func (ttl int, results chan Result) {\n        results &lt;- pw.SendTTL(ttl, dest)\n        results &lt;- pw.Recv(3)\n    }(i, results)\n    outstanding++;\n}\n</code></pre>\n\n<p>No joy. Same experience.</p>\n\n<p>I also tried the other suggested option where you use a local variable in the loop, and use that within the closure. Same experience.</p>\n\n<p>What am I doing wrong here? What boat did I miss?</p>\n"}, {"tags": ["http", "authentication", "go", "gerrit"], "comments": [{"owner": {"reputation": 2619, "user_id": 2249725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06905a0d11a7662cbadd4daffe029452?s=128&d=identicon&r=PG", "display_name": "mvndaai", "link": "https://stackoverflow.com/users/2249725/mvndaai"}, "reply_to_user": {"reputation": 11981, "user_id": 4653675, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--qAy9sY_FtU/AAAAAAAAAAI/AAAAAAAAAcI/1eUd0gZytXc/photo.jpg?sz=128", "display_name": "Marcelo &#193;vila de Oliveira", "link": "https://stackoverflow.com/users/4653675/marcelo-%c3%81vila-de-oliveira"}, "edited": false, "score": 0, "creation_date": 1473817397, "post_id": 39474284, "comment_id": 66281609, "body": "Every request I made just gave me a 401. I figure out how to make the request and will add an answer now."}], "answers": [{"comments": [{"owner": {"reputation": 1189, "user_id": 2634332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2eaac490041b2f3ccad6dec6eeacdd43?s=128&d=identicon&r=PG", "display_name": "Joppe", "link": "https://stackoverflow.com/users/2634332/joppe"}, "edited": false, "score": 0, "creation_date": 1485599539, "post_id": 39481441, "comment_id": 70999056, "body": "Isn&#39;t it: &quot;in the headers of the unauthorized response&quot;, you are meaning?"}, {"owner": {"reputation": 2619, "user_id": 2249725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06905a0d11a7662cbadd4daffe029452?s=128&d=identicon&r=PG", "display_name": "mvndaai", "link": "https://stackoverflow.com/users/2249725/mvndaai"}, "reply_to_user": {"reputation": 1189, "user_id": 2634332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2eaac490041b2f3ccad6dec6eeacdd43?s=128&d=identicon&r=PG", "display_name": "Joppe", "link": "https://stackoverflow.com/users/2634332/joppe"}, "edited": false, "score": 0, "creation_date": 1485756609, "post_id": 39481441, "comment_id": 71040118, "body": "You get back parts that you need to use to make the request. You then have to use them to make the request, but it isn&#39;t just a copy and paste."}, {"owner": {"reputation": 6391, "user_id": 2909897, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/LMSiW.jpg?s=128&g=1", "display_name": "mbigras", "link": "https://stackoverflow.com/users/2909897/mbigras"}, "edited": false, "score": 1, "creation_date": 1508539057, "post_id": 39481441, "comment_id": 80664046, "body": "import ( \t&quot;bytes&quot; \t&quot;crypto/md5&quot; \t&quot;crypto/rand&quot; \t&quot;encoding/hex&quot; \t&quot;fmt&quot; \t&quot;io&quot; \t&quot;io/ioutil&quot; \t&quot;log&quot; \t&quot;net/http&quot; \t&quot;strings&quot; )"}, {"owner": {"reputation": 443, "user_id": 5158845, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2eff4c21679d34a45c335d91940215c9?s=128&d=identicon&r=PG&f=1", "display_name": "gogofan", "link": "https://stackoverflow.com/users/5158845/gogofan"}, "edited": false, "score": 0, "creation_date": 1510262108, "post_id": 39481441, "comment_id": 81372681, "body": "@mvndaai Hey thanks for this source code! I am wondering if you have written a test for this?"}, {"owner": {"reputation": 2619, "user_id": 2249725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06905a0d11a7662cbadd4daffe029452?s=128&d=identicon&r=PG", "display_name": "mvndaai", "link": "https://stackoverflow.com/users/2249725/mvndaai"}, "reply_to_user": {"reputation": 443, "user_id": 5158845, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2eff4c21679d34a45c335d91940215c9?s=128&d=identicon&r=PG&f=1", "display_name": "gogofan", "link": "https://stackoverflow.com/users/5158845/gogofan"}, "edited": false, "score": 0, "creation_date": 1510262985, "post_id": 39481441, "comment_id": 81373120, "body": "@JeffreyYong sorry the don&#39;t have the project that I made this for anymore."}], "tags": [], "owner": {"reputation": 2619, "user_id": 2249725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06905a0d11a7662cbadd4daffe029452?s=128&d=identicon&r=PG", "display_name": "mvndaai", "link": "https://stackoverflow.com/users/2249725/mvndaai"}, "is_accepted": false, "score": 8, "last_activity_date": 1508652067, "last_edit_date": 1508652067, "creation_date": 1473818598, "answer_id": 39481441, "question_id": 39474284, "link": "https://stackoverflow.com/questions/39474284/how-do-you-do-a-http-post-with-digest-authentication-in-golang/39481441#39481441", "title": "How do you do a HTTP POST with digest authentication in Golang?", "body": "<p>I mostly followed what <a href=\"https://en.wikipedia.org/wiki/Digest_access_authentication\" rel=\"noreferrer\">Wikipedia</a> said about how to make a request then looked at the details of a verbose curl request to figure out the parts <code>curl -v --digest --user username:password http://url.com/api</code>. Here are the parts. You need to make a request, receive a 401 unauthorized, then compute an authorization header using MD5 sums based on the <code>nonce</code> and <code>realm</code> in the headers of the unauthorized request. </p>\n\n<pre><code>import (\n    \"bytes\"\n    \"crypto/md5\"\n    \"crypto/rand\"\n    \"encoding/hex\"\n    \"fmt\"\n    \"io\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"strings\"\n)\n\nfunc digestPost(host string, uri string, postBody []byte) bool {\n    url := host + uri\n    method := \"POST\"\n    req, err := http.NewRequest(method, url, nil)\n    req.Header.Set(\"Content-Type\", \"application/json\")\n    client := &amp;http.Client{}\n    resp, err := client.Do(req)\n    if err != nil {\n        panic(err)\n    }\n    defer resp.Body.Close()\n    if resp.StatusCode != http.StatusUnauthorized {\n        log.Printf(\"Recieved status code '%v' auth skipped\", resp.StatusCode)\n        return true\n    }\n    digestParts := digestParts(resp)\n    digestParts[\"uri\"] = uri\n    digestParts[\"method\"] = method\n    digestParts[\"username\"] = \"username\"\n    digestParts[\"password\"] = \"password\"\n    req, err = http.NewRequest(method, url, bytes.NewBuffer(postBody))\n    req.Header.Set(\"Authorization\", getDigestAuthrization(digestParts))\n    req.Header.Set(\"Content-Type\", \"application/json\")\n\n    resp, err = client.Do(req)\n    if err != nil {\n        panic(err)\n    }\n    defer resp.Body.Close()\n    if resp.StatusCode != http.StatusOK {\n        body, err := ioutil.ReadAll(resp.Body)\n        if err != nil {\n            panic(err)\n        }\n        log.Println(\"response body: \", string(body))\n        return false\n    }\n    return true\n}\n\nfunc digestParts(resp *http.Response) map[string]string {\n    result := map[string]string{}\n    if len(resp.Header[\"Www-Authenticate\"]) &gt; 0 {\n        wantedHeaders := []string{\"nonce\", \"realm\", \"qop\"}\n        responseHeaders := strings.Split(resp.Header[\"Www-Authenticate\"][0], \",\")\n        for _, r := range responseHeaders {\n            for _, w := range wantedHeaders {\n                if strings.Contains(r, w) {\n                    result[w] = strings.Split(r, `\"`)[1]\n                }\n            }\n        }\n    }\n    return result\n}\n\nfunc getMD5(text string) string {\n    hasher := md5.New()\n    hasher.Write([]byte(text))\n    return hex.EncodeToString(hasher.Sum(nil))\n}\n\nfunc getCnonce() string {\n    b := make([]byte, 8)\n    io.ReadFull(rand.Reader, b)\n    return fmt.Sprintf(\"%x\", b)[:16]\n}\n\nfunc getDigestAuthrization(digestParts map[string]string) string {\n    d := digestParts\n    ha1 := getMD5(d[\"username\"] + \":\" + d[\"realm\"] + \":\" + d[\"password\"])\n    ha2 := getMD5(d[\"method\"] + \":\" + d[\"uri\"])\n    nonceCount := 00000001\n    cnonce := getCnonce()\n    response := getMD5(fmt.Sprintf(\"%s:%s:%v:%s:%s:%s\", ha1, d[\"nonce\"], nonceCount, cnonce, d[\"qop\"], ha2))\n    authorization := fmt.Sprintf(`Digest username=\"%s\", realm=\"%s\", nonce=\"%s\", uri=\"%s\", cnonce=\"%s\", nc=\"%v\", qop=\"%s\", response=\"%s\"`,\n        d[\"username\"], d[\"realm\"], d[\"nonce\"], d[\"uri\"], cnonce, nonceCount, d[\"qop\"], response)\n    return authorization\n}\n</code></pre>\n"}], "owner": {"reputation": 2619, "user_id": 2249725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06905a0d11a7662cbadd4daffe029452?s=128&d=identicon&r=PG", "display_name": "mvndaai", "link": "https://stackoverflow.com/users/2249725/mvndaai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6388, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1508652067, "creation_date": 1473782024, "last_edit_date": 1473785661, "question_id": 39474284, "link": "https://stackoverflow.com/questions/39474284/how-do-you-do-a-http-post-with-digest-authentication-in-golang", "title": "How do you do a HTTP POST with digest authentication in Golang?", "body": "<p>I am trying to use the <a href=\"https://gerrit-review.googlesource.com/Documentation/rest-api.html#authentication\" rel=\"nofollow\">Gerrit API</a> that requires digest authentication. After reading up some I know I am supposed to make a request, get a 401, then use the realm and nonce and maybe other headers to then create the actual request authentication using MD5. I have found some examples on digest but they all seem to be the server side, not the client side.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6089431, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9lmfQMJorQM/AAAAAAAAAAI/AAAAAAAAAHQ/uFZss15KckI/photo.jpg?sz=128", "display_name": "Vincent Rasquier", "link": "https://stackoverflow.com/users/6089431/vincent-rasquier"}, "edited": false, "score": 0, "creation_date": 1473780535, "post_id": 39473601, "comment_id": 66266810, "body": "But why when I Do : n._lastRequest = *req \tfmt.Println(n._lastRequest)  Before the request I got the body and after the client.Do I lost it ?"}, {"owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "reply_to_user": {"reputation": 33, "user_id": 6089431, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9lmfQMJorQM/AAAAAAAAAAI/AAAAAAAAAHQ/uFZss15KckI/photo.jpg?sz=128", "display_name": "Vincent Rasquier", "link": "https://stackoverflow.com/users/6089431/vincent-rasquier"}, "edited": false, "score": 0, "creation_date": 1473780612, "post_id": 39473601, "comment_id": 66266861, "body": "Of course: sending the &quot;content&quot; of the <a href=\"https://en.wikipedia.org/wiki/Stream_(computing)\" rel=\"nofollow noreferrer\">stream</a> is done by reading from it."}], "tags": [], "owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "is_accepted": false, "score": 0, "last_activity_date": 1473780688, "last_edit_date": 1473780688, "creation_date": 1473779931, "answer_id": 39473601, "question_id": 39473493, "link": "https://stackoverflow.com/questions/39473493/golang-keep-a-trace-of-request-body-inside-http-request/39473601#39473601", "title": "Golang keep a trace of request &#39;body&#39; inside http.Request", "body": "<p>The Body isn't a string but a Reader (more specifically a <a href=\"https://golang.org/pkg/io/#ReadCloser\" rel=\"nofollow\">ReadCloser</a>). When you read some byte, you take it from the stream, you can't read it again.</p>\n\n<p>If you really need to intercept the Body before sending it, and can't read again from the source, a solution would be to read it into a buffer before reconstructing a new ReadCloser from the buffer.</p>\n\n<p><strong>EDIT:</strong> at this point I realize this is mostly a duplicate of <a href=\"https://stackoverflow.com/questions/23070876/reading-body-of-http-request-without-modifying-request-state\">Reading body of http.Request without modifying request state?</a> and I vote to close as such. I might delete the answer if it brings nothing.</p>\n"}], "owner": {"reputation": 33, "user_id": 6089431, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-9lmfQMJorQM/AAAAAAAAAAI/AAAAAAAAAHQ/uFZss15KckI/photo.jpg?sz=128", "display_name": "Vincent Rasquier", "link": "https://stackoverflow.com/users/6089431/vincent-rasquier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 418, "favorite_count": 0, "closed_date": 1473780262, "answer_count": 1, "score": 0, "last_activity_date": 1473780688, "creation_date": 1473779638, "question_id": 39473493, "link": "https://stackoverflow.com/questions/39473493/golang-keep-a-trace-of-request-body-inside-http-request", "closed_reason": "Duplicate", "title": "Golang keep a trace of request &#39;body&#39; inside http.Request", "body": "<p>My error is well explain here :\n<a href=\"https://github.com/golang/go/issues/17088\" rel=\"nofollow\">https://github.com/golang/go/issues/17088</a></p>\n\n<p>I don't know if it's a misunderstanding of the concept of http package but I fail to return the \"body\" (the parameters that my POST request send) of a request after the request is sent (client.Do) .. .</p>\n\n<p>Example :</p>\n\n<pre><code>func showRequestBody(r *http.Request) {\n  fmt.Println(r)\n  fmt.Println(r.Body)\n}\n</code></pre>\n\n<p>Give me an empty map or when I do : r.Form or r.PostForm it's nil or empty.</p>\n\n<p>Thanks :) (More info and great code highlight on the github link)</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 2, "creation_date": 1473777045, "post_id": 39472522, "comment_id": 66264468, "body": "Use <code>.*?</code> instead of the <code>.*</code> instead of the first two <code>.*</code>"}, {"owner": {"reputation": 5101, "user_id": 153586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bc43786cfcbc75521a28870e76759c1?s=128&d=identicon&r=PG", "display_name": "Sankar", "link": "https://stackoverflow.com/users/153586/sankar"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1473777498, "post_id": 39472522, "comment_id": 66264789, "body": "Thanks Wiktor. I was about to ping you as you have already answered some of my regex questions but could not find such an option in stackoverflow."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1473777685, "post_id": 39472522, "comment_id": 66264915, "body": "I think my first comment is a bit corrupt, I meant to say: <i>Use <code>.*?</code> (lazy quantifier) instead of the first two <code>.*</code></i>."}, {"owner": {"reputation": 5101, "user_id": 153586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bc43786cfcbc75521a28870e76759c1?s=128&d=identicon&r=PG", "display_name": "Sankar", "link": "https://stackoverflow.com/users/153586/sankar"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1473778943, "post_id": 39472522, "comment_id": 66265750, "body": "No worries. I got it working based on the answer in the duplicate link. Thanks for your help."}], "owner": {"reputation": 5101, "user_id": 153586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bc43786cfcbc75521a28870e76759c1?s=128&d=identicon&r=PG", "display_name": "Sankar", "link": "https://stackoverflow.com/users/153586/sankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "closed_date": 1473777004, "answer_count": 0, "score": 1, "last_activity_date": 1473776904, "creation_date": 1473776904, "question_id": 39472522, "link": "https://stackoverflow.com/questions/39472522/golang-regexp-break-after-first-match", "closed_reason": "Duplicate", "title": "golang regexp break after first match", "body": "<p>I have the following go code:</p>\n\n<pre><code>s := `prefix&lt;b&gt;Group ID:&lt;/b&gt;&lt;br/&gt;\nG123&lt;br/&gt;temporary&lt;br/&gt;suffix`\n\nre := regexp.MustCompile(`(?s)(.*)&lt;b&gt;Group ID:&lt;/b&gt;&lt;br/&gt;(.*)&lt;br/&gt;(.*)`)\n\nm := re.FindAllStringSubmatch(s, -1)\nfmt.Println(m[0][2])\n</code></pre>\n\n<p>playground link: <a href=\"https://play.golang.org/p/hz2kg7Pe2Z\" rel=\"nofollow\">https://play.golang.org/p/hz2kg7Pe2Z</a></p>\n\n<p>The above program prints <code>\\nG123&lt;br/&gt;temporary</code> because the last/second <code>&lt;br/&gt;</code> after the pattern is matched, as per the regex. Is there a way to get the first <code>&lt;br/&gt;</code> to be matched so that the output will be, just: <code>G123</code>. In addition to the first br match, the newline/whitespace in the beginning should also be stripped. Any suggestions ?</p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 1189, "user_id": 3931609, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/4n2cW.jpg?s=128&g=1", "display_name": "Kul", "link": "https://stackoverflow.com/users/3931609/kul"}, "edited": false, "score": 0, "creation_date": 1473778254, "post_id": 39472041, "comment_id": 66265293, "body": "I don&#39;t quite understand the question here. Is parsing the XML the problem or is it something else? You have a comment stating &#39;This is the part that differentiates the type of the section&#39; - can you give an example of how it can differ?"}, {"owner": {"reputation": 125, "user_id": 6826827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11205eb6e0d618234d5bf3e17ba3f98?s=128&d=identicon&r=PG&f=1", "display_name": "L.D.", "link": "https://stackoverflow.com/users/6826827/l-d"}, "reply_to_user": {"reputation": 1189, "user_id": 3931609, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/4n2cW.jpg?s=128&g=1", "display_name": "Kul", "link": "https://stackoverflow.com/users/3931609/kul"}, "edited": false, "score": 0, "creation_date": 1473787065, "post_id": 39472041, "comment_id": 66270418, "body": "If you look at the value of the id in the section it is different.  And I needed help creating the XML, but it&#39;s been solved now. Thanks for trying though!"}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 6826827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11205eb6e0d618234d5bf3e17ba3f98?s=128&d=identicon&r=PG&f=1", "display_name": "L.D.", "link": "https://stackoverflow.com/users/6826827/l-d"}, "edited": false, "score": 0, "creation_date": 1473785381, "post_id": 39474968, "comment_id": 66269595, "body": "Except I need to create the XML from the structs, not the other way around."}, {"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "reply_to_user": {"reputation": 125, "user_id": 6826827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11205eb6e0d618234d5bf3e17ba3f98?s=128&d=identicon&r=PG&f=1", "display_name": "L.D.", "link": "https://stackoverflow.com/users/6826827/l-d"}, "edited": false, "score": 0, "creation_date": 1473785578, "post_id": 39474968, "comment_id": 66269690, "body": "@L.D. oh, yeah sorry I missed that. Well the way I have those types looks like it should still work for making the xml. I&#39;ll add a bit to show that."}, {"owner": {"reputation": 125, "user_id": 6826827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11205eb6e0d618234d5bf3e17ba3f98?s=128&d=identicon&r=PG&f=1", "display_name": "L.D.", "link": "https://stackoverflow.com/users/6826827/l-d"}, "edited": false, "score": 0, "creation_date": 1473785660, "post_id": 39474968, "comment_id": 66269725, "body": "Thanks! Luckily, the actual parsing of the XMLs is handled in C# with XPaths. This is mainly a test harness."}, {"owner": {"reputation": 125, "user_id": 6826827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11205eb6e0d618234d5bf3e17ba3f98?s=128&d=identicon&r=PG&f=1", "display_name": "L.D.", "link": "https://stackoverflow.com/users/6826827/l-d"}, "edited": false, "score": 0, "creation_date": 1473787013, "post_id": 39474968, "comment_id": 66270385, "body": "You are amazing! Now to adapt this to the rest of the code. (There are instances of this in the fields I omitted inside the sections.)"}], "tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": true, "score": 1, "last_activity_date": 1473785779, "last_edit_date": 1473785779, "creation_date": 1473784511, "answer_id": 39474968, "question_id": 39472041, "link": "https://stackoverflow.com/questions/39472041/golang-xml-creation-with-same-tags/39474968#39474968", "title": "Golang XML Creation with same tags", "body": "<p>I don't know if this is a perfect answer but it's workable. The gist is to implement <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshaler\" rel=\"nofollow\">encoding/xml.Unmarshaler</a> on the <code>Component</code> type then inside that <code>UnmarshalXML</code> method you unmarshal the raw data of the section into a temporary value and inspect its ID before deciding if you want to unmarshal it into a <code>FooSection</code> or <code>BarSection</code></p>\n\n<p>These are the types I'm working with</p>\n\n<pre><code>type ID struct {\n    Value int    `xml:\"value,attr,omitempty\"`\n    Type  string `xml:\"valueType,attr,omitempty\"`\n}\n\ntype Document struct {\n    Components []Component `xml:\"SubDocument&gt;component\"`\n}\n\ntype Component struct {\n    Section interface{} `xml:\"section\"`\n}\n\ntype FooSection struct {\n    ID    ID     `xml:\"id\"`\n    Title string `xml:\"title\"`\n    Foo   string `xml:\"foo\"`\n}\n\ntype BarSection struct {\n    ID    ID     `xml:\"id\"`\n    Title string `xml:\"title\"`\n    Bar   string `xml:\"bar\"`\n}\n</code></pre>\n\n<p>Note that <code>Component</code> is storing its <code>Section</code> as just an <code>interface{}</code>. That is kind of annoying because you'll have to type switch it whenever you want to use it so you can probably do something better with that.</p>\n\n<p>Then the <code>UnmarshalXML</code> method is here</p>\n\n<pre><code>func (c *Component) UnmarshalXML(d *xml.Decoder, start xml.StartElement) error {\n\n    // tmp holds the data for this Component. We can only call d.DecodeElement\n    // once so we have to put it somewhere so it can be reused.\n    tmp := struct {\n        Data []byte `xml:\",innerxml\"`\n    }{}\n    if err := d.DecodeElement(&amp;tmp, &amp;start); err != nil {\n        return err\n    }\n\n    // which holds just enough information to tell us what kind of section to\n    // make. We'll unmarshal tmp.Data into this to inspect it\n    which := struct {\n        ID ID `xml:\"id\"`\n    }{}\n    if err := xml.Unmarshal(tmp.Data, &amp;which); err != nil {\n        return err\n    }\n\n    switch which.ID.Value {\n    case 0:\n        var f FooSection\n        if err := xml.Unmarshal(tmp.Data, &amp;f); err != nil {\n            return err\n        }\n        c.Section = f\n\n    case 1:\n        var b BarSection\n        if err := xml.Unmarshal(tmp.Data, &amp;b); err != nil {\n            return err\n        }\n        c.Section = b\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>Full working code <a href=\"https://play.golang.org/p/b2PEd2EcEk\" rel=\"nofollow\">on the playground</a>.</p>\n\n<hr>\n\n<p>Edit: These types should also work for generating the XML string as you actually were asking. When you're constructing each <code>Component</code> you should choose what kind of section to make and just stick it in there. Since it's a <code>interface{}</code> it can hold anything. I've updated my playground link to an example that shows turning those types back into a string works as expected.</p>\n"}], "owner": {"reputation": 125, "user_id": 6826827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11205eb6e0d618234d5bf3e17ba3f98?s=128&d=identicon&r=PG&f=1", "display_name": "L.D.", "link": "https://stackoverflow.com/users/6826827/l-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1228, "favorite_count": 0, "accepted_answer_id": 39474968, "answer_count": 1, "score": 2, "last_activity_date": 1473785779, "creation_date": 1473775400, "last_edit_date": 1473777106, "question_id": 39472041, "link": "https://stackoverflow.com/questions/39472041/golang-xml-creation-with-same-tags", "title": "Golang XML Creation with same tags", "body": "<p>So I've got this specific format for xml (industry standard) and I'm trying to create a simple program to allow us to make samples of this xml to test our services. I'm using the standard Go XML library.</p>\n\n<p>Problem is the XML is annoyingly formatted.\nHere's the simplified version of it:</p>\n\n<pre><code>&lt;Document&gt;\n  &lt;SubDocument&gt;\n    {other fields}\n    &lt;component&gt;\n         &lt;section&gt;\n             &lt;id value=\"0\" valueType=\"num\"/&gt; //This is the part that differentiates the type of the section\n             &lt;title&gt;Foo-Type Section&lt;/title&gt;\n             {other fields you lot don't need to care about}\n         &lt;/section&gt;\n    &lt;/component&gt;\n    &lt;component&gt;\n         &lt;section&gt;\n             &lt;id value=\"1\" valueType=\"num\"/&gt;\n             &lt;title&gt;Bar-Type Section&lt;/title&gt;\n             {more fields you don't need to care about, but most are different than above}\n         &lt;/section&gt;\n    &lt;/component&gt;\n    {more sections}\n  &lt;/SubDocument&gt;\n&lt;/Document&gt;\n</code></pre>\n\n<p>What I'm struggling with is that in Go, the tags on each section need to be unique if they are different struct types.</p>\n\n<p>I've the following Go code:</p>\n\n<pre><code>type HasID struct{\n    ID   string `xml:\"value,attr,omitempty\"`\n    IDType    string `xml:\"valueType,attr,omitempty\"`\n}\ntype FooSection struct{\n     ID   HasID `xml:\"id,omitempty\"`\n     Title string `xml:\"title,omitempty\"`\n     //Foo fields\n}\ntype BarSection struct{\n     ID   HasID `xml:\"id,omitempty\"`\n     Title string `xml:\"title,omitempty\"`\n     //Bar fields\n}\ntype Document struct{\n    XMLName  struct{} `xml:\"Document,omitempty\"`\n    //Other fields\n    Sections  []interface{} `xml:\"SubDocument&gt;component&gt;section,omitempty\"`\n}\n</code></pre>\n\n<p>I've also tried to have the Sections field have no tag and have both FooSection and BarSection have the </p>\n\n<pre><code>XMLName  struct{} `xml:\"component&gt;section,omitempty\"`\n</code></pre>\n\n<p>tag, to no avail. Furthermore, I've tried having Sections be an array of strings and then marshaled each section type, dumped those in and used the \",innerxml\" tag, but then it escapes the \"&lt;\", etc of the innerxml.</p>\n\n<p>Does anyone know a way to do this in Go? The structs are written by me and are completely open to change if need be.</p>\n\n<p>It might just be that I'm too entrenched in OO and am having trouble being Go-like.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "reflection", "slice"], "comments": [{"owner": {"reputation": 1521, "user_id": 1013731, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/41427402ce0ec49a8e6ebcb0e7008dfe?s=128&d=identicon&r=PG", "display_name": "Michael Sazonov", "link": "https://stackoverflow.com/users/1013731/michael-sazonov"}, "edited": false, "score": 1, "creation_date": 1473763391, "post_id": 39467591, "comment_id": 66255980, "body": "Downvoting without a comment? That&#39;s a nice feedback."}], "answers": [{"comments": [{"owner": {"reputation": 1521, "user_id": 1013731, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/41427402ce0ec49a8e6ebcb0e7008dfe?s=128&d=identicon&r=PG", "display_name": "Michael Sazonov", "link": "https://stackoverflow.com/users/1013731/michael-sazonov"}, "edited": false, "score": 0, "creation_date": 1473772922, "post_id": 39468423, "comment_id": 66261649, "body": "Your solution works like a charm. I do not really understand, why you need the <code>for</code> loop, but it works, rather than just <code>t := reflect.TypeOf(a)</code>. Could you point at an explanation maybe?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1521, "user_id": 1013731, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/41427402ce0ec49a8e6ebcb0e7008dfe?s=128&d=identicon&r=PG", "display_name": "Michael Sazonov", "link": "https://stackoverflow.com/users/1013731/michael-sazonov"}, "edited": false, "score": 0, "creation_date": 1473773223, "post_id": 39468423, "comment_id": 66261833, "body": "@MichaelSazonov If you start with the type <code>[]**MyModel</code>, <code>Elem()</code> will return you a type describing <code>**MyModel</code>. Calling <code>Elem()</code> again will return you <code>*MyModel</code>, and calling <code>Elem()</code> again you get <code>MyModel</code>. A call to <code>Elem()</code> strips one &quot;type-layer&quot; . You need a loop to remove all &quot;layers&quot; until what you have left is the &quot;bare&quot; type."}, {"owner": {"reputation": 1521, "user_id": 1013731, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/41427402ce0ec49a8e6ebcb0e7008dfe?s=128&d=identicon&r=PG", "display_name": "Michael Sazonov", "link": "https://stackoverflow.com/users/1013731/michael-sazonov"}, "edited": false, "score": 0, "creation_date": 1473773495, "post_id": 39468423, "comment_id": 66262011, "body": "As simple as that... Thank you very much!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1473772444, "last_edit_date": 1473772444, "creation_date": 1473764544, "answer_id": 39468423, "question_id": 39467591, "link": "https://stackoverflow.com/questions/39467591/get-type-of-an-uninitialized-slice/39468423#39468423", "title": "Get type of an uninitialized slice", "body": "<p>You may use <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"nofollow\"><code>Type.Elem()</code></a> to get the type's element type, which works for <code>Array</code>, <code>Chan</code>, <code>Map</code>, <code>Ptr</code> and <code>Slice</code>.</p>\n\n<p>You may run a loop and \"navigate\" to the type's element type until the type is not a pointer nor a slice (nor array, chan, map if you need so).</p>\n\n<p>So the simple solution is this:</p>\n\n<pre><code>func getElemType(a interface{}) reflect.Type {\n    for t := reflect.TypeOf(a); ; {\n        switch t.Kind() {\n        case reflect.Ptr, reflect.Slice:\n            t = t.Elem()\n        default:\n            return t\n        }\n    }\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>type MyModel struct{}\n\nfmt.Println(getElemType(MyModel{}))\nfmt.Println(getElemType(&amp;MyModel{}))\nfmt.Println(getElemType([]MyModel{}))\nfmt.Println(getElemType([]*MyModel{}))\nfmt.Println(getElemType(&amp;[]*MyModel{}))\nfmt.Println(getElemType(&amp;[]****MyModel{}))\nfmt.Println(getElemType(&amp;[][]**[]*[]***MyModel{}))\nvar p *[][]**[]*[]***MyModel\nfmt.Println(p) // It's nil!\nfmt.Println(getElemType(p))\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/qBW3EIN2Jl\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>main.MyModel\nmain.MyModel\nmain.MyModel\nmain.MyModel\nmain.MyModel\nmain.MyModel\nmain.MyModel\n&lt;nil&gt;\nmain.MyModel\n</code></pre>\n\n<p>As you can see, no matter how \"deep\" we go with slices and pointers (<code>&amp;[][]**[]*[]***MyModel{}</code>), <code>getElemType()</code> is able to extract <code>main.MyModel</code>.</p>\n\n<p>One thing to note is that in my solution I used <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"nofollow\"><code>reflect.Type</code></a> and not <a href=\"https://golang.org/pkg/reflect/#Value\" rel=\"nofollow\"><code>reflect.Value</code></a>. Go is a statically typed language, so the type information is there even if pointers and slice elements are not \"populated\", even if we pass a \"typed\" <code>nil</code> such as <code>p</code>, we're still able to navigate through the \"type chain\".</p>\n\n<p><strong>Note:</strong> The above <code>getElemType()</code> panics if called with an untyped <code>nil</code> value, e.g. <code>getElemType(nil)</code>, because in this case there is no type information available. To defend this, you may add a simple check:</p>\n\n<pre><code>if a == nil {\n    return nil\n}\n</code></pre>\n\n<p><strong>Note #2:</strong> Since the implementation contains a loop without limiting iteration count, values of recursive types will drive it into an endless loop, such as:</p>\n\n<pre><code>type RecType []RecType\ngetElemType(RecType{}) // Endless loop!\n</code></pre>\n"}], "owner": {"reputation": 1521, "user_id": 1013731, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/41427402ce0ec49a8e6ebcb0e7008dfe?s=128&d=identicon&r=PG", "display_name": "Michael Sazonov", "link": "https://stackoverflow.com/users/1013731/michael-sazonov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 1, "accepted_answer_id": 39468423, "answer_count": 1, "score": 1, "last_activity_date": 1473772444, "creation_date": 1473761933, "last_edit_date": 1473762972, "question_id": 39467591, "link": "https://stackoverflow.com/questions/39467591/get-type-of-an-uninitialized-slice", "title": "Get type of an uninitialized slice", "body": "<p>I want to return a type of an <code>interface{}</code>, while the input value might be <code>var m []*MyModel</code></p>\n\n<p>I've managed to get to the type <code>*MyModel</code>, while <code>MyModel</code> not as a pointer seems to be unreachable to me.</p>\n\n<pre><code>func getType( m interface{} ) reflect.Type {\n\n    t := reflect.TypeOf( m );   \n    v := reflect.ValueOf( m );\n\n    if t.Kind() == reflect.Ptr {    \n\n        if v.IsValid() &amp;&amp; !v.IsNil() {          \n            return getType( v.Elem().Interface() );         \n        }\n\n        panic( \"We have a problem\" );   \n\n    }\n\n    if t.Kind() == reflect.Slice {\n\n        if v.Len() == 0 {           \n\n            s := reflect.MakeSlice( t , 1 , 1 );            \n            return getType( s.Interface() );    \n\n        }\n\n        return getType( v.Index( 0 ).Interface() );\n\n    }\n\n    return t;\n\n}\n</code></pre>\n\n<p>Is it possible?</p>\n"}, {"tags": ["android", "go", "cmake", "ninja"], "comments": [{"owner": {"reputation": 16953, "user_id": 2799037, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2uPVa.png?s=128&g=1", "display_name": "usr1234567", "link": "https://stackoverflow.com/users/2799037/usr1234567"}, "edited": false, "score": 0, "creation_date": 1473770515, "post_id": 39467278, "comment_id": 66260181, "body": "Maybe there is no CMake? Just because CMake can produce ninja files and Andoid uses Ninja, too, does not mean CMake must be involved."}], "answers": [{"comments": [{"owner": {"reputation": 305, "user_id": 2002477, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1f282b727c1ae091c64637c6368b5979?s=128&d=identicon&r=PG&f=1", "display_name": "butter", "link": "https://stackoverflow.com/users/2002477/butter"}, "edited": false, "score": 1, "creation_date": 1473843450, "post_id": 39485923, "comment_id": 66290847, "body": "The CMake is not as what I thought to be an Android platform builder , it just for App developers in the develop kit right? Thanks for your attention on this newbie&#39;s question!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 305, "user_id": 2002477, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1f282b727c1ae091c64637c6368b5979?s=128&d=identicon&r=PG&f=1", "display_name": "butter", "link": "https://stackoverflow.com/users/2002477/butter"}, "edited": false, "score": 1, "creation_date": 1473846522, "post_id": 39485923, "comment_id": 66292691, "body": "@butter: Yes, You may build an Android NDK project with Cmake and create APK. See also: <a href=\"http://stackoverflow.com/tags/cmake/info\">stackoverflow.com/tags/cmake/info</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 2, "last_activity_date": 1473842375, "last_edit_date": 1495535358, "creation_date": 1473842064, "answer_id": 39485923, "question_id": 39467278, "link": "https://stackoverflow.com/questions/39467278/whats-cmake-doing-with-ninja-in-android-7-build-system/39485923#39485923", "title": "What&#39;s CMake doing with Ninja in Android 7 build system?", "body": "<blockquote>\n  <p>Starting in 2.2, Android Studio on 64 bit OS, supports building C/C++\n  via CMake and ndk-build through stable gradle.</p>\n  \n  <p>In both cases, Gradle is configured to point at the external build\n  system.  It interrogates the external build system to determine a list\n  of all C/C++ sources that are being built in the project and uses this\n  list to populate the Studio project, enabling editing and debugging\n  inside Studio while still using the external build system to compile\n  and link the C/C++ sources.</p>\n  \n  <p>There is a set of maintained CMake NDK samples\n  <a href=\"https://github.com/googlesamples/android-ndk/tree/master-cmake\" rel=\"nofollow noreferrer\">here</a>.</p>\n</blockquote>\n\n<p>ref: <a href=\"http://tools.android.com/tech-docs/external-c-builds\" rel=\"nofollow noreferrer\">http://tools.android.com/tech-docs/external-c-builds</a></p>\n\n<p>See: <a href=\"https://stackoverflow.com/questions/19207721/build-android-ndk-project-with-cmake\">Build Android NDK project with Cmake</a></p>\n"}], "owner": {"reputation": 305, "user_id": 2002477, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1f282b727c1ae091c64637c6368b5979?s=128&d=identicon&r=PG&f=1", "display_name": "butter", "link": "https://stackoverflow.com/users/2002477/butter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2710, "favorite_count": 1, "accepted_answer_id": 39485923, "answer_count": 1, "score": 1, "last_activity_date": 1473842730, "creation_date": 1473760953, "last_edit_date": 1473842730, "question_id": 39467278, "link": "https://stackoverflow.com/questions/39467278/whats-cmake-doing-with-ninja-in-android-7-build-system", "title": "What&#39;s CMake doing with Ninja in Android 7 build system?", "body": "<p>From the information I got, in the Android 7 build system : </p>\n\n<ul>\n<li>The Go provides a build support for the Soong.</li>\n<li>The Soong, instead of using make, loads the .bp/.mk files, and outputs .ninja files.</li>\n<li>The Ninja loads the .ninja files and builds the source code.</li>\n</ul>\n\n<p>And I also found in the <a href=\"https://cmake.org/cmake/help/v3.6/release/3.6.html\" rel=\"nofollow\">help page</a> that CMake includes a Ninja generator.</p>\n\n<p>EDIT :</p>\n\n<p>CMake is included in the <a href=\"https://android.googlesource.com/platform/prebuilts/cmake/linux-x86/\" rel=\"nofollow\">platform/prebuilts</a>, but not included in the <a href=\"https://android.googlesource.com/platform/manifest/+/android-7.0.0_r6\" rel=\"nofollow\">Android 7 manifests</a></p>\n\n<p>But I checked the android code again , there being so many CMakeLists.txt and CMake being called in some scripts under /external.</p>\n\n<pre><code>    ./external/clang/CMakeLists.txt:686:  get_cmake_property(variableNames VARIABLES)\n    ./external/clang/CMakeLists.txt:711:    ${cmake_3_1_EXCLUDE_FROM_ALL}\n    ./external/clang/CMakeLists.txt:725:    ${cmake_3_4_USES_TERMINAL_OPTIONS}\n    ./external/clang/CMakeLists.txt:734:    ${cmake_3_4_USES_TERMINAL}\n    ./external/clang/CMakeLists.txt:750:      ${cmake_3_4_USES_TERMINAL}\n    ./external/clang/runtime/CMakeLists.txt:28:    set(cmake_3_4_USES_TERMINAL_OPTIONS\n    ./external/clang/runtime/CMakeLists.txt:49:  get_cmake_property(variableNames VARIABLES)\n    ./external/clang/runtime/CMakeLists.txt:78:    ${cmake_3_4_USES_TERMINAL_OPTIONS}\n    ./external/dbus/cmake/cross-compile.sh\n    ./external/compiler-rt/lib/tsan/check_cmake.sh\n    ./external/opencv3/platforms/scripts/cmake_android_mips.sh\n    ./external/opencv3/platforms/scripts/cmake_arm_gnueabi_softfp.sh\n    ./external/opencv3/platforms/scripts/cmake_carma.sh\n    ./external/opencv3/platforms/scripts/cmake_android_x86.sh\n    ./external/opencv3/platforms/scripts/cmake_android_arm.sh\n    ./external/opencv3/platforms/scripts/cmake_arm_gnueabi_hardfp.sh\n    ./external/opencv3/platforms/scripts/cmake_android_service.sh\n    ./external/opencv3/samples/android/hello-android/cmake_android.sh\n</code></pre>\n\n<p>Also, CMake exist under folder</p>\n\n<pre><code>    butter@server131:~/code/AOSP/N$ find ./ -name \"cmake\"\n    ./prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.15-4.8/sysroot/usr/lib/cmake\n    ./prebuilts/gcc/linux-x86/host/x86_64-linux-glibc2.15-4.8/sysroot/usr/lib32/cmake\n    ./external/dbus/cmake\n    ./external/llvm/cmake\n    ./external/compiler-rt/cmake\n    ./external/deqp/framework/delibs/cmake\n    ./external/eigen/cmake\n    ./external/eigen/bench/btl/cmake\n    ./external/ceres-solver/cmake\n    ./external/google-benchmark/cmake\n    ./external/libcxx/cmake\n    ./external/libcxxabi/cmake\n    ./external/opencv3/platforms/ios/cmake\n    ./external/opencv3/cmake\n    ./external/clang/cmake\n    ./external/google-breakpad/src/testing/gtest/cmake\n    ./external/libunwind_llvm/cmake\n    ./external/pcre/dist/cmake\n</code></pre>\n\n<p>So if the Soong could generate .ninja files , what is CMake's role in the Android 7 build system?   Just an alternative choice or just not fully replaced by the Soong yet? </p>\n"}, {"tags": ["debugging", "go", "ide"], "comments": [{"owner": {"reputation": 9712, "user_id": 66907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f45da391d77044534895e4dd3770ffd2?s=128&d=identicon&r=PG", "display_name": "Sascha", "link": "https://stackoverflow.com/users/66907/sascha"}, "edited": false, "score": 0, "creation_date": 1473760441, "post_id": 39466975, "comment_id": 66254299, "body": "This is more a question that asks for tooling. This is not regarded as a good question. At least show what you have tried. A simple search reveals  <a href=\"https://www.leaseweb.com/labs/2014/06/debugging-golang-using-liteide-on-ubuntu-14-04/\" rel=\"nofollow noreferrer\">leaseweb.com/labs/2014/06/&hellip;</a>. That article shows how to use LiteIDE with golang"}, {"owner": {"reputation": 120, "user_id": 6825671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a40892849d1da401dc6773b5f54aecc?s=128&d=identicon&r=PG&f=1", "display_name": "Andriian", "link": "https://stackoverflow.com/users/6825671/andriian"}, "reply_to_user": {"reputation": 9712, "user_id": 66907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f45da391d77044534895e4dd3770ffd2?s=128&d=identicon&r=PG", "display_name": "Sascha", "link": "https://stackoverflow.com/users/66907/sascha"}, "edited": false, "score": 0, "creation_date": 1473856671, "post_id": 39466975, "comment_id": 66298786, "body": "@Sascha, thank you for your answer. It&#39;s clear how to debug regular Go application but it&#39;s not clear how to use it in hyperledger chaincode specific case. And, more specifically, when set up is done in the way of Option 1 which is described in the doc.  In the setup we use Windows like host OS (optionally) and Ubuntu (by Vagrant virtualization) for running chaincode itself.  Is it possible to use LiteIDE debug in that case? Or should I run LiteIDE and Go chaincode in the same OS? There should be developers who tried chaincode debugging and faced similar issues."}], "owner": {"reputation": 120, "user_id": 6825671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a40892849d1da401dc6773b5f54aecc?s=128&d=identicon&r=PG&f=1", "display_name": "Andriian", "link": "https://stackoverflow.com/users/6825671/andriian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 755, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1473782936, "creation_date": 1473760063, "last_edit_date": 1473782936, "question_id": 39466975, "link": "https://stackoverflow.com/questions/39466975/how-do-i-debug-in-liteide-with-breakpoints-step-into-step-over-etc", "title": "How do I debug in LiteIDE with breakpoints, step into, step over, etc?", "body": "<p>I would like to know it there is a way to run debug for Go chaincode in LiteIDE (or any other) and be able to use some standard features like breakpoints in the code,  Step Into &amp; Step Over commands, watch variables as any step, etc. \nIn some other environments it is possible to attach IDE to some process for debugging with all that features.</p>\n\n<hr>\n\n<p>Background:</p>\n\n<p>I'm new to Go and IBM Hyperledger and now I'm trying to clarify the question in the Title.</p>\n\n<p>Prerequisites:</p>\n\n<ol>\n<li>I've completed chaincode setup by the Option 1 (using Vagrant) in the tutorial: <a href=\"http://hyperledger-fabric.readthedocs.io/en/latest/Setup/Chaincode-setup/\" rel=\"nofollow\">http://hyperledger-fabric.readthedocs.io/en/latest/Setup/Chaincode-setup/</a></li>\n<li>I'm able to write, build, deploy and invoke Go chaincode to the peer which is run with --peer-chaincodedev flag.</li>\n<li>My OS is Windows 8 and Ubunty 14.04.4 LTS runs in Vagrant</li>\n<li>I use LiteIDE for Go chaincode development</li>\n</ol>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1473759061, "last_edit_date": 1473759061, "creation_date": 1473756493, "answer_id": 39465818, "question_id": 39465504, "link": "https://stackoverflow.com/questions/39465504/how-to-work-with-non-required-json-parameters-in-go/39465818#39465818", "title": "How to work with non required JSON parameters in Go?", "body": "<p>When unmarshalling a value from JSON text, the <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow\"><code>json</code></a> package does not require that all fields to be present in JSON, nor that all JSON fields have a matching Go field.</p>\n\n<p>So you don't have anything special to do, just unmarshal what you have to a Go value what you want or may want.</p>\n\n<p>One thing to note is that if a field is missing in the JSON text, the <code>json</code> package will not change the corresponding Go field, so if you start with a \"fresh\", <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow\">zero value</a>, the field will be left with the zero value of its type.</p>\n\n<p>Most of the time this is enough to detect the presence or absence of a field (in JSON), for example if in the Go struct you have a <code>SortBy</code> field of type <code>string</code>, if this is missing in JSON, it will remain the empty <code>string</code>: <code>\"\"</code>.</p>\n\n<p>If the zero value is something useful and valid, then you may turn to use pointers. For example if in your application the empty <code>string</code> would be a valid <code>SortBy</code> value, you may declare this field to be a pointer: <code>*string</code>. And in this case if it's missing in the JSON text, it will remain <code>nil</code>, the zero value for any pointer type.</p>\n\n<p>See this example:</p>\n\n<pre><code>type Data struct {\n    I int\n    S string\n    P *string\n}\n\nfunc main() {\n    var d Data\n    var err error\n\n    d, err = Data{}, nil\n    err = json.Unmarshal([]byte(`{\"I\":1, \"S\":\"sv\", \"P\":\"pv\"}`), &amp;d)\n    fmt.Printf(\"%#v %v\\n\", d, err)\n\n    d, err = Data{}, nil\n    err = json.Unmarshal([]byte(`{\"I\":1}`), &amp;d)\n    fmt.Printf(\"%#v %v\\n\", d, err)\n\n    d, err = Data{}, nil\n    err = json.Unmarshal([]byte(`{\"S\":\"abc\"}`), &amp;d)\n    fmt.Printf(\"%#v %v\\n\", d, err)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/vszUWmqZTf\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>main.Data{I:1, S:\"sv\", P:(*string)(0x1050a150)} &lt;nil&gt;\nmain.Data{I:1, S:\"\", P:(*string)(nil)} &lt;nil&gt;\nmain.Data{I:0, S:\"abc\", P:(*string)(nil)} &lt;nil&gt;\n</code></pre>\n"}], "owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 1, "accepted_answer_id": 39465818, "answer_count": 1, "score": 1, "last_activity_date": 1473759061, "creation_date": 1473755498, "last_edit_date": 1473757367, "question_id": 39465504, "link": "https://stackoverflow.com/questions/39465504/how-to-work-with-non-required-json-parameters-in-go", "title": "How to work with non required JSON parameters in Go?", "body": "<p>Hi I am working on a rest API in Go and I want the user to pass JSON parameters:</p>\n\n<pre><code>Offset int64  `json:\"offset\"`\nLimit  int64  `json:\"limit\"`\nSortBy string `json:\"sortby\"`\nAsc    bool   `json:\"asc\"`\nUsername   string `json:\"username\"`\nFirst_Name string `json:\"first_name\"`\nLast_Name  string `json:\"last_name\"`\nStatus     string `json:\"status\"`\n</code></pre>\n\n<p>But they are not always required so for example a user can pass only <code>Offset</code> and ignore the others. He can even send 0 parameters. How can I do this?</p>\n"}, {"tags": ["go", "mgo", "mangodb"], "comments": [{"owner": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "edited": false, "score": 0, "creation_date": 1473769940, "post_id": 39464370, "comment_id": 66259806, "body": "You&#39;d better use <code>$unwind</code> to unfold the array and <code>$match</code> to filter out the required &quot;leave&quot; from there on"}, {"owner": {"reputation": 157, "user_id": 5024301, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/836491216400010/picture?type=large", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/5024301/rajesh-kumar"}, "reply_to_user": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "edited": false, "score": 0, "creation_date": 1473905861, "post_id": 39464370, "comment_id": 66321779, "body": "Thanks.Implemented and got the desired result.Will post the answer now.Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 5024301, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/836491216400010/picture?type=large", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/5024301/rajesh-kumar"}, "edited": false, "score": 0, "creation_date": 1473906039, "post_id": 39466490, "comment_id": 66321806, "body": "Thanks for your reply.I found that by implementing the $unwind,$match,$project this can be implemented.Now i have got the result that i need.Once Again thanks for your effort.....I will post my answer now.Thanks"}], "tags": [], "owner": {"reputation": 11, "user_id": 6825757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GVQJC.jpg?s=128&g=1", "display_name": "Alexandre Thomas", "link": "https://stackoverflow.com/users/6825757/alexandre-thomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1473758646, "creation_date": 1473758646, "answer_id": 39466490, "question_id": 39464370, "link": "https://stackoverflow.com/questions/39464370/retrieving-elements-from-embedded-array-in-mgogolangmangodb/39466490#39466490", "title": "Retrieving elements from embedded array in mgo(golang+MangoDB)", "body": "<p>I am not sure that what you ask is possible in a single mongo query. I would rather get all\nelements and the filter in go with something like this:</p>\n\n<pre><code>var result []*Employee\nerr := c.Find(nil).All(&amp;result)\nif err != nil {\n    // do stuff...\n}\n\n// For each result, filter the Leave values having a to small From value.\nt := time.Date(2016, 10, 1, 0, 0, 0, 0, time.UTC)\nfor i := range result {\n    var j int\n    for j &lt; len(result[i].Leave) {\n        if result[i][j].From.Before(t) {\n            result[i] = append(result[i][:j], result[i][j+1:]...)\n            continue\n        }\n        j++\n    }\n}       \n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 5024301, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/836491216400010/picture?type=large", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/5024301/rajesh-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482761933, "creation_date": 1473751551, "last_edit_date": 1482761933, "question_id": 39464370, "link": "https://stackoverflow.com/questions/39464370/retrieving-elements-from-embedded-array-in-mgogolangmangodb", "title": "Retrieving elements from embedded array in mgo(golang+MangoDB)", "body": "<p>I'm using golang in the backend and mongoDB as database. When I try to retrieve documents from one of the embedded array I'm getting only one index of the embedded array in the result as the result.</p>\n\n<p>My struct is like this</p>\n\n<pre><code>type (\n    Employee struct {\n        Name           string\n        EmpId          string\n        Password       string\n        Leave        []*LeaveInfo\n    }\nLeaveInfo struct {\n\n        Id              int\n        Days            float64\n        From            time.Time\n        To              time.Time\n        AppliedDate     time.Time\n        Status          string\n        ApprovedDate    time.Time\n    }\n</code></pre>\n\n<p>My golang code is </p>\n\n<pre><code>   t := time.Date(2016, 10, 1, 0, 0, 0, 0, time.UTC)\n    var result []*Employee\n        if e := c.Find(nil).Select(bson.M{\"leave\": bson.M{\n            \"$elemMatch\": bson.M{\n                \"from\": bson.M{\n               \"$gte\":t, \n    },\n            },\n        },\n        },\n        ).All(&amp;result); e != nil {\n            fmt.Println(e)\n}\n</code></pre>\n\n<p>My database structure is </p>\n\n<pre><code>_id:57d7a6673897593ae84bed49{\nName:\"Mark\"\nEmpId:\"E123\"\nPassword:1234\nLeave:[\n{\n    \"id\" : 0,\n    \"days\" : 1.5,\n    \"from\" : ISODate(\"2016-12-01T00:00:00Z\"),\n    \"to\"   : ISODate(\"2016-12-02T12:00:00Z\"),\n    \"applieddate\" : ISODate(\"0001-01-01T00:00:00Z\"),\n    \"status\" : \"Approved\",\n    \"approveddate\" : ISODate(\"0001-01-01T00:00:00Z\"),\n\n  },\n{\n\n    \"id\" : 1,\n    \"days\" : 2.0,\n    \"from\" : ISODate(\"2016-12-11T00:00:00Z\"),\n    \"to\" : ISODate(\"2016-12-12T00:00:00Z\"),\n    \"applieddate\" : ISODate(\"0001-01-01T00:00:00Z\"),\n    \"status\" : \"Approved\",\n    \"approveddate\" : ISODate(\"0001-01-01T00:00:00Z\"),\n\n  },\n]\n}\n</code></pre>\n\n<p>In this I m getting only the index 0 of the Leave array.As you can see both the index of the array have date greater than t.But when i retreive it I m getting only one index (index 0).But what i need is to retreive all the index which has date greater than t.Please help me.thanks</p>\n\n<p>My result is as follows </p>\n\n<pre><code>{\n    \"Name\": \"\",\n\n    \"EmpId\": \"\",\n    \"Password\": \"\",\n\"Leave\": [\n      {\n\n        \"Id\": 0,\n        \"Days\": 1.5,\n        \"from\" : ISODate(\"2016-12-01T00:00:00Z\"),\n        \"to\"   : ISODate(\"2016-12-02T12:00:00Z\"),\n        \"applieddate\" : ISODate(\"0001-01-01T00:00:00Z\"),\n        \"status\" : \"Approved\",\n        \"approveddate\" : ISODate(\"0001-01-01T00:00:00Z\"),\n      }\n    ]\n}\n</code></pre>\n"}, {"tags": ["json", "parsing", "curl", "go", "json-web-token"], "answers": [{"comments": [{"owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 0, "creation_date": 1473727285, "post_id": 39460624, "comment_id": 66242228, "body": "Is there any more information that I could give to you that would point to the origin of this error?"}, {"owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "reply_to_user": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 0, "creation_date": 1473728526, "post_id": 39460624, "comment_id": 66242478, "body": "Can you describe how you&#39;re creating the key?"}, {"owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 0, "creation_date": 1473739649, "post_id": 39460624, "comment_id": 66244845, "body": "I have added the process I used to generate the token, Thanks!"}, {"owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "reply_to_user": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 0, "creation_date": 1473741335, "post_id": 39460624, "comment_id": 66245291, "body": "you know what, maybe it does work if you just remove bearer. I can&#39;t tell because I don&#39;t have the public key from the example"}, {"owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 0, "creation_date": 1473750676, "post_id": 39460624, "comment_id": 66248720, "body": "I forgot to mention that I had already tried that, It gives me exactly the same error?"}], "tags": [], "owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "is_accepted": true, "score": 3, "last_activity_date": 1473727121, "creation_date": 1473727121, "answer_id": 39460624, "question_id": 39460330, "link": "https://stackoverflow.com/questions/39460330/invalid-json-web-token-in-go/39460624#39460624", "title": "Invalid Json web token in Go", "body": "<p>The error returned by <code>jwt.Parse()</code> says </p>\n\n<blockquote>\n  <p>tokenstring should not contain 'bearer '</p>\n</blockquote>\n\n<p>So if you remove \"Bearer \":</p>\n\n<pre><code>jwtString = strings.Split(jwtString, \"Bearer \")[1]\n</code></pre>\n\n<p>you get a bit further</p>\n\n<blockquote>\n  <p>The token has been successfully returned</p>\n</blockquote>\n\n<p>however now there's a new error:</p>\n\n<blockquote>\n  <p>key is of invalid type</p>\n</blockquote>\n\n<p>Sorry it's not a complete answer!</p>\n"}, {"tags": [], "owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "is_accepted": false, "score": 0, "last_activity_date": 1564429525, "creation_date": 1564429525, "answer_id": 57260495, "question_id": 39460330, "link": "https://stackoverflow.com/questions/39460330/invalid-json-web-token-in-go/57260495#57260495", "title": "Invalid Json web token in Go", "body": "<blockquote>\n  <p>key is of invalid type</p>\n</blockquote>\n\n<p><em>type</em> in this context is referring to the dynamic data-type in Go.</p>\n\n<p>For <code>SigningMethodRSA</code>, the public key must be of type <code>*rsa.PublicKey</code> which can be constructed by calling <code>jwt.ParseRSAPublicKeyFromPEM()</code>.</p>\n\n<p>The key value returned to the parser might be created with something like:</p>\n\n<pre><code>keyStruct, _ := jwt.ParseRSAPublicKeyFromPEM(myPublicKeyString)\n</code></pre>\n\n<p>See: </p>\n\n<ul>\n<li><a href=\"https://github.com/dgrijalva/jwt-go#signing-methods-and-key-types\" rel=\"nofollow noreferrer\">https://github.com/dgrijalva/jwt-go#signing-methods-and-key-types</a></li>\n<li><a href=\"https://godoc.org/github.com/dgrijalva/jwt-go#SigningMethodRSA\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/dgrijalva/jwt-go#SigningMethodRSA</a></li>\n<li><a href=\"https://godoc.org/github.com/dgrijalva/jwt-go#ParseRSAPublicKeyFromPEM\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/dgrijalva/jwt-go#ParseRSAPublicKeyFromPEM</a></li>\n</ul>\n\n<p>Related: </p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/51471802/86967\">How to generate JWT token always through invalid key type error</a></li>\n</ul>\n"}], "owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1640, "favorite_count": 1, "accepted_answer_id": 39460624, "answer_count": 2, "score": 2, "last_activity_date": 1564429525, "creation_date": 1473724202, "last_edit_date": 1473750798, "question_id": 39460330, "link": "https://stackoverflow.com/questions/39460330/invalid-json-web-token-in-go", "title": "Invalid Json web token in Go", "body": "<p>I am trying to make a Json web token authentication system with Go however I cant seem to get the parsing of the web token working.\nThe error occurs in the following function.</p>\n\n<pre><code>func RequireTokenAuthentication(rw http.ResponseWriter, req *http.Request, next http.HandlerFunc) {\nauthBackend := InitJWTAuthenticationBackend()\n\njwtString := req.Header.Get(\"Authorization\")\n\n\ntoken, err := jwt.Parse(jwtString, func(token *jwt.Token) (interface{}, error) {\n    if _, ok := token.Method.(*jwt.SigningMethodRSA); !ok {\n        log.Println(\"Unexpected signing method\")\n        return nil, fmt.Errorf(\"Unexpected signing method: %v\", token.Header[\"alg\"])\n    } else {\n        log.Println(\"The token has been successfully returned\")\n        return authBackend.PublicKey, nil\n    }\n})\n\nlog.Println(token)\nlog.Println(token.Valid)\n\nif err == nil &amp;&amp; token.Valid &amp;&amp; !authBackend.IsInBlacklist(req.Header.Get(\"Authorization\")) {\n    next(rw, req)\n} else {\n    rw.WriteHeader(http.StatusUnauthorized)\n    log.P\n\nrintln(\"Status unauthorized RequireTokenAuthentication\")\n    }\n}\n</code></pre>\n\n<p>returns the following log</p>\n\n<pre><code>[negroni] Started GET /test/hello\n2016/09/13 01:34:46 &amp;{Bearer eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0NzM5NzQ4OTAsImlhdCI6MTQ3MzcxNTY5MCwic3ViIjoiIn0.mnwEwdR8nuvdLo_4Ie43me7iph2LeSj1uikokgD6VJB7isjFPShN8E7eQr4GKwuIiLTi34_i6iJRpmx9qrPugkzvsoxX44qlFi6M7FDhVySRiYbBQwTCvKCpvhnsK8BHJyEgy813aaxOMK6sKZJoaKs5JYUvnNZdNqmENYj1BM6FdbGP-oLHuR_CJK0Pym1NMhv9zLI1rpJOGu4mfj1t4tHYZAEGirPnzYMamtrK6TyEFE6Xi4voEEadq7hXvWREg6wNSQsYgww8uOaIWLy1yLbhTkPmT8zfRwLLYLqS_UuZ0xIaSWO1mF2plvOzz1WlF3ZEHLS31T1egB1XL4WTNQe &lt;nil&gt; map[] &lt;nil&gt;  false}\n2016/09/13 01:34:46 false\n2016/09/13 01:34:46 Status unauthorized RequireTokenAuthentication\n[negroni] Completed 401 Unauthorized in 71.628ms\n</code></pre>\n\n<p>and here is the cURL that I am using to initiate it</p>\n\n<pre><code>curl -H \"Authorization: Bearer eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0NzM5NzQ4OTAsImlhdCI6MTQ3MzcxNTY5MCwic3ViIjoiIn0.mnwEwdR8nuvdLo_4Ie43me7iph2LeSj1uikokgD6VJB7isjFPShN8E7eQr4GKwuIiLTi34_i6iJRpmx9qrPugkzvsoxX44qlFi6M7FDhVySRiYbBQwTCvKCpvhnsK8BHJyEgy813aaxOMK6sKZJoaKs5JYUvnNZdNqmENYj1BM6FdbGP-oLHuR_CJK0Pym1NMhv9zLI1rpJOGu4mfj1t4tHYZAEGirPnzYMamtrK6TyEFE6Xi4voEEadq7hXvWREg6wNSQsYgww8uOaIWLy1yLbhTkPmT8zfRwLLYLqS_UuZ0xIaSWO1mF2plvOzz1WlF3ZEHLS31T1egB1XL4WTNQe\" http://localhost:5000/test/hello\n</code></pre>\n\n<p>I have also tried curl without <code>Bearer</code></p>\n\n<pre><code>curl -H \"Authorization:eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0NzM5NzQ4OTAsImlhdCI6MTQ3MzcxNTY5MCwic3ViIjoiIn0.mnwEwdR8nuvdLo_4Ie43me7iph2LeSj1uikokgD6VJB7isjFPShN8E7eQr4GKwuIiLTi34_i6iJRpmx9qrPugkzvsoxX44qlFi6M7FDhVySRiYbBQwTCvKCpvhnsK8BHJyEgy813aaxOMK6sKZJoaKs5JYUvnNZdNqmENYj1BM6FdbGP-oLHuR_CJK0Pym1NMhv9zLI1rpJOGu4mfj1t4tHYZAEGirPnzYMamtrK6TyEFE6Xi4voEEadq7hXvWREg6wNSQsYgww8uOaIWLy1yLbhTkPmT8zfRwLLYLqS_UuZ0xIaSWO1mF2plvOzz1WlF3ZEHLS31T1egB1XL4WTNQe\" http://localhost:5000/test/hello\n</code></pre>\n\n<p>The error is occurring because the token is invalid <code>token.Valid = false</code> I have generated it using the following process.</p>\n\n<p>Here is the router</p>\n\n<pre><code>router.HandleFunc(\"/token-auth\", controllers.Login).Methods(\"POST\")\n</code></pre>\n\n<p>Here is the login controller</p>\n\n<pre><code>    func Login(w http.ResponseWriter, r *http.Request) {\n    requestUser := new(models.User)\n    decoder := json.NewDecoder(r.Body)\n    decoder.Decode(&amp;requestUser)    \n    responseStatus, token := utils.Login(requestUser) //here the util file seen below is used\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    w.WriteHeader(responseStatus)\n    w.Write(token)\n\n}\n</code></pre>\n\n<p>This is the util file</p>\n\n<pre><code>    func Login(requestUser *models.User) (int, []byte) {\n        authBackend := authentication.InitJWTAuthenticationBackend()\n\n        if authBackend.Authenticate(requestUser) {\n            token, err := authBackend.GenerateToken(requestUser.UUID)\n            if err != nil {\n                return http.StatusInternalServerError, []byte(\"\")\n            } else {\n                response, _ := json.Marshal(parameters.TokenAuthentication{token})\n                return http.StatusOK, response\n            }\n        }\n        return http.StatusUnauthorized, []byte(\"\")\n    }\n</code></pre>\n\n<p>and here is the method used to generate the token</p>\n\n<pre><code>    func (backend *JWTAuthenticationBackend) GenerateToken(userUUID string) (string, error) {\n    token := jwt.New(jwt.SigningMethodRS512)\n\n    claims := token.Claims.(jwt.MapClaims)\n\n    claims[\"exp\"] = time.Now().Add(time.Hour * time.Duration(settings.Get().JWTExpirationDelta)).Unix()\n    claims[\"iat\"] = time.Now().Unix()\n    claims[\"sub\"] = userUUID\n\n    tokenString, err := token.SignedString(backend.privateKey)\n    if err != nil {\n        panic(err)\n        return \"\", err\n    }\n\n    return tokenString, nil\n}\n</code></pre>\n\n<p>How do I fix the Token Parsing system so that the token is valid?\nIf you need any additional information I would be more than happy to make an edit with the respective information.\nThank</p>\n"}, {"tags": ["sql", "postgresql", "go"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1473723532, "post_id": 39460205, "comment_id": 66241534, "body": "Unrelated: you do not need the scalar subquery."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1473762735, "post_id": 39460205, "comment_id": 66255650, "body": "I thought Postgres only works with numbered placeholders, i.e. <code>$1</code>."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1473776197, "post_id": 39460205, "comment_id": 66263903, "body": "What driver package are you using to work with pgsql? You know, Go does not include drivers for any RDBMS in its standard library, so it&#39;s essential to tell us what you&#39;re doing. If you&#39;re using <code>github.com&#47;lib&#47;pq</code>, <a href=\"https://godoc.org/github.com/lib/pq\" rel=\"nofollow noreferrer\">the docs</a> mention only <code>$n</code>-style parameters, as @Ainar-G suggested. IOW, formats of query placeholders are driver-specific, not something universal."}, {"owner": {"reputation": 2071, "user_id": 2128461, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d16f5d2ad004ea827c463cb650f552ce?s=128&d=identicon&r=PG&f=1", "display_name": "jazzblue", "link": "https://stackoverflow.com/users/2128461/jazzblue"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1473789384, "post_id": 39460205, "comment_id": 66271709, "body": "@kostix: thanks, I am, indeed, using pq"}], "answers": [{"tags": [], "owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "is_accepted": false, "score": 0, "last_activity_date": 1473723775, "creation_date": 1473723775, "answer_id": 39460280, "question_id": 39460205, "link": "https://stackoverflow.com/questions/39460205/postgresql-argument-placeholder-does-not-work-for-with/39460280#39460280", "title": "PostgreSQL &quot;?&quot; argument placeholder does not work for &quot;WITH&quot;", "body": "<p>Go doesn't support this at of the box.</p>\n\n<p>You can use <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow\">jmoiron/sqlx</a> if you want this functional</p>\n\n<p>example using sqlx (from <a href=\"https://jmoiron.github.io/sqlx/\" rel=\"nofollow\">docs</a>):</p>\n\n<pre><code>var levels = []int{4, 6, 7}\nquery, args, err := sqlx.In(\"SELECT * FROM users WHERE level IN (?);\", levels)\n\n// sqlx.In returns queries with the `?` bindvar, we can rebind it for our backend\nquery = db.Rebind(query)\nrows, err := db.Query(query, args...)\n</code></pre>\n"}], "owner": {"reputation": 2071, "user_id": 2128461, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d16f5d2ad004ea827c463cb650f552ce?s=128&d=identicon&r=PG&f=1", "display_name": "jazzblue", "link": "https://stackoverflow.com/users/2128461/jazzblue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 840, "favorite_count": 0, "closed_date": 1600093820, "answer_count": 1, "score": 0, "last_activity_date": 1473724859, "creation_date": 1473723128, "last_edit_date": 1473724859, "question_id": 39460205, "link": "https://stackoverflow.com/questions/39460205/postgresql-argument-placeholder-does-not-work-for-with", "closed_reason": "Duplicate", "title": "PostgreSQL &quot;?&quot; argument placeholder does not work for &quot;WITH&quot;", "body": "<p>I am trying to use <code>?</code> in the following way (I use it in Golang to generate query, but it seems like it is not Go dependent):</p>\n\n<pre><code>WITH Tmp(name, enabled) AS (\n    VALUES(?, ?),(?, ?)\n) \nUPDATE table_groups \n    SET enabled = (SELECT enabled \n                   FROM Tmp \n                   WHERE table_groups.name=Tmp.name) \nWHERE table_groups.name IN (SELECT name FROM Tmp)\n</code></pre>\n\n<p>getting:</p>\n\n<pre><code>syntax error at or near \",\"\n</code></pre>\n\n<p>If I substitute <code>?</code> in the above statement by concrete values, everything works fine. Is there a problem using <code>?</code> with <code>WITH</code> and how would I get around it? Thanks.</p>\n"}, {"tags": ["go", "visual-studio-code", "delve"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1473717145, "post_id": 39458526, "comment_id": 66239889, "body": "&quot;internal&quot; is a reserved package name. Are you trying to import a package named &quot;internal&quot; in your code?"}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "edited": false, "score": 0, "creation_date": 1473785996, "post_id": 39458526, "comment_id": 66269884, "body": "Looks like the same <a href=\"https://stackoverflow.com/questions/39456064/remote-debugging-with-volume-panicks\">problem</a> I have. I suspect it to be within VsCode."}], "answers": [{"tags": [], "owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "is_accepted": false, "score": 0, "last_activity_date": 1473719501, "last_edit_date": 1473719501, "creation_date": 1473718589, "answer_id": 39459596, "question_id": 39458526, "link": "https://stackoverflow.com/questions/39458526/how-to-fix-delve-cant-load-package-package-internal-error/39459596#39459596", "title": "How to fix delve &quot;can&#39;t load package: package internal&quot; error", "body": "<p>If Go is installed correctly, this error message is saying you are trying to import an external package called \"internal\"</p>\n\n<p>Compile an empty program with no imports to see if the issue persists eg.</p>\n\n<pre><code>package main\n\nfunc main() {\n}\n</code></pre>\n\n<p>You should not see any errors here. If you do then that is most likely an indication Go is not installed properly.</p>\n"}, {"comments": [{"owner": {"reputation": 1508, "user_id": 448420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6025e3530546eb4f2e6abb51b2c11ce8?s=128&d=identicon&r=PG", "display_name": "runec", "link": "https://stackoverflow.com/users/448420/runec"}, "edited": false, "score": 5, "creation_date": 1473765347, "post_id": 39466111, "comment_id": 66257090, "body": "Thank you :) I sucessfully executed these steps in <code>go&#47;src&#47;github.com&#47;derekparker&#47;delve</code> after regular go get: <code>git checkout e4c7df</code>then <code>go install github.com&#47;derekparker&#47;delve&#47;cmd&#47;dlv</code>"}, {"owner": {"reputation": 526, "user_id": 6538004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3dcbdcdf4ea47dc3c63434d0da854cb?s=128&d=identicon&r=PG&f=1", "display_name": "grssn", "link": "https://stackoverflow.com/users/6538004/grssn"}, "edited": false, "score": 0, "creation_date": 1473765537, "post_id": 39466111, "comment_id": 66257215, "body": "Thanks. This seems to be the case. I&#39;ll try rebuilding from source when I get home."}, {"owner": {"reputation": 944, "user_id": 129346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4b07758e88c2ec9f8dcd5d2b25210a?s=128&d=identicon&r=PG", "display_name": "Icebob", "link": "https://stackoverflow.com/users/129346/icebob"}, "reply_to_user": {"reputation": 1508, "user_id": 448420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6025e3530546eb4f2e6abb51b2c11ce8?s=128&d=identicon&r=PG", "display_name": "runec", "link": "https://stackoverflow.com/users/448420/runec"}, "edited": false, "score": 1, "creation_date": 1474444907, "post_id": 39466111, "comment_id": 66528971, "body": "Thanks @runec. Working properly!"}], "tags": [], "owner": {"reputation": 84, "user_id": 3887029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e57080b75a4ab5f364f8c4d05513829a?s=128&d=identicon&r=PG&f=1", "display_name": "Sunnyque", "link": "https://stackoverflow.com/users/3887029/sunnyque"}, "is_accepted": true, "score": 6, "last_activity_date": 1473757394, "creation_date": 1473757394, "answer_id": 39466111, "question_id": 39458526, "link": "https://stackoverflow.com/questions/39458526/how-to-fix-delve-cant-load-package-package-internal-error/39466111#39466111", "title": "How to fix delve &quot;can&#39;t load package: package internal&quot; error", "body": "<p>Got same issue with latest delve and vscode:</p>\n\n<blockquote>\n  <p>can't load package: package internal: no buildable Go source files in\n  C:\\Coding\\Go\\src\\internal</p>\n</blockquote>\n\n<p>and 'go build' working without any errors</p>\n\n<p>Have to fallback to previous version of delve to get it working. It seems delve broke something or just need to update some things. Seems it enough just to replace dlv.exe in %GOPATH%\\bin folder. I'm not sharing my version because it exe, but you can find it or build from sources</p>\n"}, {"tags": [], "owner": {"reputation": 317, "user_id": 2060735, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kJFRk.jpg?s=128&g=1", "display_name": "Ali Altun", "link": "https://stackoverflow.com/users/2060735/ali-altun"}, "is_accepted": false, "score": 3, "last_activity_date": 1479057279, "creation_date": 1479057279, "answer_id": 40576580, "question_id": 39458526, "link": "https://stackoverflow.com/questions/39458526/how-to-fix-delve-cant-load-package-package-internal-error/40576580#40576580", "title": "How to fix delve &quot;can&#39;t load package: package internal&quot; error", "body": "<p>I solved my problem that looks like same problem by changing launch.json file.  </p>\n\n<pre><code>// before\n\"program\": \"${workspaceRoot}\n\n// after changing \n\"program\": \"${workspaceRoot}/src/github.com/myproje/hello\",\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7746050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3779cb9dabf6463660895b96e3ee245f?s=128&d=identicon&r=PG&f=1", "display_name": "Serhiy Savin", "link": "https://stackoverflow.com/users/7746050/serhiy-savin"}, "is_accepted": false, "score": 1, "last_activity_date": 1490105051, "creation_date": 1490105051, "answer_id": 42929405, "question_id": 39458526, "link": "https://stackoverflow.com/questions/39458526/how-to-fix-delve-cant-load-package-package-internal-error/42929405#42929405", "title": "How to fix delve &quot;can&#39;t load package: package internal&quot; error", "body": "<p>same problem (vscode/linux/go1.8)\nThe Solution:</p>\n\n<pre><code>change in launch.json &gt; \n \"program\": \"${fileDirname}\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 653, "user_id": 11884135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4K6gU.jpg?s=128&g=1", "display_name": "Furkan &#214;zt&#252;rk", "link": "https://stackoverflow.com/users/11884135/furkan-%c3%96zt%c3%bcrk"}, "is_accepted": false, "score": 1, "last_activity_date": 1603023947, "creation_date": 1603023947, "answer_id": 64413276, "question_id": 39458526, "link": "https://stackoverflow.com/questions/39458526/how-to-fix-delve-cant-load-package-package-internal-error/64413276#64413276", "title": "How to fix delve &quot;can&#39;t load package: package internal&quot; error", "body": "<p><strong>I had the same problem. When i check, {fileDirName} points my .vscode folder. So i've just given my path manuelly and it works.</strong></p>\n<p><em>I've replaced this</em></p>\n<pre><code>&quot;program&quot;: &quot;${fileDirname}&quot;\n</code></pre>\n<p><em>with this</em></p>\n<pre><code>&quot;program&quot;: &quot;c:/Go/src/MyGoProject&quot;\n</code></pre>\n"}], "owner": {"reputation": 526, "user_id": 6538004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3dcbdcdf4ea47dc3c63434d0da854cb?s=128&d=identicon&r=PG&f=1", "display_name": "grssn", "link": "https://stackoverflow.com/users/6538004/grssn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8584, "favorite_count": 2, "accepted_answer_id": 39466111, "answer_count": 5, "score": 5, "last_activity_date": 1603023947, "creation_date": 1473713087, "last_edit_date": 1534978735, "question_id": 39458526, "link": "https://stackoverflow.com/questions/39458526/how-to-fix-delve-cant-load-package-package-internal-error", "title": "How to fix delve &quot;can&#39;t load package: package internal&quot; error", "body": "<p>So I installed VSCODE on my windows machine as my main golang IDE and I guess my overall lack of go knowledge is making me experience this seemingly unsolvable error: \nI installed delve and wanted to use it as my debugger in vscode-go. I did everything as mentioned in the readme on <a href=\"https://github.com/Microsoft/vscode-go\" rel=\"nofollow\">https://github.com/Microsoft/vscode-go</a> , yet for some reason when I run dlv debug I get error \"can't load package: package internal: no buildable Go source files in c:\\go\\src\\internal exit status 1\". I couldn't find anything related to this folder on the internet, but I have never myself entered the path to src/internal in any of the config files. So this is making me really confused, since I thought if it was a common folder someone should have atleast gotten the same error once. </p>\n\n<p>It occurs both in the vscode and in command prompt, also if dlv test is run. I also know it is not the issue with my folder structure/env variables since it complains about my package files missing too if I remove them in addition to also giving the same c:\\go\\src\\internal error. It seems as if there is a setting somewhere to check that folder for source files too, but I can't find the setting and the dlv debug crashes after giving me the error.</p>\n"}, {"tags": ["go", "compilation", "homebrew"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1473738639, "post_id": 39458106, "comment_id": 66244578, "body": "Your Go sources must <b>not</b> be under $GOPATH."}, {"owner": {"reputation": 23, "user_id": 6823931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a582bf9463931680b4d18c5ea449972?s=128&d=identicon&r=PG&f=1", "display_name": "question", "link": "https://stackoverflow.com/users/6823931/question"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1474832761, "post_id": 39458106, "comment_id": 66681463, "body": "I thought all Go source code must be under a valid $GOPATH? also the homebrew install is just the binary I believe."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1474834304, "post_id": 39458106, "comment_id": 66681960, "body": "Your beliefs are wrong. Your <i>own</i> code <i>should</i> be under GOPATH (to use the <code>go</code> tool). The compiler source <i>must</i> <i>not</i>."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9583460, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/2c216d4e96c0f56eb3c52a11b4fac0f9?s=128&d=identicon&r=PG", "display_name": "And", "link": "https://stackoverflow.com/users/9583460/and"}, "is_accepted": false, "score": 1, "last_activity_date": 1522616754, "creation_date": 1522616754, "answer_id": 49602617, "question_id": 39458106, "link": "https://stackoverflow.com/questions/39458106/best-way-to-bootstrap-the-golang-install-with-an-existing-homebrew-install/49602617#49602617", "title": "Best way to bootstrap the Golang install with an existing homebrew install", "body": "<p>Post version 1.4 Go is written in go so you need to install something that can understand and compile go natively, often called the go toolchain.</p>\n\n<p>Don't change anything else just install the latest 1.4 version and point GOROOT_BOOTSTRAP at this.  In my case I installed Go 1.4.3 and placed into a directory C:\\Go143 and on windows did this\nset GOROOT_BOOTSTRAP=C:\\Go143</p>\n\n<p>All worked after that</p>\n"}], "owner": {"reputation": 23, "user_id": 6823931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a582bf9463931680b4d18c5ea449972?s=128&d=identicon&r=PG&f=1", "display_name": "question", "link": "https://stackoverflow.com/users/6823931/question"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 856, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522616754, "creation_date": 1473711223, "last_edit_date": 1473711554, "question_id": 39458106, "link": "https://stackoverflow.com/questions/39458106/best-way-to-bootstrap-the-golang-install-with-an-existing-homebrew-install", "title": "Best way to bootstrap the Golang install with an existing homebrew install", "body": "<p>The Go tool chain was rewritten in Go, requiring a prior Go compiler to exist to perform the install.</p>\n\n<p>You can point to an existing compiler using the GOROOT_BOOTSTRAP environment variable.</p>\n\n<p>In my situation I have Go already installed by Homebrew. Going forward I want to compile from the source and <strong>not</strong> by 'brew upgrade go'. I want to use the Homebrew install to compile the latest source, as it already exists on the system.</p>\n\n<p>the following throws an error (\"Cannot find packages\")</p>\n\n<pre><code>cd $GOPATH/src/github.com/golang/go/src\nGOROOT_BOOTSTRAP=/usr/local/Cellar/go/1.6.2 ./all.bash\n</code></pre>\n\n<p>and so does this (\"Cannot find /usr/local/Cellar/go/1.6.2/go/bin/go\")</p>\n\n<pre><code>GOROOT_BOOTSTRAP=/usr/local/Cellar/go/1.6.2/go ./all.bash\n</code></pre>\n\n<p>but this works (mostly, except for me it fails with a Python _lldb.so plug-in error)</p>\n\n<pre><code>GOROOT_BOOTSTRAP=/usr/local/Cellar/go/1.6.2/libexec ./all.bash\n</code></pre>\n\n<p>What does the \"libexec\" do in this context?\nand is there a better way to install golang with the prior compiler being from homebrew?</p>\n"}, {"tags": ["http", "go", "httpclient"], "comments": [{"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 0, "creation_date": 1473711798, "post_id": 39457824, "comment_id": 66237589, "body": "Reading from ahrefs help page you need a particular subscription to use the API. Maybe this is the problem"}, {"owner": {"reputation": 743, "user_id": 2539622, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/SXZtK.jpg?s=128&g=1", "display_name": "belek", "link": "https://stackoverflow.com/users/2539622/belek"}, "reply_to_user": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 0, "creation_date": 1473744065, "post_id": 39457824, "comment_id": 66245998, "body": "I know, but I have no opportunity to use API. My task is to parse the html."}], "owner": {"reputation": 743, "user_id": 2539622, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/SXZtK.jpg?s=128&g=1", "display_name": "belek", "link": "https://stackoverflow.com/users/2539622/belek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473710081, "creation_date": 1473710081, "question_id": 39457824, "link": "https://stackoverflow.com/questions/39457824/301-status-code-after-postform", "title": "301 status code after PostForm", "body": "<p>I am trying to write a program which will login to <code>ahrefs.com</code> and parse some data.\nAt first I am sending GET request to <code>ahrefs.com</code> to get cookies and html to parse needed token:</p>\n\n<pre><code>    client := &amp;http.Client{}\n    jar := &amp;myjar{}\n    jar.jar = make(map[string] []*http.Cookie)\n    client.Jar = jar\n    resp, _ := client.Get(\"https://ahrefs.com\")\n\n    root, _ := html.Parse(resp.Body)\n    element, _ := getElementByName(\"_token\", root)\n    token := \"\"\n    for _, a := range element.Attr {\n        if a.Key == \"value\" {\n            token = a.Val\n        }\n    }\n</code></pre>\n\n<p>Then I am sending POST request using <code>PostForm</code> to <code>ahrefs.com/user/login/</code>. I  fill the fields with correct data (tested it via browser). When I submit form in browser it has field <code>return_to</code> with value of main page of the site, which should redirect  to <code>ahrefs.com/dashboard/metrics/</code> (the page from I want to parse data). But my program's behavior is different. After <code>PostForm</code> I got <code>301</code> status code:</p>\n\n<pre><code>resp, _ = client.PostForm(\n        \"https://ahrefs.com/user/login/\",\n        url.Values{\n            \"email\": {\"djviman@gmail.com\"},\n            \"password\": {\"Aau4bqRxfc4ZEvu\"},\n            \"_token\": {token},\n            \"return_to\": {\"https://ahrefs.com/\"},\n        })\n    log.Println(resp.Status)\n    resp.Body.Close()\n</code></pre>\n\n<p>Then I am sending GET request to <code>ahrefs.com/dashboard/metrics/</code> but it redirects me to the home page, like I'm not logged in:</p>\n\n<pre><code>resp, _ = client.Get(\"https://ahrefs.com/\")\n    log.Println(resp.Status)\n    resp.Body.Close()\n</code></pre>\n\n<p>Questions are: what I am doing wrong? And hot to successfully log in to this site?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1473709660, "post_id": 39457628, "comment_id": 66236566, "body": "Are there any symlinked directories in the path for <code>&#47;home&#47;mjohn&#47;workspace&#47;gopath&#47;src&#47;mjohn&#47;msg&#47;vendor&#47;zombiezen.&zwnj;&#8203;com&#47;go&#47;capnproto2</code> ?"}, {"owner": {"reputation": 1055, "user_id": 4205792, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0297dc684ce4aad71243b4e66d9e9f13?s=128&d=identicon&r=PG&f=1", "display_name": "dangeroushobo", "link": "https://stackoverflow.com/users/4205792/dangeroushobo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1473710035, "post_id": 39457628, "comment_id": 66236747, "body": "Yes, the msg directory was a symlink. I removed it and tried again but still seeing the same issue."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1473711186, "creation_date": 1473711186, "answer_id": 39458102, "question_id": 39457628, "link": "https://stackoverflow.com/questions/39457628/go1-7-not-reconizing-vendor-directory/39458102#39458102", "title": "go1.7 not reconizing vendor directory", "body": "<p>The package <code>mjohn/fram/rim</code> is what is failing to import <code>zombiezen.com/go/capnproto2</code>, but the vendor directory is in the <code>mjohn/msg</code> package. </p>\n\n<p>You can either vendor <code>mjohn/fram/rim</code> in it's entirety, including dependencies inside the <code>mjohn/msg</code> package, or you can vendor <code>zombiezen.com/go/capnproto2</code> in the <code>mjohn/fram/rim</code> package where it's imported. </p>\n"}], "owner": {"reputation": 1055, "user_id": 4205792, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0297dc684ce4aad71243b4e66d9e9f13?s=128&d=identicon&r=PG&f=1", "display_name": "dangeroushobo", "link": "https://stackoverflow.com/users/4205792/dangeroushobo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 39458102, "answer_count": 1, "score": 0, "last_activity_date": 1473711186, "creation_date": 1473709243, "question_id": 39457628, "link": "https://stackoverflow.com/questions/39457628/go1-7-not-reconizing-vendor-directory", "title": "go1.7 not reconizing vendor directory", "body": "<p>I have a package which I'm trying to vendorize. It uses the capnproto2 package. It builds without error when the package is under $GOPATH/src/zombiezen.com/go/capnproto2 but fails when I move it to my vendor directory. My project is located under my GOPATH.</p>\n\n<pre><code>$ go build\n../fram/rim/fsd.go:7:8: cannot find package \"zombiezen.com/go/capnproto2\" in any of:\n    /home/mjohn/software/go/src/zombiezen.com/go/capnproto2 (from $GOROOT)\n    /home/mjohn/workspace/gopath/src/zombiezen.com/go/capnproto2 (from $GOPATH)\n../fram/rim/schema.capnp.go:7:2: cannot find package \"zombiezen.com/go/capnproto2/encoding/text\" in any of:\n    /home/mjohn/software/go/src/zombiezen.com/go/capnproto2/encoding/text (from $GOROOT)\n    /home/mjohn/workspace/gopath/src/zombiezen.com/go/capnproto2/encoding/text (from $GOPATH)\n../fram/rim/schema.capnp.go:8:2: cannot find package \"zombiezen.com/go/capnproto2/schemas\" in any of:\n    /home/mjohn/software/go/src/zombiezen.com/go/capnproto2/schemas (from $GOROOT)\n    /home/mjohn/workspace/gopath/src/zombiezen.com/go/capnproto2/schemas (from $GOPATH)\n</code></pre>\n\n<p>My environment:</p>\n\n<pre><code>$ go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/mjohn/workspace/gopath\"\nGORACE=\"\"\nGOROOT=\"/home/mjohn/software/go\"\nGOTOOLDIR=\"/home/mjohn/software/go/pkg/tool/linux_amd64\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build069056451=/tmp/go-build -gno-record-gcc-switches\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>My project layout</p>\n\n<pre><code>$ pwd\n/home/mjohn/workspace/gopath/src/mjohn/msg\n\n$ ls\ncmd/main.go\ncmd/rpc.go\nvendor/zombiezen.com/go/capnproto2\n</code></pre>\n\n<p>Obviously there's more in the capnproto2 directory, but this was a copy from $GOPATH/src/zombiezen.com/go/capnproto2.</p>\n\n<p>Any ideas on why go doesn't recognize my vendor directory?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "go", "struct", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 402, "user_id": 2566890, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/719312174/picture?type=large", "display_name": "dimlee", "link": "https://stackoverflow.com/users/2566890/dimlee"}, "edited": false, "score": 0, "creation_date": 1473706652, "post_id": 39456775, "comment_id": 66235061, "body": "Wow, that worked perfectly, thank you Clifford. I refactored from C++ to C to avoid having to use SWIG and didn&#39;t even know that would be an issue. Thank you."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": true, "score": 4, "last_activity_date": 1524350922, "last_edit_date": 1524350922, "creation_date": 1473705916, "answer_id": 39456775, "question_id": 39456628, "link": "https://stackoverflow.com/questions/39456628/why-doesnt-cgo-recognize-my-struct-declared-in-a-header-file/39456775#39456775", "title": "Why doesn&#39;t CGo recognize my struct declared in a header file?", "body": "<p>In C, (unlike C++), the <code>struct</code> keyword does not declare a type-name that can be used on its own; it needs qualification with the <code>struct</code> keyword. The type is <code>struct PROCESS</code> not <code>PROCESS</code>:</p>\n\n<pre><code>struct PROCESS \n{\n    char* name ;\n    int os_type ;\n    addr_t address ;\n    struct PROCESS* next ;   // The struct keyword is needed here\n    ...\n</code></pre>\n"}], "owner": {"reputation": 402, "user_id": 2566890, "user_type": "registered", "accept_rate": 85, "profile_image": "https://graph.facebook.com/719312174/picture?type=large", "display_name": "dimlee", "link": "https://stackoverflow.com/users/2566890/dimlee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "accepted_answer_id": 39456775, "answer_count": 1, "score": 0, "last_activity_date": 1524350922, "creation_date": 1473705304, "question_id": 39456628, "link": "https://stackoverflow.com/questions/39456628/why-doesnt-cgo-recognize-my-struct-declared-in-a-header-file", "title": "Why doesn&#39;t CGo recognize my struct declared in a header file?", "body": "<p>I am getting the error <strong>\"./test.h:10:3: error: unknown type name 'PROCESS'\"</strong> when I include my header file test.h that has the struct definition PROCESS as a part of my C Go Lang application. The code compiles in C with no problems so I imagine I'm doing something very simple incorrectly...</p>\n\n<pre><code>package main\n\n// #include &lt;sys/mman.h&gt;\n// #include &lt;errno.h&gt;\n// #include &lt;inttypes.h&gt;\n// #include &lt;stdlib.h&gt;\n// #include \"test.h\"\nimport \"C\"\n\nimport (\n    \"fmt\"\n    _\"unsafe\"\n  )\n\n\nfunc main() {\n    fmt.Println(\"Retrieving process list\");\n\n}\n</code></pre>\n\n<p>The contents of test.h are below...</p>\n\n<pre><code>#include &lt;sys/mman.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;inttypes.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct PROCESS {\n    char *name;\n    int os_type;\n    addr_t address;\n    PROCESS *next;\n\n    //fields we care about\n    unsigned int uid;\n    unsigned int gid;\n    unsigned int is_root;\n    unsigned int io_r;\n    unsigned int io_wr;\n    unsigned int io_sys_r;\n    unsigned int io_sys_wr;\n    unsigned int used_super;\n    unsigned int is_k_thread;\n    unsigned int cpus;\n    unsigned long hw_rss;\n    unsigned long vma_size;\n    unsigned long map_count;\n    unsigned long pages;\n    unsigned long total_map;\n    unsigned long min_flt;\n    unsigned long mm_usrs;\n    unsigned long nr_ptes;\n    unsigned long nvcsw;\n\n};\n</code></pre>\n"}, {"tags": ["go", "byte", "ascii", "string-conversion"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1473697335, "post_id": 39454630, "comment_id": 66230726, "body": "ASIC?: <a href=\"https://en.wikipedia.org/wiki/Application-specific_integrated_circuit\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Application-specific_integrated_circui&zwnj;&#8203;t</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1473697485, "post_id": 39454630, "comment_id": 66230800, "body": "Are you just looking for <a href=\"https://golang.org/pkg/strconv/#Atoi\" rel=\"nofollow noreferrer\"><code>strconv.Atoi</code></a>?"}, {"owner": {"reputation": 37, "user_id": 4015785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a97049119d1053ede71970db753a26e?s=128&d=identicon&r=PG&f=1", "display_name": "younis", "link": "https://stackoverflow.com/users/4015785/younis"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1473733154, "post_id": 39454630, "comment_id": 66243381, "body": "Yes, that can solve my problem. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4015785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a97049119d1053ede71970db753a26e?s=128&d=identicon&r=PG&f=1", "display_name": "younis", "link": "https://stackoverflow.com/users/4015785/younis"}, "edited": false, "score": 0, "creation_date": 1473732957, "post_id": 39454808, "comment_id": 66243332, "body": "Yes, thank you. But I&#39;ve encountered a problem when I practiced a algorithm problem. The scanf somehow took blank lines into account and it didn&#39;t get the whole data and got zeros at blank lines. It&#39;s a little awkward......<a href=\"http://codeforces.com/contest/575/submission/20550909\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 37, "user_id": 4015785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a97049119d1053ede71970db753a26e?s=128&d=identicon&r=PG&f=1", "display_name": "younis", "link": "https://stackoverflow.com/users/4015785/younis"}, "edited": false, "score": 0, "creation_date": 1473762429, "post_id": 39454808, "comment_id": 66255457, "body": "I don&#39;t get what you&#39;re saying. I run your program on my machine and it gives 8."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1473697660, "creation_date": 1473697660, "answer_id": 39454808, "question_id": 39454630, "link": "https://stackoverflow.com/questions/39454630/how-to-add-an-ascii-value-of-a-byte-to-an-integer-in-golang/39454808#39454808", "title": "How to add an ASCII value of a byte to an integer in golang?", "body": "<p>If you need to read an integer from a stream of bytes, the fastest way would be just to <a href=\"https://golang.org/pkg/fmt/#hdr-Scanning\" rel=\"nofollow\">scan</a> it with <code>fmt</code>. Example:</p>\n\n<pre><code>n := 0\n_, err := fmt.Scanf(\"%d\", &amp;n)\nif err != nil {\n    log.Fatal(err)\n}\nfmt.Printf(\"you entered %d\\n\", n)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 4015785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a97049119d1053ede71970db753a26e?s=128&d=identicon&r=PG&f=1", "display_name": "younis", "link": "https://stackoverflow.com/users/4015785/younis"}, "edited": false, "score": 0, "creation_date": 1473733121, "post_id": 39456159, "comment_id": 66243375, "body": "Thank you very much! It&#39;s a little pity I can  not add the asic value of character to an integer like I do in c++ language."}, {"owner": {"reputation": 1289, "user_id": 2379903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2ee17b19924a4e62661b710523ba060?s=128&d=identicon&r=PG", "display_name": "Art Yerkes", "link": "https://stackoverflow.com/users/2379903/art-yerkes"}, "reply_to_user": {"reputation": 37, "user_id": 4015785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a97049119d1053ede71970db753a26e?s=128&d=identicon&r=PG&f=1", "display_name": "younis", "link": "https://stackoverflow.com/users/4015785/younis"}, "edited": false, "score": 0, "creation_date": 1473738958, "post_id": 39456159, "comment_id": 66244661, "body": "You can coerce a byte value to int to parse an integral value, but it&#39;s better to use a library function that traps errors.  Also just realized that you meant ASCII rather than ASIC."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 37, "user_id": 4015785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a97049119d1053ede71970db753a26e?s=128&d=identicon&r=PG&f=1", "display_name": "younis", "link": "https://stackoverflow.com/users/4015785/younis"}, "edited": false, "score": 0, "creation_date": 1473772576, "post_id": 39456159, "comment_id": 66261409, "body": "@younis: you can convert any numeric types with the rules laid out in the spec: <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Conversions</a> (specifically under &quot;Conversions between numeric types&quot;)"}], "tags": [], "owner": {"reputation": 1289, "user_id": 2379903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2ee17b19924a4e62661b710523ba060?s=128&d=identicon&r=PG", "display_name": "Art Yerkes", "link": "https://stackoverflow.com/users/2379903/art-yerkes"}, "is_accepted": true, "score": 2, "last_activity_date": 1473703335, "creation_date": 1473703335, "answer_id": 39456159, "question_id": 39454630, "link": "https://stackoverflow.com/questions/39454630/how-to-add-an-ascii-value-of-a-byte-to-an-integer-in-golang/39456159#39456159", "title": "How to add an ASCII value of a byte to an integer in golang?", "body": "<p>In go, you can convert byte array to string with the string() coercion and then use strconv.Atoi on it.  Presumably, you also want to use slice operations to isolate just the part of the input you want to convert.</p>\n\n<pre><code>package main\n\nimport (\n    \"strconv\"\n    \"fmt\"\n)\n\nfunc main() {\n    data := []byte { 0x20, 0x31, 0x32, 0x33, 0x20 } // Embedded number\n    // string(...) coercion yields a string from a byte buffer\n    // Number starts at char 1, ends before char 4\n    str := string(data[1:4])\n    i, err := strconv.Atoi(str)\n    if err != nil {\n        fmt.Printf(\"Error %v\\n\", err)\n        return\n    }\n\n    fmt.Printf(\"value %v\\n\", i)\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>value 123\n</code></pre>\n\n<p>And since go has nicely hygenic practicies, errors will be handled too.</p>\n"}], "owner": {"reputation": 37, "user_id": 4015785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a97049119d1053ede71970db753a26e?s=128&d=identicon&r=PG&f=1", "display_name": "younis", "link": "https://stackoverflow.com/users/4015785/younis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3701, "favorite_count": 0, "accepted_answer_id": 39456159, "answer_count": 2, "score": -2, "last_activity_date": 1473742074, "creation_date": 1473696904, "last_edit_date": 1473742074, "question_id": 39454630, "link": "https://stackoverflow.com/questions/39454630/how-to-add-an-ascii-value-of-a-byte-to-an-integer-in-golang", "title": "How to add an ASCII value of a byte to an integer in golang?", "body": "<p>I'd like to get a byte[] variables' asic value added to an integer. For example, I fisrt read all input in a byte[] buffer. And then I get out a number string \"123\" in it. And then I can assign it to an integer by ('1' - '0')*100 + ('2' - '0')*10 + '3' - '0'. But I can not assign integers with byte variables. How can I do that with any means? Thank you very much :)</p>\n"}, {"tags": ["templates", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1473694971, "post_id": 39453851, "comment_id": 66229429, "body": "Why not define a proper type that satisfies the structure you need?"}, {"owner": {"reputation": 3409, "user_id": 2310989, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/034bf2e2ba137b4b6db19cea989150d1?s=128&d=identicon&r=PG", "display_name": "Gaurav Pant", "link": "https://stackoverflow.com/users/2310989/gaurav-pant"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1473695217, "post_id": 39453851, "comment_id": 66229595, "body": "i am talking about readability here. The python / Perl code seems more readable."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1473695804, "post_id": 39453851, "comment_id": 66229997, "body": "What do you consider &quot;unreadable&quot;? You haven&#39;t shown an example of what didn&#39;t work for you in Go. Go is statically typed, so you&#39;re going to have type definitions <i>somewhere</i> in the code."}], "answers": [{"tags": [], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "is_accepted": false, "score": 2, "last_activity_date": 1473695434, "creation_date": 1473695434, "answer_id": 39454238, "question_id": 39453851, "link": "https://stackoverflow.com/questions/39453851/how-to-define-anonymous-data-structure-in-golang/39454238#39454238", "title": "how to define anonymous data-structure in golang", "body": "<p>It is probably easier to define a type (either at the package level or within the function), but you can define literal structs inline (arrays of these are usually seen in table-driven tests).</p>\n\n<pre><code>blah := struct{\n    s string\n    f int\n}{\"blah\",12}\n</code></pre>\n\n<p>These can be nested arbitrarily, but it gets to be harder to read.</p>\n"}], "owner": {"reputation": 3409, "user_id": 2310989, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/034bf2e2ba137b4b6db19cea989150d1?s=128&d=identicon&r=PG", "display_name": "Gaurav Pant", "link": "https://stackoverflow.com/users/2310989/gaurav-pant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473695434, "creation_date": 1473694038, "last_edit_date": 1473694677, "question_id": 39453851, "link": "https://stackoverflow.com/questions/39453851/how-to-define-anonymous-data-structure-in-golang", "title": "how to define anonymous data-structure in golang", "body": "<p>I am new to golang and you may find my question very silly. But still I have tried my leave best to find solution for my problem but no luck.</p>\n\n<p>I need to keep mapping in below data structure which I want to use later in generating page from template. If I need to define below data structure in Python or Perl then I can do it easily do this. </p>\n\n<p>Below is sample code for python.</p>\n\n<pre><code>{\n    'abc' : {\n        '1' : ['A', 'B', 'C']\n    }\n    'def' : {\n        '1': {\n            'key1':'val1',\n            'key2':'val2',\n            .....\n            ...\n            },\n        '2':{\n            'key1':'val1',\n            'key2':'val2',\n            .....\n            ...\n            },\n        ....\n        ....\n    }\n}\n</code></pre>\n\n<p>Is there any easy way to achieve the same in golang? I understand that by uses of <strong>make(map[string]map[string]string)</strong> or<br>\n<strong>make(map[string]interface{})</strong> . But still this seems me quite unreadable.</p>\n\n<p><strong>Update 1:</strong>\nJust clicked the idea that I can define the same structure in JSON format as well. But still is there any other way directly at language level?</p>\n"}, {"tags": ["mysql", "go", "connection"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1473690190, "post_id": 39452555, "comment_id": 66226488, "body": "Show the querying code. Are you sure that you always close <code>*sql.Rows</code> returned by <code>Query</code> and commit/rollback transactions?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1473690204, "post_id": 39452555, "comment_id": 66226496, "body": "You must close your statements and rows when you&#39;re done with them by calling <a href=\"https://golang.org/pkg/database/sql/#Stmt.Close\" rel=\"nofollow noreferrer\"><code>Stmt.Close()</code></a> and <a href=\"https://golang.org/pkg/database/sql/#Rows.Close\" rel=\"nofollow noreferrer\"><code>Rows.Close()</code></a>. See related questions: <a href=\"http://stackoverflow.com/questions/38390999/go-sql-prepared-statement-scope\">Go sql - prepared statement scope</a> and <a href=\"http://stackoverflow.com/questions/38474071/goroutines-blocked-connection-pool\">Goroutines blocked connection pool</a>."}, {"owner": {"reputation": 1671, "user_id": 325358, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/eb58709dc08423fc567de3a3225b23c9?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/325358/ivan"}, "edited": false, "score": 1, "creation_date": 1473690817, "post_id": 39452555, "comment_id": 66226965, "body": "Added how I call them. I never close any statement, because I keep calling them all the time. So actually I should just have 4 connections, one for each statement right?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1473694150, "post_id": 39452555, "comment_id": 66228951, "body": "@Ivan After some googling, it seems like <code>Connections</code> is the total number of connections, and you should actually look at <code>Threads_connected</code> which is fairly small. <a href=\"http://stackoverflow.com/a/8080531/1892060\">stackoverflow.com/a/8080531/1892060</a>"}, {"owner": {"reputation": 1671, "user_id": 325358, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/eb58709dc08423fc567de3a3225b23c9?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/325358/ivan"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1473753801, "post_id": 39452555, "comment_id": 66250372, "body": "@Ainar-G that&#39;s good to know. What about aborted connections and max_used_connections? I even had to increase that value because the MySQL server was blocking connections from the golang server (<code>Host is blocked because of many connection errors unblock with &#39;mysqladmin flush-hosts&#39; mysql</code>)"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1473762493, "post_id": 39452555, "comment_id": 66255498, "body": "@Ivan Sorry, I don&#39;t know enough about MySQL to answer that."}], "owner": {"reputation": 1671, "user_id": 325358, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/eb58709dc08423fc567de3a3225b23c9?s=128&d=identicon&r=PG", "display_name": "Ivan", "link": "https://stackoverflow.com/users/325358/ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 375, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1473690746, "creation_date": 1473690056, "last_edit_date": 1473690746, "question_id": 39452555, "link": "https://stackoverflow.com/questions/39452555/is-it-normal-to-have-these-many-connections-in-mysql", "title": "Is it normal to have these many connections in MySQL?", "body": "<p><a href=\"https://i.stack.imgur.com/0g7fz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0g7fz.png\" alt=\"mysql connections\"></a></p>\n\n<p>I connect to the database in the init function of a controller, like:</p>\n\n<pre><code>db, err = sql.Open(\"mysql\", \"user:pass@tcp(&lt;ip&gt;:3306)/&lt;db&gt;\")\nif err != nil {\n    log.Fatal(err)\n}\n\nerr = db.Ping()\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>Then I prepare some statements (<code>db.Prepare</code>) and finally execute them somewhere in the code, without creating new db connections or anything weird. Just letting go handle the connection pool.</p>\n\n<p>But as you can see in the image, I'm getting a lot of connections and aborted connections which make the server run slow and even crash.</p>\n\n<p>Why is it happening? Also I have around 2000 simultaneous online users which result in about 20 queries per second. I don't think it's much, just in case it mattered.</p>\n\n<p><strong>EDIT:</strong>\nHere's how I run the prepared statements. I have 2 selects, 1 update and 1 insert. Selects are being run like:</p>\n\n<pre><code>err = getStatement.QueryRow(apiKey).Scan(&amp;keyId)\nif err != nil {\n    res, _ := json.Marshal(RespError{\"Statement Error\"})\n    w.Write(res)\n    return\n}\n</code></pre>\n\n<p>Inserts and updates:</p>\n\n<pre><code>insertStatement.Exec(a,b,c)\n</code></pre>\n"}, {"tags": ["loops", "dictionary", "go", "hashmap", "for-range"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1473683264, "post_id": 39450120, "comment_id": 66221783, "body": "Map only. When need to iterate: <i>Collect</i> keys, sort, iterate, done."}, {"owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1473684592, "post_id": 39450120, "comment_id": 66222596, "body": "My question regards looping using the order the keys have been inserted, not to loop using the keys ordered."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1531042025, "post_id": 39450120, "comment_id": 89440515, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/23330781/sort-golang-map-values-by-keys\">sort golang map values by keys</a>"}, {"owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1531127499, "post_id": 39450120, "comment_id": 89462441, "body": "@Flimzy I&#39;ve updated the question addressing the possible duplicate flag, I think the questions are related but <b>not</b> the same, thus the flag is not correct. Hope I&#39;ve been clearer."}], "answers": [{"comments": [{"owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "edited": false, "score": 0, "creation_date": 1473684296, "post_id": 39450454, "comment_id": 66222394, "body": "Defining a new type wrapping map+slice didn&#39;t occur to my mind. Still working around, but it feels much cleaner and safer and at this point I don&#39;t think there&#39;s anything much cleaner."}, {"owner": {"reputation": 13757, "user_id": 2126755, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/8QFus.jpg?s=128&g=1", "display_name": "robbmj", "link": "https://stackoverflow.com/users/2126755/robbmj"}, "edited": false, "score": 1, "creation_date": 1473685040, "post_id": 39450454, "comment_id": 66222861, "body": "Here is a fork where Range takes a callback: <a href=\"https://play.golang.org/p/fBgAEu-Zpw\" rel=\"nofollow noreferrer\">play.golang.org/p/fBgAEu-Zpw</a>"}, {"owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "edited": false, "score": 0, "creation_date": 1473685531, "post_id": 39450454, "comment_id": 66223201, "body": "Thanks a lot to both!  Great answer!"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "edited": false, "score": 0, "creation_date": 1473685564, "post_id": 39450454, "comment_id": 66223224, "body": "@FredMaggiowski Added example implementations to both approaches."}, {"owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "edited": false, "score": 0, "creation_date": 1473685768, "post_id": 39450454, "comment_id": 66223361, "body": "@icza yeah, I&#39;ve seen, thanks! I&#39;ve also seen the notes regarding the second example and I agree with using <code>*valueWrapper</code>. Anyhow I think I&#39;ll go with the first example (map+slice) since it seems to be the easiest one to maintain.. You did a great work! I truly appreciate it."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "edited": false, "score": 0, "creation_date": 1473686223, "post_id": 39450454, "comment_id": 66223635, "body": "@FredMaggiowski Added a Comparison section. Yes, additional slice is clearer / easier. The linked-list in wrapper solution can be faster for removal operation if map grows big."}, {"owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "edited": false, "score": 0, "creation_date": 1473686313, "post_id": 39450454, "comment_id": 66223691, "body": "sure thing, I don&#39;t think that in this case the Map will grow that big ;)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1550477368, "last_edit_date": 1550477368, "creation_date": 1473683670, "answer_id": 39450454, "question_id": 39450120, "link": "https://stackoverflow.com/questions/39450120/map-in-order-range-loop/39450454#39450454", "title": "Map in order range loop", "body": "<p>If you need a <code>map</code> and keys in order, those are 2 different things, you need 2 different (data) types to provide that functionality.</p>\n\n<h3>With a keys slice</h3>\n\n<p>The easiest way to achieve this is to maintain key order in a different slice. Whenever you put a new pair into the map, first check if the key is already in it. If not, add the new key to the separate slice. When you need elements in order, you may use the keys slice. Of course when you remove a pair, you also have to remove it from the slice too.</p>\n\n<p>The keys slice only has to contain the keys (and not the values), so the overhead is little.</p>\n\n<p>Wrap this new functionality (map+keys slice) into a new type and provide methods for it, and hide the map and slice. Then data misalignment cannot occur.</p>\n\n<p>Example implementation:</p>\n\n<pre><code>type Key int   // Key type\ntype Value int // Value type\n\ntype Map struct {\n    m    map[Key]Value\n    keys []Key\n}\n\nfunc New() *Map {\n    return &amp;Map{m: make(map[Key]Value)}\n}\n\nfunc (m *Map) Set(k Key, v Value) {\n    if _, ok := m.m[k]; !ok {\n        m.keys = append(m.keys, k)\n    }\n    m.m[k] = v\n}\n\nfunc (m *Map) Range() {\n    for _, k := range m.keys {\n        fmt.Println(m.m[k])\n    }\n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>m := New()\nm.Set(1, 11)\nm.Set(2, 22)\nm.Range()\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/wqhstzhBQT\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<h3>With a value-wrapper implementing a linked-list</h3>\n\n<p>Another approach would be to wrap the values, and \u2013along the real value\u2013 also store the next/previous key.</p>\n\n<p>For example, assuming you want a map like <code>map[Key]Value</code>:</p>\n\n<pre><code>type valueWrapper struct {\n    value Value\n    next  *Key // Next key\n}\n</code></pre>\n\n<p>Whenever you add a pair to the map, you set a <code>valueWrapper</code> as the value, and you have to <em>link</em> this to the previous (last) pair. To <em>link</em>, you have to set <code>next</code> field of the last wrapper to point to this new key. To easily implement this, it's recommended to also store the last key (to avoid having to search for it).</p>\n\n<p>When you want to iterate over the elements in insertion order, you start from the first (you have to store this), and its associated <code>valueWrapper</code> will tell you the next key (in insertion order).</p>\n\n<p>Example implementation:</p>\n\n<pre><code>type Key int   // Key type\ntype Value int // Value type\n\ntype valueWrapper struct {\n    v    Value\n    next *Key\n}\n\ntype Map struct {\n    m           map[Key]valueWrapper\n    first, last *Key\n}\n\nfunc New() *Map {\n    return &amp;Map{m: make(map[Key]valueWrapper)}\n}\n\nfunc (m *Map) Set(k Key, v Value) {\n    if _, ok := m.m[k]; !ok &amp;&amp; m.last != nil {\n        w2 := m.m[*m.last]\n        m.m[*m.last] = valueWrapper{w2.v, &amp;k}\n    }\n    w := valueWrapper{v: v}\n    m.m[k] = w\n    if m.first == nil {\n        m.first = &amp;k\n    }\n    m.last = &amp;k\n}\n\nfunc (m *Map) Range() {\n    for k := m.first; k != nil; {\n        w := m.m[*k]\n        fmt.Println(w.v)\n        k = w.next\n    }\n}\n</code></pre>\n\n<p>Using it is the same. Try it on the <a href=\"https://play.golang.org/p/Ih-ZvaGXsl\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p><strong>Notes:</strong> You may vary a couple of things to your liking:</p>\n\n<ul>\n<li><p>You may declare the internal map like <code>m map[Key]*valueWrapper</code> and so in <code>Set()</code> you can change the <code>next</code> field without having to assign a new <code>valueWrapper</code>.</p></li>\n<li><p>You may choose <code>first</code> and <code>last</code> fields to be of type <code>*valueWrapper</code></p></li>\n<li><p>You may choose <code>next</code> to be of type <code>*valueWrapper</code></p></li>\n</ul>\n\n<h3>Comparison</h3>\n\n<p>The approach with an additional slice is easier and cleaner. But removing an element from it may become slow if the map grows big, as we also have to find the key in the slice which is \"unsorted\", so it's <code>O(n)</code> complexity.</p>\n\n<p>The approach with linked-list in value-wrapper can easily be extended to support fast element removal even if the map is big, if you also add the <code>prev</code> field to the <code>valueWrapper</code> struct. So if you need to remove an element, you can super-fast find the wrapper (<code>O(1)</code>), update the prev and next wrappers (to point to each other), and perform a simple <code>delete()</code> operation, it's <code>O(1)</code>.</p>\n\n<p>Note that deletion in the first solution (with slice) could still be sped up by using 1 additional map, which would map from key to index of the key in the slice (<code>map[Key]int</code>), so delete operation could still be implemented in <code>O(1)</code>, in exchange for greater complexity. Another option for speeding up could be to change the value in the map to be a wrapper, which could hold the actual value and the index of the key in the slice.</p>\n\n<p>See related question: <a href=\"https://stackoverflow.com/questions/28930416/why-cant-go-iterate-maps-in-insertion-order\">Why can&#39;t Go iterate maps in insertion order?</a></p>\n"}], "owner": {"reputation": 2103, "user_id": 3119050, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/mZahs.jpg?s=128&g=1", "display_name": "fredmaggiowski", "link": "https://stackoverflow.com/users/3119050/fredmaggiowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3660, "favorite_count": 1, "accepted_answer_id": 39450454, "answer_count": 1, "score": 4, "last_activity_date": 1550477368, "creation_date": 1473682635, "last_edit_date": 1531127433, "question_id": 39450120, "link": "https://stackoverflow.com/questions/39450120/map-in-order-range-loop", "title": "Map in order range loop", "body": "<p>I'm looking for a definitive way to range over a <code>Go</code> <code>map</code> in-order.</p>\n\n<p><a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow noreferrer\">Golang spec</a> states the following:</p>\n\n<blockquote>\n  <p>The iteration order over maps is not specified and is not guaranteed to be the same from one iteration to the next. If map entries that have not yet been reached are removed during iteration, the corresponding iteration values will not be produced. If map entries are created during iteration, that entry may be produced during the iteration or may be skipped. The choice may vary for each entry created and from one iteration to the next. If the map is nil, the number of iterations is 0.</p>\n</blockquote>\n\n<p>All I've found here on StackOverflow and Googling are (<strong>imho</strong>) workarounds that I don't like.</p>\n\n<p>Is there a solid way to iterate through a map and retrieve items in the order they've been inserted?</p>\n\n<p>The solutions I've found are:</p>\n\n<ul>\n<li><p>Keep track of keys and values in two separate slices: which sounds like \"Do not use a map\", losing all the advantages of using maps.</p></li>\n<li><p>Use a map but keep track of keys in a different slice: this means data duplication which might lead to data misalignment and eventually may bring loads of bugs and painful debugging.</p></li>\n</ul>\n\n<p>What do you suggest?</p>\n\n<hr>\n\n<p>Edit in response to the possible duplicate flag.</p>\n\n<p>There's a slight difference between my question and the one provided (<a href=\"https://stackoverflow.com/questions/23330781/sort-go-map-values-by-keys\">this question</a>, but also <a href=\"https://stackoverflow.com/questions/18342784/how-to-iterate-through-a-map-in-golang-in-order\">this one</a>), both questions asked for looping through the map following the keys lexicographic order; I, instead, have specifically asked:</p>\n\n<blockquote>\n  <p>Is there a solid way to iterate through a map and <strong>retrieve items in the order they've been inserted</strong>?</p>\n</blockquote>\n\n<p>which is not lexicographic and thus different from <a href=\"https://stackoverflow.com/questions/23330781/sort-go-map-values-by-keys\"><code>@gramme.ninja</code> question</a>: </p>\n\n<blockquote>\n  <p>How can I get the keys to be in order / sort the map so that the keys are in order and the values correspond?</p>\n</blockquote>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1473679309, "post_id": 39449079, "comment_id": 66219589, "body": "<code>recover()</code> must be called in a defered function. Your code does not work."}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1473679695, "post_id": 39449079, "comment_id": 66219778, "body": "@Volker I call recover with defer: <code>defer PanicHandle()</code>. Usual panic is recovered in my code if I add <code>panic(&quot;panic&quot;)</code> to <code>Test1</code> after <code>defer PanicHandle()</code> line. But timeout panic is not recovered."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1473680689, "post_id": 39449079, "comment_id": 66220307, "body": "From <a href=\"https://golang.org/ref/spec#Handling_panics\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Handling_panics</a>: &quot;The return value of recover is nil if any of the following conditions holds: [...] recover was not called directly by a deferred function.&quot; Your simplified code shows proper use of recover. Note that the &quot;timeout panic&quot; does not occur from <i>inside</i> your code so it cannot be recovered."}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1552, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1473680168, "creation_date": 1473678916, "last_edit_date": 1592644375, "question_id": 39449079, "link": "https://stackoverflow.com/questions/39449079/recover-from-test-timeout-panic-in-golang", "title": "recover from test timeout panic in golang", "body": "<p>How to recover from test timeout panic in golang?</p>\n<p>main.go:</p>\n<pre><code>package main\n\nimport &quot;fmt&quot;\n\nfunc main()  {\n    fmt.Println(&quot;main&quot;)\n}\n</code></pre>\n<p>main_test.go:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;os&quot;\n    &quot;testing&quot;\n    &quot;time&quot;\n)\n\nfunc TestMain(m *testing.M) {\n    defer PanicHandle() // this doesn't work\n    retCode := m.Run()\n    fmt.Println(&quot;retCode&quot;, retCode)\n}\n\nfunc PanicHandle() {\n    if r := recover(); r != nil {\n        fmt.Println(&quot;panic handled&quot;)\n        os.Exit(1)\n    }\n}\n\nfunc Test1(t *testing.T) {\n    defer PanicHandle()\n    fmt.Println(&quot;test1&quot;)\n    time.Sleep(time.Second)\n}\n</code></pre>\n<p>And run with command:</p>\n<pre><code>go test -c -o test &amp;&amp; ./test -test.timeout 1s\n</code></pre>\n<p>I'm using <code>recover()</code> in <code>TestMain</code> and in <code>Test1</code>. But the panic <code>panic: test timed out after 1s</code> is not recovered anyway.</p>\n<h1>Update</h1>\n<p>To simplify the code I refactored it:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;os&quot;\n    &quot;testing&quot;\n    &quot;time&quot;\n)\n\nfunc TestMain(m *testing.M) {\n    defer func() {\n        if r := recover(); r != nil {\n            fmt.Println(&quot;panic handled&quot;)\n            os.Exit(1)\n        }\n    }()\n    retCode := m.Run()\n    fmt.Println(&quot;retCode&quot;, retCode)\n}\n\nfunc Test1(t *testing.T) {\n    defer func() {\n        if r := recover(); r != nil {\n            fmt.Println(&quot;panic handled&quot;)\n            os.Exit(1)\n        }\n    }()\n    fmt.Println(&quot;test1&quot;)\n    time.Sleep(time.Second)\n    panic(&quot;panic in test1&quot;)\n}\n</code></pre>\n<p>Usual panic is handled:\ngo test -v -timeout <strong>2</strong>s</p>\n<pre><code>=== RUN   Test1\ntest1\npanic handled\nexit status 1\n</code></pre>\n<p>But timeout panic is not:\ngo test -v -timeout <strong>1</strong>s</p>\n<pre><code>=== RUN   Test1\ntest1\npanic: test timed out after 1s\n\ngoroutine 21 [running]:\npanic(0xe5520, 0xc42008e490)\n    /usr/local/go/src/runtime/panic.go:500 +0x1a1\ntesting.startAlarm.func1()\n    /usr/local/go/src/testing/testing.go:918 +0x10b\ncreated by time.goFunc\n    /usr/local/go/src/time/sleep.go:154 +0x44\n\ngoroutine 1 [chan receive]:\ntesting.(*T).Run(0xc42009a0c0, 0x10cf65, 0x5, 0x11b928, 0x58135)\n    /usr/local/go/src/testing/testing.go:647 +0x316\ntesting.RunTests.func1(0xc42009a0c0)\n    /usr/local/go/src/testing/testing.go:793 +0x6d\ntesting.tRunner(0xc42009a0c0, 0xc42003fdb0)\n    /usr/local/go/src/testing/testing.go:610 +0x81\ntesting.RunTests(0x11b938, 0x191230, 0x1, 0x1, 0x27be3)\n    /usr/local/go/src/testing/testing.go:799 +0x2f5\ntesting.(*M).Run(0xc42003fee8, 0x11b930)\n    /usr/local/go/src/testing/testing.go:743 +0x85\ngithub.com/ypapax/deferPanic.TestMain(0xc42003fee8)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1473678335, "post_id": 39448905, "comment_id": 66219075, "body": "Have you tried <code>r.RunTLS(&quot;1.2.3.4:8080&quot;, &quot;domain.crt&quot;, &quot;domain.key&quot;))</code>? (obviously replace <code>1.2.3.4</code> with the intended IP)"}, {"owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1473678357, "post_id": 39448905, "comment_id": 66219083, "body": "Yes this does not work"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1473679319, "post_id": 39448905, "comment_id": 66219594, "body": "And what error do you get? <a href=\"https://godoc.org/github.com/gin-gonic/gin#Engine.RunTLS\" rel=\"nofollow noreferrer\"><code>Engine.RunTLS()</code></a> returns an error, please be kind to check and post it."}, {"owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1473745210, "post_id": 39448905, "comment_id": 66246371, "body": "I do not get any error. It says server <code>[GIN-debug] Listening and serving HTTPS on 1.1.1.1:9000</code> but when I try to access the rest api it does not work. As soon as I remove 1.1.1.1 it works on localhost."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1473976263, "post_id": 39448905, "comment_id": 66357544, "body": "What did you do when you tried access it ? What happened ? (Copy/paste any command you ran) You naturally need to specify an IP that is configured on the machine, and you need to connect to that specific IP address, not localhost"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 960, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1473678275, "creation_date": 1473678275, "question_id": 39448905, "link": "https://stackoverflow.com/questions/39448905/how-to-run-a-go-gin-server-on-a-specific-ip-address", "title": "How to run a go-gin server on a specific IP address", "body": "<p>I am running a gin server using </p>\n\n<pre><code>r.RunTLS(\":8080\" , \"domain.crt\", \"domain.key\")\n</code></pre>\n\n<p>This starts the server with localhost as host-name. I can access my APIs using localhost host-name. How can I change this behavior to point to IP address instead of localhost?</p>\n"}, {"tags": ["go"], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1473676017, "creation_date": 1473676017, "question_id": 39448231, "link": "https://stackoverflow.com/questions/39448231/how-to-pass-some-data-to-last-gin-handler", "title": "How to pass some data to last gin handler", "body": "<p>I am running a gin router and defined a API like this</p>\n\n<pre><code>versionOneApis.GET(/details, myfunc1(\"my data\") , myfunc2)\n</code></pre>\n\n<p>My myfunc2 has the following signature</p>\n\n<pre><code>func myfunc2 (c *gin.Context) {\n\n    c.Header(\"Content-Type\", \"application/json\")\n    c.JSON(http.StatusOK, \"my details\")\n}\n</code></pre>\n\n<p>I want to pass some  data into myfunc2. I am able to pass data into myfunc1 whose signature is </p>\n\n<pre><code>func myfunc1 (somedata string) {\n   fmt.Println(somedata)       \n}\n</code></pre>\n\n<p>But I am not able to pass data into myfunc2 as I cannot pass a *gin.Context and my data together and if I dont pass 2 values then I get an error saying that 2 inputs are required for myfunc2.</p>\n\n<p>How can I pass data to myfunc2 which already has a *gin.Context input paramter?</p>\n"}, {"tags": ["go", "marshalling", "bson", "mgo", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 1505, "user_id": 4344586, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zmULe.png?s=128&g=1", "display_name": "Frank AK", "link": "https://stackoverflow.com/users/4344586/frank-ak"}, "edited": false, "score": 0, "creation_date": 1542114815, "post_id": 39504335, "comment_id": 93445173, "body": "Hey buddy, You did a great job!"}], "tags": [], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "is_accepted": true, "score": 3, "last_activity_date": 1473920801, "creation_date": 1473920801, "answer_id": 39504335, "question_id": 39447061, "link": "https://stackoverflow.com/questions/39447061/use-a-pre-constructed-string-as-bson-m-for-mgo-query-in-go/39504335#39504335", "title": "Use a pre-constructed string as bson.M for mgo query in go", "body": "<p>I found the solution by Unmarshalling finalbody into a map[string]interface{} and then using that as the update map.</p>\n\n<p>So,</p>\n\n<pre><code>finalbody, err := json.Marshal(body)\nvar finalbodymap map[string]interface{}\njson.Unmarshal(finalbody, &amp;finalbodymap)\n</code></pre>\n\n<p>Of course, you need to add some error handling so the final code looks like this -</p>\n\n<pre><code>finalbody, err := json.Marshal(body)\n    if err != nil {\n        log.Println(err)\n        return\n    }\nvar finalbodymap map[string]interface{}\n    if err = json.Unmarshal(finalbody, &amp;finalbodymap); err != nil{\n        log.Println(err)\n    }\n</code></pre>\n\n<p>And then in the update query, I can simply write - </p>\n\n<pre><code>bson.M{\"$set\": finalbodymap}\n</code></pre>\n\n<p>One issue here though was that while Marshalling, it would set any time.Time type values to nil i.e. \"0001-01-01T00:00:00Z\". I suspect such behavior could be observed with certain other types as well.</p>\n"}], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2100, "favorite_count": 1, "accepted_answer_id": 39504335, "answer_count": 1, "score": 2, "last_activity_date": 1473920801, "creation_date": 1473672097, "question_id": 39447061, "link": "https://stackoverflow.com/questions/39447061/use-a-pre-constructed-string-as-bson-m-for-mgo-query-in-go", "title": "Use a pre-constructed string as bson.M for mgo query in go", "body": "<p>The larger goal here is to have an update query in go set only those fields that are sent to it in the request.</p>\n\n<p>For e.g., I have a document to update where I am allowing the user to update a variable number of fields by simply specifying them in the request like so -</p>\n\n<pre><code>{\n\"field1\": valueOfField1,\n\"field2\": valueOfField2,\n\"field3\": valueOfField3,\n...\n}\n</code></pre>\n\n<p>The problem here is that when I decode this input using <code>json.Decode</code> to a custom struct type which has most fields optional, the values which do not exist in the input are left <code>nil</code>.</p>\n\n<p>My struct looks like this -</p>\n\n<pre><code>type Fields struct {\n    Field1       string      `bson:\"field1\" json:\"field1,omitempty\"`\n    Field2       string      `bson:\"field2\" json:\"field2\"`\n    Field3       time.Time   `bson:\"field3,omitempty\" json:\"field3,omitempty\"`\n    Field4       bool        `bson:\"field4,omitempty\" json:\"field4,omitempty\"`\n...\n}\n</code></pre>\n\n<p>Now in my update query, I say,</p>\n\n<pre><code>bson.M{\"$set\": bson.M{\"field1\": body.Field1, \"field2\": body.Field2, \"field3\": body.Field3, \"field4\": body.Field4, ...}}\n</code></pre>\n\n<p>The problem is that if one of these fields does not exist in the input, it still over-writes existing values in the database and makes it null.</p>\n\n<p>To avoid this, I would ideally want that this <code>{\"field1\": body.Field1, \"field2\": body.Field2, \"field3\": body.Field3, \"field4\": body.Field4, ...}</code> part is dynamically constructed depending on the fields coming in.</p>\n\n<p>To do that, I did a <code>json.Marshal</code> of the input, like so -</p>\n\n<pre><code>finalbody, err := json.Marshal(body)\n</code></pre>\n\n<p>And then I am trying to use this inside the $set field as -</p>\n\n<pre><code>bson.M{\"$set\": string(finalbody)}\n</code></pre>\n\n<p>Of course this gives me an error saying - \"Modifiers operate on fields but we found a string instead\".\nThe string is perfectly just like the bson.M would've been except that it is not a bson.M i.e. <code>{\"field1\": valueOfField1, \"field2\": valueOfField2, \"field3\": valueOfField1, ...}</code></p>\n\n<p>Where am I going wrong?\n[... represents 'and so on']</p>\n"}, {"tags": ["go", "bit-manipulation", "bitwise-operators", "bit-shift", "evaluation"], "answers": [{"comments": [{"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 0, "creation_date": 1473666244, "post_id": 39445372, "comment_id": 66212851, "body": "As a follow up for the question, Can I use the second form to find the Minimum int value? Or Is there a better way to get the minimum int value?"}, {"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 0, "creation_date": 1473672487, "post_id": 39445372, "comment_id": 66216031, "body": "Just curious to know. Why do we need two different behavior? Is there a specific reason for allowing overflown value for variables but not for constants?"}, {"owner": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "reply_to_user": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 0, "creation_date": 1485352683, "post_id": 39445372, "comment_id": 70890579, "body": "@spartan: compared to some other languages I see an advantage in this behaviour as it is always clear and you wont get strange results from some (internal) conversions you dont understand. Such problems are usually difficult to resolve and debug. I like the type system in Go and the way it deals with conversions. In case I get an overflow at compile time for fmt.Println(math.MaxUint64), where math.MaxUint64 is an untyped constant value, I simply convert it into a typed value by surrounding it with its type, in this case fmt.Println(uint64(math.MaxUint64))."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 10, "last_activity_date": 1473676221, "last_edit_date": 1495540433, "creation_date": 1473665617, "answer_id": 39445372, "question_id": 39444852, "link": "https://stackoverflow.com/questions/39444852/does-go-compilers-evaluation-differ-for-constant-expression-and-other-expressio/39445372#39445372", "title": "Does Go compiler&#39;s evaluation differ for constant expression and other expression", "body": "<p>There is a difference in evaluation between constant and non-constant expression that arises from constants being precise:</p>\n\n<blockquote>\n  <p>Numeric constants represent exact values of arbitrary precision <strong>and do not overflow</strong>.</p>\n</blockquote>\n\n<p>Typed constant expressions cannot overflow; if the result cannot be represented by its type, it's a compile-time error (this can be detected at compile-time).</p>\n\n<p>The same thing does not apply to non-constant expressions, as this can't be detected at compile-time (it could only be detected at runtime). Operations on variables can overflow.</p>\n\n<p><strong>In your first example</strong> <code>ONE</code> is a typed constant with type <code>int</code>. This constant expression:</p>\n\n<pre><code>ONE &lt;&lt; (unsafe.Sizeof(x)*8 - 1)\n</code></pre>\n\n<p>Is a constant <a href=\"https://golang.org/ref/spec#Operators\" rel=\"noreferrer\">shift expression</a>, the following applies: <a href=\"https://golang.org/ref/spec#Constant_expressions\" rel=\"noreferrer\">Spec: Constant expressions:</a></p>\n\n<blockquote>\n  <p>If the left operand of a constant <a href=\"https://golang.org/ref/spec#Operators\" rel=\"noreferrer\">shift expression</a> is an untyped constant, the result is an integer constant; <strong>otherwise it is a constant of the same type as the left operand, which must be of <a href=\"https://golang.org/ref/spec#Numeric_types\" rel=\"noreferrer\">integer type</a></strong>.</p>\n</blockquote>\n\n<p>So the result of the shift expression must fit into an <code>int</code> because this is a constant expression; but since it doesn't, it's a compile-time error.</p>\n\n<p><strong>In your second example</strong> <code>ONE</code> is not a constant, it's a variable of type <code>int</code>. So the shift expression here may \u2013and will\u2013 overflow, resulting in the expected negative value.</p>\n\n<p><strong>Notes:</strong></p>\n\n<p>Should you change <code>ONE</code> in the 2nd example to a constant instead of a variable, you'd get the same error (as the expression in the initializer would be a constant expression). Should you change <code>ONE</code> to a variable in the first example, it wouldn't work as variables cannot be used in constant expressions (it must be a constant expression because it initializes a constant).</p>\n\n<h2>Constant expressions to find min-max values</h2>\n\n<p>You may use the following solution which yields the max and min values of <code>uint</code> and <code>int</code> types:</p>\n\n<pre><code>const (\n    MaxUint = ^uint(0)\n    MinUint = 0\n    MaxInt  = int(MaxUint &gt;&gt; 1)\n    MinInt  = -MaxInt - 1\n)\n\nfunc main() {\n    fmt.Printf(\"uint: %d..%d\\n\", MinUint, MaxUint)\n    fmt.Printf(\"int: %d..%d\\n\", MinInt, MaxInt)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/zxduLFqdM_\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>uint: 0..4294967295\nint: -2147483648..2147483647\n</code></pre>\n\n<p>The logic behind it lies in the <a href=\"https://golang.org/ref/spec#Constant_expressions\" rel=\"noreferrer\">Spec: Constant expressions:</a></p>\n\n<blockquote>\n  <p>The mask used by the unary bitwise complement operator ^ matches the rule for non-constants: the mask is all 1s for unsigned constants and -1 for signed and untyped constants.</p>\n</blockquote>\n\n<p>So the typed constant expression <code>^uint(0)</code> is of type <code>uint</code> and is the max value of <code>uint</code>: it has all its bits set to <code>1</code>. Given that integers are represented using <a href=\"https://en.wikipedia.org/wiki/Two%27s_complement\" rel=\"noreferrer\">2's complement</a>: shifting this to the left by <code>1</code> you'll get the value of max <code>int</code>, from which the min <code>int</code> value is <code>-MaxInt - 1</code> (<code>-1</code> due to the <code>0</code> value).</p>\n\n<h2>Reasoning for the different behavior</h2>\n\n<p>Why is there no <a href=\"https://en.wikipedia.org/wiki/Arithmetic_overflow\" rel=\"noreferrer\">overflow</a> for constant expressions and overflow for non-constant expressions?</p>\n\n<p>The latter is easy: in most other (programming) languages there is overflow. So this behavior is consistent with other languages and it has its benefits.</p>\n\n<p>The real question is the first: why isn't overflow allowed for constant expressions?</p>\n\n<p>Constants in Go are more than values of typed variables: they represent <em>exact values of arbitrary precision</em>. Staying at the word <em>exact</em>, if you have a value that you want to assign to a <em>typed</em> constant, allowing overflow and assigning a completely different value doesn't really live up to <em>exact</em>.</p>\n\n<p>Going forward, this type checking and disallowing overflow can catch mistakes like this one:</p>\n\n<pre><code>type Char byte\nvar c1 Char = 'a' // OK\nvar c2 Char = '\u4e16' // Compile-time error: constant 19990 overflows Char\n</code></pre>\n\n<p>What happens here? <code>c1 Char = 'a'</code> works because <code>'a'</code> is a <code>rune</code> constant, and <code>rune</code> is alias for <code>int32</code>, and <code>'a'</code> has numeric value <code>97</code> which fits into <code>byte</code>'s valid range (which is <code>0..255</code>).</p>\n\n<p>But <code>c2 Char = '\u4e16'</code> results in a compile-time error because the rune <code>'\u4e16'</code> has numeric value <code>19990</code> which doesn't fit into a <code>byte</code>. If overflow would be allowed, your code would compile and assign <code>22</code> numeric value (<code>'\\x16'</code>) to <code>c2</code> but obviously this wasn't your intent. By disallowing overflow this mistake is easily caught, and at compile-time.</p>\n\n<p>To verify the results:</p>\n\n<pre><code>var c1 Char = 'a'\nfmt.Printf(\"%d %q %c\\n\", c1, c1, c1)\n\n// var c2 Char = '\u4e16' // Compile-time error: constant 19990 overflows Char\nr := '\u4e16'\nvar c2 Char = Char(r)\nfmt.Printf(\"%d %q %c\\n\", c2, c2, c2)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/IcufRCuzFk\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>97 'a' a\n22 '\\x16' \n</code></pre>\n\n<p>To read more about constants and their philosophy, read the blog post: <a href=\"https://blog.golang.org/constants\" rel=\"noreferrer\">The Go Blog: Constants</a></p>\n\n<p>And a couple more questions (+answers) that relate and / or are interesting:<br>\n<a href=\"https://stackoverflow.com/questions/34704843/golang-on-purpose-int-overflow\">Golang: on-purpose int overflow</a><br>\n<a href=\"https://stackoverflow.com/questions/38982278/how-does-go-perform-arithmetic-on-constants\">How does Go perform arithmetic on constants?</a><br>\n<a href=\"https://stackoverflow.com/questions/35146286/find-address-of-constant-in-go\">Find address of constant in go</a><br>\n<a href=\"https://stackoverflow.com/questions/27819137/why-do-these-two-float64s-have-different-values\">Why do these two float64s have different values?</a><br>\n<a href=\"https://stackoverflow.com/questions/30897208/how-to-change-a-float64-number-to-uint64-in-a-right-way\">How to change a float64 number to uint64 in a right way?</a><br>\n<a href=\"https://stackoverflow.com/questions/34124294/writing-powers-of-10-as-constants-compactly\">Writing powers of 10 as constants compactly</a>  </p>\n"}], "owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 764, "favorite_count": 2, "accepted_answer_id": 39445372, "answer_count": 1, "score": 6, "last_activity_date": 1554155278, "creation_date": 1473663488, "last_edit_date": 1554155278, "question_id": 39444852, "link": "https://stackoverflow.com/questions/39444852/does-go-compilers-evaluation-differ-for-constant-expression-and-other-expressio", "title": "Does Go compiler&#39;s evaluation differ for constant expression and other expression", "body": "<p>Why does below code fail to compile?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"unsafe\"\n)\n\nvar x int = 1\n\nconst (\n    ONE     int = 1\n    MIN_INT int = ONE &lt;&lt; (unsafe.Sizeof(x)*8 - 1)\n)\n\nfunc main() {\n    fmt.Println(MIN_INT)\n\n}\n</code></pre>\n\n<p>I get an error </p>\n\n<blockquote>\n  <p>main.go:12: constant 2147483648 overflows int</p>\n</blockquote>\n\n<p>Above statement is correct. Yes, 2147483648 overflows int (In 32 bit architecture). But the shift operation should result in a negative value ie -2147483648. </p>\n\n<p>But the same code works, If I change the constants into variables and I get the expected output. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"unsafe\"\n)\n\nvar x int = 1\n\nvar (\n    ONE     int = 1\n    MIN_INT int = ONE &lt;&lt; (unsafe.Sizeof(x)*8 - 1)\n)\n\nfunc main() {\n    fmt.Println(MIN_INT)\n\n}\n</code></pre>\n"}, {"tags": ["logging", "go", "gorilla", "loggly"], "answers": [{"tags": [], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "is_accepted": true, "score": 0, "last_activity_date": 1475124504, "last_edit_date": 1495540098, "creation_date": 1475124504, "answer_id": 39761623, "question_id": 39444292, "link": "https://stackoverflow.com/questions/39444292/golang-logrus-logs-available-in-console-but-not-being-sent-to-loggly/39761623#39761623", "title": "Golang logrus logs available in console but not being sent to loggly", "body": "<p>I was able to solve the issue by declaring the following globally</p>\n\n<pre><code>log := logrus.New()\nhook := logrusly.NewLogglyHook(logglyToken, domain, logrus.WarnLevel, logglyUsername, logglyPassword)\n</code></pre>\n\n<p>and then using functions like this -</p>\n\n<pre><code>func LogrusInfo(args ...interface{}) {\n    logger.Hooks.Add(hook)\n    logger.Info(args...)\n    hook.Flush()\n}\n</code></pre>\n\n<p>Reference: <a href=\"https://stackoverflow.com/a/30261304/4720042\">https://stackoverflow.com/a/30261304/4720042</a></p>\n"}], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1202, "favorite_count": 0, "accepted_answer_id": 39761623, "answer_count": 1, "score": 0, "last_activity_date": 1475124504, "creation_date": 1473660935, "question_id": 39444292, "link": "https://stackoverflow.com/questions/39444292/golang-logrus-logs-available-in-console-but-not-being-sent-to-loggly", "title": "Golang logrus logs available in console but not being sent to loggly", "body": "<p>I have a golang project and I'm trying to use loggly logging as explained in their blog at <a href=\"https://www.loggly.com/blog/logging-to-loggly-from-go-with-logrus-and-logrusly/\" rel=\"nofollow\">https://www.loggly.com/blog/logging-to-loggly-from-go-with-logrus-and-logrusly/</a></p>\n\n<p>The problem is that with their example, things are fine but I have a bunch of files and dozens of functions (which handle API calls) and I don't want to go about re-initializing the logger instance every time.</p>\n\n<p>This works perfectly in main.go</p>\n\n<pre><code>log := logrus.New()\nhook := logrusly.NewLogglyHook(logglyToken, domain, logrus.WarnLevel, logglyUsername, logglyPassword)\nlog.Hooks.Add(hook)\nlog.Info(\"Welcome\")\nhook.Flush()\n</code></pre>\n\n<p>and I'm able to see this message in my loggly account.</p>\n\n<p>But, if I do something like this - </p>\n\n<pre><code>func LogrusLogger(loglevel string, message interface{}){\n    log := logrus.New()\n    hook := logrusly.NewLogglyHook(logglyToken, domain, logrus.WarnLevel, logglyUsername, logglyPassword)\n    log.Hooks.Add(hook)\n\n    log.Info(loglevel, message)\n    hook.Flush()\n}\n</code></pre>\n\n<p>then upon calling this function, the logs can be seen in the program console but not in the loggly account specified.\nAm I calling the hook.Flush() correctly? (Because I'm assuming that's the point where the logs get sent to the loggly server)</p>\n\n<p>Additional info:\nThe first piece of code is in <code>main.go</code> inside the <code>main()</code> function</p>\n\n<p>The second piece of code is in <code>utility.go</code> which has a package utility and I call the function as <code>utility.LogrusLogger(loglevel, message)</code> wherever I want after importing the package utility in that file.\nI'm pretty sure things are fine as I'm able to see the logs in the program console.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1473662955, "post_id": 39443512, "comment_id": 66211340, "body": "Please add how the generated URL should look like. Currently the question is too vague."}, {"owner": {"reputation": 137, "user_id": 5782485, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/da349415a52d4ece0e598781029d8343?s=128&d=identicon&r=PG&f=1", "display_name": "shaidiren", "link": "https://stackoverflow.com/users/5782485/shaidiren"}, "reply_to_user": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1473736575, "post_id": 39443512, "comment_id": 66244104, "body": "<a href=\"https://host:port/path?para=\" rel=\"nofollow noreferrer\">host:port/path?para=</a>{&quot;key1&quot;: value1,&quot;key2&quot;:&quot;value2&quot;},  I want to encode the parameter(in map structure) and transport it with json_encoded @RolandIllig"}], "answers": [{"tags": [], "owner": {"reputation": 137, "user_id": 5782485, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/da349415a52d4ece0e598781029d8343?s=128&d=identicon&r=PG&f=1", "display_name": "shaidiren", "link": "https://stackoverflow.com/users/5782485/shaidiren"}, "is_accepted": false, "score": 5, "last_activity_date": 1473658263, "creation_date": 1473658263, "answer_id": 39443856, "question_id": 39443512, "link": "https://stackoverflow.com/questions/39443512/how-to-encode-url-parameters-in-golang/39443856#39443856", "title": "How to encode url parameters in golang?", "body": "<p>There is the one of method to get it.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/url\"\n    \"encoding/json\"\n)\n\nfunc main() {\n    m := map[string]interface{}{\"app_id\": \"you_api\", \"app_sign\": \"md5_base_16\", \"timestamp\": \"1473655478000\"}\n    json_str, _ := json.Marshal(m)\n    fmt.Println(string(json_str[:]))\n\n    values := url.Values{\"para\": {string(json_str[:])}}\n\n    fmt.Println(values.Encode())\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2257, "user_id": 10712274, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aQMP8mldxrU/AAAAAAAAAAI/AAAAAAAAAVg/uLh1oysx8ZI/photo.jpg?sz=128", "display_name": "Reza Torkaman Ahmadi", "link": "https://stackoverflow.com/users/10712274/reza-torkaman-ahmadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1544035039, "creation_date": 1544035039, "answer_id": 53638724, "question_id": 39443512, "link": "https://stackoverflow.com/questions/39443512/how-to-encode-url-parameters-in-golang/53638724#53638724", "title": "How to encode url parameters in golang?", "body": "<p>You can use <code>url</code> built in library for that. <code>url.Parse(message)</code></p>\n"}, {"tags": [], "owner": {"reputation": 1723, "user_id": 9361998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4903f0d1b79d5499e942a376d853475?s=128&d=identicon&r=PG&f=1", "display_name": "alessiosavi", "link": "https://stackoverflow.com/users/9361998/alessiosavi"}, "is_accepted": false, "score": 1, "last_activity_date": 1569438855, "creation_date": 1569438855, "answer_id": 58105155, "question_id": 39443512, "link": "https://stackoverflow.com/questions/39443512/how-to-encode-url-parameters-in-golang/58105155#58105155", "title": "How to encode url parameters in golang?", "body": "<p>Here you can view how to urlencode a 'key-set' for send a request (like query params or form values)</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import \"net/url\"\nencoded := url.Values{}\nencoded.Set(\"grant_type\", \"urn:ibm:params:oauth:grant-type:apikey\")\nencoded.Set(\"apikey\", conf.Apikey)\n</code></pre>\n\n<p>For further information have a look here:\n<a href=\"https://github.com/alessiosavi/GoCloudant/blob/a8ad3a7990f04ea728bb327d6faea6af3e5455ca/cloudant.go#L117\" rel=\"nofollow noreferrer\">https://github.com/alessiosavi/GoCloudant/blob/a8ad3a7990f04ea728bb327d6faea6af3e5455ca/cloudant.go#L117</a></p>\n\n<p>Here a few-lines-library that wrap the builtin library for execute HTTP request used in the previous code:\n<a href=\"https://github.com/alessiosavi/Requests\" rel=\"nofollow noreferrer\">https://github.com/alessiosavi/Requests</a></p>\n"}], "owner": {"reputation": 137, "user_id": 5782485, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/da349415a52d4ece0e598781029d8343?s=128&d=identicon&r=PG&f=1", "display_name": "shaidiren", "link": "https://stackoverflow.com/users/5782485/shaidiren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8214, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1569438855, "creation_date": 1473655830, "question_id": 39443512, "link": "https://stackoverflow.com/questions/39443512/how-to-encode-url-parameters-in-golang", "title": "How to encode url parameters in golang?", "body": "<p>Is there any go package to encode url?I need to encode a parameter(type in map[string]interface{}) before it was transfered in url.</p>\n\n<p>Maybe the parameter likes:<code>map[string]interface{}{\"app_id\":\"you_api\",\"app_sign\":\"md5_base_16\",\"timestamp\":\"1473655478000\"}\n</code>\nHow to encode it and what the encoded result would be?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 106150, "user_id": 213464, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a7ba62044bc19143ea4a38cf490b67f2?s=128&d=identicon&r=PG", "display_name": "YOU", "link": "https://stackoverflow.com/users/213464/you"}, "edited": false, "score": 0, "creation_date": 1473649713, "post_id": 39442825, "comment_id": 66207832, "body": "its not nested imo"}], "answers": [{"comments": [{"owner": {"reputation": 3137, "user_id": 974864, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ca5ae67f42e78088fc795e8e4badb02d?s=128&d=identicon&r=PG&f=1", "display_name": "jimf", "link": "https://stackoverflow.com/users/974864/jimf"}, "edited": false, "score": 0, "creation_date": 1473679319, "post_id": 39442873, "comment_id": 66219596, "body": "I tried this - but I get another error: &quot;main.go:15: cannot use time.Unix(a, 0) (type time.Time) as type myTime in assignment&quot;.  Is the problem that I am trying to assign a time.Time object to an aliased type?  If the types aren&#39;t identical and you can&#39;t assign from one to the other, why alias types at all?"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 0, "last_activity_date": 1473695139, "last_edit_date": 1473695139, "creation_date": 1473649898, "answer_id": 39442873, "question_id": 39442825, "link": "https://stackoverflow.com/questions/39442825/go-assigning-to-nested-struct/39442873#39442873", "title": "Go: Assigning to nested struct", "body": "<p>time.Unix returns a time.Time value (not pointer)</p>\n\n<p>so just do <code>*t = myTime(time.Unix(a,0))</code></p>\n\n<p>This basically assigns the value returned from time.Unix(a,0) to the value pointed to by <code>t</code></p>\n\n<p>as for String, you have to make your own:</p>\n\n<p><code>func (m myTime) String() string { return time.Time(m).String() }</code></p>\n\n<p>This is because when you alias a type, you do not inherit its method set.\nso you must declare any method you want yourself.</p>\n"}], "owner": {"reputation": 3137, "user_id": 974864, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ca5ae67f42e78088fc795e8e4badb02d?s=128&d=identicon&r=PG&f=1", "display_name": "jimf", "link": "https://stackoverflow.com/users/974864/jimf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1473695139, "creation_date": 1473649349, "question_id": 39442825, "link": "https://stackoverflow.com/questions/39442825/go-assigning-to-nested-struct", "title": "Go: Assigning to nested struct", "body": "<p>Below is a code snippet - I am confused as to how to assign to variables within my nested struct (\"myTime\") which I am using for JSON decoding.  (I have some Unix timestamps in a JSON file and am hoping to learn how to decode them.)</p>\n\n<p>This throws the following error:</p>\n\n<pre><code>main.go:15: cannot use time.Unix(a, 0) (type time.Time) as type *myTime in assignment\nmain.go:25: t.String undefined (type myTime has no field or method String)\n</code></pre>\n\n<p>I'm not sure exactly how to go about understanding the issue, so any explanation or a pointer to specific documentation would help greatly! </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/binary\"\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"time\"\n)\n\ntype myTime time.Time\n\nfunc (t *myTime) UnmarshalJSON(buf []byte) error {\n    a, _ := binary.Varint(buf)\n    t = time.Unix(a, 0)\n    return nil\n}\n\nfunc main() {\n    var t myTime\n\n    if err := json.Unmarshal([]byte(\"123123123.123123\"), &amp;t); err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"result: %f\\n\", t.String())\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 4, "creation_date": 1473662543, "post_id": 39442167, "comment_id": 66211134, "body": "What is so bad about first converting the <code>int32</code> to an <code>int</code>? Why do you need to avoid it?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1473684915, "post_id": 39442167, "comment_id": 66222788, "body": "Why is this a problem? Any formatting function you pass the value into will have to convert it internally anyway."}, {"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1594270847, "post_id": 39442167, "comment_id": 111068506, "body": "<code>fmt.Sprint(i)</code> or <code>strconv.Itoa(int(i))</code> to set an int32 to a string. See <a href=\"https://stackoverflow.com/a/62737936/12817546\">stackoverflow.com/a/62737936/12817546</a>. <code>strconv.Atoi(s)</code> and <code>int32(i)</code> to set a string to an int32. See <a href=\"https://stackoverflow.com/a/62740786/12817546\">stackoverflow.com/a/62740786/12817546</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "is_accepted": false, "score": 8, "last_activity_date": 1473644311, "creation_date": 1473644311, "answer_id": 39442353, "question_id": 39442167, "link": "https://stackoverflow.com/questions/39442167/convert-int32-to-string-in-golang/39442353#39442353", "title": "Convert int32 to string in Golang", "body": "<p>The <a href=\"https://golang.org/pkg/fmt/#Sprint\" rel=\"noreferrer\">Sprint</a> function converts a given value to string.</p>\n\n<pre><code>package main\n\nimport (\n     \"fmt\"\n)\n\nfunc main() {\n\n      var sampleInt int32 = 1\n\n      sampleString := fmt.Sprint(sampleInt)\n      fmt.Printf(\"%+V %+V\\n\", sampleInt, sampleString)\n}\n\n// %!V(int32=+1) %!V(string=1)\n</code></pre>\n\n<p>See this <a href=\"https://play.golang.org/p/PvdNVNI14H\" rel=\"noreferrer\">example</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1476122909, "last_edit_date": 1476122909, "creation_date": 1473653227, "answer_id": 39443227, "question_id": 39442167, "link": "https://stackoverflow.com/questions/39442167/convert-int32-to-string-in-golang/39443227#39443227", "title": "Convert int32 to string in Golang", "body": "<p>Use a <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow\">conversion</a> and <a href=\"https://godoc.org/strconv#FormatInt\" rel=\"nofollow\">strconv.FormatInt</a> to format int32 values as a string. The conversion has zero cost on most platforms.</p>\n\n<pre><code>s := strconv.FormatInt(int64(n), 10)\n</code></pre>\n\n<p>If you have many calls like this, consider writing a helper function similar to <a href=\"https://golang.org/src/strconv/itoa.go#L24\" rel=\"nofollow\">strconv.Itoa</a>:</p>\n\n<pre><code>func formatInt32(n int32) string {\n    return strconv.FormatInt(int64(n), 10)\n}\n</code></pre>\n\n<p>All of the low-level integer formatting code in the standard library works with <code>int64</code> values. Any answer to this question using formatting code in the standard library (fmt package included) requires a <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow\">conversion</a> to <code>int64</code> somewhere. The only way to avoid the conversion is to write formatting function from scratch, but there's little point in doing that.</p>\n"}, {"comments": [{"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 1, "creation_date": 1473662721, "post_id": 39444005, "comment_id": 66211222, "body": "The question was how to do it <i>without</i> converting <code>n</code> to another integer type."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1473842317, "post_id": 39444005, "comment_id": 66290112, "body": "@RolandIllig : See this new Edit."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 82, "last_activity_date": 1473692604, "last_edit_date": 1473692604, "creation_date": 1473659176, "answer_id": 39444005, "question_id": 39442167, "link": "https://stackoverflow.com/questions/39442167/convert-int32-to-string-in-golang/39444005#39444005", "title": "Convert int32 to string in Golang", "body": "<p>One line answer is <code>fmt.Sprint(i)</code>.</p>\n\n<p>Anyway there are many conversions, even inside standard library function like <code>fmt.Sprint(i)</code>, so you have some options (try <a href=\"https://play.golang.org/p/VymwuAD-gV\">The Go Playground</a>):  </p>\n\n<hr>\n\n<p>1- You may write your conversion function (<strong>Fastest</strong>):</p>\n\n<pre><code>func String(n int32) string {\n    buf := [11]byte{}\n    pos := len(buf)\n    i := int64(n)\n    signed := i &lt; 0\n    if signed {\n        i = -i\n    }\n    for {\n        pos--\n        buf[pos], i = '0'+byte(i%10), i/10\n        if i == 0 {\n            if signed {\n                pos--\n                buf[pos] = '-'\n            }\n            return string(buf[pos:])\n        }\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>2- You may use <code>fmt.Sprint(i)</code>  (<strong>Slow</strong>)<br>\nSee inside:</p>\n\n<pre><code>// Sprint formats using the default formats for its operands and returns the resulting string.\n// Spaces are added between operands when neither is a string.\nfunc Sprint(a ...interface{}) string {\n    p := newPrinter()\n    p.doPrint(a)\n    s := string(p.buf)\n    p.free()\n    return s\n}\n</code></pre>\n\n<hr>\n\n<p>3- You may use <code>strconv.Itoa(int(i))</code>  (<strong>Fast</strong>)<br>\nSee inside:</p>\n\n<pre><code>// Itoa is shorthand for FormatInt(int64(i), 10).\nfunc Itoa(i int) string {\n    return FormatInt(int64(i), 10)\n}\n</code></pre>\n\n<hr>\n\n<p>4- You may use <code>strconv.FormatInt(int64(i), 10)</code> (<strong>Faster</strong>)<br>\nSee inside:</p>\n\n<pre><code>// FormatInt returns the string representation of i in the given base,\n// for 2 &lt;= base &lt;= 36. The result uses the lower-case letters 'a' to 'z'\n// for digit values &gt;= 10.\nfunc FormatInt(i int64, base int) string {\n    _, s := formatBits(nil, uint64(i), base, i &lt; 0, false)\n    return s\n}\n</code></pre>\n\n<hr>\n\n<p>Comparison &amp; Benchmark (with 50000000 iterations):</p>\n\n<pre><code>s = String(i)                       takes:  5.5923198s\ns = String2(i)                      takes:  5.5923199s\ns = strconv.FormatInt(int64(i), 10) takes:  5.9133382s\ns = strconv.Itoa(int(i))            takes:  5.9763418s\ns = fmt.Sprint(i)                   takes: 13.5697761s\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    //\"strconv\"\n    \"time\"\n)\n\nfunc main() {\n    var s string\n    i := int32(-2147483648)\n    t := time.Now()\n    for j := 0; j &lt; 50000000; j++ {\n        s = String(i) //5.5923198s\n        //s = String2(i) //5.5923199s\n        //s = strconv.FormatInt(int64(i), 10) // 5.9133382s\n        //s = strconv.Itoa(int(i)) //5.9763418s\n        //s = fmt.Sprint(i) // 13.5697761s\n    }\n    fmt.Println(time.Since(t))\n    fmt.Println(s)\n}\n\nfunc String(n int32) string {\n    buf := [11]byte{}\n    pos := len(buf)\n    i := int64(n)\n    signed := i &lt; 0\n    if signed {\n        i = -i\n    }\n    for {\n        pos--\n        buf[pos], i = '0'+byte(i%10), i/10\n        if i == 0 {\n            if signed {\n                pos--\n                buf[pos] = '-'\n            }\n            return string(buf[pos:])\n        }\n    }\n}\n\nfunc String2(n int32) string {\n    buf := [11]byte{}\n    pos := len(buf)\n    i, q := int64(n), int64(0)\n    signed := i &lt; 0\n    if signed {\n        i = -i\n    }\n    for {\n        pos--\n        q = i / 10\n        buf[pos], i = '0'+byte(i-10*q), q\n        if i == 0 {\n            if signed {\n                pos--\n                buf[pos] = '-'\n            }\n            return string(buf[pos:])\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7906, "user_id": 244009, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bd8e93613dba2b3b39c97afd6d065279?s=128&d=identicon&r=PG", "display_name": "codefx", "link": "https://stackoverflow.com/users/244009/codefx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53973, "favorite_count": 11, "accepted_answer_id": 39444005, "answer_count": 3, "score": 34, "last_activity_date": 1476122909, "creation_date": 1473642553, "last_edit_date": 1473659248, "question_id": 39442167, "link": "https://stackoverflow.com/questions/39442167/convert-int32-to-string-in-golang", "title": "Convert int32 to string in Golang", "body": "<p>I need to convert an <code>int32</code> to <code>string</code> in Golang. Is it possible to convert <code>int32</code> to <code>string</code> in Golang without converting to <code>int</code> or <code>int64</code> first?</p>\n\n<p><code>Itoa</code> needs an <code>int</code>. <code>FormatInt</code> needs an <code>int64</code>.</p>\n"}, {"tags": ["http", "go", "fileserver"], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1473629170, "creation_date": 1473629170, "answer_id": 39440821, "question_id": 39440634, "link": "https://stackoverflow.com/questions/39440634/why-my-fileserver-handler-doesnt-work/39440821#39440821", "title": "Why my fileServer handler doesn&#39;t work?", "body": "<p>Dot in ./Images refer cwd current working directory, not you project root. For your server to work you must run it from Test/ directory, or address Images with absolute rooted path.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 2, "last_activity_date": 1473661174, "last_edit_date": 1473661174, "creation_date": 1473630556, "answer_id": 39440968, "question_id": 39440634, "link": "https://stackoverflow.com/questions/39440634/why-my-fileserver-handler-doesnt-work/39440968#39440968", "title": "Why my fileServer handler doesn&#39;t work?", "body": "<p>You need to remove <code>*</code> and add extra sub-folder <code>Images</code>:<br>\nThis works fine:</p>\n\n<pre><code>Test/\n    main.go\n    Images/\n          Images/\n                image1.png\n                image2.png\n                index.html\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n)\n\nfunc main() {\n    fs := http.FileServer(http.Dir(\"./Images\"))\n    http.Handle(\"/Images/\", fs)\n    http.ListenAndServe(\":3003\", nil)\n}\n</code></pre>\n\n<p>Then <code>go run main.go</code></p>\n\n<p>And:</p>\n\n<p><a href=\"http://localhost:3003/Images/\" rel=\"nofollow\">http://localhost:3003/Images/</a></p>\n\n<hr>\n\n<p>Or simply use:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n)\n\nfunc main() {\n    fs := http.FileServer(http.Dir(\"./Images\"))\n    http.Handle(\"/\", fs)\n    http.ListenAndServe(\":3003\", nil)\n}\n</code></pre>\n\n<p>with:\n<a href=\"http://localhost:3003/\" rel=\"nofollow\">http://localhost:3003/</a></p>\n"}, {"tags": [], "owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "is_accepted": false, "score": 1, "last_activity_date": 1473643357, "creation_date": 1473643357, "answer_id": 39442250, "question_id": 39440634, "link": "https://stackoverflow.com/questions/39440634/why-my-fileserver-handler-doesnt-work/39442250#39442250", "title": "Why my fileServer handler doesn&#39;t work?", "body": "<p>The reason the request failed to return what you expected is because they did not match the pattern defined in the <code>http.Handle(pattern string, handler Handler)</code> call. The <a href=\"https://golang.org/pkg/net/http/#ServeMux\" rel=\"nofollow\">ServeMux</a> documentation provides a description of how to compose patterns. Any request is prefixed matched from most specific to least specific. It appears as though you have assumed a glob pattern can be used. Your handler would have been invoked with requests to <code>/Images/*&lt;file system path&gt;</code>.  You need to define a directory path like so, <code>Images/</code>.</p>\n\n<p>On a side note, it is worth considering how your program gets the directory path to serve files from. Hard coding a relative means your program will only function within a specific location within the filesystem which incredibly brittle. You could use a command line argument to allow users to specify a path or use a configuration file parsed at runtime. These considerations make your program easy to modularize and test.</p>\n"}], "owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 39440968, "answer_count": 3, "score": 1, "last_activity_date": 1473661174, "creation_date": 1473627824, "last_edit_date": 1495542255, "question_id": 39440634, "link": "https://stackoverflow.com/questions/39440634/why-my-fileserver-handler-doesnt-work", "title": "Why my fileServer handler doesn&#39;t work?", "body": "<p>I've a simple folder :</p>\n\n<pre><code>Test/\n    main.go\n    Images/\n          image1.png\n          image2.png\n          index.html\n</code></pre>\n\n<p>In main main.go I just put : </p>\n\n<pre><code>package main\n\nimport (\n       \"net/http\"\n)\n\nfunc main(){\n     fs := http.FileServer(http.Dir(\"./Images\"))\n     http.Handle(\"/Images/*\", fs)\n     http.ListenAndServe(\":3003\", nil)\n}\n</code></pre>\n\n<p>But when I curl on <em><a href=\"http://localhost:3003/Images/\" rel=\"nofollow noreferrer\">http://localhost:3003/Images/</a></em> or even I add to path file's name, it doesn't work.\nI don't understand because it's the same as the reply given on\n<a href=\"https://stackoverflow.com/questions/26559557/how-do-you-serve-a-static-html-file-using-a-go-web-server\">this subject</a></p>\n\n<p>Can you tell me so that this does not work ?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 3080873, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eb667b5943f727b85ffa422e69e6a472?s=128&d=identicon&r=PG&f=1", "display_name": "user3080873", "link": "https://stackoverflow.com/users/3080873/user3080873"}, "edited": false, "score": 0, "creation_date": 1473623031, "post_id": 39439953, "comment_id": 66202321, "body": "I have played around with unmarshaling from a hard coded string in the code. Thats no problem, it works great. Somehow the data its pulling from disk must be corrupt. Thats why im printing the string and the byte array it read from disk, but they both look fine. I am on windows so there may be some shenanigans due to my os?"}, {"owner": {"reputation": 57, "user_id": 3080873, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eb667b5943f727b85ffa422e69e6a472?s=128&d=identicon&r=PG&f=1", "display_name": "user3080873", "link": "https://stackoverflow.com/users/3080873/user3080873"}, "edited": false, "score": 0, "creation_date": 1473623229, "post_id": 39439953, "comment_id": 66202363, "body": "Oh okay, changing the struct variables to upper case did the trick, they needed to be public. Doh! Thanks so much!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 2, "last_activity_date": 1473623668, "last_edit_date": 1473623668, "creation_date": 1473622827, "answer_id": 39439953, "question_id": 39439863, "link": "https://stackoverflow.com/questions/39439863/json-unmarshal-not-returning-decoded-data/39439953#39439953", "title": "json.Unmarshal not returning decoded data", "body": "<p><a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow\">Unmarshal</a> will only set exported fields of the struct.<br>\nJust make the fields public (exported):</p>\n\n<pre><code>type redisConfig struct {\n    Host     string\n    Password string\n}\n</code></pre>\n\n<hr>\n\n<p>Using <code>ioutil.ReadFile(\"config.json\")</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n)\n\nfunc main() {\n    b, err := ioutil.ReadFile(\"config.json\")\n    if err != nil {\n        panic(err)\n    }\n    var config redisConfig\n    err = json.Unmarshal(b, &amp;config)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(config)\n}\n\ntype redisConfig struct {\n    Host     string\n    Password string\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>{example.com password123}\n</code></pre>\n\n<hr>\n\n<p>try <a href=\"https://play.golang.org/p/5IBfUR00-c\" rel=\"nofollow\">The Go Playground</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    //The file config.json contains this:\n    str := `{\n  \"host\": \"example.com\",\n  \"password\": \"password123\"\n}`\n    //b, _ := ioutil.ReadFile(\"config.json\")\n    b := []byte(str)\n    var config redisConfig\n    e := json.Unmarshal(b, &amp;config)\n    if e != nil {\n        panic(e)\n    }\n    fmt.Println(config)\n}\n\ntype redisConfig struct {\n    Host     string\n    Password string\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>{example.com password123}\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 3080873, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eb667b5943f727b85ffa422e69e6a472?s=128&d=identicon&r=PG&f=1", "display_name": "user3080873", "link": "https://stackoverflow.com/users/3080873/user3080873"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 700, "favorite_count": 0, "closed_date": 1473625524, "accepted_answer_id": 39439953, "answer_count": 1, "score": -1, "last_activity_date": 1562677098, "creation_date": 1473622125, "last_edit_date": 1562677098, "question_id": 39439863, "link": "https://stackoverflow.com/questions/39439863/json-unmarshal-not-returning-decoded-data", "closed_reason": "Duplicate", "title": "json.Unmarshal not returning decoded data", "body": "<p>I am having trouble with unmarshaling the json data read from a <code>.json</code> file</p>\n\n<pre><code>type redisConfig struct {\n    host string\n    password string\n}\n\nfunc loadRedisConfig() (redisConfig, error){\n    b, _ := ioutil.ReadFile(\"config.json\")\n    var config redisConfig\n    fmt.Println(b)\n    fmt.Println(string(b))\n\n\n    e := json.Unmarshal(b, &amp;config)\n\n    fmt.Println(e)\n\n    fmt.Println(config)\n    return config, nil;\n}\n</code></pre>\n\n<p>The file <code>config.json</code> contains this:</p>\n\n<pre><code>{\n  \"host\": \"example.com\",\n  \"password\": \"password\"\n}\n</code></pre>\n\n<p>I have verified that it is valid JSON using <a href=\"http://jsonlint.com/\" rel=\"nofollow\">http://jsonlint.com/</a>. Reading other similar questions here on SO I saw that the issue was invalid json, I do not think that is the case here.</p>\n\n<p>Here is the output from running the code snippet:</p>\n\n<pre><code>[123 13 10 32 32 34 104 111 115 116 34 58 32 34 101 120 97 109 112 108 101 46 99 111 109 34 44 13 10 32 32 34 112 97 115 115 119 111 114 100 34 58 32 34 112 97 115 115 119 111 114 100 34 13 10 125]\n{\n  \"host\": \"example.com\",\n  \"password\": \"password\"\n}\n&lt;nil&gt;\n{ }\n</code></pre>\n\n<p>The <code>config</code> variable contains an empty struct, it should be populated with the marshaled json provided by the file and decoder</p>\n"}, {"tags": ["go", "websocket"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1473619627, "post_id": 39438422, "comment_id": 66201367, "body": "<a href=\"https://github.com/gorilla/websocket/tree/master/examples/command\" rel=\"nofollow noreferrer\">Gorilla&#39;s command example</a> shows how to create a process per websocket connection."}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 5673118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/105abf7b4959bdd54486c06db0b4e450?s=128&d=identicon&r=PG&f=1", "display_name": "user9403", "link": "https://stackoverflow.com/users/5673118/user9403"}, "edited": false, "score": 0, "creation_date": 1473682495, "post_id": 39442001, "comment_id": 66221325, "body": "I&#39;d prefer to use WS over keep-alive to allow greater flexibility.  &quot;Faking&quot; an http protocol has worked well for me in the past.  For 2., I don&#39;t know how to pass a generic &quot;class&quot; into the goroutine and perform operations on the class.   I would prefer to keep the WS logic separate from the logic that deals with the external program.  In node this is solved with callbacks and in C++ with templates and callbacks."}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "reply_to_user": {"reputation": 179, "user_id": 5673118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/105abf7b4959bdd54486c06db0b4e450?s=128&d=identicon&r=PG&f=1", "display_name": "user9403", "link": "https://stackoverflow.com/users/5673118/user9403"}, "edited": false, "score": 1, "creation_date": 1473691679, "post_id": 39442001, "comment_id": 66227491, "body": "For 2. In Go you pass into goroutine http.Request which represent request(in Go &gt;= 1.7 it has Context() and WithContext() methods allowing you to provide context.Context} and ResponseWriter to write messages which represent connection. You describe goroutine to be spawned as <code>func handlerFunc(httt.ResponseWriter, *http.Request)</code> and provide all logic in it."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 1, "last_activity_date": 1473690812, "last_edit_date": 1473690812, "creation_date": 1473640703, "answer_id": 39442001, "question_id": 39438422, "link": "https://stackoverflow.com/questions/39438422/design-practices-in-handling-websocket-communication-in-golang/39442001#39442001", "title": "Design practices in handling websocket communication in golang", "body": "<ol>\n<li>You describe how http protocol works, means request-response. If that all you need you may feel good with just keep-alive connections. Websocket is async in nature, messages aren't assume responses. Use-case is server-send-events for example.</li>\n<li>In Go server uses fire-and-forget strategy. It accepts connection, spawns goroutine to handle it, forgets it and listens for a new. Spawned goroutine upgrades connection to websocket and then serves client itself without any intermediary.</li>\n</ol>\n"}], "owner": {"reputation": 179, "user_id": 5673118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/105abf7b4959bdd54486c06db0b4e450?s=128&d=identicon&r=PG&f=1", "display_name": "user9403", "link": "https://stackoverflow.com/users/5673118/user9403"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 0, "accepted_answer_id": 39442001, "answer_count": 1, "score": 0, "last_activity_date": 1473690812, "creation_date": 1473612714, "last_edit_date": 1473647592, "question_id": 39438422, "link": "https://stackoverflow.com/questions/39438422/design-practices-in-handling-websocket-communication-in-golang", "title": "Design practices in handling websocket communication in golang", "body": "<p>I am new to go and trying to learn it by replacing a nodejs server.  My nodejs server had the following components:  </p>\n\n<ol>\n<li><p>It received a websocket message from a client.  The client would provide a unique ID and a key for the message. The server would process the message based on the key (much like a REST interface would) and return a message to the client with the unique ID so that the client would know \nwhich message the server was responding to.  </p></li>\n<li><p>For some of the messages, the server would spawn an external process (one for each connection).  The server would then act as a \"client\" to the spawned process, sending JSON messages with unique IDs and receiving back data.  The server in this instance acts as an intermediary between the spawned process and the client.  </p></li>\n</ol>\n\n<p>On node it was trivial to get this to work generically.  I simply added the spawned process to the connection in my \"main\" and used callbacks in the main.  The websocket server module and the module governing the spawned process communication had no direct interaction and were completely generic. </p>\n\n<p>However, while I have a websocket package and a spawn package that work well in go, I haven't been able to figure out a good way to generically create a spawned process per websocket connection.  I've thought of passing callbacks and inits but this method seems hackish.  I recognize that node and go probably require different strategies in programming but I can't think of a good \"go\" way of doing this.  I welcome any suggestions!</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "is_accepted": true, "score": 6, "last_activity_date": 1473610218, "last_edit_date": 1473610218, "creation_date": 1473609425, "answer_id": 39437960, "question_id": 39437634, "link": "https://stackoverflow.com/questions/39437634/404-when-using-the-go-http-client/39437960#39437960", "title": "404 when using the Go http client", "body": "<p>\"get\" is not a valid HTTP Method, you want \"GET\" or http.MethodGet when you construct the request, e.g.</p>\n\n<pre><code>var req, e1 = http.NewRequest(http.MethodGet, url, nil)\n</code></pre>\n\n<p>with that change i get a successful response</p>\n\n<pre><code>&amp;{GET https://auth.docker.io/token?service=registry.docker.io&amp;scope=repository:waisbrot/wait:pull HTTP/1.1 1 1 map[] &lt;nil&gt; 0 [] false auth.docker.io map[] map[] &lt;nil&gt; map[]   &lt;nil&gt; &lt;nil&gt;}\n{\"token\":\"eyJhbGciOiJFUzI1N....\n</code></pre>\n"}], "owner": {"reputation": 18731, "user_id": 1220269, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/KVjUY.jpg?s=128&g=1", "display_name": "Nathaniel Waisbrot", "link": "https://stackoverflow.com/users/1220269/nathaniel-waisbrot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 978, "favorite_count": 0, "accepted_answer_id": 39437960, "answer_count": 1, "score": 1, "last_activity_date": 1473610218, "creation_date": 1473607398, "last_edit_date": 1592644375, "question_id": 39437634, "link": "https://stackoverflow.com/questions/39437634/404-when-using-the-go-http-client", "title": "404 when using the Go http client", "body": "<p>I want to programmatically authenticate against the Docker hub service. When I run my code, I get a 404 error. But when I pass the same URL into Curl, I get a 200. I'm not sure how to debug the problem.</p>\n<p>I use the following code:</p>\n<pre><code>import (\n    &quot;bytes&quot;\n    &quot;encoding/json&quot;\n    &quot;fmt&quot;\n    &quot;io/ioutil&quot;\n    &quot;log&quot;\n    &quot;net/http&quot;\n    &quot;strings&quot;\n    &quot;time&quot;\n)\n\ntype Image struct {\n    host, name, tag string\n}\n\nfunc authenticate(image Image) (token string) {\n    var url = fmt.Sprintf(&quot;https://auth.docker.io/token?service=%s&amp;scope=repository:%s:pull&quot;, image.host, image.name)\n    var req, e1 = http.NewRequest(&quot;get&quot;, url, nil)\n    if e1 != nil {\n        log.Fatal(e1)\n    }\n    fmt.Println(req)\n    var client = &amp;http.Client{\n        Timeout:       time.Second * 10,\n        CheckRedirect: nil,\n        Jar:           nil,\n    }\n    var res, e2 = client.Do(req)\n    if e2 != nil {\n        log.Fatal(e2)\n    }\n    var buf, e3 = ioutil.ReadAll(res.Body)\n    if e3 != nil {\n        log.Fatal(e3)\n    }\n    if res.StatusCode &gt; 299 {\n        log.Fatal(res.StatusCode, &quot;: &quot;, bytes.NewBuffer(buf).String())\n    }\n    type AuthResponse struct {\n        token string\n    }\n    var authres AuthResponse\n    fmt.Println(bytes.NewBuffer(buf).String())\n    var e4 = json.Unmarshal(buf, &amp;authres)\n    if e4 != nil {\n        log.Fatal(e4)\n    }\n    return authres.token\n}\n</code></pre>\n<p>My print statements output:</p>\n<blockquote>\n<p>&amp;{registry.docker.io waisbrot/wait latest}</p>\n<p>&amp;{get <a href=\"https://auth.docker.io/token?service=registry.docker.io&amp;scope=repository:waisbrot/wait:pull\" rel=\"nofollow noreferrer\">https://auth.docker.io/token?service=registry.docker.io&amp;scope=repository:waisbrot/wait:pull</a> HTTP/1.1 1 1 map[]  0 [] false auth.docker.io map[] map[]  map[]      }</p>\n<p>2016/09/11 11:19:42 404: 404 page not found</p>\n</blockquote>\n<p>But the URL shown does not produce a 404 in Curl (or in a web browser), so I don't understand why Go is seeing an error.</p>\n"}, {"tags": ["database", "go", "performance-testing"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1473605203, "post_id": 39437216, "comment_id": 66196863, "body": "have you ran your code with a profiler to see what&#39;s taking up the time?"}, {"owner": {"reputation": 679, "user_id": 2014530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f34c0a0dee7b7791553c7682f1023f?s=128&d=identicon&r=PG", "display_name": "Yousaf", "link": "https://stackoverflow.com/users/2014530/yousaf"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1473605240, "post_id": 39437216, "comment_id": 66196875, "body": "I am new to Go what profiler can I use for go ?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1473606307, "post_id": 39437216, "comment_id": 66197224, "body": "try this: <a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">blog.golang.org/profiling-go-programs</a>"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 2, "creation_date": 1473606361, "post_id": 39437216, "comment_id": 66197236, "body": "but in general, your code looks like PHP written in Go. instead of building dictionaries, use go&#39;s power and build statically typed structs."}, {"owner": {"reputation": 679, "user_id": 2014530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f34c0a0dee7b7791553c7682f1023f?s=128&d=identicon&r=PG", "display_name": "Yousaf", "link": "https://stackoverflow.com/users/2014530/yousaf"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1473627646, "post_id": 39437216, "comment_id": 66203538, "body": "@Not_a_Golfer ofcourse thats what it is."}, {"owner": {"reputation": 679, "user_id": 2014530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f34c0a0dee7b7791553c7682f1023f?s=128&d=identicon&r=PG", "display_name": "Yousaf", "link": "https://stackoverflow.com/users/2014530/yousaf"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1473631847, "post_id": 39437216, "comment_id": 66204561, "body": "@Not_a_Golfer please read the edits, and thanks for your time"}, {"owner": {"reputation": 679, "user_id": 2014530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f34c0a0dee7b7791553c7682f1023f?s=128&d=identicon&r=PG", "display_name": "Yousaf", "link": "https://stackoverflow.com/users/2014530/yousaf"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1473632319, "post_id": 39437216, "comment_id": 66204667, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/123124/discussion-between-yousaf-and-not-a-golfer\">continue this discussion in chat</a>."}, {"owner": {"reputation": 679, "user_id": 2014530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f34c0a0dee7b7791553c7682f1023f?s=128&d=identicon&r=PG", "display_name": "Yousaf", "link": "https://stackoverflow.com/users/2014530/yousaf"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1474063510, "post_id": 39437216, "comment_id": 66395390, "body": "@Not_a_Golfer got it fixed check my answer, by the thanks for your help :)"}], "answers": [{"comments": [{"owner": {"reputation": 5118, "user_id": 1185534, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/128f8ce5456a7c64f67626b2b756c7e6?s=128&d=identicon&r=PG", "display_name": "Seer", "link": "https://stackoverflow.com/users/1185534/seer"}, "edited": false, "score": 0, "creation_date": 1591606183, "post_id": 39540723, "comment_id": 110108930, "body": "I know this is nearly 4 years later, but one reason your Go code might also be slower is because you&#39;re not closing the database rows (e.g. <code>defer rows.Close()</code> - but check the error!), and are therefore having to create a new connection for every query you run, rather than reusing any existing connections (because you never release any of the connections!)"}], "tags": [], "owner": {"reputation": 679, "user_id": 2014530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f34c0a0dee7b7791553c7682f1023f?s=128&d=identicon&r=PG", "display_name": "Yousaf", "link": "https://stackoverflow.com/users/2014530/yousaf"}, "is_accepted": true, "score": 0, "last_activity_date": 1474063444, "creation_date": 1474063444, "answer_id": 39540723, "question_id": 39437216, "link": "https://stackoverflow.com/questions/39437216/golang-code-running-really-slow-than-same-code-in-php/39540723#39540723", "title": "Golang code running really slow than same code in PHP", "body": "<p>Ok So got it fixed by the way. I brought the request time from <strong>5k+ MS</strong> to <strong>500 MS</strong>, now finally my PHP code is slower which is <strong>900 MS</strong></p>\n\n<p>I got rid of the inner loop to search by implementing a separate function to get SQL data in a different data structure in key value of maps instead of searching whole arrays I created the value as key which I was looking for in array, This way I got rid of the second loop which was making trouble by linear search on strings.</p>\n\n<pre><code>manualGroups := sqlToArraySpecial(db, \"****\")\n\n    for _, manualList := range manualListings {\n        //index := stringInSliceArray(manualList.DateCreated, manualGroups)\n        groupId := \"142,\" + manualList.DateCreated\n        var entry listingsType\n        entry.TicketId = manualList.TicketId\n        entry.DateCreated = manualGroups[groupId]\n        normalListings = append(normalListings, entry)\n\n    }\n</code></pre>\n\n<p>and here is my new SQL function</p>\n\n<pre><code>func sqlToArraySpecial(db *sql.DB, sqlString string) map[string]string {\n\n    rows, err := db.Query(sqlString)\n    checkErr(err)\n\n    tableData := make(map[string]string)\n\n    for rows.Next() {\n\n        var date_created string\n        var ticket_id string\n\n        rows.Scan(&amp;ticket_id, &amp;date_created)\n        //fmt.Println(ticket_id)\n        tableData[ticket_id] = date_created\n\n    }\n\n    return tableData\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 679, "user_id": 2014530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f34c0a0dee7b7791553c7682f1023f?s=128&d=identicon&r=PG", "display_name": "Yousaf", "link": "https://stackoverflow.com/users/2014530/yousaf"}, "edited": false, "score": 0, "creation_date": 1481150441, "post_id": 41025575, "comment_id": 69264817, "body": "I agree with you. Thats what I actually recognized and than fixed my code. See answer below.. :) peace"}], "tags": [], "owner": {"reputation": 1844, "user_id": 4844024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9de342e1ce408f4874eac3f019efb33?s=128&d=identicon&r=PG&f=1", "display_name": "mad.meesh", "link": "https://stackoverflow.com/users/4844024/mad-meesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1481138228, "creation_date": 1481138228, "answer_id": 41025575, "question_id": 39437216, "link": "https://stackoverflow.com/questions/39437216/golang-code-running-really-slow-than-same-code-in-php/41025575#41025575", "title": "Golang code running really slow than same code in PHP", "body": "<p>although this is a dead post, I cannot help but note since no one else has (explicitly), and it's kinda' important to know <em>why</em>:</p>\n\n<ul>\n<li>nested for loops exhibit quadratic running time complexity,</li>\n<li>and as you stated, searching an array takes linear time,</li>\n</ul>\n\n<p>so simply put:</p>\n\n<ul>\n<li>the computation time will increase by the square of the total number of elements.</li>\n</ul>\n\n<p>now to answer why this isn't the case in php -- well cause you were using a hash map which:</p>\n\n<ul>\n<li>can be said, exhibits a constant time complexity</li>\n</ul>\n\n<p>again, simply put this means that:</p>\n\n<ul>\n<li>look up time is not related to the number of elements (aka the size of the collection).</li>\n</ul>\n\n<p>see: <a href=\"https://en.wikipedia.org/wiki/Big_O_notation\" rel=\"nofollow noreferrer\">big-o</a></p>\n\n<p>with all that being said, please note: </p>\n\n<ul>\n<li>i don't know php,\n\n<ul>\n<li>thus do not the know details regarding how the language implements arrays, and</li>\n</ul></li>\n<li>im not an algorithm expert,</li>\n</ul>\n\n<p>so please treat my post as a statement for the <em>general</em> case.</p>\n\n<p><strong>pce</strong></p>\n"}], "owner": {"reputation": 679, "user_id": 2014530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f34c0a0dee7b7791553c7682f1023f?s=128&d=identicon&r=PG", "display_name": "Yousaf", "link": "https://stackoverflow.com/users/2014530/yousaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1129, "favorite_count": 0, "accepted_answer_id": 39540723, "answer_count": 2, "score": 0, "last_activity_date": 1481138228, "creation_date": 1473604900, "last_edit_date": 1473969112, "question_id": 39437216, "link": "https://stackoverflow.com/questions/39437216/golang-code-running-really-slow-than-same-code-in-php", "title": "Golang code running really slow than same code in PHP", "body": "<p>New to Golang, Yesterday I started to play with Golang and wrote some code which was actually written in PHP, I just wanted to see difference in performance. I am doing the exact same thing in PHP response is exact same in http request but the Golang is performing really slow even after compiling it. I am trying to understand what things that I am using in Golang I shouldn't be using and how can I imporve performance in this piece of Code. I know Iterating over map is slow but PHP using hash maps for implementing multidimentional arrays, well. I can gurantee the sql queries I used were exact same copy pasted from PHP, machines are same, and loop numbers are same in both codes.  </p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"encoding/json\"\n    \"fmt\"\n    _ \"github.com/go-sql-driver/mysql\"\n    \"net/http\"\n    \"reflect\"\n    \"strings\"\n)\n\nfunc main() {\n    db, err := sql.Open(\"mysql\", \"***:****@tcp(****:3306)/****\")\n    fmt.Println(reflect.TypeOf(db))\n    checkErr(err)\n    fmt.Println(\"Handle Request setup... OK\")\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, req *http.Request) {\n\n        jsonData, err := getListings(db)\n        checkErr(err)\n\n        w.Write([]byte(jsonData))\n\n    })\n    fmt.Println(\"Starting Server....\")\n    fmt.Println(\"Listening on port 8081\")\n    http.ListenAndServe(\":8081\", nil)\n\n}\n\nfunc getListings(db *sql.DB) ([]byte, error) {\n    var userId string = \"142\"\n\n    normalListings := sqlToArray(db, `******`)\n\n    manualListings := sqlToArray(db, \"******\")\n\n    var groupIds []string\n    for key := range manualListings {\n\n        groupId := \"142,\" + manualListings[key][\"group_id\"]\n        if !stringInSlice(groupId, groupIds) {\n            groupIds = append(groupIds, groupId)\n        }\n    }\n\n    var groupIdsString string\n    groupIdsString = strings.Join(groupIds, \", \")\n\n    manualGroups := sqlToArray(db, \"*****\")\n\n    for key := range manualListings {\n\n        for key2 := range manualGroups {\n            groupId := \"142,\" + manualListings[key][\"group_id\"]\n\n            if groupId == manualGroups[key][\"ticket_id\"] {\n                entry := make(map[string]string)\n                entry[\"ticket_id\"] = manualListings[key][\"listing_id\"]\n                entry[\"date_created\"] = manualGroups[key2][\"date_created\"]\n                normalListings = append(normalListings, entry)\n\n            }\n        }\n    }\n\n    return json.Marshal(normalListings)\n\n}\n\nfunc stringInSlice(a string, list []string) bool {\n    for _, b := range list {\n        if b == a {\n            return true\n        }\n    }\n    return false\n}\n\nfunc sqlToArray(db *sql.DB, sqlString string) []map[string]string {\n\n    rows, err := db.Query(sqlString)\n    checkErr(err)\n    columns, err := rows.Columns()\n    count := len(columns)\n    values := make([]interface{}, count)\n    valuePtrs := make([]interface{}, count)\n    tableData := make([]map[string]string, 0)\n\n    for rows.Next() {\n\n        for i := 0; i &lt; count; i++ {\n            valuePtrs[i] = &amp;values[i]\n        }\n        rows.Scan(valuePtrs...)\n        entry := make(map[string]string)\n        for i, col := range columns {\n\n            val := values[i]\n            b, ok := val.([]byte)\n            if ok {\n                entry[col] = string(b)\n            } else {\n                entry[col] = string(b)\n            }\n\n        }\n        tableData = append(tableData, entry)\n\n    }\n\n    return tableData\n\n}\n\nfunc checkErr(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p><strong>Edits:</strong>\nChanged the code to use statically typed structs instead of using maps and Identified the problematic piece of code</p>\n\n<p><strong>New code:</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"encoding/json\"\n    \"fmt\"\n    _ \"github.com/go-sql-driver/mysql\"\n    \"net/http\"\n    \"strings\"\n)\n\ntype listingsType struct {\n    TicketId    string\n    DateCreated string\n}\n\nfunc main() {\n    db, err := sql.Open(\"mysql\", \"******\")\n\n    checkErr(err)\n    fmt.Println(\"Handle Request setup... OK\")\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, req *http.Request) {\n\n        jsonData, err := getListings(db)\n        checkErr(err)\n\n        w.Write([]byte(jsonData))\n\n    })\n    fmt.Println(\"Starting Server....\")\n    fmt.Println(\"Listening on port 8081\")\n    http.ListenAndServe(\":8081\", nil)\n\n}\n\nfunc getListings(db *sql.DB) ([]byte, error) {\n    var userId string = \"142\"\n\n    normalListings := sqlToArray(db, `*****`)\n\n    manualListings := sqlToArray(db, \"*****\")\n\n    var groupIds []string\n\n    for _, elem := range manualListings {\n        groupId := \"142,\" + elem.DateCreated\n        if !stringInSlice(groupId, groupIds) {\n            groupIds = append(groupIds, groupId)\n        }\n\n    }\n\n    var groupIdsString string\n    groupIdsString = strings.Join(groupIds, \", \")\n    fmt.Println(groupIdsString)\n    manualGroups := sqlToArray(db, \"******\")\n\n    for _, manualList := range manualListings {\n\n        for _, manualGroup := range manualGroups {\n            groupId := \"142,\" + manualList.DateCreated\n\n            if groupId == manualGroup.TicketId {\n                var entry listingsType\n                entry.TicketId = manualList.TicketId\n                entry.DateCreated = manualGroup.DateCreated\n                normalListings = append(normalListings, entry)\n\n            }\n        }\n    }\n\n    return json.Marshal(normalListings)\n\n}\n\nfunc stringInSlice(a string, list []string) bool {\n    for _, b := range list {\n        if b == a {\n            return true\n        }\n    }\n    return false\n}\n\nfunc sqlToArray(db *sql.DB, sqlString string) []listingsType {\n\n    rows, err := db.Query(sqlString)\n    checkErr(err)\n\n    tableData := []listingsType{}\n\n    for rows.Next() {\n\n        var entry listingsType\n        rows.Scan(&amp;entry.TicketId, &amp;entry.DateCreated)\n\n        tableData = append(tableData, entry)\n\n    }\n\n    return tableData\n\n}\n\nfunc checkErr(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p><strong>Problematic piece of code</strong>\nAs soon as I comment the following block of code the my code performs just fine. Any idea what is wrong with this loop ?</p>\n\n<pre><code>for _, manualList := range manualListings {\n\n        for _, manualGroup := range manualGroups {\n            groupId := \"142,\" + manualList.DateCreated\n\n            if groupId == manualGroup.TicketId {\n                var entry listingsType\n                entry.TicketId = manualList.TicketId\n                entry.DateCreated = manualGroup.DateCreated\n                normalListings = append(normalListings, entry)\n\n            }\n        }\n    }\n</code></pre>\n\n<p><strong>Profiling Result</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/Kzq7F.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kzq7F.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["string", "go", "int64"], "comments": [{"owner": {"reputation": 815, "user_id": 5595052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VCv1pzX179I/AAAAAAAAAAI/AAAAAAAAANM/1-bBYl0T9ZE/photo.jpg?sz=128", "display_name": "jnmoal", "link": "https://stackoverflow.com/users/5595052/jnmoal"}, "edited": false, "score": 1, "creation_date": 1473602699, "post_id": 39436701, "comment_id": 66196163, "body": "the runtime error is due to the use of the [5:]. this means I want the character from index 5 to the end of the string. But, how do you now that your token contains at least 6 digits (like 100 000)?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1473603067, "post_id": 39436701, "comment_id": 66196253, "body": "Your string has fewer than 5 characters. Verify it before you index into it"}, {"owner": {"reputation": 65, "user_id": 1080674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3448b3cb7a810959aa15339156941d7?s=128&d=identicon&r=PG", "display_name": "Juanse", "link": "https://stackoverflow.com/users/1080674/juanse"}, "reply_to_user": {"reputation": 815, "user_id": 5595052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VCv1pzX179I/AAAAAAAAAAI/AAAAAAAAANM/1-bBYl0T9ZE/photo.jpg?sz=128", "display_name": "jnmoal", "link": "https://stackoverflow.com/users/5595052/jnmoal"}, "edited": false, "score": 0, "creation_date": 1473604839, "post_id": 39436701, "comment_id": 66196757, "body": "@Jean-NicolasMoal Yes it has at least 6 digits. I&#39;ve just updated my post"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 1080674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3448b3cb7a810959aa15339156941d7?s=128&d=identicon&r=PG", "display_name": "Juanse", "link": "https://stackoverflow.com/users/1080674/juanse"}, "edited": false, "score": 0, "creation_date": 1473607227, "post_id": 39437510, "comment_id": 66197498, "body": "if io.Copy returns the number of bites, how is it that in my example cadenita shows a string and not a number?"}, {"owner": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "reply_to_user": {"reputation": 65, "user_id": 1080674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3448b3cb7a810959aa15339156941d7?s=128&d=identicon&r=PG", "display_name": "Juanse", "link": "https://stackoverflow.com/users/1080674/juanse"}, "edited": false, "score": 1, "creation_date": 1473607942, "post_id": 39437510, "comment_id": 66197753, "body": "because you copy the response to stdOut, the output is from the Copy call, the 35 at the end of the line is from the &quot;token&quot; value"}, {"owner": {"reputation": 65, "user_id": 1080674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3448b3cb7a810959aa15339156941d7?s=128&d=identicon&r=PG", "display_name": "Juanse", "link": "https://stackoverflow.com/users/1080674/juanse"}, "edited": false, "score": 0, "creation_date": 1473608443, "post_id": 39437510, "comment_id": 66197922, "body": "since token will not be used, that line can be replaced by _, err := io.Copy(&amp;buff, reader)"}], "tags": [], "owner": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "is_accepted": true, "score": 2, "last_activity_date": 1473608978, "last_edit_date": 1473608978, "creation_date": 1473606631, "answer_id": 39437510, "question_id": 39436701, "link": "https://stackoverflow.com/questions/39436701/in-golang-transformation-from-int64-to-string-and-then-slice-doesnt-work/39437510#39437510", "title": "In Golang, transformation from int64 to string and then slice doesn&#39;t work", "body": "<p>io.Copy returns the number of bytes copied, so that's the value thats in your token variable, so somewhere in the area of 40 for your example. FormatInt converts that to a string \"40\" which only has 2 chars, so it'll error as you see when you ask for the substring starting at char 5 of \"40\".</p>\n\n<p>Are you trying to get the actual response data in token? if so you'll need to copy it into a buffer, e.g.</p>\n\n<pre><code>buff := bytes.Buffer{}\n_, err := io.Copy(&amp;buff, reader)\nif err != nil {\n    log.Fatal(err)\n}\nfmt.Println(buff.String()[5:])\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 1080674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3448b3cb7a810959aa15339156941d7?s=128&d=identicon&r=PG", "display_name": "Juanse", "link": "https://stackoverflow.com/users/1080674/juanse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 39437510, "answer_count": 1, "score": 0, "last_activity_date": 1473608978, "creation_date": 1473601310, "last_edit_date": 1473604768, "question_id": 39436701, "link": "https://stackoverflow.com/questions/39436701/in-golang-transformation-from-int64-to-string-and-then-slice-doesnt-work", "title": "In Golang, transformation from int64 to string and then slice doesn&#39;t work", "body": "<p>I've have this code on a client that receives a  gzipped response from an API : </p>\n\n<pre><code>client := &amp;http.Client{}\nresponse, _ := client.Do(r)\n\n// Check that the server actual sent compressed data\nvar reader io.ReadCloser\nswitch response.Header.Get(\"Content-Encoding\") {\ncase \"gzip\":\n    reader, err := gzip.NewReader(response.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer reader.Close()\ndefault:\n    reader = response.Body\n}\n\ntoken, err := io.Copy(os.Stdout, reader)\nif err != nil {\n    log.Fatal(err)\n}\n\ncadenita := strconv.FormatInt(token, 10)\n\nfmt.Println(cadenita)\n\ncadena := \"code=b2cc1793-cb7a-ea8d-3c82-766557\"\nfmt.Println(cadena[5:])\n</code></pre>\n\n<p>This code shows :\n<a href=\"https://i.stack.imgur.com/DzSPd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DzSPd.png\" alt=\"enter image description here\"></a></p>\n\n<p>But, if I use [5:] directly on cadenita, although it's also a string, I have this error.</p>\n\n<p><a href=\"https://i.stack.imgur.com/wrUs5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wrUs5.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to be able to slice and regex on the token(int64) transformed in a string. How can I do so ?</p>\n"}, {"tags": ["mysql", "go", "revel"], "comments": [{"owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "edited": false, "score": 0, "creation_date": 1473553900, "post_id": 39431794, "comment_id": 66186766, "body": "Is it possible to use directly inside index wothout gorm?"}], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "edited": false, "score": 0, "creation_date": 1473554679, "post_id": 39431815, "comment_id": 66186906, "body": "Ugh.. always so easy and takes me forever to figure out. Thank you!"}], "tags": [], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "is_accepted": true, "score": 1, "last_activity_date": 1473554130, "creation_date": 1473554130, "answer_id": 39431815, "question_id": 39431794, "link": "https://stackoverflow.com/questions/39431794/using-mysql-db-for-revel-without-gorm/39431815#39431815", "title": "using mysql db for revel without gorm", "body": "<p>You are declaring your variable in a wrong way. The current way you are using its like declaring a normal variable for the InitDB scope (you are using := ).</p>\n\n<pre><code>func InitDB() {\n\n    var err error\n    Db, err = sql.Open(\"mysql\", \"username:xxxxxxx@tcp(xxxxxxx:3306)/xxxx\")\n    if err != nil {\n        revel.INFO.Println(\"DB Error\", err)\n    }\n    revel.INFO.Println(\"DB Connected\")\n    //fmt.Println(Db)\n\n}\n</code></pre>\n\n<p>I also suggest creating a folder inside app called controllers to store all your route logic and if needed call the app.Db variable</p>\n\n<p>This should work</p>\n"}], "owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 39431815, "answer_count": 1, "score": 0, "last_activity_date": 1473554130, "creation_date": 1473553826, "question_id": 39431794, "link": "https://stackoverflow.com/questions/39431794/using-mysql-db-for-revel-without-gorm", "title": "using mysql db for revel without gorm", "body": "<p>I've placed everything into app.go and the database opens correctly but Index cannot access the global variable. The global variable doesn't seem to be global because if I remove the use of Db after assigning it inside InitDB I get the error \"Db declared and not used\"</p>\n\n<pre><code>package controllers\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n\n    _ \"github.com/go-sql-driver/mysql\"\n    \"github.com/revel/revel\"\n)\n\nvar Db *sql.DB\n\ntype App struct {\n    *revel.Controller\n}\n\nfunc (c App) Index() revel.Result {\n    if c.Params.Get(\"id\") == \"3012\" {\n\n        return c.Redirect(\"http://youtube.com\")\n    }\n    fmt.Println(\"here is the db from index:\", Db)\n    return c.Render()\n}\n\nfunc InitDB() {\n\n    // open db\n    Db, err := sql.Open(\"mysql\", \"username:xxxxxxx@tcp(xxxxxxx:3306)/xxxx\")\n    if err != nil {\n        revel.INFO.Println(\"DB Error\", err)\n    }\n    revel.INFO.Println(\"DB Connected\")\n    //fmt.Println(Db)\n\n}\n\nfunc init() {\n    revel.OnAppStart(InitDB)\n}\n</code></pre>\n\n<p>any help would be appreciated! Thanks. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1473590998, "post_id": 39431521, "comment_id": 66193124, "body": "Can you use <a href=\"https://github.com/kataras/iris/blob/master/context.go#L820\" rel=\"nofollow noreferrer\">github.com/kataras/iris/blob/master/context.go#L820</a> ?"}], "answers": [{"tags": [], "owner": {"reputation": 769, "user_id": 2647655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qGHOi.png?s=128&g=1", "display_name": "kataras", "link": "https://stackoverflow.com/users/2647655/kataras"}, "is_accepted": false, "score": 1, "last_activity_date": 1510939845, "last_edit_date": 1510939845, "creation_date": 1474620516, "answer_id": 39656536, "question_id": 39431521, "link": "https://stackoverflow.com/questions/39431521/golang-iris-webframework-share-between-handlers/39656536#39656536", "title": "Golang (iris webframework) share between handlers", "body": "<pre><code>// retrieve local storage or previous handler,\n// this is how handlers can share values, with the context's Values().\nlogged := ctx.Values().Get(\"logged\")\n\n// set template data {{.isLogged}}\nctx.ViewData(\"isLogged\", logged)\n\n// and finally, render the mypage.html\nctx.View(\"mypage.html\")\n</code></pre>\n\n<p><code>\"logged\"</code> can be set to your middleware/any previous handler by:</p>\n\n<p><code>ctx.Values().Set(\"logged\", false)</code></p>\n\n<p>All these are described to the examples, you're welcome to explore some of those there: <a href=\"https://github.com/kataras/iris/tree/master/_examples\" rel=\"nofollow noreferrer\">https://github.com/kataras/iris/tree/master/_examples</a></p>\n\n<p>Happy Coding!</p>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510939845, "creation_date": 1473550437, "question_id": 39431521, "link": "https://stackoverflow.com/questions/39431521/golang-iris-webframework-share-between-handlers", "title": "Golang (iris webframework) share between handlers", "body": "<p>I am currently using the iris web framework and since questions cannot be asked on the issue tracker and the community chat is dead I am asking this here hoping someone helps me out.</p>\n\n<p>I need to pass data to the c.Render function</p>\n\n<p>I have a handler that checks if the user is logged or not. If its not logged I should add an extra button to the html page</p>\n\n<pre><code>iris.Use(userHandler{})\n\ntype userHandler struct{\n    Allow bool\n}\n\nfunc (u userHandler) Serve(c *iris.Context) {\n    ...\n    if isLogged {\n        // When I call from another middleware (c.Next) c.Render it should know that the user is logged in\n    }\n    c.Next()\n}\n</code></pre>\n\n<p>So is it possible to add some default data to the c.Render function?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 4366, "user_id": 176478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a10b460f85d3d8b9702782bf6dd72307?s=128&d=identicon&r=PG", "display_name": "dmportella", "link": "https://stackoverflow.com/users/176478/dmportella"}, "is_accepted": true, "score": 17, "last_activity_date": 1473521906, "last_edit_date": 1473521906, "creation_date": 1473521483, "answer_id": 39427606, "question_id": 39427544, "link": "https://stackoverflow.com/questions/39427544/golang-http-response-headers-being-removed/39427606#39427606", "title": "golang http response headers being removed", "body": "<p>Headers can only be written once to the response so you must set all the headers before writting them. Once the headers are written they are sent to the client.</p>\n\n<p>You should only call <code>w.WriteHeader(http.StatusCreated)</code> once you have set all your headers.</p>\n\n<p><a href=\"https://golang.org/pkg/net/http/#ResponseWriter\">Read in the GOLANG spec how WriteHeader works</a></p>\n\n<p>This rule is the same for the body once the body is written (writting to the response is literally sending it to the client) it can not be resent or changed.</p>\n"}], "owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2581, "favorite_count": 1, "accepted_answer_id": 39427606, "answer_count": 1, "score": 9, "last_activity_date": 1473521906, "creation_date": 1473521060, "question_id": 39427544, "link": "https://stackoverflow.com/questions/39427544/golang-http-response-headers-being-removed", "title": "golang http response headers being removed", "body": "<p>I'm not sure if this is a bug or how the http response package is supposed to work.</p>\n\n<p>In this example the <code>Content-Type</code> response header will not be set</p>\n\n<pre><code>// Return the response\nw.WriteHeader(http.StatusCreated)\nw.Header().Set(\"Content-Type\", \"application/json\")\nw.Write(js)\n</code></pre>\n\n<p>How ever if I flip the order of how the headers are set it does work:</p>\n\n<pre><code>// Return the response\nw.Header().Set(\"Content-Type\", \"application/json\")\nw.WriteHeader(http.StatusCreated)\nw.Write(js)\n</code></pre>\n\n<p>Now this will actual set the header to <code>application/json</code>. Is this behavior intended? </p>\n"}, {"tags": ["model-view-controller", "go", "init"], "answers": [{"tags": [], "owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "is_accepted": false, "score": 1, "last_activity_date": 1473667707, "last_edit_date": 1473667707, "creation_date": 1473540046, "answer_id": 39430398, "question_id": 39427299, "link": "https://stackoverflow.com/questions/39427299/connection-db-in-golang/39430398#39430398", "title": "Connection DB in golang", "body": "<p>I always do some packega where i keep my enviroment variables.</p>\n\n<p>For example <code>main.go</code></p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n     env \"github.com/vardius/example/enviroment\"\n)\n\nfunc main() {\n    //some extra code here, http srever or something\n    defer env.DB.Close()\n}\n</code></pre>\n\n<p>end inside <code>enviroment</code> dir <code>env.go</code></p>\n\n<pre><code>package env\n\nimport (\n    \"database/sql\"\n\n    _ \"github.com/go-sql-driver/mysql\"\n)\n\nvar (\n    DB     *sql.DB\n)\n\nfunc connectToDB(dbURL string) *sql.DB {\n    conn, err := sql.Open(\"mysql\", dbURL)\n    //check for err\n\n    return conn\n}\n\nfunc init() {\n    DB = connectToDB(\"root:password@tcp(127.0.0.1:3306)/test\")\n}\n</code></pre>\n\n<p>this way you initialize once your DB and can use it in all parts of your app by injecting env</p>\n\n<blockquote>\n  <p>Ofcourse this solution has some downsides. First, code is harder to\n  ponder because the dependencies of a component are unclear. Second,\n  testing these components is made more difficult, and running tests in\n  parallel is near impossible. With global connections, tests that hit\n  the same data in a backend service could not be run in parallel.</p>\n</blockquote>\n\n<p>There is a great article about a <a href=\"http://blog.parse.com/learn/engineering/dependency-injection-with-go/\" rel=\"nofollow\">Dependency Injection with Go</a></p>\n\n<p>I hope you will find this helpfull</p>\n"}, {"comments": [{"owner": {"reputation": 540, "user_id": 4320971, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GTaVLU9qvKk/AAAAAAAAAAI/AAAAAAAAAzg/6UaPy5Cx1ys/photo.jpg?sz=128", "display_name": "Niko Kovacevic", "link": "https://stackoverflow.com/users/4320971/niko-kovacevic"}, "edited": false, "score": 1, "creation_date": 1531160312, "post_id": 39433050, "comment_id": 89482376, "body": "This is from a blog post by Alex Edwards: <a href=\"https://www.alexedwards.net/blog/organising-database-access\" rel=\"nofollow noreferrer\">alexedwards.net/blog/organising-database-access</a>"}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 3, "last_activity_date": 1502802326, "last_edit_date": 1502802326, "creation_date": 1473570304, "answer_id": 39433050, "question_id": 39427299, "link": "https://stackoverflow.com/questions/39427299/connection-db-in-golang/39433050#39433050", "title": "Connection DB in golang", "body": "<p>You can use global variables, but I don't suggest to do it. What happens in more complicated applications where database logic is spread over multiple packages? It's better to use dependency injection:</p>\n\n<p>File: main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"bookstore/models\"\n    \"database/sql\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n)\n\ntype Env struct {\n    db *sql.DB\n}\n\nfunc main() {\n    db, err := models.NewDB(\"postgres://user:pass@localhost/bookstore\")\n    if err != nil {\n        log.Panic(err)\n    }\n    env := &amp;Env{db: db}\n\n    http.HandleFunc(\"/books\", env.booksIndex)\n    http.ListenAndServe(\":3000\", nil)\n}\n\nfunc (env *Env) booksIndex(w http.ResponseWriter, r *http.Request) {\n    if r.Method != \"GET\" {\n        http.Error(w, http.StatusText(405), 405)\n        return\n    }\n    bks, err := models.AllBooks(env.db)\n    if err != nil {\n        http.Error(w, http.StatusText(500), 500)\n        return\n    }\n    for _, bk := range bks {\n        fmt.Fprintf(w, \"%s, %s, %s, \u00a3%.2f\\n\", bk.Isbn, bk.Title, bk.Author, bk.Price)\n    }\n}\n</code></pre>\n\n<p>File: models/db.go</p>\n\n<pre><code>package models\n\nimport (\n    \"database/sql\"\n    _ \"github.com/lib/pq\"\n)\n\nfunc NewDB(dataSourceName string) (*sql.DB, error) {\n    db, err := sql.Open(\"postgres\", dataSourceName)\n    if err != nil {\n        return nil, err\n    }\n    if err = db.Ping(); err != nil {\n        return nil, err\n    }\n    return db, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 5253536, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh6.googleusercontent.com/-1-_ML3iG1Yw/AAAAAAAAAAI/AAAAAAAAABI/G_t-YKqspMQ/photo.jpg?sz=128", "display_name": "Patryk Gtfo", "link": "https://stackoverflow.com/users/5253536/patryk-gtfo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1768, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1502802326, "creation_date": 1473519562, "question_id": 39427299, "link": "https://stackoverflow.com/questions/39427299/connection-db-in-golang", "title": "Connection DB in golang", "body": "<p>Where i can put initialize files like languages, connection db etc. in mvc structur golang (beego,revel)?</p>\n\n<p>I tried to use in controller but it isn't good.</p>\n\n<p>Is a good solution would be create base controller and put here all init connection, languages etc? or is there some other way (better)?</p>\n"}, {"tags": ["recursion", "go", "filesystemwatcher"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1473524324, "post_id": 39427199, "comment_id": 66179581, "body": "Can&#39;t reproduce behaviour on my machine. To my mind deal is either a typo or  w.W.Add(path) which you didn&#39;t provide. Without w.W.Add(path) your code output correctly on my machine."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1473533550, "last_edit_date": 1473533550, "creation_date": 1473523011, "answer_id": 39427871, "question_id": 39427199, "link": "https://stackoverflow.com/questions/39427199/golang-file-directory-walker-adding-files-multiple-times/39427871#39427871", "title": "Golang File/Directory Walker adding files multiple times", "body": "<p>Check your main code, this works fine, (try <a href=\"https://play.golang.org/p/kT5sDgY9cV\" rel=\"nofollow\">The Go Playground</a>):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"path/filepath\"\n    \"reflect\"\n    \"time\"\n)\n\nfunc main() {\n    rootDir := \"..\"\n    pattern := \"*\"\n    dirs, err := GetDirectories(rootDir, pattern)\n    if err != nil {\n        panic(err)\n    }\n    ticker := time.NewTicker(1 * time.Second)\n    for i := 1; i &lt; 10; i++ {\n        &lt;-ticker.C\n        dirs2, err := GetDirectories(rootDir, pattern)\n        //fmt.Println(dirs2)\n        if err != nil {\n            panic(err)\n        }\n        if !reflect.DeepEqual(dirs, dirs2) {\n            fmt.Println(\"Dir Changed: \", len(dirs), len(dirs2))\n            dirs = dirs2\n        }\n    }\n    ticker.Stop()\n    fmt.Println(\"Done\")\n}\n\n// Returns the names of the subdirectories (including their paths)\n// that match the specified search pattern in the specified directory.\nfunc GetDirectories(root, pattern string) ([]string, error) {\n    dirs := make([]string, 0, 144)\n    return dirs, filepath.Walk(root, func(path string, fi os.FileInfo, err error) error {\n        if !fi.IsDir() {\n            return nil\n        }\n        matched, err := filepath.Match(pattern, fi.Name())\n        if err != nil {\n            return err\n        }\n        if !matched {\n            return nil\n        }\n        dirs = append(dirs, path)\n        return nil\n    })\n}\n</code></pre>\n\n<p>Sample output ( with one new dir):</p>\n\n<pre><code>Dir Changed:  16 17\nDone\n</code></pre>\n"}], "owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 830, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1473533550, "creation_date": 1473518863, "last_edit_date": 1473523401, "question_id": 39427199, "link": "https://stackoverflow.com/questions/39427199/golang-file-directory-walker-adding-files-multiple-times", "title": "Golang File/Directory Walker adding files multiple times", "body": "<p>So I am using the <code>filepath.Walk</code> function to monitor for changes in files recursively. <code>fsnotify</code> can't do recursive out of the box. I set up a Goroutine to monitor for changes, and then I add the paths to the watcher in the <code>Walk()</code> function.</p>\n\n<pre><code>func (w Watch) walkDirectories(fp string) {\n    error := filepath.Walk(fp, func(path string, info os.FileInfo, err error) error {\n        // skip files\n        if info == nil {\n            log.Fatalf(\"wrong watcher package: %s\", path)\n        }\n        if !info.IsDir() {\n            return nil\n        }\n        if len(path) &gt; 1 &amp;&amp; strings.HasPrefix(filepath.Base(path), \".\") {\n            return filepath.SkipDir\n        }\n        log.Println(\"filepath: \", filepath)\n        w.W.Add(path)\n        return err\n    })\n    log.Println(\"error: \", error)\n}\n</code></pre>\n\n<p>I have a custom Struct that holds a Watcher, so that I can easily add paths for it to watch. You can see it being used here: <code>w.W.Add(path)</code>. It all works great, except that files in the top level directory seem to be added twice to the watcher, or at least my hypothesis is \"as many times as their are directory levels below the top level\". My directory structure is such that:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 languages.go\n\u251c\u2500\u2500 languages.json\n\u251c\u2500\u2500 librarymonitor.go\n\u251c\u2500\u2500 telemetryClient\n\u2514\u2500\u2500 testfiles\n    \u251c\u2500\u2500 test.go\n    \u251c\u2500\u2500 test.c\n    \u251c\u2500\u2500 test.java\n</code></pre>\n\n<p>If I change a file in the testfiles directory, I get one \"notification\" from the watcher. If I change a file in the root, I get two. Can anyone shed light on this?<br>\nThanks</p>\n"}, {"tags": ["node.js", "go", "cryptography", "hmac"], "answers": [{"comments": [{"owner": {"reputation": 7750, "user_id": 2244411, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Y4bul.jpg?s=128&g=1", "display_name": "Dibish", "link": "https://stackoverflow.com/users/2244411/dibish"}, "edited": false, "score": 0, "creation_date": 1473511310, "post_id": 39426143, "comment_id": 66176159, "body": "Thank you so much @Tim. Your answer really helped me."}, {"owner": {"reputation": 569, "user_id": 5805469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7dJe9.jpg?s=128&g=1", "display_name": "Ishan Jain", "link": "https://stackoverflow.com/users/5805469/ishan-jain"}, "edited": false, "score": 0, "creation_date": 1497257520, "post_id": 39426143, "comment_id": 75983583, "body": "If I want to write more data in hmac, Can I use h.Write() multiple times? or do I need to reset it before I write next value?"}, {"owner": {"reputation": 776, "user_id": 3409400, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0uu6.jpg?s=128&g=1", "display_name": "oscarz", "link": "https://stackoverflow.com/users/3409400/oscarz"}, "edited": false, "score": 0, "creation_date": 1523328150, "post_id": 39426143, "comment_id": 86503615, "body": "@Tim, Oh my bro, you saved me!!! I didn&#39;t figure out how to use <code>hmac.Write()</code> and <code>hmac.sum()</code>.  so I put the message into <code>sum()</code> and the result drove me crazy. Anyway, thanks a lot."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 13, "last_activity_date": 1473510950, "creation_date": 1473510950, "answer_id": 39426143, "question_id": 39426096, "link": "https://stackoverflow.com/questions/39426096/how-to-generate-hmac/39426143#39426143", "title": "How to generate HMAC", "body": "<p>You need to use the same encoding in your Go program as you do in your Node.js program (<a href=\"http://godoc.org/encoding/hex\" rel=\"noreferrer\">hex</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/hmac\"\n    \"crypto/sha256\"\n    \"encoding/hex\"\n    \"fmt\"\n)\n\nfunc ComputeHmac256(message string, secret string) string {\n    key := []byte(secret)\n    h := hmac.New(sha256.New, key)\n    h.Write([]byte(message))\n    return hex.EncodeToString(h.Sum(nil))\n}\n\nfunc main() {\n    fmt.Println(ComputeHmac256(\"sms1\", \"b5fb5b3a65b8429693c3a029308e2e46\"))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/-1yePFeipT\" rel=\"noreferrer\">https://play.golang.org/p/-1yePFeipT</a></p>\n"}], "owner": {"reputation": 7750, "user_id": 2244411, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Y4bul.jpg?s=128&g=1", "display_name": "Dibish", "link": "https://stackoverflow.com/users/2244411/dibish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2232, "favorite_count": 2, "accepted_answer_id": 39426143, "answer_count": 1, "score": 1, "last_activity_date": 1531208454, "creation_date": 1473510586, "last_edit_date": 1531208454, "question_id": 39426096, "link": "https://stackoverflow.com/questions/39426096/how-to-generate-hmac", "title": "How to generate HMAC", "body": "<p>I need to create an Hmac in Go. I have created an Hmac in nodejs, need to generate the same Hamc in Go. Tried following code but getting exactly different output. I don't know what I am doing wrong. \nThis is what I tried </p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/hmac\"\n    \"crypto/sha256\"\n    \"encoding/base64\"\n    \"fmt\"\n)\n\nfunc ComputeHmac256(message string, secret string) string {\n    key := []byte(secret)\n    h := hmac.New(sha256.New, key)\n    h.Write([]byte(message))\n    return base64.StdEncoding.EncodeToString(h.Sum(nil))\n}\n\nfunc main() {\n    fmt.Println(ComputeHmac256(\"sms1\", \"b5fb5b3a65b8429693c3a029308e2e46\"))\n}\nOutput: JVN7kUPFL0aQ09lIH4YOsFJA3A2faqTuu6zIaYo61VI=\n</code></pre>\n\n<p><strong>Need go equivalent of following nodejs code</strong></p>\n\n<pre><code>var crypto = require('crypto'),\n    text = 'sms1',\n    key = 'b5fb5b3a65b8429693c3a029308e2e46'\nvar hash = crypto.createHmac('sha256', key)\nhash.update(text)\nvar value = hash.digest('hex')\n// Output \n25537b9143c52f4690d3d9481f860eb05240dc0d9f6aa4eebbacc8698a3ad552\n</code></pre>\n"}, {"tags": ["go", "network-programming", "ipv6", "multicast"], "comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1473543394, "post_id": 39425574, "comment_id": 66184848, "body": "I&#39;m pretty sure you&#39;ll have to use pcap for this."}], "owner": {"reputation": 2422, "user_id": 202311, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7408fce5260e98922355385680be0179?s=128&d=identicon&r=PG", "display_name": "IanB", "link": "https://stackoverflow.com/users/202311/ianb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1473506900, "creation_date": 1473506900, "question_id": 39425574, "link": "https://stackoverflow.com/questions/39425574/read-all-multicast-icmpv6-packets-in-go", "title": "read all multicast ICMPv6 packets in Go", "body": "<p>There doesn't appear to be a way to read multicast packets <strong>not</strong> destined for the local host when using net.PacketConn.</p>\n\n<p>I'm trying to use <a href=\"https://godoc.org/golang.org/x/net/ipv6\" rel=\"nofollow\"><code>x/net/ipv6</code></a> as follows:</p>\n\n<pre><code>var c net.PacketConn\nc, err = net.ListenPacket(\"ip6:ipv6-icmp\", ifaceIP.String())\n...\np := ipv6.NewPacketConn(c)\nerr = p.SetControlMessage(ipv6.FlagSrc|ipv6.FlagDst, true)\n...\nvar f ipv6.ICMPFilter\nf.SetAll(true)\nf.Accept(ipv6.ICMPTypeNeighborSolicitation)\nf.Accept(ipv6.ICMPTypeNeighborAdvertisement)\nerr = p.SetICMPFilter(&amp;f)\n...\npayload := make([]byte, snaplen)\ni, rcm, src, err := p.ReadFrom(payload)\n...\n</code></pre>\n\n<p>I would like to read, for example, IPv6 neighbor solicitations where the destination solicited-node multicast address does not belong to the local host.</p>\n\n<p>Can this be done with the standard lib (i.e. not using pcap library)?</p>\n"}, {"tags": ["go", "clojure"], "answers": [{"tags": [], "owner": {"reputation": 11421, "user_id": 7650, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/052338b3d753f00bb7724f2d2ca060a4?s=128&d=identicon&r=PG", "display_name": "lazy1", "link": "https://stackoverflow.com/users/7650/lazy1"}, "is_accepted": true, "score": 3, "last_activity_date": 1473498518, "creation_date": 1473498518, "answer_id": 39424491, "question_id": 39424385, "link": "https://stackoverflow.com/questions/39424385/is-there-any-equivalent-sliding-buffer-chan-in-golang/39424491#39424491", "title": "Is there any equivalent sliding-buffer chan in golang?", "body": "<p>I don't think so. Go has <a href=\"https://golang.org/doc/effective_go.html#channels\" rel=\"nofollow\">buffered channels</a> but they will block when the channel is full. </p>\n\n<p>You'll probably have to write something yourself, maybe with a goroutine in the middle that manages the buffer (maybe using <a href=\"https://github.com/tebeka/deque\" rel=\"nofollow\">deque</a> ;)</p>\n"}], "owner": {"reputation": 2564, "user_id": 1125621, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c1b3328f06ea4ab079677388658dae10?s=128&d=identicon&r=PG", "display_name": "o0omycomputero0o", "link": "https://stackoverflow.com/users/1125621/o0omycomputero0o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 1, "accepted_answer_id": 39424491, "answer_count": 1, "score": 2, "last_activity_date": 1473520656, "creation_date": 1473497862, "last_edit_date": 1473520656, "question_id": 39424385, "link": "https://stackoverflow.com/questions/39424385/is-there-any-equivalent-sliding-buffer-chan-in-golang", "title": "Is there any equivalent sliding-buffer chan in golang?", "body": "<p>In clojure we can have sliding-buffer chan; Is there any equivalent in golang?</p>\n\n<pre class=\"lang-clj prettyprint-override\"><code>(require '[clojure.core.async :refer [go-loop &lt;! &gt;!! sliding-buffer chan]])\n(def sliding-chan (chan (sliding-buffer 1)))\n(go-loop []\n  (println \"Received:\" (&lt;! sliding-chan))\n  (recur))\n(dotimes [n 100]\n  (&gt;!! sliding-chan n))\n\n;;=&gt; Received: 0 \n;;=&gt; Received: 99\n</code></pre>\n"}, {"tags": ["json", "google-app-engine", "post", "go"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1473497540, "post_id": 39422084, "comment_id": 66172819, "body": "Would <a href=\"http://stackoverflow.com/a/24455606/6309\">stackoverflow.com/a/24455606/6309</a> help?"}, {"owner": {"reputation": 8978, "user_id": 1351600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2noZs.jpg?s=128&g=1", "display_name": "Paul Collingwood", "link": "https://stackoverflow.com/users/1351600/paul-collingwood"}, "edited": false, "score": 0, "creation_date": 1473507419, "post_id": 39422084, "comment_id": 66175257, "body": "<a href=\"http://jsonlint.com/\" rel=\"nofollow noreferrer\">jsonlint.com</a>"}, {"owner": {"reputation": 43, "user_id": 4892442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67803703ea508ff72210f74665e1848f?s=128&d=identicon&r=PG&f=1", "display_name": "bhux", "link": "https://stackoverflow.com/users/4892442/bhux"}, "edited": false, "score": 0, "creation_date": 1473528313, "post_id": 39422084, "comment_id": 66180836, "body": "Yes VonC I have referenced to that stackoverflow post several times, however app engine uses urlfetch which is a wrapper around net/http and does not help me resolve my situation"}, {"owner": {"reputation": 43, "user_id": 4892442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67803703ea508ff72210f74665e1848f?s=128&d=identicon&r=PG&f=1", "display_name": "bhux", "link": "https://stackoverflow.com/users/4892442/bhux"}, "edited": false, "score": 0, "creation_date": 1473528334, "post_id": 39422084, "comment_id": 66180845, "body": "My Json is perfectly valid, but thanks for the link Paul"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4892442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67803703ea508ff72210f74665e1848f?s=128&d=identicon&r=PG&f=1", "display_name": "bhux", "link": "https://stackoverflow.com/users/4892442/bhux"}, "edited": false, "score": 0, "creation_date": 1473528369, "post_id": 39425289, "comment_id": 66180858, "body": "I did try this before, and just tried it again, but the results are the same.  The receiving side data is completely empty.  What makes you think I am not sending valid Json?"}, {"owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "reply_to_user": {"reputation": 43, "user_id": 4892442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67803703ea508ff72210f74665e1848f?s=128&d=identicon&r=PG&f=1", "display_name": "bhux", "link": "https://stackoverflow.com/users/4892442/bhux"}, "edited": false, "score": 1, "creation_date": 1473581475, "post_id": 39425289, "comment_id": 66190967, "body": "Some parsers expecting to always receive a Json object as a top level, that&#39;s why. Can we see also the receiving side? I&#39;m starting to think that it gets data somewhat differently, even though curl works."}, {"owner": {"reputation": 43, "user_id": 4892442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67803703ea508ff72210f74665e1848f?s=128&d=identicon&r=PG&f=1", "display_name": "bhux", "link": "https://stackoverflow.com/users/4892442/bhux"}, "edited": false, "score": 0, "creation_date": 1473585092, "post_id": 39425289, "comment_id": 66191712, "body": "Alexey - thank you for the help on this -- I have added the receiving side, which is in Python using Flask."}, {"owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "reply_to_user": {"reputation": 43, "user_id": 4892442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67803703ea508ff72210f74665e1848f?s=128&d=identicon&r=PG&f=1", "display_name": "bhux", "link": "https://stackoverflow.com/users/4892442/bhux"}, "edited": false, "score": 1, "creation_date": 1473699955, "post_id": 39425289, "comment_id": 66231816, "body": "You&#39;re using request.form instead of request.data. With curl you don&#39;t specify headers, so it falls back to application/x-www-form-urlencoded, but in Go you do: application/json"}, {"owner": {"reputation": 43, "user_id": 4892442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67803703ea508ff72210f74665e1848f?s=128&d=identicon&r=PG&f=1", "display_name": "bhux", "link": "https://stackoverflow.com/users/4892442/bhux"}, "edited": false, "score": 1, "creation_date": 1473725757, "post_id": 39425289, "comment_id": 66241949, "body": "Thank you Alexey!  That was indeed the issue - I had believed I had tried that previously, but in this situation you were completely correct and that is where the data was hiding. Much regards, and thank you!"}], "tags": [], "owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "is_accepted": true, "score": 1, "last_activity_date": 1473504675, "creation_date": 1473504675, "answer_id": 39425289, "question_id": 39422084, "link": "https://stackoverflow.com/questions/39422084/unable-to-successfully-post-valid-json-data-to-a-remote-url-from-app-engine-usin/39425289#39425289", "title": "Unable to successfully POST valid JSON data to a remote url from App Engine using Golang", "body": "<p>There are two problems I can see there.  </p>\n\n<ol>\n<li>Although you think you're sending a valid Json, you aren't.</li>\n<li>NewBuffer should receive []byte, not string</li>\n</ol>\n\n<p>Try it like this:</p>\n\n<pre><code>s := `[{\"i sware to ritchie\":\"this json is 100 percent valid\"},{\"i can even\":\"copy and paste it into a curl POST request and receive it flawless on the remote side\"}]`\n\nreq, err := http.NewRequest(\"POST\", url, bytes.NewBuffer([]byte(fmt.Sprintf(`{\"data\":%s}`, s))))\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4892442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67803703ea508ff72210f74665e1848f?s=128&d=identicon&r=PG&f=1", "display_name": "bhux", "link": "https://stackoverflow.com/users/4892442/bhux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 1, "accepted_answer_id": 39425289, "answer_count": 1, "score": -1, "last_activity_date": 1473725842, "creation_date": 1473476423, "last_edit_date": 1473725842, "question_id": 39422084, "link": "https://stackoverflow.com/questions/39422084/unable-to-successfully-post-valid-json-data-to-a-remote-url-from-app-engine-usin", "title": "Unable to successfully POST valid JSON data to a remote url from App Engine using Golang", "body": "<h1>UPDATE: Please see Alexey's comments below for the solution</h1>\n\n<hr>\n\n<h2>I am trying what I thought would be a trivial function to take some valid Json data and post it to a remote url</h2>\n\n<p>I've tried every example I could find close to this on StackOverflow, and the receiving side always has an empty payload. </p>\n\n<p>I'm ruling out the receiving side, due to being able to do this:</p>\n\n<p><code>curl -XPOST 'http://supersecreturl/mypost' -d '[{\"i sware to ritchie\":\"this json is 100 percent valid\"},{\"i can even\":\"copy and paste it into a curl POST request and receive it flawlessly on the remote side\"}]'</code></p>\n\n<p>Please help, I'm loosing my mind here..</p>\n\n<hr>\n\n<pre><code>/// Here is approximately my code - had to remove the valid url and the JSON content\n\n\n\nfunc PutArticlesJSON(c appengine.Context, articles []*Articlez) (*http.Response){                                                                      \n\nurl := \"http://mysecreturl/mypost\"                                                                                                            \nclient := urlfetch.Client(c)                                                                                                                       \njsonarts, _ := json.Marshal(articles)                                                                                                              \nc.Debugf(\" --- What do we have - %v\", string(jsonarts)) /// the appengine log shows exactly valid json at this point, such as:                                   \n/*                                                                                                                                                 \n [{\"i sware to ritchie\":\"this json is 100 percent valid\"},{\"i can even\":\"copy and paste it into a curl POST request and receive it flawless on the remote side\"}]      \n*/                                                                                                                                                 \n\n// tried this way too....                                                                                                                          \n//req, err := http.NewRequest(\"POST\", url,     strings.NewReader(string(jsonarts)))                                                                    \n//                                                                                                                                                 \nreq, err := http.NewRequest(\"POST\", url, bytes.NewBuffer(string(jsonStr)))       /// on the receiving side, the payload is completely empty no matter what I try                                                                  \nreq.Header.Set(\"Content-Type\", \"application/json\")                                                                                                 \n\nresp, err := client.Do(req)                                                                                                                        \nif err != nil {                                                                                                                                    \n    panic(err)                                                                                                                                     \n}                                                                                                                                                  \ndefer resp.Body.Close()                                                                                                                            \n\n\nbody, _ := ioutil.ReadAll(resp.Body)                                                                                                               \n\nreturn resp                                                                                                                                        \n}\n</code></pre>\n\n#\n\n<pre><code>#!/usr/bin/env python                                                                                                                              \n#                                                                                                                                                  \nfrom flask import Flask                                                                                                                            \nfrom flask import request                                                                                                                          \nimport urllib                                                                                                                                                                                                                                                         \nimport json                                                                                                                                        \n\n\napp = Flask(__name__)                                                                                                                              \n\n@app.route('/mypost', methods = ['GET','POST'])                                                                                                     \ndef esput():                                                                                                                                       \n    datapack = request.form                                                                                                                        \n    datastream = request.stream                                                                                                                    \n    with open(\"/tmp/log\", \"a\") as myf:                                                                                                             \n        myf.write(str(datastream))                                                                                                                 \n        myf.write(str(datapack))                                                                                                                   \n        myf.write(\"\\n\")                                                                                                                                                                                                                              \n    return \"all good\"                                                                                                                              \n\n\nif __name__ == '__main__':                                                                                                                         \n    app.run(threaded=True,host='0.0.0.0',port='333',debug=False)         \n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 458, "user_id": 3430396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FC684.png?s=128&g=1", "display_name": "Francisco Ortiz", "link": "https://stackoverflow.com/users/3430396/francisco-ortiz"}, "is_accepted": false, "score": 1, "last_activity_date": 1473467907, "creation_date": 1473467907, "answer_id": 39421409, "question_id": 39420773, "link": "https://stackoverflow.com/questions/39420773/is-there-an-idiomatic-go-way-to-dry-up-the-following-code/39421409#39421409", "title": "Is there an idiomatic Go way to DRY up the following code:", "body": "<p>if I didn't misunderstand, you want to make a \"constructor\" for the Baby and Human. There are some equivalents of constructors in Go.</p>\n\n<p>If you have the Human struct:</p>\n\n<pre><code>type Human struct {\n    Knowledge string\n}\n</code></pre>\n\n<p>You can call a function <code>makeHuman</code> to create a new Human:</p>\n\n<pre><code>func makeHuman(knowledge string) Human {\n    return Human{knowledge}\n}\n</code></pre>\n\n<p>If you prefer to return a pointer, you can choose this one:</p>\n\n<pre><code>func newHuman(knowledge string) *Human {\n    return &amp;Human{knowledge}\n}\n</code></pre>\n\n<p>You can check both options in the links below: </p>\n\n<ul>\n<li><p>Using <code>makeHuman</code>: <a href=\"https://play.golang.org/p/2hlTpnVXF9\" rel=\"nofollow\">https://play.golang.org/p/2hlTpnVXF9</a></p></li>\n<li><p>Using <code>newHuman</code>: <a href=\"https://play.golang.org/p/ru63o81C4V\" rel=\"nofollow\">https://play.golang.org/p/ru63o81C4V</a></p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 1, "last_activity_date": 1473469567, "creation_date": 1473469567, "answer_id": 39421538, "question_id": 39420773, "link": "https://stackoverflow.com/questions/39420773/is-there-an-idiomatic-go-way-to-dry-up-the-following-code/39421538#39421538", "title": "Is there an idiomatic Go way to DRY up the following code:", "body": "<p>About speak() function you can embed</p>\n\n<pre><code>type Knowledge string\nfunc (b Knowledge) speak() {\n    fmt.Println(b)\n}\ntype Baby struct {\n    Knowledge\n}\ntype Human struct {\n    Knowledge\n}\n</code></pre>\n\n<p>and about constructors, seems for such a simple type buitin new() is OK but you can write an initializer</p>\n\n<pre><code>func Ini(k Knowledgable) {\n    switch k.(type) {\n    case *Baby:\n        k.changeKnowledge(\"ga-ga\")\n    case *Human:\n        k.changeKnowledge(\"good things\")\n    }\n}\n</code></pre>\n\n<p>then things will be</p>\n\n<pre><code>h := new(Human)\nb:=new(Baby)\nIni(h)\nIni(b)\nh.speak()\n</code></pre>\n"}], "owner": {"reputation": 1169, "user_id": 2628355, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100004033970083/picture?type=large", "display_name": "Babistalikesflyingonrails", "link": "https://stackoverflow.com/users/2628355/babistalikesflyingonrails"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 2, "accepted_answer_id": 39421538, "answer_count": 2, "score": 0, "last_activity_date": 1473493748, "creation_date": 1473461838, "last_edit_date": 1473493748, "question_id": 39420773, "link": "https://stackoverflow.com/questions/39420773/is-there-an-idiomatic-go-way-to-dry-up-the-following-code", "title": "Is there an idiomatic Go way to DRY up the following code:", "body": "<p>I seem to be repeating the speak function for example.</p>\n\n<p>Also is there a way to move the initial knowledge of the baby and the human to a default constructor instead of being passed while making a new baby and human?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    h := Human{\"good things\"}\n    d := Devil{}\n    b := Baby{\"ga ga\"}\n    b.speak()\n    h.speak()\n    d.poisons(&amp;h)\n    d.poisons(&amp;b)\n    b.speak()\n    h.speak()\n}\n\ntype Human struct {\n    Knowledge string\n}\n\ntype Devil struct{}\n\ntype Baby struct {\n    Knowledge string\n}\n\ntype Knowledgable interface {\n    changeKnowledge(newKnowledge string)\n}\n\nfunc (d Devil) poisons(creature Knowledgable) {\n    creature.changeKnowledge(\" evil things\")\n}\n\nfunc (h Human) speak() {\n    fmt.Println(h.Knowledge)\n}\n\nfunc (b Baby) speak() {\n    fmt.Println(b.Knowledge)\n}\n\nfunc (h *Human) changeKnowledge(newKnowledge string) {\n    h.Knowledge += newKnowledge\n}\n\nfunc (b *Baby) changeKnowledge(newKnowledge string) {\n    b.Knowledge = newKnowledge\n}\n</code></pre>\n"}, {"tags": ["sockets", "go", "tcp", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6221381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6efccbec4b4015e0d9194d86789afe5?s=128&d=identicon&r=PG&f=1", "display_name": "internet3", "link": "https://stackoverflow.com/users/6221381/internet3"}, "edited": false, "score": 0, "creation_date": 1473499766, "post_id": 39420461, "comment_id": 66173319, "body": "The solutions that I need, thanks a lot! Great! ciao Uvelichitel"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1473459468, "creation_date": 1473459468, "answer_id": 39420461, "question_id": 39420210, "link": "https://stackoverflow.com/questions/39420210/retrieve-the-exact-connection-tcp-socket-channel-goroutine/39420461#39420461", "title": "retrieve the exact connection - tcp socket - channel - goroutine", "body": "<p>Just provide channel of type suitable for purpose</p>\n\n<pre><code>type Msg struct {\n    Msg  string\n    Conn *net.Conn\n}\n\ntype MsgChan chan Msg\n\nfunc handleConnection(c net.Conn, msgchan MsgChan) {\n//...\n    msgchan &lt;- Msg{Msg: o, Conn: &amp;c}\n//...\n}\n\nfunc processMessages(msgchan &lt;-chan Msg) {\n  for msg := range msgchan {\n       m := msg.Msg\n       conn := nsg.Conn\n//...\n} \n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6221381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6efccbec4b4015e0d9194d86789afe5?s=128&d=identicon&r=PG&f=1", "display_name": "internet3", "link": "https://stackoverflow.com/users/6221381/internet3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473459468, "creation_date": 1473457931, "question_id": 39420210, "link": "https://stackoverflow.com/questions/39420210/retrieve-the-exact-connection-tcp-socket-channel-goroutine", "title": "retrieve the exact connection - tcp socket - channel - goroutine", "body": "<p>I am learning Golang by few days, so it's not clear to me, how to retrieve the right connection \"conn\" inside the function </p>\n\n<p>func processMessages</p>\n\n<p>for the relative message \"msg\"</p>\n\n<p>Thanks!</p>\n\n<pre><code>package main\n\nimport ( \n  \"fmt\"\n  \"log\"\n  \"net\" \n  \"os\"\n  \"encoding/json\"\n  \"time\"\n  \"bufio\"\n)\n\ntype Packet struct {\n  Payload Payload   `json:\"payload\"`\n}\n\ntype Payload struct {\n  Data string       `json:\"data\"`\n}\n\n\n\nfunc main() {\n\n  if len(os.Args) != 2 {\n    fmt.Fprintf(os.Stderr, \"Usage: %s hostname\\n\", os.Args[0])\n    fmt.Println(\"Usage: \", os.Args[0], \"port number\")\n    os.Exit(1)\n  }\n\n  msgchan := make(chan string)\n  go processMessages(msgchan)\n\n  addr := \":\" + os.Args[1]\n\n  ln, err := net.Listen(\"tcp\", addr)\n  if err != nil {\n    fmt.Println(err)\n    //log.Fatal(err)\n  }\n\n  fmt.Println(\"Server listening at \", addr)\n\n  for {\n\n    conn, err := ln.Accept()\n    if err != nil {\n      log.Println(err)\n      continue\n    }\n\n    /* FIRST GOROUTINE */\n    go handleConnection(conn, msgchan)\n  }\n\n}\n\nfunc processMessages(msgchan &lt;-chan string) {\n\n  for msg := range msgchan {\n\n    /*\n\n    .. here the problem.. how I can know here the 'conn' the relative connection for this message???\n\n    */\n\n    if len(msg)&gt;0 {\n\n      packet := &amp;Packet{}\n      err := json.Unmarshal([]byte(msg), packet)\n      if err != nil {\n        log.Fatalln(\"Error xxx: \", err)\n      } else {\n\n        if len(packet.Payload.Data) &gt; 0 {\n\n          fmt.Println( len(packet.Payload.Data) )\n\n        }\n      }\n    }\n\n  }\n}\n\nfunc closeConnection(c net.Conn) {\n  c.Close()\n}\n\nfunc handleConnection(c net.Conn, msgchan chan&lt;- string) {\n\n  for {\n    inputReader := bufio.NewReader(c)\n    o, _ := inputReader.ReadString('\\n')\n    msgchan &lt;- o\n  }\n\n}\n</code></pre>\n\n<p>inside the function func handleConnection I have the connection, but.. how to forward the connection to the channel \"msgchan\" together with the message \"&lt;- o\" ??? </p>\n\n<p>Valeriano Cossu</p>\n"}, {"tags": ["multithreading", "go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1473446085, "post_id": 39417713, "comment_id": 66160373, "body": "You have nothing blocking your main function. Your program exits before you see all the output."}, {"owner": {"reputation": 300, "user_id": 2768132, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2d20550ae595902abbc54f0a2b6292ae?s=128&d=identicon&r=PG&f=1", "display_name": "user2768132", "link": "https://stackoverflow.com/users/2768132/user2768132"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1473446242, "post_id": 39417713, "comment_id": 66160440, "body": "@JimB thanks for your reply. but it is writing in to the file and working."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1473446582, "post_id": 39417713, "comment_id": 66160609, "body": "Besides the lack of blocking in main (which you need to fix first), the mutex isn&#39;t locking <i>anything</i> since they aren&#39;t shared between goroutines, plus there&#39;s a separate mutex initialized for each loop so it&#39;s not even blocking within the goroutine. You call defer to unlock the lock when you aren&#39;t returning. You should never need to to call <code>runtime.GoSched</code> in a well behaved program."}, {"owner": {"reputation": 300, "user_id": 2768132, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2d20550ae595902abbc54f0a2b6292ae?s=128&d=identicon&r=PG&f=1", "display_name": "user2768132", "link": "https://stackoverflow.com/users/2768132/user2768132"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1473447638, "post_id": 39417713, "comment_id": 66161148, "body": "@JimB thanks again for your valuable comment. got your point. but can you please correct my program so that i can create 5 thread and each thread will print different values. it will be great help for me. i did it from my side but can not understand. please help me out."}], "answers": [{"comments": [{"owner": {"reputation": 300, "user_id": 2768132, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2d20550ae595902abbc54f0a2b6292ae?s=128&d=identicon&r=PG&f=1", "display_name": "user2768132", "link": "https://stackoverflow.com/users/2768132/user2768132"}, "edited": false, "score": 0, "creation_date": 1473448339, "post_id": 39418199, "comment_id": 66161497, "body": "Thank you so much for your cooperation .. i will try to implement it. I am hoping it is creating 5 thread and each thread is printing different values. By the way is this a right way to implement multithreading in GoLang or is there any other simple way by which we can do so?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 300, "user_id": 2768132, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2d20550ae595902abbc54f0a2b6292ae?s=128&d=identicon&r=PG&f=1", "display_name": "user2768132", "link": "https://stackoverflow.com/users/2768132/user2768132"}, "edited": false, "score": 0, "creation_date": 1473448428, "post_id": 39418199, "comment_id": 66161530, "body": "Go doesn&#39;t expose OS threads, so yes, you use goroutines for concurrency."}, {"owner": {"reputation": 300, "user_id": 2768132, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2d20550ae595902abbc54f0a2b6292ae?s=128&d=identicon&r=PG&f=1", "display_name": "user2768132", "link": "https://stackoverflow.com/users/2768132/user2768132"}, "edited": false, "score": 0, "creation_date": 1473501077, "post_id": 39418199, "comment_id": 66173683, "body": "got your point. But still i am not able to achieve parallelism here. in the above example i am locking and processing data one by one. I want to process all the threads parallel. any idea how can i do so? for example - if there are collections and wanted to fetch data from service or database how can i do that?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 300, "user_id": 2768132, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2d20550ae595902abbc54f0a2b6292ae?s=128&d=identicon&r=PG&f=1", "display_name": "user2768132", "link": "https://stackoverflow.com/users/2768132/user2768132"}, "edited": false, "score": 0, "creation_date": 1473503562, "post_id": 39418199, "comment_id": 66174328, "body": "@user2768132: I don&#39;t know what you mean. Each goroutine is running concurrently, probably scheduled in parallel over multiple threads, the locking is solely around the shared file write. Querying a database is something completely unrelated."}, {"owner": {"reputation": 300, "user_id": 2768132, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2d20550ae595902abbc54f0a2b6292ae?s=128&d=identicon&r=PG&f=1", "display_name": "user2768132", "link": "https://stackoverflow.com/users/2768132/user2768132"}, "edited": false, "score": 0, "creation_date": 1473507293, "post_id": 39418199, "comment_id": 66175223, "body": "thanks for your reply. acctually i am trying to HIT a service url just before writing to the file. after hitting the URL i am writing response in to the file.  If i am seeing the current example i am thinking that it is not running parallel due to lock. first it is locking and writing in to the file. till that time all the other threads are waiting. am i correct? Please guide me."}, {"owner": {"reputation": 300, "user_id": 2768132, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2d20550ae595902abbc54f0a2b6292ae?s=128&d=identicon&r=PG&f=1", "display_name": "user2768132", "link": "https://stackoverflow.com/users/2768132/user2768132"}, "edited": false, "score": 0, "creation_date": 1473508132, "post_id": 39418199, "comment_id": 66175440, "body": "I mean to say it is creating multiple goroutins but when it is processing first it is locking one thread and hitting URL and writing the code. till that time other threads are in waiting mode. so i am assuming that only one thread at a time processing data. correct me if i am wrong."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 300, "user_id": 2768132, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2d20550ae595902abbc54f0a2b6292ae?s=128&d=identicon&r=PG&f=1", "display_name": "user2768132", "link": "https://stackoverflow.com/users/2768132/user2768132"}, "edited": false, "score": 0, "creation_date": 1473524499, "post_id": 39418199, "comment_id": 66179640, "body": "@user2768132, if you want to make http requests concurrently, don&#39;t use a lock around the requests. I have no idea what you&#39;re doing, because there&#39;s nothing in your example about http requests, databases, etc."}, {"owner": {"reputation": 300, "user_id": 2768132, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2d20550ae595902abbc54f0a2b6292ae?s=128&d=identicon&r=PG&f=1", "display_name": "user2768132", "link": "https://stackoverflow.com/users/2768132/user2768132"}, "edited": false, "score": 0, "creation_date": 1473588103, "post_id": 39418199, "comment_id": 66192429, "body": "Sorry for that if i am not able to make you understand about my requirement. forget about the example which i have shared. actually my requirement is to process 1000000 data with multiple gorouting. for example, i have 1000000 customer id. i am running a for loop till 1000000. in the for loop i am hitting the HTTP request to get the customer details and i am writing all the customer details in to the file. so that next level can process.and all this i wanted with multi-threading. i am not able to achieve my requirement by above example. Can you please help me out."}, {"owner": {"reputation": 300, "user_id": 2768132, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2d20550ae595902abbc54f0a2b6292ae?s=128&d=identicon&r=PG&f=1", "display_name": "user2768132", "link": "https://stackoverflow.com/users/2768132/user2768132"}, "edited": false, "score": 0, "creation_date": 1473588125, "post_id": 39418199, "comment_id": 66192434, "body": "Please let me know if you needed any other details."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 300, "user_id": 2768132, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2d20550ae595902abbc54f0a2b6292ae?s=128&d=identicon&r=PG&f=1", "display_name": "user2768132", "link": "https://stackoverflow.com/users/2768132/user2768132"}, "edited": false, "score": 0, "creation_date": 1473703306, "post_id": 39418199, "comment_id": 66233368, "body": "@user2768132: comments are not the place to ask new questions. Please ask a new question with a reproducible example of the problem you&#39;re having."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1473448366, "last_edit_date": 1473448366, "creation_date": 1473447775, "answer_id": 39418199, "question_id": 39417713, "link": "https://stackoverflow.com/questions/39417713/goroutine-or-multithreading-is-not-working-in-golang/39418199#39418199", "title": "goroutine or multithreading is not working in golang", "body": "<p>First, you need to block in your main function until all other goroutines return. The mutexes in your program aren't blocking <em>anything</em>, and since they're re-initialized in each loop, they don't even block within their own goroutine. You can't defer an unlock if you're not returning from the function, you need to explicitly unlock in each iteration of the loop. You aren't using any of the values in your array (though you should use a slice instead), so we can drop that entirely. You also don't need <code>runtime.GoSched</code> in a well-behaved program, and it does nothing here. </p>\n\n<p>An equivalent program that will run to completion would look like:</p>\n\n<pre><code>var wg sync.WaitGroup\n\nvar fileMutex sync.Mutex\n\nfunc test(s string, fo *os.File) {\n    defer wg.Done()\n    for i := 0; i &lt; 105; i++ {\n        fileMutex.Lock()\n        fmt.Fprintf(fo, \"%s%d\", s, i)\n        fileMutex.Unlock()\n    }\n}\n\nfunc main() {\n    fo, err := os.Create(\"D:/output.txt\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    for i := 0; i &lt; 4; i++ {\n        wg.Add(1)\n        go test(\"bye\", fo)\n\n    }\n    wg.Wait()\n}\n</code></pre>\n\n<p>Finally though, there's no reason to try and write serial values to a single file from multiple goroutines, and it's less efficient to do so. If you want the values ordered over the entire file, you will need to use a single goroutine anyway.  </p>\n"}], "owner": {"reputation": 300, "user_id": 2768132, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2d20550ae595902abbc54f0a2b6292ae?s=128&d=identicon&r=PG&f=1", "display_name": "user2768132", "link": "https://stackoverflow.com/users/2768132/user2768132"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2037, "favorite_count": 0, "accepted_answer_id": 39418199, "answer_count": 1, "score": -1, "last_activity_date": 1473448366, "creation_date": 1473445739, "last_edit_date": 1473446143, "question_id": 39417713, "link": "https://stackoverflow.com/questions/39417713/goroutine-or-multithreading-is-not-working-in-golang", "title": "goroutine or multithreading is not working in golang", "body": "<p>I was trying to implement multithreading in golang. I am able to implement go routines but it is not working as expected. below is the sample program which i have prepared,</p>\n\n<pre><code>func test(s string, fo *os.File) {\n    var s1 [105]int\n    count :=0\n    for x :=1000; x&lt;1101;x++ {\n    s1[count] = x;\n        count++\n    }\n\n    //fmt.Println(s1[0])\n    for i := range s1 {\n        runtime.Gosched() \n        sd := s + strconv.Itoa(i)\n        var fileMutex sync.Mutex\n        fileMutex.Lock()\n        fmt.Fprintf(fo,sd)\n        defer fileMutex.Unlock()\n    }\n}\n\nfunc main() {\n    fo,err :=os.Create(\"D:/Output.txt\")\n    if err != nil {\n        panic(err)\n    }\n    for i := 0; i &lt; 4; i++ {\n        go test(\"bye\",fo) \n\n    }\n\n\n\n}\n</code></pre>\n\n<p>OUTPUT - good0bye0bye0bye0bye0good1bye1bye1bye1bye1good2bye2bye2bye2bye2.... etc.\nthe above program will create a file and write \"Hello\" and \"bye\" in the file.</p>\n\n<p>My problem is i am trying to create 5 thread and wanted to process different values values with different thread. if you will see the above example it is printing \"bye\" 4 times. </p>\n\n<p>i wanted output like below using 5 thread,</p>\n\n<p>good0bye0good1bye1good2bye2....etc....</p>\n\n<p>any idea how can i achieve this?</p>\n"}, {"tags": ["http", "go", "httpresponse"], "comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1473438496, "post_id": 39415827, "comment_id": 66156640, "body": "I found a possible solution. Every time I write to the ResponseWriter with a redirect or file server, I could also set a custom header <code>w.Header().Set(&quot;custom&quot;, &quot;1&quot;)</code> indicating it&#39;s been set and I could check with <code>w.Header().Get(&quot;custom&quot;) == &quot;1&quot;</code>"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1473449112, "post_id": 39415827, "comment_id": 66161842, "body": "You could make your own version of <code>http.ResponseWriter</code> that sets a bool to true when <code>WriteHeader</code> is called. See <a href=\"https://play.golang.org/p/o6Tp9urYZZ\" rel=\"nofollow noreferrer\">play.golang.org/p/o6Tp9urYZZ</a>."}, {"owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "edited": false, "score": 0, "creation_date": 1473459211, "post_id": 39415827, "comment_id": 66165853, "body": "Have a look at the <a href=\"https://github.com/gin-gonic/gin/blob/4a6bc4aac4607e253bcda67c8c5bcda693d2388e/response_writer.go\" rel=\"nofollow noreferrer\">Gin framework</a>. It implements a <code>Written()</code> method on the ResponseWriter"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1473462307, "post_id": 39415827, "comment_id": 66166568, "body": "See example implementation of <a href=\"http://stackoverflow.com/a/34018537/1705598\">storing and accessing written status code</a>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1489399317, "post_id": 39415827, "comment_id": 72637148, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31897411/how-can-i-tell-if-net-https-responsewriter-write-has-been-called\">How can I tell if net/http&#39;s ResponseWriter.Write() has been called?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 4, "last_activity_date": 1494433281, "last_edit_date": 1494433281, "creation_date": 1494431516, "answer_id": 43897364, "question_id": 39415827, "link": "https://stackoverflow.com/questions/39415827/how-to-check-if-responsewriter-has-been-written/43897364#43897364", "title": "How to check if ResponseWriter has been written", "body": "<p>The only way to do this is with a custom implementation of <code>http.ResponseWriter</code>:</p>\n\n<pre><code>type doneWriter struct {\n    http.ResponseWriter\n    done bool\n}\n\nfunc (w *doneWriter) WriteHeader(status int) {\n    w.done = true\n    w.ResponseWriter.WriteHeader(status)\n}\n\nfunc (w *doneWriter) Write(b []byte) (int, error) {\n    w.done = true\n    return w.ResponseWriter.Write(b)\n}\n\nfunc myMiddleware(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        dw := &amp;doneWriter{ResponseWriter: w}\n        next.ServeHTTP(dw, r)\n        if dw.done {\n            // Something already wrote a response\n            return\n        }\n        // Nothing else wrote a response\n        w.WriteHeader(http.StatusOK)\n        // Whatever you want here\n    }\n}\n</code></pre>\n\n<p>I also threw together <a href=\"https://godoc.org/github.com/flimzy/donewriter\" rel=\"nofollow noreferrer\">a simple package</a> to handle this for me. Feel free to use it as well if you like.</p>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4358, "favorite_count": 0, "accepted_answer_id": 43897364, "answer_count": 1, "score": 4, "last_activity_date": 1561718618, "creation_date": 1473437974, "last_edit_date": 1561718618, "question_id": 39415827, "link": "https://stackoverflow.com/questions/39415827/how-to-check-if-responsewriter-has-been-written", "title": "How to check if ResponseWriter has been written", "body": "<p>Using Golang's <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow\">net/http</a> package, how can I check if the <code>ResponseWriter</code> has been written to? I am receiving the following error message:</p>\n\n<blockquote>\n  <p>http: multiple response.WriteHeader calls</p>\n</blockquote>\n\n<p>Of course I can return booleans and such from my functions indicating weather I wrote to the <code>ResponseWriter</code> with a redirect or something, which I tried, but surely I am able to check if the <code>ResponseWriter</code> has been written to before I write to it with an easy method.</p>\n\n<p>I am looking for a function that would look something like the following which I can use before I write to the <code>ResponseWriter</code>:</p>\n\n<pre><code>if w.Header().Get(\"Status-Code\") == \"\" {\n    http.Redirect(w, r, \"/\", http.StatusSeeOther)\n} else {\n    fmt.Println(\"Response Writer has already been written to.\")\n}\n</code></pre>\n\n<p>The code above doesn't seem to work... anyone have any idea how to check if the <code>ResponseWriter</code> has been written to or not?</p>\n"}, {"tags": ["parsing", "go", "data-structures", "declarative"], "comments": [{"owner": {"reputation": 1330, "user_id": 2889812, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6aab926508d432c4682095eb3977b9ea?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Milogradov", "link": "https://stackoverflow.com/users/2889812/alexey-milogradov"}, "edited": false, "score": 0, "creation_date": 1495086806, "post_id": 39412191, "comment_id": 75105146, "body": "Hi, @synthesizerpatel! I have similar question. I wonder if you&#39;ve found something useful?"}], "answers": [{"tags": [], "owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "is_accepted": false, "score": 0, "last_activity_date": 1473430756, "creation_date": 1473430756, "answer_id": 39413743, "question_id": 39412191, "link": "https://stackoverflow.com/questions/39412191/is-there-a-golang-library-similar-to-pythons-construct/39413743#39413743", "title": "Is there a golang library similar to Python&#39;s construct?", "body": "<p>This isn't the same as Python's Construct package, but there is a version of <a href=\"https://9p.io/magic/man2html/1/yacc\" rel=\"nofollow\">Yacc</a> for Go:</p>\n\n<ul>\n<li><a href=\"https://golang.org/cmd/yacc/\" rel=\"nofollow\">https://golang.org/cmd/yacc/</a></li>\n</ul>\n\n<p>Yacc's grammar is similar to EBNF, so it may not meet your criteria, but it's widely used and understood, so I think it's worth mentioning.</p>\n"}], "owner": {"reputation": 24450, "user_id": 210613, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8489af0be35b69d4e257df06e0bc10c8?s=128&d=identicon&r=PG", "display_name": "synthesizerpatel", "link": "https://stackoverflow.com/users/210613/synthesizerpatel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 501, "favorite_count": 1, "closed_date": 1532749994, "answer_count": 1, "score": 3, "last_activity_date": 1473430756, "creation_date": 1473425951, "question_id": 39412191, "link": "https://stackoverflow.com/questions/39412191/is-there-a-golang-library-similar-to-pythons-construct", "closed_reason": "Not suitable for this site", "title": "Is there a golang library similar to Python&#39;s construct?", "body": "<p>I really love the Python construct module's declarative syntax for defining bi-directional (binary|text) parser / builders.</p>\n\n<p>I've recently started focusing on golang and was wondering if anyone has seen (or might be the esteemed author of) a similar library for golang.</p>\n\n<p>If you've never used the <a href=\"https://pypi.python.org/pypi/construct/2.5.4\" rel=\"nofollow\">construct</a> module, you basically build a declarative tree of Python objects that you can feed Python object trees and get binary blobs out, or parse binary blobs into Python object trees.</p>\n\n<p>A simple example from the construct webpage:</p>\n\n<pre><code>&gt;&gt;&gt; PascalString2 = ExprAdapter(PascalString,\n...     encoder = lambda obj, ctx: Container(length = len(obj), data = obj),\n...     decoder = lambda obj, ctx: obj.data\n... )\n&gt;&gt;&gt; PascalString2.parse(\"\\x05hello\")\n'hello'\n&gt;&gt;&gt; PascalString2.build(\"i'm a long string\")\n\"\\x11i'm a long string\"\n</code></pre>\n\n<p>A slightly more complex example from the source that shows a hard drive MBR parser.</p>\n\n<pre><code>mbr = Struct(\"mbr\",\n    HexDumpAdapter(Bytes(\"bootloader_code\", 446)),\n    Array(4,\n        Struct(\"partitions\",\n            Enum(Byte(\"state\"),\n                INACTIVE = 0x00,\n                ACTIVE = 0x80,\n            ),\n            BitStruct(\"beginning\",\n                Octet(\"head\"),\n                Bits(\"sect\", 6),\n                Bits(\"cyl\", 10),\n            ),\n            Enum(UBInt8(\"type\"),\n                Nothing = 0x00,\n                FAT12 = 0x01,\n                XENIX_ROOT = 0x02,\n                XENIX_USR = 0x03,\n                FAT16_old = 0x04,\n                Extended_DOS = 0x05,\n                FAT16 = 0x06,\n                FAT32 = 0x0b,\n                FAT32_LBA = 0x0c,\n                NTFS = 0x07,\n                LINUX_SWAP = 0x82,\n                LINUX_NATIVE = 0x83,\n                _default_ = Pass,\n            ),\n            BitStruct(\"ending\",\n                Octet(\"head\"),\n                Bits(\"sect\", 6),\n                Bits(\"cyl\", 10),\n            ),\n            UBInt32(\"sector_offset\"), # offset from MBR in sectors\n            UBInt32(\"size\"), # in sectors\n        )\n    ),\n    Const(\"signature\", b\"\\x55\\xAA\"),\n)\n</code></pre>\n\n<p>There's a <a href=\"https://github.com/construct/construct/tree/master/construct/protocols\" rel=\"nofollow\">TCP/IP stack</a> example that really shows how powerful the construct model is, with the ability to have bite-sized blocks of definitions that you combine into a single parser/generator. </p>\n\n<p>I know there are PEG / EBNF parser generators, but I was hoping for something a little prettier to look at.</p>\n"}, {"tags": ["linux", "go", "process"], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1473433552, "post_id": 39413784, "comment_id": 66153673, "body": "Out of curiosity, why do they all have different PIDs?"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1473433629, "post_id": 39413784, "comment_id": 66153715, "body": "@Kaedys: They don&#39;t. That confused me too so I copied the code and ran it myself. What looks like different PIDs is htop displaying the TIDs instead."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1473434116, "post_id": 39413784, "comment_id": 66154005, "body": "Ah, weird. /15char"}], "tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": true, "score": 3, "last_activity_date": 1473430869, "creation_date": 1473430869, "answer_id": 39413784, "question_id": 39412130, "link": "https://stackoverflow.com/questions/39412130/why-in-linux-golang-run-http-service-will-automatically-create-multiple-child-p/39413784#39413784", "title": "Why in Linux, golang run Http service will automatically create multiple child processes\uff1f", "body": "<p>Your <code>htop</code> program is displaying threads, not processes. What you are seeing is Go's natural creation of threads which are used to run goroutines and to run system calls without blocking in the kernel.</p>\n\n<p><a href=\"http://dave.cheney.net/2015/11/29/a-whirlwind-tour-of-gos-runtime-environment-variables\" rel=\"nofollow\">You can control the number of threads created with the GOMAXPROCS environment variable.</a> </p>\n"}], "owner": {"reputation": 23, "user_id": 2490213, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/usCSL.jpg?s=128&g=1", "display_name": "zimuyang", "link": "https://stackoverflow.com/users/2490213/zimuyang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 1, "accepted_answer_id": 39413784, "answer_count": 1, "score": 0, "last_activity_date": 1473433682, "creation_date": 1473425756, "last_edit_date": 1473433682, "question_id": 39412130, "link": "https://stackoverflow.com/questions/39412130/why-in-linux-golang-run-http-service-will-automatically-create-multiple-child-p", "title": "Why in Linux, golang run Http service will automatically create multiple child processes\uff1f", "body": "<p>This is what I used to do the test code</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"net/http\"\n    \"time\"\n)\n\nfunc main() {\n    s := &amp;http.Server{\n        Addr:           \":9301\",\n        ReadTimeout:    10 * time.Second,\n        WriteTimeout:   10 * time.Second,\n        MaxHeaderBytes: 1 &lt;&lt; 20,\n    }\n\n    http.HandleFunc(\"/line/getList\", Response)\n    s.ListenAndServe()\n}\n\nfunc Response(w http.ResponseWriter, req *http.Request)  {\n\n    w.Header().Set(\"Content-Type\", \"application/json; charset=utf-8\")\n    w.Header().Set(\"Connection\", \"keep-alive\")\n    w.WriteHeader(200)\n\n    for i:= 0; i &lt; 10000; i++ {\n        w.Write([]byte(\"hello world\"))\n    }\n}\n</code></pre>\n\n<p>Here is the situation when the code runs</p>\n\n<p><a href=\"https://i.stack.imgur.com/mRZSm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mRZSm.png\" alt=\"htop output showing a tree with nested apptest threads\"></a></p>\n\n<p>System is centos 6.5</p>\n\n<p>This normal? If not normal, how to limit golang automatically create a large number of child processes?</p>\n"}, {"tags": ["xml", "go"], "answers": [{"tags": [], "owner": {"reputation": 23028, "user_id": 107156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mSIVv.jpg?s=128&g=1", "display_name": "Kyle Brandt", "link": "https://stackoverflow.com/users/107156/kyle-brandt"}, "is_accepted": false, "score": 0, "last_activity_date": 1473424732, "creation_date": 1473424732, "answer_id": 39411814, "question_id": 39411656, "link": "https://stackoverflow.com/questions/39411656/get-original-xml-when-failing-to-decode/39411814#39411814", "title": "Get original xml when failing to decode", "body": "<p>For http responses you can use the <a href=\"https://golang.org/pkg/net/http/httputil/\" rel=\"nofollow\">httputil</a> package's <a href=\"https://golang.org/pkg/net/http/httputil/#DumpResponse\" rel=\"nofollow\">DumpResponse</a>:</p>\n\n<p>Example from the link:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"net/http/httptest\"\n    \"net/http/httputil\"\n)\n\nfunc main() {\n    const body = \"Go is a general-purpose language designed with systems programming in mind.\"\n    ts := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Date\", \"Wed, 19 Jul 1972 19:00:00 GMT\")\n        fmt.Fprintln(w, body)\n    }))\n    defer ts.Close()\n\n    resp, err := http.Get(ts.URL)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer resp.Body.Close()\n\n    dump, err := httputil.DumpResponse(resp, true)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Printf(\"%q\", dump)\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3261, "user_id": 1818847, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fPeO9.jpg?s=128&g=1", "display_name": "Mario Stoilov", "link": "https://stackoverflow.com/users/1818847/mario-stoilov"}, "edited": false, "score": 0, "creation_date": 1473425433, "post_id": 39411885, "comment_id": 66148224, "body": "While this DOES work, please specify that it returns <code>[]byte</code> not a string and should use something like this -&gt; <a href=\"http://stackoverflow.com/questions/14230145/what-is-the-best-way-to-convert-byte-array-to-string\" title=\"what is the best way to convert byte array to string\">stackoverflow.com/questions/14230145/&hellip;</a> to convert it"}, {"owner": {"reputation": 801, "user_id": 5056691, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z3xo21C2gaU/AAAAAAAAAAI/AAAAAAAAAI0/0KSAJRkAaYA/photo.jpg?sz=128", "display_name": "Anupam", "link": "https://stackoverflow.com/users/5056691/anupam"}, "reply_to_user": {"reputation": 3261, "user_id": 1818847, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fPeO9.jpg?s=128&g=1", "display_name": "Mario Stoilov", "link": "https://stackoverflow.com/users/1818847/mario-stoilov"}, "edited": false, "score": 0, "creation_date": 1473425749, "post_id": 39411885, "comment_id": 66148406, "body": "True, but in this case since unmarhsal accepts []byte and it wasn&#39;t required. <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshal\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/xml/#Unmarshal</a>"}], "tags": [], "owner": {"reputation": 801, "user_id": 5056691, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z3xo21C2gaU/AAAAAAAAAAI/AAAAAAAAAI0/0KSAJRkAaYA/photo.jpg?sz=128", "display_name": "Anupam", "link": "https://stackoverflow.com/users/5056691/anupam"}, "is_accepted": true, "score": 4, "last_activity_date": 1473424965, "creation_date": 1473424965, "answer_id": 39411885, "question_id": 39411656, "link": "https://stackoverflow.com/questions/39411656/get-original-xml-when-failing-to-decode/39411885#39411885", "title": "Get original xml when failing to decode", "body": "<ol>\n<li><p>Read bytes with <code>io/ioutil</code> ReadAll</p>\n\n<p><code>defer body.Close()</code></p>\n\n<p><code>data, err := ioutil.ReadAll(body)</code></p></li>\n<li><p>Then unmarshal</p>\n\n<p><code>err = xml.Unmarshal(data, &amp;qResult)</code></p></li>\n</ol>\n\n<p>You can log <strong>data</strong> for checking original xml.</p>\n"}], "owner": {"reputation": 3261, "user_id": 1818847, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fPeO9.jpg?s=128&g=1", "display_name": "Mario Stoilov", "link": "https://stackoverflow.com/users/1818847/mario-stoilov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 39411885, "answer_count": 2, "score": 0, "last_activity_date": 1473424965, "creation_date": 1473424203, "question_id": 39411656, "link": "https://stackoverflow.com/questions/39411656/get-original-xml-when-failing-to-decode", "title": "Get original xml when failing to decode", "body": "<p>(go newbie here)\nI have some code like this:</p>\n\n<pre><code>func (c *clientImpl) queryHost(qtype string, page int) (io.ReadCloser, error) {\n    queryURI := c.URL + \"/api/query\"\n    req, _ := http.NewRequest(http.MethodGet, queryURI, nil)\n    req.Header.Add(authHeaderName, authToken)\n    req.Header.Add(\"Accept\", accept)\n\n    q := req.URL.Query()\n    q.Add(\"type\", qtype)\n    q.Add(\"pageSize\", pageSize)\n    q.Add(\"page\", strconv.Itoa(page))\n    req.URL.RawQuery = q.Encode()\n    resp, err := c.client.Do(req) //*http.Client\n    if err != nil {\n        return nil, utils.NestedError(\"Error in querying Host\", err)\n    }\n\n    return resp.Body, nil\n}\n</code></pre>\n\n<p>And then called like this:</p>\n\n<pre><code>body, err := c.queryHost(myQType, i)\n        if err != nil {\n            log.Printf(\"Error while trying to get page %v - %v \\n\", i, err)\n            return err\n        }\n        defer body.Close()\n\n        var qResult myQueryResult\n        err = xml.NewDecoder(body).Decode(&amp;myQueryResult)\n        if err != nil {\n            log.Printf(\"Error while decoding page %v - %v \\n\", i, err)\n            return utils.NestedError(\"Error in decoding response body xml\", err)\n        }\n</code></pre>\n\n<p>I want to log the original xml that was failed to be processed, but since this is a <code>ReadCloser</code> and once read, it cannot be read again (or am I wrong?). Is there a way I can get this, or do I have to store the initial response somewhere and pass copies around?</p>\n"}, {"tags": ["date", "go", "time"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1473423948, "post_id": 39411510, "comment_id": 66147290, "body": "No, the right solution must calculate the difference in the <i>context of the time</i>. See possible duplicate of <a href=\"http://stackoverflow.com/questions/36530251/golang-time-since-with-months-and-years\">golang time.Since() with months and years</a>"}], "answers": [{"comments": [{"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1473424009, "post_id": 39411576, "comment_id": 66147321, "body": "So the only way is to parse it as a string, extract the hours part and convert it to days? :("}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "reply_to_user": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1473424213, "post_id": 39411576, "comment_id": 66147476, "body": "@GauravOjha Don&#39;t parse it. Duration is actually <code>int64</code>, use duration.(int64) to get nanoseconds. Yet conversion is not trivial."}, {"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1473424766, "post_id": 39411576, "comment_id": 66147816, "body": "Thank you! The comment made by @icza is also helpful in this context."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1473425162, "post_id": 39411576, "comment_id": 66148056, "body": "@Grzegorz\u017bur The proper syntax to convert a Duration to int64 is <code>int64(duration)</code> , not a type assertion."}, {"owner": {"reputation": 3621, "user_id": 999248, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/G9pId.jpg?s=128&g=1", "display_name": "robstarbuck", "link": "https://stackoverflow.com/users/999248/robstarbuck"}, "edited": false, "score": 0, "creation_date": 1473715691, "post_id": 39411576, "comment_id": 66239313, "body": "The duration type probably already has the method you&#39;re looking eg: <code>duration.Hours()</code> <a href=\"https://golang.org/pkg/time/#Duration.Hours\" rel=\"nofollow noreferrer\">golang.org/pkg/time/#Duration.Hours</a>"}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 2, "last_activity_date": 1473424038, "last_edit_date": 1473424038, "creation_date": 1473423950, "answer_id": 39411576, "question_id": 39411510, "link": "https://stackoverflow.com/questions/39411510/golang-time-sub-returns-hours-mins-seconds-how-to-get-it-in-days-or-months/39411576#39411576", "title": "Golang Time.Sub returns hours, mins, seconds - how to get it in days or months?", "body": "<p>No it is not possible. The type <a href=\"https://golang.org/pkg/time/#Duration\" rel=\"nofollow\"><code>Duration</code></a> that is returned by <code>time.Sub</code> is limited to hours:</p>\n\n<blockquote>\n  <p>There is no definition for units of Day or larger to avoid confusion across daylight savings time zone transitions.</p>\n</blockquote>\n"}], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1646, "favorite_count": 0, "accepted_answer_id": 39411576, "answer_count": 1, "score": 0, "last_activity_date": 1473424038, "creation_date": 1473423773, "question_id": 39411510, "link": "https://stackoverflow.com/questions/39411510/golang-time-sub-returns-hours-mins-seconds-how-to-get-it-in-days-or-months", "title": "Golang Time.Sub returns hours, mins, seconds - how to get it in days or months?", "body": "<p>In Golang, I am trying to find out the difference between a given <code>time.Time</code> value and the current <code>time.Time</code> value using <code>time.Sub</code> and my result looks like this -</p>\n\n<pre><code>4691h42m17.1831189s\n</code></pre>\n\n<p>Is it possible to make it return the number of days or months without performing any mathematical manipulations on this value and just using the <code>time</code> package?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "edited": false, "score": 0, "creation_date": 1473430865, "post_id": 39410808, "comment_id": 66151811, "body": "What is the type of the data in the interface? A string, or is it already an *rsa.PublicKey and you just need to know how to tell Go what it is?"}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1473422910, "post_id": 39411120, "comment_id": 66146640, "body": "The key in the question uses exactly this format. See this working example with questioner&#39;s key: <a href=\"https://play.golang.org/p/meIO51mkEX\" rel=\"nofollow noreferrer\">Go Playground</a>. Output: <code>*rsa.PublicKey &amp;rsa.PublicKey{N:15560...TRIMMED...309090347, E:65537}</code>"}, {"owner": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 0, "creation_date": 1548261576, "post_id": 39411120, "comment_id": 95481544, "body": "This example panics on &quot;failed to parse PEM block containing the public key&quot; See this <a href=\"https://play.golang.org/p/4_yUhySBcO9\" rel=\"nofollow noreferrer\">playground</a>"}], "tags": [], "owner": {"reputation": 23028, "user_id": 107156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mSIVv.jpg?s=128&g=1", "display_name": "Kyle Brandt", "link": "https://stackoverflow.com/users/107156/kyle-brandt"}, "is_accepted": true, "score": 8, "last_activity_date": 1473422434, "last_edit_date": 1495540389, "creation_date": 1473422434, "answer_id": 39411120, "question_id": 39410808, "link": "https://stackoverflow.com/questions/39410808/how-to-convert-a-interface-into-type-rsa-publickey-golang/39411120#39411120", "title": "How to convert a interface{} into type *rsa.PublicKey golang", "body": "<p>In general you would decode a pem file (assuming this is in a x509) cert using the <code>crypto/x509</code> library. The provided <a href=\"https://golang.org/pkg/crypto/x509/#ParsePKIXPublicKey\" rel=\"noreferrer\">example</a> in the documentation is as follows:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/dsa\"\n    \"crypto/ecdsa\"\n    \"crypto/rsa\"\n    \"crypto/x509\"\n    \"encoding/pem\"\n    \"fmt\"\n)\n\nfunc main() {\n    const pubPEM = `\n-----BEGIN PUBLIC KEY-----\nMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAlRuRnThUjU8/prwYxbty\nWPT9pURI3lbsKMiB6Fn/VHOKE13p4D8xgOCADpdRagdT6n4etr9atzDKUSvpMtR3\nCP5noNc97WiNCggBjVWhs7szEe8ugyqF23XwpHQ6uV1LKH50m92MbOWfCtjU9p/x\nqhNpQQ1AZhqNy5Gevap5k8XzRmjSldNAFZMY7Yv3Gi+nyCwGwpVtBUwhuLzgNFK/\nyDtw2WcWmUU7NuC8Q6MWvPebxVtCfVp/iQU6q60yyt6aGOBkhAX0LpKAEhKidixY\nnP9PNVBvxgu3XZ4P36gZV6+ummKdBVnc3NqwBLu5+CcdRdusmHPHd5pHf4/38Z3/\n6qU2a/fPvWzceVTEgZ47QjFMTCTmCwNt29cvi7zZeQzjtwQgn4ipN9NibRH/Ax/q\nTbIzHfrJ1xa2RteWSdFjwtxi9C20HUkjXSeI4YlzQMH0fPX6KCE7aVePTOnB69I/\na9/q96DiXZajwlpq3wFctrs1oXqBp5DVrCIj8hU2wNgB7LtQ1mCtsYz//heai0K9\nPhE4X6hiE0YmeAZjR0uHl8M/5aW9xCoJ72+12kKpWAa0SFRWLy6FejNYCYpkupVJ\nyecLk/4L1W0l6jQQZnWErXZYe0PNFcmwGXy1Rep83kfBRNKRy5tvocalLlwXLdUk\nAIU+2GKjyT3iMuzZxxFxPFMCAwEAAQ==\n-----END PUBLIC KEY-----`\n\n    block, _ := pem.Decode([]byte(pubPEM))\n    if block == nil {\n        panic(\"failed to parse PEM block containing the public key\")\n    }\n\n    pub, err := x509.ParsePKIXPublicKey(block.Bytes)\n    if err != nil {\n        panic(\"failed to parse DER encoded public key: \" + err.Error())\n    }\n\n    switch pub := pub.(type) {\n    case *rsa.PublicKey:\n        fmt.Println(\"pub is of type RSA:\", pub)\n    case *dsa.PublicKey:\n        fmt.Println(\"pub is of type DSA:\", pub)\n    case *ecdsa.PublicKey:\n        fmt.Println(\"pub is of type ECDSA:\", pub)\n    default:\n        panic(\"unknown type of public key\")\n    }\n}\n</code></pre>\n\n<p>I'm not really sure about the encoding you have there though. The following might help you past that hurdle:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/12749858/rsa-public-key-format\">RSA Public Key format</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 448, "user_id": 5754238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c904324232f30ce9c2997ecf9aaf6a8?s=128&d=identicon&r=PG&f=1", "display_name": "uwevil", "link": "https://stackoverflow.com/users/5754238/uwevil"}, "is_accepted": false, "score": 3, "last_activity_date": 1496351948, "creation_date": 1496351948, "answer_id": 44317246, "question_id": 39410808, "link": "https://stackoverflow.com/questions/39410808/how-to-convert-a-interface-into-type-rsa-publickey-golang/44317246#44317246", "title": "How to convert a interface{} into type *rsa.PublicKey golang", "body": "<p>you can use: \n<code>\n    rsaPublickey, _ := pub.(*rsa.PublicKey)\n</code>\nto convert to rsa.PublicKey</p>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5439, "favorite_count": 2, "accepted_answer_id": 39411120, "answer_count": 2, "score": 6, "last_activity_date": 1496351948, "creation_date": 1473421342, "question_id": 39410808, "link": "https://stackoverflow.com/questions/39410808/how-to-convert-a-interface-into-type-rsa-publickey-golang", "title": "How to convert a interface{} into type *rsa.PublicKey golang", "body": "<p>I have public key stored in a variable of type interface{}</p>\n\n<pre><code>-----BEGIN PUBLIC KEY-----    MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDdlatRjRjogo3WojgGHFHYLugdUWAY9iR3fy4arWNA1KoS8kVw33cJibXr8bvwUAUparCwlvdbH6dvEOfou0/gCFQsHUfQrSDv+MuSUMAe8jzKE4qW+jK+xQU9a03GUnKHkkle+Q0pX/g6jXZ7r1/xAK5Do2kQ+X5xK9cipRgEKwIDAQAB\n-----END PUBLIC KEY-----\n</code></pre>\n\n<p>Is there anyway I can convert this into type *rsa.PublicKey in golang. It might involve some intermediate step like converting interface{} to string first may be.</p>\n"}, {"tags": ["go", "named-pipes"], "answers": [{"tags": [], "owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "is_accepted": false, "score": 4, "last_activity_date": 1559568397, "last_edit_date": 1559568397, "creation_date": 1473412125, "answer_id": 39407888, "question_id": 39407592, "link": "https://stackoverflow.com/questions/39407592/named-pipes-in-go-for-both-windows-and-linux/39407888#39407888", "title": "Named Pipes in Go for both Windows and Linux", "body": "<p>There is an implementation of named pipes for Windows in Go from Microsoft:</p>\n\n<p><a href=\"https://github.com/Microsoft/go-winio\" rel=\"nofollow noreferrer\">https://github.com/Microsoft/go-winio</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 10, "last_activity_date": 1482141975, "last_edit_date": 1482141975, "creation_date": 1473412339, "answer_id": 39407943, "question_id": 39407592, "link": "https://stackoverflow.com/questions/39407592/named-pipes-in-go-for-both-windows-and-linux/39407943#39407943", "title": "Named Pipes in Go for both Windows and Linux", "body": "<p>According to <a href=\"https://github.com/golang/go/issues/3599\" rel=\"noreferrer\">https://github.com/golang/go/issues/3599</a></p>\n\n<blockquote>\n  <p>nate's package looks nice, and anyone can \"go get\" it.</p>\n</blockquote>\n\n<p>A Windows named pipe implementation written in pure Go:<br>\n<a href=\"https://github.com/natefinch/npipe\" rel=\"noreferrer\">https://github.com/natefinch/npipe</a></p>\n\n<p>Which has inspired (Win32 IO-related utilities for Go):<br>\n<a href=\"https://github.com/Microsoft/go-winio\" rel=\"noreferrer\">https://github.com/Microsoft/go-winio</a></p>\n"}], "owner": {"reputation": 622, "user_id": 5604249, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7bed34ebe08c34a10addbea1bf85ff17?s=128&d=identicon&r=PG&f=1", "display_name": "Pharaoh", "link": "https://stackoverflow.com/users/5604249/pharaoh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10765, "favorite_count": 4, "answer_count": 2, "score": 9, "last_activity_date": 1559568397, "creation_date": 1473411225, "last_edit_date": 1559568366, "question_id": 39407592, "link": "https://stackoverflow.com/questions/39407592/named-pipes-in-go-for-both-windows-and-linux", "title": "Named Pipes in Go for both Windows and Linux", "body": "<p>I am new to Go, I want to create Named Pipes implementation in Go which works on both Windows and Linux.</p>\n\n<p>I managed to get the code working on Ubuntu, but this one does not work on Windows</p>\n\n<p>Isn't there any abstraction in Go which allows you to work with Named Pipes in both environment</p>\n\n<p>Below is piece of my code</p>\n\n<pre><code>//to create pipe: does not work in windows    \nsyscall.Mkfifo(\"tmpPipe\", 0666)    \n\n// to open pipe to write    \nfile, err1 := os.OpenFile(\"tmpPipe\", os.O_RDWR, os.ModeNamedPipe)    \n\n//to open pipe to read    \nfile, err := os.OpenFile(\"tmpPipe\", os.O_RDONLY, os.ModeNamedPipe)\n</code></pre>\n\n<p>Any help or pointers would help a lot. Thanks</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "is_accepted": true, "score": 1, "last_activity_date": 1473403765, "last_edit_date": 1495541302, "creation_date": 1473403765, "answer_id": 39405442, "question_id": 39404963, "link": "https://stackoverflow.com/questions/39404963/entity-group-in-transaction-contention/39405442#39405442", "title": "Entity group in transaction (contention)", "body": "<p>Yes, such design may be considered a bad one as it doesn't scale well with the number of users. I can't see a good reason for which messages would need the board as ancestor.</p>\n\n<p>Yes, creating a new entity in a group counts as an entity group update and all updates can contribute to contention.</p>\n\n<p>Side note: you might find this clarification useful: <a href=\"https://stackoverflow.com/a/39309022/4495081\">https://stackoverflow.com/a/39309022/4495081</a> (but for designs which have good reasons for using multi-entity groups).</p>\n"}], "owner": {"reputation": 6586, "user_id": 256405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/420ecb69f4d50ee66160e01e4071be6e?s=128&d=identicon&r=PG", "display_name": "Morrowless", "link": "https://stackoverflow.com/users/256405/morrowless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 39405442, "answer_count": 1, "score": 2, "last_activity_date": 1473403765, "creation_date": 1473401806, "question_id": 39404963, "link": "https://stackoverflow.com/questions/39404963/entity-group-in-transaction-contention", "title": "Entity group in transaction (contention)", "body": "<p>I'm reading a book on GAE. In a chapter about transactions, it says:</p>\n\n<blockquote>\n  <p>Updating an entity in a group can potentially cancel updates to any other entity in the group by another process. You should design your data model so that entity groups do not need to be updated by many users simultaneously. </p>\n  \n  <p>Be especially careful if the number of simultaneous updates to a\n  single group grows as your application gets more users. In this case,\n  you usually want to spread the load across multiple entity groups, and\n  increase the number of entity groups automatically as the user base\n  grows. Scalable division of a data resource like this is known as\n  sharding.</p>\n</blockquote>\n\n<p>An often used example for an entity group is the message board, where the board is the ancestor of messages belonging to that board.</p>\n\n<p>However, If updating a message (i.e. editing it) causes contention, and more often so as the userbase grows, isn't it bad design to create a huge group of messages with the board as its ancestor? The write rate of an entity group is limited to 1 per second. Does that mean any message within the board can be updated at most once per second?</p>\n\n<p>Also, does merely adding an entity to a group (i.e. posting a new message) also count as \"updating\" and cause contention?</p>\n"}, {"tags": ["go", "memory-leaks", "socket.io"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1473400228, "post_id": 39404625, "comment_id": 66134604, "body": "This question was also asked on <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/w1tG1KDZDJE\" rel=\"nofollow noreferrer\">golang-nuts group</a>."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1473400525, "post_id": 39404625, "comment_id": 66134704, "body": "... and also asked <a href=\"https://groups.google.com/d/msg/golang-nuts/h2YObrIw7Fg/h7hWpc3lAQAJ\" rel=\"nofollow noreferrer\">here</a> with some discussion."}, {"owner": {"reputation": 41, "user_id": 4895059, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-obQBpx20lwU/AAAAAAAAAAI/AAAAAAAAADA/agKuz_ZRqdo/photo.jpg?sz=128", "display_name": "Aiden Luo", "link": "https://stackoverflow.com/users/4895059/aiden-luo"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1473403384, "post_id": 39404625, "comment_id": 66135977, "body": "yes, but sill not be solved\u3002"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1473427893, "post_id": 39404625, "comment_id": 66149815, "body": "Yes, but it will be nice to know here if progress is made in the Google Group."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 4895059, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-obQBpx20lwU/AAAAAAAAAAI/AAAAAAAAADA/agKuz_ZRqdo/photo.jpg?sz=128", "display_name": "Aiden Luo", "link": "https://stackoverflow.com/users/4895059/aiden-luo"}, "is_accepted": false, "score": 1, "last_activity_date": 1474531633, "creation_date": 1474531633, "answer_id": 39633561, "question_id": 39404625, "link": "https://stackoverflow.com/questions/39404625/golang-websocket-memory-leak/39633561#39633561", "title": "golang websocket memory leak", "body": "<p>Finally I fixed the problem.</p>\n\n<p>I use the <a href=\"https://github.com/auth0/go-jwt-middleware\" rel=\"nofollow\">https://github.com/auth0/go-jwt-middleware</a> to auth with JWT. I also open the KeepContext of gorilla mux router to true for that can get the jwt token of  request from the goriila context. When I get the jwt token, will clear the request context (via context.Clear(r))  immediately. So far, all is work correctly. <strong>But when the go-jwt-middleware auth failed there is no chance to clear the request context because KeepContext of mux has been to true.</strong> This is the root cause. </p>\n"}], "owner": {"reputation": 41, "user_id": 4895059, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-obQBpx20lwU/AAAAAAAAAAI/AAAAAAAAADA/agKuz_ZRqdo/photo.jpg?sz=128", "display_name": "Aiden Luo", "link": "https://stackoverflow.com/users/4895059/aiden-luo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1489, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1474531633, "creation_date": 1473400095, "last_edit_date": 1473404264, "question_id": 39404625, "link": "https://stackoverflow.com/questions/39404625/golang-websocket-memory-leak", "title": "golang websocket memory leak", "body": "<p>We have a websocket service based on go-socket.io( the socket.io golang implementation) and gorilla websocket, but seems have a memory leak problem. The HeapAlloc is always increase even I using the debug.FreeOSMemroy to force release the memory. </p>\n\n<p>The service is very simple. It will authenticate the come in request with jwt token, if authentication is successful, then will create a go-socket.io conn based on the gorilla websocket conn. But now seems that the <strong>net/textproto.(*Reader).ReadMIMEHeader</strong> (contains in net/http.readRequest which located in net/http.(*conn).serve) took much memory which confused me, because when the request hijack to the websocket conn, the net/http.(*conn).serve goroutine will return immediately.</p>\n\n<ol>\n<li>heap in-use callgraph</li>\n</ol>\n\n<p><a href=\"https://lh3.googleusercontent.com/-mm2uAP5ihFM/V9IVWSlqUFI/AAAAAAAAAFc/8lLdQ3XgKCgeuCxQN81VQ8U5mDJcQxvWQCLcB/s1600/heap_in_use.png\" rel=\"nofollow\">https://lh3.googleusercontent.com/-mm2uAP5ihFM/V9IVWSlqUFI/AAAAAAAAAFc/8lLdQ3XgKCgeuCxQN81VQ8U5mDJcQxvWQCLcB/s1600/heap_in_use.png</a></p>\n\n<ol start=\"2\">\n<li>heap alloc space callgraph</li>\n</ol>\n\n<p><a href=\"https://lh3.googleusercontent.com/-zKpnnKowYcc/V9IV5Ncxs3I/AAAAAAAAAFg/hcptQ-bmiwsmRbFYnvTEB9jNylbJ8nh3gCLcB/s1600/heap_alloc.png\" rel=\"nofollow\">https://lh3.googleusercontent.com/-zKpnnKowYcc/V9IV5Ncxs3I/AAAAAAAAAFg/hcptQ-bmiwsmRbFYnvTEB9jNylbJ8nh3gCLcB/s1600/heap_alloc.png</a></p>\n\n<ol start=\"3\">\n<li>gc trace log</li>\n</ol>\n\n<pre><code>\n\ngc 440 @51045.897s 0%: 0.034+4182+0.96 ms clock, 0.13+0/4182/12246+3.8 ms cpu, 4304->4309->4143 MB, 8266 MB goal, 4 P\nscvg340: inuse: 4404, idle: 15, sys: 4419, released: 0, consumed: 4419 (MB)\nGC forced\ngc 441 @51170.096s 0%: 3.7+4355+1.4 ms clock, 14+2.9/4357/12795+5.8 ms cpu, 4317->4323->4158 MB, 8287 MB goal, 4 P\nGC forced\ngc 442 @51294.460s 0%: 0.034+3987+1.2 ms clock, 0.13+1.5/3987/11701+4.9 ms cpu, 4336->4341->4169 MB, 8316 MB goal, 4 P\nscvg341: inuse: 4318, idle: 133, sys: 4451, released: 0, consumed: 4451 (MB)\nGC forced\ngc 443 @51418.451s 0%: 0.36+3925+0.99 ms clock, 1.4+4.0/3925/11554+3.9 ms cpu, 4350->4356->4182 MB, 8338 MB goal, 4 P\nscvg342: inuse: 4363, idle: 103, sys: 4466, released: 0, consumed: 4466 (MB)\nGC forced\ngc 444 @51542.394s 0%: 0.042+3986+1.6 ms clock, 0.16+0/3981/11757+6.5 ms cpu, 4361->4367->4194 MB, 8365 MB goal, 4 P\nscvg343: inuse: 4404, idle: 74, sys: 4478, released: 0, consumed: 4478 (MB)\nGC forced\ngc 445 @51666.384s 0%: 3.4+3987+1.4 ms clock, 13+2.5/3986/11747+5.7 ms cpu, 4375->4382->4208 MB, 8388 MB goal, 4 P\nscvg344: inuse: 4454, idle: 39, sys: 4493, released: 0, consumed: 4493 (MB)\nGC forced\ngc 446 @51790.379s 0%: 0.055+4147+1.5 ms clock, 0.22+0/4139/12125+6.2 ms cpu, 4396->4402->4220 MB, 8416 MB goal, 4 P\nscvg345: inuse: 4509, idle: 5, sys: 4514, released: 0, consumed: 4514 (MB)\nGC forced\ngc 447 @51914.542s 0%: 0.052+4205+2.1 ms clock, 0.21+1.5/4199/12348+8.5 ms cpu, 4413->4420->4234 MB, 8441 MB goal, 4 P\nGC forced\ngc 448 @52038.752s 0%: 2.7+4517+1.8 ms clock, 11+2.3/4517/13245+7.2 ms cpu, 4428->4436->4247 MB, 8469 MB goal, 4 P\nscvg346: inuse: 4406, idle: 142, sys: 4548, released: 0, consumed: 4548 (MB)\nGC forced\ngc 449 @52163.276s 0%: 0.033+4206+1.3 ms clock, 0.13+0/4206/12306+5.3 ms cpu, 4442->4449->4259 MB, 8495 MB goal, 4 P\nscvg347: inuse: 4452, idle: 109, sys: 4561, released: 0, consumed: 4561 (MB)\nGC forced\ngc 450 @52287.491s 0%: 0.044+4262+2.0 ms clock, 0.17+0/4261/12565+8.2 ms cpu, 4452->4459->4272 MB, 8519 MB goal, 4 P\nscvg348: inuse: 4498, idle: 74, sys: 4572, released: 0, consumed: 4572 (MB)\nGC forced\ngc 451 @52411.769s 0%: 0.028+4012+2.0 ms clock, 0.11+0.066/3992/11762+8.0 ms cpu, 4471->4477->4285 MB, 8544 MB goal, 4 P\nscvg349: inuse: 4550, idle: 40, sys: 4590, released: 0, consumed: 4590 (MB)\n\n</code></pre>\n\n<ol start=\"4\">\n<li><p>code example</p>\n\n<pre><code>func (c *CometServer) initHTTPServer() {\n\njwtMiddleware := jwtmiddleware.New(jwtmiddleware.Options{\n        SigningMethod: jwt.SigningMethodHS256,\n        ValidationKeyGetter: func(token *jwt.Token) (interface{}, error) {\n                return []byte(setting.JwtSecret), nil\n        },\n\n        // get token from header, querystring, and cookie\n        Extractor: jwtmiddleware.FromFirst(\n                jwtmiddleware.FromParameter(setting.JwtTokenQueryStringField),\n                TokenFromCookie(setting.JwtTokenCookieField),\n                jwtmiddleware.FromAuthHeader,\n        ),\n        ErrorHandler: jwtErrorHandler,\n})\n\nr := mux.NewRouter()\n// Must call cotext.Clear after every request follow\nr.KeepContext = true\n\nsocketHandler := jwtMiddleware.Handler(c.socketio)\n\nr.Handle(\"/socket.io/\", socketHandler)\n\nif setting.DEBUG {\n        r.PathPrefix(\"/debug/\").Handler(http.DefaultServeMux)\n        r.PathPrefix(\"/\").Handler(http.FileServer(http.Dir(\"./asset/\")))\n}\n\n// n.UseHandler(r)\n\nc.httpServer = &amp;http.Server{\n        Addr:    setting.HTTPListenAddr,\n        Handler: r,\n}\n</code></pre>\n\n<p>}</p>\n\n<p>// ....\n// go-socket.io code\n// ....\nfunc (c *CometServer) initSocketIO() error {\n    server, err := socketio.NewServer(transports)\n    if err != nil {\n            return err\n    }</p>\n\n<pre><code>// ....\n\nserver.On(\"error\", func(so socketio.Socket, err error) {\n        logger := SocketLogger(so)\n        logger.Error(\"socket connect error\")\n})\n</code></pre>\n\n<p>server.On(\"connection\", func(so socketio.Socket) {</p>\n\n<pre><code>        var (\n                uid   string\n                exist bool\n        )\n\n        logger := SocketLogger(so)\n\n        claim := (context.Get(so.Request(), \"user\")).(*jwt.Token).Claims\n        // after get the claims, should clear the request context\n        context.Clear(so.Request())\n\n        var rawUID interface{}\n        if user, ok := claim.(jwt.MapClaims); ok {\n                if rawUID, ok = user[setting.JwtUserClaimField]; !ok {\n                        logger.Error(\"invalid user claim\")\n                        so.Emit(\"disconnect\", \"invalid user claim\")\n                }\n        } else {\n                logger.Errorf(\"invalid jwt claim %s\", claim)\n                so.Emit(\"disconnect\", \"invalid user claim\")\n        }\n\n        if uid, exist = rawUID.(string); exist {\n                // Multi connection for same user will be join to the same room\n                so.Join(uid)\n\n                // root for broadcast all user\n                so.Join(Hourse)\n\n                c.users.Add(uid, 1)\n\n                logger.Debug(\"socket connected\")\n\n                if setting.DEBUG {\n                        so.Emit(\"debug\", fmt.Sprintf(\"Your uid is %s, sid is %s\", uid, so.Id()))\n                }\n        } else {\n                so.Emit(\"disconnect\", \"invalid user claim\")\n        }\n\n        so.On(\"debug\", func(data string) {\n                log.Debugf(\"debug data from client %s\", data)\n        })\n\n        so.On(\"disconnection\", func(data string) {\n                logger.Debugf(\"socket disconnected\")\n                c.users.Add(uid, -1)\n        })\n})\nc.socketio = server\n\nreturn nil\n</code></pre>\n\n<p>}</p></li>\n</ol>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 1, "creation_date": 1473392888, "post_id": 39403513, "comment_id": 66132542, "body": "Did you just inadvertently release your username and password to the whole world? I hope that&#39;s not a public server."}, {"owner": {"reputation": 1414, "user_id": 822779, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/aJm0V.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/822779/sam"}, "edited": false, "score": 0, "creation_date": 1473396763, "post_id": 39403513, "comment_id": 66133513, "body": "I believe that is a WD NAS, so we cannot access it. Still very silly to release it publicly."}, {"owner": {"reputation": 137, "user_id": 5782485, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/da349415a52d4ece0e598781029d8343?s=128&d=identicon&r=PG&f=1", "display_name": "shaidiren", "link": "https://stackoverflow.com/users/5782485/shaidiren"}, "reply_to_user": {"reputation": 767718, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "edited": false, "score": 0, "creation_date": 1473411135, "post_id": 39403513, "comment_id": 66139915, "body": "@paxdiablo It is not a real username and password,But thank you very much, I will not do that again."}], "answers": [{"tags": [], "owner": {"reputation": 137, "user_id": 5782485, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/da349415a52d4ece0e598781029d8343?s=128&d=identicon&r=PG&f=1", "display_name": "shaidiren", "link": "https://stackoverflow.com/users/5782485/shaidiren"}, "is_accepted": false, "score": 0, "last_activity_date": 1473411343, "creation_date": 1473411343, "answer_id": 39407629, "question_id": 39403513, "link": "https://stackoverflow.com/questions/39403513/i-try-to-connect-mysql-with-golang-and-it-reported-an-errors/39407629#39407629", "title": "I try to connect mysql with golang and it reported an errors", "body": "<p>I used <code>db.Ping()</code> twice, if one was removed than it works.</p>\n"}], "owner": {"reputation": 137, "user_id": 5782485, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/da349415a52d4ece0e598781029d8343?s=128&d=identicon&r=PG&f=1", "display_name": "shaidiren", "link": "https://stackoverflow.com/users/5782485/shaidiren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1473411343, "creation_date": 1473392621, "last_edit_date": 1473403875, "question_id": 39403513, "link": "https://stackoverflow.com/questions/39403513/i-try-to-connect-mysql-with-golang-and-it-reported-an-errors", "title": "I try to connect mysql with golang and it reported an errors", "body": "<p>My Test code likes:</p>\n\n<pre><code>package main\nimport (\n        \"fmt\"\n        \"math/rand\"\n        \"time\"\n        \"log\"\n        \"database/sql\"\n        _ \"github.com/go-sql-driver/mysql\"\n)\n\nfunc main() {\n\n        db, err := sql.Open(\"mysql\", \"username:password@tcp(55b5f18rtr8895.sh.cdb.myqcloud.com:7863)/bsk\")\n        if err != nil {\n                log.Println(err)\n        }\n\n        db.SetConnMaxLifetime(100 * 100)\n        db.SetMaxIdleConns(10)\n        db.SetMaxOpenConns(50)\n        defer db.Close()\n\n        db.Ping()\n        err = db.Ping()\n        if err != nil {\n                log.Println(err)\n        }\n\n}\n</code></pre>\n\n<p>And the error is:</p>\n\n<pre><code>driver: bad connection\n</code></pre>\n\n<p>I am sure the mysql host and port is roght.\nBut i just can't find any problems here, please help me.</p>\n"}, {"tags": ["oop", "go"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6811670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/326c198b45b9604c6e1f7a0c738fd94c?s=128&d=identicon&r=PG&f=1", "display_name": "r0tten91", "link": "https://stackoverflow.com/users/6811670/r0tten91"}, "edited": false, "score": 0, "creation_date": 1473429093, "post_id": 39402963, "comment_id": 66150575, "body": "Thanks for your reply! It saved me a lot of effort, but now it generates me another question, how i can refer to current Object, for example i have some Matrix object with some values, and i want to add another Matrix, so how i can refer inside method as self.Matrix or sth like that ?"}, {"owner": {"reputation": 3, "user_id": 6811670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/326c198b45b9604c6e1f7a0c738fd94c?s=128&d=identicon&r=PG&f=1", "display_name": "r0tten91", "link": "https://stackoverflow.com/users/6811670/r0tten91"}, "edited": false, "score": 0, "creation_date": 1473431948, "post_id": 39402963, "comment_id": 66152584, "body": "Okay, got it! Ill post code if anyone will need some feedback on this ;)      type MatrixMethods interface {        \tadd(inputMatrix [][]int) [][]int     }          type Matrix [][]int      func NewThing(inMatrix [][]int) *Matrix {     \t    p := new(Matrix) \t    return p     }      func (m Matrix) add(inputMatrix [][]int) { \t    fmt.Println(&quot;Matrix 1&quot;, m) \t    fmt.Println(&quot;Another Matrix&quot;, inputMatrix) \t    // do what you want! :)       }"}], "tags": [], "owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "is_accepted": true, "score": 3, "last_activity_date": 1473388410, "creation_date": 1473388410, "answer_id": 39402963, "question_id": 39402767, "link": "https://stackoverflow.com/questions/39402767/golang-oop-architecture-passing-a-slice-into-a-constructor-creating-a-slice-ob/39402963#39402963", "title": "Golang OOP architecture, passing a slice into a constructor, creating a slice object", "body": "<p>What your compiler is saying is that <code>[][]int</code> and <code>Matrix</code> are two totally unrelated types. You can not convert from one to the other. Thats because <code>Matrix</code> is a <code>struct</code> which <em>contains</em> a <code>[][]int</code>, but <code>Matrix</code> <em>is not</em> an <code>[][]int</code>. To create a <code>Matrix</code> out of it you'd need to create a new <code>Matrix</code> and set the <code>[][]int</code> to the only member:</p>\n\n<pre><code>a := Matrix{nonsingularRandomMatrix()}\n</code></pre>\n\n<p>An easier way would be if <code>Matrix</code> <em>were</em> a <code>[][]int</code>.</p>\n\n<pre><code>type Matrix [][]int\n</code></pre>\n\n<p>This would just create a new name (<code>Matrix</code>) for <code>[][]int</code>, and in this case, a simple (explicit) conversion would work</p>\n\n<pre><code>Matrix(nonsingularRandomMatrix())\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6811670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/326c198b45b9604c6e1f7a0c738fd94c?s=128&d=identicon&r=PG&f=1", "display_name": "r0tten91", "link": "https://stackoverflow.com/users/6811670/r0tten91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 39402963, "answer_count": 1, "score": 0, "last_activity_date": 1473388410, "creation_date": 1473386858, "last_edit_date": 1592644375, "question_id": 39402767, "link": "https://stackoverflow.com/questions/39402767/golang-oop-architecture-passing-a-slice-into-a-constructor-creating-a-slice-ob", "title": "Golang OOP architecture, passing a slice into a constructor, creating a slice object", "body": "<p>I just started with <code>go</code> language, everything looks cool, I coded everything I need but I have two problems, actually it is passing an slice into a <code>Struct</code> or so called <code>object</code>, and how to create a method that I can add for example another matrix, but this is minor problem I think.</p>\n<h3>Code:</h3>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;math/rand&quot;\n    &quot;time&quot;\n)\n\nfunc main() {\n    a := Matrix(nonsingularRandomMatrix())\n    fmt.Println(a)\n}\n\ntype Matrix struct {\n\n    inputMatrix [][]int\n}\n\nfunc NewThing(inMatrix [][]int) *Matrix {\n    p := new(Matrix)\n    p.inputMatrix = inMatrix\n    return p\n}\n\nfunc nonsingularRandomMatrix() [][]int {\n    rand.Seed(time.Now().UTC().UnixNano())\n    var matrixDeterminant int = 0\n    nm := make([][]int, 4)\n    for i := 0; i &lt; 4; i++ {\n        nm[i] = make([]int, 4)\n        for j := 0; j &lt; 4; j++ {\n            nm[i][j] = rand.Intn(100)\n    }\n}\nmatrixDeterminant =\n    nm[0][0]*nm[1][1]*nm[2][2]*nm[3][3] - nm[0][0]*nm[1][1]*nm[2][3]*nm[3][2] -\n        nm[0][0]*nm[1][2]*nm[2][1]*nm[3][3] + nm[0][0]*nm[1][2]*nm[2][3]*nm[3][1] +\n        nm[0][0]*nm[1][3]*nm[2][1]*nm[3][2] - nm[0][0]*nm[1][3]*nm[2][2]*nm[3][1] -\n        nm[0][1]*nm[1][0]*nm[2][2]*nm[3][3] + nm[0][1]*nm[1][0]*nm[2][3]*nm[3][2] +\n        nm[0][1]*nm[1][2]*nm[2][0]*nm[3][3] - nm[0][1]*nm[1][2]*nm[2][3]*nm[3][0] -\n        nm[0][1]*nm[1][3]*nm[2][0]*nm[3][2] + nm[0][1]*nm[1][3]*nm[2][2]*nm[3][0] +\n        nm[0][2]*nm[1][0]*nm[2][1]*nm[3][3] - nm[0][2]*nm[1][0]*nm[2][3]*nm[3][1] -\n        nm[0][2]*nm[1][1]*nm[2][0]*nm[3][3] + nm[0][2]*nm[1][1]*nm[2][3]*nm[3][0] +\n        nm[0][2]*nm[1][3]*nm[2][0]*nm[3][1] - nm[0][2]*nm[1][3]*nm[2][1]*nm[3][0] -\n        nm[0][3]*nm[1][0]*nm[2][1]*nm[3][2] + nm[0][3]*nm[1][0]*nm[2][2]*nm[3][1] +\n        nm[0][3]*nm[1][1]*nm[2][0]*nm[3][2] - nm[0][3]*nm[1][1]*nm[2][2]*nm[3][0] -\n        nm[0][3]*nm[1][2]*nm[2][0]*nm[3][1] + nm[0][3]*nm[1][2]*nm[2][1]*nm[3][0]\nif matrixDeterminant == 0 {\n    nonsingularRandomMatrix()\n}\nreturn nm\n}\n</code></pre>\n<h3>Output from my console:</h3>\n<blockquote>\n<p>go run oop.go</p>\n<p>command-line-arguments</p>\n<p>.\\oop.go:10: cannot convert nonsingularRandomMatrix() (type [][]int) to type Matrix</p>\n</blockquote>\n<p>Any clue?</p>\n<p>Greets!</p>\n"}, {"tags": ["ssl", "go"], "answers": [{"tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": true, "score": 2, "last_activity_date": 1473395540, "creation_date": 1473395540, "answer_id": 39403909, "question_id": 39402674, "link": "https://stackoverflow.com/questions/39402674/go-tls-handshake-error/39403909#39403909", "title": "Go TLS handshake error", "body": "<p>This is usually nothing to worry about. This can simply be some network scanner which just tries to find out if somebody is listening on the port or some client with bad connectivity. As long as you don't get any problem reports from real clients you can just ignore this noise.</p>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 883, "favorite_count": 0, "accepted_answer_id": 39403909, "answer_count": 1, "score": 3, "last_activity_date": 1473395540, "creation_date": 1473386176, "question_id": 39402674, "link": "https://stackoverflow.com/questions/39402674/go-tls-handshake-error", "title": "Go TLS handshake error", "body": "<p>So everything seems to be working fine on my webserver. But I randomly get</p>\n\n<blockquote>\n  <p>http: TLS handshake error from IP EOF</p>\n</blockquote>\n\n<p>The certs are all good. HTTPS connection works fine on mobile and desktop but I randomly get this error messages. Shouls I be worried or maybe its some bot with no https support?</p>\n\n<p>The server is just a regular ListenAndServeTLS with an httprouter passed with the cert and key files. No error returned</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1473385201, "post_id": 39402443, "comment_id": 66130941, "body": "They are both concrete map types.  One of them has an interface value type.  Write a for loop to construct the <code>map[string]IterableWithID</code> from a <code>map[string]MyType</code>."}, {"owner": {"reputation": 393, "user_id": 2966482, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2b686d935b792668064807b6100ad653?s=128&d=identicon&r=PG&f=1", "display_name": "arduima", "link": "https://stackoverflow.com/users/2966482/arduima"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1473386646, "post_id": 39402443, "comment_id": 66131278, "body": "I should have said &quot;pass a map of a concrete type to a method that has a map of an interface type in the signature&quot;. MyType implements IterableWithID but the compiler says it&#39;s not valid."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1473392645, "post_id": 39402443, "comment_id": 66132491, "body": "My point is that is that the values have different concrete types.  It&#39;s not possible to assign one to the other."}], "answers": [{"tags": [], "owner": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "is_accepted": false, "score": 1, "last_activity_date": 1473388856, "creation_date": 1473388856, "answer_id": 39403027, "question_id": 39402443, "link": "https://stackoverflow.com/questions/39402443/use-mapstringspecifictype-with-method-of-mapstringsomeinterface-into/39403027#39403027", "title": "Use map[string]SpecificType with method of map[string]SomeInterface into", "body": "<p>Go's interface convention doesn't quite work the same way as in, say, Java (and the designers apparently didn't like the idea of getters and setters very much :-/ ).  So you've got two core problems:</p>\n\n<ol>\n<li>A map[string]Foo is not the same as a map[string]Bar, even if Bar implements Foo, so you have to break it out a bit (use make() beforehand, then assign in a single assignment).</li>\n<li>Interface methods are called by value with no pointers, so you really need to do foo = foo.Method(bar) in your callers or get really pointer-happy to implement something like this.</li>\n</ol>\n\n<p>What you can do to more-or-less simulate what you want:</p>\n\n<pre><code>type IterableWithID interface {\n    SetID(id string) IterableWithID     // use as foo = foo.SetID(bar)\n}\n\nfunc (t MyType) SetID(id string) IterableWithID {\n    t.ID = id\n    return t\n}\n\n...and to deal with the typing problem\n\nt := make(map[string]IterableWithID)\nt[\"foo\"] = MyType{}\nMapToList(t)              // This is a map[string]IterableWithID, so compiler's happy. \n\n...and finally...\n\nvalue = value.SetID(key)  // We set back the copy of the value we mutated\n</code></pre>\n\n<p>The final value= deals with the fact that the method gets a fresh copy of the value object, so the original would be untouched by your method (the change would simply vanish).</p>\n\n<p>Updated code on <a href=\"https://play.golang.org/p/OgFjTFw_LZ\" rel=\"nofollow\">the Go Playground</a></p>\n\n<p>...but it's not particularly idiomatic Go--they really want you to just reference struct members rather than use Java-style mutators in interfaces (though TBH I'm not so keen on that little detail--mutators are supes handy to do validation).</p>\n"}, {"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 1, "last_activity_date": 1473389952, "creation_date": 1473389952, "answer_id": 39403151, "question_id": 39402443, "link": "https://stackoverflow.com/questions/39402443/use-mapstringspecifictype-with-method-of-mapstringsomeinterface-into/39403151#39403151", "title": "Use map[string]SpecificType with method of map[string]SomeInterface into", "body": "<p>You can't do what you want to do because the two map types are different. It doesn't matter that the element type of one is a type that implements the interface which is the element type of the other. The map type that you pass into the function has to be <code>map[string]IterableWithID</code>. You could create a map of that type, assign values of type <code>MyType</code> to the map, and pass that to the function.</p>\n\n<p>See <a href=\"https://play.golang.org/p/NfsTlunHkW\" rel=\"nofollow\">https://play.golang.org/p/NfsTlunHkW</a></p>\n\n<p>Also, you probably don't want to be returning a pointer to a slice in <code>MapToList</code>. Just return the slice itself. A slice contains a reference to the underlying array.</p>\n"}], "owner": {"reputation": 393, "user_id": 2966482, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2b686d935b792668064807b6100ad653?s=128&d=identicon&r=PG&f=1", "display_name": "arduima", "link": "https://stackoverflow.com/users/2966482/arduima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1473389952, "creation_date": 1473384033, "question_id": 39402443, "link": "https://stackoverflow.com/questions/39402443/use-mapstringspecifictype-with-method-of-mapstringsomeinterface-into", "title": "Use map[string]SpecificType with method of map[string]SomeInterface into", "body": "<p>I get <code>cannot use map[string]MyType literal (type map[string]MyType) as type map[string]IterableWithID in argument to MapToList</code> with the code below, how do I pass in a concrete map type to method that expects a interface type? </p>\n\n<p><a href=\"https://play.golang.org/p/G7VzMwrRRw\" rel=\"nofollow\">https://play.golang.org/p/G7VzMwrRRw</a></p>\n"}, {"tags": ["ssl", "go", "lets-encrypt"], "comments": [{"owner": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "edited": false, "score": 2, "creation_date": 1473381605, "post_id": 39402128, "comment_id": 66130164, "body": "This sounds more like DNS and IP.  Connection refused means that there&#39;s no TCP listener on the port (or a facsimile thereof).  Do example.com and www.example.com resolve to the same IP?"}, {"owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "reply_to_user": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "edited": false, "score": 0, "creation_date": 1473381802, "post_id": 39402128, "comment_id": 66130212, "body": "Could it be my DNS setup? I have A record with host www pointing to my ip and URL redirect record with @ host pointing to www.example.com"}, {"owner": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "edited": false, "score": 0, "creation_date": 1473382113, "post_id": 39402128, "comment_id": 66130288, "body": "&quot;URL redirect records&quot; are a fiction that domain providers use to redirect folks (i.e. that&#39;s not an actual DNS thing).  Basically what happens is that your A record points to THEIR server, which terminates the first connection and serves an HTTP 302 or similar to go to the address you actually want.  In this case, your domain provider isn&#39;t providing SSL, so your connect refused.  Usually I put the A record for the IP on @ and use a CNAME to redirect &quot;www&quot; -&gt; @ and that&#39;s the sanest thing to do if you can."}, {"owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "reply_to_user": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "edited": false, "score": 0, "creation_date": 1473382307, "post_id": 39402128, "comment_id": 66130331, "body": "I can change it yeah. But on my provider it says that &quot;Setting up CNAME for a naked domain may affect email service&quot; should I worry about this?"}, {"owner": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "edited": false, "score": 0, "creation_date": 1473382487, "post_id": 39402128, "comment_id": 66130381, "body": "If @ is an actual A record, www is a CNAME, you have one or more @ MX records, and you are only using user@example.com (and not user@www.example.com) email addresses, you should be fine.  PM me with your domain and I&#39;ll hit it with host(1) and see if there are any obvious red flags."}, {"owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "reply_to_user": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "edited": false, "score": 0, "creation_date": 1473382905, "post_id": 39402128, "comment_id": 66130471, "body": "I dont think stackoverflow supports private messages. I cant add a CNAME record for www -&gt; @ with the error @ should not be an IP/URL for CNAME"}, {"owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "reply_to_user": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "edited": false, "score": 0, "creation_date": 1473383031, "post_id": 39402128, "comment_id": 66130503, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/122945/discussion-between-alvaro-carvajal-nakosmai-and-bj-black\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "is_accepted": false, "score": 0, "last_activity_date": 1473383567, "creation_date": 1473383567, "answer_id": 39402390, "question_id": 39402128, "link": "https://stackoverflow.com/questions/39402128/lets-encrypt-and-go/39402390#39402390", "title": "Lets encrypt and Go", "body": "<p>This as told in the comments was a DNS error caused by using URL REDIRECT record</p>\n\n<p>I simply added an A record pointint @ to my IP and the same for www</p>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473383567, "creation_date": 1473381431, "question_id": 39402128, "link": "https://stackoverflow.com/questions/39402128/lets-encrypt-and-go", "title": "Lets encrypt and Go", "body": "<p>I currently have my letsencrypt certs set up for my domain www.example.com and example.com</p>\n\n<p>When I open my server <a href=\"https://www.example.com\" rel=\"nofollow\">https://www.example.com</a> works perfectly BUT <a href=\"https://example.com\" rel=\"nofollow\">https://example.com</a> will give me</p>\n\n<blockquote>\n  <p>ERR_CONNECTION_REFUSED</p>\n</blockquote>\n\n<p>I am doing the server the following way</p>\n\n<pre><code>if err := http.ListenAndServeTLS(\n    \":443\",\n    \"domain-crt.pem\",\n    \"domain-key.pem\",\n    Route.router,\n); err != nil {\n    ERROR.Fatal(err)\n}\n</code></pre>\n\n<p>This gives me no errors and with the www the website works fine. The .pem files are not encrypted and the ListenAndServeTLS doesn't return any error.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6023, "user_id": 4236078, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/9959d878feda9f2bab4b43b554e09847?s=128&d=identicon&r=PG&f=1", "display_name": "ale64bit", "link": "https://stackoverflow.com/users/4236078/ale64bit"}, "edited": false, "score": 0, "creation_date": 1473374923, "post_id": 39401185, "comment_id": 66128612, "body": "I&#39;m not able to reproduce your error. Are you sure there&#39;s nothing else around causing it? <a href=\"https://play.golang.org/p/OpqqN7cBFZ\" rel=\"nofollow noreferrer\">play.golang.org/p/OpqqN7cBFZ</a>"}, {"owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "edited": false, "score": 0, "creation_date": 1473377060, "post_id": 39401185, "comment_id": 66129140, "body": "What do you mean by &quot;factor these into a single function&quot;? <code>getString</code> reads a string out of a map and returns it. <code>getInt</code> reads an int out of a map and returns it. In Go, these are very different behaviors."}, {"owner": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "edited": false, "score": 0, "creation_date": 1473385275, "post_id": 39401185, "comment_id": 66130952, "body": "Might there be a different &quot;s&quot; somewhere in your code that&#39;s confusing you?  (Hint: Use more descriptive varnames)."}], "answers": [{"comments": [{"owner": {"reputation": 999, "user_id": 98328, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XgbPP.jpg?s=128&g=1", "display_name": "Charlie Skilbeck", "link": "https://stackoverflow.com/users/98328/charlie-skilbeck"}, "edited": false, "score": 0, "creation_date": 1473399930, "post_id": 39401283, "comment_id": 66134504, "body": "err ma gerrrd. In my defence, it was nearly midnight. Thanks!"}], "tags": [], "owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "is_accepted": false, "score": 1, "last_activity_date": 1473374934, "creation_date": 1473374934, "answer_id": 39401283, "question_id": 39401185, "link": "https://stackoverflow.com/questions/39401185/go-var-declared-but-not-used-error-how-to-work-around-it/39401283#39401283", "title": "go: var declared but not used error - how to work around it?", "body": "<p>Your error comes from (declaring and not) using the same identifier elsewhere because this compiles and runs fine on <code>golang.org</code>:</p>\n\n<pre><code>package main\n\nimport \"reflect\"\n\nfunc main() {\n    m := make(map[string]interface{})\n    m[\"foo\"] = \"25\"\n    getString(m, \"foo\")\n}\n\nfunc getString(data map[string]interface{}, name string) (string, error) {\n    s := data[name]\n    if reflect.TypeOf(s).Kind() != reflect.String {\n        return s.(string), nil\n    }\n    return \"\", nil\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 999, "user_id": 98328, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XgbPP.jpg?s=128&g=1", "display_name": "Charlie Skilbeck", "link": "https://stackoverflow.com/users/98328/charlie-skilbeck"}, "edited": false, "score": 0, "creation_date": 1473400008, "post_id": 39402019, "comment_id": 66134531, "body": "Thanks! You&#39;re right, it&#39;s questionable whether this is an improvement on the situation."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1473380635, "creation_date": 1473380635, "answer_id": 39402019, "question_id": 39401185, "link": "https://stackoverflow.com/questions/39401185/go-var-declared-but-not-used-error-how-to-work-around-it/39402019#39402019", "title": "go: var declared but not used error - how to work around it?", "body": "<p>Your code looks correct, error isn't reproducible.\nSure you can refactor these into a single function, but you may not like it depending of tastes.</p>\n\n<pre><code>type VType int\nconst (\n    VInteger VType = iota\n    VString\n    VUnknown\n)\nfunc getValue(data map[string]interface{}, name string) (VType, int, string) {\n    switch v := data[name].(type) {\n    case int:\n        return VInteger, v, \"\"\n    case string:\n        return VString, 0, v\n    default:\n        return VUnknown, 0, \"\"\n    }\n}\nfunc main() {\n    m := make(map[string]interface{})\n    m[\"foo\"] = \"25\"\n    switch t, i, s := getValue(m, \"foo\"); t {\n    case VInteger:\n        fmt.Println(\"int \", i)  //do something with int\n    case VString:\n        fmt.Println(\"string \", s) //do something with string\n    case VUnknown:\n        err := &amp;apiError{1, \"it's not an int\"} //do something with err\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 999, "user_id": 98328, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/XgbPP.jpg?s=128&g=1", "display_name": "Charlie Skilbeck", "link": "https://stackoverflow.com/users/98328/charlie-skilbeck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1473380635, "creation_date": 1473374147, "question_id": 39401185, "link": "https://stackoverflow.com/questions/39401185/go-var-declared-but-not-used-error-how-to-work-around-it", "title": "go: var declared but not used error - how to work around it?", "body": "<p>In this function I get <strong><em>\"s declared and not used\"</em></strong> which I don't understand - do I need to somehow tag it as 'really I used it' or something?</p>\n\n<pre><code>func getString(data map[string]interface{}, name string) (string, error) {\n    s := data[name]\n    if reflect.TypeOf(s).Kind() != reflect.String {\n        return s.(string), nil\n    }\n    return \"\", &amp;apiError{1, \"it's not a string\"}\n}\n</code></pre>\n\n<p>Oddly, I don't get the error from this function:</p>\n\n<pre><code>func getInt(data map[string]interface{}, name string) (int, error) {\n    t := data[name]\n    if reflect.TypeOf(t).Kind() == reflect.Int {\n        return t.(int), nil\n    }\n    return 0, &amp;apiError{1, \"it's not an int\"}\n}\n</code></pre>\n\n<p>Also, any thoughts on the right way to factor these into a single function would be welcomed!</p>\n"}, {"tags": ["node.js", "go", "docker", "docker-machine", "docker-toolbox"], "answers": [{"tags": [], "owner": {"reputation": 336, "user_id": 1994837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab8d0644e7c302549d515e305e5c5338?s=128&d=identicon&r=PG", "display_name": "deanrock0", "link": "https://stackoverflow.com/users/1994837/deanrock0"}, "is_accepted": true, "score": 16, "last_activity_date": 1473417019, "creation_date": 1473417019, "answer_id": 39409497, "question_id": 39400128, "link": "https://stackoverflow.com/questions/39400128/empty-reply-from-server-when-trying-to-run-webpack-dev-server-inside-a-docker/39409497#39409497", "title": "&quot;Empty reply from server&quot; when trying to run webpack-dev-server inside a docker container with docker-compose on windows running docker-toolbox", "body": "<p>Webpack development server by default listens on localhost only.</p>\n\n<p>If you want to expose it's port outside of Docker container you need to explicitly specify host to listen to:</p>\n\n<blockquote>\n  <p>webpack-dev-server --host 0.0.0.0 --port 80</p>\n</blockquote>\n"}], "owner": {"reputation": 2023, "user_id": 2402929, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wd4f2.jpg?s=128&g=1", "display_name": "xtrinch", "link": "https://stackoverflow.com/users/2402929/xtrinch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3380, "favorite_count": 0, "accepted_answer_id": 39409497, "answer_count": 1, "score": 8, "last_activity_date": 1473417019, "creation_date": 1473368456, "last_edit_date": 1473412976, "question_id": 39400128, "link": "https://stackoverflow.com/questions/39400128/empty-reply-from-server-when-trying-to-run-webpack-dev-server-inside-a-docker", "title": "&quot;Empty reply from server&quot; when trying to run webpack-dev-server inside a docker container with docker-compose on windows running docker-toolbox", "body": "<p>I am having problems accessing a react container run with docker-compose inside docker-machine. I can curl the webpage inside the container, but I cannot access it inside docker-machine (or on the host's browser for that matter). The backend Golang container can be accessed from docker-machine and from the host's browser (as seen in the snippets, it returns a <em>404 not found</em>).</p>\n\n<p>In the docker-compose logs everything seems to be running smoothly, webpack-dev-server runs as expected, I just can't access it from outside the container.</p>\n\n<p>I am using docker toolbox for windows.</p>\n\n<p>Best to additionally describe the problem with some snippets.</p>\n\n<p><strong>Docker-compose file:</strong></p>\n\n<pre><code>version: '2'\nservices:\n    postgres:\n        image: postgres\n        environment:\n            - POSTGRES_PASSWORD=postgres\n    server:\n        build: ./server\n        command: gin\n        volumes:\n            - ./server:/go/src/app\n        ports:\n            - \"8080:3000\"\n        environment:\n            - POSTGRES_PASSWORD=postgres\n    client:\n        build: ./client\n        command: npm start\n        volumes:\n            - ./client:/usr/src/app\n            # mount node_modules as a workaround for it disappearing\n            # after adding /client as a mounted folder\n            - /usr/src/app/node_modules\n        ports:\n            - \"9000:3000\"\n</code></pre>\n\n<p><strong>Dockerfile for the node container:</strong></p>\n\n<pre><code>FROM node:6.5.0-slim\n\nRUN mkdir -p /usr/src/app\nWORKDIR /usr/src/app\n\nCOPY package.json /usr/src/app/\nENV NODE_ENV development\nRUN npm install\n</code></pre>\n\n<p><strong>Output of the following commands inside docker-machine (default):</strong></p>\n\n<blockquote>\n  <p>docker@default:~$ sudo iptables -t nat -L -n</p>\n</blockquote>\n\n<pre><code>Chain PREROUTING (policy ACCEPT)\ntarget     prot opt source               destination\nDOCKER     all  --  0.0.0.0/0            0.0.0.0/0            ADDRTYPE match dst-type LOCAL\n\nChain INPUT (policy ACCEPT)\ntarget     prot opt source               destination\n\nChain OUTPUT (policy ACCEPT)\ntarget     prot opt source               destination\nDOCKER     all  --  0.0.0.0/0           !127.0.0.0/8          ADDRTYPE match dst-type LOCAL\n\nChain POSTROUTING (policy ACCEPT)\ntarget     prot opt source               destination\nMASQUERADE  all  --  172.17.0.0/16        0.0.0.0/0\nMASQUERADE  all  --  172.19.0.0/16        0.0.0.0/0\nMASQUERADE  all  --  172.18.0.0/16        0.0.0.0/0\nMASQUERADE  tcp  --  172.19.0.2           172.19.0.2           tcp dpt:3000\nMASQUERADE  tcp  --  172.19.0.3           172.19.0.3           tcp dpt:3000\n\nChain DOCKER (2 references)\ntarget     prot opt source               destination\nRETURN     all  --  0.0.0.0/0            0.0.0.0/0\nRETURN     all  --  0.0.0.0/0            0.0.0.0/0\nRETURN     all  --  0.0.0.0/0            0.0.0.0/0\nDNAT       tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:8080 to:172.19.0.2:3000\nDNAT       tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:9000 to:172.19.0.3:3000\n</code></pre>\n\n<p><em>Here comes the main problem:</em></p>\n\n<blockquote>\n  <p>docker@default:~$ curl 0.0.0.0:9000</p>\n</blockquote>\n\n<pre><code>curl: (52) Empty reply from server\n</code></pre>\n\n<blockquote>\n  <p>docker@default:~$ curl 0.0.0.0:8080</p>\n</blockquote>\n\n<pre><code>404 page not found\n</code></pre>\n\n<blockquote>\n  <p>docker@default:~$ docker ps</p>\n</blockquote>\n\n<pre><code>CONTAINER ID        IMAGE                COMMAND                  CREATED             STATUS              PORTS\n           NAMES\nf93fd1833de2        goreacttodo_client   \"npm start\"              32 minutes ago      Up 5 minutes        0.0.0.0:9000-&gt;\n3000/tcp   goreacttodo_client_1\nff1fa9c33b05        postgres             \"/docker-entrypoint.s\"   3 days ago          Up 5 minutes        5432/tcp\n           goreacttodo_postgres_1\ne4581f8e368b        goreacttodo_server   \"gin\"                    3 days ago          Up 5 minutes        0.0.0.0:8080-&gt;\n3000/tcp   goreacttodo_server_1\n</code></pre>\n\n<p>Output of the following commands inside the node container:</p>\n\n<blockquote>\n  <p>root@f93fd1833de2:/usr/src/app# curl localhost:3000</p>\n</blockquote>\n\n<pre><code>&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;/head&gt;\n&lt;body lang=\"en\"&gt;\n&lt;div id=\"react-app\"&gt;&lt;/div&gt;\n&lt;script src=\"/bundle.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<p>Any help would be greatly appreaciated.</p>\n"}, {"tags": ["go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 4057002, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/b66037f1824e75561304a1ae74df0426?s=128&d=identicon&r=PG&f=1", "display_name": "balakrishna", "link": "https://stackoverflow.com/users/4057002/balakrishna"}, "edited": false, "score": 1, "creation_date": 1473360631, "post_id": 39398111, "comment_id": 66122362, "body": "two files are in 2 different packages."}, {"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "reply_to_user": {"reputation": 119, "user_id": 4057002, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/b66037f1824e75561304a1ae74df0426?s=128&d=identicon&r=PG&f=1", "display_name": "balakrishna", "link": "https://stackoverflow.com/users/4057002/balakrishna"}, "edited": false, "score": 0, "creation_date": 1473360969, "post_id": 39398111, "comment_id": 66122545, "body": "@balakrishna how about now? added Alexey Soshin tip as well"}, {"owner": {"reputation": 119, "user_id": 4057002, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/b66037f1824e75561304a1ae74df0426?s=128&d=identicon&r=PG&f=1", "display_name": "balakrishna", "link": "https://stackoverflow.com/users/4057002/balakrishna"}, "edited": false, "score": 0, "creation_date": 1473362130, "post_id": 39398111, "comment_id": 66123146, "body": "Thanks for the reply @CESCO.   ecap := abc.ECAP{new(abc.ECA)} is giving error &quot;implicit assignment of unexported field &#39;eca&#39; in abc.ECAP literal&quot; as eca is un-exported field in ECA struct."}, {"owner": {"reputation": 119, "user_id": 4057002, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/b66037f1824e75561304a1ae74df0426?s=128&d=identicon&r=PG&f=1", "display_name": "balakrishna", "link": "https://stackoverflow.com/users/4057002/balakrishna"}, "edited": false, "score": 0, "creation_date": 1473363565, "post_id": 39398111, "comment_id": 66123902, "body": "Unfortunately i should not touch the package &quot;abc&quot;. Is there any way that i can do without changing to exported field ?"}], "tags": [], "owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "is_accepted": false, "score": 0, "last_activity_date": 1473362393, "last_edit_date": 1473362393, "creation_date": 1473360251, "answer_id": 39398111, "question_id": 39397865, "link": "https://stackoverflow.com/questions/39397865/how-to-create-object-for-a-struct-in-golang/39398111#39398111", "title": "How to create object for a struct in golang", "body": "<p>You need to import the second file from your $GOPATH.  And your function return 2 values, not just an error.</p>\n\n<pre><code>package main\n\n\nimport (\n     \"$RELATIVE_PATH_FROM_GOPATH/abc\"\n)\n\n\nvar ecap := ECAP{new(ECA)} //initialize your struct, since it has pointers\n\nfunc main() {\n    cert, err = ecap.ReadCACertificate(floo,floo)\n}\n</code></pre>\n\n<h1>File 1</h1>\n\n<pre><code>type ECAP struct {\n    Eca *ECA //uppercase make field be exported\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 4057002, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/b66037f1824e75561304a1ae74df0426?s=128&d=identicon&r=PG&f=1", "display_name": "balakrishna", "link": "https://stackoverflow.com/users/4057002/balakrishna"}, "edited": false, "score": 0, "creation_date": 1473361129, "post_id": 39398162, "comment_id": 66122636, "body": "I am importing package &quot;abc&quot; into another package &quot;main&quot;. If you see the struct &quot;ECAP&quot; has one field &quot;eca&quot; which is un-exported field in package &quot;abc&quot;.  If i tried to create instance for ECAP struct i am getting error <b>&quot;implicit assignment of unexported field &#39;eca&#39; in abc.ECAP literal&quot;</b>"}, {"owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "reply_to_user": {"reputation": 119, "user_id": 4057002, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/b66037f1824e75561304a1ae74df0426?s=128&d=identicon&r=PG&f=1", "display_name": "balakrishna", "link": "https://stackoverflow.com/users/4057002/balakrishna"}, "edited": false, "score": 0, "creation_date": 1473361692, "post_id": 39398162, "comment_id": 66122906, "body": "If you stick with the packages, then use also abc.ECA"}, {"owner": {"reputation": 119, "user_id": 4057002, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/b66037f1824e75561304a1ae74df0426?s=128&d=identicon&r=PG&f=1", "display_name": "balakrishna", "link": "https://stackoverflow.com/users/4057002/balakrishna"}, "edited": false, "score": 0, "creation_date": 1473362017, "post_id": 39398162, "comment_id": 66123088, "body": "<b>ecap := abc.ECAP{new(abc.ECA)}</b> is giving error &quot;implicit assignment of unexported field &#39;eca&#39; in abc.ECAP literal&quot; as eca is un-exported field in ECA struct."}], "tags": [], "owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "is_accepted": false, "score": 1, "last_activity_date": 1473360401, "creation_date": 1473360401, "answer_id": 39398162, "question_id": 39397865, "link": "https://stackoverflow.com/questions/39397865/how-to-create-object-for-a-struct-in-golang/39398162#39398162", "title": "How to create object for a struct in golang", "body": "<p>Your example is incomplete, but basically you need to initialize your struct, since it has pointers, and default pointer value is nil.</p>\n\n<pre><code>var ecap := ECAP{new(ECA)}\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 4057002, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/b66037f1824e75561304a1ae74df0426?s=128&d=identicon&r=PG&f=1", "display_name": "balakrishna", "link": "https://stackoverflow.com/users/4057002/balakrishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7801, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1567602125, "creation_date": 1473359290, "last_edit_date": 1473360593, "question_id": 39397865, "link": "https://stackoverflow.com/questions/39397865/how-to-create-object-for-a-struct-in-golang", "title": "How to create object for a struct in golang", "body": "<p><em>File1.go</em></p>\n\n<pre><code>Package abc\n\ntype ECA struct {\n    *CA\n    obcKey          []byte\n    obcPriv, obcPub []byte\n    gRPCServer      *grpc.Server\n}\n\n\ntype ECAP struct {\n    eca *ECA\n}\n\n\nfunc (ecap *ECAP) ReadCACertificate(ctx context.Context, in *pb.Empty) (*pb.Cert, error) {\n    Trace.Println(\"gRPC ECAP:ReadCACertificate\")\n\n    return &amp;pb.Cert{Cert: ecap.eca.raw}, nil\n}\n</code></pre>\n\n<p><em>File2.go</em></p>\n\n<pre><code>package main\n\nimport \"abc\"\n\nvar ecap abc.ECAP //creating instance\n\nfunc main() {\n    err = ecap.ReadCACertificate(floo,floo)\n}\n</code></pre>\n\n<p>I am a newbie. I want to create instance of ECAP struct and call ReadCACertificate method. Right now i am creating like this \"var ecap abc.ECAP //creating instance\" which is giving \"nil\" and nil pointer error.</p>\n\n<p>Can anyone help how to call the ReadCACertificate method in efficient way.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["unit-testing", "intellij-idea", "go", "intellij-plugin"], "answers": [{"comments": [{"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1473438114, "post_id": 39410326, "comment_id": 66156428, "body": "Oh, I see it in the jUnit tab. It did not occur to me that something like this might be test type related implementation - that I find as a strange decision anyways. I am using intelliJ with go and I was looking for such for Go Test. It seems that for this I need to request a plugin change."}], "tags": [], "owner": {"reputation": 17947, "user_id": 4510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a51b77dc8b8d8a2dd5d0f882f2cc736?s=128&d=identicon&r=PG", "display_name": "Bas Leijdekkers", "link": "https://stackoverflow.com/users/4510/bas-leijdekkers"}, "is_accepted": true, "score": 13, "last_activity_date": 1473419737, "creation_date": 1473419737, "answer_id": 39410326, "question_id": 39396165, "link": "https://stackoverflow.com/questions/39396165/how-to-run-one-or-group-of-tests-repeatedly-in-go-test-intellij/39410326#39410326", "title": "how to run one or group of tests repeatedly in Go Test IntelliJ", "body": "<p>In the Run Configuration of the test there is a \"Repeat:\" dropdown where you can specify the number of repeats, for example until the test fails. I believe this is available since IntelliJ IDEA 15.</p>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 2679628, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WFYxr.jpg?s=128&g=1", "display_name": "Puneet", "link": "https://stackoverflow.com/users/2679628/puneet"}, "is_accepted": false, "score": -1, "last_activity_date": 1473525513, "creation_date": 1473525513, "answer_id": 39428271, "question_id": 39396165, "link": "https://stackoverflow.com/questions/39396165/how-to-run-one-or-group-of-tests-repeatedly-in-go-test-intellij/39428271#39428271", "title": "how to run one or group of tests repeatedly in Go Test IntelliJ", "body": "<pre><code>You can use oracle JDK to create a executor service which schedules the running /execution of the test suite periodically unless you shut down the service \n\nPlease have a look at the below oracle doc \n\nhttps://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ScheduledExecutorService.html\n\nSample \n\n import static java.util.concurrent.TimeUnit.*;\n class BeeperControl {\n   private final ScheduledExecutorService scheduler =\n     Executors.newScheduledThreadPool(1);\n\n   public void beepForAnHour() {\n     final Runnable beeper = new Runnable() {\n       public void run() { System.out.println(\"beep\"); }\n     };\n     final ScheduledFuture&lt;?&gt; beeperHandle =\n       scheduler.scheduleAtFixedRate(beeper, 10, 10, SECONDS);\n     scheduler.schedule(new Runnable() {\n       public void run() { beeperHandle.cancel(true); }\n     }, 60 * 60, SECONDS);\n   }\n }\n</code></pre>\n"}], "owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2821, "favorite_count": 1, "accepted_answer_id": 39410326, "answer_count": 2, "score": 3, "last_activity_date": 1473525513, "creation_date": 1473352466, "last_edit_date": 1473495506, "question_id": 39396165, "link": "https://stackoverflow.com/questions/39396165/how-to-run-one-or-group-of-tests-repeatedly-in-go-test-intellij", "title": "how to run one or group of tests repeatedly in Go Test IntelliJ", "body": "<p>From time to time I have this annoying tests with intermittent issues, that I need to run many times to expose. I was looking for a convenient way to set a number or \"endless loop\" from the intelliJ, but I did not find.</p>\n\n<p>Is there a plugin or I missed something that could allow me to do this from the UI (instead of changing code for it).</p>\n\n<p>EDIT: As I found the support for such feature is per test utility plugin. For example, it already exists for JUnit, but there is no such for Go Test. My instinct suggests that such functionality should be generically provided for all test plugins, but there might be some technical reasons for per plugin approach.  </p>\n"}, {"tags": ["arrays", "go", "hashmap"], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 1, "last_activity_date": 1473351737, "creation_date": 1473351737, "answer_id": 39395970, "question_id": 39395279, "link": "https://stackoverflow.com/questions/39395279/improving-performance-of-searching-slice-of-structs-for-value/39395970#39395970", "title": "Improving performance of searching slice of structs for value", "body": "<p>Your code is reasonable, but it's not array of map, it's slice of struct. The efficient way would be</p>\n\n<pre><code>type userMap struct {\n    JiraUsername string\n    CHProjectID  int\n    CHID         string\n}\ntype UsersMap map[string]userMap\n\nfunc main() {\n    userMaps := make(UsersMap)\n    userMaps[\"ted\"] = userMap{\n        JiraUsername: \"ted\",\n        CHProjectID:  81,\n        CHID:         \"23jk3f32jl3323\",\n    }\n\n    fmt.Println(GetUserInfo(userMaps, \"ted\"))\n}\n\nfunc GetUserInfo(userMaps UsersMap, jiraUsername string) (CHProjectID int, CHID string) {\n    if u, ok := userMaps[jiraUsername]; ok {\n        return u.CHProjectID, u.CHID\n    }\n    return 0, \"\"\n}\n</code></pre>\n\n<p>This doesn't require loop and has O(1) complexity.</p>\n"}], "owner": {"reputation": 3144, "user_id": 297824, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d1cf72408e13e38a3bf918413f762e94?s=128&d=identicon&r=PG", "display_name": "T3db0t", "link": "https://stackoverflow.com/users/297824/t3db0t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 39395970, "answer_count": 1, "score": -2, "last_activity_date": 1473354834, "creation_date": 1473349595, "last_edit_date": 1473354834, "question_id": 39395279, "link": "https://stackoverflow.com/questions/39395279/improving-performance-of-searching-slice-of-structs-for-value", "title": "Improving performance of searching slice of structs for value", "body": "<p>How can I optimize the code below for searching an array of maps for a specific key-value (and then return the other key-values)?</p>\n\n<pre><code>type userMap struct {\n    JiraUsername    string\n    CHProjectID int\n    CHID        string\n}\n\nfunc main() {\n    var userMaps []userMap\n\n    userMaps = append(userMaps, userMap{\n        JiraUsername: \"ted\",\n        CHProjectID: 81,\n        CHID: \"23jk3f32jl3323\",\n    })\n\n    fmt.Println(GetUserInfo(userMaps, \"ted\"))\n}\n\nfunc GetUserInfo(userMaps []userMap, jiraUsername string) (CHProjectID int, CHID string) {\n    for _, u := range userMaps {\n        if u.JiraUsername == jiraUsername {\n            return u.CHProjectID, u.CHID\n        }\n    }\n    return 0, \"\"\n}\n</code></pre>\n"}, {"tags": ["go", "division", "modulo"], "answers": [{"comments": [{"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 0, "creation_date": 1473858233, "post_id": 39394067, "comment_id": 66299874, "body": "I meant the math.Mod equivalent for big.Float"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1473346268, "creation_date": 1473346268, "answer_id": 39394067, "question_id": 39392771, "link": "https://stackoverflow.com/questions/39392771/div-and-mod-in-big-float/39394067#39394067", "title": "Div and Mod in big.Float", "body": "<p>Division or quotient operation on integers and big integers produce integer value while on floats it produce float. That's why operations have different precision and mathematical sense.</p>\n\n<pre><code>var x, y int = 5, 3\nz:=x/y    //give you 1\n</code></pre>\n\n<p>but</p>\n\n<pre><code>var x, y float32 = 5, 3\nz:=x/y   //give you 1.6666666\n</code></pre>\n\n<p>Modulo or reminder operations didn't defined on floats because it's hard to elaborate what them can mean. Same with math/big</p>\n"}], "owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 498, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473858212, "creation_date": 1473342656, "last_edit_date": 1473858212, "question_id": 39392771, "link": "https://stackoverflow.com/questions/39392771/div-and-mod-in-big-float", "title": "Div and Mod in big.Float", "body": "<p>big.Int supports both Division and Modulo operations. Why division and modulo operations are not supported in big.Float? Is Quo() is different from division? Is there math.Mod(x, y float64) equivalent for big.Float</p>\n"}, {"tags": ["dictionary", "pointers", "go", "memory-leaks"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 2, "creation_date": 1473343931, "post_id": 39392467, "comment_id": 66112504, "body": "There are no  leaks. We shouldn&#39;t nil the entry."}], "answers": [{"tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 4, "last_activity_date": 1473350109, "last_edit_date": 1473350109, "creation_date": 1473348846, "answer_id": 39395039, "question_id": 39392467, "link": "https://stackoverflow.com/questions/39392467/in-go-deleting-an-entry-of-a-map-of-pointers-causes-memory-leak/39395039#39395039", "title": "In Go, deleting an entry of a map of pointers causes memory leak?", "body": "<p>No, there will not be any memory leaks when deleting from a map.</p>\n\n<p>In case of slices, since a slice actually uses an underlying array, as long as the slice exists - even if it uses just one slot in that array - the pointer items inside the array can not get garbage collected.</p>\n\n<p>\"<a href=\"https://blog.golang.org/slices\" rel=\"nofollow\">A slice describes a piece of an array</a>\" which implies the array needs to be there for the slice to exist and can not get collected by GC; as long as some code is pointing at the slice.</p>\n"}, {"comments": [{"owner": {"reputation": 2483, "user_id": 82668, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bcce136de1e64ddcce596e2a982db3a8?s=128&d=identicon&r=PG", "display_name": "ashgromnies", "link": "https://stackoverflow.com/users/82668/ashgromnies"}, "edited": false, "score": 0, "creation_date": 1614637795, "post_id": 39395345, "comment_id": 117441230, "body": "It&#39;s not clear from the snippet of code you posted what prevents value pointers with references elsewhere from being GC&#39;d, e.g. if you add <code>v := m[1]</code> on the line following the <code>fillMap()</code> call, and then <code>fmt.Println(v)</code> after the map entry has been deleted, the struct prints as expected and isn&#39;t zeroed out. It makes sense why this would be useful but it&#39;s not clear from the <code>mapdelete</code> code snippet why it&#39;s not zeroed out."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2483, "user_id": 82668, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bcce136de1e64ddcce596e2a982db3a8?s=128&d=identicon&r=PG", "display_name": "ashgromnies", "link": "https://stackoverflow.com/users/82668/ashgromnies"}, "edited": false, "score": 0, "creation_date": 1614767327, "post_id": 39395345, "comment_id": 117483357, "body": "@ashgromnies I&#39;m not sure I understand what you want to say. If there is any reference to an object that is reachable, it cannot be gc&#39;d. If the map has the <i>only</i> reference and it is deleted from the map, then it is eligible for gc."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 7, "last_activity_date": 1501067697, "last_edit_date": 1501067697, "creation_date": 1473349754, "answer_id": 39395345, "question_id": 39392467, "link": "https://stackoverflow.com/questions/39392467/in-go-deleting-an-entry-of-a-map-of-pointers-causes-memory-leak/39395345#39395345", "title": "In Go, deleting an entry of a map of pointers causes memory leak?", "body": "<h2>Checking the sources</h2>\n\n<p>Although this is not documented anywhere, checking the sources: <a href=\"https://golang.org/src/runtime/hashmap.go\" rel=\"nofollow noreferrer\"><code>runtime/hashmap.go</code></a>, <code>mapdelete()</code> function:</p>\n\n<pre><code>558 func mapdelete(t *maptype, h *hmap, key unsafe.Pointer) {\n        // ...\n600             memclr(k, uintptr(t.keysize))\n601             v := unsafe.Pointer(uintptr(unsafe.Pointer(b)) + dataOffset + bucketCnt*uintptr(t.keysize) + i*uintptr(t.valuesize))\n602             memclr(v, uintptr(t.valuesize))\n        // ...\n618 }\n</code></pre>\n\n<p>As you can see, storage for both the key (line #600) and the value (line #602) are cleared / zeroed.</p>\n\n<p>This means if any of the key or value was a pointer, or if they were values of complex types containing pointers, they are zeroed and therefore the pointed objects are no longer referenced by the internal data structures of the map, so there is no memory leak here.</p>\n\n<p>When there is no more reference to a complete <code>map</code> value, then the complete memory area of the <code>map</code> will be garbage collected, and all the pointers included in keys and values are also not held anymore by the map; and if no one else has reference to the pointed objects, they will be garbage collected properly.</p>\n\n<h2>Constructing an example to prove this</h2>\n\n<p>We can also construct a test code which proves this without examining the sources:</p>\n\n<pre><code>type point struct {\n    X, Y int\n}\n\nvar m = map[int]*point{}\n\nfunc main() {\n    fillMap()\n    delete(m, 1)\n    runtime.GC()\n    time.Sleep(time.Second)\n    fmt.Println(m)\n}\n\nfunc fillMap() {\n    p := &amp;point{1, 2}\n    runtime.SetFinalizer(p, func(p *point) {\n        fmt.Printf(\"Finalized: %p %+v\\n\", p, p)\n    })\n    m[1] = p\n    fmt.Printf(\"Put in map: %p %+v\\n\", p, p)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/X-eRlTjU35\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Put in map: 0x1040a128 &amp;{X:1 Y:2}\nFinalized: 0x1040a128 &amp;{X:1 Y:2}\nmap[]\n</code></pre>\n\n<p>What does this do? It creates a <code>*Point</code> value (pointer to a struct), puts it in the map, and registers a function that <em>should</em> be called when this pointer becomes unreachable (using <a href=\"https://golang.org/pkg/runtime/#SetFinalizer\" rel=\"nofollow noreferrer\"><code>runtime.SetFinalizer()</code></a>), and then deletes the entry containing this pointer. Then we call <a href=\"https://golang.org/pkg/runtime/#GC\" rel=\"nofollow noreferrer\"><code>runtime.GC()</code></a> to \"force\" an immediate garbage collection. I also print the map at the end just to make sure the whole map is not garbage collected due to some optimization.</p>\n\n<p>The result? We see the registered function gets called, which proves the pointer was removed from the map as the result of the <code>delete()</code> call, because (since we had no other references to it) it was eligible for garbage collection.</p>\n"}], "owner": {"reputation": 47, "user_id": 2118750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/687bbbed0b3e496ee3fce206634a7224?s=128&d=identicon&r=PG", "display_name": "calado", "link": "https://stackoverflow.com/users/2118750/calado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2731, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1560510644, "creation_date": 1473341775, "last_edit_date": 1560510644, "question_id": 39392467, "link": "https://stackoverflow.com/questions/39392467/in-go-deleting-an-entry-of-a-map-of-pointers-causes-memory-leak", "title": "In Go, deleting an entry of a map of pointers causes memory leak?", "body": "<p>first timer here,</p>\n\n<p>The first <strong>NOTE</strong> in <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow\">SliceTricks</a> suggests that there is a potential memory leak problem when cutting or deleting elements in a slice of pointers.</p>\n\n<p>Is the same true for a map? For example: <a href=\"https://play.golang.org/p/67cN0JggWY\" rel=\"nofollow\">https://play.golang.org/p/67cN0JggWY</a></p>\n\n<p>Should we nil the entry before deleting from map? Like so:</p>\n\n<pre><code>m[\"foo\"] = nil\n</code></pre>\n\n<p>What if we simply <em>clear</em> the map?</p>\n\n<pre><code>m = make(map[string]*myStruct)\n</code></pre>\n\n<p>Will the garbage collector still pick it up?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["arrays", "go", "types", "maps"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 1, "creation_date": 1473340202, "post_id": 39391437, "comment_id": 66109767, "body": "well, you could iterate: <code>for k, v := range(map1) { map2[k] = v}</code> but you need to decide what happens when there is a key collision. you can check that with <code>v, ok := map2[k]; if !ok {...}</code>"}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1473340325, "post_id": 39391437, "comment_id": 66109868, "body": "sorry I missed the slice. You can do <code>newslice := append(slice1, slice2...)</code> see <a href=\"https://blog.golang.org/slices#TOC_10\" rel=\"nofollow noreferrer\">blog.golang.org/slices#TOC_10</a>."}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 1, "creation_date": 1473340455, "post_id": 39391437, "comment_id": 66109958, "body": "Sure you can append just result := append(result1, result2...) if results are of the same type []map[string]interface{}"}, {"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1473340805, "post_id": 39391437, "comment_id": 66110198, "body": "You&#39;re right. I just gave it a try with what @Uvelichitel said and had to do it twice (because I had 3 arrays) and it worked like a charm! Should I put it up as an answer?"}, {"owner": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "edited": false, "score": 0, "creation_date": 1489147541, "post_id": 39391437, "comment_id": 72555857, "body": "Actually the question should be re-written to match go&#39;s syntax and ability. For the question and for go it is insignificant that there is a map contained in the slice. You can do the same with any slice type, for example <code>[]byte</code>. That&#39;s what go&#39;s internal function <code>append</code> is for and that&#39;s how it is documented (append and copy for slices)."}], "answers": [{"comments": [{"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1473402341, "post_id": 39392689, "comment_id": 66135474, "body": "Kudos! In my case, I had map1, map2 and map3 all of []map[string]interface{} types and I did -  result := map1 result = append(result, map2...) result = append(result, map3...)  And that&#39;s exactly what I needed!"}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": true, "score": 15, "last_activity_date": 1523079513, "last_edit_date": 1523079513, "creation_date": 1473342458, "answer_id": 39392689, "question_id": 39391437, "link": "https://stackoverflow.com/questions/39391437/merge-two-or-more-mapstringinterface-types-into-one-in-golang/39392689#39392689", "title": "Merge two or more []map[string]interface{} types into one in Golang", "body": "<p>Even the answer is already given in the comments above i will post a short example how this can be achieved.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    result := []map[string]interface{}{}\n\n    mp1 := map[string]interface{}{\n        \"one\" : 1, \n        \"two\" : 2,\n    }\n\n    mp2 := map[string]interface{}{\n        \"three\" : 3,\n        \"four\" : 4,\n    }\n\n    mp3 := make(map[string]interface{})\n    for k, v := range mp1 {\n        if _, ok := mp1[k]; ok {\n            mp3[k] = v          \n        }\n    }\n\n    for k, v := range mp2 {\n        if _, ok := mp2[k]; ok {\n            mp3[k] = v\n        }\n    }\n\n    result = append(result, mp1, mp2)\n    fmt.Println(result)\n}\n</code></pre>\n\n<p>The output will be:</p>\n\n<pre><code>[map[one:1 two:2] map[three:3 four:4]]\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/CtLqM8c1lu\" rel=\"noreferrer\">Playground example</a></p>\n"}, {"comments": [{"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 3, "creation_date": 1473407127, "post_id": 39406305, "comment_id": 66137783, "body": "Makes sense and its useful in the long run! Thank you!"}, {"owner": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "edited": false, "score": 0, "creation_date": 1489147814, "post_id": 39406305, "comment_id": 72556017, "body": "Note that this is a completely different type of operation! <code>append</code> operates on slices. If you merge two maps you can define two different merge operations (<code>A := A MERGE B</code>) where B[k] overwrites A[k] and another one where A[k] preserves its values over B[k]."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 1, "creation_date": 1489254629, "post_id": 39406305, "comment_id": 72595071, "body": "True, that&#39;s why this answer begins with &quot;The other answer is correct&quot;. Though other than handling json (or some external data stream), it&#39;s some common mistake to have a &quot;slice of maps&quot;, and <code>mp3</code> is not actually used anywhere inside first answer."}, {"owner": {"reputation": 526, "user_id": 1035977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310abc9d873d41cede1258891d6bcaf3?s=128&d=identicon&r=PG", "display_name": "Gwyneth Llewelyn", "link": "https://stackoverflow.com/users/1035977/gwyneth-llewelyn"}, "edited": false, "score": 0, "creation_date": 1597240694, "post_id": 39406305, "comment_id": 112068898, "body": "Personally, I prefer your solution, because in my use case, I actually wish subsequent maps (used to store all sorts of configuration variables, coming from several sources) to override &#39;default&#39; configurations stored on the first map. This works flawlessly for that kind of usage! Thanks \ud83d\ude4f"}], "tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 11, "last_activity_date": 1489254374, "last_edit_date": 1489254374, "creation_date": 1473406795, "answer_id": 39406305, "question_id": 39391437, "link": "https://stackoverflow.com/questions/39391437/merge-two-or-more-mapstringinterface-types-into-one-in-golang/39406305#39406305", "title": "Merge two or more []map[string]interface{} types into one in Golang", "body": "<p>The other answer is correct. You could also write a helper function to avoid repetitive map merges.</p>\n\n<pre><code>// overwriting duplicate keys, you should handle that if there is a need\nfunc mergeMaps(maps ...map[string]interface{}) map[string]interface{} {\n    result := make(map[string]interface{})\n    for _, m := range maps {\n        for k, v := range m {\n            result[k] = v\n        }\n    }\n    return result\n}\n\nfunc main() {\n    log.Println(`started`)\n\n    v := []map[string]interface{}{\n        map[string]interface{}{\n            `one`: 1,\n            `two`: 2,\n        },\n        map[string]interface{}{\n            `one`:   `I`,\n            `three`: 3,\n            `other`: `NAN`,\n        },\n        map[string]interface{}{\n            `name`: `Bob`,\n            `age`:  300,\n        },\n    }\n\n    m := mergeMaps(v...)\n    log.Println(m, len(m))\n}\n</code></pre>\n"}], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18592, "favorite_count": 1, "accepted_answer_id": 39392689, "answer_count": 2, "score": 11, "last_activity_date": 1618922005, "creation_date": 1473339019, "question_id": 39391437, "link": "https://stackoverflow.com/questions/39391437/merge-two-or-more-mapstringinterface-types-into-one-in-golang", "title": "Merge two or more []map[string]interface{} types into one in Golang", "body": "<p>I'm using Golang and for some reason, I need to merge results from different database queries, all of which return me a <code>[]map[string]interface{}</code>\nI'm thinking of Append but its just not clear enough if this is even possible.\nWhat is the final datatype I'm looking at?</p>\n\n<p>Clearly, an array of maps of interfaces with keys as strings should be able to simply 'attach' (concat, if you may) to another array of maps of interfaces with keys as strings!</p>\n\n<p>So what is the mechanism to achieve this?</p>\n"}, {"tags": ["go", "cmd", "tail", "kill-process"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 4523797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a99ac89556bea283e7bf2068b7a95dd2?s=128&d=identicon&r=PG&f=1", "display_name": "faza", "link": "https://stackoverflow.com/users/4523797/faza"}, "is_accepted": true, "score": 1, "last_activity_date": 1473338705, "last_edit_date": 1492086990, "creation_date": 1473338705, "answer_id": 39391333, "question_id": 39390087, "link": "https://stackoverflow.com/questions/39390087/go-execute-ssh-command-and-cant-kill-the-command-on-the-remote-server/39391333#39391333", "title": "go execute ssh command and can&#39;t kill the command on the remote server", "body": "<p>Just add one more \"-t\" in the arguments.</p>\n\n<pre><code>var  cmd = exec.Command(\"ssh\",\"-t\", \"-t\", \"-p\", \"9122\",\"deploy@123.com\" ,\"tail -f /log.out\")\n</code></pre>\n\n<p>For more information, refer this <a href=\"https://unix.stackexchange.com/questions/103699/kill-process-spawned-by-ssh-when-ssh-dies/210356#210356\">link</a></p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1473359330, "creation_date": 1473359330, "answer_id": 39397879, "question_id": 39390087, "link": "https://stackoverflow.com/questions/39390087/go-execute-ssh-command-and-cant-kill-the-command-on-the-remote-server/39397879#39397879", "title": "go execute ssh command and can&#39;t kill the command on the remote server", "body": "<p>You can try to send Control-C</p>\n\n<pre><code>w, err := cmd.StdinPipe()\nctlC, err := hex.DecodeString(`\\x03`) //CtlC on most machines\nw.Write(ctlC)\n</code></pre>\n\n<p>before killing ssh</p>\n\n<pre><code>err = cmd.Process.Kill()\n</code></pre>\n\n<p>this works in my setup</p>\n"}], "owner": {"reputation": 23, "user_id": 3148217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8SjKk.jpg?s=128&g=1", "display_name": "StyleTang", "link": "https://stackoverflow.com/users/3148217/styletang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 1, "accepted_answer_id": 39391333, "answer_count": 2, "score": 1, "last_activity_date": 1548179608, "creation_date": 1473335174, "last_edit_date": 1548179608, "question_id": 39390087, "link": "https://stackoverflow.com/questions/39390087/go-execute-ssh-command-and-cant-kill-the-command-on-the-remote-server", "title": "go execute ssh command and can&#39;t kill the command on the remote server", "body": "<p>I use go exec ssh to execute \"tail -f\" on the remote server. Then I kill the process, but the \"tail -f \" still runs on the remote server.</p>\n\n<p>What can I do to kill the \"tail -f\" process on the remote server?</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>package main\n\nimport (\n    \"os/exec\"\n    \"github.com/astaxie/beego\"\n    \"time\"\n)\n\nfunc main() {\n    var  cmd = exec.Command(\"ssh\",\"-t\", \"-p\", \"9122\",\"deploy@123.com\" ,\"tail -f /log.out\")\n    var err error\n    cmd.Start()\n    time.Sleep(time.Second*5)\n    err = cmd.Process.Kill() // when I kill this process, the remote server  deploy@123.com still has 'tail -f /log.out' running\n    beego.Error(err)\n}\n</code></pre>\n"}, {"tags": ["go", "proxy", "websocket", "slack"], "comments": [{"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1473332967, "post_id": 39388763, "comment_id": 66104873, "body": "Can you connect to ws with http? The url in that example uses http"}, {"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1473333795, "post_id": 39388763, "comment_id": 66105351, "body": "Turns out you <a href=\"http://stackoverflow.com/questions/9745249/html5-websocket-with-ssl\">can</a>. Are you reading the response from the http call ? Looks like <a href=\"https://api.slack.com/methods/rtm.start\" rel=\"nofollow noreferrer\">that</a> provides you with the wss url to connect to"}, {"owner": {"reputation": 3550, "user_id": 2762587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/udFJH.png?s=128&g=1", "display_name": "tonka", "link": "https://stackoverflow.com/users/2762587/tonka"}, "reply_to_user": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1473333889, "post_id": 39388763, "comment_id": 66105416, "body": "Where is the http call?"}, {"owner": {"reputation": 3550, "user_id": 2762587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/udFJH.png?s=128&g=1", "display_name": "tonka", "link": "https://stackoverflow.com/users/2762587/tonka"}, "reply_to_user": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1473334123, "post_id": 39388763, "comment_id": 66105547, "body": "the blog example already give me a wss address!"}, {"owner": {"reputation": 1414, "user_id": 822779, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/aJm0V.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/822779/sam"}, "edited": false, "score": 0, "creation_date": 1473397237, "post_id": 39388763, "comment_id": 66133651, "body": "Can you post your exact code? I cannot connect to that IP address."}, {"owner": {"reputation": 3550, "user_id": 2762587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/udFJH.png?s=128&g=1", "display_name": "tonka", "link": "https://stackoverflow.com/users/2762587/tonka"}, "edited": false, "score": 0, "creation_date": 1473402358, "post_id": 39388763, "comment_id": 66135479, "body": "The link in my post contains the code, i have exactly this code. It seems that our proxy is the problem, without it it works well."}], "answers": [{"comments": [{"owner": {"reputation": 3550, "user_id": 2762587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/udFJH.png?s=128&g=1", "display_name": "tonka", "link": "https://stackoverflow.com/users/2762587/tonka"}, "edited": false, "score": 0, "creation_date": 1473534021, "post_id": 39408937, "comment_id": 66182535, "body": "Thx, i will try gorilla&#39;s websocket lib"}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 1, "last_activity_date": 1473415331, "creation_date": 1473415331, "answer_id": 39408937, "question_id": 39388763, "link": "https://stackoverflow.com/questions/39388763/why-is-this-websocket-connection-being-refused/39408937#39408937", "title": "Why is this websocket connection being refused?", "body": "<p>If you are using <a href=\"https://github.com/gorilla/websocket/\" rel=\"nofollow\">gorilla/websocket</a>, it has the ability to use a Proxy. From <a href=\"https://github.com/gorilla/websocket/issues/107\" rel=\"nofollow\">issue 107</a>:</p>\n\n<pre><code>import \"net/http\"\n\n...\n\nvar dialer = websocket.Dialer{\n    Proxy: http.ProxyFromEnvironment,\n}\n</code></pre>\n\n<p>If you are using <a href=\"http://golang.org/x/net\" rel=\"nofollow\">golang.org/x/net</a> you should switch to gorilla/websocket.</p>\n"}], "owner": {"reputation": 3550, "user_id": 2762587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/udFJH.png?s=128&g=1", "display_name": "tonka", "link": "https://stackoverflow.com/users/2762587/tonka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1583, "favorite_count": 1, "accepted_answer_id": 39408937, "answer_count": 1, "score": 2, "last_activity_date": 1473415331, "creation_date": 1473331135, "last_edit_date": 1473338819, "question_id": 39388763, "link": "https://stackoverflow.com/questions/39388763/why-is-this-websocket-connection-being-refused", "title": "Why is this websocket connection being refused?", "body": "<p>I try to use the slack-sample bot from this blogpost <a href=\"https://www.opsdash.com/blog/slack-bot-in-golang.html\" rel=\"nofollow\">https://www.opsdash.com/blog/slack-bot-in-golang.html</a> . I've successfully created my api token, but i can not connect to the websocket server (the rtm.start request passs normally). I've get the error message</p>\n\n<blockquote>\n<pre><code>dial tcp 54.242.95.213:443: connectex: No connection could be made because the target machine actively refused it\n</code></pre>\n</blockquote>\n\n<p>I've also tried to connect via a chrome app called <strong>Simple Web Socket Client</strong> and via a website based one tester. Both work well, i can establish a connection and i can send data.</p>\n\n<p>I'm behind a proxy, but i only have troubles with golang's websocket.Dial function.</p>\n\n<p>Does anybody know why this can happen?</p>\n\n<p>I use:<br>\n- Windows 7 SP1 x64<br>\n- Golang 1.7.1 windows/amd64  </p>\n\n<p>Greetings\nTonka</p>\n"}, {"tags": ["mysql", "stored-procedures", "go"], "comments": [{"owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "edited": false, "score": 0, "creation_date": 1473362070, "post_id": 39388467, "comment_id": 66123119, "body": "Did you take a look at mymysl? <a href=\"http://stackoverflow.com/questions/28548559/does-a-go-mysql-driver-exist-that-supports-multiple-statements-within-a-single-s\" title=\"does a go mysql driver exist that supports multiple statements within a single s\">stackoverflow.com/questions/28548559/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3045, "user_id": 1333999, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/163b47af024db6763d5ad0c885db117c?s=128&d=identicon&r=PG", "display_name": "grepsedawk", "link": "https://stackoverflow.com/users/1333999/grepsedawk"}, "is_accepted": true, "score": 1, "last_activity_date": 1473375009, "creation_date": 1473375009, "answer_id": 39401295, "question_id": 39388467, "link": "https://stackoverflow.com/questions/39388467/create-stored-procedure-from-migration/39401295#39401295", "title": "Create stored procedure from migration", "body": "<p>I ran into the same situation, actually. The way I ran it is I removed all delimiter declarations and ran it. Since you don't need a delimiter within the migration, it will auto terminate (or realistically denominate) and the migration should run. </p>\n"}], "owner": {"reputation": 1778, "user_id": 2303988, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VcVRc.jpg?s=128&g=1", "display_name": "Alessio", "link": "https://stackoverflow.com/users/2303988/alessio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 39401295, "answer_count": 1, "score": 0, "last_activity_date": 1473375009, "creation_date": 1473330241, "question_id": 39388467, "link": "https://stackoverflow.com/questions/39388467/create-stored-procedure-from-migration", "title": "Create stored procedure from migration", "body": "<p>I've a project in GO that check if there are new migrations to apply when the app starts (I'm using library <a href=\"https://github.com/mattes/migrate\" rel=\"nofollow\">https://github.com/mattes/migrate</a>).</p>\n\n<p>Now the problem is that I have a stored procedure to create in one of this migration (because this will be called later, and I need to create it in a migration otherwise the test suite will fail of course).</p>\n\n<p>An example can be this one:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>DELIMITER @@\n    CREATE PROCEDURE get_value(my_id BIGINT(20), OUT out_value DOUBLE)\n       BEGIN\n         SELECT CASE\n            WHEN o.financial_status = \"test\" THEN 0\n            ELSE 1\n            END\n            INTO out_value\n          FROM `order` o\n          LEFT JOIN `my_table_2` io ON io.field_2 = o.id\n          LEFT JOIN `my_table_3` ip ON io.field_3 = ip.id\n          WHERE o.id = my_id;\nEND @@\nDELIMITER ;\n</code></pre>\n\n<p>As far as I read, this might not be possible because sql driver for go does not support multi statement (we're using mysql 5.6).</p>\n\n<p>There are any other way to do that? Thanks! </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1473323791, "post_id": 39385883, "comment_id": 66099238, "body": "<a href=\"https://godoc.org/time#NewTicker\" rel=\"nofollow noreferrer\">time.NewTicker()</a> perhaps? i dont really get your objective. as written, as N increases, the sleep time DECREASES"}, {"owner": {"reputation": 2446, "user_id": 5682933, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29d72b97ce20902d21488878741621f3?s=128&d=identicon&r=PG&f=1", "display_name": "Haoyuan Ge", "link": "https://stackoverflow.com/users/5682933/haoyuan-ge"}, "reply_to_user": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1473327448, "post_id": 39385883, "comment_id": 66101440, "body": "@Plato ticker works if a ticker counts time in parallel to fmt.Println and getLogs,"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 5, "last_activity_date": 1473329370, "last_edit_date": 1495541341, "creation_date": 1473324014, "answer_id": 39386316, "question_id": 39385883, "link": "https://stackoverflow.com/questions/39385883/how-do-i-execute-commands-many-many-times-per-second-in-golang/39386316#39386316", "title": "How do I execute commands many many times per second in Golang?", "body": "<p>You may use <code>time.NewTicker</code> (try <a href=\"https://play.golang.org/p/k69YHb5Nkn\" rel=\"nofollow noreferrer\">The Go Playground</a>):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    const N = 4\n    ticker := time.NewTicker(1000000000 / N * time.Nanosecond)\n    for i := 0; i &lt; N; i++ {\n        fmt.Println(getLogs(i))\n        &lt;-ticker.C\n    }\n    ticker.Stop()\n}\n\nfunc getLogs(i int) int {\n    time.Sleep(1 * time.Millisecond)\n    return i\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>0\n1\n2\n3\n</code></pre>\n\n<hr>\n\n<p>See <code>func NewTicker(d Duration) *Ticker</code> Docs:</p>\n\n<blockquote>\n  <p><code>NewTicker</code> returns a new <code>Ticker</code> containing a channel that will send the\n  time with a period specified by the duration argument. It adjusts the\n  intervals or drops ticks to make up for slow receivers. The duration d\n  must be greater than zero; if not, <code>NewTicker</code> will panic. Stop the\n  ticker to release associated resources.</p>\n</blockquote>\n\n<hr>\n\n<p>Also see: <a href=\"https://stackoverflow.com/questions/38386762/running-code-at-noon-golang\">Running code at noon in Golang</a></p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1473336621, "last_edit_date": 1473336621, "creation_date": 1473324106, "answer_id": 39386348, "question_id": 39385883, "link": "https://stackoverflow.com/questions/39385883/how-do-i-execute-commands-many-many-times-per-second-in-golang/39386348#39386348", "title": "How do I execute commands many many times per second in Golang?", "body": "<p>You can use <code>time.Ticker</code> something like</p>\n\n<pre><code>for range time.Tick(time.Duration(1000000000/N) * time.Nanosecond){\n    fmt.Println(getLogs())\n    if cond {\n        break\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2446, "user_id": 5682933, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29d72b97ce20902d21488878741621f3?s=128&d=identicon&r=PG&f=1", "display_name": "Haoyuan Ge", "link": "https://stackoverflow.com/users/5682933/haoyuan-ge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 39386316, "answer_count": 2, "score": 1, "last_activity_date": 1473668128, "creation_date": 1473322628, "last_edit_date": 1473668128, "question_id": 39385883, "link": "https://stackoverflow.com/questions/39385883/how-do-i-execute-commands-many-many-times-per-second-in-golang", "title": "How do I execute commands many many times per second in Golang?", "body": "<p>I want to print <code>N</code> lines per second. </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>for i := 0; i &lt; N; i++ {\n  fmt.Println(getLogs())\n  time.Sleep(1000000000/N * time.Nanosecond)\n}\n</code></pre>\n\n<p>But it seems <code>fmt.Println()</code> and <code>getLogs()</code> will also consume time. So actually it will cost me more than 1s to print <code>N</code> lines. </p>\n\n<p>Say <code>getLogs()</code> and <code>fmt.Println()</code> will both cost 1 ms. And I want to print 1 million lines per second. Therefore, to print 1 line will cost 1 ms to <code>getLogs()</code>, 1 ms to print, and 1 ms to sleep... It will cost me 3s to print N lines. </p>\n\n<p>Any better solutions to achieve this more accurately?</p>\n"}, {"tags": ["mongodb", "go", "time", "mgo", "gorilla"], "comments": [{"owner": {"reputation": 685, "user_id": 7047363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a4cda8321abd1a553445a95258babb?s=128&d=identicon&r=PG&f=1", "display_name": "muthukumar selvaraj", "link": "https://stackoverflow.com/users/7047363/muthukumar-selvaraj"}, "edited": false, "score": 0, "creation_date": 1524135565, "post_id": 39385265, "comment_id": 86854063, "body": "i also having this same issue ..."}], "answers": [{"comments": [{"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1473325899, "post_id": 39386789, "comment_id": 66100460, "body": "Hi! Its not about not getting the date correctly. In the mongo console query, I have just copy pasted the value returned by currentDate as seen from my program console. When using this one, the time value returned is 1473326105000 and the response is still null."}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "reply_to_user": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1473328262, "post_id": 39386789, "comment_id": 66101920, "body": "Does { &quot;start_date&quot;: { $lt: 1473326105000 }, $and: [ { &quot;end_date&quot;: { $gt: 1473326105000 } } ] } works in console? Maybe mongo documentation is incorrect about milliseconds. How about currentDate := time.Now().Unix() or in console { &quot;start_date&quot;: { $lt: 1473326105 }, $and: [ { &quot;end_date&quot;: { $gt: 1473326105 } } ] }"}, {"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1473329235, "post_id": 39386789, "comment_id": 66102489, "body": "Both of these return null on the mongo console as well :("}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "reply_to_user": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1473333753, "post_id": 39386789, "comment_id": 66105320, "body": "@GauravOjha After deeper investigation completely rewrite answer. Sorry for inconvenience."}, {"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1473338581, "post_id": 39386789, "comment_id": 66108547, "body": "Thank you! I had figured it out that just Time.Now() works! Isn&#39;t it kind of amazing yet frustrating?!"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 2, "last_activity_date": 1473333605, "last_edit_date": 1473333605, "creation_date": 1473325419, "answer_id": 39386789, "question_id": 39385265, "link": "https://stackoverflow.com/questions/39385265/golang-mgo-querying-mongodb-fails-when-using-time-because-of-missing-isodate/39386789#39386789", "title": "Golang + mgo querying mongodb fails when using time because of missing &#39;ISODate&#39;", "body": "<p>mgo driver seems smart enough to correctly convert time.Time to mongo Date so just</p>\n\n<pre><code>currentDate := time.Now()\n</code></pre>\n\n<p>should work. Also  gopkg.in/mgo.v2/bson has helper to get time with millisecond precision which mongo use </p>\n\n<pre><code>func Now() time.Time\n</code></pre>\n\n<p>so</p>\n\n<pre><code>currentDate := bson.Now()\n</code></pre>\n\n<p>this helper function has simple source</p>\n\n<pre><code>return time.Unix(0, time.Now().UnixNano()/1e6*1e6)\n</code></pre>\n\n<p>this way any Go timestamp time.Time can be obtained in millisecond</p>\n\n<pre><code>someDate := time.Unix(0, time.someTime.UnixNano()/1e6*1e6)\n</code></pre>\n"}], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 937, "favorite_count": 1, "accepted_answer_id": 39386789, "answer_count": 1, "score": 1, "last_activity_date": 1473333605, "creation_date": 1473320665, "last_edit_date": 1473322144, "question_id": 39385265, "link": "https://stackoverflow.com/questions/39385265/golang-mgo-querying-mongodb-fails-when-using-time-because-of-missing-isodate", "title": "Golang + mgo querying mongodb fails when using time because of missing &#39;ISODate&#39;", "body": "<p>I have the following code to retrieve some data from my mongodb -</p>\n\n<pre><code>currentDate := time.Now().Format(time.RFC3339)\ncontent := database.FindDocuments(\"content\", bson.M{ \"$and\": []bson.M{ bson.M{\"start_date\": bson.M{\"$lte\": currentDate}}, bson.M{\"end_date\": bson.M{ \"$gte\": currentDate}}, }})\n</code></pre>\n\n<p>FindDocuments is basically <code>MgoSession.DB(Dbname).C(collectionName).Find(query).All(&amp;result)</code> giving me a <code>[]map[string]interface{}</code>.</p>\n\n<p>This gives me null, whereas in the mongo console (using the same value as returned by the currentDate variable) -</p>\n\n<pre><code>{ \"start_date\": { $lt: ISODate(\"2016-09-08T13:05:24+05:30\") }, $and: [ { \"end_date\": { $gt: ISODate(\"2016-09-08T13:05:24+05:30\") } } ] }\n</code></pre>\n\n<p>returns me -</p>\n\n<pre><code>{ \n    \"_id\" : ObjectId(\"57cff2bc32291a1fa0e79e90\"), \n    \"image_url\" : \"www.example.com\", \n    \"title\" : \"This is a new content\", \n    \"start_date\" : ISODate(\"2016-09-06T10:58:54.701+0000\"), \n    \"end_date\" : ISODate(\"2016-09-10T10:59:04.447+0000\"), \n    \"type\" : \"content\"\n}\n</code></pre>\n\n<p>Why is this issue coming up despite using the correct time format?</p>\n"}, {"tags": ["go", "blockchain", "hyperledger"], "comments": [{"owner": {"reputation": 2061, "user_id": 539877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2078f8c58536286626ce779e7bfdb10c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Balashevich", "link": "https://stackoverflow.com/users/539877/sergey-balashevich"}, "edited": false, "score": 0, "creation_date": 1473328615, "post_id": 39383805, "comment_id": 66102118, "body": "Can you add the source code for &quot;read&quot; method either?"}, {"owner": {"reputation": 11, "user_id": 6807626, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RI11N.jpg?s=128&g=1", "display_name": "Lee. Jr", "link": "https://stackoverflow.com/users/6807626/lee-jr"}, "reply_to_user": {"reputation": 2061, "user_id": 539877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2078f8c58536286626ce779e7bfdb10c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Balashevich", "link": "https://stackoverflow.com/users/539877/sergey-balashevich"}, "edited": false, "score": 0, "creation_date": 1473387446, "post_id": 39383805, "comment_id": 66131422, "body": "Hi Sergey, Updated the read function. Thanks."}], "owner": {"reputation": 11, "user_id": 6807626, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RI11N.jpg?s=128&g=1", "display_name": "Lee. Jr", "link": "https://stackoverflow.com/users/6807626/lee-jr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 400, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1479841893, "creation_date": 1473315634, "last_edit_date": 1473387563, "question_id": 39383805, "link": "https://stackoverflow.com/questions/39383805/why-i-cannot-get-my-donationids-value-from-stubs-getstate-function", "title": "Why I cannot get my donationId&#39;s value from stub&#39;s GetState function", "body": "<p>Currently, I am learning hyperledger/fabric and trying to write the chaincode. Below is the invoke function and customized function I created. </p>\n\n<pre><code>type Donation struct {\n    Id string `json:\"id\"`\n    Who string `json:\"who\"`\n    Rid string  `json:\"rid\"`\n    Money int   `json:\"money\"`\n}\n\ntype Request struct {\n    Id string `json:\"id\"`\n    Name string  `json:\"name\"`\n    Description string `json:\"description\"`\n    ExpectedMoney int `json:\"expectedMoney\"`\n    CurrentMoney int  `json:\"currentMoney\"`\n    DonationList []string `json:\"donationList\"`\n}\n\n\ntype Person struct {\n    Id string `json:\"id\"`\n    Name string `json:\"name\"`\n    MyRequests []string `json:\"myRequests\"`\n    MyDonations []string `json:\"myDonations\"`\n}\nfunc (t *SimpleChaincode) Invoke(stub *shim.ChaincodeStub, function string, args []string) ([]byte, error) {\n\n     if function == \"createDonation\" {\n        return t.createDonation(stub, args)\n     }\n     return nil, errors.New(\"Received unknown function invocation\")\n}\nfunc (t *SimpleChaincode) createDonation(stub *shim.ChaincodeStub, args []string) ([]byte, error) {\n     var from, toRid string\n     var money int\n     var err error\n\n     if len(args) != 3 {\n         return nil, errors.New(\"My createDonation. Incorrect number of arguments. Expecting 3\")\n     }\n     from = args[0]\n     toRid = args[1]\n     money, err = strconv.Atoi(args[2])\n     if err != nil {\n        return nil, errors.New(\"money cannot convert to number\")\n     }\n\n     var donation Donation\n     donation = Donation{Id: \"donationid\", Rid: toRid, Who: from, Money: money}\n     djson, err := json.Marshal(&amp;donation)\n     if err != nil {\n        return nil, err\n     }\n     var a = donation.Id\n     stub.PutState(a, djson)\n\n     personByte, err := stub.GetState(from + \"\")\n     fmt.Println(personByte)\n     return nil, nil\n\n}\n\n\n\nfunc (t *SimpleChaincode) read(stub *shim.ChaincodeStub, args []string) ([]byte, error) {\n    log.Println(\"Get into read function\")\n\n    var key, jsonResp string\n    var err error\n\n    key = args[0]\n    valAsbytes, err := stub.GetState(key)\n    if err != nil {\n        jsonResp = \"{\\\"Error\\\":\\\"Failed to get state for \" + key + \"\\\"}\"\n        return nil, errors.New(jsonResp)\n    }\n    if valAsbytes == nil {\n        return []byte(\"cannot find the key's value of the chaincode\"), nil\n    }\n\n    return valAsbytes, nil\n}\n</code></pre>\n\n<p>However, When I tried to use swagger UI to invoke and retrieve the \"donationid\"'s value, it is empty. Is there anything wrong about my code? Thanks in advance.\n<strong>Invoke</strong></p>\n\n<pre><code>{\n    \"jsonrpc\": \"2.0\",\n    \"method\": \"invoke\",\n    \"params\": {\n        \"type\": 1,\n        \"chaincodeID\": {\n            \"name\": \"92d975f9301f9b72c7b148e65dcc835a971be55b2555a45c41d6d2eed04ecfd6b1974245cfb77d002e244e9e581e4042747e9f4d6a46b59e9d7e8a7419476296\"\n        },\n        \"ctorMsg\": {\n            \"function\": \"createDonation\",\n            \"args\": [\n                \"Simon\",\n                \"requestid\",\n                \"300\"\n            ]\n        },\n        \"secureContext\": \"user_type1_XXXXXXX\"\n    },\n    \"id\": 3\n}\n</code></pre>\n\n<p>query</p>\n\n<pre><code>{\n    \"jsonrpc\": \"2.0\",\n    \"method\": \"query\",\n    \"params\": {\n        \"type\": 1,\n        \"chaincodeID\": {\n            \"name\": \"92d975f9301f9b72c7b148e65dcc835a971be55b2555a45c41d6d2eed04ecfd6b1974245cfb77d002e244e9e581e4042747e9f4d6a46b59e9d7e8a7419476296\"\n        },\n        \"ctorMsg\": {\n            \"function\": \"read\",\n            \"args\": [\n                \"donationid\"\n            ]\n        },\n        \"secureContext\": \"user_type1_xxxxxx\"\n    },\n    \"id\": 2\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 0, "last_activity_date": 1473318440, "last_edit_date": 1473318440, "creation_date": 1473312805, "answer_id": 39383237, "question_id": 39383135, "link": "https://stackoverflow.com/questions/39383135/a-tour-of-go-example-on-goroutines-concurrency/39383237#39383237", "title": "A Tour of Go example on Goroutines concurrency", "body": "<p><code>w.Done()</code> decrements the <code>WaitGroup</code> counter.<br>\nSo your code even sometimes panic: sync: negative <code>WaitGroup</code> counter.  </p>\n\n<p>You have two Goroutines:<br>\n1 - <code>go say(\"world\")</code><br>\n2 - <code>say(\"hello\")</code> inside <code>main</code> Goroutine<br>\nso use <code>w.Add(2)</code>, see this working sample (<a href=\"https://play.golang.org/p/l3UcGrpEOR\" rel=\"nofollow\">The Go Playground</a>):  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nvar w sync.WaitGroup\n\nfunc say(s string) {\n    for i := 0; i &lt; 2; i++ {\n        time.Sleep(100 * time.Millisecond)\n        fmt.Println(s)\n    }\n    w.Done()\n}\n\nfunc main() {\n    w.Add(2)\n    go say(\"world\")\n    say(\"hello\")\n    w.Wait()\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>world\nhello\nhello\nworld\n</code></pre>\n\n<p>I hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 0, "last_activity_date": 1473312996, "creation_date": 1473312996, "answer_id": 39383265, "question_id": 39383135, "link": "https://stackoverflow.com/questions/39383135/a-tour-of-go-example-on-goroutines-concurrency/39383265#39383265", "title": "A Tour of Go example on Goroutines concurrency", "body": "<p>You're only adding 1 to the WaitGroup, but calling Done from 2 invocations of <code>say</code>.</p>\n\n<p>In your example, starting the WaitGroup with 2 would work</p>\n\n<pre><code>w.Add(2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 801, "user_id": 5056691, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Z3xo21C2gaU/AAAAAAAAAAI/AAAAAAAAAI0/0KSAJRkAaYA/photo.jpg?sz=128", "display_name": "Anupam", "link": "https://stackoverflow.com/users/5056691/anupam"}, "is_accepted": false, "score": 0, "last_activity_date": 1473315201, "creation_date": 1473315201, "answer_id": 39383692, "question_id": 39383135, "link": "https://stackoverflow.com/questions/39383135/a-tour-of-go-example-on-goroutines-concurrency/39383692#39383692", "title": "A Tour of Go example on Goroutines concurrency", "body": "<p>Problem occurs due to unconditional call to w.Done(). So when u called say(\"hello\") this also decremented counter for waitGroup.</p>\n\n<p>Refer <a href=\"https://play.golang.org/p/wJeAyYyjA2\" rel=\"nofollow\">https://play.golang.org/p/wJeAyYyjA2</a></p>\n\n<pre><code>    package main\n\n    import (\n        \"fmt\"\n        \"sync\"\n        \"time\"\n    )\n\n    var w sync.WaitGroup\n\n    func say(s string, async bool) {\n        if async {\n            defer w.Done()\n        }\n        for i := 0; i &lt; 2; i++ {\n            time.Sleep(100 * time.Millisecond)\n            fmt.Println(s)\n        }\n    }\n\n    func main() {\n        w.Add(1)\n        go say(\"world\", true)\n        say(\"hello\", false)\n        w.Wait()\n    }\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6807283"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "accepted_answer_id": 39383237, "answer_count": 3, "score": -1, "last_activity_date": 1473322734, "creation_date": 1473312288, "last_edit_date": 1473322734, "question_id": 39383135, "link": "https://stackoverflow.com/questions/39383135/a-tour-of-go-example-on-goroutines-concurrency", "title": "A Tour of Go example on Goroutines concurrency", "body": "<p>I'm new to the Go Language, and learning here:\n<a href=\"https://tour.golang.org/concurrency/1\" rel=\"nofollow\">https://tour.golang.org/concurrency/1</a></p>\n\n<p>When I run <a href=\"https://play.golang.org/p/9JvbtSuv5o\" rel=\"nofollow\">https://play.golang.org/p/9JvbtSuv5o</a>  the result is:</p>\n\n<pre><code>world\nhello\nhello\n</code></pre>\n\n<p>So Added <code>sync.WaitGroup</code>: <a href=\"https://play.golang.org/p/vjdhnDssGk\" rel=\"nofollow\">https://play.golang.org/p/vjdhnDssGk</a>  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nvar w sync.WaitGroup\n\nfunc say(s string) {\n    for i := 0; i &lt; 2; i++ {\n        time.Sleep(100 * time.Millisecond)\n        fmt.Println(s)\n    }\n    w.Done()\n}\n\nfunc main() {\n    w.Add(1)\n    go say(\"world\")\n    say(\"hello\")\n    w.Wait()\n}\n</code></pre>\n\n<p>But the result is same: </p>\n\n<pre><code>world\nhello\nhello\n</code></pre>\n\n<p>What is wrong with my code?  </p>\n\n<p>Please help,<br>\nThank you for your help.</p>\n"}]