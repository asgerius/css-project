[{"tags": ["go", "channel", "type-switch"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 5, "last_activity_date": 1427318104, "creation_date": 1427318104, "answer_id": 29266659, "question_id": 29266414, "link": "https://stackoverflow.com/questions/29266414/handle-different-types-of-messages-one-or-many-channels/29266659#29266659", "title": "Handle different types of messages - one or many channels?", "body": "<p>I would also go with option 'a': one channel only. You can enforce type correctness if you create a base message type (an <code>interface</code>) and both of the possible message types implement it (or if they are interfaces too, they can embed it).</p>\n\n<p>Further advantage of the one-channel solution is that it is extensible. If now you want to handle a 3rd type of message, it's very easy to add it and to handle it. In case of the other: you would need a 3rd channel which if the number of message types increases soon becomes unmanageable and makes your code ugly. Also in case of multi channels, the <code>select</code> randomly chooses a ready channel. If messages come in frequently in some channels, others might starve even if only one message is in the channel and no more is coming.</p>\n"}, {"tags": [], "owner": {"reputation": 14588, "user_id": 244393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55eb813499c0cf9fd47e95690782bf83?s=128&d=identicon&r=PG", "display_name": "Crast", "link": "https://stackoverflow.com/users/244393/crast"}, "is_accepted": false, "score": 2, "last_activity_date": 1427408401, "last_edit_date": 1427408401, "creation_date": 1427318865, "answer_id": 29266871, "question_id": 29266414, "link": "https://stackoverflow.com/questions/29266414/handle-different-types-of-messages-one-or-many-channels/29266871#29266871", "title": "Handle different types of messages - one or many channels?", "body": "<p>Answer to your questions first:</p>\n\n<p><strong>1)</strong> You got the major functional difference already, the ordering difference depending on how the channel is written to. There is also some differences in the implementation of how a channel of struct type versus interface type is implemented.  Mostly, these are implementation details and don't change the nature of the majority of outcomes of using your code that much, but in the case where you're sending millions of messages, maybe this implementation detail will cost you.</p>\n\n<p><strong>2)</strong> I would say neither example you gave is more idiomatic than the other simply by reading your pseudocode, because whether you read from one channel or two has more to do with the semantics and requirements of your program (ordering, where the data is coming from, channel depth requirements, etc) than anything else. For example, What if one of the message types was a \"stop\" message to tell your processor to stop reading, or do something that could change the state of future messages processed? Maybe that would go on its own channel to make sure it doesn't get delayed by pending writes to the other channel.</p>\n\n<p>And then you asked for possibly a better option?</p>\n\n<p>One way to keep using a single channel and also keep from doing type checks is to instead send an enclosing type as the channel type:</p>\n\n<pre><code>type Message struct { /* ... */}\ntype OtherMessage struct { /* ... */}\ntype Wrap struct {\n    *Message\n    *OtherMessage\n}\n\ntype MyProcess struct {\n    in chan Wrap\n}\n\nfunc (foo *MyProcess) Start() {\n    for msg := range foo.in {\n        if msg.Message != nil {\n            // do processing of message here\n        }\n        if msg.OtherMessage != nil {\n            // process OtherMessage here\n        }\n    }\n    // someone closed `in` - bye\n}\n</code></pre>\n\n<p>An interesting side effect of struct Wrap is you can send both a <code>Message</code> and <code>OtherMessage</code> in the same channel message. It's up to you to decide whether this means anything or will happen at all.</p>\n\n<p>One should note that if <code>Wrap</code> was going to grow beyond a handful of message types the cost of sending a wrap instance may actually be higher at some breakoff point (easy enough to benchmark) than simply sending an interface type and doing a type switch.</p>\n\n<p>The other thing which you may want to look at, depending on the similarity between the types, is defining a non-empty interface where both Message and OtherMessage have that method receiver set; maybe it will contain functionality that will solve having to do a type switch at all.</p>\n\n<p>Maybe you're reading messages to send them to a queuing library and all you really needed to get was:</p>\n\n<pre><code>interface{\n    MessageID() string\n    SerializeJSON() []byte\n}\n</code></pre>\n\n<p>(I just made that up for illustration purposes)</p>\n"}], "owner": {"reputation": 64568, "user_id": 399317, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/28235d26ee007743c9d2150759d29139?s=128&d=identicon&r=PG", "display_name": "Kos", "link": "https://stackoverflow.com/users/399317/kos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 910, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1427408401, "creation_date": 1427317196, "question_id": 29266414, "link": "https://stackoverflow.com/questions/29266414/handle-different-types-of-messages-one-or-many-channels", "title": "Handle different types of messages - one or many channels?", "body": "<p>Consider this simple code:</p>\n\n<pre><code>type Message struct { /* ... */ }\ntype MyProcess struct {\n    in chan Message\n}\n\nfunc (foo *MyProcess) Start() {\n    for msg := range foo.in {\n        // handle `msg`\n    }\n    // someone closed `in` - bye\n}\n</code></pre>\n\n<p>I'd like to change MyProcess to support 2 different kinds of messages.\nI have 2 ideas:</p>\n\n<p>a) Type switch</p>\n\n<pre><code>type Message struct { /* ... */ }\ntype OtherMessage struct { /* ... */ }\ntype MyProcess struct {\n    in chan interface{} // Changed signature to something more generic\n}\n\nfunc (foo *MyProcess) Start() {\n    for msg := range foo.in {\n        switch msg := msg.(type) {\n        case Message:\n            // handle `msg`\n        case OtherMessage:\n            // handle `msg`\n        default:\n            // programming error, type system didn't save us this time.\n            // panic?\n        }\n    }\n    // someone closed `in` - bye\n}\n</code></pre>\n\n<p>b) Two channels</p>\n\n<pre><code>type Message struct { /* ... */ }\ntype OtherMessage struct { /* ... */ }\ntype MyProcess struct {\n    in      chan Message\n    otherIn chan OtherMessage\n}\n\nfunc (foo *MyProcess) Start() {\n    for {\n        select {\n        case msg, ok := &lt;-foo.in:\n            if !ok {\n                // Someone closed `in`\n                break\n            }\n            // handle `msg`\n        case msg, ok := &lt;-foo.otherIn:\n            if !ok {\n                // Someone closed `otherIn`\n                break\n            }\n            // handle `msg`\n        }\n    }\n    // someone closed `in` or `otherIn` - bye\n}\n</code></pre>\n\n<ol>\n<li><p>What's the functional difference between the two implementations? One thing is the ordering differences - only the first one guarantees that the messages (<code>Message</code> and <code>OtherMessage</code>) will be processed in the proper sequence.</p></li>\n<li><p>Which one is more idiomatic? The approach 'a' is shorter but doesn't enforce message type correctness (one could put anything in the channel). The approach 'b' fixes this, but has more boilerplate and more space for human error: both channels need to be checked for closedness (easy to forget) and someone needs to actually close both of them (even easier to forget).</p></li>\n</ol>\n\n<p>Long story short I'd rather use 'a' but it doesn't leverage the type system and thus feels ugly. Maybe there is an even better option?</p>\n"}, {"tags": ["logging", "web-applications", "go"], "answers": [{"tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": true, "score": 1, "last_activity_date": 1427311067, "creation_date": 1427311067, "answer_id": 29264608, "question_id": 29264337, "link": "https://stackoverflow.com/questions/29264337/can-we-direct-all-console-log-to-file/29264608#29264608", "title": "can we direct all console log to file?", "body": "<p>You can use this function to redirect standard error to a file.  This will receive tracebacks.</p>\n\n<pre><code>// redirectStderr to the file passed in\nfunc redirectStderr(f *os.File) {\nerr := syscall.Dup2(int(f.Fd()), int(os.Stderr.Fd()))\n    if err != nil {\n        log.Fatalf(\"Failed to redirect stderr to file: %v\", err)\n    }\n}\n</code></pre>\n\n<p>It only works on linux/mac/unix.</p>\n\n<p>Here is how to do the same thing for windows</p>\n\n<pre><code>var (\n    kernel32 = syscall.MustLoadDLL(\"kernel32.dll\")\n    procSetStdHandle = kernel32.MustFindProc(\"SetStdHandle\")\n)\n\nfunc setStdHandle(stdhandle int32, handle syscall.Handle) error {\n    r0, _, e1 := syscall.Syscall(procSetStdHandle.Addr(), 2, uintptr(stdhandle), uintptr(handle), 0)\n    if r0 == 0 {\n        if e1 != 0 {\n            return error(e1)\n        }\n        return syscall.EINVAL\n    }\n    return nil\n}\n\n// redirectStderr to the file passed in\nfunc redirectStderr(f *os.File) {\n    err := setStdHandle(syscall.STD_ERROR_HANDLE, syscall.Handle(f.Fd()))\n    if err != nil {\n        log.Fatalf(\"Failed to redirect stderr to file: %v\", err)\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/kLtct7lSUg\" rel=\"nofollow\">Original code from minux</a></p>\n"}, {"tags": [], "owner": {"reputation": 939, "user_id": 4648046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932ac0b92feea46110e78577f7047c74?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy R.", "link": "https://stackoverflow.com/users/4648046/eddy-r"}, "is_accepted": false, "score": 2, "last_activity_date": 1427317206, "creation_date": 1427317206, "answer_id": 29266420, "question_id": 29264337, "link": "https://stackoverflow.com/questions/29264337/can-we-direct-all-console-log-to-file/29266420#29266420", "title": "can we direct all console log to file?", "body": "<p>Assuming your code uses the log library to report errors everywhere, you can change the file that the default logger writes to rather than defining your own log object and passing it around. This is done via the log library's <a href=\"http://golang.org/pkg/log/#SetOutput\" rel=\"nofollow\">SetOutput()</a> function.</p>\n\n<p>This way the following code would just write into your log file instead standard error:</p>\n\n<pre><code>// Call this when your program starts and pass it the file handle for your\n// log file.\nfunc SetupErrorLog(logFile io.Writer) {\n    log.SetOutput(logFile)\n}\n\n...\n\nfunc DoSomething() {\n    ...\n    if err != nil {\n       // prints to your log file and exits\n       log.Fatalln(\"A fatal error has occurred:\", err)\n   }\n}\n</code></pre>\n\n<p>If you are not using the log library uniformly and you want to capture all  output (like panics), then the accepted answer works. However, I'd prefer a much simpler approach without complicating your code by using a tool like logger when you invoke your program:</p>\n\n<pre><code>go run MainPackageFile.go 2&gt;&amp;1 | logger\n</code></pre>\n\n<p>This will send all of your program's output to syslog without having to mess with your code. The logger command has many options to customize logging behavior, including the ability to choose your own log file. Read the <a href=\"http://man7.org/linux/man-pages/man1/logger.1.html\" rel=\"nofollow\">logger man page</a> for more information.</p>\n\n<p>The logger command is available on Unix systems (including Mac). The Windows solution might be a little different.</p>\n"}], "owner": {"reputation": 12482, "user_id": 96898, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/d4fd99e7e659272c0d375a29da8b9c39?s=128&d=identicon&r=PG", "display_name": "jojo", "link": "https://stackoverflow.com/users/96898/jojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 1, "accepted_answer_id": 29264608, "answer_count": 2, "score": 2, "last_activity_date": 1427317206, "creation_date": 1427310235, "question_id": 29264337, "link": "https://stackoverflow.com/questions/29264337/can-we-direct-all-console-log-to-file", "title": "can we direct all console log to file?", "body": "<p>when running web app locally with command </p>\n\n<pre><code>go run MainPackageFile.go\n</code></pre>\n\n<p>and we can map logger e.g with martini</p>\n\n<pre><code>m := martini.Classic()\nm.Get(\"/m\", func() string {\n  return \"Hello world!\"\n})\nm.Map(log.New(f, \"[martini]\", log.LstdFlags))\n</code></pre>\n\n<p>however what if there is something wrong outside the code, e.g Go not able to download package etc... is there a way to get those go runtime log?\nwhen running locally errors will print out onto console. is there a way when running in server, we can have all those log write into text file?</p>\n"}, {"tags": ["error-handling", "go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "edited": false, "score": 1, "creation_date": 1427317661, "post_id": 29266148, "comment_id": 46734770, "body": "Thanks very much!  Your snippet answers my question perfectly."}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 4, "last_activity_date": 1427316276, "creation_date": 1427316276, "answer_id": 29266148, "question_id": 29263203, "link": "https://stackoverflow.com/questions/29263203/how-can-i-detect-a-connection-failure-in-gorm/29266148#29266148", "title": "How can I detect a connection failure in gorm?", "body": "<p>Gorm appears to swallow database driver errors and emit only it's own classification of error types (see <a href=\"https://github.com/jinzhu/gorm/blob/master/errors.go\" rel=\"nofollow\"><code>gorm/errors.go</code></a>).  Connection errors do not currently appear to be reported.</p>\n\n<p>Consider submitting an issue or pull request to expose the database driver error directly.</p>\n\n<p><strong>[Original]</strong></p>\n\n<p>Try inspecting the runtime type of <code>db.Error</code> per the advice in the <a href=\"https://github.com/jinzhu/gorm#error-handling\" rel=\"nofollow\">gorm readme \"Error Handling\" section</a>.</p>\n\n<p>Assuming it's an error type returned by your database driver you can likely get a specific code that indicates connection errors.  For example, if you're using PostgreSQL via the pq library then you might try something like this:</p>\n\n<pre><code>import \"github.com/lib/pq\"\n\n// ...\n\nif db.Error != nil {\n  pqerr, ok := err.(*pq.Error)\n  if ok &amp;&amp; pqerr.Code[0:2] == \"08\" {\n    // PostgreSQL \"Connection Exceptions\" are class \"08\"\n    // http://www.postgresql.org/docs/9.4/static/errcodes-appendix.html#ERRCODES-TABLE\n    // Do something for connection errors...\n  } else {\n    // Do something else with non-pg error or non-connection error...\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 15832, "user_id": 1156707, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/99055b620fb3a9d30a8f6ac480c25227?s=128&d=identicon&r=PG", "display_name": "Louis Thibault", "link": "https://stackoverflow.com/users/1156707/louis-thibault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2917, "favorite_count": 1, "accepted_answer_id": 29266148, "answer_count": 1, "score": 0, "last_activity_date": 1427316276, "creation_date": 1427306762, "question_id": 29263203, "link": "https://stackoverflow.com/questions/29263203/how-can-i-detect-a-connection-failure-in-gorm", "title": "How can I detect a connection failure in gorm?", "body": "<p>I'm writing a small, simple web app in go using the <a href=\"https://github.com/jinzhu/gorm\" rel=\"nofollow\">gorm ORM</a>.</p>\n\n<p>Since the database can fail independently of the web application, I'd like to be able to identify errors that correspond to this case so that I can reconnect to my database without restarting the web application.</p>\n\n<p><strong>Motivating example:</strong></p>\n\n<p>Consider the following code:</p>\n\n<pre><code>var mrs MyRowStruct\ndb := myDB.Model(MyRowStruct{}).Where(\"column_name = ?\", value).First(&amp;mrs)\nreturn &amp;mrs, db.Error\n</code></pre>\n\n<ol>\n<li><p>In the event that <code>db.Error != nil</code>, how can I programmatically determine if the error stems from a database connection problem?</p></li>\n<li><p>From my reading, I understand that <code>gorm.DB</code> <strong>does not</strong> represent a connection, so do I even have to worry about reconnecting or re-issuing a call to <code>gorm.Open</code> if a database connection fails?</p></li>\n<li><p>Are there any common patterns for handling database failures in Go?</p></li>\n</ol>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 53873, "user_id": 3737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a3fc14ec0008acf8d406c93e23c3ae?s=128&d=identicon&r=PG", "display_name": "Jesse Rusak", "link": "https://stackoverflow.com/users/3737/jesse-rusak"}, "edited": false, "score": 0, "creation_date": 1427306212, "post_id": 29262947, "comment_id": 46728029, "body": "How about trying to produce a minimal test case?"}, {"owner": {"reputation": 187, "user_id": 3995228, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3704db62cc1e1967db3ef022eea118f2?s=128&d=identicon&r=PG&f=1", "display_name": "\u017diga Pata\u010dko Koderman", "link": "https://stackoverflow.com/users/3995228/%c5%bdiga-pata%c4%8dko-koderman"}, "reply_to_user": {"reputation": 53873, "user_id": 3737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04a3fc14ec0008acf8d406c93e23c3ae?s=128&d=identicon&r=PG", "display_name": "Jesse Rusak", "link": "https://stackoverflow.com/users/3737/jesse-rusak"}, "edited": false, "score": 0, "creation_date": 1427309127, "post_id": 29262947, "comment_id": 46729894, "body": "that is the problem: i have no idea how I got into this trouble :/ any idea where to start?"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1427311103, "creation_date": 1427311103, "answer_id": 29264621, "question_id": 29262947, "link": "https://stackoverflow.com/questions/29262947/go-gae-app-works-locally-when-deployed-i-get-404-nothing/29264621#29264621", "title": "Go GAE app works locally, when deployed I get 404/nothing", "body": "<p>For Go applications, <a href=\"https://cloud.google.com/appengine/docs/go/config/appconfig#Go_app_yaml_Script_handlers\" rel=\"nofollow\">set the script handler</a> to \"_go_app\".  For example:</p>\n\n<pre><code>handlers:\n    url: /api/.* \n    script: _go_app\n</code></pre>\n\n<p>AppEngine dispatches all requests for Go applications to a single compiled executable. This is different from Python where you can specify a different script for each handler.</p>\n"}], "owner": {"reputation": 187, "user_id": 3995228, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3704db62cc1e1967db3ef022eea118f2?s=128&d=identicon&r=PG&f=1", "display_name": "\u017diga Pata\u010dko Koderman", "link": "https://stackoverflow.com/users/3995228/%c5%bdiga-pata%c4%8dko-koderman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427318085, "creation_date": 1427305833, "last_edit_date": 1427318085, "question_id": 29262947, "link": "https://stackoverflow.com/questions/29262947/go-gae-app-works-locally-when-deployed-i-get-404-nothing", "title": "Go GAE app works locally, when deployed I get 404/nothing", "body": "<p>I'm working on a serverside part of a <a href=\"http://partycon.net\" rel=\"nofollow\">PartyCon</a> project. It is written in Golang on Google App Engine platform. I have just implemented a few new things which work perfectly LOCALLY. However, when deployed, I cannot rich console.go script.</p>\n\n<p>Here is my app.yaml configuration (sorry, this is how stackoverflow shows yaml files):</p>\n\n<pre><code>application: party-serverside version: alpha-1 runtime: go\napi_version: go1\n\nhandlers:\n\n#handlers for api\n- url: /api/.*   \n  script: api/api.go\n\n#handlers for console and webpage routing\n- url: /redirect   \n  script: redirecter/redirecter.go\n\n- url: /admin_console/choose   \n  script: admin_console/choose.go\n\n- url: /post-request   \n  script: webpage/post-request.go\n\n- url: /console   \n  script: console/console.go\n\n #handlers for static files\n - url: /css/console.css   \n   static_files: console/page/css/console.css   upload: console/page/css/console.css\n\n- url: /console/page   \n  static_dir: console/page\n\n- url: /   \n  static_files: webpage/index.html   \n  upload: webpage/index.html\n\n- url: /   \n  static_dir: webpage\n\n- url: /css   \n  static_dir: webpage/css\n\n- url: /js   \n  static_dir: webpage/js\n\n- url: /img   \n  static_dir: webpage/img\n\n- url: /fonts   \n  static_dir: webpage/fonts\n</code></pre>\n\n<p>And my console.go file:</p>\n\n<pre><code>package console\n\nimport (\n    \"appengine\"\n    \"appengine/user\"\n    \"database/sql\"\n    _ \"github.com/go-sql-driver/mysql\"\n    \"html/template\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"strconv\"\n    \"time\"\n)\n\n//for deployment\nvar dbConnectString string = \"****************************\"\n\n//for local testing\n//var dbConnectString string = \"root@/party\"\n\nfunc init() {\n    http.HandleFunc(\"/console\", consoleHandler)\n}\n\nfunc consoleHandler(w http.ResponseWriter, r *http.Request) {\n    redirectIfNeeded(w, r)\n    c := appengine.NewContext(r)\n    u := user.Current(c)\n\n    logoutUrl, e := user.LogoutURL(c, \"/redirect\")\n\n    if e != nil {\n        panic(e)\n    }\n\n    email := u.Email\n    data := WebpageData{LogoutUrl: logoutUrl, UserName: email, NewPartyUrl: \"/console/newparty\"}\n\n    template := template.Must(template.New(\"template\").Parse(generateUnsignedHtml(u)))\n\n    err := template.Execute(w, data)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    }\n\n}\n\nfunc generateUnsignedHtml(u *user.User) string {\n    firstPart := fileValue(\"./console/page/firstPart.html\")\n    table := generateTable(u)\n    secondPart := fileValue(\"./console/page/secondPart.html\")\n\n    html := firstPart + table + secondPart\n    return html\n}\n\nfunc generateTable(u *user.User) string {\n    con, e := sql.Open(\"mysql\", dbConnectString)\n    if e != nil {\n        panic(e)\n    }\n    defer con.Close()\n\n    var parties []Party\n    partyRows, err := con.Query(\"select id, name, datetime, host, location from parties where author='\" + u.Email + \"';\")\n    if err != nil {\n        panic(err)\n    }\n\n    var id int\n    var name string\n    var datetime string\n    var host string\n    var location string\n\n    for partyRows.Next() {\n        partyRows.Scan(&amp;id, &amp;name, &amp;datetime, &amp;host, &amp;location)\n        parties = append(parties, Party{Id: id, Name: name, DatetimeString: datetime, Host: host, Location: location})\n    }\n\n    html := \"\"\n    for i, party := range parties {\n        actionsHtml := \"&lt;a href=\\\"/console/edit?id=\" + strconv.Itoa(party.Id) + \"\\\" class=\\\"uk-button uk-button-primary editButton\\\"&gt;Edit&lt;/a&gt; &lt;a href=\\\"/console/delete?id=\" + strconv.Itoa(party.Id) + \"\\\" class=\\\"uk-button uk-button-danger\\\"&gt;Delete&lt;/a&gt;\"\n        html += \"&lt;tr&gt;\" + makeTd(strconv.Itoa(i+1)) + makeTd(party.Name) + makeTd(party.DatetimeString) + makeTd(party.Host) + makeTd(party.Location) + makeTd(actionsHtml) + \"&lt;/tr&gt;\"\n    }\n\n    html += \"&lt;/table&gt;\"\n    return html\n}\n\nfunc makeTd(content string) string {\n    return \"&lt;td&gt;\" + content + \"&lt;/td&gt;\"\n}\n\nfunc redirectIfNeeded(w http.ResponseWriter, r *http.Request) {\n    expire := time.Date(2000, 1, 1, 1, 1, 1, 0, time.UTC)\n    cookie := &amp;http.Cookie{Name: \"ACSID\", Value: \"\", Expires: expire, HttpOnly: true}\n    http.SetCookie(w, cookie)\n    cookie2 := &amp;http.Cookie{Name: \"SACSID\", Value: \"\", Expires: expire, HttpOnly: true}\n    http.SetCookie(w, cookie2)\n\n    c := appengine.NewContext(r)\n    u := user.Current(c)\n    if u == nil {\n        url, err := user.LoginURL(c, r.URL.String())\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n        w.Header().Set(\"Location\", url)\n        w.WriteHeader(http.StatusFound)\n        return\n    }\n\n    con, e := sql.Open(\"mysql\", dbConnectString)\n    if e != nil {\n        panic(e)\n    }\n    defer con.Close()\n\n    //check whether user is admin\n    admRows, error := con.Query(\"select email from admin_users;\")\n    if error != nil {\n        panic(error)\n    }\n    var email string\n    isAdmin := false\n    for admRows.Next() {\n        admRows.Scan(&amp;email)\n        if email == u.Email {\n            isAdmin = true\n        }\n    }\n\n    //check if he is validated user\n    validRows, error2 := con.Query(\"select email from party_validated_users;\")\n    if error2 != nil {\n        panic(error2)\n    }\n    email = \"\"\n    isValidated := false\n    for validRows.Next() {\n        validRows.Scan(&amp;email)\n        if email == u.Email {\n            isValidated = true\n        }\n    }\n\n    var url string\n\n    if user.IsAdmin(c) || isAdmin {\n        //user is declared as admin in db or is admin of gae app\n        //we are allready here\n        url = \"/console\"\n    } else if isValidated {\n        //user is validated\n        //we are allready here\n        url = \"/console\"\n    } else {\n        //user is not validated yet\n        url = \"/redirect\"\n        w.Header().Set(\"Location\", url)\n        w.WriteHeader(http.StatusFound)\n    }\n}\n\nfunc fileValue(path string) string {\n    content, err := ioutil.ReadFile(path)\n    if err != nil {\n        panic(err)\n    }\n    return string(content)\n}\n\ntype WebpageData struct {\n    LogoutUrl   string\n    UserName    string\n    NewPartyUrl string\n}\n\ntype Party struct {\n    Id             int\n    Name           string\n    DatetimeString string\n    Host           string\n    Location       string\n}\n</code></pre>\n\n<p>Any idea why this happens? Thanks in advance :)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427299315, "post_id": 29260549, "comment_id": 46723410, "body": "Capture stderr (or for windows, perhaps combined output) and print it in your error block (or directly set <code>cmd.Stderr = os.Stderr</code>). Sane commands should say why they fail to stderr when they exit with a non-zero exist status (except for when they clearly document what a specific exit code means, e.g. <code>grep</code> exits 1 with no output when it doesn&#39;t find anything)."}, {"owner": {"reputation": 19, "user_id": 147221, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3e119d040bc88aa33aaaf4c8404df926?s=128&d=identicon&r=PG", "display_name": "bumstyla", "link": "https://stackoverflow.com/users/147221/bumstyla"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427299748, "post_id": 29260549, "comment_id": 46723700, "body": "Thanx Dave. Im new to go and didnt know how to get the Stderr. Now i can see my errors."}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 2, "last_activity_date": 1427299989, "last_edit_date": 1427299989, "creation_date": 1427299644, "answer_id": 29260772, "question_id": 29260549, "link": "https://stackoverflow.com/questions/29260549/executing-web2exe-from-golang-is-giving-me-exit-status-2/29260772#29260772", "title": "Executing web2exe from Golang is giving me &#39;exit status 2&#39;", "body": "<p>When a program exits non-zero it means that it could not run successfully and typically it has written an error message to STDERR (or STDOUT).  You should somehow capture or print the output streams so you can inspect them for error messages.  For example:</p>\n\n<pre><code>cmd.Stdout = os.Stdout\ncmd.Stderr = os.Stderr\n</code></pre>\n\n<p>Note also that your command line arguments should be separate array elements (instead of space separated elements in a single string as they are now):</p>\n\n<pre><code>cmd := exec.Command(\"web2exe-win.exe\", \"html-folder\", \"--main\", \"index.html\", \"--export-to\", \"windows-x32\", \"--output-dir\")\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 147221, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3e119d040bc88aa33aaaf4c8404df926?s=128&d=identicon&r=PG", "display_name": "bumstyla", "link": "https://stackoverflow.com/users/147221/bumstyla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 973, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1427299989, "creation_date": 1427298993, "question_id": 29260549, "link": "https://stackoverflow.com/questions/29260549/executing-web2exe-from-golang-is-giving-me-exit-status-2", "title": "Executing web2exe from Golang is giving me &#39;exit status 2&#39;", "body": "<p>Im trying the following, to use go to bundle a folder of html files using the CMD web2exe. </p>\n\n<pre><code>cmd := exec.Command(\"web2exe-win.exe\", \"html-folder --main index.html --export- to windows-x32 --output-dir\")\nvar out bytes.Buffer\ncmd.Stdout = &amp;out\nerr := cmd.Run()\nif err != nil {\n    fmt.Println(err)\n}\nfmt.Println(out)\n</code></pre>\n"}, {"tags": ["go", "pprof"], "answers": [{"tags": [], "owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "is_accepted": true, "score": 11, "last_activity_date": 1557154574, "last_edit_date": 1557154574, "creation_date": 1427301401, "answer_id": 29261394, "question_id": 29258455, "link": "https://stackoverflow.com/questions/29258455/what-are-the-dashed-dotted-lines-in-gos-pprof-web-output/29261394#29261394", "title": "What are the dashed/dotted lines in Go&#39;s pprof web output?", "body": "<p>Dotted lines represent nodes' connection through another node, which is not rendered in final output.</p>\n\n<p>See <a href=\"https://github.com/google/pprof/blob/master/internal/graph/dotgraph.go#L311\" rel=\"nofollow noreferrer\">https://github.com/google/pprof/blob/master/internal/graph/dotgraph.go#L311</a></p>\n\n<pre><code>if e.residual {\n    attr = attr + ` style=\"dotted\"`\n}\n</code></pre>\n\n<p>and residual stands for</p>\n\n<blockquote>\n  <p>// residual edges connect nodes that were connected through a\n  separate node, which has been removed from the report.</p>\n</blockquote>\n\n<p><a href=\"https://github.com/google/pprof/blob/master/internal/graph/graph.go#L243\" rel=\"nofollow noreferrer\">https://github.com/google/pprof/blob/master/internal/graph/graph.go#L243</a></p>\n"}], "owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1259, "favorite_count": 1, "accepted_answer_id": 29261394, "answer_count": 1, "score": 4, "last_activity_date": 1557154574, "creation_date": 1427293640, "last_edit_date": 1427569547, "question_id": 29258455, "link": "https://stackoverflow.com/questions/29258455/what-are-the-dashed-dotted-lines-in-gos-pprof-web-output", "title": "What are the dashed/dotted lines in Go&#39;s pprof web output?", "body": "<p>In the web output of <code>go tool pprof</code>, what are the dashed/dotted lines?</p>\n\n<p>I find some mention that it could represent inlined functions, but there's no canonical reference.</p>\n"}, {"tags": ["oauth", "go", "linuxbrew"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1427287635, "post_id": 29256057, "comment_id": 46714852, "body": "If you look at <a href=\"https://code.google.com/p/goauth2/\" rel=\"nofollow noreferrer\">code.google.com/p/goauth2</a> you&#39;ll see that you probably want <code>golang.org&#47;x&#47;oauth2</code>."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427287802, "post_id": 29256057, "comment_id": 46714974, "body": "That said, <code>go get code.google.com&#47;p&#47;goauth2&#47;oauth</code> does work for me."}, {"owner": {"reputation": 1173, "user_id": 4014693, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "avinash pandey", "link": "https://stackoverflow.com/users/4014693/avinash-pandey"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427287838, "post_id": 29256057, "comment_id": 46714999, "body": "Yes. I did look into the package in their official github page and it was indeed golang.org/x/oauth2.Thanks @DaveC"}, {"owner": {"reputation": 1173, "user_id": 4014693, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "avinash pandey", "link": "https://stackoverflow.com/users/4014693/avinash-pandey"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427288150, "post_id": 29256057, "comment_id": 46715210, "body": "@DaveC Now even i tried running go get for oauth but it now gives me a very common problem of mercurial not being installed.Is Google planning to move such packages from mercurial version control to github ant time soon"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1427288577, "post_id": 29256057, "comment_id": 46715520, "body": "In general, if you expect <code>go get &lt;random import&gt;</code> to work you need at minimum git and mecurial installed, probably bzr too as there are a couple of well used packages on launchpad."}], "owner": {"reputation": 1173, "user_id": 4014693, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "avinash pandey", "link": "https://stackoverflow.com/users/4014693/avinash-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 500, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1427288625, "creation_date": 1427287461, "last_edit_date": 1427288625, "question_id": 29256057, "link": "https://stackoverflow.com/questions/29256057/where-to-set-gopath-after-installing-go-using-brew", "title": "Where to set GOPATH after installing go using brew?", "body": "<p>I installed Go on my ubuntu 14.04 using Linux brew and then I have set <code>GOPATH</code> to <code>$HOME/go</code>. But after that i tried to install goauth package for go using go get command but still my code is not importing goauth package. After going through the error I decided to check the <code>GOPATH</code>. It is properly set but the goauth package is not getting installed in <code>$HOME/go/src/code.google.com/p</code>. Please suggest me a work around. Here is the error that I am getting.</p>\n\n<pre><code>dummy.go:5:8: cannot find package \"code.google.com/p/goauth2/oauth\" in any of:\n    /home/avinash/.linuxbrew/Cellar/go/1.4.2/libexec/src/code.google.com/p/goauth2/oauth (from $GOROOT)\n    /home/avinash/go/src/code.google.com/p/goauth2/oauth (from $GOPATH)\ngo/src/github.com/google/go-github/github/github.go:22:2: cannot find package \"github.com/google/go-querystring/query\" in any of:\n    /home/avinash/.linuxbrew/Cellar/go/1.4.2/libexec/src/github.com/google/go-querystring/query (from $GOROOT)\n    /home/avinash/go/src/github.com/google/go-querystring/query (from $GOPATH)\n</code></pre>\n"}, {"tags": ["string", "go", "unicode", "utf-8", "type-conversion"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427286935, "post_id": 29255746, "comment_id": 46714403, "body": "See <a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">The Go Blog: Strings, bytes, runes and characters in Go</a>."}, {"owner": {"reputation": 1658, "user_id": 516037, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b4987583409b6d79fca0bd1145c54609?s=128&d=identicon&r=PG&f=1", "display_name": "dpington", "link": "https://stackoverflow.com/users/516037/dpington"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 3, "creation_date": 1427287013, "post_id": 29255746, "comment_id": 46714458, "body": "@DaveC I&#39;ve read that document at least 5 times and didn&#39;t find what I was looking for."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1427287177, "post_id": 29255746, "comment_id": 46714560, "body": "Then an even more basic source: <a href=\"https://golang.org/ref/spec#Conversions_to_and_from_a_string_type\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Conversions_to_and_from_a_string_type</a> Combine #3 and #4 from that list."}], "answers": [{"comments": [{"owner": {"reputation": 1658, "user_id": 516037, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b4987583409b6d79fca0bd1145c54609?s=128&d=identicon&r=PG&f=1", "display_name": "dpington", "link": "https://stackoverflow.com/users/516037/dpington"}, "edited": false, "score": 3, "creation_date": 1427287074, "post_id": 29255836, "comment_id": 46714497, "body": "Ah so I was missing something, it made perfect sense to me <code>string &lt;-&gt; []byte</code>, but I didn&#39;t make the jump from <code>[]rune -&gt; string -&gt; []byte</code>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 43, "last_activity_date": 1556831926, "last_edit_date": 1556831926, "creation_date": 1427286915, "answer_id": 29255836, "question_id": 29255746, "link": "https://stackoverflow.com/questions/29255746/how-encode-rune-into-byte-using-utf8/29255836#29255836", "title": "How encode []rune into []byte using utf8", "body": "<p>You can simply convert a rune slice (<code>[]rune</code>) to <code>string</code> which you can convert back to <code>[]byte</code>.</p>\n\n<p>Example:</p>\n\n<pre><code>rs := []rune{'H', 'e', 'l', 'l', 'o', ' ', '\u4e16', '\u754c'}\nbs := []byte(string(rs))\n\nfmt.Printf(\"%s\\n\", bs)\nfmt.Println(string(bs))\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/9RYoQhUTHj\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Hello \u4e16\u754c\nHello \u4e16\u754c\n</code></pre>\n\n<p>The <a href=\"http://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">Go Specification: Conversions</a> mentions this case explicitly: <a href=\"http://golang.org/ref/spec#Conversions_to_and_from_a_string_type\" rel=\"noreferrer\">Conversions to and from a string type</a>, point #3:</p>\n\n<blockquote>\n  <p>Converting a slice of runes to a string type yields a string that is the concatenation of the individual rune values converted to strings.</p>\n</blockquote>\n\n<p>Note that the above solution\u2013although may be the simplest\u2013might not be the most efficient. And the reason is because it first creates a <code>string</code> value that will hold a \"copy\" of the runes in UTF-8 encoded form, then it copies the backing slice of the string to the result byte slice (a copy has to be made because <code>string</code> values are immutable, and if the result slice would share data with the <code>string</code>, we would be able to modify the content of the <code>string</code>; for details, see <a href=\"https://stackoverflow.com/questions/43470284/golang-bytestring-vs-bytestring/43470344#43470344\">golang: []byte(string) vs []byte(*string)</a> and <a href=\"https://stackoverflow.com/questions/47352449/immutable-string-and-pointer-address/47352588#47352588\">Immutable string and pointer address</a>).</p>\n\n<p><sup>Note that a smart compiler could detect that the intermediate <code>string</code> value cannot be referred to and thus eliminate one of the copies.</sup></p>\n\n<p>We may get better performance by allocating a single byte slice, and encode the runes one-by-one into it. And we're done. To easily do this, we may call the <a href=\"https://golang.org/pkg/unicode/utf8/\" rel=\"noreferrer\"><code>unicode/utf8</code></a> package to our aid:</p>\n\n<pre><code>rs := []rune{'H', 'e', 'l', 'l', 'o', ' ', '\u4e16', '\u754c'}\nbs := make([]byte, len(rs)*utf8.UTFMax)\n\ncount := 0\nfor _, r := range rs {\n    count += utf8.EncodeRune(bs[count:], r)\n}\nbs = bs[:count]\n\nfmt.Printf(\"%s\\n\", bs)\nfmt.Println(string(bs))\n</code></pre>\n\n<p>Output of the above is the same. Try it on the <a href=\"https://play.golang.org/p/HZaHzxAWw5P\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p>Note that in order to create the result slice, we had to guess how big the result slice will be. We used a maximum estimation, which is the number of runes multiplied by the max number of bytes a rune may be encoded to (<code>utf8.UTFMax</code>). In most cases, this will be bigger than needed.</p>\n\n<p>We may create a third version where we first calculate the exact size needed. For this, we may use the <a href=\"https://golang.org/pkg/unicode/utf8/#RuneLen\" rel=\"noreferrer\"><code>utf8.RuneLen()</code></a> function. The gain will be that we will not \"waste\" memory, and we won't have to do a final slicing (<code>bs = bs[:count]</code>).</p>\n\n<p>Let's compare the performances. The 3 functions (3 versions) to compare:</p>\n\n<pre><code>func runesToUTF8(rs []rune) []byte {\n    return []byte(string(rs))\n}\n\nfunc runesToUTF8Manual(rs []rune) []byte {\n    bs := make([]byte, len(rs)*utf8.UTFMax)\n\n    count := 0\n    for _, r := range rs {\n        count += utf8.EncodeRune(bs[count:], r)\n    }\n\n    return bs[:count]\n}\n\nfunc runesToUTF8Manual2(rs []rune) []byte {\n    size := 0\n    for _, r := range rs {\n        size += utf8.RuneLen(r)\n    }\n\n    bs := make([]byte, size)\n\n    count := 0\n    for _, r := range rs {\n        count += utf8.EncodeRune(bs[count:], r)\n    }\n\n    return bs\n}\n</code></pre>\n\n<p>And the benchmarking code:</p>\n\n<pre><code>var rs = []rune{'H', 'e', 'l', 'l', 'o', ' ', '\u4e16', '\u754c'}\n\nfunc BenchmarkFirst(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        runesToUTF8(rs)\n    }\n}\n\nfunc BenchmarkSecond(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        runesToUTF8Manual(rs)\n    }\n}\n\nfunc BenchmarkThird(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        runesToUTF8Manual2(rs)\n    }\n}\n</code></pre>\n\n<p>And the results:</p>\n\n<pre><code>BenchmarkFirst-4        20000000                95.8 ns/op\nBenchmarkSecond-4       20000000                84.4 ns/op\nBenchmarkThird-4        20000000                81.2 ns/op\n</code></pre>\n\n<p>As suspected, the second version is faster and the third version is the fastest, although the performance gain is not huge. In general the first, simplest solution is preferred, but if this is in some critical part of your app (and is executed many-many times), the third version might worth it to be used.</p>\n"}], "owner": {"reputation": 1658, "user_id": 516037, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b4987583409b6d79fca0bd1145c54609?s=128&d=identicon&r=PG&f=1", "display_name": "dpington", "link": "https://stackoverflow.com/users/516037/dpington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27941, "favorite_count": 4, "accepted_answer_id": 29255836, "answer_count": 1, "score": 20, "last_activity_date": 1594194828, "creation_date": 1427286676, "last_edit_date": 1594194828, "question_id": 29255746, "link": "https://stackoverflow.com/questions/29255746/how-encode-rune-into-byte-using-utf8", "title": "How encode []rune into []byte using utf8", "body": "<p>It's really easy to decode a <code>[]byte</code> into a <code>[]rune</code> (simply cast to <code>string</code>, then cast to <code>[]rune</code> works very nicely, I'm assuming it defaults to utf8 and with filler bytes for invalids). My question is - how are you suppose to decode this <code>[]rune</code> back to <code>[]byte</code> in utf8 form?</p>\n<p>Am I missing something or do I have manually call <a href=\"http://golang.org/pkg/unicode/utf8/#EncodeRune\" rel=\"nofollow noreferrer\">EncodeRune</a> for every single rune in my <code>[]rune</code>? Surely there is an encoder that I can simply pass a <code>Writer</code> to.</p>\n"}, {"tags": ["github", "go", "github-api"], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 2128746, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lQXxz.jpg?s=128&g=1", "display_name": "Hasit Mistry", "link": "https://stackoverflow.com/users/2128746/hasit-mistry"}, "edited": false, "score": 0, "creation_date": 1427314244, "post_id": 29261635, "comment_id": 46732837, "body": "Thank you for your help. One more question: The ID that is being printed is not the same that I see when I print <code>gists</code>. It prints something this: <code>0xc20813af60</code> instead of <code>910349555dc0175ab949</code>. How do I get it in the format that I like?"}, {"owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "reply_to_user": {"reputation": 189, "user_id": 2128746, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lQXxz.jpg?s=128&g=1", "display_name": "Hasit Mistry", "link": "https://stackoverflow.com/users/2128746/hasit-mistry"}, "edited": false, "score": 1, "creation_date": 1427314514, "post_id": 29261635, "comment_id": 46733021, "body": "Ah, yes, my bad - ID is of type *string (pointer to string), so 0xc20813af60 is a correct value of this type (address in memory). So we need to get value at that address, using asterisk (*):  fmt.Printf(&quot;%v / %v\\n&quot;, *g.ID, filename)  I&#39;ve modified code above with this change."}, {"owner": {"reputation": 189, "user_id": 2128746, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lQXxz.jpg?s=128&g=1", "display_name": "Hasit Mistry", "link": "https://stackoverflow.com/users/2128746/hasit-mistry"}, "edited": false, "score": 0, "creation_date": 1427314802, "post_id": 29261635, "comment_id": 46733174, "body": "Perfect. Thank you so much for answering quickly. This solves a lot of things for me."}], "tags": [], "owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "is_accepted": true, "score": 1, "last_activity_date": 1427314540, "last_edit_date": 1427314540, "creation_date": 1427302056, "answer_id": 29261635, "question_id": 29252684, "link": "https://stackoverflow.com/questions/29252684/extracting-information-from-go-github-gist-type/29261635#29261635", "title": "Extracting information from go-github Gist type", "body": "<p>You have Files map, where filename is stored in key variable of type GistFilename, and ID is in Gist type variable. So you have to have two range's - one for Gists, other for Files.\nSomething like this:</p>\n\n<pre><code>    for _, g := range gists {\n        for filename, _ := range g.Files {\n            fmt.Printf(\"%v / %v\\n\", *g.ID, filename)\n        }\n    }\n</code></pre>\n\n<p>Full code:</p>\n\n<pre><code>package main\n\nimport (\n    \"code.google.com/p/goauth2/oauth\"\n    \"fmt\"\n    \"github.com/google/go-github/github\"\n)\n\nfunc main() {\n    t := &amp;oauth.Transport{\n        Token: &amp;oauth.Token{AccessToken: \"secretaccesstokenhere\"},\n    }\n\n    client := github.NewClient(t.Client())\n\n    gists, _, err := client.Gists.List(\"\", nil)\n\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    for _, g := range gists {\n        for filename, _ := range g.Files {\n            fmt.Printf(\"%v / %v\\n\", *g.ID, filename)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 2128746, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/lQXxz.jpg?s=128&g=1", "display_name": "Hasit Mistry", "link": "https://stackoverflow.com/users/2128746/hasit-mistry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "accepted_answer_id": 29261635, "answer_count": 1, "score": 1, "last_activity_date": 1427314540, "creation_date": 1427278064, "question_id": 29252684, "link": "https://stackoverflow.com/questions/29252684/extracting-information-from-go-github-gist-type", "title": "Extracting information from go-github Gist type", "body": "<p>I have started learning Go and I find it quite interesting so far. As an assignment for myself to get get better at the language, I decided to write a Gister in Go using <a href=\"https://github.com/google/go-github\" rel=\"nofollow\">go-github</a>.</p>\n\n<p>I have been able to get all my Gists using an access token and I am able to print as follows:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"github.com/google/go-github/github\"\nimport \"code.google.com/p/goauth2/oauth\"\n\nfunc main() {\n    t := &amp;oauth.Transport{\n        Token: &amp;oauth.Token{AccessToken: \"secretaccesstokenhere\"},\n    }\n\n    client := github.NewClient(t.Client())\n\n    gists, _, err := client.Gists.List(\"\", nil)\n\n    if err != nil {\n        fmt.Println(err)\n    } else {\n        for _, g := range gists {\n            fmt.Printf(\"%v\\n\\n\", g.Files)\n        }\n    }\n}\n</code></pre>\n\n<p>And I get the following output:</p>\n\n<pre><code>map[TODO.md:github.GistFile{Size:166, Filename:\"TODO.md\", RawURL:\"somerawurlhere\"}]\n\nmap[fourcore.c:github.GistFile{Size:309, Filename:\"fourcore.c\", RawURL:\"somerawurlhere\"}]\n\nmap[coretest.cpp:github.GistFile{Size:160, Filename:\"coretest.cpp\", RawURL:\"somerawurlhere\"}]\n</code></pre>\n\n<p>What I would like to print is \"ID / FILENAME\". I understand that I need to extract the ID from Gist type and Filename from above map but I wasn't able to find a way to do that. How do I do that? Help would be greatly appreciated.</p>\n\n<p>P.S: <a href=\"http://godoc.org/github.com/google/go-github/github#Gist\" rel=\"nofollow\">Here</a> is the documentation describing Gist type.</p>\n"}, {"tags": ["url", "go"], "comments": [{"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "edited": false, "score": 0, "creation_date": 1427275790, "post_id": 29249900, "comment_id": 46707409, "body": "With &quot;an extra&quot;, do you mean you get <code>%2525</code> instead of expected <code>%25</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1427279363, "last_edit_date": 1427279363, "creation_date": 1427275651, "answer_id": 29251811, "question_id": 29249900, "link": "https://stackoverflow.com/questions/29249900/extra-escape-character-in-go-url/29251811#29251811", "title": "Extra escape character in go URL", "body": "<p>URLs may only contain characters of the ASCII character set, but it is often intended to include/transfer characters outside of this ASCII set. In such cases the URL has to be converted into a valid ASCII format.</p>\n\n<p>If the <em>raw</em> URL contains characters outside of the allowed set, they are escaped: they are replaced with a <code>'%'</code> followed by two hexadecimal digits. Therefore the character <code>'%'</code> is special and also has to be escaped (and its escaped form will start with <code>'%'</code> as well, and its hexadecimal code is <code>25</code>).</p>\n\n<p>Since your <em>raw</em> URL contains the character <code>'%'</code>, it will be replaced by <code>\"%25\"</code>.</p>\n\n<p>Back to your example: in the printed form you see <code>\"%2525\"</code>. You could ask why not just <code>\"%25\"</code>?</p>\n\n<p>This is because your original url contains a <code>'%'</code> in its <em>escaped</em> form which means its <em>raw</em> form contains the escape sequence <code>\"%25\"</code>. If you use/interpret this as <em>raw</em> input, the <code>'%'</code> will be replaced by <code>\"%25\"</code> which will be followed by the <code>\"25\"</code> from the input hence resulting in <code>\"%2525\"</code>.</p>\n\n<p>See: <a href=\"http://www.w3schools.com/tags/ref_urlencode.asp\" rel=\"nofollow\">HTML URL Encoding Reference</a></p>\n\n<p>Also: <a href=\"http://www.faqs.org/rfcs/rfc1738.html\" rel=\"nofollow\">RFC 1738 - Uniform Resource Locators (URL)</a></p>\n\n<p>And also: <a href=\"http://www.faqs.org/rfcs/rfc3986.html\" rel=\"nofollow\">RFC 3986 - Uniform Resource Identifier (URI): Generic Syntax</a></p>\n"}], "owner": {"reputation": 154, "user_id": 4476655, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-w1yQjZw-Hsk/AAAAAAAAAAI/AAAAAAAADGA/qpPQ9_ESvEU/photo.jpg?sz=128", "display_name": "Manik Taneja", "link": "https://stackoverflow.com/users/4476655/manik-taneja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2271, "favorite_count": 0, "accepted_answer_id": 29251811, "answer_count": 1, "score": 1, "last_activity_date": 1427279363, "creation_date": 1427269027, "last_edit_date": 1427269360, "question_id": 29249900, "link": "https://stackoverflow.com/questions/29249900/extra-escape-character-in-go-url", "title": "Extra escape character in go URL", "body": "<p>I have the following snippet of code :</p>\n\n<pre><code>    u := *baseURL\n    u.User = nil \n    if q := strings.Index(path, \"?\"); q &gt; 0 { \n            u.Path = path[:q]\n            u.RawQuery = path[q+1:]\n    } else {\n            u.Path = path\n    }   \n\n    log.Printf(\" url %v, u.String())\n</code></pre>\n\n<p>I see that when the baseurl is set to something like this <a href=\"http://localhost:9000/buckets/test%?bucket_uuid=7864b0dcdf0a578bd0012c70aef58aca\" rel=\"nofollow\">http://localhost:9000/buckets/test%?bucket_uuid=7864b0dcdf0a578bd0012c70aef58aca</a> the url package seems to add an extra escape character near the % sign. For e.g. the output of the above print statement is the following :</p>\n\n<pre><code>2015/03/25 12:02:49  url http://localhost:9000/pools/default/buckets/test%2525?bucket_uuid=7864b0dcdf0a578bd0012c70aef58aca\n</code></pre>\n\n<p>This seems to only happen when the RawQuery field of the URL is set. Any idea why this is happening ?  I'm using go version 1.3.3 </p>\n\n<p>Cheers,\nManik</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-storage"], "answers": [{"comments": [{"owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "edited": false, "score": 0, "creation_date": 1427267025, "post_id": 29248494, "comment_id": 46703126, "body": "I added this , Its not making the file public !"}, {"owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "edited": false, "score": 0, "creation_date": 1427269385, "post_id": 29248494, "comment_id": 46704174, "body": "Since setting ACL on <b><i>wc</i></b> object didnt work , so i decided to open an issue on the github repo of Google golang-gloud repo , please take a look at the conversation , here is the link of opened issue <a href=\"https://github.com/GoogleCloudPlatform/gcloud-golang/issues/122\" rel=\"nofollow noreferrer\">github.com/GoogleCloudPlatform/gcloud-golang/issues/122</a>"}], "tags": [], "owner": {"reputation": 32859, "user_id": 81491, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa2d855b58c41269f0876b99eac9607d?s=128&d=identicon&r=PG", "display_name": "Brandon Yarbrough", "link": "https://stackoverflow.com/users/81491/brandon-yarbrough"}, "is_accepted": false, "score": 4, "last_activity_date": 1427263276, "creation_date": 1427263276, "answer_id": 29248494, "question_id": 29247826, "link": "https://stackoverflow.com/questions/29247826/making-newly-created-file-public-on-google-cloud-storage-go-runtime-client-api/29248494#29248494", "title": "Making Newly created file public on Google Cloud Storage Go runtime Client API", "body": "<p>Try setting:</p>\n\n<pre><code>wc.ACL = []storage.ACLRule{{storage.AllUsers, storage.RoleReader}}\n</code></pre>\n\n<p>Alternately, you can also change the default object ACL on the bucket so that newly created objects default to being publicly readable.</p>\n"}, {"tags": [], "owner": {"reputation": 2133, "user_id": 7436566, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VxBgdn2E0Qk/AAAAAAAAAAI/AAAAAAAAAIg/H8mCkOR8q_k/photo.jpg?sz=128", "display_name": "OhhhThatVarun", "link": "https://stackoverflow.com/users/7436566/ohhhthatvarun"}, "is_accepted": false, "score": 0, "last_activity_date": 1571138430, "creation_date": 1571138430, "answer_id": 58393482, "question_id": 29247826, "link": "https://stackoverflow.com/questions/29247826/making-newly-created-file-public-on-google-cloud-storage-go-runtime-client-api/58393482#58393482", "title": "Making Newly created file public on Google Cloud Storage Go runtime Client API", "body": "<p>You can do the same by this also.</p>\n\n<pre><code>acl := client.Bucket(bucket).Object(object).ACL()\nif err := acl.Set(ctx, storage.AllUsers, storage.RoleReader); err != nil {\n        return err\n}\n</code></pre>\n\n<p><a href=\"https://cloud.google.com/storage/docs/access-control/making-data-public#storage-make-object-public-go\" rel=\"nofollow noreferrer\">Here</a> is the link to the docs.</p>\n"}], "owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1571138430, "creation_date": 1427259713, "question_id": 29247826, "link": "https://stackoverflow.com/questions/29247826/making-newly-created-file-public-on-google-cloud-storage-go-runtime-client-api", "title": "Making Newly created file public on Google Cloud Storage Go runtime Client API", "body": "<p>Im using Google Cloud Storage Go Runtime client API to write a string from GO server into a file in the default bucket . Here is the code </p>\n\n<pre><code>wc := storage.NewWriter(d.ctx, bucket, fileName)\nwc.ContentType = \"text/plain\"\nif _, err := wc.Write([]byte(myData)); err != nil {\n        d.errorf(\"createFile: unable to write data to bucket %q, file %q: %v\", bucket, fileName, err)\n        return\n}\n</code></pre>\n\n<p>But im Not able set right ACL permissions on the <strong><em>wc</em></strong> object to make the file public ?? How to do achieve it so that the created file becomes public ?</p>\n"}, {"tags": ["rest", "go", "sparkcore", "gobot.io"], "answers": [{"comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "reply_to_user": {"reputation": 24020, "user_id": 264802, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/9d9b871f40b338b97bfb44bdafa14a87?s=128&d=identicon&r=PG", "display_name": "fulvio", "link": "https://stackoverflow.com/users/264802/fulvio"}, "edited": false, "score": 1, "creation_date": 1427337367, "post_id": 29254679, "comment_id": 46741230, "body": "typo on my part, gbot.Start(), just add the word go in front of the line that is blocking... updating answer"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 2, "last_activity_date": 1427798544, "last_edit_date": 1427798544, "creation_date": 1427283736, "answer_id": 29254679, "question_id": 29247254, "link": "https://stackoverflow.com/questions/29247254/execute-sparkcore-function-using-gobot-io-and-sleepy-restful-framework-for-go/29254679#29254679", "title": "Execute SparkCore function using Gobot.io and sleepy RESTful Framework for Go", "body": "<p><code>gbot.Start()</code> is a blocking call.</p>\n\n<p>In this context, you are expected to call it as:</p>\n\n<pre><code>go gbot.Start() \n</code></pre>\n\n<p>This will launch it in a goroutine (think thread) and then let your app continue.</p>\n\n<p>When you look at the <a href=\"https://github.com/hybridgroup/gobot\" rel=\"nofollow\">gobot example app</a>, they don't run in the background since it is the main function. If main runs everything in the background and doesn't wait for anything, the app exits immediately with no apparent effect.</p>\n"}], "owner": {"reputation": 24020, "user_id": 264802, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/9d9b871f40b338b97bfb44bdafa14a87?s=128&d=identicon&r=PG", "display_name": "fulvio", "link": "https://stackoverflow.com/users/264802/fulvio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 29254679, "answer_count": 1, "score": 2, "last_activity_date": 1427798544, "creation_date": 1427256380, "question_id": 29247254, "link": "https://stackoverflow.com/questions/29247254/execute-sparkcore-function-using-gobot-io-and-sleepy-restful-framework-for-go", "title": "Execute SparkCore function using Gobot.io and sleepy RESTful Framework for Go", "body": "<p>I have the following bit of code where I'm using the RESTful framework for Go called <a href=\"https://github.com/dougblack/sleepy\" rel=\"nofollow\">sleepy</a>.</p>\n\n<p>I can successfully start the service at: <a href=\"http://localhost:3000\" rel=\"nofollow\">http://localhost:3000</a>, however when I try to access <a href=\"http://localhost:3000/temperature\" rel=\"nofollow\">http://localhost:3000/temperature</a> I'm expecting my <a href=\"http://docs.spark.io/api/#introduction-calling-a-function\" rel=\"nofollow\">SparkCore</a> function <code>dht</code> to execute.</p>\n\n<p>I'm using the <a href=\"http://gobot.io/documentation/platforms/spark/\" rel=\"nofollow\">Gobot.io Spark platform</a> to execute this function based on <a href=\"https://github.com/hybridgroup/gobot/blob/master/examples/spark_core_function.go\" rel=\"nofollow\">this example</a>, which I've implemented in my own code.</p>\n\n<p>The problem is that the code doesn't get past the <code>gobot.Start()</code> method inside the <code>Get()</code> function so I can't actually return the <code>result</code> data.</p>\n\n<p>I'm setting the <code>data</code> value hoping that I can do the:</p>\n\n<pre><code>return 200, data, http.Header{\"Content-type\": {\"application/json\"}}\n</code></pre>\n\n<p>But it never gets called becuase of the <code>gobot.Start()</code>.</p>\n\n<p>I'm very new to Go so any help would be greatly appreciated.</p>\n\n<pre><code>package main\n\nimport (\n    \"net/url\"\n    \"net/http\"\n    \"fmt\"\n    \"github.com/dougblack/sleepy\"\n    \"github.com/hybridgroup/gobot\"\n    \"github.com/hybridgroup/gobot/platforms/spark\"\n)\n\nvar gbot = gobot.NewGobot()\nvar sparkCore = spark.NewSparkCoreAdaptor(\"spark\", \"device_id\", \"auth_token\")\n\ntype Temperature struct {}\nfunc (temperature Temperature) Get(values url.Values, headers http.Header) (int, interface{}, http.Header) {\n    work := func() {\n        if result, err := sparkCore.Function(\"dht\", \"\"); err != nil {\n            fmt.Println(err)\n        } else {\n            data := map[string]string{\"Temperature\": result}\n            fmt.Println(\"result from \\\"dht\\\":\", result)\n        }\n    }\n\n    robot := gobot.NewRobot(\"spark\",\n        []gobot.Connection{sparkCore},\n        work,\n    )\n\n    gbot.AddRobot(robot)\n    gbot.Start()\n\n    return 200, data, http.Header{\"Content-type\": {\"application/json\"}}\n}\n\nfunc main() {\n    api := sleepy.NewAPI()\n\n    temperatureResource := new(Temperature)\n    api.AddResource(temperatureResource, \"/temperature\")\n\n    fmt.Println(\"Listening on http://localhost:3000/\")\n    api.Start(3000)\n}\n</code></pre>\n"}, {"tags": ["go", "cuda", "liteide"], "comments": [{"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1427275266, "post_id": 29247158, "comment_id": 46707094, "body": "Did you go get the cuda 5 library ?"}, {"owner": {"reputation": 863, "user_id": 1084853, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3f200f9430393e9ef8d94c4ef7ed5d73?s=128&d=identicon&r=PG", "display_name": "jpreed00", "link": "https://stackoverflow.com/users/1084853/jpreed00"}, "reply_to_user": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 1, "creation_date": 1427324968, "post_id": 29247158, "comment_id": 46737859, "body": "Of course.  I believe the error is the Go compiler having trouble finding the includes needed by the library."}, {"owner": {"reputation": 19654, "user_id": 92837, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1375f202e61682cc4963295f4b0430dc?s=128&d=identicon&r=PG", "display_name": "Sathyajith Bhat", "link": "https://stackoverflow.com/users/92837/sathyajith-bhat"}, "edited": false, "score": 0, "creation_date": 1427369574, "post_id": 29247158, "comment_id": 46752870, "body": "can you try <code>go get</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 863, "user_id": 1084853, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3f200f9430393e9ef8d94c4ef7ed5d73?s=128&d=identicon&r=PG", "display_name": "jpreed00", "link": "https://stackoverflow.com/users/1084853/jpreed00"}, "edited": false, "score": 0, "creation_date": 1427403895, "post_id": 29282855, "comment_id": 46774903, "body": "I will investigate this avenue and report back, thanks!"}], "tags": [], "owner": {"reputation": 116, "user_id": 1208122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406307eed77015484c1a86f2715954b9?s=128&d=identicon&r=PG", "display_name": "singron", "link": "https://stackoverflow.com/users/1208122/singron"}, "is_accepted": false, "score": 1, "last_activity_date": 1427384598, "creation_date": 1427384598, "answer_id": 29282855, "question_id": 29247158, "link": "https://stackoverflow.com/questions/29247158/how-do-you-add-an-include-directory-to-go-liteide/29282855#29282855", "title": "How do you add an include directory to Go/LiteIDE?", "body": "<p>It looks like your C compiler doesn't know what directory has the cuda header file. You can tell go to give the C compiler extra options using the <code>CGO_CPPFLAGS</code> environment variable. You probably want to set it to something like</p>\n\n<pre><code>CGO_CPPFLAGS=\"-isystem /path/to/dir/with/cuda/header/in/it\"\n</code></pre>\n\n<p>See <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow\">https://golang.org/cmd/cgo/</a></p>\n"}], "owner": {"reputation": 863, "user_id": 1084853, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3f200f9430393e9ef8d94c4ef7ed5d73?s=128&d=identicon&r=PG", "display_name": "jpreed00", "link": "https://stackoverflow.com/users/1084853/jpreed00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427384598, "creation_date": 1427255676, "last_edit_date": 1427337686, "question_id": 29247158, "link": "https://stackoverflow.com/questions/29247158/how-do-you-add-an-include-directory-to-go-liteide", "title": "How do you add an include directory to Go/LiteIDE?", "body": "<p>I'm attempting to use LiteIDE to run the program:</p>\n\n<pre><code>// cudatest\npackage cudatest\n\nimport (\n    \"fmt\"\n    \"github.com/barnex/cuda5/cu\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello, your GPU is:\", cu.Device(0).Name())\n}\n</code></pre>\n\n<p>All I get is:  </p>\n\n<pre><code>c:/go/bin/go.exe build -i [C:/godev]\n# github.com/barnex/cuda5/cu\nc:\\GoDev\\src\\github.com\\barnex\\cuda5\\cu\\context.go:5:18: fatal error: cuda.h: No such file or directory\n//#include &lt;cuda.h&gt;\n           ^\ncompilation terminated.\nError: process exited with code 2.\n</code></pre>\n\n<p>I have the latest CUDA SDK from NVIDIA installed.  What do I need to do in order to make the Go compiler see it?</p>\n"}, {"tags": ["unit-testing", "go", "mocking"], "comments": [{"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 1, "creation_date": 1427258649, "post_id": 29246249, "comment_id": 46700215, "body": "Why bother? I would think a unit test per method is more than enough. Think of a unit test on method &quot;Three&quot; like a mini integration test."}, {"owner": {"reputation": 5834, "user_id": 393109, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1b8c2e6df5cbbbe81e02be9537697305?s=128&d=identicon&r=PG", "display_name": "mohi666", "link": "https://stackoverflow.com/users/393109/mohi666"}, "reply_to_user": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1427270570, "post_id": 29246249, "comment_id": 46704712, "body": "That&#39;s exactly what I&#39;m trying to do. I want to mock all those calls, because I&#39;m only testing the functionality of a particular function. Function &quot;Three&quot; could be just any function here. It&#39;s not necessarily an integrated test."}, {"owner": {"reputation": 16853, "user_id": 4101725, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dGwoPMFb_tM/AAAAAAAAAAI/AAAAAAAABks/tMMqc6E9REg/photo.jpg?sz=128", "display_name": "Michele d&#39;Amico", "link": "https://stackoverflow.com/users/4101725/michele-damico"}, "edited": false, "score": 0, "creation_date": 1427272953, "post_id": 29246249, "comment_id": 46705846, "body": "Why <i>I don&#39;t want to use a third party mocking library</i>? <code>unittest.mock</code> was be a third party library till python3.2 and in python2.7 you need always install it by <code>pip</code>."}, {"owner": {"reputation": 22099, "user_id": 828366, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/V8V1N.jpg?s=128&g=1", "display_name": "Francesco Casula", "link": "https://stackoverflow.com/users/828366/francesco-casula"}, "edited": false, "score": 0, "creation_date": 1515680614, "post_id": 29246249, "comment_id": 83399358, "body": "Here&#39;s another approach with a full example that should make clear how it is possible to write testable code in Go: <a href=\"https://stackoverflow.com/a/48206430/828366\">stackoverflow.com/a/48206430/828366</a>"}, {"owner": {"reputation": 22099, "user_id": 828366, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/V8V1N.jpg?s=128&g=1", "display_name": "Francesco Casula", "link": "https://stackoverflow.com/users/828366/francesco-casula"}, "edited": false, "score": 0, "creation_date": 1515680697, "post_id": 29246249, "comment_id": 83399435, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19167970/mock-functions-in-go\">Mock functions in Go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 406, "user_id": 4571055, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NV49QeXoHLs/AAAAAAAAAAI/AAAAAAAAABE/JxgTVmq7aao/photo.jpg?sz=128", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/4571055/siddharth"}, "edited": false, "score": 0, "creation_date": 1583599403, "post_id": 29250254, "comment_id": 107174761, "body": "Assume <code>one</code> does a network call  in this case how do you write test for <code>two</code> ?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 406, "user_id": 4571055, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NV49QeXoHLs/AAAAAAAAAAI/AAAAAAAAABE/JxgTVmq7aao/photo.jpg?sz=128", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/4571055/siddharth"}, "edited": false, "score": 0, "creation_date": 1583604171, "post_id": 29250254, "comment_id": 107176206, "body": "@Siddhart Set up a test server with net/http/httptest.Server and let <code>one</code> do the &quot;network call&quot;. I know: Some school teach &quot;Unit-Test == does not access anything, no file system, no database, no network, no nothing&quot;. This is academic circlejerk and as such it is fine. In real life: How often do you run your unit tests on a system where no file system is available or you cannot call a local HTTP server?"}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 7, "last_activity_date": 1427270466, "creation_date": 1427270466, "answer_id": 29250254, "question_id": 29246249, "link": "https://stackoverflow.com/questions/29246249/mocking-receiver-functions-in-go/29250254#29250254", "title": "Mocking receiver functions in Go", "body": "<p>That is a really un-idiomatic way to test your stuff.\nAll this mocking might be needed in other languages, but\nplease don't do it in Go.</p>\n\n<p>The natural way to test your code in the example you gave\nwould be: 1) Write a table driven test for <code>MyStruct.one</code>\nand make sure you test all cases. Now that you know <code>one</code>\nworks perfectly fine 2) do the same with <code>MyStruct.two</code>.\nNote that testing unexported stuff is possible, useful and\ncommon in Go. Now there is no longer a need need to mock\nsome methods, just 3) write some table driven test for \n<code>MyStruct.Three</code> and check it works.</p>\n\n<p>But maybe your methods <code>one</code> and <code>two</code> do fancier stuff, and\naccess the environment (filesystem, database, network) and\nyou do not want your tests of  <code>Three</code> to depend on that?\nSo refactor your code! Maybe <code>Three</code> should not be a method\nof  <code>MyStruct</code> but a function which takes an <code>interface OneAndTwoer</code>\nas an argument and your production code calls <code>Three</code> with \"real\"\nMyStructs while your testcode calls it with InMemoryMyStrcuts\nwhich do not depend on the environment?  You could call it a\nmock, I'd call it a different implementation of an interface.</p>\n\n<p>In your example it is simple to give advice: Use table driven \ntests for <code>one</code>, <code>two</code> and <code>Three</code> and do not mock.\nFor a more realistic problem the advice might be different but\nit is hard to give a general advice without knowing the \ncircumstances. Best general advice is: Take a look at the test in\nthe standard library where you'll find useful patterns for almost\nevery testing scenario.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 2587752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15a45facbc2e7fb28e875492612e2b50?s=128&d=identicon&r=PG", "display_name": "codermomo", "link": "https://stackoverflow.com/users/2587752/codermomo"}, "is_accepted": false, "score": 0, "last_activity_date": 1571862710, "creation_date": 1571862710, "answer_id": 58530590, "question_id": 29246249, "link": "https://stackoverflow.com/questions/29246249/mocking-receiver-functions-in-go/58530590#58530590", "title": "Mocking receiver functions in Go", "body": "<p>You can do a refactor to pass two as a func in <code>Three</code>, so that you can directly mock the input.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n    var ms MyStruct\n    fmt.Println(ms.one())\n    fmt.Println(ms.two())\n    fmt.Println(ms.Three(ms.two))\n}\n\ntype MyStruct struct {}\n\nfunc (m *MyStruct) one() int {\n    return 2\n}\n\nfunc (m *MyStruct) two() int {\n    return m.one() * 2\n}\n\nfunc (m *MyStruct) Three(two func() int) int {\n    return two() * 2\n}\n</code></pre>\n"}], "owner": {"reputation": 5834, "user_id": 393109, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/1b8c2e6df5cbbbe81e02be9537697305?s=128&d=identicon&r=PG", "display_name": "mohi666", "link": "https://stackoverflow.com/users/393109/mohi666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2178, "favorite_count": 0, "accepted_answer_id": 29250254, "answer_count": 2, "score": 4, "last_activity_date": 1571862710, "creation_date": 1427249207, "last_edit_date": 1495540745, "question_id": 29246249, "link": "https://stackoverflow.com/questions/29246249/mocking-receiver-functions-in-go", "title": "Mocking receiver functions in Go", "body": "<p>I'm trying to unit test a receiver function that calls other receiver functions in that struct.</p>\n\n<p>Let's say I want to test Three() and mock the call to two() in the following:</p>\n\n<pre><code>type MyStruct struct {\n    a string\n    b string\n}\n\nfunc (m *MyStruct) one() int {\n    return 2\n}\n\nfunc (m *MyStruct) two() int {\n    return m.one() * 2\n}\n\nfunc (m *MyStruct) Three() int {\n    return m.two() * 2\n}\n</code></pre>\n\n<p>I was following method two of the following <a href=\"https://stackoverflow.com/a/19168875/393109\">answer</a>.</p>\n\n<p>I created a custom constructor for every single function that I wanted to unit test and overrode those methods with mocked versions. But I thought it may not be easy to maintain the code once the number of functions grow.</p>\n\n<p>Is there any preferred way of mocking such functions? I wish the official documentation had some guidelines on how to mock things in different scenarios, similar to what mox on Python provides.</p>\n\n<p>Also, note that I don't want to use a third party mocking library.</p>\n"}, {"tags": ["go", "callstack", "continuations", "go-toolchain"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1427244072, "post_id": 29245296, "comment_id": 46696669, "body": "Not directly. Since it&#39;s an interpreter you&#39;re writing, there might be some way to in effect create a continuation by blocking the running goroutine on a channel read (the channel is your continuation object), then resuming it by sending to that channel. I don&#39;t know enough about the Scheme side of things to confidently sketch out more of what that would look like, though."}, {"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1427244236, "post_id": 29245296, "comment_id": 46696709, "body": "@twotwotwo: Thanks for the tip! I was thinking there might be a way to do it with goroutines, but I couldn&#39;t figure out how. Your suggestion just might work."}, {"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1427244359, "post_id": 29245296, "comment_id": 46696738, "body": "@twotwotwo: On second thought, it probably won&#39;t work because there would be no way to resume the same continuation more than once. Is there a way to copy goroutines?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1427244797, "post_id": 29245296, "comment_id": 46696882, "body": "Ah, fascinating. No, I didn&#39;t know you could copy a continuation, resume both copies, and have them both start from the same point. You can copy a channel, and if the goroutine blocks on reading from it again you can send to it again, but it&#39;ll resume from the new state, not the old."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1427245589, "post_id": 29245296, "comment_id": 46697086, "body": "All I can see to get those exact semantics is going all the way to the lowest level and having your own little bytecode interpreter working with stacks of []interface{}s -- obviously a way harder type of project."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1427245640, "post_id": 29245296, "comment_id": 46697098, "body": "There are some alleged lisps/schemes listed at <a href=\"http://go-lang.cat-v.org/go-code\" rel=\"nofollow noreferrer\">go-lang.cat-v.org/go-code</a> -- could see if any of them have continuations that can resume from the same place more than once, and how they do it if so."}, {"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1427249588, "post_id": 29245296, "comment_id": 46697975, "body": "@twotwotwo: One thing I could do is refactor the <code>eval</code> function to use its own stack-like structure and loop instead of recursion, but I asked this question to see if there is a way to copy the actual Go callstack. Another method to work around this problem would be <a href=\"https://en.wikipedia.org/wiki/Trampoline_(computing)\" rel=\"nofollow noreferrer\">trampolining</a>, but I would like to avoid it."}], "owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1430814139, "creation_date": 1427242360, "last_edit_date": 1430814139, "question_id": 29245296, "link": "https://stackoverflow.com/questions/29245296/is-there-a-way-to-copy-and-restore-the-callstack-in-a-go-program", "title": "Is there a way to copy and restore the callstack in a Go program?", "body": "<p>I am trying to implement continuations with unlimited extent in a Go program (for those curious, I am writing a scheme interpreter). One way to do this is to copy the callstack to the heap so that it can be restored later. Go's garbage collector still needs to know about all the pointers in the copy of the stack. Is there a way to do this in a Go program? Note that I am willing to write code in C or assembly, compatibly with the Go toolchain, if need be.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "edited": false, "score": 0, "creation_date": 1427242255, "post_id": 29244881, "comment_id": 46696131, "body": "Any more details about the error? Line number/any additional trace?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1427243600, "post_id": 29244881, "comment_id": 46696541, "body": "The <code>go list</code> command is a wrapper around the <a href=\"http://godoc.org/go/build\" rel=\"nofollow noreferrer\">go/build</a> package. I suggest calling <code>build.DefaultContext.Import(path, &quot;&quot;, 0)</code> from your application to get the imports instead of exec&#39;ing the <code>go list</code> command."}, {"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "reply_to_user": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "edited": false, "score": 0, "creation_date": 1427244531, "post_id": 29244881, "comment_id": 46696794, "body": "@Momer it doesn&#39;t give a line number, nor a trace. Is there a way to create a trace?"}, {"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1427244629, "post_id": 29244881, "comment_id": 46696819, "body": "@thundercat I wanted the json output of the go list command. Can you suggest how I can turn the out out of go build into json?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1427249580, "post_id": 29244881, "comment_id": 46697968, "body": "Here&#39;s how to encode the imports for package with given path as JSON: <code>p, err := build.DefaultContext.Import(path, &quot;&quot;, 0);  jsonBytes, err := json.Marshal(p.Imports)</code>  The general strategy is to build up a Go value that corresponds to the JSON value you want and then call json.Marshal(v)."}, {"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1427250665, "post_id": 29244881, "comment_id": 46698229, "body": "Thanks, I&#39;m going to play with it. Would you recommend that I create some type of struct with embedded slices to hold values as I recurse through the dependency tree? And then convert all to json at end in one go? If so, I&#39;m not sure what the fields on struct would look like"}, {"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1427252592, "post_id": 29244881, "comment_id": 46698696, "body": "@ThunderCat thank you go rumour help. can you point out where go list I command is defined? I want yo see how it wraps go build, will try yo use that"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1427255989, "post_id": 29244881, "comment_id": 46699464, "body": "The JSON is generated <a href=\"https://github.com/golang/go/blob/2420926a8a38eef9131a4c3543987b92667204c1/src/cmd/go/list.go#L135\" rel=\"nofollow noreferrer\">here</a>. If you dig through the layers of functions called, you will find that the build *Package object is created <a href=\"https://github.com/golang/go/blob/2420926a8a38eef9131a4c3543987b92667204c1/src/cmd/go/pkg.go#L267\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 3609, "user_id": 2148827, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZaNTL.png?s=128&g=1", "display_name": "Prasanth Jaya", "link": "https://stackoverflow.com/users/2148827/prasanth-jaya"}, "edited": false, "score": 0, "creation_date": 1510305784, "post_id": 29244881, "comment_id": 81388146, "body": "Somewhere you will have <code>,,</code> or you might have <code>,</code> at end of your json"}, {"owner": {"reputation": 351, "user_id": 6150881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a42d9d73c727b1b482f4e215ac1b663?s=128&d=identicon&r=PG&f=1", "display_name": "Rabhi salim", "link": "https://stackoverflow.com/users/6150881/rabhi-salim"}, "edited": false, "score": 0, "creation_date": 1580745652, "post_id": 29244881, "comment_id": 106189445, "body": "I had the same problem, and fixed it using this: <a href=\"https://stackoverflow.com/a/60042738/6150881\">stackoverflow.com/a/60042738/6150881</a> Hope it helps!"}, {"owner": {"reputation": 351, "user_id": 6150881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a42d9d73c727b1b482f4e215ac1b663?s=128&d=identicon&r=PG&f=1", "display_name": "Rabhi salim", "link": "https://stackoverflow.com/users/6150881/rabhi-salim"}, "edited": false, "score": 0, "creation_date": 1580745758, "post_id": 29244881, "comment_id": 106189507, "body": "In my case I fixed it using : <a href=\"https://stackoverflow.com/a/60042738/6150881\">stackoverflow.com/a/60042738/6150881</a> Hope it helps!"}], "answers": [{"comments": [{"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1427244726, "post_id": 29245641, "comment_id": 46696856, "body": "I wanted the json output of go list -json, otherwise I&#39;d have to build json manually and I&#39;m not sure how to do that in go (this is my first go project)"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1427245500, "post_id": 29245641, "comment_id": 46697061, "body": "@Leahcim Investigated a litter further and found the problem. I&#39;ll leave the rest of the answer here for you since it should help you realize how you can find this things yourself."}, {"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1427245519, "post_id": 29245641, "comment_id": 46697069, "body": "That&#39;s very interesting (how you found the problem) but I&#39;m not entirely sure I understand which characte it&#39;s objecting to. Json.Compact was supposed to remove the \\n and \\t characters, are they the problem? I&#39;ll try your cod on my computer"}, {"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1427246104, "post_id": 29245641, "comment_id": 46697214, "body": "Ok that error is gone but now I have a new similar  type of error with: invalid character &#39;{&#39;&#39; after array element. Did you get that too?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1427246279, "post_id": 29245641, "comment_id": 46697264, "body": "@Leahcim start by checking <i>every</i> error return from each <code>json.*</code> call you&#39;re making instead of ignoring them like you do in the <code>imports</code> method."}, {"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1427246684, "post_id": 29245641, "comment_id": 46697367, "body": "You removed the part of code from your answer where you &#39;continue&#39; if the length of t.J is zero, can you please put it back. I think I had copied it incorrectly, hence my subsequent error. Btw, learned a lot from your answer thank you"}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 13, "last_activity_date": 1427246159, "last_edit_date": 1427246159, "creation_date": 1427244522, "answer_id": 29245641, "question_id": 29244881, "link": "https://stackoverflow.com/questions/29244881/how-to-find-invalid-character-looking-for-beginning-of-value-error-messag/29245641#29245641", "title": "how to find, &quot;invalid character &#39;,&#39; looking for beginning of value&quot; error message", "body": "<p>First, as has been commented, are you sure you can't use\nthe <code>go/build</code> package directly rather than running <code>go list</code>?</p>\n\n<p>I Wouldn't use <code>println</code> (or <code>fmt.Println</code>) inside HTTP handlers. It's much better to use <code>log.Println</code> and/or get the error into the <code>ResponseWriter</code>. Also, it's a good idea to wrap your <code>ListenAndServe</code> call with <code>log.Fatal</code>.</p>\n\n<p>When printing/logging <code>error</code> values you can just use <code>err</code>, no need to have <code>err.Error()</code>.</p>\n\n<p>Further, when you actually want to do something more detailed than just reporting/logging the error message you can look at it's type and other info. For example, <code>log.Printf(\"verbose error info: %#v\", err)</code> gives:</p>\n\n<pre><code>&amp;json.SyntaxError{msg:\"invalid character ',' looking for beginning of value\", Offset:0}\n</code></pre>\n\n<p>I tried this because I know the <code>json</code> package returns various error types with additional info and I was hoping the offset value would be of help. If it had been then something like this might have been helpful:</p>\n\n<pre><code>if err := json.Compact(\u2026) {\n    if err != nil {\n        log.Println(\"json.Compact:\", err)\n        if serr, ok := err.(*json.SyntaxError); ok {\n            log.Println(\"Occurred at offset:\", serr.Offset)\n            // \u2026 something to show the data in buff around that offset \u2026\n        }\n    }\n}\n</code></pre>\n\n<p>But offset zero isn't helpful :(</p>\n\n<p>So although this doesn't identify you problem hopefully\nit can be of some help to your further investigation.</p>\n\n<p>Edit:</p>\n\n<p>So after adding:</p>\n\n<pre><code>log.Println(\"Write file:\", ioutil.WriteFile(\"data.json\", buff.Bytes(), 0600))\n</code></pre>\n\n<p>to the above error handling block I then ran a JSON validator on the resultant file and it identified this piece:</p>\n\n<pre><code>        \"XTestImports\": [\n                \"io\",\n                \"log\",\n                \"net\"\n        ]\n},,{\n        \"Dir\": \"/usr/local/go/src/mime\",\n        \"ImportPath\": \"mime\",\n        \"Name\": \"mime\",\n</code></pre>\n\n<p>Note the double <code>,,</code>.</p>\n\n<p>That should tell you whete the error in your code is.\nBut if not, you need to skip empty entries, either when processing <code>t.J</code> or when you build it. The later is better and just involves:</p>\n\n<pre><code>    if len(newj) &gt; 0 {\n        myObj.J = append(myObj.J, newj)\n    }\n</code></pre>\n\n<p>(where btw you don't check for errors from <code>json.Unmarshal</code> so it's not clear if that is supposed to ever be empty or if it's empty due to a preceeding error. <strong>Never</strong> ignore error returns!)</p>\n"}, {"tags": [], "owner": {"reputation": 7972, "user_id": 101827, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/R2AOA.png?s=128&g=1", "display_name": "Mike Atlas", "link": "https://stackoverflow.com/users/101827/mike-atlas"}, "is_accepted": false, "score": 4, "last_activity_date": 1464385834, "creation_date": 1464385834, "answer_id": 37492750, "question_id": 29244881, "link": "https://stackoverflow.com/questions/29244881/how-to-find-invalid-character-looking-for-beginning-of-value-error-messag/37492750#37492750", "title": "how to find, &quot;invalid character &#39;,&#39; looking for beginning of value&quot; error message", "body": "<p>I also encountered the same error message in a Go program, but the error message was within the HTTP response error, in HTML format when my HTTP response parser expected JSON. </p>\n\n<p>For me, the solution was to change my request to include setting the <code>Content-Type</code> header to <code>application/json</code>. How you do this depends on which http client library you happen to be using; if you have access to the <code>http.Header</code> core type, you can set the header with <code>.Set(...)</code>. </p>\n\n<p>I realize the scope of this fix for me may not apply to the original question, but I came here first after googling and thought this would help others, since the message was not particularly obvious at first glance. The hint is that the invalid <code>&lt;</code> character is the first HTML character in the error/response, which is likely the result of the request type not being set to <code>application/json</code>, thus the server responds with a non JSON response.</p>\n"}, {"tags": [], "owner": {"reputation": 135, "user_id": 6319187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4be37c8c89518a3f301810d1b521f083?s=128&d=identicon&r=PG&f=1", "display_name": "SharadG", "link": "https://stackoverflow.com/users/6319187/sharadg"}, "is_accepted": false, "score": 3, "last_activity_date": 1607957246, "last_edit_date": 1607957246, "creation_date": 1547814243, "answer_id": 54253975, "question_id": 29244881, "link": "https://stackoverflow.com/questions/29244881/how-to-find-invalid-character-looking-for-beginning-of-value-error-messag/54253975#54253975", "title": "how to find, &quot;invalid character &#39;,&#39; looking for beginning of value&quot; error message", "body": "<p>For me the issue was I was trying to parse the already parsed JSON.</p>\n"}, {"tags": [], "owner": {"reputation": 10444, "user_id": 127434, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f97fc5991564e09a8d1131800debdd67?s=128&d=identicon&r=PG&f=1", "display_name": "cja", "link": "https://stackoverflow.com/users/127434/cja"}, "is_accepted": false, "score": 1, "last_activity_date": 1551356757, "creation_date": 1551356757, "answer_id": 54925714, "question_id": 29244881, "link": "https://stackoverflow.com/questions/29244881/how-to-find-invalid-character-looking-for-beginning-of-value-error-messag/54925714#54925714", "title": "how to find, &quot;invalid character &#39;,&#39; looking for beginning of value&quot; error message", "body": "<p>And in case someone has the same problem as me, I needed to call JSON.stringify on my post data.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 2617984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57531308f95225998c0978a519bd1a86?s=128&d=identicon&r=PG", "display_name": "Toasts", "link": "https://stackoverflow.com/users/2617984/toasts"}, "reply_to_user": {"reputation": 5883, "user_id": 5411888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vLbdS.jpg?s=128&g=1", "display_name": "Amit Upadhyay", "link": "https://stackoverflow.com/users/5411888/amit-upadhyay"}, "edited": false, "score": 0, "creation_date": 1571299428, "post_id": 56446327, "comment_id": 103196592, "body": "@AmitUpadhyay I resolved it by expecting BSON instead of JSON and using bson.Unmarshal instead of json.Unmarshal. Once i debugged the byte array it made sense json was not able to parse because in it was something like {&quot;date&quot;: ISODate(&quot;2010-01-01T00:00:00.000Z&quot;)}"}], "tags": [], "owner": {"reputation": 1, "user_id": 2617984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57531308f95225998c0978a519bd1a86?s=128&d=identicon&r=PG", "display_name": "Toasts", "link": "https://stackoverflow.com/users/2617984/toasts"}, "is_accepted": false, "score": 0, "last_activity_date": 1559659815, "creation_date": 1559659815, "answer_id": 56446327, "question_id": 29244881, "link": "https://stackoverflow.com/questions/29244881/how-to-find-invalid-character-looking-for-beginning-of-value-error-messag/56446327#56446327", "title": "how to find, &quot;invalid character &#39;,&#39; looking for beginning of value&quot; error message", "body": "<p>I encountered a similar problem with my error message being: </p>\n\n<blockquote>\n  <p>invalid character 'I' looking for beginning of value</p>\n</blockquote>\n\n<p>In my case, i was trying to decode <code>BSON</code> using <code>json.Unmarshal</code>. Json doesn't recognize the <code>ISODate</code> type, which caused this error.</p>\n"}, {"tags": [], "owner": {"reputation": 351, "user_id": 6150881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a42d9d73c727b1b482f4e215ac1b663?s=128&d=identicon&r=PG&f=1", "display_name": "Rabhi salim", "link": "https://stackoverflow.com/users/6150881/rabhi-salim"}, "is_accepted": false, "score": 1, "last_activity_date": 1580748055, "last_edit_date": 1580748055, "creation_date": 1580746078, "answer_id": 60042980, "question_id": 29244881, "link": "https://stackoverflow.com/questions/29244881/how-to-find-invalid-character-looking-for-beginning-of-value-error-messag/60042980#60042980", "title": "how to find, &quot;invalid character &#39;,&#39; looking for beginning of value&quot; error message", "body": "<p>Reason for this eerie error message is : </p>\n\n<pre><code>// When unmarshaling quoted strings, invalid UTF-8 or\n// invalid UTF-16 surrogate pairs are not treated as an error.\n// Instead, they are replaced by the Unicode replacement\n// character U+FFFD.\n</code></pre>\n\n<p><a href=\"https://golang.org/src/encoding/json/decode.go\" rel=\"nofollow noreferrer\">https://golang.org/src/encoding/json/decode.go</a></p>\n\n<p>In my case I saved my json as string then parsed it by :\n<code>stringData = JSON.parse(myJsonString)</code></p>\n\n<p>I also had the same error another time using gin-context-ShouldBind() (<a href=\"https://godoc.org/github.com/gin-gonic/gin#Context.ShouldBind\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/gin-gonic/gin#Context.ShouldBind</a>) and mapping my json to go object:\nerror was because it needs a json as string, so I used : JSON.stringify(jsonObject) when sending my request from front-end part.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13055269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8db1c42ddbc700c0208cce8936567c0d?s=128&d=identicon&r=PG&f=1", "display_name": "Shiaondo_Orkuma", "link": "https://stackoverflow.com/users/13055269/shiaondo-orkuma"}, "is_accepted": false, "score": 0, "last_activity_date": 1607957240, "last_edit_date": 1607957240, "creation_date": 1607956741, "answer_id": 65290923, "question_id": 29244881, "link": "https://stackoverflow.com/questions/29244881/how-to-find-invalid-character-looking-for-beginning-of-value-error-messag/65290923#65290923", "title": "how to find, &quot;invalid character &#39;,&#39; looking for beginning of value&quot; error message", "body": "<p>I had a similar issue. For me I omitted the first letter of my authorization token. So instead of</p>\n<pre><code>&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InJhcGhhZWxuZ0BlbWFpbC5jb20iLCJleHAiOjE2MTM5NTQzMjB9.yPGC937VNAF8Qg05Z1x3fZ3zu_MUs-cA_Iag5-4RcJE&quot;\n</code></pre>\n<p>I used this</p>\n<pre><code>&quot;yJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InJhcGhhZWxuZ0BlbWFpbC5jb20iLCJleHAiOjE2MTM5NTQzMjB9.yPGC937VNAF8Qg05Z1x3fZ3zu_MUs-cA_Iag5-4RcJE&quot;\n</code></pre>\n"}], "owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96688, "favorite_count": 4, "accepted_answer_id": 29245641, "answer_count": 7, "score": 12, "last_activity_date": 1608564545, "creation_date": 1427240187, "last_edit_date": 1501693566, "question_id": 29244881, "link": "https://stackoverflow.com/questions/29244881/how-to-find-invalid-character-looking-for-beginning-of-value-error-messag", "title": "how to find, &quot;invalid character &#39;,&#39; looking for beginning of value&quot; error message", "body": "<p>I have a short Go program that runs the <code>go list -json</code> command for several packages, stores the output of each run of the command in a json.RawMessage, appends each json.RawMessage into a slice of json.RawMessages, and then returns the result to the server after concatenating each of the json.RawMessages together and compacting the json. However, there is an error message that gets produced when I run <code>json.Compact</code> that I can't locate the source of. Googling this error message reveals that most people who seem to encounter it--whether it's for an invalid <code>,</code> or some other character--have a hard time finding the source of it.</p>\n\n<pre><code>invalid character ',' looking for beginning of value\n</code></pre>\n\n<p>The code with comments is available to view here <a href=\"https://play.golang.org/p/ghVvuSYhpg\" rel=\"noreferrer\">on play.golang.org</a> (although it won't run there) and also below. </p>\n\n<p>Question: can you explain the source of this error and how to prevent it?</p>\n\n<p>(Note, some of the packages were included just for testing purposes)</p>\n\n<pre><code>package main\n\nimport (\n    \"expvar\"\n\n    \"encoding/json\"\n\n    \"bytes\"\n    \"fmt\"\n    \"github.com/go-martini/martini\"\n    \"github.com/zenazn/goji\"\n    \"github.com/zenazn/goji/web\"\n    \"go/build\"\n    \"log\"\n    \"math/rand\"\n    \"net/http\"\n    _ \"net/http/pprof\"\n    \"os/exec\"\n)\n\ntype myType struct {\n    J []json.RawMessage\n}\n\nvar pack map[string]string\n\ntype GoList struct {\n    Imports []string\n}\n\ntype Import struct {\n    Dir        string\n    ImportPath string\n    Name       string\n    Target     string\n    Standard   bool\n    Root       string\n    GoFiles    []string\n    Imports    []string\n    Deps       []string\n}\n\nconst contentTypeJSON = \"application/json\"\n\nfunc main() {\n\n    http.HandleFunc(\"/importgraph\", func(w http.ResponseWriter, r *http.Request) { importGraph(w, r) })\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"Inside handler\")\n    fmt.Fprintf(w, \"Hello world from my Go program!\")\n}\n\nfunc importGraph(w http.ResponseWriter, r *http.Request) {\n\n    pack = make(map[string]string)\n\n    var t myType\n    cmd := exec.Command(\"go\", \"list\", \"-json\")\n    stdout, err := cmd.Output()\n    if err != nil {\n\n        println(err.Error())\n        return\n    }\n\n    var list GoList\n    err = json.Unmarshal(stdout, &amp;list)\n\n    for _, d := range list.Imports {\n        //get the imports for each of the packages listed by go list -json\n        t.imports(d)\n\n    }\n\n    var buff bytes.Buffer\n\n    //concatenate the separate json.RawMessages together into json\n\n    buff.WriteByte('[')\n\n    for i, j := range t.J {\n\n        if i != 0 {\n            buff.WriteByte(',')\n        }\n        buff.Write([]byte(j))\n    }\n    buff.WriteByte(']')\n\n    var buffer bytes.Buffer\n    if err := json.Compact(&amp;buffer, buff.Bytes()); err != nil {\n        println(err.Error()) //error message: invalid character ',' looking for beginning of value\n        return\n\n    }\n\n    w.Header().Set(\"Content-Type\", contentTypeJSON)\n\n    w.Write(buffer.Bytes())\n\n}\n\nfunc (myObj *myType) imports(pk string) error {\n\n    cmd := exec.Command(\"go\", \"list\", \"-json\", pk)\n    stdout, _ := cmd.Output()\n\n    pack[pk] = pk\n\n    var deplist Import\n    json.Unmarshal(stdout, &amp;deplist)\n\n    var newj json.RawMessage\n    json.Unmarshal(stdout, &amp;newj)\n    myObj.J = append(myObj.J, newj)\n\n    for _, imp := range deplist.Imports {\n\n        if _, ok := pack[imp]; !ok {\n\n            myObj.imports(imp) //recursive call to get the imports of the imports etc\n\n        }\n    }\n\n    return nil\n\n}\n</code></pre>\n"}, {"tags": ["go", "nsq"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1427232689, "post_id": 29243277, "comment_id": 46692508, "body": "what are you using for GOMAXPROCS?"}, {"owner": {"reputation": 336, "user_id": 958129, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dbe453acf80dbfda1fc2bd425f63310?s=128&d=identicon&r=PG", "display_name": "Walter Cecil Worsley IV", "link": "https://stackoverflow.com/users/958129/walter-cecil-worsley-iv"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1427233461, "post_id": 29243277, "comment_id": 46692844, "body": "You mean the int I give as the second param in AddConcurrentHandlers? Its required by the api, probably to prevent an infinite number of routines"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1427233830, "post_id": 29243277, "comment_id": 46693019, "body": "No, JimB asked about your environment variable GOMAXPROCS. Unset or too low won&#39;t use all cores. Try setting it to 2, 4, 8 and 12 and observe your application."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1427233930, "post_id": 29243277, "comment_id": 46693074, "body": "@cworsley4: GOMAXPROCS sets the maximum number of active threads running goroutines in your application."}, {"owner": {"reputation": 336, "user_id": 958129, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dbe453acf80dbfda1fc2bd425f63310?s=128&d=identicon&r=PG", "display_name": "Walter Cecil Worsley IV", "link": "https://stackoverflow.com/users/958129/walter-cecil-worsley-iv"}, "edited": false, "score": 0, "creation_date": 1427234328, "post_id": 29243277, "comment_id": 46693264, "body": "Yeah I&#39;m a real noob. I hadn&#39;t set that env var so it maxes out at 6 right? I upped it to 70 and I&#39;m seeing the same issue."}, {"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "edited": false, "score": 1, "creation_date": 1427235628, "post_id": 29243277, "comment_id": 46693814, "body": "Well, setting <code>n</code> to some random high number just isn&#39;t the best solution with most things <code>n</code>. More info on GOMAXPROCS at the summary of <a href=\"http://golang.org/pkg/runtime/\" rel=\"nofollow noreferrer\">golang.org/pkg/runtime</a> and <a href=\"http://golang.org/pkg/runtime/#GOMAXPROCS\" rel=\"nofollow noreferrer\">golang.org/pkg/runtime/#GOMAXPROCS</a> . It looks like you&#39;re using the <a href=\"https://github.com/bitly/go-nsq\" rel=\"nofollow noreferrer\">go-nsq</a> package; in which case, you might not be using it correctly per the <a href=\"https://github.com/bitly/go-nsq/blob/master/UPGRADING.md#improving-the-nsqhandler-interface\" rel=\"nofollow noreferrer\">examples I just looked at</a>"}, {"owner": {"reputation": 336, "user_id": 958129, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dbe453acf80dbfda1fc2bd425f63310?s=128&d=identicon&r=PG", "display_name": "Walter Cecil Worsley IV", "link": "https://stackoverflow.com/users/958129/walter-cecil-worsley-iv"}, "reply_to_user": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "edited": false, "score": 0, "creation_date": 1427239296, "post_id": 29243277, "comment_id": 46695199, "body": "I believe you are correct @Momer. So I added inflight to my NSQ config and set to 1000 (from the example). That fixed the issue. Do you have any insight into why that makes a difference?"}, {"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "edited": false, "score": 0, "creation_date": 1427241163, "post_id": 29243277, "comment_id": 46695781, "body": "I&#39;m not familiar with the project, but it seems that MaxInFlight would be the max number of messages in flight at any given time over all consumers. It defaults to 1, so that could be your resolution: <a href=\"https://github.com/bitly/go-nsq/blob/edb565821d2ffe9b8927d2c4a6cc8437c476ccc8/config.go#L172-L173\" rel=\"nofollow noreferrer\">github.com/bitly/go-nsq/blob/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 336, "user_id": 958129, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dbe453acf80dbfda1fc2bd425f63310?s=128&d=identicon&r=PG", "display_name": "Walter Cecil Worsley IV", "link": "https://stackoverflow.com/users/958129/walter-cecil-worsley-iv"}, "edited": false, "score": 0, "creation_date": 1427241701, "post_id": 29245114, "comment_id": 46695928, "body": "Thank you again! Great answer!"}, {"owner": {"reputation": 336, "user_id": 958129, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dbe453acf80dbfda1fc2bd425f63310?s=128&d=identicon&r=PG", "display_name": "Walter Cecil Worsley IV", "link": "https://stackoverflow.com/users/958129/walter-cecil-worsley-iv"}, "edited": false, "score": 0, "creation_date": 1427241737, "post_id": 29245114, "comment_id": 46695938, "body": "There should absolutely be more clear documentation around this."}, {"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "reply_to_user": {"reputation": 336, "user_id": 958129, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dbe453acf80dbfda1fc2bd425f63310?s=128&d=identicon&r=PG", "display_name": "Walter Cecil Worsley IV", "link": "https://stackoverflow.com/users/958129/walter-cecil-worsley-iv"}, "edited": false, "score": 0, "creation_date": 1427242069, "post_id": 29245114, "comment_id": 46696063, "body": "Make a PR, I&#39;m sure they&#39;ll accept some enhancements to the docs!"}, {"owner": {"reputation": 336, "user_id": 958129, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dbe453acf80dbfda1fc2bd425f63310?s=128&d=identicon&r=PG", "display_name": "Walter Cecil Worsley IV", "link": "https://stackoverflow.com/users/958129/walter-cecil-worsley-iv"}, "edited": false, "score": 0, "creation_date": 1427242210, "post_id": 29245114, "comment_id": 46696110, "body": "Interesting point; I created the same server in Node without specifying a MaxInFlight option and it was able to keep up. And the Node module I used (nsq.js) defaults to 1. Strange"}, {"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "reply_to_user": {"reputation": 336, "user_id": 958129, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dbe453acf80dbfda1fc2bd425f63310?s=128&d=identicon&r=PG", "display_name": "Walter Cecil Worsley IV", "link": "https://stackoverflow.com/users/958129/walter-cecil-worsley-iv"}, "edited": false, "score": 0, "creation_date": 1427242787, "post_id": 29245114, "comment_id": 46696305, "body": "Well, interestingly enough, the <code>reader.js</code> in the js module for nsq has a default of <code>10</code> which overrides the <code>connection.js</code> of <code>1</code>. More info @ <a href=\"https://github.com/segmentio/nsq.js/blob/badb32bb2310084decec05f1cf85c49c70517ec9/lib/reader.js#L60\" rel=\"nofollow noreferrer\">github.com/segmentio/nsq.js/blob/&hellip;</a> and <a href=\"https://github.com/segmentio/nsq.js/blob/badb32bb2310084decec05f1cf85c49c70517ec9/lib/connection.js#L50\" rel=\"nofollow noreferrer\">github.com/segmentio/nsq.js/blob/&hellip;</a>"}, {"owner": {"reputation": 571, "user_id": 405130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e57e8d5e12069d69d04a2e080628ede4?s=128&d=identicon&r=PG", "display_name": "tunesmith", "link": "https://stackoverflow.com/users/405130/tunesmith"}, "edited": false, "score": 0, "creation_date": 1494548977, "post_id": 29245114, "comment_id": 74888152, "body": "I&#39;m having trouble understanding why MaxRdyCount &lt; MaxInFlight could lead to truncation. Isn&#39;t it fine for it to be less? I&#39;d think &gt; would be the worse problem."}], "tags": [], "owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "is_accepted": true, "score": 4, "last_activity_date": 1427241421, "creation_date": 1427241421, "answer_id": 29245114, "question_id": 29243277, "link": "https://stackoverflow.com/questions/29243277/nsq-go-client-cant-keep-up/29245114#29245114", "title": "nsq go client can&#39;t keep up", "body": "<p><code>cfg.MaxInFlight</code> handles the, \"maximum number of messages this comsumer instance will allow in-flight...\" More details are available in the <a href=\"https://github.com/bitly/go-nsq/blob/33e8317bf9e133d821be81c09d07039b586d45fa/consumer.go#L244-L277\" rel=\"nofollow\">consumer source</a></p>\n\n<p>Set <code>cfg.MaxInFlight</code> to something reasonable, as it <a href=\"https://github.com/bitly/go-nsq/blob/edb565821d2ffe9b8927d2c4a6cc8437c476ccc8/config.go#L172-L173\" rel=\"nofollow\">defaults to 1</a></p>\n\n<p>An example configuration is <a href=\"https://github.com/bitly/go-nsq/blob/master/UPGRADING.md#improving-the-nsqhandler-interface\" rel=\"nofollow\">available in the documentation</a> where it is set to 1000. This may or may not be suitable for your application; and, you'd do well to monitor it, as a misconfiguration may result in <a href=\"https://github.com/bitly/go-nsq/blob/33e8317bf9e133d821be81c09d07039b586d45fa/consumer.go#L540\" rel=\"nofollow\">truncated messages</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 498, "user_id": 3375252, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001245231546/picture?type=large", "display_name": "andrey", "link": "https://stackoverflow.com/users/3375252/andrey"}, "is_accepted": false, "score": 0, "last_activity_date": 1479802012, "creation_date": 1479802012, "answer_id": 40736654, "question_id": 29243277, "link": "https://stackoverflow.com/questions/29243277/nsq-go-client-cant-keep-up/40736654#40736654", "title": "nsq go client can&#39;t keep up", "body": "<p>Another ways to speed up go nsq consumers can be found here: <a href=\"https://github.com/nsqio/go-nsq/issues/187\" rel=\"nofollow noreferrer\">https://github.com/nsqio/go-nsq/issues/187</a></p>\n\n<p>One of them, which works for me, is increasing <code>--max-rdy-count</code> on nsqd, which allows to increase consumer's <code>--max_in_flight</code> even higher than the default 2500.</p>\n"}], "owner": {"reputation": 336, "user_id": 958129, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dbe453acf80dbfda1fc2bd425f63310?s=128&d=identicon&r=PG", "display_name": "Walter Cecil Worsley IV", "link": "https://stackoverflow.com/users/958129/walter-cecil-worsley-iv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1761, "favorite_count": 0, "accepted_answer_id": 29245114, "answer_count": 2, "score": 1, "last_activity_date": 1479802012, "creation_date": 1427232629, "question_id": 29243277, "link": "https://stackoverflow.com/questions/29243277/nsq-go-client-cant-keep-up", "title": "nsq go client can&#39;t keep up", "body": "<p>I'm a Go novice coming from the Node world and I'm building a consumer using the official Bitly Go client. I am using AddConcurrentHandlers to spawn 50 goroutines to handle the fire hose of messages. The issue is that my consumer falls behind leaving an exponential of unprocessed/received messages on nsq. Has anyone else encountered this?</p>\n\n<p>I built the same thing in Node to see if there was a server or NSQ configuration issue and its able to process all messages as quickly as they come in.</p>\n\n<p>GO CODE:</p>\n\n<pre><code>q, _ := nsq.NewConsumer(\"chat\", \"golangbetches\", config)\n\nq.AddConcurrentHandlers(nsq.HandlerFunc(func(message *nsq.Message) error {\n  l.Debug(\"Got a message: %v\", message)\n  message.Finish()\n  return nil\n}), 50)\n\nerr := q.ConnectToNSQLookupd(\"&lt;address here&gt;\")\n</code></pre>\n"}, {"tags": ["json", "types", "go", "marshalling"], "comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427228148, "post_id": 29241443, "comment_id": 46690082, "body": "I can&#39;t confirm right now.. but from memory, the marshaller uses <code>float64</code> for all numbers in an interface by default. It will then call <code>String()</code> on it at some point resulting in the scientific/E notation you&#39;re seeing if the number is large enough."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427228637, "post_id": 29241443, "comment_id": 46690356, "body": "Isn&#39;t that very strange? (long) numbers are probably the most common values in jSON files. Should I just <code>Itoa</code> all integers? :P That will probably decrease my performance terrible when the request load on my server becomes heavier."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1427231027, "creation_date": 1427231027, "answer_id": 29242842, "question_id": 29241443, "link": "https://stackoverflow.com/questions/29241443/marshalling-json-big-ints-turn-into-floats-to-the-power/29242842#29242842", "title": "Marshalling jSON big ints turn into floats to the power", "body": "<p>You can marshal an int64 as a string in json to avoid the conversion to a float64 by using the <code>string</code> tag</p>\n\n<pre><code>type T struct {\n    Val int64 `json:\"val,string\"`\n}\nt := T{Val: math.MaxInt64}\nj, _ := json.Marshal(t)\nfmt.Println(string(j))\n// {\"val\":\"9223372036854775807\"}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1427231027, "creation_date": 1427226088, "last_edit_date": 1427228118, "question_id": 29241443, "link": "https://stackoverflow.com/questions/29241443/marshalling-json-big-ints-turn-into-floats-to-the-power", "title": "Marshalling jSON big ints turn into floats to the power", "body": "<p>I have this piece of data:</p>\n\n<pre><code>productID, err := products.Insert(map[string]interface{}{\n    \"Properties\": map[string]interface{}{\n        strconv.Itoa(propertyNameID): map[string]string{\n            \"en\": \"Jeans Jersey\",\n            \"nl\": \"Broek Jersey\",\n        },\n        strconv.Itoa(propertyColorID): propertyOptionRedID,\n    },\n    \"Type\":        productTypeID,\n    \"Propertyset\": propertysetID,\n    \"Active\":      true,\n    \"EAN13\":       \"1234567890123\"})\n</code></pre>\n\n<p>All the <code>***ID</code> variables are of type <code>int</code>. Sadly when I do a normal marshal:</p>\n\n<pre><code>{  \n    \"Active\":true,\n    \"EAN13\":\"1234567890123\",\n    \"Properties\":{  \n        \"2286408386526632249\":{  \n            \"en\":\"Jeans Jersey\",\n            \"nl\":\"Broek Jersey\"\n        },\n        \"4750062295175300168\":7.908474319828591e+18\n    },\n    \"Propertyset\":8.882218269088507e+18,\n    \"Type\":7.185126253999425e+18\n}\n</code></pre>\n\n<p>... the some ints are transformed into <code>float</code> type to the power.</p>\n\n<p>The <code>Itoa</code> are still just some tests tho, because the marshaller can't do <code>map[int]interface{}</code> (lists with index-values as integers). I just don't understand why the <code>int</code> values get changed to their \"display\"-value, instead of their pure value.</p>\n\n<p><strong>Update:</strong> I tried \"Properties\" with <code>map[string]int</code> and just one entry. Still the same result :(</p>\n"}, {"tags": ["arrays", "json", "go"], "comments": [{"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "edited": false, "score": 0, "creation_date": 1427218294, "post_id": 29238600, "comment_id": 46684547, "body": "Can you add what the content, exactly, sliceOfJsonRawmessages is?"}, {"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "reply_to_user": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "edited": false, "score": 0, "creation_date": 1427222132, "post_id": 29238600, "comment_id": 46686772, "body": "@Momer I create a slice that takes json.RawMessage and then append jso.RawMessage (s) to it, those json.RawMessages are exactly what you see in the OP"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427228284, "post_id": 29238600, "comment_id": 46690167, "body": "Never ignore errors!"}], "answers": [{"comments": [{"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1427217807, "post_id": 29238963, "comment_id": 46684245, "body": "Thank you, but you can&#39;t pass <code>buff</code> to json.Compact as a source. Could you add a little more detail?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1427218856, "post_id": 29238963, "comment_id": 46684879, "body": "@Leahcim: you use the <code>Bytes()</code> method to get a slice from the buffer"}, {"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1427223786, "post_id": 29238963, "comment_id": 46687700, "body": "after I do json.Compact or json.Indent i.e. <code>if err := json.Compact(&amp;output, buff.Bytes()); err != nil{ fmt.Println(&quot;error&quot;) }</code> , I then do <code>output, _ := json.Marshall(output.String())</code> and return output <code>w.Write(output)</code>, however, when I try to access to first object of the array i.e.<code>result[0]</code> in the success callback of a (javascript) ajax call, I get the left bracket <code>[</code> rather than the first object inside the left bracket. Same if I do <code>json.Indent</code>.  Can you tell me what I&#39;m doing wrong? (btw, thank you so much for your help)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1427224163, "post_id": 29238963, "comment_id": 46687886, "body": "@Leahcim: the contents of the <code>output</code> buffer are already marshaled. Marshaling output.String() writes it in a single json string."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1427224081, "last_edit_date": 1427224081, "creation_date": 1427217440, "answer_id": 29238963, "question_id": 29238600, "link": "https://stackoverflow.com/questions/29238600/marshalling-string-of-json-objects-into-json-array/29238963#29238963", "title": "Marshalling string of json objects into json array", "body": "<p>You can concatenate them yourself:</p>\n\n<pre><code>var buff bytes.Buffer\nbuff.WriteByte('[')\n\nfor i, j := range jsons {\n    if i != 0 {\n      buff.WriteByte(',')\n    }\n    buff.Write([]byte(j))\n}\nbuff.WriteByte(']')\n</code></pre>\n\n<p>you can then use <code>json.Indent</code> or <code>json.Compact</code> if you need to clean up the json further.</p>\n\n<pre><code>var output bytes.Buffer\nerr = json.Indent(&amp;output, buff.Bytes(), \"\", \"  \")\n// or json.Compact(&amp;output, buff.Bytes())\nif err != nil {\n    // something wrong with the json\n}\n</code></pre>\n"}], "owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 1, "accepted_answer_id": 29238963, "answer_count": 1, "score": 0, "last_activity_date": 1427224081, "creation_date": 1427216323, "last_edit_date": 1495540693, "question_id": 29238600, "link": "https://stackoverflow.com/questions/29238600/marshalling-string-of-json-objects-into-json-array", "title": "Marshalling string of json objects into json array", "body": "<p>This question is related to <a href=\"https://stackoverflow.com/questions/29237411/how-to-convert-type-bytes-buffer-to-use-as-byte-in-argument-to-w-write/29237675?noredirect=1#comment46681985_29237675\">this solved one (i.e. similar code</a> but it is a different question. The output of the code below is a series of json objects, but taken together they are not json (at least in the format that I need it). i.e. The objects are not in an array, and there is not a comma between them. How can I return comma separated objects in an array?</p>\n\n<pre><code>buffer := new(bytes.Buffer)\nfor _, jsonRawMessage := range sliceOfJsonRawMessages{\n    if err := json.Compact(buffer, jsonRawMessage); err != nil{\n        fmt.Println(\"error\")\n\n    }\n\n}\noutput, _ := json.Marshal(buffer.String())\nw.Header().Set(\"Content-Type\", contentTypeJSON)\n\nw.Write(output)\n</code></pre>\n\n<p><strong>Output (2 distinct json objects but there's actually a lot more)</strong></p>\n\n<pre><code>{\n    \"Dir\": \"/usr/local/go/src/bytes\",\n    \"ImportPath\": \"bytes\",\n    \"Name\": \"bytes\",\n    \"Doc\": \"Package bytes implements functions for the manipulation of byte slices.\",\n    \"Target\": \"/usr/local/go/pkg/darwin_amd64/bytes.a\",\n    \"Goroot\": true,\n    \"Standard\": true,\n    \"Root\": \"/usr/local/go\",\n    \"GoFiles\": [\n        \"buffer.go\",\n        \"bytes.go\",\n        \"bytes_decl.go\",\n        \"reader.go\"\n    ],\n    \"IgnoredGoFiles\": [\n        \"equal_test.go\"\n    ],\n    \"Imports\": [\n        \"errors\",\n        \"io\",\n        \"unicode\",\n        \"unicode/utf8\"\n    ],\n    \"Deps\": [\n        \"errors\",\n        \"io\",\n        \"runtime\",\n        \"sync\",\n        \"sync/atomic\",\n        \"unicode\",\n        \"unicode/utf8\",\n        \"unsafe\"\n    ],\n    \"TestGoFiles\": [\n        \"export_test.go\"\n    ],\n    \"XTestGoFiles\": [\n        \"buffer_test.go\",\n        \"bytes_test.go\",\n        \"compare_test.go\",\n        \"example_test.go\",\n        \"reader_test.go\"\n    ],\n    \"XTestImports\": [\n        \"bytes\",\n        \"encoding/base64\",\n        \"fmt\",\n        \"io\",\n        \"io/ioutil\",\n        \"math/rand\",\n        \"os\",\n        \"reflect\",\n        \"runtime\",\n        \"sort\",\n        \"sync\",\n        \"testing\",\n        \"unicode\",\n        \"unicode/utf8\"\n    ]\n}{\n    \"Dir\": \"/usr/local/go/src/errors\",\n    \"ImportPath\": \"errors\",\n    \"Name\": \"errors\",\n    \"Doc\": \"Package errors implements functions to manipulate errors.\",\n    \"Target\": \"/usr/local/go/pkg/darwin_amd64/errors.a\",\n    \"Goroot\": true,\n    \"Standard\": true,\n    \"Root\": \"/usr/local/go\",\n    \"GoFiles\": [\n        \"errors.go\"\n    ],\n    \"Deps\": [\n        \"runtime\",\n        \"unsafe\"\n    ],\n    \"XTestGoFiles\": [\n        \"errors_test.go\",\n        \"example_test.go\"\n    ],\n    \"XTestImports\": [\n        \"errors\",\n        \"fmt\",\n        \"testing\",\n        \"time\"\n    ]\n}\n</code></pre>\n"}, {"tags": ["go", "webserver", "restart"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1427214138, "post_id": 29237500, "comment_id": 46681694, "body": "If you would handle the errors ListenAndServe returns you would see what is wrong (and we could help). Probably your port is still in use and there is not much you can do about it except properly shutting down your app."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1427228071, "post_id": 29237500, "comment_id": 46690042, "body": "As a side note, something like <code>go list -f &#39;{{join .GoFiles &quot; &quot;}}&#39;</code> is probably safer than using <code>*.go</code> to either <code>ls</code> or <code>go run</code> (e.g. that will skip <code>*_test.go</code> files and honor <a href=\"https://golang.org/pkg/go/build/#hdr-Build_Constraints\" rel=\"nofollow noreferrer\">build constraints</a>). You should probably also be using <code>go build</code> instead of <code>go run</code> (or <code>go build &amp;&amp; .&#47;yourProgName</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 852, "user_id": 3557679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41a6a162eaae49373538db6356e0dda3?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Yeah", "link": "https://stackoverflow.com/users/3557679/mr-yeah"}, "is_accepted": false, "score": 1, "last_activity_date": 1427224044, "creation_date": 1427224044, "answer_id": 29240876, "question_id": 29237500, "link": "https://stackoverflow.com/questions/29237500/entr-and-go-run-not-playing-nice/29240876#29240876", "title": "entr and go run not playing nice", "body": "<p>The problem:\n<code>go run</code> will start the server in a separate process which won't be killed.</p>\n\n<p>A solution:\nUse a little script which kills and starts the server</p>\n\n<pre><code>#!/bin/sh\npkill \"$1\"\ngo run \"$1.go\"\n</code></pre>\n\n<p>and use this for <code>entr</code>.</p>\n"}], "owner": {"reputation": 13264, "user_id": 190887, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b1a747d0a7e3450408e0f07adba49111?s=128&d=identicon&r=PG", "display_name": "Inaimathi", "link": "https://stackoverflow.com/users/190887/inaimathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1427224044, "creation_date": 1427213138, "last_edit_date": 1427217202, "question_id": 29237500, "link": "https://stackoverflow.com/questions/29237500/entr-and-go-run-not-playing-nice", "title": "entr and go run not playing nice", "body": "<p>I'm doing some light web development in <a href=\"http://golang.org/\" rel=\"nofollow\"><code>go</code></a>, and running into a problem with <a href=\"http://entrproject.org/\" rel=\"nofollow\"><code>entr</code></a>. I'm editing <code>.go</code> files in a directory while having </p>\n\n<pre><code>ls *.go | entr -r go run *.go\n</code></pre>\n\n<p>running in a separate terminal window.</p>\n\n<p>I can see it re-starting my program every time I save a file, because some format statements get printed out to the terminal every time I do so. However, whenever I navigate to <code>localhost:8080</code>, I see the handler content that was present when I started <code>entr</code> (rather than the content in the most recent change). If I <code>Ctrl+C</code>, then restart <code>entr</code>, I see the latest changes.</p>\n\n<p>Any idea what I'm doing wrong?</p>\n\n<p>Here's the minimal example:</p>\n\n<pre><code>// test.go\npackage main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc handler (w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hello there! I love %s!\", r.URL.Path[1:])\n}\n\nfunc main() {\n    fmt.Println(\"Starting up...\")\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>Now, if I run <code>ls test.go | entr -r go run test.go</code>, I see <code>Starting up...</code> printed to the terminal, and I can go to <code>localhost:8080/tests</code> to see a page that says <code>\"Hello there! I love tests!\"</code>. If I change the <code>handler</code> function so that it reads</p>\n\n<pre><code>func handler (w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"I guess %s are ok...\", r.URL.Path[1:])\n}\n</code></pre>\n\n<p>I see the <code>Starting up...</code> message printed in terminal again, but going to <code>localhost:8080/tests</code> still gives me the page showing <code>\"Hello there! I love tests!\"</code> (even in incognito mode). If I then kill the <code>entr</code> process and restart it, I can go to <code>localhost:8080/tests</code> to see <code>I guess tests are ok...</code> as expected.</p>\n\n<p><strong>Edit</strong>:</p>\n\n<p>Getting the error out of <code>ListenAndServe</code> confirms that this has to do with a dangling socket.</p>\n\n<pre><code>...\n   err := http.ListenAndServe(\":8080\", nil)\n   fmt.Printf(\"ListenAndServe ERR: %s\\n\", err)\n...\n</code></pre>\n\n<p>shows the extra line </p>\n\n<pre><code>listen tcp :8080: bind: address already in use\n</code></pre>\n\n<p>in terminal. A quick search tells me that there isn't an easy way to stop a listener started with <code>ListenAndServe</code>. Is there a simpler approach than <a href=\"http://www.hydrogen18.com/blog/stop-listening-http-server-go.html\" rel=\"nofollow\">this</a>?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1427213891, "post_id": 29237675, "comment_id": 46681526, "body": "Thank you but I require a little clarification. What would I pass to json.Compact in this situation (which I need to use to remove \\n and \\t)? Can you please provide a bit more information specific to my code sample? Thank you if you can help."}, {"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1427214351, "post_id": 29237675, "comment_id": 46681849, "body": "for example, this prints bytes to my terminal- <code>fmt.Println(&quot;json returned&quot;, buffer.Bytes())</code>, if I pass buffer.Bytes() to w.Write, won&#39;t it return a stream of bytes as well. i need json returned. Note, I can&#39;t test this because there&#39;s other problems with my browser."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "edited": false, "score": 0, "creation_date": 1427214526, "post_id": 29237675, "comment_id": 46681985, "body": "@Leahcim If you want to print it, try <code>buffer.String()</code>. <code>buffer.Bytes()</code> returns the UTF-8 encoded bytes of the json text."}], "tags": [], "owner": {"reputation": 9694, "user_id": 797538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b50394e88b7b1ff30dbca04c06560e5a?s=128&d=identicon&r=PG", "display_name": "lnmx", "link": "https://stackoverflow.com/users/797538/lnmx"}, "is_accepted": true, "score": 57, "last_activity_date": 1427213612, "creation_date": 1427213612, "answer_id": 29237675, "question_id": 29237411, "link": "https://stackoverflow.com/questions/29237411/how-to-convert-type-bytes-buffer-to-use-as-byte-in-argument-to-w-write/29237675#29237675", "title": "How to convert (type *bytes.Buffer) to use as []byte in argument to w.Write", "body": "<p>Write requires a <code>[]byte</code> (slice of bytes), and you have a <code>*bytes.Buffer</code> (pointer to a buffer).</p>\n\n<p>You could get the data from the buffer with <a href=\"http://golang.org/pkg/bytes/#Buffer.Bytes\">Buffer.Bytes()</a> and give that to <code>Write()</code>:</p>\n\n<pre><code>_, err = w.Write(buffer.Bytes())\n</code></pre>\n\n<p>...or use <a href=\"http://golang.org/pkg/bytes/#Buffer.WriteTo\">Buffer.WriteTo()</a> to copy the buffer contents directly to a <code>Writer</code>:</p>\n\n<pre><code>_, err = buffer.WriteTo(w)\n</code></pre>\n\n<p>Using a <code>bytes.Buffer</code> is not strictly necessary.  <a href=\"http://golang.org/pkg/encoding/json/#Marshal\">json.Marshal()</a> returns a <code>[]byte</code> directly:</p>\n\n<pre><code>var buf []byte\n\nbuf, err = json.Marshal(thing)\n\n_, err = w.Write(buf)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 616, "user_id": 5911998, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xjU7BaHGqcg/AAAAAAAAAAI/AAAAAAAAABU/JP57QVLOAl0/photo.jpg?sz=128", "display_name": "Joyston", "link": "https://stackoverflow.com/users/5911998/joyston"}, "is_accepted": false, "score": 7, "last_activity_date": 1521779381, "creation_date": 1521779381, "answer_id": 49442374, "question_id": 29237411, "link": "https://stackoverflow.com/questions/29237411/how-to-convert-type-bytes-buffer-to-use-as-byte-in-argument-to-w-write/49442374#49442374", "title": "How to convert (type *bytes.Buffer) to use as []byte in argument to w.Write", "body": "<p>This is how I solved my problem</p>\n\n<pre><code>readBuf, _ := ioutil.ReadAll(jsonStoredInBuffVariable)\n</code></pre>\n\n<p>This code will read from the buffer variable and output []byte value</p>\n"}], "owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46499, "favorite_count": 11, "accepted_answer_id": 29237675, "answer_count": 2, "score": 44, "last_activity_date": 1521779381, "creation_date": 1427212900, "last_edit_date": 1495540476, "question_id": 29237411, "link": "https://stackoverflow.com/questions/29237411/how-to-convert-type-bytes-buffer-to-use-as-byte-in-argument-to-w-write", "title": "How to convert (type *bytes.Buffer) to use as []byte in argument to w.Write", "body": "<p>I'm trying to return some json back from the server but get this error with the following code</p>\n\n<pre><code>cannot use buffer (type *bytes.Buffer) as type []byte in argument to w.Write\n</code></pre>\n\n<p>With a little googling, I found <a href=\"https://stackoverflow.com/questions/23454940/getting-bytes-buffer-does-not-implement-io-writer-error-message\">this SO answer</a> but couldn't get it to work (see second code sample with error message)</p>\n\n<p>1st code sample</p>\n\n<pre><code>buffer := new(bytes.Buffer)\n\nfor _, jsonRawMessage := range sliceOfJsonRawMessages{\n    if err := json.Compact(buffer, jsonRawMessage); err != nil{\n        fmt.Println(\"error\")\n\n    }\n\n}   \nfmt.Println(\"json returned\", buffer)//this is json\nw.Header().Set(\"Content-Type\", contentTypeJSON)\n\nw.Write(buffer)//error: cannot use buffer (type *bytes.Buffer) as type []byte in argument to w.Write\n</code></pre>\n\n<p>2nd code sample with error</p>\n\n<pre><code>cannot use foo (type *bufio.Writer) as type *bytes.Buffer in argument to json.Compact\n cannot use foo (type *bufio.Writer) as type []byte in argument to w.Write\n\n\nvar b bytes.Buffer\nfoo := bufio.NewWriter(&amp;b)\n\nfor _, d := range t.J{\n    if err := json.Compact(foo, d); err != nil{\n        fmt.Println(\"error\")\n\n    }\n\n}\n\n\nw.Header().Set(\"Content-Type\", contentTypeJSON)\n\nw.Write(foo)\n</code></pre>\n"}, {"tags": ["go", "windows-services", "operating-system"], "comments": [{"owner": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 1, "creation_date": 1427219788, "post_id": 29236609, "comment_id": 46685439, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/13878921/how-to-get-all-windows-service-names-starting-with-a-common-word\">How to get all Windows service names starting with a common word?</a>"}, {"owner": {"reputation": 87, "user_id": 1281411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mj03D.png?s=128&g=1", "display_name": "gaurav46", "link": "https://stackoverflow.com/users/1281411/gaurav46"}, "reply_to_user": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 1, "creation_date": 1427220056, "post_id": 29236609, "comment_id": 46685599, "body": "I am looking for implementation in go programming language"}, {"owner": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 0, "creation_date": 1427220339, "post_id": 29236609, "comment_id": 46685778, "body": "I&#39;m aware of that requirement, but I guess you can <a href=\"http://stackoverflow.com/a/7786922/2626313\">call shell command</a> from <code>go</code> and the shell command would look like shown in the linked answer, so I (wearing your shoes) would walk this way and considered the problem solved. You can of course wait until someone else shows up providing some better hint"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1427226785, "post_id": 29236609, "comment_id": 46689327, "body": "Check if the <a href=\"https://golang.org/pkg/syscall/\" rel=\"nofollow noreferrer\"><code>syscall</code></a> or <code>golang.org&#47;x&#47;sys&#47;windows</code> packages has anything to help you, otherwise you&#39;ll likely need/want to <code>os.exec</code> as previously mentioned."}, {"owner": {"reputation": 87, "user_id": 1281411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mj03D.png?s=128&g=1", "display_name": "gaurav46", "link": "https://stackoverflow.com/users/1281411/gaurav46"}, "reply_to_user": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 0, "creation_date": 1427232115, "post_id": 29236609, "comment_id": 46692216, "body": "@xmojmr  looks like will need to use os.exec - thanks for your help"}, {"owner": {"reputation": 87, "user_id": 1281411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mj03D.png?s=128&g=1", "display_name": "gaurav46", "link": "https://stackoverflow.com/users/1281411/gaurav46"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427232123, "post_id": 29236609, "comment_id": 46692220, "body": "@DaveC  looks like will need to use os.exec - thanks for your help"}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 5, "last_activity_date": 1427229807, "last_edit_date": 1495541575, "creation_date": 1427229807, "answer_id": 29242498, "question_id": 29236609, "link": "https://stackoverflow.com/questions/29236609/list-of-services-in-os-golang/29242498#29242498", "title": "List of services in OS - golang", "body": "<p>There is no such function in the standard library and there will likely never be.</p>\n\n<p>Consider using <a href=\"https://golang.org/pkg/os/exec/\" rel=\"nofollow noreferrer\">one of the functions in <code>os/exec</code></a> to launch a Windows program that will list the available services and parse its output (e.g. <a href=\"https://stackoverflow.com/questions/12172997/how-to-collect-each-service-name-and-its-status-in-windows\">\"<code>sc query state=all</code>\"</a>).</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10838294, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/7f444b9da0942725beb107886be5c653?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/10838294/zack"}, "is_accepted": false, "score": 0, "last_activity_date": 1545902114, "last_edit_date": 1545902114, "creation_date": 1545901402, "answer_id": 53942368, "question_id": 29236609, "link": "https://stackoverflow.com/questions/29236609/list-of-services-in-os-golang/53942368#53942368", "title": "List of services in OS - golang", "body": "<p>This is an old post, but figured I would share this link anyways.\n<a href=\"https://godoc.org/golang.org/x/sys/windows/svc/mgr\" rel=\"nofollow noreferrer\">https://godoc.org/golang.org/x/sys/windows/svc/mgr</a></p>\n\n<p>This package provides an API for creating, controlling and listing windows services on both the local and remote systems.</p>\n\n<p>I copied the following text from the above link:</p>\n\n<pre><code>func (m *Mgr) ListServices() ([]string, error)\n</code></pre>\n\n<p>ListServices enumerates services in the specified service control manager database m. If the caller does not have the <code>SERVICE_QUERY_STATUS</code> access right to a service, the service is silently omitted from the list of services returned.</p>\n"}], "owner": {"reputation": 87, "user_id": 1281411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mj03D.png?s=128&g=1", "display_name": "gaurav46", "link": "https://stackoverflow.com/users/1281411/gaurav46"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2627, "favorite_count": 1, "accepted_answer_id": 29242498, "answer_count": 2, "score": 2, "last_activity_date": 1545902114, "creation_date": 1427210822, "last_edit_date": 1495540250, "question_id": 29236609, "link": "https://stackoverflow.com/questions/29236609/list-of-services-in-os-golang", "title": "List of services in OS - golang", "body": "<p>How can I get the list of currently installed services in golang under Windows?</p>\n\n<p>I need something like:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/9030680/list-of-currently-running-process-in-golang\">List of currently running process in golang</a></p>\n\n<p>but for services and not process.</p>\n"}, {"tags": ["http", "go", "revel"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4702763, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tG0yKJGqX70/AAAAAAAAAAI/AAAAAAAABJc/U4PGmKuR70E/photo.jpg?sz=128", "display_name": "Nilton OS", "link": "https://stackoverflow.com/users/4702763/nilton-os"}, "edited": false, "score": 0, "creation_date": 1427225897, "post_id": 29236630, "comment_id": 46688794, "body": "Request.RemoteAddr return 127.0.0.1"}, {"owner": {"reputation": 21, "user_id": 4702763, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tG0yKJGqX70/AAAAAAAAAAI/AAAAAAAABJc/U4PGmKuR70E/photo.jpg?sz=128", "display_name": "Nilton OS", "link": "https://stackoverflow.com/users/4702763/nilton-os"}, "edited": false, "score": 1, "creation_date": 1427225910, "post_id": 29236630, "comment_id": 46688804, "body": "Return real IP   ip := c.Request.Header.Get(&quot;X-Forwarded-For&quot;)"}, {"owner": {"reputation": 21, "user_id": 4702763, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tG0yKJGqX70/AAAAAAAAAAI/AAAAAAAABJc/U4PGmKuR70E/photo.jpg?sz=128", "display_name": "Nilton OS", "link": "https://stackoverflow.com/users/4702763/nilton-os"}, "edited": false, "score": 0, "creation_date": 1427226086, "post_id": 29236630, "comment_id": 46688917, "body": "Add Utils GetIp <a href=\"https://github.com/zzdboy/GoCMS/blob/master/app/controllers/User/user.go#L205\" rel=\"nofollow noreferrer\">github.com/zzdboy/GoCMS/blob/master/app/controllers/User/&hellip;</a>"}, {"owner": {"reputation": 3178, "user_id": 972966, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77e82beae0d15e24aff8b28d7b9213c8?s=128&d=identicon&r=PG", "display_name": "JazzCat", "link": "https://stackoverflow.com/users/972966/jazzcat"}, "reply_to_user": {"reputation": 21, "user_id": 4702763, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tG0yKJGqX70/AAAAAAAAAAI/AAAAAAAABJc/U4PGmKuR70E/photo.jpg?sz=128", "display_name": "Nilton OS", "link": "https://stackoverflow.com/users/4702763/nilton-os"}, "edited": false, "score": 0, "creation_date": 1491160006, "post_id": 29236630, "comment_id": 73418707, "body": "The answer should be changed to what @NiltonOS responded, the above does not work."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1579089680, "last_edit_date": 1579089680, "creation_date": 1427210872, "answer_id": 29236630, "question_id": 29236051, "link": "https://stackoverflow.com/questions/29236051/how-to-get-client-ip-address-in-go-revel/29236630#29236630", "title": "How to get client IP address in Go/Revel", "body": "<p><strong>Foreword:</strong> I released this utility in my <a href=\"https://github.com/icza/gox\" rel=\"nofollow noreferrer\"><code>github.com/icza/gox</code></a> library, see <a href=\"https://godoc.org/github.com/icza/gox/netx/httpx#ClientIP\" rel=\"nofollow noreferrer\"><code>httpx.ClientIP()</code></a>.</p>\n\n<hr>\n\n<p>It's very similar in Revel too. The <a href=\"http://revel.github.io/docs/godoc/controller.html#Controller\" rel=\"nofollow noreferrer\"><code>Controller</code></a> is a <code>struct</code> which contains the <a href=\"http://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\"><code>http.Request</code></a>, so from there you have access to <code>Request.RemoteAddr</code>, the one used in the above Beego example:</p>\n\n<pre><code>// ctrl is a struct embedding a pointer of github.com/revel/revel.Controller\ns := strings.Split(ctrl.Request.RemoteAddr, \":\")\nip := s[0]\n</code></pre>\n\n<p>Or in one line:</p>\n\n<pre><code>ip := strings.Split(ctrl.Request.RemoteAddr, \":\")[0]\n</code></pre>\n\n<p><strong>Note:</strong> There is no standard form for the value of the <code>RemoteAddr</code>. It can be an IPv4 or an IPv6 address, it may or may not contain port, so the above algorithm (copied from the question) will not work in every case. The question was directed at how to obtain this <code>RemoteAddr</code> and not how to parse it particularly. To easily parse address strings, use <a href=\"https://golang.org/pkg/net/#SplitHostPort\" rel=\"nofollow noreferrer\"><code>net.SplitHostPort()</code></a>, like:</p>\n\n<pre><code>host, port, err := net.SplitHostPort(ctrl.Request.RemoteAddr)\n</code></pre>\n\n<p><strong>Note #2:</strong> If the request gets forwarded and/or goes through proxy servers, the <code>RemoteAddr</code> field may not denote the original client that sent the request. Usually when a request is forwarded / goes through proxies, the original client is added in an HTTP header field called <code>X-Forwarded-For</code>, which you can get like</p>\n\n<pre><code>ip := c.Request.Header.Get(\"X-Forwarded-For\")\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4702763, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tG0yKJGqX70/AAAAAAAAAAI/AAAAAAAABJc/U4PGmKuR70E/photo.jpg?sz=128", "display_name": "Nilton OS", "link": "https://stackoverflow.com/users/4702763/nilton-os"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3230, "favorite_count": 1, "closed_date": 1566244898, "accepted_answer_id": 29236630, "answer_count": 1, "score": 1, "last_activity_date": 1579089697, "creation_date": 1427209475, "last_edit_date": 1579089697, "question_id": 29236051, "link": "https://stackoverflow.com/questions/29236051/how-to-get-client-ip-address-in-go-revel", "closed_reason": "Duplicate", "title": "How to get client IP address in Go/Revel", "body": "<p>Howto get the client's IP Address in Revel?</p>\n\n<p>In Beego:</p>\n\n<pre><code>func (this *baseController) getClientIp() string {\n    s := strings.Split(this.Ctx.Request.RemoteAddr, \":\")\n    return s[0]\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427226234, "post_id": 29235887, "comment_id": 46688993, "body": "You don&#39;t need regexp to remove a set of runes from a string. <a href=\"https://golang.org/pkg/strings/#Map\" rel=\"nofollow noreferrer\"><code>strings.Map()</code></a> is your friend (note the mapping function can return &lt;0 to indicate runes to drop, the func could be a simple literal wrapping some <a href=\"https://golang.org/pkg/unicode/\" rel=\"nofollow noreferrer\"><code>unicode.IsXXX</code></a> call). You probably can do want you want with <a href=\"https://golang.org/pkg/strings/#FieldsFunc\" rel=\"nofollow noreferrer\"><code>strings.FieldsFunc()</code></a> directly specifying how you want the input split."}], "answers": [{"comments": [{"owner": {"reputation": 6027, "user_id": 205832, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/23c6d359b6f7af3d3f91ca9e17b804b3?s=128&d=identicon&r=PG", "display_name": "Peter Bengtsson", "link": "https://stackoverflow.com/users/205832/peter-bengtsson"}, "edited": false, "score": 0, "creation_date": 1427232806, "post_id": 29235928, "comment_id": 46692559, "body": "That&#39;s both annoying and nifty at the same time. Thanks!"}], "tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": true, "score": 4, "last_activity_date": 1427209501, "last_edit_date": 1427209501, "creation_date": 1427209161, "answer_id": 29235928, "question_id": 29235887, "link": "https://stackoverflow.com/questions/29235887/why-are-numbers-removed-in-a-regex-replaceallstring/29235928#29235928", "title": "Why are numbers removed in a regex.ReplaceAllString()", "body": "<p><code>[,-:]</code> matches all characters in the range <code>,</code>\u2013<code>:</code>. This range happens to contain all ASCII digits (see <a href=\"http://unixhelp.ed.ac.uk/CGI/man-cgi?ascii+7\" rel=\"nofollow\">ascii(7)</a>). Put the <code>-</code> at the end instead:</p>\n\n<pre><code>reg := regexp.MustCompile(`[\\[\\](){}\"?!,:;,'-]`)\n</code></pre>\n"}], "owner": {"reputation": 6027, "user_id": 205832, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/23c6d359b6f7af3d3f91ca9e17b804b3?s=128&d=identicon&r=PG", "display_name": "Peter Bengtsson", "link": "https://stackoverflow.com/users/205832/peter-bengtsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 29235928, "answer_count": 1, "score": 0, "last_activity_date": 1427209501, "creation_date": 1427209053, "question_id": 29235887, "link": "https://stackoverflow.com/questions/29235887/why-are-numbers-removed-in-a-regex-replaceallstring", "title": "Why are numbers removed in a regex.ReplaceAllString()", "body": "<p>This <a href=\"http://play.golang.org/p/GoJhfazkHP\" rel=\"nofollow\">play</a> clearly demonstrates my predicament.</p>\n\n<p>Ultimately I'm trying to split an unruly string into words. To me \"2015\" is a word and so is \"$100\" but if the input is \"One. 2wo, (three)\" I want [One 2wo three]. Because go doesn't allow a Unicode aware regex I thought I'd first remove all \"junk characters\" and then use <code>strings.Fields()</code></p>\n\n<p>The problem is that any numbers are stripped:</p>\n\n<pre><code>reg := regexp.MustCompile(`[\\[\\](){}\"?!,-:;,']`)\nfmt.Println(reg.ReplaceAllString(\"one 1 zer0\", \"\"))\n// outputs \"one  zer\" when I'd expect \"one 1 zer0\" :(\n</code></pre>\n"}, {"tags": ["go", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "edited": false, "score": 0, "creation_date": 1427210996, "post_id": 29235569, "comment_id": 46679336, "body": "I have read the godoc, and tried this: mx.HandleFunc(&quot;/&quot;, test).Queries(&quot;id&quot;, &quot;bar&quot;). I print the r.URL.String() from the request, and get &quot;/?id=bar&quot;, but it only goes to frontPage-func (mx.HandleFunc(&quot;/&quot;, frontPage). I expected it to go call test() since it was a query or both test() a frontPage() since it fits both patterns.."}, {"owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "edited": false, "score": 0, "creation_date": 1427212101, "post_id": 29235569, "comment_id": 46680201, "body": "Ahhh, I think I know what is happening. It is a ordering of the handleFuncs that is the problem. I have the default case &quot;/&quot; first (which also matches (and catches) &quot;/?id=&quot;)) so by changing the order it works, anyway thank you."}], "tags": [], "owner": {"reputation": 4802, "user_id": 59438, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/edc4947b6f0f2644c7cd191233f3f940?s=128&d=identicon&r=PG", "display_name": "mpobrien", "link": "https://stackoverflow.com/users/59438/mpobrien"}, "is_accepted": true, "score": 2, "last_activity_date": 1427208211, "creation_date": 1427208211, "answer_id": 29235569, "question_id": 29234122, "link": "https://stackoverflow.com/questions/29234122/how-to-correctly-pattern-match-with-routers-handlefunc/29235569#29235569", "title": "how to correctly pattern match with routers handleFunc?", "body": "<p>When using <code>.Queries()</code> you need to give it both a key and a value, like:</p>\n\n<pre><code>mx.HandleFunc(\"/\", test).Queries(\"id\", \"value\")\n</code></pre>\n\n<p>You can also use a pattern as the value, like:</p>\n\n<pre><code>mx.HandleFunc(\"/\", test).Queries(\"id\", \"{id:[0-9]+}\")\n</code></pre>\n\n<p>See here for details: <a href=\"http://godoc.org/github.com/gorilla/mux#Route.Queries\" rel=\"nofollow\">http://godoc.org/github.com/gorilla/mux#Route.Queries</a></p>\n"}], "owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 716, "favorite_count": 0, "accepted_answer_id": 29235569, "answer_count": 1, "score": 1, "last_activity_date": 1427208211, "creation_date": 1427204234, "question_id": 29234122, "link": "https://stackoverflow.com/questions/29234122/how-to-correctly-pattern-match-with-routers-handlefunc", "title": "how to correctly pattern match with routers handleFunc?", "body": "<p>I am using gorilla web toolkit and golang, and have the following code </p>\n\n<pre><code>func test(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"test was called ..\")\n}\n\nfunc main() {\n    runtime.GOMAXPROCS(runtime.NumCPU())\n    mx := mux.NewRouter()\n    mx.HandleFunc(?, test)\n    http.ListenAndServe(\":8080\", mx)\n} \n</code></pre>\n\n<p>My server will serve a html-document with a form that will do a get-request and send a \"/?id={something}\". How can I set up a pattern in the mx.HandleFunc to match the query so that test is called? </p>\n\n<p>I have tried:</p>\n\n<pre><code>\"/?id={something}, \n\"/?id=\", \nmx.HandleFunc(\"/\", test).Queries(\"id\")\nmx.HandleFunc(\"/\", test).Methods(\"POST\") \n</code></pre>\n\n<p>(the last one I changed the corresponding page code so that form makes a post instead). </p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1427215861, "post_id": 29230739, "comment_id": 46682984, "body": "note this doesn&#39;t come up in real code, because you should almost never use a pointer to an interface."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1427224336, "post_id": 29230739, "comment_id": 46687972, "body": "And you don&#39;t normally use pointers to slices (or maps, or strings) either. A slice is already a reference to to the underlying data so there is no need for extra indirection (unless you wanted to update the slice&#39;s length or capacity, but in many such cases it&#39;s better to return the resultant slice like <code>append</code> does)."}, {"owner": {"reputation": 335, "user_id": 2387196, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/186078e5a0be34f6180806030dc7a7b7?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/2387196/michael"}, "edited": false, "score": 0, "creation_date": 1427308873, "post_id": 29230739, "comment_id": 46729723, "body": "I&#39;m using it because I need to get the source IP address of a connection, inside a function, and to have better efficiency I passed the connection as reference instead of coping it. Am I wrong?"}], "answers": [{"tags": [], "owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "is_accepted": true, "score": 4, "last_activity_date": 1427195356, "last_edit_date": 1427195356, "creation_date": 1427195054, "answer_id": 29230925, "question_id": 29230739, "link": "https://stackoverflow.com/questions/29230739/pointers-to-structure-in-go-language/29230925#29230925", "title": "Pointers to structure in Go Language", "body": "<p>If you refer to <a href=\"https://golang.org/ref/spec#Method_values\" rel=\"nofollow\">the Golang Language Specification - Method values</a> section, you'll note this quote (emphasis mine):</p>\n\n<blockquote>\n  <p>As with selectors, a reference to a <strong>non-interface</strong> method with a value receiver using a pointer will <strong>automatically dereference that pointer: pt.Mv is equivalent to (*pt).Mv.</strong></p>\n</blockquote>\n\n<p>Thus, your pointer is being automatically dereferenced for you.</p>\n\n<p><code>net.Conn</code> is an interface .. and as such, you must manually dereference the pointer in order for this to work.</p>\n"}], "owner": {"reputation": 335, "user_id": 2387196, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/186078e5a0be34f6180806030dc7a7b7?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/2387196/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 29230925, "answer_count": 1, "score": 1, "last_activity_date": 1427195356, "creation_date": 1427194513, "question_id": 29230739, "link": "https://stackoverflow.com/questions/29230739/pointers-to-structure-in-go-language", "title": "Pointers to structure in Go Language", "body": "<p>this is my code:</p>\n\n<pre><code>package main\nimport (\"fmt\")\n\ntype Message struct {\n\n    Text []byte\n    Tag string\n}\n\nfunc main() {\n\n    var m Message\n\n    pkt := []byte(\"Hey\")\n    editMessage(&amp;m, &amp;pkt)\n\n    fmt.Println(string(m.Text))\n    }\n\nfunc editMessage(m *Message, pkt *[]byte) {\n\n    m.Text = *pkt\n}\n</code></pre>\n\n<p>And I get \"Hey\" as expected on the output.</p>\n\n<p>If I change <code>m.Text = *pkt</code> with <code>(*m).Text = *pkt</code> It works as well!</p>\n\n<p>Which is the correct/more efficient version? Or is it just a shortcut?</p>\n\n<p>This thing doesn't now work all the time, if I use</p>\n\n<pre><code>c *net.Conn\n</code></pre>\n\n<p>as input in a function, I must use</p>\n\n<pre><code>something := (*c).RemoteAddr()  \n</code></pre>\n\n<p>to get it working.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "edited": false, "score": 3, "creation_date": 1469104190, "post_id": 30204310, "comment_id": 64407101, "body": "Keep in mind that this implementation uses subsequent SELECT(s). While this is great for simplicity (and perhaps multi-level caching with the correct callback configuration) ... it&#39;s also could be optimized by using <code>JOIN</code> statements to reduce latency to/from the server from multiple queries."}], "tags": [], "owner": {"reputation": 415, "user_id": 2851543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ccf22c2997ad9d6512b4a0a5527e6a?s=128&d=identicon&r=PG&f=1", "display_name": "Jinzhu", "link": "https://stackoverflow.com/users/2851543/jinzhu"}, "is_accepted": true, "score": 11, "last_activity_date": 1480967881, "last_edit_date": 1480967881, "creation_date": 1431482010, "answer_id": 30204310, "question_id": 29230261, "link": "https://stackoverflow.com/questions/29230261/how-preload-a-full-hierarchy-in-go-using-gorm/30204310#30204310", "title": "how preload a full hierarchy in GO using GORM", "body": "<p>This is already supported, please refer to the documentation: <a href=\"http://jinzhu.me/gorm/crud.html#nested-preloading\" rel=\"noreferrer\">http://jinzhu.me/gorm/crud.html#nested-preloading</a></p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 1853915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/929baefb3ccc178f8701bbb8a8733fa2?s=128&d=identicon&r=PG", "display_name": "Zonkiie", "link": "https://stackoverflow.com/users/1853915/zonkiie"}, "edited": false, "score": 1, "creation_date": 1527099745, "post_id": 44091098, "comment_id": 88002825, "body": "Note: Since a few month, go-gorm has eager loading integrated. See at <a href=\"http://gorm.io/docs/preload.html\" rel=\"nofollow noreferrer\">http://gorm.io/docs/preload.html</a> under the section &quot;Auto Preloading&quot; for instructions to auto preload. Thanks jinzhu!"}], "tags": [], "owner": {"reputation": 31, "user_id": 1853915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/929baefb3ccc178f8701bbb8a8733fa2?s=128&d=identicon&r=PG", "display_name": "Zonkiie", "link": "https://stackoverflow.com/users/1853915/zonkiie"}, "is_accepted": false, "score": 3, "last_activity_date": 1495316734, "creation_date": 1495316734, "answer_id": 44091098, "question_id": 29230261, "link": "https://stackoverflow.com/questions/29230261/how-preload-a-full-hierarchy-in-go-using-gorm/44091098#44091098", "title": "how preload a full hierarchy in GO using GORM", "body": "<p>my solution:</p>\n\n<pre><code>/****** MIT License **********\nCopyright (c) 2017 Zonkiie\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n***************************/\n\npackage main\n\n/// http://stackoverflow.com/questions/23030884/is-there-a-way-to-create-an-instance-of-a-struct-from-a-string\n/// http://stackoverflow.com/questions/7850140/how-do-you-create-a-new-instance-of-a-struct-from-its-type-at-runtime-in-go\n/// http://stackoverflow.com/questions/29435783/gorm-golang-orm-associations\n\nimport (\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/jinzhu/gorm/dialects/sqlite\"\n    \"fmt\"\n    \"reflect\"\n    \"regexp\"\n    \"encoding/json\"\n    \"encoding/xml\"\n    //\"strconv\"\n    \"os\"\n    \"flag\"\n    \"strings\"\n)\n\ntype rs struct {\n    //Parent    *rs `gorm:\"ForeignKey:ID;AssociationForeignKey:ParentID\"`\n    Childs  []*rs   `gorm:\"ForeignKey:ID;AssociationForeignKey:ParentID\" walkrec:\"true\"`\n    ID  int64\n    ParentID    int64   `gorm:\"column:ParentID\"`\n    Value   string\n    Sub []rs_sub    `gorm:\"ForeignKey:ID;AssociationForeignKey:Rs_ID\" walkrec:\"true\"`\n}\n\ntype rs_sub struct {\n    ID  int64\n    Rs_ID   int64   `gorm:\"column:rs_id\"`\n    Value   string\n}\n\nvar db *gorm.DB\n\nfunc populateDb(db *gorm.DB) {\n\n    rs1 := rs{ID: 1, ParentID: 0, Value: \"root\"}\n    db.Save(&amp;rs1)\n    rs2 := rs{ID: 2, ParentID: 1, Value: \"Child1\"}\n    db.Save(&amp;rs2)\n    rs3 := rs{ID: 3, ParentID: 2, Value: \"Child2\"}\n    db.Save(&amp;rs3)\n    rs4 := rs{ID: 4, ParentID: 3, Value: \"Child3\"}\n    db.Save(&amp;rs4)\n    rs5 := rs{ID: 5, ParentID: 3, Value: \"Child4\"}\n    db.Save(&amp;rs5)\n    rs_s := rs_sub{ID:1, Rs_ID:4, Value: \"SubChild1\"}\n    db.Save(&amp;rs_s)\n}\n\nfunc PStdErr(format string, args ...interface{}) {\n    fmt.Fprintf(os.Stderr, format, args...)\n}\n\nfunc JsonMarshal(data interface{}) string {\n    b, err := json.Marshal(data)\n    if err != nil {\n        return \"Error\"\n    }\n    return string(b[:])\n}\n\nfunc XmlMarshal(data interface{}) string {\n    b, err := xml.Marshal(data)\n    if err != nil {\n        return \"Error\"\n    }\n    return string(b[:])\n}\n\nfunc InitDB() *gorm.DB {\ndb, err := gorm.Open(\"sqlite3\", \":memory:\")\nif err != nil {\n    panic(\"failed to connect database\")\n}\ndb.Exec(\"DROP TABLE IF EXISTS rs;\")\n\n    db.SingularTable(true)\n\n// Migrate the schema\ndb.AutoMigrate(&amp;rs{})\ndb.AutoMigrate(&amp;rs_sub{})\n\npopulateDb(db)\n//db.LogMode(true)\nreturn db\n\n}\n\n// This function fetches all related objects from a given object in the data parameter.\n// The struct must be fully tagged, we don't recognize automatically related IDs and so on.\n// The function works only with not combined keys.\n// Every field which should be fetched must be tagged with:\n// walkrec:\"true\" gorm:\"ForeignKey:ID;AssociationForeignKey:ForeignKey\"\n// See: http://stackoverflow.com/questions/24537525/reflect-value-fieldbyname-causing-panic\n// See: http://stackoverflow.com/questions/34493062/how-to-reflect-struct-recursive-in-golang\nfunc fetchRec(db *gorm.DB, data interface{}) {\n    // With data *rs: Type: *main.rs\n    // With data interface{}: *main.rs\n    var ref reflect.Value\n    if reflect.TypeOf(data).Kind() == reflect.Struct {\n        ref = reflect.ValueOf(data)\n    } else if reflect.TypeOf(data).Kind() == reflect.Ptr {\n        ref = reflect.Indirect(reflect.ValueOf(data))\n    }\n    if ref.Type().Kind() == reflect.Slice {\n        for i := 0; i &lt; ref.Len(); i++ {\n            if ref.Index(i).Type().Kind() == reflect.Ptr {\n                fetchRec(db, ref.Index(i).Elem().Addr().Interface())\n            } else if ref.Index(i).Type().Kind() == reflect.Struct {\n                // What should we do here?\n            }\n        }\n\n    } else if ref.Type().Kind() == reflect.Struct {\n        for i := 0; i &lt; ref.NumField(); i++ {\n            var IDFieldRaw string\n            var IDFields []string\n            var RefFieldRaw string\n            var RefFields []string\n            var re *regexp.Regexp\n            var matches []string\n\n            if ref.Field(i).CanAddr() &amp;&amp; strings.EqualFold(ref.Type().Field(i).Tag.Get(\"walkrec\"), \"true\") {\n                gormflags := ref.Type().Field(i).Tag.Get(\"gorm\")\n                if gormflags == \"\" {\n                    panic(\"No gorm flags found!\")\n                } else {\n                    re = regexp.MustCompile(`\\bForeignKey:([a-zA-Z0-9_,]+)\\b`)\n                    matches = re.FindStringSubmatch(gormflags)\n                    if len(matches) == 2 {\n                        IDFieldRaw = matches[1]\n                        IDFields = strings.Split(IDFieldRaw, \",\")\n                    }\n                    re = regexp.MustCompile(`\\bAssociationForeignKey:([a-zA-Z0-9_,]+)\\b`)\n                    matches = re.FindStringSubmatch(gormflags)\n                    if len(matches) == 2 {\n                        RefFieldRaw = matches[1]\n                        RefFields = strings.Split(RefFieldRaw, \",\")\n                    }\n                }\n                if len(IDFields) == 0 { continue }\n                if len(RefFields) != 0 {\n                    WhereMap := make(map[string]interface{})\n                    for fk := 0; fk &lt; len(RefFields); fk++ {\n                        WhereMap[RefFields[fk]] = fmt.Sprint(ref.FieldByName(IDFields[fk]))\n                    }\n                    db.Where(WhereMap).Find(ref.Field(i).Addr().Interface())\n                    if ref.Field(i).Addr().Interface() != nil {\n                        fetchRec(db, ref.Field(i).Addr().Interface())\n                    }\n                } else {\n                    panic(\"AssociationForeignKey empty!\")\n                }\n            }\n        }\n    }\n}\n\nfunc getParams() (id int) {\n    flag.IntVar(&amp;id, \"id\", 1, \"the id to fetch\")\n    flag.Parse()\n    return\n}\n\nfunc fetch(db *gorm.DB, id interface{}) (d rs, found bool) {\n\n    //db.First(&amp;d, id)\n    found = false\n    found = !db.Find(&amp;d, id).RecordNotFound()\n    if found {\n        fetchRec(db, &amp;d)\n    }\n    return\n}\n\n// Execute this program. For example:\n// go run main.go --id=2\nfunc main() {\n    db = InitDB()\n    defer db.Close()\n    id := getParams()\n    PStdErr(\"Loading data with ID %d\\n\", id)\n    rs, found := fetch(db, id)\n    if found {\n        fmt.Print(XmlMarshal(rs) + \"\\n\")\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3913, "user_id": 3710800, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6b06275b7ae4d1d759875b312db2102f?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Barr&#233;", "link": "https://stackoverflow.com/users/3710800/guillaume-barr%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16474, "favorite_count": 1, "accepted_answer_id": 30204310, "answer_count": 2, "score": 8, "last_activity_date": 1610437681, "creation_date": 1427193126, "last_edit_date": 1610437681, "question_id": 29230261, "link": "https://stackoverflow.com/questions/29230261/how-preload-a-full-hierarchy-in-go-using-gorm", "title": "how preload a full hierarchy in GO using GORM", "body": "<p>I have a hierachy composed by several structures</p>\n<pre><code>type Entry struct {\n    Id          int\n    CreatedAt   time.Time\n    UpdatedAt   time.Time\n    Fields      []Field\n}\n\ntype SyncField struct {\n    Id                   int\n    CreatedAt            time.Time\n    UpdatedAt            time.Time\n    TechnicalName        string\n    JsonName             string\n    EntryId              int\n    Decorators           []Decorator\n}\n\ntype Decorator struct {\n    Id           int\n    CreatedAt    time.Time\n    UpdatedAt    time.Time\n    Name         string\n    Description  string\n    SortingOrder int\n    Params       string\n    SyncFieldId  int\n}\n</code></pre>\n<p>My DB creation is definded like this :</p>\n<pre><code>db.CreateTable(&amp;Entry{})\ndb.CreateTable(&amp;SyncField{})\ndb.Model(&amp;Entry{}).Related(&amp;SyncField{}, &quot;EntryId&quot;)\n\ndb.CreateTable(&amp;Decorator{})\ndb.Model(&amp;SyncField{}).Related(&amp;Decorator{}, &quot;DecoratorId&quot;)\n</code></pre>\n<p>Everything is clear and works fine to preload just one &quot;sub level&quot; of the hierachy like this :</p>\n<pre><code>entry := &amp;Entry{Id: i}\niDB.Preload(&quot;SyncFields&quot;).First(entry)\n</code></pre>\n<p>or</p>\n<pre><code>field := &amp;SyncField{Id: idf}\niDB.Preload(&quot;Decorators&quot;).First(field)\n</code></pre>\n<p>I'm looking for a way using GORM to preload the whole hierachy invoking the &quot;First()&quot; method on one of the root element...\nI want to load an &quot;Entry&quot; with all its related &quot;Fields&quot; and I also want to have each &quot;Field&quot; preloaded with all its &quot;Decorators&quot;...</p>\n<p>This is not feasable using the several &quot;Preload()&quot; functions :</p>\n<pre><code>entry := &amp;Entry{Id: i}\niDB.Preload(&quot;Decorators&quot;).Preload(&quot;SyncFields&quot;).First(entry)\n</code></pre>\n<p>I understand &quot;<code>iDB.Preload(&quot;child1&quot;).Preload(&quot;child2&quot;).First(root)</code>&quot; works when both child1 and child2 are &quot;leaf&quot; of root.</p>\n<p>So my question is : is it possible to do this with gorm and if yes what is the best way to load recursively a complete hierachy?</p>\n<p>Thanks.\nRegards</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 538898, "user_id": 104349, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0f4cefeedec5163556751d61625eedd0?s=128&d=identicon&r=PG", "display_name": "Daniel Roseman", "link": "https://stackoverflow.com/users/104349/daniel-roseman"}, "edited": false, "score": 0, "creation_date": 1427189567, "post_id": 29228712, "comment_id": 46664705, "body": "Almost certainly because of eventual consistency."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 538898, "user_id": 104349, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0f4cefeedec5163556751d61625eedd0?s=128&d=identicon&r=PG", "display_name": "Daniel Roseman", "link": "https://stackoverflow.com/users/104349/daniel-roseman"}, "edited": false, "score": 0, "creation_date": 1427189815, "post_id": 29228712, "comment_id": 46664871, "body": "I doubt that. The filters should filter the data anyway. Also the eventual consistency query has its own api <a href=\"https://godoc.org/google.golang.org/appengine/datastore#Query.EventualConsistency\" rel=\"nofollow noreferrer\">godoc.org/google.golang.org/appengine/&hellip;</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1427191235, "post_id": 29228712, "comment_id": 46665730, "body": "@Theuserwithnohat The link you provided only applies when you use ancestor queries, which you don&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1427191209, "post_id": 29229462, "comment_id": 46665710, "body": "I&#39;m not sure what ancestor key to use because there is no ancestor. &quot;employee&quot; is the root entity. Maybe I&#39;m missing something but why does the API return the query pointer instead to update it? It doesn&#39;t look wise to me, at least not for the most common use cases."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1427191303, "post_id": 29229462, "comment_id": 46665768, "body": "@Theuserwithnohat It&#39;s a design decision. This way <code>Query</code> can be immutable, can be shared and reused."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1427191418, "post_id": 29229462, "comment_id": 46665846, "body": "@Theuserwithnohat An ancestor key is only required if you want strongly consistent results. If you&#39;re fine with a few seconds delay for the results to show up, you don&#39;t have to. Also note that the ancestor key does not have to be the key of an existing entity, it&#39;s just semantics. You can create any fictional key. Using the same (fictional) key to multiple entities will put them into the same entity group and ancestor queries on this group will be strongly consistent."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1427191951, "post_id": 29229462, "comment_id": 46666168, "body": "So the ancestor is basically a kind lock."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1427192152, "post_id": 29229462, "comment_id": 46666312, "body": "@Theuserwithnohat Not a kind, group. Multiple entities of the same kind can have different parents (or none at all), and entities from multiple kinds can have the same parent."}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1470661471, "post_id": 29229462, "comment_id": 65025375, "body": "Note that, at this time, NewContext does not take any parameters. NewInstance does, at which point you&#39;re dealing with development-server instance-creation semantics rather than merely a new-context call."}, {"owner": {"reputation": 3142, "user_id": 2474792, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/327964b28dd74fd6bbbe669aac4edf04?s=128&d=identicon&r=PG", "display_name": "Demi", "link": "https://stackoverflow.com/users/2474792/demi"}, "edited": false, "score": 0, "creation_date": 1470950095, "post_id": 29229462, "comment_id": 65170928, "body": "Also note that writes to any given entity group are serialized and are limited to about 1 per SECOND, per entity group.  So in practice you need to have a separate entity group for each (human) user that is updated at most once per page.  If you need cross-user strongly consistent transactions, you are out of luck."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1444173567, "last_edit_date": 1444173567, "creation_date": 1427190721, "answer_id": 29229462, "question_id": 29228712, "link": "https://stackoverflow.com/questions/29228712/how-to-filter-a-gae-query/29229462#29229462", "title": "How to filter a GAE query?", "body": "<p>The (first) problem is this:</p>\n\n<pre><code>q :=  datastore.NewQuery(\"employee\")\nq.Filter(\"Name =\", \"Andrew W\")\n</code></pre>\n\n<p><a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#Query.Filter\" rel=\"nofollow\"><code>Query.Filter()</code></a> returns a derivative query with the filter you specified included. You have to store the return value and use it ongoing:</p>\n\n<pre><code>q := datastore.NewQuery(\"employee\")\nq = q.Filter(\"Name =\", \"Andrew W\")\n</code></pre>\n\n<p>Or just one line:</p>\n\n<pre><code>q := datastore.NewQuery(\"employee\").Filter(\"Name =\", \"Andrew W\")\n</code></pre>\n\n<p>Note: Without this the query you execute would have no filters and therefore would return all previously saved entities of the kind <code>\"employee\"</code>, where <code>\"Joe Citizen\"</code> might be the first one which you see printed.</p>\n\n<p>For the first run you will most likely see 0 results. Note that since you don't use Ancestor queries, <strong>eventual consistency applies</strong>. The development SDK simulates the High replication datastore with its eventual consistency, and therefore the query following the <code>Put()</code> operations will not see the results.</p>\n\n<p>If you put a small <code>time.Sleep()</code> before proceeding with the query, you will see the results you expect:</p>\n\n<pre><code>time.Sleep(time.Second)\n\nvar e2 Employee\nq := datastore.NewQuery(\"employee\").Filter(\"Name=\", \"Andrew W\")\n// Rest of your code...\n</code></pre>\n\n<p>Also note that running your code in the SDK you can simulate <strong>strong consistency</strong> by creating your context like this:</p>\n\n<pre><code>c, err := aetest.NewContext(&amp;aetest.Options{StronglyConsistentDatastore: true})\n</code></pre>\n\n<p>But of course this is for testing purposes only, you can't do this in production.</p>\n\n<p>If you want strongly consistent results, specify an ancestor key when creating the key, and use <a href=\"https://cloud.google.com/appengine/docs/go/datastore/queries#Go_Ancestor_queries\" rel=\"nofollow\">ancestor queries</a>. An ancestor key is only required if you want strongly consistent results. If you're fine with a few seconds delay for the results to show up, you don't have to. Also note that the ancestor key does not have to be the key of an existing entity, it's just semantics. You can create any fictional key. Using the same (fictional) key to multiple entities will put them into the same entity group and ancestor queries on this group will be strongly consistent.</p>\n\n<p>Often the ancestor key is an existing key, usually derived from the current user or account, because that can be created/computed easily and it holds/stores some additional information, but as noted above, it doesn't have to be.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 789, "favorite_count": 1, "accepted_answer_id": 29229462, "answer_count": 1, "score": 4, "last_activity_date": 1474845369, "creation_date": 1427188427, "last_edit_date": 1474845369, "question_id": 29228712, "link": "https://stackoverflow.com/questions/29228712/how-to-filter-a-gae-query", "title": "How to filter a GAE query?", "body": "<p>I'm trying to save two records and then get the 2nd one. The issue is that the filter doesn't seem to work. Although I filter by Name (\"Andrew W\") I always get \"Joe Citizen\". The counter also indicates 2 records when it should be just one. This drives me crazy. See the full code below.\nThe result prints <code>counter 2 e2 {\"Joe Citizen\" \"Manager\" \"2015-03-24 09:08:58.363929 +0000 UTC\" \"\"}</code></p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"time\"\n    \"net/http\"\n\n    \"google.golang.org/appengine\"\n    \"google.golang.org/appengine/datastore\"\n)\n\n\ntype Employee struct {\n    Name     string\n    Role     string\n    HireDate time.Time\n    Account  string\n}\nfunc init(){\n\n    http.HandleFunc(\"/\", handle)\n}\nfunc handle(w http.ResponseWriter, r *http.Request) {\n    c := appengine.NewContext(r)\n\n    e1 := Employee{\n        Name:     \"Joe Citizen\",\n        Role:     \"Manager\",\n        HireDate: time.Now(),\n    }\n\n    _, err := datastore.Put(c, datastore.NewKey(c, \"employee\", \"\", 0, nil), &amp;e1)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    panic(err)\n        return\n    }\n    e1.Name = \"Andrew W\"\n\n    _, err = datastore.Put(c, datastore.NewKey(c, \"employee\", \"\", 0, nil), &amp;e1)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    panic(err)\n        return\n    }\n\n    var e2 Employee\n    q :=  datastore.NewQuery(\"employee\")\n    q.Filter(\"Name =\", \"Andrew W\")\n    cnt, err  := q.Count(c)\n    if err !=nil{\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        panic(err)\n        return\n    }\n    for t := q.Run(c); ; {  \n        if _, err := t.Next(&amp;e2); err != nil {\n             http.Error(w, err.Error(), http.StatusInternalServerError)\n            panic(err)\n            return\n        }\n        break\n    }   \n    fmt.Fprintf(w, \"counter %v e2 %q\", cnt, e2)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1427185044, "post_id": 29227149, "comment_id": 46662414, "body": "What is the type of <code>n</code> and <code>data.N</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 2, "last_activity_date": 1427185460, "creation_date": 1427185460, "answer_id": 29227862, "question_id": 29227149, "link": "https://stackoverflow.com/questions/29227149/if-value-is-0-then-input-value-will-be-empty-value-otherwise/29227862#29227862", "title": "If value is 0 then input value will be empty, value otherwise", "body": "<p>There is no standard/builtin way to get any request parameters from within a template, you'll have to put it into your data. (You could write a function which does this for you, but that will result in an ugly hack.)</p>\n\n<p>I don't see what's wrong with your solution.</p>\n"}, {"tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": false, "score": 1, "last_activity_date": 1427198182, "last_edit_date": 1427198182, "creation_date": 1427194474, "answer_id": 29230721, "question_id": 29227149, "link": "https://stackoverflow.com/questions/29227149/if-value-is-0-then-input-value-will-be-empty-value-otherwise/29230721#29230721", "title": "If value is 0 then input value will be empty, value otherwise", "body": "<p>I take a similar approach, but use structs.</p>\n\n<pre><code>type SignupForm struct {\n    Name string\n    Email string\n    Etcera bool\n}\n\n// Type alias\ntype M map[string]interface{}\n\n...\n\n// In the handler that accepts your form\nerr := r.ParseForm()\nif err != nil {\n    // handle error\n}\n\nsignup := SignupForm{}\nerr := decoder.Decode(signup, r.PostForm)\nif err != nil {\n    // handle error\n}\n\n// Store the 'saved' form contents somewhere temporary - \n// e.g.\n//  - cookies (keep in mind the 4K browser limit)\n//  - server side sessions (Redis; how I do it)\n//  - db\n\n// In the handler that renders your form\nerr := template.ExecuteTemplate(w, \"form.html\", M{\n        \"form\": signup,\n        \"csrfToken\": csrfToken,\n        // and so on...\n        })\n</code></pre>\n\n<p>Note that wherever you store the form data, make sure it is temporary. Server side sessions are ideal as you can have them expire (if you don't want to delete them manually).    </p>\n"}], "owner": {"reputation": 4236, "user_id": 2231905, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0d4a1b6ef81bd93c9dd8896880995b77?s=128&d=identicon&r=PG", "display_name": "Fallen", "link": "https://stackoverflow.com/users/2231905/fallen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1427198182, "creation_date": 1427182564, "question_id": 29227149, "link": "https://stackoverflow.com/questions/29227149/if-value-is-0-then-input-value-will-be-empty-value-otherwise", "title": "If value is 0 then input value will be empty, value otherwise", "body": "<p><strong>Problem:</strong>\nI have created a simple form, where there's an input field \"num\". After submission I want to show the value of num in the same input field, in other words want to retain the input in that field. If the value was set to 0 then I want to ignore that.</p>\n\n<p>I can do it in several languages but I'm not sure about how to do it in Golang. My current template file has,</p>\n\n<pre><code>&lt;input type=\"text\" placeholder=\"foo\" name=\"bar\" value=\"{{if gt .N 0 }} {{.N}} {{end}} \"/&gt; \n</code></pre>\n\n<p>Server file contains:</p>\n\n<pre><code>data := &amp;listOfReport {\n        R: r,\n        I: i,\n        N: n\n}\nlistTmpl := template.Must(template.New(\"list_tmpl\").Parse(string(report.Template[\"xxx.tmpl\"])))\nif err := listTmpl.Execute(w, data); err != nil {\n    http.Error(w, fmt.Sprintf(\"Error rendering template %v\", err), 500)\n}\n</code></pre>\n\n<p>Another thought is to make N a string so make it '' or value in the server file. But that actually spoils the variable's name/purpose.</p>\n\n<p>Is there any better way to do it? Is ther any better way to access GET parameters directly from template? Please note that the value of N is originally got from a GET variable.</p>\n\n<p>*This code is not tested</p>\n"}, {"tags": ["css", "templates", "go"], "answers": [{"comments": [{"owner": {"reputation": 459, "user_id": 1540033, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/275b35f80c93e82aa2c15456fd73b215?s=128&d=identicon&r=PG", "display_name": "mehdix_", "link": "https://stackoverflow.com/users/1540033/mehdix"}, "edited": false, "score": 0, "creation_date": 1427185093, "post_id": 29227646, "comment_id": 46662442, "body": "Thanks, I knew I was close. Solved the problem."}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 2, "last_activity_date": 1427184601, "creation_date": 1427184601, "answer_id": 29227646, "question_id": 29226762, "link": "https://stackoverflow.com/questions/29226762/css-file-doesnt-get-referenced/29227646#29227646", "title": "CSS file doesn&#39;t get referenced", "body": "<p>Use</p>\n\n<pre><code>http.Dir(\"static/css\")\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>http.Dir(\"css\")\n</code></pre>\n"}], "owner": {"reputation": 459, "user_id": 1540033, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/275b35f80c93e82aa2c15456fd73b215?s=128&d=identicon&r=PG", "display_name": "mehdix_", "link": "https://stackoverflow.com/users/1540033/mehdix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 29227646, "answer_count": 1, "score": 0, "last_activity_date": 1427184601, "creation_date": 1427180780, "last_edit_date": 1427181187, "question_id": 29226762, "link": "https://stackoverflow.com/questions/29226762/css-file-doesnt-get-referenced", "title": "CSS file doesn&#39;t get referenced", "body": "<p>I have this code as my myApp.go:</p>\n\n<pre><code>package fastaticapp\n\nimport (\n \"html/template\"\n \"log\"\n \"net/http\"\n)\n\nfunc init() {\nhttp.HandleFunc(\"/\", rootHandler)\n}\n\nfunc rootHandler(w http.ResponseWriter, r *http.Request) {\nhttp.Handle(\"/css/\", http.StripPrefix(\"/css/\", http.FileServer(http.Dir(\"css\"))))\n\nif r.URL.Path != \"/\" {\n    errorHandler(w, r, http.StatusNotFound, \"\")\n    return\n}\n\npage := template.Must(template.ParseFiles(\n    \"static/_base.html\",\n    \"static/index.html\",\n))\n\nif err := page.Execute(w, nil); err != nil {\n    errorHandler(w, r, http.StatusInternalServerError, err.Error())\n    return\n}\n</code></pre>\n\n<p>}</p>\n\n<p>And the direcotry Layout looks like this:</p>\n\n<pre><code>webapp/\n  myApp/\n    server.go\n  static/\n    index.html\n    _base.html\n    img/\n    css/\n     main.css\n</code></pre>\n\n<p>I am using template package with Must function. running the dev server, the HTML page gets rendered by the browser and using developer tools I can see the html contents. The problem is main.css file within the css folder does not appear to be properly handled by the server. \nAny thought on this would be highly appreciated.</p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1427202347, "post_id": 29224244, "comment_id": 46672861, "body": "Seems like a broken install, can you try with Go 1.4?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1427206691, "post_id": 29224244, "comment_id": 46676033, "body": "@OneOfOne: What output did you get when you ran the program?"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1427221281, "post_id": 29224244, "comment_id": 46686287, "body": "@peterSO after switching to <code>&#47;* xxx *&#47;</code> comment style and <code>import &quot;C&quot;</code> on a separate line, it printed a random value for me. <code>test 1804289383</code>"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1427225131, "post_id": 29224244, "comment_id": 46688358, "body": "The &quot;special&quot; comments must <b>immediately</b> precede the import statement, your example has a blank line and so I get &quot;<code>could not determine kind of name for C.random</code>&quot;). (Just like godoc comments they must not have blank lines before what they document.) See first few paragraphs of <code>godoc cgo</code>. As you&#39;ve also discovered, but is less clear from the documentation, <code>import &quot;C&quot;</code> seems to have to appear by itself separate from the regular <code>import ( \u2026 )</code> block."}, {"owner": {"reputation": 2766, "user_id": 1145208, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c92287ad4532c0faf7197093a4693a9?s=128&d=identicon&r=PG", "display_name": "Hongseok Yoon", "link": "https://stackoverflow.com/users/1145208/hongseok-yoon"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1427240968, "post_id": 29224244, "comment_id": 46695735, "body": "@OneOfOne + all thanks! upgraded to 1.4 and removed empty line as you said, it worked!"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1427206069, "creation_date": 1427206069, "answer_id": 29234777, "question_id": 29224244, "link": "https://stackoverflow.com/questions/29224244/error-encountered-running-simple-cgo-file/29234777#29234777", "title": "Error encountered running simple cgo file", "body": "<p>What output do you get from this program?</p>\n\n<pre><code>package main\n\n/*\n#include &lt;stdlib.h&gt;\n*/\nimport \"C\"\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Printf(\"test %d\\n\", int(C.rand()))\n}\n</code></pre>\n"}], "owner": {"reputation": 2766, "user_id": 1145208, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2c92287ad4532c0faf7197093a4693a9?s=128&d=identicon&r=PG", "display_name": "Hongseok Yoon", "link": "https://stackoverflow.com/users/1145208/hongseok-yoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 938, "favorite_count": 1, "accepted_answer_id": 29234777, "answer_count": 1, "score": 1, "last_activity_date": 1427206069, "creation_date": 1427165751, "last_edit_date": 1427173423, "question_id": 29224244, "link": "https://stackoverflow.com/questions/29224244/error-encountered-running-simple-cgo-file", "title": "Error encountered running simple cgo file", "body": "<p>I'm trying to test cgo code.</p>\n\n<pre><code>package main\n\n// #include &lt;stdlib.h&gt;\n\nimport (\n    \"C\"\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Printf(\"test %d\\n\", int(C.random()))\n}\n\nD:\\Dev\\Go\\src&gt;go version \ngo version go1.3 windows/amd64\n\nD:\\Dev\\Go\\src&gt;go env \nset GOARCH=amd64 \nset GOBIN= \nset GOCHAR=6 \nset GOEXE=.exe \nset GOHOSTARCH=amd64 \nset GOHOSTOS=windows \nset GOOS=windows\nset GOPATH=D:\\\\Dev\\\\Go \nset GORACE= \nset GOROOT=c:\\go \nset GOTOOLDIR=c:\\go\\pkg\\tool\\windows_amd64 \nset CC=gcc \nset GOGCCFLAGS=-m64-mthreads -fmessage-length=0 \nset CXX=g++ \nset CGO_ENABLED=1\n\nD:\\Dev\\Go\\src&gt;go run test_binding.go\n# runtime/cgo C:\\Users\\hyoon\\AppData\\Local\\Temp\\go-build779392087\\runtime\\cgo\\_obj\\_cgo_defun.c:7 6c: No such file  or directory: runtime.h\n</code></pre>\n\n<p>please check the last error. what's wrong?</p>\n"}, {"tags": ["tcp", "go"], "answers": [{"tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 1, "last_activity_date": 1427152055, "last_edit_date": 1427152055, "creation_date": 1427151572, "answer_id": 29222005, "question_id": 29221872, "link": "https://stackoverflow.com/questions/29221872/golang-read-bytes-from-net-tcpconn/29222005#29222005", "title": "Golang Read Bytes from net.TCPConn", "body": "<p><a href=\"https://golang.org/pkg/io/#ReadFull\" rel=\"nofollow\">io.ReadFull</a>\nor\n<a href=\"https://golang.org/pkg/io/#LimitedReader\" rel=\"nofollow\">io.LimitedReader</a>\nor\n<a href=\"https://golang.org/pkg/net/http/#MaxBytesReader\" rel=\"nofollow\">http.MaxBytesReader</a>.</p>\n\n<p>If you need something different first look at how those are implemented, it'd be trivial to roll your own with tweaked behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1441717180, "last_edit_date": 1441717180, "creation_date": 1427152119, "answer_id": 29222113, "question_id": 29221872, "link": "https://stackoverflow.com/questions/29221872/golang-read-bytes-from-net-tcpconn/29222113#29222113", "title": "Golang Read Bytes from net.TCPConn", "body": "<p>There are two options. If <code>n</code> is the number of bytes you want to read and <code>r</code> is the connection.</p>\n\n<p>Option 1: </p>\n\n<pre><code>p := make([]byte, n)\n_, err := io.ReadFull(r, p)\n</code></pre>\n\n<p>Option 2: </p>\n\n<pre><code>p, err := io.ReadAll(&amp;io.LimitedReader{R: r, N: n})\n</code></pre>\n\n<p>The first option is more efficient if the application typically fills the buffer.</p>\n\n<p>If you are reading from an HTTP request body, then use <a href=\"http://godoc.org/net/http#MaxBytesReader\" rel=\"nofollow\">http.MaxBytesReader</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1564923109, "post_id": 29223689, "comment_id": 101181194, "body": "Worth noting that ReadFull uses ReadAtLeast underlyingly."}], "tags": [], "owner": {"reputation": 7514, "user_id": 1008837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f67dc852a25a639e13fafbec62eec69?s=128&d=identicon&r=PG&f=1", "display_name": "Pravin Mishra", "link": "https://stackoverflow.com/users/1008837/pravin-mishra"}, "is_accepted": false, "score": 3, "last_activity_date": 1427162011, "creation_date": 1427162011, "answer_id": 29223689, "question_id": 29221872, "link": "https://stackoverflow.com/questions/29221872/golang-read-bytes-from-net-tcpconn/29223689#29223689", "title": "Golang Read Bytes from net.TCPConn", "body": "<p>There are a couple of ways to achieve your requirement. You can use either one. </p>\n\n<p><a href=\"https://golang.org/pkg/io/#ReadFull\" rel=\"nofollow\">func ReadFull</a></p>\n\n<pre><code>func ReadFull(r Reader, buf []byte) (n int, err error)\n</code></pre>\n\n<blockquote>\n  <p>ReadFull reads exactly len(buf) bytes from r into buf. It returns the\n  number of bytes copied and an error if fewer bytes were read. The\n  error is EOF only if no bytes were read.</p>\n</blockquote>\n\n<p><a href=\"http://golang.org/pkg/io/#LimitReader\" rel=\"nofollow\">func LimitReader</a></p>\n\n<pre><code>func LimitReader(r Reader, n int64) Reader\n</code></pre>\n\n<p>LimitReader returns a Reader that reads from r but stops with EOF after n bytes. The underlying implementation is a *LimitedReader.</p>\n\n<p><a href=\"http://golang.org/pkg/io/#CopyN\" rel=\"nofollow\">func CopyN</a></p>\n\n<pre><code>func CopyN(dst Writer, src Reader, n int64) (written int64, err error)\n</code></pre>\n\n<blockquote>\n  <p>CopyN copies n bytes (or until an error) from src to dst. It returns\n  the number of bytes copied and the earliest error encountered while\n  copying. On return, written == n if and only if err == nil.</p>\n</blockquote>\n\n<p><a href=\"http://golang.org/pkg/io/#ReadAtLeast\" rel=\"nofollow\">func ReadAtLeast</a></p>\n\n<pre><code>func ReadAtLeast(r Reader, buf []byte, min int) (n int, err error)\n</code></pre>\n\n<blockquote>\n  <p>ReadAtLeast reads from r into buf until it has read at least min\n  bytes. It returns the number of bytes copied and an error if fewer\n  bytes were read. The error is EOF only if no bytes were read.</p>\n</blockquote>\n"}], "owner": {"reputation": 53, "user_id": 4688038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d28dec521dcd76483147aced11fae398?s=128&d=identicon&r=PG&f=1", "display_name": "Frederick Rice", "link": "https://stackoverflow.com/users/4688038/frederick-rice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9187, "favorite_count": 2, "accepted_answer_id": 29222005, "answer_count": 3, "score": 5, "last_activity_date": 1441717180, "creation_date": 1427150897, "question_id": 29221872, "link": "https://stackoverflow.com/questions/29221872/golang-read-bytes-from-net-tcpconn", "title": "Golang Read Bytes from net.TCPConn", "body": "<p>Is there a version of <code>ioutil.ReadAll</code> that will read until it reaches an EOF OR if it reads <code>n</code> bytes (whichever comes first)? </p>\n\n<p>I cannot just take the first <code>n</code> bytes from an <code>ioutil.ReadAll</code> dump for DOS reasons. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1427152603, "post_id": 29221854, "comment_id": 46653215, "body": "<code>x := somethingForCats.getSomething().(Cat); &amp;x</code> unless you change <code>return Cat{}</code> into <code>return &amp;Cat{}</code> or <code>return new(Cat)</code> and then just <code>somethingForCats.getSomething().(*Cat)</code>. <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">Read the spec on type assertions</a>."}, {"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427154617, "post_id": 29221854, "comment_id": 46653843, "body": "@DaveC eh, it can be played with a bit, but it&#39;s definitely not great for performance: <a href=\"http://stackoverflow.com/a/29222497/1162491\">stackoverflow.com/a/29222497/1162491</a>"}, {"owner": {"reputation": 6194, "user_id": 773210, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/b2cf058543966b93b0b15acb631eb527?s=128&d=identicon&r=PG", "display_name": "Oved D", "link": "https://stackoverflow.com/users/773210/oved-d"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427168987, "post_id": 29221854, "comment_id": 46657449, "body": "@DaveC The place that this code is run will not know about the Cat type, so it cannot directly to that cast.  Furthermore this code needs to work for any type getSomething() returns.  It is for code in a separate package.  You&#39;d pass a pointer to the interface into this external package."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427222341, "post_id": 29221854, "comment_id": 46686876, "body": "@OvedD then edit your question. The first paragraph currently says you have an <code>interface{}</code> and need a <code>*structType</code> to pass somewhere else. A type assertion is the simplest way to do exactly that."}], "answers": [{"comments": [{"owner": {"reputation": 6194, "user_id": 773210, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/b2cf058543966b93b0b15acb631eb527?s=128&d=identicon&r=PG", "display_name": "Oved D", "link": "https://stackoverflow.com/users/773210/oved-d"}, "edited": false, "score": 0, "creation_date": 1427169020, "post_id": 29222267, "comment_id": 46657456, "body": "The code where this is run does not have access to the Cat or Dog class"}], "tags": [], "owner": {"reputation": 10925, "user_id": 723947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b898a5dde625380e861e3719e50a4c?s=128&d=identicon&r=PG", "display_name": "dyoo", "link": "https://stackoverflow.com/users/723947/dyoo"}, "is_accepted": false, "score": 2, "last_activity_date": 1427152913, "creation_date": 1427152913, "answer_id": 29222267, "question_id": 29221854, "link": "https://stackoverflow.com/questions/29221854/in-go-golang-how-can-you-cast-an-interface-pointer-into-a-struct-pointer/29222267#29222267", "title": "In go (golang), how can you cast an interface pointer into a struct pointer?", "body": "<p>The following may help: <a href=\"http://play.golang.org/p/XkdzeizPpP\" rel=\"nofollow\">http://play.golang.org/p/XkdzeizPpP</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Cat struct {\n    name string\n}\n\ntype Dog struct {\n    name string\n}\n\ntype SomethingGeneric struct {\n    getSomething func() interface{}\n}\n\nfunc getSomeCat() interface{} {\n    return Cat{name: \"garfield\"}\n}\n\nfunc getSomeDog() interface{} {\n    return Dog{name: \"fido\"}\n}\n\nvar somethings = []SomethingGeneric{\n    SomethingGeneric{getSomething: getSomeCat},\n    SomethingGeneric{getSomething: getSomeDog},\n}\n\nfunc main() {\n    for _, something := range somethings {\n        interfaceVariable := something.getSomething()\n\n        cat, isCat := interfaceVariable.(Cat)\n        dog, isDog := interfaceVariable.(Dog)\n\n        fmt.Printf(\"cat %v %v\\n\", cat, isCat)\n        fmt.Printf(\"dog %v %v\\n\", dog, isDog)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "is_accepted": false, "score": 3, "last_activity_date": 1427190047, "last_edit_date": 1427190047, "creation_date": 1427154259, "answer_id": 29222497, "question_id": 29221854, "link": "https://stackoverflow.com/questions/29221854/in-go-golang-how-can-you-cast-an-interface-pointer-into-a-struct-pointer/29222497#29222497", "title": "In go (golang), how can you cast an interface pointer into a struct pointer?", "body": "<p>@dyoo's example does work, but it relies on you to manually cast <code>Dog</code> and <code>Cat</code>.</p>\n\n<p>Here's a bit of a convoluted/verbose example which avoids that constraint somewhat:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Cat struct {\n    name string\n}\n\ntype SomethingGeneric struct {\n    getSomething func() interface{}\n}\n\nfunc getSomeCat() interface{} {\n    return Cat{name: \"Fuzzy Wuzzy\"}\n}\n\nvar somethingForCats = SomethingGeneric{getSomething: getSomeCat}\n\nfunc main() {\n    interfaceVariable := somethingForCats.getSomething()\n    castVar := reflect.ValueOf(interfaceVariable)\n    castVar.Convert(castVar.Type())\n\n    // If you want a pointer, do this:\n    fmt.Println(reflect.PtrTo(castVar.Type()))\n\n    // The deref'd val\n    if castVar.Type() != reflect.TypeOf(Cat{}) {\n        fmt.Printf(\"Type was %v but expected %v\\n\", castVar, reflect.TypeOf(&amp;Cat{}))\n    } else {\n        fmt.Println(castVar.Field(0))\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/GalgPFeSyd\" rel=\"nofollow\">Playground Link</a></p>\n"}, {"tags": [], "owner": {"reputation": 3820, "user_id": 4754037, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EpB-u9D7emI/AAAAAAAAAAI/AAAAAAAAAAA/LsS3R-k2AUY/photo.jpg?sz=128", "display_name": "shawn", "link": "https://stackoverflow.com/users/4754037/shawn"}, "is_accepted": false, "score": 3, "last_activity_date": 1530894221, "creation_date": 1530894221, "answer_id": 51214370, "question_id": 29221854, "link": "https://stackoverflow.com/questions/29221854/in-go-golang-how-can-you-cast-an-interface-pointer-into-a-struct-pointer/51214370#51214370", "title": "In go (golang), how can you cast an interface pointer into a struct pointer?", "body": "<p>I found this thread: <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/KB3_Yj3Ny4c\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/golang-nuts/KB3_Yj3Ny4c</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Cat struct {\n    name string\n}\n\n//\n// Return a pointer to the supplied struct via interface{}\n//\nfunc to_struct_ptr(obj interface{}) interface{} {\n\n    fmt.Println(\"obj is a\", reflect.TypeOf(obj).Name())\n\n    // Create a new instance of the underlying type \n    vp := reflect.New(reflect.TypeOf(obj))\n\n    // Should be a *Cat and Cat respectively\n    fmt.Println(\"vp is\", vp.Type(), \" to a \", vp.Elem().Type())\n\n    vp.Elem().Set(reflect.ValueOf(obj))\n\n    // NOTE: `vp.Elem().Set(reflect.ValueOf(&amp;obj).Elem())` does not work\n\n    // Return a `Cat` pointer to obj -- i.e. &amp;obj.(*Cat)\n    return vp.Interface()\n}\n\n//\n// Dump out a pointer ...\n//\nfunc test_ptr(ptr interface{}) {\n    v := reflect.ValueOf(ptr)\n    fmt.Println(\"ptr is a\", v.Type(), \"to a\", reflect.Indirect(v).Type())\n}\n\nfunc main() {\n    cat := Cat{name: \"Fuzzy Wuzzy\"}\n\n    // Reports \"*main.Cat\"\n    test_ptr(&amp;cat)\n\n    // Get a \"*Cat\" generically via interface{}\n    sp := to_struct_ptr(cat)\n\n    // *should* report \"*main.Cat\" also\n    test_ptr(sp)\n\n    fmt.Println(\"sp is\",sp)\n}\n</code></pre>\n"}], "owner": {"reputation": 6194, "user_id": 773210, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/b2cf058543966b93b0b15acb631eb527?s=128&d=identicon&r=PG", "display_name": "Oved D", "link": "https://stackoverflow.com/users/773210/oved-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14195, "favorite_count": 1, "answer_count": 3, "score": 7, "last_activity_date": 1530894221, "creation_date": 1427150822, "last_edit_date": 1427169119, "question_id": 29221854, "link": "https://stackoverflow.com/questions/29221854/in-go-golang-how-can-you-cast-an-interface-pointer-into-a-struct-pointer", "title": "In go (golang), how can you cast an interface pointer into a struct pointer?", "body": "<p>I want to use some external code that requires a pointer to a struct.  At the point that the code is called, I have an interface variable.  </p>\n\n<p>When creating a pointer off of that variable, the pointer's type is <code>interface{}*</code> when I need it to be the pointer type of the struct's type.</p>\n\n<p>Image the code in <code>TestCanGetStructPointer</code> <strong>does not know about the Cat class</strong>, and that it exists in some external package.</p>\n\n<p>How can I cast it to this?</p>\n\n<p>Here is a code sample:</p>\n\n<pre><code>import (\n    \"reflect\"\n    \"testing\"\n)   \n\ntype Cat struct {\n    name string\n}\n\ntype SomethingGeneric struct {\n    getSomething func() interface{}\n}\n\nfunc getSomeCat() interface{} {\n    return Cat{}\n}\n\nvar somethingForCats = SomethingGeneric{getSomething: getSomeCat}\n\nfunc TestCanGetStructPointer(t *testing.T) {\n    interfaceVariable := somethingForCats.getSomething()\n\n    pointer := &amp;interfaceVariable\n\n    interfaceVarType := reflect.TypeOf(interfaceVariable)\n    structPointerType := reflect.PtrTo(interfaceVarType)\n    pointerType := reflect.TypeOf(pointer)\n\n    if pointerType != structPointerType {\n        t.Errorf(\"Pointer type was %v but expected %v\", pointerType, structPointerType)\n    }\n\n}\n</code></pre>\n\n<p>The test fails with:</p>\n\n<p><code>Pointer type was *interface {} but expected *parameterized.Cat</code></p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 3, "creation_date": 1427152458, "post_id": 29221752, "comment_id": 46653158, "body": "Try capturing a request from your web browser and setting your go HTTP client&#39;s headers to match.  It might be more than just the <code>User-Agent</code>..."}, {"owner": {"reputation": 9229, "user_id": 2571021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87cbb4445df2a3318c04b951bf1d8148?s=128&d=identicon&r=PG", "display_name": "Dijkgraaf", "link": "https://stackoverflow.com/users/2571021/dijkgraaf"}, "edited": false, "score": 1, "creation_date": 1427160532, "post_id": 29221752, "comment_id": 46655449, "body": "At what rate do you fetch pages at?  If it is too quickly you may be blocked as well if you hit some sort of rate limiter."}, {"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "edited": false, "score": 0, "creation_date": 1427189355, "post_id": 29221752, "comment_id": 46664585, "body": "Maybe they don&#39;t want your requests."}, {"owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "reply_to_user": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "edited": false, "score": 0, "creation_date": 1427244958, "post_id": 29221752, "comment_id": 46696931, "body": "@mihai Actually they do."}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 3, "last_activity_date": 1427159875, "creation_date": 1427159875, "answer_id": 29223362, "question_id": 29221752, "link": "https://stackoverflow.com/questions/29221752/how-to-avoid-some-sites-rejecting-http-get-using-go/29223362#29223362", "title": "How to avoid some sites rejecting HTTP get using go", "body": "<p>Try matching the exact headers from a request from your web browser to eliminate other factors.  A smart firewall could have heuristics on what looks like a web browser versus a robot.</p>\n\n<p>Notice that the go http client sends only a minimal HTTP request:</p>\n\n<pre class=\"lang-txt prettyprint-override\"><code>GET /foo HTTP/1.1\nHost: localhost:3030\nUser-Agent: Go 1.1 package http\nAccept-Encoding: gzip\n</code></pre>\n\n<p>Whereas a web browser is more chatty:</p>\n\n<pre class=\"lang-txt prettyprint-override\"><code>GET /foo HTTP/1.1\nHost: localhost:3030\nConnection: keep-alive\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36\nAccept-Encoding: gzip, deflate, sdch\nAccept-Language: en-US,en;q=0.8\n</code></pre>\n"}], "owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 29223362, "answer_count": 1, "score": 1, "last_activity_date": 1427159875, "creation_date": 1427150248, "last_edit_date": 1427150458, "question_id": 29221752, "link": "https://stackoverflow.com/questions/29221752/how-to-avoid-some-sites-rejecting-http-get-using-go", "title": "How to avoid some sites rejecting HTTP get using go", "body": "<p>We have a script that on a daily basis checks all of the web links in all of our database records (the users want notifications when a link becomes out of date).</p>\n\n<p>There are a couple of sites that work fine through a web browser from this IP address, but when fetched through GO, they either disconnect before completing the request or return a HTTP authorisation denied message.</p>\n\n<p>I am assuming some sort of firewall (F5) is filtering/blocking the request. This occurs even when I change the HTTP request to use a common user agent. What can we do to ensure a GO request looks like a standard browser?</p>\n\n<pre><code>func fetch_url(url string, d time.Duration) (int, error) {\n\n    client := &amp;http.Client{\n        Timeout: d,\n    }\n\n    req, err := http.NewRequest(\"GET\", url, nil)\n    if err != nil {\n        return 0, err\n    }\n\n    req.Header.Set(\"User-Agent\", \"Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/7.0 Mobile/11A465 Safari/9537.53\")\n\n    resp, err := client.Do(req)\n    if err != nil {\n        return 0, err\n    }\n\n    status := resp.StatusCode\n    resp.Body.Close()\n    return status, nil\n}\n</code></pre>\n"}, {"tags": ["go", "websocket", "chat"], "comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427147235, "post_id": 29220922, "comment_id": 46651020, "body": "Walking the fine line of self promotion here .. but, <a href=\"https://github.com/simon-whitehead/relayr\" rel=\"nofollow noreferrer\">my package might help you to get started</a> .. however I don&#39;t currently have a <code>SendDirectlyToUser</code> method. You could, however, just assign users to groups and send to the group (the direct send is coming .. I just haven&#39;t had time..)."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1427147243, "post_id": 29220922, "comment_id": 46651028, "body": "take the Gorilla websocket example and instead of a broadcast be selective about the user you are sending to. <a href=\"https://github.com/gorilla/websocket/blob/master/examples/chat/hub.go\" rel=\"nofollow noreferrer\">github.com/gorilla/websocket/blob/master/examples/chat/hub.g&zwnj;&#8203;o</a>"}, {"owner": {"reputation": 149, "user_id": 1161498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a77a000b38dc2503007ae08762975e?s=128&d=identicon&r=PG&f=1", "display_name": "Rakzin Roman", "link": "https://stackoverflow.com/users/1161498/rakzin-roman"}, "edited": false, "score": 0, "creation_date": 1427147555, "post_id": 29220922, "comment_id": 46651177, "body": "I have used examples from <a href=\"https://www.youtube.com/watch?v=ysAZ_oqPOo0\" rel=\"nofollow noreferrer\">youtube.com/watch?v=ysAZ_oqPOo0</a>  and Gorilla, but i can not make message direct to user"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 4, "creation_date": 1427147628, "post_id": 29220922, "comment_id": 46651206, "body": "Right - well, we aren&#39;t going to write code for you. Show us what you have and explain the issues you&#39;re having and we can help you understand the problem."}, {"owner": {"reputation": 149, "user_id": 1161498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a77a000b38dc2503007ae08762975e?s=128&d=identicon&r=PG&f=1", "display_name": "Rakzin Roman", "link": "https://stackoverflow.com/users/1161498/rakzin-roman"}, "edited": false, "score": 0, "creation_date": 1427147958, "post_id": 29220922, "comment_id": 46651379, "body": "I have chat from <a href=\"https://github.com/jakecoffman/go-angular-tutorial/tree/master/tutorial_2\" rel=\"nofollow noreferrer\">github.com/jakecoffman/go-angular-tutorial/tree/master/&hellip;</a> and i have function send_to_all.  I want connected and write my id. Client send message {client_id:22,to_id:1,message:&#39;Hello&#39;}  and server send message to user 1 from user 22.     <a href=\"http://prntscr.com/6kj6k3\" rel=\"nofollow noreferrer\">prntscr.com/6kj6k3</a>"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 1161498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a77a000b38dc2503007ae08762975e?s=128&d=identicon&r=PG&f=1", "display_name": "Rakzin Roman", "link": "https://stackoverflow.com/users/1161498/rakzin-roman"}, "edited": false, "score": 0, "creation_date": 1427186351, "post_id": 29221860, "comment_id": 46663002, "body": "<a href=\"https://github.com/garyburd/gary.burd.info/tree/master/go-websocket-chat\" rel=\"nofollow noreferrer\">github.com/garyburd/gary.burd.info/tree/master/&hellip;</a>   I can compile, but dont work. Console show 0,5 sekunde and dont work"}, {"owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "reply_to_user": {"reputation": 149, "user_id": 1161498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a77a000b38dc2503007ae08762975e?s=128&d=identicon&r=PG&f=1", "display_name": "Rakzin Roman", "link": "https://stackoverflow.com/users/1161498/rakzin-roman"}, "edited": false, "score": 0, "creation_date": 1427244117, "post_id": 29221860, "comment_id": 46696681, "body": "@RomanRakzin The project has a <code>README.md</code> file, you can follow the instructions on how to build it by using the <code>README.md</code>"}], "tags": [], "owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "is_accepted": false, "score": 6, "last_activity_date": 1427150850, "creation_date": 1427150850, "answer_id": 29221860, "question_id": 29220922, "link": "https://stackoverflow.com/questions/29220922/how-to-create-golang-web-socket-chat/29221860#29221860", "title": "How to create golang web socket chat?", "body": "<p>Refer to this example GO chat application:</p>\n\n<pre><code>http://gary.burd.info/go-websocket-chat\n</code></pre>\n\n<p>I tested this out last year and it worked well. You can look at the code to see how it works.</p>\n"}, {"tags": [], "owner": {"reputation": 26894, "user_id": 19020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VpVEj.jpg?s=128&g=1", "display_name": "Dan Esparza", "link": "https://stackoverflow.com/users/19020/dan-esparza"}, "is_accepted": false, "score": 0, "last_activity_date": 1464724453, "creation_date": 1464724453, "answer_id": 37554526, "question_id": 29220922, "link": "https://stackoverflow.com/questions/29220922/how-to-create-golang-web-socket-chat/37554526#37554526", "title": "How to create golang web socket chat?", "body": "<p>Another great example is this: <a href=\"https://github.com/arschles/go-in-5-minutes/tree/master/episode4\" rel=\"nofollow\">https://github.com/arschles/go-in-5-minutes/tree/master/episode4</a></p>\n\n<p>There is a tutorial video that goes along with this source code:  <a href=\"https://www.youtube.com/watch?v=DJiOrGRsIKo\" rel=\"nofollow\">https://www.youtube.com/watch?v=DJiOrGRsIKo</a></p>\n"}], "owner": {"reputation": 149, "user_id": 1161498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a77a000b38dc2503007ae08762975e?s=128&d=identicon&r=PG&f=1", "display_name": "Rakzin Roman", "link": "https://stackoverflow.com/users/1161498/rakzin-roman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4771, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1464724453, "creation_date": 1427146790, "question_id": 29220922, "link": "https://stackoverflow.com/questions/29220922/how-to-create-golang-web-socket-chat", "title": "How to create golang web socket chat?", "body": "<p>Good afternoon. \nHow to create a golang web socket chat with the ability to send messages to the selected user, and not all?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 1, "creation_date": 1427147115, "post_id": 29220916, "comment_id": 46650965, "body": "Nice suggestion. I take things a step further usually and (using a CLI package or not..) split every high level command into its own file with its children. This keeps the files focused and doesn&#39;t cause too much bloat."}, {"owner": {"reputation": 1639, "user_id": 1015959, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8a7782834dfa58dd751b2cf92439db1?s=128&d=identicon&r=PG", "display_name": "Hank Lapidez", "link": "https://stackoverflow.com/users/1015959/hank-lapidez"}, "edited": false, "score": 0, "creation_date": 1427172260, "post_id": 29220916, "comment_id": 46658295, "body": "Thanks a lot ThunderCat. This works!. But why is it important to name the first file main.go? When it has an other name it does&#39;t.work. The variables then can not be resolved."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1427242900, "post_id": 29220916, "comment_id": 46696339, "body": "The file does not need to be named <code>main.go</code>. What is the exact error that you are getting from the <code>go build</code> or <code>go install</code> command?"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1427146777, "creation_date": 1427146777, "answer_id": 29220916, "question_id": 29219958, "link": "https://stackoverflow.com/questions/29219958/separate-implementation-in-own-files-in-same-package/29220916#29220916", "title": "Separate Implementation in own files in same package", "body": "<p>Here's one way of several ways to split the file up:</p>\n\n<p>In file main.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"github.com/codegangsta/cli\"\n)\n\nfunc main() {\n    app := cli.NewApp()\n    app.Commands = []cli.Command{\n        addCommand,\n        completeCommand,\n    }\n    app.Run(os.Args)\n} \n</code></pre>\n\n<p>In file comamnds.go write:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/codegangsta/cli\"\n)\n\nvar addCommand = cli.Command{\n        Name:      \"add\",\n        Usage:     \"add a task to the list\",\n        Action: func(c *cli.Context) {\n            println(\"added task: \", c.Args().First())\n        },\n    }\n\n var completeCommand cli.Command{\n        Name:      \"complete\",\n        Usage:     \"complete a task on the list\",\n        Action: func(c *cli.Context) {\n            println(\"completed task: \", c.Args().First())\n        },\n    }\n</code></pre>\n"}], "owner": {"reputation": 1639, "user_id": 1015959, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8a7782834dfa58dd751b2cf92439db1?s=128&d=identicon&r=PG", "display_name": "Hank Lapidez", "link": "https://stackoverflow.com/users/1015959/hank-lapidez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 29220916, "answer_count": 1, "score": 0, "last_activity_date": 1427146777, "creation_date": 1427143288, "question_id": 29219958, "link": "https://stackoverflow.com/questions/29219958/separate-implementation-in-own-files-in-same-package", "title": "Separate Implementation in own files in same package", "body": "<p>I am try to get hands dirty with golang. So I invented a small project and want do build a small console app with different commands. </p>\n\n<p>I found <a href=\"https://github.com/codegangsta/cli\" rel=\"nofollow\">codegangsta/cli</a> and tried the example. </p>\n\n<pre><code>    package main\n\nimport (\n    \"os\"\n\n\n    \"github.com/codegangsta/cli\"\n)\nfunc main() {\n    app := cli.NewApp()\n    app.Commands = []cli.Command{\n        {\n            Name:      \"add\",\n            Usage:     \"add a task to the list\",\n            Action: func(c *cli.Context) {\n                println(\"added task: \", c.Args().First())\n            },\n        },\n        {\n            Name:      \"complete\",\n            Usage:     \"complete a task on the list\",\n            Action: func(c *cli.Context) {\n                println(\"completed task: \", c.Args().First())\n            },\n        },\n\n    }\n    app.Run(os.Args)\n}\n</code></pre>\n\n<p>Now I want to put the commands in Commands-array in separate files and only reference them. </p>\n\n<p>How can I achieve this? </p>\n\n<p>Thanks for some advice.</p>\n"}, {"tags": ["arrays", "pointers", "go", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1427132395, "post_id": 29216252, "comment_id": 46642697, "body": "You seem to be trying to figure out the language via trial and error. You would be well served by carefully reading the <a href=\"http://golang.org/ref/spec\" rel=\"nofollow noreferrer\">Go Specification</a> and the <a href=\"http://golang.org/ref/mem\" rel=\"nofollow noreferrer\">Memory Model</a>"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 1, "creation_date": 1427151377, "post_id": 29216252, "comment_id": 46652788, "body": "This is the hackers way to learn. I&#39;d encourage it."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 1, "creation_date": 1427205639, "post_id": 29216252, "comment_id": 46675215, "body": "@thwd: nothing wrong with experimenting, just wanted to cover all bases first."}, {"owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "edited": false, "score": 2, "creation_date": 1443706289, "post_id": 29216252, "comment_id": 53607510, "body": "IMO too many down votes here.  this is a pedagogical and well intentioned post."}], "answers": [{"comments": [{"owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 0, "creation_date": 1427144556, "post_id": 29217199, "comment_id": 46649548, "body": "<a href=\"https://play.golang.org/p/Agq_hKws6M\" rel=\"nofollow noreferrer\">play.golang.org/p/Agq_hKws6M</a> As you can see in this code, that addPtr is pointing to the array, and not the slice header."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 2, "creation_date": 1427144954, "post_id": 29217199, "comment_id": 46649786, "body": "@aubble: stop bouncing between the Go mailing list and here. Keep the conversation on one forum or the other, otherwise you&#39;re wasting people time."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 0, "creation_date": 1427145074, "post_id": 29217199, "comment_id": 46649857, "body": "@aubble: that doesn&#39;t change my answer. I never mentioned here that addPtr isn&#39;t pointing to the array."}, {"owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 0, "creation_date": 1427145460, "post_id": 29217199, "comment_id": 46650081, "body": "&quot;You are printing out the address if the slice header in the function arguments&quot; But i&#39;m not. I am printing out the address of the array."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 0, "creation_date": 1427146123, "post_id": 29217199, "comment_id": 46650425, "body": "@aubble: clarified the wording here. You&#39;re passing the slice header by value, making a copy of it. Also, as an implementation detail, when you slice the original down to zero length and capacity, it doesn&#39;t zero out the Data pointer."}, {"owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 0, "creation_date": 1427146709, "post_id": 29217199, "comment_id": 46650744, "body": "You don&#39;t understand what I am saying. This shouldn&#39;t matter what so ever, the pointer gets copied by value, and points to the same array. Look at this code; <a href=\"https://play.golang.org/p/R8ARPdZiDx\" rel=\"nofollow noreferrer\">play.golang.org/p/R8ARPdZiDx</a>. There is definitely a array from make, whereas the nil slice gives me a error. The guy in the golang group explained how the compiler is making optimizations in the first code I was talking about. , I will post that discussion here for anyone who is looking for this in the future. <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/77XWCS2A_cY\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-nuts/77XWCS2A_cY</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 1, "creation_date": 1427147998, "post_id": 29217199, "comment_id": 46651392, "body": "@aubble: I&#39;m tiring of this game of semantics. The original response was about making an array with make, it makes a slice (since you mislabeled the slice literal, it stood to reason that you may have been confused about the two). It&#39;s perfectly reasonable that make might allocate a backing array, it&#39;s an implementation detail, but without checking the assembly or runtime source, there&#39;s no way to know if that&#39;s a valid address, or just an old value. (I&#39;m assuming it&#39;s cruft, since an immediate append allocates again). A true, 0-length array takes no memory, just like a <code>struct{}</code>."}, {"owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 0, "creation_date": 1427148135, "post_id": 29217199, "comment_id": 46651461, "body": "Yea, I guess I could have been much more clear. Completely my fault, sorry. Thanks anyways."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 3, "last_activity_date": 1427206356, "last_edit_date": 1427206356, "creation_date": 1427133617, "answer_id": 29217199, "question_id": 29216252, "link": "https://stackoverflow.com/questions/29216252/0-length-slices-and-arrays-in-golang/29217199#29217199", "title": "0 length slices and arrays in golang", "body": "<blockquote>\n  <p>I've noticed that the address of the first and last array is always\n  the exact same? Why?</p>\n  \n  <p>Why is this?</p>\n</blockquote>\n\n<p>You are basing the addresses in your function on the slice header in the function arguments. And by chance that function happens to run at the same memory address each time. Also, as an implementation detail, when you slice the original down to zero length and capacity, it doesn't zero out the Data pointer. In both your functions, the slice header is copied, so you're not even examining the original header slice to begin with.</p>\n\n<p>The second example, you're not correctly reading out the slice header.\nIf you want to play around, you don't need to try and do pointer arithmetic, and you you can take the address of the slice directly</p>\n\n<pre><code>hdr := (*reflect.SliceHeader)(unsafe.Pointer(&amp;slice))\n</code></pre>\n\n<p>Though, if you really want to inspect a slice header via pointer arithmetic, maybe this can better clarify what you need to do: <a href=\"https://play.golang.org/p/GL6NtyPNs8\" rel=\"nofollow\">https://play.golang.org/p/GL6NtyPNs8</a></p>\n\n<pre><code>func InspectSlice(slice *[]int) {\n    // Get the header directly by converting it to a reflect.SliceHeader\n    hdr := (*reflect.SliceHeader)(unsafe.Pointer(slice))\n\n    // Create a header for comparison via pointer manipulation\n    address := (uintptr)(unsafe.Pointer(slice))\n    lenAddr := address + unsafe.Sizeof(address)\n    capAddr := lenAddr + unsafe.Sizeof(int(0))\n\n    unsafeHdr := reflect.SliceHeader{\n        Data: *(*uintptr)(unsafe.Pointer(address)),\n        Len:  *(*int)(unsafe.Pointer(lenAddr)),\n        Cap:  *(*int)(unsafe.Pointer(capAddr)),\n    }\n\n    fmt.Printf(\"Real Header:  %#v\\n\", *hdr)\n    fmt.Printf(\"UnsafeHeader: %#v\\n\", unsafeHdr)\n\n}\n</code></pre>\n\n<blockquote>\n  <p>Also, why does make() even create an array?</p>\n</blockquote>\n\n<p>Make doesn't create an array, and what you have labeled as <code>array</code> is just a slice literal.</p>\n\n<blockquote>\n  <p>How does an array of length 0 even look in memory?</p>\n</blockquote>\n\n<p>It doesn't look like anything. It consumes 0 bytes.</p>\n\n<p>What you are seeing when making a zero-length slice is most likely a pointer to a global zero value array. Make a bunch zero length slices of different types, and the Data pointers will all be the same. Just as all empty <code>struct{}</code> and empty nil <code>interface{}</code> are given the same value as an optimization. This is entirely an implementation detail, as you are not expected to access that Data value. When slicing a slice back to zero length and capacity, the runtime also doesn't zero out the Data pointer. Because of these two behaviors, the Data pointer in any slice is rarely going to be nil. </p>\n"}], "owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1694, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1427206356, "creation_date": 1427130811, "question_id": 29216252, "link": "https://stackoverflow.com/questions/29216252/0-length-slices-and-arrays-in-golang", "title": "0 length slices and arrays in golang", "body": "<p>Was trying to figure out how 0 length arrays and slices behaved in Golang. Came up with two snippets of code (I found the code somewhere and modified it a bit to work with this)</p>\n\n<p><a href=\"https://play.golang.org/p/ew2YYgvpGC\" rel=\"nofollow\">https://play.golang.org/p/ew2YYgvpGC</a></p>\n\n<p><a href=\"https://play.golang.org/p/jm2p6L6WCG\" rel=\"nofollow\">https://play.golang.org/p/jm2p6L6WCG</a></p>\n\n<p>I learnt from the website that nil arrays ([]int(nil)) have a pointer value of nil, so I decided to test it. Sure enough, that is the case. I'm just confused on make and slicing an array. It has unexpected behaviour for me.</p>\n\n<p>I am really confused by the behaviour of these two. The first one runs fine on my computer and on the playground. I've noticed that the address of the first and last array is always the exact same? Why?</p>\n\n<p>Why is this?</p>\n\n<p>The second one is weirder. This is the exact same code as the previous one, except there are snippets of other code for the len/cap in between. It does not run on the go playground, there is an error at the last one with the sliced array, for some reason, the slice gets a length of 3 (on my computer it is 0 for the last one, and the cap for all of them is 272851504). It does run on my computer however. I noticed that the address of the first array created with make is always smaller than the last one. Its always different, and a bit smaller (the first one), why? There is no change in the code for the address of the array</p>\n\n<p>Also, why does make() even create an array? How does an array of length 0 even look in memory?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 19482, "user_id": 1048862, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a0f604322f5a3e0b11aad4c3529f83b5?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/1048862/matt"}, "edited": false, "score": 5, "creation_date": 1427124345, "post_id": 29213974, "comment_id": 46637466, "body": "Sounds like the JSON body you&#39;re decoding doesn&#39;t quote the distance field as a string. What is the JSON body you&#39;re trying to unmarshal?"}, {"owner": {"reputation": 833, "user_id": 1043625, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OQ3hw.jpg?s=128&g=1", "display_name": "rlhh", "link": "https://stackoverflow.com/users/1043625/rlhh"}, "reply_to_user": {"reputation": 19482, "user_id": 1048862, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a0f604322f5a3e0b11aad4c3529f83b5?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/1048862/matt"}, "edited": false, "score": 0, "creation_date": 1427215068, "post_id": 29213974, "comment_id": 46682418, "body": "@Matt I&#39;ve updated my question with more information."}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 1, "last_activity_date": 1427127148, "last_edit_date": 1427127148, "creation_date": 1427125887, "answer_id": 29214611, "question_id": 29213974, "link": "https://stackoverflow.com/questions/29213974/using-json-string-returning-invalid-use-of-string-struct-tag-trying-to-un/29214611#29214611", "title": "Using `json:&quot;,string&quot;` returning invalid use of ,string struct tag, trying to unmarshal unquoted value", "body": "<p>This error happens when the \"distance\" JSON value is encoded as a number instead of a string (per the \"string\" tag on the \"Distance\") field:</p>\n\n<pre><code>str := []byte(`{\"distance\":1.23,\"distanceSource\":\"foo\"}`)\n// Note JSON number -------^\nvar cbr CreateBookingRequest\nerr := json.Unmarshal(str, &amp;cbr)\n// err =&gt; json: invalid use of ,string struct tag, trying to unmarshal unquoted value into [34 100 105 115 116 97 110 99 101 34]%!(EXTRA *reflect.rtype=main.CreateBookingRequest)\n</code></pre>\n\n<p>If you change the type of the distance value to a string (per the tag) then it works fine:</p>\n\n<pre><code>str := []byte(`{\"distance\":\"1.23\",\"distanceSource\":\"foo\"}`)\n// Note JSON string -------^\n</code></pre>\n\n<p>You could change the error message by identifying that specific error somehow and provide a different message.  You might also consider changing the tag for the Distance type to simply accept a number instead of a string:</p>\n\n<pre><code>type CreateBookingRequest struct {\n  Distance       float64 `json:\"distance\"`\n  ...\n}\n\n...\n  str := []byte(`{\"distance\":1.23,\"distanceSource\":\"foo\"}`)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1427127746, "creation_date": 1427127746, "answer_id": 29215263, "question_id": 29213974, "link": "https://stackoverflow.com/questions/29213974/using-json-string-returning-invalid-use-of-string-struct-tag-trying-to-un/29215263#29215263", "title": "Using `json:&quot;,string&quot;` returning invalid use of ,string struct tag, trying to unmarshal unquoted value", "body": "<p>The error is simply saying you designated <code>Distance</code> as a string with your json annotations but in the json string you're trying to deserialize the value is not quoted (therefor not a string).</p>\n\n<p>The solution is simple, either change this <code>json:\"distance,string\"</code> to <code>json:\"distance\"</code> or get json that matches your definition (meaning it has distince in quotes like <code>\"Distance\":\"10.4\"</code>)</p>\n\n<p>Given, the error and the fact that your native Go type is a float64 I would advise getting rid of the string annotation.</p>\n"}, {"tags": [], "owner": {"reputation": 7514, "user_id": 1008837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f67dc852a25a639e13fafbec62eec69?s=128&d=identicon&r=PG&f=1", "display_name": "Pravin Mishra", "link": "https://stackoverflow.com/users/1008837/pravin-mishra"}, "is_accepted": false, "score": 1, "last_activity_date": 1427128532, "creation_date": 1427128532, "answer_id": 29215547, "question_id": 29213974, "link": "https://stackoverflow.com/questions/29213974/using-json-string-returning-invalid-use-of-string-struct-tag-trying-to-un/29215547#29215547", "title": "Using `json:&quot;,string&quot;` returning invalid use of ,string struct tag, trying to unmarshal unquoted value", "body": "<p><a href=\"http://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow\">func unmarshal</a> state: </p>\n\n<blockquote>\n  <p>To unmarshal JSON into a struct, Unmarshal matches incoming object\n  keys to the keys used by Marshal (either the struct field name or its\n  tag), preferring an exact match but also accepting a case-insensitive\n  match.</p>\n</blockquote>\n\n<pre><code>bool, for JSON booleans\nfloat64, for JSON numbers\nstring, for JSON strings\n[]interface{}, for JSON arrays\nmap[string]interface{}, for JSON objects\nnil for JSON null\n</code></pre>\n\n<p>So, unmarshal expecting Distance should be <code>float64</code> by default. But as per tag, you are requesting unmarshal to except Distance as <code>string</code>. Here is data type missing matches.</p>\n\n<p>So you have two options, either you change distance tag with <a href=\"http://play.golang.org/p/nrz41IS8pr\" rel=\"nofollow\">float64</a> or marshal distance as <a href=\"http://play.golang.org/p/JQ5p6FAxxx\" rel=\"nofollow\">string</a>.    </p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1437679088, "post_id": 31595318, "comment_id": 51144192, "body": "I&#39;d avoid the use of regexp. If I had to deal with such a JSON &quot;type&quot; I&#39;d make my own Go type with <a href=\"https://play.golang.org/p/KNPxDL1yqL\" rel=\"nofollow noreferrer\">appropriate MarshalJSON and UnmarshalJSON methods</a> that used one of <code>bytes.Trim</code>, <code>bytes.TrimFunc</code>, or <code>data = data[1:len(data)-1]</code> depending on the exact needs."}, {"owner": {"reputation": 4081, "user_id": 242684, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d73353bb2ecd4cd2a2bbeefe30116a7e?s=128&d=identicon&r=PG", "display_name": "Alec Mev", "link": "https://stackoverflow.com/users/242684/alec-mev"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1437684788, "post_id": 31595318, "comment_id": 51147374, "body": "@DaveC You should post that as an answer, it does exactly what is needed and is as idiomatic as it gets."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1437692720, "post_id": 31595318, "comment_id": 51150578, "body": "Except the original question doesn&#39;t need/want to accept both formats. They wanted just strings (with a readable user error otherwise)."}, {"owner": {"reputation": 4081, "user_id": 242684, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d73353bb2ecd4cd2a2bbeefe30116a7e?s=128&d=identicon&r=PG", "display_name": "Alec Mev", "link": "https://stackoverflow.com/users/242684/alec-mev"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1437721152, "post_id": 31595318, "comment_id": 51158727, "body": "That&#39;s correct, I&#39;ve confused it with a similar thread in golang-nuts. Well, I&#39;ll post a self-answered question then :)"}], "tags": [], "owner": {"reputation": 4081, "user_id": 242684, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d73353bb2ecd4cd2a2bbeefe30116a7e?s=128&d=identicon&r=PG", "display_name": "Alec Mev", "link": "https://stackoverflow.com/users/242684/alec-mev"}, "is_accepted": false, "score": 2, "last_activity_date": 1437675970, "creation_date": 1437675970, "answer_id": 31595318, "question_id": 29213974, "link": "https://stackoverflow.com/questions/29213974/using-json-string-returning-invalid-use-of-string-struct-tag-trying-to-un/31595318#31595318", "title": "Using `json:&quot;,string&quot;` returning invalid use of ,string struct tag, trying to unmarshal unquoted value", "body": "<p>I had to work with an API which sometimes quotes numbers and sometimes doesn't. The owners of the service weren't likely to fix it, so I came up with a simple workaround:</p>\n\n<pre><code>re := regexp.MustCompile(`(\":\\s*)([\\d\\.]+)(\\s*[,}])`)\nrawJsonByteArray = re.ReplaceAll(rawJsonByteArray, []byte(`$1\"$2\"$3`))\n</code></pre>\n\n<p>Regular expressions are somewhat inefficient, but I don't believe I'd be able to implement something substantially faster.</p>\n"}], "owner": {"reputation": 833, "user_id": 1043625, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/OQ3hw.jpg?s=128&g=1", "display_name": "rlhh", "link": "https://stackoverflow.com/users/1043625/rlhh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5497, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1437675970, "creation_date": 1427124118, "last_edit_date": 1427215028, "question_id": 29213974, "link": "https://stackoverflow.com/questions/29213974/using-json-string-returning-invalid-use-of-string-struct-tag-trying-to-un", "title": "Using `json:&quot;,string&quot;` returning invalid use of ,string struct tag, trying to unmarshal unquoted value", "body": "<p>When trying to parse a json with a float value for distance to the following struct</p>\n\n<pre><code>type CreateBookingRequest struct {\n    Distance          float64           `json:\"distance,string\"`\n    DistanceSource    string            `json:\"distanceSource\"`\n}\n</code></pre>\n\n<p>I get the following error</p>\n\n<blockquote>\n  <p>json: invalid use of ,string struct tag, trying to unmarshal unquoted\n  value into [34 100 105 115 116 97 110 99 101 34]%!(EXTRA\n  *reflect.rtype=dto.CreateBookingRequest)</p>\n</blockquote>\n\n<p>Is there a way for me to avoid the error/get a better error message? </p>\n\n<p><strong>Edit:</strong>\nI am actually expecting the users of the API to pass in a string value but if they for some reason pass in a non-string value, I would like to be able to tell them clearly, instead of this hard to read error message. </p>\n"}, {"tags": ["go", "pathname"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1427140711, "post_id": 29213429, "comment_id": 46647402, "body": "In addition to <code>Clean</code> consider <code>filepath.EvalSymlinks()</code> and <code>filepath.Abs()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1427190364, "last_edit_date": 1427190364, "creation_date": 1427123206, "answer_id": 29213654, "question_id": 29213429, "link": "https://stackoverflow.com/questions/29213429/checking-if-a-file-is-in-a-given-directory/29213654#29213654", "title": "Checking if a file is in a given directory", "body": "<p>You're not missing anything, look at the source:</p>\n\n<pre><code>// HasPrefix exists for historical compatibility and should not be used.\nfunc HasPrefix(p, prefix string) bool {\n    return strings.HasPrefix(p, prefix)\n}\n</code></pre>\n\n<p>Just use <code>strings.HasPrefix(p, prefix)</code> directly.</p>\n"}, {"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 1, "last_activity_date": 1427123298, "creation_date": 1427123298, "answer_id": 29213688, "question_id": 29213429, "link": "https://stackoverflow.com/questions/29213429/checking-if-a-file-is-in-a-given-directory/29213688#29213688", "title": "Checking if a file is in a given directory", "body": "<p>In Go 1.4 method <code>filepath.HasPrefix</code> <a href=\"http://golang.org/src/path/filepath/path_unix.go?s=606:643#L13\" rel=\"nofollow\">actually calls</a> <code>strings.HasPrefix</code> so the answer is yes.</p>\n"}, {"tags": [], "owner": {"reputation": 404, "user_id": 1361836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abfc3c69a8e326fa8ea1b4acad286ebf?s=128&d=identicon&r=PG", "display_name": "B-Con", "link": "https://stackoverflow.com/users/1361836/b-con"}, "is_accepted": false, "score": 0, "last_activity_date": 1559951343, "creation_date": 1559951343, "answer_id": 56502308, "question_id": 29213429, "link": "https://stackoverflow.com/questions/29213429/checking-if-a-file-is-in-a-given-directory/56502308#56502308", "title": "Checking if a file is in a given directory", "body": "<p>While you will get the same functionality with <code>strings.HasPrefix</code>, it doesn't work in general. <code>filepath.HasPrefix</code> is deprecated for a reason and it's approach should be considered deprecated too.</p>\n\n<p>Consider <code>filename=/foo/bar</code> and <code>prefix=/fo</code>. This passes the <code>strings.HasPrefix</code> test but clearly <code>bar</code> is not in <code>/fo</code>.</p>\n\n<p>The proper approach would compare each directory name holistically.</p>\n"}], "owner": {"reputation": 13264, "user_id": 190887, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b1a747d0a7e3450408e0f07adba49111?s=128&d=identicon&r=PG", "display_name": "Inaimathi", "link": "https://stackoverflow.com/users/190887/inaimathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 29213654, "answer_count": 3, "score": 2, "last_activity_date": 1559951343, "creation_date": 1427122593, "last_edit_date": 1427207054, "question_id": 29213429, "link": "https://stackoverflow.com/questions/29213429/checking-if-a-file-is-in-a-given-directory", "title": "Checking if a file is in a given directory", "body": "<p>I've got a situation where I'd like to check whether a particular path lands inside of a particular directory. My first instinct was to do something like</p>\n\n<pre><code>filepath.HasPrefix(filepath.Clean(path), dir)\n</code></pre>\n\n<p>but the procedure <code>filepath.HasPrefix</code> is <a href=\"http://golang.org/pkg/path/filepath/#HasPrefix\" rel=\"nofollow\">documented as existing for historic reasons only</a>. Am I going to get the same effect by using <code>strings.HasPrefix</code>, or is there something I'm missing?</p>\n"}, {"tags": ["sql", "go", "driver", "sql-server-2014"], "comments": [{"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1427163103, "post_id": 29212758, "comment_id": 46656106, "body": "why doesn&#39;t <code>database&#47;mssql</code> work?"}, {"owner": {"reputation": 125, "user_id": 4504743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a788ca4208f56fc870d13d3852c55e5c?s=128&d=identicon&r=PG&f=1", "display_name": "Lee Denson", "link": "https://stackoverflow.com/users/4504743/lee-denson"}, "reply_to_user": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1427398124, "post_id": 29212758, "comment_id": 46771691, "body": "For some reason I got undefined config errors in the mssql package"}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 4504743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a788ca4208f56fc870d13d3852c55e5c?s=128&d=identicon&r=PG&f=1", "display_name": "Lee Denson", "link": "https://stackoverflow.com/users/4504743/lee-denson"}, "edited": false, "score": 0, "creation_date": 1427398364, "post_id": 29241240, "comment_id": 46771807, "body": "It&#39;s the same issue.  I think it has something to do with setting up an odbc on the remote sql server and setting the right group permissions."}, {"owner": {"reputation": 125, "user_id": 4504743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a788ca4208f56fc870d13d3852c55e5c?s=128&d=identicon&r=PG&f=1", "display_name": "Lee Denson", "link": "https://stackoverflow.com/users/4504743/lee-denson"}, "edited": false, "score": 0, "creation_date": 1427901207, "post_id": 29241240, "comment_id": 46965493, "body": "I changed the driver and it connected. Thank you!!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4158347"}, "edited": false, "score": 0, "creation_date": 1519954901, "post_id": 29241240, "comment_id": 85128119, "body": "All of the documentation is god awful... Why doesn&#39;t is exact the EXACT connection string from my DB? Every &quot;guide&quot; you read is completely different. Does no one actually know the best wa yto do this yet or something?"}], "tags": [], "owner": {"reputation": 852, "user_id": 3557679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41a6a162eaae49373538db6356e0dda3?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Yeah", "link": "https://stackoverflow.com/users/3557679/mr-yeah"}, "is_accepted": true, "score": 6, "last_activity_date": 1427225406, "creation_date": 1427225406, "answer_id": 29241240, "question_id": 29212758, "link": "https://stackoverflow.com/questions/29212758/connect-to-sql-server-2014-in-go-lang/29241240#29241240", "title": "Connect to SQL Server 2014 in Go Lang", "body": "<p>Try <a href=\"http://golang.org/pkg/database/sql/\" rel=\"noreferrer\">database/sql</a> with the <a href=\"https://github.com/denisenkom/go-mssqldb\" rel=\"noreferrer\">github.com/denisenkom/go-mssqldb</a> driver.</p>\n"}], "owner": {"reputation": 125, "user_id": 4504743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a788ca4208f56fc870d13d3852c55e5c?s=128&d=identicon&r=PG&f=1", "display_name": "Lee Denson", "link": "https://stackoverflow.com/users/4504743/lee-denson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9180, "favorite_count": 0, "accepted_answer_id": 29241240, "answer_count": 1, "score": 2, "last_activity_date": 1543490949, "creation_date": 1427120749, "last_edit_date": 1427162986, "question_id": 29212758, "link": "https://stackoverflow.com/questions/29212758/connect-to-sql-server-2014-in-go-lang", "title": "Connect to SQL Server 2014 in Go Lang", "body": "<p>I had a working database connection on a windows 7 machine to SQL Server 2008 R2 using:</p>\n\n<pre><code>     db, err = sqlx.Open(\"lodbc\", connString)\n</code></pre>\n\n<p>importing the following packages</p>\n\n<pre><code>     \"github.com/LukeMauldin/lodbc\"\n     \"github.com/jmoiron/sqlx\"\n</code></pre>\n\n<p>But now using the same driver and changing the connection string to a 2014 SQL Server database located on a remote windows 8 machine, I get a successful connection but a sqlx query breaks saying</p>\n\n<blockquote>\n  <p>datasource 2015/03/23 09:09:37 http: panic serving 127.0.0.1:49346: {IM002} [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified</p>\n</blockquote>\n\n<p>Is there another driver I can use? I tried <a href=\"https://code.google.com/p/odbc/\" rel=\"nofollow\">code.google.com/p/odbc</a> and database/mssql packages and those didn't work.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "routes", "url-mapping"], "answers": [{"comments": [{"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 17, "creation_date": 1427124602, "post_id": 29214098, "comment_id": 46637658, "body": "If you can&#39;t without external libraries, how are those libraries implemented?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 8, "creation_date": 1427124684, "post_id": 29214098, "comment_id": 46637720, "body": "@\u0440\u0430\u0439\u0442\u0444\u043e\u043b\u0434 they are implemented at the lowest level, bypassing the default http router. I understood OP&#39;s question as &quot;is there a way to do this using the default http library&quot;. Well - just to implement your own router. And there really isn&#39;t a need for that."}, {"owner": {"reputation": 923, "user_id": 2511892, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/378315f8cf1daaf1641ac2ff7dc1adc1?s=128&d=identicon&r=PG", "display_name": "Steven Eckhoff", "link": "https://stackoverflow.com/users/2511892/steven-eckhoff"}, "edited": false, "score": 0, "creation_date": 1596624464, "post_id": 29214098, "comment_id": 111869353, "body": "I&#39;d also recommend chi - <a href=\"https://github.com/go-chi/chi\" rel=\"nofollow noreferrer\">github.com/go-chi/chi</a>"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 14, "last_activity_date": 1427124471, "creation_date": 1427124471, "answer_id": 29214098, "question_id": 29211241, "link": "https://stackoverflow.com/questions/29211241/go-url-parameters-mapping/29214098#29214098", "title": "Go url parameters mapping", "body": "<p>Well, without external libraries you can't, but may I recommend two excellent ones: </p>\n\n<ol>\n<li><p>httprouter - <a href=\"https://github.com/julienschmidt/httprouter\">https://github.com/julienschmidt/httprouter</a> - is extremely fast and very lightweight. It's faster than the standard library's router, and it creates 0 allocations per call, which is great in a GCed language.</p></li>\n<li><p>Gorilla Mux - <a href=\"http://www.gorillatoolkit.org/pkg/mux\">http://www.gorillatoolkit.org/pkg/mux</a> -\nVery popular, nice interface, nice community.</p></li>\n</ol>\n\n<p>Example usage of httprouter:</p>\n\n<pre><code>func Hello(w http.ResponseWriter, r *http.Request, ps httprouter.Params) {\n    fmt.Fprintf(w, \"hello, %s!\\n\", ps.ByName(\"name\"))\n}\n\nfunc main() {\n    router := httprouter.New()\n    router.GET(\"/hello/:name\", Hello)\n\n    log.Fatal(http.ListenAndServe(\":8080\", router))\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1506, "user_id": 8689709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd57855e7bff23fbca35abc8ddc0073?s=128&d=identicon&r=PG", "display_name": "Bill Zelenko", "link": "https://stackoverflow.com/users/8689709/bill-zelenko"}, "edited": false, "score": 0, "creation_date": 1536721938, "post_id": 29221954, "comment_id": 91521822, "body": "<a href=\"https://husobee.github.io/golang/urlrouter/vestigo/2015/09/22/vesigo.html\" rel=\"nofollow noreferrer\">Vestigo</a> is another good router."}], "tags": [], "owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "is_accepted": true, "score": 26, "last_activity_date": 1427151293, "creation_date": 1427151293, "answer_id": 29221954, "question_id": 29211241, "link": "https://stackoverflow.com/questions/29211241/go-url-parameters-mapping/29221954#29221954", "title": "Go url parameters mapping", "body": "<p>There is no built in simple way to do this, however, it is not hard to do.</p>\n\n<p>This is how I do it, without adding a particular library. It is placed in a function so that you can invoke a simple <code>getCode()</code> function within your request handler.</p>\n\n<p>Basically you just split the <code>r.URL.Path</code> into parts, and then analyse the parts.</p>\n\n<pre><code>// Extract a code from a URL. Return the default code if code\n// is missing or code is not a valid number.\nfunc getCode(r *http.Request, defaultCode int) (int, string) {\n        p := strings.Split(r.URL.Path, \"/\")\n        if len(p) == 1 {\n                return defaultCode, p[0]\n        } else if len(p) &gt; 1 {\n                code, err := strconv.Atoi(p[0])\n                if err == nil {\n                        return code, p[1]\n                } else {\n                        return defaultCode, p[1]\n                }\n        } else {\n                return defaultCode, \"\"\n        }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "edited": false, "score": 0, "creation_date": 1536812831, "post_id": 34914847, "comment_id": 91560474, "body": "Before I go searching for a library, I want to know if it can be done in golang. (Also, Stackoverflow bans questions asking about choosing libraries)"}, {"owner": {"reputation": 659, "user_id": 1155514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mjZMX.jpg?s=128&g=1", "display_name": "Muhammad Tariq", "link": "https://stackoverflow.com/users/1155514/muhammad-tariq"}, "edited": false, "score": 0, "creation_date": 1611509858, "post_id": 34914847, "comment_id": 116469056, "body": "Please provide a sample solution if you are suggesting something. Your answer is not helpful to the readers. Provide a sample to question asked using <code>Beego</code>"}], "tags": [], "owner": {"reputation": 579, "user_id": 4992577, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ptHfrI1YK_I/AAAAAAAAAAI/AAAAAAAAAAA/-avow-AWQy4/photo.jpg?sz=128", "display_name": "Arief Hidayatulloh", "link": "https://stackoverflow.com/users/4992577/arief-hidayatulloh"}, "is_accepted": false, "score": 0, "last_activity_date": 1463821090, "last_edit_date": 1463821090, "creation_date": 1453346588, "answer_id": 34914847, "question_id": 29211241, "link": "https://stackoverflow.com/questions/29211241/go-url-parameters-mapping/34914847#34914847", "title": "Go url parameters mapping", "body": "<p>No way without standard library. Why you don't want to try some library? I think its not so hard to use it, just go get bla bla bla</p>\n\n<p>I use <a href=\"http://beego.me/\" rel=\"nofollow\">Beego</a>. Its MVC style.</p>\n"}, {"comments": [{"owner": {"reputation": 904, "user_id": 2375154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad8ebac3a35c2186ac40373816f8f8ba?s=128&d=identicon&r=PG", "display_name": "Alexander K&#246;b", "link": "https://stackoverflow.com/users/2375154/alexander-k%c3%b6b"}, "edited": false, "score": 1, "creation_date": 1548633912, "post_id": 36238873, "comment_id": 95599841, "body": "You might want to read about iris before you use it, eg: <a href=\"https://www.reddit.com/r/golang/comments/57w79c/why_you_really_should_stop_using_iris/\" rel=\"nofollow noreferrer\">reddit.com/r/golang/comments/57w79c/&hellip;</a>"}], "tags": [], "owner": {"reputation": 769, "user_id": 2647655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qGHOi.png?s=128&g=1", "display_name": "kataras", "link": "https://stackoverflow.com/users/2647655/kataras"}, "is_accepted": false, "score": -9, "last_activity_date": 1487819418, "last_edit_date": 1487819418, "creation_date": 1459015517, "answer_id": 36238873, "question_id": 29211241, "link": "https://stackoverflow.com/questions/29211241/go-url-parameters-mapping/36238873#36238873", "title": "Go url parameters mapping", "body": "<p>If you need a framework and you think it will be slow because it's 'bigger' than a router or net/http, then you 're wrong.</p>\n\n<p><a href=\"http://iris-go.com\" rel=\"nofollow noreferrer\">Iris</a> is the fastest <strong>go web framework</strong> that you will ever find, so far according to all benchmarks.</p>\n\n<p>Install by </p>\n\n<pre><code>  go get gopkg.in/kataras/iris.v6\n</code></pre>\n\n<p>Django templates goes easy with iris: </p>\n\n<pre><code>import (\n    \"gopkg.in/kataras/iris.v6\"\n    \"gopkg.in/kataras/iris.v6/adaptors/httprouter\"\n    \"gopkg.in/kataras/iris.v6/adaptors/view\" // &lt;-----\n\n)\n\nfunc main() {\n\n    app := iris.New()\n    app.Adapt(iris.DevLogger())\n    app.Adapt(httprouter.New()) // you can choose gorillamux too\n    app.Adapt(view.Django(\"./templates\", \".html\")) // &lt;-----\n\n    // RESOURCE: http://127.0.0.1:8080/hi\n    // METHOD: \"GET\"\n    app.Get(\"/hi\", hi)\n\n    app.Listen(\":8080\")\n}\n\nfunc hi(ctx *iris.Context){\n   ctx.Render(\"hi.html\", iris.Map{\"Name\": \"iris\"})\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 40406, "user_id": 459, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0db193fbf6f0929c49dd9704698204ff?s=128&d=identicon&r=PG", "display_name": "dlamblin", "link": "https://stackoverflow.com/users/459/dlamblin"}, "edited": false, "score": 1, "creation_date": 1586533745, "post_id": 38386916, "comment_id": 108169317, "body": "Is it just me, or does this do the inverse of what was asked?"}], "tags": [], "owner": {"reputation": 2051, "user_id": 474002, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Oqy8c.jpg?s=128&g=1", "display_name": "Browny Lin", "link": "https://stackoverflow.com/users/474002/browny-lin"}, "is_accepted": false, "score": 2, "last_activity_date": 1468549215, "creation_date": 1468549215, "answer_id": 38386916, "question_id": 29211241, "link": "https://stackoverflow.com/questions/29211241/go-url-parameters-mapping/38386916#38386916", "title": "Go url parameters mapping", "body": "<p>How about writing your own url generator (extend <code>net/url</code> a little bit) as below.</p>\n\n<pre><code>// --- This is how does it work like --- //\nurl, _ := rest.NewURLGen(\"http\", \"stack.over.flow\", \"1234\").\n    Pattern(foo/:foo_id/bar/:bar_id).\n    ParamQuery(\"foo_id\", \"abc\").\n    ParamQuery(\"bar_id\", \"xyz\").\n    ParamQuery(\"page\", \"1\").\n    ParamQuery(\"offset\", \"5\").\n    Do()\n\nlog.Printf(\"url: %s\", url) \n// url: http://stack.over.flow:1234/foo/abc/bar/xyz?page=1&amp;offset=5\n\n// --- Your own url generator would be like below --- //\npackage rest\n\nimport (\n    \"log\"\n    \"net/url\"\n    \"strings\"\n\n    \"straas.io/base/errors\"\n\n    \"github.com/jinzhu/copier\"\n)\n\n// URLGen generates request URL\ntype URLGen struct {\n    url.URL\n\n    pattern    string\n    paramPath  map[string]string\n    paramQuery map[string]string\n}\n\n// NewURLGen new a URLGen\nfunc NewURLGen(scheme, host, port string) *URLGen {\n    h := host\n    if port != \"\" {\n        h += \":\" + port\n    }\n\n    ug := URLGen{}\n    ug.Scheme = scheme\n    ug.Host = h\n    ug.paramPath = make(map[string]string)\n    ug.paramQuery = make(map[string]string)\n\n    return &amp;ug\n}\n\n// Clone return copied self\nfunc (u *URLGen) Clone() *URLGen {\n    cloned := &amp;URLGen{}\n    cloned.paramPath = make(map[string]string)\n    cloned.paramQuery = make(map[string]string)\n\n    err := copier.Copy(cloned, u)\n    if err != nil {\n        log.Panic(err)\n    }\n\n    return cloned\n}\n\n// Pattern sets path pattern with placeholder (format `:&lt;holder_name&gt;`)\nfunc (u *URLGen) Pattern(pattern string) *URLGen {\n    u.pattern = pattern\n    return u\n}\n\n// ParamPath builds path part of URL\nfunc (u *URLGen) ParamPath(key, value string) *URLGen {\n    u.paramPath[key] = value\n    return u\n}\n\n// ParamQuery builds query part of URL\nfunc (u *URLGen) ParamQuery(key, value string) *URLGen {\n    u.paramQuery[key] = value\n    return u\n}\n\n// Do returns final URL result.\n// The result URL string is possible not escaped correctly.\n// This is input for `gorequest`, `gorequest` will handle URL escape.\nfunc (u *URLGen) Do() (string, error) {\n    err := u.buildPath()\n    if err != nil {\n        return \"\", err\n    }\n    u.buildQuery()\n\n    return u.String(), nil\n}\n\nfunc (u *URLGen) buildPath() error {\n    r := []string{}\n    p := strings.Split(u.pattern, \"/\")\n\n    for i := range p {\n        part := p[i]\n        if strings.Contains(part, \":\") {\n            key := strings.TrimPrefix(p[i], \":\")\n\n            if val, ok := u.paramPath[key]; ok {\n                r = append(r, val)\n            } else {\n                if i != len(p)-1 {\n                    // if placeholder at the end of pattern, it could be not provided\n                    return errors.Errorf(\"placeholder[%s] not provided\", key)\n                }\n            }\n            continue\n        }\n        r = append(r, part)\n    }\n\n    u.Path = strings.Join(r, \"/\")\n    return nil\n}\n\nfunc (u *URLGen) buildQuery() {\n    q := u.URL.Query()\n    for k, v := range u.paramQuery {\n        q.Set(k, v)\n    }\n    u.RawQuery = q.Encode()\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15416, "user_id": 2441637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z8fpp.jpg?s=128&g=1", "display_name": "Hasan A Yousef", "link": "https://stackoverflow.com/users/2441637/hasan-a-yousef"}, "edited": false, "score": 0, "creation_date": 1610302801, "post_id": 64801630, "comment_id": 116084194, "body": "This is the opposite of the question, the question is if the url is: <code>http:&#47;&#47;localhost:8080&#47;blob&#47;123&#47;test</code> the appis required to read it and tell the <code>:id = 123</code>"}], "tags": [], "owner": {"reputation": 2725, "user_id": 303114, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/kBVST.jpg?s=128&g=1", "display_name": "danfromisrael", "link": "https://stackoverflow.com/users/303114/danfromisrael"}, "is_accepted": false, "score": -1, "last_activity_date": 1605174796, "creation_date": 1605174796, "answer_id": 64801630, "question_id": 29211241, "link": "https://stackoverflow.com/questions/29211241/go-url-parameters-mapping/64801630#64801630", "title": "Go url parameters mapping", "body": "<p>how about a simple utility function ?</p>\n<pre><code>func withURLParams(u url.URL, param, val string) url.URL{\n    u.Path = strings.ReplaceAll(u.Path, param, val)\n    return u\n}\n</code></pre>\n<p>you can use it like this:</p>\n<pre><code>u, err := url.Parse(&quot;http://localhost:8080/blob/:id/test&quot;)\nif err != nil {\n    return nil, err\n}\nu := withURLParams(u, &quot;:id&quot;,&quot;123&quot;)\n\n// now u.String() is http://localhost:8080/blob/123/test\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1610307345, "post_id": 65657064, "comment_id": 116085606, "body": "While <code>regexp</code> would work, it is a lot slower than the accepted answer. Also there are enough routers written nowadays that do this and we really do not need to reimplement this again and again."}], "tags": [], "owner": {"reputation": 15416, "user_id": 2441637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z8fpp.jpg?s=128&g=1", "display_name": "Hasan A Yousef", "link": "https://stackoverflow.com/users/2441637/hasan-a-yousef"}, "is_accepted": false, "score": 3, "last_activity_date": 1610307366, "last_edit_date": 1610307366, "creation_date": 1610304011, "answer_id": 65657064, "question_id": 29211241, "link": "https://stackoverflow.com/questions/29211241/go-url-parameters-mapping/65657064#65657064", "title": "Go url parameters mapping", "body": "<p>What about trying using regex, and find a named group in your url, like <a href=\"https://play.golang.org/p/4xUqVCTqC5S\" rel=\"nofollow noreferrer\">playground</a>:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;net/url&quot;\n    &quot;regexp&quot;\n)\n\nvar myExp = regexp.MustCompile(`/blob/(?P&lt;id&gt;\\d+)/test`) // use (?P&lt;id&gt;[a-zA-Z]+) if the id is alphapatic\n\nfunc main() {\n\n    s := &quot;http://localhost:8080/blob/123/test&quot;\n\n    u, err := url.Parse(s)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(u.Path)\n\n    match := myExp.FindStringSubmatch(s) // or match := myExp.FindStringSubmatch(u.Path)\n    result := make(map[string]string)\n    for i, name := range myExp.SubexpNames() {\n        if i != 0 &amp;&amp; name != &quot;&quot; {\n            result[name] = match[i]\n        }\n    }\n    fmt.Printf(&quot;id: %s\\n&quot;, result[&quot;id&quot;])\n\n}\n</code></pre>\n<p>output</p>\n<pre class=\"lang-sh prettyprint-override\"><code>/blob/123/test\nid: 123\n</code></pre>\n<p>Below full code to use it with url, that is receiving <code>http://localhost:8000/hello/John/58</code> and returning <code>http://localhost:8000/hello/John/58</code>:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;net/http&quot;\n    &quot;regexp&quot;\n    &quot;strconv&quot;\n)\n\nvar helloExp = regexp.MustCompile(`/hello/(?P&lt;name&gt;[a-zA-Z]+)/(?P&lt;age&gt;\\d+)`)\n\nfunc hello(w http.ResponseWriter, req *http.Request) {\n    match := helloExp.FindStringSubmatch(req.URL.Path)\n    if len(match) &gt; 0 {\n        result := make(map[string]string)\n        for i, name := range helloExp.SubexpNames() {\n            if i != 0 &amp;&amp; name != &quot;&quot; {\n                result[name] = match[i]\n            }\n        }\n        if _, err := strconv.Atoi(result[&quot;age&quot;]); err == nil {\n            fmt.Fprintf(w, &quot;Hello, %v year old named %s!&quot;, result[&quot;age&quot;], result[&quot;name&quot;])\n        } else {\n            fmt.Fprintf(w, &quot;Sorry, not accepted age!&quot;)\n        }\n    } else {\n        fmt.Fprintf(w, &quot;Wrong url\\n&quot;)\n    }\n}\n\nfunc main() {\n\n    http.HandleFunc(&quot;/hello/&quot;, hello)\n\n    http.ListenAndServe(&quot;:8090&quot;, nil)\n}\n</code></pre>\n"}], "owner": {"reputation": 1095, "user_id": 1578522, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/90dcc100026b3728de372b6ece1fbaec?s=128&d=identicon&r=PG", "display_name": "Somesh", "link": "https://stackoverflow.com/users/1578522/somesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29605, "favorite_count": 9, "accepted_answer_id": 29221954, "answer_count": 7, "score": 33, "last_activity_date": 1610307366, "creation_date": 1427116574, "last_edit_date": 1537338366, "question_id": 29211241, "link": "https://stackoverflow.com/questions/29211241/go-url-parameters-mapping", "title": "Go url parameters mapping", "body": "<p>Is there a native way for inplace url parameters in native <code>Go</code>?</p>\n\n<p>For Example, if I have a URL: <code>http://localhost:8080/blob/123/test</code> I want to use this URL as <code>/blob/{id}/test</code>.</p>\n\n<p>This is not a question about finding <code>go</code> libraries. I am starting with the basic question, does go itself provide a basic facility to do this natively.</p>\n"}, {"tags": ["reflection", "go", "runtime"], "answers": [{"comments": [{"owner": {"reputation": 436, "user_id": 478309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0e42cd135cba45a460dbad590bf110a8?s=128&d=identicon&r=PG", "display_name": "Lei Cao", "link": "https://stackoverflow.com/users/478309/lei-cao"}, "edited": false, "score": 0, "creation_date": 1427105193, "post_id": 29207395, "comment_id": 46625343, "body": "The purpose of doing this kind of thing <code>value.(type)</code> is I might have many struct like <code>Config1</code> ... <code>Config100</code>, I don&#39;t want to <code>case</code> them one by one if there is another way to do so."}, {"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1427114381, "post_id": 29207395, "comment_id": 46630612, "body": "If you just want to check the type, or assert it to use it, you can just do <code>val, ok := value.(TypeICareAbout)</code>. This can be fairly useful for doing things like checking what kind of error an error &quot;actually&quot; is, if it implements a package specific interface, so that you can use behavior it exposes (i.e. <a href=\"http://dave.cheney.net/2014/12/24/inspecting-errors\" rel=\"nofollow noreferrer\">dave.cheney.net/2014/12/24/inspecting-errors</a>)."}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 5, "last_activity_date": 1427108718, "last_edit_date": 1427108718, "creation_date": 1427104900, "answer_id": 29207395, "question_id": 29207232, "link": "https://stackoverflow.com/questions/29207232/how-can-i-convert-type-dynamically-in-runtime-in-golang/29207395#29207395", "title": "How can I convert type dynamically in runtime in Golang?", "body": "<p>The notation</p>\n\n<pre><code>value.(type)\n</code></pre>\n\n<p>is called a <a href=\"https://golang.org/doc/effective_go.html#interface_conversions\" rel=\"nofollow\">type-assertion</a>. The <code>type</code> in an assertion has to be known at compile-time and it's always a type name.</p>\n\n<p>In your playground example <code>SetStruct2</code> could use a <a href=\"https://golang.org/doc/effective_go.html#type_switch\" rel=\"nofollow\">type-switch</a> to handle different types for its second argument:</p>\n\n<pre><code>switch v := value.(type) {\ncase Config:\n    // code that uses v as a Config\ncase int:\n    // code that uses v as an int\n}\n</code></pre>\n\n<p>You cannot, however, assert an interface to be something dynamic (like in your code). Because otherwise the compiler could not type-check your program.</p>\n\n<p>Edit:</p>\n\n<blockquote>\n  <p>I don't want to case them one by one if there is another way to do so?</p>\n</blockquote>\n\n<p>You can use <a href=\"http://golang.org/pkg/reflect/\" rel=\"nofollow\">reflection</a> to work type-agnostically. You can then set stuff randomly on values but it will panic if you perform an illegal operation for a type.</p>\n\n<p>If you want to benefit from the compiler's type checks you'll have to enumerate the different cases.</p>\n"}], "owner": {"reputation": 436, "user_id": 478309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0e42cd135cba45a460dbad590bf110a8?s=128&d=identicon&r=PG", "display_name": "Lei Cao", "link": "https://stackoverflow.com/users/478309/lei-cao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1189, "favorite_count": 0, "accepted_answer_id": 29207395, "answer_count": 1, "score": 0, "last_activity_date": 1427108718, "creation_date": 1427104389, "question_id": 29207232, "link": "https://stackoverflow.com/questions/29207232/how-can-i-convert-type-dynamically-in-runtime-in-golang", "title": "How can I convert type dynamically in runtime in Golang?", "body": "<p>Here is my example:\n<a href=\"http://play.golang.org/p/D608cYqtO5\" rel=\"nofollow\">http://play.golang.org/p/D608cYqtO5</a></p>\n\n<p>Basically I want to do this:</p>\n\n<pre><code>theType := reflect.TypeOf(anInterfaceValue)\ntheConvertedValue := anInterfaceValue.(theType)\n</code></pre>\n"}, {"tags": ["web-applications", "go", "elasticsearch"], "comments": [{"owner": {"reputation": 56502, "user_id": 271475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b00f41e5f2a69734051f2a78f4f3785?s=128&d=identicon&r=PG", "display_name": "Chris Heald", "link": "https://stackoverflow.com/users/271475/chris-heald"}, "edited": false, "score": 0, "creation_date": 1427093473, "post_id": 29204430, "comment_id": 46620307, "body": "Elasticsearch would do just fine for this. All you need to interface with it is an HTTP library and time to read the documentation."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1427098696, "post_id": 29204430, "comment_id": 46622217, "body": "If you are using PostgreSQL - the full text search (FTS) capabilities may also suit. Will depend on your need. For a smaller site that needs a documentation search, article/blog post search, etc - it is more than capable. <a href=\"http://blog.lostpropertyhq.com/postgres-full-text-search-is-good-enough/\" rel=\"nofollow noreferrer\">blog.lostpropertyhq.com/&hellip;</a> - I use Postgres FTS + <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">github.com/jmoiron/sqlx</a> for my own web app."}], "answers": [{"tags": [], "owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "is_accepted": false, "score": 2, "last_activity_date": 1427110593, "creation_date": 1427110593, "answer_id": 29209245, "question_id": 29204430, "link": "https://stackoverflow.com/questions/29204430/internal-site-search/29209245#29209245", "title": "Internal Site Search", "body": "<p>Take a look at <a href=\"http://www.blevesearch.com\" rel=\"nofollow\">Bleve</a> - it's pure Go ElasticSearch/Lucene alternative. Looks promising.</p>\n\n<p>Here is nice talk about Bleve at FOSDEM'15 Go DevRoom: <a href=\"https://video.fosdem.org/2015/devroom-go/bleve.mp4\" rel=\"nofollow\">https://video.fosdem.org/2015/devroom-go/bleve.mp4</a> (145M)</p>\n"}], "owner": {"reputation": 607, "user_id": 2704875, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/d01a9368d31ce231b4de371504c2f878?s=128&d=identicon&r=PG&f=1", "display_name": "freetoplay", "link": "https://stackoverflow.com/users/2704875/freetoplay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1427110593, "creation_date": 1427092503, "question_id": 29204430, "link": "https://stackoverflow.com/questions/29204430/internal-site-search", "title": "Internal Site Search", "body": "<p>I'm learning to develop web applications and I would like to create my own internal site search engine (without using Google or a 3rd party hosting service) that could index my web app. Could I go about using something like Elastic Search for a small web app? I have been reading about it, but I have only seen it used for big sites/apps. Or would I have to implement this myself without any 3rd party APIs? I'm using Golang as my programming language. </p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427089302, "post_id": 29203812, "comment_id": 46619102, "body": "So your json response is a key-value pair and you want to know how to turn this into a hashset/dictionary/map?"}, {"owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427089508, "post_id": 29203812, "comment_id": 46619156, "body": "@SimonWhitehead :  yes , thats my objective !"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427089662, "post_id": 29203812, "comment_id": 46619198, "body": "Now that your duplicate question is gone... edit this one and include relevant information."}, {"owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1427090087, "post_id": 29203812, "comment_id": 46619328, "body": "@SimonWhitehead , Edit done ."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 2, "creation_date": 1427091504, "post_id": 29203812, "comment_id": 46619686, "body": "<a href=\"http://blog.golang.org/json-and-go\" rel=\"nofollow noreferrer\">blog.golang.org/json-and-go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "edited": false, "score": 0, "creation_date": 1427092630, "post_id": 29204255, "comment_id": 46620017, "body": "getting this following error  &quot; panic serving 127.0.0.1:33514: json: cannot unmarshal object into Go value of type string goroutine 6 [running]:&quot;"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "edited": false, "score": 1, "creation_date": 1427092788, "post_id": 29204255, "comment_id": 46620072, "body": "@KarthicRao Your input json contains other types than just <code>string</code>s, e.g. lists or nested structs. Use <code>map[string]interface{}</code> map type then."}, {"owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "edited": false, "score": 0, "creation_date": 1427094261, "post_id": 29204255, "comment_id": 46620597, "body": "Works Perfect . Ty :)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1471854971, "last_edit_date": 1471854971, "creation_date": 1427091527, "answer_id": 29204255, "question_id": 29203812, "link": "https://stackoverflow.com/questions/29203812/converting-uint8-byte-to-hash-table-golang/29204255#29204255", "title": "Converting []uint8/[]byte to hash table GoLang", "body": "<p>Note that <code>byte</code> is an alias for <code>uint8</code>. Having said that what you want is a simple <a href=\"http://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow\">json unmarshal</a>:</p>\n\n<pre><code>js := []byte(`{\"SortAs\": \"SGML\",\"GlossTerm\": \"Standard Generalized Markup Language\", \"Acronym\": \"SGML\",\"Abbrev\": \"ISO 8879:1986\"}`)\n\nm := map[string]interface{}{}\nif err := json.Unmarshal(js, &amp;m); err != nil {\n    panic(err)\n}\nfmt.Printf(\"%q\",m)\n</code></pre>\n\n<p>Output (wrapped):</p>\n\n<pre><code>map[\"SortAs\":\"SGML\" \"GlossTerm\":\"Standard Generalized Markup Language\"\n    \"Acronym\":\"SGML\" \"Abbrev\":\"ISO 8879:1986\"]\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/2ZO2ixR48l\" rel=\"nofollow\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1076, "favorite_count": 0, "accepted_answer_id": 29204255, "answer_count": 1, "score": 1, "last_activity_date": 1471854971, "creation_date": 1427088611, "last_edit_date": 1427094507, "question_id": 29203812, "link": "https://stackoverflow.com/questions/29203812/converting-uint8-byte-to-hash-table-golang", "title": "Converting []uint8/[]byte to hash table GoLang", "body": "<p>My server sends a JSON response which looks like shown below </p>\n\n<pre><code>{\"SortAs\": \"SGML\",\"GlossTerm\": \"Standard Generalized Markup Language\",\"Acronym\": \"SGML\",\"Abbrev\": \"ISO 8879:1986\"}\n</code></pre>\n\n<p>But My Go program receives it as type []uint8 .   Also the size JSON  sent from the server is not of definite size , it varies . How do i convert it  into a Hash table containing key/value pair again ?</p>\n"}, {"tags": ["pointers", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 0, "creation_date": 1427088693, "post_id": 29203674, "comment_id": 46618950, "body": "ok, it makes more sense now but, what about the last one. Why does  fmt.Printf(&quot;address of slice: %p\\n\\n&quot;, slice)  change when the slice is modified? I get why the other stays the same."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "reply_to_user": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 0, "creation_date": 1427089060, "post_id": 29203674, "comment_id": 46619048, "body": "@aubble I have an answer, but perhaps it should be a new question?"}, {"owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 0, "creation_date": 1514714299, "post_id": 29203674, "comment_id": 83053516, "body": "I figured it out. It comes from <a href=\"https://github.com/golang/go/blob/38c561cb2caa8019e44059e2be71c909ceef30a6/src/reflect/value.go#L1267-L1268\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/&hellip;</a>"}], "tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": true, "score": 4, "last_activity_date": 1427087993, "last_edit_date": 1427087993, "creation_date": 1427087614, "answer_id": 29203674, "question_id": 29203551, "link": "https://stackoverflow.com/questions/29203551/address-of-slice-in-golang/29203674#29203674", "title": "Address of slice in golang", "body": "<p>It's what <code>fmt.Println</code> is defined to do.</p>\n\n<p>From <a href=\"https://golang.org/pkg/fmt/#Println\" rel=\"nofollow\">https://golang.org/pkg/fmt/#Println</a> :</p>\n\n<blockquote>\n  <p>Println formats using the default formats for its operands and writes to standard output. Spaces are always added between operands and a newline is appended. It returns the number of bytes written and any write error encountered.</p>\n</blockquote>\n\n<p>And earlier on that page, describing the default formats:</p>\n\n<blockquote>\n  <p>For compound objects, the elements are printed using these rules, recursively, laid out like this:</p>\n\n<pre><code>struct:             {field0 field1 ...}\narray, slice:       [elem0 elem1 ...]\nmaps:               map[key1:value1 key2:value2]\npointer to above:   &amp;{}, &amp;[], &amp;map[]\n</code></pre>\n</blockquote>\n\n<p>Maybe your question was \"why\" is it like this. The answer is debatable, but I suppose it's because it was considered more useful to show the data in this form rather than a raw pointer.</p>\n\n<p>You also ask why modifying a slice doesn't change its address. A slice is a value type (<em>not</em> a reference type) which contains a pointer to the underlying array (as well as its capacity and current length). Assigning a new value to a variable of slice type overwrites the value, but doesn't change its address. <a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow\">This article on slice use and internals</a> is a good reference.</p>\n"}], "owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2097, "favorite_count": 1, "accepted_answer_id": 29203674, "answer_count": 1, "score": -1, "last_activity_date": 1427087993, "creation_date": 1427086778, "question_id": 29203551, "link": "https://stackoverflow.com/questions/29203551/address-of-slice-in-golang", "title": "Address of slice in golang", "body": "<p>I have this piece of code </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc Extend(slice []int, element int) []int {\n    n := len(slice)\n    if n == cap(slice) {\n        // Slice is full; must grow.\n        // We double its size and add 1, so if the size is zero we still grow.\n        newSlice := make([]int, len(slice), 2*len(slice)+1)\n        copy(newSlice, slice)\n        slice = newSlice\n    }\n    slice = slice[0 : n+1]\n    slice[n] = element\n    return slice\n}\n\nfunc main() {\n    slice := make([]int, 0, 5)\n    for i := 0; i &lt; 10; i++ {\n        slice = Extend(slice, i)\n        fmt.Printf(\"len=%d cap=%d slice=%v\\n\", len(slice), cap(slice), slice)\n        fmt.Println(\"address of 0th element:\", &amp;slice[0])\n        fmt.Println(\"address of slice:\", &amp;slice) // why does this print the slice and not its address?\n        fmt.Printf(\"address of slice: %p\\n\", &amp;slice) // why is this different from below? and why does it not change when a new slice is created pointing to a different array?\n        fmt.Printf(\"address of slice: %p\\n\\n\", slice)\n    }\n}\n</code></pre>\n\n<p>playground: <a href=\"https://play.golang.org/p/PWMN-i9_z9\" rel=\"nofollow\">https://play.golang.org/p/PWMN-i9_z9</a></p>\n\n<p>My question on the second Println at the bottom in the loop. If you run it, you will see it prints out &amp;[values...]. Why does it not print out the address? I know you can do it with Printf, among other ways, and it works, but what about Println? Println with &amp;slice[0] works fine, it prints the address not the value, but Println with &amp;slice is just like nope. </p>\n\n<p>I also just noticed that when I do the Printf statement %p with &amp;slice, vs then I do only slice, I get different addresses. Why? And the address with &amp;slice does not change when it is changed (run it, the program resizes the array and creates a new slice). But printf(%p, slice) does change?</p>\n"}, {"tags": ["string", "unicode", "go"], "answers": [{"comments": [{"owner": {"reputation": 76876, "user_id": 287586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tB5AG.png?s=128&g=1", "display_name": "dan04", "link": "https://stackoverflow.com/users/287586/dan04"}, "edited": false, "score": 0, "creation_date": 1427081942, "post_id": 29202893, "comment_id": 46617531, "body": "Does it support multi-character replacements like <code>&#223;</code> \u2192 <code>SS</code>?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427082012, "post_id": 29202893, "comment_id": 46617545, "body": "Or just use (or look at the source for) <code>strings.ToUpper</code>. This was listed as an &quot;Advanced exercise&quot; in the document you link to so asking for an answer is like asking someone else to do your homework for you. :)"}, {"owner": {"reputation": 1523, "user_id": 3791794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378946c1efd33604a905ef2fd60839a1?s=128&d=identicon&r=PG&f=1", "display_name": "Simba", "link": "https://stackoverflow.com/users/3791794/simba"}, "reply_to_user": {"reputation": 76876, "user_id": 287586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tB5AG.png?s=128&g=1", "display_name": "dan04", "link": "https://stackoverflow.com/users/287586/dan04"}, "edited": false, "score": 0, "creation_date": 1427082069, "post_id": 29202893, "comment_id": 46617556, "body": "@dan04 it didn&#39;t work in the playground so guess not :/"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 76876, "user_id": 287586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tB5AG.png?s=128&g=1", "display_name": "dan04", "link": "https://stackoverflow.com/users/287586/dan04"}, "edited": false, "score": 0, "creation_date": 1427082217, "post_id": 29202893, "comment_id": 46617584, "body": "@dan04 See the follow up blog post: <a href=\"https://blog.golang.org/normalization\" rel=\"nofollow noreferrer\">Text normalization in Go</a> for more about Unicode and Go. But the short answer is <code>unicode.ToUpper</code> takes a rune and returns a rune so it can&#39;t possibly convert one rune to several."}, {"owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1427082431, "post_id": 29202893, "comment_id": 46617624, "body": "@Dave C Very new to the Go language. Not much experience, I just learnt about runes and this stuff now. I guess I could have probably just figured it out myself but I thought they wanted me to implement a actual function to do it all though itself, without the library. But I guess not, that would be really hard."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 1, "creation_date": 1427083722, "post_id": 29202893, "comment_id": 46617881, "body": "@aubble, sortof, the actual <code>strings.ToUpper</code> function is literally just <code>func ToUpper(s string) string { return Map(unicode.ToUpper, s) }</code>. The <code>strings.Map</code> function isn&#39;t bad though. The standard packages are a good place to look for learning idiomatic Go that does things well (mostly, there is some cruft in the corners)."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 76876, "user_id": 287586, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/tB5AG.png?s=128&g=1", "display_name": "dan04", "link": "https://stackoverflow.com/users/287586/dan04"}, "edited": false, "score": 0, "creation_date": 1427110715, "post_id": 29202893, "comment_id": 46628396, "body": "@dan04 I think it converts &#223; to \u1e9e."}], "tags": [], "owner": {"reputation": 1523, "user_id": 3791794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378946c1efd33604a905ef2fd60839a1?s=128&d=identicon&r=PG&f=1", "display_name": "Simba", "link": "https://stackoverflow.com/users/3791794/simba"}, "is_accepted": true, "score": 4, "last_activity_date": 1427081975, "last_edit_date": 1427081975, "creation_date": 1427081730, "answer_id": 29202893, "question_id": 29202849, "link": "https://stackoverflow.com/questions/29202849/writing-a-toupper-function-for-unicode-letters/29202893#29202893", "title": "Writing a toUpper function for unicode letters", "body": "<p>You should use <code>rune</code> when you use unicode. The <code>unicode</code> package in golang has a toUpper function.</p>\n\n<pre><code>package main\n\nimport (\n    \"unicode\"\n    \"fmt\"\n)\n\ntype path []rune\n\nfunc (p path) ToUpper() {\n    for i, b := range p {\n        p[i] = unicode.ToUpper(b)\n    }\n}\n\nfunc main() {\n    pathName := path(\"/usr/bin/tso\")\n    pathName.ToUpper()\n    string1 := string(pathName)\n    fmt.Printf(\"%s\\n\", string1)\n}\n</code></pre>\n\n<p>in the playground:\n<a href=\"https://play.golang.org/p/yIbjkde2rY\" rel=\"nofollow\">example</a></p>\n"}, {"tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1427083889, "creation_date": 1427083889, "answer_id": 29203143, "question_id": 29202849, "link": "https://stackoverflow.com/questions/29202849/writing-a-toupper-function-for-unicode-letters/29203143#29203143", "title": "Writing a toUpper function for unicode letters", "body": "<p>You can use <code>strings.Map</code> to apply a function to each rune of a string, returning the mapped string. <a href=\"https://play.golang.org/p/5Fm3Tc7RjC\" rel=\"nofollow\">Playground link to this code:</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n    \"unicode\"\n)\n\nfunc main() {\n    pathName := strings.Map(unicode.ToUpper, \"/usr/bin/tso\")\n    fmt.Printf(\"%s\\n\", pathName)\n}\n</code></pre>\n"}], "owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 29202893, "answer_count": 2, "score": 0, "last_activity_date": 1441116934, "creation_date": 1427081373, "last_edit_date": 1441116934, "question_id": 29202849, "link": "https://stackoverflow.com/questions/29202849/writing-a-toupper-function-for-unicode-letters", "title": "Writing a toUpper function for unicode letters", "body": "<p>From here <a href=\"http://blog.golang.org/slices\" rel=\"nofollow\">http://blog.golang.org/slices</a> (it's right before the Capacity section)</p>\n\n<pre><code>type path []byte\n\nfunc (p path) ToUpper() {\n    for i, b := range p {\n        if 'a' &lt;= b &amp;&amp; b &lt;= 'z' {\n            p[i] = b + 'A' - 'a'\n        }\n    }\n}\n\nfunc main() {\n    pathName := path(\"/usr/bin/tso\")\n    pathName.ToUpper()\n    string1 := string(pathName)\n    fmt.Printf(\"%s\\n\", string1)\n}\n</code></pre>\n\n<p>Was reading on slices and stuff in golang. This is a function to convert ascii characters. How would you go about turning this function to handle unicode as well? </p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 599, "user_id": 1952713, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/fQze7.jpg?s=128&g=1", "display_name": "ibsenv", "link": "https://stackoverflow.com/users/1952713/ibsenv"}, "edited": false, "score": 0, "creation_date": 1427528760, "post_id": 29202516, "comment_id": 46822268, "body": "I think you should take a look at testsu&#39;s answer <a href=\"http://stackoverflow.com/questions/930966/app-engine-datastore-does-not-support-operator-or\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1923, "user_id": 7139000, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hnvVgGVbT6U/AAAAAAAAAAI/AAAAAAAAABk/HEWzkJSv0tM/photo.jpg?sz=128", "display_name": "Daniel Swiegers", "link": "https://stackoverflow.com/users/7139000/daniel-swiegers"}, "edited": false, "score": 0, "creation_date": 1539816371, "post_id": 29204370, "comment_id": 92643481, "body": "using GQL you can also do something like SELECT * FROM survey WHERE survey.candidate.emails contains &#39;&#39;"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1427127653, "last_edit_date": 1427127653, "creation_date": 1427092210, "answer_id": 29204370, "question_id": 29202516, "link": "https://stackoverflow.com/questions/29202516/doing-a-in-array-query-on-google-app-engine-datastore-with-golang/29204370#29204370", "title": "Doing a &quot;IN Array&quot; query on google app engine datastore with golang", "body": "<p>Generally <code>\"IN\"</code> filters are not supported by the Datastore. The documentation of <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#Query.Filter\" rel=\"nofollow\"><code>Query.Filter()</code></a> lists the allowed operators:</p>\n\n<pre><code>\"&gt;\", \"&lt;\", \"&gt;=\", \"&lt;=\", or \"=\"\n</code></pre>\n\n<p>What you can do is execute a <em>separate</em> query for each of the elements in the array you want to filter by. Also if the elements are in a continous range, you can substitute the <code>IN</code> with <code>id&gt;=min</code> and <code>id&lt;=max</code>. E.g.:</p>\n\n<pre><code>ids := []int64{1,2,3,4}\nq := datastore.NewQuery(\"Category\").Filter(\"Id&gt;=\", 1).Filter(\"Id&lt;=\", 4)\n</code></pre>\n\n<p>Also note that while the <code>IN</code> is not supported in general, if the property is the entity key itself, you can get a list of entities specified by an array of their keys using the <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#GetMulti\" rel=\"nofollow\"><code>datastore.GetMulti()</code></a> function:</p>\n\n<pre><code>func GetMulti(c appengine.Context, key []*Key, dst interface{}) error\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>Your 2nd attempt returns all entities because you call <code>Filter()</code> on your query, but you don't store the return value, so the query you end up executing will have no filters at all. <code>Query.Filter()</code> returns a derivative query which contains the filter you just specified, you have to use the returned <code>Query</code> ongoing. So it should be:</p>\n\n<pre><code>q = q.Filter(\"Id=\", id)\n</code></pre>\n\n<p>But even this won't work either: if multiple filters are specified, they will be in logical AND connection so it will most likely give you 0 results as I suspect no category will exists where <code>Id</code> is a list and which would contain all the ids you want to filter by.</p>\n"}], "owner": {"reputation": 2013, "user_id": 219912, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/edb8a30b7125b23b5ddae9047019f1e0?s=128&d=identicon&r=PG", "display_name": "Steven Lu", "link": "https://stackoverflow.com/users/219912/steven-lu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3398, "favorite_count": 0, "accepted_answer_id": 29204370, "answer_count": 1, "score": 5, "last_activity_date": 1477976214, "creation_date": 1427078377, "last_edit_date": 1477976214, "question_id": 29202516, "link": "https://stackoverflow.com/questions/29202516/doing-a-in-array-query-on-google-app-engine-datastore-with-golang", "title": "Doing a &quot;IN Array&quot; query on google app engine datastore with golang", "body": "<p>Is there a way to do a query with <code>ids []int64</code> on datastore? I've tried the following with no avail.</p>\n\n<ol>\n<li><p>Errors out</p>\n\n<pre><code>q := datastore.NewQuery(\"Category\").Filter(\"Id IN\", ids)\n</code></pre></li>\n<li><p>Just gets me all the the categories in the datastore</p>\n\n<pre><code>for _, id := range ids {\n    q.Filter(\"Id =\", id)\n}\n</code></pre></li>\n</ol>\n\n<p><strong>After icza's answer</strong></p>\n\n<pre><code>var keys []*datastore.Key\n\nfor _, id := range ids {\n    keys = append(keys, datastore.NewKey(c, \"Category\", \"\", id, nil))\n}\n\ncategories := make([]Category, len(keys))\nerr := datastore.GetMulti(c, keys, categories)\nif err != nil {\n    return nil, err\n}\n</code></pre>\n"}, {"tags": ["concurrency", "go"], "answers": [{"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1427067657, "post_id": 29200962, "comment_id": 46614471, "body": "Seems to be the  correct answer through I sense the code looks a bit more &quot;complex&quot; due the additional nested go routine."}], "tags": [], "owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "is_accepted": true, "score": 1, "last_activity_date": 1427065655, "creation_date": 1427065655, "answer_id": 29200962, "question_id": 29200625, "link": "https://stackoverflow.com/questions/29200625/how-to-exit-a-channel-range-collect-results/29200962#29200962", "title": "How to exit a channel range / collect results", "body": "<p>There's nothing <em>wrong</em> with that .. it works. However, it really should be the producers job to close the channel (not the consumer).</p>\n\n<p>To that end .. I would propose that you move the entire producer process into a goroutine and have that wait .. then close the channel:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"sync\"\n\nfunc main() {\n    ch := make(chan int, 3)\n    var wg sync.WaitGroup\n\n    go func() {\n        for i := 0; i &lt; 3; i++ {\n            wg.Add(1)\n            go func(i int) {\n                defer wg.Done()\n                ch &lt;- i\n            }(i)\n        }\n        wg.Wait()\n        close(ch) // producer is now closing the channel\n    }()\n\n    // Consumer has the single responsibility of iterating over the channel\n    for v := range ch {\n        fmt.Println(\"consume \", v)\n    }\n    fmt.Printf(\"All done\")\n}\n</code></pre>\n\n<p><kbd><a href=\"http://play.golang.org/p/wT_YjPMtEF\" rel=\"nofollow\">See it in the Go Playground</a></kbd></p>\n"}, {"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1427066905, "post_id": 29200983, "comment_id": 46614308, "body": "I don&#39;t see the &quot;All done&quot; print in your snippet which is a constrain you should consider."}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1427071034, "post_id": 29200983, "comment_id": 46615193, "body": "@Theuserwithnohat I am not sure how an extra <code>Println</code> is a constraint, but I added it anyway."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1427074620, "post_id": 29200983, "comment_id": 46616014, "body": "right... sorry about that. The real constraint is that the number of values is usually unknown. I&#39;ve used <code>3</code> as a &quot;random&quot; number."}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 1, "last_activity_date": 1427071007, "last_edit_date": 1427071007, "creation_date": 1427065760, "answer_id": 29200983, "question_id": 29200625, "link": "https://stackoverflow.com/questions/29200625/how-to-exit-a-channel-range-collect-results/29200983#29200983", "title": "How to exit a channel range / collect results", "body": "<p>I am sure your example is contrived, but your example could be made much simpler:</p>\n\n<pre><code>ch := make(chan int, 99)\nfor i := 0; i &lt; 3; i++ {\n    go func(i int) {\n        ch &lt;- i\n    }(i)\n}\nfor i := 0; i &lt; 3; i++ {\n    v := &lt;- ch\n    fmt.Println(\"consume \", v)\n}\nfmt.Println(\"All done\")\n</code></pre>\n\n<p>Your real code may be more complex and require something like a waitGroup, and if that is the case please do whatever you can to explain your specific problem.</p>\n\n<p>Closing a channel within a range in order to exit the range seems like non-idiomatic Go. </p>\n\n<p><kbd><a href=\"http://play.golang.org/p/0b9Kw5W2mr\" rel=\"nofollow\">Go Play</a></kbd></p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "accepted_answer_id": 29200962, "answer_count": 2, "score": 1, "last_activity_date": 1427117199, "creation_date": 1427063332, "last_edit_date": 1427063585, "question_id": 29200625, "link": "https://stackoverflow.com/questions/29200625/how-to-exit-a-channel-range-collect-results", "title": "How to exit a channel range / collect results", "body": "<p>I need to process several tasks concurrently and then \"collect\" the results. Below is the code I came up with but I'm wondering if it's the right way to do this(i.e idiomatic/ best practice) or if there is something wrong that I might miss. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"sync\"\n\nfunc main() {\n    // ch is the int provider. Cap is 99 but it should \n    // really be 3\n    ch := make(chan int, 99)\n    var wg sync.WaitGroup\n    for i := 0; i &lt; 3; i++ {\n        wg.Add(1)\n        go func(i int) {\n            defer wg.Done()\n            ch &lt;- i\n        }(i)\n    }\n    wg.Wait()\n    for v := range ch {\n        fmt.Println(\"consume \", v)\n        if len(ch) == 0 {\n            close(ch)\n        }\n    }\n    fmt.Printf(\"All done\")\n}\n</code></pre>\n"}, {"tags": ["struct", "go", "binary", "endianness"], "answers": [{"tags": [], "owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "is_accepted": true, "score": 1, "last_activity_date": 1427063268, "creation_date": 1427063268, "answer_id": 29200617, "question_id": 29200499, "link": "https://stackoverflow.com/questions/29200499/is-it-possible-to-specify-big-little-endian-for-every-field-when-using-binary-re/29200617#29200617", "title": "Is it possible to specify big/little endian for every field when using binary.Read() to decode a byte stream into a struct?", "body": "<p>No, it doesn't look like it.</p>\n\n<p><a href=\"http://golang.org/src/encoding/binary/binary.go?s=4055:4118#L128\" rel=\"nofollow\">The Read method</a> goes through all of the work of deciphering what it needs to read .. then all of the actual read methods have this:</p>\n\n<pre><code>d.order.....\n</code></pre>\n\n<p>So basically, they use the <code>ByteOrder</code> you've specified directly .. and make no attempt (via struct tags or anything else) to let you specify it on a per-field basis.</p>\n\n<p>Unfortunate .. but I smell an opportunity for someone to come along and make a neat package that can be shared with the community :)</p>\n"}], "owner": {"reputation": 12786, "user_id": 499125, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1e0971e368bdad6e495b2eafcdeb7796?s=128&d=identicon&r=PG", "display_name": "Some Noob Student", "link": "https://stackoverflow.com/users/499125/some-noob-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 29200617, "answer_count": 1, "score": 2, "last_activity_date": 1427063268, "creation_date": 1427062562, "question_id": 29200499, "link": "https://stackoverflow.com/questions/29200499/is-it-possible-to-specify-big-little-endian-for-every-field-when-using-binary-re", "title": "Is it possible to specify big/little endian for every field when using binary.Read() to decode a byte stream into a struct?", "body": "<p>When decoding bytes, <a href=\"http://golang.org/pkg/encoding/binary/#Read\" rel=\"nofollow\">binary.Read()</a> requires you to specify the expected byte order of that operation. binary.Read() also allows you to pass in a struct, but AFAIK, it uses the same byte order to decode the byte stream into every field in the struct. </p>\n\n<p>This is inconvenient when the byte order of encoded integers is in little endian but encoded strings and floats are in big endian.</p>\n\n<p>Is it possible to specify on a per-field basis, which byte-order to use when decoding a stream of bytes into a struct?</p>\n"}, {"tags": ["go", "docker"], "answers": [{"comments": [{"owner": {"reputation": 10891, "user_id": 21290, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c6ab4816b95d9c41d8e4a86f08ad1c48?s=128&d=identicon&r=PG", "display_name": "benzaita", "link": "https://stackoverflow.com/users/21290/benzaita"}, "edited": false, "score": 0, "creation_date": 1427052754, "post_id": 29198778, "comment_id": 46610178, "body": "Thanks. This seems to be a basic assumption Go makes (pulling the source from VCS). Is it intentionally hard to use proprietary code? Ultimately I&#39;m deploying to a cloud service that might not have access to my company&#39;s VCS..."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 10891, "user_id": 21290, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c6ab4816b95d9c41d8e4a86f08ad1c48?s=128&d=identicon&r=PG", "display_name": "benzaita", "link": "https://stackoverflow.com/users/21290/benzaita"}, "edited": false, "score": 0, "creation_date": 1427054554, "post_id": 29198778, "comment_id": 46610758, "body": "@benzaita: Most people keep code in a VCS, proprietary or not. Regardless, it only a convenience. You can generate your GOPATH any way you want -- tar it up and pull it with http if it suits you."}, {"owner": {"reputation": 492, "user_id": 2610345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c721bfa71e69255547a4d52fe50e6ae?s=128&d=identicon&r=PG", "display_name": "schemar", "link": "https://stackoverflow.com/users/2610345/schemar"}, "edited": false, "score": 0, "creation_date": 1427226454, "post_id": 29198778, "comment_id": 46689116, "body": "You usually deploy the built image. then there is no need for VCS anymore, as you did that when building the image. Also: why don&#39;t you use the binaries (prog1 and 2) for deployment?"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1427052102, "creation_date": 1427052102, "answer_id": 29198778, "question_id": 29198603, "link": "https://stackoverflow.com/questions/29198603/recommended-project-structure-for-docker/29198778#29198778", "title": "Recommended Project Structure for Docker", "body": "<p>Most pull the files in via their VCS or just <code>go get</code> instead of using <code>ADD</code>.  You add the the source tree in the same way regardless of what tool your building, since you need the structure of <code>$GOPATH</code> to be the same for each.</p>\n\n<p>Note, you can also name your docker file via <code>docker build -f</code>, so if you want to use <code>ADD</code>, you can have multiple DOCKERFILEs in your root directory.</p>\n"}], "owner": {"reputation": 10891, "user_id": 21290, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c6ab4816b95d9c41d8e4a86f08ad1c48?s=128&d=identicon&r=PG", "display_name": "benzaita", "link": "https://stackoverflow.com/users/21290/benzaita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1665, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1427110579, "creation_date": 1427051205, "last_edit_date": 1495540893, "question_id": 29198603, "link": "https://stackoverflow.com/questions/29198603/recommended-project-structure-for-docker", "title": "Recommended Project Structure for Docker", "body": "<p>I'm working on a Go project that has the following structure (schematic):</p>\n\n<pre><code>./lib1\n./prog1\n    ./...\n./prog2\n    ./...\n</code></pre>\n\n<p>Where:</p>\n\n<ul>\n<li>lib1 is a library</li>\n<li>prog1 and prog2 are executables (both depend on lib1)</li>\n</ul>\n\n<p><strong>In a nutshell:</strong> How do I create Dockerfiles for prog1 and prog2?</p>\n\n<hr>\n\n<p>I tried several approaches, all to no avail:</p>\n\n<h2>Creating a Dockerfile in prog1/</h2>\n\n<p>Failed because docker cannot <code>ADD ../lib1</code> to the container since it is out of the context (see <a href=\"http://docs.docker.com/reference/builder/#add\" rel=\"nofollow noreferrer\">http://docs.docker.com/reference/builder/#add</a>).</p>\n\n<h2>Creating a Dockerfile in the root directory</h2>\n\n<p>Ignoring the fact that I actually need two Dockerfiles (for prog1, and for prog2), I tried placing the Dockerfile in the root directory of the project.</p>\n\n<p>However, the docker image I need to use (golang:1.4.1-onbuild) fails to find any Go files (since they are in ./prog1, and not in the root):</p>\n\n<pre><code>+ exec go install -v\ncan't load package: package app: no buildable Go source files in /go/src/app\n</code></pre>\n\n<p><strong>What is the recommended project structure for the golang:1.4.1-onbuild image?</strong></p>\n\n<hr>\n\n<p><strong>Edit:</strong> Better asked here: <a href=\"https://stackoverflow.com/questions/29209202/dockerizing-gos-hello-world\">https://stackoverflow.com/questions/29209202/dockerizing-gos-hello-world</a></p>\n"}, {"tags": ["go", "long-polling"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1427051317, "post_id": 29197970, "comment_id": 46609701, "body": "not that it&#39;s pertinent to this answer, but it often preferable to use the <code>http.DefaultTransport</code>, which has sensible timeouts (and <code>ProxyFromEnvironment</code>) instead of an empty Transport."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 3, "creation_date": 1427052293, "post_id": 29197970, "comment_id": 46610039, "body": "Of course, don&#39;t use the above exactly as written. It&#39;s a stripped down example and it discards the <code>*http.Response</code> returned from <code>client.Do</code> without calling <code>resp.Body.Close()</code>. Don&#39;t ever do that."}, {"owner": {"reputation": 29724, "user_id": 93995, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/35752f1794d9a5f8ab8fe8edf272f0cc?s=128&d=identicon&r=PG", "display_name": "George Armhold", "link": "https://stackoverflow.com/users/93995/george-armhold"}, "edited": false, "score": 0, "creation_date": 1427120259, "post_id": 29197970, "comment_id": 46634589, "body": "Ah, tr.CancelRequest() (and the related example code) is what I was looking for."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 29724, "user_id": 93995, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/35752f1794d9a5f8ab8fe8edf272f0cc?s=128&d=identicon&r=PG", "display_name": "George Armhold", "link": "https://stackoverflow.com/users/93995/george-armhold"}, "edited": false, "score": 0, "creation_date": 1481922668, "post_id": 29197970, "comment_id": 69584724, "body": "@CaffeineComa if you could unaccept this and accept paulo&#39;s or themihai&#39;s answer below, that would be fine. It is a better answer now."}], "tags": [], "owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "is_accepted": true, "score": 7, "last_activity_date": 1427057055, "last_edit_date": 1427057055, "creation_date": 1427047731, "answer_id": 29197970, "question_id": 29197685, "link": "https://stackoverflow.com/questions/29197685/how-to-close-abort-a-golang-http-client-post-prematurely/29197970#29197970", "title": "how to close/abort a Golang http.Client POST prematurely", "body": "<p>Nope, client.Post is a handy wrapper for 90% of use-cases where request cancellation is not needed. </p>\n\n<p>Probably it will be enough simply to reimplement your client to get access to underlying Transport object, which has CancelRequest() function.</p>\n\n<p>Just a quick example:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc main() {\n    req, _ := http.NewRequest(\"GET\", \"http://google.com\", nil)\n    tr := &amp;http.Transport{} // TODO: copy defaults from http.DefaultTransport\n    client := &amp;http.Client{Transport: tr}\n    c := make(chan error, 1)\n    go func() {\n        resp, err := client.Do(req)\n        // handle response ...\n        _ = resp\n        c &lt;- err\n    }()\n\n    // Simulating user cancel request channel\n    user := make(chan struct{}, 0)\n    go func() {\n        time.Sleep(100 * time.Millisecond)\n        user &lt;- struct{}{}\n    }()\n\n    for {\n        select {\n        case &lt;-user:\n            log.Println(\"Cancelling request\")\n            tr.CancelRequest(req)\n        case err := &lt;-c:\n            log.Println(\"Client finished:\", err)\n            return\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 1, "creation_date": 1446190083, "post_id": 29200933, "comment_id": 54649771, "body": "You don&#39;t even need the extra goroutine or the special client. Just set <code>req.Cancel = ctx.Done()</code> and it will handle everything for you."}, {"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1481920132, "post_id": 29200933, "comment_id": 69583764, "body": "The http library suffered several updates since I posted the answer. The most idiomatic solution is now provided by @Paulo."}, {"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1481920604, "post_id": 29200933, "comment_id": 69583969, "body": "@captncraig I&#39;ve updated my answer. Feel free to write new answers if the method changes again(though I doubt it) and hopefully it will get the votes it deserves. I think the SO authors are not responsible for maintenance. The voting system should help in this regard."}, {"owner": {"reputation": 131, "user_id": 1554714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e80d28191c335630e0401299038785d?s=128&d=identicon&r=PG", "display_name": "shadow", "link": "https://stackoverflow.com/users/1554714/shadow"}, "edited": false, "score": 0, "creation_date": 1482228369, "post_id": 29200933, "comment_id": 69678886, "body": "This is regarding the update portion of your code. I am new to go but this looks wrong. Idea is to cancel the request, here the first go routine keeps running until request is actually complete. You don&#39;t cancel it, you just move ahead in the main thread based on who completes first."}, {"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "reply_to_user": {"reputation": 131, "user_id": 1554714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e80d28191c335630e0401299038785d?s=128&d=identicon&r=PG", "display_name": "shadow", "link": "https://stackoverflow.com/users/1554714/shadow"}, "edited": false, "score": 0, "creation_date": 1482262910, "post_id": 29200933, "comment_id": 69700295, "body": "@shadow, I&#39;ve updated the answer to include the actual cancellation op (WithCancel)"}], "tags": [], "owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "is_accepted": false, "score": 17, "last_activity_date": 1482264390, "last_edit_date": 1495539984, "creation_date": 1427065407, "answer_id": 29200933, "question_id": 29197685, "link": "https://stackoverflow.com/questions/29197685/how-to-close-abort-a-golang-http-client-post-prematurely/29200933#29200933", "title": "how to close/abort a Golang http.Client POST prematurely", "body": "<p>The standard way is to use a context of type <code>context.Context</code> and pass it around to all the functions that need to know when the request is cancelled. </p>\n\n<pre><code>func httpDo(ctx context.Context, req *http.Request, f func(*http.Response, error) error) error {\n    // Run the HTTP request in a goroutine and pass the response to f.\n    tr := &amp;http.Transport{}\n    client := &amp;http.Client{Transport: tr}\n    c := make(chan error, 1)\n    go func() { c &lt;- f(client.Do(req)) }()\n    select {\n    case &lt;-ctx.Done():\n        tr.CancelRequest(req)\n        &lt;-c // Wait for f to return.\n        return ctx.Err()\n    case err := &lt;-c:\n        return err\n    }\n}\n</code></pre>\n\n<p>golang.org/x/net/context</p>\n\n<pre><code>// A Context carries a deadline, cancelation signal, and request-scoped values\n// across API boundaries. Its methods are safe for simultaneous use by multiple\n// goroutines.\ntype Context interface {\n    // Done returns a channel that is closed when this Context is canceled\n    // or times out.\n    Done() &lt;-chan struct{}\n\n    // Err indicates why this context was canceled, after the Done channel\n    // is closed.\n    Err() error\n\n    // Deadline returns the time when this Context will be canceled, if any.\n    Deadline() (deadline time.Time, ok bool)\n\n    // Value returns the value associated with key or nil if none.\n    Value(key interface{}) interface{}\n}\n</code></pre>\n\n<p>Source and more on <a href=\"https://blog.golang.org/context\" rel=\"noreferrer\">https://blog.golang.org/context</a></p>\n\n<p><strong>Update</strong></p>\n\n<p>As Paulo <a href=\"https://stackoverflow.com/a/40494794/613453\">mentioned</a>, Request.Cancel is now deprecated and the author should  pass the context to the request itself(using *Request.WithContext) and use the cancellation channel of the context(to cancel the request).</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc main() {\n    cx, cancel := context.WithCancel(context.Background())\n    req, _ := http.NewRequest(\"GET\", \"http://google.com\", nil)\n    req = req.WithContext(cx)\n    ch := make(chan error)\n\n    go func() {\n        _, err := http.DefaultClient.Do(req)\n        select {\n        case &lt;-cx.Done():\n            // Already timedout\n        default:\n            ch &lt;- err\n        }\n    }()\n\n    // Simulating user cancel request\n    go func() {\n        time.Sleep(100 * time.Millisecond)\n        cancel()\n    }()\n    select {\n    case err := &lt;-ch:\n        if err != nil {\n            // HTTP error\n            panic(err)\n        }\n        print(\"no error\")\n    case &lt;-cx.Done():\n        panic(cx.Err())\n    }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 855, "user_id": 162029, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b30885a14060cbd33cadaabbc44ca688?s=128&d=identicon&r=PG", "display_name": "Paulo Casaretto", "link": "https://stackoverflow.com/users/162029/paulo-casaretto"}, "is_accepted": false, "score": 19, "last_activity_date": 1482152527, "last_edit_date": 1482152527, "creation_date": 1478632726, "answer_id": 40494794, "question_id": 29197685, "link": "https://stackoverflow.com/questions/29197685/how-to-close-abort-a-golang-http-client-post-prematurely/40494794#40494794", "title": "how to close/abort a Golang http.Client POST prematurely", "body": "<p>Using <a href=\"https://golang.org/pkg/net/http/#Transport.CancelRequest\" rel=\"noreferrer\">CancelRequest</a> is now deprecated.</p>\n\n<p>The current strategy is to use <a href=\"https://golang.org/pkg/net/http/#Request.WithContext\" rel=\"noreferrer\">http.Request.WithContext</a> passing a context with a deadline or that will be canceled otherwise.\nJust use it like a normal request afterwards.</p>\n\n<pre><code>req, err := http.NewRequest(\"GET\", \"http://example.com\", nil)\n// ...\nreq.Header.Add(\"If-None-Match\", `W/\"wyzzy\"`)\nreq = req.WithContext(ctx)\nresp, err := client.Do(req)\n// ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 964, "user_id": 2752670, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BUkkv.jpg?s=128&g=1", "display_name": "vikyd", "link": "https://stackoverflow.com/users/2752670/vikyd"}, "is_accepted": false, "score": 0, "last_activity_date": 1543114251, "creation_date": 1543114251, "answer_id": 53464244, "question_id": 29197685, "link": "https://stackoverflow.com/questions/29197685/how-to-close-abort-a-golang-http-client-post-prematurely/53464244#53464244", "title": "how to close/abort a Golang http.Client POST prematurely", "body": "<p>@Paulo Casaretto 's answer is right, should using \n<a href=\"https://golang.org/pkg/net/http/#Request.WithContext\" rel=\"nofollow noreferrer\">http.Request.WithContext</a>.</p>\n\n<p>Here is a full demo (be aware of the time numbers: 5, 10, 30 seconds).</p>\n\n<p>HTTP Server: </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"before sleep\")\n    time.Sleep(10 * time.Second)\n    fmt.Println(\"after sleep\")\n\n    fmt.Fprintf(w, \"Hi\")\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    log.Fatal(http.ListenAndServe(\":9191\", nil))\n}\n</code></pre>\n\n<p>The HTTP Server console print:</p>\n\n<pre><code>before sleep\nafter sleep \n</code></pre>\n\n<p>HTTP Client:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc main() {\n    ctx, cancel := context.WithCancel(context.Background())\n\n    go func() {\n        fmt.Println(\"before request\")\n        client := &amp;http.Client{Timeout: 30 * time.Second}\n        req, err := http.NewRequest(\"GET\", \"http://127.0.0.1:9191\", nil)\n        if err != nil {\n            panic(err)\n        }\n        req = req.WithContext(ctx)\n        _, err = client.Do(req)\n        if err != nil {\n            panic(err)\n        }\n        fmt.Println(\"will not reach here\")\n    }()\n\n    time.Sleep(5 * time.Second)\n    cancel()\n    fmt.Println(\"finished\")\n}\n</code></pre>\n\n<p>The HTTP Client console print:</p>\n\n<pre><code>before request\nfinished\n</code></pre>\n"}], "owner": {"reputation": 29724, "user_id": 93995, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/35752f1794d9a5f8ab8fe8edf272f0cc?s=128&d=identicon&r=PG", "display_name": "George Armhold", "link": "https://stackoverflow.com/users/93995/george-armhold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15096, "favorite_count": 2, "accepted_answer_id": 29197970, "answer_count": 4, "score": 7, "last_activity_date": 1543114251, "creation_date": 1427046202, "last_edit_date": 1427046560, "question_id": 29197685, "link": "https://stackoverflow.com/questions/29197685/how-to-close-abort-a-golang-http-client-post-prematurely", "title": "how to close/abort a Golang http.Client POST prematurely", "body": "<p>I'm using <a href=\"http://golang.org/pkg/net/http/#Client\" rel=\"noreferrer\"><code>http.Client</code></a> for the client-side implementation of a long-poll:</p>\n\n<pre><code>resp, err := client.Post(url, \"application/json\", bytes.NewBuffer(jsonPostBytes))\nif err != nil {\n    panic(err)\n}\ndefer resp.Body.Close()\n\nvar results []*ResponseMessage\nerr = json.NewDecoder(resp.Body).Decode(&amp;results)  // code blocks here on long-poll\n</code></pre>\n\n<p><strong>Is there a standard way to pre-empt/cancel the request from the client-side?</strong> </p>\n\n<p>I imagine that calling <code>resp.Body.Close()</code> would do it, but I'd have to call that from another goroutine, as the client is normally already blocked in reading the response of the long-poll.</p>\n\n<p>I know that there is a way to set a timeout via <code>http.Transport</code>, but my app logic need to do the cancellation based on a user action, not just a timeout.</p>\n"}, {"tags": ["pointers", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 0, "creation_date": 1427042002, "post_id": 29196849, "comment_id": 46606515, "body": "I don&#39;t disagree with this, just the last part about how it doesn&#39;t need to allocate because its a multiword structure. But it says a pointer would, thats what I&#39;m confused on. Third paragraph of the slices stuff."}], "tags": [], "owner": {"reputation": 7514, "user_id": 1008837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f67dc852a25a639e13fafbec62eec69?s=128&d=identicon&r=PG&f=1", "display_name": "Pravin Mishra", "link": "https://stackoverflow.com/users/1008837/pravin-mishra"}, "is_accepted": false, "score": 2, "last_activity_date": 1427041588, "creation_date": 1427041588, "answer_id": 29196849, "question_id": 29196475, "link": "https://stackoverflow.com/questions/29196475/slices-in-golang-do-not-allocate-any-memory/29196849#29196849", "title": "Slices in golang do not allocate any memory?", "body": "<p>Every data type allocates memory when it's initialized. In blog, he clearly mention </p>\n\n<blockquote>\n  <p>the slicing operation does not need to allocate memory.</p>\n</blockquote>\n\n<p>And he is right. Now see, <a href=\"http://golang.org/doc/effective_go.html#slices\" rel=\"nofollow\">how slice works in golang</a>. </p>\n\n<blockquote>\n  <p>Slices hold references to an underlying array, and if you assign one\n  slice to another, both refer to the same array. If a function takes a\n  slice argument, changes it makes to the elements of the slice will be\n  visible to the caller, analogous to passing a pointer to the\n  underlying array.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 0, "creation_date": 1427050232, "post_id": 29197768, "comment_id": 46609304, "body": "Why would it be on the heap before though? Example 2 and 3. Why? Otherwise thanks :D"}, {"owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 0, "creation_date": 1427050644, "post_id": 29197768, "comment_id": 46609455, "body": "Never mind got it, it&#39;s because go returned the address of the new structure right, and as you said return &amp;example puts it on the heap"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 0, "creation_date": 1427052023, "post_id": 29197768, "comment_id": 46609948, "body": "@aubble correct. I wasn&#39;t as clear as I could have been. <code>var x int</code> never needs to be on the heap since it can&#39;t be referenced past the lifetime of the function. As soon as you do <code>&amp;x</code> or <code>y := new(int)</code> they <i>might</i> live past the life of the function (referred to as escaping) and if so they need to be on the heap. (The stack space goes away &quot;automatically&quot; and cheaply on function return)."}, {"owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 0, "creation_date": 1427070765, "post_id": 29197768, "comment_id": 46615132, "body": "one more thing. &quot; Even with a fast allocator, that creates a lot of unnecessary work for the garbage collector, and we found that, as was the case with strings above, programs avoided slicing operations in favor of passing explicit indices. &quot; Where do the strings above have this? (should I make a new question or add this into my original question("}, {"owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 0, "creation_date": 1427071637, "post_id": 29197768, "comment_id": 46615337, "body": "Would the array itself be on the heap as well because of the pointer returned in the structure?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 1, "creation_date": 1427080345, "post_id": 29197768, "comment_id": 46617213, "body": "@aubble I believe in the past pretty much everything created with <code>make</code> got put on the stack so <code>slice := make([]int, x)</code> would have the slice header (ptr, len, cap) on the stack but the underlying array on the heap. At some point however escape analysis improved such that it&#39;s less clear now. Take some smallish program/packages and compile with <code>go build -gcflags=&quot;-m&quot;</code> to see what escapes and what doesn&#39;t. You&#39;ll find many small/medium slices don&#39;t escape and are put on the stack. But add <code>&amp;x</code> or do <code>fmt.Print(&amp;x)</code> and you&#39;ll see it does escape and gets moved to the heap."}, {"owner": {"reputation": 4737, "user_id": 745018, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/3f6f6b69f75cb7cd56515a696f83df6d?s=128&d=identicon&r=PG&f=1", "display_name": "crackerplace", "link": "https://stackoverflow.com/users/745018/crackerplace"}, "edited": false, "score": 0, "creation_date": 1485456790, "post_id": 29197768, "comment_id": 70943789, "body": "@dave But one point that is mentioned is that even  &quot;the slicing operation does not need to allocate memory, not even for the slice header&quot;.Not sure but whenever you create new slice ,atleast header shud be created as this slice starts at some index than the one it is created from ?"}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 6, "last_activity_date": 1427046632, "last_edit_date": 1495542326, "creation_date": 1427046632, "answer_id": 29197768, "question_id": 29196475, "link": "https://stackoverflow.com/questions/29196475/slices-in-golang-do-not-allocate-any-memory/29197768#29197768", "title": "Slices in golang do not allocate any memory?", "body": "<p>To expand on <a href=\"https://stackoverflow.com/a/29196849/55504\">Pravin Mishra's answer</a>:</p>\n\n<blockquote>\n  <p>the slicing operation does not need to allocate memory.</p>\n</blockquote>\n\n<p>\"Slicing operation\" refers to things like <code>s1[x:y]</code> and not slice initialization or <code>make([]int, x)</code>. For example:</p>\n\n<pre><code>var s1 = []int{0, 1, 2, 3, 4, 5} // &lt;&lt;- allocates (or put on stack)\ns2 := s1[1:3]                    // &lt;&lt;- does not (normally) allocate\n</code></pre>\n\n<p>That is, the second line is <em>similar</em> to:</p>\n\n<pre><code>type SliceHeader struct {\n        Data uintptr\n        Len  int\n        Cap  int\n}\n\u2026\nexample := SliceHeader{&amp;s1[1], 2, 5}\n</code></pre>\n\n<p>Usually local variables like <code>example</code> get put onto the stack. It's just like if this was done instead of using a struct:</p>\n\n<pre><code>var exampleData            uintptr\nvar exampleLen, exampleCap int\n</code></pre>\n\n<p>Those <code>example*</code> variables go onto the stack.\nOnly if the code does <code>return &amp;example</code> or <code>otherFunc(&amp;example)</code> or otherwise allows a pointer to this to escape will the compiler be forced to allocate the struct (or slice header) on the heap.</p>\n\n<blockquote>\n  <p>Then it mentions that it was originally a pointer to that slice structure, and it needed to allocate memory for a new object. Why does it not need to do that now?</p>\n</blockquote>\n\n<p>Imagine that instead of the above you did:</p>\n\n<pre><code>example2 := &amp;SliceHeader{\u2026same\u2026}\n// or\nexample3 := new(SliceHeader)\nexample3.Data = \u2026\nexample3.Len = \u2026\nexample3.Cap = \u2026\n</code></pre>\n\n<p>i.e.\u00a0the type is <code>*SliceHeader</code> rather than <code>SliceHeader</code>.\nThis is effectively what slices used to be (pre Go 1.0) according to what you mention.</p>\n\n<p>It also used to be that both <code>example2</code> and <code>example3</code> would have to be allocated on the heap. That is the \"memory for a new object\" being refered to. I <em>think</em> that now escape analysis will try and put both of these onto the stack as long as the pointer(s) are kept local to the function so it's not as big of an issue anymore. Either way though, avoiding one level of indirection is good, it's almost always faster to copy three ints compared to copying a pointer and dereferencing it repeatedly.</p>\n"}], "owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2579, "favorite_count": 1, "accepted_answer_id": 29197768, "answer_count": 2, "score": 0, "last_activity_date": 1427046632, "creation_date": 1427039658, "question_id": 29196475, "link": "https://stackoverflow.com/questions/29196475/slices-in-golang-do-not-allocate-any-memory", "title": "Slices in golang do not allocate any memory?", "body": "<p>This link: <a href=\"http://research.swtch.com/godata\" rel=\"nofollow\">http://research.swtch.com/godata</a></p>\n\n<p>It says (third paragraph of section Slices):</p>\n\n<blockquote>\n  <p>Because slices are multiword structures, not pointers, the slicing\n  operation does not need to allocate memory, not even for the slice\n  header, which can usually be kept on the stack. This representation\n  makes slices about as cheap to use as passing around explicit pointer\n  and length pairs in C. Go originally represented a slice as a pointer\n  to the structure shown above, but doing so meant that every slice\n  operation allocated a new memory object. Even with a fast allocator,\n  that creates a lot of unnecessary work for the garbage collector, and\n  we found that, as was the case with strings above, programs avoided\n  slicing operations in favor of passing explicit indices. Removing the\n  indirection and the allocation made slices cheap enough to avoid\n  passing explicit indices in most cases.</p>\n</blockquote>\n\n<p>What...? Why does it not allocate any memory? If it is a multiword structure or a pointer? Does it not need to allocate memory? Then it mentions that it was originally a pointer to that slice structure, and it needed to allocate memory for a new object. Why does it not need to do that now? Very confused</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 3, "creation_date": 1427039622, "post_id": 29196323, "comment_id": 46605673, "body": "Of course in due diligence, I overlooked the example in the go docs to dynamically sort <a href=\"http://golang.org/pkg/sort/#example__sortKeys\" rel=\"nofollow noreferrer\">golang.org/pkg/sort/#example__sortKeys</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 2, "last_activity_date": 1427056981, "creation_date": 1427056981, "answer_id": 29199611, "question_id": 29196323, "link": "https://stackoverflow.com/questions/29196323/how-do-i-pass-a-sort-interface-implementation-type-as-a-function-parameter/29199611#29199611", "title": "How do I pass a sort interface implementation type as a function parameter?", "body": "<p>Maybe this way</p>\n\n<pre><code>type Schedule struct {\n    Jobs []Job\n}\nconst(\nDifference=iota\nRatio=iota\n)\ntype ByDifference Schedule\n// ByDifference implements sort.Interface\n\ntype ByRatio Schedule\n// ByRatio implements sort.Interface\n\nfunc (s *Schedule) Schedule(order int) { // s.Schedule(Difference) for example\n    // Summation variables omitted\n    switch order{\n        case Difference: ss:= ByDifference(*s);  sort(ss); s=&amp;Schedule(ss)\n        case Ratio: ss:= ByRatio(*s);  sort(ss); s=&amp;Schedule(ss)\n    }\n\n    for _, v := range s.Jobs {\n        // Compute weighted sum omitted\n    }\n\n    // Output code omitted\n\n}\n</code></pre>\n"}], "owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 29199611, "answer_count": 1, "score": 2, "last_activity_date": 1427056981, "creation_date": 1427038910, "question_id": 29196323, "link": "https://stackoverflow.com/questions/29196323/how-do-i-pass-a-sort-interface-implementation-type-as-a-function-parameter", "title": "How do I pass a sort interface implementation type as a function parameter?", "body": "<p>I am writing different scheduling algorithm and would like to compare various ways of ordering jobs. I have a function on a struct that I would like to pass the type of a sort interface type to be used by the sort within the function.</p>\n\n<pre><code>type Schedule struct {\n    Jobs []Job\n}\n\ntype ByDifference []Job\n// ByDifference implements sort.Interface\n\ntype ByRatio []Job\n// ByRatio implements sort.Interface\n\nfunc (s *Schedule) Schedule(OrderBy sort.Interface) {\n    // Summation variables omitted\n\n    // This fails as there is no function OrderBy()\n    sort.(OrderBy(q.Jobs))\n\n    for _, v := range q.Jobs {\n        // Compute weighted sum omitted\n    }\n\n    // Output code omitted\n\n}\n</code></pre>\n\n<p>Naturally, I would like to to call the Schedule function and pass some representation of ByDifference or ByRatio and have the sort use that type. My initial reading seems to lead to type reflection. Is it possible to use this design to pass a type that implements an interface to be used by sort within a function?</p>\n"}, {"tags": ["emacs", "go"], "comments": [{"owner": {"reputation": 12253, "user_id": 2112489, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/5f4ed4b573c4e38444c6fc54b28076c0?s=128&d=identicon&r=PG", "display_name": "lawlist", "link": "https://stackoverflow.com/users/2112489/lawlist"}, "edited": false, "score": 0, "creation_date": 1427046681, "post_id": 29195496, "comment_id": 46608068, "body": "If you want to keep some of the whitespace highlighting, the variable <code>whitespace-style</code> can be adjusted to include only those elements you wish to highlight.  To see the options available for that variable, type <code>M-x describe-variable RET whitespace-style RET</code>"}], "answers": [{"tags": [], "owner": {"reputation": 20703, "user_id": 2805033, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TasHL.jpg?s=128&g=1", "display_name": "Ben Darnell", "link": "https://stackoverflow.com/users/2805033/ben-darnell"}, "is_accepted": true, "score": 1, "last_activity_date": 1427045527, "last_edit_date": 1492087965, "creation_date": 1427045527, "answer_id": 29197555, "question_id": 29195496, "link": "https://stackoverflow.com/questions/29195496/how-to-turn-off-tab-highlighting-in-go-buffers/29197555#29197555", "title": "How to turn off \u2018tab\u2019 highlighting in go buffers?", "body": "<p>To be clear, you're doing something like</p>\n\n<pre><code>(require 'whitespace)\n(global-whitespace-mode t)\n</code></pre>\n\n<p>right? You can disable <code>whitespace-mode</code> for <code>go-mode</code> with</p>\n\n<pre><code>(setq whitespace-global-modes '(not go-mode))\n</code></pre>\n\n<p>There is a <a href=\"https://emacs.stackexchange.com/questions/4229/only-enable-whitespace-mode-in-certain-buffers\">related question</a> on emacs stack exchange.</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 5117028, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-U4t0zrmau8E/AAAAAAAAAAI/AAAAAAAACgo/8aNemayVpZ8/photo.jpg?sz=128", "display_name": "Ian MacDonald", "link": "https://stackoverflow.com/users/5117028/ian-macdonald"}, "is_accepted": false, "score": 0, "last_activity_date": 1519351478, "creation_date": 1519351478, "answer_id": 48940059, "question_id": 29195496, "link": "https://stackoverflow.com/questions/29195496/how-to-turn-off-tab-highlighting-in-go-buffers/48940059#48940059", "title": "How to turn off \u2018tab\u2019 highlighting in go buffers?", "body": "<p>I found that this</p>\n\n<pre><code>(add-hook 'go-mode-hook\n      (lambda ()\n        (add-hook 'before-save-hook 'gofmt-before-save)\n        (setq whitespace-style '(face empty trailing lines-tail))\n        (setq tab-width 4)\n        (setq indent-tabs-mode 1)))\n</code></pre>\n\n<p>Worked a bit better for me. Leaves whitespace-mode on but doesn't highlight tabs. Also runs go fmt before save and sets tab width to 4. I'm using prelude. </p>\n"}, {"tags": [], "owner": {"reputation": 1009, "user_id": 6000005, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/eCjaK.jpg?s=128&g=1", "display_name": "azzamsa", "link": "https://stackoverflow.com/users/6000005/azzamsa"}, "is_accepted": false, "score": 0, "last_activity_date": 1544286151, "creation_date": 1544286151, "answer_id": 53684498, "question_id": 29195496, "link": "https://stackoverflow.com/questions/29195496/how-to-turn-off-tab-highlighting-in-go-buffers/53684498#53684498", "title": "How to turn off \u2018tab\u2019 highlighting in go buffers?", "body": "<p>Add this line </p>\n\n<pre><code>(whitespace-toggle-options '(tabs)))\n</code></pre>\n\n<p>To your go-mode hook e.g</p>\n\n<pre><code>(use-package go-mode\n  :preface\n  (defun go-mode-config ()\n    (whitespace-toggle-options '(tabs)))\n  :config\n  (add-hook 'go-mode-hook (lambda ()\n                            (go-mode-config))))\n</code></pre>\n\n<p>Taken from <a href=\"https://github.com/bbatsov/prelude/blob/bb152ad383ad6556d4cac1128f4f0d8fb32d7baf/modules/prelude-go.el#L66\" rel=\"nofollow noreferrer\">prelue go config</a></p>\n"}], "owner": {"reputation": 476, "user_id": 700011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c12d2963163d64a5e22ae0f55a471b6e?s=128&d=identicon&r=PG", "display_name": "argent_smith", "link": "https://stackoverflow.com/users/700011/argent-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 528, "favorite_count": 0, "accepted_answer_id": 29197555, "answer_count": 3, "score": 0, "last_activity_date": 1544286151, "creation_date": 1427034026, "question_id": 29195496, "link": "https://stackoverflow.com/questions/29195496/how-to-turn-off-tab-highlighting-in-go-buffers", "title": "How to turn off \u2018tab\u2019 highlighting in go buffers?", "body": "<p>I\u2019ve just started writing Go programs in Emacs. How can I turn off tabs highlighting in go-mode buffers? I use \u00abwhitespace\u00bb for whitespace chars highlighting. Go btw is the only mode where I don\u2019t want tabs highlighted since tabs are standard formatting in Go.</p>\n\n<p>Sincerely, Pavel. </p>\n"}, {"tags": ["json", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 2297, "user_id": 661378, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/853372c681dc96b95f42adcb88b0cb3f?s=128&d=identicon&r=PG", "display_name": "qwertmax", "link": "https://stackoverflow.com/users/661378/qwertmax"}, "edited": false, "score": 0, "creation_date": 1427022984, "post_id": 29193556, "comment_id": 46600674, "body": "As soon as I made a post, stackoverflow highlighted the go code, it immediately made me think about the exported and not exported values"}], "answers": [{"tags": [], "owner": {"reputation": 2297, "user_id": 661378, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/853372c681dc96b95f42adcb88b0cb3f?s=128&d=identicon&r=PG", "display_name": "qwertmax", "link": "https://stackoverflow.com/users/661378/qwertmax"}, "is_accepted": true, "score": 10, "last_activity_date": 1427022651, "creation_date": 1427022651, "answer_id": 29193629, "question_id": 29193556, "link": "https://stackoverflow.com/questions/29193556/go-json-unmarshal-do-not-working/29193629#29193629", "title": "go json.Unmarshal do not working", "body": "<p>I've found error </p>\n\n<p>was </p>\n\n<pre><code>    type GOOGLE_JSON struct {\n        code        string `json:\"code\"`\n        clientId    string `json:\"clientId\"`\n        redirectUri string `json:\"redirectUri\"`\n    }\n</code></pre>\n\n<p>must be capital letters</p>\n\n<pre><code>    type GOOGLE_JSON struct {\n        Code        string `json:\"code\"`\n        ClientId    string `json:\"clientId\"`\n        RedirectUri string `json:\"redirectUri\"`\n    }\n</code></pre>\n\n<p>I was inattentive</p>\n\n<pre><code>Code // &lt;- exported\nClientId // &lt;- exported\nRedirectUri // &lt;- exported\n\ncode // &lt;-- not exported\nclientId // &lt;-- not exported\nredirectUri // &lt;-- not exported\n</code></pre>\n"}], "owner": {"reputation": 2297, "user_id": 661378, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/853372c681dc96b95f42adcb88b0cb3f?s=128&d=identicon&r=PG", "display_name": "qwertmax", "link": "https://stackoverflow.com/users/661378/qwertmax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1162, "favorite_count": 2, "accepted_answer_id": 29193629, "answer_count": 1, "score": 3, "last_activity_date": 1427022651, "creation_date": 1427022163, "question_id": 29193556, "link": "https://stackoverflow.com/questions/29193556/go-json-unmarshal-do-not-working", "title": "go json.Unmarshal do not working", "body": "<p>I have json which is not decoded to struct. </p>\n\n<p>I know that error somewhere in my code, but I'm stuck and do not know where the error is and what am I doing wrong</p>\n\n<p>Help me please, here is my code:</p>\n\n<pre><code>type GOOGLE_JSON struct {\n    code        string `json:\"code\"`\n    clientId    string `json:\"clientId\"`\n    redirectUri string `json:\"redirectUri\"`\n}\n\nbody := []byte(`{\"code\":\"111\",\"clientId\":\"222\",\"redirectUri\":\"333\"}`)\n\n//google_json := GOOGLE_JSON{}\nvar google_json GOOGLE_JSON\n\nerr := json.Unmarshal(body, &amp;google_json)\nif err != nil {\n    fmt.Println(err)\n}\nfmt.Println(google_json)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/JuCz9l4CoX\" rel=\"nofollow\">example here</a></p>\n"}, {"tags": ["http", "ssl", "curl", "go"], "owner": {"reputation": 9173, "user_id": 172265, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/7d658f2c111ae5d8b48f0f0aa7624372?s=128&d=identicon&r=PG", "display_name": "lang2", "link": "https://stackoverflow.com/users/172265/lang2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 413, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1427014486, "creation_date": 1427013998, "question_id": 29192498, "link": "https://stackoverflow.com/questions/29192498/http-tls-server-golang-not-working-with-curl", "title": "http tls server (golang) not working with curl", "body": "<p>So I'm trying to secure some REST API with TLS + http basic auth (I know it's not the best option but will start with and maybe move to OAuth later). Here is what I did:</p>\n\n<ul>\n<li>Generate cert and key with generate_cert.go. This gives cert.pem and key.pem</li>\n<li>In the server code, I used <code>ListenAndServeTLS()</code> with no extra option.</li>\n<li>So I fired up browser and go to <a href=\"https://localhost:8000\" rel=\"nofollow\">https://localhost:8000</a>. After adding an certificate exception, it works fine.</li>\n</ul>\n\n<p>Now I have a few shell scripts for testing purpose using <code>curl</code>. I tried </p>\n\n<pre><code>curl -i --cacert cert.pem https://localhost:8000\n</code></pre>\n\n<p>and fully expected to see some JSON dump but all I got was the following error message:</p>\n\n<pre><code>curl: (60) SSL certificate problem: unable to get local issuer certificate\nMore details here: http://curl.haxx.se/docs/sslcerts.html\n\ncurl performs SSL certificate verification by default, using a \"bundle\"\n of Certificate Authority (CA) public keys (CA certs). If the default\n bundle file isn't adequate, you can specify an alternate file\n using the --cacert option.\nIf this HTTPS server uses a certificate signed by a CA represented in\n the bundle, the certificate verification probably failed due to a\n problem with the certificate (it might be expired, or the name might\n not match the domain name in the URL).\nIf you'd like to turn off curl's verification of the certificate, use\n the -k (or --insecure) option.\n</code></pre>\n\n<p>Am I doing it wrong? If so, how can I use curl for this purpose?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "edited": false, "score": 0, "creation_date": 1427014550, "post_id": 29192478, "comment_id": 46598804, "body": "Where is your full code? Where is userKey defined? What do you mean by tried couple of ways? Just hustling pointers and references won&#39;t magically fix your problem."}, {"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1427014927, "post_id": 29192478, "comment_id": 46598873, "body": "@Allendar i added the putUser method  , this is how  i insert a user"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "edited": false, "score": 1, "creation_date": 1427015583, "post_id": 29192478, "comment_id": 46598999, "body": "I still don&#39;t really get it tho. Nil-pointer itself mostly means that someone uses a value while a checked error should&#39;ve told you that the code went wrong at an earlier point. Nil-pointers imply a unfilled peace of memory. If this is a value coming from Google&#39;s own API, then the only conclusion is that an error-check isn&#39;t done. If it&#39;s your own code, then its likely a fault in your type-assignment. It&#39;s a common mistake to put wrong memory references in memory-pointers."}], "answers": [{"tags": [], "owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "is_accepted": true, "score": 2, "last_activity_date": 1530071008, "creation_date": 1530071008, "answer_id": 51054242, "question_id": 29192478, "link": "https://stackoverflow.com/questions/29192478/datastore-invalid-entity-type-on-get/51054242#51054242", "title": "datastore: invalid entity type on get", "body": "<p>It's because <code>datastore.Get(c, k, \"pointer\")</code> expects a pointer to struct as its third argument, and you are passing a pointer of a pointer <code>**userRes</code></p>\n\n<pre><code>userRes := new(Users)\n</code></pre>\n\n<p>There you are creating a pointer to struct <a href=\"https://stackoverflow.com/questions/34543430/golang-basics-struct-and-new-keyword\">see</a></p>\n\n<p>So you should do:</p>\n\n<pre><code>datastore.Get(c, k, userRes)\n</code></pre>\n\n<p>Without the ampersand, because with new keyword you are already creating a pointer</p>\n"}], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1115, "favorite_count": 0, "accepted_answer_id": 51054242, "answer_count": 1, "score": 1, "last_activity_date": 1530071008, "creation_date": 1427013743, "last_edit_date": 1477976221, "question_id": 29192478, "link": "https://stackoverflow.com/questions/29192478/datastore-invalid-entity-type-on-get", "title": "datastore: invalid entity type on get", "body": "<p>Hey  im trying to get  an entity by passing an  id ,</p>\n\n<p>But it`s look like im getting a <strong>nill pointer</strong>\nI tried to initialize the entity in couple  of ways but the result is the same.</p>\n\n<p>I'm trying  to create my server  as much as i can like this example \n<a href=\"https://github.com/campoy/todo/blob/master/task/task.go\" rel=\"nofollow\">to-do</a> </p>\n\n<p>what am im missing here ?   </p>\n\n<pre><code>type UserManager struct {\n    users []*Users\n    user  *Users\n}\n\nfunc NewUserManager() *UserManager {\n    return &amp;UserManager{}\n}\n\n func (userManager *UserManager) putUser(c appengine.Context, u *Users) (usreRes *Users, err error) {\n\nkey, err := datastore.Put(c, datastore.NewIncompleteKey(c, \"users\", nil), u)\nif err != nil {\n    return nil, err\n }\nc.Debugf(\"file key inserted :%#v\", key)\nreturn u, nil\n}\n\n\nfunc (userManager *UserManager) getUserById(userKey string, c appengine.Context) (usreRes *Users, err error) {\n\nentity_id_int, err := strconv.ParseInt(userKey, 10, 64)\n\nif err != nil {\n    return userManager.user, err\n}\nk := datastore.NewKey(c, \"users\", \"\", entity_id_int, nil)\n\nuserRes := new(Users)\nerr = datastore.Get(c, k, &amp;userRes)\n\n//err = datastore.Get(c, k, &amp;userManager.user)\n\nif err != nil {\n    return userManager.user, err\n}\n\n//return userManager.user,nil\nreturn userRes, nil\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1427006390, "post_id": 29191689, "comment_id": 46597279, "body": "Nothing special; you can do this in your code. The trick is that <code>b</code> isn&#39;t a <code>nil</code> <i>pointer</i> to <code>bytes.Buffer</code>, it&#39;s a <code>bytes.Buffer</code> <i>struct</i> with all its fields initially zeroed."}], "answers": [{"comments": [{"owner": {"reputation": 587, "user_id": 3587115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/veo3Q.jpg?s=128&g=1", "display_name": "Sundrique", "link": "https://stackoverflow.com/users/3587115/sundrique"}, "edited": false, "score": 0, "creation_date": 1427007620, "post_id": 29191782, "comment_id": 46597485, "body": "But I didn&#39;t allocate <code>bytes.Buffer</code> neither with <code>new</code> keyword or struct literal. How come, it get&#39;s me initialized <code>bytes.Buffer</code> object."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 587, "user_id": 3587115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/veo3Q.jpg?s=128&g=1", "display_name": "Sundrique", "link": "https://stackoverflow.com/users/3587115/sundrique"}, "edited": false, "score": 2, "creation_date": 1427007786, "post_id": 29191782, "comment_id": 46597516, "body": "<code>var T</code> allocates a <code>T</code>: <a href=\"https://golang.org/ref/spec#Variables\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Variables</a> (<code>var *T</code> does not allocate a <code>T</code>.)"}], "tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 7, "last_activity_date": 1427007108, "creation_date": 1427007108, "answer_id": 29191782, "question_id": 29191689, "link": "https://stackoverflow.com/questions/29191689/how-to-assign-to-a-field-of-nil-struct-in-golang/29191782#29191782", "title": "How to assign to a field of nil struct in golang", "body": "<p>The crucial thing is <code>var b bytes.Buffer</code> doesn't get you a <code>nil</code> pointer, it gets you a <code>bytes.Buffer</code> object with all its fields initialized with their zero values (in machine terms, with zero bytes). <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"noreferrer\">The spec says</a> the zero value is \"false for booleans, 0 for integers, 0.0 for floats, \"\" for strings, and nil for pointers, functions, interfaces, slices, channels, and maps\"; follow that link for more detail.</p>\n\n<p>It is possible to make your own structs whose zero values work and <a href=\"http://golang.org/doc/effective_go.html#allocation_new\" rel=\"noreferrer\">the Go team encourages it</a>. <code>struct Position { x, y int }</code> is an easy example and Effective Go gives a more realistic one. But note that that doesn't make <em>the nil pointer</em> work; you would still need <code>new(Node)</code> or <code>var n Node</code> to allocate the zero <code>Node</code>. Same for <code>bytes.Buffer</code>. </p>\n\n<p>Another common use of zero values: wherever your users create structs of your type directly (as folks do with, say, <a href=\"http://golang.org/pkg/net/http/#Server\" rel=\"noreferrer\"><code>http.Server</code></a>), the zero value is the default for any fields they don't specify. It's the default in a lot of other places: what you get for a not-found map key, if you receive from a closed channel, and probably others.</p>\n"}], "owner": {"reputation": 587, "user_id": 3587115, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/veo3Q.jpg?s=128&g=1", "display_name": "Sundrique", "link": "https://stackoverflow.com/users/3587115/sundrique"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4436, "favorite_count": 0, "accepted_answer_id": 29191782, "answer_count": 1, "score": 0, "last_activity_date": 1427008346, "creation_date": 1427006093, "last_edit_date": 1427008346, "question_id": 29191689, "link": "https://stackoverflow.com/questions/29191689/how-to-assign-to-a-field-of-nil-struct-in-golang", "title": "How to assign to a field of nil struct in golang", "body": "<p>I'm trying to assign a value to a field, but my program panics with <code>runtime error: invalid memory address or nil pointer dereference</code>.</p>\n\n<pre><code>package main\n\ntype Node struct {\n    Value int\n}\n\nfunc (n *Node) SetValue(value int) {\n    n.Value = value\n}\n\nfunc main() {\n    var n *Node\n\n    n.SetValue(1)\n}\n</code></pre>\n\n<p>This is reasonable since variable is nil.<br/>\nBut I've fount some Go internal structs are allowed to do this, e.g. <code>bytes.Buffer</code></p>\n\n<pre><code>package main\n\nimport \"bytes\"\nimport \"io\"\nimport \"os\"\n\nfunc main() {\n    var b bytes.Buffer\n    b.Write([]byte(\"Hello world\"))\n    io.Copy(os.Stdout, &amp;b)\n}\n</code></pre>\n\n<p>Here is the `bytes.Buffer source code</p>\n\n<pre><code>func (b *Buffer) Write(p []byte) (n int, err error) {\n    b.lastRead = opInvalid\n    m := b.grow(len(p))\n    return copy(b.buf[m:], p), nil\n}\n</code></pre>\n\n<p>Is it the thing only builtin structs can do or it's possible to accomplish this in my code?</p>\n\n<p><strong>EDIT</strong><br/>\nHere is the working example. Thanks @twotwotwo for suggestion.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Node struct {\n    Value int\n}\n\nfunc (n *Node) SetValue(value int) {\n    n.Value = value\n}\n\nfunc main() {\n    var n Node\n\n    n.SetValue(1)\n\n    fmt.Println(n.Value)\n}\n</code></pre>\n"}, {"tags": ["syntax", "go", "overloading"], "answers": [{"comments": [{"owner": {"reputation": 1658, "user_id": 516037, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b4987583409b6d79fca0bd1145c54609?s=128&d=identicon&r=PG&f=1", "display_name": "dpington", "link": "https://stackoverflow.com/users/516037/dpington"}, "edited": false, "score": 0, "creation_date": 1426996963, "post_id": 29190830, "comment_id": 46595803, "body": "So the <code>map</code> and <code>for i := range blah { }</code>, <code>for i, x := range blah { }</code> are all special?"}, {"owner": {"reputation": 81, "user_id": 4654998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b49ef7bad8e98db4a10d483a7cd4815c?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyWearsPJs", "link": "https://stackoverflow.com/users/4654998/crazywearspjs"}, "reply_to_user": {"reputation": 1658, "user_id": 516037, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b4987583409b6d79fca0bd1145c54609?s=128&d=identicon&r=PG&f=1", "display_name": "dpington", "link": "https://stackoverflow.com/users/516037/dpington"}, "edited": false, "score": 1, "creation_date": 1426997813, "post_id": 29190830, "comment_id": 46595930, "body": "Yes, those are special syntax.   For user-defined functions, the idiom is to create wrapper functions for different arguments/return values.  e.g. <code>k := customMap.GetKey()</code>, <code>k, v := customMap.GetKeyValue()</code>"}], "tags": [], "owner": {"reputation": 81, "user_id": 4654998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b49ef7bad8e98db4a10d483a7cd4815c?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyWearsPJs", "link": "https://stackoverflow.com/users/4654998/crazywearspjs"}, "is_accepted": true, "score": 1, "last_activity_date": 1426997253, "last_edit_date": 1426997253, "creation_date": 1426996830, "answer_id": 29190830, "question_id": 29190683, "link": "https://stackoverflow.com/questions/29190683/is-the-golang-multiple-return-overloading-unique-to-the-map-type/29190830#29190830", "title": "Is the Golang multiple return overloading unique to the map type?", "body": "<p>Go doesn't support overloading even if the two functions have different arity in parameters or return values or even if the parameters have different parameter or return types.</p>\n\n<p><a href=\"http://golang.org/doc/faq#overloading\" rel=\"nofollow\">http://golang.org/doc/faq#overloading</a></p>\n\n<p>There is no list of special identifiers or special rules that the built-ins get away with as far as I know. However, they seem to be few and far in-between.</p>\n"}, {"tags": [], "owner": {"reputation": 7514, "user_id": 1008837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f67dc852a25a639e13fafbec62eec69?s=128&d=identicon&r=PG&f=1", "display_name": "Pravin Mishra", "link": "https://stackoverflow.com/users/1008837/pravin-mishra"}, "is_accepted": false, "score": 0, "last_activity_date": 1469163126, "last_edit_date": 1469163126, "creation_date": 1426997915, "answer_id": 29190944, "question_id": 29190683, "link": "https://stackoverflow.com/questions/29190683/is-the-golang-multiple-return-overloading-unique-to-the-map-type/29190944#29190944", "title": "Is the Golang multiple return overloading unique to the map type?", "body": "<p>The example you are given are not method overloading.</p>\n\n<p>1st Example: Show whether key exist in map or not.</p>\n\n<pre><code>m := make(map[int]int)\nelem, ok := m[1]\nelem = m[1]\n</code></pre>\n\n<p><code>elem</code> will receive either the value of \"1\" from the map or a \"zero value\" and ok will receive a bool that will be set to true if \"foo\" was actually present in the map.</p>\n\n<p>Officially Site: <a href=\"http://golang.org/doc/faq#overloading\" rel=\"nofollow\">Go not support overloading of methods and operators?</a></p>\n\n<blockquote>\n  <p>Method dispatch is simplified if it doesn't need to do type matching\n  as well. Experience with other languages told us that having a variety\n  of methods with the same name but different signatures was\n  occasionally useful but that it could also be confusing and fragile in\n  practice. Matching only by name and requiring consistency in the types\n  was a major simplifying decision in Go's type system.</p>\n</blockquote>\n\n<p>Golang supports variadic functions and methods. That is a another way you can (more or less) do function and method overloading in Golang.</p>\n\n<blockquote>\n  <p>A variadic function or method is a function or method that accepts a\n  variable number of parameters.</p>\n</blockquote>\n\n<p><a href=\"http://play.golang.org/p/edhQHrQ54z\" rel=\"nofollow\">Example</a>:</p>\n\n<pre><code>o1 := Overload(1, 2, 3)\no2 := Overload(153, 196883, 1729, 1634, 5, 36)\no3 := Overload(1, -2)\n</code></pre>\n\n<p>For more details you can look to this post: <a href=\"http://changelog.ca/log/2015/01/30/golang\" rel=\"nofollow\">Function and Method Overloading in Golang.</a></p>\n"}, {"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": false, "score": 6, "last_activity_date": 1427074887, "last_edit_date": 1427074887, "creation_date": 1426998606, "answer_id": 29191008, "question_id": 29190683, "link": "https://stackoverflow.com/questions/29190683/is-the-golang-multiple-return-overloading-unique-to-the-map-type/29191008#29191008", "title": "Is the Golang multiple return overloading unique to the map type?", "body": "<p>It's special syntax. Besides the map key check, at least <a href=\"http://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">type assertion</a> and <a href=\"http://golang.org/ref/spec#Receive_operator\" rel=\"nofollow\">channel receive</a> have one- and two-element versions. In all those cases, the second element is a <code>bool</code> called <code>ok</code> in the doc examples; for type assertions it says whether the assertion succeeded and for channel receives it says whether the communication succeeded (<code>false</code> if the channel is closed and empty).</p>\n\n<p><code>for...range</code> has its own, different one- and two-element versions, though maybe <code>range</code> is more-obviously special.</p>\n\n<p>There is a <a href=\"http://golang.org/ref/spec#Built-in_functions\" rel=\"nofollow\">list of built-in functions</a>. If you really want to know all of the corner cases, <a href=\"http://golang.org/ref/spec\" rel=\"nofollow\">go over the spec</a>--it is pretty short, not bogged down in the sorts of details some standards documents are, and worth the time once you've played with the language a bit. (<a href=\"http://golang.org/doc/effective_go.html\" rel=\"nofollow\">Effective Go</a> and <a href=\"http://golang.org/doc/faq\" rel=\"nofollow\">the FAQ</a> are also in this category.)</p>\n"}], "owner": {"reputation": 1658, "user_id": 516037, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b4987583409b6d79fca0bd1145c54609?s=128&d=identicon&r=PG&f=1", "display_name": "dpington", "link": "https://stackoverflow.com/users/516037/dpington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 0, "accepted_answer_id": 29190830, "answer_count": 3, "score": 2, "last_activity_date": 1520345091, "creation_date": 1426995405, "last_edit_date": 1520345091, "question_id": 29190683, "link": "https://stackoverflow.com/questions/29190683/is-the-golang-multiple-return-overloading-unique-to-the-map-type", "title": "Is the Golang multiple return overloading unique to the map type?", "body": "<p>These both work:</p>\n\n<pre><code>m := make(map[int]int)\nelem, ok := m[1]\nelem = m[1]\n</code></pre>\n\n<p>Yet, this not allowed:</p>\n\n<pre><code>func overload() (int, int) {\n    return 1, 1\n}\n\nfunc overload() int {\n    return 1\n}\n\nfunc main() {\n    x := overload()\n    x, y := overload()\n}\n</code></pre>\n\n<p>Also, is there a list of built-in syntax that doesn't generalize? I keep getting confused on what is a special syntax, i.e. <code>map[string]int</code>, <code>make([]int, 10)</code> and what is part of the language.</p>\n"}, {"tags": ["memory-leaks", "go", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "edited": false, "score": 0, "creation_date": 1426992900, "post_id": 29190369, "comment_id": 46595169, "body": "thanks, I see how the second one exits these routines now too. Thank you very much."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4122236"}, "is_accepted": true, "score": 2, "last_activity_date": 1426992136, "creation_date": 1426992136, "answer_id": 29190369, "question_id": 29190333, "link": "https://stackoverflow.com/questions/29190333/golang-goroutine-leak/29190369#29190369", "title": "Golang Goroutine leak", "body": "<p>The program stops receiving on the channels when a difference is detected. </p>\n\n<p>The walk goroutines run until they block sending to the channels. They never exit. This is the leak.</p>\n"}, {"tags": [], "owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "is_accepted": false, "score": 0, "last_activity_date": 1466762284, "creation_date": 1466762284, "answer_id": 38010631, "question_id": 29190333, "link": "https://stackoverflow.com/questions/29190333/golang-goroutine-leak/38010631#38010631", "title": "Golang Goroutine leak", "body": "<p>The second solution handles the leak by using the quit channel. When the quit channel is closed (in Same() function), the case 2 of select statement succeeds(case &lt;-quit in walkImpl function) and the function returns. Hence there is no block in the walkImpl function after the program exits.</p>\n"}], "owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 982, "favorite_count": 0, "accepted_answer_id": 29190369, "answer_count": 2, "score": 2, "last_activity_date": 1466762284, "creation_date": 1426991752, "question_id": 29190333, "link": "https://stackoverflow.com/questions/29190333/golang-goroutine-leak", "title": "Golang Goroutine leak", "body": "<pre><code>// Copyright 2012 The Go Authors.  All rights reserved.\n// Use of this source code is governed by a BSD-style\n// license that can be found in the LICENSE file.\n\n// +build ignore\n\npackage main\n\nimport (\n    \"fmt\"\n\n    \"code.google.com/p/go-tour/tree\"\n)\n\nfunc walkImpl(t *tree.Tree, ch chan int) {\n    if t == nil {\n        return\n    }\n    walkImpl(t.Left, ch)\n    ch &lt;- t.Value\n    walkImpl(t.Right, ch)\n}\n\n// Walk walks the tree t sending all values\n// from the tree to the channel ch.\nfunc Walk(t *tree.Tree, ch chan int) {\n    walkImpl(t, ch)\n    // Need to close the channel here\n    close(ch)\n}\n\n// Same determines whether the trees\n// t1 and t2 contain the same values.\n// NOTE: The implementation leaks goroutines when trees are different.\n// See binarytrees_quit.go for a better solution.\nfunc Same(t1, t2 *tree.Tree) bool {\n    w1, w2 := make(chan int), make(chan int)\n\n    go Walk(t1, w1)\n    go Walk(t2, w2)\n\n    for {\n        v1, ok1 := &lt;-w1\n        v2, ok2 := &lt;-w2\n        if !ok1 || !ok2 {\n            return ok1 == ok2\n        }\n        if v1 != v2 {\n            return false\n        }\n    }\n}\n\nfunc main() {\n    fmt.Print(\"tree.New(1) == tree.New(1): \")\n    if Same(tree.New(1), tree.New(1)) {\n        fmt.Println(\"PASSED\")\n    } else {\n        fmt.Println(\"FAILED\")\n    }\n\n    fmt.Print(\"tree.New(1) != tree.New(2): \")\n    if !Same(tree.New(1), tree.New(2)) {\n        fmt.Println(\"PASSED\")\n    } else {\n        fmt.Println(\"FAILED\")\n    }\n}\n</code></pre>\n\n<p>In this code, a solution for <a href=\"http://tour.golang.org/concurrency/8\" rel=\"nofollow\">http://tour.golang.org/concurrency/8</a></p>\n\n<p>Why is there a comment on Same() func Same(t1, t2 *tree.Tree) bool saying that it leaks goroutines? How so? It also mentions a second file that fixes this: </p>\n\n<pre><code>// Copyright 2015 The Go Authors.  All rights reserved.\n// Use of this source code is governed by a BSD-style\n// license that can be found in the LICENSE file.\n\n// +build ignore\n\npackage main\n\nimport (\n    \"fmt\"\n\n    \"code.google.com/p/go-tour/tree\"\n)\n\nfunc walkImpl(t *tree.Tree, ch, quit chan int) {\n    if t == nil {\n        return\n    }\n    walkImpl(t.Left, ch, quit)\n    select {\n    case ch &lt;- t.Value:\n        // Value successfully sent.\n    case &lt;-quit:\n        return\n    }\n    walkImpl(t.Right, ch, quit)\n}\n\n// Walk walks the tree t sending all values\n// from the tree to the channel ch.\nfunc Walk(t *tree.Tree, ch, quit chan int) {\n    walkImpl(t, ch, quit)\n    close(ch)\n}\n\n// Same determines whether the trees\n// t1 and t2 contain the same values.\nfunc Same(t1, t2 *tree.Tree) bool {\n    w1, w2 := make(chan int), make(chan int)\n    quit := make(chan int)\n    defer close(quit)\n\n    go Walk(t1, w1, quit)\n    go Walk(t2, w2, quit)\n\n    for {\n        v1, ok1 := &lt;-w1\n        v2, ok2 := &lt;-w2\n        if !ok1 || !ok2 {\n            return ok1 == ok2\n        }\n        if v1 != v2 {\n            return false\n        }\n    }\n}\n\nfunc main() {\n    fmt.Print(\"tree.New(1) == tree.New(1): \")\n    if Same(tree.New(1), tree.New(1)) {\n        fmt.Println(\"PASSED\")\n    } else {\n        fmt.Println(\"FAILED\")\n    }\n\n    fmt.Print(\"tree.New(1) != tree.New(2): \")\n    if !Same(tree.New(1), tree.New(2)) {\n        fmt.Println(\"PASSED\")\n    } else {\n        fmt.Println(\"FAILED\")\n    }\n}\n</code></pre>\n\n<p>How does it accomplish that? Where was this leak? (to test the code you will have to run it on <a href=\"http://tour.golang.org/concurrency/8\" rel=\"nofollow\">http://tour.golang.org/concurrency/8</a>). Very confused and would appreciate some help, thanks!</p>\n"}, {"tags": ["go", "built-in"], "answers": [{"comments": [{"owner": {"reputation": 78771, "user_id": 831878, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1d1a4823c46ad92f357b4bb7e74a64b0?s=128&d=identicon&r=PG", "display_name": "Ray Toal", "link": "https://stackoverflow.com/users/831878/ray-toal"}, "edited": false, "score": 0, "creation_date": 1426990304, "post_id": 29190186, "comment_id": 46594796, "body": "Correct. &quot;For documentation purposes only&quot; comes from <a href=\"http://golang.org/pkg/builtin/#Type\" rel=\"nofollow noreferrer\">this description</a>."}], "tags": [], "owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "is_accepted": true, "score": 1, "last_activity_date": 1426990151, "creation_date": 1426990151, "answer_id": 29190186, "question_id": 29190165, "link": "https://stackoverflow.com/questions/29190165/are-the-builtins-the-only-functions-that-can-accept-a-type-parameter/29190186#29190186", "title": "Are the builtins the only functions that can accept a type parameter?", "body": "<p>No - you cannot.</p>\n\n<p>They are special cases. The <code>builtin</code> package is there purely for documentation purposes .. there is no actual way for you to accept a type parameter like that. You may have already seen that Go does not support generics.</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 4654998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b49ef7bad8e98db4a10d483a7cd4815c?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyWearsPJs", "link": "https://stackoverflow.com/users/4654998/crazywearspjs"}, "is_accepted": false, "score": 0, "last_activity_date": 1426990223, "creation_date": 1426990223, "answer_id": 29190192, "question_id": 29190165, "link": "https://stackoverflow.com/questions/29190165/are-the-builtins-the-only-functions-that-can-accept-a-type-parameter/29190192#29190192", "title": "Are the builtins the only functions that can accept a type parameter?", "body": "<p>It looks like a built-in only syntax.</p>\n\n<p>Even in the documented source, they note that the in <code>func make(Type, size IntegerType) Type</code> the \n<code>Type</code> parameter is just a stand-in for any Go-type and is only explicitly stated for documentation purposes only.</p>\n\n<p>Source: <a href=\"https://golang.org/src/builtin/builtin.go\" rel=\"nofollow\">https://golang.org/src/builtin/builtin.go</a> </p>\n"}], "owner": {"reputation": 1658, "user_id": 516037, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b4987583409b6d79fca0bd1145c54609?s=128&d=identicon&r=PG&f=1", "display_name": "dpington", "link": "https://stackoverflow.com/users/516037/dpington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 29190186, "answer_count": 2, "score": 2, "last_activity_date": 1426990223, "creation_date": 1426989740, "question_id": 29190165, "link": "https://stackoverflow.com/questions/29190165/are-the-builtins-the-only-functions-that-can-accept-a-type-parameter", "title": "Are the builtins the only functions that can accept a type parameter?", "body": "<p>The <code>make</code> function takes a type parameter.</p>\n\n<p>i.e. <code>make([]int, 3)</code></p>\n\n<p>Is this just a special syntax for builtins or can we create functions that take types (without reflection of course).</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1426986778, "post_id": 29189878, "comment_id": 46594249, "body": "It&#39;s the method receiver (<a href=\"http://golang.org/ref/spec#Method_declarations\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Method_declarations</a>), similar to other languages&#39; &quot;this&quot;, and you use a pointer if the object may be large or the method may need to change the object--if you copy the thing, the method can only change <i>its copy</i> of the object."}, {"owner": {"reputation": 14145, "user_id": 1255956, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a6a3498ebb173fb2373fded6f46d65fd?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1255956/chris"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1426986834, "post_id": 29189878, "comment_id": 46594255, "body": "@twotwotwo can you please paste this in answer so I can accept it? Thank you! Makes sense"}], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 2, "last_activity_date": 1426987360, "creation_date": 1426987360, "answer_id": 29189946, "question_id": 29189878, "link": "https://stackoverflow.com/questions/29189878/go-function-parameters/29189946#29189946", "title": "Go function parameters", "body": "<p>The <code>(*db Database)</code> in front of the method name is the <a href=\"http://golang.org/ref/spec#Method_declarations\" rel=\"nofollow\">method receiver</a>, similar to other languages' \"this\", and you use a pointer if the object may be large or the method may need to change the object--if you copy it, the method can only change its copy of the object.</p>\n"}, {"tags": [], "owner": {"reputation": 7514, "user_id": 1008837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f67dc852a25a639e13fafbec62eec69?s=128&d=identicon&r=PG&f=1", "display_name": "Pravin Mishra", "link": "https://stackoverflow.com/users/1008837/pravin-mishra"}, "is_accepted": false, "score": 1, "last_activity_date": 1427002167, "creation_date": 1427002167, "answer_id": 29191330, "question_id": 29189878, "link": "https://stackoverflow.com/questions/29189878/go-function-parameters/29191330#29191330", "title": "Go function parameters", "body": "<p>In Go, you can define methods using both pointer and no-pointer method <a href=\"http://golang.org/ref/spec#Method_sets\" rel=\"nofollow\">receivers</a>. The formate feels like <code>func (t *Type)</code> and <code>func (t Type)</code> respective.</p>\n\n<p>So what\u2019s the difference between pointer and non-pointer method receivers?</p>\n\n<p>a) Reasons when use pointer receiver?</p>\n\n<ol>\n<li>You want to actually modify the receiver (<code>read/write</code> as opposed to just \u201cread\u201d)</li>\n<li>The struct is very large and a deep copy is expensive.</li>\n<li>Consistency: if some of the methods on the struct have pointer receivers, the rest should too. This allows predictability of behavior.</li>\n<li>If the receiver is a large struct or array, a pointer receiver is more efficient.</li>\n</ol>\n\n<p>If you need these characteristics on your method call, use a pointer receiver.</p>\n\n<p>b) Reasons when use value receiver?</p>\n\n<ol>\n<li>If the receiver is a map, func or chan, don't use a pointer to it.</li>\n<li>If the receiver is a slice and the method doesn't reslice or reallocate the slice, don't use a pointer to it.</li>\n</ol>\n"}], "owner": {"reputation": 14145, "user_id": 1255956, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a6a3498ebb173fb2373fded6f46d65fd?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1255956/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 29189946, "answer_count": 2, "score": -1, "last_activity_date": 1427002167, "creation_date": 1426986578, "question_id": 29189878, "link": "https://stackoverflow.com/questions/29189878/go-function-parameters", "title": "Go function parameters", "body": "<pre><code>func (db *Database) VerifyEmail(emailAddress string) (*data.UserName, error) {\n....\n}\n</code></pre>\n\n<p>Can someone please help clarify 1.what and 2.why with the above function? From the <a href=\"https://golang.org/doc/codewalk/functions/\" rel=\"nofollow\">docs</a> and <a href=\"https://gobyexample.com/functions\" rel=\"nofollow\">this</a> book I can tell that VerifyEmail is taking in emailAdress as a parameter and returning what I think is the  memory address to a username.</p>\n\n<p>However, what does <code>(db *Database)</code> do? I mean why put that after <code>func</code> and before the name of the function? And what may be some reasons to pass the memory address to a function as a pointer as opposed to the variable representing it?</p>\n"}, {"tags": ["winapi", "go", "cgo"], "comments": [{"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1426978540, "post_id": 29188730, "comment_id": 46592628, "body": "If <code>pSharedMem</code> comes from cgo, then yes, that is correct, and yes, it is performant, but <a href=\"https://github.com/golang/go/blob/25bf792197ff737fc84c8b1dd46be8a6b066333a/src/runtime/string.go#L312-L320\" rel=\"nofollow noreferrer\">it will copy memory</a>, so you can&#39;t write to the new byte slice and expect the underlying C array to change. If you have to change the original C array. you could use <code>reflect.SliceHeader</code> and an <code>unsafe.Pointer</code>-based <code>*[]byte</code> cast. This won&#39;t do a copy, but is less safe."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1426978638, "post_id": 29188730, "comment_id": 46592646, "body": "Though are you rewriting the library entirely, or simply writing a bindings package? If you&#39;re doing a full rewrite, would you not be able to get rid of the C code entirely (and thus should choose a different approach to implementing <code>irsdk_header</code>)? <code>pSharedMem</code> appears to come from a memory-mapped file, and there are several mmap packages for Go (as well as <code>syscall.Mmap()</code>)..."}, {"owner": {"reputation": 769, "user_id": 294916, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1a9637acaccba514bf6c2cecf80c3f16?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/294916/leon"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1427029933, "post_id": 29188730, "comment_id": 46602590, "body": "Thanks! Copying isn&#39;t bad because the memory-mapped file could change 60 times a second. So when copying it I have time to process the data. I would love to get rid of cgo but I don&#39;t know how. The memory-mapped file is provided by an external (closed source) process with a specific layout. I thought if I wouldn&#39;t use C.int&#39;s the memory wouldn&#39;t map correctly to the struct. I could be wrong because of my lack of understanding this stuff..."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1427050833, "creation_date": 1427050833, "answer_id": 29198536, "question_id": 29188730, "link": "https://stackoverflow.com/questions/29188730/what-is-the-best-safest-most-performant-way-of-getting-a-specific-slice-of-b/29198536#29198536", "title": "What is the best (safest + most performant) way of getting a specific slice of bytes from an unsafe.Pointer", "body": "<p><code>GoBytes</code> is going to be the safest method. You still have to ensure that the array exists for the entirety of the copy operation, but once you have the bytes copied, you know it can't be changed from cgo. As long as the memory being copied isn't too large, or the copy presents a performance problem, this is the way to go.</p>\n\n<p>If you want direct access to the bytes via a slice, you can slice it as an array like so:</p>\n\n<pre><code>size := pHeader.sessionInfoLen\nbyteSlice := (*[1&lt;&lt;30]byte)(pSharedMem)[:size:size]\n</code></pre>\n\n<p>This saves you the copy, but you then have to manage concurrent access from cgo, and ensure the memory isn't released while you're accessing it from Go.</p>\n"}], "owner": {"reputation": 769, "user_id": 294916, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1a9637acaccba514bf6c2cecf80c3f16?s=128&d=identicon&r=PG", "display_name": "Leon", "link": "https://stackoverflow.com/users/294916/leon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427050833, "creation_date": 1426976479, "question_id": 29188730, "link": "https://stackoverflow.com/questions/29188730/what-is-the-best-safest-most-performant-way-of-getting-a-specific-slice-of-b", "title": "What is the best (safest + most performant) way of getting a specific slice of bytes from an unsafe.Pointer", "body": "<p>I'm trying to convert <a href=\"https://github.com/vipoo/irsdk/blob/master/irsdk_utils.cpp#L258\" rel=\"nofollow\">this c++</a> to go.</p>\n\n<p>This is in short what the c code is doing:</p>\n\n<pre><code>static const char *pSharedMem = NULL;\nint sessionInfoOffset;\n\nreturn pSharedMem + pHeader-&gt;sessionInfoOffset;\n</code></pre>\n\n<p>This is my (pseudo) go code:</p>\n\n<pre><code>var pSharedMem unsafe.Pointer\nsessionInfoLen C.int\n\nbyteSlice := C.GoBytes(pSharedMem, pHeader.sessionInfoLen)\nreturn byteSlice[pHeader.sessionInfoOffset:]\n</code></pre>\n\n<p>I've never really written any C code and I have no idea if this a good way of retrieving a byte slice from an unsafe.Pointer. Could go anything wrong with this (copying wrong piece of memory or something) and is this performant of am I doing something really stupid?</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1426977559, "post_id": 29188072, "comment_id": 46592385, "body": "Or <code>make(chan Result, len(replicas))</code>. If you don&#39;t just want to let the other goroutines run to completion and then get cleaned, but instead want a way to ask them to die, look at the <a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">context package</a>."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1426989289, "post_id": 29188072, "comment_id": 46594631, "body": "Error handling is also missing, since queries may fail."}], "answers": [{"comments": [{"owner": {"reputation": 29724, "user_id": 93995, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/35752f1794d9a5f8ab8fe8edf272f0cc?s=128&d=identicon&r=PG", "display_name": "George Armhold", "link": "https://stackoverflow.com/users/93995/george-armhold"}, "edited": false, "score": 0, "creation_date": 1426988070, "post_id": 29188500, "comment_id": 46594436, "body": "I agree about not putting it on a slide. I actually asked this question because of a bug in my code, based on a misapprehension of how channels are supposed to work. Seeing the slide made me think it <i>ought</i> to be correct!"}], "tags": [], "owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1426976954, "last_edit_date": 1426976954, "creation_date": 1426974894, "answer_id": 29188500, "question_id": 29188072, "link": "https://stackoverflow.com/questions/29188072/go-concurrency-pattern-will-this-leave-hanging-goroutines/29188500#29188500", "title": "Go Concurrency Pattern- will this leave hanging goroutines?", "body": "<p>You are correct. But that doesn't fit on a single slide. He was talking about concurrency patterns, not necessarily the code to do it.</p>\n\n<p>Of course, I still wouldn't have put that code on a slide...</p>\n"}], "owner": {"reputation": 29724, "user_id": 93995, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/35752f1794d9a5f8ab8fe8edf272f0cc?s=128&d=identicon&r=PG", "display_name": "George Armhold", "link": "https://stackoverflow.com/users/93995/george-armhold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 1, "accepted_answer_id": 29188500, "answer_count": 1, "score": 2, "last_activity_date": 1483433508, "creation_date": 1426972145, "last_edit_date": 1483433508, "question_id": 29188072, "link": "https://stackoverflow.com/questions/29188072/go-concurrency-pattern-will-this-leave-hanging-goroutines", "title": "Go Concurrency Pattern- will this leave hanging goroutines?", "body": "<p>In Rob Pike's <a href=\"https://www.youtube.com/watch?v=f6kdp27TYZs\" rel=\"nofollow\">Google IO talk</a> on Go Concurrency Patterns, he presented <a href=\"http://talks.golang.org/2012/concurrency.slide#48\" rel=\"nofollow\">this code</a> as an example of how to pick the fastest responder from a number of replica servers:</p>\n\n<pre><code>func First(query string, replicas ...Search) Result {\n    c := make(chan Result)\n    searchReplica := func(i int) { c &lt;- replicas[i](query) }\n    for i := range replicas {\n        go searchReplica(i)\n    }\n    return &lt;-c\n}\n</code></pre>\n\n<p><strong>Question</strong>: Won't this leave N-1 of the replica goroutines blocking on a channel write?</p>\n\n<p>In the discussion after the talk, one of the audience members seems to be asking this question, but got kind of a handy-wavy response. </p>\n\n<p>I'd be inclined to change the 3rd line to something like this:</p>\n\n<pre><code>searchReplica := func(i int) {\n   select {\n      case c &lt;- replicas[i](query):\n      default: // non-blocking write\n }\n}\n</code></pre>\n"}, {"tags": ["string", "go", "literals"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1426991414, "post_id": 29187854, "comment_id": 46594940, "body": "The error message you get isn&#39;t reproducible. Line 31 is one of the blank lines in the middle of your program."}], "answers": [{"tags": [], "owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "is_accepted": true, "score": 1, "last_activity_date": 1426973971, "last_edit_date": 1426973971, "creation_date": 1426971313, "answer_id": 29187949, "question_id": 29187854, "link": "https://stackoverflow.com/questions/29187854/go-unexpected-string-literal/29187949#29187949", "title": "Go unexpected string literal", "body": "<p>There are a few minor typos in your example. After fixing those, your example ran for me without the <code>unexpected string literal</code> error. Also, if you want to write the JSON to the <code>http.ResponseWriter</code>, you should change <code>fmt.Println</code> to <code>fmt.Fprintln</code> as shown in part 2 below.</p>\n\n<p>(1) Minor Typos</p>\n\n<pre><code># Error 1: undefined: httpRequest\nfunc serveRest(w http.ResponseWriter, r *httpRequest){\n# Fixed:\nfunc serveRest(w http.ResponseWriter, r *http.Request){\n\n# Error 2: cannot refer to unexported name fmt.println\nfmt.println(w, string(response))\n# Fixed to remove error. Use Fprintln to write to 'w' http.ResponseWriter\nfmt.Println(w, string(response))\n\n# Error 3: undefined: http.HandleFucn\nhttp.HandleFucn(\"/\", serveRest)\n# Fixed\nhttp.HandleFunc(\"/\", serveRest)\n</code></pre>\n\n<p>(2) Returning JSON in HTTP Response</p>\n\n<p>Because <code>fmt.Println</code> writes to standard output and <code>fmt.Fprintln</code> writes to supplied io.Writer, to return the JSON in the HTTP response, use the following:</p>\n\n<pre><code>fmt.Fprintln(w, string(response))\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 2645584, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000053862327/picture?type=large", "display_name": "Sushant Ubale Patil", "link": "https://stackoverflow.com/users/2645584/sushant-ubale-patil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5545, "favorite_count": 0, "accepted_answer_id": 29187949, "answer_count": 1, "score": 0, "last_activity_date": 1459896232, "creation_date": 1426970724, "last_edit_date": 1459896232, "question_id": 29187854, "link": "https://stackoverflow.com/questions/29187854/go-unexpected-string-literal", "title": "Go unexpected string literal", "body": "<p>This is my code in Go and everything is right I guess.... </p>\n\n<pre><code>package main\n\nimport(\n\"fmt\"\n\"encoding/json\"\n\"net/http\"\n\n)\ntype Payload struct {\n    Stuff Data\n}\ntype Data struct {\n    Fruit Fruits\n    Veggies Vegetables\n}\ntype Fruits map[string]int\ntype Vegetables map[string]int\n\n\nfunc serveRest(w http.ResponseWriter, r *httpRequest){\n    response , err := getJsonResponse()\n    if err != nil{\n        panic(err)\n    }\n    fmt.println(w, string(response))\n\n}\n\n\n\n\n\n\nfunc main(){\n\nhttp.HandleFucn(\"/\", serveRest)\nhttp.ListenAndServe(\"localhost:1337\",nil)\n}\n\n\nfunc getJsonResponse() ([]byte, error){\n\nfruits := make(map[string]int)\nfruits[\"Apples\"] = 25\nfruits[\"Oranges\"] = 11\n\nvegetables := make(map[string]int)\nvegetables[\"Carrots\"] = 21\nvegetables[\"Peppers\"] = 0\n\nd := Data{fruits, vegetables}\np := Payload{d}\n\nreturn json.MarshalIndent(p, \"\", \"  \")\n\n}\n</code></pre>\n\n<p>And this is the error I am getting</p>\n\n<pre><code>API_Sushant.go:31: syntax error: unexpected string literal, expecting semicolon or newline or }\n</code></pre>\n\n<p>Can anybody tell me whats the error plz ....</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426977148, "post_id": 29187829, "comment_id": 46592295, "body": "Your question says &quot;stack trace&quot; but then you ask about file:line of the &quot;log point&quot;; did you look at <a href=\"https://golang.org/pkg/log/#Llongfile\" rel=\"nofollow noreferrer\"><code>log.Llongfile</code> or <code>log.Lshortfile</code></a>? (Or search the docs for &quot;stack trace&quot;?)"}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426981362, "post_id": 29187829, "comment_id": 46593203, "body": "i think GAE log package doesn&#39;t provide a log point. You seem to point to the std lib log package. See <a href=\"https://godoc.org/google.golang.org/appengine/log\" rel=\"nofollow noreferrer\">godoc.org/google.golang.org/appengine/log</a>"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426981654, "post_id": 29187829, "comment_id": 46593261, "body": "Wow, that&#39;s dumb. I&#39;ll have to remember to not bother with GAE if they don&#39;t even have basics from the standard library on it."}], "answers": [{"tags": [], "owner": {"reputation": 757655, "user_id": 95810, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e8d5fe90f1fe2148bf130cccd4dc311c?s=128&d=identicon&r=PG", "display_name": "Alex Martelli", "link": "https://stackoverflow.com/users/95810/alex-martelli"}, "is_accepted": false, "score": 1, "last_activity_date": 1426972909, "creation_date": 1426972909, "answer_id": 29188203, "question_id": 29187829, "link": "https://stackoverflow.com/questions/29187829/is-it-possible-to-get-the-log-point-on-gae/29188203#29188203", "title": "Is it possible to get the log point on GAE?", "body": "<p>What you request is definitely possible, you just need to be very explicit about it!  I recommend Andrew Gerrand's excellent article at <a href=\"http://blog.golang.org/error-handling-and-go\" rel=\"nofollow\">http://blog.golang.org/error-handling-and-go</a> for general information on the issue, including notes specific to App Engine.</p>\n\n<p>That article does not specifically address stack traces, but of course you could do those yourself, via <a href=\"http://golang.org/pkg/runtime/#Stack\" rel=\"nofollow\">http://golang.org/pkg/runtime/#Stack</a> .</p>\n\n<p>Let's be honest and admit that Go -- being by design more of a system-programming language than of an application-focused one -- doesn't do <strong>quite</strong> as much implicit, automatic hand-holding for you, as more app-oriented languages such as the other App Engine ones -- Java, Python, PHP... [*] but, Go <strong>does</strong> give you all the tools you need to do just as little, or as much, \"supporting infrastructure\", as you desire to have in support of your own apps!-)</p>\n\n<p>[*] hey, you don't even get automatically by-default propagating <strong>exceptions</strong>, as you do for other languages -- nay, you're responsible for catching and dealing with errors yourself, oh the horror...!-)</p>\n"}, {"tags": [], "owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "is_accepted": false, "score": 0, "last_activity_date": 1428087335, "last_edit_date": 1428087335, "creation_date": 1428086896, "answer_id": 29437973, "question_id": 29187829, "link": "https://stackoverflow.com/questions/29187829/is-it-possible-to-get-the-log-point-on-gae/29437973#29437973", "title": "Is it possible to get the log point on GAE?", "body": "<p>You can use the <a href=\"http://golang.org/pkg/runtime/#Caller\" rel=\"nofollow\">runtime</a> package to trace the caller(I assume that's basically what you want). There is no GAE specific issue and it has nothing to do with the error handling. </p>\n\n<pre><code>   // The depth specifies how many stack frames above \n   // lives the source line to be identified in the log message.\n    func traceCaller(depth int)(string, int){\n    _, file, line, ok := runtime.Caller(2 + depth)\n        if !ok {\n            file = \"???\"\n            line = 1\n        } else {\n            slash := strings.LastIndex(file, \"/\")\n            if slash &gt;= 0 {\n                file = file[slash+1:]\n            }\n        }\n        return file, line\n}\n</code></pre>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1428087335, "creation_date": 1426970565, "last_edit_date": 1426986344, "question_id": 29187829, "link": "https://stackoverflow.com/questions/29187829/is-it-possible-to-get-the-log-point-on-gae", "title": "Is it possible to get the log point on GAE?", "body": "<p>I'm wondering if it's possible to log the line/column number when i log an error. The GAE logging lib seems to store only the error message but I think it would be quite valuable to get the exact location of the error/log point like most logging libraries do. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1426966549, "post_id": 29187086, "comment_id": 46589244, "body": "You&#39;re probably interested in <code>strings.Split</code>."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1426966689, "post_id": 29187086, "comment_id": 46589298, "body": "actually it&#39;s strings.Index. No need for a split."}], "answers": [{"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1426966654, "post_id": 29187137, "comment_id": 46589288, "body": "ah... it seems it doesn&#39;t really work as expected. What I need seems to be strings.Index[]"}, {"owner": {"reputation": 13109, "user_id": 3775079, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/cUoYM.jpg?s=128&g=1", "display_name": "Landeeyo", "link": "https://stackoverflow.com/users/3775079/landeeyo"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1426967651, "post_id": 29187137, "comment_id": 46589573, "body": "@Theuserwithnohat Right, TrimLeft is a counter-intuitive named method. Index is okay, but may not be as convenient and intuitive as TrimPrefix. TrimPrefix could be also necessary in some cases so it&#39;s good to know."}, {"owner": {"reputation": 3950, "user_id": 659715, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6255793373939f9531d46761e40e55d7?s=128&d=identicon&r=PG", "display_name": "djeikyb", "link": "https://stackoverflow.com/users/659715/djeikyb"}, "edited": false, "score": 0, "creation_date": 1501817746, "post_id": 29187137, "comment_id": 77956710, "body": "I still don&#39;t get it. From the docs, I can&#39;t tell the difference betwen TrimLeft and TrimPrefix."}, {"owner": {"reputation": 1039, "user_id": 3610366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/31Tgk.jpg?s=128&g=1", "display_name": "SunghoMoon", "link": "https://stackoverflow.com/users/3610366/sunghomoon"}, "reply_to_user": {"reputation": 3950, "user_id": 659715, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6255793373939f9531d46761e40e55d7?s=128&d=identicon&r=PG", "display_name": "djeikyb", "link": "https://stackoverflow.com/users/659715/djeikyb"}, "edited": false, "score": 0, "creation_date": 1509339117, "post_id": 29187137, "comment_id": 80963194, "body": "@djeikyb See the second argument of &#39;TrimPrefix&#39; and &#39;TrimLeft&#39;. TrimPrefix receive &#39;prefix string&#39; but TimeLeft receive &#39;cutset string&#39;."}], "tags": [], "owner": {"reputation": 61736, "user_id": 43846, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TGOxx.png?s=128&g=1", "display_name": "stuartd", "link": "https://stackoverflow.com/users/43846/stuartd"}, "is_accepted": true, "score": 8, "last_activity_date": 1426967355, "last_edit_date": 1426967355, "creation_date": 1426966512, "answer_id": 29187137, "question_id": 29187086, "link": "https://stackoverflow.com/questions/29187086/why-trimleft-doesnt-work-as-expected/29187137#29187137", "title": "Why TrimLeft doesn&#39;t work as expected?", "body": "<p>It is working <a href=\"http://golang.org/pkg/strings/#TrimLeft\" rel=\"noreferrer\">as documented</a>:</p>\n\n<blockquote>\n  <p>TrimLeft returns a slice of the string s <em>with all leading Unicode\n  code points contained in cutset removed</em></p>\n</blockquote>\n\n<p>Because there's an 'a' in the first argument (the cutset) the leading 'a' in account is removed</p>\n"}, {"tags": [], "owner": {"reputation": 13109, "user_id": 3775079, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/cUoYM.jpg?s=128&g=1", "display_name": "Landeeyo", "link": "https://stackoverflow.com/users/3775079/landeeyo"}, "is_accepted": false, "score": 9, "last_activity_date": 1426967325, "last_edit_date": 1426967325, "creation_date": 1426966776, "answer_id": 29187186, "question_id": 29187086, "link": "https://stackoverflow.com/questions/29187086/why-trimleft-doesnt-work-as-expected/29187186#29187186", "title": "Why TrimLeft doesn&#39;t work as expected?", "body": "<p>Use TrimPrefix instead of TrimLeft</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"strings\"\n\nfunc main() {\n    s := \"refs/tags/account\"\n    tag := strings.TrimPrefix(s, \"refs/tags/\")\n    fmt.Println(tag)\n}\n</code></pre>\n\n<p>Please notice that following TrimLeft calls will result the same \"fghijk\n\" string:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"strings\"\n)\n\nfunc main() {\n    s := \"/abcde/fghijk\"\n    tag := strings.TrimLeft(s, \"/abcde\")\n    fmt.Println(tag)    \n    tag = strings.TrimLeft(s, \"/edcba\")\n    fmt.Println(tag)\n}\n</code></pre>\n\n<p>So TrimLeft is not the method which fits your needs. I guess it's impossible to use it in the example you've given to get the result you expect.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3840, "favorite_count": 0, "accepted_answer_id": 29187137, "answer_count": 2, "score": 6, "last_activity_date": 1426967355, "creation_date": 1426966229, "question_id": 29187086, "link": "https://stackoverflow.com/questions/29187086/why-trimleft-doesnt-work-as-expected", "title": "Why TrimLeft doesn&#39;t work as expected?", "body": "<p>I've expected tag to be \"account\" but it is \"ccount\". Why is \"a\" removed? </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"strings\"\n\nfunc main() {\n    s := \"refs/tags/account\"\n    tag := strings.TrimLeft(s, \"refs/tags\")\n    fmt.Println(tag)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/M1p_WUi_r2\" rel=\"noreferrer\">Run</a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 1, "creation_date": 1427115486, "post_id": 29187885, "comment_id": 46631289, "body": "Also, for flags defined by other packages I like the convention to normally use <code>flag.Set(&quot;flagName&quot;, value)</code>, specifically for <code>glog</code>, you probably are looking to do <code>flag.Set(&quot;alsologtostderr&quot;, &quot;true&quot;)</code>."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1427136416, "post_id": 29187885, "comment_id": 46644933, "body": "@user114241very good to point out the simpler function. D&#39;oh! I was snarky in my reference/link to the documentation but then failed to pick the easiest documented option! Note to self: Must more fully re-read <i>complete</i> documentation before answering questions!"}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 6, "last_activity_date": 1427136954, "last_edit_date": 1427136954, "creation_date": 1426970938, "answer_id": 29187885, "question_id": 29186781, "link": "https://stackoverflow.com/questions/29186781/is-it-possible-to-overwrite-flag-values/29187885#29187885", "title": "Is it possible to overwrite flag values?", "body": "<p>You can just do <a href=\"https://golang.org/pkg/flag/#Set\" rel=\"nofollow\"><code>flag.Set(\"flagname\", \"whatever\")</code></a>.</p>\n\n<p>Or if you want to do something else to the option (check the default, see if it's already been changed, etc) you can use <a href=\"https://golang.org/pkg/flag/#Lookup\" rel=\"nofollow\"><code>f := flag.Lookup(\"flagname\")</code></a> and then <code>f.Value.Set(\"whatever\")</code> (as well as other methods).</p>\n\n<p>In either case there are matching <code>flag.FlagSet</code> methods if you need this on something other than the <code>flag.CommandLine</code> set.</p>\n\n<p><a href=\"http://play.golang.org/p/RvXfJouXQB\" rel=\"nofollow\"><kbd>Playground example</kbd></a></p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1497, "favorite_count": 0, "accepted_answer_id": 29187885, "answer_count": 1, "score": 2, "last_activity_date": 1427136954, "creation_date": 1426964453, "question_id": 29186781, "link": "https://stackoverflow.com/questions/29186781/is-it-possible-to-overwrite-flag-values", "title": "Is it possible to overwrite flag values?", "body": "<p>I'm wondering if it's possible to overwrite flag values on runtime.</p>\n\n<p>Example: </p>\n\n<ul>\n<li>main.go imports a package pkg.go. </li>\n<li>pkg.go uses a flag (\"-myFlag\") but the identifier which stores the flag is not exported. </li>\n</ul>\n\n<p>Is it possible to change the flag value of \"-myFlag\" which pkg.go receives from main.go ? </p>\n\n<p>Usecase:  I'm using a library which uses <a href=\"http://github.com/golang/glog\" rel=\"nofollow\">glog</a> to log the errors. glog uses flags to define where to write the logs and by default it writes the logs to a file. The environment I'm using doesn't allow writes to filesystem nor to set flags on app initialisation so I need to overwrite/set the glog flags somehow so that I can set it to write the errors to stderr.</p>\n"}, {"tags": ["go", "forms", "martini", "http-post"], "answers": [{"tags": [], "owner": {"reputation": 2009, "user_id": 4618774, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/031e68c41285d97f220f8e1d056eb7b0?s=128&d=identicon&r=PG&f=1", "display_name": "cycle4passion", "link": "https://stackoverflow.com/users/4618774/cycle4passion"}, "is_accepted": false, "score": 0, "last_activity_date": 1426963129, "creation_date": 1426963129, "answer_id": 29186545, "question_id": 29186413, "link": "https://stackoverflow.com/questions/29186413/go-handling-of-html-form-data/29186545#29186545", "title": "Go handling of HTML form data", "body": "<p>changed m.GET to m.POST, and voil\u00e0 fixed.</p>\n"}, {"tags": [], "owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "is_accepted": true, "score": 3, "last_activity_date": 1426963186, "creation_date": 1426963186, "answer_id": 29186554, "question_id": 29186413, "link": "https://stackoverflow.com/questions/29186413/go-handling-of-html-form-data/29186554#29186554", "title": "Go handling of HTML form data", "body": "<p>Notice in your form you've specified <code>method=\"POST\"</code>, but in the server code you have <code>m.Get(\"/results\",...)</code>. That line should be <code>m.Post(\"/results\",...)</code>. Martini is trying to route the request but there is no definition for <code>POST /results</code> only <code>GET /results</code></p>\n"}], "owner": {"reputation": 2009, "user_id": 4618774, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/031e68c41285d97f220f8e1d056eb7b0?s=128&d=identicon&r=PG&f=1", "display_name": "cycle4passion", "link": "https://stackoverflow.com/users/4618774/cycle4passion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 0, "accepted_answer_id": 29186554, "answer_count": 2, "score": 1, "last_activity_date": 1426963186, "creation_date": 1426962442, "last_edit_date": 1564891733, "question_id": 29186413, "link": "https://stackoverflow.com/questions/29186413/go-handling-of-html-form-data", "title": "Go handling of HTML form data", "body": "<p>I am having trouble getting data from the HTML form.\nThe template shows at localhost:3000, I submit and am taken to localhost:3000/results with a \"404 page not found\" results. The URL does not include any of the forms fields. </p>\n\n<pre><code>package main\n\nimport (\n    \"html/template\"\n    \"net/http\"\n    \"github.com/go-martini/martini\"\n)\n\nfunc main() {\n    m := martini.Classic()\n    m.Get(\"/\", func(res http.ResponseWriter, req *http.Request) { // res and req are injected by Martini\n        t, _ := template.ParseFiles(\"form.gtpl\")\n        t.Execute(res, nil)\n    })\n\n    m.Get(\"/results\", func(r *http.Request) string {\n        text := r.FormValue(\"text\")\n        return text\n    })\n    m.Run()\n}\n</code></pre>\n\n<p>and the template is: form.gtpl</p>\n\n<pre><code>&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Title Here&lt;/title&gt;\n&lt;/head&gt;\n&lt;body bgcolor=\"#E6E6FA\"&gt;\n&lt;h1&gt;Header Here&lt;/h1&gt;\n&lt;form action=\"/results\" method=\"POST\"&gt;\n    Date: &lt;input type=\"text\" name=\"dated\" size=\"10\" value=\"01/12/2015\"&gt;        \n    Triggers: &lt;input type=\"text\" name=\"triggers\" size=\"100\" value=\"Trigger1|Trigger2\"&gt;&lt;br&gt;&lt;br&gt;\n    &lt;textarea name =\"text\" rows=\"20\" cols=\"150\"&gt;random text here\n&lt;/textarea&gt;\n    &lt;input autofocus type=\"submit\" value=\"Submit\"&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": ["go", "module", "url-for", "beego"], "answers": [{"tags": [], "owner": {"reputation": 702, "user_id": 1614036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57b80cdc7bd62ad727bd7cafdb7a0c9f?s=128&d=identicon&r=PG", "display_name": "Juan de Parras", "link": "https://stackoverflow.com/users/1614036/juan-de-parras"}, "is_accepted": true, "score": 0, "last_activity_date": 1427883269, "creation_date": 1427883269, "answer_id": 29388148, "question_id": 29186316, "link": "https://stackoverflow.com/questions/29186316/how-to-select-module-name-in-urlfor-function-inside-template/29388148#29388148", "title": "How to select module name in urlfor function inside template", "body": "<p>For anybody with the same issue:</p>\n\n<p>The problem is how I implemented the application folder structure for modules. It seems not be compatible with <code>{{urlfor}}</code>.</p>\n\n<p>The correct answer come from github: <a href=\"https://github.com/astaxie/beego/issues/1100\" rel=\"nofollow\">https://github.com/astaxie/beego/issues/1100</a></p>\n\n<p>In the link you can found the correct directory tree</p>\n"}], "owner": {"reputation": 702, "user_id": 1614036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57b80cdc7bd62ad727bd7cafdb7a0c9f?s=128&d=identicon&r=PG", "display_name": "Juan de Parras", "link": "https://stackoverflow.com/users/1614036/juan-de-parras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 29388148, "answer_count": 1, "score": 0, "last_activity_date": 1427883269, "creation_date": 1426961964, "last_edit_date": 1427112276, "question_id": 29186316, "link": "https://stackoverflow.com/questions/29186316/how-to-select-module-name-in-urlfor-function-inside-template", "title": "How to select module name in urlfor function inside template", "body": "<p>Im working in a beego application with 2 modules, and has a controller with the same name in both modules.\nWhen I use <code>{{urlfor}}</code> in template the generated url is linking with the other module.</p>\n\n<p>Anybody know if its posible select module name in <code>urlfor</code> function? I search in the docs and cant see any reference about. Im currently use beego 1.4.3</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "is_accepted": false, "score": 0, "last_activity_date": 1426963450, "creation_date": 1426963450, "answer_id": 29186612, "question_id": 29186031, "link": "https://stackoverflow.com/questions/29186031/how-to-set-environment-variables-on-google-appengine/29186612#29186612", "title": "how to set environment variables on google appengine?", "body": "<p>I can't find the docs for that field anywhere. I only see it in the python config, not the Go config. It's likely unavailable for go if you're basing this off of the python docs <a href=\"https://cloud.google.com/appengine/docs/python/config/appconfig#Python_app_yaml_Defining_environment_variables\" rel=\"nofollow\">here</a></p>\n"}, {"comments": [{"owner": {"reputation": 4544, "user_id": 1337127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88c5c900e5e61ec5d73e63fbb1f8242d?s=128&d=identicon&r=PG", "display_name": "Mark Doyle", "link": "https://stackoverflow.com/users/1337127/mark-doyle"}, "edited": false, "score": 1, "creation_date": 1438783880, "post_id": 29186875, "comment_id": 51591740, "body": "Seems this was the issue: <a href=\"https://code.google.com/p/googleappengine/issues/detail?id=12006\" rel=\"nofollow noreferrer\">code.google.com/p/googleappengine/issues/detail?id=12006</a> Although currently it only works on dev server and not production."}, {"owner": {"reputation": 2752, "user_id": 140164, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c44c58fe1ee2a3189f1fd99a3d73d0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Dipen Bhikadya", "link": "https://stackoverflow.com/users/140164/dipen-bhikadya"}, "reply_to_user": {"reputation": 4544, "user_id": 1337127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88c5c900e5e61ec5d73e63fbb1f8242d?s=128&d=identicon&r=PG", "display_name": "Mark Doyle", "link": "https://stackoverflow.com/users/1337127/mark-doyle"}, "edited": false, "score": 0, "creation_date": 1449756821, "post_id": 29186875, "comment_id": 56152591, "body": "@MarkDoyle +1 for the link"}, {"owner": {"reputation": 757655, "user_id": 95810, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e8d5fe90f1fe2148bf130cccd4dc311c?s=128&d=identicon&r=PG", "display_name": "Alex Martelli", "link": "https://stackoverflow.com/users/95810/alex-martelli"}, "edited": false, "score": 0, "creation_date": 1449789555, "post_id": 29186875, "comment_id": 56171567, "body": "Yep, it&#39;s great that the new feature was implemented, just 3 months after this discussion (and it does seem to work in production... but just in the context of a request, after init functions are done  -- roughly as per the discussion on the next question... ah well, better than nothing!-)."}], "tags": [], "owner": {"reputation": 757655, "user_id": 95810, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e8d5fe90f1fe2148bf130cccd4dc311c?s=128&d=identicon&r=PG", "display_name": "Alex Martelli", "link": "https://stackoverflow.com/users/95810/alex-martelli"}, "is_accepted": false, "score": 2, "last_activity_date": 1426965022, "last_edit_date": 1495540813, "creation_date": 1426965022, "answer_id": 29186875, "question_id": 29186031, "link": "https://stackoverflow.com/questions/29186031/how-to-set-environment-variables-on-google-appengine/29186875#29186875", "title": "how to set environment variables on google appengine?", "body": "<p>Unfortunately, the GAE Go runtime does <strong>not</strong> support environment variable setting in app.yaml -- see for example <a href=\"https://stackoverflow.com/questions/24585406/how-to-set-gae-environment-specific-environment-variables\">How to set GAE environment-specific environment variables?</a> and <a href=\"https://groups.google.com/forum/#!msg/google-appengine-go/qzMbZapLyAU/eKOZzZO14qQJ\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!msg/google-appengine-go/qzMbZapLyAU/eKOZzZO14qQJ</a> .</p>\n\n<p>The functionality <strong>is</strong> supported in PHP, per <a href=\"https://cloud.google.com/appengine/docs/php/config/appconfig#PHP_app_yaml_Defining_environment_variables\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/php/config/appconfig#PHP_app_yaml_Defining_environment_variables</a> ; Java, per <a href=\"https://cloud.google.com/appengine/docs/java/config/appconfig#Java_appengine_web_xml_System_properties_and_environment_variables\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/java/config/appconfig#Java_appengine_web_xml_System_properties_and_environment_variables</a> ; and Python, per <a href=\"https://cloud.google.com/appengine/docs/python/config/appconfig#Python_app_yaml_Defining_environment_variables\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/python/config/appconfig#Python_app_yaml_Defining_environment_variables</a> .</p>\n\n<p>In the Go runtime for App Engine, however -- see <a href=\"https://cloud.google.com/appengine/docs/go/config/appconfig\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/go/config/appconfig</a> -- there is simply no equivalent functionality.</p>\n\n<p>I would recommend opening a feature request at <a href=\"https://code.google.com/p/googleappengine/issues/list?can=2&amp;q=language=Go&amp;colspec=ID%20Type%20Component%20Status%20Stars%20Summary%20Language%20Priority%20Owner%20Log\" rel=\"nofollow noreferrer\">https://code.google.com/p/googleappengine/issues/list?can=2&amp;q=language=Go&amp;colspec=ID%20Type%20Component%20Status%20Stars%20Summary%20Language%20Priority%20Owner%20Log</a> (I don't see any equivalent feature request already in the list of 27 open FRs, or else, of course, I would recommend just \"starring\" the existing FR to register your interest in it).</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440610904, "post_id": 31726860, "comment_id": 52348861, "body": "Can you clarify what you mean by &quot;it does not work if you declare as a global variable&quot;? Your example <code>consumer</code> variable is package global so it&#39;s unclear what you mean."}, {"owner": {"reputation": 1702, "user_id": 693110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/206943677d134ec0d9dc12a27bf5303a?s=128&d=identicon&r=PG&f=1", "display_name": "Chunliang Lyu", "link": "https://stackoverflow.com/users/693110/chunliang-lyu"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440647882, "post_id": 31726860, "comment_id": 52362415, "body": "@DaveC I am not sure what went wrong, I am new to Go. The thing is, if I declare the variable as the package global like the sample code, it does not work on AppEngine (however it does work on local dev server). However, if I move the <code>os.Getenv</code> inside some function, it works. I have no idea about the internal."}, {"owner": {"reputation": 2752, "user_id": 140164, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c44c58fe1ee2a3189f1fd99a3d73d0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Dipen Bhikadya", "link": "https://stackoverflow.com/users/140164/dipen-bhikadya"}, "edited": false, "score": 1, "creation_date": 1449757020, "post_id": 31726860, "comment_id": 56152707, "body": "Based on the link @markdoyle provided below (code.google.com/p/googleappengine/issues/detail?id=12006), environment variables are not ready until all the init functions are run and I would say same might be applying to the global variable declaration too. It works from a function because by that time environment variables are set."}], "tags": [], "owner": {"reputation": 1702, "user_id": 693110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/206943677d134ec0d9dc12a27bf5303a?s=128&d=identicon&r=PG&f=1", "display_name": "Chunliang Lyu", "link": "https://stackoverflow.com/users/693110/chunliang-lyu"}, "is_accepted": false, "score": 8, "last_activity_date": 1440573640, "last_edit_date": 1440573640, "creation_date": 1438267245, "answer_id": 31726860, "question_id": 29186031, "link": "https://stackoverflow.com/questions/29186031/how-to-set-environment-variables-on-google-appengine/31726860#31726860", "title": "how to set environment variables on google appengine?", "body": "<p>The feature is now documented <a href=\"https://cloud.google.com/appengine/docs/go/config/appconfig#Go_app_yaml_Defining_environment_variables\" rel=\"noreferrer\">here</a>. <strike>However, as I have tested just now, it doesn't work on AppEngine. It does work on local server, so don't be fooled.</strike>.</p>\n\n<p>Edit: It works on Google AppEngine. My previous failure is due to a mistake. Consider this:</p>\n\n<pre><code>import \"os\"\n\nvar consumer = OAuth1Consumer{\n    secret: os.Getenv(\"secret\")\n}\n</code></pre>\n\n<p>It does not work if you declare as global variable.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6877, "favorite_count": 0, "answer_count": 3, "score": 7, "last_activity_date": 1440573640, "creation_date": 1426960505, "question_id": 29186031, "link": "https://stackoverflow.com/questions/29186031/how-to-set-environment-variables-on-google-appengine", "title": "how to set environment variables on google appengine?", "body": "<p>I'm trying to set and use an environment variable on google app engine. My app.yaml file looks as below. However when I use os.Getenv(\"mytoken\") I get an empty string instead the actual value I set. Is it a GAE bug?</p>\n\n<pre><code>api_version: go1\nhandlers:\n- url: /.*\n  script: _go_app\nenv_variables:\n  mytoken: '88786d9b9a0359824'\n</code></pre>\n"}, {"tags": ["sql", "reflection", "go"], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 19, "last_activity_date": 1426960610, "last_edit_date": 1426960610, "creation_date": 1426956900, "answer_id": 29185381, "question_id": 29184933, "link": "https://stackoverflow.com/questions/29184933/golang-reflect-get-pointer-to-a-struct-field-value/29185381#29185381", "title": "golang reflect, get pointer to a struct field value", "body": "<p>You need to use <code>.Interface()</code> not <code>.Pointer()</code></p>\n\n<pre><code>func StrutForScan(u interface{}) []interface{} {\n    val := reflect.ValueOf(u).Elem()\n    v := make([]interface{}, val.NumField())\n    for i := 0; i &lt; val.NumField(); i++ {\n        valueField := val.Field(i)\n        v[i] = valueField.Addr().Interface()\n    }\n    return v\n}\n</code></pre>\n\n<p>The reason behind that is that <code>.Pointer()</code> returns an actual \"pointer\" to the data, you can't do much with it without using the <code>unsafe</code> package.</p>\n"}], "owner": {"reputation": 2589, "user_id": 1186291, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LlKBe.jpg?s=128&g=1", "display_name": "alfonsodev", "link": "https://stackoverflow.com/users/1186291/alfonsodev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7971, "favorite_count": 3, "accepted_answer_id": 29185381, "answer_count": 1, "score": 12, "last_activity_date": 1426960610, "creation_date": 1426954470, "question_id": 29184933, "link": "https://stackoverflow.com/questions/29184933/golang-reflect-get-pointer-to-a-struct-field-value", "title": "golang reflect, get pointer to a struct field value", "body": "<p>I'm trying to make a function that converts a struct in the way mysql rows.Scan function needs it, so I don't need to pass manually lots of parameters.  </p>\n\n<p>Note: I know the existence of sqlx and the alternative of writing manually in separate lines every pointer, but I'd like to solve it in this way as I'm learning go and want to understand what's going on.</p>\n\n<p>The error I get with this solution is:<br>\n<code>panic: sql: Scan error on column index 0: destination not a pointer\n</code>\nto me looks like <code>valueField.Addr().Pointer()</code> should be a Pointer to the value. The following is a simplification of my code.</p>\n\n<pre><code>type User struct {\n    Name string\n    Age  int\n}\n\nfunc StrutForScan(u interface{}) []interface{} {\n    val := reflect.ValueOf(u).Elem()\n    v := make([]interface{}, val.NumField())\n    for i := 0; i &lt; val.NumField(); i++ {\n        valueField := val.Field(i)\n        v[i] = valueField.Addr().Pointer()\n    }\n    return v\n}\n\nfunc ListUsers {\n    rows, err := db.Query(\"SELECT * FROM users\")\n    PanicIf(err)\n    var user User\n    for rows.Next() {\n        err := rows.Scan(StrutForScan(&amp;user)...)\n        PanicIf(err)\n        fmt.Printf(\"\\nName: %s, Age: %s\", user.Name, string(user.Age))\n\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1426946930, "post_id": 29183434, "comment_id": 46583282, "body": "Asking how to write language X in language Y is the wrong approach to different languages. Learn how to solve the problem at hand in idiomatic language Y ways and play to language Y&#39;s strengths rather than sticking to whatever language X supported. Why do you want an array different types?? What are you trying to do?? Depending on that there may be many different Go answers (e.g. make an interface that describes the common bit and store a <i>slice</i> of those (slices and arrays are different)."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1426947225, "post_id": 29183434, "comment_id": 46583369, "body": "And from reading your comment on an answer I was correct. You don&#39;t an array of different types at all, you want a completely different Go construct: multiple returns and/or a struct. My recommendation: Stop. Read the <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">Go spec</a>. Take the <a href=\"https://tour.golang.org\" rel=\"nofollow noreferrer\">Go tour</a>. Read <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">Effective Go</a>. Continue."}], "answers": [{"comments": [{"owner": {"reputation": 15106, "user_id": 1117851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/9FMVK.jpg?s=128&g=1", "display_name": "itsnikolay", "link": "https://stackoverflow.com/users/1117851/itsnikolay"}, "edited": false, "score": 1, "creation_date": 1426945756, "post_id": 29183450, "comment_id": 46582906, "body": "is there just one way (with <code>Interface</code>) to implement it?"}, {"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "reply_to_user": {"reputation": 15106, "user_id": 1117851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/9FMVK.jpg?s=128&g=1", "display_name": "itsnikolay", "link": "https://stackoverflow.com/users/1117851/itsnikolay"}, "edited": false, "score": 1, "creation_date": 1426945994, "post_id": 29183450, "comment_id": 46582994, "body": "@itsnikolay Yeah, Go is statically typed. Why do you need such a mixed list?"}, {"owner": {"reputation": 15106, "user_id": 1117851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/9FMVK.jpg?s=128&g=1", "display_name": "itsnikolay", "link": "https://stackoverflow.com/users/1117851/itsnikolay"}, "edited": false, "score": 0, "creation_date": 1426946348, "post_id": 29183450, "comment_id": 46583106, "body": "i would like to return array <code>[year, month, day]</code> for a result of <code>time.Now().Date()</code>"}, {"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "reply_to_user": {"reputation": 15106, "user_id": 1117851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/9FMVK.jpg?s=128&g=1", "display_name": "itsnikolay", "link": "https://stackoverflow.com/users/1117851/itsnikolay"}, "edited": false, "score": 5, "creation_date": 1426946496, "post_id": 29183450, "comment_id": 46583160, "body": "@itsnikolay Why don&#39;t you directly return those results or a struct that contains your values?"}, {"owner": {"reputation": 15106, "user_id": 1117851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/9FMVK.jpg?s=128&g=1", "display_name": "itsnikolay", "link": "https://stackoverflow.com/users/1117851/itsnikolay"}, "edited": false, "score": 0, "creation_date": 1426946615, "post_id": 29183450, "comment_id": 46583190, "body": "Now I think, that your suggested way is the best in Go world"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1426947108, "post_id": 29183450, "comment_id": 46583330, "body": "yes, use a struct, or just return 3 values.  But, in case you still want a slice, you can create the same slice with a literal: \tfmt.Println([]interface{}{&quot;foo&quot;,5})"}], "tags": [], "owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "is_accepted": true, "score": 12, "last_activity_date": 1426947205, "last_edit_date": 1426947205, "creation_date": 1426945681, "answer_id": 29183450, "question_id": 29183434, "link": "https://stackoverflow.com/questions/29183434/how-to-build-mixed-array/29183450#29183450", "title": "How to build mixed array", "body": "<p>You can do that via the empty interface - <code>interface{}</code>:</p>\n\n<pre><code>arr := make([]interface{}, 0)\n\narr = append(arr, \"asdfs\")\narr = append(arr, 5)\n</code></pre>\n\n<p>or in literal form:</p>\n\n<pre><code>arr := []interface{}{\"asdfs\", 5}\n</code></pre>\n\n<p>Whenever you want to use a value of that array you need to use a type assertion.</p>\n"}], "owner": {"reputation": 15106, "user_id": 1117851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/9FMVK.jpg?s=128&g=1", "display_name": "itsnikolay", "link": "https://stackoverflow.com/users/1117851/itsnikolay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2388, "favorite_count": 0, "accepted_answer_id": 29183450, "answer_count": 1, "score": 5, "last_activity_date": 1426947205, "creation_date": 1426945560, "question_id": 29183434, "link": "https://stackoverflow.com/questions/29183434/how-to-build-mixed-array", "title": "How to build mixed array", "body": "<p>In ruby I can created array is filled with types:</p>\n\n<pre><code>[1, 'hello', :world] # [Fixnum, String, Symbol]\n=&gt; [1, \"hello\", :here]\n</code></pre>\n\n<p>How to implement a similar array is filled with mixed types in Go?</p>\n\n<p>How to declare the array?</p>\n"}, {"tags": ["go", "export-to-csv", "martini"], "answers": [{"comments": [{"owner": {"reputation": 90304, "user_id": 562769, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/e86681e49622d52817b36fd2a4c936b7?s=128&d=identicon&r=PG", "display_name": "Martin Thoma", "link": "https://stackoverflow.com/users/562769/martin-thoma"}, "edited": false, "score": 0, "creation_date": 1427019212, "post_id": 29186738, "comment_id": 46599805, "body": "You should add <code>wr.Flush()</code>. But even then, the file is automatically downloaded and the approach is very manual (-&gt; I have to manually add each field of the struct)."}, {"owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "reply_to_user": {"reputation": 90304, "user_id": 562769, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/e86681e49622d52817b36fd2a4c936b7?s=128&d=identicon&r=PG", "display_name": "Martin Thoma", "link": "https://stackoverflow.com/users/562769/martin-thoma"}, "edited": false, "score": 0, "creation_date": 1427050807, "post_id": 29186738, "comment_id": 46609513, "body": "Yep. If you want a general solution with no extra work for new fields, you have to use reflect."}], "tags": [], "owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "is_accepted": false, "score": -1, "last_activity_date": 1427060593, "last_edit_date": 1427060593, "creation_date": 1426964213, "answer_id": 29186738, "question_id": 29183152, "link": "https://stackoverflow.com/questions/29183152/how-can-i-output-csv-with-martini/29186738#29186738", "title": "How can I output CSV with martini?", "body": "<p>Use the standard library. There is no general solution without reflection, but you can simplify it. </p>\n\n<pre><code>func handler(rw http.ResponseWriter) {\n    rw.Header().Add(\"Content-Type\", \"text/csv\")\n    wr := csv.NewWriter(rw)\n    err := wr.Write([]string{\"id\", \"Latitude\", \"Longitude\"})\n    if err != nil {\n        ...\n    }\n    for _, packet := range tour.Packets {\n        err := wr.Write([]string{\n            strconv.FormatInt(packet.Id, 10),\n            strconv.FormatFloat(packet.Latitude, 'f', 6, 64),\n            strconv.FormatFloat(packet.Longitude, 'f', 6, 64),\n        })\n        if err != nil {\n            ...\n        }\n    }\n}\n</code></pre>\n\n<p>If you need a general solution for any struct, it will require reflect.\nSee <a href=\"http://play.golang.org/p/ms5qQ1tQS1\" rel=\"nofollow\">here</a>. </p>\n\n<pre><code>// structToStringSlice takes a struct value and\n// creates a string slice of all the values in that struct\nfunc structToStringSlice(i interface{}) []string {\n    v := reflect.ValueOf(i)\n    n := v.NumField()\n    out := make([]string, n)\n    for i := 0; i &lt; n; i++ {\n        field := v.Field(i)\n        switch field.Kind() {\n        case reflect.String:\n            out[i] = field.String()\n        case reflect.Int:\n            out[i] = strconv.FormatInt(field.Int(), 10)\n        // add cases here to support more field types.\n        }\n    }\n    return out\n}\n\n// writeToCSV prints a slice of structs as csv to a writer\nfunc writeToCSV(w io.Writer, i interface{}) {\n    wr := csv.NewWriter(w)\n    v := reflect.ValueOf(i)\n\n    // Get slice's element type (some unknown struct type)\n    typ := v.Type().Elem()\n    numFields := typ.NumField()\n    fieldSet := make([]string, numFields)\n    for i := 0; i &lt; numFields; i++ {\n        fieldSet[i] = typ.Field(i).Name\n    }\n    // Write header row\n    wr.Write(fieldSet)\n\n    // Write data rows\n    sliceLen := v.Len()\n    for i := 0; i &lt; sliceLen; i++ {\n        wr.Write(structToStringSlice(v.Index(i).Interface()))\n    }\n    wr.Flush()\n}\n</code></pre>\n\n<p>so then your example is just:</p>\n\n<pre><code>func handler(rw http.ResponseWriter) {\n    ....\n    writeToCSV(rw, tour.Packets)\n}\n</code></pre>\n\n<p>The function I've written will only work for int or string fields. You can easily extend this to more types by adding cases to the switch in structToStringSlice. See <a href=\"https://godoc.org/reflect#Kind\" rel=\"nofollow\">here</a> for reflect docs on the other <code>Kinds</code>.</p>\n"}], "owner": {"reputation": 90304, "user_id": 562769, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/e86681e49622d52817b36fd2a4c936b7?s=128&d=identicon&r=PG", "display_name": "Martin Thoma", "link": "https://stackoverflow.com/users/562769/martin-thoma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1427060593, "creation_date": 1426943758, "last_edit_date": 1426945035, "question_id": 29183152, "link": "https://stackoverflow.com/questions/29183152/how-can-i-output-csv-with-martini", "title": "How can I output CSV with martini?", "body": "<p>I would like to print CSV-data to the output with martini. Currently, I have always used <code>r.JSON(200, somestruct)</code> where <code>r</code> is a <code>render.Render</code> from <code>github.com/martini-contrib</code>.</p>\n\n<p>Now I have an slice of structs and I would like to print them as CSV (stringify each field of a single struct and print one struct at one line).</p>\n\n<p>Currently, I do it like this:</p>\n\n<pre><code>r.Data(200, []byte(\"id,Latitude,Longitude\\n\"))\nfor _, packet := range tour.Packets {\n    r.Data(200, []byte(strconv.FormatInt(packet.Id, 10)+\",\"+strconv.FormatFloat(packet.Latitude, 'f', 6, 64)+\",\"+strconv.FormatFloat(packet.Longitude, 'f', 6, 64)+\"\\n\"))\n}\n</code></pre>\n\n<p>But I don't like the way I do it for the following reasons:</p>\n\n<ul>\n<li>It is downloaded directly and not printed to the screen.</li>\n<li>I get <code>http: multiple response.WriteHeader calls</code></li>\n<li>I would prefer not to make this manually (the struct has much more fields, but all fields are either <code>\u00ecnt64</code>, <code>float64</code> or <code>time.Time</code>.</li>\n</ul>\n\n<p>How can I implement the CSV export option in a simpler way?</p>\n"}, {"tags": ["methods", "concurrency", "go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1426936270, "post_id": 29182000, "comment_id": 46580244, "body": "Your program exits before the goroutine manages to start"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1426936704, "post_id": 29182000, "comment_id": 46580372, "body": "Also related: <a href=\"http://stackoverflow.com/questions/28307783/goroutine-does-not-execute-if-time-sleep-included\" title=\"goroutine does not execute if time sleep included\">stackoverflow.com/questions/28307783/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2611, "user_id": 872918, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b89d3f5413870b28a39767f0289c32b?s=128&d=identicon&r=PG", "display_name": "snap", "link": "https://stackoverflow.com/users/872918/snap"}, "is_accepted": false, "score": 0, "last_activity_date": 1426936285, "creation_date": 1426936285, "answer_id": 29182022, "question_id": 29182000, "link": "https://stackoverflow.com/questions/29182000/go-invoking-methods-concurrently-isnt-working-for-me/29182022#29182022", "title": "Go: invoking methods concurrently isn&#39;t working for me", "body": "<p>Your <code>main</code> exits and the process dies before the goroutine has a chance to print the output.</p>\n"}], "owner": {"reputation": 1, "user_id": 4696973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/949dcac735f32564fa9356767856bf6c?s=128&d=identicon&r=PG&f=1", "display_name": "Srikanth Seshadri", "link": "https://stackoverflow.com/users/4696973/srikanth-seshadri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "closed_date": 1426969103, "answer_count": 1, "score": -1, "last_activity_date": 1457963457, "creation_date": 1426936108, "question_id": 29182000, "link": "https://stackoverflow.com/questions/29182000/go-invoking-methods-concurrently-isnt-working-for-me", "closed_reason": "Duplicate", "title": "Go: invoking methods concurrently isn&#39;t working for me", "body": "<p>I'm new to Go. I'm trying out this example where I want to perform a concurrent call from a method. This isn't working for me (I don't see the output). </p>\n\n<p>Based on \"Effective Go\", it says concurrency is supported for methods and functions. What am I doing wrong?</p>\n\n<p>Thanks,\n-Srikanth</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Hello struct {\n    a int\n}\n\nfunc (h *Hello) Myprint (value string) {\n    go func() {\n        fmt.Println(value)\n    } ()\n}\n\nfunc main() {\n    h := &amp;Hello{100}\n\n    go h.Myprint(\"need to go\")\n}\n</code></pre>\n"}, {"tags": ["angularjs", "http", "go", "request"], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 4697005, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IcWqw.jpg?s=128&g=1", "display_name": "Kody Doherty", "link": "https://stackoverflow.com/users/4697005/kody-doherty"}, "edited": false, "score": 0, "creation_date": 1427065614, "post_id": 29197782, "comment_id": 46614022, "body": "Thanks for taking the time to explain that to me. It makes a lot more sense now. I have been stuck on this for over a week. Saved me a huge headache thanks!!!"}, {"owner": {"reputation": 312, "user_id": 4920026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KR0NK.jpg?s=128&g=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/4920026/priyanka"}, "edited": false, "score": 0, "creation_date": 1547113566, "post_id": 29197782, "comment_id": 95083028, "body": "Getting err as &#39; http: multipart handled by ParseMultipartForm&#39;"}], "tags": [], "owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "is_accepted": true, "score": 3, "last_activity_date": 1427046719, "creation_date": 1427046719, "answer_id": 29197782, "question_id": 29181995, "link": "https://stackoverflow.com/questions/29181995/how-do-you-parse-both-a-file-and-json-data-out-of-one-http-request-with-go/29197782#29197782", "title": "How do you parse both a file and JSON data out of one HTTP request with Go?", "body": "<p>In your example you're trying to read r.Body as if it was stripped out of PDF part of the request, but it isn't. You need to process separately both parts, PDF and JSON.\nUse <a href=\"http://golang.org/pkg/net/http/#Request.MultipartReader\" rel=\"nofollow\">http.(*Request).MultipartReader()</a> for that.</p>\n\n<p>r.MultipartReader() will return you <a href=\"http://golang.org/pkg/mime/multipart/#Reader\" rel=\"nofollow\">mime/multipart.Reader</a> object, so you can iterate over parts with <a href=\"http://golang.org/pkg/mime/multipart/#Reader.NextPart\" rel=\"nofollow\">r.NextPart()</a> function and process each part separately.</p>\n\n<p>So your handler function should be like this:</p>\n\n<pre><code>func (s *Server) PostFileHandler(w http.ResponseWriter, r *http.Request) {\n    mr, err := r.MultipartReader()\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    doc := Doc{}\n    for {\n        part, err := mr.NextPart()\n\n        // This is OK, no more parts\n        if err == io.EOF {\n            break\n        }\n\n        // Some error\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n\n        // PDF 'file' part\n        if part.FormName() == \"file\" {\n            doc.Url = part.FileName()\n            fmt.Println(\"URL:\", part.FileName())\n            outfile, err := os.Create(\"./docs/\" + part.FileName())\n            if err != nil {\n                http.Error(w, err.Error(), http.StatusInternalServerError)\n                return\n            }\n            defer outfile.Close()\n\n            _, err = io.Copy(outfile, part)\n            if err != nil {\n                http.Error(w, err.Error(), http.StatusInternalServerError)\n                return\n            }\n        }\n\n        // JSON 'doc' part\n        if part.FormName() == \"doc\" {\n            jsonDecoder := json.NewDecoder(part)\n            err = jsonDecoder.Decode(&amp;doc)\n            if err != nil {\n                http.Error(w, err.Error(), http.StatusInternalServerError)\n                return\n            }\n            fmt.Println(doc.Title, doc.Url, doc.Cat, doc.Date)\n        }\n    }\n\n    doc.Id = len(docs) + 1\n    err = s.db.Insert(&amp;doc)\n    checkErr(err, \"Insert failed\")\n\n    s.Ren.JSON(w, http.StatusOK, &amp;doc)\n}\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 4697005, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IcWqw.jpg?s=128&g=1", "display_name": "Kody Doherty", "link": "https://stackoverflow.com/users/4697005/kody-doherty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1584, "favorite_count": 0, "accepted_answer_id": 29197782, "answer_count": 1, "score": 1, "last_activity_date": 1427046719, "creation_date": 1426936082, "question_id": 29181995, "link": "https://stackoverflow.com/questions/29181995/how-do-you-parse-both-a-file-and-json-data-out-of-one-http-request-with-go", "title": "How do you parse both a file and JSON data out of one HTTP request with Go?", "body": "<p>I am stuck trying to figure out how to parse both a PDF document and JSON data out of one http request form from an Angularjs front end. \nThe request payload is </p>\n\n<p><strong>HTTP Request</strong></p>\n\n<p>Content-Disposition: form-data; name=\"file\"; filename=\"Parent Handbook.pdf\"\nContent-Type: application/pdf</p>\n\n<p>Content-Disposition: form-data; name=\"doc\"</p>\n\n<p>{\"title\":\"test\",\"cat\":\"test cat\",\"date\":20142323}</p>\n\n<p>The \u201cfile\u201d is the pdf and \u201cdoc\u201d is the json data I want to parse. </p>\n\n<p>My handler can parse and save the file just fine but fails to get anything out of the Json. Any ideas?</p>\n\n<pre><code>func (s *Server) PostFileHandler(w http.ResponseWriter, r *http.Request) {\n    const _24K = (1 &lt;&lt; 20) * 24\n    err := r.ParseMultipartForm(_24K)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n    doc := Doc{}\n    jsonDecoder := json.NewDecoder(r.Body)\n    fmt.Println(r.Body)\n    err = jsonDecoder.Decode(&amp;doc)\n    if err != nil {\n        fmt.Println(err.Error())\n    }\n    fmt.Println(doc.Title, doc.Url, doc.Cat, doc.Date)\n    doc.Id = len(docs) + 1\n    err = s.db.Insert(&amp;doc)\n    checkErr(err, \"Insert failed\")\n\n    // files := m.File[\"myFile\"]\n    for _, fheaders := range r.MultipartForm.File {\n        for _, hdr := range fheaders {\n            var infile multipart.File\n            infile, err = hdr.Open()\n            // defer infile.Close()\n            if err != nil {\n                http.Error(w, err.Error(), http.StatusInternalServerError)\n                return\n            }\n            doc.Url = hdr.Filename\n            fmt.Println(hdr.Filename)\n            var outfile *os.File\n            outfile, err = os.Create(\"./docs/\" + hdr.Filename)\n            // defer outfile.Close()\n            if err != nil {\n                http.Error(w, err.Error(), http.StatusInternalServerError)\n                return\n            }\n            _, err = io.Copy(outfile, infile)\n            if err != nil {\n                http.Error(w, err.Error(), http.StatusInternalServerError)\n                return\n            }\n\n        }\n    }\n    s.Ren.JSON(w, http.StatusOK, &amp;doc)\n    // http.Error(w, \"hit file server\", http.StatusOK)\n}\n</code></pre>\n"}, {"tags": ["php", "encryption", "go"], "comments": [{"owner": {"reputation": 3457, "user_id": 3108853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db3d997e8c35cb14623d4dc4de494801?s=128&d=identicon&r=PG&f=1", "display_name": "lsowen", "link": "https://stackoverflow.com/users/3108853/lsowen"}, "edited": false, "score": 1, "creation_date": 1426912058, "post_id": 29178760, "comment_id": 46575441, "body": "The PHP output is actually <code>lvb7JwaI4OCYUrdJMm8Q9uDd9rIILnvbZKJb&#47;ozFbwDV98XaJjvzEjBQp7jc&zwnj;&#8203;+2DH</code> (Note the last symbol is missing)."}, {"owner": {"reputation": 2703, "user_id": 2049333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3de211d5b26ab932c16ab465d1791018?s=128&d=identicon&r=PG", "display_name": "mschuett", "link": "https://stackoverflow.com/users/2049333/mschuett"}, "reply_to_user": {"reputation": 76487, "user_id": 34218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f657c6adf1e623cd6f8818408ecd8f75?s=128&d=identicon&r=PG", "display_name": "Jason Coco", "link": "https://stackoverflow.com/users/34218/jason-coco"}, "edited": false, "score": 0, "creation_date": 1426979951, "post_id": 29178760, "comment_id": 46592922, "body": "@JasonCoco would you care to elaborate? Like i said above I don&#39;t know a lot about crypto. But that is besides the point this is the encryption that a third party uses. However if you link me to some articles on why using CBC is bad ill look into it and try and change some peoples minds."}, {"owner": {"reputation": 76487, "user_id": 34218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f657c6adf1e623cd6f8818408ecd8f75?s=128&d=identicon&r=PG", "display_name": "Jason Coco", "link": "https://stackoverflow.com/users/34218/jason-coco"}, "edited": false, "score": 1, "creation_date": 1427056896, "post_id": 29178760, "comment_id": 46611562, "body": "Sorry, it&#39;s my bad, use cbc, don&#39;t use ecb, which you weren&#39;t using at all :) Apologizes for the misleading comment and I promise to sleep more before commenting in the future!"}, {"owner": {"reputation": 2703, "user_id": 2049333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3de211d5b26ab932c16ab465d1791018?s=128&d=identicon&r=PG", "display_name": "mschuett", "link": "https://stackoverflow.com/users/2049333/mschuett"}, "reply_to_user": {"reputation": 76487, "user_id": 34218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f657c6adf1e623cd6f8818408ecd8f75?s=128&d=identicon&r=PG", "display_name": "Jason Coco", "link": "https://stackoverflow.com/users/34218/jason-coco"}, "edited": false, "score": 0, "creation_date": 1427062490, "post_id": 29178760, "comment_id": 46613152, "body": "@JasonCoco no problem at all just wanted to make sure I wasn&#39;t doing something stupid."}], "answers": [{"comments": [{"owner": {"reputation": 2703, "user_id": 2049333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3de211d5b26ab932c16ab465d1791018?s=128&d=identicon&r=PG", "display_name": "mschuett", "link": "https://stackoverflow.com/users/2049333/mschuett"}, "edited": false, "score": 0, "creation_date": 1426912297, "post_id": 29179244, "comment_id": 46575469, "body": "Thank you so much, Been trying to figure this one out for a while. The answer you linked to helped me understand padding better."}, {"owner": {"reputation": 3457, "user_id": 3108853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db3d997e8c35cb14623d4dc4de494801?s=128&d=identicon&r=PG&f=1", "display_name": "lsowen", "link": "https://stackoverflow.com/users/3108853/lsowen"}, "reply_to_user": {"reputation": 2703, "user_id": 2049333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3de211d5b26ab932c16ab465d1791018?s=128&d=identicon&r=PG", "display_name": "mschuett", "link": "https://stackoverflow.com/users/2049333/mschuett"}, "edited": false, "score": 1, "creation_date": 1426912384, "post_id": 29179244, "comment_id": 46575484, "body": "Glad I could help.  Just FYI, looks like you <i>always</i> have to use padding, so you might have to change your code some to still use padding even when the input plaintext is exactly a multiple of the block size."}, {"owner": {"reputation": 596, "user_id": 981494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2517ef01ac77a6a0b251336a6ce224?s=128&d=identicon&r=PG", "display_name": "Anatoly Bubenkov", "link": "https://stackoverflow.com/users/981494/anatoly-bubenkov"}, "edited": false, "score": 0, "creation_date": 1520077104, "post_id": 29179244, "comment_id": 85172570, "body": "Thank you very much! Saved me a lot of time"}], "tags": [], "owner": {"reputation": 3457, "user_id": 3108853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db3d997e8c35cb14623d4dc4de494801?s=128&d=identicon&r=PG&f=1", "display_name": "lsowen", "link": "https://stackoverflow.com/users/3108853/lsowen"}, "is_accepted": true, "score": 4, "last_activity_date": 1426911929, "last_edit_date": 1495540617, "creation_date": 1426911929, "answer_id": 29179244, "question_id": 29178760, "link": "https://stackoverflow.com/questions/29178760/how-to-duplicate-openssl-encrypt/29179244#29179244", "title": "how to duplicate openssl_encrypt?", "body": "<p>You were very close, but you had the padding wrong.  According to <a href=\"https://stackoverflow.com/a/1870754/3108853\">this answer</a> (and the PHP docs), PHP uses the default OpenSSL padding behavior, which is to use the required number of padding bytes as the padding byte value.</p>\n\n<p>The only change I made was:</p>\n\n<pre><code>copy(plaintextblock[length:], bytes.Repeat([]byte{uint8(extendBlock)}, extendBlock))\n</code></pre>\n\n<p>You can see the full updated code <a href=\"https://play.golang.org/p/WFzm4QRDVC\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1426914735, "creation_date": 1426914735, "answer_id": 29179492, "question_id": 29178760, "link": "https://stackoverflow.com/questions/29178760/how-to-duplicate-openssl-encrypt/29179492#29179492", "title": "how to duplicate openssl_encrypt?", "body": "<p>Others beat me to the answer while I was playing with it, but I have a \"better\" fixed version of your example code that also takes into account that padding is always required (at least to emulate what the php code does).</p>\n\n<p>It also shows the <code>openssl</code> command line that you'd use to do the same thing, and if available runs it (of course the playground won't).</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"encoding/base64\"\n    \"fmt\"\n    \"log\"\n    \"os/exec\"\n    \"strings\"\n)\n\nfunc main() {\n    const input = \"This is some text I want to encrypt\"\n    fmt.Println(opensslCommand(input))\n    fmt.Println(aesCBCenctypt(input))\n}\n\nfunc aesCBCenctypt(input string) string {\n    // Of course real IVs should be from crypto/rand\n    iv := []byte(\"MMMMMMMMMMMMMMMM\")\n    // And real keys should be from something like PBKDF2, RFC 2898.\n    // E.g. use golang.org/x/crypto/pbkdf2 to turn a\n    // \"passphrase\" into a key.\n    key := []byte(\"This is a really long key and su\")\n\n    // Make sure the block size is a multiple of aes.BlockSize\n    // Pad to aes.BlockSize using the pad length as the padding\n    // byte. If we would otherwise need no padding we instead\n    // pad an entire extra block.\n    pad := (aes.BlockSize - len(input)%aes.BlockSize)\n    if pad == 0 {\n        pad = aes.BlockSize\n    }\n    data := make([]byte, len(input)+pad)\n    copy(data, input)\n    for i := len(input); i &lt; len(input)+pad; i++ {\n        data[i] = byte(pad)\n    }\n\n    cb, err := aes.NewCipher(key)\n    if err != nil {\n        log.Fatalln(\"error NewCipher():\", err)\n    }\n\n    mode := cipher.NewCBCEncrypter(cb, iv)\n    mode.CryptBlocks(data, data)\n    return base64.StdEncoding.EncodeToString(data)\n}\n\n// Just for comparison, don't do this for real!\nfunc opensslCommand(input string) string {\n    iv := []byte(\"MMMMMMMMMMMMMMMM\")\n    key := []byte(\"This is a really long key and su\")\n\n    args := []string{\"enc\", \"-aes-256-cbc\", \"-base64\"}\n    // \"-nosalt\", \"-nopad\"\n    args = append(args, \"-iv\", fmt.Sprintf(\"%X\", iv))\n    args = append(args, \"-K\", fmt.Sprintf(\"%X\", key))\n\n    cmd := exec.Command(\"openssl\", args...)\n    // Show how you could do this via the command line:\n    fmt.Println(\"Command:\", strings.Join(cmd.Args, \" \"))\n\n    cmd.Stdin = strings.NewReader(input)\n    result, err := cmd.CombinedOutput()\n    if err != nil {\n        if e, ok := err.(*exec.Error); ok &amp;&amp; e.Err == exec.ErrNotFound {\n            // openssl not available\n            return err.Error() // XXX\n        }\n        // some other error, show it and the (error?) output and die\n        fmt.Println(\"cmd error:\", err)\n        log.Fatalf(\"result %q\", result)\n    }\n    // Strip trailing '\\n' and return it.\n    if n := len(result) - 1; result[n] == '\\n' {\n        result = result[:n]\n    }\n    return string(result)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/rzP7MzYqBH\" rel=\"nofollow\"><kbd>Playground</kbd></a></p>\n"}], "owner": {"reputation": 2703, "user_id": 2049333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3de211d5b26ab932c16ab465d1791018?s=128&d=identicon&r=PG", "display_name": "mschuett", "link": "https://stackoverflow.com/users/2049333/mschuett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 610, "favorite_count": 1, "accepted_answer_id": 29179244, "answer_count": 2, "score": 1, "last_activity_date": 1426914735, "creation_date": 1426906763, "last_edit_date": 1426912329, "question_id": 29178760, "link": "https://stackoverflow.com/questions/29178760/how-to-duplicate-openssl-encrypt", "title": "how to duplicate openssl_encrypt?", "body": "<p>I was hoping someone had already implemented this in golang as I am far from even good at cryptography. However in porting a project from php to golang I have run into an issue with porting the openssl_encrypt method found <a href=\"http://php.net/manual/en/function.openssl-encrypt.php\" rel=\"nofollow\">here</a>. I have also dug into the <a href=\"https://github.com/php/php-src/blob/8633685675692e9a926cf9f97b1c406c37497ddf/ext/openssl/openssl.c#L5168-L5246\" rel=\"nofollow\">source code</a> a little with no avail. </p>\n\n<p>Here is the method I have <a href=\"https://play.golang.org/p/bAlV--IYbY\" rel=\"nofollow\">implemented</a> in golang. which gives me the output </p>\n\n<pre><code>lvb7JwaI4OCYUrdJMm8Q9uDd9rIILnvbZKJb/ozFbwCmLKkxoJN5Zf/ODOJ/RGq5\n</code></pre>\n\n<p>Here is the output I need when using php.</p>\n\n<pre><code>lvb7JwaI4OCYUrdJMm8Q9uDd9rIILnvbZKJb/ozFbwDV98XaJjvzEjBQp7jc+2DH\n</code></pre>\n\n<p>And here is the function I used to generate it with php.</p>\n\n<pre><code>$data = \"This is some text I want to encrypt\";\n$method = \"aes-256-cbc\";\n$password = \"This is a really long key and su\";\n$options = 0;\n$iv = \"MMMMMMMMMMMMMMMM\";\n\necho openssl_encrypt($data, $method, $password, $options, $iv);\n</code></pre>\n\n<p>To me it looks like it is very close and I must be missing something obvious.</p>\n"}, {"tags": ["arrays", "dictionary", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 8, "last_activity_date": 1471848807, "last_edit_date": 1471848807, "creation_date": 1426883465, "answer_id": 29175330, "question_id": 29175247, "link": "https://stackoverflow.com/questions/29175247/hash-with-key-as-an-array-type/29175330#29175330", "title": "Hash with key as an array type", "body": "<p>Array types (unlike slices) in Go are comparable, so there is nothing magical in it: you can just define it like any other maps: <a href=\"http://golang.org/ref/spec#Map_types\" rel=\"nofollow\"><code>map[KeyType]ValueType</code></a> where <code>KeyType</code> will be <code>[3]int</code> and <code>ValueType</code> will be <code>string</code>.</p>\n\n<blockquote>\n  <p>The <a href=\"http://golang.org/ref/spec#Comparison_operators\" rel=\"nofollow\">comparison operators</a> == and != must be fully defined for operands of the key type; thus the key type must not be a function, map, or slice. </p>\n</blockquote>\n\n<pre><code>m := map[[3]int]string{}\n\nm[[3]int{1, 2, 3}] = \"First quarter\"\nm[[3]int{4, 5, 6}] = \"Second quarter\"\nm[[3]int{7, 8, 9}] = \"Third quarter\"\nm[[3]int{10, 11, 12}] = \"Fourth quarter\"\n\nfmt.Println(m)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>map[[1 2 3]:First quarter [4 5 6]:Second quarter \n    [7 8 9]:Third quarter [10 11 12]:Fourth quarter]\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/xfMirCe_cq\" rel=\"nofollow\">Go Playground</a>.</p>\n\n<p>To query an element:</p>\n\n<pre><code>fmt.Println(m[[3]int{1, 2, 3}]) // Prints \"First quarter\"\n</code></pre>\n\n<p>You can also create the map in one step:</p>\n\n<pre><code>m := map[[3]int]string{\n    [3]int{1, 2, 3}:    \"First quarter\",\n    [3]int{4, 5, 6}:    \"Second quarter\",\n    [3]int{7, 8, 9}:    \"Third quarter\",\n    [3]int{10, 11, 12}: \"Fourth quarter\",\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": false, "score": 1, "last_activity_date": 1426962731, "last_edit_date": 1426962731, "creation_date": 1426962068, "answer_id": 29186336, "question_id": 29175247, "link": "https://stackoverflow.com/questions/29175247/hash-with-key-as-an-array-type/29186336#29186336", "title": "Hash with key as an array type", "body": "<p>It should be noted that <code>array</code> in ruby and <code>array</code> in go are different data structures. Go array is not mutable, while ruby <code>array</code> is. Go <code>slice</code> is a lot more similar data structure to ruby <code>array</code>. However, you cannot use <code>slices</code> as keys in go, as pointed out in icza's answer.</p>\n\n<p>So to answer your question: </p>\n\n<blockquote>\n  <p>How the same will be looked in Golang ?</p>\n</blockquote>\n\n<p>It is impossible, you cannot have a dictionary that maps <code>dynamic arrays</code> to <code>strings</code> in go. However, you could convert <code>slices</code> to <code>arrays</code> and use them as keys, as very well explained by icza.</p>\n"}], "owner": {"reputation": 15106, "user_id": 1117851, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/9FMVK.jpg?s=128&g=1", "display_name": "itsnikolay", "link": "https://stackoverflow.com/users/1117851/itsnikolay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 29175330, "answer_count": 2, "score": 3, "last_activity_date": 1471848807, "creation_date": 1426883105, "last_edit_date": 1426893681, "question_id": 29175247, "link": "https://stackoverflow.com/questions/29175247/hash-with-key-as-an-array-type", "title": "Hash with key as an array type", "body": "<p>How to create a key as array in Go for map.\nFor example in ruby I can implement it such:</p>\n\n<pre><code>quarters = {\n  [1, 2, 3] =&gt; 'First quarter',\n  [4, 5, 6] =&gt; 'Second quarter',\n  [7, 8 ,9] =&gt; 'Third quarter',\n  [10, 11, 12] =&gt; 'Fourh quarter',\n}\nquarters[[1, 2, 3]] \n# =&gt; \"First quarter\"\n</code></pre>\n\n<p>How the same will be looked in Golang ?</p>\n"}, {"tags": ["orm", "go", "go-gorm"], "comments": [{"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1431824678, "post_id": 29175144, "comment_id": 48662762, "body": "What do you have in mind? I general you could implement a query callback, but i don&#39;t think that worth the effort.  Automatic Lazy loading is not possible, since there is no interception mechanism on the structs fields."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1433806115, "post_id": 29175144, "comment_id": 49498729, "body": "Could you give a sample of the models? I&#39;d kind of expect it to load those up without an explicit call to <code>Preload</code> so long as the relation is specified correctly. If not some option should be added to the package like <code>CascadingRead</code> that causes a recursive instantiation rather than returning me an object with empty arrays that should hold the many items my current object has foreign key relations with."}], "answers": [{"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": false, "score": 2, "last_activity_date": 1441376947, "creation_date": 1441376947, "answer_id": 32400540, "question_id": 29175144, "link": "https://stackoverflow.com/questions/29175144/gorm-golang-fetching-a-collection-and-its-relationships/32400540#32400540", "title": "Gorm Golang fetching a collection and its relationships", "body": "<p>You can load the related entities later (only when/if needed), using <a href=\"https://godoc.org/github.com/jinzhu/gorm#DB.Related\" rel=\"nofollow\">DB.Related</a> as shown in <a href=\"https://github.com/jinzhu/gorm#has-many\" rel=\"nofollow\">the documentation</a> :</p>\n\n<pre><code>// User has many emails\ndb.Model(&amp;user).Related(&amp;emails)\n//// SELECT * FROM emails WHERE user_id = 111;\n// user_id is the foreign key, 111 is user's primary key's value\n\n// Specify the foreign key\ndb.Model(&amp;user).Related(&amp;emails, \"ProfileId\")\n//// SELECT * FROM emails WHERE profile_id = 111;\n// profile_id is the foreign key, 111 is user's primary key's value\n</code></pre>\n\n<p>I do not see another way in the documentation.</p>\n"}], "owner": {"reputation": 199, "user_id": 1943442, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/d51f42d7f47d45b3259268e5898c5e8f?s=128&d=identicon&r=PG", "display_name": "user1943442", "link": "https://stackoverflow.com/users/1943442/user1943442"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5241, "favorite_count": 2, "answer_count": 1, "score": 10, "last_activity_date": 1441376947, "creation_date": 1426882657, "last_edit_date": 1426920874, "question_id": 29175144, "link": "https://stackoverflow.com/questions/29175144/gorm-golang-fetching-a-collection-and-its-relationships", "title": "Gorm Golang fetching a collection and its relationships", "body": "<p>I recently started using Golang and decided to give GORM a try as an ORM.\nIt works pretty well on most things, but as most ORMs are sometimes it's limited. Luckily it ties very well into database/sql so I can do custom queries easily.</p>\n\n<p>I'm wondering if there is any other way to do this in gorm:\nI have a struct Companies, Companies have one to many relationships w/ emails, addresses, and phones.  I use the following code in gorm to pull a list of companies and their corresponding info.   I use gorm's Preload function. </p>\n\n<pre><code>db.DBAccess.\n    Model(&amp;companies).\n    Count(&amp;dbInfo.Count).\n    Order(\"companies.id asc\").\n    Offset(offset).\n    Limit(length).\n    Preload(\"Addresses\").\n    Preload(\"Phones\").\n    Preload(\"Emails\").\n    Find(&amp;companies)\n</code></pre>\n\n<p>This works perfectly fine. However I feel like there is another way to accomplish this without the Preload function. Any ideas?</p>\n"}, {"tags": ["struct", "go", "literals"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1426877304, "post_id": 29173720, "comment_id": 46565369, "body": "You might expect it to, but literal generally doesn&#39;t imply constant. This is the case in a lot of languages."}, {"owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1426878178, "post_id": 29173720, "comment_id": 46565848, "body": "so what does it mean? lol"}, {"owner": {"reputation": 21153, "user_id": 3397217, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/t9AGX.jpg?s=128&g=1", "display_name": "LinusGeffarth", "link": "https://stackoverflow.com/users/3397217/linusgeffarth"}, "edited": false, "score": 0, "creation_date": 1426878334, "post_id": 29173720, "comment_id": 46565932, "body": "because they are literals? :D"}], "answers": [{"comments": [{"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "edited": false, "score": 2, "creation_date": 1426880522, "post_id": 29174063, "comment_id": 46567031, "body": "Other examples: <code>1</code> is an int literal, <code>&quot;foo&quot;</code> is a string literal, etc."}, {"owner": {"reputation": 3468, "user_id": 71978, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Ex4dt.jpg?s=128&g=1", "display_name": "TomOnTime", "link": "https://stackoverflow.com/users/71978/tomontime"}, "edited": false, "score": 5, "creation_date": 1513277604, "post_id": 29174063, "comment_id": 82602771, "body": "An  easy way  to remember this is that the data for the struct is <code>literal</code>ly right there in the code."}, {"owner": {"reputation": 791, "user_id": 2661238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ce538b600d5570b9c9ebc0a45310d1?s=128&d=identicon&r=PG", "display_name": "Deep", "link": "https://stackoverflow.com/users/2661238/deep"}, "reply_to_user": {"reputation": 675, "user_id": 771555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/969a742cb368841cd092bf01cee0a01f?s=128&d=identicon&r=PG", "display_name": "andyfeller", "link": "https://stackoverflow.com/users/771555/andyfeller"}, "edited": false, "score": 4, "creation_date": 1560442111, "post_id": 29174063, "comment_id": 99747151, "body": "<code>It means it&#39;s not constructed by creating an empty one and adding or subtracting as you go.</code> Made it super clear for me. Thank you @andyfeller \ud83d\ude4c\ud83c\udffc"}], "tags": [], "owner": {"reputation": 15253, "user_id": 456188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ab34924e6d4e07371b890c5655c185a9?s=128&d=identicon&r=PG", "display_name": "Chris Pfohl", "link": "https://stackoverflow.com/users/456188/chris-pfohl"}, "is_accepted": true, "score": 20, "last_activity_date": 1560442468, "last_edit_date": 1560442468, "creation_date": 1426878299, "answer_id": 29174063, "question_id": 29173720, "link": "https://stackoverflow.com/questions/29173720/why-are-struct-literals-literal/29174063#29174063", "title": "Why are struct literals &quot;literal&quot;", "body": "<p>Programming languages use the word \"Literal\" when referring to syntactic ways to construct some data structure. It means it's not constructed by creating an empty one and adding or subtracting as you go.</p>\n\n<p>Compare:</p>\n\n<pre><code>MyType{Field: myVariable}\n</code></pre>\n\n<p>to</p>\n\n<pre><code>var x = new(MyType)\nx.Field = myVariable\n</code></pre>\n\n<p>The benefit is that your code's appearance reflects the data structure in some way.  The downside is that you have to know the layout in advance and have the content initialized already, not possible, if for instance, you're constructing a map with unknown keys.</p>\n\n<p>Here are links to the literals in the Go language specification. Notice that they all are syntactic ways to define a data structure:</p>\n\n<ul>\n<li><a href=\"https://golang.org/ref/spec#Lexical_elements\" rel=\"noreferrer\">Lexical elements</a>\n\n<ul>\n<li><a href=\"https://golang.org/ref/spec#Integer_literals\" rel=\"noreferrer\">Integer literals</a></li>\n<li><a href=\"https://golang.org/ref/spec#Floating-point_literals\" rel=\"noreferrer\">Floating-point literals</a></li>\n<li><a href=\"https://golang.org/ref/spec#Imaginary_literals\" rel=\"noreferrer\">Imaginary literals</a></li>\n<li><a href=\"https://golang.org/ref/spec#Rune_literals\" rel=\"noreferrer\">Rune literals</a></li>\n<li><a href=\"https://golang.org/ref/spec#String_literals\" rel=\"noreferrer\">String literals</a></li>\n</ul></li>\n<li><a href=\"https://golang.org/ref/spec#Expressions\" rel=\"noreferrer\">Expressions</a>\n\n<ul>\n<li><a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"noreferrer\">Composite literals</a></li>\n<li><a href=\"https://golang.org/ref/spec#Function_literals\" rel=\"noreferrer\">Function literals</a></li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 875, "user_id": 4283659, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9QGUw.jpg?s=128&g=1", "display_name": "nhooyr", "link": "https://stackoverflow.com/users/4283659/nhooyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5385, "favorite_count": 5, "accepted_answer_id": 29174063, "answer_count": 1, "score": 13, "last_activity_date": 1560442468, "creation_date": 1426877065, "last_edit_date": 1426878084, "question_id": 29173720, "link": "https://stackoverflow.com/questions/29173720/why-are-struct-literals-literal", "title": "Why are struct literals &quot;literal&quot;", "body": "<p>In golang what are struct literals?</p>\n\n<p>Why is the following a literal even though there is a variable? And aren't structs literally variable, even when not const? So how does it make sense.</p>\n\n<pre><code>MyType{Field: var)\n</code></pre>\n\n<p>It has a variable and yet it's a \"literal\"?</p>\n\n<p>Also why is it only called a \"struct literal\" when you first initialize it?</p>\n"}, {"tags": ["concurrency", "go", "parallel-processing", "quicksort", "goroutine"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1426869088, "post_id": 29171425, "comment_id": 46561024, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/20670242/go-lang-parallel-segment-runs-slower-than-series-segment\">Go-lang parallel segment runs slower than series segment</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1426875440, "post_id": 29171425, "comment_id": 46564425, "body": "There&#39;re clearly similarities, but (after writing an accepted answer on the other q!) I&#39;m not sure it&#39;s a dupe, because the fix looks pretty different for a recursive thing like quicksort as opposed to the flat &quot;do some analysis on every item in an array&quot; task."}, {"owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 2, "creation_date": 1426876008, "post_id": 29171425, "comment_id": 46564705, "body": "What&#39;s your GOMAXPROCS?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1426878201, "post_id": 29171425, "comment_id": 46565858, "body": "Posted a strategy, hope to flesh it out with sample code when I get time. (I&#39;d like to start with a minimal serial <code>qsort</code> for clarity, so it&#39;ll take a little time to do that.)"}, {"owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "edited": false, "score": 1, "creation_date": 1426880184, "post_id": 29171425, "comment_id": 46566860, "body": "<a href=\"https://gist.github.com/ncw/5419af0e255d2fb62b98\" rel=\"nofollow noreferrer\">Here</a> is a parallel quicksort I wrote just for fun which abuses go concurrency mechanisms..."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426880225, "post_id": 29171425, "comment_id": 46566879, "body": "FYI, it&#39;s best to do benchmarking of Go code with the <a href=\"https://golang.org/pkg/testing/#hdr-Benchmarks\" rel=\"nofollow noreferrer\">benchmarking support in the <code>testing</code> package</a>. Then you and others can easily do <code>go test -bench=. -cpu=1,4,8</code> (or whatever number of CPUs is appropriate)."}, {"owner": {"reputation": 2537, "user_id": 609444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9067a93d98103b998a407bd89122c85b?s=128&d=identicon&r=PG", "display_name": "Erez A. Korn", "link": "https://stackoverflow.com/users/609444/erez-a-korn"}, "reply_to_user": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 0, "creation_date": 1426913155, "post_id": 29171425, "comment_id": 46575569, "body": "@dmitri-goldring I used your comment and checked the number of GOMAXPROCS, I posted the answer as such"}], "answers": [{"comments": [{"owner": {"reputation": 2537, "user_id": 609444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9067a93d98103b998a407bd89122c85b?s=128&d=identicon&r=PG", "display_name": "Erez A. Korn", "link": "https://stackoverflow.com/users/609444/erez-a-korn"}, "edited": false, "score": 0, "creation_date": 1426913228, "post_id": 29173931, "comment_id": 46575575, "body": "After checking everything, the reason was simple enough and not in the algorithm itself. Additionally, the reason I&#39;m not using the sort package is that I&#39;m giving a Go course, and this is one of the challenges. I wanted to understand the issue for the class."}], "tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": false, "score": 6, "last_activity_date": 1426895449, "last_edit_date": 1426895449, "creation_date": 1426877816, "answer_id": 29173931, "question_id": 29171425, "link": "https://stackoverflow.com/questions/29171425/worse-performance-when-using-go-routines-in-parallel-quicksort-implementation/29173931#29173931", "title": "Worse performance when using go routines in parallel quicksort implementation", "body": "<p>The general answer is that inter-thread coordination has a cost, so sending a task off to another goroutine can only speed things up if the task is at least a certain size. So don't send single items.</p>\n\n<p>For a divide-and-conquer algorithm like quicksort, the ways to parallelize can be interesting. Generally: when you recurse, you can start the \"sort one half of the array\" task in a goroutine if it's large enough. The \"if it's large enough\" part is how you reduce coordination overhead.</p>\n\n<p>In more detail, that looks like:</p>\n\n<ol>\n<li><p>write a non-parallel <code>qsort(data []int)</code></p></li>\n<li><p>change <code>qsort</code> to optionally take a <a href=\"http://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow\"><code>*sync.WaitGroup</code></a> we'll call <code>wg</code> for signaling that it's done. Add <code>if wg != nil { wg.Done() }</code> before each of its <code>return</code>s.</p></li>\n<li><p>where <code>qsort</code> recurses, have it check whether the half of the data it's going to sort is large-ish (say, over 500 items?), and </p>\n\n<ul>\n<li>if it's large, start another task: <code>wg.Add(1); go qsort(half, wg)</code></li>\n<li>if it's not, sort here and now: <code>qsort(half, nil)</code></li>\n</ul></li>\n<li><p>wrap <code>qsort</code> in to hide the parallel machinery from the user: like, have <code>quicksort(data)</code> do <code>wg := new(sync.WaitGroup)</code>, do an initial <code>wg.Add(1)</code>, call <code>qsort(data, wg)</code>, and do <code>wg.Wait()</code> to wait for all of the background sorts to complete.</p></li>\n</ol>\n\n<p>This isn't an <em>optimal</em> strategy, because it keeps forking off new goroutines even after there are enough tasks to keep your cores busy. And there is a lot of tuning one could do around just <em>how</em> you hand off some tasks to the background. But the big point is, using another thread <em>only for large subtasks</em> is a way to parallelize quicksort without getting smashed by coordination overhead. </p>\n\n<p>Here's a <a href=\"http://play.golang.org/p/QMQxKEzATq\" rel=\"nofollow\">demo with an embarrassingly slapdash quicksort</a> (you have run it locally to get the timing)--good chance of bugs, definitely is quadratic on already-sorted data; the point is to get the idea of parallel divide-and-conquer across.</p>\n\n<p>There is also a bottom-up strategy--sort pieces then merge--used in, for instance, <a href=\"https://github.com/Workiva/go-datastructures/blob/master/sort/sort.go\" rel=\"nofollow\">this parallel sort package</a>. The in-place merge code that package uses is tricky, though.</p>\n\n<p>(And if you haven't set GOMAXPROCS, set it with something like <code>runtime.GOMAXPROCS(runtime.NumCPU())</code> in <code>main</code>.)</p>\n\n<p>Finally, <a href=\"https://github.com/golang/go/tree/master/src/sort/\" rel=\"nofollow\">look at Go's sort package</a>. There's a lot of code, but it's pretty clear, and once you get it you can do your experiments with a \"real\", fleshed-out sort implementation.</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426915544, "post_id": 29179448, "comment_id": 46575902, "body": "You don&#39;t just want to <a href=\"https://golang.org/doc/faq#Why_GOMAXPROCS\" rel=\"nofollow noreferrer\">blindly always set GOMAXPROCS</a>. Set it as appropriate per program, or for some programs it may be appropriate to use <a href=\"https://golang.org/pkg/runtime/#GOMAXPROCS\" rel=\"nofollow noreferrer\"><code>runtime.GOMAXPROCS()</code></a> (possibly via a <code>-cpu</code> or <code>-ncpu</code> flag of your program)."}, {"owner": {"reputation": 2537, "user_id": 609444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9067a93d98103b998a407bd89122c85b?s=128&d=identicon&r=PG", "display_name": "Erez A. Korn", "link": "https://stackoverflow.com/users/609444/erez-a-korn"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426916826, "post_id": 29179448, "comment_id": 46576131, "body": "I&#39;m not sure I agree, as &quot;This call will go away when the scheduler improves&quot; <a href=\"http://golang.org/pkg/runtime/#GOMAXPROCS\" rel=\"nofollow noreferrer\">runtime.GOMAXPROCS()</a>. In any case, the point was that the default has no value at all."}], "tags": [], "owner": {"reputation": 2537, "user_id": 609444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9067a93d98103b998a407bd89122c85b?s=128&d=identicon&r=PG", "display_name": "Erez A. Korn", "link": "https://stackoverflow.com/users/609444/erez-a-korn"}, "is_accepted": true, "score": 2, "last_activity_date": 1426916384, "last_edit_date": 1426916384, "creation_date": 1426914334, "answer_id": 29179448, "question_id": 29171425, "link": "https://stackoverflow.com/questions/29171425/worse-performance-when-using-go-routines-in-parallel-quicksort-implementation/29179448#29179448", "title": "Worse performance when using go routines in parallel quicksort implementation", "body": "<p>Turns out it was very simple. As I'm on a new machine, the GOMAXPROCS variable wasn't set.</p>\n\n<p>The new benchmark favors, as predicted, the parallel implementation:\nSet to double the number of cores:</p>\n\n<pre><code>Using 16 goroutines\nRan 100 times\n\nNon parallel average - 1980\nParallel average - 1133\n</code></pre>\n\n<p>Set to the number of cores:</p>\n\n<pre><code>Using 8 goroutines\nRan 100 times\n\nNon parallel average - 2004\nParallel average - 1197\n</code></pre>\n\n<p>By the way, this is fairly consistent. The average for double the number of cores is always a bit better. </p>\n\n<p>Benchmark for a larger collection (1000000):</p>\n\n<pre><code>Using 8 goroutines\nRan 100 times\n\nNon parallel average - 3748\nParallel average - 2265\n</code></pre>\n\n<p>With double:</p>\n\n<pre><code>Using 16 goroutines\nRan 100 times\n\nNon parallel average - 3817\nParallel average - 2012\n</code></pre>\n"}], "owner": {"reputation": 2537, "user_id": 609444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9067a93d98103b998a407bd89122c85b?s=128&d=identicon&r=PG", "display_name": "Erez A. Korn", "link": "https://stackoverflow.com/users/609444/erez-a-korn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1159, "favorite_count": 0, "accepted_answer_id": 29179448, "answer_count": 2, "score": 3, "last_activity_date": 1551393753, "creation_date": 1426868971, "last_edit_date": 1426913041, "question_id": 29171425, "link": "https://stackoverflow.com/questions/29171425/worse-performance-when-using-go-routines-in-parallel-quicksort-implementation", "title": "Worse performance when using go routines in parallel quicksort implementation", "body": "<p>Note: The \"Go-lang parallel segment runs slower than series segment\" question dealt with race conditions, this one has another issue, so imho it's not a duplicate.</p>\n\n<p>I'm trying to find an explanation for the following situation:\nRunning parallel quicksort results in a significantly longer runtime when done using go routines.</p>\n\n<p>Benchmarks are after the code:</p>\n\n<pre><code>package c9sort\n\nimport (\n    \"time\"\n)\n\nvar runInParllel bool\n\nfunc Quicksort(nums []int, parallel bool) ([]int, int) {\n    started := time.Now()\n    ch := make(chan int)\n    runInParllel = parallel\n\n    go quicksort(nums, ch)\n\n    sorted := make([]int, len(nums))\n    i := 0\n    for next := range ch {\n        sorted[i] = next\n        i++\n    }\n    return sorted, int(time.Since(started).Nanoseconds() / 1000000)\n}\n\nfunc quicksort(nums []int, ch chan int) {\n\n    // Choose first number as pivot\n    pivot := nums[0]\n\n    // Prepare secondary slices\n    smallerThanPivot := make([]int, 0)\n    largerThanPivot := make([]int, 0)\n\n    // Slice except pivot\n    nums = nums[1:]\n\n    // Go over slice and sort\n    for _, i := range nums {\n        switch {\n        case i &lt;= pivot:\n            smallerThanPivot = append(smallerThanPivot, i)\n        case i &gt; pivot:\n            largerThanPivot = append(largerThanPivot, i)\n        }\n    }\n\n    var ch1 chan int\n    var ch2 chan int\n\n    // Now do the same for the two slices\n    if len(smallerThanPivot) &gt; 1 {\n        ch1 = make(chan int, len(smallerThanPivot))\n        if runInParllel {\n            go quicksort(smallerThanPivot, ch1)\n        } else {\n            quicksort(smallerThanPivot, ch1)\n        }\n    }\n    if len(largerThanPivot) &gt; 1 {\n        ch2 = make(chan int, len(largerThanPivot))\n        if runInParllel {\n            go quicksort(largerThanPivot, ch2)\n        } else {\n            quicksort(largerThanPivot, ch2)\n        }\n    }\n\n    // Wait until the sorting finishes for the smaller slice\n    if len(smallerThanPivot) &gt; 1 {\n        for i := range ch1 {\n            ch &lt;- i\n        }\n    } else if len(smallerThanPivot) == 1 {\n        ch &lt;- smallerThanPivot[0]\n    }\n    ch &lt;- pivot\n\n    if len(largerThanPivot) &gt; 1 {\n        for i := range ch2 {\n            ch &lt;- i\n        }\n    } else if len(largerThanPivot) == 1 {\n        ch &lt;- largerThanPivot[0]\n    }\n\n    close(ch)\n}\n</code></pre>\n\n<p>Benchmarks for a random perm of 500000 integers:</p>\n\n<p>Ran 100 times</p>\n\n<p>Non parallel average - 1866ms</p>\n\n<p>Parallel average - 2437ms</p>\n\n<p>Any explanation would be appreciated. I know goroutines may not be best for this kind of parallelism, but I'm trying to understand the reason.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["struct", "go"], "comments": [{"owner": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 2, "creation_date": 1426861817, "post_id": 29168905, "comment_id": 46556135, "body": "As you&#39;re not passing a pointer, your function which returns nothing can&#39;t clear a because it doesn&#39;t know a, only a copy of the value."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 6, "creation_date": 1426862207, "post_id": 29168905, "comment_id": 46556379, "body": "Just assign a zero value like this <code>a=A{}</code> which is much simpler and more readable."}, {"owner": {"reputation": 20642, "user_id": 51233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92da37f356622a97ff8a2bfe3d4d962?s=128&d=identicon&r=PG", "display_name": "Jeremy Wall", "link": "https://stackoverflow.com/users/51233/jeremy-wall"}, "edited": false, "score": 0, "creation_date": 1426865335, "post_id": 29168905, "comment_id": 46558598, "body": "technically an interface value <i>is</i> a reference type. So the clear function as he wrote it could clear a struct. However he would have to use a lot of reflection. Much easier to just use a zero value as others have said."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 20642, "user_id": 51233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92da37f356622a97ff8a2bfe3d4d962?s=128&d=identicon&r=PG", "display_name": "Jeremy Wall", "link": "https://stackoverflow.com/users/51233/jeremy-wall"}, "edited": false, "score": 2, "creation_date": 1426865702, "post_id": 29168905, "comment_id": 46558842, "body": "@JeremyWall: that&#39;s incorrect. You cannot get a reference to the original value through an interface, even via reflection."}, {"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1426868678, "post_id": 29168905, "comment_id": 46560770, "body": "@JimB I don&#39;t understand.  The clear example in your own answer modifies the original value through an interface via reflection."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "edited": false, "score": 3, "creation_date": 1426868874, "post_id": 29168905, "comment_id": 46560873, "body": "@zmb, it&#39;s because my answer is using a pointer. It has nothing to do with an interface being a &quot;reference type&quot; (which is a bit of a misnomer), it&#39;s just extracting a pointer from an interface. The original question is <i>not</i> passing a pointer, and because everything in Go is a value, and all assignments are a copy, there is no way to modify the values of a and b in that manner."}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426877211, "post_id": 29169727, "comment_id": 46565318, "body": "FYI, instead of a <code>Clear()</code> method there is precedent in the standard library of using <code>Reset()</code>. E.g. <a href=\"https://golang.org/pkg/bytes/#Buffer.Reset\" rel=\"nofollow noreferrer\"><code>bytes.Buffer</code></a>, <a href=\"https://golang.org/pkg/hash/#Hash\" rel=\"nofollow noreferrer\"><code>hash.Hash</code></a>, etc."}, {"owner": {"reputation": 867, "user_id": 764516, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/e9c6eb568d8f822119773908a236ebbc?s=128&d=identicon&r=PG", "display_name": "thinkhy", "link": "https://stackoverflow.com/users/764516/thinkhy"}, "edited": false, "score": 0, "creation_date": 1461821292, "post_id": 29169727, "comment_id": 61375345, "body": "Seems clear function doesn&#39;t work for string type: &quot;reflect: call of reflect.Value.Elem on string Value&quot;"}, {"owner": {"reputation": 541, "user_id": 811827, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f091e1ad556fc066d3a09052f8936312?s=128&d=identicon&r=PG", "display_name": "Cyberience", "link": "https://stackoverflow.com/users/811827/cyberience"}, "edited": false, "score": 0, "creation_date": 1554980310, "post_id": 29169727, "comment_id": 97952901, "body": "the answer from @AESTHETICS is more correct, as this solution does in-fact fail. myStructVar = myBaseStruct{} This works, would be nice to have a struct method called reset."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 541, "user_id": 811827, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f091e1ad556fc066d3a09052f8936312?s=128&d=identicon&r=PG", "display_name": "Cyberience", "link": "https://stackoverflow.com/users/811827/cyberience"}, "edited": false, "score": 1, "creation_date": 1555955189, "post_id": 29169727, "comment_id": 98266337, "body": "@Cyberience: yes, AESTHETICS answer would be preferred if the real use code was as simple as the example provided. While that should be the preferred method for most code, it makes no attempt to answer the question posted; especially since the OP may actually have a use case for replacing various arbitrary values with their zero value equivalent (which is not entirely unheard of)"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 20, "last_activity_date": 1546711260, "last_edit_date": 1546711260, "creation_date": 1426864001, "answer_id": 29169727, "question_id": 29168905, "link": "https://stackoverflow.com/questions/29168905/how-to-clear-values-of-a-instance-of-a-type-struct-dynamically/29169727#29169727", "title": "How to clear values of a instance of a type struct dynamically", "body": "<p>You can't modify the original values without passing a pointer to them.</p>\n\n<p>It's much easier and more clear to simply assign a new zero value in your code. If your types are more complex, you can replace the values with a constructor, or provide <code>Reset()</code> methods for your types with a pointer receiver.</p>\n\n<p>If you really want to see how to do it via reflection your <code>clear</code> function could look like: <a href=\"http://play.golang.org/p/g0zIzQA06b\" rel=\"nofollow noreferrer\">http://play.golang.org/p/g0zIzQA06b</a></p>\n\n<pre><code>func clear(v interface{}) {\n    p := reflect.ValueOf(v).Elem()\n    p.Set(reflect.Zero(p.Type()))\n}\n</code></pre>\n\n<p>(This will panic if you pass in a non-pointer value)</p>\n"}, {"comments": [{"owner": {"reputation": 814, "user_id": 3184418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae21c7b12b1eb257035947327ff6d441?s=128&d=identicon&r=PG&f=1", "display_name": "siddhantsomani", "link": "https://stackoverflow.com/users/3184418/siddhantsomani"}, "edited": false, "score": 0, "creation_date": 1538171573, "post_id": 51006888, "comment_id": 92064604, "body": "Is this recommended?"}, {"owner": {"reputation": 867, "user_id": 6531129, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3741d495ced91c057769a904b8ee6c26?s=128&d=identicon&r=PG&f=1", "display_name": "AESTHETICS", "link": "https://stackoverflow.com/users/6531129/aesthetics"}, "reply_to_user": {"reputation": 814, "user_id": 3184418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae21c7b12b1eb257035947327ff6d441?s=128&d=identicon&r=PG&f=1", "display_name": "siddhantsomani", "link": "https://stackoverflow.com/users/3184418/siddhantsomani"}, "edited": false, "score": 0, "creation_date": 1538292747, "post_id": 51006888, "comment_id": 92086827, "body": "I have seen it done in multiple languages and it works. No reason not to use it. It\u2019s just like reassigning the value of the object."}, {"owner": {"reputation": 4657, "user_id": 102699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81df87e0d3e269d6fa6a17c6914fd656?s=128&d=identicon&r=PG", "display_name": "MikeSchinkel", "link": "https://stackoverflow.com/users/102699/mikeschinkel"}, "edited": false, "score": 0, "creation_date": 1546590201, "post_id": 51006888, "comment_id": 94905982, "body": "This approach does a new allocation, and if your goal is to reuse objects in order to minimize allocations in programs that create a lot of objects quickly and the throws them away this won&#39;t help."}, {"owner": {"reputation": 867, "user_id": 6531129, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3741d495ced91c057769a904b8ee6c26?s=128&d=identicon&r=PG&f=1", "display_name": "AESTHETICS", "link": "https://stackoverflow.com/users/6531129/aesthetics"}, "reply_to_user": {"reputation": 4657, "user_id": 102699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81df87e0d3e269d6fa6a17c6914fd656?s=128&d=identicon&r=PG", "display_name": "MikeSchinkel", "link": "https://stackoverflow.com/users/102699/mikeschinkel"}, "edited": false, "score": 0, "creation_date": 1546683183, "post_id": 51006888, "comment_id": 94936377, "body": "@MikeSchinkel where did you get this idea? It\u2019s not true. It\u2019s still the same object with different value."}, {"owner": {"reputation": 4657, "user_id": 102699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81df87e0d3e269d6fa6a17c6914fd656?s=128&d=identicon&r=PG", "display_name": "MikeSchinkel", "link": "https://stackoverflow.com/users/102699/mikeschinkel"}, "edited": false, "score": 2, "creation_date": 1546708713, "post_id": 51006888, "comment_id": 94942900, "body": "Let&#39;s be more precise than the term &quot;object,&quot; and I&#39;ll just talk about <code>A</code> since the same will apply to <code>B</code>.  We have 1.) the <b>variable</b> <code>A</code>, 2.) the <b>memory</b> that stores <code>{&quot;Momo&quot;, 1}</code> and and <code>{ , 0}</code>, and 3.) the <b>address</b> of the memory that stores  <code>{&quot;Momo&quot;, 1}</code> and <code>{ , 0}</code>.  You are correct that it will still be <i>variable</i> <code>A</code>, but incorrect in that the <i>address</i> to the difference values in memory will be the same. When you call <code>A{}</code> it allocates new memory and assigns a that address to <code>A</code> while making the memory <code>{&quot;Momo&quot;, 1}</code> available to the garbage collector."}, {"owner": {"reputation": 4657, "user_id": 102699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81df87e0d3e269d6fa6a17c6914fd656?s=128&d=identicon&r=PG", "display_name": "MikeSchinkel", "link": "https://stackoverflow.com/users/102699/mikeschinkel"}, "edited": false, "score": 0, "creation_date": 1546709209, "post_id": 51006888, "comment_id": 94943003, "body": "You can see what I am referring to in this <a href=\"https://play.golang.org/p/IES0jjD2Qrb\" rel=\"nofollow noreferrer\">Go playground link</a>."}, {"owner": {"reputation": 867, "user_id": 6531129, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3741d495ced91c057769a904b8ee6c26?s=128&d=identicon&r=PG&f=1", "display_name": "AESTHETICS", "link": "https://stackoverflow.com/users/6531129/aesthetics"}, "edited": false, "score": 0, "creation_date": 1546763580, "post_id": 51006888, "comment_id": 94953207, "body": "Nice Pepega, you did not applied my example but yours with pointers to an object. Check this <a href=\"https://play.golang.org/p/w_mrVKB2rMQ\" rel=\"nofollow noreferrer\">play.golang.org/p/w_mrVKB2rMQ</a>"}], "tags": [], "owner": {"reputation": 867, "user_id": 6531129, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3741d495ced91c057769a904b8ee6c26?s=128&d=identicon&r=PG&f=1", "display_name": "AESTHETICS", "link": "https://stackoverflow.com/users/6531129/aesthetics"}, "is_accepted": false, "score": 1, "last_activity_date": 1529813497, "creation_date": 1529813497, "answer_id": 51006888, "question_id": 29168905, "link": "https://stackoverflow.com/questions/29168905/how-to-clear-values-of-a-instance-of-a-type-struct-dynamically/51006888#51006888", "title": "How to clear values of a instance of a type struct dynamically", "body": "<p>It's possible to reassign the value with an empty object of the struct which will reset the values.</p>\n\n<pre><code>a := A{\"Momo\", 1}\nb := B{\"Starfall\"}\n\nfmt.Println(a)\nfmt.Println(b)\n// outputs\n// {\"Momo\", 1}\n// {\"Starfall\"}\n\na = A{}\nb = B{}\n// outputs\n// { , 0}\n// { }\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/CJ6cx2TFytY\" rel=\"nofollow noreferrer\">https://play.golang.org/p/CJ6cx2TFytY</a></p>\n"}, {"tags": [], "owner": {"reputation": 4657, "user_id": 102699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81df87e0d3e269d6fa6a17c6914fd656?s=128&d=identicon&r=PG", "display_name": "MikeSchinkel", "link": "https://stackoverflow.com/users/102699/mikeschinkel"}, "is_accepted": false, "score": 4, "last_activity_date": 1546711177, "creation_date": 1546711177, "answer_id": 54054696, "question_id": 29168905, "link": "https://stackoverflow.com/questions/29168905/how-to-clear-values-of-a-instance-of-a-type-struct-dynamically/54054696#54054696", "title": "How to clear values of a instance of a type struct dynamically", "body": "<p>Even though this question was first asked 3 years and 9 months ago it IMO still does not have a good answer so let me propose one.</p>\n\n<p>There is no need for reflection, or to create a new instance each time you want to clear your variable. Instead create one pristine new instance that you leave in its initial zeroed state which you can then copy over your object's memory when you want to <code>Reset()</code> it. <em>(Hat tip to @DaveC for pointing out that a <code>Reset()</code> method is more idiomatic.)</em></p>\n\n<p>You simply copy from your zeroed value to the location at which your object points to using pointers. The following reads <em>\"Copy the <strong>value</strong> of the memory that <code>zeroA</code> references to the <strong>memory location</strong> that <code>a</code> references.\":</em> </p>\n\n<pre><code>*a = *zeroA\n</code></pre>\n\n<p>Here is my full example which you can also try in <a href=\"https://play.golang.org/p/HJax8mDJT4W\" rel=\"nofollow noreferrer\">the Go Playground</a>. <em>(Note that since your <a href=\"https://tour.golang.org/methods/4\" rel=\"nofollow noreferrer\">receiver</a> for <code>Reset()</code> is a pointer to type <code>A</code> then calling the <code>Reset()</code> method allows you to update the value of <code>a</code> where the update survives past the end of the method call):</em></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype A struct {\n    Name string\n    Level int\n}\nvar zeroA = &amp;A{}\nfunc (a *A) Reset() {\n    *a = *zeroA\n}\n\nfunc main() {\n    a1 := A{\"Momo\", 1}\n    a2 := &amp;a1\n    a3 := a1\n\n    fmt.Println(a1)\n    fmt.Println(a2)\n    fmt.Println(a3)\n\n    a1.Reset()\n\n    fmt.Println(a1)\n    fmt.Println(a2)\n    fmt.Println(a3)\n}\n</code></pre>\n\n<p>And here is your output <em>(Note that I prove that your variable is zeroed out and a pointer to that variable is also zeroed, but if you made a *copy* of the original it is not zeroed):</em></p>\n\n<pre><code>{Momo 1}\n&amp;{Momo 1}\n{Momo 1}\n{ 0}\n&amp;{ 0}\n{Momo 1}    \n</code></pre>\n\n<p>You can also use this technique to copy over the values of a struct that contains default values. <em>However</em> be aware that this is a <strong>shallow copy</strong>, not a deep copy. If your <code>struct</code> contains any properties that are pointers this approach  will copy the pointer values over too and will not allocate memory to point to new copies of the values pointed to. So you will need to do extra work in <code>Reset()</code> if you want to reset your struct to new defaults, including copies of any sub-structs that are declared with pointers.</p>\n\n<p>I hope this helps others so they do not have to learn this the hard way like it took me.</p>\n"}, {"tags": [], "owner": {"reputation": 1370, "user_id": 7824245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-0l2xVxKv9gc/AAAAAAAAAAI/AAAAAAAAABo/GSjROchHomI/photo.jpg?sz=128", "display_name": "Floating Sunfish", "link": "https://stackoverflow.com/users/7824245/floating-sunfish"}, "is_accepted": false, "score": 0, "last_activity_date": 1568721147, "creation_date": 1568721147, "answer_id": 57973648, "question_id": 29168905, "link": "https://stackoverflow.com/questions/29168905/how-to-clear-values-of-a-instance-of-a-type-struct-dynamically/57973648#57973648", "title": "How to clear values of a instance of a type struct dynamically", "body": "<p>You can just set it to an empty struct like so:</p>\n\n<pre><code>var obj myStruct\nobj.field1 = \"apple\"\nobj.field2 = 12\n\n// Reset struct.\nobj = myStruct{}\n</code></pre>\n\n<p>Playground link: <a href=\"https://play.golang.org/p/Rf1BqfFe3IQ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Rf1BqfFe3IQ</a></p>\n"}], "owner": {"reputation": 521, "user_id": 3416153, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d57673c14a704d4e06dcac38fd65fd66?s=128&d=identicon&r=PG&f=1", "display_name": "javinc", "link": "https://stackoverflow.com/users/3416153/javinc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15419, "favorite_count": 4, "accepted_answer_id": 29169727, "answer_count": 4, "score": 15, "last_activity_date": 1571237132, "creation_date": 1426861696, "last_edit_date": 1571237132, "question_id": 29168905, "link": "https://stackoverflow.com/questions/29168905/how-to-clear-values-of-a-instance-of-a-type-struct-dynamically", "title": "How to clear values of a instance of a type struct dynamically", "body": "<p>Is it possible with Go to make a method that dynamically clears the values of a instance of a struct?</p>\n\n<pre><code>type A struct {\n    Name string\n    Level int\n}\n\ntype B struct {\n    Skill string\n}\n\nfunc main() {\n    a := A{\"Momo\", 1}\n    b := B{\"Starfall\"}\n\n    // outputs\n    // {\"Momo\", 1}\n    // {\"Starfall\"}\n\n    clear(a)\n    clear(b)\n\n    // outputs\n    // { , 0}\n    // { }\n}\n\nfunc clear(v interface{}) {\n    // some code\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "edited": false, "score": 0, "creation_date": 1426864836, "post_id": 29169486, "comment_id": 46558236, "body": "Wow !! So many programmers would be affected by this mistake in the documentation ! Thank You :)"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1426863864, "last_edit_date": 1426863864, "creation_date": 1426863325, "answer_id": 29169486, "question_id": 29168848, "link": "https://stackoverflow.com/questions/29168848/c-infof-undefined-type-context-context-has-no-field-or-method-infof-google-gol/29169486#29169486", "title": "c.Infof undefined (type context.Context has no field or method Infof) google.golang.org/appengine/log error", "body": "<p>The example in the package documentation is not correct.</p>\n\n<p>Use the <a href=\"https://godoc.org/google.golang.org/appengine/log\" rel=\"nofollow\">log</a> package functions to write to the App Engine log.  Here's the corrected example:</p>\n\n<pre><code>c := appengine.NewContext(r)\nquery := &amp;log.Query{\n    AppLogs:  true,\n    Versions: []string{\"1\"},\n}\n\nfor results := query.Run(c); ; {\n    record, err := results.Next()\n    if err == log.Done {\n       log.Infof(c, \"Done processing results\")\n       break\n    }\n    if err != nil {\n        log.Errorf(c, \"Failed to retrieve next log: %v\", err)\n        break\n    }\n    log.Infof(c, \"Saw record %v\", record)\n}\n</code></pre>\n\n<p>The example in the package documentation was copied from the App Engine Classic package, but not updated to use the new functions. I suggest reporting this to the App Engine Team.</p>\n"}], "owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1152, "favorite_count": 2, "accepted_answer_id": 29169486, "answer_count": 1, "score": 1, "last_activity_date": 1426863864, "creation_date": 1426861531, "question_id": 29168848, "link": "https://stackoverflow.com/questions/29168848/c-infof-undefined-type-context-context-has-no-field-or-method-infof-google-gol", "title": "c.Infof undefined (type context.Context has no field or method Infof) google.golang.org/appengine/log error", "body": "<p>In the Go Runtime  i used the method c.Infof to log messages , but it fails to compile with the following error \n<strong><em>c.Infof undefined (type context.Context has no field or method Infof)</em></strong> .\nThe Error clearly tells that the app engine context returned from <strong><em>c := appengine.NewContext(r)</em></strong> is of type <strong><em>context.Context</em></strong> and it doesnt have a method <strong><em>c.Infof</em></strong> on it. But contrary to this the documentation in <a href=\"https://godoc.org/google.golang.org/appengine/log\" rel=\"nofollow\">https://godoc.org/google.golang.org/appengine/log</a> suggests that this method exists . Another point to note , The method existed on the context returned by \"appengine\" (import \"appengine\" ) package , and this doesnt seem to exist on the context returned by the new package <strong><em>google.golang.org/appengine</em></strong> , what is <strong><em>c.Infof</em></strong> equivalent on the new Context of type context.Context returned by package <strong><em>\"google.golang.org/appengine\"</em></strong> ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "edited": false, "score": 2, "creation_date": 1426852975, "post_id": 29165973, "comment_id": 46550705, "body": "Please post an example of the hash table you want to encode."}, {"owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "reply_to_user": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "edited": false, "score": 0, "creation_date": 1426853457, "post_id": 29165973, "comment_id": 46550931, "body": "I have edited the question with the hash table which i want to encode"}], "answers": [{"tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 2, "last_activity_date": 1426854198, "creation_date": 1426854198, "answer_id": 29166419, "question_id": 29165973, "link": "https://stackoverflow.com/questions/29165973/golang-converting-hash-table-to-json/29166419#29166419", "title": "Golang converting hash table to JSON", "body": "<p>Like that</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    data := make(map[string]string)\n    data[\"a\"] = \"b\"\n    data[\"c\"] = \"d\"\n    bytes, err := json.Marshal(data)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    text := string(bytes)\n    fmt.Println(text)\n}\n</code></pre>\n\n<p><kbd><a href=\"https://play.golang.org/p/57alCUCuOq\" rel=\"nofollow\">Playground</a></kbd></p>\n"}], "owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1276, "favorite_count": 0, "accepted_answer_id": 29166419, "answer_count": 1, "score": 1, "last_activity_date": 1426854198, "creation_date": 1426852645, "last_edit_date": 1426853433, "question_id": 29165973, "link": "https://stackoverflow.com/questions/29165973/golang-converting-hash-table-to-json", "title": "Golang converting hash table to JSON", "body": "<p>How to convert a Hashtable into JSON in GoLang ? I want to convert a hash table  into a JSON to be able to send it as POST request payload </p>\n\n<pre><code>data := make(map[string]string)\ndata[\"a\"] = \"b\"\ndata[\"c\"] = \"d\"\n</code></pre>\n\n<p>How do i convert this to JSON ?</p>\n"}, {"tags": ["json", "go", "decoding"], "answers": [{"comments": [{"owner": {"reputation": 7262, "user_id": 1120530, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/e3ceb36b9980348b4062af73b7ca7dc9?s=128&d=identicon&r=PG", "display_name": "brg", "link": "https://stackoverflow.com/users/1120530/brg"}, "edited": false, "score": 0, "creation_date": 1426849570, "post_id": 29165012, "comment_id": 46548894, "body": "Will this work if I fetch the content reading any json file with above json?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7262, "user_id": 1120530, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/e3ceb36b9980348b4062af73b7ca7dc9?s=128&d=identicon&r=PG", "display_name": "brg", "link": "https://stackoverflow.com/users/1120530/brg"}, "edited": false, "score": 0, "creation_date": 1426849632, "post_id": 29165012, "comment_id": 46548927, "body": "@ram It doesn&#39;t matter where the JSON is coming from. But if your input JSON is not an array, then don&#39;t try to parse an array (slice) out of it, just one <code>ShaInfo</code>."}, {"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 0, "creation_date": 1426849652, "post_id": 29165012, "comment_id": 46548934, "body": "Either this, or change the definition of <code>data</code> to <code>ShaInfo</code> rather than <code>[]ShaInfo</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1426849716, "last_edit_date": 1426849716, "creation_date": 1426849390, "answer_id": 29165012, "question_id": 29164967, "link": "https://stackoverflow.com/questions/29164967/unable-to-parse-json-array-in-golang/29165012#29165012", "title": "Unable to parse JSON array in Golang", "body": "<p>This is your original JSON input:</p>\n\n<pre><code>content := `{\"ShaId\": \"adf56a4d\", \"Regions\": [{\"Name\": \"us-east-1a\"}]}`\n</code></pre>\n\n<p>It is not an array, change it to:</p>\n\n<pre><code>content := `[{\"ShaId\": \"adf56a4d\", \"Regions\": [{\"Name\": \"us-east-1a\"}]}]`\n</code></pre>\n\n<p>With this, the result:</p>\n\n<pre><code>Results: []main.ShaInfo{main.ShaInfo{ShaId:\"adf56a4d\",\n                Regions:main.Region{struct { Name string }{Name:\"us-east-1a\"}}}}\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>If you input is not an array, then don't try to parse an array (slice) out of it, just one <code>ShaInfo</code>. This also works if you don't/can't modify the input:</p>\n\n<pre><code>var data ShaInfo\ncontent := `{\"ShaId\": \"adf56a4d\", \"Regions\": [{\"Name\": \"us-east-1a\"}]}`\njson.Unmarshal([]byte(content), &amp;data)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Results: main.ShaInfo{ShaId:\"adf56a4d\",\n              Regions:main.Region{struct { Name string }{Name:\"us-east-1a\"}}}\n</code></pre>\n"}], "owner": {"reputation": 7262, "user_id": 1120530, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/e3ceb36b9980348b4062af73b7ca7dc9?s=128&d=identicon&r=PG", "display_name": "brg", "link": "https://stackoverflow.com/users/1120530/brg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 29165012, "answer_count": 1, "score": 0, "last_activity_date": 1426849716, "creation_date": 1426849240, "question_id": 29164967, "link": "https://stackoverflow.com/questions/29164967/unable-to-parse-json-array-in-golang", "title": "Unable to parse JSON array in Golang", "body": "<p>I am having hard time parsing following JSON array.</p>\n\n<pre><code>// JSON Array\n[      \n  {\n    \"ShaId\": \"adf56a4d\",\n    \"Regions\": [\n      {\n        \"Name\": \"us-east-1a\"\n      }\n    ]\n  }\n .... more such\n]     \n</code></pre>\n\n<p>Link to Go Playground :- <a href=\"https://play.golang.org/p/D4VrX3uoE8\" rel=\"nofollow\">https://play.golang.org/p/D4VrX3uoE8</a></p>\n\n<p>Where am I making mistake?</p>\n"}, {"tags": ["arrays", "go", "slice"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1426874780, "post_id": 29164375, "comment_id": 46564124, "body": "You say &quot;non-fixed size&quot;, but slices are <i>never</i> have a fixed size. Unless you mean with zero capacity. Note, if you have an idea/guess/hint of what capacity you might need then using the three argument version is good. E.g. to build a slice of map keys: <code>keys := make([]int, 0, len(m)); for k, v := range m { keys := append(keys,k) }</code>"}, {"owner": {"reputation": 16038, "user_id": 3075942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de479917d8d7ad4b708741f8efd4de01?s=128&d=identicon&r=PG&f=1", "display_name": "user", "link": "https://stackoverflow.com/users/3075942/user"}, "edited": false, "score": 1, "creation_date": 1448064499, "post_id": 29164375, "comment_id": 55441523, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/25543520/declare-slice-or-make-slice\">Declare slice or make slice?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 78, "last_activity_date": 1550830681, "last_edit_date": 1550830681, "creation_date": 1426847834, "answer_id": 29164546, "question_id": 29164375, "link": "https://stackoverflow.com/questions/29164375/correct-way-to-initialize-empty-slice/29164546#29164546", "title": "Correct way to initialize empty slice", "body": "<p>They are equivalent. See this code:</p>\n\n<pre><code>mySlice1 := make([]int, 0)\nmySlice2 := []int{}\nfmt.Println(\"mySlice1\", cap(mySlice1))\nfmt.Println(\"mySlice2\", cap(mySlice2))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>mySlice1 0\nmySlice2 0\n</code></pre>\n\n<p>Both slices have <code>0</code> capacity which implies both slices have <code>0</code> length (cannot be greater than the capacity) which implies both slices have no elements. This means the 2 slices are identical in every aspect.</p>\n\n<p>See similar questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/49104157/what-is-the-point-of-having-nil-slice-and-empty-slice-in-golang\">What is the point of having nil slice and empty slice in golang?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/44305170/nil-slices-vs-non-nil-slices-vs-empty-slices-in-go-language/44305910#44305910\">nil slices vs non-nil slices vs empty slices in Go language</a></p>\n"}, {"comments": [{"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 4, "creation_date": 1426848614, "post_id": 29164565, "comment_id": 46548442, "body": "Also mention on wiki <a href=\"https://github.com/golang/go/wiki/CodeReviewComments#declaring-empty-slices\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/&hellip;</a>"}, {"owner": {"reputation": 3212, "user_id": 2175114, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4b54c37154aeed8d946535e13f6423c2?s=128&d=identicon&r=PG", "display_name": "farwayer", "link": "https://stackoverflow.com/users/2175114/farwayer"}, "edited": false, "score": 114, "creation_date": 1499817129, "post_id": 29164565, "comment_id": 77066538, "body": "Be care: <code>json.Marshal()</code> will return <code>null</code> for <code>var myslice []int</code> and <code>[]</code> for initialized slice <code>myslice := []int{}</code>"}, {"owner": {"reputation": 157, "user_id": 1311538, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1dc49f99b84275d3364164127bf190d?s=128&d=identicon&r=PG", "display_name": "asgaines", "link": "https://stackoverflow.com/users/1311538/asgaines"}, "edited": false, "score": 11, "creation_date": 1528903525, "post_id": 29164565, "comment_id": 88685506, "body": "Also be careful: <code>reflect.DeepEqual</code> makes a distinction between nil slices and non-nil slices: <code>a := []int{}</code>, <code>var b []int</code>, <code>reflect.DeepEqual(a, b) &#47;&#47; returns false</code>"}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 1, "creation_date": 1587478213, "post_id": 29164565, "comment_id": 108523372, "body": "Why you think it would do an allocation? Cap is zero so nothing is allocated. All pointers to zero length things point to the same location in memory: <a href=\"https://play.golang.org/p/MPOKKl_sYvw\" rel=\"nofollow noreferrer\">play.golang.org/p/MPOKKl_sYvw</a>"}, {"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "reply_to_user": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 1, "creation_date": 1587483745, "post_id": 29164565, "comment_id": 108526793, "body": "@ArmanOrdookhani You are correct. I tried it out, and I also found out that I was wrong with my assumption on identical assembly instructions. Fixed!"}], "tags": [], "owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "is_accepted": true, "score": 322, "last_activity_date": 1587483594, "last_edit_date": 1587483594, "creation_date": 1426847880, "answer_id": 29164565, "question_id": 29164375, "link": "https://stackoverflow.com/questions/29164375/correct-way-to-initialize-empty-slice/29164565#29164565", "title": "Correct way to initialize empty slice", "body": "<p>The two alternative you gave are semantically identical, but using <code>make([]int, 0)</code> will result in an internal call to <em>runtime.makeslice</em> (Go 1.14).</p>\n\n<p>You also have the option to leave it with a <code>nil</code> value:</p>\n\n<pre><code>var myslice []int\n</code></pre>\n\n<p>As written in the <a href=\"http://blog.golang.org/slices\" rel=\"noreferrer\">Golang.org blog</a>:</p>\n\n<blockquote>\n  <p>a nil slice is functionally equivalent to a zero-length slice, even though it points to nothing. It has length zero and can be appended to, with allocation.</p>\n</blockquote>\n\n<p>A <code>nil</code> slice will however <code>json.Marshal()</code> into <code>\"null\"</code> whereas an empty slice will marshal into <code>\"[]\"</code>, as pointed out by  @farwayer.</p>\n\n<p>None of the above options will cause any allocation, as pointed out by @ArmanOrdookhani.</p>\n"}, {"comments": [{"owner": {"reputation": 8461, "user_id": 1366465, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4dc40044c49dfa91cf52a3f1ea6858a7?s=128&d=identicon&r=PG", "display_name": "Andrzej Rehmann", "link": "https://stackoverflow.com/users/1366465/andrzej-rehmann"}, "edited": false, "score": 1, "creation_date": 1545755345, "post_id": 42917145, "comment_id": 94689617, "body": "<code>make([]int, 0)</code> is the best because Jetbrains GoLand does not complain about it being &quot;unnecessary&quot; as it does in the case of <code>[]int{}</code>. This is useful in writing unit tests."}], "tags": [], "owner": {"reputation": 181, "user_id": 6754699, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vWhgg.png?s=128&g=1", "display_name": "Joe.CK", "link": "https://stackoverflow.com/users/6754699/joe-ck"}, "is_accepted": false, "score": 17, "last_activity_date": 1502293429, "last_edit_date": 1502293429, "creation_date": 1490061875, "answer_id": 42917145, "question_id": 29164375, "link": "https://stackoverflow.com/questions/29164375/correct-way-to-initialize-empty-slice/42917145#42917145", "title": "Correct way to initialize empty slice", "body": "<p>Empty slice and nil slice are initialized differently in Go:</p>\n\n<pre><code>var nilSlice []int \nemptySlice1 := make([]int, 0)\nemptySlice2 := []int{}\n\nfmt.Println(nilSlice == nil)    // true\nfmt.Println(emptySlice1 == nil) // false\nfmt.Println(emptySlice2 == nil) // false\n</code></pre>\n\n<p>As for all three slices, len and cap are 0.</p>\n"}, {"comments": [{"owner": {"reputation": 2251, "user_id": 5238892, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b27ed4cd2a119f7efeaad687f11403cb?s=128&d=identicon&r=PG&f=1", "display_name": "Simin Jie", "link": "https://stackoverflow.com/users/5238892/simin-jie"}, "edited": false, "score": 0, "creation_date": 1531744995, "post_id": 45997533, "comment_id": 89696337, "body": "Can we get the address of empty slice in one step using <code>make</code>?"}, {"owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "reply_to_user": {"reputation": 2251, "user_id": 5238892, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b27ed4cd2a119f7efeaad687f11403cb?s=128&d=identicon&r=PG&f=1", "display_name": "Simin Jie", "link": "https://stackoverflow.com/users/5238892/simin-jie"}, "edited": false, "score": 0, "creation_date": 1531746371, "post_id": 45997533, "comment_id": 89697217, "body": "If we take a look at the function <a href=\"https://golang.org/pkg/builtin/#make\" rel=\"nofollow noreferrer\">signature</a>, <code>make</code> doesn&#39;t seem to return the address. I believe you can&#39;t do it in one step."}], "tags": [], "owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "is_accepted": false, "score": 52, "last_activity_date": 1504778922, "last_edit_date": 1504778922, "creation_date": 1504259411, "answer_id": 45997533, "question_id": 29164375, "link": "https://stackoverflow.com/questions/29164375/correct-way-to-initialize-empty-slice/45997533#45997533", "title": "Correct way to initialize empty slice", "body": "<p>As an addition to <a href=\"https://stackoverflow.com/users/694331/anisus\">@ANisus'</a> answer...</p>\n\n<p>below is some information from the <em>\"Go in action\"</em> book, which I think is worth mentioning:</p>\n\n<h2>Difference between <code>nil</code> &amp; <code>empty</code> slices</h2>\n\n<p>If we think of a slice like this:</p>\n\n<pre><code>[pointer] [length] [capacity]\n</code></pre>\n\n<p>then:</p>\n\n<pre><code>nil slice:   [nil][0][0]\nempty slice: [addr][0][0] // points to an address\n</code></pre>\n\n<blockquote>\n  <h3>nil slice</h3>\n  \n  <p>They\u2019re useful when you want to represent a slice that doesn\u2019t exist, such as when an exception occurs in a function that returns a slice.</p>\n\n<pre><code>// Create a nil slice of integers.\nvar slice []int\n</code></pre>\n  \n  <h3>empty slice</h3>\n  \n  <p>Empty slices are useful when you want to represent an empty collection, such as when a database query returns zero results.</p>\n\n<pre><code>// Use make to create an empty slice of integers.\nslice := make([]int, 0)\n\n// Use a slice literal to create an empty slice of integers.\nslice := []int{}\n</code></pre>\n  \n  <p>Regardless of whether you\u2019re using a nil slice or an empty slice, the built-in functions <code>append</code>, <code>len</code>, and <code>cap</code> work the same.</p>\n</blockquote>\n\n<hr>\n\n<p><a href=\"https://play.golang.org/p/5bjyfO5OmB\" rel=\"noreferrer\">Go playground example</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\n    var nil_slice []int\n    var empty_slice = []int{}\n\n    fmt.Println(nil_slice == nil, len(nil_slice), cap(nil_slice))\n    fmt.Println(empty_slice == nil, len(empty_slice), cap(empty_slice))\n\n}\n</code></pre>\n\n<p>prints:</p>\n\n<pre><code>true 0 0\nfalse 0 0\n</code></pre>\n"}], "owner": {"reputation": 3857, "user_id": 698329, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/u4NRK.jpg?s=128&g=1", "display_name": "eouti", "link": "https://stackoverflow.com/users/698329/eouti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257138, "favorite_count": 47, "accepted_answer_id": 29164565, "answer_count": 4, "score": 268, "last_activity_date": 1587483594, "creation_date": 1426847276, "last_edit_date": 1532095433, "question_id": 29164375, "link": "https://stackoverflow.com/questions/29164375/correct-way-to-initialize-empty-slice", "title": "Correct way to initialize empty slice", "body": "<p>To declare an empty slice, with a non-fixed size,\nis it better to do:</p>\n\n<pre><code>mySlice1 := make([]int, 0)\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>mySlice2 := []int{}\n</code></pre>\n\n<p>Just wondering which one is the correct way.  </p>\n"}, {"tags": ["performance", "google-app-engine", "go"], "comments": [{"owner": {"reputation": 327, "user_id": 2685221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5472dd7bfa40b60cb7bd8b57cd51ddde?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Morewood", "link": "https://stackoverflow.com/users/2685221/robert-morewood"}, "edited": false, "score": 0, "creation_date": 1426844111, "post_id": 29162961, "comment_id": 46545948, "body": "On re-reading the docs I find: &quot;if one request is, say, waiting for a datastore API call, another request may be processed by the same instance.&quot; - but that doesn&#39;t explain why it sometimes takes 20 seconds to print the log entry on the first line of the request handler."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1426845385, "post_id": 29162961, "comment_id": 46546642, "body": "Are your test results from a production environment? What version of the SDK are you using?"}, {"owner": {"reputation": 12677, "user_id": 220710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0e3616fa71abd6c30910910d4d439470?s=128&d=identicon&r=PG", "display_name": "Emil Davtyan", "link": "https://stackoverflow.com/users/220710/emil-davtyan"}, "edited": false, "score": 0, "creation_date": 1426860641, "post_id": 29162961, "comment_id": 46555387, "body": "Try setting <code>GOMAXPROCS</code> to something other than 1."}, {"owner": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1426860763, "post_id": 29162961, "comment_id": 46555453, "body": "It&#39;s hard to comment on performance without knowing what your code is doing, but does this happen only on the loading request or all requests?  Have you tried <a href=\"https://cloud.google.com/tools/cloud-trace\" rel=\"nofollow noreferrer\">Cloud Trace</a>?"}, {"owner": {"reputation": 8978, "user_id": 1351600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2noZs.jpg?s=128&g=1", "display_name": "Paul Collingwood", "link": "https://stackoverflow.com/users/1351600/paul-collingwood"}, "edited": false, "score": 0, "creation_date": 1426934828, "post_id": 29162961, "comment_id": 46579857, "body": "At a tangent, but perhaps do the resizing outside of your app by using get_serving_url with the desired size appended to the request, instead of doing it your app?"}, {"owner": {"reputation": 327, "user_id": 2685221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5472dd7bfa40b60cb7bd8b57cd51ddde?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Morewood", "link": "https://stackoverflow.com/users/2685221/robert-morewood"}, "reply_to_user": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1426953933, "post_id": 29162961, "comment_id": 46585294, "body": "@tx802  Loading requests run instantly, very little initialization.  The problem is concurrent requests in the same (running) instance.  The internal multi-tasking seems to be failing and requests are blocking each other.  No problem with concurrent requests in different instances (I&#39;ve tried manually created a huge number of instances so that the odds favour different instances).  I&#39;d like to prevent requests being loaded into instances which are already serving requests - use instances which are not currently serving or, if necessary, automatically create new ones.  How does one set that up?"}, {"owner": {"reputation": 327, "user_id": 2685221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5472dd7bfa40b60cb7bd8b57cd51ddde?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Morewood", "link": "https://stackoverflow.com/users/2685221/robert-morewood"}, "reply_to_user": {"reputation": 8978, "user_id": 1351600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2noZs.jpg?s=128&g=1", "display_name": "Paul Collingwood", "link": "https://stackoverflow.com/users/1351600/paul-collingwood"}, "edited": false, "score": 0, "creation_date": 1426956786, "post_id": 29162961, "comment_id": 46586169, "body": "@Paul Collingwood  Thanks for the suggestion.  According to the documentation: <a href=\"https://cloud.google.com/appengine/docs/go/images/reference\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/go/images/reference</a> &quot;get_serving_url&quot; is severly limited in the manipulations it will perform.  Although a quick peak at source <a href=\"https://github.com/golang/appengine/blob/master/internal/image/images_service.pb.go\" rel=\"nofollow noreferrer\">github.com/golang/appengine/blob/master/internal/image/&hellip;</a> suggests greater flexibility is possible... On the other hand, I think I resent the implication that appengine programs cannot do things for themselves, just call google services to do the real work."}, {"owner": {"reputation": 8978, "user_id": 1351600, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2noZs.jpg?s=128&g=1", "display_name": "Paul Collingwood", "link": "https://stackoverflow.com/users/1351600/paul-collingwood"}, "edited": false, "score": 0, "creation_date": 1426958841, "post_id": 29162961, "comment_id": 46586814, "body": "I think it depends. If I expect requests to do significant work immediately I&#39;d be inclined to shuffle them off to a more powerful backend instance with a task queue and return/update when ready, rather than process there and then and eventually return. The CPU etc is configurable - have you tried upping the power of your default instance? At default it&#39;s quite low.  I don&#39;t see it worthwhile attempting to do computationally intensive things on those low powered instances., at least not very often. Perhaps you want to pass these custom resize tasks off to a Compute VM instance instead?"}], "owner": {"reputation": 327, "user_id": 2685221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5472dd7bfa40b60cb7bd8b57cd51ddde?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Morewood", "link": "https://stackoverflow.com/users/2685221/robert-morewood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1426953169, "creation_date": 1426842560, "last_edit_date": 1426953169, "question_id": 29162961, "link": "https://stackoverflow.com/questions/29162961/golang-app-engine-performance-parameters", "title": "Golang app-engine performance parameters", "body": "<p>Using stock out-of-the-box configuration on a golang app-engine project, I am getting very disappointing performance.  Any hints on what I might be missing?  How should a golang google app be optimized?</p>\n\n<p>Sending a few dozen requests, not more than six concurrently, I find only one instance handling all the requests, up to six requests concurrently (not sequentially) on that one instance - where I expected to see up to six instances.  Possibly as a result, things seem to be blocking.  I am seeing many timeouts, even on administrative functions like blobstore.Create(), which didn't happen when requests were being sent and processed individually.</p>\n\n<p>EDIT1:  These three lines\n<div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>context.Infof(\"Sending request to blobstore to create %s as %s\", Name, MimeType)\r\nblobWriter, err := blobstore.Create(context, MimeType)\r\nif err!=nil {\r\n\tcontext.Warningf(\"Unable to access content store: %v\",err)\r\n}</code></pre>\r\n</div>\r\n</div>\r\n\nare producing:</p>\n\n<blockquote>\n<pre><code>I 12:47:36.201 Sending request to blobstore to create download.jpg as application/octet-stream\nW 12:47:41.251 Unable to access content store: Canceled: Deadline exceeded (timeout)\n</code></pre>\n</blockquote>\n\n<p>On failure here it is always about five seconds in blobstore.Create (a few milliseconds when it passes).  Timeouts also occur in blobstore.Write and blobstore.Close and datastore, but with 20 to 30 second delays.\n--End EDIT1.</p>\n\n<p>There also seem to be performance issues.  There is one computationally intensive bit, taking nearly a second to complete on my home machine (at 1.7GHz).  According to the logged time stamps, that same code running on the remote app-engine (at 600MHz) is taking over 30 seconds on average, with a maximum of 109 seconds.  That doesn't seem right!</p>\n\n<p>EDIT2:  The most computationally intensive bit used the resize function:\n<a href=\"https://code.google.com/p/appengine-go/source/browse/example/moustachio/resize/resize.go\" rel=\"nofollow\">https://code.google.com/p/appengine-go/source/browse/example/moustachio/resize/resize.go</a>\n(with the obvious bug fixes).  Not the most efficient resizer, but fast enough for now in a stand-along app.  However it runs an order of magnitude slower in appengine (either the local SDK version 1.9 or running on Google's servers).  Perhaps Google's version of the image library is slower?  Probably the library? - A recursive fibonacci computation runs inside appengine in the same time as outside (same order of magnitude as C code).\n--- End EDIT2</p>\n\n<p>Any hints on how to get google app performance more similar to a multi-threaded stand-along application?  So far these preliminary scaling experiments have been a miserable failure!</p>\n\n<p>UPDATE: Using runtime.GOMAXPROCS(6), for a maximum of 6 concurrent requests, made no measurable difference.  When using \"manual_scaling\" with more instances that requests was helpful, requests usually get assigned to different instances, but sometimes not - leading to problems.</p>\n\n<p>A partial solution:  Segregate computationally intensive requests on a separate module, running on separate instances, so that they do not block smaller more time-sensitive requests.  Next, break down larger functions into several smaller requests, so that several can run \"concurrently\" on the same instance without timing out?  (Make the client send several requests to do one job!)</p>\n\n<p>It would be much better if I could ask the appengine just to start new instances for each request when none are available.  Experimentally, starting a new instance is much cheaper than running two requests in slow motion on one instance.</p>\n"}, {"tags": ["search", "indexing", "go", "elasticsearch"], "answers": [{"comments": [{"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1426938976, "post_id": 29166181, "comment_id": 46580931, "body": "I am new to elasticsearch. I appreciate the help.  Could you tell me how can I change the index process?. So that it will be helpful to search a string matching with all fields in the JSON."}, {"owner": {"reputation": 5562, "user_id": 4170437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VO527.jpg?s=128&g=1", "display_name": "Olly Cruickshank", "link": "https://stackoverflow.com/users/4170437/olly-cruickshank"}, "reply_to_user": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "edited": false, "score": 0, "creation_date": 1427017267, "post_id": 29166181, "comment_id": 46599344, "body": "The first step is set up an analyser and then reference it in your mapping. There&#39;s a good introduction here - <a href=\"http://www.elastic.co/guide/en/elasticsearch/guide/current/analysis-intro.html\" rel=\"nofollow noreferrer\">elastic.co/guide/en/elasticsearch/guide/current/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5562, "user_id": 4170437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VO527.jpg?s=128&g=1", "display_name": "Olly Cruickshank", "link": "https://stackoverflow.com/users/4170437/olly-cruickshank"}, "is_accepted": true, "score": 2, "last_activity_date": 1426853379, "creation_date": 1426853379, "answer_id": 29166181, "question_id": 29161705, "link": "https://stackoverflow.com/questions/29161705/how-to-search-a-string-in-the-elasticsearch-documentindexed-in-golang/29166181#29166181", "title": "How to search a string in the elasticsearch document(indexed) in golang?", "body": "<p>How you search and find data depends on your analyser - from your code it's likely that the standard analyser is being used (i.e. you haven't specified an alternative in your mapping).</p>\n\n<p>The <a href=\"http://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-standard-analyzer.html\" rel=\"nofollow\">Standard Analyser</a> will only index complete words. So to match \"olive\" against \"olivere\" you could either: </p>\n\n<ol>\n<li>Change the search process</li>\n</ol>\n\n<p>e.g. switch from a term query to a <a href=\"http://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-prefix-query.html\" rel=\"nofollow\">Prefix query</a> or use a <a href=\"http://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html\" rel=\"nofollow\">Query String query</a> with a wildcard.</p>\n\n<ol start=\"2\">\n<li>Change the index process</li>\n</ol>\n\n<p>If you want to find strings within larger strings then look at using <a href=\"http://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-ngram-tokenizer.html\" rel=\"nofollow\">nGrams</a> or <a href=\"http://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-edgengram-tokenizer.html\" rel=\"nofollow\">Edge nGrams</a> in your analyser. </p>\n"}], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3803, "favorite_count": 0, "accepted_answer_id": 29166181, "answer_count": 1, "score": 1, "last_activity_date": 1426853379, "creation_date": 1426837423, "question_id": 29161705, "link": "https://stackoverflow.com/questions/29161705/how-to-search-a-string-in-the-elasticsearch-documentindexed-in-golang", "title": "How to search a string in the elasticsearch document(indexed) in golang?", "body": "<p>I am writing a function in golang to search for a string in elasticsearch documents which are indexed. I am using elasticsearch golang client <a href=\"https://github.com/olivere/elastic\" rel=\"nofollow\">elastic</a>. For example consider the object is tweet,</p>\n\n<pre><code>type Tweet struct {\n    User    string\n    Message string\n    Retweets int\n}\n</code></pre>\n\n<p>And the search function is </p>\n\n<pre><code>func SearchProject() error{\n    // Search with a term query\n    termQuery := elastic.NewTermQuery(\"user\", \"olivere\")\n    searchResult, err := client.Search().\n        Index(\"twitter\").   // search in index \"twitter\"\n        Query(&amp;termQuery).  // specify the query\n        Sort(\"user\", true). // sort by \"user\" field, ascending\n        From(0).Size(10).   // take documents 0-9\n        Pretty(true).       // pretty print request and response JSON\n        Do()                // execute\n    if err != nil {\n        // Handle error\n        panic(err)\n        return err\n    }\n\n    // searchResult is of type SearchResult and returns hits, suggestions,\n    // and all kinds of other information from Elasticsearch.\n    fmt.Printf(\"Query took %d milliseconds\\n\", searchResult.TookInMillis)\n\n    // Each is a convenience function that iterates over hits in a search result.\n    // It makes sure you don't need to check for nil values in the response.\n    // However, it ignores errors in serialization. If you want full control\n    // over iterating the hits, see below.\n    var ttyp Tweet\n    for _, item := range searchResult.Each(reflect.TypeOf(ttyp)) {\n        t := item.(Tweet)\n        fmt.Printf(\"Tweet by %s: %s\\n\", t.User, t.Message)\n    }\n    // TotalHits is another convenience function that works even when something goes wrong.\n    fmt.Printf(\"Found a total of %d tweets\\n\", searchResult.TotalHits())\n\n    // Here's how you iterate through results with full control over each step.\n    if searchResult.Hits != nil {\n        fmt.Printf(\"Found a total of %d tweets\\n\", searchResult.Hits.TotalHits)\n\n        // Iterate through results\n        for _, hit := range searchResult.Hits.Hits {\n            // hit.Index contains the name of the index\n\n            // Deserialize hit.Source into a Tweet (could also be just a map[string]interface{}).\n            var t Tweet\n            err := json.Unmarshal(*hit.Source, &amp;t)\n            if err != nil {\n                // Deserialization failed\n            }\n\n            // Work with tweet\n            fmt.Printf(\"Tweet by %s: %s\\n\", t.User, t.Message)\n        }\n    } else {\n        // No hits\n        fmt.Print(\"Found no tweets\\n\")\n    }\n    return nil\n}\n</code></pre>\n\n<p>This search is printing tweets by the user 'olivere'.  But if I give 'olive' then search is not working. How do I search for a string which is part of User/Message/Retweets?</p>\n\n<p>And the Indexing function looks like this,</p>\n\n<pre><code>func IndexProject(p *objects.ElasticProject) error {\n// Index a tweet (using JSON serialization)\n    tweet1 := `{\"user\" : \"olivere\", \"message\" : \"It's a Raggy Waltz\"}`\n    put1, err := client.Index().\n        Index(\"twitter\").\n        Type(\"tweet\").\n        Id(\"1\").\n        BodyJson(tweet1).\n        Do()\n    if err != nil {\n        // Handle error\n        panic(err)\n        return err\n    }\n    fmt.Printf(\"Indexed tweet %s to index %s, type %s\\n\", put1.Id, put1.Index, put1.Type)\n\n    return nil\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>Indexed tweet 1 to index twitter, type tweet\nGot document 1 in version 1 from index twitter, type tweet\nQuery took 4 milliseconds\nTweet by olivere: It's a Raggy Waltz\nFound a total of 1 tweets\nFound a total of 1 tweets\nTweet by olivere: It's a Raggy Waltz\n</code></pre>\n\n<p><strong>Version</strong></p>\n\n<pre><code>Go 1.4.2\nElasticsearch-1.4.4\n</code></pre>\n\n<p><strong>Elasticsearch Go Library</strong></p>\n\n<pre><code>github.com/olivere/elastic\n</code></pre>\n\n<p>Could anyone help me on this.? Thank you</p>\n"}, {"tags": ["string", "go", "unicode", "type-conversion"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426877528, "post_id": 29161300, "comment_id": 46565491, "body": "<code>utf8.DecodeRuneInString(norm.NFC.String(stringSource))</code> or <code>utf8.DecodeRune(norm.NFC.Bytes(byteSliceSource))</code> depending of if your real input is a <code>string</code> or a <code>[]byte</code>. Avoid unnecessary conversions between byte slices and strings as they can cause copies."}], "answers": [{"tags": [], "owner": {"reputation": 2232, "user_id": 4584812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nzgSK.png?s=128&g=1", "display_name": "Xi Sigma", "link": "https://stackoverflow.com/users/4584812/xi-sigma"}, "is_accepted": false, "score": 6, "last_activity_date": 1426836291, "creation_date": 1426836291, "answer_id": 29161442, "question_id": 29161300, "link": "https://stackoverflow.com/questions/29161300/how-can-i-get-the-unicode-value-of-a-character-in-go/29161442#29161442", "title": "How can I get the Unicode value of a character in go?", "body": "<p>you can use the <code>unicode/utf8</code> package    </p>\n\n<pre><code>rune,_:=utf8.DecodeRuneInString(\"\u00c4\")\nfmt.Println(rune)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "edited": false, "score": 0, "creation_date": 1426839118, "post_id": 29161443, "comment_id": 46543452, "body": "Yes, that works if I use a constant assignment, e.g. str := &quot;&#196;&quot;. Then the length is 2 and the byte codes are [195 132], that results in a Rune: 196. But I read the character from a file, the length is 3 and I get byte codes [65 204 136] and Rune: 65. fmt.Println outputs both strings as &#196;. I don&#39;t know how the file is encoded."}, {"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "reply_to_user": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "edited": false, "score": 2, "creation_date": 1426839762, "post_id": 29161443, "comment_id": 46543730, "body": "It is UTF8 allright, but you have A (U+0040) and a combining diaeresis (&#168;) character (U+0308). Combined they become &#196;. What you need to do is first normalizing your string to NFC form using the <code>golang.org&#47;x&#47;text&#47;unicode&#47;norm</code> package."}, {"owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "edited": false, "score": 0, "creation_date": 1426866562, "post_id": 29161443, "comment_id": 46559400, "body": "I added the solution code to my question above. Feel free to add it to your answer. Most people will look there for it ;-)"}, {"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "reply_to_user": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "edited": false, "score": 0, "creation_date": 1427041377, "post_id": 29161443, "comment_id": 46606290, "body": "@Michael I modified the reply to include the normalization part. Just a note: normalization isn&#39;t Go-specific - it is part of the unicode standard. The <code>norm</code> package simply implements unicode normalization."}], "tags": [], "owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "is_accepted": true, "score": 9, "last_activity_date": 1427041239, "last_edit_date": 1427041239, "creation_date": 1426836295, "answer_id": 29161443, "question_id": 29161300, "link": "https://stackoverflow.com/questions/29161300/how-can-i-get-the-unicode-value-of-a-character-in-go/29161443#29161443", "title": "How can I get the Unicode value of a character in go?", "body": "<p>Strings are utf8 encoded, so to decode a character from a string to get the <code>rune</code> (unicode code point), you can use the <a href=\"http://golang.org/pkg/unicode/utf8/#DecodeRuneInString\" rel=\"noreferrer\"><code>unicode/utf8</code></a> package.</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"unicode/utf8\"\n)\n\nfunc main() {\n    str := \"A\u00c5\u00c4\u00d6\"\n\n    for len(str) &gt; 0 {\n        r, size := utf8.DecodeRuneInString(str)\n        fmt.Printf(\"%d %v\\n\", r, size)\n\n        str = str[size:]\n    }\n}\n</code></pre>\n\n<p><strong>Result:</strong></p>\n\n<blockquote>\n  <p>65 1<br>\n  197 2<br>\n  196 2<br>\n  214 2</p>\n</blockquote>\n\n<p><strong>Edit:</strong> (To clarify Michael's supplement)</p>\n\n<p>A character such as <code>\u00c4</code> may be created using different unicode code points:</p>\n\n<p><em>Precomposed:</em> <code>\u00c4</code> (U+00C4)<br>\n<em>Using combining diaeresis:</em> <code>A</code> (U+0041) + <code>\u00a8</code> (U+0308)</p>\n\n<p>In order to get the precomposed form, one can use the normalization package, <code>golang.org/x/text/unicode/norm</code>. The NFC (Canonical Decomposition,\nfollowed by Canonical Composition) form will turn U+0041 + U+0308 into U+00C4:</p>\n\n<pre><code>c := \"\\u0041\\u0308\"\nr, _ := utf8.DecodeRune(norm.NFC.Bytes([]byte(c)))\nfmt.Printf(\"%+q\", r) // '\\u00c4'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 6, "last_activity_date": 1471955040, "last_edit_date": 1471955040, "creation_date": 1426837125, "answer_id": 29161635, "question_id": 29161300, "link": "https://stackoverflow.com/questions/29161300/how-can-i-get-the-unicode-value-of-a-character-in-go/29161635#29161635", "title": "How can I get the Unicode value of a character in go?", "body": "<p>The \"character\" type in Go is the <a href=\"http://golang.org/ref/spec#Numeric_types\" rel=\"nofollow\"><code>rune</code></a> which is an alias for <code>int32</code>, see also <a href=\"http://golang.org/ref/spec#Rune_literals\" rel=\"nofollow\">Rune literals</a>. A <code>rune</code> is an integer value identifying a Unicode code point.</p>\n\n<p>In Go <code>string</code>s are represented and stored as the UTF-8 encoded byte sequence of the text. The <code>range</code> form of the <code>for</code> loop iterates over the <code>rune</code>s of the text:</p>\n\n<pre><code>s := \"\u00e4\u00f6\u00fc\u00c4\u00d6\u00dc\u4e16\u754c\"\nfor _, r := range s {\n    fmt.Printf(\"%c - %d\\n\", r, r)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>\u00e4 - 228\n\u00f6 - 246\n\u00fc - 252\n\u00c4 - 196\n\u00d6 - 214\n\u00dc - 220\n\u4e16 - 19990\n\u754c - 30028\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/UHKKeGp0q_\" rel=\"nofollow\">Go Playground</a>.</p>\n\n<p>Read this blog article if you want to know more about the topic:</p>\n\n<p><a href=\"http://blog.golang.org/strings\" rel=\"nofollow\"><strong>Strings, bytes, runes and characters in Go</strong></a></p>\n"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6041, "favorite_count": 1, "accepted_answer_id": 29161443, "answer_count": 3, "score": 3, "last_activity_date": 1475354945, "creation_date": 1426835637, "last_edit_date": 1475354945, "question_id": 29161300, "link": "https://stackoverflow.com/questions/29161300/how-can-i-get-the-unicode-value-of-a-character-in-go", "title": "How can I get the Unicode value of a character in go?", "body": "<p>I try to get the unicode value of a string character in Go as an Int value.</p>\n\n<p>I do this: </p>\n\n<pre><code>value = strconv.Itoa(int(([]byte(char))[0]))\n</code></pre>\n\n<p>where char contains a string with one character.</p>\n\n<p>That works for many cases. It doesn't work for umlauts like \u00e4, \u00f6, \u00fc, \u00c4, \u00d6, \u00dc.</p>\n\n<p>E.g. \u00c4 results in 65, which is the same as for A. </p>\n\n<p>How can I do that?</p>\n\n<p>Supplement: I had two problems. The first was solved with any of the answers below. The second was a bit more tricky. My input was not Go normalized UTF-8 code, e.g. umlauts were represented by two characters instead of one. As ANisus said the solution is found in the package golang.org/x/text/unicode/norm. The line above is now two lines: </p>\n\n<pre><code>rune, _ := utf8.DecodeRune(norm.NFC.Bytes([]byte(char)))\nvalue = strconv.Itoa(int(rune)) \n</code></pre>\n\n<p>Any hints to make this shorter welcome ... </p>\n"}, {"tags": ["go", "cgo", "gccgo"], "comments": [{"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1426838589, "post_id": 29160464, "comment_id": 46543248, "body": "I would say that your compiler doesn&#39;t link against the golang runtime. I don&#39;t know where it is located, but I would bet that the documentation of <i>gccgo</i> must evoque it somewhere\u2026"}], "answers": [{"tags": [], "owner": {"reputation": 7787, "user_id": 1257035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WHLC8.png?s=128&g=1", "display_name": "a3f", "link": "https://stackoverflow.com/users/1257035/a3f"}, "is_accepted": true, "score": 1, "last_activity_date": 1426840475, "creation_date": 1426840475, "answer_id": 29162383, "question_id": 29160464, "link": "https://stackoverflow.com/questions/29160464/integer-division-in-go-called-from-c/29162383#29162383", "title": "integer division in Go called from C", "body": "<p>You need to link using <code>gccgo</code> and not with normal <code>gcc</code>. Normal gcc doesn't know that it ought to link against the go runtime (libgo).</p>\n\n<p>Depending on your configuration, you might also need to specify where the runtime library can be found. For example by embedding it statically or by making it available in the <code>LD_LIBRARY_PATH</code> environment variable.\nExample:</p>\n\n<pre><code>gccgo -static-libgo calc.o calcc.o -o main\n</code></pre>\n\n<p>For more information, check <a href=\"https://golang.org/doc/install/gccgo\" rel=\"nofollow\">Setting up and using gccgo</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426873999, "post_id": 29172683, "comment_id": 46563767, "body": "Of course, since we all know that <a href=\"https://en.wikipedia.org/wiki/Phrases_from_The_Hitchhiker%27s_Guide_to_the_Galaxy\" rel=\"nofollow noreferrer\">6&#215;9=42</a> it follows that 42&#247;6 should equal 9, so there must be something <i>fundamentally wrong</i> with this example\u2026 :)"}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1426881826, "last_edit_date": 1426881826, "creation_date": 1426873307, "answer_id": 29172683, "question_id": 29160464, "link": "https://stackoverflow.com/questions/29160464/integer-division-in-go-called-from-c/29172683#29172683", "title": "integer division in Go called from C", "body": "<p>I believe your method of using <code>__asm__</code> is gccgo specific (I've never seen it before).</p>\n\n<p>The <a href=\"https://golang.org/cmd/cgo/#hdr-C_references_to_Go\" rel=\"nofollow\">standard way</a> to export Go functions to C is via an \"<code>//export name</code>\" comment in the Go code.</p>\n\n<p>Further, standard Go&lt;->C via cgo requires that C code is linked into Go and Go's main runs and not the other way around. This is so that the Go runtime is fully running. Otherwise goroutines, the garbage collector, etc would not be running. Of course Go's main could just be a simple call to a C pseudo-main function that does all the work and calls back into Go only as needed.</p>\n\n<p>Given these points a small example of what you tried using <em>standard</em> cgo and fully <code>go build</code>-able is this:</p>\n\n<p>calc.go:</p>\n\n<pre><code>package main\n\n// /* could be in a declared in a header file instead */\n// extern void pseudo_main(void);\nimport \"C\"\n\n//export Add\nfunc Add(a, b int) int {\n    return a + b\n}\n\n// \u2026 etc \u2026\n\n//export Div\nfunc Div(a, b int) int {\n    return a / b\n}\n\n// Main needs to be Go so that the go runtime\n// gets started so you can use goroutines, the\n// garbage collector, etc,etc.\n//\n// It can just be a trivial call into a C main like\n// function.\nfunc main() {\n    C.pseudo_main()\n}\n</code></pre>\n\n<p>and calc.c:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"_cgo_export.h\" // file auto-generated by cgo from Go's \"//export func\" comments\n\n// passing argc, argv, envp like arguments\n// if desired is left as an excersise :)\nvoid pseudo_main(void) {\n    int x, y, z;\n\n    printf(\"Hello from C\\n\");\n    x = 42;\n    y = 6;\n    z = Add(x, y);\n    printf(\"%d + %d = %d\\n\", x, y, z);\n    z = Div(x, y);\n    printf(\"%d / %d = %d\\n\", x, y, z);\n}\n</code></pre>\n\n<p>building and running (on a Unix like host):</p>\n\n<pre><code>% go build -o calc\n% ./calc\n</code></pre>\n\n<p><sub>Note: normally you wouldn't use <code>-o</code>, you'd let the tool pick the name based on package or directory name. I've used <code>-o</code> here to list <em>exact</em> and repeatable commands without specifying what directory the files are in. Further note, for Microsoft Windows it would be different. Also, if you're interested in what goes on behind the scenes with cgo, try <code>go build -x</code>.</sub></p>\n\n<p>output:</p>\n\n<pre><code>Hello from C\n42 + 6 = 48\n42 / 6 = 7\n</code></pre>\n\n<p><a href=\"https://gist.github.com/dchapes/8c094b9d92b2d163d330\" rel=\"nofollow\"><kbd>gist.github.com</kbd></a></p>\n\n<p>See also: <a href=\"https://blog.golang.org/c-go-cgo\" rel=\"nofollow\">The Go Blog: C? Go? Cgo!</a></p>\n"}], "owner": {"reputation": 284, "user_id": 4460309, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/483818ae34723ee0b33ea411e95da766?s=128&d=identicon&r=PG&f=1", "display_name": "Ridhima", "link": "https://stackoverflow.com/users/4460309/ridhima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 760, "favorite_count": 1, "accepted_answer_id": 29162383, "answer_count": 2, "score": 4, "last_activity_date": 1426887121, "creation_date": 1426831860, "last_edit_date": 1426887121, "question_id": 29160464, "link": "https://stackoverflow.com/questions/29160464/integer-division-in-go-called-from-c", "title": "integer division in Go called from C", "body": "<p>I am able to perform integer division in go by this program :</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n a := 10\n b := 5\n    fmt.Println(a/b)\n}\n</code></pre>\n\n<p>Then I made a program in go that has functions for +, -, * and /.\nand I made a program in C that calls each of these functions and performs arithmetic operations.\nExcept division, the code works fine. </p>\n\n<p>The go file with the functions is :  (calc.go)</p>\n\n<pre><code>package main\n\nfunc Add(a, b int) int {\n    return a + b\n}\nfunc Sub(a, b int) int {\n    return a - b\n}\nfunc Mul(a, b int) int {\n    return a * b\n}\nfunc Div(a, b int) int {\n    return a / b\n}\n</code></pre>\n\n<p>And the C program that calls these functions is : (calcc.c)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nextern int go_add(int, int) __asm__ (\"main.Add\");\nextern int go_sub(int, int) __asm__ (\"main.Sub\");\nextern int go_mul(int, int) __asm__ (\"main.Mul\");\nextern int go_div(int, int) __asm__ (\"main.Div\");\n\nint menu()\n{\n  int op;\n  printf(\"\\n1 add\");\n  printf(\"\\n2 sub\");\n  printf(\"\\n3 mul\");\n  printf(\"\\n4 div\");\n  printf(\"\\nEnter your choice : \");\n  scanf(\"%d\", &amp;op);\n  return op;\n}\nint main() {\n\n\n  int op, ch, result, a, b;\n\n  do{ \n    op= menu();\n\n    printf(\"First number  : \");\n    scanf(\"%d\", &amp;a);\n    printf(\"Second number : \");\n    scanf(\"%d\", &amp;b);\n\n    switch(op)\n    {\n       case 1:\n        result = go_add(a, b);\n    printf(\"Result : %d\" , result);\n        break;\n       case 2:\n        result = go_sub(a, b);\n    printf(\"Result : %d\" , result);\n        break;\n       case 3:\n        result = go_mul(a, b);\n    printf(\"Result : %d\" , result);\n    break;\n       case 4:\n        result = go_div(a, b);\n    printf(\"Result : %d\" , result);\n    break;\n       default:\n        printf(\"Invalid choice ! \");\n    }\n    printf(\"\\nAnother operation? (1 if yes) : \");\n    scanf(\"%d\", &amp;ch);\n  } while(ch==1);\n  printf(\"\\nThank you!\");\n}\n</code></pre>\n\n<p>I compiled on the terminal using the commands :</p>\n\n<blockquote>\n  <p>gccgo -c calc.go </p>\n</blockquote>\n\n<ul>\n<li>and</li>\n</ul>\n\n<blockquote>\n  <p>gcc calc.o calcc.c -o main</p>\n</blockquote>\n\n<p>And got this error :\n undefined reference to `__go_runtime_error'\ncollect2: error: ld returned 1 exit status</p>\n\n<p>How should I fix this?</p>\n"}, {"tags": ["go", "cryptography", "jwt", "rsa", "jwt-go"], "comments": [{"owner": {"reputation": 3233, "user_id": 474545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/914c278e0eefbe4cd86f723c64d74a74?s=128&d=identicon&r=PG", "display_name": "icchanobot", "link": "https://stackoverflow.com/users/474545/icchanobot"}, "edited": false, "score": 1, "creation_date": 1426831276, "post_id": 29158646, "comment_id": 46540407, "body": "The example in the blog in incomplete.  When he calls jwt.ParseFromRequest he would actually verify the signatures match.  Do you want to have a use JWT for symmetric key signature authentication? If you do, then in the KeyFunc passed into  jwt.ParseFromRequest you should extract the publickey from the claims.. look up the private key in your datastore.. recreate the signature and then compare it to the one in the jwt"}, {"owner": {"reputation": 39, "user_id": 3920701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08a79c13e1e4fa5244e6d147d0a1177f?s=128&d=identicon&r=PG", "display_name": "victorsamuelmd", "link": "https://stackoverflow.com/users/3920701/victorsamuelmd"}, "reply_to_user": {"reputation": 3233, "user_id": 474545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/914c278e0eefbe4cd86f723c64d74a74?s=128&d=identicon&r=PG", "display_name": "icchanobot", "link": "https://stackoverflow.com/users/474545/icchanobot"}, "edited": false, "score": 1, "creation_date": 1426859316, "post_id": 29158646, "comment_id": 46554589, "body": "Nop, I wanted asymetric key signature using the crypto/rsa package from go."}, {"owner": {"reputation": 3233, "user_id": 474545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/914c278e0eefbe4cd86f723c64d74a74?s=128&d=identicon&r=PG", "display_name": "icchanobot", "link": "https://stackoverflow.com/users/474545/icchanobot"}, "edited": false, "score": 1, "creation_date": 1427013690, "post_id": 29158646, "comment_id": 46598647, "body": "oh ok.. i dont think that strictly jwt anymore then.. but you need to remember that the claims are sent inside json i.e. its not really stored as int64.. its just parsed as int64, so you can probably just cast it"}], "answers": [{"tags": [], "owner": {"reputation": 362, "user_id": 1111002, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5175ed7bc99de14d8026f9173bdbb679?s=128&d=identicon&r=PG", "display_name": "sio4", "link": "https://stackoverflow.com/users/1111002/sio4"}, "is_accepted": false, "score": 3, "last_activity_date": 1501167557, "creation_date": 1501167557, "answer_id": 45354453, "question_id": 29158646, "link": "https://stackoverflow.com/questions/29158646/golang-package-jwt-go-with-rsa-key-how-to-put-the-public-key-and-how-to-get-it/45354453#45354453", "title": "Golang package jwt-go with rsa key. How to put the public key and how to get it from the token?", "body": "<p>I think storing the public key in the claims is not good idea because we can verify the JWT with that key technically, but it means it is not a signed JWT anymore. If anyone can generate the JWT with their own private key and storing the public key in JWT, we cannot sure who is signer.</p>\n\n<p>Anyway, you can convert the public key into PEM format which is just a string, and store it in claims. In client side, you can also simply parse it again into public key format. The sample code is below:</p>\n\n<pre><code>privateKey, _ := rsa.GenerateKey(rand.Reader, 1024)\nbytes, _ := x509.MarshalPKIXPublicKey(&amp;privateKey.PublicKey)\npem := pem.EncodeToMemory(&amp;pem.Block{\n    Type:  \"RSA PUBLIC KEY\",\n    Bytes: bytes,\n})\nclaim[\"publickey\"] = string(pem)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>pem := []byte(claims[\"publickey\"].(string))\nreturn jwt.ParseRSAPublicKeyFromPEM(pem)\n</code></pre>\n\n<p><code>jwt</code> is <a href=\"https://github.com/dgrijalva/jwt-go\" rel=\"nofollow noreferrer\">dgrijalva's jwt-go</a>.</p>\n"}], "owner": {"reputation": 39, "user_id": 3920701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08a79c13e1e4fa5244e6d147d0a1177f?s=128&d=identicon&r=PG", "display_name": "victorsamuelmd", "link": "https://stackoverflow.com/users/3920701/victorsamuelmd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7884, "favorite_count": 3, "answer_count": 1, "score": 2, "last_activity_date": 1588099046, "creation_date": 1426820261, "last_edit_date": 1588099046, "question_id": 29158646, "link": "https://stackoverflow.com/questions/29158646/golang-package-jwt-go-with-rsa-key-how-to-put-the-public-key-and-how-to-get-it", "title": "Golang package jwt-go with rsa key. How to put the public key and how to get it from the token?", "body": "<p>I'm trying to generate a token with a rsa key using the jwt-go package in golang.</p>\n\n<p><a href=\"https://sendgrid.com/blog/tokens-tokens-intro-json-web-tokens-jwt-go/\" rel=\"nofollow noreferrer\">Here</a> there is a blog explaining how to do it but that code will always be validating all tokens because is using the public key stored in the server and is not obtaining it from the token. How do you put the complete public key in the token? I was trying this:</p>\n\n<pre><code>var secretKey, _ = rsa.GenerateKey(rand.Reader, 1024)\ntoken := jwt.New(jwt.SigningMethodRS256)\ntoken.Claims[\"username\"] = \"victorsamuelmd\"\ntoken.Claims[\"N\"] = secretKey.PublicKey.N\ntoken.Claims[\"E\"] = secretKey.PublicKey.E\n\ntokenString, err := token.SignedString(secretKey)\n\nnt, err := jwt.Parse(tokenString, func(t *jwt.Token) (interface{}, error) {\n    // here I need to recover the public key from the token\n    // but N is a big.Int and the token stores N as int64\n})\n</code></pre>\n\n<p>Sorry about my english. Thanks.</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 5, "creation_date": 1426801146, "post_id": 29155202, "comment_id": 46531724, "body": "I wrote a lot about when to use/not use pointers <a href=\"http://stackoverflow.com/questions/23542989/pointers-vs-values-in-parameters-and-return-values/23551970#23551970\">over here</a>. Don&#39;t sweat the perf until you know you&#39;re working on code that&#39;s your bottleneck; to know when it&#39;ll help or hurt, you really might have to experiment on your actual code, to take account of cache effects and such."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1426884542, "post_id": 29155202, "comment_id": 46568837, "body": "The question is really only about the performance issue not the other uses cases."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1426885375, "post_id": 29155202, "comment_id": 46569260, "body": "I&#39;ve also updated the question to clarify that it&#39;s not about when to use pointers."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1426890882, "post_id": 29155202, "comment_id": 46571337, "body": "Rules of thumb: In the other answer, I noted the stdlib has a function that pushes 10 words of data on the stack, so maybe you can see that as the upper bound past which you&#39;d tend to use a pointer. I definitely wouldn&#39;t use a pointer to two strings (four words). Around three strings (six words) I&#39;d start measuring, if the performance really mattered. It usually doesn&#39;t really matter."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1426891112, "post_id": 29155202, "comment_id": 46571421, "body": "And rules of thumb, or even careful analysis, won&#39;t always predict what performs best--if it&#39;s crucial you just have to benchmark your app. Pointer versus value has a lot of different effects (on amount of copying, memory locality, GC time, number of allocations, etc.), so you may have to measure to see how they balance out in your case."}], "answers": [{"tags": [], "owner": {"reputation": 412, "user_id": 4690715, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-C9lxqcBIw3E/AAAAAAAAAAI/AAAAAAAAABM/9Iq4ql5R0OY/photo.jpg?sz=128", "display_name": "Raed CHAMMAM", "link": "https://stackoverflow.com/users/4690715/raed-chammam"}, "is_accepted": false, "score": 1, "last_activity_date": 1426800310, "creation_date": 1426800310, "answer_id": 29155305, "question_id": 29155202, "link": "https://stackoverflow.com/questions/29155202/why-should-i-use-a-pointer-performance/29155305#29155305", "title": "Why should I use a pointer ( performance)?", "body": "<p>To quote the official <a href=\"https://golang.org/doc/faq#methods_on_values_or_pointers\" rel=\"nofollow\">golang documentation</a> </p>\n\n<blockquote>\n  <p>...the consideration of efficiency. If the receiver is large, a big struct for instance, it will be much cheaper to use a pointer receiver.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 4, "creation_date": 1426801370, "post_id": 29155375, "comment_id": 46531826, "body": "Strings, interface values, and function values are also implemented with pointers. There&#39;s a lot about it <a href=\"http://stackoverflow.com/questions/23542989/pointers-vs-values-in-parameters-and-return-values/23551970#23551970\">over here</a>."}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1426884792, "post_id": 29155375, "comment_id": 46568969, "body": "Should I understand from this answer that  for anything that&#39;s not a reference type I should use a pointer? i.e. a string."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1426885285, "post_id": 29155375, "comment_id": 46569209, "body": "@Theuserwithnohat that for anything that&#39;s not a reference type, you <i>can</i> use a pointer. That doesn&#39;t mean that you <i>have</i> to, but it can make sense mainly when passing around large structures."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1426885649, "post_id": 29155375, "comment_id": 46569377, "body": "@Theuserwithnohat &quot;maybe some people want to do the right thing whenever they have to chance even if the performance gain is not signifiant&quot;: that is called <a href=\"http://c2.com/cgi/wiki?PrematureOptimization\" rel=\"nofollow noreferrer\">c2.com/cgi/wiki?PrematureOptimization</a> and is well documented: don&#39;t worry too soon, that is why go comes with a benchmarking framework (<a href=\"http://dave.cheney.net/2013/06/30/how-to-write-benchmarks-in-go\" rel=\"nofollow noreferrer\">dave.cheney.net/2013/06/30/how-to-write-benchmarks-in-go</a>)"}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1426885847, "post_id": 29155375, "comment_id": 46569462, "body": "@VonC I&#39;m wondering if using different integer types is considered premature optimisation too."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1426885911, "post_id": 29155375, "comment_id": 46569486, "body": "@Theuserwithnohat it is not, if you measure it (with benchmark tests), like some did for the go web frameworks (<a href=\"https://quip.com/Ha0bAfeh1ZVY\" rel=\"nofollow noreferrer\">quip.com/Ha0bAfeh1ZVY</a>)"}, {"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1426887385, "post_id": 29155375, "comment_id": 46570112, "body": "This doesn&#39;t go anywhere... I will benchmark the pointer vs non-pointer thing when I get time and post the results as my answer.  I think using the pointer improperly is same as using the wrong integer type or even worse. The question is about correctness of the pointer usage and all the answers basically provide the same rhetoric. &quot;Use pointers when you think the receiver is big/large&quot; though &quot;large&quot; or &quot;big&quot; is not something that you can measure unless you have a comparison value."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 3, "last_activity_date": 1426803169, "last_edit_date": 1495540250, "creation_date": 1426800684, "answer_id": 29155375, "question_id": 29155202, "link": "https://stackoverflow.com/questions/29155202/why-should-i-use-a-pointer-performance/29155375#29155375", "title": "Why should I use a pointer ( performance)?", "body": "<p>An example where it doesn't make sense to use a pointer is for reference types (<a href=\"http://golang.org/ref/spec#Making_slices_maps_and_channels\" rel=\"nofollow noreferrer\">slices, maps, and channels</a>)</p>\n\n<p>As mentioned in <a href=\"https://groups.google.com/forum/#!msg/golang-nuts/xQUsmdo6oSs/RJ8SF4NsbowJ\" rel=\"nofollow noreferrer\">this thread</a>:</p>\n\n<blockquote>\n  <p>The concept of a reference just means something that serves the purpose of referring you to something. It's not magical.  </p>\n  \n  <p>A pointer is a simple reference that tells you where to look.<br>\n  A slice tells you where to start looking and how far.<br>\n  Maps and channels also just tell you where to look, but the data they reference and the operations they support on it are more complex. </p>\n  \n  <p>The point is that all the actually data is stored indirectly and all you're holding is information on how to access it.<br>\n  <strong>As a result, in many cases you don't need to add another layer of indirection, unless you want a double indirection for some reason.</strong></p>\n</blockquote>\n\n<p>As <a href=\"https://stackoverflow.com/users/2714852/twotwotwo\">twotwotwo</a> details in \"<a href=\"https://stackoverflow.com/a/23551970/6309\">Pointers vs. values in parameters and return values</a>\", strings, interface values, and function values are also implemented with pointers.<br>\nAs a consequence, you would rarely need a to use a pointer on those objects.</p>\n"}, {"tags": [], "owner": {"reputation": 13728, "user_id": 336186, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/u4ox0.png?s=128&g=1", "display_name": "Lukasz Madon", "link": "https://stackoverflow.com/users/336186/lukasz-madon"}, "is_accepted": false, "score": -1, "last_activity_date": 1426892142, "creation_date": 1426892142, "answer_id": 29177032, "question_id": 29155202, "link": "https://stackoverflow.com/questions/29155202/why-should-i-use-a-pointer-performance/29177032#29177032", "title": "Why should I use a pointer ( performance)?", "body": "<p>It's very hard to give you exact conditions since there can be different performance goals. As a rule of thumb, by default, all objects larger than 128 bits should be passed by pointer. Possible exceptions of the rule:</p>\n\n<ul>\n<li><p>you are writing latency sensitive server, so you want to minimise garbage collection pressure. In order to achieve that your Request struct has byte[8] field instead of pointer to Data struct which holds byte[8]. One allocation instead of two.</p>\n\n<ul>\n<li>algorithm you are writing is more readable when you pass the struct and make a copy</li>\n</ul></li>\n</ul>\n\n<p>etc.</p>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1426892142, "creation_date": 1426799900, "last_edit_date": 1426885721, "question_id": 29155202, "link": "https://stackoverflow.com/questions/29155202/why-should-i-use-a-pointer-performance", "title": "Why should I use a pointer ( performance)?", "body": "<p>I'm wondering if there is any perf benchmark on raw objects vs pointers to objects.</p>\n\n<ul>\n<li>I'm aware that it doesn't make sense to use pointers on reference types (e.g. maps) so please don't mention it.</li>\n<li>I'm aware that you \"must\" use pointers if the data needs to be updated so please don't mention it. </li>\n</ul>\n\n<p>Most of the answers/ docs that I've found basically rephrase the guidelines from the official documentation: \n<code>... If the receiver is large, a big struct for instance, it will be much cheaper to use a pointer receiver.</code></p>\n\n<p>My question is simply what means \"large\" / \"big\"? Is a pointer on a string overkill ? what about a struct with two strings, what about a struct 3 string fields?? </p>\n\n<p>I think we deal with this use case quite often so it's a fair question to ask. Some advise to don't mind the performance issue but maybe some people want to use the right notation whenever they have to chance even if the performance gain is not signifiant. After all a pointer is not that expensive (i.e. one additional keystroke).</p>\n"}, {"tags": ["pointers", "struct", "types", "go", "initialization"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 5, "creation_date": 1426794081, "post_id": 29152710, "comment_id": 46528241, "body": "According to the Go team, you should not make types pointers to structs. Always make types structs and add pointers where necessary."}], "answers": [{"comments": [{"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 0, "creation_date": 1426791801, "post_id": 29152787, "comment_id": 46527077, "body": "Whenever you say &quot;there&#39;s no reason to ever do X&quot;, you&#39;re probably wrong. I my case, I have a set of types that all implement the same interface. However, some of them are supposed to work with pointer receivers and others with value receivers. In order to not have to change all my code every time I change whether a type is a pointer type or a value type, it would be better to just declare the pointer types as pointers. (I hope that doesn&#39;t sound to confusing.)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 2, "creation_date": 1426792165, "post_id": 29152787, "comment_id": 46527236, "body": "@Matt: good point, there are almost always exceptions ;) Though I don&#39;t think that&#39;s a valid reason to go down this path. You&#39;re trying to hide the pointer in a very non-idiomatic way, and I would venture to say it&#39;s going to be awkward and less maintainable. Switching from pointer to value receivers is usually a very quick refactor. The compiler tells you exactly what lines to change."}, {"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 1, "creation_date": 1426792392, "post_id": 29152787, "comment_id": 46527349, "body": "It&#39;s not switching the receivers that&#39;s difficult. It&#39;s changing every <code>*Foo</code> to <code>Foo</code> and <code>(&amp;foo).X</code> to <code>foo.X</code> in the rest of my code that&#39;s difficult."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 2, "creation_date": 1426792574, "post_id": 29152787, "comment_id": 46527458, "body": "@matt, that&#39;s what I&#39;m talking about. The compiler will tell you where they are (maybe some editor/IDE plugins do too?). Plus, due to addressability and automatic referencing/dereferencing, many don&#39;t need to be changed <a href=\"http://play.golang.org/p/uImXTAh6Ll\" rel=\"nofollow noreferrer\">play.golang.org/p/uImXTAh6Ll</a>"}, {"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 0, "creation_date": 1426792679, "post_id": 29152787, "comment_id": 46527511, "body": "Still that means that I have to change a package&#39;s interface just because I changed the implementation."}, {"owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "edited": false, "score": 0, "creation_date": 1426798784, "post_id": 29152787, "comment_id": 46530636, "body": "I realize now that Go doesn&#39;t even allow me to add methods to <code>Bar</code>, so there goes that idea..."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1426795920, "last_edit_date": 1426795920, "creation_date": 1426791349, "answer_id": 29152787, "question_id": 29152710, "link": "https://stackoverflow.com/questions/29152710/how-can-i-initialize-a-type-that-is-a-pointer-to-a-struct-in-go/29152787#29152787", "title": "How can I initialize a type that is a pointer to a struct in Go?", "body": "<p>There's [probably] no reason to ever use the form <code>type Bar *struct</code>. The type is a pointer to an anonymous struct, so you have to initialize it with an anonymous struct (or as you point out, an equivalent, convertible struct type).</p>\n\n<pre><code>var b Bar = &amp;struct{x int}{}\n// or\nb := Bar(&amp;Foo{})\n</code></pre>\n\n<p>The declaration is essentially the same is</p>\n\n<pre><code>type Bar *Foo\n</code></pre>\n\n<p>Which may make it a little more clear what you're trying to do. </p>\n\n<p>But again, this is non-idiomatic, and you will probably encounter resistance using this in a team setting or public interface (i.e. I personally wouldn't pass this is code review)</p>\n"}], "owner": {"reputation": 17775, "user_id": 810671, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a2131c899b918a6bfae126ddb1e2bbf?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/810671/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 29152787, "answer_count": 1, "score": 1, "last_activity_date": 1426795920, "creation_date": 1426791042, "question_id": 29152710, "link": "https://stackoverflow.com/questions/29152710/how-can-i-initialize-a-type-that-is-a-pointer-to-a-struct-in-go", "title": "How can I initialize a type that is a pointer to a struct in Go?", "body": "<p>For example:</p>\n\n<pre><code>type Foo struct {\n        x int\n}\nvar foo *Foo = &amp;Foo{5}\n\ntype Bar *struct {\n        x int\n}\nvar bar Bar = ??\n</code></pre>\n\n<p>How can I initialize <code>bar</code>?</p>\n\n<p>I realize there is a workaround:</p>\n\n<pre><code>type Bar *Foo\nvar bar Bar = &amp;Foo{5}\n</code></pre>\n\n<p>But I would like to avoid that.</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 6095, "user_id": 2317463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc6966c56da13c927a06caf26b02b92?s=128&d=identicon&r=PG", "display_name": "Jake Burkhead", "link": "https://stackoverflow.com/users/2317463/jake-burkhead"}, "edited": false, "score": 5, "creation_date": 1426784864, "post_id": 29150756, "comment_id": 46523316, "body": "Does <code>go test &gt; test.out</code> work?"}, {"owner": {"reputation": 8029, "user_id": 3137499, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7acff2bbbdb9c51ea478377a0f6dcb03?s=128&d=identicon&r=PG&f=1", "display_name": "aruisdante", "link": "https://stackoverflow.com/users/3137499/aruisdante"}, "edited": false, "score": 0, "creation_date": 1426784965, "post_id": 29150756, "comment_id": 46523372, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/20958647/converting-go-testing-output-to-xunit\">Converting Go testing output to XUnit</a>"}, {"owner": {"reputation": 10946, "user_id": 1259261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a105607c3fd93df0d386c6d6a6b4aad?s=128&d=identicon&r=PG", "display_name": "Daniel Robinson", "link": "https://stackoverflow.com/users/1259261/daniel-robinson"}, "reply_to_user": {"reputation": 6095, "user_id": 2317463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccc6966c56da13c927a06caf26b02b92?s=128&d=identicon&r=PG", "display_name": "Jake Burkhead", "link": "https://stackoverflow.com/users/2317463/jake-burkhead"}, "edited": false, "score": 0, "creation_date": 1426785662, "post_id": 29150756, "comment_id": 46523808, "body": "go test &gt; test.out was exactly what I wanted thankyou very much @JakeBurkhead"}], "answers": [{"comments": [{"owner": {"reputation": 816, "user_id": 2352496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/S5VUa.jpg?s=128&g=1", "display_name": "AnoopGoudar", "link": "https://stackoverflow.com/users/2352496/anoopgoudar"}, "edited": false, "score": 0, "creation_date": 1535617800, "post_id": 29151193, "comment_id": 91134817, "body": "is there a way to store the output of go test command ? I am only interested in the end result, may be just &quot;pass&quot; or &quot;fail&quot;"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 816, "user_id": 2352496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/S5VUa.jpg?s=128&g=1", "display_name": "AnoopGoudar", "link": "https://stackoverflow.com/users/2352496/anoopgoudar"}, "edited": false, "score": 0, "creation_date": 1535618519, "post_id": 29151193, "comment_id": 91135232, "body": "@AnoopGoudar You could use the exit status of the go test command: <a href=\"https://github.com/golang/go/issues/25989#issuecomment-399275051\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/25989#issuecomment-399275051</a>"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 4, "last_activity_date": 1426786044, "creation_date": 1426786044, "answer_id": 29151193, "question_id": 29150756, "link": "https://stackoverflow.com/questions/29150756/is-it-possible-to-print-golang-unit-test-results-out-to-a-file/29151193#29151193", "title": "Is it possible to print golang unit test results out to a file?", "body": "<p>Since I only want to see failed test, I have this script \"<code>gt</code>\" that I run instead of go test:</p>\n\n<pre><code>go test -coverprofile=coverage.out %*|grep -v -e \"^\\.\\.*$\"|grep -v \"^$\"|grep -v \"thus far\"\n</code></pre>\n\n<p>That way, it filters everything but the failed cases.<br>\nAnd you can redirect its content to a file, as mentioned: <code>gt &gt; test.out</code></p>\n\n<p>It also generates code coverage, which is why I have another script \"<code>gc</code>\":</p>\n\n<pre><code>grep -v -e \" 1$\" coverage.out\n</code></pre>\n\n<p>That way, I don't even wait for a brower to open, I directly see the list of lines which are not yet covered (ie, which don't end with '<code>1</code>' in the <code>coverage.out</code> file)</p>\n"}], "owner": {"reputation": 10946, "user_id": 1259261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a105607c3fd93df0d386c6d6a6b4aad?s=128&d=identicon&r=PG", "display_name": "Daniel Robinson", "link": "https://stackoverflow.com/users/1259261/daniel-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5508, "favorite_count": 1, "accepted_answer_id": 29151193, "answer_count": 1, "score": 2, "last_activity_date": 1426786044, "creation_date": 1426784737, "question_id": 29150756, "link": "https://stackoverflow.com/questions/29150756/is-it-possible-to-print-golang-unit-test-results-out-to-a-file", "title": "Is it possible to print golang unit test results out to a file?", "body": "<p>I run <code>go test</code> in my pkg directory and I get the test results printed to the console as they run, but it would be ideal if I could get them printed to a txt file or even a html file, is it possible to do this? I know you can get coverage reports out from it and generate html files for those which is excellent, but I would have thought it possible to do the same just for the actual results of the tests i.e which tests ran, which passed and which failed. I've been searching the net but even <code>go test help</code> doesn't offer any suggestions for printing results out to a file. </p>\n"}, {"tags": ["image", "google-app-engine", "go", "base64", "google-cloud-storage"], "answers": [{"comments": [{"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "reply_to_user": {"reputation": 7706, "user_id": 4058484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uQgA5.png?s=128&g=1", "display_name": "Chetabahana", "link": "https://stackoverflow.com/users/4058484/chetabahana"}, "edited": false, "score": 0, "creation_date": 1426996190, "post_id": 29187533, "comment_id": 46595700, "body": "If this answers your question, consider selecting it as the answer."}, {"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "reply_to_user": {"reputation": 7706, "user_id": 4058484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uQgA5.png?s=128&g=1", "display_name": "Chetabahana", "link": "https://stackoverflow.com/users/4058484/chetabahana"}, "edited": false, "score": 0, "creation_date": 1427001673, "post_id": 29187533, "comment_id": 46596518, "body": "The minutia of the implementation details are in the docs of the linked package repos. Likewise goes for printing it to the browser; this is a solution to your questions, not an implementation of your application."}, {"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "reply_to_user": {"reputation": 7706, "user_id": 4058484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uQgA5.png?s=128&g=1", "display_name": "Chetabahana", "link": "https://stackoverflow.com/users/4058484/chetabahana"}, "edited": false, "score": 0, "creation_date": 1427006263, "post_id": 29187533, "comment_id": 46597256, "body": "The best I can do is link you to these two resources: <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> and the bullets towards the bottom of <a href=\"http://stackoverflow.com/help/how-to-answer\">stackoverflow.com/help/how-to-answer</a>"}, {"owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "reply_to_user": {"reputation": 7706, "user_id": 4058484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uQgA5.png?s=128&g=1", "display_name": "Chetabahana", "link": "https://stackoverflow.com/users/4058484/chetabahana"}, "edited": false, "score": 0, "creation_date": 1427025343, "post_id": 29187533, "comment_id": 46601284, "body": "Though, in reality, you have not: &quot;...require too much guidance for you to answer in full, or request answers to multiple questions.&quot;"}, {"owner": {"reputation": 7706, "user_id": 4058484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uQgA5.png?s=128&g=1", "display_name": "Chetabahana", "link": "https://stackoverflow.com/users/4058484/chetabahana"}, "edited": false, "score": 0, "creation_date": 1427095450, "post_id": 29187533, "comment_id": 46621014, "body": "Thanks for your updated answer. Still got error for the import library of <b>the second ????</b> stating: <code>cannot find package &quot;golang.org&#47;x&#47;oauth2&quot; in any of: \t&#47;usr&#47;src&#47;go&#47;src&#47;golang.org&#47;x&#47;oauth2 (from $GOROOT) \t&#47;go&#47;src&#47;golang.org&#47;x&#47;oauth2 (from $GOPATH)</code> I run the code <a href=\"http://play.golang.org/p/caPzto97Ix\" rel=\"nofollow noreferrer\">here</a>"}], "tags": [], "owner": {"reputation": 2914, "user_id": 1162491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3MH1.jpg?s=128&g=1", "display_name": "Momer", "link": "https://stackoverflow.com/users/1162491/momer"}, "is_accepted": false, "score": 4, "last_activity_date": 1427050013, "last_edit_date": 1427050013, "creation_date": 1426968788, "answer_id": 29187533, "question_id": 29148777, "link": "https://stackoverflow.com/questions/29148777/how-to-get-my-image-base64-in-google-cloud-storage-with-go-script/29187533#29187533", "title": "How to get my image (base64) in Google-Cloud-Storage with go script", "body": "<p>From what I've read in your description, it seems that the only relevant parts are the <code>????</code> lines in the actual Go code. Let me know if that's not the case.</p>\n\n<h1>First ????: \"what code to get the string of 'mythumb.jpg' from url\"?</h1>\n\n<p>From reading the code, you're looking to extract <code>mythumb.jpg</code> from a url like <code>http://localhost/images/thumb/mythumb.jpg</code>. A working example is available at the <a href=\"https://golang.org/doc/articles/wiki/#tmp_3\" rel=\"nofollow\">Writing Web Applications</a> tutorial:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hi there, I love %s!\", r.URL.Path[1:])\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>Such that</p>\n\n<pre><code>http://localhost:8080/monkeys\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>Hi there, I love monkeys!\n</code></pre>\n\n<h1>Second ????: \"what code to get the image stored data from GCS\"?</h1>\n\n<p>The API method you're probably looking to use is <a href=\"https://cloud.google.com/storage/docs/json_api/v1/objects/get\" rel=\"nofollow\">storage.objects.get</a>.</p>\n\n<p>You did link to one of the <a href=\"https://cloud.google.com/storage/docs/json_api/v1/json-api-go-samples\" rel=\"nofollow\">JSON API Go Examples</a> for Google Cloud Storage, which is a good general reference, but is not related to the problem you're trying to solve. That particular example is put together for Client-side applications (hence the <code>redirectURL = \"urn:ietf:wg:oauth:2.0:oob\"</code> line). Additionally, this sample uses deprecated/out-of-date oauth2 and storage packages.</p>\n\n<p>One of the cleanest (and non-deprecated) ways to do this for an application which wants to access its own buckets on behalf of itself would be to use the <a href=\"https://github.com/golang/oauth2\" rel=\"nofollow\">golang/oauth2</a> and <a href=\"https://github.com/google/google-api-go-client\" rel=\"nofollow\">Google APIs Client Library for Go</a> packages.</p>\n\n<p>An example of how to authenticate with JSON Web Token auth with the <a href=\"https://github.com/golang/oauth2\" rel=\"nofollow\">golang/oauth2</a> package is <a href=\"https://github.com/golang/oauth2/blob/master/jwt/example_test.go\" rel=\"nofollow\">available in the repo</a>:</p>\n\n<pre><code>func ExampleJWTConfig() {\n    conf := &amp;jwt.Config{\n        Email: \"xxx@developer.com\",\n        // The contents of your RSA private key or your PEM file\n        // that contains a private key.\n        // If you have a p12 file instead, you\n        // can use `openssl` to export the private key into a pem file.\n        //\n        //    $ openssl pkcs12 -in key.p12 -out key.pem -nodes\n        //\n        // It only supports PEM containers with no passphrase.\n        PrivateKey: []byte(\"-----BEGIN RSA PRIVATE KEY-----...\"),\n        Subject:    \"user@example.com\",\n        TokenURL:   \"https://provider.com/o/oauth2/token\",\n    }\n    // Initiate an http.Client, the following GET request will be\n    // authorized and authenticated on the behalf of user@example.com.\n    client := conf.Client(oauth2.NoContext)\n    client.Get(\"...\")\n}\n</code></pre>\n\n<p>Next, instead of using the oauth2 <code>client</code> directly, use that client with the <a href=\"https://github.com/google/google-api-go-client\" rel=\"nofollow\">Google APIs Client Library for Go</a> mentioned earlier:</p>\n\n<pre><code>service, err := storage.New(client)\nif err != nil {\n    fatalf(service, \"Failed to create service %v\", err)\n}\n</code></pre>\n\n<p>Notice the similarity to the out-of-date <a href=\"https://cloud.google.com/storage/docs/json_api/v1/json-api-go-samples\" rel=\"nofollow\">JSON API Go Examples</a>?</p>\n\n<p>In your handler, you'll want to go out and get the related object using <a href=\"https://godoc.org/google.golang.org/api/storage/v1#ObjectsService.Get\" rel=\"nofollow\"><code>func ObjectsService.Get</code></a>. Assuming that you know the name of the <code>object</code> and <code>bucket</code>, that is.</p>\n\n<p>Straight from the previous example, you can use code similar to what's below to retrieve the download link:</p>\n\n<pre><code>if res, err := service.Objects.Get(bucketName, objectName).Do(); err == nil {\n    fmt.Printf(\"The media download link for %v/%v is %v.\\n\\n\", bucketName, res.Name, res.MediaLink)\n} else {\n    fatalf(service, \"Failed to get %s/%s: %s.\", bucketName, objectName, err)\n}\n</code></pre>\n\n<p>Then, fetch the file, or do whatever you want with it. Full example:</p>\n\n<pre><code>import (\n    \"golang.org/x/oauth2\"\n    \"golang.org/x/oauth2/jwt\"\n    \"google.golang.org/api/storage/v1\"\n    \"fmt\"\n)\n\n...\n\nconst (\n    bucketName = \"YOUR_BUCKET_NAME\"\n    objectName = \"mythumb.jpg\"\n)\n\nfunc main() {\n    conf := &amp;jwt.Config{\n        Email: \"xxx@developer.com\",\n        PrivateKey: []byte(\"-----BEGIN RSA PRIVATE KEY-----...\"),\n        Subject:    \"user@example.com\",\n        TokenURL:   \"https://provider.com/o/oauth2/token\",\n     }\n\n    client := conf.Client(oauth2.NoContext)\n\n    service, err := storage.New(client)\n    if err != nil {\n        fatalf(service, \"Failed to create service %v\", err)\n    }\n\n    if res, err := service.Objects.Get(bucketName, objectName).Do(); err == nil {\n        fmt.Printf(\"The media download link for %v/%v is %v.\\n\\n\", bucketName, res.Name, res.MediaLink)\n    } else {\n        fatalf(service, \"Failed to get %s/%s: %s.\", bucketName, objectName, err)\n    }\n\n    // Go fetch the file, etc.\n}\n</code></pre>\n\n<h1>Third ????: \"what code to encoce base64 data\"?</h1>\n\n<p>Pretty simple with the <a href=\"http://golang.org/pkg/encoding/base64/\" rel=\"nofollow\"><code>encoding/base64</code></a> package. SO simple, that they've included an <a href=\"http://golang.org/pkg/encoding/base64/#example_Encoding_EncodeToString\" rel=\"nofollow\">example</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/base64\"\n    \"fmt\"\n)\n\nfunc main() {\n    data := []byte(\"any + old &amp; data\")\n    str := base64.StdEncoding.EncodeToString(data)\n    fmt.Println(str)\n}\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 7706, "user_id": 4058484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uQgA5.png?s=128&g=1", "display_name": "Chetabahana", "link": "https://stackoverflow.com/users/4058484/chetabahana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1905, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1427520091, "creation_date": 1426779195, "last_edit_date": 1495540277, "question_id": 29148777, "link": "https://stackoverflow.com/questions/29148777/how-to-get-my-image-base64-in-google-cloud-storage-with-go-script", "title": "How to get my image (base64) in Google-Cloud-Storage with go script", "body": "<p>I have been looking for an example GAE script in <a href=\"https://stackoverflow.com/questions/11286534/test-cases-for-go-and-appengine\"><strong>go</strong></a> to get my image that I got from the resulted screenshot of <a href=\"https://developers.google.com/speed/docs/insights/v2/first-app\" rel=\"nofollow noreferrer\">PageSpeed Insights</a> and saved it as <em>json_decode</em> object using <a href=\"https://github.com/kohana/cache/tree/v3.3.0\" rel=\"nofollow noreferrer\">Kohana/Cache</a> to <em>Google Cloud Storage (GCS)</em>. </p>\n\n<p>The reason of this method is simply because I found this Kohana model is the most convenient way writing files to GCS, although I am seeking also other way like <a href=\"https://stackoverflow.com/questions/26987062/how-to-serve-google-cloud-storage-images\"><em>this</em></a> to write files to GCS using <a href=\"https://github.com/voscausa/appengine-gcs-blobstore-python\" rel=\"nofollow noreferrer\"><em>Blobstore</em></a> to serve them while the Go API Files has been deprecate as documented <a href=\"https://cloud.google.com/appengine/docs/go/blobstore/\" rel=\"nofollow noreferrer\"><em>here</em></a>.</p>\n\n<p>Here is the form of stored object containing the screenshot image data (base64) which is saved as public in default application bucket with object name <a href=\"https://www.googleapis.com/storage/v1/b/hyip-investment-monitors.appspot.com/o/images%2Fthumb%2Fmythumb.jpg\" rel=\"nofollow noreferrer\"><em>images/thumb/mythumb.jpg</em></a>:</p>\n\n<pre><code>stdClass Object\n(\n    [screenshot] =&gt; stdClass Object\n        (\n            [data] =&gt; _9j_4AAQSkZJRgABAQAAAQABAAD_...= // base64 data\n            [height] =&gt; 240\n            [mime_type] =&gt; image/jpeg\n            [width] =&gt; 320\n        )\n\n    [otherdata] =&gt; Array\n        (\n            [..] =&gt; ..\n            [..] =&gt; ..\n        )\n\n)\n</code></pre>\n\n<p>I want to get this image that set as <a href=\"https://cloud.google.com/appengine/docs/php/googlestorage/advanced#permissions_caching_and_metadata_options\" rel=\"nofollow noreferrer\"><em>public</em></a> using my customized url as below that to be proceed through <code>go module</code> and also I need it to be expired in a certain time because I have managed to update the image content itself regularly:</p>\n\n<blockquote>\n  <p><code>http://myappId.appspot.com/image/thumb/mythumb.jpg</code></p>\n</blockquote>\n\n<p>I have set in <em>disptach.yaml</em> to send all image request to my <code>go module</code> as below:</p>\n\n<pre><code>- url: \"*/images/*\"\n  module: go\n</code></pre>\n\n<p>and set the handler in <em>go.yaml</em> to proceed the image request as below:</p>\n\n<pre><code>handlers:\n- url: /images/thumb/.*\n  script: _go_app\n\n- url: /images\n  static_dir: images\n</code></pre>\n\n<p>Using this directive I have got that all <em>/images/</em> request (other than <em>/images/thumb/</em> request) serve images from the static directory and that <em>/images/thumb/mythumb.jpg</em> goes to the module application. </p>\n\n<p>So left what code I have to use (see <code>????</code>) in my application file named <em>thumb.go</em> as below:</p>\n\n<pre><code>package thumb\n\nimport(\n    //what to import\n    ????\n    ????\n)\n\nconst (\n    googleAccessID            = \"&lt;serviceAccountEmail&gt;@developer.gserviceaccount.com\"\n    serviceAccountPEMFilename = \"YOUR_SERVICE_ACCOUNT_KEY.pem\"\n    bucket                    = \"myappId.appspot.com\"\n)\n\nvar (\n    expiration = time.Now().Add(time.Second * 60) //expire in 60 seconds\n)\n\nfunc init() {\n    http.HandleFunc(\"/images/thumb/\", handleThumb)\n}\n\nfunc handleThumb(w http.ResponseWriter, r *http.Request) {\n    ctx := cloud.NewContext(appengine.AppID(c), hc)\n    ???? //what code to get the string of 'mythumb.jpg' from url\n    ???? //what code to get the image stored data from GCS\n    ???? //what code to encoce base64 data\n    w.Header().Set(\"Content-Type\", \"image/jpeg;\")    \n    fmt.Fprintf(w, \"%v\", mythumb.jpg)\n}\n</code></pre>\n\n<p>I have taken many codes from some examples like <a href=\"https://cloud.google.com/appengine/docs/go/googlecloudstorageclient/getstarted\" rel=\"nofollow noreferrer\"><em>this</em></a>, <a href=\"https://cloud.google.com/storage/docs/access-control#signing-code-go\" rel=\"nofollow noreferrer\"><em>this</em></a> or <a href=\"https://cloud.google.com/storage/docs/json_api/v1/json-api-go-samples\" rel=\"nofollow noreferrer\"><em>this</em></a> but could not get one works so far. I have also tried a sample from <a href=\"http://play.golang.org/p/TkKRROJTfb\" rel=\"nofollow noreferrer\"><em>this</em></a> which is almost close to <a href=\"http://play.golang.org/p/oS2K-Z4NQx\" rel=\"nofollow noreferrer\"><em>my case</em></a> but also found no luck.</p>\n\n<p>So in generally t was mainly due to lack on what are the correct code to be put on the line that I marked by <code>????</code> as well the relevant library or path to be imported. I have also checked the <a href=\"https://cloud.google.com/appengine/docs/go/googlecloudstorageclient/activate\" rel=\"nofollow noreferrer\"><em>GCS permission</em></a> if something have been missing as described <a href=\"https://stackoverflow.com/questions/20294785/how-to-use-google-cloud-storage-for-php\"><em>here</em></a> and <a href=\"https://github.com/GoogleCloudPlatform/gcloud-golang/issues/118\" rel=\"nofollow noreferrer\"><em>here</em></a>.</p>\n\n<p>I shall thank you much for your help and advise.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4122236"}, "edited": false, "score": 0, "creation_date": 1426779875, "post_id": 29148800, "comment_id": 46520228, "body": "Is there a reason to use <code>hex.EncodeToString([]byte(objid))</code> instead of the <a href=\"http://godoc.org/gopkg.in/mgo.v2/bson#ObjectId.Hex\" rel=\"nofollow noreferrer\">Hex</a> method?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1426780158, "post_id": 29148800, "comment_id": 46520428, "body": "@BeBop I don&#39;t think so. I just didn&#39;t know about the <code>Hex()</code> method. Should I add it to the answer or you post it as a new answer?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 11, "last_activity_date": 1499426217, "last_edit_date": 1499426217, "creation_date": 1426779244, "answer_id": 29148800, "question_id": 29146922, "link": "https://stackoverflow.com/questions/29146922/obtain-objectidhex-value-from-mgo-query/29148800#29148800", "title": "Obtain ObjectIdHex value from mgo query", "body": "<p>The value associated with key <code>\"_id\"</code> is of type <a href=\"https://godoc.org/gopkg.in/mgo.v2/bson#ObjectId\" rel=\"noreferrer\"><code>bson.ObjectId</code></a> which is simply a <code>string</code>.</p>\n\n<p><a href=\"https://godoc.org/gopkg.in/mgo.v2/bson#M\" rel=\"noreferrer\"><code>bson.M</code></a> is a type <code>map[string]interface{}</code>, so you need <a href=\"http://golang.org/ref/spec#Type_assertions\" rel=\"noreferrer\">Type assertion</a> to get the id as an <code>ObjectId</code>:</p>\n\n<pre><code>objid, ok := m[\"_id\"].(ObjectId)\nif !ok {\n    panic(\"Not ObjectId\")\n}\n</code></pre>\n\n<p>And the <code>ObjectId</code> has a <a href=\"http://godoc.org/gopkg.in/mgo.v2/bson#ObjectId.Hex\" rel=\"noreferrer\"><code>ObjectId.Hex()</code></a> method which returns exactly what you want: the object id as a \"pure\" hex string:</p>\n\n<pre><code>fmt.Println(objid.Hex())\n</code></pre>\n\n<h3>Alternatives</h3>\n\n<p><code>objid</code> can simply be converted to <code>string</code> because its underlying type is <code>string</code>. So you can use a number of further options to convert it to a hex <code>string</code>:</p>\n\n<pre><code>hexid := fmt.Sprintf(\"%x\", string(objid))\n</code></pre>\n\n<p>If you just want to print it, you can do directly:</p>\n\n<pre><code>fmt.Printf(\"%x\", string(objid))\n</code></pre>\n\n<p><strong>Note:</strong> Converting it to <code>string</code> is important else the <code>fmt</code> package would call its <code>String()</code> method which results in a string like <code>ObjectIdHex(\"537f700b537461b70c5f0000\")</code> and this is what would be converted to hex which is clearly not what you want.</p>\n\n<p><strong>Alternatively</strong> you can use the <a href=\"http://golang.org/pkg/encoding/hex/\" rel=\"noreferrer\"><code>encoding/hex</code></a> package and the <a href=\"http://golang.org/pkg/encoding/hex/#EncodeToString\" rel=\"noreferrer\"><code>hex.EncodeToString()</code></a> function:</p>\n\n<pre><code>hexid := hex.EncodeToString([]byte(objid))\n</code></pre>\n"}], "owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4789, "favorite_count": 0, "accepted_answer_id": 29148800, "answer_count": 1, "score": 5, "last_activity_date": 1535969933, "creation_date": 1426774487, "last_edit_date": 1535969933, "question_id": 29146922, "link": "https://stackoverflow.com/questions/29146922/obtain-objectidhex-value-from-mgo-query", "title": "Obtain ObjectIdHex value from mgo query", "body": "<p>I'm still new to go and while I see multiple questions on SO similar to this, I'm unable to reproduce the output some OP's had requested (<a href=\"https://stackoverflow.com/a/23490793/3109182\">this answer looking the closest</a>).  </p>\n\n<p>I'm doing something fairly simple, I'm hitting a <code>users</code> collection in mongo and all I want to do is get the <code>_id</code> value back as a string.  I'm going to eventually push these <code>_id</code>'s up to NSQ but that's the brunt of my task.</p>\n\n<pre><code>var users []bson.M\nerr = sess.DB(\"db_name\").C(\"users\").Find(bson.M{}).All(&amp;users)\n\nif err != nil {\n    os.Exit(1)\n}\n\nfor _, user := range users {\n    fmt.Printf(\"%+v \\n\", user[\"_id\"])\n}\n</code></pre>\n\n<p>Today this outputs:</p>\n\n<pre><code>ObjectIdHex(\"537f700b537461b70c5f0000\")\nObjectIdHex(\"537f700b537461b70c600000\")\nObjectIdHex(\"537f700b537461b70c610000\")\nObjectIdHex(\"537f700b537461b70c620000\")\n</code></pre>\n\n<p>I went through the <a href=\"http://godoc.org/labix.org/v2/mgo/bson#M\" rel=\"nofollow noreferrer\">bson#m</a> docs and thought I was correctly using the map in order to extra the value.  So I think, my query results in:</p>\n\n<pre><code>{\"_id\" : ObjectIdHex(\"Some_ID\") }\n</code></pre>\n\n<p>but if ObjectIdHex(\"ID\") is the value, how do I simply get the string within there. </p>\n\n<p>So ideal output:</p>\n\n<pre><code>\"537f700b537461b70c5f0000\"\n\"537f700b537461b70c600000\"\n\"537f700b537461b70c610000\"\n\"537f700b537461b70c620000\"\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 21722, "user_id": 357705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9cb8f635bfd71c18b91e1b0ed5d2ee9?s=128&d=identicon&r=PG", "display_name": "jimt", "link": "https://stackoverflow.com/users/357705/jimt"}, "is_accepted": false, "score": 3, "last_activity_date": 1426772454, "creation_date": 1426772454, "answer_id": 29146165, "question_id": 29145577, "link": "https://stackoverflow.com/questions/29145577/how-to-store-unicode-in-a-go-struct-golang/29146165#29146165", "title": "How to store unicode in a Go struct (golang)", "body": "<p>Go expects string data to be encoded as UTF-8. If your input data uses a different encoding, you will need to convert it to UTF-8 before assigning it to a string.</p>\n\n<p>You can do this manually, or use a third party library like <a href=\"https://code.google.com/p/go-charset/\" rel=\"nofollow\">go-charset</a></p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426781450, "post_id": 29146202, "comment_id": 46521303, "body": "In addition to the excellent blog post mentioned, I&#39;d also recommend reading the <a href=\"https://blog.golang.org/normalization\" rel=\"nofollow noreferrer\">Text normalization in Go</a> article."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 3, "last_activity_date": 1426773132, "last_edit_date": 1426773132, "creation_date": 1426772560, "answer_id": 29146202, "question_id": 29145577, "link": "https://stackoverflow.com/questions/29145577/how-to-store-unicode-in-a-go-struct-golang/29146202#29146202", "title": "How to store unicode in a Go struct (golang)", "body": "<p>It depends on what you mean by \"unicode\". Everything in Go is expected to be UTF-8, including the <code>string</code> datatype, so there's probably nothing you need to do (as long as you're dealing with UTF-8).</p>\n\n<p><code>[]byte</code> is just a series of bytes. It opaque to the data that's in it. You don't need to do anything special to write it to a file. </p>\n\n<p>The stdlib has the <a href=\"http://golang.org/pkg/unicode/\" rel=\"nofollow\"><code>unicode</code></a>, <a href=\"http://golang.org/pkg/unicode/utf8/\" rel=\"nofollow\"><code>unicode/utf8</code></a>, and <a href=\"http://golang.org/pkg/unicode/utf16/\" rel=\"nofollow\"><code>unicode/utf16</code></a> packages. There's also a normalization package if you need it here: <a href=\"http://godoc.org/golang.org/x/text/unicode/norm\" rel=\"nofollow\">http://godoc.org/golang.org/x/text/unicode/norm</a></p>\n\n<p>This blog post can explain it in more depth than we can answer here, and has some links to more resources: <a href=\"http://blog.golang.org/strings\" rel=\"nofollow\">http://blog.golang.org/strings</a></p>\n"}], "owner": {"reputation": 283, "user_id": 1346779, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/Q2FaG.jpg?s=128&g=1", "display_name": "Douglas Fils", "link": "https://stackoverflow.com/users/1346779/douglas-fils"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1426773132, "creation_date": 1426770860, "question_id": 29145577, "link": "https://stackoverflow.com/questions/29145577/how-to-store-unicode-in-a-go-struct-golang", "title": "How to store unicode in a Go struct (golang)", "body": "<p>I am reading in unicode names in golang.   My struct item is of type string, but this not correct I believe.  </p>\n\n<p>Is there an example of how to properly store unicode strings in a golang struct?</p>\n\n<p>When I read the CSV document using csv.NewReader and print it to screen it works fine, but once in the struct as a string, it no longer prints correctly.  This seems like a simple byte / string issue but I am having a hard time resolving it.  </p>\n\n<p>I tried using []byte in the struct, but then how do I do comparisons of the strings laters and what is the way I would print that []byte to a file correctly?  Since I am writing to file as RDF, I suspect I need to convert to UTF-8 or something?</p>\n"}, {"tags": ["inheritance", "go", "struct", "interface", "embedding"], "answers": [{"comments": [{"owner": {"reputation": 837, "user_id": 4407235, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/852456ad707667cfbd432a0bebef780b?s=128&d=identicon&r=PG&f=1", "display_name": "unnamed_addr", "link": "https://stackoverflow.com/users/4407235/unnamed-addr"}, "edited": false, "score": 0, "creation_date": 1426769632, "post_id": 29145086, "comment_id": 46512845, "body": "Thank you for your answer. But how can I rethink my design for a non-OO language?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 837, "user_id": 4407235, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/852456ad707667cfbd432a0bebef780b?s=128&d=identicon&r=PG&f=1", "display_name": "unnamed_addr", "link": "https://stackoverflow.com/users/4407235/unnamed-addr"}, "edited": false, "score": 0, "creation_date": 1426769862, "post_id": 29145086, "comment_id": 46512990, "body": "@unnamed_addr You mean for Go? What is the problem with empty methods?"}, {"owner": {"reputation": 837, "user_id": 4407235, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/852456ad707667cfbd432a0bebef780b?s=128&d=identicon&r=PG&f=1", "display_name": "unnamed_addr", "link": "https://stackoverflow.com/users/4407235/unnamed-addr"}, "edited": false, "score": 0, "creation_date": 1426770165, "post_id": 29145086, "comment_id": 46513220, "body": "I don&#39;t have any problem with typing more but I was thinking I was doing it the wrong way. That is the reason for me asking this question."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 837, "user_id": 4407235, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/852456ad707667cfbd432a0bebef780b?s=128&d=identicon&r=PG&f=1", "display_name": "unnamed_addr", "link": "https://stackoverflow.com/users/4407235/unnamed-addr"}, "edited": false, "score": 1, "creation_date": 1426770569, "post_id": 29145086, "comment_id": 46513488, "body": "@unnamed_addr I edited my answer to show you a &quot;technic&quot; how to reduce the empty methods. This way you only have to write them once, and they are &quot;inherited&quot;."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1519388864, "last_edit_date": 1519388864, "creation_date": 1426769462, "answer_id": 29145086, "question_id": 29144622, "link": "https://stackoverflow.com/questions/29144622/what-is-the-idiomatic-way-in-go-to-create-a-complex-hierarchy-of-structs/29145086#29145086", "title": "What is the idiomatic way in Go to create a complex hierarchy of structs?", "body": "<p>Go is <a href=\"http://golang.org/doc/faq#Is_Go_an_object-oriented_language\" rel=\"nofollow noreferrer\">not (quite) an object oriented language</a>: it does not have classes and it <a href=\"http://golang.org/doc/faq#inheritance\" rel=\"nofollow noreferrer\">does not have type inheritance</a>; but it supports a similar construct called <em>embedding</em> both on <code>struct</code> level and on <code>interface</code> level, and it does have <a href=\"http://golang.org/ref/spec#Method_declarations\" rel=\"nofollow noreferrer\">methods</a>.</p>\n\n<p><a href=\"http://golang.org/ref/spec#Interface_types\" rel=\"nofollow noreferrer\">Interfaces</a> in Go are just fixed method sets. A type <em>implicitly</em> implements an interface if its method set is a superset of the interface (there is no declaration of the intent).</p>\n\n<p>Empty methods are great if you want to <em>document</em> or <em>state explicitly</em> that your type does implement an interface (because it is not stated explicitly). Official <a href=\"https://golang.org/doc/faq#guarantee_satisfies_interface\" rel=\"nofollow noreferrer\">Go FAQ: How can I guarantee my type satisfies an interface?</a></p>\n\n<pre><code>type Fooer interface {\n    Foo()\n    ImplementsFooer()\n}\n</code></pre>\n\n<p>If you want a distinction in your type hierarchy (e.g. you don't want to allow an object to be both <code>Movable</code> and <code>Immovable</code>), they must have different method sets (there must be at least 1 method in each of the method sets of <code>Movable</code> and <code>Immovable</code> that is not present in the other's), because if the method sets would contain the same methods, an implementation of one would automatically implement the other too therefore you could assign a <code>Movable</code> object to a variable of type <code>Immovable</code>.</p>\n\n<p>Adding an empty method to the interface with the same name will provide you this distinction, assuming that you will not add such methods to other types.</p>\n\n<h1>Reducing the number of empty methods</h1>\n\n<p>Personally I have no problem with empty methods whatsoever. There is a way to reduce them though.</p>\n\n<p>If you also create a <code>struct</code> <em>implementation</em> for each type in the hierarchy and each implementation <em>embeds</em> the <code>struct</code> implementation one level higher, the method set of one level higher will automatically come without further ado:</p>\n\n<h3>Object</h3>\n\n<p><code>Object</code> interface and <code>ObjectImpl</code> implementation:</p>\n\n<pre><code>type Object interface {\n  object()\n}\ntype ObjectImpl struct {}\nfunc (o *ObjectImpl) object() {}\n</code></pre>\n\n<h3>Immovable</h3>\n\n<p><code>Immovable</code> interface and <code>ImmovableImpl</code> implementation:</p>\n\n<pre><code>type Immovable interface {\n    Object\n    immovable()\n}\ntype ImmovableImpl struct {\n    ObjectImpl // Embed ObjectImpl\n}\nfunc (o *Immovable) immovable() {}\n</code></pre>\n\n<p><em>Note <code>ImmovableImpl</code> only adds <code>immovable()</code> method, <code>object()</code> is \"inherited\".</em></p>\n\n<h3>Building</h3>\n\n<p><code>Building</code> implementation:</p>\n\n<pre><code>type Building struct {\n    ImmovableImpl // Embed ImmovableImpl struct\n\n    // Building-specific other fields may come here\n}\n</code></pre>\n\n<p><em>Note <code>Building</code> <strong>does not add</strong> any new methods yet it is automatically an <code>Immovable</code> object.</em></p>\n\n<p>The advantage of this technic grows greatly if the number of \"subtypes\" increases or if the interface types have more than just 1 \"marker\" method (because all methods are \"inherited\").</p>\n"}], "owner": {"reputation": 837, "user_id": 4407235, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/852456ad707667cfbd432a0bebef780b?s=128&d=identicon&r=PG&f=1", "display_name": "unnamed_addr", "link": "https://stackoverflow.com/users/4407235/unnamed-addr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1751, "favorite_count": 4, "accepted_answer_id": 29145086, "answer_count": 1, "score": 8, "last_activity_date": 1519388864, "creation_date": 1426768161, "last_edit_date": 1475439361, "question_id": 29144622, "link": "https://stackoverflow.com/questions/29144622/what-is-the-idiomatic-way-in-go-to-create-a-complex-hierarchy-of-structs", "title": "What is the idiomatic way in Go to create a complex hierarchy of structs?", "body": "<p>I am writing an interpreter in Go and I am looking for the idiomatic way to store the AST. I read the Go compiler source code and it seems they used interfaces with an empty method to represent the AST. For example, we have the following hierarchy,</p>\n\n<pre><code>Object\n--Immovable\n----Building\n----Mountain\n--Movable\n----Car\n----Bike\n</code></pre>\n\n<p>This is how the above hierarchy is implemented in the \"empty method\" way.</p>\n\n<pre><code>type Object interface {\n  object()\n}\n\ntype Immovable interface {\n  Object\n  immovable()\n}\n\ntype Building struct {\n  ... \n}\n\ntype Mountain struct {\n  ... \n}\n\ntype Movable interface {\n  Object\n  movable()\n}\n\ntype Car struct {\n  ...\n} \n\ntype Mountain struct {\n  ...\n} \n\nfunc (*Building) object() {}\nfunc (*Mountain) object() {}\nfunc (*Car) object() {}\nfunc (*Bike) object() {}\nfunc (*Building) immovable() {}\nfunc (*Mountain) immovable() {}\nfunc (*Car) movable() {}\nfunc (*Bike) movable() {}    \n</code></pre>\n\n<p>The above code is a contrived example and this is how the Go compiler <a href=\"https://golang.org/src/go/ast/ast.go\" rel=\"nofollow\">implemented</a> the AST with dozens of empty methods. But WHY? Note how many empty methods are defined. It may get very complicated with the increase of the depth of the hierarchy. </p>\n\n<p>It is stated in the comments that the empty methods disallow the assignment of incompatible types. In our example, a <code>*Car</code> can't be assigned to a <code>*Immovable</code> for instance.</p>\n\n<p>This is so easy in other languages like C++ that supports inheritance. I can't think of any other way of representing the AST.</p>\n\n<p>The way how the Go compiler AST is implemented may be idiomatic but isn't it less straight forward? </p>\n"}, {"tags": ["azure", "go", "single-sign-on"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4575036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ae263893365b1331d893219ca9ee388?s=128&d=identicon&r=PG&f=1", "display_name": "anju", "link": "https://stackoverflow.com/users/4575036/anju"}, "edited": false, "score": 0, "creation_date": 1426768528, "post_id": 29143721, "comment_id": 46512111, "body": "Could you suggest me which one is the best among them to use along with golang?"}, {"owner": {"reputation": 5253, "user_id": 2899711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5y9EZ.jpg?s=128&g=1", "display_name": "Simon W", "link": "https://stackoverflow.com/users/2899711/simon-w"}, "reply_to_user": {"reputation": 11, "user_id": 4575036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ae263893365b1331d893219ca9ee388?s=128&d=identicon&r=PG&f=1", "display_name": "anju", "link": "https://stackoverflow.com/users/4575036/anju"}, "edited": false, "score": 0, "creation_date": 1426818566, "post_id": 29143721, "comment_id": 46537173, "body": "It will depend on library support for the protocol (SAML, etc) and the type of application you&#39;re building (web, mobile native, etc). You&#39;ll most likely find answers to that elsewhere on SO such as: <a href=\"http://stackoverflow.com/questions/12310828/is-there-a-saml-library-for-the-go-language\" title=\"is there a saml library for the go language\">stackoverflow.com/questions/12310828/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5253, "user_id": 2899711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5y9EZ.jpg?s=128&g=1", "display_name": "Simon W", "link": "https://stackoverflow.com/users/2899711/simon-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1426765531, "creation_date": 1426765531, "answer_id": 29143721, "question_id": 29142361, "link": "https://stackoverflow.com/questions/29142361/enable-single-sign-on/29143721#29143721", "title": "Enable single sign on", "body": "<p>Azure AD can provide auth via WS-Fed, SAML-P, OAuth2 and OpenID Connect.  As long as you develop using one of those then your application can be registered in Azure AD as an application and can leverage the standard protocols listed above.</p>\n"}], "owner": {"reputation": 11, "user_id": 4575036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ae263893365b1331d893219ca9ee388?s=128&d=identicon&r=PG&f=1", "display_name": "anju", "link": "https://stackoverflow.com/users/4575036/anju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 212, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1426765531, "creation_date": 1426761601, "question_id": 29142361, "link": "https://stackoverflow.com/questions/29142361/enable-single-sign-on", "title": "Enable single sign on", "body": "<p>Hi I have to develop a framework to enable single sign on for an application that my organisation develops.I want the framework to be in GOLANG.I want to authenticate the users with azure active directory details.How can I achieve this?</p>\n"}, {"tags": ["testing", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1426781123, "post_id": 29141579, "comment_id": 46521106, "body": "I see nothing unclear in the documentation you link to. IMO, your question is equivalent to something like &quot;the spec mentions <code>int</code> what is the meaning and use case for it?&quot; i.e. so vague/basic or with no real question as to be useless."}, {"owner": {"reputation": 1598, "user_id": 1104534, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad2bdd8c4d37364f52e6ab7aa92ef570?s=128&d=identicon&r=PG", "display_name": "Calin", "link": "https://stackoverflow.com/users/1104534/calin"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1426782086, "post_id": 29141579, "comment_id": 46521718, "body": "@icza&#39;s answer was spot on. The docs don&#39;t mention that example functions are used with <code>godoc</code>, so it was unclear to me what you would use them for."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1431087155, "last_edit_date": 1431087155, "creation_date": 1426759766, "answer_id": 29141725, "question_id": 29141579, "link": "https://stackoverflow.com/questions/29141579/what-are-go-example-functions/29141725#29141725", "title": "What are Go example functions?", "body": "<p>Example functions are usage examples of a package or functions or other code you're documenting. Example functions will be included in the generated godoc in source form (while other functions are not), with proper formatting, also some processing applied, for example if last line of the example function contains output in the format of:</p>\n\n<pre><code>func ExampleExamples_output() {\n    fmt.Println(\"Hello\")\n    // Output: Hello\n}\n</code></pre>\n\n<p>The last line specifying the output will be stripped and rendered in a separate block, as can be seen here: <a href=\"https://godoc.org/github.com/fluhus/godoc-tricks#example-Examples--Output\" rel=\"nofollow noreferrer\">Example (Output)</a>.</p>\n\n<p>Also if the output is provided: running the package's test suite (e.g. with <code>go test</code>) also executes example functions with no further arrangement from you, and Go compares the output of the example function with the output specified in the last comment line - the result of this will determine if this example function as \"test\" passes. If output is not specified in the example function, <code>go test</code> will only compile it but will not execute it.</p>\n\n<p>Check out this page: <a href=\"https://godoc.org/github.com/fluhus/godoc-tricks\" rel=\"nofollow noreferrer\"><strong>package godoctricks</strong></a></p>\n\n<p>Also a blog article has been published about Example functions:</p>\n\n<p><a href=\"http://blog.golang.org/examples\" rel=\"nofollow noreferrer\"><strong>Testable Examples in Go</strong></a></p>\n"}], "owner": {"reputation": 1598, "user_id": 1104534, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad2bdd8c4d37364f52e6ab7aa92ef570?s=128&d=identicon&r=PG", "display_name": "Calin", "link": "https://stackoverflow.com/users/1104534/calin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 805, "favorite_count": 1, "accepted_answer_id": 29141725, "answer_count": 1, "score": 8, "last_activity_date": 1431087155, "creation_date": 1426759314, "question_id": 29141579, "link": "https://stackoverflow.com/questions/29141579/what-are-go-example-functions", "title": "What are Go example functions?", "body": "<p>The Go testing package mentions <a href=\"http://golang.org/pkg/testing/#hdr-Examples\">example functions</a> as in:</p>\n\n<pre><code>func Example() { ... }\nfunc ExampleF() { ... }\nfunc ExampleT() { ... }\nfunc ExampleT_M() { ... }\n</code></pre>\n\n<p>What is the meaning and use case for these?</p>\n"}]